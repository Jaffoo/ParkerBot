var GC=Object.defineProperty;var QC=(t,r,e)=>r in t?GC(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var JC=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports);var Fi=(t,r,e)=>(QC(t,typeof r!="symbol"?r+"":r,e),e);var YC=JC((exports,module)=>{(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=e(o);fetch(o.href,s)}})();function makeMap(t,r){const e=Object.create(null),n=t.split(",");for(let o=0;o<n.length;o++)e[n[o]]=!0;return r?o=>!!e[o.toLowerCase()]:o=>!!e[o]}const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,onRE=/^on[^a-z]/,isOn=t=>onRE.test(t),isModelListener=t=>t.startsWith("onUpdate:"),extend$1=Object.assign,remove=(t,r)=>{const e=t.indexOf(r);e>-1&&t.splice(e,1)},hasOwnProperty$e=Object.prototype.hasOwnProperty,hasOwn=(t,r)=>hasOwnProperty$e.call(t,r),isArray$4=Array.isArray,isMap$2=t=>toTypeString(t)==="[object Map]",isSet$2=t=>toTypeString(t)==="[object Set]",isDate$1=t=>toTypeString(t)==="[object Date]",isFunction$3=t=>typeof t=="function",isString$2=t=>typeof t=="string",isSymbol$1=t=>typeof t=="symbol",isObject$2=t=>t!==null&&typeof t=="object",isPromise=t=>(isObject$2(t)||isFunction$3(t))&&isFunction$3(t.then)&&isFunction$3(t.catch),objectToString$1=Object.prototype.toString,toTypeString=t=>objectToString$1.call(t),toRawType=t=>toTypeString(t).slice(8,-1),isPlainObject$1=t=>toTypeString(t)==="[object Object]",isIntegerKey=t=>isString$2(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=t=>{const r=Object.create(null);return e=>r[e]||(r[e]=t(e))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(t=>t.replace(camelizeRE,(r,e)=>e?e.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(t=>t.replace(hyphenateRE,"-$1").toLowerCase()),capitalize$1=cacheStringFunction(t=>t.charAt(0).toUpperCase()+t.slice(1)),toHandlerKey=cacheStringFunction(t=>t?`on${capitalize$1(t)}`:""),hasChanged=(t,r)=>!Object.is(t,r),invokeArrayFns=(t,r)=>{for(let e=0;e<t.length;e++)t[e](r)},def=(t,r,e)=>{Object.defineProperty(t,r,{configurable:!0,enumerable:!1,value:e})},looseToNumber=t=>{const r=parseFloat(t);return isNaN(r)?t:r},toNumber$1=t=>{const r=isString$2(t)?Number(t):NaN;return isNaN(r)?t:r};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function normalizeStyle(t){if(isArray$4(t)){const r={};for(let e=0;e<t.length;e++){const n=t[e],o=isString$2(n)?parseStringStyle(n):normalizeStyle(n);if(o)for(const s in o)r[s]=o[s]}return r}else if(isString$2(t)||isObject$2(t))return t}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(t){const r={};return t.replace(styleCommentRE,"").split(listDelimiterRE).forEach(e=>{if(e){const n=e.split(propertyDelimiterRE);n.length>1&&(r[n[0].trim()]=n[1].trim())}}),r}function normalizeClass(t){let r="";if(isString$2(t))r=t;else if(isArray$4(t))for(let e=0;e<t.length;e++){const n=normalizeClass(t[e]);n&&(r+=n+" ")}else if(isObject$2(t))for(const e in t)t[e]&&(r+=e+" ");return r.trim()}function normalizeProps(t){if(!t)return null;let{class:r,style:e}=t;return r&&!isString$2(r)&&(t.class=normalizeClass(r)),e&&(t.style=normalizeStyle(e)),t}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(t){return!!t||t===""}function looseCompareArrays(t,r){if(t.length!==r.length)return!1;let e=!0;for(let n=0;e&&n<t.length;n++)e=looseEqual(t[n],r[n]);return e}function looseEqual(t,r){if(t===r)return!0;let e=isDate$1(t),n=isDate$1(r);if(e||n)return e&&n?t.getTime()===r.getTime():!1;if(e=isSymbol$1(t),n=isSymbol$1(r),e||n)return t===r;if(e=isArray$4(t),n=isArray$4(r),e||n)return e&&n?looseCompareArrays(t,r):!1;if(e=isObject$2(t),n=isObject$2(r),e||n){if(!e||!n)return!1;const o=Object.keys(t).length,s=Object.keys(r).length;if(o!==s)return!1;for(const a in t){const i=t.hasOwnProperty(a),u=r.hasOwnProperty(a);if(i&&!u||!i&&u||!looseEqual(t[a],r[a]))return!1}}return String(t)===String(r)}function looseIndexOf(t,r){return t.findIndex(e=>looseEqual(e,r))}const toDisplayString=t=>isString$2(t)?t:t==null?"":isArray$4(t)||isObject$2(t)&&(t.toString===objectToString$1||!isFunction$3(t.toString))?JSON.stringify(t,replacer,2):String(t),replacer=(t,r)=>r&&r.__v_isRef?replacer(t,r.value):isMap$2(r)?{[`Map(${r.size})`]:[...r.entries()].reduce((e,[n,o])=>(e[`${n} =>`]=o,e),{})}:isSet$2(r)?{[`Set(${r.size})`]:[...r.values()]}:isObject$2(r)&&!isArray$4(r)&&!isPlainObject$1(r)?String(r):r;let activeEffectScope;class EffectScope{constructor(r=!1){this.detached=r,this._active=!0,this.effects=[],this.cleanups=[],this.parent=activeEffectScope,!r&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}run(r){if(this._active){const e=activeEffectScope;try{return activeEffectScope=this,r()}finally{activeEffectScope=e}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(r){if(this._active){let e,n;for(e=0,n=this.effects.length;e<n;e++)this.effects[e].stop();for(e=0,n=this.cleanups.length;e<n;e++)this.cleanups[e]();if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!r){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0,this._active=!1}}}function effectScope(t){return new EffectScope(t)}function recordEffectScope(t,r=activeEffectScope){r&&r.active&&r.effects.push(t)}function getCurrentScope(){return activeEffectScope}function onScopeDispose(t){activeEffectScope&&activeEffectScope.cleanups.push(t)}const createDep=t=>{const r=new Set(t);return r.w=0,r.n=0,r},wasTracked=t=>(t.w&trackOpBit)>0,newTracked=t=>(t.n&trackOpBit)>0,initDepMarkers=({deps:t})=>{if(t.length)for(let r=0;r<t.length;r++)t[r].w|=trackOpBit},finalizeDepMarkers=t=>{const{deps:r}=t;if(r.length){let e=0;for(let n=0;n<r.length;n++){const o=r[n];wasTracked(o)&&!newTracked(o)?o.delete(t):r[e++]=o,o.w&=~trackOpBit,o.n&=~trackOpBit}r.length=e}},targetMap=new WeakMap;let effectTrackDepth=0,trackOpBit=1;const maxMarkerBits=30;let activeEffect;const ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol("");class ReactiveEffect{constructor(r,e=null,n){this.fn=r,this.scheduler=e,this.active=!0,this.deps=[],this.parent=void 0,recordEffectScope(this,n)}run(){if(!this.active)return this.fn();let r=activeEffect,e=shouldTrack;for(;r;){if(r===this)return;r=r.parent}try{return this.parent=activeEffect,activeEffect=this,shouldTrack=!0,trackOpBit=1<<++effectTrackDepth,effectTrackDepth<=maxMarkerBits?initDepMarkers(this):cleanupEffect(this),this.fn()}finally{effectTrackDepth<=maxMarkerBits&&finalizeDepMarkers(this),trackOpBit=1<<--effectTrackDepth,activeEffect=this.parent,shouldTrack=e,this.parent=void 0,this.deferStop&&this.stop()}}stop(){activeEffect===this?this.deferStop=!0:this.active&&(cleanupEffect(this),this.onStop&&this.onStop(),this.active=!1)}}function cleanupEffect(t){const{deps:r}=t;if(r.length){for(let e=0;e<r.length;e++)r[e].delete(t);r.length=0}}let shouldTrack=!0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const t=trackStack.pop();shouldTrack=t===void 0?!0:t}function track(t,r,e){if(shouldTrack&&activeEffect){let n=targetMap.get(t);n||targetMap.set(t,n=new Map);let o=n.get(e);o||n.set(e,o=createDep()),trackEffects(o)}}function trackEffects(t,r){let e=!1;effectTrackDepth<=maxMarkerBits?newTracked(t)||(t.n|=trackOpBit,e=!wasTracked(t)):e=!t.has(activeEffect),e&&(t.add(activeEffect),activeEffect.deps.push(t))}function trigger(t,r,e,n,o,s){const a=targetMap.get(t);if(!a)return;let i=[];if(r==="clear")i=[...a.values()];else if(e==="length"&&isArray$4(t)){const u=Number(n);a.forEach((d,c)=>{(c==="length"||!isSymbol$1(c)&&c>=u)&&i.push(d)})}else switch(e!==void 0&&i.push(a.get(e)),r){case"add":isArray$4(t)?isIntegerKey(e)&&i.push(a.get("length")):(i.push(a.get(ITERATE_KEY)),isMap$2(t)&&i.push(a.get(MAP_KEY_ITERATE_KEY)));break;case"delete":isArray$4(t)||(i.push(a.get(ITERATE_KEY)),isMap$2(t)&&i.push(a.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap$2(t)&&i.push(a.get(ITERATE_KEY));break}if(i.length===1)i[0]&&triggerEffects(i[0]);else{const u=[];for(const d of i)d&&u.push(...d);triggerEffects(createDep(u))}}function triggerEffects(t,r){const e=isArray$4(t)?t:[...t];for(const n of e)n.computed&&triggerEffect(n);for(const n of e)n.computed||triggerEffect(n)}function triggerEffect(t,r){(t!==activeEffect||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}function getDepFromReactive(t,r){var e;return(e=targetMap.get(t))==null?void 0:e.get(r)}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(isSymbol$1)),arrayInstrumentations=createArrayInstrumentations();function createArrayInstrumentations(){const t={};return["includes","indexOf","lastIndexOf"].forEach(r=>{t[r]=function(...e){const n=toRaw(this);for(let s=0,a=this.length;s<a;s++)track(n,"get",s+"");const o=n[r](...e);return o===-1||o===!1?n[r](...e.map(toRaw)):o}}),["push","pop","shift","unshift","splice"].forEach(r=>{t[r]=function(...e){pauseTracking();const n=toRaw(this)[r].apply(this,e);return resetTracking(),n}}),t}function hasOwnProperty$d(t){const r=toRaw(this);return track(r,"has",t),r.hasOwnProperty(t)}class BaseReactiveHandler{constructor(r=!1,e=!1){this._isReadonly=r,this._shallow=e}get(r,e,n){const o=this._isReadonly,s=this._shallow;if(e==="__v_isReactive")return!o;if(e==="__v_isReadonly")return o;if(e==="__v_isShallow")return s;if(e==="__v_raw"&&n===(o?s?shallowReadonlyMap:readonlyMap:s?shallowReactiveMap:reactiveMap).get(r))return r;const a=isArray$4(r);if(!o){if(a&&hasOwn(arrayInstrumentations,e))return Reflect.get(arrayInstrumentations,e,n);if(e==="hasOwnProperty")return hasOwnProperty$d}const i=Reflect.get(r,e,n);return(isSymbol$1(e)?builtInSymbols.has(e):isNonTrackableKeys(e))||(o||track(r,"get",e),s)?i:isRef(i)?a&&isIntegerKey(e)?i:i.value:isObject$2(i)?o?readonly(i):reactive(i):i}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(r=!1){super(!1,r)}set(r,e,n,o){let s=r[e];if(isReadonly(s)&&isRef(s)&&!isRef(n))return!1;if(!this._shallow&&(!isShallow(n)&&!isReadonly(n)&&(s=toRaw(s),n=toRaw(n)),!isArray$4(r)&&isRef(s)&&!isRef(n)))return s.value=n,!0;const a=isArray$4(r)&&isIntegerKey(e)?Number(e)<r.length:hasOwn(r,e),i=Reflect.set(r,e,n,o);return r===toRaw(o)&&(a?hasChanged(n,s)&&trigger(r,"set",e,n):trigger(r,"add",e,n)),i}deleteProperty(r,e){const n=hasOwn(r,e);r[e];const o=Reflect.deleteProperty(r,e);return o&&n&&trigger(r,"delete",e,void 0),o}has(r,e){const n=Reflect.has(r,e);return(!isSymbol$1(e)||!builtInSymbols.has(e))&&track(r,"has",e),n}ownKeys(r){return track(r,"iterate",isArray$4(r)?"length":ITERATE_KEY),Reflect.ownKeys(r)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(r=!1){super(!0,r)}set(r,e){return!0}deleteProperty(r,e){return!0}}const mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),toShallow=t=>t,getProto=t=>Reflect.getPrototypeOf(t);function get$1(t,r,e=!1,n=!1){t=t.__v_raw;const o=toRaw(t),s=toRaw(r);e||(hasChanged(r,s)&&track(o,"get",r),track(o,"get",s));const{has:a}=getProto(o),i=n?toShallow:e?toReadonly:toReactive;if(a.call(o,r))return i(t.get(r));if(a.call(o,s))return i(t.get(s));t!==o&&t.get(r)}function has(t,r=!1){const e=this.__v_raw,n=toRaw(e),o=toRaw(t);return r||(hasChanged(t,o)&&track(n,"has",t),track(n,"has",o)),t===o?e.has(t):e.has(t)||e.has(o)}function size(t,r=!1){return t=t.__v_raw,!r&&track(toRaw(t),"iterate",ITERATE_KEY),Reflect.get(t,"size",t)}function add(t){t=toRaw(t);const r=toRaw(this);return getProto(r).has.call(r,t)||(r.add(t),trigger(r,"add",t,t)),this}function set$1(t,r){r=toRaw(r);const e=toRaw(this),{has:n,get:o}=getProto(e);let s=n.call(e,t);s||(t=toRaw(t),s=n.call(e,t));const a=o.call(e,t);return e.set(t,r),s?hasChanged(r,a)&&trigger(e,"set",t,r):trigger(e,"add",t,r),this}function deleteEntry(t){const r=toRaw(this),{has:e,get:n}=getProto(r);let o=e.call(r,t);o||(t=toRaw(t),o=e.call(r,t)),n&&n.call(r,t);const s=r.delete(t);return o&&trigger(r,"delete",t,void 0),s}function clear(){const t=toRaw(this),r=t.size!==0,e=t.clear();return r&&trigger(t,"clear",void 0,void 0),e}function createForEach(t,r){return function(n,o){const s=this,a=s.__v_raw,i=toRaw(a),u=r?toShallow:t?toReadonly:toReactive;return!t&&track(i,"iterate",ITERATE_KEY),a.forEach((d,c)=>n.call(o,u(d),u(c),s))}}function createIterableMethod(t,r,e){return function(...n){const o=this.__v_raw,s=toRaw(o),a=isMap$2(s),i=t==="entries"||t===Symbol.iterator&&a,u=t==="keys"&&a,d=o[t](...n),c=e?toShallow:r?toReadonly:toReactive;return!r&&track(s,"iterate",u?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:m,done:v}=d.next();return v?{value:m,done:v}:{value:i?[c(m[0]),c(m[1])]:c(m),done:v}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(t){return function(...r){return t==="delete"?!1:this}}function createInstrumentations(){const t={get(s){return get$1(this,s)},get size(){return size(this)},has,add,set:set$1,delete:deleteEntry,clear,forEach:createForEach(!1,!1)},r={get(s){return get$1(this,s,!1,!0)},get size(){return size(this)},has,add,set:set$1,delete:deleteEntry,clear,forEach:createForEach(!1,!0)},e={get(s){return get$1(this,s,!0)},get size(){return size(this,!0)},has(s){return has.call(this,s,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!1)},n={get(s){return get$1(this,s,!0,!0)},get size(){return size(this,!0)},has(s){return has.call(this,s,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=createIterableMethod(s,!1,!1),e[s]=createIterableMethod(s,!0,!1),r[s]=createIterableMethod(s,!1,!0),n[s]=createIterableMethod(s,!0,!0)}),[t,e,r,n]}const[mutableInstrumentations,readonlyInstrumentations,shallowInstrumentations,shallowReadonlyInstrumentations]=createInstrumentations();function createInstrumentationGetter(t,r){const e=r?t?shallowReadonlyInstrumentations:shallowInstrumentations:t?readonlyInstrumentations:mutableInstrumentations;return(n,o,s)=>o==="__v_isReactive"?!t:o==="__v_isReadonly"?t:o==="__v_raw"?n:Reflect.get(hasOwn(e,o)&&o in n?e:n,o,s)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(t){return t.__v_skip||!Object.isExtensible(t)?0:targetTypeMap(toRawType(t))}function reactive(t){return isReadonly(t)?t:createReactiveObject(t,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(t){return createReactiveObject(t,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(t){return createReactiveObject(t,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function createReactiveObject(t,r,e,n,o){if(!isObject$2(t)||t.__v_raw&&!(r&&t.__v_isReactive))return t;const s=o.get(t);if(s)return s;const a=getTargetType(t);if(a===0)return t;const i=new Proxy(t,a===2?n:e);return o.set(t,i),i}function isReactive(t){return isReadonly(t)?isReactive(t.__v_raw):!!(t&&t.__v_isReactive)}function isReadonly(t){return!!(t&&t.__v_isReadonly)}function isShallow(t){return!!(t&&t.__v_isShallow)}function isProxy(t){return isReactive(t)||isReadonly(t)}function toRaw(t){const r=t&&t.__v_raw;return r?toRaw(r):t}function markRaw(t){return def(t,"__v_skip",!0),t}const toReactive=t=>isObject$2(t)?reactive(t):t,toReadonly=t=>isObject$2(t)?readonly(t):t;function trackRefValue(t){shouldTrack&&activeEffect&&(t=toRaw(t),trackEffects(t.dep||(t.dep=createDep())))}function triggerRefValue(t,r){t=toRaw(t);const e=t.dep;e&&triggerEffects(e)}function isRef(t){return!!(t&&t.__v_isRef===!0)}function ref(t){return createRef(t,!1)}function shallowRef(t){return createRef(t,!0)}function createRef(t,r){return isRef(t)?t:new RefImpl(t,r)}class RefImpl{constructor(r,e){this.__v_isShallow=e,this.dep=void 0,this.__v_isRef=!0,this._rawValue=e?r:toRaw(r),this._value=e?r:toReactive(r)}get value(){return trackRefValue(this),this._value}set value(r){const e=this.__v_isShallow||isShallow(r)||isReadonly(r);r=e?r:toRaw(r),hasChanged(r,this._rawValue)&&(this._rawValue=r,this._value=e?r:toReactive(r),triggerRefValue(this))}}function triggerRef(t){triggerRefValue(t)}function unref(t){return isRef(t)?t.value:t}const shallowUnwrapHandlers={get:(t,r,e)=>unref(Reflect.get(t,r,e)),set:(t,r,e,n)=>{const o=t[r];return isRef(o)&&!isRef(e)?(o.value=e,!0):Reflect.set(t,r,e,n)}};function proxyRefs(t){return isReactive(t)?t:new Proxy(t,shallowUnwrapHandlers)}function toRefs(t){const r=isArray$4(t)?new Array(t.length):{};for(const e in t)r[e]=propertyToRef(t,e);return r}class ObjectRefImpl{constructor(r,e,n){this._object=r,this._key=e,this._defaultValue=n,this.__v_isRef=!0}get value(){const r=this._object[this._key];return r===void 0?this._defaultValue:r}set value(r){this._object[this._key]=r}get dep(){return getDepFromReactive(toRaw(this._object),this._key)}}class GetterRefImpl{constructor(r){this._getter=r,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function toRef(t,r,e){return isRef(t)?t:isFunction$3(t)?new GetterRefImpl(t):isObject$2(t)&&arguments.length>1?propertyToRef(t,r,e):ref(t)}function propertyToRef(t,r,e){const n=t[r];return isRef(n)?n:new ObjectRefImpl(t,r,e)}class ComputedRefImpl{constructor(r,e,n,o){this._setter=e,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new ReactiveEffect(r,()=>{this._dirty||(this._dirty=!0,triggerRefValue(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!o,this.__v_isReadonly=n}get value(){const r=toRaw(this);return trackRefValue(r),(r._dirty||!r._cacheable)&&(r._dirty=!1,r._value=r.effect.run()),r._value}set value(r){this._setter(r)}}function computed$1(t,r,e=!1){let n,o;const s=isFunction$3(t);return s?(n=t,o=NOOP):(n=t.get,o=t.set),new ComputedRefImpl(n,o,s||!o,e)}function warn(t,...r){}function callWithErrorHandling(t,r,e,n){let o;try{o=n?t(...n):t()}catch(s){handleError(s,r,e)}return o}function callWithAsyncErrorHandling(t,r,e,n){if(isFunction$3(t)){const s=callWithErrorHandling(t,r,e,n);return s&&isPromise(s)&&s.catch(a=>{handleError(a,r,e)}),s}const o=[];for(let s=0;s<t.length;s++)o.push(callWithAsyncErrorHandling(t[s],r,e,n));return o}function handleError(t,r,e,n=!0){const o=r?r.vnode:null;if(r){let s=r.parent;const a=r.proxy,i=e;for(;s;){const d=s.ec;if(d){for(let c=0;c<d.length;c++)if(d[c](t,a,i)===!1)return}s=s.parent}const u=r.appContext.config.errorHandler;if(u){callWithErrorHandling(u,null,10,[t,a,i]);return}}logError(t,e,o,n)}function logError(t,r,e,n=!0){console.error(t)}let isFlushing=!1,isFlushPending=!1;const queue=[];let flushIndex=0;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(t){const r=currentFlushPromise||resolvedPromise;return t?r.then(this?t.bind(this):t):r}function findInsertionIndex(t){let r=flushIndex+1,e=queue.length;for(;r<e;){const n=r+e>>>1,o=queue[n],s=getId(o);s<t||s===t&&o.pre?r=n+1:e=n}return r}function queueJob(t){(!queue.length||!queue.includes(t,isFlushing&&t.allowRecurse?flushIndex+1:flushIndex))&&(t.id==null?queue.push(t):queue.splice(findInsertionIndex(t.id),0,t),queueFlush())}function queueFlush(){!isFlushing&&!isFlushPending&&(isFlushPending=!0,currentFlushPromise=resolvedPromise.then(flushJobs))}function invalidateJob(t){const r=queue.indexOf(t);r>flushIndex&&queue.splice(r,1)}function queuePostFlushCb(t){isArray$4(t)?pendingPostFlushCbs.push(...t):(!activePostFlushCbs||!activePostFlushCbs.includes(t,t.allowRecurse?postFlushIndex+1:postFlushIndex))&&pendingPostFlushCbs.push(t),queueFlush()}function flushPreFlushCbs(t,r=isFlushing?flushIndex+1:0){for(;r<queue.length;r++){const e=queue[r];e&&e.pre&&(queue.splice(r,1),r--,e())}}function flushPostFlushCbs(t){if(pendingPostFlushCbs.length){const r=[...new Set(pendingPostFlushCbs)];if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...r);return}for(activePostFlushCbs=r,activePostFlushCbs.sort((e,n)=>getId(e)-getId(n)),postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++)activePostFlushCbs[postFlushIndex]();activePostFlushCbs=null,postFlushIndex=0}}const getId=t=>t.id==null?1/0:t.id,comparator=(t,r)=>{const e=getId(t)-getId(r);if(e===0){if(t.pre&&!r.pre)return-1;if(r.pre&&!t.pre)return 1}return e};function flushJobs(t){isFlushPending=!1,isFlushing=!0,queue.sort(comparator);const r=NOOP;try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const e=queue[flushIndex];e&&e.active!==!1&&callWithErrorHandling(e,null,14)}}finally{flushIndex=0,queue.length=0,flushPostFlushCbs(),isFlushing=!1,currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}function emit(t,r,...e){if(t.isUnmounted)return;const n=t.vnode.props||EMPTY_OBJ;let o=e;const s=r.startsWith("update:"),a=s&&r.slice(7);if(a&&a in n){const c=`${a==="modelValue"?"model":a}Modifiers`,{number:m,trim:v}=n[c]||EMPTY_OBJ;v&&(o=e.map(g=>isString$2(g)?g.trim():g)),m&&(o=e.map(looseToNumber))}let i,u=n[i=toHandlerKey(r)]||n[i=toHandlerKey(camelize(r))];!u&&s&&(u=n[i=toHandlerKey(hyphenate(r))]),u&&callWithAsyncErrorHandling(u,t,6,o);const d=n[i+"Once"];if(d){if(!t.emitted)t.emitted={};else if(t.emitted[i])return;t.emitted[i]=!0,callWithAsyncErrorHandling(d,t,6,o)}}function normalizeEmitsOptions(t,r,e=!1){const n=r.emitsCache,o=n.get(t);if(o!==void 0)return o;const s=t.emits;let a={},i=!1;if(!isFunction$3(t)){const u=d=>{const c=normalizeEmitsOptions(d,r,!0);c&&(i=!0,extend$1(a,c))};!e&&r.mixins.length&&r.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}return!s&&!i?(isObject$2(t)&&n.set(t,null),null):(isArray$4(s)?s.forEach(u=>a[u]=null):extend$1(a,s),isObject$2(t)&&n.set(t,a),a)}function isEmitListener(t,r){return!t||!isOn(r)?!1:(r=r.slice(2).replace(/Once$/,""),hasOwn(t,r[0].toLowerCase()+r.slice(1))||hasOwn(t,hyphenate(r))||hasOwn(t,r))}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(t){const r=currentRenderingInstance;return currentRenderingInstance=t,currentScopeId=t&&t.type.__scopeId||null,r}function withCtx(t,r=currentRenderingInstance,e){if(!r||t._n)return t;const n=(...o)=>{n._d&&setBlockTracking(-1);const s=setCurrentRenderingInstance(r);let a;try{a=t(...o)}finally{setCurrentRenderingInstance(s),n._d&&setBlockTracking(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function markAttrsAccessed(){}function renderComponentRoot(t){const{type:r,vnode:e,proxy:n,withProxy:o,props:s,propsOptions:[a],slots:i,attrs:u,emit:d,render:c,renderCache:m,data:v,setupState:g,ctx:b,inheritAttrs:T}=t;let k,y;const O=setCurrentRenderingInstance(t);try{if(e.shapeFlag&4){const he=o||n;k=normalizeVNode(c.call(he,he,m,s,g,v,b)),y=u}else{const he=r;k=normalizeVNode(he.length>1?he(s,{attrs:u,slots:i,emit:d}):he(s,null)),y=r.props?u:getFunctionalFallthrough(u)}}catch(he){blockStack.length=0,handleError(he,t,1),k=createVNode(Comment)}let D=k;if(y&&T!==!1){const he=Object.keys(y),{shapeFlag:ae}=D;he.length&&ae&7&&(a&&he.some(isModelListener)&&(y=filterModelListeners(y,a)),D=cloneVNode(D,y))}return e.dirs&&(D=cloneVNode(D),D.dirs=D.dirs?D.dirs.concat(e.dirs):e.dirs),e.transition&&(D.transition=e.transition),k=D,setCurrentRenderingInstance(O),k}const getFunctionalFallthrough=t=>{let r;for(const e in t)(e==="class"||e==="style"||isOn(e))&&((r||(r={}))[e]=t[e]);return r},filterModelListeners=(t,r)=>{const e={};for(const n in t)(!isModelListener(n)||!(n.slice(9)in r))&&(e[n]=t[n]);return e};function shouldUpdateComponent(t,r,e){const{props:n,children:o,component:s}=t,{props:a,children:i,patchFlag:u}=r,d=s.emitsOptions;if(r.dirs||r.transition)return!0;if(e&&u>=0){if(u&1024)return!0;if(u&16)return n?hasPropsChanged(n,a,d):!!a;if(u&8){const c=r.dynamicProps;for(let m=0;m<c.length;m++){const v=c[m];if(a[v]!==n[v]&&!isEmitListener(d,v))return!0}}}else return(o||i)&&(!i||!i.$stable)?!0:n===a?!1:n?a?hasPropsChanged(n,a,d):!0:!!a;return!1}function hasPropsChanged(t,r,e){const n=Object.keys(r);if(n.length!==Object.keys(t).length)return!0;for(let o=0;o<n.length;o++){const s=n[o];if(r[s]!==t[s]&&!isEmitListener(e,s))return!0}return!1}function updateHOCHostEl({vnode:t,parent:r},e){for(;r&&r.subTree===t;)(t=r.vnode).el=e,r=r.parent}const isSuspense=t=>t.__isSuspense;function queueEffectWithSuspense(t,r){r&&r.pendingBranch?isArray$4(t)?r.effects.push(...t):r.effects.push(t):queuePostFlushCb(t)}function watchEffect(t,r){return doWatch(t,null,r)}const INITIAL_WATCHER_VALUE={};function watch(t,r,e){return doWatch(t,r,e)}function doWatch(t,r,{immediate:e,deep:n,flush:o,onTrack:s,onTrigger:a}=EMPTY_OBJ){var i;const u=getCurrentScope()===((i=currentInstance)==null?void 0:i.scope)?currentInstance:null;let d,c=!1,m=!1;if(isRef(t)?(d=()=>t.value,c=isShallow(t)):isReactive(t)?(d=()=>t,n=!0):isArray$4(t)?(m=!0,c=t.some(he=>isReactive(he)||isShallow(he)),d=()=>t.map(he=>{if(isRef(he))return he.value;if(isReactive(he))return traverse(he);if(isFunction$3(he))return callWithErrorHandling(he,u,2)})):isFunction$3(t)?r?d=()=>callWithErrorHandling(t,u,2):d=()=>{if(!(u&&u.isUnmounted))return v&&v(),callWithAsyncErrorHandling(t,u,3,[g])}:d=NOOP,r&&n){const he=d;d=()=>traverse(he())}let v,g=he=>{v=O.onStop=()=>{callWithErrorHandling(he,u,4)}},b;if(isInSSRComponentSetup)if(g=NOOP,r?e&&callWithAsyncErrorHandling(r,u,3,[d(),m?[]:void 0,g]):d(),o==="sync"){const he=useSSRContext();b=he.__watcherHandles||(he.__watcherHandles=[])}else return NOOP;let T=m?new Array(t.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const k=()=>{if(O.active)if(r){const he=O.run();(n||c||(m?he.some((ae,Ne)=>hasChanged(ae,T[Ne])):hasChanged(he,T)))&&(v&&v(),callWithAsyncErrorHandling(r,u,3,[he,T===INITIAL_WATCHER_VALUE?void 0:m&&T[0]===INITIAL_WATCHER_VALUE?[]:T,g]),T=he)}else O.run()};k.allowRecurse=!!r;let y;o==="sync"?y=k:o==="post"?y=()=>queuePostRenderEffect(k,u&&u.suspense):(k.pre=!0,u&&(k.id=u.uid),y=()=>queueJob(k));const O=new ReactiveEffect(d,y);r?e?k():T=O.run():o==="post"?queuePostRenderEffect(O.run.bind(O),u&&u.suspense):O.run();const D=()=>{O.stop(),u&&u.scope&&remove(u.scope.effects,O)};return b&&b.push(D),D}function instanceWatch(t,r,e){const n=this.proxy,o=isString$2(t)?t.includes(".")?createPathGetter(n,t):()=>n[t]:t.bind(n,n);let s;isFunction$3(r)?s=r:(s=r.handler,e=r);const a=currentInstance;setCurrentInstance(this);const i=doWatch(o,s.bind(n),e);return a?setCurrentInstance(a):unsetCurrentInstance(),i}function createPathGetter(t,r){const e=r.split(".");return()=>{let n=t;for(let o=0;o<e.length&&n;o++)n=n[e[o]];return n}}function traverse(t,r){if(!isObject$2(t)||t.__v_skip||(r=r||new Set,r.has(t)))return t;if(r.add(t),isRef(t))traverse(t.value,r);else if(isArray$4(t))for(let e=0;e<t.length;e++)traverse(t[e],r);else if(isSet$2(t)||isMap$2(t))t.forEach(e=>{traverse(e,r)});else if(isPlainObject$1(t))for(const e in t)traverse(t[e],r);return t}function withDirectives(t,r){const e=currentRenderingInstance;if(e===null)return t;const n=getExposeProxy(e)||e.proxy,o=t.dirs||(t.dirs=[]);for(let s=0;s<r.length;s++){let[a,i,u,d=EMPTY_OBJ]=r[s];a&&(isFunction$3(a)&&(a={mounted:a,updated:a}),a.deep&&traverse(i),o.push({dir:a,instance:n,value:i,oldValue:void 0,arg:u,modifiers:d}))}return t}function invokeDirectiveHook(t,r,e,n){const o=t.dirs,s=r&&r.dirs;for(let a=0;a<o.length;a++){const i=o[a];s&&(i.oldValue=s[a].value);let u=i.dir[n];u&&(pauseTracking(),callWithAsyncErrorHandling(u,e,8,[t.el,i,t,r]),resetTracking())}}const leaveCbKey=Symbol("_leaveCb"),enterCbKey$1=Symbol("_enterCb");function useTransitionState(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return onMounted(()=>{t.isMounted=!0}),onBeforeUnmount(()=>{t.isUnmounting=!0}),t}const TransitionHookValidator=[Function,Array],BaseTransitionPropsValidators={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:TransitionHookValidator,onEnter:TransitionHookValidator,onAfterEnter:TransitionHookValidator,onEnterCancelled:TransitionHookValidator,onBeforeLeave:TransitionHookValidator,onLeave:TransitionHookValidator,onAfterLeave:TransitionHookValidator,onLeaveCancelled:TransitionHookValidator,onBeforeAppear:TransitionHookValidator,onAppear:TransitionHookValidator,onAfterAppear:TransitionHookValidator,onAppearCancelled:TransitionHookValidator},BaseTransitionImpl={name:"BaseTransition",props:BaseTransitionPropsValidators,setup(t,{slots:r}){const e=getCurrentInstance(),n=useTransitionState();let o;return()=>{const s=r.default&&getTransitionRawChildren(r.default(),!0);if(!s||!s.length)return;let a=s[0];if(s.length>1){for(const T of s)if(T.type!==Comment){a=T;break}}const i=toRaw(t),{mode:u}=i;if(n.isLeaving)return emptyPlaceholder(a);const d=getKeepAliveChild(a);if(!d)return emptyPlaceholder(a);const c=resolveTransitionHooks(d,i,n,e);setTransitionHooks(d,c);const m=e.subTree,v=m&&getKeepAliveChild(m);let g=!1;const{getTransitionKey:b}=d.type;if(b){const T=b();o===void 0?o=T:T!==o&&(o=T,g=!0)}if(v&&v.type!==Comment&&(!isSameVNodeType(d,v)||g)){const T=resolveTransitionHooks(v,i,n,e);if(setTransitionHooks(v,T),u==="out-in")return n.isLeaving=!0,T.afterLeave=()=>{n.isLeaving=!1,e.update.active!==!1&&e.update()},emptyPlaceholder(a);u==="in-out"&&d.type!==Comment&&(T.delayLeave=(k,y,O)=>{const D=getLeavingNodesForType(n,v);D[String(v.key)]=v,k[leaveCbKey]=()=>{y(),k[leaveCbKey]=void 0,delete c.delayedLeave},c.delayedLeave=O})}return a}}},BaseTransition=BaseTransitionImpl;function getLeavingNodesForType(t,r){const{leavingVNodes:e}=t;let n=e.get(r.type);return n||(n=Object.create(null),e.set(r.type,n)),n}function resolveTransitionHooks(t,r,e,n){const{appear:o,mode:s,persisted:a=!1,onBeforeEnter:i,onEnter:u,onAfterEnter:d,onEnterCancelled:c,onBeforeLeave:m,onLeave:v,onAfterLeave:g,onLeaveCancelled:b,onBeforeAppear:T,onAppear:k,onAfterAppear:y,onAppearCancelled:O}=r,D=String(t.key),he=getLeavingNodesForType(e,t),ae=(Y,_e)=>{Y&&callWithAsyncErrorHandling(Y,n,9,_e)},Ne=(Y,_e)=>{const Ce=_e[1];ae(Y,_e),isArray$4(Y)?Y.every(ze=>ze.length<=1)&&Ce():Y.length<=1&&Ce()},ue={mode:s,persisted:a,beforeEnter(Y){let _e=i;if(!e.isMounted)if(o)_e=T||i;else return;Y[leaveCbKey]&&Y[leaveCbKey](!0);const Ce=he[D];Ce&&isSameVNodeType(t,Ce)&&Ce.el[leaveCbKey]&&Ce.el[leaveCbKey](),ae(_e,[Y])},enter(Y){let _e=u,Ce=d,ze=c;if(!e.isMounted)if(o)_e=k||u,Ce=y||d,ze=O||c;else return;let ie=!1;const le=Y[enterCbKey$1]=Ie=>{ie||(ie=!0,Ie?ae(ze,[Y]):ae(Ce,[Y]),ue.delayedLeave&&ue.delayedLeave(),Y[enterCbKey$1]=void 0)};_e?Ne(_e,[Y,le]):le()},leave(Y,_e){const Ce=String(t.key);if(Y[enterCbKey$1]&&Y[enterCbKey$1](!0),e.isUnmounting)return _e();ae(m,[Y]);let ze=!1;const ie=Y[leaveCbKey]=le=>{ze||(ze=!0,_e(),le?ae(b,[Y]):ae(g,[Y]),Y[leaveCbKey]=void 0,he[Ce]===t&&delete he[Ce])};he[Ce]=t,v?Ne(v,[Y,ie]):ie()},clone(Y){return resolveTransitionHooks(Y,r,e,n)}};return ue}function emptyPlaceholder(t){if(isKeepAlive(t))return t=cloneVNode(t),t.children=null,t}function getKeepAliveChild(t){return isKeepAlive(t)?t.children?t.children[0]:void 0:t}function setTransitionHooks(t,r){t.shapeFlag&6&&t.component?setTransitionHooks(t.component.subTree,r):t.shapeFlag&128?(t.ssContent.transition=r.clone(t.ssContent),t.ssFallback.transition=r.clone(t.ssFallback)):t.transition=r}function getTransitionRawChildren(t,r=!1,e){let n=[],o=0;for(let s=0;s<t.length;s++){let a=t[s];const i=e==null?a.key:String(e)+String(a.key!=null?a.key:s);a.type===Fragment?(a.patchFlag&128&&o++,n=n.concat(getTransitionRawChildren(a.children,r,i))):(r||a.type!==Comment)&&n.push(i!=null?cloneVNode(a,{key:i}):a)}if(o>1)for(let s=0;s<n.length;s++)n[s].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function defineComponent(t,r){return isFunction$3(t)?(()=>extend$1({name:t.name},r,{setup:t}))():t}const isAsyncWrapper=t=>!!t.type.__asyncLoader,isKeepAlive=t=>t.type.__isKeepAlive;function onActivated(t,r){registerKeepAliveHook(t,"a",r)}function onDeactivated(t,r){registerKeepAliveHook(t,"da",r)}function registerKeepAliveHook(t,r,e=currentInstance){const n=t.__wdc||(t.__wdc=()=>{let o=e;for(;o;){if(o.isDeactivated)return;o=o.parent}return t()});if(injectHook(r,n,e),e){let o=e.parent;for(;o&&o.parent;)isKeepAlive(o.parent.vnode)&&injectToKeepAliveRoot(n,r,e,o),o=o.parent}}function injectToKeepAliveRoot(t,r,e,n){const o=injectHook(r,t,n,!0);onUnmounted(()=>{remove(n[r],o)},e)}function injectHook(t,r,e=currentInstance,n=!1){if(e){const o=e[t]||(e[t]=[]),s=r.__weh||(r.__weh=(...a)=>{if(e.isUnmounted)return;pauseTracking(),setCurrentInstance(e);const i=callWithAsyncErrorHandling(r,e,t,a);return unsetCurrentInstance(),resetTracking(),i});return n?o.unshift(s):o.push(s),s}}const createHook=t=>(r,e=currentInstance)=>(!isInSSRComponentSetup||t==="sp")&&injectHook(t,(...n)=>r(...n),e),onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(t,r=currentInstance){injectHook("ec",t,r)}const COMPONENTS="components",DIRECTIVES="directives";function resolveComponent(t,r){return resolveAsset(COMPONENTS,t,!0,r)||t}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc");function resolveDynamicComponent(t){return isString$2(t)?resolveAsset(COMPONENTS,t,!1)||t:t||NULL_DYNAMIC_COMPONENT}function resolveDirective(t){return resolveAsset(DIRECTIVES,t)}function resolveAsset(t,r,e=!0,n=!1){const o=currentRenderingInstance||currentInstance;if(o){const s=o.type;if(t===COMPONENTS){const i=getComponentName(s,!1);if(i&&(i===r||i===camelize(r)||i===capitalize$1(camelize(r))))return s}const a=resolve(o[t]||s[t],r)||resolve(o.appContext[t],r);return!a&&n?s:a}}function resolve(t,r){return t&&(t[r]||t[camelize(r)]||t[capitalize$1(camelize(r))])}function renderList(t,r,e,n){let o;const s=e&&e[n];if(isArray$4(t)||isString$2(t)){o=new Array(t.length);for(let a=0,i=t.length;a<i;a++)o[a]=r(t[a],a,void 0,s&&s[a])}else if(typeof t=="number"){o=new Array(t);for(let a=0;a<t;a++)o[a]=r(a+1,a,void 0,s&&s[a])}else if(isObject$2(t))if(t[Symbol.iterator])o=Array.from(t,(a,i)=>r(a,i,void 0,s&&s[i]));else{const a=Object.keys(t);o=new Array(a.length);for(let i=0,u=a.length;i<u;i++){const d=a[i];o[i]=r(t[d],d,i,s&&s[i])}}else o=[];return e&&(e[n]=o),o}function createSlots(t,r){for(let e=0;e<r.length;e++){const n=r[e];if(isArray$4(n))for(let o=0;o<n.length;o++)t[n[o].name]=n[o].fn;else n&&(t[n.name]=n.key?(...o)=>{const s=n.fn(...o);return s&&(s.key=n.key),s}:n.fn)}return t}function renderSlot(t,r,e={},n,o){if(currentRenderingInstance.isCE||currentRenderingInstance.parent&&isAsyncWrapper(currentRenderingInstance.parent)&&currentRenderingInstance.parent.isCE)return r!=="default"&&(e.name=r),createVNode("slot",e,n&&n());let s=t[r];s&&s._c&&(s._d=!1),openBlock();const a=s&&ensureValidVNode(s(e)),i=createBlock(Fragment,{key:e.key||a&&a.key||`_${r}`},a||(n?n():[]),a&&t._===1?64:-2);return!o&&i.scopeId&&(i.slotScopeIds=[i.scopeId+"-s"]),s&&s._c&&(s._d=!0),i}function ensureValidVNode(t){return t.some(r=>isVNode(r)?!(r.type===Comment||r.type===Fragment&&!ensureValidVNode(r.children)):!0)?t:null}function toHandlers(t,r){const e={};for(const n in t)e[r&&/[A-Z]/.test(n)?`on:${n}`:toHandlerKey(n)]=t[n];return e}const getPublicInstance=t=>t?isStatefulComponent(t)?getExposeProxy(t)||t.proxy:getPublicInstance(t.parent):null,publicPropertiesMap=extend$1(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>getPublicInstance(t.parent),$root:t=>getPublicInstance(t.root),$emit:t=>t.emit,$options:t=>resolveMergedOptions(t),$forceUpdate:t=>t.f||(t.f=()=>queueJob(t.update)),$nextTick:t=>t.n||(t.n=nextTick.bind(t.proxy)),$watch:t=>instanceWatch.bind(t)}),hasSetupBinding=(t,r)=>t!==EMPTY_OBJ&&!t.__isScriptSetup&&hasOwn(t,r),PublicInstanceProxyHandlers={get({_:t},r){const{ctx:e,setupState:n,data:o,props:s,accessCache:a,type:i,appContext:u}=t;let d;if(r[0]!=="$"){const g=a[r];if(g!==void 0)switch(g){case 1:return n[r];case 2:return o[r];case 4:return e[r];case 3:return s[r]}else{if(hasSetupBinding(n,r))return a[r]=1,n[r];if(o!==EMPTY_OBJ&&hasOwn(o,r))return a[r]=2,o[r];if((d=t.propsOptions[0])&&hasOwn(d,r))return a[r]=3,s[r];if(e!==EMPTY_OBJ&&hasOwn(e,r))return a[r]=4,e[r];shouldCacheAccess&&(a[r]=0)}}const c=publicPropertiesMap[r];let m,v;if(c)return r==="$attrs"&&track(t,"get",r),c(t);if((m=i.__cssModules)&&(m=m[r]))return m;if(e!==EMPTY_OBJ&&hasOwn(e,r))return a[r]=4,e[r];if(v=u.config.globalProperties,hasOwn(v,r))return v[r]},set({_:t},r,e){const{data:n,setupState:o,ctx:s}=t;return hasSetupBinding(o,r)?(o[r]=e,!0):n!==EMPTY_OBJ&&hasOwn(n,r)?(n[r]=e,!0):hasOwn(t.props,r)||r[0]==="$"&&r.slice(1)in t?!1:(s[r]=e,!0)},has({_:{data:t,setupState:r,accessCache:e,ctx:n,appContext:o,propsOptions:s}},a){let i;return!!e[a]||t!==EMPTY_OBJ&&hasOwn(t,a)||hasSetupBinding(r,a)||(i=s[0])&&hasOwn(i,a)||hasOwn(n,a)||hasOwn(publicPropertiesMap,a)||hasOwn(o.config.globalProperties,a)},defineProperty(t,r,e){return e.get!=null?t._.accessCache[r]=0:hasOwn(e,"value")&&this.set(t,r,e.value,null),Reflect.defineProperty(t,r,e)}};function useSlots(){return getContext().slots}function useAttrs$1(){return getContext().attrs}function getContext(){const t=getCurrentInstance();return t.setupContext||(t.setupContext=createSetupContext(t))}function normalizePropsOrEmits(t){return isArray$4(t)?t.reduce((r,e)=>(r[e]=null,r),{}):t}let shouldCacheAccess=!0;function applyOptions(t){const r=resolveMergedOptions(t),e=t.proxy,n=t.ctx;shouldCacheAccess=!1,r.beforeCreate&&callHook$1(r.beforeCreate,t,"bc");const{data:o,computed:s,methods:a,watch:i,provide:u,inject:d,created:c,beforeMount:m,mounted:v,beforeUpdate:g,updated:b,activated:T,deactivated:k,beforeDestroy:y,beforeUnmount:O,destroyed:D,unmounted:he,render:ae,renderTracked:Ne,renderTriggered:ue,errorCaptured:Y,serverPrefetch:_e,expose:Ce,inheritAttrs:ze,components:ie,directives:le,filters:Ie}=r;if(d&&resolveInjections(d,n,null),a)for(const $e in a){const Lt=a[$e];isFunction$3(Lt)&&(n[$e]=Lt.bind(e))}if(o){const $e=o.call(e,e);isObject$2($e)&&(t.data=reactive($e))}if(shouldCacheAccess=!0,s)for(const $e in s){const Lt=s[$e],Dt=isFunction$3(Lt)?Lt.bind(e,e):isFunction$3(Lt.get)?Lt.get.bind(e,e):NOOP,dr=!isFunction$3(Lt)&&isFunction$3(Lt.set)?Lt.set.bind(e):NOOP,pr=computed({get:Dt,set:dr});Object.defineProperty(n,$e,{enumerable:!0,configurable:!0,get:()=>pr.value,set:sr=>pr.value=sr})}if(i)for(const $e in i)createWatcher(i[$e],n,e,$e);if(u){const $e=isFunction$3(u)?u.call(e):u;Reflect.ownKeys($e).forEach(Lt=>{provide(Lt,$e[Lt])})}c&&callHook$1(c,t,"c");function qe($e,Lt){isArray$4(Lt)?Lt.forEach(Dt=>$e(Dt.bind(e))):Lt&&$e(Lt.bind(e))}if(qe(onBeforeMount,m),qe(onMounted,v),qe(onBeforeUpdate,g),qe(onUpdated,b),qe(onActivated,T),qe(onDeactivated,k),qe(onErrorCaptured,Y),qe(onRenderTracked,Ne),qe(onRenderTriggered,ue),qe(onBeforeUnmount,O),qe(onUnmounted,he),qe(onServerPrefetch,_e),isArray$4(Ce))if(Ce.length){const $e=t.exposed||(t.exposed={});Ce.forEach(Lt=>{Object.defineProperty($e,Lt,{get:()=>e[Lt],set:Dt=>e[Lt]=Dt})})}else t.exposed||(t.exposed={});ae&&t.render===NOOP&&(t.render=ae),ze!=null&&(t.inheritAttrs=ze),ie&&(t.components=ie),le&&(t.directives=le)}function resolveInjections(t,r,e=NOOP){isArray$4(t)&&(t=normalizeInject(t));for(const n in t){const o=t[n];let s;isObject$2(o)?"default"in o?s=inject(o.from||n,o.default,!0):s=inject(o.from||n):s=inject(o),isRef(s)?Object.defineProperty(r,n,{enumerable:!0,configurable:!0,get:()=>s.value,set:a=>s.value=a}):r[n]=s}}function callHook$1(t,r,e){callWithAsyncErrorHandling(isArray$4(t)?t.map(n=>n.bind(r.proxy)):t.bind(r.proxy),r,e)}function createWatcher(t,r,e,n){const o=n.includes(".")?createPathGetter(e,n):()=>e[n];if(isString$2(t)){const s=r[t];isFunction$3(s)&&watch(o,s)}else if(isFunction$3(t))watch(o,t.bind(e));else if(isObject$2(t))if(isArray$4(t))t.forEach(s=>createWatcher(s,r,e,n));else{const s=isFunction$3(t.handler)?t.handler.bind(e):r[t.handler];isFunction$3(s)&&watch(o,s,t)}}function resolveMergedOptions(t){const r=t.type,{mixins:e,extends:n}=r,{mixins:o,optionsCache:s,config:{optionMergeStrategies:a}}=t.appContext,i=s.get(r);let u;return i?u=i:!o.length&&!e&&!n?u=r:(u={},o.length&&o.forEach(d=>mergeOptions$1(u,d,a,!0)),mergeOptions$1(u,r,a)),isObject$2(r)&&s.set(r,u),u}function mergeOptions$1(t,r,e,n=!1){const{mixins:o,extends:s}=r;s&&mergeOptions$1(t,s,e,!0),o&&o.forEach(a=>mergeOptions$1(t,a,e,!0));for(const a in r)if(!(n&&a==="expose")){const i=internalOptionMergeStrats[a]||e&&e[a];t[a]=i?i(t[a],r[a]):r[a]}return t}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(t,r){return r?t?function(){return extend$1(isFunction$3(t)?t.call(this,this):t,isFunction$3(r)?r.call(this,this):r)}:r:t}function mergeInject(t,r){return mergeObjectOptions(normalizeInject(t),normalizeInject(r))}function normalizeInject(t){if(isArray$4(t)){const r={};for(let e=0;e<t.length;e++)r[t[e]]=t[e];return r}return t}function mergeAsArray(t,r){return t?[...new Set([].concat(t,r))]:r}function mergeObjectOptions(t,r){return t?extend$1(Object.create(null),t,r):r}function mergeEmitsOrPropsOptions(t,r){return t?isArray$4(t)&&isArray$4(r)?[...new Set([...t,...r])]:extend$1(Object.create(null),normalizePropsOrEmits(t),normalizePropsOrEmits(r??{})):r}function mergeWatchOptions(t,r){if(!t)return r;if(!r)return t;const e=extend$1(Object.create(null),t);for(const n in r)e[n]=mergeAsArray(t[n],r[n]);return e}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(t,r){return function(n,o=null){isFunction$3(n)||(n=extend$1({},n)),o!=null&&!isObject$2(o)&&(o=null);const s=createAppContext(),a=new WeakSet;let i=!1;const u=s.app={_uid:uid$1++,_component:n,_props:o,_container:null,_context:s,_instance:null,version,get config(){return s.config},set config(d){},use(d,...c){return a.has(d)||(d&&isFunction$3(d.install)?(a.add(d),d.install(u,...c)):isFunction$3(d)&&(a.add(d),d(u,...c))),u},mixin(d){return s.mixins.includes(d)||s.mixins.push(d),u},component(d,c){return c?(s.components[d]=c,u):s.components[d]},directive(d,c){return c?(s.directives[d]=c,u):s.directives[d]},mount(d,c,m){if(!i){const v=createVNode(n,o);return v.appContext=s,c&&r?r(v,d):t(v,d,m),i=!0,u._container=d,d.__vue_app__=u,getExposeProxy(v.component)||v.component.proxy}},unmount(){i&&(t(null,u._container),delete u._container.__vue_app__)},provide(d,c){return s.provides[d]=c,u},runWithContext(d){currentApp=u;try{return d()}finally{currentApp=null}}};return u}}let currentApp=null;function provide(t,r){if(currentInstance){let e=currentInstance.provides;const n=currentInstance.parent&&currentInstance.parent.provides;n===e&&(e=currentInstance.provides=Object.create(n)),e[t]=r}}function inject(t,r,e=!1){const n=currentInstance||currentRenderingInstance;if(n||currentApp){const o=n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:currentApp._context.provides;if(o&&t in o)return o[t];if(arguments.length>1)return e&&isFunction$3(r)?r.call(n&&n.proxy):r}}function initProps(t,r,e,n=!1){const o={},s={};def(s,InternalObjectKey,1),t.propsDefaults=Object.create(null),setFullProps(t,r,o,s);for(const a in t.propsOptions[0])a in o||(o[a]=void 0);e?t.props=n?o:shallowReactive(o):t.type.props?t.props=o:t.props=s,t.attrs=s}function updateProps(t,r,e,n){const{props:o,attrs:s,vnode:{patchFlag:a}}=t,i=toRaw(o),[u]=t.propsOptions;let d=!1;if((n||a>0)&&!(a&16)){if(a&8){const c=t.vnode.dynamicProps;for(let m=0;m<c.length;m++){let v=c[m];if(isEmitListener(t.emitsOptions,v))continue;const g=r[v];if(u)if(hasOwn(s,v))g!==s[v]&&(s[v]=g,d=!0);else{const b=camelize(v);o[b]=resolvePropValue(u,i,b,g,t,!1)}else g!==s[v]&&(s[v]=g,d=!0)}}}else{setFullProps(t,r,o,s)&&(d=!0);let c;for(const m in i)(!r||!hasOwn(r,m)&&((c=hyphenate(m))===m||!hasOwn(r,c)))&&(u?e&&(e[m]!==void 0||e[c]!==void 0)&&(o[m]=resolvePropValue(u,i,m,void 0,t,!0)):delete o[m]);if(s!==i)for(const m in s)(!r||!hasOwn(r,m))&&(delete s[m],d=!0)}d&&trigger(t,"set","$attrs")}function setFullProps(t,r,e,n){const[o,s]=t.propsOptions;let a=!1,i;if(r)for(let u in r){if(isReservedProp(u))continue;const d=r[u];let c;o&&hasOwn(o,c=camelize(u))?!s||!s.includes(c)?e[c]=d:(i||(i={}))[c]=d:isEmitListener(t.emitsOptions,u)||(!(u in n)||d!==n[u])&&(n[u]=d,a=!0)}if(s){const u=toRaw(e),d=i||EMPTY_OBJ;for(let c=0;c<s.length;c++){const m=s[c];e[m]=resolvePropValue(o,u,m,d[m],t,!hasOwn(d,m))}}return a}function resolvePropValue(t,r,e,n,o,s){const a=t[e];if(a!=null){const i=hasOwn(a,"default");if(i&&n===void 0){const u=a.default;if(a.type!==Function&&!a.skipFactory&&isFunction$3(u)){const{propsDefaults:d}=o;e in d?n=d[e]:(setCurrentInstance(o),n=d[e]=u.call(null,r),unsetCurrentInstance())}else n=u}a[0]&&(s&&!i?n=!1:a[1]&&(n===""||n===hyphenate(e))&&(n=!0))}return n}function normalizePropsOptions(t,r,e=!1){const n=r.propsCache,o=n.get(t);if(o)return o;const s=t.props,a={},i=[];let u=!1;if(!isFunction$3(t)){const c=m=>{u=!0;const[v,g]=normalizePropsOptions(m,r,!0);extend$1(a,v),g&&i.push(...g)};!e&&r.mixins.length&&r.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}if(!s&&!u)return isObject$2(t)&&n.set(t,EMPTY_ARR),EMPTY_ARR;if(isArray$4(s))for(let c=0;c<s.length;c++){const m=camelize(s[c]);validatePropName(m)&&(a[m]=EMPTY_OBJ)}else if(s)for(const c in s){const m=camelize(c);if(validatePropName(m)){const v=s[c],g=a[m]=isArray$4(v)||isFunction$3(v)?{type:v}:extend$1({},v);if(g){const b=getTypeIndex(Boolean,g.type),T=getTypeIndex(String,g.type);g[0]=b>-1,g[1]=T<0||b<T,(b>-1||hasOwn(g,"default"))&&i.push(m)}}}const d=[a,i];return isObject$2(t)&&n.set(t,d),d}function validatePropName(t){return t[0]!=="$"}function getType(t){const r=t&&t.toString().match(/^\s*(function|class) (\w+)/);return r?r[2]:t===null?"null":""}function isSameType(t,r){return getType(t)===getType(r)}function getTypeIndex(t,r){return isArray$4(r)?r.findIndex(e=>isSameType(e,t)):isFunction$3(r)&&isSameType(r,t)?0:-1}const isInternalKey=t=>t[0]==="_"||t==="$stable",normalizeSlotValue=t=>isArray$4(t)?t.map(normalizeVNode):[normalizeVNode(t)],normalizeSlot$1=(t,r,e)=>{if(r._n)return r;const n=withCtx((...o)=>normalizeSlotValue(r(...o)),e);return n._c=!1,n},normalizeObjectSlots=(t,r,e)=>{const n=t._ctx;for(const o in t){if(isInternalKey(o))continue;const s=t[o];if(isFunction$3(s))r[o]=normalizeSlot$1(o,s,n);else if(s!=null){const a=normalizeSlotValue(s);r[o]=()=>a}}},normalizeVNodeSlots=(t,r)=>{const e=normalizeSlotValue(r);t.slots.default=()=>e},initSlots=(t,r)=>{if(t.vnode.shapeFlag&32){const e=r._;e?(t.slots=toRaw(r),def(r,"_",e)):normalizeObjectSlots(r,t.slots={})}else t.slots={},r&&normalizeVNodeSlots(t,r);def(t.slots,InternalObjectKey,1)},updateSlots=(t,r,e)=>{const{vnode:n,slots:o}=t;let s=!0,a=EMPTY_OBJ;if(n.shapeFlag&32){const i=r._;i?e&&i===1?s=!1:(extend$1(o,r),!e&&i===1&&delete o._):(s=!r.$stable,normalizeObjectSlots(r,o)),a=r}else r&&(normalizeVNodeSlots(t,r),a={default:1});if(s)for(const i in o)!isInternalKey(i)&&a[i]==null&&delete o[i]};function setRef(t,r,e,n,o=!1){if(isArray$4(t)){t.forEach((v,g)=>setRef(v,r&&(isArray$4(r)?r[g]:r),e,n,o));return}if(isAsyncWrapper(n)&&!o)return;const s=n.shapeFlag&4?getExposeProxy(n.component)||n.component.proxy:n.el,a=o?null:s,{i,r:u}=t,d=r&&r.r,c=i.refs===EMPTY_OBJ?i.refs={}:i.refs,m=i.setupState;if(d!=null&&d!==u&&(isString$2(d)?(c[d]=null,hasOwn(m,d)&&(m[d]=null)):isRef(d)&&(d.value=null)),isFunction$3(u))callWithErrorHandling(u,i,12,[a,c]);else{const v=isString$2(u),g=isRef(u);if(v||g){const b=()=>{if(t.f){const T=v?hasOwn(m,u)?m[u]:c[u]:u.value;o?isArray$4(T)&&remove(T,s):isArray$4(T)?T.includes(s)||T.push(s):v?(c[u]=[s],hasOwn(m,u)&&(m[u]=c[u])):(u.value=[s],t.k&&(c[t.k]=u.value))}else v?(c[u]=a,hasOwn(m,u)&&(m[u]=a)):g&&(u.value=a,t.k&&(c[t.k]=a))};a?(b.id=-1,queuePostRenderEffect(b,e)):b()}}}const queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(t){return baseCreateRenderer(t)}function baseCreateRenderer(t,r){const e=getGlobalThis();e.__VUE__=!0;const{insert:n,remove:o,patchProp:s,createElement:a,createText:i,createComment:u,setText:d,setElementText:c,parentNode:m,nextSibling:v,setScopeId:g=NOOP,insertStaticContent:b}=t,T=(kt,er,cr,mr=null,vr=null,Tr=null,Ir=!1,kr=null,Ar=!!er.dynamicChildren)=>{if(kt===er)return;kt&&!isSameVNodeType(kt,er)&&(mr=Ue(kt),sr(kt,vr,Tr,!0),kt=null),er.patchFlag===-2&&(Ar=!1,er.dynamicChildren=null);const{type:Rr,ref:Cn,shapeFlag:Or}=er;switch(Rr){case Text:k(kt,er,cr,mr);break;case Comment:y(kt,er,cr,mr);break;case Static:kt==null&&O(er,cr,mr,Ir);break;case Fragment:ie(kt,er,cr,mr,vr,Tr,Ir,kr,Ar);break;default:Or&1?ae(kt,er,cr,mr,vr,Tr,Ir,kr,Ar):Or&6?le(kt,er,cr,mr,vr,Tr,Ir,kr,Ar):(Or&64||Or&128)&&Rr.process(kt,er,cr,mr,vr,Tr,Ir,kr,Ar,or)}Cn!=null&&vr&&setRef(Cn,kt&&kt.ref,Tr,er||kt,!er)},k=(kt,er,cr,mr)=>{if(kt==null)n(er.el=i(er.children),cr,mr);else{const vr=er.el=kt.el;er.children!==kt.children&&d(vr,er.children)}},y=(kt,er,cr,mr)=>{kt==null?n(er.el=u(er.children||""),cr,mr):er.el=kt.el},O=(kt,er,cr,mr)=>{[kt.el,kt.anchor]=b(kt.children,er,cr,mr,kt.el,kt.anchor)},D=({el:kt,anchor:er},cr,mr)=>{let vr;for(;kt&&kt!==er;)vr=v(kt),n(kt,cr,mr),kt=vr;n(er,cr,mr)},he=({el:kt,anchor:er})=>{let cr;for(;kt&&kt!==er;)cr=v(kt),o(kt),kt=cr;o(er)},ae=(kt,er,cr,mr,vr,Tr,Ir,kr,Ar)=>{Ir=Ir||er.type==="svg",kt==null?Ne(er,cr,mr,vr,Tr,Ir,kr,Ar):_e(kt,er,vr,Tr,Ir,kr,Ar)},Ne=(kt,er,cr,mr,vr,Tr,Ir,kr)=>{let Ar,Rr;const{type:Cn,props:Or,shapeFlag:Pr,transition:Nr,dirs:Qr}=kt;if(Ar=kt.el=a(kt.type,Tr,Or&&Or.is,Or),Pr&8?c(Ar,kt.children):Pr&16&&Y(kt.children,Ar,null,mr,vr,Tr&&Cn!=="foreignObject",Ir,kr),Qr&&invokeDirectiveHook(kt,null,mr,"created"),ue(Ar,kt,kt.scopeId,Ir,mr),Or){for(const Ur in Or)Ur!=="value"&&!isReservedProp(Ur)&&s(Ar,Ur,null,Or[Ur],Tr,kt.children,mr,vr,ir);"value"in Or&&s(Ar,"value",null,Or.value),(Rr=Or.onVnodeBeforeMount)&&invokeVNodeHook(Rr,mr,kt)}Qr&&invokeDirectiveHook(kt,null,mr,"beforeMount");const hn=needTransition(vr,Nr);hn&&Nr.beforeEnter(Ar),n(Ar,er,cr),((Rr=Or&&Or.onVnodeMounted)||hn||Qr)&&queuePostRenderEffect(()=>{Rr&&invokeVNodeHook(Rr,mr,kt),hn&&Nr.enter(Ar),Qr&&invokeDirectiveHook(kt,null,mr,"mounted")},vr)},ue=(kt,er,cr,mr,vr)=>{if(cr&&g(kt,cr),mr)for(let Tr=0;Tr<mr.length;Tr++)g(kt,mr[Tr]);if(vr){let Tr=vr.subTree;if(er===Tr){const Ir=vr.vnode;ue(kt,Ir,Ir.scopeId,Ir.slotScopeIds,vr.parent)}}},Y=(kt,er,cr,mr,vr,Tr,Ir,kr,Ar=0)=>{for(let Rr=Ar;Rr<kt.length;Rr++){const Cn=kt[Rr]=kr?cloneIfMounted(kt[Rr]):normalizeVNode(kt[Rr]);T(null,Cn,er,cr,mr,vr,Tr,Ir,kr)}},_e=(kt,er,cr,mr,vr,Tr,Ir)=>{const kr=er.el=kt.el;let{patchFlag:Ar,dynamicChildren:Rr,dirs:Cn}=er;Ar|=kt.patchFlag&16;const Or=kt.props||EMPTY_OBJ,Pr=er.props||EMPTY_OBJ;let Nr;cr&&toggleRecurse(cr,!1),(Nr=Pr.onVnodeBeforeUpdate)&&invokeVNodeHook(Nr,cr,er,kt),Cn&&invokeDirectiveHook(er,kt,cr,"beforeUpdate"),cr&&toggleRecurse(cr,!0);const Qr=vr&&er.type!=="foreignObject";if(Rr?Ce(kt.dynamicChildren,Rr,kr,cr,mr,Qr,Tr):Ir||Lt(kt,er,kr,null,cr,mr,Qr,Tr,!1),Ar>0){if(Ar&16)ze(kr,er,Or,Pr,cr,mr,vr);else if(Ar&2&&Or.class!==Pr.class&&s(kr,"class",null,Pr.class,vr),Ar&4&&s(kr,"style",Or.style,Pr.style,vr),Ar&8){const hn=er.dynamicProps;for(let Ur=0;Ur<hn.length;Ur++){const qr=hn[Ur],Gn=Or[qr],$n=Pr[qr];($n!==Gn||qr==="value")&&s(kr,qr,Gn,$n,vr,kt.children,cr,mr,ir)}}Ar&1&&kt.children!==er.children&&c(kr,er.children)}else!Ir&&Rr==null&&ze(kr,er,Or,Pr,cr,mr,vr);((Nr=Pr.onVnodeUpdated)||Cn)&&queuePostRenderEffect(()=>{Nr&&invokeVNodeHook(Nr,cr,er,kt),Cn&&invokeDirectiveHook(er,kt,cr,"updated")},mr)},Ce=(kt,er,cr,mr,vr,Tr,Ir)=>{for(let kr=0;kr<er.length;kr++){const Ar=kt[kr],Rr=er[kr],Cn=Ar.el&&(Ar.type===Fragment||!isSameVNodeType(Ar,Rr)||Ar.shapeFlag&70)?m(Ar.el):cr;T(Ar,Rr,Cn,null,mr,vr,Tr,Ir,!0)}},ze=(kt,er,cr,mr,vr,Tr,Ir)=>{if(cr!==mr){if(cr!==EMPTY_OBJ)for(const kr in cr)!isReservedProp(kr)&&!(kr in mr)&&s(kt,kr,cr[kr],null,Ir,er.children,vr,Tr,ir);for(const kr in mr){if(isReservedProp(kr))continue;const Ar=mr[kr],Rr=cr[kr];Ar!==Rr&&kr!=="value"&&s(kt,kr,Rr,Ar,Ir,er.children,vr,Tr,ir)}"value"in mr&&s(kt,"value",cr.value,mr.value)}},ie=(kt,er,cr,mr,vr,Tr,Ir,kr,Ar)=>{const Rr=er.el=kt?kt.el:i(""),Cn=er.anchor=kt?kt.anchor:i("");let{patchFlag:Or,dynamicChildren:Pr,slotScopeIds:Nr}=er;Nr&&(kr=kr?kr.concat(Nr):Nr),kt==null?(n(Rr,cr,mr),n(Cn,cr,mr),Y(er.children,cr,Cn,vr,Tr,Ir,kr,Ar)):Or>0&&Or&64&&Pr&&kt.dynamicChildren?(Ce(kt.dynamicChildren,Pr,cr,vr,Tr,Ir,kr),(er.key!=null||vr&&er===vr.subTree)&&traverseStaticChildren(kt,er,!0)):Lt(kt,er,cr,Cn,vr,Tr,Ir,kr,Ar)},le=(kt,er,cr,mr,vr,Tr,Ir,kr,Ar)=>{er.slotScopeIds=kr,kt==null?er.shapeFlag&512?vr.ctx.activate(er,cr,mr,Ir,Ar):Ie(er,cr,mr,vr,Tr,Ir,Ar):pe(kt,er,Ar)},Ie=(kt,er,cr,mr,vr,Tr,Ir)=>{const kr=kt.component=createComponentInstance(kt,mr,vr);if(isKeepAlive(kt)&&(kr.ctx.renderer=or),setupComponent(kr),kr.asyncDep){if(vr&&vr.registerDep(kr,qe),!kt.el){const Ar=kr.subTree=createVNode(Comment);y(null,Ar,er,cr)}return}qe(kr,kt,er,cr,vr,Tr,Ir)},pe=(kt,er,cr)=>{const mr=er.component=kt.component;if(shouldUpdateComponent(kt,er,cr))if(mr.asyncDep&&!mr.asyncResolved){$e(mr,er,cr);return}else mr.next=er,invalidateJob(mr.update),mr.update();else er.el=kt.el,mr.vnode=er},qe=(kt,er,cr,mr,vr,Tr,Ir)=>{const kr=()=>{if(kt.isMounted){let{next:Cn,bu:Or,u:Pr,parent:Nr,vnode:Qr}=kt,hn=Cn,Ur;toggleRecurse(kt,!1),Cn?(Cn.el=Qr.el,$e(kt,Cn,Ir)):Cn=Qr,Or&&invokeArrayFns(Or),(Ur=Cn.props&&Cn.props.onVnodeBeforeUpdate)&&invokeVNodeHook(Ur,Nr,Cn,Qr),toggleRecurse(kt,!0);const qr=renderComponentRoot(kt),Gn=kt.subTree;kt.subTree=qr,T(Gn,qr,m(Gn.el),Ue(Gn),kt,vr,Tr),Cn.el=qr.el,hn===null&&updateHOCHostEl(kt,qr.el),Pr&&queuePostRenderEffect(Pr,vr),(Ur=Cn.props&&Cn.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(Ur,Nr,Cn,Qr),vr)}else{let Cn;const{el:Or,props:Pr}=er,{bm:Nr,m:Qr,parent:hn}=kt,Ur=isAsyncWrapper(er);if(toggleRecurse(kt,!1),Nr&&invokeArrayFns(Nr),!Ur&&(Cn=Pr&&Pr.onVnodeBeforeMount)&&invokeVNodeHook(Cn,hn,er),toggleRecurse(kt,!0),Or&&Et){const qr=()=>{kt.subTree=renderComponentRoot(kt),Et(Or,kt.subTree,kt,vr,null)};Ur?er.type.__asyncLoader().then(()=>!kt.isUnmounted&&qr()):qr()}else{const qr=kt.subTree=renderComponentRoot(kt);T(null,qr,cr,mr,kt,vr,Tr),er.el=qr.el}if(Qr&&queuePostRenderEffect(Qr,vr),!Ur&&(Cn=Pr&&Pr.onVnodeMounted)){const qr=er;queuePostRenderEffect(()=>invokeVNodeHook(Cn,hn,qr),vr)}(er.shapeFlag&256||hn&&isAsyncWrapper(hn.vnode)&&hn.vnode.shapeFlag&256)&&kt.a&&queuePostRenderEffect(kt.a,vr),kt.isMounted=!0,er=cr=mr=null}},Ar=kt.effect=new ReactiveEffect(kr,()=>queueJob(Rr),kt.scope),Rr=kt.update=()=>Ar.run();Rr.id=kt.uid,toggleRecurse(kt,!0),Rr()},$e=(kt,er,cr)=>{er.component=kt;const mr=kt.vnode.props;kt.vnode=er,kt.next=null,updateProps(kt,er.props,mr,cr),updateSlots(kt,er.children,cr),pauseTracking(),flushPreFlushCbs(),resetTracking()},Lt=(kt,er,cr,mr,vr,Tr,Ir,kr,Ar=!1)=>{const Rr=kt&&kt.children,Cn=kt?kt.shapeFlag:0,Or=er.children,{patchFlag:Pr,shapeFlag:Nr}=er;if(Pr>0){if(Pr&128){dr(Rr,Or,cr,mr,vr,Tr,Ir,kr,Ar);return}else if(Pr&256){Dt(Rr,Or,cr,mr,vr,Tr,Ir,kr,Ar);return}}Nr&8?(Cn&16&&ir(Rr,vr,Tr),Or!==Rr&&c(cr,Or)):Cn&16?Nr&16?dr(Rr,Or,cr,mr,vr,Tr,Ir,kr,Ar):ir(Rr,vr,Tr,!0):(Cn&8&&c(cr,""),Nr&16&&Y(Or,cr,mr,vr,Tr,Ir,kr,Ar))},Dt=(kt,er,cr,mr,vr,Tr,Ir,kr,Ar)=>{kt=kt||EMPTY_ARR,er=er||EMPTY_ARR;const Rr=kt.length,Cn=er.length,Or=Math.min(Rr,Cn);let Pr;for(Pr=0;Pr<Or;Pr++){const Nr=er[Pr]=Ar?cloneIfMounted(er[Pr]):normalizeVNode(er[Pr]);T(kt[Pr],Nr,cr,null,vr,Tr,Ir,kr,Ar)}Rr>Cn?ir(kt,vr,Tr,!0,!1,Or):Y(er,cr,mr,vr,Tr,Ir,kr,Ar,Or)},dr=(kt,er,cr,mr,vr,Tr,Ir,kr,Ar)=>{let Rr=0;const Cn=er.length;let Or=kt.length-1,Pr=Cn-1;for(;Rr<=Or&&Rr<=Pr;){const Nr=kt[Rr],Qr=er[Rr]=Ar?cloneIfMounted(er[Rr]):normalizeVNode(er[Rr]);if(isSameVNodeType(Nr,Qr))T(Nr,Qr,cr,null,vr,Tr,Ir,kr,Ar);else break;Rr++}for(;Rr<=Or&&Rr<=Pr;){const Nr=kt[Or],Qr=er[Pr]=Ar?cloneIfMounted(er[Pr]):normalizeVNode(er[Pr]);if(isSameVNodeType(Nr,Qr))T(Nr,Qr,cr,null,vr,Tr,Ir,kr,Ar);else break;Or--,Pr--}if(Rr>Or){if(Rr<=Pr){const Nr=Pr+1,Qr=Nr<Cn?er[Nr].el:mr;for(;Rr<=Pr;)T(null,er[Rr]=Ar?cloneIfMounted(er[Rr]):normalizeVNode(er[Rr]),cr,Qr,vr,Tr,Ir,kr,Ar),Rr++}}else if(Rr>Pr)for(;Rr<=Or;)sr(kt[Rr],vr,Tr,!0),Rr++;else{const Nr=Rr,Qr=Rr,hn=new Map;for(Rr=Qr;Rr<=Pr;Rr++){const vo=er[Rr]=Ar?cloneIfMounted(er[Rr]):normalizeVNode(er[Rr]);vo.key!=null&&hn.set(vo.key,Rr)}let Ur,qr=0;const Gn=Pr-Qr+1;let $n=!1,Jr=0;const Lr=new Array(Gn);for(Rr=0;Rr<Gn;Rr++)Lr[Rr]=0;for(Rr=Nr;Rr<=Or;Rr++){const vo=kt[Rr];if(qr>=Gn){sr(vo,vr,Tr,!0);continue}let bo;if(vo.key!=null)bo=hn.get(vo.key);else for(Ur=Qr;Ur<=Pr;Ur++)if(Lr[Ur-Qr]===0&&isSameVNodeType(vo,er[Ur])){bo=Ur;break}bo===void 0?sr(vo,vr,Tr,!0):(Lr[bo-Qr]=Rr+1,bo>=Jr?Jr=bo:$n=!0,T(vo,er[bo],cr,null,vr,Tr,Ir,kr,Ar),qr++)}const Kn=$n?getSequence(Lr):EMPTY_ARR;for(Ur=Kn.length-1,Rr=Gn-1;Rr>=0;Rr--){const vo=Qr+Rr,bo=er[vo],so=vo+1<Cn?er[vo+1].el:mr;Lr[Rr]===0?T(null,bo,cr,so,vr,Tr,Ir,kr,Ar):$n&&(Ur<0||Rr!==Kn[Ur]?pr(bo,cr,so,2):Ur--)}}},pr=(kt,er,cr,mr,vr=null)=>{const{el:Tr,type:Ir,transition:kr,children:Ar,shapeFlag:Rr}=kt;if(Rr&6){pr(kt.component.subTree,er,cr,mr);return}if(Rr&128){kt.suspense.move(er,cr,mr);return}if(Rr&64){Ir.move(kt,er,cr,or);return}if(Ir===Fragment){n(Tr,er,cr);for(let Or=0;Or<Ar.length;Or++)pr(Ar[Or],er,cr,mr);n(kt.anchor,er,cr);return}if(Ir===Static){D(kt,er,cr);return}if(mr!==2&&Rr&1&&kr)if(mr===0)kr.beforeEnter(Tr),n(Tr,er,cr),queuePostRenderEffect(()=>kr.enter(Tr),vr);else{const{leave:Or,delayLeave:Pr,afterLeave:Nr}=kr,Qr=()=>n(Tr,er,cr),hn=()=>{Or(Tr,()=>{Qr(),Nr&&Nr()})};Pr?Pr(Tr,Qr,hn):hn()}else n(Tr,er,cr)},sr=(kt,er,cr,mr=!1,vr=!1)=>{const{type:Tr,props:Ir,ref:kr,children:Ar,dynamicChildren:Rr,shapeFlag:Cn,patchFlag:Or,dirs:Pr}=kt;if(kr!=null&&setRef(kr,null,cr,kt,!0),Cn&256){er.ctx.deactivate(kt);return}const Nr=Cn&1&&Pr,Qr=!isAsyncWrapper(kt);let hn;if(Qr&&(hn=Ir&&Ir.onVnodeBeforeUnmount)&&invokeVNodeHook(hn,er,kt),Cn&6)nr(kt.component,cr,mr);else{if(Cn&128){kt.suspense.unmount(cr,mr);return}Nr&&invokeDirectiveHook(kt,null,er,"beforeUnmount"),Cn&64?kt.type.remove(kt,er,cr,vr,or,mr):Rr&&(Tr!==Fragment||Or>0&&Or&64)?ir(Rr,er,cr,!1,!0):(Tr===Fragment&&Or&384||!vr&&Cn&16)&&ir(Ar,er,cr),mr&&hr(kt)}(Qr&&(hn=Ir&&Ir.onVnodeUnmounted)||Nr)&&queuePostRenderEffect(()=>{hn&&invokeVNodeHook(hn,er,kt),Nr&&invokeDirectiveHook(kt,null,er,"unmounted")},cr)},hr=kt=>{const{type:er,el:cr,anchor:mr,transition:vr}=kt;if(er===Fragment){Fe(cr,mr);return}if(er===Static){he(kt);return}const Tr=()=>{o(cr),vr&&!vr.persisted&&vr.afterLeave&&vr.afterLeave()};if(kt.shapeFlag&1&&vr&&!vr.persisted){const{leave:Ir,delayLeave:kr}=vr,Ar=()=>Ir(cr,Tr);kr?kr(kt.el,Tr,Ar):Ar()}else Tr()},Fe=(kt,er)=>{let cr;for(;kt!==er;)cr=v(kt),o(kt),kt=cr;o(er)},nr=(kt,er,cr)=>{const{bum:mr,scope:vr,update:Tr,subTree:Ir,um:kr}=kt;mr&&invokeArrayFns(mr),vr.stop(),Tr&&(Tr.active=!1,sr(Ir,kt,er,cr)),kr&&queuePostRenderEffect(kr,er),queuePostRenderEffect(()=>{kt.isUnmounted=!0},er),er&&er.pendingBranch&&!er.isUnmounted&&kt.asyncDep&&!kt.asyncResolved&&kt.suspenseId===er.pendingId&&(er.deps--,er.deps===0&&er.resolve())},ir=(kt,er,cr,mr=!1,vr=!1,Tr=0)=>{for(let Ir=Tr;Ir<kt.length;Ir++)sr(kt[Ir],er,cr,mr,vr)},Ue=kt=>kt.shapeFlag&6?Ue(kt.component.subTree):kt.shapeFlag&128?kt.suspense.next():v(kt.anchor||kt.el),rr=(kt,er,cr)=>{kt==null?er._vnode&&sr(er._vnode,null,null,!0):T(er._vnode||null,kt,er,null,null,null,cr),flushPreFlushCbs(),flushPostFlushCbs(),er._vnode=kt},or={p:T,um:sr,m:pr,r:hr,mt:Ie,mc:Y,pc:Lt,pbc:Ce,n:Ue,o:t};let Pt,Et;return r&&([Pt,Et]=r(or)),{render:rr,hydrate:Pt,createApp:createAppAPI(rr,Pt)}}function toggleRecurse({effect:t,update:r},e){t.allowRecurse=r.allowRecurse=e}function needTransition(t,r){return(!t||t&&!t.pendingBranch)&&r&&!r.persisted}function traverseStaticChildren(t,r,e=!1){const n=t.children,o=r.children;if(isArray$4(n)&&isArray$4(o))for(let s=0;s<n.length;s++){const a=n[s];let i=o[s];i.shapeFlag&1&&!i.dynamicChildren&&((i.patchFlag<=0||i.patchFlag===32)&&(i=o[s]=cloneIfMounted(o[s]),i.el=a.el),e||traverseStaticChildren(a,i)),i.type===Text&&(i.el=a.el)}}function getSequence(t){const r=t.slice(),e=[0];let n,o,s,a,i;const u=t.length;for(n=0;n<u;n++){const d=t[n];if(d!==0){if(o=e[e.length-1],t[o]<d){r[n]=o,e.push(n);continue}for(s=0,a=e.length-1;s<a;)i=s+a>>1,t[e[i]]<d?s=i+1:a=i;d<t[e[s]]&&(s>0&&(r[n]=e[s-1]),e[s]=n)}}for(s=e.length,a=e[s-1];s-- >0;)e[s]=a,a=r[a];return e}const isTeleport=t=>t.__isTeleport,isTeleportDisabled=t=>t&&(t.disabled||t.disabled===""),isTargetSVG=t=>typeof SVGElement<"u"&&t instanceof SVGElement,resolveTarget=(t,r)=>{const e=t&&t.to;return isString$2(e)?r?r(e):null:e},TeleportImpl={__isTeleport:!0,process(t,r,e,n,o,s,a,i,u,d){const{mc:c,pc:m,pbc:v,o:{insert:g,querySelector:b,createText:T,createComment:k}}=d,y=isTeleportDisabled(r.props);let{shapeFlag:O,children:D,dynamicChildren:he}=r;if(t==null){const ae=r.el=T(""),Ne=r.anchor=T("");g(ae,e,n),g(Ne,e,n);const ue=r.target=resolveTarget(r.props,b),Y=r.targetAnchor=T("");ue&&(g(Y,ue),a=a||isTargetSVG(ue));const _e=(Ce,ze)=>{O&16&&c(D,Ce,ze,o,s,a,i,u)};y?_e(e,Ne):ue&&_e(ue,Y)}else{r.el=t.el;const ae=r.anchor=t.anchor,Ne=r.target=t.target,ue=r.targetAnchor=t.targetAnchor,Y=isTeleportDisabled(t.props),_e=Y?e:Ne,Ce=Y?ae:ue;if(a=a||isTargetSVG(Ne),he?(v(t.dynamicChildren,he,_e,o,s,a,i),traverseStaticChildren(t,r,!0)):u||m(t,r,_e,Ce,o,s,a,i,!1),y)Y?r.props&&t.props&&r.props.to!==t.props.to&&(r.props.to=t.props.to):moveTeleport(r,e,ae,d,1);else if((r.props&&r.props.to)!==(t.props&&t.props.to)){const ze=r.target=resolveTarget(r.props,b);ze&&moveTeleport(r,ze,null,d,0)}else Y&&moveTeleport(r,Ne,ue,d,1)}updateCssVars(r)},remove(t,r,e,n,{um:o,o:{remove:s}},a){const{shapeFlag:i,children:u,anchor:d,targetAnchor:c,target:m,props:v}=t;if(m&&s(c),a&&s(d),i&16){const g=a||!isTeleportDisabled(v);for(let b=0;b<u.length;b++){const T=u[b];o(T,r,e,g,!!T.dynamicChildren)}}},move:moveTeleport,hydrate:hydrateTeleport};function moveTeleport(t,r,e,{o:{insert:n},m:o},s=2){s===0&&n(t.targetAnchor,r,e);const{el:a,anchor:i,shapeFlag:u,children:d,props:c}=t,m=s===2;if(m&&n(a,r,e),(!m||isTeleportDisabled(c))&&u&16)for(let v=0;v<d.length;v++)o(d[v],r,e,2);m&&n(i,r,e)}function hydrateTeleport(t,r,e,n,o,s,{o:{nextSibling:a,parentNode:i,querySelector:u}},d){const c=r.target=resolveTarget(r.props,u);if(c){const m=c._lpa||c.firstChild;if(r.shapeFlag&16)if(isTeleportDisabled(r.props))r.anchor=d(a(t),r,i(t),e,n,o,s),r.targetAnchor=m;else{r.anchor=a(t);let v=m;for(;v;)if(v=a(v),v&&v.nodeType===8&&v.data==="teleport anchor"){r.targetAnchor=v,c._lpa=r.targetAnchor&&a(r.targetAnchor);break}d(m,r,c,e,n,o,s)}updateCssVars(r)}return r.anchor&&a(r.anchor)}const Teleport=TeleportImpl;function updateCssVars(t){const r=t.ctx;if(r&&r.ut){let e=t.children[0].el;for(;e&&e!==t.targetAnchor;)e.nodeType===1&&e.setAttribute("data-v-owner",r.uid),e=e.nextSibling;r.ut()}}const Fragment=Symbol.for("v-fgt"),Text=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;function openBlock(t=!1){blockStack.push(currentBlock=t?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(t){isBlockTreeEnabled+=t}function setupBlock(t){return t.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(t),t}function createElementBlock(t,r,e,n,o,s){return setupBlock(createBaseVNode(t,r,e,n,o,s,!0))}function createBlock(t,r,e,n,o){return setupBlock(createVNode(t,r,e,n,o,!0))}function isVNode(t){return t?t.__v_isVNode===!0:!1}function isSameVNodeType(t,r){return t.type===r.type&&t.key===r.key}const InternalObjectKey="__vInternal",normalizeKey=({key:t})=>t??null,normalizeRef=({ref:t,ref_key:r,ref_for:e})=>(typeof t=="number"&&(t=""+t),t!=null?isString$2(t)||isRef(t)||isFunction$3(t)?{i:currentRenderingInstance,r:t,k:r,f:!!e}:t:null);function createBaseVNode(t,r=null,e=null,n=0,o=null,s=t===Fragment?0:1,a=!1,i=!1){const u={__v_isVNode:!0,__v_skip:!0,type:t,props:r,key:r&&normalizeKey(r),ref:r&&normalizeRef(r),scopeId:currentScopeId,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:n,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return i?(normalizeChildren(u,e),s&128&&t.normalize(u)):e&&(u.shapeFlag|=isString$2(e)?8:16),isBlockTreeEnabled>0&&!a&&currentBlock&&(u.patchFlag>0||s&6)&&u.patchFlag!==32&&currentBlock.push(u),u}const createVNode=_createVNode;function _createVNode(t,r=null,e=null,n=0,o=null,s=!1){if((!t||t===NULL_DYNAMIC_COMPONENT)&&(t=Comment),isVNode(t)){const i=cloneVNode(t,r,!0);return e&&normalizeChildren(i,e),isBlockTreeEnabled>0&&!s&&currentBlock&&(i.shapeFlag&6?currentBlock[currentBlock.indexOf(t)]=i:currentBlock.push(i)),i.patchFlag|=-2,i}if(isClassComponent(t)&&(t=t.__vccOpts),r){r=guardReactiveProps(r);let{class:i,style:u}=r;i&&!isString$2(i)&&(r.class=normalizeClass(i)),isObject$2(u)&&(isProxy(u)&&!isArray$4(u)&&(u=extend$1({},u)),r.style=normalizeStyle(u))}const a=isString$2(t)?1:isSuspense(t)?128:isTeleport(t)?64:isObject$2(t)?4:isFunction$3(t)?2:0;return createBaseVNode(t,r,e,n,o,a,s,!0)}function guardReactiveProps(t){return t?isProxy(t)||InternalObjectKey in t?extend$1({},t):t:null}function cloneVNode(t,r,e=!1){const{props:n,ref:o,patchFlag:s,children:a}=t,i=r?mergeProps(n||{},r):n;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:i,key:i&&normalizeKey(i),ref:r&&r.ref?e&&o?isArray$4(o)?o.concat(normalizeRef(r)):[o,normalizeRef(r)]:normalizeRef(r):o,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:r&&t.type!==Fragment?s===-1?16:s|16:s,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&cloneVNode(t.ssContent),ssFallback:t.ssFallback&&cloneVNode(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function createTextVNode(t=" ",r=0){return createVNode(Text,null,t,r)}function createCommentVNode(t="",r=!1){return r?(openBlock(),createBlock(Comment,null,t)):createVNode(Comment,null,t)}function normalizeVNode(t){return t==null||typeof t=="boolean"?createVNode(Comment):isArray$4(t)?createVNode(Fragment,null,t.slice()):typeof t=="object"?cloneIfMounted(t):createVNode(Text,null,String(t))}function cloneIfMounted(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:cloneVNode(t)}function normalizeChildren(t,r){let e=0;const{shapeFlag:n}=t;if(r==null)r=null;else if(isArray$4(r))e=16;else if(typeof r=="object")if(n&65){const o=r.default;o&&(o._c&&(o._d=!1),normalizeChildren(t,o()),o._c&&(o._d=!0));return}else{e=32;const o=r._;!o&&!(InternalObjectKey in r)?r._ctx=currentRenderingInstance:o===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?r._=1:(r._=2,t.patchFlag|=1024))}else isFunction$3(r)?(r={default:r,_ctx:currentRenderingInstance},e=32):(r=String(r),n&64?(e=16,r=[createTextVNode(r)]):e=8);t.children=r,t.shapeFlag|=e}function mergeProps(...t){const r={};for(let e=0;e<t.length;e++){const n=t[e];for(const o in n)if(o==="class")r.class!==n.class&&(r.class=normalizeClass([r.class,n.class]));else if(o==="style")r.style=normalizeStyle([r.style,n.style]);else if(isOn(o)){const s=r[o],a=n[o];a&&s!==a&&!(isArray$4(s)&&s.includes(a))&&(r[o]=s?[].concat(s,a):a)}else o!==""&&(r[o]=n[o])}return r}function invokeVNodeHook(t,r,e,n=null){callWithAsyncErrorHandling(t,r,7,[e,n])}const emptyAppContext=createAppContext();let uid$2=0;function createComponentInstance(t,r,e){const n=t.type,o=(r?r.appContext:t.appContext)||emptyAppContext,s={uid:uid$2++,vnode:t,type:n,parent:r,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:r?r.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(n,o),emitsOptions:normalizeEmitsOptions(n,o),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:n.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=r?r.root:s,s.emit=emit.bind(null,s),t.ce&&t.ce(s),s}let currentInstance=null;const getCurrentInstance=()=>currentInstance||currentRenderingInstance;let internalSetCurrentInstance,globalCurrentInstanceSetters,settersKey="__VUE_INSTANCE_SETTERS__";(globalCurrentInstanceSetters=getGlobalThis()[settersKey])||(globalCurrentInstanceSetters=getGlobalThis()[settersKey]=[]),globalCurrentInstanceSetters.push(t=>currentInstance=t),internalSetCurrentInstance=t=>{globalCurrentInstanceSetters.length>1?globalCurrentInstanceSetters.forEach(r=>r(t)):globalCurrentInstanceSetters[0](t)};const setCurrentInstance=t=>{internalSetCurrentInstance(t),t.scope.on()},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(t){return t.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(t,r=!1){isInSSRComponentSetup=r;const{props:e,children:n}=t.vnode,o=isStatefulComponent(t);initProps(t,e,o,r),initSlots(t,n);const s=o?setupStatefulComponent(t,r):void 0;return isInSSRComponentSetup=!1,s}function setupStatefulComponent(t,r){const e=t.type;t.accessCache=Object.create(null),t.proxy=markRaw(new Proxy(t.ctx,PublicInstanceProxyHandlers));const{setup:n}=e;if(n){const o=t.setupContext=n.length>1?createSetupContext(t):null;setCurrentInstance(t),pauseTracking();const s=callWithErrorHandling(n,t,0,[t.props,o]);if(resetTracking(),unsetCurrentInstance(),isPromise(s)){if(s.then(unsetCurrentInstance,unsetCurrentInstance),r)return s.then(a=>{handleSetupResult(t,a,r)}).catch(a=>{handleError(a,t,0)});t.asyncDep=s}else handleSetupResult(t,s,r)}else finishComponentSetup(t,r)}function handleSetupResult(t,r,e){isFunction$3(r)?t.type.__ssrInlineRender?t.ssrRender=r:t.render=r:isObject$2(r)&&(t.setupState=proxyRefs(r)),finishComponentSetup(t,e)}let compile;function finishComponentSetup(t,r,e){const n=t.type;if(!t.render){if(!r&&compile&&!n.render){const o=n.template||resolveMergedOptions(t).template;if(o){const{isCustomElement:s,compilerOptions:a}=t.appContext.config,{delimiters:i,compilerOptions:u}=n,d=extend$1(extend$1({isCustomElement:s,delimiters:i},a),u);n.render=compile(o,d)}}t.render=n.render||NOOP}{setCurrentInstance(t),pauseTracking();try{applyOptions(t)}finally{resetTracking(),unsetCurrentInstance()}}}function getAttrsProxy(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(r,e){return track(t,"get","$attrs"),r[e]}}))}function createSetupContext(t){const r=e=>{t.exposed=e||{}};return{get attrs(){return getAttrsProxy(t)},slots:t.slots,emit:t.emit,expose:r}}function getExposeProxy(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(proxyRefs(markRaw(t.exposed)),{get(r,e){if(e in r)return r[e];if(e in publicPropertiesMap)return publicPropertiesMap[e](t)},has(r,e){return e in r||e in publicPropertiesMap}}))}function getComponentName(t,r=!0){return isFunction$3(t)?t.displayName||t.name:t.name||r&&t.__name}function isClassComponent(t){return isFunction$3(t)&&"__vccOpts"in t}const computed=(t,r)=>computed$1(t,r,isInSSRComponentSetup);function h(t,r,e){const n=arguments.length;return n===2?isObject$2(r)&&!isArray$4(r)?isVNode(r)?createVNode(t,null,[r]):createVNode(t,r):createVNode(t,null,r):(n>3?e=Array.prototype.slice.call(arguments,2):n===3&&isVNode(e)&&(e=[e]),createVNode(t,r,e))}const ssrContextKey=Symbol.for("v-scx"),useSSRContext=()=>inject(ssrContextKey),version="3.3.7",svgNS="http://www.w3.org/2000/svg",doc=typeof document<"u"?document:null,templateContainer=doc&&doc.createElement("template"),nodeOps={insert:(t,r,e)=>{r.insertBefore(t,e||null)},remove:t=>{const r=t.parentNode;r&&r.removeChild(t)},createElement:(t,r,e,n)=>{const o=r?doc.createElementNS(svgNS,t):doc.createElement(t,e?{is:e}:void 0);return t==="select"&&n&&n.multiple!=null&&o.setAttribute("multiple",n.multiple),o},createText:t=>doc.createTextNode(t),createComment:t=>doc.createComment(t),setText:(t,r)=>{t.nodeValue=r},setElementText:(t,r)=>{t.textContent=r},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>doc.querySelector(t),setScopeId(t,r){t.setAttribute(r,"")},insertStaticContent(t,r,e,n,o,s){const a=e?e.previousSibling:r.lastChild;if(o&&(o===s||o.nextSibling))for(;r.insertBefore(o.cloneNode(!0),e),!(o===s||!(o=o.nextSibling)););else{templateContainer.innerHTML=n?`<svg>${t}</svg>`:t;const i=templateContainer.content;if(n){const u=i.firstChild;for(;u.firstChild;)i.appendChild(u.firstChild);i.removeChild(u)}r.insertBefore(i,e)}return[a?a.nextSibling:r.firstChild,e?e.previousSibling:r.lastChild]}},TRANSITION="transition",ANIMATION="animation",vtcKey=Symbol("_vtc"),Transition=(t,{slots:r})=>h(BaseTransition,resolveTransitionProps(t),r);Transition.displayName="Transition";const DOMTransitionPropsValidators={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},TransitionPropsValidators=Transition.props=extend$1({},BaseTransitionPropsValidators,DOMTransitionPropsValidators),callHook=(t,r=[])=>{isArray$4(t)?t.forEach(e=>e(...r)):t&&t(...r)},hasExplicitCallback=t=>t?isArray$4(t)?t.some(r=>r.length>1):t.length>1:!1;function resolveTransitionProps(t){const r={};for(const ie in t)ie in DOMTransitionPropsValidators||(r[ie]=t[ie]);if(t.css===!1)return r;const{name:e="v",type:n,duration:o,enterFromClass:s=`${e}-enter-from`,enterActiveClass:a=`${e}-enter-active`,enterToClass:i=`${e}-enter-to`,appearFromClass:u=s,appearActiveClass:d=a,appearToClass:c=i,leaveFromClass:m=`${e}-leave-from`,leaveActiveClass:v=`${e}-leave-active`,leaveToClass:g=`${e}-leave-to`}=t,b=normalizeDuration(o),T=b&&b[0],k=b&&b[1],{onBeforeEnter:y,onEnter:O,onEnterCancelled:D,onLeave:he,onLeaveCancelled:ae,onBeforeAppear:Ne=y,onAppear:ue=O,onAppearCancelled:Y=D}=r,_e=(ie,le,Ie)=>{removeTransitionClass(ie,le?c:i),removeTransitionClass(ie,le?d:a),Ie&&Ie()},Ce=(ie,le)=>{ie._isLeaving=!1,removeTransitionClass(ie,m),removeTransitionClass(ie,g),removeTransitionClass(ie,v),le&&le()},ze=ie=>(le,Ie)=>{const pe=ie?ue:O,qe=()=>_e(le,ie,Ie);callHook(pe,[le,qe]),nextFrame(()=>{removeTransitionClass(le,ie?u:s),addTransitionClass(le,ie?c:i),hasExplicitCallback(pe)||whenTransitionEnds(le,n,T,qe)})};return extend$1(r,{onBeforeEnter(ie){callHook(y,[ie]),addTransitionClass(ie,s),addTransitionClass(ie,a)},onBeforeAppear(ie){callHook(Ne,[ie]),addTransitionClass(ie,u),addTransitionClass(ie,d)},onEnter:ze(!1),onAppear:ze(!0),onLeave(ie,le){ie._isLeaving=!0;const Ie=()=>Ce(ie,le);addTransitionClass(ie,m),forceReflow(),addTransitionClass(ie,v),nextFrame(()=>{ie._isLeaving&&(removeTransitionClass(ie,m),addTransitionClass(ie,g),hasExplicitCallback(he)||whenTransitionEnds(ie,n,k,Ie))}),callHook(he,[ie,Ie])},onEnterCancelled(ie){_e(ie,!1),callHook(D,[ie])},onAppearCancelled(ie){_e(ie,!0),callHook(Y,[ie])},onLeaveCancelled(ie){Ce(ie),callHook(ae,[ie])}})}function normalizeDuration(t){if(t==null)return null;if(isObject$2(t))return[NumberOf(t.enter),NumberOf(t.leave)];{const r=NumberOf(t);return[r,r]}}function NumberOf(t){return toNumber$1(t)}function addTransitionClass(t,r){r.split(/\s+/).forEach(e=>e&&t.classList.add(e)),(t[vtcKey]||(t[vtcKey]=new Set)).add(r)}function removeTransitionClass(t,r){r.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const e=t[vtcKey];e&&(e.delete(r),e.size||(t[vtcKey]=void 0))}function nextFrame(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let endId=0;function whenTransitionEnds(t,r,e,n){const o=t._endId=++endId,s=()=>{o===t._endId&&n()};if(e)return setTimeout(s,e);const{type:a,timeout:i,propCount:u}=getTransitionInfo(t,r);if(!a)return n();const d=a+"end";let c=0;const m=()=>{t.removeEventListener(d,v),s()},v=g=>{g.target===t&&++c>=u&&m()};setTimeout(()=>{c<u&&m()},i+1),t.addEventListener(d,v)}function getTransitionInfo(t,r){const e=window.getComputedStyle(t),n=b=>(e[b]||"").split(", "),o=n(`${TRANSITION}Delay`),s=n(`${TRANSITION}Duration`),a=getTimeout(o,s),i=n(`${ANIMATION}Delay`),u=n(`${ANIMATION}Duration`),d=getTimeout(i,u);let c=null,m=0,v=0;r===TRANSITION?a>0&&(c=TRANSITION,m=a,v=s.length):r===ANIMATION?d>0&&(c=ANIMATION,m=d,v=u.length):(m=Math.max(a,d),c=m>0?a>d?TRANSITION:ANIMATION:null,v=c?c===TRANSITION?s.length:u.length:0);const g=c===TRANSITION&&/\b(transform|all)(,|$)/.test(n(`${TRANSITION}Property`).toString());return{type:c,timeout:m,propCount:v,hasTransform:g}}function getTimeout(t,r){for(;t.length<r.length;)t=t.concat(t);return Math.max(...r.map((e,n)=>toMs(e)+toMs(t[n])))}function toMs(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function forceReflow(){return document.body.offsetHeight}function patchClass(t,r,e){const n=t[vtcKey];n&&(r=(r?[r,...n]:[...n]).join(" ")),r==null?t.removeAttribute("class"):e?t.setAttribute("class",r):t.className=r}const vShowOldKey=Symbol("_vod"),vShow={beforeMount(t,{value:r},{transition:e}){t[vShowOldKey]=t.style.display==="none"?"":t.style.display,e&&r?e.beforeEnter(t):setDisplay(t,r)},mounted(t,{value:r},{transition:e}){e&&r&&e.enter(t)},updated(t,{value:r,oldValue:e},{transition:n}){!r!=!e&&(n?r?(n.beforeEnter(t),setDisplay(t,!0),n.enter(t)):n.leave(t,()=>{setDisplay(t,!1)}):setDisplay(t,r))},beforeUnmount(t,{value:r}){setDisplay(t,r)}};function setDisplay(t,r){t.style.display=r?t[vShowOldKey]:"none"}function patchStyle(t,r,e){const n=t.style,o=isString$2(e);if(e&&!o){if(r&&!isString$2(r))for(const s in r)e[s]==null&&setStyle(n,s,"");for(const s in e)setStyle(n,s,e[s])}else{const s=n.display;o?r!==e&&(n.cssText=e):r&&t.removeAttribute("style"),vShowOldKey in t&&(n.display=s)}}const importantRE=/\s*!important$/;function setStyle(t,r,e){if(isArray$4(e))e.forEach(n=>setStyle(t,r,n));else if(e==null&&(e=""),r.startsWith("--"))t.setProperty(r,e);else{const n=autoPrefix(t,r);importantRE.test(e)?t.setProperty(hyphenate(n),e.replace(importantRE,""),"important"):t[n]=e}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(t,r){const e=prefixCache[r];if(e)return e;let n=camelize(r);if(n!=="filter"&&n in t)return prefixCache[r]=n;n=capitalize$1(n);for(let o=0;o<prefixes.length;o++){const s=prefixes[o]+n;if(s in t)return prefixCache[r]=s}return r}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(t,r,e,n,o){if(n&&r.startsWith("xlink:"))e==null?t.removeAttributeNS(xlinkNS,r.slice(6,r.length)):t.setAttributeNS(xlinkNS,r,e);else{const s=isSpecialBooleanAttr(r);e==null||s&&!includeBooleanAttr(e)?t.removeAttribute(r):t.setAttribute(r,s?"":e)}}function patchDOMProp(t,r,e,n,o,s,a){if(r==="innerHTML"||r==="textContent"){n&&a(n,o,s),t[r]=e??"";return}const i=t.tagName;if(r==="value"&&i!=="PROGRESS"&&!i.includes("-")){t._value=e;const d=i==="OPTION"?t.getAttribute("value"):t.value,c=e??"";d!==c&&(t.value=c),e==null&&t.removeAttribute(r);return}let u=!1;if(e===""||e==null){const d=typeof t[r];d==="boolean"?e=includeBooleanAttr(e):e==null&&d==="string"?(e="",u=!0):d==="number"&&(e=0,u=!0)}try{t[r]=e}catch{}u&&t.removeAttribute(r)}function addEventListener(t,r,e,n){t.addEventListener(r,e,n)}function removeEventListener(t,r,e,n){t.removeEventListener(r,e,n)}const veiKey=Symbol("_vei");function patchEvent(t,r,e,n,o=null){const s=t[veiKey]||(t[veiKey]={}),a=s[r];if(n&&a)a.value=n;else{const[i,u]=parseName(r);if(n){const d=s[r]=createInvoker(n,o);addEventListener(t,i,d,u)}else a&&(removeEventListener(t,i,a,u),s[r]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(t){let r;if(optionsModifierRE.test(t)){r={};let n;for(;n=t.match(optionsModifierRE);)t=t.slice(0,t.length-n[0].length),r[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):hyphenate(t.slice(2)),r]}let cachedNow=0;const p=Promise.resolve(),getNow=()=>cachedNow||(p.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(t,r){const e=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=e.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(n,e.value),r,5,[n])};return e.value=t,e.attached=getNow(),e}function patchStopImmediatePropagation(t,r){if(isArray$4(r)){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{e.call(t),t._stopped=!0},r.map(n=>o=>!o._stopped&&n&&n(o))}else return r}const nativeOnRE=/^on[a-z]/,patchProp=(t,r,e,n,o=!1,s,a,i,u)=>{r==="class"?patchClass(t,n,o):r==="style"?patchStyle(t,e,n):isOn(r)?isModelListener(r)||patchEvent(t,r,e,n,a):(r[0]==="."?(r=r.slice(1),!0):r[0]==="^"?(r=r.slice(1),!1):shouldSetAsProp(t,r,n,o))?patchDOMProp(t,r,n,s,a,i,u):(r==="true-value"?t._trueValue=n:r==="false-value"&&(t._falseValue=n),patchAttr(t,r,n,o))};function shouldSetAsProp(t,r,e,n){return n?!!(r==="innerHTML"||r==="textContent"||r in t&&nativeOnRE.test(r)&&isFunction$3(e)):r==="spellcheck"||r==="draggable"||r==="translate"||r==="form"||r==="list"&&t.tagName==="INPUT"||r==="type"&&t.tagName==="TEXTAREA"||nativeOnRE.test(r)&&isString$2(e)?!1:r in t}const positionMap=new WeakMap,newPositionMap=new WeakMap,moveCbKey=Symbol("_moveCb"),enterCbKey=Symbol("_enterCb"),TransitionGroupImpl={name:"TransitionGroup",props:extend$1({},TransitionPropsValidators,{tag:String,moveClass:String}),setup(t,{slots:r}){const e=getCurrentInstance(),n=useTransitionState();let o,s;return onUpdated(()=>{if(!o.length)return;const a=t.moveClass||`${t.name||"v"}-move`;if(!hasCSSTransform(o[0].el,e.vnode.el,a))return;o.forEach(callPendingCbs),o.forEach(recordPosition);const i=o.filter(applyTranslation);forceReflow(),i.forEach(u=>{const d=u.el,c=d.style;addTransitionClass(d,a),c.transform=c.webkitTransform=c.transitionDuration="";const m=d[moveCbKey]=v=>{v&&v.target!==d||(!v||/transform$/.test(v.propertyName))&&(d.removeEventListener("transitionend",m),d[moveCbKey]=null,removeTransitionClass(d,a))};d.addEventListener("transitionend",m)})}),()=>{const a=toRaw(t),i=resolveTransitionProps(a);let u=a.tag||Fragment;o=s,s=r.default?getTransitionRawChildren(r.default()):[];for(let d=0;d<s.length;d++){const c=s[d];c.key!=null&&setTransitionHooks(c,resolveTransitionHooks(c,i,n,e))}if(o)for(let d=0;d<o.length;d++){const c=o[d];setTransitionHooks(c,resolveTransitionHooks(c,i,n,e)),positionMap.set(c,c.el.getBoundingClientRect())}return createVNode(u,null,s)}}},removeMode=t=>delete t.mode;TransitionGroupImpl.props;const TransitionGroup=TransitionGroupImpl;function callPendingCbs(t){const r=t.el;r[moveCbKey]&&r[moveCbKey](),r[enterCbKey]&&r[enterCbKey]()}function recordPosition(t){newPositionMap.set(t,t.el.getBoundingClientRect())}function applyTranslation(t){const r=positionMap.get(t),e=newPositionMap.get(t),n=r.left-e.left,o=r.top-e.top;if(n||o){const s=t.el.style;return s.transform=s.webkitTransform=`translate(${n}px,${o}px)`,s.transitionDuration="0s",t}}function hasCSSTransform(t,r,e){const n=t.cloneNode(),o=t[vtcKey];o&&o.forEach(i=>{i.split(/\s+/).forEach(u=>u&&n.classList.remove(u))}),e.split(/\s+/).forEach(i=>i&&n.classList.add(i)),n.style.display="none";const s=r.nodeType===1?r:r.parentNode;s.appendChild(n);const{hasTransform:a}=getTransitionInfo(n);return s.removeChild(n),a}const getModelAssigner=t=>{const r=t.props["onUpdate:modelValue"]||!1;return isArray$4(r)?e=>invokeArrayFns(r,e):r};function onCompositionStart(t){t.target.composing=!0}function onCompositionEnd(t){const r=t.target;r.composing&&(r.composing=!1,r.dispatchEvent(new Event("input")))}const assignKey=Symbol("_assign"),vModelText={created(t,{modifiers:{lazy:r,trim:e,number:n}},o){t[assignKey]=getModelAssigner(o);const s=n||o.props&&o.props.type==="number";addEventListener(t,r?"change":"input",a=>{if(a.target.composing)return;let i=t.value;e&&(i=i.trim()),s&&(i=looseToNumber(i)),t[assignKey](i)}),e&&addEventListener(t,"change",()=>{t.value=t.value.trim()}),r||(addEventListener(t,"compositionstart",onCompositionStart),addEventListener(t,"compositionend",onCompositionEnd),addEventListener(t,"change",onCompositionEnd))},mounted(t,{value:r}){t.value=r??""},beforeUpdate(t,{value:r,modifiers:{lazy:e,trim:n,number:o}},s){if(t[assignKey]=getModelAssigner(s),t.composing||document.activeElement===t&&t.type!=="range"&&(e||n&&t.value.trim()===r||(o||t.type==="number")&&looseToNumber(t.value)===r))return;const a=r??"";t.value!==a&&(t.value=a)}},vModelCheckbox={deep:!0,created(t,r,e){t[assignKey]=getModelAssigner(e),addEventListener(t,"change",()=>{const n=t._modelValue,o=getValue$2(t),s=t.checked,a=t[assignKey];if(isArray$4(n)){const i=looseIndexOf(n,o),u=i!==-1;if(s&&!u)a(n.concat(o));else if(!s&&u){const d=[...n];d.splice(i,1),a(d)}}else if(isSet$2(n)){const i=new Set(n);s?i.add(o):i.delete(o),a(i)}else a(getCheckboxValue(t,s))})},mounted:setChecked,beforeUpdate(t,r,e){t[assignKey]=getModelAssigner(e),setChecked(t,r,e)}};function setChecked(t,{value:r,oldValue:e},n){t._modelValue=r,isArray$4(r)?t.checked=looseIndexOf(r,n.props.value)>-1:isSet$2(r)?t.checked=r.has(n.props.value):r!==e&&(t.checked=looseEqual(r,getCheckboxValue(t,!0)))}const vModelRadio={created(t,{value:r},e){t.checked=looseEqual(r,e.props.value),t[assignKey]=getModelAssigner(e),addEventListener(t,"change",()=>{t[assignKey](getValue$2(t))})},beforeUpdate(t,{value:r,oldValue:e},n){t[assignKey]=getModelAssigner(n),r!==e&&(t.checked=looseEqual(r,n.props.value))}};function getValue$2(t){return"_value"in t?t._value:t.value}function getCheckboxValue(t,r){const e=r?"_trueValue":"_falseValue";return e in t?t[e]:r}const systemModifiers=["ctrl","shift","alt","meta"],modifierGuards={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,r)=>systemModifiers.some(e=>t[`${e}Key`]&&!r.includes(e))},withModifiers=(t,r)=>(e,...n)=>{for(let o=0;o<r.length;o++){const s=modifierGuards[r[o]];if(s&&s(e,r))return}return t(e,...n)},keyNames={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},withKeys=(t,r)=>e=>{if(!("key"in e))return;const n=hyphenate(e.key);if(r.some(o=>o===n||keyNames[o]===n))return t(e)},rendererOptions=extend$1({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const render=(...t)=>{ensureRenderer().render(...t)},createApp=(...t)=>{const r=ensureRenderer().createApp(...t),{mount:e}=r;return r.mount=n=>{const o=normalizeContainer(n);if(!o)return;const s=r._component;!isFunction$3(s)&&!s.render&&!s.template&&(s.template=o.innerHTML),o.innerHTML="";const a=e(o,!1,o instanceof SVGElement);return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),a},r};function normalizeContainer(t){return isString$2(t)?document.querySelector(t):t}/*!
  * vue-router v4.2.5
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const isBrowser=typeof window<"u";function isESModule(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const assign=Object.assign;function applyToParams(t,r){const e={};for(const n in r){const o=r[n];e[n]=isArray$3(o)?o.map(t):t(o)}return e}const noop$2=()=>{},isArray$3=Array.isArray,TRAILING_SLASH_RE=/\/$/,removeTrailingSlash=t=>t.replace(TRAILING_SLASH_RE,"");function parseURL(t,r,e="/"){let n,o={},s="",a="";const i=r.indexOf("#");let u=r.indexOf("?");return i<u&&i>=0&&(u=-1),u>-1&&(n=r.slice(0,u),s=r.slice(u+1,i>-1?i:r.length),o=t(s)),i>-1&&(n=n||r.slice(0,i),a=r.slice(i,r.length)),n=resolveRelativePath(n??r,e),{fullPath:n+(s&&"?")+s+a,path:n,query:o,hash:a}}function stringifyURL(t,r){const e=r.query?t(r.query):"";return r.path+(e&&"?")+e+(r.hash||"")}function stripBase(t,r){return!r||!t.toLowerCase().startsWith(r.toLowerCase())?t:t.slice(r.length)||"/"}function isSameRouteLocation(t,r,e){const n=r.matched.length-1,o=e.matched.length-1;return n>-1&&n===o&&isSameRouteRecord(r.matched[n],e.matched[o])&&isSameRouteLocationParams(r.params,e.params)&&t(r.query)===t(e.query)&&r.hash===e.hash}function isSameRouteRecord(t,r){return(t.aliasOf||t)===(r.aliasOf||r)}function isSameRouteLocationParams(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const e in t)if(!isSameRouteLocationParamsValue(t[e],r[e]))return!1;return!0}function isSameRouteLocationParamsValue(t,r){return isArray$3(t)?isEquivalentArray(t,r):isArray$3(r)?isEquivalentArray(r,t):t===r}function isEquivalentArray(t,r){return isArray$3(r)?t.length===r.length&&t.every((e,n)=>e===r[n]):t.length===1&&t[0]===r}function resolveRelativePath(t,r){if(t.startsWith("/"))return t;if(!t)return r;const e=r.split("/"),n=t.split("/"),o=n[n.length-1];(o===".."||o===".")&&n.push("");let s=e.length-1,a,i;for(a=0;a<n.length;a++)if(i=n[a],i!==".")if(i==="..")s>1&&s--;else break;return e.slice(0,s).join("/")+"/"+n.slice(a-(a===n.length?1:0)).join("/")}var NavigationType;(function(t){t.pop="pop",t.push="push"})(NavigationType||(NavigationType={}));var NavigationDirection;(function(t){t.back="back",t.forward="forward",t.unknown=""})(NavigationDirection||(NavigationDirection={}));function normalizeBase(t){if(!t)if(isBrowser){const r=document.querySelector("base");t=r&&r.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),removeTrailingSlash(t)}const BEFORE_HASH_RE=/^[^#]+#/;function createHref(t,r){return t.replace(BEFORE_HASH_RE,"#")+r}function getElementPosition(t,r){const e=document.documentElement.getBoundingClientRect(),n=t.getBoundingClientRect();return{behavior:r.behavior,left:n.left-e.left-(r.left||0),top:n.top-e.top-(r.top||0)}}const computeScrollPosition=()=>({left:window.pageXOffset,top:window.pageYOffset});function scrollToPosition(t){let r;if("el"in t){const e=t.el,n=typeof e=="string"&&e.startsWith("#"),o=typeof e=="string"?n?document.getElementById(e.slice(1)):document.querySelector(e):e;if(!o)return;r=getElementPosition(o,t)}else r=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(r):window.scrollTo(r.left!=null?r.left:window.pageXOffset,r.top!=null?r.top:window.pageYOffset)}function getScrollKey(t,r){return(history.state?history.state.position-r:-1)+t}const scrollPositions=new Map;function saveScrollPosition(t,r){scrollPositions.set(t,r)}function getSavedScrollPosition(t){const r=scrollPositions.get(t);return scrollPositions.delete(t),r}let createBaseLocation=()=>location.protocol+"//"+location.host;function createCurrentLocation(t,r){const{pathname:e,search:n,hash:o}=r,s=t.indexOf("#");if(s>-1){let i=o.includes(t.slice(s))?t.slice(s).length:1,u=o.slice(i);return u[0]!=="/"&&(u="/"+u),stripBase(u,"")}return stripBase(e,t)+n+o}function useHistoryListeners(t,r,e,n){let o=[],s=[],a=null;const i=({state:v})=>{const g=createCurrentLocation(t,location),b=e.value,T=r.value;let k=0;if(v){if(e.value=g,r.value=v,a&&a===b){a=null;return}k=T?v.position-T.position:0}else n(g);o.forEach(y=>{y(e.value,b,{delta:k,type:NavigationType.pop,direction:k?k>0?NavigationDirection.forward:NavigationDirection.back:NavigationDirection.unknown})})};function u(){a=e.value}function d(v){o.push(v);const g=()=>{const b=o.indexOf(v);b>-1&&o.splice(b,1)};return s.push(g),g}function c(){const{history:v}=window;v.state&&v.replaceState(assign({},v.state,{scroll:computeScrollPosition()}),"")}function m(){for(const v of s)v();s=[],window.removeEventListener("popstate",i),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",i),window.addEventListener("beforeunload",c,{passive:!0}),{pauseListeners:u,listen:d,destroy:m}}function buildState(t,r,e,n=!1,o=!1){return{back:t,current:r,forward:e,replaced:n,position:window.history.length,scroll:o?computeScrollPosition():null}}function useHistoryStateNavigation(t){const{history:r,location:e}=window,n={value:createCurrentLocation(t,e)},o={value:r.state};o.value||s(n.value,{back:null,current:n.value,forward:null,position:r.length-1,replaced:!0,scroll:null},!0);function s(u,d,c){const m=t.indexOf("#"),v=m>-1?(e.host&&document.querySelector("base")?t:t.slice(m))+u:createBaseLocation()+t+u;try{r[c?"replaceState":"pushState"](d,"",v),o.value=d}catch(g){console.error(g),e[c?"replace":"assign"](v)}}function a(u,d){const c=assign({},r.state,buildState(o.value.back,u,o.value.forward,!0),d,{position:o.value.position});s(u,c,!0),n.value=u}function i(u,d){const c=assign({},o.value,r.state,{forward:u,scroll:computeScrollPosition()});s(c.current,c,!0);const m=assign({},buildState(n.value,u,null),{position:c.position+1},d);s(u,m,!1),n.value=u}return{location:n,state:o,push:i,replace:a}}function createWebHistory(t){t=normalizeBase(t);const r=useHistoryStateNavigation(t),e=useHistoryListeners(t,r.state,r.location,r.replace);function n(s,a=!0){a||e.pauseListeners(),history.go(s)}const o=assign({location:"",base:t,go:n,createHref:createHref.bind(null,t)},r,e);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>r.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>r.state.value}),o}function isRouteLocation(t){return typeof t=="string"||t&&typeof t=="object"}function isRouteName(t){return typeof t=="string"||typeof t=="symbol"}const START_LOCATION_NORMALIZED={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},NavigationFailureSymbol=Symbol("");var NavigationFailureType;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(NavigationFailureType||(NavigationFailureType={}));function createRouterError(t,r){return assign(new Error,{type:t,[NavigationFailureSymbol]:!0},r)}function isNavigationFailure(t,r){return t instanceof Error&&NavigationFailureSymbol in t&&(r==null||!!(t.type&r))}const BASE_PARAM_PATTERN="[^/]+?",BASE_PATH_PARSER_OPTIONS={sensitive:!1,strict:!1,start:!0,end:!0},REGEX_CHARS_RE=/[.+*?^${}()[\]/\\]/g;function tokensToParser(t,r){const e=assign({},BASE_PATH_PARSER_OPTIONS,r),n=[];let o=e.start?"^":"";const s=[];for(const d of t){const c=d.length?[]:[90];e.strict&&!d.length&&(o+="/");for(let m=0;m<d.length;m++){const v=d[m];let g=40+(e.sensitive?.25:0);if(v.type===0)m||(o+="/"),o+=v.value.replace(REGEX_CHARS_RE,"\\$&"),g+=40;else if(v.type===1){const{value:b,repeatable:T,optional:k,regexp:y}=v;s.push({name:b,repeatable:T,optional:k});const O=y||BASE_PARAM_PATTERN;if(O!==BASE_PARAM_PATTERN){g+=10;try{new RegExp(`(${O})`)}catch(he){throw new Error(`Invalid custom RegExp for param "${b}" (${O}): `+he.message)}}let D=T?`((?:${O})(?:/(?:${O}))*)`:`(${O})`;m||(D=k&&d.length<2?`(?:/${D})`:"/"+D),k&&(D+="?"),o+=D,g+=20,k&&(g+=-8),T&&(g+=-20),O===".*"&&(g+=-50)}c.push(g)}n.push(c)}if(e.strict&&e.end){const d=n.length-1;n[d][n[d].length-1]+=.7000000000000001}e.strict||(o+="/?"),e.end?o+="$":e.strict&&(o+="(?:/|$)");const a=new RegExp(o,e.sensitive?"":"i");function i(d){const c=d.match(a),m={};if(!c)return null;for(let v=1;v<c.length;v++){const g=c[v]||"",b=s[v-1];m[b.name]=g&&b.repeatable?g.split("/"):g}return m}function u(d){let c="",m=!1;for(const v of t){(!m||!c.endsWith("/"))&&(c+="/"),m=!1;for(const g of v)if(g.type===0)c+=g.value;else if(g.type===1){const{value:b,repeatable:T,optional:k}=g,y=b in d?d[b]:"";if(isArray$3(y)&&!T)throw new Error(`Provided param "${b}" is an array but it is not repeatable (* or + modifiers)`);const O=isArray$3(y)?y.join("/"):y;if(!O)if(k)v.length<2&&(c.endsWith("/")?c=c.slice(0,-1):m=!0);else throw new Error(`Missing required param "${b}"`);c+=O}}return c||"/"}return{re:a,score:n,keys:s,parse:i,stringify:u}}function compareScoreArray(t,r){let e=0;for(;e<t.length&&e<r.length;){const n=r[e]-t[e];if(n)return n;e++}return t.length<r.length?t.length===1&&t[0]===40+40?-1:1:t.length>r.length?r.length===1&&r[0]===40+40?1:-1:0}function comparePathParserScore(t,r){let e=0;const n=t.score,o=r.score;for(;e<n.length&&e<o.length;){const s=compareScoreArray(n[e],o[e]);if(s)return s;e++}if(Math.abs(o.length-n.length)===1){if(isLastScoreNegative(n))return 1;if(isLastScoreNegative(o))return-1}return o.length-n.length}function isLastScoreNegative(t){const r=t[t.length-1];return t.length>0&&r[r.length-1]<0}const ROOT_TOKEN={type:0,value:""},VALID_PARAM_RE=/[a-zA-Z0-9_]/;function tokenizePath(t){if(!t)return[[]];if(t==="/")return[[ROOT_TOKEN]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function r(g){throw new Error(`ERR (${e})/"${d}": ${g}`)}let e=0,n=e;const o=[];let s;function a(){s&&o.push(s),s=[]}let i=0,u,d="",c="";function m(){d&&(e===0?s.push({type:0,value:d}):e===1||e===2||e===3?(s.length>1&&(u==="*"||u==="+")&&r(`A repeatable param (${d}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:d,regexp:c,repeatable:u==="*"||u==="+",optional:u==="*"||u==="?"})):r("Invalid state to consume buffer"),d="")}function v(){d+=u}for(;i<t.length;){if(u=t[i++],u==="\\"&&e!==2){n=e,e=4;continue}switch(e){case 0:u==="/"?(d&&m(),a()):u===":"?(m(),e=1):v();break;case 4:v(),e=n;break;case 1:u==="("?e=2:VALID_PARAM_RE.test(u)?v():(m(),e=0,u!=="*"&&u!=="?"&&u!=="+"&&i--);break;case 2:u===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+u:e=3:c+=u;break;case 3:m(),e=0,u!=="*"&&u!=="?"&&u!=="+"&&i--,c="";break;default:r("Unknown state");break}}return e===2&&r(`Unfinished custom RegExp for param "${d}"`),m(),a(),o}function createRouteRecordMatcher(t,r,e){const n=tokensToParser(tokenizePath(t.path),e),o=assign(n,{record:t,parent:r,children:[],alias:[]});return r&&!o.record.aliasOf==!r.record.aliasOf&&r.children.push(o),o}function createRouterMatcher(t,r){const e=[],n=new Map;r=mergeOptions({strict:!1,end:!0,sensitive:!1},r);function o(c){return n.get(c)}function s(c,m,v){const g=!v,b=normalizeRouteRecord(c);b.aliasOf=v&&v.record;const T=mergeOptions(r,c),k=[b];if("alias"in c){const D=typeof c.alias=="string"?[c.alias]:c.alias;for(const he of D)k.push(assign({},b,{components:v?v.record.components:b.components,path:he,aliasOf:v?v.record:b}))}let y,O;for(const D of k){const{path:he}=D;if(m&&he[0]!=="/"){const ae=m.record.path,Ne=ae[ae.length-1]==="/"?"":"/";D.path=m.record.path+(he&&Ne+he)}if(y=createRouteRecordMatcher(D,m,T),v?v.alias.push(y):(O=O||y,O!==y&&O.alias.push(y),g&&c.name&&!isAliasRecord(y)&&a(c.name)),b.children){const ae=b.children;for(let Ne=0;Ne<ae.length;Ne++)s(ae[Ne],y,v&&v.children[Ne])}v=v||y,(y.record.components&&Object.keys(y.record.components).length||y.record.name||y.record.redirect)&&u(y)}return O?()=>{a(O)}:noop$2}function a(c){if(isRouteName(c)){const m=n.get(c);m&&(n.delete(c),e.splice(e.indexOf(m),1),m.children.forEach(a),m.alias.forEach(a))}else{const m=e.indexOf(c);m>-1&&(e.splice(m,1),c.record.name&&n.delete(c.record.name),c.children.forEach(a),c.alias.forEach(a))}}function i(){return e}function u(c){let m=0;for(;m<e.length&&comparePathParserScore(c,e[m])>=0&&(c.record.path!==e[m].record.path||!isRecordChildOf(c,e[m]));)m++;e.splice(m,0,c),c.record.name&&!isAliasRecord(c)&&n.set(c.record.name,c)}function d(c,m){let v,g={},b,T;if("name"in c&&c.name){if(v=n.get(c.name),!v)throw createRouterError(1,{location:c});T=v.record.name,g=assign(paramsFromLocation(m.params,v.keys.filter(O=>!O.optional).map(O=>O.name)),c.params&&paramsFromLocation(c.params,v.keys.map(O=>O.name))),b=v.stringify(g)}else if("path"in c)b=c.path,v=e.find(O=>O.re.test(b)),v&&(g=v.parse(b),T=v.record.name);else{if(v=m.name?n.get(m.name):e.find(O=>O.re.test(m.path)),!v)throw createRouterError(1,{location:c,currentLocation:m});T=v.record.name,g=assign({},m.params,c.params),b=v.stringify(g)}const k=[];let y=v;for(;y;)k.unshift(y.record),y=y.parent;return{name:T,path:b,params:g,matched:k,meta:mergeMetaFields(k)}}return t.forEach(c=>s(c)),{addRoute:s,resolve:d,removeRoute:a,getRoutes:i,getRecordMatcher:o}}function paramsFromLocation(t,r){const e={};for(const n of r)n in t&&(e[n]=t[n]);return e}function normalizeRouteRecord(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:normalizeRecordProps(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function normalizeRecordProps(t){const r={},e=t.props||!1;if("component"in t)r.default=e;else for(const n in t.components)r[n]=typeof e=="object"?e[n]:e;return r}function isAliasRecord(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function mergeMetaFields(t){return t.reduce((r,e)=>assign(r,e.meta),{})}function mergeOptions(t,r){const e={};for(const n in t)e[n]=n in r?r[n]:t[n];return e}function isRecordChildOf(t,r){return r.children.some(e=>e===t||isRecordChildOf(t,e))}const HASH_RE=/#/g,AMPERSAND_RE=/&/g,SLASH_RE=/\//g,EQUAL_RE=/=/g,IM_RE=/\?/g,PLUS_RE=/\+/g,ENC_BRACKET_OPEN_RE=/%5B/g,ENC_BRACKET_CLOSE_RE=/%5D/g,ENC_CARET_RE=/%5E/g,ENC_BACKTICK_RE=/%60/g,ENC_CURLY_OPEN_RE=/%7B/g,ENC_PIPE_RE=/%7C/g,ENC_CURLY_CLOSE_RE=/%7D/g,ENC_SPACE_RE=/%20/g;function commonEncode(t){return encodeURI(""+t).replace(ENC_PIPE_RE,"|").replace(ENC_BRACKET_OPEN_RE,"[").replace(ENC_BRACKET_CLOSE_RE,"]")}function encodeHash(t){return commonEncode(t).replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryValue(t){return commonEncode(t).replace(PLUS_RE,"%2B").replace(ENC_SPACE_RE,"+").replace(HASH_RE,"%23").replace(AMPERSAND_RE,"%26").replace(ENC_BACKTICK_RE,"`").replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryKey(t){return encodeQueryValue(t).replace(EQUAL_RE,"%3D")}function encodePath(t){return commonEncode(t).replace(HASH_RE,"%23").replace(IM_RE,"%3F")}function encodeParam(t){return t==null?"":encodePath(t).replace(SLASH_RE,"%2F")}function decode(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function parseQuery(t){const r={};if(t===""||t==="?")return r;const n=(t[0]==="?"?t.slice(1):t).split("&");for(let o=0;o<n.length;++o){const s=n[o].replace(PLUS_RE," "),a=s.indexOf("="),i=decode(a<0?s:s.slice(0,a)),u=a<0?null:decode(s.slice(a+1));if(i in r){let d=r[i];isArray$3(d)||(d=r[i]=[d]),d.push(u)}else r[i]=u}return r}function stringifyQuery(t){let r="";for(let e in t){const n=t[e];if(e=encodeQueryKey(e),n==null){n!==void 0&&(r+=(r.length?"&":"")+e);continue}(isArray$3(n)?n.map(s=>s&&encodeQueryValue(s)):[n&&encodeQueryValue(n)]).forEach(s=>{s!==void 0&&(r+=(r.length?"&":"")+e,s!=null&&(r+="="+s))})}return r}function normalizeQuery(t){const r={};for(const e in t){const n=t[e];n!==void 0&&(r[e]=isArray$3(n)?n.map(o=>o==null?null:""+o):n==null?n:""+n)}return r}const matchedRouteKey=Symbol(""),viewDepthKey=Symbol(""),routerKey=Symbol(""),routeLocationKey=Symbol(""),routerViewLocationKey=Symbol("");function useCallbacks(){let t=[];function r(n){return t.push(n),()=>{const o=t.indexOf(n);o>-1&&t.splice(o,1)}}function e(){t=[]}return{add:r,list:()=>t.slice(),reset:e}}function guardToPromiseFn(t,r,e,n,o){const s=n&&(n.enterCallbacks[o]=n.enterCallbacks[o]||[]);return()=>new Promise((a,i)=>{const u=m=>{m===!1?i(createRouterError(4,{from:e,to:r})):m instanceof Error?i(m):isRouteLocation(m)?i(createRouterError(2,{from:r,to:m})):(s&&n.enterCallbacks[o]===s&&typeof m=="function"&&s.push(m),a())},d=t.call(n&&n.instances[o],r,e,u);let c=Promise.resolve(d);t.length<3&&(c=c.then(u)),c.catch(m=>i(m))})}function extractComponentsGuards(t,r,e,n){const o=[];for(const s of t)for(const a in s.components){let i=s.components[a];if(!(r!=="beforeRouteEnter"&&!s.instances[a]))if(isRouteComponent(i)){const d=(i.__vccOpts||i)[r];d&&o.push(guardToPromiseFn(d,e,n,s,a))}else{let u=i();o.push(()=>u.then(d=>{if(!d)return Promise.reject(new Error(`Couldn't resolve component "${a}" at "${s.path}"`));const c=isESModule(d)?d.default:d;s.components[a]=c;const v=(c.__vccOpts||c)[r];return v&&guardToPromiseFn(v,e,n,s,a)()}))}}return o}function isRouteComponent(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function useLink(t){const r=inject(routerKey),e=inject(routeLocationKey),n=computed(()=>r.resolve(unref(t.to))),o=computed(()=>{const{matched:u}=n.value,{length:d}=u,c=u[d-1],m=e.matched;if(!c||!m.length)return-1;const v=m.findIndex(isSameRouteRecord.bind(null,c));if(v>-1)return v;const g=getOriginalPath(u[d-2]);return d>1&&getOriginalPath(c)===g&&m[m.length-1].path!==g?m.findIndex(isSameRouteRecord.bind(null,u[d-2])):v}),s=computed(()=>o.value>-1&&includesParams(e.params,n.value.params)),a=computed(()=>o.value>-1&&o.value===e.matched.length-1&&isSameRouteLocationParams(e.params,n.value.params));function i(u={}){return guardEvent(u)?r[unref(t.replace)?"replace":"push"](unref(t.to)).catch(noop$2):Promise.resolve()}return{route:n,href:computed(()=>n.value.href),isActive:s,isExactActive:a,navigate:i}}const RouterLinkImpl=defineComponent({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink,setup(t,{slots:r}){const e=reactive(useLink(t)),{options:n}=inject(routerKey),o=computed(()=>({[getLinkClass(t.activeClass,n.linkActiveClass,"router-link-active")]:e.isActive,[getLinkClass(t.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:e.isExactActive}));return()=>{const s=r.default&&r.default(e);return t.custom?s:h("a",{"aria-current":e.isExactActive?t.ariaCurrentValue:null,href:e.href,onClick:e.navigate,class:o.value},s)}}}),RouterLink=RouterLinkImpl;function guardEvent(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const r=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(r))return}return t.preventDefault&&t.preventDefault(),!0}}function includesParams(t,r){for(const e in r){const n=r[e],o=t[e];if(typeof n=="string"){if(n!==o)return!1}else if(!isArray$3(o)||o.length!==n.length||n.some((s,a)=>s!==o[a]))return!1}return!0}function getOriginalPath(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const getLinkClass=(t,r,e)=>t??r??e,RouterViewImpl=defineComponent({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:r,slots:e}){const n=inject(routerViewLocationKey),o=computed(()=>t.route||n.value),s=inject(viewDepthKey,0),a=computed(()=>{let d=unref(s);const{matched:c}=o.value;let m;for(;(m=c[d])&&!m.components;)d++;return d}),i=computed(()=>o.value.matched[a.value]);provide(viewDepthKey,computed(()=>a.value+1)),provide(matchedRouteKey,i),provide(routerViewLocationKey,o);const u=ref();return watch(()=>[u.value,i.value,t.name],([d,c,m],[v,g,b])=>{c&&(c.instances[m]=d,g&&g!==c&&d&&d===v&&(c.leaveGuards.size||(c.leaveGuards=g.leaveGuards),c.updateGuards.size||(c.updateGuards=g.updateGuards))),d&&c&&(!g||!isSameRouteRecord(c,g)||!v)&&(c.enterCallbacks[m]||[]).forEach(T=>T(d))},{flush:"post"}),()=>{const d=o.value,c=t.name,m=i.value,v=m&&m.components[c];if(!v)return normalizeSlot(e.default,{Component:v,route:d});const g=m.props[c],b=g?g===!0?d.params:typeof g=="function"?g(d):g:null,k=h(v,assign({},b,r,{onVnodeUnmounted:y=>{y.component.isUnmounted&&(m.instances[c]=null)},ref:u}));return normalizeSlot(e.default,{Component:k,route:d})||k}}});function normalizeSlot(t,r){if(!t)return null;const e=t(r);return e.length===1?e[0]:e}const RouterView=RouterViewImpl;function createRouter(t){const r=createRouterMatcher(t.routes,t),e=t.parseQuery||parseQuery,n=t.stringifyQuery||stringifyQuery,o=t.history,s=useCallbacks(),a=useCallbacks(),i=useCallbacks(),u=shallowRef(START_LOCATION_NORMALIZED);let d=START_LOCATION_NORMALIZED;isBrowser&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=applyToParams.bind(null,Ue=>""+Ue),m=applyToParams.bind(null,encodeParam),v=applyToParams.bind(null,decode);function g(Ue,rr){let or,Pt;return isRouteName(Ue)?(or=r.getRecordMatcher(Ue),Pt=rr):Pt=Ue,r.addRoute(Pt,or)}function b(Ue){const rr=r.getRecordMatcher(Ue);rr&&r.removeRoute(rr)}function T(){return r.getRoutes().map(Ue=>Ue.record)}function k(Ue){return!!r.getRecordMatcher(Ue)}function y(Ue,rr){if(rr=assign({},rr||u.value),typeof Ue=="string"){const cr=parseURL(e,Ue,rr.path),mr=r.resolve({path:cr.path},rr),vr=o.createHref(cr.fullPath);return assign(cr,mr,{params:v(mr.params),hash:decode(cr.hash),redirectedFrom:void 0,href:vr})}let or;if("path"in Ue)or=assign({},Ue,{path:parseURL(e,Ue.path,rr.path).path});else{const cr=assign({},Ue.params);for(const mr in cr)cr[mr]==null&&delete cr[mr];or=assign({},Ue,{params:m(cr)}),rr.params=m(rr.params)}const Pt=r.resolve(or,rr),Et=Ue.hash||"";Pt.params=c(v(Pt.params));const kt=stringifyURL(n,assign({},Ue,{hash:encodeHash(Et),path:Pt.path})),er=o.createHref(kt);return assign({fullPath:kt,hash:Et,query:n===stringifyQuery?normalizeQuery(Ue.query):Ue.query||{}},Pt,{redirectedFrom:void 0,href:er})}function O(Ue){return typeof Ue=="string"?parseURL(e,Ue,u.value.path):assign({},Ue)}function D(Ue,rr){if(d!==Ue)return createRouterError(8,{from:rr,to:Ue})}function he(Ue){return ue(Ue)}function ae(Ue){return he(assign(O(Ue),{replace:!0}))}function Ne(Ue){const rr=Ue.matched[Ue.matched.length-1];if(rr&&rr.redirect){const{redirect:or}=rr;let Pt=typeof or=="function"?or(Ue):or;return typeof Pt=="string"&&(Pt=Pt.includes("?")||Pt.includes("#")?Pt=O(Pt):{path:Pt},Pt.params={}),assign({query:Ue.query,hash:Ue.hash,params:"path"in Pt?{}:Ue.params},Pt)}}function ue(Ue,rr){const or=d=y(Ue),Pt=u.value,Et=Ue.state,kt=Ue.force,er=Ue.replace===!0,cr=Ne(or);if(cr)return ue(assign(O(cr),{state:typeof cr=="object"?assign({},Et,cr.state):Et,force:kt,replace:er}),rr||or);const mr=or;mr.redirectedFrom=rr;let vr;return!kt&&isSameRouteLocation(n,Pt,or)&&(vr=createRouterError(16,{to:mr,from:Pt}),pr(Pt,Pt,!0,!1)),(vr?Promise.resolve(vr):Ce(mr,Pt)).catch(Tr=>isNavigationFailure(Tr)?isNavigationFailure(Tr,2)?Tr:dr(Tr):Lt(Tr,mr,Pt)).then(Tr=>{if(Tr){if(isNavigationFailure(Tr,2))return ue(assign({replace:er},O(Tr.to),{state:typeof Tr.to=="object"?assign({},Et,Tr.to.state):Et,force:kt}),rr||mr)}else Tr=ie(mr,Pt,!0,er,Et);return ze(mr,Pt,Tr),Tr})}function Y(Ue,rr){const or=D(Ue,rr);return or?Promise.reject(or):Promise.resolve()}function _e(Ue){const rr=Fe.values().next().value;return rr&&typeof rr.runWithContext=="function"?rr.runWithContext(Ue):Ue()}function Ce(Ue,rr){let or;const[Pt,Et,kt]=extractChangingRecords(Ue,rr);or=extractComponentsGuards(Pt.reverse(),"beforeRouteLeave",Ue,rr);for(const cr of Pt)cr.leaveGuards.forEach(mr=>{or.push(guardToPromiseFn(mr,Ue,rr))});const er=Y.bind(null,Ue,rr);return or.push(er),ir(or).then(()=>{or=[];for(const cr of s.list())or.push(guardToPromiseFn(cr,Ue,rr));return or.push(er),ir(or)}).then(()=>{or=extractComponentsGuards(Et,"beforeRouteUpdate",Ue,rr);for(const cr of Et)cr.updateGuards.forEach(mr=>{or.push(guardToPromiseFn(mr,Ue,rr))});return or.push(er),ir(or)}).then(()=>{or=[];for(const cr of kt)if(cr.beforeEnter)if(isArray$3(cr.beforeEnter))for(const mr of cr.beforeEnter)or.push(guardToPromiseFn(mr,Ue,rr));else or.push(guardToPromiseFn(cr.beforeEnter,Ue,rr));return or.push(er),ir(or)}).then(()=>(Ue.matched.forEach(cr=>cr.enterCallbacks={}),or=extractComponentsGuards(kt,"beforeRouteEnter",Ue,rr),or.push(er),ir(or))).then(()=>{or=[];for(const cr of a.list())or.push(guardToPromiseFn(cr,Ue,rr));return or.push(er),ir(or)}).catch(cr=>isNavigationFailure(cr,8)?cr:Promise.reject(cr))}function ze(Ue,rr,or){i.list().forEach(Pt=>_e(()=>Pt(Ue,rr,or)))}function ie(Ue,rr,or,Pt,Et){const kt=D(Ue,rr);if(kt)return kt;const er=rr===START_LOCATION_NORMALIZED,cr=isBrowser?history.state:{};or&&(Pt||er?o.replace(Ue.fullPath,assign({scroll:er&&cr&&cr.scroll},Et)):o.push(Ue.fullPath,Et)),u.value=Ue,pr(Ue,rr,or,er),dr()}let le;function Ie(){le||(le=o.listen((Ue,rr,or)=>{if(!nr.listening)return;const Pt=y(Ue),Et=Ne(Pt);if(Et){ue(assign(Et,{replace:!0}),Pt).catch(noop$2);return}d=Pt;const kt=u.value;isBrowser&&saveScrollPosition(getScrollKey(kt.fullPath,or.delta),computeScrollPosition()),Ce(Pt,kt).catch(er=>isNavigationFailure(er,12)?er:isNavigationFailure(er,2)?(ue(er.to,Pt).then(cr=>{isNavigationFailure(cr,20)&&!or.delta&&or.type===NavigationType.pop&&o.go(-1,!1)}).catch(noop$2),Promise.reject()):(or.delta&&o.go(-or.delta,!1),Lt(er,Pt,kt))).then(er=>{er=er||ie(Pt,kt,!1),er&&(or.delta&&!isNavigationFailure(er,8)?o.go(-or.delta,!1):or.type===NavigationType.pop&&isNavigationFailure(er,20)&&o.go(-1,!1)),ze(Pt,kt,er)}).catch(noop$2)}))}let pe=useCallbacks(),qe=useCallbacks(),$e;function Lt(Ue,rr,or){dr(Ue);const Pt=qe.list();return Pt.length?Pt.forEach(Et=>Et(Ue,rr,or)):console.error(Ue),Promise.reject(Ue)}function Dt(){return $e&&u.value!==START_LOCATION_NORMALIZED?Promise.resolve():new Promise((Ue,rr)=>{pe.add([Ue,rr])})}function dr(Ue){return $e||($e=!Ue,Ie(),pe.list().forEach(([rr,or])=>Ue?or(Ue):rr()),pe.reset()),Ue}function pr(Ue,rr,or,Pt){const{scrollBehavior:Et}=t;if(!isBrowser||!Et)return Promise.resolve();const kt=!or&&getSavedScrollPosition(getScrollKey(Ue.fullPath,0))||(Pt||!or)&&history.state&&history.state.scroll||null;return nextTick().then(()=>Et(Ue,rr,kt)).then(er=>er&&scrollToPosition(er)).catch(er=>Lt(er,Ue,rr))}const sr=Ue=>o.go(Ue);let hr;const Fe=new Set,nr={currentRoute:u,listening:!0,addRoute:g,removeRoute:b,hasRoute:k,getRoutes:T,resolve:y,options:t,push:he,replace:ae,go:sr,back:()=>sr(-1),forward:()=>sr(1),beforeEach:s.add,beforeResolve:a.add,afterEach:i.add,onError:qe.add,isReady:Dt,install(Ue){const rr=this;Ue.component("RouterLink",RouterLink),Ue.component("RouterView",RouterView),Ue.config.globalProperties.$router=rr,Object.defineProperty(Ue.config.globalProperties,"$route",{enumerable:!0,get:()=>unref(u)}),isBrowser&&!hr&&u.value===START_LOCATION_NORMALIZED&&(hr=!0,he(o.location).catch(Et=>{}));const or={};for(const Et in START_LOCATION_NORMALIZED)Object.defineProperty(or,Et,{get:()=>u.value[Et],enumerable:!0});Ue.provide(routerKey,rr),Ue.provide(routeLocationKey,shallowReactive(or)),Ue.provide(routerViewLocationKey,u);const Pt=Ue.unmount;Fe.add(Ue),Ue.unmount=function(){Fe.delete(Ue),Fe.size<1&&(d=START_LOCATION_NORMALIZED,le&&le(),le=null,u.value=START_LOCATION_NORMALIZED,hr=!1,$e=!1),Pt()}}};function ir(Ue){return Ue.reduce((rr,or)=>rr.then(()=>_e(or)),Promise.resolve())}return nr}function extractChangingRecords(t,r){const e=[],n=[],o=[],s=Math.max(r.matched.length,t.matched.length);for(let a=0;a<s;a++){const i=r.matched[a];i&&(t.matched.find(d=>isSameRouteRecord(d,i))?n.push(i):e.push(i));const u=t.matched[a];u&&(r.matched.find(d=>isSameRouteRecord(d,u))||o.push(u))}return[e,n,o]}function useRouter(){return inject(routerKey)}const FOCUSABLE_ELEMENT_SELECTORS='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',isVisible=t=>getComputedStyle(t).position==="fixed"?!1:t.offsetParent!==null,obtainAllFocusableElements$1=t=>Array.from(t.querySelectorAll(FOCUSABLE_ELEMENT_SELECTORS)).filter(r=>isFocusable(r)&&isVisible(r)),isFocusable=t=>{if(t.tabIndex>0||t.tabIndex===0&&t.getAttribute("tabIndex")!==null)return!0;if(t.disabled)return!1;switch(t.nodeName){case"A":return!!t.href&&t.rel!=="ignore";case"INPUT":return!(t.type==="hidden"||t.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},isLeaf=t=>!t.getAttribute("aria-owns"),getSibling=(t,r,e)=>{const{parentNode:n}=t;if(!n)return null;const o=n.querySelectorAll(e),s=Array.prototype.indexOf.call(o,t);return o[s+r]||null},focusNode=t=>{t&&(t.focus(),!isLeaf(t)&&t.click())},composeEventHandlers=(t,r,{checkForDefaultPrevented:e=!0}={})=>o=>{const s=t==null?void 0:t(o);if(e===!1||!s)return r==null?void 0:r(o)},whenMouse=t=>r=>r.pointerType==="mouse"?t(r):void 0;var _a;const isClient=typeof window<"u",isDef=t=>typeof t<"u",isFunction$2=t=>typeof t=="function",isString$1=t=>typeof t=="string",noop$1=()=>{},isIOS=isClient&&((_a=window==null?void 0:window.navigator)==null?void 0:_a.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function resolveUnref(t){return typeof t=="function"?t():unref(t)}function createFilterWrapper(t,r){function e(...n){return new Promise((o,s)=>{Promise.resolve(t(()=>r.apply(this,n),{fn:r,thisArg:this,args:n})).then(o).catch(s)})}return e}function debounceFilter(t,r={}){let e,n,o=noop$1;const s=i=>{clearTimeout(i),o(),o=noop$1};return i=>{const u=resolveUnref(t),d=resolveUnref(r.maxWait);return e&&s(e),u<=0||d!==void 0&&d<=0?(n&&(s(n),n=null),Promise.resolve(i())):new Promise((c,m)=>{o=r.rejectOnCancel?m:c,d&&!n&&(n=setTimeout(()=>{e&&s(e),n=null,c(i())},d)),e=setTimeout(()=>{n&&s(n),n=null,c(i())},u)})}}function throttleFilter(t,r=!0,e=!0,n=!1){let o=0,s,a=!0,i=noop$1,u;const d=()=>{s&&(clearTimeout(s),s=void 0,i(),i=noop$1)};return m=>{const v=resolveUnref(t),g=Date.now()-o,b=()=>u=m();return d(),v<=0?(o=Date.now(),b()):(g>v&&(e||!a)?(o=Date.now(),b()):r&&(u=new Promise((T,k)=>{i=n?k:T,s=setTimeout(()=>{o=Date.now(),a=!0,T(b()),d()},Math.max(0,v-g))})),!e&&!s&&(s=setTimeout(()=>a=!0,v)),a=!1,u)}}function identity$1(t){return t}function tryOnScopeDispose(t){return getCurrentScope()?(onScopeDispose(t),!0):!1}function useDebounceFn(t,r=200,e={}){return createFilterWrapper(debounceFilter(r,e),t)}function refDebounced(t,r=200,e={}){const n=ref(t.value),o=useDebounceFn(()=>{n.value=t.value},r,e);return watch(t,()=>o()),n}function useThrottleFn(t,r=200,e=!1,n=!0,o=!1){return createFilterWrapper(throttleFilter(r,e,n,o),t)}function tryOnMounted(t,r=!0){getCurrentInstance()?onMounted(t):r?t():nextTick(t)}function useTimeoutFn(t,r,e={}){const{immediate:n=!0}=e,o=ref(!1);let s=null;function a(){s&&(clearTimeout(s),s=null)}function i(){o.value=!1,a()}function u(...d){a(),o.value=!0,s=setTimeout(()=>{o.value=!1,s=null,t(...d)},resolveUnref(r))}return n&&(o.value=!0,isClient&&u()),tryOnScopeDispose(i),{isPending:readonly(o),start:u,stop:i}}function unrefElement(t){var r;const e=resolveUnref(t);return(r=e==null?void 0:e.$el)!=null?r:e}const defaultWindow=isClient?window:void 0;function useEventListener(...t){let r,e,n,o;if(isString$1(t[0])||Array.isArray(t[0])?([e,n,o]=t,r=defaultWindow):[r,e,n,o]=t,!r)return noop$1;Array.isArray(e)||(e=[e]),Array.isArray(n)||(n=[n]);const s=[],a=()=>{s.forEach(c=>c()),s.length=0},i=(c,m,v,g)=>(c.addEventListener(m,v,g),()=>c.removeEventListener(m,v,g)),u=watch(()=>[unrefElement(r),resolveUnref(o)],([c,m])=>{a(),c&&s.push(...e.flatMap(v=>n.map(g=>i(c,v,g,m))))},{immediate:!0,flush:"post"}),d=()=>{u(),a()};return tryOnScopeDispose(d),d}let _iOSWorkaround=!1;function onClickOutside(t,r,e={}){const{window:n=defaultWindow,ignore:o=[],capture:s=!0,detectIframe:a=!1}=e;if(!n)return;isIOS&&!_iOSWorkaround&&(_iOSWorkaround=!0,Array.from(n.document.body.children).forEach(v=>v.addEventListener("click",noop$1)));let i=!0;const u=v=>o.some(g=>{if(typeof g=="string")return Array.from(n.document.querySelectorAll(g)).some(b=>b===v.target||v.composedPath().includes(b));{const b=unrefElement(g);return b&&(v.target===b||v.composedPath().includes(b))}}),c=[useEventListener(n,"click",v=>{const g=unrefElement(t);if(!(!g||g===v.target||v.composedPath().includes(g))){if(v.detail===0&&(i=!u(v)),!i){i=!0;return}r(v)}},{passive:!0,capture:s}),useEventListener(n,"pointerdown",v=>{const g=unrefElement(t);g&&(i=!v.composedPath().includes(g)&&!u(v))},{passive:!0}),a&&useEventListener(n,"blur",v=>{var g;const b=unrefElement(t);((g=n.document.activeElement)==null?void 0:g.tagName)==="IFRAME"&&!(b!=null&&b.contains(n.document.activeElement))&&r(v)})].filter(Boolean);return()=>c.forEach(v=>v())}function useSupported(t,r=!1){const e=ref(),n=()=>e.value=!!t();return n(),tryOnMounted(n,r),e}function cloneFnJSON(t){return JSON.parse(JSON.stringify(t))}const _global$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},globalKey="__vueuse_ssr_handlers__";_global$1[globalKey]=_global$1[globalKey]||{};function useCssVar(t,r,{window:e=defaultWindow,initialValue:n=""}={}){const o=ref(n),s=computed(()=>{var a;return unrefElement(r)||((a=e==null?void 0:e.document)==null?void 0:a.documentElement)});return watch([s,()=>resolveUnref(t)],([a,i])=>{var u;if(a&&e){const d=(u=e.getComputedStyle(a).getPropertyValue(i))==null?void 0:u.trim();o.value=d||n}},{immediate:!0}),watch(o,a=>{var i;(i=s.value)!=null&&i.style&&s.value.style.setProperty(resolveUnref(t),a)}),o}var __getOwnPropSymbols$g=Object.getOwnPropertySymbols,__hasOwnProp$g=Object.prototype.hasOwnProperty,__propIsEnum$g=Object.prototype.propertyIsEnumerable,__objRest$2=(t,r)=>{var e={};for(var n in t)__hasOwnProp$g.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&__getOwnPropSymbols$g)for(var n of __getOwnPropSymbols$g(t))r.indexOf(n)<0&&__propIsEnum$g.call(t,n)&&(e[n]=t[n]);return e};function useResizeObserver(t,r,e={}){const n=e,{window:o=defaultWindow}=n,s=__objRest$2(n,["window"]);let a;const i=useSupported(()=>o&&"ResizeObserver"in o),u=()=>{a&&(a.disconnect(),a=void 0)},d=watch(()=>unrefElement(t),m=>{u(),i.value&&o&&m&&(a=new ResizeObserver(r),a.observe(m,s))},{immediate:!0,flush:"post"}),c=()=>{u(),d()};return tryOnScopeDispose(c),{isSupported:i,stop:c}}function useElementBounding(t,r={}){const{reset:e=!0,windowResize:n=!0,windowScroll:o=!0,immediate:s=!0}=r,a=ref(0),i=ref(0),u=ref(0),d=ref(0),c=ref(0),m=ref(0),v=ref(0),g=ref(0);function b(){const T=unrefElement(t);if(!T){e&&(a.value=0,i.value=0,u.value=0,d.value=0,c.value=0,m.value=0,v.value=0,g.value=0);return}const k=T.getBoundingClientRect();a.value=k.height,i.value=k.bottom,u.value=k.left,d.value=k.right,c.value=k.top,m.value=k.width,v.value=k.x,g.value=k.y}return useResizeObserver(t,b),watch(()=>unrefElement(t),T=>!T&&b()),o&&useEventListener("scroll",b,{capture:!0,passive:!0}),n&&useEventListener("resize",b,{passive:!0}),tryOnMounted(()=>{s&&b()}),{height:a,bottom:i,left:u,right:d,top:c,width:m,x:v,y:g,update:b}}var SwipeDirection;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(SwipeDirection||(SwipeDirection={}));var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(t,r,e)=>r in t?__defProp(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,__spreadValues=(t,r)=>{for(var e in r||(r={}))__hasOwnProp.call(r,e)&&__defNormalProp(t,e,r[e]);if(__getOwnPropSymbols)for(var e of __getOwnPropSymbols(r))__propIsEnum.call(r,e)&&__defNormalProp(t,e,r[e]);return t};const _TransitionPresets={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};__spreadValues({linear:identity$1},_TransitionPresets);function useVModel(t,r,e,n={}){var o,s,a;const{clone:i=!1,passive:u=!1,eventName:d,deep:c=!1,defaultValue:m}=n,v=getCurrentInstance(),g=e||(v==null?void 0:v.emit)||((o=v==null?void 0:v.$emit)==null?void 0:o.bind(v))||((a=(s=v==null?void 0:v.proxy)==null?void 0:s.$emit)==null?void 0:a.bind(v==null?void 0:v.proxy));let b=d;r||(r="modelValue"),b=d||b||`update:${r.toString()}`;const T=y=>i?isFunction$2(i)?i(y):cloneFnJSON(y):y,k=()=>isDef(t[r])?T(t[r]):m;if(u){const y=k(),O=ref(y);return watch(()=>t[r],D=>O.value=T(D)),watch(O,D=>{(D!==t[r]||c)&&g(b,D)},{deep:c}),O}else return computed({get(){return k()},set(y){g(b,y)}})}function useWindowSize(t={}){const{window:r=defaultWindow,initialWidth:e=1/0,initialHeight:n=1/0,listenOrientation:o=!0,includeScrollbar:s=!0}=t,a=ref(e),i=ref(n),u=()=>{r&&(s?(a.value=r.innerWidth,i.value=r.innerHeight):(a.value=r.document.documentElement.clientWidth,i.value=r.document.documentElement.clientHeight))};return u(),tryOnMounted(u),useEventListener("resize",u,{passive:!0}),o&&useEventListener("orientationchange",u,{passive:!0}),{width:a,height:i}}const isFirefox=()=>isClient&&/firefox/i.test(window.navigator.userAgent),isInContainer=(t,r)=>{if(!isClient||!t||!r)return!1;const e=t.getBoundingClientRect();let n;return r instanceof Element?n=r.getBoundingClientRect():n={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},e.top<n.bottom&&e.bottom>n.top&&e.right>n.left&&e.left<n.right};var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global;const freeGlobal$1=freeGlobal;var freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal$1||freeSelf||Function("return this")();const root$1=root;var Symbol$1=root$1.Symbol;const Symbol$2=Symbol$1;var objectProto$e=Object.prototype,hasOwnProperty$c=objectProto$e.hasOwnProperty,nativeObjectToString$1=objectProto$e.toString,symToStringTag$1=Symbol$2?Symbol$2.toStringTag:void 0;function getRawTag(t){var r=hasOwnProperty$c.call(t,symToStringTag$1),e=t[symToStringTag$1];try{t[symToStringTag$1]=void 0;var n=!0}catch{}var o=nativeObjectToString$1.call(t);return n&&(r?t[symToStringTag$1]=e:delete t[symToStringTag$1]),o}var objectProto$d=Object.prototype,nativeObjectToString=objectProto$d.toString;function objectToString(t){return nativeObjectToString.call(t)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$2?Symbol$2.toStringTag:void 0;function baseGetTag(t){return t==null?t===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(t)?getRawTag(t):objectToString(t)}function isObjectLike(t){return t!=null&&typeof t=="object"}var symbolTag$3="[object Symbol]";function isSymbol(t){return typeof t=="symbol"||isObjectLike(t)&&baseGetTag(t)==symbolTag$3}function arrayMap(t,r){for(var e=-1,n=t==null?0:t.length,o=Array(n);++e<n;)o[e]=r(t[e],e,t);return o}var isArray$1=Array.isArray;const isArray$2=isArray$1;var INFINITY$3=1/0,symbolProto$2=Symbol$2?Symbol$2.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(t){if(typeof t=="string")return t;if(isArray$2(t))return arrayMap(t,baseToString)+"";if(isSymbol(t))return symbolToString?symbolToString.call(t):"";var r=t+"";return r=="0"&&1/t==-INFINITY$3?"-0":r}var reWhitespace=/\s/;function trimmedEndIndex(t){for(var r=t.length;r--&&reWhitespace.test(t.charAt(r)););return r}var reTrimStart=/^\s+/;function baseTrim(t){return t&&t.slice(0,trimmedEndIndex(t)+1).replace(reTrimStart,"")}function isObject$1(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}var NAN=0/0,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(t){if(typeof t=="number")return t;if(isSymbol(t))return NAN;if(isObject$1(t)){var r=typeof t.valueOf=="function"?t.valueOf():t;t=isObject$1(r)?r+"":r}if(typeof t!="string")return t===0?t:+t;t=baseTrim(t);var e=reIsBinary.test(t);return e||reIsOctal.test(t)?freeParseInt(t.slice(2),e?2:8):reIsBadHex.test(t)?NAN:+t}var INFINITY$2=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(t){if(!t)return t===0?t:0;if(t=toNumber(t),t===INFINITY$2||t===-INFINITY$2){var r=t<0?-1:1;return r*MAX_INTEGER}return t===t?t:0}function toInteger(t){var r=toFinite(t),e=r%1;return r===r?e?r-e:r:0}function identity(t){return t}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$1(t){if(!isObject$1(t))return!1;var r=baseGetTag(t);return r==funcTag$2||r==genTag$1||r==asyncTag||r==proxyTag}var coreJsData=root$1["__core-js_shared__"];const coreJsData$1=coreJsData;var maskSrcKey=function(){var t=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function isMasked(t){return!!maskSrcKey&&maskSrcKey in t}var funcProto$1=Function.prototype,funcToString$1=funcProto$1.toString;function toSource(t){if(t!=null){try{return funcToString$1.call(t)}catch{}try{return t+""}catch{}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto$c=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$b=objectProto$c.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty$b).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(t){if(!isObject$1(t)||isMasked(t))return!1;var r=isFunction$1(t)?reIsNative:reIsHostCtor;return r.test(toSource(t))}function getValue$1(t,r){return t==null?void 0:t[r]}function getNative(t,r){var e=getValue$1(t,r);return baseIsNative(e)?e:void 0}var WeakMap$1=getNative(root$1,"WeakMap");const WeakMap$2=WeakMap$1;var objectCreate=Object.create,baseCreate=function(){function t(){}return function(r){if(!isObject$1(r))return{};if(objectCreate)return objectCreate(r);t.prototype=r;var e=new t;return t.prototype=void 0,e}}();const baseCreate$1=baseCreate;function apply(t,r,e){switch(e.length){case 0:return t.call(r);case 1:return t.call(r,e[0]);case 2:return t.call(r,e[0],e[1]);case 3:return t.call(r,e[0],e[1],e[2])}return t.apply(r,e)}function copyArray(t,r){var e=-1,n=t.length;for(r||(r=Array(n));++e<n;)r[e]=t[e];return r}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(t){var r=0,e=0;return function(){var n=nativeNow(),o=HOT_SPAN-(n-e);if(e=n,o>0){if(++r>=HOT_COUNT)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}function constant(t){return function(){return t}}var defineProperty=function(){try{var t=getNative(Object,"defineProperty");return t({},"",{}),t}catch{}}();const defineProperty$1=defineProperty;var baseSetToString=defineProperty$1?function(t,r){return defineProperty$1(t,"toString",{configurable:!0,enumerable:!1,value:constant(r),writable:!0})}:identity;const baseSetToString$1=baseSetToString;var setToString=shortOut(baseSetToString$1);const setToString$1=setToString;function arrayEach(t,r){for(var e=-1,n=t==null?0:t.length;++e<n&&r(t[e],e,t)!==!1;);return t}function baseFindIndex(t,r,e,n){for(var o=t.length,s=e+(n?1:-1);n?s--:++s<o;)if(r(t[s],s,t))return s;return-1}var MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(t,r){var e=typeof t;return r=r??MAX_SAFE_INTEGER$1,!!r&&(e=="number"||e!="symbol"&&reIsUint.test(t))&&t>-1&&t%1==0&&t<r}function baseAssignValue(t,r,e){r=="__proto__"&&defineProperty$1?defineProperty$1(t,r,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[r]=e}function eq(t,r){return t===r||t!==t&&r!==r}var objectProto$b=Object.prototype,hasOwnProperty$a=objectProto$b.hasOwnProperty;function assignValue(t,r,e){var n=t[r];(!(hasOwnProperty$a.call(t,r)&&eq(n,e))||e===void 0&&!(r in t))&&baseAssignValue(t,r,e)}function copyObject(t,r,e,n){var o=!e;e||(e={});for(var s=-1,a=r.length;++s<a;){var i=r[s],u=n?n(e[i],t[i],i,e,t):void 0;u===void 0&&(u=t[i]),o?baseAssignValue(e,i,u):assignValue(e,i,u)}return e}var nativeMax$2=Math.max;function overRest(t,r,e){return r=nativeMax$2(r===void 0?t.length-1:r,0),function(){for(var n=arguments,o=-1,s=nativeMax$2(n.length-r,0),a=Array(s);++o<s;)a[o]=n[r+o];o=-1;for(var i=Array(r+1);++o<r;)i[o]=n[o];return i[r]=e(a),apply(t,this,i)}}var MAX_SAFE_INTEGER=9007199254740991;function isLength(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=MAX_SAFE_INTEGER}function isArrayLike(t){return t!=null&&isLength(t.length)&&!isFunction$1(t)}var objectProto$a=Object.prototype;function isPrototype(t){var r=t&&t.constructor,e=typeof r=="function"&&r.prototype||objectProto$a;return t===e}function baseTimes(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n}var argsTag$3="[object Arguments]";function baseIsArguments(t){return isObjectLike(t)&&baseGetTag(t)==argsTag$3}var objectProto$9=Object.prototype,hasOwnProperty$9=objectProto$9.hasOwnProperty,propertyIsEnumerable$1=objectProto$9.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(t){return isObjectLike(t)&&hasOwnProperty$9.call(t,"callee")&&!propertyIsEnumerable$1.call(t,"callee")};const isArguments$1=isArguments;function stubFalse(){return!1}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$2=moduleExports$2?root$1.Buffer:void 0,nativeIsBuffer=Buffer$2?Buffer$2.isBuffer:void 0,isBuffer$1=nativeIsBuffer||stubFalse;const isBuffer$2=isBuffer$1;var argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$1="[object Function]",mapTag$5="[object Map]",numberTag$3="[object Number]",objectTag$3="[object Object]",regexpTag$3="[object RegExp]",setTag$5="[object Set]",stringTag$3="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0;typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$3]=typedArrayTags[boolTag$3]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$3]=typedArrayTags[errorTag$2]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$5]=typedArrayTags[numberTag$3]=typedArrayTags[objectTag$3]=typedArrayTags[regexpTag$3]=typedArrayTags[setTag$5]=typedArrayTags[stringTag$3]=typedArrayTags[weakMapTag$2]=!1;function baseIsTypedArray(t){return isObjectLike(t)&&isLength(t.length)&&!!typedArrayTags[baseGetTag(t)]}function baseUnary(t){return function(r){return t(r)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal$1.process,nodeUtil=function(){try{var t=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return t||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch{}}();const nodeUtil$1=nodeUtil;var nodeIsTypedArray=nodeUtil$1&&nodeUtil$1.isTypedArray,isTypedArray$1=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;const isTypedArray$2=isTypedArray$1;var objectProto$8=Object.prototype,hasOwnProperty$8=objectProto$8.hasOwnProperty;function arrayLikeKeys(t,r){var e=isArray$2(t),n=!e&&isArguments$1(t),o=!e&&!n&&isBuffer$2(t),s=!e&&!n&&!o&&isTypedArray$2(t),a=e||n||o||s,i=a?baseTimes(t.length,String):[],u=i.length;for(var d in t)(r||hasOwnProperty$8.call(t,d))&&!(a&&(d=="length"||o&&(d=="offset"||d=="parent")||s&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||isIndex(d,u)))&&i.push(d);return i}function overArg(t,r){return function(e){return t(r(e))}}var nativeKeys=overArg(Object.keys,Object);const nativeKeys$1=nativeKeys;var objectProto$7=Object.prototype,hasOwnProperty$7=objectProto$7.hasOwnProperty;function baseKeys(t){if(!isPrototype(t))return nativeKeys$1(t);var r=[];for(var e in Object(t))hasOwnProperty$7.call(t,e)&&e!="constructor"&&r.push(e);return r}function keys(t){return isArrayLike(t)?arrayLikeKeys(t):baseKeys(t)}function nativeKeysIn(t){var r=[];if(t!=null)for(var e in Object(t))r.push(e);return r}var objectProto$6=Object.prototype,hasOwnProperty$6=objectProto$6.hasOwnProperty;function baseKeysIn(t){if(!isObject$1(t))return nativeKeysIn(t);var r=isPrototype(t),e=[];for(var n in t)n=="constructor"&&(r||!hasOwnProperty$6.call(t,n))||e.push(n);return e}function keysIn(t){return isArrayLike(t)?arrayLikeKeys(t,!0):baseKeysIn(t)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(t,r){if(isArray$2(t))return!1;var e=typeof t;return e=="number"||e=="symbol"||e=="boolean"||t==null||isSymbol(t)?!0:reIsPlainProp.test(t)||!reIsDeepProp.test(t)||r!=null&&t in Object(r)}var nativeCreate=getNative(Object,"create");const nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$5=Object.prototype,hasOwnProperty$5=objectProto$5.hasOwnProperty;function hashGet(t){var r=this.__data__;if(nativeCreate$1){var e=r[t];return e===HASH_UNDEFINED$2?void 0:e}return hasOwnProperty$5.call(r,t)?r[t]:void 0}var objectProto$4=Object.prototype,hasOwnProperty$4=objectProto$4.hasOwnProperty;function hashHas(t){var r=this.__data__;return nativeCreate$1?r[t]!==void 0:hasOwnProperty$4.call(r,t)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=nativeCreate$1&&r===void 0?HASH_UNDEFINED$1:r,this}function Hash(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Hash.prototype.clear=hashClear;Hash.prototype.delete=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(t,r){for(var e=t.length;e--;)if(eq(t[e][0],r))return e;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(t){var r=this.__data__,e=assocIndexOf(r,t);if(e<0)return!1;var n=r.length-1;return e==n?r.pop():splice.call(r,e,1),--this.size,!0}function listCacheGet(t){var r=this.__data__,e=assocIndexOf(r,t);return e<0?void 0:r[e][1]}function listCacheHas(t){return assocIndexOf(this.__data__,t)>-1}function listCacheSet(t,r){var e=this.__data__,n=assocIndexOf(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this}function ListCache(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype.delete=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative(root$1,"Map");const Map$2=Map$1;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$2||ListCache),string:new Hash}}function isKeyable(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}function getMapData(t,r){var e=t.__data__;return isKeyable(r)?e[typeof r=="string"?"string":"hash"]:e.map}function mapCacheDelete(t){var r=getMapData(this,t).delete(t);return this.size-=r?1:0,r}function mapCacheGet(t){return getMapData(this,t).get(t)}function mapCacheHas(t){return getMapData(this,t).has(t)}function mapCacheSet(t,r){var e=getMapData(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this}function MapCache(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype.delete=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT$2="Expected a function";function memoize(t,r){if(typeof t!="function"||r!=null&&typeof r!="function")throw new TypeError(FUNC_ERROR_TEXT$2);var e=function(){var n=arguments,o=r?r.apply(this,n):n[0],s=e.cache;if(s.has(o))return s.get(o);var a=t.apply(this,n);return e.cache=s.set(o,a)||s,a};return e.cache=new(memoize.Cache||MapCache),e}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(t){var r=memoize(t,function(n){return e.size===MAX_MEMOIZE_SIZE&&e.clear(),n}),e=r.cache;return r}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(t){var r=[];return t.charCodeAt(0)===46&&r.push(""),t.replace(rePropName,function(e,n,o,s){r.push(o?s.replace(reEscapeChar,"$1"):n||e)}),r});const stringToPath$1=stringToPath;function toString$1(t){return t==null?"":baseToString(t)}function castPath(t,r){return isArray$2(t)?t:isKey(t,r)?[t]:stringToPath$1(toString$1(t))}var INFINITY$1=1/0;function toKey(t){if(typeof t=="string"||isSymbol(t))return t;var r=t+"";return r=="0"&&1/t==-INFINITY$1?"-0":r}function baseGet(t,r){r=castPath(r,t);for(var e=0,n=r.length;t!=null&&e<n;)t=t[toKey(r[e++])];return e&&e==n?t:void 0}function get(t,r,e){var n=t==null?void 0:baseGet(t,r);return n===void 0?e:n}function arrayPush(t,r){for(var e=-1,n=r.length,o=t.length;++e<n;)t[o+e]=r[e];return t}var spreadableSymbol=Symbol$2?Symbol$2.isConcatSpreadable:void 0;function isFlattenable(t){return isArray$2(t)||isArguments$1(t)||!!(spreadableSymbol&&t&&t[spreadableSymbol])}function baseFlatten(t,r,e,n,o){var s=-1,a=t.length;for(e||(e=isFlattenable),o||(o=[]);++s<a;){var i=t[s];r>0&&e(i)?r>1?baseFlatten(i,r-1,e,n,o):arrayPush(o,i):n||(o[o.length]=i)}return o}function flatten(t){var r=t==null?0:t.length;return r?baseFlatten(t,1):[]}function flatRest(t){return setToString$1(overRest(t,void 0,flatten),t+"")}var getPrototype=overArg(Object.getPrototypeOf,Object);const getPrototype$1=getPrototype;function castArray$1(){if(!arguments.length)return[];var t=arguments[0];return isArray$2(t)?t:[t]}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(t){var r=this.__data__,e=r.delete(t);return this.size=r.size,e}function stackGet(t){return this.__data__.get(t)}function stackHas(t){return this.__data__.has(t)}var LARGE_ARRAY_SIZE=200;function stackSet(t,r){var e=this.__data__;if(e instanceof ListCache){var n=e.__data__;if(!Map$2||n.length<LARGE_ARRAY_SIZE-1)return n.push([t,r]),this.size=++e.size,this;e=this.__data__=new MapCache(n)}return e.set(t,r),this.size=e.size,this}function Stack(t){var r=this.__data__=new ListCache(t);this.size=r.size}Stack.prototype.clear=stackClear;Stack.prototype.delete=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;function baseAssign(t,r){return t&&copyObject(r,keys(r),t)}function baseAssignIn(t,r){return t&&copyObject(r,keysIn(r),t)}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer$1=moduleExports?root$1.Buffer:void 0,allocUnsafe=Buffer$1?Buffer$1.allocUnsafe:void 0;function cloneBuffer(t,r){if(r)return t.slice();var e=t.length,n=allocUnsafe?allocUnsafe(e):new t.constructor(e);return t.copy(n),n}function arrayFilter(t,r){for(var e=-1,n=t==null?0:t.length,o=0,s=[];++e<n;){var a=t[e];r(a,e,t)&&(s[o++]=a)}return s}function stubArray(){return[]}var objectProto$3=Object.prototype,propertyIsEnumerable=objectProto$3.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(t){return t==null?[]:(t=Object(t),arrayFilter(nativeGetSymbols$1(t),function(r){return propertyIsEnumerable.call(t,r)}))}:stubArray;const getSymbols$1=getSymbols;function copySymbols(t,r){return copyObject(t,getSymbols$1(t),r)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(t){for(var r=[];t;)arrayPush(r,getSymbols$1(t)),t=getPrototype$1(t);return r}:stubArray;const getSymbolsIn$1=getSymbolsIn;function copySymbolsIn(t,r){return copyObject(t,getSymbolsIn$1(t),r)}function baseGetAllKeys(t,r,e){var n=r(t);return isArray$2(t)?n:arrayPush(n,e(t))}function getAllKeys(t){return baseGetAllKeys(t,keys,getSymbols$1)}function getAllKeysIn(t){return baseGetAllKeys(t,keysIn,getSymbolsIn$1)}var DataView=getNative(root$1,"DataView");const DataView$1=DataView;var Promise$1=getNative(root$1,"Promise");const Promise$2=Promise$1;var Set$1=getNative(root$1,"Set");const Set$2=Set$1;var mapTag$4="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$4="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$3="[object DataView]",dataViewCtorString=toSource(DataView$1),mapCtorString=toSource(Map$2),promiseCtorString=toSource(Promise$2),setCtorString=toSource(Set$2),weakMapCtorString=toSource(WeakMap$2),getTag=baseGetTag;(DataView$1&&getTag(new DataView$1(new ArrayBuffer(1)))!=dataViewTag$3||Map$2&&getTag(new Map$2)!=mapTag$4||Promise$2&&getTag(Promise$2.resolve())!=promiseTag||Set$2&&getTag(new Set$2)!=setTag$4||WeakMap$2&&getTag(new WeakMap$2)!=weakMapTag$1)&&(getTag=function(t){var r=baseGetTag(t),e=r==objectTag$2?t.constructor:void 0,n=e?toSource(e):"";if(n)switch(n){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$4;case promiseCtorString:return promiseTag;case setCtorString:return setTag$4;case weakMapCtorString:return weakMapTag$1}return r});const getTag$1=getTag;var objectProto$2=Object.prototype,hasOwnProperty$3=objectProto$2.hasOwnProperty;function initCloneArray(t){var r=t.length,e=new t.constructor(r);return r&&typeof t[0]=="string"&&hasOwnProperty$3.call(t,"index")&&(e.index=t.index,e.input=t.input),e}var Uint8Array$1=root$1.Uint8Array;const Uint8Array$2=Uint8Array$1;function cloneArrayBuffer(t){var r=new t.constructor(t.byteLength);return new Uint8Array$2(r).set(new Uint8Array$2(t)),r}function cloneDataView(t,r){var e=r?cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}var reFlags=/\w*$/;function cloneRegExp(t){var r=new t.constructor(t.source,reFlags.exec(t));return r.lastIndex=t.lastIndex,r}var symbolProto$1=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(t){return symbolValueOf$1?Object(symbolValueOf$1.call(t)):{}}function cloneTypedArray(t,r){var e=r?cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}var boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$3="[object Map]",numberTag$2="[object Number]",regexpTag$2="[object RegExp]",setTag$3="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(t,r,e){var n=t.constructor;switch(r){case arrayBufferTag$2:return cloneArrayBuffer(t);case boolTag$2:case dateTag$2:return new n(+t);case dataViewTag$2:return cloneDataView(t,e);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(t,e);case mapTag$3:return new n;case numberTag$2:case stringTag$2:return new n(t);case regexpTag$2:return cloneRegExp(t);case setTag$3:return new n;case symbolTag$2:return cloneSymbol(t)}}function initCloneObject(t){return typeof t.constructor=="function"&&!isPrototype(t)?baseCreate$1(getPrototype$1(t)):{}}var mapTag$2="[object Map]";function baseIsMap(t){return isObjectLike(t)&&getTag$1(t)==mapTag$2}var nodeIsMap=nodeUtil$1&&nodeUtil$1.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap;const isMap$1=isMap;var setTag$2="[object Set]";function baseIsSet(t){return isObjectLike(t)&&getTag$1(t)==setTag$2}var nodeIsSet=nodeUtil$1&&nodeUtil$1.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet;const isSet$1=isSet;var CLONE_DEEP_FLAG$1=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$2=4,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$1="[object Map]",numberTag$1="[object Number]",objectTag$1="[object Object]",regexpTag$1="[object RegExp]",setTag$1="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$1]=cloneableTags[numberTag$1]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$1]=cloneableTags[setTag$1]=cloneableTags[stringTag$1]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0;cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;function baseClone(t,r,e,n,o,s){var a,i=r&CLONE_DEEP_FLAG$1,u=r&CLONE_FLAT_FLAG,d=r&CLONE_SYMBOLS_FLAG$2;if(e&&(a=o?e(t,n,o,s):e(t)),a!==void 0)return a;if(!isObject$1(t))return t;var c=isArray$2(t);if(c){if(a=initCloneArray(t),!i)return copyArray(t,a)}else{var m=getTag$1(t),v=m==funcTag||m==genTag;if(isBuffer$2(t))return cloneBuffer(t,i);if(m==objectTag$1||m==argsTag$1||v&&!o){if(a=u||v?{}:initCloneObject(t),!i)return u?copySymbolsIn(t,baseAssignIn(a,t)):copySymbols(t,baseAssign(a,t))}else{if(!cloneableTags[m])return o?t:{};a=initCloneByTag(t,m,i)}}s||(s=new Stack);var g=s.get(t);if(g)return g;s.set(t,a),isSet$1(t)?t.forEach(function(k){a.add(baseClone(k,r,e,k,t,s))}):isMap$1(t)&&t.forEach(function(k,y){a.set(y,baseClone(k,r,e,y,t,s))});var b=d?u?getAllKeysIn:getAllKeys:u?keysIn:keys,T=c?void 0:b(t);return arrayEach(T||t,function(k,y){T&&(y=k,k=t[y]),assignValue(a,y,baseClone(k,r,e,y,t,s))}),a}var CLONE_SYMBOLS_FLAG$1=4;function clone(t){return baseClone(t,CLONE_SYMBOLS_FLAG$1)}var CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG=4;function cloneDeep(t){return baseClone(t,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG)}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(t){return this.__data__.set(t,HASH_UNDEFINED),this}function setCacheHas(t){return this.__data__.has(t)}function SetCache(t){var r=-1,e=t==null?0:t.length;for(this.__data__=new MapCache;++r<e;)this.add(t[r])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function arraySome(t,r){for(var e=-1,n=t==null?0:t.length;++e<n;)if(r(t[e],e,t))return!0;return!1}function cacheHas(t,r){return t.has(r)}var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(t,r,e,n,o,s){var a=e&COMPARE_PARTIAL_FLAG$5,i=t.length,u=r.length;if(i!=u&&!(a&&u>i))return!1;var d=s.get(t),c=s.get(r);if(d&&c)return d==r&&c==t;var m=-1,v=!0,g=e&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(s.set(t,r),s.set(r,t);++m<i;){var b=t[m],T=r[m];if(n)var k=a?n(T,b,m,r,t,s):n(b,T,m,t,r,s);if(k!==void 0){if(k)continue;v=!1;break}if(g){if(!arraySome(r,function(y,O){if(!cacheHas(g,O)&&(b===y||o(b,y,e,n,s)))return g.push(O)})){v=!1;break}}else if(!(b===T||o(b,T,e,n,s))){v=!1;break}}return s.delete(t),s.delete(r),v}function mapToArray(t){var r=-1,e=Array(t.size);return t.forEach(function(n,o){e[++r]=[o,n]}),e}function setToArray(t){var r=-1,e=Array(t.size);return t.forEach(function(n){e[++r]=n}),e}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(t,r,e,n,o,s,a){switch(e){case dataViewTag:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case arrayBufferTag:return!(t.byteLength!=r.byteLength||!s(new Uint8Array$2(t),new Uint8Array$2(r)));case boolTag:case dateTag:case numberTag:return eq(+t,+r);case errorTag:return t.name==r.name&&t.message==r.message;case regexpTag:case stringTag:return t==r+"";case mapTag:var i=mapToArray;case setTag:var u=n&COMPARE_PARTIAL_FLAG$4;if(i||(i=setToArray),t.size!=r.size&&!u)return!1;var d=a.get(t);if(d)return d==r;n|=COMPARE_UNORDERED_FLAG$2,a.set(t,r);var c=equalArrays(i(t),i(r),n,o,s,a);return a.delete(t),c;case symbolTag:if(symbolValueOf)return symbolValueOf.call(t)==symbolValueOf.call(r)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$1=Object.prototype,hasOwnProperty$2=objectProto$1.hasOwnProperty;function equalObjects(t,r,e,n,o,s){var a=e&COMPARE_PARTIAL_FLAG$3,i=getAllKeys(t),u=i.length,d=getAllKeys(r),c=d.length;if(u!=c&&!a)return!1;for(var m=u;m--;){var v=i[m];if(!(a?v in r:hasOwnProperty$2.call(r,v)))return!1}var g=s.get(t),b=s.get(r);if(g&&b)return g==r&&b==t;var T=!0;s.set(t,r),s.set(r,t);for(var k=a;++m<u;){v=i[m];var y=t[v],O=r[v];if(n)var D=a?n(O,y,v,r,t,s):n(y,O,v,t,r,s);if(!(D===void 0?y===O||o(y,O,e,n,s):D)){T=!1;break}k||(k=v=="constructor")}if(T&&!k){var he=t.constructor,ae=r.constructor;he!=ae&&"constructor"in t&&"constructor"in r&&!(typeof he=="function"&&he instanceof he&&typeof ae=="function"&&ae instanceof ae)&&(T=!1)}return s.delete(t),s.delete(r),T}var COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto=Object.prototype,hasOwnProperty$1=objectProto.hasOwnProperty;function baseIsEqualDeep(t,r,e,n,o,s){var a=isArray$2(t),i=isArray$2(r),u=a?arrayTag:getTag$1(t),d=i?arrayTag:getTag$1(r);u=u==argsTag?objectTag:u,d=d==argsTag?objectTag:d;var c=u==objectTag,m=d==objectTag,v=u==d;if(v&&isBuffer$2(t)){if(!isBuffer$2(r))return!1;a=!0,c=!1}if(v&&!c)return s||(s=new Stack),a||isTypedArray$2(t)?equalArrays(t,r,e,n,o,s):equalByTag(t,r,u,e,n,o,s);if(!(e&COMPARE_PARTIAL_FLAG$2)){var g=c&&hasOwnProperty$1.call(t,"__wrapped__"),b=m&&hasOwnProperty$1.call(r,"__wrapped__");if(g||b){var T=g?t.value():t,k=b?r.value():r;return s||(s=new Stack),o(T,k,e,n,s)}}return v?(s||(s=new Stack),equalObjects(t,r,e,n,o,s)):!1}function baseIsEqual(t,r,e,n,o){return t===r?!0:t==null||r==null||!isObjectLike(t)&&!isObjectLike(r)?t!==t&&r!==r:baseIsEqualDeep(t,r,e,n,baseIsEqual,o)}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(t,r,e,n){var o=e.length,s=o,a=!n;if(t==null)return!s;for(t=Object(t);o--;){var i=e[o];if(a&&i[2]?i[1]!==t[i[0]]:!(i[0]in t))return!1}for(;++o<s;){i=e[o];var u=i[0],d=t[u],c=i[1];if(a&&i[2]){if(d===void 0&&!(u in t))return!1}else{var m=new Stack;if(n)var v=n(d,c,u,t,r,m);if(!(v===void 0?baseIsEqual(c,d,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,n,m):v))return!1}}return!0}function isStrictComparable(t){return t===t&&!isObject$1(t)}function getMatchData(t){for(var r=keys(t),e=r.length;e--;){var n=r[e],o=t[n];r[e]=[n,o,isStrictComparable(o)]}return r}function matchesStrictComparable(t,r){return function(e){return e==null?!1:e[t]===r&&(r!==void 0||t in Object(e))}}function baseMatches(t){var r=getMatchData(t);return r.length==1&&r[0][2]?matchesStrictComparable(r[0][0],r[0][1]):function(e){return e===t||baseIsMatch(e,t,r)}}function baseHasIn(t,r){return t!=null&&r in Object(t)}function hasPath(t,r,e){r=castPath(r,t);for(var n=-1,o=r.length,s=!1;++n<o;){var a=toKey(r[n]);if(!(s=t!=null&&e(t,a)))break;t=t[a]}return s||++n!=o?s:(o=t==null?0:t.length,!!o&&isLength(o)&&isIndex(a,o)&&(isArray$2(t)||isArguments$1(t)))}function hasIn(t,r){return t!=null&&hasPath(t,r,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(t,r){return isKey(t)&&isStrictComparable(r)?matchesStrictComparable(toKey(t),r):function(e){var n=get(e,t);return n===void 0&&n===r?hasIn(e,t):baseIsEqual(r,n,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(t){return function(r){return r==null?void 0:r[t]}}function basePropertyDeep(t){return function(r){return baseGet(r,t)}}function property(t){return isKey(t)?baseProperty(toKey(t)):basePropertyDeep(t)}function baseIteratee(t){return typeof t=="function"?t:t==null?identity:typeof t=="object"?isArray$2(t)?baseMatchesProperty(t[0],t[1]):baseMatches(t):property(t)}var now=function(){return root$1.Date.now()};const now$1=now;var FUNC_ERROR_TEXT$1="Expected a function",nativeMax$1=Math.max,nativeMin$1=Math.min;function debounce(t,r,e){var n,o,s,a,i,u,d=0,c=!1,m=!1,v=!0;if(typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT$1);r=toNumber(r)||0,isObject$1(e)&&(c=!!e.leading,m="maxWait"in e,s=m?nativeMax$1(toNumber(e.maxWait)||0,r):s,v="trailing"in e?!!e.trailing:v);function g(Ne){var ue=n,Y=o;return n=o=void 0,d=Ne,a=t.apply(Y,ue),a}function b(Ne){return d=Ne,i=setTimeout(y,r),c?g(Ne):a}function T(Ne){var ue=Ne-u,Y=Ne-d,_e=r-ue;return m?nativeMin$1(_e,s-Y):_e}function k(Ne){var ue=Ne-u,Y=Ne-d;return u===void 0||ue>=r||ue<0||m&&Y>=s}function y(){var Ne=now$1();if(k(Ne))return O(Ne);i=setTimeout(y,T(Ne))}function O(Ne){return i=void 0,v&&n?g(Ne):(n=o=void 0,a)}function D(){i!==void 0&&clearTimeout(i),d=0,n=u=o=i=void 0}function he(){return i===void 0?a:O(now$1())}function ae(){var Ne=now$1(),ue=k(Ne);if(n=arguments,o=this,u=Ne,ue){if(i===void 0)return b(u);if(m)return clearTimeout(i),i=setTimeout(y,r),g(u)}return i===void 0&&(i=setTimeout(y,r)),a}return ae.cancel=D,ae.flush=he,ae}var nativeMax=Math.max,nativeMin=Math.min;function findLastIndex(t,r,e){var n=t==null?0:t.length;if(!n)return-1;var o=n-1;return e!==void 0&&(o=toInteger(e),o=e<0?nativeMax(n+o,0):nativeMin(o,n-1)),baseFindIndex(t,baseIteratee(r),o,!0)}var INFINITY=1/0;function flattenDeep(t){var r=t==null?0:t.length;return r?baseFlatten(t,INFINITY):[]}function fromPairs(t){for(var r=-1,e=t==null?0:t.length,n={};++r<e;){var o=t[r];n[o[0]]=o[1]}return n}function isEqual(t,r){return baseIsEqual(t,r)}function isNil(t){return t==null}function isUndefined$2(t){return t===void 0}function baseSet(t,r,e,n){if(!isObject$1(t))return t;r=castPath(r,t);for(var o=-1,s=r.length,a=s-1,i=t;i!=null&&++o<s;){var u=toKey(r[o]),d=e;if(u==="__proto__"||u==="constructor"||u==="prototype")return t;if(o!=a){var c=i[u];d=n?n(c,u,i):void 0,d===void 0&&(d=isObject$1(c)?c:isIndex(r[o+1])?[]:{})}assignValue(i,u,d),i=i[u]}return t}function basePickBy(t,r,e){for(var n=-1,o=r.length,s={};++n<o;){var a=r[n],i=baseGet(t,a);e(i,a)&&baseSet(s,castPath(a,t),i)}return s}function basePick(t,r){return basePickBy(t,r,function(e,n){return hasIn(t,n)})}var pick=flatRest(function(t,r){return t==null?{}:basePick(t,r)});const pick$1=pick;function set(t,r,e){return t==null?t:baseSet(t,r,e)}var FUNC_ERROR_TEXT="Expected a function";function throttle(t,r,e){var n=!0,o=!0;if(typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT);return isObject$1(e)&&(n="leading"in e?!!e.leading:n,o="trailing"in e?!!e.trailing:o),debounce(t,r,{leading:n,maxWait:r,trailing:o})}const isUndefined$1=t=>t===void 0,isBoolean$1=t=>typeof t=="boolean",isNumber$1=t=>typeof t=="number",isEmpty=t=>!t&&t!==0||isArray$4(t)&&t.length===0||isObject$2(t)&&!Object.keys(t).length,isElement=t=>typeof Element>"u"?!1:t instanceof Element,isStringNumber=t=>isString$2(t)?!Number.isNaN(Number(t)):!1,escapeStringRegexp=(t="")=>t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),capitalize=t=>capitalize$1(t),keysOf=t=>Object.keys(t),entriesOf=t=>Object.entries(t),getProp=(t,r,e)=>({get value(){return get(t,r,e)},set value(n){set(t,r,n)}});class ElementPlusError extends Error{constructor(r){super(r),this.name="ElementPlusError"}}function throwError(t,r){throw new ElementPlusError(`[${t}] ${r}`)}function debugWarn(t,r){}const classNameToArray=(t="")=>t.split(" ").filter(r=>!!r.trim()),hasClass=(t,r)=>{if(!t||!r)return!1;if(r.includes(" "))throw new Error("className should not contain space.");return t.classList.contains(r)},addClass=(t,r)=>{!t||!r.trim()||t.classList.add(...classNameToArray(r))},removeClass=(t,r)=>{!t||!r.trim()||t.classList.remove(...classNameToArray(r))},getStyle=(t,r)=>{var e;if(!isClient||!t||!r)return"";let n=camelize(r);n==="float"&&(n="cssFloat");try{const o=t.style[n];if(o)return o;const s=(e=document.defaultView)==null?void 0:e.getComputedStyle(t,"");return s?s[n]:""}catch{return t.style[n]}};function addUnit(t,r="px"){if(!t)return"";if(isNumber$1(t)||isStringNumber(t))return`${t}${r}`;if(isString$2(t))return t}const isScroll=(t,r)=>{if(!isClient)return!1;const e={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(r)],n=getStyle(t,e);return["scroll","auto","overlay"].some(o=>n.includes(o))},getScrollContainer=(t,r)=>{if(!isClient)return;let e=t;for(;e;){if([window,document,document.documentElement].includes(e))return window;if(isScroll(e,r))return e;e=e.parentNode}return e};let scrollBarWidth;const getScrollBarWidth=t=>{var r;if(!isClient)return 0;if(scrollBarWidth!==void 0)return scrollBarWidth;const e=document.createElement("div");e.className=`${t}-scrollbar__wrap`,e.style.visibility="hidden",e.style.width="100px",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);const n=e.offsetWidth;e.style.overflow="scroll";const o=document.createElement("div");o.style.width="100%",e.appendChild(o);const s=o.offsetWidth;return(r=e.parentNode)==null||r.removeChild(e),scrollBarWidth=n-s,scrollBarWidth};function scrollIntoView(t,r){if(!isClient)return;if(!r){t.scrollTop=0;return}const e=[];let n=r.offsetParent;for(;n!==null&&t!==n&&t.contains(n);)e.push(n),n=n.offsetParent;const o=r.offsetTop+e.reduce((u,d)=>u+d.offsetTop,0),s=o+r.offsetHeight,a=t.scrollTop,i=a+t.clientHeight;o<a?t.scrollTop=o:s>i&&(t.scrollTop=s-t.clientHeight)}/*! Element Plus Icons Vue v2.1.0 */var export_helper_default=(t,r)=>{let e=t.__vccOpts||t;for(let[n,o]of r)e[n]=o;return e},arrow_down_bold_vue_vue_type_script_lang_default={name:"ArrowDownBold"},_hoisted_15$1={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_25=createBaseVNode("path",{fill:"currentColor",d:"M104.704 338.752a64 64 0 0 1 90.496 0l316.8 316.8 316.8-316.8a64 64 0 0 1 90.496 90.496L557.248 791.296a64 64 0 0 1-90.496 0L104.704 429.248a64 64 0 0 1 0-90.496z"},null,-1),_hoisted_35=[_hoisted_25];function _sfc_render5(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_15$1,_hoisted_35)}var arrow_down_bold_default=export_helper_default(arrow_down_bold_vue_vue_type_script_lang_default,[["render",_sfc_render5],["__file","arrow-down-bold.vue"]]),arrow_down_vue_vue_type_script_lang_default={name:"ArrowDown"},_hoisted_16$1={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_26=createBaseVNode("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"},null,-1),_hoisted_36=[_hoisted_26];function _sfc_render6(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_16$1,_hoisted_36)}var arrow_down_default=export_helper_default(arrow_down_vue_vue_type_script_lang_default,[["render",_sfc_render6],["__file","arrow-down.vue"]]),arrow_left_vue_vue_type_script_lang_default={name:"ArrowLeft"},_hoisted_18$1={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_28=createBaseVNode("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"},null,-1),_hoisted_38=[_hoisted_28];function _sfc_render8(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_18$1,_hoisted_38)}var arrow_left_default=export_helper_default(arrow_left_vue_vue_type_script_lang_default,[["render",_sfc_render8],["__file","arrow-left.vue"]]),arrow_right_vue_vue_type_script_lang_default={name:"ArrowRight"},_hoisted_110={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_210=createBaseVNode("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"},null,-1),_hoisted_310=[_hoisted_210];function _sfc_render10(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_110,_hoisted_310)}var arrow_right_default=export_helper_default(arrow_right_vue_vue_type_script_lang_default,[["render",_sfc_render10],["__file","arrow-right.vue"]]),caret_top_vue_vue_type_script_lang_default={name:"CaretTop"},_hoisted_135={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_235=createBaseVNode("path",{fill:"currentColor",d:"M512 320 192 704h639.936z"},null,-1),_hoisted_334=[_hoisted_235];function _sfc_render35(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_135,_hoisted_334)}var caret_top_default=export_helper_default(caret_top_vue_vue_type_script_lang_default,[["render",_sfc_render35],["__file","caret-top.vue"]]),check_vue_vue_type_script_lang_default={name:"Check"},_hoisted_143={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_243=createBaseVNode("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"},null,-1),_hoisted_342=[_hoisted_243];function _sfc_render43(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_143,_hoisted_342)}var check_default=export_helper_default(check_vue_vue_type_script_lang_default,[["render",_sfc_render43],["__file","check.vue"]]),circle_check_vue_vue_type_script_lang_default={name:"CircleCheck"},_hoisted_149={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_249=createBaseVNode("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),_hoisted_348=createBaseVNode("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"},null,-1),_hoisted_415=[_hoisted_249,_hoisted_348];function _sfc_render49(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_149,_hoisted_415)}var circle_check_default=export_helper_default(circle_check_vue_vue_type_script_lang_default,[["render",_sfc_render49],["__file","circle-check.vue"]]),circle_close_filled_vue_vue_type_script_lang_default={name:"CircleCloseFilled"},_hoisted_150={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_250=createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336L512 457.664z"},null,-1),_hoisted_349=[_hoisted_250];function _sfc_render50(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_150,_hoisted_349)}var circle_close_filled_default=export_helper_default(circle_close_filled_vue_vue_type_script_lang_default,[["render",_sfc_render50],["__file","circle-close-filled.vue"]]),circle_close_vue_vue_type_script_lang_default={name:"CircleClose"},_hoisted_151={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_251=createBaseVNode("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248L466.752 512z"},null,-1),_hoisted_350=createBaseVNode("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),_hoisted_416=[_hoisted_251,_hoisted_350];function _sfc_render51(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_151,_hoisted_416)}var circle_close_default=export_helper_default(circle_close_vue_vue_type_script_lang_default,[["render",_sfc_render51],["__file","circle-close.vue"]]),close_vue_vue_type_script_lang_default={name:"Close"},_hoisted_156={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_256=createBaseVNode("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"},null,-1),_hoisted_355=[_hoisted_256];function _sfc_render56(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_156,_hoisted_355)}var close_default=export_helper_default(close_vue_vue_type_script_lang_default,[["render",_sfc_render56],["__file","close.vue"]]),delete_vue_vue_type_script_lang_default={name:"Delete"},_hoisted_180={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_280=createBaseVNode("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32V256zm448-64v-64H416v64h192zM224 896h576V256H224v640zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32zm192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32z"},null,-1),_hoisted_379=[_hoisted_280];function _sfc_render80(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_180,_hoisted_379)}var delete_default=export_helper_default(delete_vue_vue_type_script_lang_default,[["render",_sfc_render80],["__file","delete.vue"]]),document_vue_vue_type_script_lang_default={name:"Document"},_hoisted_190={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_290=createBaseVNode("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640V384zm-26.496-64L640 154.496V320h165.504zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32zm160 448h384v64H320v-64zm0-192h160v64H320v-64zm0 384h384v64H320v-64z"},null,-1),_hoisted_389=[_hoisted_290];function _sfc_render90(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_190,_hoisted_389)}var document_default=export_helper_default(document_vue_vue_type_script_lang_default,[["render",_sfc_render90],["__file","document.vue"]]),edit_vue_vue_type_script_lang_default={name:"Edit"},_hoisted_194={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_294=createBaseVNode("path",{fill:"currentColor",d:"M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640V512z"},null,-1),_hoisted_393=createBaseVNode("path",{fill:"currentColor",d:"m469.952 554.24 52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z"},null,-1),_hoisted_431=[_hoisted_294,_hoisted_393];function _sfc_render94(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_194,_hoisted_431)}var edit_default=export_helper_default(edit_vue_vue_type_script_lang_default,[["render",_sfc_render94],["__file","edit.vue"]]),full_screen_vue_vue_type_script_lang_default={name:"FullScreen"},_hoisted_1118={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2118=createBaseVNode("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64v.064zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64l-192 .192zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64v-.064z"},null,-1),_hoisted_3117=[_hoisted_2118];function _sfc_render118(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1118,_hoisted_3117)}var full_screen_default=export_helper_default(full_screen_vue_vue_type_script_lang_default,[["render",_sfc_render118],["__file","full-screen.vue"]]),hide_vue_vue_type_script_lang_default={name:"Hide"},_hoisted_1133={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2133=createBaseVNode("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2L371.2 588.8ZM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"},null,-1),_hoisted_3132=createBaseVNode("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"},null,-1),_hoisted_438=[_hoisted_2133,_hoisted_3132];function _sfc_render133(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1133,_hoisted_438)}var hide_default=export_helper_default(hide_vue_vue_type_script_lang_default,[["render",_sfc_render133],["__file","hide.vue"]]),info_filled_vue_vue_type_script_lang_default={name:"InfoFilled"},_hoisted_1143={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2143=createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64zm67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344zM590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"},null,-1),_hoisted_3142=[_hoisted_2143];function _sfc_render143(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1143,_hoisted_3142)}var info_filled_default=export_helper_default(info_filled_vue_vue_type_script_lang_default,[["render",_sfc_render143],["__file","info-filled.vue"]]),loading_vue_vue_type_script_lang_default={name:"Loading"},_hoisted_1150={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2150=createBaseVNode("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32zm448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32zm-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0zm-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"},null,-1),_hoisted_3149=[_hoisted_2150];function _sfc_render150(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1150,_hoisted_3149)}var loading_default=export_helper_default(loading_vue_vue_type_script_lang_default,[["render",_sfc_render150],["__file","loading.vue"]]),plus_vue_vue_type_script_lang_default={name:"Plus"},_hoisted_1201={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2201=createBaseVNode("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"},null,-1),_hoisted_3200=[_hoisted_2201];function _sfc_render201(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1201,_hoisted_3200)}var plus_default=export_helper_default(plus_vue_vue_type_script_lang_default,[["render",_sfc_render201],["__file","plus.vue"]]),refresh_left_vue_vue_type_script_lang_default={name:"RefreshLeft"},_hoisted_1215={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2215=createBaseVNode("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"},null,-1),_hoisted_3214=[_hoisted_2215];function _sfc_render215(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1215,_hoisted_3214)}var refresh_left_default=export_helper_default(refresh_left_vue_vue_type_script_lang_default,[["render",_sfc_render215],["__file","refresh-left.vue"]]),refresh_right_vue_vue_type_script_lang_default={name:"RefreshRight"},_hoisted_1216={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2216=createBaseVNode("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"},null,-1),_hoisted_3215=[_hoisted_2216];function _sfc_render216(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1216,_hoisted_3215)}var refresh_right_default=export_helper_default(refresh_right_vue_vue_type_script_lang_default,[["render",_sfc_render216],["__file","refresh-right.vue"]]),scale_to_original_vue_vue_type_script_lang_default={name:"ScaleToOriginal"},_hoisted_1222={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2222=createBaseVNode("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zM512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412zM512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512z"},null,-1),_hoisted_3221=[_hoisted_2222];function _sfc_render222(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1222,_hoisted_3221)}var scale_to_original_default=export_helper_default(scale_to_original_vue_vue_type_script_lang_default,[["render",_sfc_render222],["__file","scale-to-original.vue"]]),search_vue_vue_type_script_lang_default={name:"Search"},_hoisted_1225={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2225=createBaseVNode("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704z"},null,-1),_hoisted_3224=[_hoisted_2225];function _sfc_render225(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1225,_hoisted_3224)}var search_default=export_helper_default(search_vue_vue_type_script_lang_default,[["render",_sfc_render225],["__file","search.vue"]]),setting_vue_vue_type_script_lang_default={name:"Setting"},_hoisted_1231={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2231=createBaseVNode("path",{fill:"currentColor",d:"M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36-116.224-25.088-65.28 113.152 79.68 88.192-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136-79.808 88.192 65.344 113.152 116.224-25.024 22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152 24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296 116.288 25.024 65.28-113.152-79.744-88.192 1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136 79.808-88.128-65.344-113.152-116.288 24.96-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384 192 192 0 0 1 0-384zm0 64a128 128 0 1 0 0 256 128 128 0 0 0 0-256z"},null,-1),_hoisted_3230=[_hoisted_2231];function _sfc_render231(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1231,_hoisted_3230)}var setting_default=export_helper_default(setting_vue_vue_type_script_lang_default,[["render",_sfc_render231],["__file","setting.vue"]]),success_filled_vue_vue_type_script_lang_default={name:"SuccessFilled"},_hoisted_1249={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2249=createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336L456.192 600.384z"},null,-1),_hoisted_3248=[_hoisted_2249];function _sfc_render249(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1249,_hoisted_3248)}var success_filled_default=export_helper_default(success_filled_vue_vue_type_script_lang_default,[["render",_sfc_render249],["__file","success-filled.vue"]]),view_vue_vue_type_script_lang_default={name:"View"},_hoisted_1283={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2283=createBaseVNode("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352zm0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448zm0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160z"},null,-1),_hoisted_3282=[_hoisted_2283];function _sfc_render283(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1283,_hoisted_3282)}var view_default=export_helper_default(view_vue_vue_type_script_lang_default,[["render",_sfc_render283],["__file","view.vue"]]),warning_filled_vue_vue_type_script_lang_default={name:"WarningFilled"},_hoisted_1287={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2287=createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256zm0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4z"},null,-1),_hoisted_3286=[_hoisted_2287];function _sfc_render287(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1287,_hoisted_3286)}var warning_filled_default=export_helper_default(warning_filled_vue_vue_type_script_lang_default,[["render",_sfc_render287],["__file","warning-filled.vue"]]),zoom_in_vue_vue_type_script_lang_default={name:"ZoomIn"},_hoisted_1292={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2292=createBaseVNode("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704zm-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64h96z"},null,-1),_hoisted_3291=[_hoisted_2292];function _sfc_render292(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1292,_hoisted_3291)}var zoom_in_default=export_helper_default(zoom_in_vue_vue_type_script_lang_default,[["render",_sfc_render292],["__file","zoom-in.vue"]]),zoom_out_vue_vue_type_script_lang_default={name:"ZoomOut"},_hoisted_1293={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2293=createBaseVNode("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704zM352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64z"},null,-1),_hoisted_3292=[_hoisted_2293];function _sfc_render293(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1293,_hoisted_3292)}var zoom_out_default=export_helper_default(zoom_out_vue_vue_type_script_lang_default,[["render",_sfc_render293],["__file","zoom-out.vue"]]);const epPropKey="__epPropKey",definePropType=t=>t,isEpProp=t=>isObject$2(t)&&!!t[epPropKey],buildProp=(t,r)=>{if(!isObject$2(t)||isEpProp(t))return t;const{values:e,required:n,default:o,type:s,validator:a}=t,u={type:s,required:!!n,validator:e||a?d=>{let c=!1,m=[];if(e&&(m=Array.from(e),hasOwn(t,"default")&&m.push(o),c||(c=m.includes(d))),a&&(c||(c=a(d))),!c&&m.length>0){const v=[...new Set(m)].map(g=>JSON.stringify(g)).join(", ");warn(`Invalid prop: validation failed${r?` for prop "${r}"`:""}. Expected one of [${v}], got value ${JSON.stringify(d)}.`)}return c}:void 0,[epPropKey]:!0};return hasOwn(t,"default")&&(u.default=o),u},buildProps=t=>fromPairs(Object.entries(t).map(([r,e])=>[r,buildProp(e,r)])),iconPropType=definePropType([String,Object,Function]),CloseComponents={Close:close_default},TypeComponents={Close:close_default,SuccessFilled:success_filled_default,InfoFilled:info_filled_default,WarningFilled:warning_filled_default,CircleCloseFilled:circle_close_filled_default},TypeComponentsMap={success:success_filled_default,warning:warning_filled_default,error:circle_close_filled_default,info:info_filled_default},ValidateComponentsMap={validating:loading_default,success:circle_check_default,error:circle_close_default},withInstall=(t,r)=>{if(t.install=e=>{for(const n of[t,...Object.values(r??{})])e.component(n.name,n)},r)for(const[e,n]of Object.entries(r))t[e]=n;return t},withInstallFunction=(t,r)=>(t.install=e=>{t._context=e._context,e.config.globalProperties[r]=t},t),withNoopInstall=t=>(t.install=NOOP,t),composeRefs=(...t)=>r=>{t.forEach(e=>{isFunction$3(e)?e(r):e.value=r})},EVENT_CODE={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},UPDATE_MODEL_EVENT="update:modelValue",CHANGE_EVENT="change",INPUT_EVENT="input",componentSizes=["","default","small","large"],componentSizeMap={large:40,default:32,small:24},getComponentSize=t=>componentSizeMap[t||"default"],isValidComponentSize=t=>["",...componentSizes].includes(t);var PatchFlags=(t=>(t[t.TEXT=1]="TEXT",t[t.CLASS=2]="CLASS",t[t.STYLE=4]="STYLE",t[t.PROPS=8]="PROPS",t[t.FULL_PROPS=16]="FULL_PROPS",t[t.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",t[t.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",t[t.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",t[t.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",t[t.NEED_PATCH=512]="NEED_PATCH",t[t.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",t[t.HOISTED=-1]="HOISTED",t[t.BAIL=-2]="BAIL",t))(PatchFlags||{});const unique=t=>[...new Set(t)],castArray=t=>!t&&t!==0?[]:Array.isArray(t)?t:[t],isKorean=t=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(t),generateId=()=>Math.floor(Math.random()*1e4),mutable=t=>t,DEFAULT_EXCLUDE_KEYS=["class","style"],LISTENER_PREFIX=/^on[A-Z]/,useAttrs=(t={})=>{const{excludeListeners:r=!1,excludeKeys:e}=t,n=computed(()=>((e==null?void 0:e.value)||[]).concat(DEFAULT_EXCLUDE_KEYS)),o=getCurrentInstance();return computed(o?()=>{var s;return fromPairs(Object.entries((s=o.proxy)==null?void 0:s.$attrs).filter(([a])=>!n.value.includes(a)&&!(r&&LISTENER_PREFIX.test(a))))}:()=>({}))},useDeprecated=({from:t,replacement:r,scope:e,version:n,ref:o,type:s="API"},a)=>{watch(()=>unref(a),i=>{},{immediate:!0})},useDraggable=(t,r,e)=>{let n={offsetX:0,offsetY:0};const o=i=>{const u=i.clientX,d=i.clientY,{offsetX:c,offsetY:m}=n,v=t.value.getBoundingClientRect(),g=v.left,b=v.top,T=v.width,k=v.height,y=document.documentElement.clientWidth,O=document.documentElement.clientHeight,D=-g+c,he=-b+m,ae=y-g-T+c,Ne=O-b-k+m,ue=_e=>{const Ce=Math.min(Math.max(c+_e.clientX-u,D),ae),ze=Math.min(Math.max(m+_e.clientY-d,he),Ne);n={offsetX:Ce,offsetY:ze},t.value.style.transform=`translate(${addUnit(Ce)}, ${addUnit(ze)})`},Y=()=>{document.removeEventListener("mousemove",ue),document.removeEventListener("mouseup",Y)};document.addEventListener("mousemove",ue),document.addEventListener("mouseup",Y)},s=()=>{r.value&&t.value&&r.value.addEventListener("mousedown",o)},a=()=>{r.value&&t.value&&r.value.removeEventListener("mousedown",o)};onMounted(()=>{watchEffect(()=>{e.value?s():a()})}),onBeforeUnmount(()=>{a()})};var English={name:"en",el:{colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"}}};const buildTranslator=t=>(r,e)=>translate(r,e,unref(t)),translate=(t,r,e)=>get(e,t,t).replace(/\{(\w+)\}/g,(n,o)=>{var s;return`${(s=r==null?void 0:r[o])!=null?s:`{${o}}`}`}),buildLocaleContext=t=>{const r=computed(()=>unref(t).name),e=isRef(t)?t:ref(t);return{lang:r,locale:e,t:buildTranslator(t)}},localeContextKey=Symbol("localeContextKey"),useLocale=t=>{const r=t||inject(localeContextKey,ref());return buildLocaleContext(computed(()=>r.value||English))},defaultNamespace="el",statePrefix="is-",_bem=(t,r,e,n,o)=>{let s=`${t}-${r}`;return e&&(s+=`-${e}`),n&&(s+=`__${n}`),o&&(s+=`--${o}`),s},namespaceContextKey=Symbol("namespaceContextKey"),useGetDerivedNamespace=t=>{const r=t||(getCurrentInstance()?inject(namespaceContextKey,ref(defaultNamespace)):ref(defaultNamespace));return computed(()=>unref(r)||defaultNamespace)},useNamespace=(t,r)=>{const e=useGetDerivedNamespace(r);return{namespace:e,b:(T="")=>_bem(e.value,t,T,"",""),e:T=>T?_bem(e.value,t,"",T,""):"",m:T=>T?_bem(e.value,t,"","",T):"",be:(T,k)=>T&&k?_bem(e.value,t,T,k,""):"",em:(T,k)=>T&&k?_bem(e.value,t,"",T,k):"",bm:(T,k)=>T&&k?_bem(e.value,t,T,"",k):"",bem:(T,k,y)=>T&&k&&y?_bem(e.value,t,T,k,y):"",is:(T,...k)=>{const y=k.length>=1?k[0]:!0;return T&&y?`${statePrefix}${T}`:""},cssVar:T=>{const k={};for(const y in T)T[y]&&(k[`--${e.value}-${y}`]=T[y]);return k},cssVarName:T=>`--${e.value}-${T}`,cssVarBlock:T=>{const k={};for(const y in T)T[y]&&(k[`--${e.value}-${t}-${y}`]=T[y]);return k},cssVarBlockName:T=>`--${e.value}-${t}-${T}`}},useLockscreen=(t,r={})=>{isRef(t)||throwError("[useLockscreen]","You need to pass a ref param to this function");const e=r.ns||useNamespace("popup"),n=computed$1(()=>e.bm("parent","hidden"));if(!isClient||hasClass(document.body,n.value))return;let o=0,s=!1,a="0";const i=()=>{setTimeout(()=>{removeClass(document==null?void 0:document.body,n.value),s&&document&&(document.body.style.width=a)},200)};watch(t,u=>{if(!u){i();return}s=!hasClass(document.body,n.value),s&&(a=document.body.style.width),o=getScrollBarWidth(e.namespace.value);const d=document.documentElement.clientHeight<document.body.scrollHeight,c=getStyle(document.body,"overflowY");o>0&&(d||c==="scroll")&&s&&(document.body.style.width=`calc(100% - ${o}px)`),addClass(document.body,n.value)}),onScopeDispose(()=>i())},_prop=buildProp({type:definePropType(Boolean),default:null}),_event=buildProp({type:definePropType(Function)}),createModelToggleComposable=t=>{const r=`update:${t}`,e=`onUpdate:${t}`,n=[r],o={[t]:_prop,[e]:_event};return{useModelToggle:({indicator:a,toggleReason:i,shouldHideWhenRouteChanges:u,shouldProceed:d,onShow:c,onHide:m})=>{const v=getCurrentInstance(),{emit:g}=v,b=v.props,T=computed(()=>isFunction$3(b[e])),k=computed(()=>b[t]===null),y=ue=>{a.value!==!0&&(a.value=!0,i&&(i.value=ue),isFunction$3(c)&&c(ue))},O=ue=>{a.value!==!1&&(a.value=!1,i&&(i.value=ue),isFunction$3(m)&&m(ue))},D=ue=>{if(b.disabled===!0||isFunction$3(d)&&!d())return;const Y=T.value&&isClient;Y&&g(r,!0),(k.value||!Y)&&y(ue)},he=ue=>{if(b.disabled===!0||!isClient)return;const Y=T.value&&isClient;Y&&g(r,!1),(k.value||!Y)&&O(ue)},ae=ue=>{isBoolean$1(ue)&&(b.disabled&&ue?T.value&&g(r,!1):a.value!==ue&&(ue?y():O()))},Ne=()=>{a.value?he():D()};return watch(()=>b[t],ae),u&&v.appContext.config.globalProperties.$route!==void 0&&watch(()=>({...v.proxy.$route}),()=>{u.value&&a.value&&he()}),onMounted(()=>{ae(b[t])}),{hide:he,show:D,toggle:Ne,hasUpdateHandler:T}},useModelToggleProps:o,useModelToggleEmits:n}};createModelToggleComposable("modelValue");const useProp=t=>{const r=getCurrentInstance();return computed(()=>{var e,n;return(n=(e=r==null?void 0:r.proxy)==null?void 0:e.$props)==null?void 0:n[t]})};var E="top",R="bottom",W="right",P="left",me="auto",G=[E,R,W,P],U="start",J="end",Xe="clippingParents",je="viewport",K="popper",Ye="reference",De=G.reduce(function(t,r){return t.concat([r+"-"+U,r+"-"+J])},[]),Ee=[].concat(G,[me]).reduce(function(t,r){return t.concat([r,r+"-"+U,r+"-"+J])},[]),Ge="beforeRead",Je="read",Ke="afterRead",Qe="beforeMain",Ze="main",et="afterMain",tt$1="beforeWrite",nt="write",rt="afterWrite",ot=[Ge,Je,Ke,Qe,Ze,et,tt$1,nt,rt];function C(t){return t?(t.nodeName||"").toLowerCase():null}function H(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var r=t.ownerDocument;return r&&r.defaultView||window}return t}function Q(t){var r=H(t).Element;return t instanceof r||t instanceof Element}function B(t){var r=H(t).HTMLElement;return t instanceof r||t instanceof HTMLElement}function Pe(t){if(typeof ShadowRoot>"u")return!1;var r=H(t).ShadowRoot;return t instanceof r||t instanceof ShadowRoot}function Mt(t){var r=t.state;Object.keys(r.elements).forEach(function(e){var n=r.styles[e]||{},o=r.attributes[e]||{},s=r.elements[e];!B(s)||!C(s)||(Object.assign(s.style,n),Object.keys(o).forEach(function(a){var i=o[a];i===!1?s.removeAttribute(a):s.setAttribute(a,i===!0?"":i)}))})}function Rt(t){var r=t.state,e={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(r.elements.popper.style,e.popper),r.styles=e,r.elements.arrow&&Object.assign(r.elements.arrow.style,e.arrow),function(){Object.keys(r.elements).forEach(function(n){var o=r.elements[n],s=r.attributes[n]||{},a=Object.keys(r.styles.hasOwnProperty(n)?r.styles[n]:e[n]),i=a.reduce(function(u,d){return u[d]="",u},{});!B(o)||!C(o)||(Object.assign(o.style,i),Object.keys(s).forEach(function(u){o.removeAttribute(u)}))})}}var Ae={name:"applyStyles",enabled:!0,phase:"write",fn:Mt,effect:Rt,requires:["computeStyles"]};function q(t){return t.split("-")[0]}var X=Math.max,ve=Math.min,Z=Math.round;function ee(t,r){r===void 0&&(r=!1);var e=t.getBoundingClientRect(),n=1,o=1;if(B(t)&&r){var s=t.offsetHeight,a=t.offsetWidth;a>0&&(n=Z(e.width)/a||1),s>0&&(o=Z(e.height)/s||1)}return{width:e.width/n,height:e.height/o,top:e.top/o,right:e.right/n,bottom:e.bottom/o,left:e.left/n,x:e.left/n,y:e.top/o}}function ke(t){var r=ee(t),e=t.offsetWidth,n=t.offsetHeight;return Math.abs(r.width-e)<=1&&(e=r.width),Math.abs(r.height-n)<=1&&(n=r.height),{x:t.offsetLeft,y:t.offsetTop,width:e,height:n}}function it(t,r){var e=r.getRootNode&&r.getRootNode();if(t.contains(r))return!0;if(e&&Pe(e)){var n=r;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function N(t){return H(t).getComputedStyle(t)}function Wt(t){return["table","td","th"].indexOf(C(t))>=0}function I(t){return((Q(t)?t.ownerDocument:t.document)||window.document).documentElement}function ge(t){return C(t)==="html"?t:t.assignedSlot||t.parentNode||(Pe(t)?t.host:null)||I(t)}function at(t){return!B(t)||N(t).position==="fixed"?null:t.offsetParent}function Bt(t){var r=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,e=navigator.userAgent.indexOf("Trident")!==-1;if(e&&B(t)){var n=N(t);if(n.position==="fixed")return null}var o=ge(t);for(Pe(o)&&(o=o.host);B(o)&&["html","body"].indexOf(C(o))<0;){var s=N(o);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||r&&s.willChange==="filter"||r&&s.filter&&s.filter!=="none")return o;o=o.parentNode}return null}function se(t){for(var r=H(t),e=at(t);e&&Wt(e)&&N(e).position==="static";)e=at(e);return e&&(C(e)==="html"||C(e)==="body"&&N(e).position==="static")?r:e||Bt(t)||r}function Le(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function fe(t,r,e){return X(t,ve(r,e))}function St(t,r,e){var n=fe(t,r,e);return n>e?e:n}function st(){return{top:0,right:0,bottom:0,left:0}}function ft(t){return Object.assign({},st(),t)}function ct(t,r){return r.reduce(function(e,n){return e[n]=t,e},{})}var Tt=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,ft(typeof t!="number"?t:ct(t,G))};function Ht(t){var r,e=t.state,n=t.name,o=t.options,s=e.elements.arrow,a=e.modifiersData.popperOffsets,i=q(e.placement),u=Le(i),d=[P,W].indexOf(i)>=0,c=d?"height":"width";if(!(!s||!a)){var m=Tt(o.padding,e),v=ke(s),g=u==="y"?E:P,b=u==="y"?R:W,T=e.rects.reference[c]+e.rects.reference[u]-a[u]-e.rects.popper[c],k=a[u]-e.rects.reference[u],y=se(s),O=y?u==="y"?y.clientHeight||0:y.clientWidth||0:0,D=T/2-k/2,he=m[g],ae=O-v[c]-m[b],Ne=O/2-v[c]/2+D,ue=fe(he,Ne,ae),Y=u;e.modifiersData[n]=(r={},r[Y]=ue,r.centerOffset=ue-Ne,r)}}function Ct(t){var r=t.state,e=t.options,n=e.element,o=n===void 0?"[data-popper-arrow]":n;o!=null&&(typeof o=="string"&&(o=r.elements.popper.querySelector(o),!o)||!it(r.elements.popper,o)||(r.elements.arrow=o))}var pt={name:"arrow",enabled:!0,phase:"main",fn:Ht,effect:Ct,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function te(t){return t.split("-")[1]}var qt={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Vt(t){var r=t.x,e=t.y,n=window,o=n.devicePixelRatio||1;return{x:Z(r*o)/o||0,y:Z(e*o)/o||0}}function ut(t){var r,e=t.popper,n=t.popperRect,o=t.placement,s=t.variation,a=t.offsets,i=t.position,u=t.gpuAcceleration,d=t.adaptive,c=t.roundOffsets,m=t.isFixed,v=a.x,g=v===void 0?0:v,b=a.y,T=b===void 0?0:b,k=typeof c=="function"?c({x:g,y:T}):{x:g,y:T};g=k.x,T=k.y;var y=a.hasOwnProperty("x"),O=a.hasOwnProperty("y"),D=P,he=E,ae=window;if(d){var Ne=se(e),ue="clientHeight",Y="clientWidth";if(Ne===H(e)&&(Ne=I(e),N(Ne).position!=="static"&&i==="absolute"&&(ue="scrollHeight",Y="scrollWidth")),Ne=Ne,o===E||(o===P||o===W)&&s===J){he=R;var _e=m&&Ne===ae&&ae.visualViewport?ae.visualViewport.height:Ne[ue];T-=_e-n.height,T*=u?1:-1}if(o===P||(o===E||o===R)&&s===J){D=W;var Ce=m&&Ne===ae&&ae.visualViewport?ae.visualViewport.width:Ne[Y];g-=Ce-n.width,g*=u?1:-1}}var ze=Object.assign({position:i},d&&qt),ie=c===!0?Vt({x:g,y:T}):{x:g,y:T};if(g=ie.x,T=ie.y,u){var le;return Object.assign({},ze,(le={},le[he]=O?"0":"",le[D]=y?"0":"",le.transform=(ae.devicePixelRatio||1)<=1?"translate("+g+"px, "+T+"px)":"translate3d("+g+"px, "+T+"px, 0)",le))}return Object.assign({},ze,(r={},r[he]=O?T+"px":"",r[D]=y?g+"px":"",r.transform="",r))}function Nt(t){var r=t.state,e=t.options,n=e.gpuAcceleration,o=n===void 0?!0:n,s=e.adaptive,a=s===void 0?!0:s,i=e.roundOffsets,u=i===void 0?!0:i,d={placement:q(r.placement),variation:te(r.placement),popper:r.elements.popper,popperRect:r.rects.popper,gpuAcceleration:o,isFixed:r.options.strategy==="fixed"};r.modifiersData.popperOffsets!=null&&(r.styles.popper=Object.assign({},r.styles.popper,ut(Object.assign({},d,{offsets:r.modifiersData.popperOffsets,position:r.options.strategy,adaptive:a,roundOffsets:u})))),r.modifiersData.arrow!=null&&(r.styles.arrow=Object.assign({},r.styles.arrow,ut(Object.assign({},d,{offsets:r.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-placement":r.placement})}var Me={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Nt,data:{}},ye={passive:!0};function It(t){var r=t.state,e=t.instance,n=t.options,o=n.scroll,s=o===void 0?!0:o,a=n.resize,i=a===void 0?!0:a,u=H(r.elements.popper),d=[].concat(r.scrollParents.reference,r.scrollParents.popper);return s&&d.forEach(function(c){c.addEventListener("scroll",e.update,ye)}),i&&u.addEventListener("resize",e.update,ye),function(){s&&d.forEach(function(c){c.removeEventListener("scroll",e.update,ye)}),i&&u.removeEventListener("resize",e.update,ye)}}var Re={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:It,data:{}},_t={left:"right",right:"left",bottom:"top",top:"bottom"};function be(t){return t.replace(/left|right|bottom|top/g,function(r){return _t[r]})}var zt={start:"end",end:"start"};function lt(t){return t.replace(/start|end/g,function(r){return zt[r]})}function We(t){var r=H(t),e=r.pageXOffset,n=r.pageYOffset;return{scrollLeft:e,scrollTop:n}}function Be(t){return ee(I(t)).left+We(t).scrollLeft}function Ft(t){var r=H(t),e=I(t),n=r.visualViewport,o=e.clientWidth,s=e.clientHeight,a=0,i=0;return n&&(o=n.width,s=n.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(a=n.offsetLeft,i=n.offsetTop)),{width:o,height:s,x:a+Be(t),y:i}}function Ut(t){var r,e=I(t),n=We(t),o=(r=t.ownerDocument)==null?void 0:r.body,s=X(e.scrollWidth,e.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),a=X(e.scrollHeight,e.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),i=-n.scrollLeft+Be(t),u=-n.scrollTop;return N(o||e).direction==="rtl"&&(i+=X(e.clientWidth,o?o.clientWidth:0)-s),{width:s,height:a,x:i,y:u}}function Se(t){var r=N(t),e=r.overflow,n=r.overflowX,o=r.overflowY;return/auto|scroll|overlay|hidden/.test(e+o+n)}function dt(t){return["html","body","#document"].indexOf(C(t))>=0?t.ownerDocument.body:B(t)&&Se(t)?t:dt(ge(t))}function ce(t,r){var e;r===void 0&&(r=[]);var n=dt(t),o=n===((e=t.ownerDocument)==null?void 0:e.body),s=H(n),a=o?[s].concat(s.visualViewport||[],Se(n)?n:[]):n,i=r.concat(a);return o?i:i.concat(ce(ge(a)))}function Te(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Xt(t){var r=ee(t);return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function ht(t,r){return r===je?Te(Ft(t)):Q(r)?Xt(r):Te(Ut(I(t)))}function Yt(t){var r=ce(ge(t)),e=["absolute","fixed"].indexOf(N(t).position)>=0,n=e&&B(t)?se(t):t;return Q(n)?r.filter(function(o){return Q(o)&&it(o,n)&&C(o)!=="body"}):[]}function Gt(t,r,e){var n=r==="clippingParents"?Yt(t):[].concat(r),o=[].concat(n,[e]),s=o[0],a=o.reduce(function(i,u){var d=ht(t,u);return i.top=X(d.top,i.top),i.right=ve(d.right,i.right),i.bottom=ve(d.bottom,i.bottom),i.left=X(d.left,i.left),i},ht(t,s));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function mt(t){var r=t.reference,e=t.element,n=t.placement,o=n?q(n):null,s=n?te(n):null,a=r.x+r.width/2-e.width/2,i=r.y+r.height/2-e.height/2,u;switch(o){case E:u={x:a,y:r.y-e.height};break;case R:u={x:a,y:r.y+r.height};break;case W:u={x:r.x+r.width,y:i};break;case P:u={x:r.x-e.width,y:i};break;default:u={x:r.x,y:r.y}}var d=o?Le(o):null;if(d!=null){var c=d==="y"?"height":"width";switch(s){case U:u[d]=u[d]-(r[c]/2-e[c]/2);break;case J:u[d]=u[d]+(r[c]/2-e[c]/2);break}}return u}function ne(t,r){r===void 0&&(r={});var e=r,n=e.placement,o=n===void 0?t.placement:n,s=e.boundary,a=s===void 0?Xe:s,i=e.rootBoundary,u=i===void 0?je:i,d=e.elementContext,c=d===void 0?K:d,m=e.altBoundary,v=m===void 0?!1:m,g=e.padding,b=g===void 0?0:g,T=ft(typeof b!="number"?b:ct(b,G)),k=c===K?Ye:K,y=t.rects.popper,O=t.elements[v?k:c],D=Gt(Q(O)?O:O.contextElement||I(t.elements.popper),a,u),he=ee(t.elements.reference),ae=mt({reference:he,element:y,strategy:"absolute",placement:o}),Ne=Te(Object.assign({},y,ae)),ue=c===K?Ne:he,Y={top:D.top-ue.top+T.top,bottom:ue.bottom-D.bottom+T.bottom,left:D.left-ue.left+T.left,right:ue.right-D.right+T.right},_e=t.modifiersData.offset;if(c===K&&_e){var Ce=_e[o];Object.keys(Y).forEach(function(ze){var ie=[W,R].indexOf(ze)>=0?1:-1,le=[E,R].indexOf(ze)>=0?"y":"x";Y[ze]+=Ce[le]*ie})}return Y}function Jt(t,r){r===void 0&&(r={});var e=r,n=e.placement,o=e.boundary,s=e.rootBoundary,a=e.padding,i=e.flipVariations,u=e.allowedAutoPlacements,d=u===void 0?Ee:u,c=te(n),m=c?i?De:De.filter(function(b){return te(b)===c}):G,v=m.filter(function(b){return d.indexOf(b)>=0});v.length===0&&(v=m);var g=v.reduce(function(b,T){return b[T]=ne(t,{placement:T,boundary:o,rootBoundary:s,padding:a})[q(T)],b},{});return Object.keys(g).sort(function(b,T){return g[b]-g[T]})}function Kt(t){if(q(t)===me)return[];var r=be(t);return[lt(t),r,lt(r)]}function Qt(t){var r=t.state,e=t.options,n=t.name;if(!r.modifiersData[n]._skip){for(var o=e.mainAxis,s=o===void 0?!0:o,a=e.altAxis,i=a===void 0?!0:a,u=e.fallbackPlacements,d=e.padding,c=e.boundary,m=e.rootBoundary,v=e.altBoundary,g=e.flipVariations,b=g===void 0?!0:g,T=e.allowedAutoPlacements,k=r.options.placement,y=q(k),O=y===k,D=u||(O||!b?[be(k)]:Kt(k)),he=[k].concat(D).reduce(function(Fe,nr){return Fe.concat(q(nr)===me?Jt(r,{placement:nr,boundary:c,rootBoundary:m,padding:d,flipVariations:b,allowedAutoPlacements:T}):nr)},[]),ae=r.rects.reference,Ne=r.rects.popper,ue=new Map,Y=!0,_e=he[0],Ce=0;Ce<he.length;Ce++){var ze=he[Ce],ie=q(ze),le=te(ze)===U,Ie=[E,R].indexOf(ie)>=0,pe=Ie?"width":"height",qe=ne(r,{placement:ze,boundary:c,rootBoundary:m,altBoundary:v,padding:d}),$e=Ie?le?W:P:le?R:E;ae[pe]>Ne[pe]&&($e=be($e));var Lt=be($e),Dt=[];if(s&&Dt.push(qe[ie]<=0),i&&Dt.push(qe[$e]<=0,qe[Lt]<=0),Dt.every(function(Fe){return Fe})){_e=ze,Y=!1;break}ue.set(ze,Dt)}if(Y)for(var dr=b?3:1,pr=function(Fe){var nr=he.find(function(ir){var Ue=ue.get(ir);if(Ue)return Ue.slice(0,Fe).every(function(rr){return rr})});if(nr)return _e=nr,"break"},sr=dr;sr>0;sr--){var hr=pr(sr);if(hr==="break")break}r.placement!==_e&&(r.modifiersData[n]._skip=!0,r.placement=_e,r.reset=!0)}}var vt={name:"flip",enabled:!0,phase:"main",fn:Qt,requiresIfExists:["offset"],data:{_skip:!1}};function gt(t,r,e){return e===void 0&&(e={x:0,y:0}),{top:t.top-r.height-e.y,right:t.right-r.width+e.x,bottom:t.bottom-r.height+e.y,left:t.left-r.width-e.x}}function yt(t){return[E,W,R,P].some(function(r){return t[r]>=0})}function Zt(t){var r=t.state,e=t.name,n=r.rects.reference,o=r.rects.popper,s=r.modifiersData.preventOverflow,a=ne(r,{elementContext:"reference"}),i=ne(r,{altBoundary:!0}),u=gt(a,n),d=gt(i,o,s),c=yt(u),m=yt(d);r.modifiersData[e]={referenceClippingOffsets:u,popperEscapeOffsets:d,isReferenceHidden:c,hasPopperEscaped:m},r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":m})}var bt={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Zt};function en(t,r,e){var n=q(t),o=[P,E].indexOf(n)>=0?-1:1,s=typeof e=="function"?e(Object.assign({},r,{placement:t})):e,a=s[0],i=s[1];return a=a||0,i=(i||0)*o,[P,W].indexOf(n)>=0?{x:i,y:a}:{x:a,y:i}}function tn(t){var r=t.state,e=t.options,n=t.name,o=e.offset,s=o===void 0?[0,0]:o,a=Ee.reduce(function(c,m){return c[m]=en(m,r.rects,s),c},{}),i=a[r.placement],u=i.x,d=i.y;r.modifiersData.popperOffsets!=null&&(r.modifiersData.popperOffsets.x+=u,r.modifiersData.popperOffsets.y+=d),r.modifiersData[n]=a}var wt={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:tn};function nn(t){var r=t.state,e=t.name;r.modifiersData[e]=mt({reference:r.rects.reference,element:r.rects.popper,strategy:"absolute",placement:r.placement})}var He={name:"popperOffsets",enabled:!0,phase:"read",fn:nn,data:{}};function rn(t){return t==="x"?"y":"x"}function on(t){var r=t.state,e=t.options,n=t.name,o=e.mainAxis,s=o===void 0?!0:o,a=e.altAxis,i=a===void 0?!1:a,u=e.boundary,d=e.rootBoundary,c=e.altBoundary,m=e.padding,v=e.tether,g=v===void 0?!0:v,b=e.tetherOffset,T=b===void 0?0:b,k=ne(r,{boundary:u,rootBoundary:d,padding:m,altBoundary:c}),y=q(r.placement),O=te(r.placement),D=!O,he=Le(y),ae=rn(he),Ne=r.modifiersData.popperOffsets,ue=r.rects.reference,Y=r.rects.popper,_e=typeof T=="function"?T(Object.assign({},r.rects,{placement:r.placement})):T,Ce=typeof _e=="number"?{mainAxis:_e,altAxis:_e}:Object.assign({mainAxis:0,altAxis:0},_e),ze=r.modifiersData.offset?r.modifiersData.offset[r.placement]:null,ie={x:0,y:0};if(Ne){if(s){var le,Ie=he==="y"?E:P,pe=he==="y"?R:W,qe=he==="y"?"height":"width",$e=Ne[he],Lt=$e+k[Ie],Dt=$e-k[pe],dr=g?-Y[qe]/2:0,pr=O===U?ue[qe]:Y[qe],sr=O===U?-Y[qe]:-ue[qe],hr=r.elements.arrow,Fe=g&&hr?ke(hr):{width:0,height:0},nr=r.modifiersData["arrow#persistent"]?r.modifiersData["arrow#persistent"].padding:st(),ir=nr[Ie],Ue=nr[pe],rr=fe(0,ue[qe],Fe[qe]),or=D?ue[qe]/2-dr-rr-ir-Ce.mainAxis:pr-rr-ir-Ce.mainAxis,Pt=D?-ue[qe]/2+dr+rr+Ue+Ce.mainAxis:sr+rr+Ue+Ce.mainAxis,Et=r.elements.arrow&&se(r.elements.arrow),kt=Et?he==="y"?Et.clientTop||0:Et.clientLeft||0:0,er=(le=ze==null?void 0:ze[he])!=null?le:0,cr=$e+or-er-kt,mr=$e+Pt-er,vr=fe(g?ve(Lt,cr):Lt,$e,g?X(Dt,mr):Dt);Ne[he]=vr,ie[he]=vr-$e}if(i){var Tr,Ir=he==="x"?E:P,kr=he==="x"?R:W,Ar=Ne[ae],Rr=ae==="y"?"height":"width",Cn=Ar+k[Ir],Or=Ar-k[kr],Pr=[E,P].indexOf(y)!==-1,Nr=(Tr=ze==null?void 0:ze[ae])!=null?Tr:0,Qr=Pr?Cn:Ar-ue[Rr]-Y[Rr]-Nr+Ce.altAxis,hn=Pr?Ar+ue[Rr]+Y[Rr]-Nr-Ce.altAxis:Or,Ur=g&&Pr?St(Qr,Ar,hn):fe(g?Qr:Cn,Ar,g?hn:Or);Ne[ae]=Ur,ie[ae]=Ur-Ar}r.modifiersData[n]=ie}}var xt={name:"preventOverflow",enabled:!0,phase:"main",fn:on,requiresIfExists:["offset"]};function an(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function sn(t){return t===H(t)||!B(t)?We(t):an(t)}function fn(t){var r=t.getBoundingClientRect(),e=Z(r.width)/t.offsetWidth||1,n=Z(r.height)/t.offsetHeight||1;return e!==1||n!==1}function cn(t,r,e){e===void 0&&(e=!1);var n=B(r),o=B(r)&&fn(r),s=I(r),a=ee(t,o),i={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(n||!n&&!e)&&((C(r)!=="body"||Se(s))&&(i=sn(r)),B(r)?(u=ee(r,!0),u.x+=r.clientLeft,u.y+=r.clientTop):s&&(u.x=Be(s))),{x:a.left+i.scrollLeft-u.x,y:a.top+i.scrollTop-u.y,width:a.width,height:a.height}}function pn(t){var r=new Map,e=new Set,n=[];t.forEach(function(s){r.set(s.name,s)});function o(s){e.add(s.name);var a=[].concat(s.requires||[],s.requiresIfExists||[]);a.forEach(function(i){if(!e.has(i)){var u=r.get(i);u&&o(u)}}),n.push(s)}return t.forEach(function(s){e.has(s.name)||o(s)}),n}function un(t){var r=pn(t);return ot.reduce(function(e,n){return e.concat(r.filter(function(o){return o.phase===n}))},[])}function ln(t){var r;return function(){return r||(r=new Promise(function(e){Promise.resolve().then(function(){r=void 0,e(t())})})),r}}function dn(t){var r=t.reduce(function(e,n){var o=e[n.name];return e[n.name]=o?Object.assign({},o,n,{options:Object.assign({},o.options,n.options),data:Object.assign({},o.data,n.data)}):n,e},{});return Object.keys(r).map(function(e){return r[e]})}var Ot={placement:"bottom",modifiers:[],strategy:"absolute"};function $t(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return!r.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function we(t){t===void 0&&(t={});var r=t,e=r.defaultModifiers,n=e===void 0?[]:e,o=r.defaultOptions,s=o===void 0?Ot:o;return function(a,i,u){u===void 0&&(u=s);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ot,s),modifiersData:{},elements:{reference:a,popper:i},attributes:{},styles:{}},c=[],m=!1,v={state:d,setOptions:function(T){var k=typeof T=="function"?T(d.options):T;b(),d.options=Object.assign({},s,d.options,k),d.scrollParents={reference:Q(a)?ce(a):a.contextElement?ce(a.contextElement):[],popper:ce(i)};var y=un(dn([].concat(n,d.options.modifiers)));return d.orderedModifiers=y.filter(function(O){return O.enabled}),g(),v.update()},forceUpdate:function(){if(!m){var T=d.elements,k=T.reference,y=T.popper;if($t(k,y)){d.rects={reference:cn(k,se(y),d.options.strategy==="fixed"),popper:ke(y)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(Y){return d.modifiersData[Y.name]=Object.assign({},Y.data)});for(var O=0;O<d.orderedModifiers.length;O++){if(d.reset===!0){d.reset=!1,O=-1;continue}var D=d.orderedModifiers[O],he=D.fn,ae=D.options,Ne=ae===void 0?{}:ae,ue=D.name;typeof he=="function"&&(d=he({state:d,options:Ne,name:ue,instance:v})||d)}}}},update:ln(function(){return new Promise(function(T){v.forceUpdate(),T(d)})}),destroy:function(){b(),m=!0}};if(!$t(a,i))return v;v.setOptions(u).then(function(T){!m&&u.onFirstUpdate&&u.onFirstUpdate(T)});function g(){d.orderedModifiers.forEach(function(T){var k=T.name,y=T.options,O=y===void 0?{}:y,D=T.effect;if(typeof D=="function"){var he=D({state:d,name:k,instance:v,options:O}),ae=function(){};c.push(he||ae)}})}function b(){c.forEach(function(T){return T()}),c=[]}return v}}we();var mn=[Re,He,Me,Ae];we({defaultModifiers:mn});var gn=[Re,He,Me,Ae,wt,vt,xt,pt,bt],yn=we({defaultModifiers:gn});const usePopper=(t,r,e={})=>{const n={name:"updateState",enabled:!0,phase:"write",fn:({state:u})=>{const d=deriveState(u);Object.assign(a.value,d)},requires:["computeStyles"]},o=computed(()=>{const{onFirstUpdate:u,placement:d,strategy:c,modifiers:m}=unref(e);return{onFirstUpdate:u,placement:d||"bottom",strategy:c||"absolute",modifiers:[...m||[],n,{name:"applyStyles",enabled:!1}]}}),s=shallowRef(),a=ref({styles:{popper:{position:unref(o).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),i=()=>{s.value&&(s.value.destroy(),s.value=void 0)};return watch(o,u=>{const d=unref(s);d&&d.setOptions(u)},{deep:!0}),watch([t,r],([u,d])=>{i(),!(!u||!d)&&(s.value=yn(u,d,unref(o)))}),onBeforeUnmount(()=>{i()}),{state:computed(()=>{var u;return{...((u=unref(s))==null?void 0:u.state)||{}}}),styles:computed(()=>unref(a).styles),attributes:computed(()=>unref(a).attributes),update:()=>{var u;return(u=unref(s))==null?void 0:u.update()},forceUpdate:()=>{var u;return(u=unref(s))==null?void 0:u.forceUpdate()},instanceRef:computed(()=>unref(s))}};function deriveState(t){const r=Object.keys(t.elements),e=fromPairs(r.map(o=>[o,t.styles[o]||{}])),n=fromPairs(r.map(o=>[o,t.attributes[o]]));return{styles:e,attributes:n}}const useSameTarget=t=>{if(!t)return{onClick:NOOP,onMousedown:NOOP,onMouseup:NOOP};let r=!1,e=!1;return{onClick:a=>{r&&e&&t(a),r=e=!1},onMousedown:a=>{r=a.target===a.currentTarget},onMouseup:a=>{e=a.target===a.currentTarget}}};function useTimeout(){let t;const r=(n,o)=>{e(),t=window.setTimeout(n,o)},e=()=>window.clearTimeout(t);return tryOnScopeDispose(()=>e()),{registerTimeout:r,cancelTimeout:e}}const defaultIdInjection={prefix:Math.floor(Math.random()*1e4),current:0},ID_INJECTION_KEY=Symbol("elIdInjection"),useIdInjection=()=>getCurrentInstance()?inject(ID_INJECTION_KEY,defaultIdInjection):defaultIdInjection,useId=t=>{const r=useIdInjection(),e=useGetDerivedNamespace();return computed(()=>unref(t)||`${e.value}-id-${r.prefix}-${r.current++}`)};let registeredEscapeHandlers=[];const cachedHandler=t=>{const r=t;r.key===EVENT_CODE.esc&&registeredEscapeHandlers.forEach(e=>e(r))},useEscapeKeydown=t=>{onMounted(()=>{registeredEscapeHandlers.length===0&&document.addEventListener("keydown",cachedHandler),isClient&&registeredEscapeHandlers.push(t)}),onBeforeUnmount(()=>{registeredEscapeHandlers=registeredEscapeHandlers.filter(r=>r!==t),registeredEscapeHandlers.length===0&&isClient&&document.removeEventListener("keydown",cachedHandler)})};let cachedContainer;const usePopperContainerId=()=>{const t=useGetDerivedNamespace(),r=useIdInjection(),e=computed(()=>`${t.value}-popper-container-${r.prefix}`),n=computed(()=>`#${e.value}`);return{id:e,selector:n}},createContainer=t=>{const r=document.createElement("div");return r.id=t,document.body.appendChild(r),r},usePopperContainer=()=>{const{id:t,selector:r}=usePopperContainerId();return onBeforeMount(()=>{isClient&&!cachedContainer&&!document.body.querySelector(r.value)&&(cachedContainer=createContainer(t.value))}),{id:t,selector:r}},useDelayedToggleProps=buildProps({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),useDelayedToggle=({showAfter:t,hideAfter:r,autoClose:e,open:n,close:o})=>{const{registerTimeout:s}=useTimeout(),{registerTimeout:a,cancelTimeout:i}=useTimeout();return{onOpen:c=>{s(()=>{n(c);const m=unref(e);isNumber$1(m)&&m>0&&a(()=>{o(c)},m)},unref(t))},onClose:c=>{i(),s(()=>{o(c)},unref(r))}}},FORWARD_REF_INJECTION_KEY=Symbol("elForwardRef"),useForwardRef=t=>{provide(FORWARD_REF_INJECTION_KEY,{setForwardRef:e=>{t.value=e}})},useForwardRefDirective=t=>({mounted(r){t(r)},updated(r){t(r)},unmounted(){t(null)}}),zIndex=ref(0),defaultInitialZIndex=2e3,zIndexContextKey=Symbol("zIndexContextKey"),useZIndex=t=>{const r=t||(getCurrentInstance()?inject(zIndexContextKey,void 0):void 0),e=computed(()=>{const s=unref(r);return isNumber$1(s)?s:defaultInitialZIndex}),n=computed(()=>e.value+zIndex.value);return{initialZIndex:e,currentZIndex:n,nextZIndex:()=>(zIndex.value++,n.value)}};function useCursor(t){const r=ref();function e(){if(t.value==null)return;const{selectionStart:o,selectionEnd:s,value:a}=t.value;if(o==null||s==null)return;const i=a.slice(0,Math.max(0,o)),u=a.slice(Math.max(0,s));r.value={selectionStart:o,selectionEnd:s,value:a,beforeTxt:i,afterTxt:u}}function n(){if(t.value==null||r.value==null)return;const{value:o}=t.value,{beforeTxt:s,afterTxt:a,selectionStart:i}=r.value;if(s==null||a==null||i==null)return;let u=o.length;if(o.endsWith(a))u=o.length-a.length;else if(o.startsWith(s))u=s.length;else{const d=s[i-1],c=o.indexOf(d,i-1);c!==-1&&(u=c+1)}t.value.setSelectionRange(u,u)}return[e,n]}const useSizeProp=buildProp({type:String,values:componentSizes,required:!1}),SIZE_INJECTION_KEY=Symbol("size"),useGlobalSize=()=>{const t=inject(SIZE_INJECTION_KEY,{});return computed(()=>unref(t.size)||"")};function useFocusController(t,{afterFocus:r,beforeBlur:e,afterBlur:n}={}){const o=getCurrentInstance(),{emit:s}=o,a=shallowRef(),i=ref(!1),u=m=>{i.value||(i.value=!0,s("focus",m),r==null||r())},d=m=>{var v;isFunction$3(e)&&e(m)||m.relatedTarget&&((v=a.value)!=null&&v.contains(m.relatedTarget))||(i.value=!1,s("blur",m),n==null||n())},c=()=>{var m;(m=t.value)==null||m.focus()};return watch(a,m=>{m&&m.setAttribute("tabindex","-1")}),useEventListener(a,"click",c),{wrapperRef:a,isFocused:i,handleFocus:u,handleBlur:d}}const configProviderContextKey=Symbol(),globalConfig=ref();function useGlobalConfig(t,r=void 0){const e=getCurrentInstance()?inject(configProviderContextKey,globalConfig):globalConfig;return t?computed(()=>{var n,o;return(o=(n=e.value)==null?void 0:n[t])!=null?o:r}):e}function useGlobalComponentSettings(t,r){const e=useGlobalConfig(),n=useNamespace(t,computed(()=>{var i;return((i=e.value)==null?void 0:i.namespace)||defaultNamespace})),o=useLocale(computed(()=>{var i;return(i=e.value)==null?void 0:i.locale})),s=useZIndex(computed(()=>{var i;return((i=e.value)==null?void 0:i.zIndex)||defaultInitialZIndex})),a=computed(()=>{var i;return unref(r)||((i=e.value)==null?void 0:i.size)||""});return provideGlobalConfig(computed(()=>unref(e)||{})),{ns:n,locale:o,zIndex:s,size:a}}const provideGlobalConfig=(t,r,e=!1)=>{var n;const o=!!getCurrentInstance(),s=o?useGlobalConfig():void 0,a=(n=r==null?void 0:r.provide)!=null?n:o?provide:void 0;if(!a)return;const i=computed(()=>{const u=unref(t);return s!=null&&s.value?mergeConfig$1(s.value,u):u});return a(configProviderContextKey,i),a(localeContextKey,computed(()=>i.value.locale)),a(namespaceContextKey,computed(()=>i.value.namespace)),a(zIndexContextKey,computed(()=>i.value.zIndex)),a(SIZE_INJECTION_KEY,{size:computed(()=>i.value.size||"")}),(e||!globalConfig.value)&&(globalConfig.value=i.value),i},mergeConfig$1=(t,r)=>{var e;const n=[...new Set([...keysOf(t),...keysOf(r)])],o={};for(const s of n)o[s]=(e=r[s])!=null?e:t[s];return o},messageConfig={},affixProps=buildProps({zIndex:{type:definePropType([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),affixEmits={scroll:({scrollTop:t,fixed:r})=>isNumber$1(t)&&isBoolean$1(r),[CHANGE_EVENT]:t=>isBoolean$1(t)};var _export_sfc=(t,r)=>{const e=t.__vccOpts||t;for(const[n,o]of r)e[n]=o;return e};const COMPONENT_NAME$9="ElAffix",__default__$L=defineComponent({name:COMPONENT_NAME$9}),_sfc_main$17=defineComponent({...__default__$L,props:affixProps,emits:affixEmits,setup(t,{expose:r,emit:e}){const n=t,o=useNamespace("affix"),s=shallowRef(),a=shallowRef(),i=shallowRef(),{height:u}=useWindowSize(),{height:d,width:c,top:m,bottom:v,update:g}=useElementBounding(a,{windowScroll:!1}),b=useElementBounding(s),T=ref(!1),k=ref(0),y=ref(0),O=computed(()=>({height:T.value?`${d.value}px`:"",width:T.value?`${c.value}px`:""})),D=computed(()=>{if(!T.value)return{};const Ne=n.offset?addUnit(n.offset):0;return{height:`${d.value}px`,width:`${c.value}px`,top:n.position==="top"?Ne:"",bottom:n.position==="bottom"?Ne:"",transform:y.value?`translateY(${y.value}px)`:"",zIndex:n.zIndex}}),he=()=>{if(i.value)if(k.value=i.value instanceof Window?document.documentElement.scrollTop:i.value.scrollTop||0,n.position==="top")if(n.target){const Ne=b.bottom.value-n.offset-d.value;T.value=n.offset>m.value&&b.bottom.value>0,y.value=Ne<0?Ne:0}else T.value=n.offset>m.value;else if(n.target){const Ne=u.value-b.top.value-n.offset-d.value;T.value=u.value-n.offset<v.value&&u.value>b.top.value,y.value=Ne<0?-Ne:0}else T.value=u.value-n.offset<v.value},ae=()=>{g(),e("scroll",{scrollTop:k.value,fixed:T.value})};return watch(T,Ne=>e("change",Ne)),onMounted(()=>{var Ne;n.target?(s.value=(Ne=document.querySelector(n.target))!=null?Ne:void 0,s.value||throwError(COMPONENT_NAME$9,`Target is not existed: ${n.target}`)):s.value=document.documentElement,i.value=getScrollContainer(a.value,!0),g()}),useEventListener(i,"scroll",ae),watchEffect(he),r({update:he,updateRoot:g}),(Ne,ue)=>(openBlock(),createElementBlock("div",{ref_key:"root",ref:a,class:normalizeClass(unref(o).b()),style:normalizeStyle(unref(O))},[createBaseVNode("div",{class:normalizeClass({[unref(o).m("fixed")]:T.value}),style:normalizeStyle(unref(D))},[renderSlot(Ne.$slots,"default")],6)],6))}});var Affix=_export_sfc(_sfc_main$17,[["__file","/home/runner/work/element-plus/element-plus/packages/components/affix/src/affix.vue"]]);const ElAffix=withInstall(Affix),iconProps=buildProps({size:{type:definePropType([Number,String])},color:{type:String}}),__default__$K=defineComponent({name:"ElIcon",inheritAttrs:!1}),_sfc_main$16=defineComponent({...__default__$K,props:iconProps,setup(t){const r=t,e=useNamespace("icon"),n=computed(()=>{const{size:o,color:s}=r;return!o&&!s?{}:{fontSize:isUndefined$1(o)?void 0:addUnit(o),"--color":s}});return(o,s)=>(openBlock(),createElementBlock("i",mergeProps({class:unref(e).b(),style:unref(n)},o.$attrs),[renderSlot(o.$slots,"default")],16))}});var Icon=_export_sfc(_sfc_main$16,[["__file","/home/runner/work/element-plus/element-plus/packages/components/icon/src/icon.vue"]]);const ElIcon=withInstall(Icon),formContextKey=Symbol("formContextKey"),formItemContextKey=Symbol("formItemContextKey"),useFormSize=(t,r={})=>{const e=ref(void 0),n=r.prop?e:useProp("size"),o=r.global?e:useGlobalSize(),s=r.form?{size:void 0}:inject(formContextKey,void 0),a=r.formItem?{size:void 0}:inject(formItemContextKey,void 0);return computed(()=>n.value||unref(t)||(a==null?void 0:a.size)||(s==null?void 0:s.size)||o.value||"")},useFormDisabled=t=>{const r=useProp("disabled"),e=inject(formContextKey,void 0);return computed(()=>r.value||unref(t)||(e==null?void 0:e.disabled)||!1)},useFormItem=()=>{const t=inject(formContextKey,void 0),r=inject(formItemContextKey,void 0);return{form:t,formItem:r}},useFormItemInputId=(t,{formItemContext:r,disableIdGeneration:e,disableIdManagement:n})=>{e||(e=ref(!1)),n||(n=ref(!1));const o=ref();let s;const a=computed(()=>{var i;return!!(!t.label&&r&&r.inputIds&&((i=r.inputIds)==null?void 0:i.length)<=1)});return onMounted(()=>{s=watch([toRef(t,"id"),e],([i,u])=>{const d=i??(u?void 0:useId().value);d!==o.value&&(r!=null&&r.removeInputId&&(o.value&&r.removeInputId(o.value),!(n!=null&&n.value)&&!u&&d&&r.addInputId(d)),o.value=d)},{immediate:!0})}),onUnmounted(()=>{s&&s(),r!=null&&r.removeInputId&&o.value&&r.removeInputId(o.value)}),{isLabeledByFormItem:a,inputId:o}},formMetaProps=buildProps({size:{type:String,values:componentSizes},disabled:Boolean}),formProps=buildProps({...formMetaProps,model:Object,rules:{type:definePropType(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),formEmits={validate:(t,r,e)=>(isArray$4(t)||isString$2(t))&&isBoolean$1(r)&&isString$2(e)};function useFormLabelWidth(){const t=ref([]),r=computed(()=>{if(!t.value.length)return"0";const s=Math.max(...t.value);return s?`${s}px`:""});function e(s){const a=t.value.indexOf(s);return a===-1&&r.value,a}function n(s,a){if(s&&a){const i=e(a);t.value.splice(i,1,s)}else s&&t.value.push(s)}function o(s){const a=e(s);a>-1&&t.value.splice(a,1)}return{autoLabelWidth:r,registerLabelWidth:n,deregisterLabelWidth:o}}const filterFields=(t,r)=>{const e=castArray$1(r);return e.length>0?t.filter(n=>n.prop&&e.includes(n.prop)):t},COMPONENT_NAME$8="ElForm",__default__$J=defineComponent({name:COMPONENT_NAME$8}),_sfc_main$15=defineComponent({...__default__$J,props:formProps,emits:formEmits,setup(t,{expose:r,emit:e}){const n=t,o=[],s=useFormSize(),a=useNamespace("form"),i=computed(()=>{const{labelPosition:O,inline:D}=n;return[a.b(),a.m(s.value||"default"),{[a.m(`label-${O}`)]:O,[a.m("inline")]:D}]}),u=O=>{o.push(O)},d=O=>{O.prop&&o.splice(o.indexOf(O),1)},c=(O=[])=>{n.model&&filterFields(o,O).forEach(D=>D.resetField())},m=(O=[])=>{filterFields(o,O).forEach(D=>D.clearValidate())},v=computed(()=>!!n.model),g=O=>{if(o.length===0)return[];const D=filterFields(o,O);return D.length?D:[]},b=async O=>k(void 0,O),T=async(O=[])=>{if(!v.value)return!1;const D=g(O);if(D.length===0)return!0;let he={};for(const ae of D)try{await ae.validate("")}catch(Ne){he={...he,...Ne}}return Object.keys(he).length===0?!0:Promise.reject(he)},k=async(O=[],D)=>{const he=!isFunction$3(D);try{const ae=await T(O);return ae===!0&&(D==null||D(ae)),ae}catch(ae){if(ae instanceof Error)throw ae;const Ne=ae;return n.scrollToError&&y(Object.keys(Ne)[0]),D==null||D(!1,Ne),he&&Promise.reject(Ne)}},y=O=>{var D;const he=filterFields(o,O)[0];he&&((D=he.$el)==null||D.scrollIntoView(n.scrollIntoViewOptions))};return watch(()=>n.rules,()=>{n.validateOnRuleChange&&b().catch(O=>void 0)},{deep:!0}),provide(formContextKey,reactive({...toRefs(n),emit:e,resetFields:c,clearValidate:m,validateField:k,addField:u,removeField:d,...useFormLabelWidth()})),r({validate:b,validateField:k,resetFields:c,clearValidate:m,scrollToField:y}),(O,D)=>(openBlock(),createElementBlock("form",{class:normalizeClass(unref(i))},[renderSlot(O.$slots,"default")],2))}});var Form=_export_sfc(_sfc_main$15,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form.vue"]]);function _extends(){return _extends=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},_extends.apply(this,arguments)}function _inheritsLoose(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,_setPrototypeOf(t,r)}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(t)}function _setPrototypeOf(t,r){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf(t,r)}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _construct(t,r,e){return _isNativeReflectConstruct()?_construct=Reflect.construct.bind():_construct=function(o,s,a){var i=[null];i.push.apply(i,s);var u=Function.bind.apply(o,i),d=new u;return a&&_setPrototypeOf(d,a.prototype),d},_construct.apply(null,arguments)}function _isNativeFunction(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function _wrapNativeSuper(t){var r=typeof Map=="function"?new Map:void 0;return _wrapNativeSuper=function(n){if(n===null||!_isNativeFunction(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r<"u"){if(r.has(n))return r.get(n);r.set(n,o)}function o(){return _construct(n,arguments,_getPrototypeOf(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(o,n)},_wrapNativeSuper(t)}var formatRegExp=/%[sdj%]/g,warning=function(){};typeof process<"u"&&process.env;function convertFieldsError(t){if(!t||!t.length)return null;var r={};return t.forEach(function(e){var n=e.field;r[n]=r[n]||[],r[n].push(e)}),r}function format(t){for(var r=arguments.length,e=new Array(r>1?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];var o=0,s=e.length;if(typeof t=="function")return t.apply(null,e);if(typeof t=="string"){var a=t.replace(formatRegExp,function(i){if(i==="%%")return"%";if(o>=s)return i;switch(i){case"%s":return String(e[o++]);case"%d":return Number(e[o++]);case"%j":try{return JSON.stringify(e[o++])}catch{return"[Circular]"}break;default:return i}});return a}return t}function isNativeStringType(t){return t==="string"||t==="url"||t==="hex"||t==="email"||t==="date"||t==="pattern"}function isEmptyValue(t,r){return!!(t==null||r==="array"&&Array.isArray(t)&&!t.length||isNativeStringType(r)&&typeof t=="string"&&!t)}function asyncParallelArray(t,r,e){var n=[],o=0,s=t.length;function a(i){n.push.apply(n,i||[]),o++,o===s&&e(n)}t.forEach(function(i){r(i,a)})}function asyncSerialArray(t,r,e){var n=0,o=t.length;function s(a){if(a&&a.length){e(a);return}var i=n;n=n+1,i<o?r(t[i],s):e([])}s([])}function flattenObjArr(t){var r=[];return Object.keys(t).forEach(function(e){r.push.apply(r,t[e]||[])}),r}var AsyncValidationError=function(t){_inheritsLoose(r,t);function r(e,n){var o;return o=t.call(this,"Async Validation Error")||this,o.errors=e,o.fields=n,o}return r}(_wrapNativeSuper(Error));function asyncMap(t,r,e,n,o){if(r.first){var s=new Promise(function(v,g){var b=function(y){return n(y),y.length?g(new AsyncValidationError(y,convertFieldsError(y))):v(o)},T=flattenObjArr(t);asyncSerialArray(T,e,b)});return s.catch(function(v){return v}),s}var a=r.firstFields===!0?Object.keys(t):r.firstFields||[],i=Object.keys(t),u=i.length,d=0,c=[],m=new Promise(function(v,g){var b=function(k){if(c.push.apply(c,k),d++,d===u)return n(c),c.length?g(new AsyncValidationError(c,convertFieldsError(c))):v(o)};i.length||(n(c),v(o)),i.forEach(function(T){var k=t[T];a.indexOf(T)!==-1?asyncSerialArray(k,e,b):asyncParallelArray(k,e,b)})});return m.catch(function(v){return v}),m}function isErrorObj(t){return!!(t&&t.message!==void 0)}function getValue(t,r){for(var e=t,n=0;n<r.length;n++){if(e==null)return e;e=e[r[n]]}return e}function complementError(t,r){return function(e){var n;return t.fullFields?n=getValue(r,t.fullFields):n=r[e.field||t.fullField],isErrorObj(e)?(e.field=e.field||t.fullField,e.fieldValue=n,e):{message:typeof e=="function"?e():e,fieldValue:n,field:e.field||t.fullField}}}function deepMerge(t,r){if(r){for(var e in r)if(r.hasOwnProperty(e)){var n=r[e];typeof n=="object"&&typeof t[e]=="object"?t[e]=_extends({},t[e],n):t[e]=n}}return t}var required$1=function(r,e,n,o,s,a){r.required&&(!n.hasOwnProperty(r.field)||isEmptyValue(e,a||r.type))&&o.push(format(s.messages.required,r.fullField))},whitespace=function(r,e,n,o,s){(/^\s+$/.test(e)||e==="")&&o.push(format(s.messages.whitespace,r.fullField))},urlReg,getUrlRegex=function(){if(urlReg)return urlReg;var t="[a-fA-F\\d:]",r=function(he){return he&&he.includeBoundaries?"(?:(?<=\\s|^)(?="+t+")|(?<="+t+")(?=\\s|$))":""},e="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",n="[a-fA-F\\d]{1,4}",o=(`
(?:
(?:`+n+":){7}(?:"+n+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+n+":){6}(?:"+e+"|:"+n+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+n+":){5}(?::"+e+"|(?::"+n+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+n+":){4}(?:(?::"+n+"){0,1}:"+e+"|(?::"+n+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+n+":){3}(?:(?::"+n+"){0,2}:"+e+"|(?::"+n+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+n+":){2}(?:(?::"+n+"){0,3}:"+e+"|(?::"+n+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+n+":){1}(?:(?::"+n+"){0,4}:"+e+"|(?::"+n+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+n+"){0,5}:"+e+"|(?::"+n+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),s=new RegExp("(?:^"+e+"$)|(?:^"+o+"$)"),a=new RegExp("^"+e+"$"),i=new RegExp("^"+o+"$"),u=function(he){return he&&he.exact?s:new RegExp("(?:"+r(he)+e+r(he)+")|(?:"+r(he)+o+r(he)+")","g")};u.v4=function(D){return D&&D.exact?a:new RegExp(""+r(D)+e+r(D),"g")},u.v6=function(D){return D&&D.exact?i:new RegExp(""+r(D)+o+r(D),"g")};var d="(?:(?:[a-z]+:)?//)",c="(?:\\S+(?::\\S*)?@)?",m=u.v4().source,v=u.v6().source,g="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",b="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",T="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",k="(?::\\d{2,5})?",y='(?:[/?#][^\\s"]*)?',O="(?:"+d+"|www\\.)"+c+"(?:localhost|"+m+"|"+v+"|"+g+b+T+")"+k+y;return urlReg=new RegExp("(?:^"+O+"$)","i"),urlReg},pattern$2={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},types={integer:function(r){return types.number(r)&&parseInt(r,10)===r},float:function(r){return types.number(r)&&!types.integer(r)},array:function(r){return Array.isArray(r)},regexp:function(r){if(r instanceof RegExp)return!0;try{return!!new RegExp(r)}catch{return!1}},date:function(r){return typeof r.getTime=="function"&&typeof r.getMonth=="function"&&typeof r.getYear=="function"&&!isNaN(r.getTime())},number:function(r){return isNaN(r)?!1:typeof r=="number"},object:function(r){return typeof r=="object"&&!types.array(r)},method:function(r){return typeof r=="function"},email:function(r){return typeof r=="string"&&r.length<=320&&!!r.match(pattern$2.email)},url:function(r){return typeof r=="string"&&r.length<=2048&&!!r.match(getUrlRegex())},hex:function(r){return typeof r=="string"&&!!r.match(pattern$2.hex)}},type$1=function(r,e,n,o,s){if(r.required&&e===void 0){required$1(r,e,n,o,s);return}var a=["integer","float","array","regexp","object","method","email","number","date","url","hex"],i=r.type;a.indexOf(i)>-1?types[i](e)||o.push(format(s.messages.types[i],r.fullField,r.type)):i&&typeof e!==r.type&&o.push(format(s.messages.types[i],r.fullField,r.type))},range$1=function(r,e,n,o,s){var a=typeof r.len=="number",i=typeof r.min=="number",u=typeof r.max=="number",d=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,c=e,m=null,v=typeof e=="number",g=typeof e=="string",b=Array.isArray(e);if(v?m="number":g?m="string":b&&(m="array"),!m)return!1;b&&(c=e.length),g&&(c=e.replace(d,"_").length),a?c!==r.len&&o.push(format(s.messages[m].len,r.fullField,r.len)):i&&!u&&c<r.min?o.push(format(s.messages[m].min,r.fullField,r.min)):u&&!i&&c>r.max?o.push(format(s.messages[m].max,r.fullField,r.max)):i&&u&&(c<r.min||c>r.max)&&o.push(format(s.messages[m].range,r.fullField,r.min,r.max))},ENUM$1="enum",enumerable$1=function(r,e,n,o,s){r[ENUM$1]=Array.isArray(r[ENUM$1])?r[ENUM$1]:[],r[ENUM$1].indexOf(e)===-1&&o.push(format(s.messages[ENUM$1],r.fullField,r[ENUM$1].join(", ")))},pattern$1=function(r,e,n,o,s){if(r.pattern){if(r.pattern instanceof RegExp)r.pattern.lastIndex=0,r.pattern.test(e)||o.push(format(s.messages.pattern.mismatch,r.fullField,e,r.pattern));else if(typeof r.pattern=="string"){var a=new RegExp(r.pattern);a.test(e)||o.push(format(s.messages.pattern.mismatch,r.fullField,e,r.pattern))}}},rules={required:required$1,whitespace,type:type$1,range:range$1,enum:enumerable$1,pattern:pattern$1},string=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e,"string")&&!r.required)return n();rules.required(r,e,o,a,s,"string"),isEmptyValue(e,"string")||(rules.type(r,e,o,a,s),rules.range(r,e,o,a,s),rules.pattern(r,e,o,a,s),r.whitespace===!0&&rules.whitespace(r,e,o,a,s))}n(a)},method=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),e!==void 0&&rules.type(r,e,o,a,s)}n(a)},number=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(e===""&&(e=void 0),isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),e!==void 0&&(rules.type(r,e,o,a,s),rules.range(r,e,o,a,s))}n(a)},_boolean=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),e!==void 0&&rules.type(r,e,o,a,s)}n(a)},regexp=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),isEmptyValue(e)||rules.type(r,e,o,a,s)}n(a)},integer=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),e!==void 0&&(rules.type(r,e,o,a,s),rules.range(r,e,o,a,s))}n(a)},floatFn=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),e!==void 0&&(rules.type(r,e,o,a,s),rules.range(r,e,o,a,s))}n(a)},array=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(e==null&&!r.required)return n();rules.required(r,e,o,a,s,"array"),e!=null&&(rules.type(r,e,o,a,s),rules.range(r,e,o,a,s))}n(a)},object=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),e!==void 0&&rules.type(r,e,o,a,s)}n(a)},ENUM="enum",enumerable=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),e!==void 0&&rules[ENUM](r,e,o,a,s)}n(a)},pattern=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e,"string")&&!r.required)return n();rules.required(r,e,o,a,s),isEmptyValue(e,"string")||rules.pattern(r,e,o,a,s)}n(a)},date=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e,"date")&&!r.required)return n();if(rules.required(r,e,o,a,s),!isEmptyValue(e,"date")){var u;e instanceof Date?u=e:u=new Date(e),rules.type(r,u,o,a,s),u&&rules.range(r,u.getTime(),o,a,s)}}n(a)},required=function(r,e,n,o,s){var a=[],i=Array.isArray(e)?"array":typeof e;rules.required(r,e,o,a,s,i),n(a)},type=function(r,e,n,o,s){var a=r.type,i=[],u=r.required||!r.required&&o.hasOwnProperty(r.field);if(u){if(isEmptyValue(e,a)&&!r.required)return n();rules.required(r,e,o,i,s,a),isEmptyValue(e,a)||rules.type(r,e,o,i,s)}n(i)},any=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s)}n(a)},validators$2={string,method,number,boolean:_boolean,regexp,integer,float:floatFn,array,object,enum:enumerable,pattern,date,url:type,hex:type,email:type,required,any};function newMessages(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var r=JSON.parse(JSON.stringify(this));return r.clone=this.clone,r}}}var messages=newMessages(),Schema=function(){function t(e){this.rules=null,this._messages=messages,this.define(e)}var r=t.prototype;return r.define=function(n){var o=this;if(!n)throw new Error("Cannot configure a schema with no rules");if(typeof n!="object"||Array.isArray(n))throw new Error("Rules must be an object");this.rules={},Object.keys(n).forEach(function(s){var a=n[s];o.rules[s]=Array.isArray(a)?a:[a]})},r.messages=function(n){return n&&(this._messages=deepMerge(newMessages(),n)),this._messages},r.validate=function(n,o,s){var a=this;o===void 0&&(o={}),s===void 0&&(s=function(){});var i=n,u=o,d=s;if(typeof u=="function"&&(d=u,u={}),!this.rules||Object.keys(this.rules).length===0)return d&&d(null,i),Promise.resolve(i);function c(T){var k=[],y={};function O(he){if(Array.isArray(he)){var ae;k=(ae=k).concat.apply(ae,he)}else k.push(he)}for(var D=0;D<T.length;D++)O(T[D]);k.length?(y=convertFieldsError(k),d(k,y)):d(null,i)}if(u.messages){var m=this.messages();m===messages&&(m=newMessages()),deepMerge(m,u.messages),u.messages=m}else u.messages=this.messages();var v={},g=u.keys||Object.keys(this.rules);g.forEach(function(T){var k=a.rules[T],y=i[T];k.forEach(function(O){var D=O;typeof D.transform=="function"&&(i===n&&(i=_extends({},i)),y=i[T]=D.transform(y)),typeof D=="function"?D={validator:D}:D=_extends({},D),D.validator=a.getValidationMethod(D),D.validator&&(D.field=T,D.fullField=D.fullField||T,D.type=a.getType(D),v[T]=v[T]||[],v[T].push({rule:D,value:y,source:i,field:T}))})});var b={};return asyncMap(v,u,function(T,k){var y=T.rule,O=(y.type==="object"||y.type==="array")&&(typeof y.fields=="object"||typeof y.defaultField=="object");O=O&&(y.required||!y.required&&T.value),y.field=T.field;function D(Ne,ue){return _extends({},ue,{fullField:y.fullField+"."+Ne,fullFields:y.fullFields?[].concat(y.fullFields,[Ne]):[Ne]})}function he(Ne){Ne===void 0&&(Ne=[]);var ue=Array.isArray(Ne)?Ne:[Ne];!u.suppressWarning&&ue.length&&t.warning("async-validator:",ue),ue.length&&y.message!==void 0&&(ue=[].concat(y.message));var Y=ue.map(complementError(y,i));if(u.first&&Y.length)return b[y.field]=1,k(Y);if(!O)k(Y);else{if(y.required&&!T.value)return y.message!==void 0?Y=[].concat(y.message).map(complementError(y,i)):u.error&&(Y=[u.error(y,format(u.messages.required,y.field))]),k(Y);var _e={};y.defaultField&&Object.keys(T.value).map(function(ie){_e[ie]=y.defaultField}),_e=_extends({},_e,T.rule.fields);var Ce={};Object.keys(_e).forEach(function(ie){var le=_e[ie],Ie=Array.isArray(le)?le:[le];Ce[ie]=Ie.map(D.bind(null,ie))});var ze=new t(Ce);ze.messages(u.messages),T.rule.options&&(T.rule.options.messages=u.messages,T.rule.options.error=u.error),ze.validate(T.value,T.rule.options||u,function(ie){var le=[];Y&&Y.length&&le.push.apply(le,Y),ie&&ie.length&&le.push.apply(le,ie),k(le.length?le:null)})}}var ae;if(y.asyncValidator)ae=y.asyncValidator(y,T.value,he,T.source,u);else if(y.validator){try{ae=y.validator(y,T.value,he,T.source,u)}catch(Ne){console.error==null||console.error(Ne),u.suppressValidatorError||setTimeout(function(){throw Ne},0),he(Ne.message)}ae===!0?he():ae===!1?he(typeof y.message=="function"?y.message(y.fullField||y.field):y.message||(y.fullField||y.field)+" fails"):ae instanceof Array?he(ae):ae instanceof Error&&he(ae.message)}ae&&ae.then&&ae.then(function(){return he()},function(Ne){return he(Ne)})},function(T){c(T)},i)},r.getType=function(n){if(n.type===void 0&&n.pattern instanceof RegExp&&(n.type="pattern"),typeof n.validator!="function"&&n.type&&!validators$2.hasOwnProperty(n.type))throw new Error(format("Unknown rule type %s",n.type));return n.type||"string"},r.getValidationMethod=function(n){if(typeof n.validator=="function")return n.validator;var o=Object.keys(n),s=o.indexOf("message");return s!==-1&&o.splice(s,1),o.length===1&&o[0]==="required"?validators$2.required:validators$2[this.getType(n)]||void 0},t}();Schema.register=function(r,e){if(typeof e!="function")throw new Error("Cannot register a validator by type, validator is not a function");validators$2[r]=e};Schema.warning=warning;Schema.messages=messages;Schema.validators=validators$2;const formItemValidateStates=["","error","validating","success"],formItemProps=buildProps({label:String,labelWidth:{type:[String,Number],default:""},prop:{type:definePropType([String,Array])},required:{type:Boolean,default:void 0},rules:{type:definePropType([Object,Array])},error:String,validateStatus:{type:String,values:formItemValidateStates},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:componentSizes}}),COMPONENT_NAME$7="ElLabelWrap";var FormLabelWrap=defineComponent({name:COMPONENT_NAME$7,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(t,{slots:r}){const e=inject(formContextKey,void 0),n=inject(formItemContextKey);n||throwError(COMPONENT_NAME$7,"usage: <el-form-item><label-wrap /></el-form-item>");const o=useNamespace("form"),s=ref(),a=ref(0),i=()=>{var c;if((c=s.value)!=null&&c.firstElementChild){const m=window.getComputedStyle(s.value.firstElementChild).width;return Math.ceil(Number.parseFloat(m))}else return 0},u=(c="update")=>{nextTick(()=>{r.default&&t.isAutoWidth&&(c==="update"?a.value=i():c==="remove"&&(e==null||e.deregisterLabelWidth(a.value)))})},d=()=>u("update");return onMounted(()=>{d()}),onBeforeUnmount(()=>{u("remove")}),onUpdated(()=>d()),watch(a,(c,m)=>{t.updateAll&&(e==null||e.registerLabelWidth(c,m))}),useResizeObserver(computed(()=>{var c,m;return(m=(c=s.value)==null?void 0:c.firstElementChild)!=null?m:null}),d),()=>{var c,m;if(!r)return null;const{isAutoWidth:v}=t;if(v){const g=e==null?void 0:e.autoLabelWidth,b=n==null?void 0:n.hasLabel,T={};if(b&&g&&g!=="auto"){const k=Math.max(0,Number.parseInt(g,10)-a.value),y=e.labelPosition==="left"?"marginRight":"marginLeft";k&&(T[y]=`${k}px`)}return createVNode("div",{ref:s,class:[o.be("item","label-wrap")],style:T},[(c=r.default)==null?void 0:c.call(r)])}else return createVNode(Fragment,{ref:s},[(m=r.default)==null?void 0:m.call(r)])}}});const _hoisted_1$u=["role","aria-labelledby"],__default__$I=defineComponent({name:"ElFormItem"}),_sfc_main$14=defineComponent({...__default__$I,props:formItemProps,setup(t,{expose:r}){const e=t,n=useSlots(),o=inject(formContextKey,void 0),s=inject(formItemContextKey,void 0),a=useFormSize(void 0,{formItem:!1}),i=useNamespace("form-item"),u=useId().value,d=ref([]),c=ref(""),m=refDebounced(c,100),v=ref(""),g=ref();let b,T=!1;const k=computed(()=>{if((o==null?void 0:o.labelPosition)==="top")return{};const Ue=addUnit(e.labelWidth||(o==null?void 0:o.labelWidth)||"");return Ue?{width:Ue}:{}}),y=computed(()=>{if((o==null?void 0:o.labelPosition)==="top"||o!=null&&o.inline)return{};if(!e.label&&!e.labelWidth&&_e)return{};const Ue=addUnit(e.labelWidth||(o==null?void 0:o.labelWidth)||"");return!e.label&&!n.label?{marginLeft:Ue}:{}}),O=computed(()=>[i.b(),i.m(a.value),i.is("error",c.value==="error"),i.is("validating",c.value==="validating"),i.is("success",c.value==="success"),i.is("required",Ie.value||e.required),i.is("no-asterisk",o==null?void 0:o.hideRequiredAsterisk),(o==null?void 0:o.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[i.m("feedback")]:o==null?void 0:o.statusIcon}]),D=computed(()=>isBoolean$1(e.inlineMessage)?e.inlineMessage:(o==null?void 0:o.inlineMessage)||!1),he=computed(()=>[i.e("error"),{[i.em("error","inline")]:D.value}]),ae=computed(()=>e.prop?isString$2(e.prop)?e.prop:e.prop.join("."):""),Ne=computed(()=>!!(e.label||n.label)),ue=computed(()=>e.for||(d.value.length===1?d.value[0]:void 0)),Y=computed(()=>!ue.value&&Ne.value),_e=!!s,Ce=computed(()=>{const Ue=o==null?void 0:o.model;if(!(!Ue||!e.prop))return getProp(Ue,e.prop).value}),ze=computed(()=>{const{required:Ue}=e,rr=[];e.rules&&rr.push(...castArray$1(e.rules));const or=o==null?void 0:o.rules;if(or&&e.prop){const Pt=getProp(or,e.prop).value;Pt&&rr.push(...castArray$1(Pt))}if(Ue!==void 0){const Pt=rr.map((Et,kt)=>[Et,kt]).filter(([Et])=>Object.keys(Et).includes("required"));if(Pt.length>0)for(const[Et,kt]of Pt)Et.required!==Ue&&(rr[kt]={...Et,required:Ue});else rr.push({required:Ue})}return rr}),ie=computed(()=>ze.value.length>0),le=Ue=>ze.value.filter(or=>!or.trigger||!Ue?!0:Array.isArray(or.trigger)?or.trigger.includes(Ue):or.trigger===Ue).map(({trigger:or,...Pt})=>Pt),Ie=computed(()=>ze.value.some(Ue=>Ue.required)),pe=computed(()=>{var Ue;return m.value==="error"&&e.showMessage&&((Ue=o==null?void 0:o.showMessage)!=null?Ue:!0)}),qe=computed(()=>`${e.label||""}${(o==null?void 0:o.labelSuffix)||""}`),$e=Ue=>{c.value=Ue},Lt=Ue=>{var rr,or;const{errors:Pt,fields:Et}=Ue;(!Pt||!Et)&&console.error(Ue),$e("error"),v.value=Pt?(or=(rr=Pt==null?void 0:Pt[0])==null?void 0:rr.message)!=null?or:`${e.prop} is required`:"",o==null||o.emit("validate",e.prop,!1,v.value)},Dt=()=>{$e("success"),o==null||o.emit("validate",e.prop,!0,"")},dr=async Ue=>{const rr=ae.value;return new Schema({[rr]:Ue}).validate({[rr]:Ce.value},{firstFields:!0}).then(()=>(Dt(),!0)).catch(Pt=>(Lt(Pt),Promise.reject(Pt)))},pr=async(Ue,rr)=>{if(T||!e.prop)return!1;const or=isFunction$3(rr);if(!ie.value)return rr==null||rr(!1),!1;const Pt=le(Ue);return Pt.length===0?(rr==null||rr(!0),!0):($e("validating"),dr(Pt).then(()=>(rr==null||rr(!0),!0)).catch(Et=>{const{fields:kt}=Et;return rr==null||rr(!1,kt),or?!1:Promise.reject(kt)}))},sr=()=>{$e(""),v.value="",T=!1},hr=async()=>{const Ue=o==null?void 0:o.model;if(!Ue||!e.prop)return;const rr=getProp(Ue,e.prop);T=!0,rr.value=clone(b),await nextTick(),sr(),T=!1},Fe=Ue=>{d.value.includes(Ue)||d.value.push(Ue)},nr=Ue=>{d.value=d.value.filter(rr=>rr!==Ue)};watch(()=>e.error,Ue=>{v.value=Ue||"",$e(Ue?"error":"")},{immediate:!0}),watch(()=>e.validateStatus,Ue=>$e(Ue||""));const ir=reactive({...toRefs(e),$el:g,size:a,validateState:c,labelId:u,inputIds:d,isGroup:Y,hasLabel:Ne,addInputId:Fe,removeInputId:nr,resetField:hr,clearValidate:sr,validate:pr});return provide(formItemContextKey,ir),onMounted(()=>{e.prop&&(o==null||o.addField(ir),b=clone(Ce.value))}),onBeforeUnmount(()=>{o==null||o.removeField(ir)}),r({size:a,validateMessage:v,validateState:c,validate:pr,clearValidate:sr,resetField:hr}),(Ue,rr)=>{var or;return openBlock(),createElementBlock("div",{ref_key:"formItemRef",ref:g,class:normalizeClass(unref(O)),role:unref(Y)?"group":void 0,"aria-labelledby":unref(Y)?unref(u):void 0},[createVNode(unref(FormLabelWrap),{"is-auto-width":unref(k).width==="auto","update-all":((or=unref(o))==null?void 0:or.labelWidth)==="auto"},{default:withCtx(()=>[unref(Ne)?(openBlock(),createBlock(resolveDynamicComponent(unref(ue)?"label":"div"),{key:0,id:unref(u),for:unref(ue),class:normalizeClass(unref(i).e("label")),style:normalizeStyle(unref(k))},{default:withCtx(()=>[renderSlot(Ue.$slots,"label",{label:unref(qe)},()=>[createTextVNode(toDisplayString(unref(qe)),1)])]),_:3},8,["id","for","class","style"])):createCommentVNode("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),createBaseVNode("div",{class:normalizeClass(unref(i).e("content")),style:normalizeStyle(unref(y))},[renderSlot(Ue.$slots,"default"),createVNode(TransitionGroup,{name:`${unref(i).namespace.value}-zoom-in-top`},{default:withCtx(()=>[unref(pe)?renderSlot(Ue.$slots,"error",{key:0,error:v.value},()=>[createBaseVNode("div",{class:normalizeClass(unref(he))},toDisplayString(v.value),3)]):createCommentVNode("v-if",!0)]),_:3},8,["name"])],6)],10,_hoisted_1$u)}}});var FormItem=_export_sfc(_sfc_main$14,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form-item.vue"]]);const ElForm=withInstall(Form,{FormItem}),ElFormItem=withNoopInstall(FormItem);let hiddenTextarea;const HIDDEN_STYLE=`
  height:0 !important;
  visibility:hidden !important;
  ${isFirefox()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,CONTEXT_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function calculateNodeStyling(t){const r=window.getComputedStyle(t),e=r.getPropertyValue("box-sizing"),n=Number.parseFloat(r.getPropertyValue("padding-bottom"))+Number.parseFloat(r.getPropertyValue("padding-top")),o=Number.parseFloat(r.getPropertyValue("border-bottom-width"))+Number.parseFloat(r.getPropertyValue("border-top-width"));return{contextStyle:CONTEXT_STYLE.map(a=>`${a}:${r.getPropertyValue(a)}`).join(";"),paddingSize:n,borderSize:o,boxSizing:e}}function calcTextareaHeight(t,r=1,e){var n;hiddenTextarea||(hiddenTextarea=document.createElement("textarea"),document.body.appendChild(hiddenTextarea));const{paddingSize:o,borderSize:s,boxSizing:a,contextStyle:i}=calculateNodeStyling(t);hiddenTextarea.setAttribute("style",`${i};${HIDDEN_STYLE}`),hiddenTextarea.value=t.value||t.placeholder||"";let u=hiddenTextarea.scrollHeight;const d={};a==="border-box"?u=u+s:a==="content-box"&&(u=u-o),hiddenTextarea.value="";const c=hiddenTextarea.scrollHeight-o;if(isNumber$1(r)){let m=c*r;a==="border-box"&&(m=m+o+s),u=Math.max(m,u),d.minHeight=`${m}px`}if(isNumber$1(e)){let m=c*e;a==="border-box"&&(m=m+o+s),u=Math.min(m,u)}return d.height=`${u}px`,(n=hiddenTextarea.parentNode)==null||n.removeChild(hiddenTextarea),hiddenTextarea=void 0,d}const inputProps=buildProps({id:{type:String,default:void 0},size:useSizeProp,disabled:Boolean,modelValue:{type:definePropType([String,Number,Object]),default:""},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:definePropType([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:iconPropType},prefixIcon:{type:iconPropType},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:definePropType([Object,Array,String]),default:()=>mutable({})},autofocus:{type:Boolean,default:!1}}),inputEmits={[UPDATE_MODEL_EVENT]:t=>isString$2(t),input:t=>isString$2(t),change:t=>isString$2(t),focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,clear:()=>!0,mouseleave:t=>t instanceof MouseEvent,mouseenter:t=>t instanceof MouseEvent,keydown:t=>t instanceof Event,compositionstart:t=>t instanceof CompositionEvent,compositionupdate:t=>t instanceof CompositionEvent,compositionend:t=>t instanceof CompositionEvent},_hoisted_1$t=["role"],_hoisted_2$j=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus"],_hoisted_3$a=["id","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus"],__default__$H=defineComponent({name:"ElInput",inheritAttrs:!1}),_sfc_main$13=defineComponent({...__default__$H,props:inputProps,emits:inputEmits,setup(t,{expose:r,emit:e}){const n=t,o=useAttrs$1(),s=useSlots(),a=computed(()=>{const Nr={};return n.containerRole==="combobox"&&(Nr["aria-haspopup"]=o["aria-haspopup"],Nr["aria-owns"]=o["aria-owns"],Nr["aria-expanded"]=o["aria-expanded"]),Nr}),i=computed(()=>[n.type==="textarea"?k.b():T.b(),T.m(g.value),T.is("disabled",b.value),T.is("exceed",Fe.value),{[T.b("group")]:s.prepend||s.append,[T.bm("group","append")]:s.append,[T.bm("group","prepend")]:s.prepend,[T.m("prefix")]:s.prefix||n.prefixIcon,[T.m("suffix")]:s.suffix||n.suffixIcon||n.clearable||n.showPassword,[T.bm("suffix","password-clear")]:dr.value&&pr.value},o.class]),u=computed(()=>[T.e("wrapper"),T.is("focus",Ce.value)]),d=useAttrs({excludeKeys:computed(()=>Object.keys(a.value))}),{form:c,formItem:m}=useFormItem(),{inputId:v}=useFormItemInputId(n,{formItemContext:m}),g=useFormSize(),b=useFormDisabled(),T=useNamespace("input"),k=useNamespace("textarea"),y=shallowRef(),O=shallowRef(),D=ref(!1),he=ref(!1),ae=ref(!1),Ne=ref(),ue=shallowRef(n.inputStyle),Y=computed(()=>y.value||O.value),{wrapperRef:_e,isFocused:Ce,handleFocus:ze,handleBlur:ie}=useFocusController(Y,{afterBlur(){var Nr;n.validateEvent&&((Nr=m==null?void 0:m.validate)==null||Nr.call(m,"blur").catch(Qr=>void 0))}}),le=computed(()=>{var Nr;return(Nr=c==null?void 0:c.statusIcon)!=null?Nr:!1}),Ie=computed(()=>(m==null?void 0:m.validateState)||""),pe=computed(()=>Ie.value&&ValidateComponentsMap[Ie.value]),qe=computed(()=>ae.value?view_default:hide_default),$e=computed(()=>[o.style,n.inputStyle]),Lt=computed(()=>[n.inputStyle,ue.value,{resize:n.resize}]),Dt=computed(()=>isNil(n.modelValue)?"":String(n.modelValue)),dr=computed(()=>n.clearable&&!b.value&&!n.readonly&&!!Dt.value&&(Ce.value||D.value)),pr=computed(()=>n.showPassword&&!b.value&&!n.readonly&&!!Dt.value&&(!!Dt.value||Ce.value)),sr=computed(()=>n.showWordLimit&&!!d.value.maxlength&&(n.type==="text"||n.type==="textarea")&&!b.value&&!n.readonly&&!n.showPassword),hr=computed(()=>Dt.value.length),Fe=computed(()=>!!sr.value&&hr.value>Number(d.value.maxlength)),nr=computed(()=>!!s.suffix||!!n.suffixIcon||dr.value||n.showPassword||sr.value||!!Ie.value&&le.value),[ir,Ue]=useCursor(y);useResizeObserver(O,Nr=>{if(Pt(),!sr.value||n.resize!=="both")return;const Qr=Nr[0],{width:hn}=Qr.contentRect;Ne.value={right:`calc(100% - ${hn+15+6}px)`}});const rr=()=>{const{type:Nr,autosize:Qr}=n;if(!(!isClient||Nr!=="textarea"||!O.value))if(Qr){const hn=isObject$2(Qr)?Qr.minRows:void 0,Ur=isObject$2(Qr)?Qr.maxRows:void 0,qr=calcTextareaHeight(O.value,hn,Ur);ue.value={overflowY:"hidden",...qr},nextTick(()=>{O.value.offsetHeight,ue.value=qr})}else ue.value={minHeight:calcTextareaHeight(O.value).minHeight}},Pt=(Nr=>{let Qr=!1;return()=>{var hn;if(Qr||!n.autosize)return;((hn=O.value)==null?void 0:hn.offsetParent)===null||(Nr(),Qr=!0)}})(rr),Et=()=>{const Nr=Y.value,Qr=n.formatter?n.formatter(Dt.value):Dt.value;!Nr||Nr.value===Qr||(Nr.value=Qr)},kt=async Nr=>{ir();let{value:Qr}=Nr.target;if(n.formatter&&(Qr=n.parser?n.parser(Qr):Qr),!he.value){if(Qr===Dt.value){Et();return}e(UPDATE_MODEL_EVENT,Qr),e("input",Qr),await nextTick(),Et(),Ue()}},er=Nr=>{e("change",Nr.target.value)},cr=Nr=>{e("compositionstart",Nr),he.value=!0},mr=Nr=>{var Qr;e("compositionupdate",Nr);const hn=(Qr=Nr.target)==null?void 0:Qr.value,Ur=hn[hn.length-1]||"";he.value=!isKorean(Ur)},vr=Nr=>{e("compositionend",Nr),he.value&&(he.value=!1,kt(Nr))},Tr=()=>{ae.value=!ae.value,Ir()},Ir=async()=>{var Nr;await nextTick(),(Nr=Y.value)==null||Nr.focus()},kr=()=>{var Nr;return(Nr=Y.value)==null?void 0:Nr.blur()},Ar=Nr=>{D.value=!1,e("mouseleave",Nr)},Rr=Nr=>{D.value=!0,e("mouseenter",Nr)},Cn=Nr=>{e("keydown",Nr)},Or=()=>{var Nr;(Nr=Y.value)==null||Nr.select()},Pr=()=>{e(UPDATE_MODEL_EVENT,""),e("change",""),e("clear"),e("input","")};return watch(()=>n.modelValue,()=>{var Nr;nextTick(()=>rr()),n.validateEvent&&((Nr=m==null?void 0:m.validate)==null||Nr.call(m,"change").catch(Qr=>void 0))}),watch(Dt,()=>Et()),watch(()=>n.type,async()=>{await nextTick(),Et(),rr()}),onMounted(()=>{!n.formatter&&n.parser,Et(),nextTick(rr)}),r({input:y,textarea:O,ref:Y,textareaStyle:Lt,autosize:toRef(n,"autosize"),focus:Ir,blur:kr,select:Or,clear:Pr,resizeTextarea:rr}),(Nr,Qr)=>withDirectives((openBlock(),createElementBlock("div",mergeProps(unref(a),{class:unref(i),style:unref($e),role:Nr.containerRole,onMouseenter:Rr,onMouseleave:Ar}),[createCommentVNode(" input "),Nr.type!=="textarea"?(openBlock(),createElementBlock(Fragment,{key:0},[createCommentVNode(" prepend slot "),Nr.$slots.prepend?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(T).be("group","prepend"))},[renderSlot(Nr.$slots,"prepend")],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{ref_key:"wrapperRef",ref:_e,class:normalizeClass(unref(u))},[createCommentVNode(" prefix slot "),Nr.$slots.prefix||Nr.prefixIcon?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(T).e("prefix"))},[createBaseVNode("span",{class:normalizeClass(unref(T).e("prefix-inner"))},[renderSlot(Nr.$slots,"prefix"),Nr.prefixIcon?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(T).e("icon"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Nr.prefixIcon)))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],2)],2)):createCommentVNode("v-if",!0),createBaseVNode("input",mergeProps({id:unref(v),ref_key:"input",ref:y,class:unref(T).e("inner")},unref(d),{type:Nr.showPassword?ae.value?"text":"password":Nr.type,disabled:unref(b),formatter:Nr.formatter,parser:Nr.parser,readonly:Nr.readonly,autocomplete:Nr.autocomplete,tabindex:Nr.tabindex,"aria-label":Nr.label,placeholder:Nr.placeholder,style:Nr.inputStyle,form:n.form,autofocus:n.autofocus,onCompositionstart:cr,onCompositionupdate:mr,onCompositionend:vr,onInput:kt,onFocus:Qr[0]||(Qr[0]=(...hn)=>unref(ze)&&unref(ze)(...hn)),onBlur:Qr[1]||(Qr[1]=(...hn)=>unref(ie)&&unref(ie)(...hn)),onChange:er,onKeydown:Cn}),null,16,_hoisted_2$j),createCommentVNode(" suffix slot "),unref(nr)?(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(unref(T).e("suffix"))},[createBaseVNode("span",{class:normalizeClass(unref(T).e("suffix-inner"))},[!unref(dr)||!unref(pr)||!unref(sr)?(openBlock(),createElementBlock(Fragment,{key:0},[renderSlot(Nr.$slots,"suffix"),Nr.suffixIcon?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(T).e("icon"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Nr.suffixIcon)))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],64)):createCommentVNode("v-if",!0),unref(dr)?(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass([unref(T).e("icon"),unref(T).e("clear")]),onMousedown:withModifiers(unref(NOOP),["prevent"]),onClick:Pr},{default:withCtx(()=>[createVNode(unref(circle_close_default))]),_:1},8,["class","onMousedown"])):createCommentVNode("v-if",!0),unref(pr)?(openBlock(),createBlock(unref(ElIcon),{key:2,class:normalizeClass([unref(T).e("icon"),unref(T).e("password")]),onClick:Tr},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(qe))))]),_:1},8,["class"])):createCommentVNode("v-if",!0),unref(sr)?(openBlock(),createElementBlock("span",{key:3,class:normalizeClass(unref(T).e("count"))},[createBaseVNode("span",{class:normalizeClass(unref(T).e("count-inner"))},toDisplayString(unref(hr))+" / "+toDisplayString(unref(d).maxlength),3)],2)):createCommentVNode("v-if",!0),unref(Ie)&&unref(pe)&&unref(le)?(openBlock(),createBlock(unref(ElIcon),{key:4,class:normalizeClass([unref(T).e("icon"),unref(T).e("validateIcon"),unref(T).is("loading",unref(Ie)==="validating")])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(pe))))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],2)],2)):createCommentVNode("v-if",!0)],2),createCommentVNode(" append slot "),Nr.$slots.append?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(T).be("group","append"))},[renderSlot(Nr.$slots,"append")],2)):createCommentVNode("v-if",!0)],64)):(openBlock(),createElementBlock(Fragment,{key:1},[createCommentVNode(" textarea "),createBaseVNode("textarea",mergeProps({id:unref(v),ref_key:"textarea",ref:O,class:unref(k).e("inner")},unref(d),{tabindex:Nr.tabindex,disabled:unref(b),readonly:Nr.readonly,autocomplete:Nr.autocomplete,style:unref(Lt),"aria-label":Nr.label,placeholder:Nr.placeholder,form:n.form,autofocus:n.autofocus,onCompositionstart:cr,onCompositionupdate:mr,onCompositionend:vr,onInput:kt,onFocus:Qr[2]||(Qr[2]=(...hn)=>unref(ze)&&unref(ze)(...hn)),onBlur:Qr[3]||(Qr[3]=(...hn)=>unref(ie)&&unref(ie)(...hn)),onChange:er,onKeydown:Cn}),null,16,_hoisted_3$a),unref(sr)?(openBlock(),createElementBlock("span",{key:0,style:normalizeStyle(Ne.value),class:normalizeClass(unref(T).e("count"))},toDisplayString(unref(hr))+" / "+toDisplayString(unref(d).maxlength),7)):createCommentVNode("v-if",!0)],64))],16,_hoisted_1$t)),[[vShow,Nr.type!=="hidden"]])}});var Input=_export_sfc(_sfc_main$13,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input/src/input.vue"]]);const ElInput=withInstall(Input),GAP=4,BAR_MAP={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},renderThumbStyle=({move:t,size:r,bar:e})=>({[e.size]:r,transform:`translate${e.axis}(${t}%)`}),scrollbarContextKey=Symbol("scrollbarContextKey"),thumbProps=buildProps({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),COMPONENT_NAME$6="Thumb",_sfc_main$12=defineComponent({__name:"thumb",props:thumbProps,setup(t){const r=t,e=inject(scrollbarContextKey),n=useNamespace("scrollbar");e||throwError(COMPONENT_NAME$6,"can not inject scrollbar context");const o=ref(),s=ref(),a=ref({}),i=ref(!1);let u=!1,d=!1,c=isClient?document.onselectstart:null;const m=computed(()=>BAR_MAP[r.vertical?"vertical":"horizontal"]),v=computed(()=>renderThumbStyle({size:r.size,move:r.move,bar:m.value})),g=computed(()=>o.value[m.value.offset]**2/e.wrapElement[m.value.scrollSize]/r.ratio/s.value[m.value.offset]),b=Ne=>{var ue;if(Ne.stopPropagation(),Ne.ctrlKey||[1,2].includes(Ne.button))return;(ue=window.getSelection())==null||ue.removeAllRanges(),k(Ne);const Y=Ne.currentTarget;Y&&(a.value[m.value.axis]=Y[m.value.offset]-(Ne[m.value.client]-Y.getBoundingClientRect()[m.value.direction]))},T=Ne=>{if(!s.value||!o.value||!e.wrapElement)return;const ue=Math.abs(Ne.target.getBoundingClientRect()[m.value.direction]-Ne[m.value.client]),Y=s.value[m.value.offset]/2,_e=(ue-Y)*100*g.value/o.value[m.value.offset];e.wrapElement[m.value.scroll]=_e*e.wrapElement[m.value.scrollSize]/100},k=Ne=>{Ne.stopImmediatePropagation(),u=!0,document.addEventListener("mousemove",y),document.addEventListener("mouseup",O),c=document.onselectstart,document.onselectstart=()=>!1},y=Ne=>{if(!o.value||!s.value||u===!1)return;const ue=a.value[m.value.axis];if(!ue)return;const Y=(o.value.getBoundingClientRect()[m.value.direction]-Ne[m.value.client])*-1,_e=s.value[m.value.offset]-ue,Ce=(Y-_e)*100*g.value/o.value[m.value.offset];e.wrapElement[m.value.scroll]=Ce*e.wrapElement[m.value.scrollSize]/100},O=()=>{u=!1,a.value[m.value.axis]=0,document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",O),ae(),d&&(i.value=!1)},D=()=>{d=!1,i.value=!!r.size},he=()=>{d=!0,i.value=u};onBeforeUnmount(()=>{ae(),document.removeEventListener("mouseup",O)});const ae=()=>{document.onselectstart!==c&&(document.onselectstart=c)};return useEventListener(toRef(e,"scrollbarElement"),"mousemove",D),useEventListener(toRef(e,"scrollbarElement"),"mouseleave",he),(Ne,ue)=>(openBlock(),createBlock(Transition,{name:unref(n).b("fade"),persisted:""},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{ref_key:"instance",ref:o,class:normalizeClass([unref(n).e("bar"),unref(n).is(unref(m).key)]),onMousedown:T},[createBaseVNode("div",{ref_key:"thumb",ref:s,class:normalizeClass(unref(n).e("thumb")),style:normalizeStyle(unref(v)),onMousedown:b},null,38)],34),[[vShow,Ne.always||i.value]])]),_:1},8,["name"]))}});var Thumb=_export_sfc(_sfc_main$12,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/thumb.vue"]]);const barProps=buildProps({always:{type:Boolean,default:!0},width:String,height:String,ratioX:{type:Number,default:1},ratioY:{type:Number,default:1}}),_sfc_main$11=defineComponent({__name:"bar",props:barProps,setup(t,{expose:r}){const e=t,n=ref(0),o=ref(0);return r({handleScroll:a=>{if(a){const i=a.offsetHeight-GAP,u=a.offsetWidth-GAP;o.value=a.scrollTop*100/i*e.ratioY,n.value=a.scrollLeft*100/u*e.ratioX}}}),(a,i)=>(openBlock(),createElementBlock(Fragment,null,[createVNode(Thumb,{move:n.value,ratio:a.ratioX,size:a.width,always:a.always},null,8,["move","ratio","size","always"]),createVNode(Thumb,{move:o.value,ratio:a.ratioY,size:a.height,vertical:"",always:a.always},null,8,["move","ratio","size","always"])],64))}});var Bar=_export_sfc(_sfc_main$11,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/bar.vue"]]);const scrollbarProps=buildProps({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:definePropType([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},id:String,role:String,ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical"]}}),scrollbarEmits={scroll:({scrollTop:t,scrollLeft:r})=>[t,r].every(isNumber$1)},COMPONENT_NAME$5="ElScrollbar",__default__$G=defineComponent({name:COMPONENT_NAME$5}),_sfc_main$10=defineComponent({...__default__$G,props:scrollbarProps,emits:scrollbarEmits,setup(t,{expose:r,emit:e}){const n=t,o=useNamespace("scrollbar");let s,a;const i=ref(),u=ref(),d=ref(),c=ref("0"),m=ref("0"),v=ref(),g=ref(1),b=ref(1),T=computed(()=>{const ue={};return n.height&&(ue.height=addUnit(n.height)),n.maxHeight&&(ue.maxHeight=addUnit(n.maxHeight)),[n.wrapStyle,ue]}),k=computed(()=>[n.wrapClass,o.e("wrap"),{[o.em("wrap","hidden-default")]:!n.native}]),y=computed(()=>[o.e("view"),n.viewClass]),O=()=>{var ue;u.value&&((ue=v.value)==null||ue.handleScroll(u.value),e("scroll",{scrollTop:u.value.scrollTop,scrollLeft:u.value.scrollLeft}))};function D(ue,Y){isObject$2(ue)?u.value.scrollTo(ue):isNumber$1(ue)&&isNumber$1(Y)&&u.value.scrollTo(ue,Y)}const he=ue=>{isNumber$1(ue)&&(u.value.scrollTop=ue)},ae=ue=>{isNumber$1(ue)&&(u.value.scrollLeft=ue)},Ne=()=>{if(!u.value)return;const ue=u.value.offsetHeight-GAP,Y=u.value.offsetWidth-GAP,_e=ue**2/u.value.scrollHeight,Ce=Y**2/u.value.scrollWidth,ze=Math.max(_e,n.minSize),ie=Math.max(Ce,n.minSize);g.value=_e/(ue-_e)/(ze/(ue-ze)),b.value=Ce/(Y-Ce)/(ie/(Y-ie)),m.value=ze+GAP<ue?`${ze}px`:"",c.value=ie+GAP<Y?`${ie}px`:""};return watch(()=>n.noresize,ue=>{ue?(s==null||s(),a==null||a()):({stop:s}=useResizeObserver(d,Ne),a=useEventListener("resize",Ne))},{immediate:!0}),watch(()=>[n.maxHeight,n.height],()=>{n.native||nextTick(()=>{var ue;Ne(),u.value&&((ue=v.value)==null||ue.handleScroll(u.value))})}),provide(scrollbarContextKey,reactive({scrollbarElement:i,wrapElement:u})),onMounted(()=>{n.native||nextTick(()=>{Ne()})}),onUpdated(()=>Ne()),r({wrapRef:u,update:Ne,scrollTo:D,setScrollTop:he,setScrollLeft:ae,handleScroll:O}),(ue,Y)=>(openBlock(),createElementBlock("div",{ref_key:"scrollbarRef",ref:i,class:normalizeClass(unref(o).b())},[createBaseVNode("div",{ref_key:"wrapRef",ref:u,class:normalizeClass(unref(k)),style:normalizeStyle(unref(T)),onScroll:O},[(openBlock(),createBlock(resolveDynamicComponent(ue.tag),{id:ue.id,ref_key:"resizeRef",ref:d,class:normalizeClass(unref(y)),style:normalizeStyle(ue.viewStyle),role:ue.role,"aria-label":ue.ariaLabel,"aria-orientation":ue.ariaOrientation},{default:withCtx(()=>[renderSlot(ue.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],38),ue.native?createCommentVNode("v-if",!0):(openBlock(),createBlock(Bar,{key:0,ref_key:"barRef",ref:v,height:m.value,width:c.value,always:ue.always,"ratio-x":b.value,"ratio-y":g.value},null,8,["height","width","always","ratio-x","ratio-y"]))],2))}});var Scrollbar=_export_sfc(_sfc_main$10,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/scrollbar.vue"]]);const ElScrollbar=withInstall(Scrollbar),POPPER_INJECTION_KEY=Symbol("popper"),POPPER_CONTENT_INJECTION_KEY=Symbol("popperContent"),roleTypes=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],popperProps=buildProps({role:{type:String,values:roleTypes,default:"tooltip"}}),__default__$F=defineComponent({name:"ElPopper",inheritAttrs:!1}),_sfc_main$$=defineComponent({...__default__$F,props:popperProps,setup(t,{expose:r}){const e=t,n=ref(),o=ref(),s=ref(),a=ref(),i=computed(()=>e.role),u={triggerRef:n,popperInstanceRef:o,contentRef:s,referenceRef:a,role:i};return r(u),provide(POPPER_INJECTION_KEY,u),(d,c)=>renderSlot(d.$slots,"default")}});var Popper=_export_sfc(_sfc_main$$,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/popper.vue"]]);const popperArrowProps=buildProps({arrowOffset:{type:Number,default:5}}),__default__$E=defineComponent({name:"ElPopperArrow",inheritAttrs:!1}),_sfc_main$_=defineComponent({...__default__$E,props:popperArrowProps,setup(t,{expose:r}){const e=t,n=useNamespace("popper"),{arrowOffset:o,arrowRef:s,arrowStyle:a}=inject(POPPER_CONTENT_INJECTION_KEY,void 0);return watch(()=>e.arrowOffset,i=>{o.value=i}),onBeforeUnmount(()=>{s.value=void 0}),r({arrowRef:s}),(i,u)=>(openBlock(),createElementBlock("span",{ref_key:"arrowRef",ref:s,class:normalizeClass(unref(n).e("arrow")),style:normalizeStyle(unref(a)),"data-popper-arrow":""},null,6))}});var ElPopperArrow=_export_sfc(_sfc_main$_,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/arrow.vue"]]);const NAME="ElOnlyChild",OnlyChild=defineComponent({name:NAME,setup(t,{slots:r,attrs:e}){var n;const o=inject(FORWARD_REF_INJECTION_KEY),s=useForwardRefDirective((n=o==null?void 0:o.setForwardRef)!=null?n:NOOP);return()=>{var a;const i=(a=r.default)==null?void 0:a.call(r,e);if(!i||i.length>1)return null;const u=findFirstLegitChild(i);return u?withDirectives(cloneVNode(u,e),[[s]]):null}}});function findFirstLegitChild(t){if(!t)return null;const r=t;for(const e of r){if(isObject$2(e))switch(e.type){case Comment:continue;case Text:case"svg":return wrapTextContent(e);case Fragment:return findFirstLegitChild(e.children);default:return e}return wrapTextContent(e)}return null}function wrapTextContent(t){const r=useNamespace("only-child");return createVNode("span",{class:r.e("content")},[t])}const popperTriggerProps=buildProps({virtualRef:{type:definePropType(Object)},virtualTriggering:Boolean,onMouseenter:{type:definePropType(Function)},onMouseleave:{type:definePropType(Function)},onClick:{type:definePropType(Function)},onKeydown:{type:definePropType(Function)},onFocus:{type:definePropType(Function)},onBlur:{type:definePropType(Function)},onContextmenu:{type:definePropType(Function)},id:String,open:Boolean}),__default__$D=defineComponent({name:"ElPopperTrigger",inheritAttrs:!1}),_sfc_main$Z=defineComponent({...__default__$D,props:popperTriggerProps,setup(t,{expose:r}){const e=t,{role:n,triggerRef:o}=inject(POPPER_INJECTION_KEY,void 0);useForwardRef(o);const s=computed(()=>i.value?e.id:void 0),a=computed(()=>{if(n&&n.value==="tooltip")return e.open&&e.id?e.id:void 0}),i=computed(()=>{if(n&&n.value!=="tooltip")return n.value}),u=computed(()=>i.value?`${e.open}`:void 0);let d;return onMounted(()=>{watch(()=>e.virtualRef,c=>{c&&(o.value=unrefElement(c))},{immediate:!0}),watch(o,(c,m)=>{d==null||d(),d=void 0,isElement(c)&&(["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"].forEach(v=>{var g;const b=e[v];b&&(c.addEventListener(v.slice(2).toLowerCase(),b),(g=m==null?void 0:m.removeEventListener)==null||g.call(m,v.slice(2).toLowerCase(),b))}),d=watch([s,a,i,u],v=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((g,b)=>{isNil(v[b])?c.removeAttribute(g):c.setAttribute(g,v[b])})},{immediate:!0})),isElement(m)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(v=>m.removeAttribute(v))},{immediate:!0})}),onBeforeUnmount(()=>{d==null||d(),d=void 0}),r({triggerRef:o}),(c,m)=>c.virtualTriggering?createCommentVNode("v-if",!0):(openBlock(),createBlock(unref(OnlyChild),mergeProps({key:0},c.$attrs,{"aria-controls":unref(s),"aria-describedby":unref(a),"aria-expanded":unref(u),"aria-haspopup":unref(i)}),{default:withCtx(()=>[renderSlot(c.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var ElPopperTrigger=_export_sfc(_sfc_main$Z,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/trigger.vue"]]);const FOCUS_AFTER_TRAPPED="focus-trap.focus-after-trapped",FOCUS_AFTER_RELEASED="focus-trap.focus-after-released",FOCUSOUT_PREVENTED="focus-trap.focusout-prevented",FOCUS_AFTER_TRAPPED_OPTS={cancelable:!0,bubbles:!1},FOCUSOUT_PREVENTED_OPTS={cancelable:!0,bubbles:!1},ON_TRAP_FOCUS_EVT="focusAfterTrapped",ON_RELEASE_FOCUS_EVT="focusAfterReleased",FOCUS_TRAP_INJECTION_KEY=Symbol("elFocusTrap"),focusReason=ref(),lastUserFocusTimestamp=ref(0),lastAutomatedFocusTimestamp=ref(0);let focusReasonUserCount=0;const obtainAllFocusableElements=t=>{const r=[],e=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const o=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||o?NodeFilter.FILTER_SKIP:n.tabIndex>=0||n===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;e.nextNode();)r.push(e.currentNode);return r},getVisibleElement=(t,r)=>{for(const e of t)if(!isHidden(e,r))return e},isHidden=(t,r)=>{if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(r&&t===r)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1},getEdges=t=>{const r=obtainAllFocusableElements(t),e=getVisibleElement(r,t),n=getVisibleElement(r.reverse(),t);return[e,n]},isSelectable=t=>t instanceof HTMLInputElement&&"select"in t,tryFocus=(t,r)=>{if(t&&t.focus){const e=document.activeElement;t.focus({preventScroll:!0}),lastAutomatedFocusTimestamp.value=window.performance.now(),t!==e&&isSelectable(t)&&r&&t.select()}};function removeFromStack(t,r){const e=[...t],n=t.indexOf(r);return n!==-1&&e.splice(n,1),e}const createFocusableStack=()=>{let t=[];return{push:n=>{const o=t[0];o&&n!==o&&o.pause(),t=removeFromStack(t,n),t.unshift(n)},remove:n=>{var o,s;t=removeFromStack(t,n),(s=(o=t[0])==null?void 0:o.resume)==null||s.call(o)}}},focusFirstDescendant=(t,r=!1)=>{const e=document.activeElement;for(const n of t)if(tryFocus(n,r),document.activeElement!==e)return},focusableStack=createFocusableStack(),isFocusCausedByUserEvent=()=>lastUserFocusTimestamp.value>lastAutomatedFocusTimestamp.value,notifyFocusReasonPointer=()=>{focusReason.value="pointer",lastUserFocusTimestamp.value=window.performance.now()},notifyFocusReasonKeydown=()=>{focusReason.value="keyboard",lastUserFocusTimestamp.value=window.performance.now()},useFocusReason=()=>(onMounted(()=>{focusReasonUserCount===0&&(document.addEventListener("mousedown",notifyFocusReasonPointer),document.addEventListener("touchstart",notifyFocusReasonPointer),document.addEventListener("keydown",notifyFocusReasonKeydown)),focusReasonUserCount++}),onBeforeUnmount(()=>{focusReasonUserCount--,focusReasonUserCount<=0&&(document.removeEventListener("mousedown",notifyFocusReasonPointer),document.removeEventListener("touchstart",notifyFocusReasonPointer),document.removeEventListener("keydown",notifyFocusReasonKeydown))}),{focusReason,lastUserFocusTimestamp,lastAutomatedFocusTimestamp}),createFocusOutPreventedEvent=t=>new CustomEvent(FOCUSOUT_PREVENTED,{...FOCUSOUT_PREVENTED_OPTS,detail:t}),_sfc_main$Y=defineComponent({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[ON_TRAP_FOCUS_EVT,ON_RELEASE_FOCUS_EVT,"focusin","focusout","focusout-prevented","release-requested"],setup(t,{emit:r}){const e=ref();let n,o;const{focusReason:s}=useFocusReason();useEscapeKeydown(b=>{t.trapped&&!a.paused&&r("release-requested",b)});const a={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},i=b=>{if(!t.loop&&!t.trapped||a.paused)return;const{key:T,altKey:k,ctrlKey:y,metaKey:O,currentTarget:D,shiftKey:he}=b,{loop:ae}=t,Ne=T===EVENT_CODE.tab&&!k&&!y&&!O,ue=document.activeElement;if(Ne&&ue){const Y=D,[_e,Ce]=getEdges(Y);if(_e&&Ce){if(!he&&ue===Ce){const ie=createFocusOutPreventedEvent({focusReason:s.value});r("focusout-prevented",ie),ie.defaultPrevented||(b.preventDefault(),ae&&tryFocus(_e,!0))}else if(he&&[_e,Y].includes(ue)){const ie=createFocusOutPreventedEvent({focusReason:s.value});r("focusout-prevented",ie),ie.defaultPrevented||(b.preventDefault(),ae&&tryFocus(Ce,!0))}}else if(ue===Y){const ie=createFocusOutPreventedEvent({focusReason:s.value});r("focusout-prevented",ie),ie.defaultPrevented||b.preventDefault()}}};provide(FOCUS_TRAP_INJECTION_KEY,{focusTrapRef:e,onKeydown:i}),watch(()=>t.focusTrapEl,b=>{b&&(e.value=b)},{immediate:!0}),watch([e],([b],[T])=>{b&&(b.addEventListener("keydown",i),b.addEventListener("focusin",c),b.addEventListener("focusout",m)),T&&(T.removeEventListener("keydown",i),T.removeEventListener("focusin",c),T.removeEventListener("focusout",m))});const u=b=>{r(ON_TRAP_FOCUS_EVT,b)},d=b=>r(ON_RELEASE_FOCUS_EVT,b),c=b=>{const T=unref(e);if(!T)return;const k=b.target,y=b.relatedTarget,O=k&&T.contains(k);t.trapped||y&&T.contains(y)||(n=y),O&&r("focusin",b),!a.paused&&t.trapped&&(O?o=k:tryFocus(o,!0))},m=b=>{const T=unref(e);if(!(a.paused||!T))if(t.trapped){const k=b.relatedTarget;!isNil(k)&&!T.contains(k)&&setTimeout(()=>{if(!a.paused&&t.trapped){const y=createFocusOutPreventedEvent({focusReason:s.value});r("focusout-prevented",y),y.defaultPrevented||tryFocus(o,!0)}},0)}else{const k=b.target;k&&T.contains(k)||r("focusout",b)}};async function v(){await nextTick();const b=unref(e);if(b){focusableStack.push(a);const T=b.contains(document.activeElement)?n:document.activeElement;if(n=T,!b.contains(T)){const y=new Event(FOCUS_AFTER_TRAPPED,FOCUS_AFTER_TRAPPED_OPTS);b.addEventListener(FOCUS_AFTER_TRAPPED,u),b.dispatchEvent(y),y.defaultPrevented||nextTick(()=>{let O=t.focusStartEl;isString$2(O)||(tryFocus(O),document.activeElement!==O&&(O="first")),O==="first"&&focusFirstDescendant(obtainAllFocusableElements(b),!0),(document.activeElement===T||O==="container")&&tryFocus(b)})}}}function g(){const b=unref(e);if(b){b.removeEventListener(FOCUS_AFTER_TRAPPED,u);const T=new CustomEvent(FOCUS_AFTER_RELEASED,{...FOCUS_AFTER_TRAPPED_OPTS,detail:{focusReason:s.value}});b.addEventListener(FOCUS_AFTER_RELEASED,d),b.dispatchEvent(T),!T.defaultPrevented&&(s.value=="keyboard"||!isFocusCausedByUserEvent()||b.contains(document.activeElement))&&tryFocus(n??document.body),b.removeEventListener(FOCUS_AFTER_RELEASED,d),focusableStack.remove(a)}}return onMounted(()=>{t.trapped&&v(),watch(()=>t.trapped,b=>{b?v():g()})}),onBeforeUnmount(()=>{t.trapped&&g()}),{onKeydown:i}}});function _sfc_render$h(t,r,e,n,o,s){return renderSlot(t.$slots,"default",{handleKeydown:t.onKeydown})}var ElFocusTrap=_export_sfc(_sfc_main$Y,[["render",_sfc_render$h],["__file","/home/runner/work/element-plus/element-plus/packages/components/focus-trap/src/focus-trap.vue"]]);const POSITIONING_STRATEGIES=["fixed","absolute"],popperCoreConfigProps=buildProps({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:definePropType(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:Ee,default:"bottom"},popperOptions:{type:definePropType(Object),default:()=>({})},strategy:{type:String,values:POSITIONING_STRATEGIES,default:"absolute"}}),popperContentProps=buildProps({...popperCoreConfigProps,id:String,style:{type:definePropType([String,Array,Object])},className:{type:definePropType([String,Array,Object])},effect:{type:String,default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:definePropType([String,Array,Object])},popperStyle:{type:definePropType([String,Array,Object])},referenceEl:{type:definePropType(Object)},triggerTargetEl:{type:definePropType(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},ariaLabel:{type:String,default:void 0},virtualTriggering:Boolean,zIndex:Number}),popperContentEmits={mouseenter:t=>t instanceof MouseEvent,mouseleave:t=>t instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},buildPopperOptions=(t,r=[])=>{const{placement:e,strategy:n,popperOptions:o}=t,s={placement:e,strategy:n,...o,modifiers:[...genModifiers(t),...r]};return deriveExtraModifiers(s,o==null?void 0:o.modifiers),s},unwrapMeasurableEl=t=>{if(isClient)return unrefElement(t)};function genModifiers(t){const{offset:r,gpuAcceleration:e,fallbackPlacements:n}=t;return[{name:"offset",options:{offset:[0,r??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:n}},{name:"computeStyles",options:{gpuAcceleration:e}}]}function deriveExtraModifiers(t,r){r&&(t.modifiers=[...t.modifiers,...r??[]])}const DEFAULT_ARROW_OFFSET=0,usePopperContent=t=>{const{popperInstanceRef:r,contentRef:e,triggerRef:n,role:o}=inject(POPPER_INJECTION_KEY,void 0),s=ref(),a=ref(),i=computed(()=>({name:"eventListeners",enabled:!!t.visible})),u=computed(()=>{var y;const O=unref(s),D=(y=unref(a))!=null?y:DEFAULT_ARROW_OFFSET;return{name:"arrow",enabled:!isUndefined$2(O),options:{element:O,padding:D}}}),d=computed(()=>({onFirstUpdate:()=>{b()},...buildPopperOptions(t,[unref(u),unref(i)])})),c=computed(()=>unwrapMeasurableEl(t.referenceEl)||unref(n)),{attributes:m,state:v,styles:g,update:b,forceUpdate:T,instanceRef:k}=usePopper(c,e,d);return watch(k,y=>r.value=y),onMounted(()=>{watch(()=>{var y;return(y=unref(c))==null?void 0:y.getBoundingClientRect()},()=>{b()})}),{attributes:m,arrowRef:s,contentRef:e,instanceRef:k,state:v,styles:g,role:o,forceUpdate:T,update:b}},usePopperContentDOM=(t,{attributes:r,styles:e,role:n})=>{const{nextZIndex:o}=useZIndex(),s=useNamespace("popper"),a=computed(()=>unref(r).popper),i=ref(isNumber$1(t.zIndex)?t.zIndex:o()),u=computed(()=>[s.b(),s.is("pure",t.pure),s.is(t.effect),t.popperClass]),d=computed(()=>[{zIndex:unref(i)},unref(e).popper,t.popperStyle||{}]),c=computed(()=>n.value==="dialog"?"false":void 0),m=computed(()=>unref(e).arrow||{});return{ariaModal:c,arrowStyle:m,contentAttrs:a,contentClass:u,contentStyle:d,contentZIndex:i,updateZIndex:()=>{i.value=isNumber$1(t.zIndex)?t.zIndex:o()}}},usePopperContentFocusTrap=(t,r)=>{const e=ref(!1),n=ref();return{focusStartRef:n,trapped:e,onFocusAfterReleased:d=>{var c;((c=d.detail)==null?void 0:c.focusReason)!=="pointer"&&(n.value="first",r("blur"))},onFocusAfterTrapped:()=>{r("focus")},onFocusInTrap:d=>{t.visible&&!e.value&&(d.target&&(n.value=d.target),e.value=!0)},onFocusoutPrevented:d=>{t.trapping||(d.detail.focusReason==="pointer"&&d.preventDefault(),e.value=!1)},onReleaseRequested:()=>{e.value=!1,r("close")}}},__default__$C=defineComponent({name:"ElPopperContent"}),_sfc_main$X=defineComponent({...__default__$C,props:popperContentProps,emits:popperContentEmits,setup(t,{expose:r,emit:e}){const n=t,{focusStartRef:o,trapped:s,onFocusAfterReleased:a,onFocusAfterTrapped:i,onFocusInTrap:u,onFocusoutPrevented:d,onReleaseRequested:c}=usePopperContentFocusTrap(n,e),{attributes:m,arrowRef:v,contentRef:g,styles:b,instanceRef:T,role:k,update:y}=usePopperContent(n),{ariaModal:O,arrowStyle:D,contentAttrs:he,contentClass:ae,contentStyle:Ne,updateZIndex:ue}=usePopperContentDOM(n,{styles:b,attributes:m,role:k}),Y=inject(formItemContextKey,void 0),_e=ref();provide(POPPER_CONTENT_INJECTION_KEY,{arrowStyle:D,arrowRef:v,arrowOffset:_e}),Y&&(Y.addInputId||Y.removeInputId)&&provide(formItemContextKey,{...Y,addInputId:NOOP,removeInputId:NOOP});let Ce;const ze=(le=!0)=>{y(),le&&ue()},ie=()=>{ze(!1),n.visible&&n.focusOnShow?s.value=!0:n.visible===!1&&(s.value=!1)};return onMounted(()=>{watch(()=>n.triggerTargetEl,(le,Ie)=>{Ce==null||Ce(),Ce=void 0;const pe=unref(le||g.value),qe=unref(Ie||g.value);isElement(pe)&&(Ce=watch([k,()=>n.ariaLabel,O,()=>n.id],$e=>{["role","aria-label","aria-modal","id"].forEach((Lt,Dt)=>{isNil($e[Dt])?pe.removeAttribute(Lt):pe.setAttribute(Lt,$e[Dt])})},{immediate:!0})),qe!==pe&&isElement(qe)&&["role","aria-label","aria-modal","id"].forEach($e=>{qe.removeAttribute($e)})},{immediate:!0}),watch(()=>n.visible,ie,{immediate:!0})}),onBeforeUnmount(()=>{Ce==null||Ce(),Ce=void 0}),r({popperContentRef:g,popperInstanceRef:T,updatePopper:ze,contentStyle:Ne}),(le,Ie)=>(openBlock(),createElementBlock("div",mergeProps({ref_key:"contentRef",ref:g},unref(he),{style:unref(Ne),class:unref(ae),tabindex:"-1",onMouseenter:Ie[0]||(Ie[0]=pe=>le.$emit("mouseenter",pe)),onMouseleave:Ie[1]||(Ie[1]=pe=>le.$emit("mouseleave",pe))}),[createVNode(unref(ElFocusTrap),{trapped:unref(s),"trap-on-focus-in":!0,"focus-trap-el":unref(g),"focus-start-el":unref(o),onFocusAfterTrapped:unref(i),onFocusAfterReleased:unref(a),onFocusin:unref(u),onFocusoutPrevented:unref(d),onReleaseRequested:unref(c)},{default:withCtx(()=>[renderSlot(le.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16))}});var ElPopperContent=_export_sfc(_sfc_main$X,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/content.vue"]]);const ElPopper=withInstall(Popper),TOOLTIP_INJECTION_KEY=Symbol("elTooltip"),useTooltipContentProps=buildProps({...useDelayedToggleProps,...popperContentProps,appendTo:{type:definePropType([String,Object])},content:{type:String,default:""},rawContent:{type:Boolean,default:!1},persistent:Boolean,ariaLabel:String,visible:{type:definePropType(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean}),useTooltipTriggerProps=buildProps({...popperTriggerProps,disabled:Boolean,trigger:{type:definePropType([String,Array]),default:"hover"},triggerKeys:{type:definePropType(Array),default:()=>[EVENT_CODE.enter,EVENT_CODE.space]}}),{useModelToggleProps:useTooltipModelToggleProps,useModelToggleEmits:useTooltipModelToggleEmits,useModelToggle:useTooltipModelToggle}=createModelToggleComposable("visible"),useTooltipProps=buildProps({...popperProps,...useTooltipModelToggleProps,...useTooltipContentProps,...useTooltipTriggerProps,...popperArrowProps,showArrow:{type:Boolean,default:!0}}),tooltipEmits=[...useTooltipModelToggleEmits,"before-show","before-hide","show","hide","open","close"],isTriggerType=(t,r)=>isArray$4(t)?t.includes(r):t===r,whenTrigger=(t,r,e)=>n=>{isTriggerType(unref(t),r)&&e(n)},__default__$B=defineComponent({name:"ElTooltipTrigger"}),_sfc_main$W=defineComponent({...__default__$B,props:useTooltipTriggerProps,setup(t,{expose:r}){const e=t,n=useNamespace("tooltip"),{controlled:o,id:s,open:a,onOpen:i,onClose:u,onToggle:d}=inject(TOOLTIP_INJECTION_KEY,void 0),c=ref(null),m=()=>{if(unref(o)||e.disabled)return!0},v=toRef(e,"trigger"),g=composeEventHandlers(m,whenTrigger(v,"hover",i)),b=composeEventHandlers(m,whenTrigger(v,"hover",u)),T=composeEventHandlers(m,whenTrigger(v,"click",he=>{he.button===0&&d(he)})),k=composeEventHandlers(m,whenTrigger(v,"focus",i)),y=composeEventHandlers(m,whenTrigger(v,"focus",u)),O=composeEventHandlers(m,whenTrigger(v,"contextmenu",he=>{he.preventDefault(),d(he)})),D=composeEventHandlers(m,he=>{const{code:ae}=he;e.triggerKeys.includes(ae)&&(he.preventDefault(),d(he))});return r({triggerRef:c}),(he,ae)=>(openBlock(),createBlock(unref(ElPopperTrigger),{id:unref(s),"virtual-ref":he.virtualRef,open:unref(a),"virtual-triggering":he.virtualTriggering,class:normalizeClass(unref(n).e("trigger")),onBlur:unref(y),onClick:unref(T),onContextmenu:unref(O),onFocus:unref(k),onMouseenter:unref(g),onMouseleave:unref(b),onKeydown:unref(D)},{default:withCtx(()=>[renderSlot(he.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var ElTooltipTrigger=_export_sfc(_sfc_main$W,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/trigger.vue"]]);const __default__$A=defineComponent({name:"ElTooltipContent",inheritAttrs:!1}),_sfc_main$V=defineComponent({...__default__$A,props:useTooltipContentProps,setup(t,{expose:r}){const e=t,{selector:n}=usePopperContainerId(),o=useNamespace("tooltip"),s=ref(null),a=ref(!1),{controlled:i,id:u,open:d,trigger:c,onClose:m,onOpen:v,onShow:g,onHide:b,onBeforeShow:T,onBeforeHide:k}=inject(TOOLTIP_INJECTION_KEY,void 0),y=computed(()=>e.transition||`${o.namespace.value}-fade-in-linear`),O=computed(()=>e.persistent);onBeforeUnmount(()=>{a.value=!0});const D=computed(()=>unref(O)?!0:unref(d)),he=computed(()=>e.disabled?!1:unref(d)),ae=computed(()=>e.appendTo||n.value),Ne=computed(()=>{var $e;return($e=e.style)!=null?$e:{}}),ue=computed(()=>!unref(d)),Y=()=>{b()},_e=()=>{if(unref(i))return!0},Ce=composeEventHandlers(_e,()=>{e.enterable&&unref(c)==="hover"&&v()}),ze=composeEventHandlers(_e,()=>{unref(c)==="hover"&&m()}),ie=()=>{var $e,Lt;(Lt=($e=s.value)==null?void 0:$e.updatePopper)==null||Lt.call($e),T==null||T()},le=()=>{k==null||k()},Ie=()=>{g(),qe=onClickOutside(computed(()=>{var $e;return($e=s.value)==null?void 0:$e.popperContentRef}),()=>{if(unref(i))return;unref(c)!=="hover"&&m()})},pe=()=>{e.virtualTriggering||m()};let qe;return watch(()=>unref(d),$e=>{$e||qe==null||qe()},{flush:"post"}),watch(()=>e.content,()=>{var $e,Lt;(Lt=($e=s.value)==null?void 0:$e.updatePopper)==null||Lt.call($e)}),r({contentRef:s}),($e,Lt)=>(openBlock(),createBlock(Teleport,{disabled:!$e.teleported,to:unref(ae)},[createVNode(Transition,{name:unref(y),onAfterLeave:Y,onBeforeEnter:ie,onAfterEnter:Ie,onBeforeLeave:le},{default:withCtx(()=>[unref(D)?withDirectives((openBlock(),createBlock(unref(ElPopperContent),mergeProps({key:0,id:unref(u),ref_key:"contentRef",ref:s},$e.$attrs,{"aria-label":$e.ariaLabel,"aria-hidden":unref(ue),"boundaries-padding":$e.boundariesPadding,"fallback-placements":$e.fallbackPlacements,"gpu-acceleration":$e.gpuAcceleration,offset:$e.offset,placement:$e.placement,"popper-options":$e.popperOptions,strategy:$e.strategy,effect:$e.effect,enterable:$e.enterable,pure:$e.pure,"popper-class":$e.popperClass,"popper-style":[$e.popperStyle,unref(Ne)],"reference-el":$e.referenceEl,"trigger-target-el":$e.triggerTargetEl,visible:unref(he),"z-index":$e.zIndex,onMouseenter:unref(Ce),onMouseleave:unref(ze),onBlur:pe,onClose:unref(m)}),{default:withCtx(()=>[a.value?createCommentVNode("v-if",!0):renderSlot($e.$slots,"default",{key:0})]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[vShow,unref(he)]]):createCommentVNode("v-if",!0)]),_:3},8,["name"])],8,["disabled","to"]))}});var ElTooltipContent=_export_sfc(_sfc_main$V,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/content.vue"]]);const _hoisted_1$s=["innerHTML"],_hoisted_2$i={key:1},__default__$z=defineComponent({name:"ElTooltip"}),_sfc_main$U=defineComponent({...__default__$z,props:useTooltipProps,emits:tooltipEmits,setup(t,{expose:r,emit:e}){const n=t;usePopperContainer();const o=useId(),s=ref(),a=ref(),i=()=>{var y;const O=unref(s);O&&((y=O.popperInstanceRef)==null||y.update())},u=ref(!1),d=ref(),{show:c,hide:m,hasUpdateHandler:v}=useTooltipModelToggle({indicator:u,toggleReason:d}),{onOpen:g,onClose:b}=useDelayedToggle({showAfter:toRef(n,"showAfter"),hideAfter:toRef(n,"hideAfter"),autoClose:toRef(n,"autoClose"),open:c,close:m}),T=computed(()=>isBoolean$1(n.visible)&&!v.value);provide(TOOLTIP_INJECTION_KEY,{controlled:T,id:o,open:readonly(u),trigger:toRef(n,"trigger"),onOpen:y=>{g(y)},onClose:y=>{b(y)},onToggle:y=>{unref(u)?b(y):g(y)},onShow:()=>{e("show",d.value)},onHide:()=>{e("hide",d.value)},onBeforeShow:()=>{e("before-show",d.value)},onBeforeHide:()=>{e("before-hide",d.value)},updatePopper:i}),watch(()=>n.disabled,y=>{y&&u.value&&(u.value=!1)});const k=y=>{var O,D;const he=(D=(O=a.value)==null?void 0:O.contentRef)==null?void 0:D.popperContentRef,ae=(y==null?void 0:y.relatedTarget)||document.activeElement;return he&&he.contains(ae)};return onDeactivated(()=>u.value&&m()),r({popperRef:s,contentRef:a,isFocusInsideContent:k,updatePopper:i,onOpen:g,onClose:b,hide:m}),(y,O)=>(openBlock(),createBlock(unref(ElPopper),{ref_key:"popperRef",ref:s,role:y.role},{default:withCtx(()=>[createVNode(ElTooltipTrigger,{disabled:y.disabled,trigger:y.trigger,"trigger-keys":y.triggerKeys,"virtual-ref":y.virtualRef,"virtual-triggering":y.virtualTriggering},{default:withCtx(()=>[y.$slots.default?renderSlot(y.$slots,"default",{key:0}):createCommentVNode("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),createVNode(ElTooltipContent,{ref_key:"contentRef",ref:a,"aria-label":y.ariaLabel,"boundaries-padding":y.boundariesPadding,content:y.content,disabled:y.disabled,effect:y.effect,enterable:y.enterable,"fallback-placements":y.fallbackPlacements,"hide-after":y.hideAfter,"gpu-acceleration":y.gpuAcceleration,offset:y.offset,persistent:y.persistent,"popper-class":y.popperClass,"popper-style":y.popperStyle,placement:y.placement,"popper-options":y.popperOptions,pure:y.pure,"raw-content":y.rawContent,"reference-el":y.referenceEl,"trigger-target-el":y.triggerTargetEl,"show-after":y.showAfter,strategy:y.strategy,teleported:y.teleported,transition:y.transition,"virtual-triggering":y.virtualTriggering,"z-index":y.zIndex,"append-to":y.appendTo},{default:withCtx(()=>[renderSlot(y.$slots,"content",{},()=>[y.rawContent?(openBlock(),createElementBlock("span",{key:0,innerHTML:y.content},null,8,_hoisted_1$s)):(openBlock(),createElementBlock("span",_hoisted_2$i,toDisplayString(y.content),1))]),y.showArrow?(openBlock(),createBlock(unref(ElPopperArrow),{key:0,"arrow-offset":y.arrowOffset},null,8,["arrow-offset"])):createCommentVNode("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var Tooltip=_export_sfc(_sfc_main$U,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/tooltip.vue"]]);const ElTooltip=withInstall(Tooltip),backtopProps={visibilityHeight:{type:Number,default:200},target:{type:String,default:""},right:{type:Number,default:40},bottom:{type:Number,default:40}},backtopEmits={click:t=>t instanceof MouseEvent},useBackTop=(t,r,e)=>{const n=shallowRef(),o=shallowRef(),s=ref(!1),a=()=>{n.value&&(s.value=n.value.scrollTop>=t.visibilityHeight)},i=d=>{var c;(c=n.value)==null||c.scrollTo({top:0,behavior:"smooth"}),r("click",d)},u=useThrottleFn(a,300,!0);return useEventListener(o,"scroll",u),onMounted(()=>{var d;o.value=document,n.value=document.documentElement,t.target&&(n.value=(d=document.querySelector(t.target))!=null?d:void 0,n.value||throwError(e,`target does not exist: ${t.target}`),o.value=n.value),a()}),{visible:s,handleClick:i}},COMPONENT_NAME$4="ElBacktop",__default__$y=defineComponent({name:COMPONENT_NAME$4}),_sfc_main$T=defineComponent({...__default__$y,props:backtopProps,emits:backtopEmits,setup(t,{emit:r}){const e=t,n=useNamespace("backtop"),{handleClick:o,visible:s}=useBackTop(e,r,COMPONENT_NAME$4),a=computed(()=>({right:`${e.right}px`,bottom:`${e.bottom}px`}));return(i,u)=>(openBlock(),createBlock(Transition,{name:`${unref(n).namespace.value}-fade-in`},{default:withCtx(()=>[unref(s)?(openBlock(),createElementBlock("div",{key:0,style:normalizeStyle(unref(a)),class:normalizeClass(unref(n).b()),onClick:u[0]||(u[0]=withModifiers((...d)=>unref(o)&&unref(o)(...d),["stop"]))},[renderSlot(i.$slots,"default",{},()=>[createVNode(unref(ElIcon),{class:normalizeClass(unref(n).e("icon"))},{default:withCtx(()=>[createVNode(unref(caret_top_default))]),_:1},8,["class"])])],6)):createCommentVNode("v-if",!0)]),_:3},8,["name"]))}});var Backtop=_export_sfc(_sfc_main$T,[["__file","/home/runner/work/element-plus/element-plus/packages/components/backtop/src/backtop.vue"]]);const ElBacktop=withInstall(Backtop),badgeProps=buildProps({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"}}),_hoisted_1$r=["textContent"],__default__$x=defineComponent({name:"ElBadge"}),_sfc_main$S=defineComponent({...__default__$x,props:badgeProps,setup(t,{expose:r}){const e=t,n=useNamespace("badge"),o=computed(()=>e.isDot?"":isNumber$1(e.value)&&isNumber$1(e.max)?e.max<e.value?`${e.max}+`:`${e.value}`:`${e.value}`);return r({content:o}),(s,a)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(n).b())},[renderSlot(s.$slots,"default"),createVNode(Transition,{name:`${unref(n).namespace.value}-zoom-in-center`,persisted:""},{default:withCtx(()=>[withDirectives(createBaseVNode("sup",{class:normalizeClass([unref(n).e("content"),unref(n).em("content",s.type),unref(n).is("fixed",!!s.$slots.default),unref(n).is("dot",s.isDot)]),textContent:toDisplayString(unref(o))},null,10,_hoisted_1$r),[[vShow,!s.hidden&&(unref(o)||s.isDot)]])]),_:1},8,["name"])],2))}});var Badge=_export_sfc(_sfc_main$S,[["__file","/home/runner/work/element-plus/element-plus/packages/components/badge/src/badge.vue"]]);const ElBadge=withInstall(Badge),buttonGroupContextKey=Symbol("buttonGroupContextKey"),useButton=(t,r)=>{useDeprecated({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},computed(()=>t.type==="text"));const e=inject(buttonGroupContextKey,void 0),n=useGlobalConfig("button"),{form:o}=useFormItem(),s=useFormSize(computed(()=>e==null?void 0:e.size)),a=useFormDisabled(),i=ref(),u=useSlots(),d=computed(()=>t.type||(e==null?void 0:e.type)||""),c=computed(()=>{var b,T,k;return(k=(T=t.autoInsertSpace)!=null?T:(b=n.value)==null?void 0:b.autoInsertSpace)!=null?k:!1}),m=computed(()=>t.tag==="button"?{ariaDisabled:a.value||t.loading,disabled:a.value||t.loading,autofocus:t.autofocus,type:t.nativeType}:{}),v=computed(()=>{var b;const T=(b=u.default)==null?void 0:b.call(u);if(c.value&&(T==null?void 0:T.length)===1){const k=T[0];if((k==null?void 0:k.type)===Text){const y=k.children;return/^\p{Unified_Ideograph}{2}$/u.test(y.trim())}}return!1});return{_disabled:a,_size:s,_type:d,_ref:i,_props:m,shouldAddSpace:v,handleClick:b=>{t.nativeType==="reset"&&(o==null||o.resetFields()),r("click",b)}}},buttonTypes=["default","primary","success","warning","info","danger","text",""],buttonNativeTypes=["button","submit","reset"],buttonProps=buildProps({size:useSizeProp,disabled:Boolean,type:{type:String,values:buttonTypes,default:""},icon:{type:iconPropType},nativeType:{type:String,values:buttonNativeTypes,default:"button"},loading:Boolean,loadingIcon:{type:iconPropType,default:()=>loading_default},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:definePropType([String,Object]),default:"button"}}),buttonEmits={click:t=>t instanceof MouseEvent};function bound01(t,r){isOnePointZero(t)&&(t="100%");var e=isPercentage(t);return t=r===360?t:Math.min(r,Math.max(0,parseFloat(t))),e&&(t=parseInt(String(t*r),10)/100),Math.abs(t-r)<1e-6?1:(r===360?t=(t<0?t%r+r:t%r)/parseFloat(String(r)):t=t%r/parseFloat(String(r)),t)}function clamp01(t){return Math.min(1,Math.max(0,t))}function isOnePointZero(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function isPercentage(t){return typeof t=="string"&&t.indexOf("%")!==-1}function boundAlpha(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function convertToPercentage(t){return t<=1?"".concat(Number(t)*100,"%"):t}function pad2(t){return t.length===1?"0"+t:String(t)}function rgbToRgb(t,r,e){return{r:bound01(t,255)*255,g:bound01(r,255)*255,b:bound01(e,255)*255}}function rgbToHsl(t,r,e){t=bound01(t,255),r=bound01(r,255),e=bound01(e,255);var n=Math.max(t,r,e),o=Math.min(t,r,e),s=0,a=0,i=(n+o)/2;if(n===o)a=0,s=0;else{var u=n-o;switch(a=i>.5?u/(2-n-o):u/(n+o),n){case t:s=(r-e)/u+(r<e?6:0);break;case r:s=(e-t)/u+2;break;case e:s=(t-r)/u+4;break}s/=6}return{h:s,s:a,l:i}}function hue2rgb(t,r,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+(r-t)*(6*e):e<1/2?r:e<2/3?t+(r-t)*(2/3-e)*6:t}function hslToRgb(t,r,e){var n,o,s;if(t=bound01(t,360),r=bound01(r,100),e=bound01(e,100),r===0)o=e,s=e,n=e;else{var a=e<.5?e*(1+r):e+r-e*r,i=2*e-a;n=hue2rgb(i,a,t+1/3),o=hue2rgb(i,a,t),s=hue2rgb(i,a,t-1/3)}return{r:n*255,g:o*255,b:s*255}}function rgbToHsv(t,r,e){t=bound01(t,255),r=bound01(r,255),e=bound01(e,255);var n=Math.max(t,r,e),o=Math.min(t,r,e),s=0,a=n,i=n-o,u=n===0?0:i/n;if(n===o)s=0;else{switch(n){case t:s=(r-e)/i+(r<e?6:0);break;case r:s=(e-t)/i+2;break;case e:s=(t-r)/i+4;break}s/=6}return{h:s,s:u,v:a}}function hsvToRgb(t,r,e){t=bound01(t,360)*6,r=bound01(r,100),e=bound01(e,100);var n=Math.floor(t),o=t-n,s=e*(1-r),a=e*(1-o*r),i=e*(1-(1-o)*r),u=n%6,d=[e,a,s,s,i,e][u],c=[i,e,e,a,s,s][u],m=[s,s,i,e,e,a][u];return{r:d*255,g:c*255,b:m*255}}function rgbToHex(t,r,e,n){var o=[pad2(Math.round(t).toString(16)),pad2(Math.round(r).toString(16)),pad2(Math.round(e).toString(16))];return n&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function rgbaToHex(t,r,e,n,o){var s=[pad2(Math.round(t).toString(16)),pad2(Math.round(r).toString(16)),pad2(Math.round(e).toString(16)),pad2(convertDecimalToHex(n))];return o&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function convertDecimalToHex(t){return Math.round(parseFloat(t)*255).toString(16)}function convertHexToDecimal(t){return parseIntFromHex(t)/255}function parseIntFromHex(t){return parseInt(t,16)}function numberInputToObject(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function inputToRGB(t){var r={r:0,g:0,b:0},e=1,n=null,o=null,s=null,a=!1,i=!1;return typeof t=="string"&&(t=stringInputToObject(t)),typeof t=="object"&&(isValidCSSUnit(t.r)&&isValidCSSUnit(t.g)&&isValidCSSUnit(t.b)?(r=rgbToRgb(t.r,t.g,t.b),a=!0,i=String(t.r).substr(-1)==="%"?"prgb":"rgb"):isValidCSSUnit(t.h)&&isValidCSSUnit(t.s)&&isValidCSSUnit(t.v)?(n=convertToPercentage(t.s),o=convertToPercentage(t.v),r=hsvToRgb(t.h,n,o),a=!0,i="hsv"):isValidCSSUnit(t.h)&&isValidCSSUnit(t.s)&&isValidCSSUnit(t.l)&&(n=convertToPercentage(t.s),s=convertToPercentage(t.l),r=hslToRgb(t.h,n,s),a=!0,i="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(e=t.a)),e=boundAlpha(e),{ok:a,format:t.format||i,r:Math.min(255,Math.max(r.r,0)),g:Math.min(255,Math.max(r.g,0)),b:Math.min(255,Math.max(r.b,0)),a:e}}var CSS_INTEGER="[-\\+]?\\d+%?",CSS_NUMBER="[-\\+]?\\d*\\.\\d+%?",CSS_UNIT="(?:".concat(CSS_NUMBER,")|(?:").concat(CSS_INTEGER,")"),PERMISSIVE_MATCH3="[\\s|\\(]+(".concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")\\s*\\)?"),PERMISSIVE_MATCH4="[\\s|\\(]+(".concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")\\s*\\)?"),matchers={CSS_UNIT:new RegExp(CSS_UNIT),rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function stringInputToObject(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var r=!1;if(names[t])t=names[t],r=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var e=matchers.rgb.exec(t);return e?{r:e[1],g:e[2],b:e[3]}:(e=matchers.rgba.exec(t),e?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=matchers.hsl.exec(t),e?{h:e[1],s:e[2],l:e[3]}:(e=matchers.hsla.exec(t),e?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=matchers.hsv.exec(t),e?{h:e[1],s:e[2],v:e[3]}:(e=matchers.hsva.exec(t),e?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=matchers.hex8.exec(t),e?{r:parseIntFromHex(e[1]),g:parseIntFromHex(e[2]),b:parseIntFromHex(e[3]),a:convertHexToDecimal(e[4]),format:r?"name":"hex8"}:(e=matchers.hex6.exec(t),e?{r:parseIntFromHex(e[1]),g:parseIntFromHex(e[2]),b:parseIntFromHex(e[3]),format:r?"name":"hex"}:(e=matchers.hex4.exec(t),e?{r:parseIntFromHex(e[1]+e[1]),g:parseIntFromHex(e[2]+e[2]),b:parseIntFromHex(e[3]+e[3]),a:convertHexToDecimal(e[4]+e[4]),format:r?"name":"hex8"}:(e=matchers.hex3.exec(t),e?{r:parseIntFromHex(e[1]+e[1]),g:parseIntFromHex(e[2]+e[2]),b:parseIntFromHex(e[3]+e[3]),format:r?"name":"hex"}:!1)))))))))}function isValidCSSUnit(t){return!!matchers.CSS_UNIT.exec(String(t))}var TinyColor=function(){function t(r,e){r===void 0&&(r=""),e===void 0&&(e={});var n;if(r instanceof t)return r;typeof r=="number"&&(r=numberInputToObject(r)),this.originalInput=r;var o=inputToRGB(r);this.originalInput=r,this.r=o.r,this.g=o.g,this.b=o.b,this.a=o.a,this.roundA=Math.round(100*this.a)/100,this.format=(n=e.format)!==null&&n!==void 0?n:o.format,this.gradientType=e.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=o.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var r=this.toRgb();return(r.r*299+r.g*587+r.b*114)/1e3},t.prototype.getLuminance=function(){var r=this.toRgb(),e,n,o,s=r.r/255,a=r.g/255,i=r.b/255;return s<=.03928?e=s/12.92:e=Math.pow((s+.055)/1.055,2.4),a<=.03928?n=a/12.92:n=Math.pow((a+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),.2126*e+.7152*n+.0722*o},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(r){return this.a=boundAlpha(r),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var r=this.toHsl().s;return r===0},t.prototype.toHsv=function(){var r=rgbToHsv(this.r,this.g,this.b);return{h:r.h*360,s:r.s,v:r.v,a:this.a}},t.prototype.toHsvString=function(){var r=rgbToHsv(this.r,this.g,this.b),e=Math.round(r.h*360),n=Math.round(r.s*100),o=Math.round(r.v*100);return this.a===1?"hsv(".concat(e,", ").concat(n,"%, ").concat(o,"%)"):"hsva(".concat(e,", ").concat(n,"%, ").concat(o,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var r=rgbToHsl(this.r,this.g,this.b);return{h:r.h*360,s:r.s,l:r.l,a:this.a}},t.prototype.toHslString=function(){var r=rgbToHsl(this.r,this.g,this.b),e=Math.round(r.h*360),n=Math.round(r.s*100),o=Math.round(r.l*100);return this.a===1?"hsl(".concat(e,", ").concat(n,"%, ").concat(o,"%)"):"hsla(".concat(e,", ").concat(n,"%, ").concat(o,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(r){return r===void 0&&(r=!1),rgbToHex(this.r,this.g,this.b,r)},t.prototype.toHexString=function(r){return r===void 0&&(r=!1),"#"+this.toHex(r)},t.prototype.toHex8=function(r){return r===void 0&&(r=!1),rgbaToHex(this.r,this.g,this.b,this.a,r)},t.prototype.toHex8String=function(r){return r===void 0&&(r=!1),"#"+this.toHex8(r)},t.prototype.toHexShortString=function(r){return r===void 0&&(r=!1),this.a===1?this.toHexString(r):this.toHex8String(r)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var r=Math.round(this.r),e=Math.round(this.g),n=Math.round(this.b);return this.a===1?"rgb(".concat(r,", ").concat(e,", ").concat(n,")"):"rgba(".concat(r,", ").concat(e,", ").concat(n,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var r=function(e){return"".concat(Math.round(bound01(e,255)*100),"%")};return{r:r(this.r),g:r(this.g),b:r(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var r=function(e){return Math.round(bound01(e,255)*100)};return this.a===1?"rgb(".concat(r(this.r),"%, ").concat(r(this.g),"%, ").concat(r(this.b),"%)"):"rgba(".concat(r(this.r),"%, ").concat(r(this.g),"%, ").concat(r(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var r="#"+rgbToHex(this.r,this.g,this.b,!1),e=0,n=Object.entries(names);e<n.length;e++){var o=n[e],s=o[0],a=o[1];if(r===a)return s}return!1},t.prototype.toString=function(r){var e=!!r;r=r??this.format;var n=!1,o=this.a<1&&this.a>=0,s=!e&&o&&(r.startsWith("hex")||r==="name");return s?r==="name"&&this.a===0?this.toName():this.toRgbString():(r==="rgb"&&(n=this.toRgbString()),r==="prgb"&&(n=this.toPercentageRgbString()),(r==="hex"||r==="hex6")&&(n=this.toHexString()),r==="hex3"&&(n=this.toHexString(!0)),r==="hex4"&&(n=this.toHex8String(!0)),r==="hex8"&&(n=this.toHex8String()),r==="name"&&(n=this.toName()),r==="hsl"&&(n=this.toHslString()),r==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.l+=r/100,e.l=clamp01(e.l),new t(e)},t.prototype.brighten=function(r){r===void 0&&(r=10);var e=this.toRgb();return e.r=Math.max(0,Math.min(255,e.r-Math.round(255*-(r/100)))),e.g=Math.max(0,Math.min(255,e.g-Math.round(255*-(r/100)))),e.b=Math.max(0,Math.min(255,e.b-Math.round(255*-(r/100)))),new t(e)},t.prototype.darken=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.l-=r/100,e.l=clamp01(e.l),new t(e)},t.prototype.tint=function(r){return r===void 0&&(r=10),this.mix("white",r)},t.prototype.shade=function(r){return r===void 0&&(r=10),this.mix("black",r)},t.prototype.desaturate=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.s-=r/100,e.s=clamp01(e.s),new t(e)},t.prototype.saturate=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.s+=r/100,e.s=clamp01(e.s),new t(e)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(r){var e=this.toHsl(),n=(e.h+r)%360;return e.h=n<0?360+n:n,new t(e)},t.prototype.mix=function(r,e){e===void 0&&(e=50);var n=this.toRgb(),o=new t(r).toRgb(),s=e/100,a={r:(o.r-n.r)*s+n.r,g:(o.g-n.g)*s+n.g,b:(o.b-n.b)*s+n.b,a:(o.a-n.a)*s+n.a};return new t(a)},t.prototype.analogous=function(r,e){r===void 0&&(r=6),e===void 0&&(e=30);var n=this.toHsl(),o=360/e,s=[this];for(n.h=(n.h-(o*r>>1)+720)%360;--r;)n.h=(n.h+o)%360,s.push(new t(n));return s},t.prototype.complement=function(){var r=this.toHsl();return r.h=(r.h+180)%360,new t(r)},t.prototype.monochromatic=function(r){r===void 0&&(r=6);for(var e=this.toHsv(),n=e.h,o=e.s,s=e.v,a=[],i=1/r;r--;)a.push(new t({h:n,s:o,v:s})),s=(s+i)%1;return a},t.prototype.splitcomplement=function(){var r=this.toHsl(),e=r.h;return[this,new t({h:(e+72)%360,s:r.s,l:r.l}),new t({h:(e+216)%360,s:r.s,l:r.l})]},t.prototype.onBackground=function(r){var e=this.toRgb(),n=new t(r).toRgb(),o=e.a+n.a*(1-e.a);return new t({r:(e.r*e.a+n.r*n.a*(1-e.a))/o,g:(e.g*e.a+n.g*n.a*(1-e.a))/o,b:(e.b*e.a+n.b*n.a*(1-e.a))/o,a:o})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(r){for(var e=this.toHsl(),n=e.h,o=[this],s=360/r,a=1;a<r;a++)o.push(new t({h:(n+a*s)%360,s:e.s,l:e.l}));return o},t.prototype.equals=function(r){return this.toRgbString()===new t(r).toRgbString()},t}();function darken(t,r=20){return t.mix("#141414",r).toString()}function useButtonCustomStyle(t){const r=useFormDisabled(),e=useNamespace("button");return computed(()=>{let n={};const o=t.color;if(o){const s=new TinyColor(o),a=t.dark?s.tint(20).toString():darken(s,20);if(t.plain)n=e.cssVarBlock({"bg-color":t.dark?darken(s,90):s.tint(90).toString(),"text-color":o,"border-color":t.dark?darken(s,50):s.tint(50).toString(),"hover-text-color":`var(${e.cssVarName("color-white")})`,"hover-bg-color":o,"hover-border-color":o,"active-bg-color":a,"active-text-color":`var(${e.cssVarName("color-white")})`,"active-border-color":a}),r.value&&(n[e.cssVarBlockName("disabled-bg-color")]=t.dark?darken(s,90):s.tint(90).toString(),n[e.cssVarBlockName("disabled-text-color")]=t.dark?darken(s,50):s.tint(50).toString(),n[e.cssVarBlockName("disabled-border-color")]=t.dark?darken(s,80):s.tint(80).toString());else{const i=t.dark?darken(s,30):s.tint(30).toString(),u=s.isDark()?`var(${e.cssVarName("color-white")})`:`var(${e.cssVarName("color-black")})`;if(n=e.cssVarBlock({"bg-color":o,"text-color":u,"border-color":o,"hover-bg-color":i,"hover-text-color":u,"hover-border-color":i,"active-bg-color":a,"active-border-color":a}),r.value){const d=t.dark?darken(s,50):s.tint(50).toString();n[e.cssVarBlockName("disabled-bg-color")]=d,n[e.cssVarBlockName("disabled-text-color")]=t.dark?"rgba(255, 255, 255, 0.5)":`var(${e.cssVarName("color-white")})`,n[e.cssVarBlockName("disabled-border-color")]=d}}}return n})}const __default__$w=defineComponent({name:"ElButton"}),_sfc_main$R=defineComponent({...__default__$w,props:buttonProps,emits:buttonEmits,setup(t,{expose:r,emit:e}){const n=t,o=useButtonCustomStyle(n),s=useNamespace("button"),{_ref:a,_size:i,_type:u,_disabled:d,_props:c,shouldAddSpace:m,handleClick:v}=useButton(n,e);return r({ref:a,size:i,type:u,disabled:d,shouldAddSpace:m}),(g,b)=>(openBlock(),createBlock(resolveDynamicComponent(g.tag),mergeProps({ref_key:"_ref",ref:a},unref(c),{class:[unref(s).b(),unref(s).m(unref(u)),unref(s).m(unref(i)),unref(s).is("disabled",unref(d)),unref(s).is("loading",g.loading),unref(s).is("plain",g.plain),unref(s).is("round",g.round),unref(s).is("circle",g.circle),unref(s).is("text",g.text),unref(s).is("link",g.link),unref(s).is("has-bg",g.bg)],style:unref(o),onClick:unref(v)}),{default:withCtx(()=>[g.loading?(openBlock(),createElementBlock(Fragment,{key:0},[g.$slots.loading?renderSlot(g.$slots,"loading",{key:0}):(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass(unref(s).is("loading"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(g.loadingIcon)))]),_:1},8,["class"]))],64)):g.icon||g.$slots.icon?(openBlock(),createBlock(unref(ElIcon),{key:1},{default:withCtx(()=>[g.icon?(openBlock(),createBlock(resolveDynamicComponent(g.icon),{key:0})):renderSlot(g.$slots,"icon",{key:1})]),_:3})):createCommentVNode("v-if",!0),g.$slots.default?(openBlock(),createElementBlock("span",{key:2,class:normalizeClass({[unref(s).em("text","expand")]:unref(m)})},[renderSlot(g.$slots,"default")],2)):createCommentVNode("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var Button=_export_sfc(_sfc_main$R,[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button.vue"]]);const buttonGroupProps={size:buttonProps.size,type:buttonProps.type},__default__$v=defineComponent({name:"ElButtonGroup"}),_sfc_main$Q=defineComponent({...__default__$v,props:buttonGroupProps,setup(t){const r=t;provide(buttonGroupContextKey,reactive({size:toRef(r,"size"),type:toRef(r,"type")}));const e=useNamespace("button");return(n,o)=>(openBlock(),createElementBlock("div",{class:normalizeClass(`${unref(e).b("group")}`)},[renderSlot(n.$slots,"default")],2))}});var ButtonGroup=_export_sfc(_sfc_main$Q,[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button-group.vue"]]);const ElButton=withInstall(Button,{ButtonGroup});withNoopInstall(ButtonGroup);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dayjs_min={exports:{}};(function(t,r){(function(e,n){t.exports=n()})(commonjsGlobal,function(){var e=1e3,n=6e4,o=36e5,s="millisecond",a="second",i="minute",u="hour",d="day",c="week",m="month",v="quarter",g="year",b="date",T="Invalid Date",k=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,O={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Ie){var pe=["th","st","nd","rd"],qe=Ie%100;return"["+Ie+(pe[(qe-20)%10]||pe[qe]||pe[0])+"]"}},D=function(Ie,pe,qe){var $e=String(Ie);return!$e||$e.length>=pe?Ie:""+Array(pe+1-$e.length).join(qe)+Ie},he={s:D,z:function(Ie){var pe=-Ie.utcOffset(),qe=Math.abs(pe),$e=Math.floor(qe/60),Lt=qe%60;return(pe<=0?"+":"-")+D($e,2,"0")+":"+D(Lt,2,"0")},m:function Ie(pe,qe){if(pe.date()<qe.date())return-Ie(qe,pe);var $e=12*(qe.year()-pe.year())+(qe.month()-pe.month()),Lt=pe.clone().add($e,m),Dt=qe-Lt<0,dr=pe.clone().add($e+(Dt?-1:1),m);return+(-($e+(qe-Lt)/(Dt?Lt-dr:dr-Lt))||0)},a:function(Ie){return Ie<0?Math.ceil(Ie)||0:Math.floor(Ie)},p:function(Ie){return{M:m,y:g,w:c,d,D:b,h:u,m:i,s:a,ms:s,Q:v}[Ie]||String(Ie||"").toLowerCase().replace(/s$/,"")},u:function(Ie){return Ie===void 0}},ae="en",Ne={};Ne[ae]=O;var ue="$isDayjsObject",Y=function(Ie){return Ie instanceof ie||!(!Ie||!Ie[ue])},_e=function Ie(pe,qe,$e){var Lt;if(!pe)return ae;if(typeof pe=="string"){var Dt=pe.toLowerCase();Ne[Dt]&&(Lt=Dt),qe&&(Ne[Dt]=qe,Lt=Dt);var dr=pe.split("-");if(!Lt&&dr.length>1)return Ie(dr[0])}else{var pr=pe.name;Ne[pr]=pe,Lt=pr}return!$e&&Lt&&(ae=Lt),Lt||!$e&&ae},Ce=function(Ie,pe){if(Y(Ie))return Ie.clone();var qe=typeof pe=="object"?pe:{};return qe.date=Ie,qe.args=arguments,new ie(qe)},ze=he;ze.l=_e,ze.i=Y,ze.w=function(Ie,pe){return Ce(Ie,{locale:pe.$L,utc:pe.$u,x:pe.$x,$offset:pe.$offset})};var ie=function(){function Ie(qe){this.$L=_e(qe.locale,null,!0),this.parse(qe),this.$x=this.$x||qe.x||{},this[ue]=!0}var pe=Ie.prototype;return pe.parse=function(qe){this.$d=function($e){var Lt=$e.date,Dt=$e.utc;if(Lt===null)return new Date(NaN);if(ze.u(Lt))return new Date;if(Lt instanceof Date)return new Date(Lt);if(typeof Lt=="string"&&!/Z$/i.test(Lt)){var dr=Lt.match(k);if(dr){var pr=dr[2]-1||0,sr=(dr[7]||"0").substring(0,3);return Dt?new Date(Date.UTC(dr[1],pr,dr[3]||1,dr[4]||0,dr[5]||0,dr[6]||0,sr)):new Date(dr[1],pr,dr[3]||1,dr[4]||0,dr[5]||0,dr[6]||0,sr)}}return new Date(Lt)}(qe),this.init()},pe.init=function(){var qe=this.$d;this.$y=qe.getFullYear(),this.$M=qe.getMonth(),this.$D=qe.getDate(),this.$W=qe.getDay(),this.$H=qe.getHours(),this.$m=qe.getMinutes(),this.$s=qe.getSeconds(),this.$ms=qe.getMilliseconds()},pe.$utils=function(){return ze},pe.isValid=function(){return this.$d.toString()!==T},pe.isSame=function(qe,$e){var Lt=Ce(qe);return this.startOf($e)<=Lt&&Lt<=this.endOf($e)},pe.isAfter=function(qe,$e){return Ce(qe)<this.startOf($e)},pe.isBefore=function(qe,$e){return this.endOf($e)<Ce(qe)},pe.$g=function(qe,$e,Lt){return ze.u(qe)?this[$e]:this.set(Lt,qe)},pe.unix=function(){return Math.floor(this.valueOf()/1e3)},pe.valueOf=function(){return this.$d.getTime()},pe.startOf=function(qe,$e){var Lt=this,Dt=!!ze.u($e)||$e,dr=ze.p(qe),pr=function(or,Pt){var Et=ze.w(Lt.$u?Date.UTC(Lt.$y,Pt,or):new Date(Lt.$y,Pt,or),Lt);return Dt?Et:Et.endOf(d)},sr=function(or,Pt){return ze.w(Lt.toDate()[or].apply(Lt.toDate("s"),(Dt?[0,0,0,0]:[23,59,59,999]).slice(Pt)),Lt)},hr=this.$W,Fe=this.$M,nr=this.$D,ir="set"+(this.$u?"UTC":"");switch(dr){case g:return Dt?pr(1,0):pr(31,11);case m:return Dt?pr(1,Fe):pr(0,Fe+1);case c:var Ue=this.$locale().weekStart||0,rr=(hr<Ue?hr+7:hr)-Ue;return pr(Dt?nr-rr:nr+(6-rr),Fe);case d:case b:return sr(ir+"Hours",0);case u:return sr(ir+"Minutes",1);case i:return sr(ir+"Seconds",2);case a:return sr(ir+"Milliseconds",3);default:return this.clone()}},pe.endOf=function(qe){return this.startOf(qe,!1)},pe.$set=function(qe,$e){var Lt,Dt=ze.p(qe),dr="set"+(this.$u?"UTC":""),pr=(Lt={},Lt[d]=dr+"Date",Lt[b]=dr+"Date",Lt[m]=dr+"Month",Lt[g]=dr+"FullYear",Lt[u]=dr+"Hours",Lt[i]=dr+"Minutes",Lt[a]=dr+"Seconds",Lt[s]=dr+"Milliseconds",Lt)[Dt],sr=Dt===d?this.$D+($e-this.$W):$e;if(Dt===m||Dt===g){var hr=this.clone().set(b,1);hr.$d[pr](sr),hr.init(),this.$d=hr.set(b,Math.min(this.$D,hr.daysInMonth())).$d}else pr&&this.$d[pr](sr);return this.init(),this},pe.set=function(qe,$e){return this.clone().$set(qe,$e)},pe.get=function(qe){return this[ze.p(qe)]()},pe.add=function(qe,$e){var Lt,Dt=this;qe=Number(qe);var dr=ze.p($e),pr=function(Fe){var nr=Ce(Dt);return ze.w(nr.date(nr.date()+Math.round(Fe*qe)),Dt)};if(dr===m)return this.set(m,this.$M+qe);if(dr===g)return this.set(g,this.$y+qe);if(dr===d)return pr(1);if(dr===c)return pr(7);var sr=(Lt={},Lt[i]=n,Lt[u]=o,Lt[a]=e,Lt)[dr]||1,hr=this.$d.getTime()+qe*sr;return ze.w(hr,this)},pe.subtract=function(qe,$e){return this.add(-1*qe,$e)},pe.format=function(qe){var $e=this,Lt=this.$locale();if(!this.isValid())return Lt.invalidDate||T;var Dt=qe||"YYYY-MM-DDTHH:mm:ssZ",dr=ze.z(this),pr=this.$H,sr=this.$m,hr=this.$M,Fe=Lt.weekdays,nr=Lt.months,ir=Lt.meridiem,Ue=function(Pt,Et,kt,er){return Pt&&(Pt[Et]||Pt($e,Dt))||kt[Et].slice(0,er)},rr=function(Pt){return ze.s(pr%12||12,Pt,"0")},or=ir||function(Pt,Et,kt){var er=Pt<12?"AM":"PM";return kt?er.toLowerCase():er};return Dt.replace(y,function(Pt,Et){return Et||function(kt){switch(kt){case"YY":return String($e.$y).slice(-2);case"YYYY":return ze.s($e.$y,4,"0");case"M":return hr+1;case"MM":return ze.s(hr+1,2,"0");case"MMM":return Ue(Lt.monthsShort,hr,nr,3);case"MMMM":return Ue(nr,hr);case"D":return $e.$D;case"DD":return ze.s($e.$D,2,"0");case"d":return String($e.$W);case"dd":return Ue(Lt.weekdaysMin,$e.$W,Fe,2);case"ddd":return Ue(Lt.weekdaysShort,$e.$W,Fe,3);case"dddd":return Fe[$e.$W];case"H":return String(pr);case"HH":return ze.s(pr,2,"0");case"h":return rr(1);case"hh":return rr(2);case"a":return or(pr,sr,!0);case"A":return or(pr,sr,!1);case"m":return String(sr);case"mm":return ze.s(sr,2,"0");case"s":return String($e.$s);case"ss":return ze.s($e.$s,2,"0");case"SSS":return ze.s($e.$ms,3,"0");case"Z":return dr}return null}(Pt)||dr.replace(":","")})},pe.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},pe.diff=function(qe,$e,Lt){var Dt,dr=this,pr=ze.p($e),sr=Ce(qe),hr=(sr.utcOffset()-this.utcOffset())*n,Fe=this-sr,nr=function(){return ze.m(dr,sr)};switch(pr){case g:Dt=nr()/12;break;case m:Dt=nr();break;case v:Dt=nr()/3;break;case c:Dt=(Fe-hr)/6048e5;break;case d:Dt=(Fe-hr)/864e5;break;case u:Dt=Fe/o;break;case i:Dt=Fe/n;break;case a:Dt=Fe/e;break;default:Dt=Fe}return Lt?Dt:ze.a(Dt)},pe.daysInMonth=function(){return this.endOf(m).$D},pe.$locale=function(){return Ne[this.$L]},pe.locale=function(qe,$e){if(!qe)return this.$L;var Lt=this.clone(),Dt=_e(qe,$e,!0);return Dt&&(Lt.$L=Dt),Lt},pe.clone=function(){return ze.w(this.$d,this)},pe.toDate=function(){return new Date(this.valueOf())},pe.toJSON=function(){return this.isValid()?this.toISOString():null},pe.toISOString=function(){return this.$d.toISOString()},pe.toString=function(){return this.$d.toUTCString()},Ie}(),le=ie.prototype;return Ce.prototype=le,[["$ms",s],["$s",a],["$m",i],["$H",u],["$W",d],["$M",m],["$y",g],["$D",b]].forEach(function(Ie){le[Ie[1]]=function(pe){return this.$g(pe,Ie[0],Ie[1])}}),Ce.extend=function(Ie,pe){return Ie.$i||(Ie(pe,ie,Ce),Ie.$i=!0),Ce},Ce.locale=_e,Ce.isDayjs=Y,Ce.unix=function(Ie){return Ce(1e3*Ie)},Ce.en=Ne[ae],Ce.Ls=Ne,Ce.p={},Ce})})(dayjs_min);var dayjs_minExports=dayjs_min.exports;const dayjs=getDefaultExportFromCjs(dayjs_minExports),nodeList=new Map;let startClick;isClient&&(document.addEventListener("mousedown",t=>startClick=t),document.addEventListener("mouseup",t=>{for(const r of nodeList.values())for(const{documentHandler:e}of r)e(t,startClick)}));function createDocumentHandler(t,r){let e=[];return Array.isArray(r.arg)?e=r.arg:isElement(r.arg)&&e.push(r.arg),function(n,o){const s=r.instance.popperRef,a=n.target,i=o==null?void 0:o.target,u=!r||!r.instance,d=!a||!i,c=t.contains(a)||t.contains(i),m=t===a,v=e.length&&e.some(b=>b==null?void 0:b.contains(a))||e.length&&e.includes(i),g=s&&(s.contains(a)||s.contains(i));u||d||c||m||v||g||r.value(n,o)}}const ClickOutside={beforeMount(t,r){nodeList.has(t)||nodeList.set(t,[]),nodeList.get(t).push({documentHandler:createDocumentHandler(t,r),bindingFn:r.value})},updated(t,r){nodeList.has(t)||nodeList.set(t,[]);const e=nodeList.get(t),n=e.findIndex(s=>s.bindingFn===r.oldValue),o={documentHandler:createDocumentHandler(t,r),bindingFn:r.value};n>=0?e.splice(n,1,o):e.push(o)},unmounted(t){nodeList.delete(t)}},FOCUSABLE_CHILDREN="_trap-focus-children",FOCUS_STACK=[],FOCUS_HANDLER=t=>{if(FOCUS_STACK.length===0)return;const r=FOCUS_STACK[FOCUS_STACK.length-1][FOCUSABLE_CHILDREN];if(r.length>0&&t.code===EVENT_CODE.tab){if(r.length===1){t.preventDefault(),document.activeElement!==r[0]&&r[0].focus();return}const e=t.shiftKey,n=t.target===r[0],o=t.target===r[r.length-1];n&&e&&(t.preventDefault(),r[r.length-1].focus()),o&&!e&&(t.preventDefault(),r[0].focus())}},TrapFocus={beforeMount(t){t[FOCUSABLE_CHILDREN]=obtainAllFocusableElements$1(t),FOCUS_STACK.push(t),FOCUS_STACK.length<=1&&document.addEventListener("keydown",FOCUS_HANDLER)},updated(t){nextTick(()=>{t[FOCUSABLE_CHILDREN]=obtainAllFocusableElements$1(t)})},unmounted(){FOCUS_STACK.shift(),FOCUS_STACK.length===0&&document.removeEventListener("keydown",FOCUS_HANDLER)}},checkboxProps={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object],default:void 0},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},controls:{type:String,default:void 0},border:Boolean,size:useSizeProp,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0}},checkboxEmits={[UPDATE_MODEL_EVENT]:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t),change:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t)},checkboxGroupContextKey=Symbol("checkboxGroupContextKey"),useCheckboxDisabled=({model:t,isChecked:r})=>{const e=inject(checkboxGroupContextKey,void 0),n=computed(()=>{var s,a;const i=(s=e==null?void 0:e.max)==null?void 0:s.value,u=(a=e==null?void 0:e.min)==null?void 0:a.value;return!isUndefined$1(i)&&t.value.length>=i&&!r.value||!isUndefined$1(u)&&t.value.length<=u&&r.value});return{isDisabled:useFormDisabled(computed(()=>(e==null?void 0:e.disabled.value)||n.value)),isLimitDisabled:n}},useCheckboxEvent=(t,{model:r,isLimitExceeded:e,hasOwnLabel:n,isDisabled:o,isLabeledByFormItem:s})=>{const a=inject(checkboxGroupContextKey,void 0),{formItem:i}=useFormItem(),{emit:u}=getCurrentInstance();function d(b){var T,k;return b===t.trueLabel||b===!0?(T=t.trueLabel)!=null?T:!0:(k=t.falseLabel)!=null?k:!1}function c(b,T){u("change",d(b),T)}function m(b){if(e.value)return;const T=b.target;u("change",d(T.checked),b)}async function v(b){e.value||!n.value&&!o.value&&s.value&&(b.composedPath().some(y=>y.tagName==="LABEL")||(r.value=d([!1,t.falseLabel].includes(r.value)),await nextTick(),c(r.value,b)))}const g=computed(()=>(a==null?void 0:a.validateEvent)||t.validateEvent);return watch(()=>t.modelValue,()=>{g.value&&(i==null||i.validate("change").catch(b=>void 0))}),{handleChange:m,onClickRoot:v}},useCheckboxModel=t=>{const r=ref(!1),{emit:e}=getCurrentInstance(),n=inject(checkboxGroupContextKey,void 0),o=computed(()=>isUndefined$1(n)===!1),s=ref(!1);return{model:computed({get(){var i,u;return o.value?(i=n==null?void 0:n.modelValue)==null?void 0:i.value:(u=t.modelValue)!=null?u:r.value},set(i){var u,d;o.value&&isArray$4(i)?(s.value=((u=n==null?void 0:n.max)==null?void 0:u.value)!==void 0&&i.length>(n==null?void 0:n.max.value),s.value===!1&&((d=n==null?void 0:n.changeEvent)==null||d.call(n,i))):(e(UPDATE_MODEL_EVENT,i),r.value=i)}}),isGroup:o,isLimitExceeded:s}},useCheckboxStatus=(t,r,{model:e})=>{const n=inject(checkboxGroupContextKey,void 0),o=ref(!1),s=computed(()=>{const d=e.value;return isBoolean$1(d)?d:isArray$4(d)?isObject$2(t.label)?d.map(toRaw).some(c=>isEqual(c,t.label)):d.map(toRaw).includes(t.label):d!=null?d===t.trueLabel:!!d}),a=useFormSize(computed(()=>{var d;return(d=n==null?void 0:n.size)==null?void 0:d.value}),{prop:!0}),i=useFormSize(computed(()=>{var d;return(d=n==null?void 0:n.size)==null?void 0:d.value})),u=computed(()=>!!r.default||!isNil(t.label));return{checkboxButtonSize:a,isChecked:s,isFocused:o,checkboxSize:i,hasOwnLabel:u}},setStoreValue=(t,{model:r})=>{function e(){isArray$4(r.value)&&!r.value.includes(t.label)?r.value.push(t.label):r.value=t.trueLabel||!0}t.checked&&e()},useCheckbox=(t,r)=>{const{formItem:e}=useFormItem(),{model:n,isGroup:o,isLimitExceeded:s}=useCheckboxModel(t),{isFocused:a,isChecked:i,checkboxButtonSize:u,checkboxSize:d,hasOwnLabel:c}=useCheckboxStatus(t,r,{model:n}),{isDisabled:m}=useCheckboxDisabled({model:n,isChecked:i}),{inputId:v,isLabeledByFormItem:g}=useFormItemInputId(t,{formItemContext:e,disableIdGeneration:c,disableIdManagement:o}),{handleChange:b,onClickRoot:T}=useCheckboxEvent(t,{model:n,isLimitExceeded:s,hasOwnLabel:c,isDisabled:m,isLabeledByFormItem:g});return setStoreValue(t,{model:n}),{inputId:v,isLabeledByFormItem:g,isChecked:i,isDisabled:m,isFocused:a,checkboxButtonSize:u,checkboxSize:d,hasOwnLabel:c,model:n,handleChange:b,onClickRoot:T}},_hoisted_1$q=["id","indeterminate","name","tabindex","disabled","true-value","false-value"],_hoisted_2$h=["id","indeterminate","disabled","value","name","tabindex"],__default__$u=defineComponent({name:"ElCheckbox"}),_sfc_main$P=defineComponent({...__default__$u,props:checkboxProps,emits:checkboxEmits,setup(t){const r=t,e=useSlots(),{inputId:n,isLabeledByFormItem:o,isChecked:s,isDisabled:a,isFocused:i,checkboxSize:u,hasOwnLabel:d,model:c,handleChange:m,onClickRoot:v}=useCheckbox(r,e),g=useNamespace("checkbox"),b=computed(()=>[g.b(),g.m(u.value),g.is("disabled",a.value),g.is("bordered",r.border),g.is("checked",s.value)]),T=computed(()=>[g.e("input"),g.is("disabled",a.value),g.is("checked",s.value),g.is("indeterminate",r.indeterminate),g.is("focus",i.value)]);return(k,y)=>(openBlock(),createBlock(resolveDynamicComponent(!unref(d)&&unref(o)?"span":"label"),{class:normalizeClass(unref(b)),"aria-controls":k.indeterminate?k.controls:null,onClick:unref(v)},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(unref(T))},[k.trueLabel||k.falseLabel?withDirectives((openBlock(),createElementBlock("input",{key:0,id:unref(n),"onUpdate:modelValue":y[0]||(y[0]=O=>isRef(c)?c.value=O:null),class:normalizeClass(unref(g).e("original")),type:"checkbox",indeterminate:k.indeterminate,name:k.name,tabindex:k.tabindex,disabled:unref(a),"true-value":k.trueLabel,"false-value":k.falseLabel,onChange:y[1]||(y[1]=(...O)=>unref(m)&&unref(m)(...O)),onFocus:y[2]||(y[2]=O=>i.value=!0),onBlur:y[3]||(y[3]=O=>i.value=!1),onClick:y[4]||(y[4]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_1$q)),[[vModelCheckbox,unref(c)]]):withDirectives((openBlock(),createElementBlock("input",{key:1,id:unref(n),"onUpdate:modelValue":y[5]||(y[5]=O=>isRef(c)?c.value=O:null),class:normalizeClass(unref(g).e("original")),type:"checkbox",indeterminate:k.indeterminate,disabled:unref(a),value:k.label,name:k.name,tabindex:k.tabindex,onChange:y[6]||(y[6]=(...O)=>unref(m)&&unref(m)(...O)),onFocus:y[7]||(y[7]=O=>i.value=!0),onBlur:y[8]||(y[8]=O=>i.value=!1),onClick:y[9]||(y[9]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_2$h)),[[vModelCheckbox,unref(c)]]),createBaseVNode("span",{class:normalizeClass(unref(g).e("inner"))},null,2)],2),unref(d)?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(g).e("label"))},[renderSlot(k.$slots,"default"),k.$slots.default?createCommentVNode("v-if",!0):(openBlock(),createElementBlock(Fragment,{key:0},[createTextVNode(toDisplayString(k.label),1)],64))],2)):createCommentVNode("v-if",!0)]),_:3},8,["class","aria-controls","onClick"]))}});var Checkbox=_export_sfc(_sfc_main$P,[["__file","/home/runner/work/element-plus/element-plus/packages/components/checkbox/src/checkbox.vue"]]);const _hoisted_1$p=["name","tabindex","disabled","true-value","false-value"],_hoisted_2$g=["name","tabindex","disabled","value"],__default__$t=defineComponent({name:"ElCheckboxButton"}),_sfc_main$O=defineComponent({...__default__$t,props:checkboxProps,emits:checkboxEmits,setup(t){const r=t,e=useSlots(),{isFocused:n,isChecked:o,isDisabled:s,checkboxButtonSize:a,model:i,handleChange:u}=useCheckbox(r,e),d=inject(checkboxGroupContextKey,void 0),c=useNamespace("checkbox"),m=computed(()=>{var g,b,T,k;const y=(b=(g=d==null?void 0:d.fill)==null?void 0:g.value)!=null?b:"";return{backgroundColor:y,borderColor:y,color:(k=(T=d==null?void 0:d.textColor)==null?void 0:T.value)!=null?k:"",boxShadow:y?`-1px 0 0 0 ${y}`:void 0}}),v=computed(()=>[c.b("button"),c.bm("button",a.value),c.is("disabled",s.value),c.is("checked",o.value),c.is("focus",n.value)]);return(g,b)=>(openBlock(),createElementBlock("label",{class:normalizeClass(unref(v))},[g.trueLabel||g.falseLabel?withDirectives((openBlock(),createElementBlock("input",{key:0,"onUpdate:modelValue":b[0]||(b[0]=T=>isRef(i)?i.value=T:null),class:normalizeClass(unref(c).be("button","original")),type:"checkbox",name:g.name,tabindex:g.tabindex,disabled:unref(s),"true-value":g.trueLabel,"false-value":g.falseLabel,onChange:b[1]||(b[1]=(...T)=>unref(u)&&unref(u)(...T)),onFocus:b[2]||(b[2]=T=>n.value=!0),onBlur:b[3]||(b[3]=T=>n.value=!1),onClick:b[4]||(b[4]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_1$p)),[[vModelCheckbox,unref(i)]]):withDirectives((openBlock(),createElementBlock("input",{key:1,"onUpdate:modelValue":b[5]||(b[5]=T=>isRef(i)?i.value=T:null),class:normalizeClass(unref(c).be("button","original")),type:"checkbox",name:g.name,tabindex:g.tabindex,disabled:unref(s),value:g.label,onChange:b[6]||(b[6]=(...T)=>unref(u)&&unref(u)(...T)),onFocus:b[7]||(b[7]=T=>n.value=!0),onBlur:b[8]||(b[8]=T=>n.value=!1),onClick:b[9]||(b[9]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_2$g)),[[vModelCheckbox,unref(i)]]),g.$slots.default||g.label?(openBlock(),createElementBlock("span",{key:2,class:normalizeClass(unref(c).be("button","inner")),style:normalizeStyle(unref(o)?unref(m):void 0)},[renderSlot(g.$slots,"default",{},()=>[createTextVNode(toDisplayString(g.label),1)])],6)):createCommentVNode("v-if",!0)],2))}});var CheckboxButton=_export_sfc(_sfc_main$O,[["__file","/home/runner/work/element-plus/element-plus/packages/components/checkbox/src/checkbox-button.vue"]]);const checkboxGroupProps=buildProps({modelValue:{type:definePropType(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:useSizeProp,label:String,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0}}),checkboxGroupEmits={[UPDATE_MODEL_EVENT]:t=>isArray$4(t),change:t=>isArray$4(t)},__default__$s=defineComponent({name:"ElCheckboxGroup"}),_sfc_main$N=defineComponent({...__default__$s,props:checkboxGroupProps,emits:checkboxGroupEmits,setup(t,{emit:r}){const e=t,n=useNamespace("checkbox"),{formItem:o}=useFormItem(),{inputId:s,isLabeledByFormItem:a}=useFormItemInputId(e,{formItemContext:o}),i=async d=>{r(UPDATE_MODEL_EVENT,d),await nextTick(),r("change",d)},u=computed({get(){return e.modelValue},set(d){i(d)}});return provide(checkboxGroupContextKey,{...pick$1(toRefs(e),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:u,changeEvent:i}),watch(()=>e.modelValue,()=>{e.validateEvent&&(o==null||o.validate("change").catch(d=>void 0))}),(d,c)=>{var m;return openBlock(),createBlock(resolveDynamicComponent(d.tag),{id:unref(s),class:normalizeClass(unref(n).b("group")),role:"group","aria-label":unref(a)?void 0:d.label||"checkbox-group","aria-labelledby":unref(a)?(m=unref(o))==null?void 0:m.labelId:void 0},{default:withCtx(()=>[renderSlot(d.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var CheckboxGroup=_export_sfc(_sfc_main$N,[["__file","/home/runner/work/element-plus/element-plus/packages/components/checkbox/src/checkbox-group.vue"]]);const ElCheckbox=withInstall(Checkbox,{CheckboxButton,CheckboxGroup});withNoopInstall(CheckboxButton);const ElCheckboxGroup=withNoopInstall(CheckboxGroup),radioPropsBase=buildProps({size:useSizeProp,disabled:Boolean,label:{type:[String,Number,Boolean],default:""}}),radioProps=buildProps({...radioPropsBase,modelValue:{type:[String,Number,Boolean],default:""},name:{type:String,default:""},border:Boolean}),radioEmits={[UPDATE_MODEL_EVENT]:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t),[CHANGE_EVENT]:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t)},radioGroupKey=Symbol("radioGroupKey"),useRadio=(t,r)=>{const e=ref(),n=inject(radioGroupKey,void 0),o=computed(()=>!!n),s=computed({get(){return o.value?n.modelValue:t.modelValue},set(c){o.value?n.changeEvent(c):r&&r(UPDATE_MODEL_EVENT,c),e.value.checked=t.modelValue===t.label}}),a=useFormSize(computed(()=>n==null?void 0:n.size)),i=useFormDisabled(computed(()=>n==null?void 0:n.disabled)),u=ref(!1),d=computed(()=>i.value||o.value&&s.value!==t.label?-1:0);return{radioRef:e,isGroup:o,radioGroup:n,focus:u,size:a,disabled:i,tabIndex:d,modelValue:s}},_hoisted_1$o=["value","name","disabled"],__default__$r=defineComponent({name:"ElRadio"}),_sfc_main$M=defineComponent({...__default__$r,props:radioProps,emits:radioEmits,setup(t,{emit:r}){const e=t,n=useNamespace("radio"),{radioRef:o,radioGroup:s,focus:a,size:i,disabled:u,modelValue:d}=useRadio(e,r);function c(){nextTick(()=>r("change",d.value))}return(m,v)=>{var g;return openBlock(),createElementBlock("label",{class:normalizeClass([unref(n).b(),unref(n).is("disabled",unref(u)),unref(n).is("focus",unref(a)),unref(n).is("bordered",m.border),unref(n).is("checked",unref(d)===m.label),unref(n).m(unref(i))])},[createBaseVNode("span",{class:normalizeClass([unref(n).e("input"),unref(n).is("disabled",unref(u)),unref(n).is("checked",unref(d)===m.label)])},[withDirectives(createBaseVNode("input",{ref_key:"radioRef",ref:o,"onUpdate:modelValue":v[0]||(v[0]=b=>isRef(d)?d.value=b:null),class:normalizeClass(unref(n).e("original")),value:m.label,name:m.name||((g=unref(s))==null?void 0:g.name),disabled:unref(u),type:"radio",onFocus:v[1]||(v[1]=b=>a.value=!0),onBlur:v[2]||(v[2]=b=>a.value=!1),onChange:c,onClick:v[3]||(v[3]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_1$o),[[vModelRadio,unref(d)]]),createBaseVNode("span",{class:normalizeClass(unref(n).e("inner"))},null,2)],2),createBaseVNode("span",{class:normalizeClass(unref(n).e("label")),onKeydown:v[4]||(v[4]=withModifiers(()=>{},["stop"]))},[renderSlot(m.$slots,"default",{},()=>[createTextVNode(toDisplayString(m.label),1)])],34)],2)}}});var Radio=_export_sfc(_sfc_main$M,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio.vue"]]);const radioButtonProps=buildProps({...radioPropsBase,name:{type:String,default:""}}),_hoisted_1$n=["value","name","disabled"],__default__$q=defineComponent({name:"ElRadioButton"}),_sfc_main$L=defineComponent({...__default__$q,props:radioButtonProps,setup(t){const r=t,e=useNamespace("radio"),{radioRef:n,focus:o,size:s,disabled:a,modelValue:i,radioGroup:u}=useRadio(r),d=computed(()=>({backgroundColor:(u==null?void 0:u.fill)||"",borderColor:(u==null?void 0:u.fill)||"",boxShadow:u!=null&&u.fill?`-1px 0 0 0 ${u.fill}`:"",color:(u==null?void 0:u.textColor)||""}));return(c,m)=>{var v;return openBlock(),createElementBlock("label",{class:normalizeClass([unref(e).b("button"),unref(e).is("active",unref(i)===c.label),unref(e).is("disabled",unref(a)),unref(e).is("focus",unref(o)),unref(e).bm("button",unref(s))])},[withDirectives(createBaseVNode("input",{ref_key:"radioRef",ref:n,"onUpdate:modelValue":m[0]||(m[0]=g=>isRef(i)?i.value=g:null),class:normalizeClass(unref(e).be("button","original-radio")),value:c.label,type:"radio",name:c.name||((v=unref(u))==null?void 0:v.name),disabled:unref(a),onFocus:m[1]||(m[1]=g=>o.value=!0),onBlur:m[2]||(m[2]=g=>o.value=!1),onClick:m[3]||(m[3]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_1$n),[[vModelRadio,unref(i)]]),createBaseVNode("span",{class:normalizeClass(unref(e).be("button","inner")),style:normalizeStyle(unref(i)===c.label?unref(d):{}),onKeydown:m[4]||(m[4]=withModifiers(()=>{},["stop"]))},[renderSlot(c.$slots,"default",{},()=>[createTextVNode(toDisplayString(c.label),1)])],38)],2)}}});var RadioButton=_export_sfc(_sfc_main$L,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio-button.vue"]]);const radioGroupProps=buildProps({id:{type:String,default:void 0},size:useSizeProp,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:""},fill:{type:String,default:""},label:{type:String,default:void 0},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0}}),radioGroupEmits=radioEmits,_hoisted_1$m=["id","aria-label","aria-labelledby"],__default__$p=defineComponent({name:"ElRadioGroup"}),_sfc_main$K=defineComponent({...__default__$p,props:radioGroupProps,emits:radioGroupEmits,setup(t,{emit:r}){const e=t,n=useNamespace("radio"),o=useId(),s=ref(),{formItem:a}=useFormItem(),{inputId:i,isLabeledByFormItem:u}=useFormItemInputId(e,{formItemContext:a}),d=m=>{r(UPDATE_MODEL_EVENT,m),nextTick(()=>r("change",m))};onMounted(()=>{const m=s.value.querySelectorAll("[type=radio]"),v=m[0];!Array.from(m).some(g=>g.checked)&&v&&(v.tabIndex=0)});const c=computed(()=>e.name||o.value);return provide(radioGroupKey,reactive({...toRefs(e),changeEvent:d,name:c})),watch(()=>e.modelValue,()=>{e.validateEvent&&(a==null||a.validate("change").catch(m=>void 0))}),(m,v)=>(openBlock(),createElementBlock("div",{id:unref(i),ref_key:"radioGroupRef",ref:s,class:normalizeClass(unref(n).b("group")),role:"radiogroup","aria-label":unref(u)?void 0:m.label||"radio-group","aria-labelledby":unref(u)?unref(a).labelId:void 0},[renderSlot(m.$slots,"default")],10,_hoisted_1$m))}});var RadioGroup=_export_sfc(_sfc_main$K,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio-group.vue"]]);const ElRadio=withInstall(Radio,{RadioButton,RadioGroup});withNoopInstall(RadioGroup);withNoopInstall(RadioButton);var NodeContent=defineComponent({name:"NodeContent",setup(){return{ns:useNamespace("cascader-node")}},render(){const{ns:t}=this,{node:r,panel:e}=this.$parent,{data:n,label:o}=r,{renderLabelFn:s}=e;return h("span",{class:t.e("label")},s?s({node:r,data:n}):o)}});const CASCADER_PANEL_INJECTION_KEY=Symbol(),_sfc_main$J=defineComponent({name:"ElCascaderNode",components:{ElCheckbox,ElRadio,NodeContent,ElIcon,Check:check_default,Loading:loading_default,ArrowRight:arrow_right_default},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(t,{emit:r}){const e=inject(CASCADER_PANEL_INJECTION_KEY),n=useNamespace("cascader-node"),o=computed(()=>e.isHoverMenu),s=computed(()=>e.config.multiple),a=computed(()=>e.config.checkStrictly),i=computed(()=>{var Ne;return(Ne=e.checkedNodes[0])==null?void 0:Ne.uid}),u=computed(()=>t.node.isDisabled),d=computed(()=>t.node.isLeaf),c=computed(()=>a.value&&!d.value||!u.value),m=computed(()=>g(e.expandingNode)),v=computed(()=>a.value&&e.checkedNodes.some(g)),g=Ne=>{var ue;const{level:Y,uid:_e}=t.node;return((ue=Ne==null?void 0:Ne.pathNodes[Y-1])==null?void 0:ue.uid)===_e},b=()=>{m.value||e.expandNode(t.node)},T=Ne=>{const{node:ue}=t;Ne!==ue.checked&&e.handleCheckChange(ue,Ne)},k=()=>{e.lazyLoad(t.node,()=>{d.value||b()})},y=Ne=>{o.value&&(O(),!d.value&&r("expand",Ne))},O=()=>{const{node:Ne}=t;!c.value||Ne.loading||(Ne.loaded?b():k())},D=()=>{o.value&&!d.value||(d.value&&!u.value&&!a.value&&!s.value?ae(!0):O())},he=Ne=>{a.value?(T(Ne),t.node.loaded&&b()):ae(Ne)},ae=Ne=>{t.node.loaded?(T(Ne),!a.value&&b()):k()};return{panel:e,isHoverMenu:o,multiple:s,checkStrictly:a,checkedNodeId:i,isDisabled:u,isLeaf:d,expandable:c,inExpandingPath:m,inCheckedPath:v,ns:n,handleHoverExpand:y,handleExpand:O,handleClick:D,handleCheck:ae,handleSelectCheck:he}}}),_hoisted_1$l=["id","aria-haspopup","aria-owns","aria-expanded","tabindex"],_hoisted_2$f=createBaseVNode("span",null,null,-1);function _sfc_render$g(t,r,e,n,o,s){const a=resolveComponent("el-checkbox"),i=resolveComponent("el-radio"),u=resolveComponent("check"),d=resolveComponent("el-icon"),c=resolveComponent("node-content"),m=resolveComponent("loading"),v=resolveComponent("arrow-right");return openBlock(),createElementBlock("li",{id:`${t.menuId}-${t.node.uid}`,role:"menuitem","aria-haspopup":!t.isLeaf,"aria-owns":t.isLeaf?null:t.menuId,"aria-expanded":t.inExpandingPath,tabindex:t.expandable?-1:void 0,class:normalizeClass([t.ns.b(),t.ns.is("selectable",t.checkStrictly),t.ns.is("active",t.node.checked),t.ns.is("disabled",!t.expandable),t.inExpandingPath&&"in-active-path",t.inCheckedPath&&"in-checked-path"]),onMouseenter:r[2]||(r[2]=(...g)=>t.handleHoverExpand&&t.handleHoverExpand(...g)),onFocus:r[3]||(r[3]=(...g)=>t.handleHoverExpand&&t.handleHoverExpand(...g)),onClick:r[4]||(r[4]=(...g)=>t.handleClick&&t.handleClick(...g))},[createCommentVNode(" prefix "),t.multiple?(openBlock(),createBlock(a,{key:0,"model-value":t.node.checked,indeterminate:t.node.indeterminate,disabled:t.isDisabled,onClick:r[0]||(r[0]=withModifiers(()=>{},["stop"])),"onUpdate:modelValue":t.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onUpdate:modelValue"])):t.checkStrictly?(openBlock(),createBlock(i,{key:1,"model-value":t.checkedNodeId,label:t.node.uid,disabled:t.isDisabled,"onUpdate:modelValue":t.handleSelectCheck,onClick:r[1]||(r[1]=withModifiers(()=>{},["stop"]))},{default:withCtx(()=>[createCommentVNode(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),_hoisted_2$f]),_:1},8,["model-value","label","disabled","onUpdate:modelValue"])):t.isLeaf&&t.node.checked?(openBlock(),createBlock(d,{key:2,class:normalizeClass(t.ns.e("prefix"))},{default:withCtx(()=>[createVNode(u)]),_:1},8,["class"])):createCommentVNode("v-if",!0),createCommentVNode(" content "),createVNode(c),createCommentVNode(" postfix "),t.isLeaf?createCommentVNode("v-if",!0):(openBlock(),createElementBlock(Fragment,{key:3},[t.node.loading?(openBlock(),createBlock(d,{key:0,class:normalizeClass([t.ns.is("loading"),t.ns.e("postfix")])},{default:withCtx(()=>[createVNode(m)]),_:1},8,["class"])):(openBlock(),createBlock(d,{key:1,class:normalizeClass(["arrow-right",t.ns.e("postfix")])},{default:withCtx(()=>[createVNode(v)]),_:1},8,["class"]))],64))],42,_hoisted_1$l)}var ElCascaderNode=_export_sfc(_sfc_main$J,[["render",_sfc_render$g],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/node.vue"]]);const _sfc_main$I=defineComponent({name:"ElCascaderMenu",components:{Loading:loading_default,ElIcon,ElScrollbar,ElCascaderNode},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(t){const r=getCurrentInstance(),e=useNamespace("cascader-menu"),{t:n}=useLocale(),o=generateId();let s=null,a=null;const i=inject(CASCADER_PANEL_INJECTION_KEY),u=ref(null),d=computed(()=>!t.nodes.length),c=computed(()=>!i.initialLoaded),m=computed(()=>`cascader-menu-${o}-${t.index}`),v=k=>{s=k.target},g=k=>{if(!(!i.isHoverMenu||!s||!u.value))if(s.contains(k.target)){b();const y=r.vnode.el,{left:O}=y.getBoundingClientRect(),{offsetWidth:D,offsetHeight:he}=y,ae=k.clientX-O,Ne=s.offsetTop,ue=Ne+s.offsetHeight;u.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${ae} ${Ne} L${D} 0 V${Ne} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${ae} ${ue} L${D} ${he} V${ue} Z" />
        `}else a||(a=window.setTimeout(T,i.config.hoverThreshold))},b=()=>{a&&(clearTimeout(a),a=null)},T=()=>{u.value&&(u.value.innerHTML="",b())};return{ns:e,panel:i,hoverZone:u,isEmpty:d,isLoading:c,menuId:m,t:n,handleExpand:v,handleMouseMove:g,clearHoverZone:T}}});function _sfc_render$f(t,r,e,n,o,s){const a=resolveComponent("el-cascader-node"),i=resolveComponent("loading"),u=resolveComponent("el-icon"),d=resolveComponent("el-scrollbar");return openBlock(),createBlock(d,{key:t.menuId,tag:"ul",role:"menu",class:normalizeClass(t.ns.b()),"wrap-class":t.ns.e("wrap"),"view-class":[t.ns.e("list"),t.ns.is("empty",t.isEmpty)],onMousemove:t.handleMouseMove,onMouseleave:t.clearHoverZone},{default:withCtx(()=>{var c;return[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.nodes,m=>(openBlock(),createBlock(a,{key:m.uid,node:m,"menu-id":t.menuId,onExpand:t.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),t.isLoading?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(t.ns.e("empty-text"))},[createVNode(u,{size:"14",class:normalizeClass(t.ns.is("loading"))},{default:withCtx(()=>[createVNode(i)]),_:1},8,["class"]),createTextVNode(" "+toDisplayString(t.t("el.cascader.loading")),1)],2)):t.isEmpty?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(t.ns.e("empty-text"))},toDisplayString(t.t("el.cascader.noData")),3)):(c=t.panel)!=null&&c.isHoverMenu?(openBlock(),createElementBlock("svg",{key:2,ref:"hoverZone",class:normalizeClass(t.ns.e("hover-zone"))},null,2)):createCommentVNode("v-if",!0)]}),_:1},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var ElCascaderMenu=_export_sfc(_sfc_main$I,[["render",_sfc_render$f],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/menu.vue"]]);let uid=0;const calculatePathNodes=t=>{const r=[t];let{parent:e}=t;for(;e;)r.unshift(e),e=e.parent;return r};class Node{constructor(r,e,n,o=!1){this.data=r,this.config=e,this.parent=n,this.root=o,this.uid=uid++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:s,label:a,children:i}=e,u=r[i],d=calculatePathNodes(this);this.level=o?0:n?n.level+1:1,this.value=r[s],this.label=r[a],this.pathNodes=d,this.pathValues=d.map(c=>c.value),this.pathLabels=d.map(c=>c.label),this.childrenData=u,this.children=(u||[]).map(c=>new Node(c,e,this)),this.loaded=!e.lazy||this.isLeaf||!isEmpty(u)}get isDisabled(){const{data:r,parent:e,config:n}=this,{disabled:o,checkStrictly:s}=n;return(isFunction$3(o)?o(r,this):!!r[o])||!s&&(e==null?void 0:e.isDisabled)}get isLeaf(){const{data:r,config:e,childrenData:n,loaded:o}=this,{lazy:s,leaf:a}=e,i=isFunction$3(a)?a(r,this):r[a];return isUndefined$1(i)?s&&!o?!1:!(Array.isArray(n)&&n.length):!!i}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(r){const{childrenData:e,children:n}=this,o=new Node(r,this.config,this);return Array.isArray(e)?e.push(r):this.childrenData=[r],n.push(o),o}calcText(r,e){const n=r?this.pathLabels.join(e):this.label;return this.text=n,n}broadcast(r,...e){const n=`onParent${capitalize(r)}`;this.children.forEach(o=>{o&&(o.broadcast(r,...e),o[n]&&o[n](...e))})}emit(r,...e){const{parent:n}=this,o=`onChild${capitalize(r)}`;n&&(n[o]&&n[o](...e),n.emit(r,...e))}onParentCheck(r){this.isDisabled||this.setCheckState(r)}onChildCheck(){const{children:r}=this,e=r.filter(o=>!o.isDisabled),n=e.length?e.every(o=>o.checked):!1;this.setCheckState(n)}setCheckState(r){const e=this.children.length,n=this.children.reduce((o,s)=>{const a=s.checked?1:s.indeterminate?.5:0;return o+a},0);this.checked=this.loaded&&this.children.filter(o=>!o.isDisabled).every(o=>o.loaded&&o.checked)&&r,this.indeterminate=this.loaded&&n!==e&&n>0}doCheck(r){if(this.checked===r)return;const{checkStrictly:e,multiple:n}=this.config;e||!n?this.checked=r:(this.broadcast("check",r),this.setCheckState(r),this.emit("check"))}}const flatNodes=(t,r)=>t.reduce((e,n)=>(n.isLeaf?e.push(n):(!r&&e.push(n),e=e.concat(flatNodes(n.children,r))),e),[]);class Store{constructor(r,e){this.config=e;const n=(r||[]).map(o=>new Node(o,this.config));this.nodes=n,this.allNodes=flatNodes(n,!1),this.leafNodes=flatNodes(n,!0)}getNodes(){return this.nodes}getFlattedNodes(r){return r?this.leafNodes:this.allNodes}appendNode(r,e){const n=e?e.appendChild(r):new Node(r,this.config);e||this.nodes.push(n),this.allNodes.push(n),n.isLeaf&&this.leafNodes.push(n)}appendNodes(r,e){r.forEach(n=>this.appendNode(n,e))}getNodeByValue(r,e=!1){return!r&&r!==0?null:this.getFlattedNodes(e).find(o=>isEqual(o.value,r)||isEqual(o.pathValues,r))||null}getSameNode(r){return r&&this.getFlattedNodes(!1).find(({value:n,level:o})=>isEqual(r.value,n)&&r.level===o)||null}}const CommonProps=buildProps({modelValue:{type:definePropType([Number,String,Array])},options:{type:definePropType(Array),default:()=>[]},props:{type:definePropType(Object),default:()=>({})}}),DefaultProps={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:NOOP,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},useCascaderConfig=t=>computed(()=>({...DefaultProps,...t.props})),getMenuIndex=t=>{if(!t)return 0;const r=t.id.split("-");return Number(r[r.length-2])},checkNode=t=>{if(!t)return;const r=t.querySelector("input");r?r.click():isLeaf(t)&&t.click()},sortByOriginalOrder=(t,r)=>{const e=r.slice(0),n=e.map(s=>s.uid),o=t.reduce((s,a)=>{const i=n.indexOf(a.uid);return i>-1&&(s.push(a),e.splice(i,1),n.splice(i,1)),s},[]);return o.push(...e),o},_sfc_main$H=defineComponent({name:"ElCascaderPanel",components:{ElCascaderMenu},props:{...CommonProps,border:{type:Boolean,default:!0},renderLabel:Function},emits:[UPDATE_MODEL_EVENT,CHANGE_EVENT,"close","expand-change"],setup(t,{emit:r,slots:e}){let n=!1;const o=useNamespace("cascader"),s=useCascaderConfig(t);let a=null;const i=ref(!0),u=ref([]),d=ref(null),c=ref([]),m=ref(null),v=ref([]),g=computed(()=>s.value.expandTrigger==="hover"),b=computed(()=>t.renderLabel||e.default),T=()=>{const{options:ie}=t,le=s.value;n=!1,a=new Store(ie,le),c.value=[a.getNodes()],le.lazy&&isEmpty(t.options)?(i.value=!1,k(void 0,Ie=>{Ie&&(a=new Store(Ie,le),c.value=[a.getNodes()]),i.value=!0,Y(!1,!0)})):Y(!1,!0)},k=(ie,le)=>{const Ie=s.value;ie=ie||new Node({},Ie,void 0,!0),ie.loading=!0;const pe=qe=>{const $e=ie,Lt=$e.root?null:$e;qe&&(a==null||a.appendNodes(qe,Lt)),$e.loading=!1,$e.loaded=!0,$e.childrenData=$e.childrenData||[],le&&le(qe)};Ie.lazyLoad(ie,pe)},y=(ie,le)=>{var Ie;const{level:pe}=ie,qe=c.value.slice(0,pe);let $e;ie.isLeaf?$e=ie.pathNodes[pe-2]:($e=ie,qe.push(ie.children)),((Ie=m.value)==null?void 0:Ie.uid)!==($e==null?void 0:$e.uid)&&(m.value=ie,c.value=qe,!le&&r("expand-change",(ie==null?void 0:ie.pathValues)||[]))},O=(ie,le,Ie=!0)=>{const{checkStrictly:pe,multiple:qe}=s.value,$e=v.value[0];n=!0,!qe&&($e==null||$e.doCheck(!1)),ie.doCheck(le),ue(),Ie&&!qe&&!pe&&r("close"),!Ie&&!qe&&!pe&&D(ie)},D=ie=>{ie&&(ie=ie.parent,D(ie),ie&&y(ie))},he=ie=>a==null?void 0:a.getFlattedNodes(ie),ae=ie=>{var le;return(le=he(ie))==null?void 0:le.filter(Ie=>Ie.checked!==!1)},Ne=()=>{v.value.forEach(ie=>ie.doCheck(!1)),ue(),c.value=c.value.slice(0,1),m.value=null,r("expand-change",[])},ue=()=>{var ie;const{checkStrictly:le,multiple:Ie}=s.value,pe=v.value,qe=ae(!le),$e=sortByOriginalOrder(pe,qe),Lt=$e.map(Dt=>Dt.valueByOption);v.value=$e,d.value=Ie?Lt:(ie=Lt[0])!=null?ie:null},Y=(ie=!1,le=!1)=>{const{modelValue:Ie}=t,{lazy:pe,multiple:qe,checkStrictly:$e}=s.value,Lt=!$e;if(!(!i.value||n||!le&&isEqual(Ie,d.value)))if(pe&&!ie){const dr=unique(flattenDeep(castArray(Ie))).map(pr=>a==null?void 0:a.getNodeByValue(pr)).filter(pr=>!!pr&&!pr.loaded&&!pr.loading);dr.length?dr.forEach(pr=>{k(pr,()=>Y(!1,le))}):Y(!0,le)}else{const Dt=qe?castArray(Ie):[Ie],dr=unique(Dt.map(pr=>a==null?void 0:a.getNodeByValue(pr,Lt)));_e(dr,le),d.value=cloneDeep(Ie)}},_e=(ie,le=!0)=>{const{checkStrictly:Ie}=s.value,pe=v.value,qe=ie.filter(Dt=>!!Dt&&(Ie||Dt.isLeaf)),$e=a==null?void 0:a.getSameNode(m.value),Lt=le&&$e||qe[0];Lt?Lt.pathNodes.forEach(Dt=>y(Dt,!0)):m.value=null,pe.forEach(Dt=>Dt.doCheck(!1)),t.props.multiple?reactive(qe).forEach(Dt=>Dt.doCheck(!0)):qe.forEach(Dt=>Dt.doCheck(!0)),v.value=qe,nextTick(Ce)},Ce=()=>{isClient&&u.value.forEach(ie=>{const le=ie==null?void 0:ie.$el;if(le){const Ie=le.querySelector(`.${o.namespace.value}-scrollbar__wrap`),pe=le.querySelector(`.${o.b("node")}.${o.is("active")}`)||le.querySelector(`.${o.b("node")}.in-active-path`);scrollIntoView(Ie,pe)}})},ze=ie=>{const le=ie.target,{code:Ie}=ie;switch(Ie){case EVENT_CODE.up:case EVENT_CODE.down:{ie.preventDefault();const pe=Ie===EVENT_CODE.up?-1:1;focusNode(getSibling(le,pe,`.${o.b("node")}[tabindex="-1"]`));break}case EVENT_CODE.left:{ie.preventDefault();const pe=u.value[getMenuIndex(le)-1],qe=pe==null?void 0:pe.$el.querySelector(`.${o.b("node")}[aria-expanded="true"]`);focusNode(qe);break}case EVENT_CODE.right:{ie.preventDefault();const pe=u.value[getMenuIndex(le)+1],qe=pe==null?void 0:pe.$el.querySelector(`.${o.b("node")}[tabindex="-1"]`);focusNode(qe);break}case EVENT_CODE.enter:checkNode(le);break}};return provide(CASCADER_PANEL_INJECTION_KEY,reactive({config:s,expandingNode:m,checkedNodes:v,isHoverMenu:g,initialLoaded:i,renderLabelFn:b,lazyLoad:k,expandNode:y,handleCheckChange:O})),watch([s,()=>t.options],T,{deep:!0,immediate:!0}),watch(()=>t.modelValue,()=>{n=!1,Y()},{deep:!0}),watch(()=>d.value,ie=>{isEqual(ie,t.modelValue)||(r(UPDATE_MODEL_EVENT,ie),r(CHANGE_EVENT,ie))}),onBeforeUpdate(()=>u.value=[]),onMounted(()=>!isEmpty(t.modelValue)&&Y()),{ns:o,menuList:u,menus:c,checkedNodes:v,handleKeyDown:ze,handleCheckChange:O,getFlattedNodes:he,getCheckedNodes:ae,clearCheckedNodes:Ne,calculateCheckedValue:ue,scrollToExpandingNode:Ce}}});function _sfc_render$e(t,r,e,n,o,s){const a=resolveComponent("el-cascader-menu");return openBlock(),createElementBlock("div",{class:normalizeClass([t.ns.b("panel"),t.ns.is("bordered",t.border)]),onKeydown:r[0]||(r[0]=(...i)=>t.handleKeyDown&&t.handleKeyDown(...i))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.menus,(i,u)=>(openBlock(),createBlock(a,{key:u,ref_for:!0,ref:d=>t.menuList[u]=d,index:u,nodes:[...i]},null,8,["index","nodes"]))),128))],34)}var CascaderPanel=_export_sfc(_sfc_main$H,[["render",_sfc_render$e],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/index.vue"]]);CascaderPanel.install=t=>{t.component(CascaderPanel.name,CascaderPanel)};const _CascaderPanel=CascaderPanel,tagProps=buildProps({type:{type:String,values:["success","info","warning","danger",""],default:""},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:{type:String,default:""},size:{type:String,values:componentSizes,default:""},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),tagEmits={close:t=>t instanceof MouseEvent,click:t=>t instanceof MouseEvent},__default__$o=defineComponent({name:"ElTag"}),_sfc_main$G=defineComponent({...__default__$o,props:tagProps,emits:tagEmits,setup(t,{emit:r}){const e=t,n=useFormSize(),o=useNamespace("tag"),s=computed(()=>{const{type:u,hit:d,effect:c,closable:m,round:v}=e;return[o.b(),o.is("closable",m),o.m(u),o.m(n.value),o.m(c),o.is("hit",d),o.is("round",v)]}),a=u=>{r("close",u)},i=u=>{r("click",u)};return(u,d)=>u.disableTransitions?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(s)),style:normalizeStyle({backgroundColor:u.color}),onClick:i},[createBaseVNode("span",{class:normalizeClass(unref(o).e("content"))},[renderSlot(u.$slots,"default")],2),u.closable?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(o).e("close")),onClick:withModifiers(a,["stop"])},{default:withCtx(()=>[createVNode(unref(close_default))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0)],6)):(openBlock(),createBlock(Transition,{key:1,name:`${unref(o).namespace.value}-zoom-in-center`,appear:""},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(unref(s)),style:normalizeStyle({backgroundColor:u.color}),onClick:i},[createBaseVNode("span",{class:normalizeClass(unref(o).e("content"))},[renderSlot(u.$slots,"default")],2),u.closable?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(o).e("close")),onClick:withModifiers(a,["stop"])},{default:withCtx(()=>[createVNode(unref(close_default))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0)],6)]),_:3},8,["name"]))}});var Tag=_export_sfc(_sfc_main$G,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tag/src/tag.vue"]]);const ElTag=withInstall(Tag),cascaderProps=buildProps({...CommonProps,size:useSizeProp,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:definePropType(Function),default:(t,r)=>t.text.includes(r)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,maxCollapseTags:{type:Number,default:1},collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:definePropType(Function),default:()=>!0},popperClass:{type:String,default:""},teleported:useTooltipContentProps.teleported,tagType:{...tagProps.type,default:"info"},validateEvent:{type:Boolean,default:!0}}),cascaderEmits={[UPDATE_MODEL_EVENT]:t=>!!t||t===null,[CHANGE_EVENT]:t=>!!t||t===null,focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,visibleChange:t=>isBoolean$1(t),expandChange:t=>!!t,removeTag:t=>!!t},_hoisted_1$k={key:0},_hoisted_2$e=["placeholder","onKeydown"],_hoisted_3$9=["onClick"],COMPONENT_NAME$3="ElCascader",__default__$n=defineComponent({name:COMPONENT_NAME$3}),_sfc_main$F=defineComponent({...__default__$n,props:cascaderProps,emits:cascaderEmits,setup(t,{expose:r,emit:e}){const n=t,o={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:Jr})=>{const{modifiersData:Lr,placement:Kn}=Jr;["right","left","bottom","top"].includes(Kn)||(Lr.arrow.x=35)},requires:["arrow"]}]},s=useAttrs$1();let a=0,i=0;const u=useNamespace("cascader"),d=useNamespace("input"),{t:c}=useLocale(),{form:m,formItem:v}=useFormItem(),g=ref(null),b=ref(null),T=ref(null),k=ref(null),y=ref(null),O=ref(!1),D=ref(!1),he=ref(!1),ae=ref(!1),Ne=ref(""),ue=ref(""),Y=ref([]),_e=ref([]),Ce=ref([]),ze=ref(!1),ie=computed(()=>s.style),le=computed(()=>n.disabled||(m==null?void 0:m.disabled)),Ie=computed(()=>n.placeholder||c("el.cascader.placeholder")),pe=computed(()=>ue.value||Y.value.length>0||ze.value?"":Ie.value),qe=useFormSize(),$e=computed(()=>["small"].includes(qe.value)?"small":"default"),Lt=computed(()=>!!n.props.multiple),Dt=computed(()=>!n.filterable||Lt.value),dr=computed(()=>Lt.value?ue.value:Ne.value),pr=computed(()=>{var Jr;return((Jr=k.value)==null?void 0:Jr.checkedNodes)||[]}),sr=computed(()=>!n.clearable||le.value||he.value||!D.value?!1:!!pr.value.length),hr=computed(()=>{const{showAllLevels:Jr,separator:Lr}=n,Kn=pr.value;return Kn.length?Lt.value?"":Kn[0].calcText(Jr,Lr):""}),Fe=computed({get(){return cloneDeep(n.modelValue)},set(Jr){e(UPDATE_MODEL_EVENT,Jr),e(CHANGE_EVENT,Jr),n.validateEvent&&(v==null||v.validate("change").catch(Lr=>void 0))}}),nr=computed(()=>[u.b(),u.m(qe.value),u.is("disabled",le.value),s.class]),ir=computed(()=>[d.e("icon"),"icon-arrow-down",u.is("reverse",O.value)]),Ue=computed(()=>u.is("focus",O.value||ae.value)),rr=computed(()=>{var Jr,Lr;return(Lr=(Jr=g.value)==null?void 0:Jr.popperRef)==null?void 0:Lr.contentRef}),or=Jr=>{var Lr,Kn,vo;le.value||(Jr=Jr??!O.value,Jr!==O.value&&(O.value=Jr,(Kn=(Lr=b.value)==null?void 0:Lr.input)==null||Kn.setAttribute("aria-expanded",`${Jr}`),Jr?(Pt(),nextTick((vo=k.value)==null?void 0:vo.scrollToExpandingNode)):n.filterable&&Or(),e("visibleChange",Jr)))},Pt=()=>{nextTick(()=>{var Jr;(Jr=g.value)==null||Jr.updatePopper()})},Et=()=>{he.value=!1},kt=Jr=>{const{showAllLevels:Lr,separator:Kn}=n;return{node:Jr,key:Jr.uid,text:Jr.calcText(Lr,Kn),hitState:!1,closable:!le.value&&!Jr.isDisabled,isCollapseTag:!1}},er=Jr=>{var Lr;const Kn=Jr.node;Kn.doCheck(!1),(Lr=k.value)==null||Lr.calculateCheckedValue(),e("removeTag",Kn.valueByOption)},cr=()=>{if(!Lt.value)return;const Jr=pr.value,Lr=[],Kn=[];if(Jr.forEach(vo=>Kn.push(kt(vo))),_e.value=Kn,Jr.length){Jr.slice(0,n.maxCollapseTags).forEach(so=>Lr.push(kt(so)));const vo=Jr.slice(n.maxCollapseTags),bo=vo.length;bo&&(n.collapseTags?Lr.push({key:-1,text:`+ ${bo}`,closable:!1,isCollapseTag:!0}):vo.forEach(so=>Lr.push(kt(so))))}Y.value=Lr},mr=()=>{var Jr,Lr;const{filterMethod:Kn,showAllLevels:vo,separator:bo}=n,so=(Lr=(Jr=k.value)==null?void 0:Jr.getFlattedNodes(!n.props.checkStrictly))==null?void 0:Lr.filter(co=>co.isDisabled?!1:(co.calcText(vo,bo),Kn(co,dr.value)));Lt.value&&(Y.value.forEach(co=>{co.hitState=!1}),_e.value.forEach(co=>{co.hitState=!1})),he.value=!0,Ce.value=so,Pt()},vr=()=>{var Jr;let Lr;he.value&&y.value?Lr=y.value.$el.querySelector(`.${u.e("suggestion-item")}`):Lr=(Jr=k.value)==null?void 0:Jr.$el.querySelector(`.${u.b("node")}[tabindex="-1"]`),Lr&&(Lr.focus(),!he.value&&Lr.click())},Tr=()=>{var Jr,Lr;const Kn=(Jr=b.value)==null?void 0:Jr.input,vo=T.value,bo=(Lr=y.value)==null?void 0:Lr.$el;if(!(!isClient||!Kn)){if(bo){const so=bo.querySelector(`.${u.e("suggestion-list")}`);so.style.minWidth=`${Kn.offsetWidth}px`}if(vo){const{offsetHeight:so}=vo,co=Y.value.length>0?`${Math.max(so+6,a)}px`:`${a}px`;Kn.style.height=co,Pt()}}},Ir=Jr=>{var Lr;return(Lr=k.value)==null?void 0:Lr.getCheckedNodes(Jr)},kr=Jr=>{Pt(),e("expandChange",Jr)},Ar=Jr=>{var Lr;const Kn=(Lr=Jr.target)==null?void 0:Lr.value;if(Jr.type==="compositionend")ze.value=!1,nextTick(()=>Gn(Kn));else{const vo=Kn[Kn.length-1]||"";ze.value=!isKorean(vo)}},Rr=Jr=>{if(!ze.value)switch(Jr.code){case EVENT_CODE.enter:or();break;case EVENT_CODE.down:or(!0),nextTick(vr),Jr.preventDefault();break;case EVENT_CODE.esc:O.value===!0&&(Jr.preventDefault(),Jr.stopPropagation(),or(!1));break;case EVENT_CODE.tab:or(!1);break}},Cn=()=>{var Jr;(Jr=k.value)==null||Jr.clearCheckedNodes(),!O.value&&n.filterable&&Or(),or(!1)},Or=()=>{const{value:Jr}=hr;Ne.value=Jr,ue.value=Jr},Pr=Jr=>{var Lr,Kn;const{checked:vo}=Jr;Lt.value?(Lr=k.value)==null||Lr.handleCheckChange(Jr,!vo,!1):(!vo&&((Kn=k.value)==null||Kn.handleCheckChange(Jr,!0,!1)),or(!1))},Nr=Jr=>{const Lr=Jr.target,{code:Kn}=Jr;switch(Kn){case EVENT_CODE.up:case EVENT_CODE.down:{const vo=Kn===EVENT_CODE.up?-1:1;focusNode(getSibling(Lr,vo,`.${u.e("suggestion-item")}[tabindex="-1"]`));break}case EVENT_CODE.enter:Lr.click();break}},Qr=()=>{const Jr=Y.value,Lr=Jr[Jr.length-1];i=ue.value?0:i+1,!(!Lr||!i||n.collapseTags&&Jr.length>1)&&(Lr.hitState?er(Lr):Lr.hitState=!0)},hn=Jr=>{const Lr=Jr.target,Kn=u.e("search-input");Lr.className===Kn&&(ae.value=!0),e("focus",Jr)},Ur=Jr=>{ae.value=!1,e("blur",Jr)},qr=debounce(()=>{const{value:Jr}=dr;if(!Jr)return;const Lr=n.beforeFilter(Jr);isPromise(Lr)?Lr.then(mr).catch(()=>{}):Lr!==!1?mr():Et()},n.debounce),Gn=(Jr,Lr)=>{!O.value&&or(!0),!(Lr!=null&&Lr.isComposing)&&(Jr?qr():Et())},$n=Jr=>Number.parseFloat(useCssVar(d.cssVarName("input-height"),Jr).value)-2;return watch(he,Pt),watch([pr,le],cr),watch(Y,()=>{nextTick(()=>Tr())}),watch(qe,async()=>{await nextTick();const Jr=b.value.input;a=$n(Jr)||a,Tr()}),watch(hr,Or,{immediate:!0}),onMounted(()=>{const Jr=b.value.input,Lr=$n(Jr);a=Jr.offsetHeight||Lr,useResizeObserver(Jr,Tr)}),r({getCheckedNodes:Ir,cascaderPanelRef:k,togglePopperVisible:or,contentRef:rr}),(Jr,Lr)=>(openBlock(),createBlock(unref(ElTooltip),{ref_key:"tooltipRef",ref:g,visible:O.value,teleported:Jr.teleported,"popper-class":[unref(u).e("dropdown"),Jr.popperClass],"popper-options":o,"fallback-placements":["bottom-start","bottom","top-start","top","right","left"],"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:"bottom-start",transition:`${unref(u).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:"",onHide:Et},{default:withCtx(()=>[withDirectives((openBlock(),createElementBlock("div",{class:normalizeClass(unref(nr)),style:normalizeStyle(unref(ie)),onClick:Lr[5]||(Lr[5]=()=>or(unref(Dt)?void 0:!0)),onKeydown:Rr,onMouseenter:Lr[6]||(Lr[6]=Kn=>D.value=!0),onMouseleave:Lr[7]||(Lr[7]=Kn=>D.value=!1)},[createVNode(unref(ElInput),{ref_key:"input",ref:b,modelValue:Ne.value,"onUpdate:modelValue":Lr[1]||(Lr[1]=Kn=>Ne.value=Kn),placeholder:unref(pe),readonly:unref(Dt),disabled:unref(le),"validate-event":!1,size:unref(qe),class:normalizeClass(unref(Ue)),tabindex:unref(Lt)&&Jr.filterable&&!unref(le)?-1:void 0,onCompositionstart:Ar,onCompositionupdate:Ar,onCompositionend:Ar,onFocus:hn,onBlur:Ur,onInput:Gn},{suffix:withCtx(()=>[unref(sr)?(openBlock(),createBlock(unref(ElIcon),{key:"clear",class:normalizeClass([unref(d).e("icon"),"icon-circle-close"]),onClick:withModifiers(Cn,["stop"])},{default:withCtx(()=>[createVNode(unref(circle_close_default))]),_:1},8,["class","onClick"])):(openBlock(),createBlock(unref(ElIcon),{key:"arrow-down",class:normalizeClass(unref(ir)),onClick:Lr[0]||(Lr[0]=withModifiers(Kn=>or(),["stop"]))},{default:withCtx(()=>[createVNode(unref(arrow_down_default))]),_:1},8,["class"]))]),_:1},8,["modelValue","placeholder","readonly","disabled","size","class","tabindex"]),unref(Lt)?(openBlock(),createElementBlock("div",{key:0,ref_key:"tagWrapper",ref:T,class:normalizeClass(unref(u).e("tags"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(Y.value,Kn=>(openBlock(),createBlock(unref(ElTag),{key:Kn.key,type:Jr.tagType,size:unref($e),hit:Kn.hitState,closable:Kn.closable,"disable-transitions":"",onClose:vo=>er(Kn)},{default:withCtx(()=>[Kn.isCollapseTag===!1?(openBlock(),createElementBlock("span",_hoisted_1$k,toDisplayString(Kn.text),1)):(openBlock(),createBlock(unref(ElTooltip),{key:1,disabled:O.value||!Jr.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(Kn.text),1)]),content:withCtx(()=>[createBaseVNode("div",{class:normalizeClass(unref(u).e("collapse-tags"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(_e.value.slice(Jr.maxCollapseTags),(vo,bo)=>(openBlock(),createElementBlock("div",{key:bo,class:normalizeClass(unref(u).e("collapse-tag"))},[(openBlock(),createBlock(unref(ElTag),{key:vo.key,class:"in-tooltip",type:Jr.tagType,size:unref($e),hit:vo.hitState,closable:vo.closable,"disable-transitions":"",onClose:so=>er(vo)},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(vo.text),1)]),_:2},1032,["type","size","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","hit","closable","onClose"]))),128)),Jr.filterable&&!unref(le)?withDirectives((openBlock(),createElementBlock("input",{key:0,"onUpdate:modelValue":Lr[2]||(Lr[2]=Kn=>ue.value=Kn),type:"text",class:normalizeClass(unref(u).e("search-input")),placeholder:unref(hr)?"":unref(Ie),onInput:Lr[3]||(Lr[3]=Kn=>Gn(ue.value,Kn)),onClick:Lr[4]||(Lr[4]=withModifiers(Kn=>or(!0),["stop"])),onKeydown:withKeys(Qr,["delete"]),onCompositionstart:Ar,onCompositionupdate:Ar,onCompositionend:Ar,onFocus:hn,onBlur:Ur},null,42,_hoisted_2$e)),[[vModelText,ue.value]]):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0)],38)),[[unref(ClickOutside),()=>or(!1),unref(rr)]])]),content:withCtx(()=>[withDirectives(createVNode(unref(_CascaderPanel),{ref_key:"cascaderPanelRef",ref:k,modelValue:unref(Fe),"onUpdate:modelValue":Lr[8]||(Lr[8]=Kn=>isRef(Fe)?Fe.value=Kn:null),options:Jr.options,props:n.props,border:!1,"render-label":Jr.$slots.default,onExpandChange:kr,onClose:Lr[9]||(Lr[9]=Kn=>Jr.$nextTick(()=>or(!1)))},null,8,["modelValue","options","props","render-label"]),[[vShow,!he.value]]),Jr.filterable?withDirectives((openBlock(),createBlock(unref(ElScrollbar),{key:0,ref_key:"suggestionPanel",ref:y,tag:"ul",class:normalizeClass(unref(u).e("suggestion-panel")),"view-class":unref(u).e("suggestion-list"),onKeydown:Nr},{default:withCtx(()=>[Ce.value.length?(openBlock(!0),createElementBlock(Fragment,{key:0},renderList(Ce.value,Kn=>(openBlock(),createElementBlock("li",{key:Kn.uid,class:normalizeClass([unref(u).e("suggestion-item"),unref(u).is("checked",Kn.checked)]),tabindex:-1,onClick:vo=>Pr(Kn)},[createBaseVNode("span",null,toDisplayString(Kn.text),1),Kn.checked?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[createVNode(unref(check_default))]),_:1})):createCommentVNode("v-if",!0)],10,_hoisted_3$9))),128)):renderSlot(Jr.$slots,"empty",{key:1},()=>[createBaseVNode("li",{class:normalizeClass(unref(u).e("empty-text"))},toDisplayString(unref(c)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[vShow,he.value]]):createCommentVNode("v-if",!0)]),_:3},8,["visible","teleported","popper-class","transition"]))}});var Cascader=_export_sfc(_sfc_main$F,[["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader/src/cascader.vue"]]);Cascader.install=t=>{t.component(Cascader.name,Cascader)};const _Cascader=Cascader,ElCascader=_Cascader,rowContextKey=Symbol("rowContextKey"),RowJustify=["start","center","end","space-around","space-between","space-evenly"],RowAlign=["top","middle","bottom"],rowProps=buildProps({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:RowJustify,default:"start"},align:{type:String,values:RowAlign}}),__default__$m=defineComponent({name:"ElRow"}),_sfc_main$E=defineComponent({...__default__$m,props:rowProps,setup(t){const r=t,e=useNamespace("row"),n=computed(()=>r.gutter);provide(rowContextKey,{gutter:n});const o=computed(()=>{const a={};return r.gutter&&(a.marginRight=a.marginLeft=`-${r.gutter/2}px`),a}),s=computed(()=>[e.b(),e.is(`justify-${r.justify}`,r.justify!=="start"),e.is(`align-${r.align}`,!!r.align)]);return(a,i)=>(openBlock(),createBlock(resolveDynamicComponent(a.tag),{class:normalizeClass(unref(s)),style:normalizeStyle(unref(o))},{default:withCtx(()=>[renderSlot(a.$slots,"default")]),_:3},8,["class","style"]))}});var Row=_export_sfc(_sfc_main$E,[["__file","/home/runner/work/element-plus/element-plus/packages/components/row/src/row.vue"]]);const ElRow=withInstall(Row),colProps=buildProps({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:definePropType([Number,Object]),default:()=>mutable({})},sm:{type:definePropType([Number,Object]),default:()=>mutable({})},md:{type:definePropType([Number,Object]),default:()=>mutable({})},lg:{type:definePropType([Number,Object]),default:()=>mutable({})},xl:{type:definePropType([Number,Object]),default:()=>mutable({})}}),__default__$l=defineComponent({name:"ElCol"}),_sfc_main$D=defineComponent({...__default__$l,props:colProps,setup(t){const r=t,{gutter:e}=inject(rowContextKey,{gutter:computed(()=>0)}),n=useNamespace("col"),o=computed(()=>{const a={};return e.value&&(a.paddingLeft=a.paddingRight=`${e.value/2}px`),a}),s=computed(()=>{const a=[];return["span","offset","pull","push"].forEach(d=>{const c=r[d];isNumber$1(c)&&(d==="span"?a.push(n.b(`${r[d]}`)):c>0&&a.push(n.b(`${d}-${r[d]}`)))}),["xs","sm","md","lg","xl"].forEach(d=>{isNumber$1(r[d])?a.push(n.b(`${d}-${r[d]}`)):isObject$2(r[d])&&Object.entries(r[d]).forEach(([c,m])=>{a.push(c!=="span"?n.b(`${d}-${c}-${m}`):n.b(`${d}-${m}`))})}),e.value&&a.push(n.is("guttered")),[n.b(),a]});return(a,i)=>(openBlock(),createBlock(resolveDynamicComponent(a.tag),{class:normalizeClass(unref(s)),style:normalizeStyle(unref(o))},{default:withCtx(()=>[renderSlot(a.$slots,"default")]),_:3},8,["class","style"]))}});var Col=_export_sfc(_sfc_main$D,[["__file","/home/runner/work/element-plus/element-plus/packages/components/col/src/col.vue"]]);const ElCol=withInstall(Col),emitChangeFn=t=>typeof isNumber$1(t),collapseProps=buildProps({accordion:Boolean,modelValue:{type:definePropType([Array,String,Number]),default:()=>mutable([])}}),collapseEmits={[UPDATE_MODEL_EVENT]:emitChangeFn,[CHANGE_EVENT]:emitChangeFn},collapseContextKey=Symbol("collapseContextKey"),useCollapse=(t,r)=>{const e=ref(castArray$1(t.modelValue)),n=s=>{e.value=s;const a=t.accordion?e.value[0]:e.value;r(UPDATE_MODEL_EVENT,a),r(CHANGE_EVENT,a)},o=s=>{if(t.accordion)n([e.value[0]===s?"":s]);else{const a=[...e.value],i=a.indexOf(s);i>-1?a.splice(i,1):a.push(s),n(a)}};return watch(()=>t.modelValue,()=>e.value=castArray$1(t.modelValue),{deep:!0}),provide(collapseContextKey,{activeNames:e,handleItemClick:o}),{activeNames:e,setActiveNames:n}},useCollapseDOM=()=>{const t=useNamespace("collapse");return{rootKls:computed(()=>t.b())}},__default__$k=defineComponent({name:"ElCollapse"}),_sfc_main$C=defineComponent({...__default__$k,props:collapseProps,emits:collapseEmits,setup(t,{expose:r,emit:e}){const n=t,{activeNames:o,setActiveNames:s}=useCollapse(n,e),{rootKls:a}=useCollapseDOM();return r({activeNames:o,setActiveNames:s}),(i,u)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(a))},[renderSlot(i.$slots,"default")],2))}});var Collapse=_export_sfc(_sfc_main$C,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse.vue"]]);const __default__$j=defineComponent({name:"ElCollapseTransition"}),_sfc_main$B=defineComponent({...__default__$j,setup(t){const r=useNamespace("collapse-transition"),e=o=>{o.style.maxHeight="",o.style.overflow=o.dataset.oldOverflow,o.style.paddingTop=o.dataset.oldPaddingTop,o.style.paddingBottom=o.dataset.oldPaddingBottom},n={beforeEnter(o){o.dataset||(o.dataset={}),o.dataset.oldPaddingTop=o.style.paddingTop,o.dataset.oldPaddingBottom=o.style.paddingBottom,o.style.maxHeight=0,o.style.paddingTop=0,o.style.paddingBottom=0},enter(o){o.dataset.oldOverflow=o.style.overflow,o.scrollHeight!==0?o.style.maxHeight=`${o.scrollHeight}px`:o.style.maxHeight=0,o.style.paddingTop=o.dataset.oldPaddingTop,o.style.paddingBottom=o.dataset.oldPaddingBottom,o.style.overflow="hidden"},afterEnter(o){o.style.maxHeight="",o.style.overflow=o.dataset.oldOverflow},enterCancelled(o){e(o)},beforeLeave(o){o.dataset||(o.dataset={}),o.dataset.oldPaddingTop=o.style.paddingTop,o.dataset.oldPaddingBottom=o.style.paddingBottom,o.dataset.oldOverflow=o.style.overflow,o.style.maxHeight=`${o.scrollHeight}px`,o.style.overflow="hidden"},leave(o){o.scrollHeight!==0&&(o.style.maxHeight=0,o.style.paddingTop=0,o.style.paddingBottom=0)},afterLeave(o){e(o)},leaveCancelled(o){e(o)}};return(o,s)=>(openBlock(),createBlock(Transition,mergeProps({name:unref(r).b()},toHandlers(n)),{default:withCtx(()=>[renderSlot(o.$slots,"default")]),_:3},16,["name"]))}});var CollapseTransition=_export_sfc(_sfc_main$B,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse-transition/src/collapse-transition.vue"]]);CollapseTransition.install=t=>{t.component(CollapseTransition.name,CollapseTransition)};const _CollapseTransition=CollapseTransition,collapseItemProps=buildProps({title:{type:String,default:""},name:{type:definePropType([String,Number]),default:()=>generateId()},disabled:Boolean}),useCollapseItem=t=>{const r=inject(collapseContextKey),e=ref(!1),n=ref(!1),o=ref(generateId()),s=computed(()=>r==null?void 0:r.activeNames.value.includes(t.name));return{focusing:e,id:o,isActive:s,handleFocus:()=>{setTimeout(()=>{n.value?n.value=!1:e.value=!0},50)},handleHeaderClick:()=>{t.disabled||(r==null||r.handleItemClick(t.name),e.value=!1,n.value=!0)},handleEnterClick:()=>{r==null||r.handleItemClick(t.name)}}},useCollapseItemDOM=(t,{focusing:r,isActive:e,id:n})=>{const o=useNamespace("collapse"),s=computed(()=>[o.b("item"),o.is("active",unref(e)),o.is("disabled",t.disabled)]),a=computed(()=>[o.be("item","header"),o.is("active",unref(e)),{focusing:unref(r)&&!t.disabled}]),i=computed(()=>[o.be("item","arrow"),o.is("active",unref(e))]),u=computed(()=>o.be("item","wrap")),d=computed(()=>o.be("item","content")),c=computed(()=>o.b(`content-${unref(n)}`)),m=computed(()=>o.b(`head-${unref(n)}`));return{arrowKls:i,headKls:a,rootKls:s,itemWrapperKls:u,itemContentKls:d,scopedContentId:c,scopedHeadId:m}},_hoisted_1$j=["id","aria-expanded","aria-controls","aria-describedby","tabindex"],_hoisted_2$d=["id","aria-hidden","aria-labelledby"],__default__$i=defineComponent({name:"ElCollapseItem"}),_sfc_main$A=defineComponent({...__default__$i,props:collapseItemProps,setup(t,{expose:r}){const e=t,{focusing:n,id:o,isActive:s,handleFocus:a,handleHeaderClick:i,handleEnterClick:u}=useCollapseItem(e),{arrowKls:d,headKls:c,rootKls:m,itemWrapperKls:v,itemContentKls:g,scopedContentId:b,scopedHeadId:T}=useCollapseItemDOM(e,{focusing:n,isActive:s,id:o});return r({isActive:s}),(k,y)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(m))},[createBaseVNode("button",{id:unref(T),class:normalizeClass(unref(c)),"aria-expanded":unref(s),"aria-controls":unref(b),"aria-describedby":unref(b),tabindex:k.disabled?-1:0,type:"button",onClick:y[0]||(y[0]=(...O)=>unref(i)&&unref(i)(...O)),onKeydown:y[1]||(y[1]=withKeys(withModifiers((...O)=>unref(u)&&unref(u)(...O),["stop","prevent"]),["space","enter"])),onFocus:y[2]||(y[2]=(...O)=>unref(a)&&unref(a)(...O)),onBlur:y[3]||(y[3]=O=>n.value=!1)},[renderSlot(k.$slots,"title",{},()=>[createTextVNode(toDisplayString(k.title),1)]),createVNode(unref(ElIcon),{class:normalizeClass(unref(d))},{default:withCtx(()=>[createVNode(unref(arrow_right_default))]),_:1},8,["class"])],42,_hoisted_1$j),createVNode(unref(_CollapseTransition),null,{default:withCtx(()=>[withDirectives(createBaseVNode("div",{id:unref(b),role:"region",class:normalizeClass(unref(v)),"aria-hidden":!unref(s),"aria-labelledby":unref(T)},[createBaseVNode("div",{class:normalizeClass(unref(g))},[renderSlot(k.$slots,"default")],2)],10,_hoisted_2$d),[[vShow,unref(s)]])]),_:3})],2))}});var CollapseItem=_export_sfc(_sfc_main$A,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse-item.vue"]]);const ElCollapse=withInstall(Collapse,{CollapseItem}),ElCollapseItem=withNoopInstall(CollapseItem),__default__$h=defineComponent({name:"ElContainer"}),_sfc_main$z=defineComponent({...__default__$h,props:{direction:{type:String}},setup(t){const r=t,e=useSlots(),n=useNamespace("container"),o=computed(()=>r.direction==="vertical"?!0:r.direction==="horizontal"?!1:e&&e.default?e.default().some(a=>{const i=a.type.name;return i==="ElHeader"||i==="ElFooter"}):!1);return(s,a)=>(openBlock(),createElementBlock("section",{class:normalizeClass([unref(n).b(),unref(n).is("vertical",unref(o))])},[renderSlot(s.$slots,"default")],2))}});var Container=_export_sfc(_sfc_main$z,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/container.vue"]]);const __default__$g=defineComponent({name:"ElAside"}),_sfc_main$y=defineComponent({...__default__$g,props:{width:{type:String,default:null}},setup(t){const r=t,e=useNamespace("aside"),n=computed(()=>r.width?e.cssVarBlock({width:r.width}):{});return(o,s)=>(openBlock(),createElementBlock("aside",{class:normalizeClass(unref(e).b()),style:normalizeStyle(unref(n))},[renderSlot(o.$slots,"default")],6))}});var Aside=_export_sfc(_sfc_main$y,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/aside.vue"]]);const __default__$f=defineComponent({name:"ElFooter"}),_sfc_main$x=defineComponent({...__default__$f,props:{height:{type:String,default:null}},setup(t){const r=t,e=useNamespace("footer"),n=computed(()=>r.height?e.cssVarBlock({height:r.height}):{});return(o,s)=>(openBlock(),createElementBlock("footer",{class:normalizeClass(unref(e).b()),style:normalizeStyle(unref(n))},[renderSlot(o.$slots,"default")],6))}});var Footer=_export_sfc(_sfc_main$x,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/footer.vue"]]);const __default__$e=defineComponent({name:"ElHeader"}),_sfc_main$w=defineComponent({...__default__$e,props:{height:{type:String,default:null}},setup(t){const r=t,e=useNamespace("header"),n=computed(()=>r.height?e.cssVarBlock({height:r.height}):{});return(o,s)=>(openBlock(),createElementBlock("header",{class:normalizeClass(unref(e).b()),style:normalizeStyle(unref(n))},[renderSlot(o.$slots,"default")],6))}});var Header=_export_sfc(_sfc_main$w,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/header.vue"]]);const __default__$d=defineComponent({name:"ElMain"}),_sfc_main$v=defineComponent({...__default__$d,setup(t){const r=useNamespace("main");return(e,n)=>(openBlock(),createElementBlock("main",{class:normalizeClass(unref(r).b())},[renderSlot(e.$slots,"default")],2))}});var Main=_export_sfc(_sfc_main$v,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/main.vue"]]);const ElContainer=withInstall(Container,{Aside,Footer,Header,Main});withNoopInstall(Aside);const ElFooter=withNoopInstall(Footer),ElHeader=withNoopInstall(Header),ElMain=withNoopInstall(Main),overlayProps=buildProps({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:definePropType([String,Array,Object])},zIndex:{type:definePropType([String,Number])}}),overlayEmits={click:t=>t instanceof MouseEvent},BLOCK="overlay";var Overlay=defineComponent({name:"ElOverlay",props:overlayProps,emits:overlayEmits,setup(t,{slots:r,emit:e}){const n=useNamespace(BLOCK),o=u=>{e("click",u)},{onClick:s,onMousedown:a,onMouseup:i}=useSameTarget(t.customMaskEvent?void 0:o);return()=>t.mask?createVNode("div",{class:[n.b(),t.overlayClass],style:{zIndex:t.zIndex},onClick:s,onMousedown:a,onMouseup:i},[renderSlot(r,"default")],PatchFlags.STYLE|PatchFlags.CLASS|PatchFlags.PROPS,["onClick","onMouseup","onMousedown"]):h("div",{class:t.overlayClass,style:{zIndex:t.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[renderSlot(r,"default")])}});const ElOverlay=Overlay,dialogInjectionKey=Symbol("dialogInjectionKey"),dialogContentProps=buildProps({center:Boolean,alignCenter:Boolean,closeIcon:{type:iconPropType},customClass:{type:String,default:""},draggable:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),dialogContentEmits={close:()=>!0},_hoisted_1$i=["aria-level"],_hoisted_2$c=["aria-label"],_hoisted_3$8=["id"],__default__$c=defineComponent({name:"ElDialogContent"}),_sfc_main$u=defineComponent({...__default__$c,props:dialogContentProps,emits:dialogContentEmits,setup(t){const r=t,{t:e}=useLocale(),{Close:n}=CloseComponents,{dialogRef:o,headerRef:s,bodyId:a,ns:i,style:u}=inject(dialogInjectionKey),{focusTrapRef:d}=inject(FOCUS_TRAP_INJECTION_KEY),c=computed(()=>[i.b(),i.is("fullscreen",r.fullscreen),i.is("draggable",r.draggable),i.is("align-center",r.alignCenter),{[i.m("center")]:r.center},r.customClass]),m=composeRefs(d,o),v=computed(()=>r.draggable);return useDraggable(o,s,v),(g,b)=>(openBlock(),createElementBlock("div",{ref:unref(m),class:normalizeClass(unref(c)),style:normalizeStyle(unref(u)),tabindex:"-1"},[createBaseVNode("header",{ref_key:"headerRef",ref:s,class:normalizeClass(unref(i).e("header"))},[renderSlot(g.$slots,"header",{},()=>[createBaseVNode("span",{role:"heading","aria-level":g.ariaLevel,class:normalizeClass(unref(i).e("title"))},toDisplayString(g.title),11,_hoisted_1$i)]),g.showClose?(openBlock(),createElementBlock("button",{key:0,"aria-label":unref(e)("el.dialog.close"),class:normalizeClass(unref(i).e("headerbtn")),type:"button",onClick:b[0]||(b[0]=T=>g.$emit("close"))},[createVNode(unref(ElIcon),{class:normalizeClass(unref(i).e("close"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(g.closeIcon||unref(n))))]),_:1},8,["class"])],10,_hoisted_2$c)):createCommentVNode("v-if",!0)],2),createBaseVNode("div",{id:unref(a),class:normalizeClass(unref(i).e("body"))},[renderSlot(g.$slots,"default")],10,_hoisted_3$8),g.$slots.footer?(openBlock(),createElementBlock("footer",{key:0,class:normalizeClass(unref(i).e("footer"))},[renderSlot(g.$slots,"footer")],2)):createCommentVNode("v-if",!0)],6))}});var ElDialogContent=_export_sfc(_sfc_main$u,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog-content.vue"]]);const dialogProps=buildProps({...dialogContentProps,appendToBody:Boolean,beforeClose:{type:definePropType(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1},headerAriaLevel:{type:String,default:"2"}}),dialogEmits={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[UPDATE_MODEL_EVENT]:t=>isBoolean$1(t),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},useDialog=(t,r)=>{const n=getCurrentInstance().emit,{nextZIndex:o}=useZIndex();let s="";const a=useId(),i=useId(),u=ref(!1),d=ref(!1),c=ref(!1),m=ref(t.zIndex||o());let v,g;const b=useGlobalConfig("namespace",defaultNamespace),T=computed(()=>{const Ie={},pe=`--${b.value}-dialog`;return t.fullscreen||(t.top&&(Ie[`${pe}-margin-top`]=t.top),t.width&&(Ie[`${pe}-width`]=addUnit(t.width))),Ie}),k=computed(()=>t.alignCenter?{display:"flex"}:{});function y(){n("opened")}function O(){n("closed"),n(UPDATE_MODEL_EVENT,!1),t.destroyOnClose&&(c.value=!1)}function D(){n("close")}function he(){g==null||g(),v==null||v(),t.openDelay&&t.openDelay>0?{stop:v}=useTimeoutFn(()=>Y(),t.openDelay):Y()}function ae(){v==null||v(),g==null||g(),t.closeDelay&&t.closeDelay>0?{stop:g}=useTimeoutFn(()=>_e(),t.closeDelay):_e()}function Ne(){function Ie(pe){pe||(d.value=!0,u.value=!1)}t.beforeClose?t.beforeClose(Ie):ae()}function ue(){t.closeOnClickModal&&Ne()}function Y(){isClient&&(u.value=!0)}function _e(){u.value=!1}function Ce(){n("openAutoFocus")}function ze(){n("closeAutoFocus")}function ie(Ie){var pe;((pe=Ie.detail)==null?void 0:pe.focusReason)==="pointer"&&Ie.preventDefault()}t.lockScroll&&useLockscreen(u);function le(){t.closeOnPressEscape&&Ne()}return watch(()=>t.modelValue,Ie=>{Ie?(d.value=!1,he(),c.value=!0,m.value=t.zIndex?m.value++:o(),nextTick(()=>{n("open"),r.value&&(r.value.scrollTop=0)})):u.value&&ae()}),watch(()=>t.fullscreen,Ie=>{r.value&&(Ie?(s=r.value.style.transform,r.value.style.transform=""):r.value.style.transform=s)}),onMounted(()=>{t.modelValue&&(u.value=!0,c.value=!0,he())}),{afterEnter:y,afterLeave:O,beforeLeave:D,handleClose:Ne,onModalClick:ue,close:ae,doClose:_e,onOpenAutoFocus:Ce,onCloseAutoFocus:ze,onCloseRequested:le,onFocusoutPrevented:ie,titleId:a,bodyId:i,closed:d,style:T,overlayDialogStyle:k,rendered:c,visible:u,zIndex:m}},_hoisted_1$h=["aria-label","aria-labelledby","aria-describedby"],__default__$b=defineComponent({name:"ElDialog",inheritAttrs:!1}),_sfc_main$t=defineComponent({...__default__$b,props:dialogProps,emits:dialogEmits,setup(t,{expose:r}){const e=t,n=useSlots();useDeprecated({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},computed(()=>!!n.title)),useDeprecated({scope:"el-dialog",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/dialog.html#attributes",type:"Attribute"},computed(()=>!!e.customClass));const o=useNamespace("dialog"),s=ref(),a=ref(),i=ref(),{visible:u,titleId:d,bodyId:c,style:m,overlayDialogStyle:v,rendered:g,zIndex:b,afterEnter:T,afterLeave:k,beforeLeave:y,handleClose:O,onModalClick:D,onOpenAutoFocus:he,onCloseAutoFocus:ae,onCloseRequested:Ne,onFocusoutPrevented:ue}=useDialog(e,s);provide(dialogInjectionKey,{dialogRef:s,headerRef:a,bodyId:c,ns:o,rendered:g,style:m});const Y=useSameTarget(D),_e=computed(()=>e.draggable&&!e.fullscreen);return r({visible:u,dialogContentRef:i}),(Ce,ze)=>(openBlock(),createBlock(Teleport,{to:"body",disabled:!Ce.appendToBody},[createVNode(Transition,{name:"dialog-fade",onAfterEnter:unref(T),onAfterLeave:unref(k),onBeforeLeave:unref(y),persisted:""},{default:withCtx(()=>[withDirectives(createVNode(unref(ElOverlay),{"custom-mask-event":"",mask:Ce.modal,"overlay-class":Ce.modalClass,"z-index":unref(b)},{default:withCtx(()=>[createBaseVNode("div",{role:"dialog","aria-modal":"true","aria-label":Ce.title||void 0,"aria-labelledby":Ce.title?void 0:unref(d),"aria-describedby":unref(c),class:normalizeClass(`${unref(o).namespace.value}-overlay-dialog`),style:normalizeStyle(unref(v)),onClick:ze[0]||(ze[0]=(...ie)=>unref(Y).onClick&&unref(Y).onClick(...ie)),onMousedown:ze[1]||(ze[1]=(...ie)=>unref(Y).onMousedown&&unref(Y).onMousedown(...ie)),onMouseup:ze[2]||(ze[2]=(...ie)=>unref(Y).onMouseup&&unref(Y).onMouseup(...ie))},[createVNode(unref(ElFocusTrap),{loop:"",trapped:unref(u),"focus-start-el":"container",onFocusAfterTrapped:unref(he),onFocusAfterReleased:unref(ae),onFocusoutPrevented:unref(ue),onReleaseRequested:unref(Ne)},{default:withCtx(()=>[unref(g)?(openBlock(),createBlock(ElDialogContent,mergeProps({key:0,ref_key:"dialogContentRef",ref:i},Ce.$attrs,{"custom-class":Ce.customClass,center:Ce.center,"align-center":Ce.alignCenter,"close-icon":Ce.closeIcon,draggable:unref(_e),fullscreen:Ce.fullscreen,"show-close":Ce.showClose,title:Ce.title,"aria-level":Ce.headerAriaLevel,onClose:unref(O)}),createSlots({header:withCtx(()=>[Ce.$slots.title?renderSlot(Ce.$slots,"title",{key:1}):renderSlot(Ce.$slots,"header",{key:0,close:unref(O),titleId:unref(d),titleClass:unref(o).e("title")})]),default:withCtx(()=>[renderSlot(Ce.$slots,"default")]),_:2},[Ce.$slots.footer?{name:"footer",fn:withCtx(()=>[renderSlot(Ce.$slots,"footer")])}:void 0]),1040,["custom-class","center","align-center","close-icon","draggable","fullscreen","show-close","title","aria-level","onClose"])):createCommentVNode("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,_hoisted_1$h)]),_:3},8,["mask","overlay-class","z-index"]),[[vShow,unref(u)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"]))}});var Dialog=_export_sfc(_sfc_main$t,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog.vue"]]);const ElDialog=withInstall(Dialog),_sfc_main$s=defineComponent({inheritAttrs:!1});function _sfc_render$d(t,r,e,n,o,s){return renderSlot(t.$slots,"default")}var Collection=_export_sfc(_sfc_main$s,[["render",_sfc_render$d],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection.vue"]]);const _sfc_main$r=defineComponent({name:"ElCollectionItem",inheritAttrs:!1});function _sfc_render$c(t,r,e,n,o,s){return renderSlot(t.$slots,"default")}var CollectionItem=_export_sfc(_sfc_main$r,[["render",_sfc_render$c],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection-item.vue"]]);const COLLECTION_ITEM_SIGN="data-el-collection-item",createCollectionWithScope=t=>{const r=`El${t}Collection`,e=`${r}Item`,n=Symbol(r),o=Symbol(e),s={...Collection,name:r,setup(){const i=ref(null),u=new Map;provide(n,{itemMap:u,getItems:()=>{const c=unref(i);if(!c)return[];const m=Array.from(c.querySelectorAll(`[${COLLECTION_ITEM_SIGN}]`));return[...u.values()].sort((g,b)=>m.indexOf(g.ref)-m.indexOf(b.ref))},collectionRef:i})}},a={...CollectionItem,name:e,setup(i,{attrs:u}){const d=ref(null),c=inject(n,void 0);provide(o,{collectionItemRef:d}),onMounted(()=>{const m=unref(d);m&&c.itemMap.set(m,{ref:m,...u})}),onBeforeUnmount(()=>{const m=unref(d);c.itemMap.delete(m)})}};return{COLLECTION_INJECTION_KEY:n,COLLECTION_ITEM_INJECTION_KEY:o,ElCollection:s,ElCollectionItem:a}},rovingFocusGroupProps=buildProps({style:{type:definePropType([String,Array,Object])},currentTabId:{type:definePropType(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:definePropType(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:ElCollection$1,ElCollectionItem:ElCollectionItem$1,COLLECTION_INJECTION_KEY:COLLECTION_INJECTION_KEY$1,COLLECTION_ITEM_INJECTION_KEY:COLLECTION_ITEM_INJECTION_KEY$1}=createCollectionWithScope("RovingFocusGroup"),ROVING_FOCUS_GROUP_INJECTION_KEY=Symbol("elRovingFocusGroup"),ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY=Symbol("elRovingFocusGroupItem"),MAP_KEY_TO_FOCUS_INTENT={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},getDirectionAwareKey=(t,r)=>{if(r!=="rtl")return t;switch(t){case EVENT_CODE.right:return EVENT_CODE.left;case EVENT_CODE.left:return EVENT_CODE.right;default:return t}},getFocusIntent=(t,r,e)=>{const n=getDirectionAwareKey(t.key,e);if(!(r==="vertical"&&[EVENT_CODE.left,EVENT_CODE.right].includes(n))&&!(r==="horizontal"&&[EVENT_CODE.up,EVENT_CODE.down].includes(n)))return MAP_KEY_TO_FOCUS_INTENT[n]},reorderArray=(t,r)=>t.map((e,n)=>t[(n+r)%t.length]),focusFirst=t=>{const{activeElement:r}=document;for(const e of t)if(e===r||(e.focus(),r!==document.activeElement))return},CURRENT_TAB_ID_CHANGE_EVT="currentTabIdChange",ENTRY_FOCUS_EVT="rovingFocusGroup.entryFocus",EVT_OPTS={bubbles:!1,cancelable:!0},_sfc_main$q=defineComponent({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:rovingFocusGroupProps,emits:[CURRENT_TAB_ID_CHANGE_EVT,"entryFocus"],setup(t,{emit:r}){var e;const n=ref((e=t.currentTabId||t.defaultCurrentTabId)!=null?e:null),o=ref(!1),s=ref(!1),a=ref(null),{getItems:i}=inject(COLLECTION_INJECTION_KEY$1,void 0),u=computed(()=>[{outline:"none"},t.style]),d=T=>{r(CURRENT_TAB_ID_CHANGE_EVT,T)},c=()=>{o.value=!0},m=composeEventHandlers(T=>{var k;(k=t.onMousedown)==null||k.call(t,T)},()=>{s.value=!0}),v=composeEventHandlers(T=>{var k;(k=t.onFocus)==null||k.call(t,T)},T=>{const k=!unref(s),{target:y,currentTarget:O}=T;if(y===O&&k&&!unref(o)){const D=new Event(ENTRY_FOCUS_EVT,EVT_OPTS);if(O==null||O.dispatchEvent(D),!D.defaultPrevented){const he=i().filter(_e=>_e.focusable),ae=he.find(_e=>_e.active),Ne=he.find(_e=>_e.id===unref(n)),Y=[ae,Ne,...he].filter(Boolean).map(_e=>_e.ref);focusFirst(Y)}}s.value=!1}),g=composeEventHandlers(T=>{var k;(k=t.onBlur)==null||k.call(t,T)},()=>{o.value=!1}),b=(...T)=>{r("entryFocus",...T)};provide(ROVING_FOCUS_GROUP_INJECTION_KEY,{currentTabbedId:readonly(n),loop:toRef(t,"loop"),tabIndex:computed(()=>unref(o)?-1:0),rovingFocusGroupRef:a,rovingFocusGroupRootStyle:u,orientation:toRef(t,"orientation"),dir:toRef(t,"dir"),onItemFocus:d,onItemShiftTab:c,onBlur:g,onFocus:v,onMousedown:m}),watch(()=>t.currentTabId,T=>{n.value=T??null}),useEventListener(a,ENTRY_FOCUS_EVT,b)}});function _sfc_render$b(t,r,e,n,o,s){return renderSlot(t.$slots,"default")}var ElRovingFocusGroupImpl=_export_sfc(_sfc_main$q,[["render",_sfc_render$b],["__file","/home/runner/work/element-plus/element-plus/packages/components/roving-focus-group/src/roving-focus-group-impl.vue"]]);const _sfc_main$p=defineComponent({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:ElCollection$1,ElRovingFocusGroupImpl}});function _sfc_render$a(t,r,e,n,o,s){const a=resolveComponent("el-roving-focus-group-impl"),i=resolveComponent("el-focus-group-collection");return openBlock(),createBlock(i,null,{default:withCtx(()=>[createVNode(a,normalizeProps(guardReactiveProps(t.$attrs)),{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},16)]),_:3})}var ElRovingFocusGroup=_export_sfc(_sfc_main$p,[["render",_sfc_render$a],["__file","/home/runner/work/element-plus/element-plus/packages/components/roving-focus-group/src/roving-focus-group.vue"]]);const _sfc_main$o=defineComponent({components:{ElRovingFocusCollectionItem:ElCollectionItem$1},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(t,{emit:r}){const{currentTabbedId:e,loop:n,onItemFocus:o,onItemShiftTab:s}=inject(ROVING_FOCUS_GROUP_INJECTION_KEY,void 0),{getItems:a}=inject(COLLECTION_INJECTION_KEY$1,void 0),i=useId(),u=ref(null),d=composeEventHandlers(g=>{r("mousedown",g)},g=>{t.focusable?o(unref(i)):g.preventDefault()}),c=composeEventHandlers(g=>{r("focus",g)},()=>{o(unref(i))}),m=composeEventHandlers(g=>{r("keydown",g)},g=>{const{key:b,shiftKey:T,target:k,currentTarget:y}=g;if(b===EVENT_CODE.tab&&T){s();return}if(k!==y)return;const O=getFocusIntent(g);if(O){g.preventDefault();let he=a().filter(ae=>ae.focusable).map(ae=>ae.ref);switch(O){case"last":{he.reverse();break}case"prev":case"next":{O==="prev"&&he.reverse();const ae=he.indexOf(y);he=n.value?reorderArray(he,ae+1):he.slice(ae+1);break}}nextTick(()=>{focusFirst(he)})}}),v=computed(()=>e.value===unref(i));return provide(ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY,{rovingFocusGroupItemRef:u,tabIndex:computed(()=>unref(v)?0:-1),handleMousedown:d,handleFocus:c,handleKeydown:m}),{id:i,handleKeydown:m,handleFocus:c,handleMousedown:d}}});function _sfc_render$9(t,r,e,n,o,s){const a=resolveComponent("el-roving-focus-collection-item");return openBlock(),createBlock(a,{id:t.id,focusable:t.focusable,active:t.active},{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},8,["id","focusable","active"])}var ElRovingFocusItem=_export_sfc(_sfc_main$o,[["render",_sfc_render$9],["__file","/home/runner/work/element-plus/element-plus/packages/components/roving-focus-group/src/roving-focus-item.vue"]]);const dropdownProps=buildProps({trigger:useTooltipTriggerProps.trigger,effect:{...useTooltipContentProps.effect,default:"light"},type:{type:definePropType(String)},placement:{type:definePropType(String),default:"bottom"},popperOptions:{type:definePropType(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:definePropType([Number,String]),default:0},maxHeight:{type:definePropType([Number,String]),default:""},popperClass:{type:String,default:""},disabled:{type:Boolean,default:!1},role:{type:String,default:"menu"},buttonProps:{type:definePropType(Object)},teleported:useTooltipContentProps.teleported}),dropdownItemProps=buildProps({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:iconPropType}}),dropdownMenuProps=buildProps({onKeydown:{type:definePropType(Function)}}),FIRST_KEYS=[EVENT_CODE.down,EVENT_CODE.pageDown,EVENT_CODE.home],LAST_KEYS=[EVENT_CODE.up,EVENT_CODE.pageUp,EVENT_CODE.end],FIRST_LAST_KEYS=[...FIRST_KEYS,...LAST_KEYS],{ElCollection,ElCollectionItem,COLLECTION_INJECTION_KEY,COLLECTION_ITEM_INJECTION_KEY}=createCollectionWithScope("Dropdown"),DROPDOWN_INJECTION_KEY=Symbol("elDropdown"),{ButtonGroup:ElButtonGroup}=ElButton,_sfc_main$n=defineComponent({name:"ElDropdown",components:{ElButton,ElButtonGroup,ElScrollbar,ElDropdownCollection:ElCollection,ElTooltip,ElRovingFocusGroup,ElOnlyChild:OnlyChild,ElIcon,ArrowDown:arrow_down_default},props:dropdownProps,emits:["visible-change","click","command"],setup(t,{emit:r}){const e=getCurrentInstance(),n=useNamespace("dropdown"),{t:o}=useLocale(),s=ref(),a=ref(),i=ref(null),u=ref(null),d=ref(null),c=ref(null),m=ref(!1),v=[EVENT_CODE.enter,EVENT_CODE.space,EVENT_CODE.down],g=computed(()=>({maxHeight:addUnit(t.maxHeight)})),b=computed(()=>[n.m(ae.value)]),T=computed(()=>castArray$1(t.trigger)),k=useId().value,y=computed(()=>t.id||k);watch([s,T],([$e,Lt],[Dt])=>{var dr,pr,sr;(dr=Dt==null?void 0:Dt.$el)!=null&&dr.removeEventListener&&Dt.$el.removeEventListener("pointerenter",ue),(pr=$e==null?void 0:$e.$el)!=null&&pr.removeEventListener&&$e.$el.removeEventListener("pointerenter",ue),(sr=$e==null?void 0:$e.$el)!=null&&sr.addEventListener&&Lt.includes("hover")&&$e.$el.addEventListener("pointerenter",ue)},{immediate:!0}),onBeforeUnmount(()=>{var $e,Lt;(Lt=($e=s.value)==null?void 0:$e.$el)!=null&&Lt.removeEventListener&&s.value.$el.removeEventListener("pointerenter",ue)});function O(){D()}function D(){var $e;($e=i.value)==null||$e.onClose()}function he(){var $e;($e=i.value)==null||$e.onOpen()}const ae=useFormSize();function Ne(...$e){r("command",...$e)}function ue(){var $e,Lt;(Lt=($e=s.value)==null?void 0:$e.$el)==null||Lt.focus()}function Y(){}function _e(){const $e=unref(u);T.value.includes("hover")&&($e==null||$e.focus()),c.value=null}function Ce($e){c.value=$e}function ze($e){m.value||($e.preventDefault(),$e.stopImmediatePropagation())}function ie(){r("visible-change",!0)}function le($e){($e==null?void 0:$e.type)==="keydown"&&u.value.focus()}function Ie(){r("visible-change",!1)}return provide(DROPDOWN_INJECTION_KEY,{contentRef:u,role:computed(()=>t.role),triggerId:y,isUsingKeyboard:m,onItemEnter:Y,onItemLeave:_e}),provide("elDropdown",{instance:e,dropdownSize:ae,handleClick:O,commandHandler:Ne,trigger:toRef(t,"trigger"),hideOnClick:toRef(t,"hideOnClick")}),{t:o,ns:n,scrollbar:d,wrapStyle:g,dropdownTriggerKls:b,dropdownSize:ae,triggerId:y,triggerKeys:v,currentTabId:c,handleCurrentTabIdChange:Ce,handlerMainButtonClick:$e=>{r("click",$e)},handleEntryFocus:ze,handleClose:D,handleOpen:he,handleBeforeShowTooltip:ie,handleShowTooltip:le,handleBeforeHideTooltip:Ie,onFocusAfterTrapped:$e=>{var Lt,Dt;$e.preventDefault(),(Dt=(Lt=u.value)==null?void 0:Lt.focus)==null||Dt.call(Lt,{preventScroll:!0})},popperRef:i,contentRef:u,triggeringElementRef:s,referenceElementRef:a}}});function _sfc_render$8(t,r,e,n,o,s){var a;const i=resolveComponent("el-dropdown-collection"),u=resolveComponent("el-roving-focus-group"),d=resolveComponent("el-scrollbar"),c=resolveComponent("el-only-child"),m=resolveComponent("el-tooltip"),v=resolveComponent("el-button"),g=resolveComponent("arrow-down"),b=resolveComponent("el-icon"),T=resolveComponent("el-button-group");return openBlock(),createElementBlock("div",{class:normalizeClass([t.ns.b(),t.ns.is("disabled",t.disabled)])},[createVNode(m,{ref:"popperRef",role:t.role,effect:t.effect,"fallback-placements":["bottom","top"],"popper-options":t.popperOptions,"gpu-acceleration":!1,"hide-after":t.trigger==="hover"?t.hideTimeout:0,"manual-mode":!0,placement:t.placement,"popper-class":[t.ns.e("popper"),t.popperClass],"reference-element":(a=t.referenceElementRef)==null?void 0:a.$el,trigger:t.trigger,"trigger-keys":t.triggerKeys,"trigger-target-el":t.contentRef,"show-after":t.trigger==="hover"?t.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":t.triggeringElementRef,"virtual-triggering":t.splitButton,disabled:t.disabled,transition:`${t.ns.namespace.value}-zoom-in-top`,teleported:t.teleported,pure:"",persistent:"",onBeforeShow:t.handleBeforeShowTooltip,onShow:t.handleShowTooltip,onBeforeHide:t.handleBeforeHideTooltip},createSlots({content:withCtx(()=>[createVNode(d,{ref:"scrollbar","wrap-style":t.wrapStyle,tag:"div","view-class":t.ns.e("list")},{default:withCtx(()=>[createVNode(u,{loop:t.loop,"current-tab-id":t.currentTabId,orientation:"horizontal",onCurrentTabIdChange:t.handleCurrentTabIdChange,onEntryFocus:t.handleEntryFocus},{default:withCtx(()=>[createVNode(i,null,{default:withCtx(()=>[renderSlot(t.$slots,"dropdown")]),_:3})]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])]),_:3},8,["wrap-style","view-class"])]),_:2},[t.splitButton?void 0:{name:"default",fn:withCtx(()=>[createVNode(c,{id:t.triggerId,ref:"triggeringElementRef",role:"button",tabindex:t.tabindex},{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","onBeforeShow","onShow","onBeforeHide"]),t.splitButton?(openBlock(),createBlock(T,{key:0},{default:withCtx(()=>[createVNode(v,mergeProps({ref:"referenceElementRef"},t.buttonProps,{size:t.dropdownSize,type:t.type,disabled:t.disabled,tabindex:t.tabindex,onClick:t.handlerMainButtonClick}),{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),createVNode(v,mergeProps({id:t.triggerId,ref:"triggeringElementRef"},t.buttonProps,{role:"button",size:t.dropdownSize,type:t.type,class:t.ns.e("caret-button"),disabled:t.disabled,tabindex:t.tabindex,"aria-label":t.t("el.dropdown.toggleDropdown")}),{default:withCtx(()=>[createVNode(b,{class:normalizeClass(t.ns.e("icon"))},{default:withCtx(()=>[createVNode(g)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):createCommentVNode("v-if",!0)],2)}var Dropdown=_export_sfc(_sfc_main$n,[["render",_sfc_render$8],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown.vue"]]);const _sfc_main$m=defineComponent({name:"DropdownItemImpl",components:{ElIcon},props:dropdownItemProps,emits:["pointermove","pointerleave","click","clickimpl"],setup(t,{emit:r}){const e=useNamespace("dropdown"),{role:n}=inject(DROPDOWN_INJECTION_KEY,void 0),{collectionItemRef:o}=inject(COLLECTION_ITEM_INJECTION_KEY,void 0),{collectionItemRef:s}=inject(COLLECTION_ITEM_INJECTION_KEY$1,void 0),{rovingFocusGroupItemRef:a,tabIndex:i,handleFocus:u,handleKeydown:d,handleMousedown:c}=inject(ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY,void 0),m=composeRefs(o,s,a),v=computed(()=>n.value==="menu"?"menuitem":n.value==="navigation"?"link":"button"),g=composeEventHandlers(b=>{const{code:T}=b;if(T===EVENT_CODE.enter||T===EVENT_CODE.space)return b.preventDefault(),b.stopImmediatePropagation(),r("clickimpl",b),!0},d);return{ns:e,itemRef:m,dataset:{[COLLECTION_ITEM_SIGN]:""},role:v,tabIndex:i,handleFocus:u,handleKeydown:g,handleMousedown:c}}}),_hoisted_1$g=["aria-disabled","tabindex","role"];function _sfc_render$7(t,r,e,n,o,s){const a=resolveComponent("el-icon");return openBlock(),createElementBlock(Fragment,null,[t.divided?(openBlock(),createElementBlock("li",mergeProps({key:0,role:"separator",class:t.ns.bem("menu","item","divided")},t.$attrs),null,16)):createCommentVNode("v-if",!0),createBaseVNode("li",mergeProps({ref:t.itemRef},{...t.dataset,...t.$attrs},{"aria-disabled":t.disabled,class:[t.ns.be("menu","item"),t.ns.is("disabled",t.disabled)],tabindex:t.tabIndex,role:t.role,onClick:r[0]||(r[0]=i=>t.$emit("clickimpl",i)),onFocus:r[1]||(r[1]=(...i)=>t.handleFocus&&t.handleFocus(...i)),onKeydown:r[2]||(r[2]=withModifiers((...i)=>t.handleKeydown&&t.handleKeydown(...i),["self"])),onMousedown:r[3]||(r[3]=(...i)=>t.handleMousedown&&t.handleMousedown(...i)),onPointermove:r[4]||(r[4]=i=>t.$emit("pointermove",i)),onPointerleave:r[5]||(r[5]=i=>t.$emit("pointerleave",i))}),[t.icon?(openBlock(),createBlock(a,{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.icon)))]),_:1})):createCommentVNode("v-if",!0),renderSlot(t.$slots,"default")],16,_hoisted_1$g)],64)}var ElDropdownItemImpl=_export_sfc(_sfc_main$m,[["render",_sfc_render$7],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown-item-impl.vue"]]);const useDropdown=()=>{const t=inject("elDropdown",{}),r=computed(()=>t==null?void 0:t.dropdownSize);return{elDropdown:t,_elDropdownSize:r}},_sfc_main$l=defineComponent({name:"ElDropdownItem",components:{ElDropdownCollectionItem:ElCollectionItem,ElRovingFocusItem,ElDropdownItemImpl},inheritAttrs:!1,props:dropdownItemProps,emits:["pointermove","pointerleave","click"],setup(t,{emit:r,attrs:e}){const{elDropdown:n}=useDropdown(),o=getCurrentInstance(),s=ref(null),a=computed(()=>{var g,b;return(b=(g=unref(s))==null?void 0:g.textContent)!=null?b:""}),{onItemEnter:i,onItemLeave:u}=inject(DROPDOWN_INJECTION_KEY,void 0),d=composeEventHandlers(g=>(r("pointermove",g),g.defaultPrevented),whenMouse(g=>{if(t.disabled){u(g);return}const b=g.currentTarget;b===document.activeElement||b.contains(document.activeElement)||(i(g),g.defaultPrevented||b==null||b.focus())})),c=composeEventHandlers(g=>(r("pointerleave",g),g.defaultPrevented),whenMouse(g=>{u(g)})),m=composeEventHandlers(g=>{if(!t.disabled)return r("click",g),g.type!=="keydown"&&g.defaultPrevented},g=>{var b,T,k;if(t.disabled){g.stopImmediatePropagation();return}(b=n==null?void 0:n.hideOnClick)!=null&&b.value&&((T=n.handleClick)==null||T.call(n)),(k=n.commandHandler)==null||k.call(n,t.command,o,g)}),v=computed(()=>({...t,...e}));return{handleClick:m,handlePointerMove:d,handlePointerLeave:c,textContent:a,propsAndAttrs:v}}});function _sfc_render$6(t,r,e,n,o,s){var a;const i=resolveComponent("el-dropdown-item-impl"),u=resolveComponent("el-roving-focus-item"),d=resolveComponent("el-dropdown-collection-item");return openBlock(),createBlock(d,{disabled:t.disabled,"text-value":(a=t.textValue)!=null?a:t.textContent},{default:withCtx(()=>[createVNode(u,{focusable:!t.disabled},{default:withCtx(()=>[createVNode(i,mergeProps(t.propsAndAttrs,{onPointerleave:t.handlePointerLeave,onPointermove:t.handlePointerMove,onClickimpl:t.handleClick}),{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},16,["onPointerleave","onPointermove","onClickimpl"])]),_:3},8,["focusable"])]),_:3},8,["disabled","text-value"])}var DropdownItem=_export_sfc(_sfc_main$l,[["render",_sfc_render$6],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown-item.vue"]]);const _sfc_main$k=defineComponent({name:"ElDropdownMenu",props:dropdownMenuProps,setup(t){const r=useNamespace("dropdown"),{_elDropdownSize:e}=useDropdown(),n=e.value,{focusTrapRef:o,onKeydown:s}=inject(FOCUS_TRAP_INJECTION_KEY,void 0),{contentRef:a,role:i,triggerId:u}=inject(DROPDOWN_INJECTION_KEY,void 0),{collectionRef:d,getItems:c}=inject(COLLECTION_INJECTION_KEY,void 0),{rovingFocusGroupRef:m,rovingFocusGroupRootStyle:v,tabIndex:g,onBlur:b,onFocus:T,onMousedown:k}=inject(ROVING_FOCUS_GROUP_INJECTION_KEY,void 0),{collectionRef:y}=inject(COLLECTION_INJECTION_KEY$1,void 0),O=computed(()=>[r.b("menu"),r.bm("menu",n==null?void 0:n.value)]),D=composeRefs(a,d,o,m,y),he=composeEventHandlers(Ne=>{var ue;(ue=t.onKeydown)==null||ue.call(t,Ne)},Ne=>{const{currentTarget:ue,code:Y,target:_e}=Ne;if(ue.contains(_e),EVENT_CODE.tab===Y&&Ne.stopImmediatePropagation(),Ne.preventDefault(),_e!==unref(a)||!FIRST_LAST_KEYS.includes(Y))return;const ze=c().filter(ie=>!ie.disabled).map(ie=>ie.ref);LAST_KEYS.includes(Y)&&ze.reverse(),focusFirst(ze)});return{size:n,rovingFocusGroupRootStyle:v,tabIndex:g,dropdownKls:O,role:i,triggerId:u,dropdownListWrapperRef:D,handleKeydown:Ne=>{he(Ne),s(Ne)},onBlur:b,onFocus:T,onMousedown:k}}}),_hoisted_1$f=["role","aria-labelledby"];function _sfc_render$5(t,r,e,n,o,s){return openBlock(),createElementBlock("ul",{ref:t.dropdownListWrapperRef,class:normalizeClass(t.dropdownKls),style:normalizeStyle(t.rovingFocusGroupRootStyle),tabindex:-1,role:t.role,"aria-labelledby":t.triggerId,onBlur:r[0]||(r[0]=(...a)=>t.onBlur&&t.onBlur(...a)),onFocus:r[1]||(r[1]=(...a)=>t.onFocus&&t.onFocus(...a)),onKeydown:r[2]||(r[2]=withModifiers((...a)=>t.handleKeydown&&t.handleKeydown(...a),["self"])),onMousedown:r[3]||(r[3]=withModifiers((...a)=>t.onMousedown&&t.onMousedown(...a),["self"]))},[renderSlot(t.$slots,"default")],46,_hoisted_1$f)}var DropdownMenu=_export_sfc(_sfc_main$k,[["render",_sfc_render$5],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown-menu.vue"]]);const ElDropdown=withInstall(Dropdown,{DropdownItem,DropdownMenu}),ElDropdownItem=withNoopInstall(DropdownItem),ElDropdownMenu=withNoopInstall(DropdownMenu),imageViewerProps=buildProps({urlList:{type:definePropType(Array),default:()=>mutable([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7}}),imageViewerEmits={close:()=>!0,switch:t=>isNumber$1(t),rotate:t=>isNumber$1(t)},_hoisted_1$e=["src"],__default__$a=defineComponent({name:"ElImageViewer"}),_sfc_main$j=defineComponent({...__default__$a,props:imageViewerProps,emits:imageViewerEmits,setup(t,{expose:r,emit:e}){const n=t,o={CONTAIN:{name:"contain",icon:markRaw(full_screen_default)},ORIGINAL:{name:"original",icon:markRaw(scale_to_original_default)}},{t:s}=useLocale(),a=useNamespace("image-viewer"),{nextZIndex:i}=useZIndex(),u=ref(),d=ref([]),c=effectScope(),m=ref(!0),v=ref(n.initialIndex),g=shallowRef(o.CONTAIN),b=ref({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),T=computed(()=>{const{urlList:Dt}=n;return Dt.length<=1}),k=computed(()=>v.value===0),y=computed(()=>v.value===n.urlList.length-1),O=computed(()=>n.urlList[v.value]),D=computed(()=>[a.e("btn"),a.e("prev"),a.is("disabled",!n.infinite&&k.value)]),he=computed(()=>[a.e("btn"),a.e("next"),a.is("disabled",!n.infinite&&y.value)]),ae=computed(()=>{const{scale:Dt,deg:dr,offsetX:pr,offsetY:sr,enableTransition:hr}=b.value;let Fe=pr/Dt,nr=sr/Dt;switch(dr%360){case 90:case-270:[Fe,nr]=[nr,-Fe];break;case 180:case-180:[Fe,nr]=[-Fe,-nr];break;case 270:case-90:[Fe,nr]=[-nr,Fe];break}const ir={transform:`scale(${Dt}) rotate(${dr}deg) translate(${Fe}px, ${nr}px)`,transition:hr?"transform .3s":""};return g.value.name===o.CONTAIN.name&&(ir.maxWidth=ir.maxHeight="100%"),ir}),Ne=computed(()=>isNumber$1(n.zIndex)?n.zIndex:i());function ue(){_e(),e("close")}function Y(){const Dt=throttle(pr=>{switch(pr.code){case EVENT_CODE.esc:n.closeOnPressEscape&&ue();break;case EVENT_CODE.space:Ie();break;case EVENT_CODE.left:qe();break;case EVENT_CODE.up:Lt("zoomIn");break;case EVENT_CODE.right:$e();break;case EVENT_CODE.down:Lt("zoomOut");break}}),dr=throttle(pr=>{const sr=pr.deltaY||pr.deltaX;Lt(sr<0?"zoomIn":"zoomOut",{zoomRate:n.zoomRate,enableTransition:!1})});c.run(()=>{useEventListener(document,"keydown",Dt),useEventListener(document,"wheel",dr)})}function _e(){c.stop()}function Ce(){m.value=!1}function ze(Dt){m.value=!1,Dt.target.alt=s("el.image.error")}function ie(Dt){if(m.value||Dt.button!==0||!u.value)return;b.value.enableTransition=!1;const{offsetX:dr,offsetY:pr}=b.value,sr=Dt.pageX,hr=Dt.pageY,Fe=throttle(ir=>{b.value={...b.value,offsetX:dr+ir.pageX-sr,offsetY:pr+ir.pageY-hr}}),nr=useEventListener(document,"mousemove",Fe);useEventListener(document,"mouseup",()=>{nr()}),Dt.preventDefault()}function le(){b.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Ie(){if(m.value)return;const Dt=keysOf(o),dr=Object.values(o),pr=g.value.name,hr=(dr.findIndex(Fe=>Fe.name===pr)+1)%Dt.length;g.value=o[Dt[hr]],le()}function pe(Dt){const dr=n.urlList.length;v.value=(Dt+dr)%dr}function qe(){k.value&&!n.infinite||pe(v.value-1)}function $e(){y.value&&!n.infinite||pe(v.value+1)}function Lt(Dt,dr={}){if(m.value)return;const{minScale:pr,maxScale:sr}=n,{zoomRate:hr,rotateDeg:Fe,enableTransition:nr}={zoomRate:n.zoomRate,rotateDeg:90,enableTransition:!0,...dr};switch(Dt){case"zoomOut":b.value.scale>pr&&(b.value.scale=Number.parseFloat((b.value.scale/hr).toFixed(3)));break;case"zoomIn":b.value.scale<sr&&(b.value.scale=Number.parseFloat((b.value.scale*hr).toFixed(3)));break;case"clockwise":b.value.deg+=Fe,e("rotate",b.value.deg);break;case"anticlockwise":b.value.deg-=Fe,e("rotate",b.value.deg);break}b.value.enableTransition=nr}return watch(O,()=>{nextTick(()=>{const Dt=d.value[0];Dt!=null&&Dt.complete||(m.value=!0)})}),watch(v,Dt=>{le(),e("switch",Dt)}),onMounted(()=>{var Dt,dr;Y(),(dr=(Dt=u.value)==null?void 0:Dt.focus)==null||dr.call(Dt)}),r({setActiveItem:pe}),(Dt,dr)=>(openBlock(),createBlock(Teleport,{to:"body",disabled:!Dt.teleported},[createVNode(Transition,{name:"viewer-fade",appear:""},{default:withCtx(()=>[createBaseVNode("div",{ref_key:"wrapper",ref:u,tabindex:-1,class:normalizeClass(unref(a).e("wrapper")),style:normalizeStyle({zIndex:unref(Ne)})},[createBaseVNode("div",{class:normalizeClass(unref(a).e("mask")),onClick:dr[0]||(dr[0]=withModifiers(pr=>Dt.hideOnClickModal&&ue(),["self"]))},null,2),createCommentVNode(" CLOSE "),createBaseVNode("span",{class:normalizeClass([unref(a).e("btn"),unref(a).e("close")]),onClick:ue},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(close_default))]),_:1})],2),createCommentVNode(" ARROW "),unref(T)?createCommentVNode("v-if",!0):(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("span",{class:normalizeClass(unref(D)),onClick:qe},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(arrow_left_default))]),_:1})],2),createBaseVNode("span",{class:normalizeClass(unref(he)),onClick:$e},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(arrow_right_default))]),_:1})],2)],64)),createCommentVNode(" ACTIONS "),createBaseVNode("div",{class:normalizeClass([unref(a).e("btn"),unref(a).e("actions")])},[createBaseVNode("div",{class:normalizeClass(unref(a).e("actions__inner"))},[createVNode(unref(ElIcon),{onClick:dr[1]||(dr[1]=pr=>Lt("zoomOut"))},{default:withCtx(()=>[createVNode(unref(zoom_out_default))]),_:1}),createVNode(unref(ElIcon),{onClick:dr[2]||(dr[2]=pr=>Lt("zoomIn"))},{default:withCtx(()=>[createVNode(unref(zoom_in_default))]),_:1}),createBaseVNode("i",{class:normalizeClass(unref(a).e("actions__divider"))},null,2),createVNode(unref(ElIcon),{onClick:Ie},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(g).icon)))]),_:1}),createBaseVNode("i",{class:normalizeClass(unref(a).e("actions__divider"))},null,2),createVNode(unref(ElIcon),{onClick:dr[3]||(dr[3]=pr=>Lt("anticlockwise"))},{default:withCtx(()=>[createVNode(unref(refresh_left_default))]),_:1}),createVNode(unref(ElIcon),{onClick:dr[4]||(dr[4]=pr=>Lt("clockwise"))},{default:withCtx(()=>[createVNode(unref(refresh_right_default))]),_:1})],2)],2),createCommentVNode(" CANVAS "),createBaseVNode("div",{class:normalizeClass(unref(a).e("canvas"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(Dt.urlList,(pr,sr)=>withDirectives((openBlock(),createElementBlock("img",{ref_for:!0,ref:hr=>d.value[sr]=hr,key:pr,src:pr,style:normalizeStyle(unref(ae)),class:normalizeClass(unref(a).e("img")),onLoad:Ce,onError:ze,onMousedown:ie},null,46,_hoisted_1$e)),[[vShow,sr===v.value]])),128))],2),renderSlot(Dt.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var ImageViewer=_export_sfc(_sfc_main$j,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const ElImageViewer=withInstall(ImageViewer),imageProps=buildProps({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:definePropType([String,Object])},previewSrcList:{type:definePropType(Array),default:()=>mutable([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7}}),imageEmits={load:t=>t instanceof Event,error:t=>t instanceof Event,switch:t=>isNumber$1(t),close:()=>!0,show:()=>!0},_hoisted_1$d=["src","loading"],_hoisted_2$b={key:0},__default__$9=defineComponent({name:"ElImage",inheritAttrs:!1}),_sfc_main$i=defineComponent({...__default__$9,props:imageProps,emits:imageEmits,setup(t,{emit:r}){const e=t;let n="";const{t:o}=useLocale(),s=useNamespace("image"),a=useAttrs$1(),i=useAttrs(),u=ref(),d=ref(!1),c=ref(!0),m=ref(!1),v=ref(),g=ref(),b=isClient&&"loading"in HTMLImageElement.prototype;let T,k;const y=computed(()=>[s.e("inner"),he.value&&s.e("preview"),c.value&&s.is("loading")]),O=computed(()=>a.style),D=computed(()=>{const{fit:Lt}=e;return isClient&&Lt?{objectFit:Lt}:{}}),he=computed(()=>{const{previewSrcList:Lt}=e;return Array.isArray(Lt)&&Lt.length>0}),ae=computed(()=>{const{previewSrcList:Lt,initialIndex:Dt}=e;let dr=Dt;return Dt>Lt.length-1&&(dr=0),dr}),Ne=computed(()=>e.loading==="eager"?!1:!b&&e.loading==="lazy"||e.lazy),ue=()=>{isClient&&(c.value=!0,d.value=!1,u.value=e.src)};function Y(Lt){c.value=!1,d.value=!1,r("load",Lt)}function _e(Lt){c.value=!1,d.value=!0,r("error",Lt)}function Ce(){isInContainer(v.value,g.value)&&(ue(),le())}const ze=useThrottleFn(Ce,200,!0);async function ie(){var Lt;if(!isClient)return;await nextTick();const{scrollContainer:Dt}=e;isElement(Dt)?g.value=Dt:isString$2(Dt)&&Dt!==""?g.value=(Lt=document.querySelector(Dt))!=null?Lt:void 0:v.value&&(g.value=getScrollContainer(v.value)),g.value&&(T=useEventListener(g,"scroll",ze),setTimeout(()=>Ce(),100))}function le(){!isClient||!g.value||!ze||(T==null||T(),g.value=void 0)}function Ie(Lt){if(Lt.ctrlKey){if(Lt.deltaY<0)return Lt.preventDefault(),!1;if(Lt.deltaY>0)return Lt.preventDefault(),!1}}function pe(){he.value&&(k=useEventListener("wheel",Ie,{passive:!1}),n=document.body.style.overflow,document.body.style.overflow="hidden",m.value=!0,r("show"))}function qe(){k==null||k(),document.body.style.overflow=n,m.value=!1,r("close")}function $e(Lt){r("switch",Lt)}return watch(()=>e.src,()=>{Ne.value?(c.value=!0,d.value=!1,le(),ie()):ue()}),onMounted(()=>{Ne.value?ie():ue()}),(Lt,Dt)=>(openBlock(),createElementBlock("div",{ref_key:"container",ref:v,class:normalizeClass([unref(s).b(),Lt.$attrs.class]),style:normalizeStyle(unref(O))},[d.value?renderSlot(Lt.$slots,"error",{key:0},()=>[createBaseVNode("div",{class:normalizeClass(unref(s).e("error"))},toDisplayString(unref(o)("el.image.error")),3)]):(openBlock(),createElementBlock(Fragment,{key:1},[u.value!==void 0?(openBlock(),createElementBlock("img",mergeProps({key:0},unref(i),{src:u.value,loading:Lt.loading,style:unref(D),class:unref(y),onClick:pe,onLoad:Y,onError:_e}),null,16,_hoisted_1$d)):createCommentVNode("v-if",!0),c.value?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(s).e("wrapper"))},[renderSlot(Lt.$slots,"placeholder",{},()=>[createBaseVNode("div",{class:normalizeClass(unref(s).e("placeholder"))},null,2)])],2)):createCommentVNode("v-if",!0)],64)),unref(he)?(openBlock(),createElementBlock(Fragment,{key:2},[m.value?(openBlock(),createBlock(unref(ElImageViewer),{key:0,"z-index":Lt.zIndex,"initial-index":unref(ae),infinite:Lt.infinite,"zoom-rate":Lt.zoomRate,"min-scale":Lt.minScale,"max-scale":Lt.maxScale,"url-list":Lt.previewSrcList,"hide-on-click-modal":Lt.hideOnClickModal,teleported:Lt.previewTeleported,"close-on-press-escape":Lt.closeOnPressEscape,onClose:qe,onSwitch:$e},{default:withCtx(()=>[Lt.$slots.viewer?(openBlock(),createElementBlock("div",_hoisted_2$b,[renderSlot(Lt.$slots,"viewer")])):createCommentVNode("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):createCommentVNode("v-if",!0)],64)):createCommentVNode("v-if",!0)],6))}});var Image$1=_export_sfc(_sfc_main$i,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const ElImage=withInstall(Image$1),selectGroupKey=Symbol("ElSelectGroup"),selectKey=Symbol("ElSelect");function useOption(t,r){const e=inject(selectKey),n=inject(selectGroupKey,{disabled:!1}),o=computed(()=>isObject$2(t.value)),s=computed(()=>e.props.multiple?m(e.props.modelValue,t.value):v(t.value,e.props.modelValue)),a=computed(()=>{if(e.props.multiple){const T=e.props.modelValue||[];return!s.value&&T.length>=e.props.multipleLimit&&e.props.multipleLimit>0}else return!1}),i=computed(()=>t.label||(o.value?"":t.value)),u=computed(()=>t.value||t.label||""),d=computed(()=>t.disabled||r.groupDisabled||a.value),c=getCurrentInstance(),m=(T=[],k)=>{if(o.value){const y=e.props.valueKey;return T&&T.some(O=>toRaw(get(O,y))===get(k,y))}else return T&&T.includes(k)},v=(T,k)=>{if(o.value){const{valueKey:y}=e.props;return get(T,y)===get(k,y)}else return T===k},g=()=>{!t.disabled&&!n.disabled&&(e.hoverIndex=e.optionsArray.indexOf(c.proxy))};watch(()=>i.value,()=>{!t.created&&!e.props.remote&&e.setSelected()}),watch(()=>t.value,(T,k)=>{const{remote:y,valueKey:O}=e.props;if(Object.is(T,k)||(e.onOptionDestroy(k,c.proxy),e.onOptionCreate(c.proxy)),!t.created&&!y){if(O&&isObject$2(T)&&isObject$2(k)&&T[O]===k[O])return;e.setSelected()}}),watch(()=>n.disabled,()=>{r.groupDisabled=n.disabled},{immediate:!0});const{queryChange:b}=toRaw(e);return watch(b,T=>{const{query:k}=unref(T),y=new RegExp(escapeStringRegexp(k),"i");r.visible=y.test(i.value)||t.created,r.visible||e.filteredOptionsCount--},{immediate:!0}),{select:e,currentLabel:i,currentValue:u,itemSelected:s,isDisabled:d,hoverItem:g}}const _sfc_main$h=defineComponent({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(t){const r=useNamespace("select"),e=useId(),n=computed(()=>[r.be("dropdown","item"),r.is("disabled",unref(i)),{selected:unref(a),hover:unref(m)}]),o=reactive({index:-1,groupDisabled:!1,visible:!0,hitState:!1,hover:!1}),{currentLabel:s,itemSelected:a,isDisabled:i,select:u,hoverItem:d}=useOption(t,o),{visible:c,hover:m}=toRefs(o),v=getCurrentInstance().proxy;u.onOptionCreate(v),onBeforeUnmount(()=>{const b=v.value,{selected:T}=u,y=(u.props.multiple?T:[T]).some(O=>O.value===v.value);nextTick(()=>{u.cachedOptions.get(b)===v&&!y&&u.cachedOptions.delete(b)}),u.onOptionDestroy(b,v)});function g(){t.disabled!==!0&&o.groupDisabled!==!0&&u.handleOptionSelect(v)}return{ns:r,id:e,containerKls:n,currentLabel:s,itemSelected:a,isDisabled:i,select:u,hoverItem:d,visible:c,hover:m,selectOptionClick:g,states:o}}}),_hoisted_1$c=["id","aria-disabled","aria-selected"];function _sfc_render$4(t,r,e,n,o,s){return withDirectives((openBlock(),createElementBlock("li",{id:t.id,class:normalizeClass(t.containerKls),role:"option","aria-disabled":t.isDisabled||void 0,"aria-selected":t.itemSelected,onMouseenter:r[0]||(r[0]=(...a)=>t.hoverItem&&t.hoverItem(...a)),onClick:r[1]||(r[1]=withModifiers((...a)=>t.selectOptionClick&&t.selectOptionClick(...a),["stop"]))},[renderSlot(t.$slots,"default",{},()=>[createBaseVNode("span",null,toDisplayString(t.currentLabel),1)])],42,_hoisted_1$c)),[[vShow,t.visible]])}var Option=_export_sfc(_sfc_main$h,[["render",_sfc_render$4],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option.vue"]]);const _sfc_main$g=defineComponent({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const t=inject(selectKey),r=useNamespace("select"),e=computed(()=>t.props.popperClass),n=computed(()=>t.props.multiple),o=computed(()=>t.props.fitInputWidth),s=ref("");function a(){var i;s.value=`${(i=t.selectWrapper)==null?void 0:i.offsetWidth}px`}return onMounted(()=>{a(),useResizeObserver(t.selectWrapper,a)}),{ns:r,minWidth:s,popperClass:e,isMultiple:n,isFitInputWidth:o}}});function _sfc_render$3(t,r,e,n,o,s){return openBlock(),createElementBlock("div",{class:normalizeClass([t.ns.b("dropdown"),t.ns.is("multiple",t.isMultiple),t.popperClass]),style:normalizeStyle({[t.isFitInputWidth?"width":"minWidth"]:t.minWidth})},[renderSlot(t.$slots,"default")],6)}var ElSelectMenu=_export_sfc(_sfc_main$g,[["render",_sfc_render$3],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select-dropdown.vue"]]);function useSelectStates(t){const{t:r}=useLocale();return reactive({options:new Map,cachedOptions:new Map,disabledOptions:new Map,createdLabel:null,createdSelected:!1,selected:t.multiple?[]:{},inputLength:20,inputWidth:0,optionsCount:0,filteredOptionsCount:0,visible:!1,selectedLabel:"",hoverIndex:-1,query:"",previousQuery:null,inputHovering:!1,cachedPlaceHolder:"",currentPlaceholder:r("el.select.placeholder"),menuVisibleOnFocus:!1,isOnComposition:!1,prefixWidth:11,mouseEnter:!1,focused:!1})}const useSelect=(t,r,e)=>{const{t:n}=useLocale(),o=useNamespace("select");useDeprecated({from:"suffixTransition",replacement:"override style scheme",version:"2.3.0",scope:"props",ref:"https://element-plus.org/en-US/component/select.html#select-attributes"},computed(()=>t.suffixTransition===!1));const s=ref(null),a=ref(null),i=ref(null),u=ref(null),d=ref(null),c=ref(null),m=ref(null),v=ref(null),g=ref(),b=shallowRef({query:""}),T=shallowRef(""),k=ref([]);let y=0;const{form:O,formItem:D}=useFormItem(),he=computed(()=>!t.filterable||t.multiple||!r.visible),ae=computed(()=>t.disabled||(O==null?void 0:O.disabled)),Ne=computed(()=>{const Br=t.multiple?Array.isArray(t.modelValue)&&t.modelValue.length>0:t.modelValue!==void 0&&t.modelValue!==null&&t.modelValue!=="";return t.clearable&&!ae.value&&r.inputHovering&&Br}),ue=computed(()=>t.remote&&t.filterable&&!t.remoteShowSuffix?"":t.suffixIcon),Y=computed(()=>o.is("reverse",ue.value&&r.visible&&t.suffixTransition)),_e=computed(()=>(O==null?void 0:O.statusIcon)&&(D==null?void 0:D.validateState)&&ValidateComponentsMap[D==null?void 0:D.validateState]),Ce=computed(()=>t.remote?300:0),ze=computed(()=>t.loading?t.loadingText||n("el.select.loading"):t.remote&&r.query===""&&r.options.size===0?!1:t.filterable&&r.query&&r.options.size>0&&r.filteredOptionsCount===0?t.noMatchText||n("el.select.noMatch"):r.options.size===0?t.noDataText||n("el.select.noData"):null),ie=computed(()=>{const Br=Array.from(r.options.values()),Gr=[];return k.value.forEach(Bn=>{const Xn=Br.findIndex(_o=>_o.currentLabel===Bn);Xn>-1&&Gr.push(Br[Xn])}),Gr.length>=Br.length?Gr:Br}),le=computed(()=>Array.from(r.cachedOptions.values())),Ie=computed(()=>{const Br=ie.value.filter(Gr=>!Gr.created).some(Gr=>Gr.currentLabel===r.query);return t.filterable&&t.allowCreate&&r.query!==""&&!Br}),pe=useFormSize(),qe=computed(()=>["small"].includes(pe.value)?"small":"default"),$e=computed({get(){return r.visible&&ze.value!==!1},set(Br){r.visible=Br}});watch([()=>ae.value,()=>pe.value,()=>O==null?void 0:O.size],()=>{nextTick(()=>{Lt()})}),watch(()=>t.placeholder,Br=>{r.cachedPlaceHolder=r.currentPlaceholder=Br,t.multiple&&Array.isArray(t.modelValue)&&t.modelValue.length>0&&(r.currentPlaceholder="")}),watch(()=>t.modelValue,(Br,Gr)=>{t.multiple&&(Lt(),Br&&Br.length>0||a.value&&r.query!==""?r.currentPlaceholder="":r.currentPlaceholder=r.cachedPlaceHolder,t.filterable&&!t.reserveKeyword&&(r.query="",Dt(r.query))),sr(),t.filterable&&!t.multiple&&(r.inputLength=20),!isEqual(Br,Gr)&&t.validateEvent&&(D==null||D.validate("change").catch(Bn=>void 0))},{flush:"post",deep:!0}),watch(()=>r.visible,Br=>{var Gr,Bn,Xn,_o,oo;Br?((Bn=(Gr=u.value)==null?void 0:Gr.updatePopper)==null||Bn.call(Gr),t.filterable&&(r.filteredOptionsCount=r.optionsCount,r.query=t.remote?"":r.selectedLabel,(_o=(Xn=i.value)==null?void 0:Xn.focus)==null||_o.call(Xn),t.multiple?(oo=a.value)==null||oo.focus():r.selectedLabel&&(r.currentPlaceholder=`${r.selectedLabel}`,r.selectedLabel=""),Dt(r.query),!t.multiple&&!t.remote&&(b.value.query="",triggerRef(b),triggerRef(T)))):(t.filterable&&(isFunction$3(t.filterMethod)&&t.filterMethod(""),isFunction$3(t.remoteMethod)&&t.remoteMethod("")),r.query="",r.previousQuery=null,r.selectedLabel="",r.inputLength=20,r.menuVisibleOnFocus=!1,Fe(),nextTick(()=>{a.value&&a.value.value===""&&r.selected.length===0&&(r.currentPlaceholder=r.cachedPlaceHolder)}),t.multiple||(r.selected&&(t.filterable&&t.allowCreate&&r.createdSelected&&r.createdLabel?r.selectedLabel=r.createdLabel:r.selectedLabel=r.selected.currentLabel,t.filterable&&(r.query=r.selectedLabel)),t.filterable&&(r.currentPlaceholder=r.cachedPlaceHolder))),e.emit("visible-change",Br)}),watch(()=>r.options.entries(),()=>{var Br,Gr,Bn;if(!isClient)return;(Gr=(Br=u.value)==null?void 0:Br.updatePopper)==null||Gr.call(Br),t.multiple&&Lt();const Xn=((Bn=m.value)==null?void 0:Bn.querySelectorAll("input"))||[];(!t.filterable&&!t.defaultFirstOption&&!isUndefined$1(t.modelValue)||!Array.from(Xn).includes(document.activeElement))&&sr(),t.defaultFirstOption&&(t.filterable||t.remote)&&r.filteredOptionsCount&&pr()},{flush:"post"}),watch(()=>r.hoverIndex,Br=>{isNumber$1(Br)&&Br>-1?g.value=ie.value[Br]||{}:g.value={},ie.value.forEach(Gr=>{Gr.hover=g.value===Gr})});const Lt=()=>{nextTick(()=>{var Br,Gr;if(!s.value)return;const Bn=s.value.$el.querySelector("input");y=y||(Bn.clientHeight>0?Bn.clientHeight+2:0);const Xn=c.value,_o=getComputedStyle(Bn).getPropertyValue(o.cssVarName("input-height")),oo=Number.parseFloat(_o)||getComponentSize(pe.value||(O==null?void 0:O.size)),Ca=pe.value||oo===y||y<=0?oo:y;!(Bn.offsetParent===null)&&(Bn.style.height=`${(r.selected.length===0?Ca:Math.max(Xn?Xn.clientHeight+(Xn.clientHeight>Ca?6:0):0,Ca))-2}px`),r.visible&&ze.value!==!1&&((Gr=(Br=u.value)==null?void 0:Br.updatePopper)==null||Gr.call(Br))})},Dt=async Br=>{if(!(r.previousQuery===Br||r.isOnComposition)){if(r.previousQuery===null&&(isFunction$3(t.filterMethod)||isFunction$3(t.remoteMethod))){r.previousQuery=Br;return}r.previousQuery=Br,nextTick(()=>{var Gr,Bn;r.visible&&((Bn=(Gr=u.value)==null?void 0:Gr.updatePopper)==null||Bn.call(Gr))}),r.hoverIndex=-1,t.multiple&&t.filterable&&nextTick(()=>{if(!ae.value){const Gr=a.value.value.length*15+20;r.inputLength=t.collapseTags?Math.min(50,Gr):Gr,dr()}Lt()}),t.remote&&isFunction$3(t.remoteMethod)?(r.hoverIndex=-1,t.remoteMethod(Br)):isFunction$3(t.filterMethod)?(t.filterMethod(Br),triggerRef(T)):(r.filteredOptionsCount=r.optionsCount,b.value.query=Br,triggerRef(b),triggerRef(T)),t.defaultFirstOption&&(t.filterable||t.remote)&&r.filteredOptionsCount&&(await nextTick(),pr())}},dr=()=>{r.currentPlaceholder!==""&&(r.currentPlaceholder=a.value.value?"":r.cachedPlaceHolder)},pr=()=>{const Br=ie.value.filter(Xn=>Xn.visible&&!Xn.disabled&&!Xn.states.groupDisabled),Gr=Br.find(Xn=>Xn.created),Bn=Br[0];r.hoverIndex=vr(ie.value,Gr||Bn)},sr=()=>{var Br;if(t.multiple)r.selectedLabel="";else{const Bn=hr(t.modelValue);(Br=Bn.props)!=null&&Br.created?(r.createdLabel=Bn.props.value,r.createdSelected=!0):r.createdSelected=!1,r.selectedLabel=Bn.currentLabel,r.selected=Bn,t.filterable&&(r.query=r.selectedLabel);return}const Gr=[];Array.isArray(t.modelValue)&&t.modelValue.forEach(Bn=>{Gr.push(hr(Bn))}),r.selected=Gr,nextTick(()=>{Lt()})},hr=Br=>{let Gr;const Bn=toRawType(Br).toLowerCase()==="object",Xn=toRawType(Br).toLowerCase()==="null",_o=toRawType(Br).toLowerCase()==="undefined";for(let is=r.cachedOptions.size-1;is>=0;is--){const cs=le.value[is];if(Bn?get(cs.value,t.valueKey)===get(Br,t.valueKey):cs.value===Br){Gr={value:Br,currentLabel:cs.currentLabel,isDisabled:cs.isDisabled};break}}if(Gr)return Gr;const oo=Bn?Br.label:!Xn&&!_o?Br:"",Ca={value:Br,currentLabel:oo};return t.multiple&&(Ca.hitState=!1),Ca},Fe=()=>{setTimeout(()=>{const Br=t.valueKey;t.multiple?r.selected.length>0?r.hoverIndex=Math.min.apply(null,r.selected.map(Gr=>ie.value.findIndex(Bn=>get(Bn,Br)===get(Gr,Br)))):r.hoverIndex=-1:r.hoverIndex=ie.value.findIndex(Gr=>Kn(Gr)===Kn(r.selected))},300)},nr=()=>{var Br,Gr;ir(),(Gr=(Br=u.value)==null?void 0:Br.updatePopper)==null||Gr.call(Br),t.multiple&&Lt()},ir=()=>{var Br;r.inputWidth=(Br=s.value)==null?void 0:Br.$el.offsetWidth},Ue=()=>{t.filterable&&r.query!==r.selectedLabel&&(r.query=r.selectedLabel,Dt(r.query))},rr=debounce(()=>{Ue()},Ce.value),or=debounce(Br=>{Dt(Br.target.value)},Ce.value),Pt=Br=>{isEqual(t.modelValue,Br)||e.emit(CHANGE_EVENT,Br)},Et=Br=>findLastIndex(Br,Gr=>!r.disabledOptions.has(Gr)),kt=Br=>{if(Br.code!==EVENT_CODE.delete){if(Br.target.value.length<=0&&!Cn()){const Gr=t.modelValue.slice(),Bn=Et(Gr);if(Bn<0)return;Gr.splice(Bn,1),e.emit(UPDATE_MODEL_EVENT,Gr),Pt(Gr)}Br.target.value.length===1&&t.modelValue.length===0&&(r.currentPlaceholder=r.cachedPlaceHolder)}},er=(Br,Gr)=>{const Bn=r.selected.indexOf(Gr);if(Bn>-1&&!ae.value){const Xn=t.modelValue.slice();Xn.splice(Bn,1),e.emit(UPDATE_MODEL_EVENT,Xn),Pt(Xn),e.emit("remove-tag",Gr.value)}Br.stopPropagation(),Qr()},cr=Br=>{Br.stopPropagation();const Gr=t.multiple?[]:"";if(!isString$2(Gr))for(const Bn of r.selected)Bn.isDisabled&&Gr.push(Bn.value);e.emit(UPDATE_MODEL_EVENT,Gr),Pt(Gr),r.hoverIndex=-1,r.visible=!1,e.emit("clear"),Qr()},mr=Br=>{var Gr;if(t.multiple){const Bn=(t.modelValue||[]).slice(),Xn=vr(Bn,Br.value);Xn>-1?Bn.splice(Xn,1):(t.multipleLimit<=0||Bn.length<t.multipleLimit)&&Bn.push(Br.value),e.emit(UPDATE_MODEL_EVENT,Bn),Pt(Bn),Br.created&&(r.query="",Dt(""),r.inputLength=20),t.filterable&&((Gr=a.value)==null||Gr.focus())}else e.emit(UPDATE_MODEL_EVENT,Br.value),Pt(Br.value),r.visible=!1;Tr(),!r.visible&&nextTick(()=>{Ir(Br)})},vr=(Br=[],Gr)=>{if(!isObject$2(Gr))return Br.indexOf(Gr);const Bn=t.valueKey;let Xn=-1;return Br.some((_o,oo)=>toRaw(get(_o,Bn))===get(Gr,Bn)?(Xn=oo,!0):!1),Xn},Tr=()=>{const Br=a.value||s.value;Br&&(Br==null||Br.focus())},Ir=Br=>{var Gr,Bn,Xn,_o,oo;const Ca=Array.isArray(Br)?Br[0]:Br;let is=null;if(Ca!=null&&Ca.value){const cs=ie.value.filter(Es=>Es.value===Ca.value);cs.length>0&&(is=cs[0].$el)}if(u.value&&is){const cs=(_o=(Xn=(Bn=(Gr=u.value)==null?void 0:Gr.popperRef)==null?void 0:Bn.contentRef)==null?void 0:Xn.querySelector)==null?void 0:_o.call(Xn,`.${o.be("dropdown","wrap")}`);cs&&scrollIntoView(cs,is)}(oo=v.value)==null||oo.handleScroll()},kr=Br=>{r.optionsCount++,r.filteredOptionsCount++,r.options.set(Br.value,Br),r.cachedOptions.set(Br.value,Br),Br.disabled&&r.disabledOptions.set(Br.value,Br)},Ar=(Br,Gr)=>{r.options.get(Br)===Gr&&(r.optionsCount--,r.filteredOptionsCount--,r.options.delete(Br))},Rr=Br=>{Br.code!==EVENT_CODE.backspace&&Cn(!1),r.inputLength=a.value.value.length*15+20,Lt()},Cn=Br=>{if(!Array.isArray(r.selected))return;const Gr=Et(r.selected.map(Xn=>Xn.value)),Bn=r.selected[Gr];if(Bn)return Br===!0||Br===!1?(Bn.hitState=Br,Br):(Bn.hitState=!Bn.hitState,Bn.hitState)},Or=Br=>{const Gr=Br.target.value;if(Br.type==="compositionend")r.isOnComposition=!1,nextTick(()=>Dt(Gr));else{const Bn=Gr[Gr.length-1]||"";r.isOnComposition=!isKorean(Bn)}},Pr=()=>{nextTick(()=>Ir(r.selected))},Nr=Br=>{r.focused||((t.automaticDropdown||t.filterable)&&(t.filterable&&!r.visible&&(r.menuVisibleOnFocus=!0),r.visible=!0),r.focused=!0,e.emit("focus",Br))},Qr=()=>{var Br,Gr;r.visible?(Br=a.value||s.value)==null||Br.focus():(Gr=s.value)==null||Gr.focus()},hn=()=>{var Br,Gr,Bn;r.visible=!1,(Br=s.value)==null||Br.blur(),(Bn=(Gr=i.value)==null?void 0:Gr.blur)==null||Bn.call(Gr)},Ur=Br=>{var Gr,Bn,Xn;(Gr=u.value)!=null&&Gr.isFocusInsideContent(Br)||(Bn=d.value)!=null&&Bn.isFocusInsideContent(Br)||(Xn=m.value)!=null&&Xn.contains(Br.relatedTarget)||(r.visible&&Gn(),r.focused=!1,e.emit("blur",Br))},qr=Br=>{cr(Br)},Gn=()=>{r.visible=!1},$n=Br=>{r.visible&&(Br.preventDefault(),Br.stopPropagation(),r.visible=!1)},Jr=Br=>{Br&&!r.mouseEnter||ae.value||(r.menuVisibleOnFocus?r.menuVisibleOnFocus=!1:(!u.value||!u.value.isFocusInsideContent())&&(r.visible=!r.visible),Qr())},Lr=()=>{r.visible?ie.value[r.hoverIndex]&&mr(ie.value[r.hoverIndex]):Jr()},Kn=Br=>isObject$2(Br.value)?get(Br.value,t.valueKey):Br.value,vo=computed(()=>ie.value.filter(Br=>Br.visible).every(Br=>Br.disabled)),bo=computed(()=>t.multiple?r.selected.slice(0,t.maxCollapseTags):[]),so=computed(()=>t.multiple?r.selected.slice(t.maxCollapseTags):[]),co=Br=>{if(!r.visible){r.visible=!0;return}if(!(r.options.size===0||r.filteredOptionsCount===0)&&!r.isOnComposition&&!vo.value){Br==="next"?(r.hoverIndex++,r.hoverIndex===r.options.size&&(r.hoverIndex=0)):Br==="prev"&&(r.hoverIndex--,r.hoverIndex<0&&(r.hoverIndex=r.options.size-1));const Gr=ie.value[r.hoverIndex];(Gr.disabled===!0||Gr.states.groupDisabled===!0||!Gr.visible)&&co(Br),nextTick(()=>Ir(g.value))}},No=()=>{r.mouseEnter=!0},An=()=>{r.mouseEnter=!1},Aa=(Br,Gr)=>{var Bn,Xn;er(Br,Gr),(Xn=(Bn=d.value)==null?void 0:Bn.updatePopper)==null||Xn.call(Bn)},to=computed(()=>({maxWidth:`${unref(r.inputWidth)-32-(_e.value?22:0)}px`,width:"100%"}));return{optionList:k,optionsArray:ie,hoverOption:g,selectSize:pe,handleResize:nr,debouncedOnInputChange:rr,debouncedQueryChange:or,deletePrevTag:kt,deleteTag:er,deleteSelected:cr,handleOptionSelect:mr,scrollToOption:Ir,readonly:he,resetInputHeight:Lt,showClose:Ne,iconComponent:ue,iconReverse:Y,showNewOption:Ie,collapseTagSize:qe,setSelected:sr,managePlaceholder:dr,selectDisabled:ae,emptyText:ze,toggleLastOptionHitState:Cn,resetInputState:Rr,handleComposition:Or,onOptionCreate:kr,onOptionDestroy:Ar,handleMenuEnter:Pr,handleFocus:Nr,focus:Qr,blur:hn,handleBlur:Ur,handleClearClick:qr,handleClose:Gn,handleKeydownEscape:$n,toggleMenu:Jr,selectOption:Lr,getValueKey:Kn,navigateOptions:co,handleDeleteTooltipTag:Aa,dropMenuVisible:$e,queryChange:b,groupQueryChange:T,showTagList:bo,collapseTagList:so,selectTagsStyle:to,reference:s,input:a,iOSInput:i,tooltipRef:u,tagTooltipRef:d,tags:c,selectWrapper:m,scrollbar:v,handleMouseEnter:No,handleMouseLeave:An}};var ElOptions=defineComponent({name:"ElOptions",emits:["update-options"],setup(t,{slots:r,emit:e}){let n=[];function o(s,a){if(s.length!==a.length)return!1;for(const[i]of s.entries())if(s[i]!=a[i])return!1;return!0}return()=>{var s,a;const i=(s=r.default)==null?void 0:s.call(r),u=[];function d(c){Array.isArray(c)&&c.forEach(m=>{var v,g,b,T;const k=(v=(m==null?void 0:m.type)||{})==null?void 0:v.name;k==="ElOptionGroup"?d(!isString$2(m.children)&&!Array.isArray(m.children)&&isFunction$3((g=m.children)==null?void 0:g.default)?(b=m.children)==null?void 0:b.default():m.children):k==="ElOption"?u.push((T=m.props)==null?void 0:T.label):Array.isArray(m.children)&&d(m.children)})}return i.length&&d((a=i[0])==null?void 0:a.children),o(u,n)||(n=u,e("update-options",u)),i}}});const COMPONENT_NAME$2="ElSelect",_sfc_main$f=defineComponent({name:COMPONENT_NAME$2,componentName:COMPONENT_NAME$2,components:{ElInput,ElSelectMenu,ElOption:Option,ElOptions,ElTag,ElScrollbar,ElTooltip,ElIcon},directives:{ClickOutside},props:{name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:{type:String,validator:isValidComponentSize},effect:{type:String,default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Object,default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:useTooltipContentProps.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:iconPropType,default:circle_close_default},fitInputWidth:Boolean,suffixIcon:{type:iconPropType,default:arrow_down_default},tagType:{...tagProps.type,default:"info"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,suffixTransition:{type:Boolean,default:!0},placement:{type:String,values:Ee,default:"bottom-start"},ariaLabel:{type:String,default:void 0}},emits:[UPDATE_MODEL_EVENT,CHANGE_EVENT,"remove-tag","clear","visible-change","focus","blur"],setup(t,r){const e=useNamespace("select"),n=useNamespace("input"),{t:o}=useLocale(),s=useId(),a=useSelectStates(t),{optionList:i,optionsArray:u,hoverOption:d,selectSize:c,readonly:m,handleResize:v,collapseTagSize:g,debouncedOnInputChange:b,debouncedQueryChange:T,deletePrevTag:k,deleteTag:y,deleteSelected:O,handleOptionSelect:D,scrollToOption:he,setSelected:ae,resetInputHeight:Ne,managePlaceholder:ue,showClose:Y,selectDisabled:_e,iconComponent:Ce,iconReverse:ze,showNewOption:ie,emptyText:le,toggleLastOptionHitState:Ie,resetInputState:pe,handleComposition:qe,onOptionCreate:$e,onOptionDestroy:Lt,handleMenuEnter:Dt,handleFocus:dr,focus:pr,blur:sr,handleBlur:hr,handleClearClick:Fe,handleClose:nr,handleKeydownEscape:ir,toggleMenu:Ue,selectOption:rr,getValueKey:or,navigateOptions:Pt,handleDeleteTooltipTag:Et,dropMenuVisible:kt,reference:er,input:cr,iOSInput:mr,tooltipRef:vr,tagTooltipRef:Tr,tags:Ir,selectWrapper:kr,scrollbar:Ar,queryChange:Rr,groupQueryChange:Cn,handleMouseEnter:Or,handleMouseLeave:Pr,showTagList:Nr,collapseTagList:Qr,selectTagsStyle:hn}=useSelect(t,a,r),{inputWidth:Ur,selected:qr,inputLength:Gn,filteredOptionsCount:$n,visible:Jr,selectedLabel:Lr,hoverIndex:Kn,query:vo,inputHovering:bo,currentPlaceholder:so,menuVisibleOnFocus:co,isOnComposition:No,options:An,cachedOptions:Aa,optionsCount:to,prefixWidth:Br}=toRefs(a),Gr=computed(()=>{const xa=[e.b()],Li=unref(c);return Li&&xa.push(e.m(Li)),t.disabled&&xa.push(e.m("disabled")),xa}),Bn=computed(()=>[e.e("tags"),e.is("disabled",unref(_e))]),Xn=computed(()=>[e.b("tags-wrapper"),{"has-prefix":unref(Br)&&unref(qr).length}]),_o=computed(()=>[e.e("input"),e.is(unref(c)),e.is("disabled",unref(_e))]),oo=computed(()=>[e.e("input"),e.is(unref(c)),e.em("input","iOS")]),Ca=computed(()=>[e.is("empty",!t.allowCreate&&!!unref(vo)&&unref($n)===0)]),is=computed(()=>({maxWidth:`${unref(Ur)>123?unref(Ur)-123:unref(Ur)-75}px`})),cs=computed(()=>({marginLeft:`${unref(Br)}px`,flexGrow:1,width:`${unref(Gn)/(unref(Ur)-32)}%`,maxWidth:`${unref(Ur)-42}px`}));provide(selectKey,reactive({props:t,options:An,optionsArray:u,cachedOptions:Aa,optionsCount:to,filteredOptionsCount:$n,hoverIndex:Kn,handleOptionSelect:D,onOptionCreate:$e,onOptionDestroy:Lt,selectWrapper:kr,selected:qr,setSelected:ae,queryChange:Rr,groupQueryChange:Cn})),onMounted(()=>{a.cachedPlaceHolder=so.value=t.placeholder||(()=>o("el.select.placeholder")),t.multiple&&Array.isArray(t.modelValue)&&t.modelValue.length>0&&(so.value=""),useResizeObserver(kr,v),t.remote&&t.multiple&&Ne(),nextTick(()=>{const xa=er.value&&er.value.$el;if(xa&&(Ur.value=xa.getBoundingClientRect().width,r.slots.prefix)){const Li=xa.querySelector(`.${n.e("prefix")}`);Br.value=Math.max(Li.getBoundingClientRect().width+11,30)}}),ae()}),t.multiple&&!Array.isArray(t.modelValue)&&r.emit(UPDATE_MODEL_EVENT,[]),!t.multiple&&Array.isArray(t.modelValue)&&r.emit(UPDATE_MODEL_EVENT,"");const Es=computed(()=>{var xa,Li;return(Li=(xa=vr.value)==null?void 0:xa.popperRef)==null?void 0:Li.contentRef});return{isIOS,onOptionsRendered:xa=>{i.value=xa},prefixWidth:Br,selectSize:c,readonly:m,handleResize:v,collapseTagSize:g,debouncedOnInputChange:b,debouncedQueryChange:T,deletePrevTag:k,deleteTag:y,handleDeleteTooltipTag:Et,deleteSelected:O,handleOptionSelect:D,scrollToOption:he,inputWidth:Ur,selected:qr,inputLength:Gn,filteredOptionsCount:$n,visible:Jr,selectedLabel:Lr,hoverIndex:Kn,query:vo,inputHovering:bo,currentPlaceholder:so,menuVisibleOnFocus:co,isOnComposition:No,options:An,resetInputHeight:Ne,managePlaceholder:ue,showClose:Y,selectDisabled:_e,iconComponent:Ce,iconReverse:ze,showNewOption:ie,emptyText:le,toggleLastOptionHitState:Ie,resetInputState:pe,handleComposition:qe,handleMenuEnter:Dt,handleFocus:dr,focus:pr,blur:sr,handleBlur:hr,handleClearClick:Fe,handleClose:nr,handleKeydownEscape:ir,toggleMenu:Ue,selectOption:rr,getValueKey:or,navigateOptions:Pt,dropMenuVisible:kt,reference:er,input:cr,iOSInput:mr,tooltipRef:vr,popperPaneRef:Es,tags:Ir,selectWrapper:kr,scrollbar:Ar,wrapperKls:Gr,tagsKls:Bn,tagWrapperKls:Xn,inputKls:_o,iOSInputKls:oo,scrollbarKls:Ca,selectTagsStyle:hn,nsSelect:e,tagTextStyle:is,inputStyle:cs,handleMouseEnter:Or,handleMouseLeave:Pr,showTagList:Nr,collapseTagList:Qr,tagTooltipRef:Tr,contentId:s,hoverOption:d}}}),_hoisted_1$b=["disabled","autocomplete","aria-activedescendant","aria-controls","aria-expanded","aria-label"],_hoisted_2$a=["disabled"],_hoisted_3$7={style:{height:"100%",display:"flex","justify-content":"center","align-items":"center"}};function _sfc_render$2(t,r,e,n,o,s){const a=resolveComponent("el-tag"),i=resolveComponent("el-tooltip"),u=resolveComponent("el-icon"),d=resolveComponent("el-input"),c=resolveComponent("el-option"),m=resolveComponent("el-options"),v=resolveComponent("el-scrollbar"),g=resolveComponent("el-select-menu"),b=resolveDirective("click-outside");return withDirectives((openBlock(),createElementBlock("div",{ref:"selectWrapper",class:normalizeClass(t.wrapperKls),onMouseenter:r[22]||(r[22]=(...T)=>t.handleMouseEnter&&t.handleMouseEnter(...T)),onMouseleave:r[23]||(r[23]=(...T)=>t.handleMouseLeave&&t.handleMouseLeave(...T)),onClick:r[24]||(r[24]=withModifiers((...T)=>t.toggleMenu&&t.toggleMenu(...T),["stop"]))},[createVNode(i,{ref:"tooltipRef",visible:t.dropMenuVisible,placement:t.placement,teleported:t.teleported,"popper-class":[t.nsSelect.e("popper"),t.popperClass],"popper-options":t.popperOptions,"fallback-placements":["bottom-start","top-start","right","left"],effect:t.effect,pure:"",trigger:"click",transition:`${t.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:t.persistent,onShow:t.handleMenuEnter},{default:withCtx(()=>{var T,k;return[createBaseVNode("div",{class:"select-trigger",onMouseenter:r[20]||(r[20]=y=>t.inputHovering=!0),onMouseleave:r[21]||(r[21]=y=>t.inputHovering=!1)},[t.multiple?(openBlock(),createElementBlock("div",{key:0,ref:"tags",tabindex:"-1",class:normalizeClass(t.tagsKls),style:normalizeStyle(t.selectTagsStyle),onClick:r[15]||(r[15]=(...y)=>t.focus&&t.focus(...y))},[t.collapseTags&&t.selected.length?(openBlock(),createBlock(Transition,{key:0,onAfterLeave:t.resetInputHeight},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(t.tagWrapperKls)},[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.showTagList,y=>(openBlock(),createBlock(a,{key:t.getValueKey(y),closable:!t.selectDisabled&&!y.isDisabled,size:t.collapseTagSize,hit:y.hitState,type:t.tagType,"disable-transitions":"",onClose:O=>t.deleteTag(O,y)},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(t.nsSelect.e("tags-text")),style:normalizeStyle(t.tagTextStyle)},toDisplayString(y.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))),128)),t.selected.length>t.maxCollapseTags?(openBlock(),createBlock(a,{key:0,closable:!1,size:t.collapseTagSize,type:t.tagType,"disable-transitions":""},{default:withCtx(()=>[t.collapseTagsTooltip?(openBlock(),createBlock(i,{key:0,ref:"tagTooltipRef",disabled:t.dropMenuVisible,"fallback-placements":["bottom","top","right","left"],effect:t.effect,placement:"bottom",teleported:t.teleported},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(t.nsSelect.e("tags-text"))},"+ "+toDisplayString(t.selected.length-t.maxCollapseTags),3)]),content:withCtx(()=>[createBaseVNode("div",{class:normalizeClass(t.nsSelect.e("collapse-tags"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.collapseTagList,y=>(openBlock(),createElementBlock("div",{key:t.getValueKey(y),class:normalizeClass(t.nsSelect.e("collapse-tag"))},[createVNode(a,{class:"in-tooltip",closable:!t.selectDisabled&&!y.isDisabled,size:t.collapseTagSize,hit:y.hitState,type:t.tagType,"disable-transitions":"",style:{margin:"2px"},onClose:O=>t.handleDeleteTooltipTag(O,y)},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(t.nsSelect.e("tags-text")),style:normalizeStyle({maxWidth:t.inputWidth-75+"px"})},toDisplayString(y.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"])],2))),128))],2)]),_:1},8,["disabled","effect","teleported"])):(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(t.nsSelect.e("tags-text"))},"+ "+toDisplayString(t.selected.length-t.maxCollapseTags),3))]),_:1},8,["size","type"])):createCommentVNode("v-if",!0)],2)]),_:1},8,["onAfterLeave"])):createCommentVNode("v-if",!0),t.collapseTags?createCommentVNode("v-if",!0):(openBlock(),createBlock(Transition,{key:1,onAfterLeave:t.resetInputHeight},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(t.tagWrapperKls),style:normalizeStyle(t.prefixWidth&&t.selected.length?{marginLeft:`${t.prefixWidth}px`}:"")},[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.selected,y=>(openBlock(),createBlock(a,{key:t.getValueKey(y),closable:!t.selectDisabled&&!y.isDisabled,size:t.collapseTagSize,hit:y.hitState,type:t.tagType,"disable-transitions":"",onClose:O=>t.deleteTag(O,y)},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(t.nsSelect.e("tags-text")),style:normalizeStyle({maxWidth:t.inputWidth-75+"px"})},toDisplayString(y.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))),128))],6)]),_:1},8,["onAfterLeave"])),t.filterable&&!t.selectDisabled?withDirectives((openBlock(),createElementBlock("input",{key:2,ref:"input","onUpdate:modelValue":r[0]||(r[0]=y=>t.query=y),type:"text",class:normalizeClass(t.inputKls),disabled:t.selectDisabled,autocomplete:t.autocomplete,style:normalizeStyle(t.inputStyle),role:"combobox","aria-activedescendant":((T=t.hoverOption)==null?void 0:T.id)||"","aria-controls":t.contentId,"aria-expanded":t.dropMenuVisible,"aria-label":t.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onFocus:r[1]||(r[1]=(...y)=>t.handleFocus&&t.handleFocus(...y)),onBlur:r[2]||(r[2]=(...y)=>t.handleBlur&&t.handleBlur(...y)),onKeyup:r[3]||(r[3]=(...y)=>t.managePlaceholder&&t.managePlaceholder(...y)),onKeydown:[r[4]||(r[4]=(...y)=>t.resetInputState&&t.resetInputState(...y)),r[5]||(r[5]=withKeys(withModifiers(y=>t.navigateOptions("next"),["prevent"]),["down"])),r[6]||(r[6]=withKeys(withModifiers(y=>t.navigateOptions("prev"),["prevent"]),["up"])),r[7]||(r[7]=withKeys((...y)=>t.handleKeydownEscape&&t.handleKeydownEscape(...y),["esc"])),r[8]||(r[8]=withKeys(withModifiers((...y)=>t.selectOption&&t.selectOption(...y),["stop","prevent"]),["enter"])),r[9]||(r[9]=withKeys((...y)=>t.deletePrevTag&&t.deletePrevTag(...y),["delete"])),r[10]||(r[10]=withKeys(y=>t.visible=!1,["tab"]))],onCompositionstart:r[11]||(r[11]=(...y)=>t.handleComposition&&t.handleComposition(...y)),onCompositionupdate:r[12]||(r[12]=(...y)=>t.handleComposition&&t.handleComposition(...y)),onCompositionend:r[13]||(r[13]=(...y)=>t.handleComposition&&t.handleComposition(...y)),onInput:r[14]||(r[14]=(...y)=>t.debouncedQueryChange&&t.debouncedQueryChange(...y))},null,46,_hoisted_1$b)),[[vModelText,t.query]]):createCommentVNode("v-if",!0)],6)):createCommentVNode("v-if",!0),t.isIOS&&!t.multiple&&t.filterable&&t.readonly?(openBlock(),createElementBlock("input",{key:1,ref:"iOSInput",class:normalizeClass(t.iOSInputKls),disabled:t.selectDisabled,type:"text"},null,10,_hoisted_2$a)):createCommentVNode("v-if",!0),createVNode(d,{id:t.id,ref:"reference",modelValue:t.selectedLabel,"onUpdate:modelValue":r[16]||(r[16]=y=>t.selectedLabel=y),type:"text",placeholder:typeof t.currentPlaceholder=="function"?t.currentPlaceholder():t.currentPlaceholder,name:t.name,autocomplete:t.autocomplete,size:t.selectSize,disabled:t.selectDisabled,readonly:t.readonly,"validate-event":!1,class:normalizeClass([t.nsSelect.is("focus",t.visible)]),tabindex:t.multiple&&t.filterable?-1:void 0,role:"combobox","aria-activedescendant":((k=t.hoverOption)==null?void 0:k.id)||"","aria-controls":t.contentId,"aria-expanded":t.dropMenuVisible,label:t.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onFocus:t.handleFocus,onBlur:t.handleBlur,onInput:t.debouncedOnInputChange,onPaste:t.debouncedOnInputChange,onCompositionstart:t.handleComposition,onCompositionupdate:t.handleComposition,onCompositionend:t.handleComposition,onKeydown:[r[17]||(r[17]=withKeys(withModifiers(y=>t.navigateOptions("next"),["stop","prevent"]),["down"])),r[18]||(r[18]=withKeys(withModifiers(y=>t.navigateOptions("prev"),["stop","prevent"]),["up"])),withKeys(withModifiers(t.selectOption,["stop","prevent"]),["enter"]),withKeys(t.handleKeydownEscape,["esc"]),r[19]||(r[19]=withKeys(y=>t.visible=!1,["tab"]))]},createSlots({suffix:withCtx(()=>[t.iconComponent&&!t.showClose?(openBlock(),createBlock(u,{key:0,class:normalizeClass([t.nsSelect.e("caret"),t.nsSelect.e("icon"),t.iconReverse])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.iconComponent)))]),_:1},8,["class"])):createCommentVNode("v-if",!0),t.showClose&&t.clearIcon?(openBlock(),createBlock(u,{key:1,class:normalizeClass([t.nsSelect.e("caret"),t.nsSelect.e("icon")]),onClick:t.handleClearClick},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.clearIcon)))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0)]),_:2},[t.$slots.prefix?{name:"prefix",fn:withCtx(()=>[createBaseVNode("div",_hoisted_3$7,[renderSlot(t.$slots,"prefix")])])}:void 0]),1032,["id","modelValue","placeholder","name","autocomplete","size","disabled","readonly","class","tabindex","aria-activedescendant","aria-controls","aria-expanded","label","onFocus","onBlur","onInput","onPaste","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown"])],32)]}),content:withCtx(()=>[createVNode(g,null,{default:withCtx(()=>[withDirectives(createVNode(v,{id:t.contentId,ref:"scrollbar",tag:"ul","wrap-class":t.nsSelect.be("dropdown","wrap"),"view-class":t.nsSelect.be("dropdown","list"),class:normalizeClass(t.scrollbarKls),role:"listbox","aria-label":t.ariaLabel,"aria-orientation":"vertical"},{default:withCtx(()=>[t.showNewOption?(openBlock(),createBlock(c,{key:0,value:t.query,created:!0},null,8,["value"])):createCommentVNode("v-if",!0),createVNode(m,{onUpdateOptions:t.onOptionsRendered},{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},8,["onUpdateOptions"])]),_:3},8,["id","wrap-class","view-class","class","aria-label"]),[[vShow,t.options.size>0&&!t.loading]]),t.emptyText&&(!t.allowCreate||t.loading||t.allowCreate&&t.options.size===0)?(openBlock(),createElementBlock(Fragment,{key:0},[t.$slots.empty?renderSlot(t.$slots,"empty",{key:0}):(openBlock(),createElementBlock("p",{key:1,class:normalizeClass(t.nsSelect.be("dropdown","empty"))},toDisplayString(t.emptyText),3))],64)):createCommentVNode("v-if",!0)]),_:3})]),_:3},8,["visible","placement","teleported","popper-class","popper-options","effect","transition","persistent","onShow"])],34)),[[b,t.handleClose,t.popperPaneRef]])}var Select=_export_sfc(_sfc_main$f,[["render",_sfc_render$2],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select.vue"]]);const _sfc_main$e=defineComponent({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(t){const r=useNamespace("select"),e=ref(!0),n=getCurrentInstance(),o=ref([]);provide(selectGroupKey,reactive({...toRefs(t)}));const s=inject(selectKey);onMounted(()=>{o.value=a(n.subTree)});const a=u=>{const d=[];return Array.isArray(u.children)&&u.children.forEach(c=>{var m;c.type&&c.type.name==="ElOption"&&c.component&&c.component.proxy?d.push(c.component.proxy):(m=c.children)!=null&&m.length&&d.push(...a(c))}),d},{groupQueryChange:i}=toRaw(s);return watch(i,()=>{e.value=o.value.some(u=>u.visible===!0)},{flush:"post"}),{visible:e,ns:r}}});function _sfc_render$1(t,r,e,n,o,s){return withDirectives((openBlock(),createElementBlock("ul",{class:normalizeClass(t.ns.be("group","wrap"))},[createBaseVNode("li",{class:normalizeClass(t.ns.be("group","title"))},toDisplayString(t.label),3),createBaseVNode("li",null,[createBaseVNode("ul",{class:normalizeClass(t.ns.b("group"))},[renderSlot(t.$slots,"default")],2)])],2)),[[vShow,t.visible]])}var OptionGroup=_export_sfc(_sfc_main$e,[["render",_sfc_render$1],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option-group.vue"]]);const ElSelect=withInstall(Select,{Option,OptionGroup}),ElOption=withNoopInstall(Option);withNoopInstall(OptionGroup);const progressProps=buildProps({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:t=>t>=0&&t<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:definePropType(String),default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:definePropType([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:definePropType(Function),default:t=>`${t}%`}}),_hoisted_1$a=["aria-valuenow"],_hoisted_2$9={viewBox:"0 0 100 100"},_hoisted_3$6=["d","stroke","stroke-linecap","stroke-width"],_hoisted_4$5=["d","stroke","opacity","stroke-linecap","stroke-width"],_hoisted_5$5={key:0},__default__$8=defineComponent({name:"ElProgress"}),_sfc_main$d=defineComponent({...__default__$8,props:progressProps,setup(t){const r=t,e={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},n=useNamespace("progress"),o=computed(()=>({width:`${r.percentage}%`,animationDuration:`${r.duration}s`,backgroundColor:O(r.percentage)})),s=computed(()=>(r.strokeWidth/r.width*100).toFixed(1)),a=computed(()=>["circle","dashboard"].includes(r.type)?Number.parseInt(`${50-Number.parseFloat(s.value)/2}`,10):0),i=computed(()=>{const D=a.value,he=r.type==="dashboard";return`
          M 50 50
          m 0 ${he?"":"-"}${D}
          a ${D} ${D} 0 1 1 0 ${he?"-":""}${D*2}
          a ${D} ${D} 0 1 1 0 ${he?"":"-"}${D*2}
          `}),u=computed(()=>2*Math.PI*a.value),d=computed(()=>r.type==="dashboard"?.75:1),c=computed(()=>`${-1*u.value*(1-d.value)/2}px`),m=computed(()=>({strokeDasharray:`${u.value*d.value}px, ${u.value}px`,strokeDashoffset:c.value})),v=computed(()=>({strokeDasharray:`${u.value*d.value*(r.percentage/100)}px, ${u.value}px`,strokeDashoffset:c.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),g=computed(()=>{let D;return r.color?D=O(r.percentage):D=e[r.status]||e.default,D}),b=computed(()=>r.status==="warning"?warning_filled_default:r.type==="line"?r.status==="success"?circle_check_default:circle_close_default:r.status==="success"?check_default:close_default),T=computed(()=>r.type==="line"?12+r.strokeWidth*.4:r.width*.111111+2),k=computed(()=>r.format(r.percentage));function y(D){const he=100/D.length;return D.map((Ne,ue)=>isString$2(Ne)?{color:Ne,percentage:(ue+1)*he}:Ne).sort((Ne,ue)=>Ne.percentage-ue.percentage)}const O=D=>{var he;const{color:ae}=r;if(isFunction$3(ae))return ae(D);if(isString$2(ae))return ae;{const Ne=y(ae);for(const ue of Ne)if(ue.percentage>D)return ue.color;return(he=Ne[Ne.length-1])==null?void 0:he.color}};return(D,he)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(n).b(),unref(n).m(D.type),unref(n).is(D.status),{[unref(n).m("without-text")]:!D.showText,[unref(n).m("text-inside")]:D.textInside}]),role:"progressbar","aria-valuenow":D.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[D.type==="line"?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(n).b("bar"))},[createBaseVNode("div",{class:normalizeClass(unref(n).be("bar","outer")),style:normalizeStyle({height:`${D.strokeWidth}px`})},[createBaseVNode("div",{class:normalizeClass([unref(n).be("bar","inner"),{[unref(n).bem("bar","inner","indeterminate")]:D.indeterminate},{[unref(n).bem("bar","inner","striped")]:D.striped},{[unref(n).bem("bar","inner","striped-flow")]:D.stripedFlow}]),style:normalizeStyle(unref(o))},[(D.showText||D.$slots.default)&&D.textInside?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(n).be("bar","innerText"))},[renderSlot(D.$slots,"default",{percentage:D.percentage},()=>[createBaseVNode("span",null,toDisplayString(unref(k)),1)])],2)):createCommentVNode("v-if",!0)],6)],6)],2)):(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(n).b("circle")),style:normalizeStyle({height:`${D.width}px`,width:`${D.width}px`})},[(openBlock(),createElementBlock("svg",_hoisted_2$9,[createBaseVNode("path",{class:normalizeClass(unref(n).be("circle","track")),d:unref(i),stroke:`var(${unref(n).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":D.strokeLinecap,"stroke-width":unref(s),fill:"none",style:normalizeStyle(unref(m))},null,14,_hoisted_3$6),createBaseVNode("path",{class:normalizeClass(unref(n).be("circle","path")),d:unref(i),stroke:unref(g),fill:"none",opacity:D.percentage?1:0,"stroke-linecap":D.strokeLinecap,"stroke-width":unref(s),style:normalizeStyle(unref(v))},null,14,_hoisted_4$5)]))],6)),(D.showText||D.$slots.default)&&!D.textInside?(openBlock(),createElementBlock("div",{key:2,class:normalizeClass(unref(n).e("text")),style:normalizeStyle({fontSize:`${unref(T)}px`})},[renderSlot(D.$slots,"default",{percentage:D.percentage},()=>[D.status?(openBlock(),createBlock(unref(ElIcon),{key:1},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(b))))]),_:1})):(openBlock(),createElementBlock("span",_hoisted_5$5,toDisplayString(unref(k)),1))])],6)):createCommentVNode("v-if",!0)],10,_hoisted_1$a))}});var Progress=_export_sfc(_sfc_main$d,[["__file","/home/runner/work/element-plus/element-plus/packages/components/progress/src/progress.vue"]]);const ElProgress=withInstall(Progress),switchProps=buildProps({modelValue:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},size:{type:String,validator:isValidComponentSize},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},inactiveActionIcon:{type:iconPropType},activeActionIcon:{type:iconPropType},activeIcon:{type:iconPropType},inactiveIcon:{type:iconPropType},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},borderColor:{type:String,default:""},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:definePropType(Function)},id:String,tabindex:{type:[String,Number]},value:{type:[Boolean,String,Number],default:!1},label:{type:String,default:void 0}}),switchEmits={[UPDATE_MODEL_EVENT]:t=>isBoolean$1(t)||isString$2(t)||isNumber$1(t),[CHANGE_EVENT]:t=>isBoolean$1(t)||isString$2(t)||isNumber$1(t),[INPUT_EVENT]:t=>isBoolean$1(t)||isString$2(t)||isNumber$1(t)},_hoisted_1$9=["onClick"],_hoisted_2$8=["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"],_hoisted_3$5=["aria-hidden"],_hoisted_4$4=["aria-hidden"],_hoisted_5$4=["aria-hidden"],COMPONENT_NAME$1="ElSwitch",__default__$7=defineComponent({name:COMPONENT_NAME$1}),_sfc_main$c=defineComponent({...__default__$7,props:switchProps,emits:switchEmits,setup(t,{expose:r,emit:e}){const n=t,o=getCurrentInstance(),{formItem:s}=useFormItem(),a=useFormSize(),i=useNamespace("switch");(Y=>{Y.forEach(_e=>{useDeprecated({from:_e[0],replacement:_e[1],scope:COMPONENT_NAME$1,version:"2.3.0",ref:"https://element-plus.org/en-US/component/switch.html#attributes",type:"Attribute"},computed(()=>{var Ce;return!!((Ce=o.vnode.props)!=null&&Ce[_e[2]])}))})})([['"value"','"model-value" or "v-model"',"value"],['"active-color"',"CSS var `--el-switch-on-color`","activeColor"],['"inactive-color"',"CSS var `--el-switch-off-color`","inactiveColor"],['"border-color"',"CSS var `--el-switch-border-color`","borderColor"]]);const{inputId:d}=useFormItemInputId(n,{formItemContext:s}),c=useFormDisabled(computed(()=>n.loading)),m=ref(n.modelValue!==!1),v=ref(),g=ref(),b=computed(()=>[i.b(),i.m(a.value),i.is("disabled",c.value),i.is("checked",D.value)]),T=computed(()=>[i.e("label"),i.em("label","left"),i.is("active",!D.value)]),k=computed(()=>[i.e("label"),i.em("label","right"),i.is("active",D.value)]),y=computed(()=>({width:addUnit(n.width)}));watch(()=>n.modelValue,()=>{m.value=!0}),watch(()=>n.value,()=>{m.value=!1});const O=computed(()=>m.value?n.modelValue:n.value),D=computed(()=>O.value===n.activeValue);[n.activeValue,n.inactiveValue].includes(O.value)||(e(UPDATE_MODEL_EVENT,n.inactiveValue),e(CHANGE_EVENT,n.inactiveValue),e(INPUT_EVENT,n.inactiveValue)),watch(D,Y=>{var _e;v.value.checked=Y,n.validateEvent&&((_e=s==null?void 0:s.validate)==null||_e.call(s,"change").catch(Ce=>void 0))});const he=()=>{const Y=D.value?n.inactiveValue:n.activeValue;e(UPDATE_MODEL_EVENT,Y),e(CHANGE_EVENT,Y),e(INPUT_EVENT,Y),nextTick(()=>{v.value.checked=D.value})},ae=()=>{if(c.value)return;const{beforeChange:Y}=n;if(!Y){he();return}const _e=Y();[isPromise(_e),isBoolean$1(_e)].includes(!0)||throwError(COMPONENT_NAME$1,"beforeChange must return type `Promise<boolean>` or `boolean`"),isPromise(_e)?_e.then(ze=>{ze&&he()}).catch(ze=>{}):_e&&he()},Ne=computed(()=>i.cssVarBlock({...n.activeColor?{"on-color":n.activeColor}:null,...n.inactiveColor?{"off-color":n.inactiveColor}:null,...n.borderColor?{"border-color":n.borderColor}:null})),ue=()=>{var Y,_e;(_e=(Y=v.value)==null?void 0:Y.focus)==null||_e.call(Y)};return onMounted(()=>{v.value.checked=D.value}),r({focus:ue,checked:D}),(Y,_e)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(b)),style:normalizeStyle(unref(Ne)),onClick:withModifiers(ae,["prevent"])},[createBaseVNode("input",{id:unref(d),ref_key:"input",ref:v,class:normalizeClass(unref(i).e("input")),type:"checkbox",role:"switch","aria-checked":unref(D),"aria-disabled":unref(c),"aria-label":Y.label,name:Y.name,"true-value":Y.activeValue,"false-value":Y.inactiveValue,disabled:unref(c),tabindex:Y.tabindex,onChange:he,onKeydown:withKeys(ae,["enter"])},null,42,_hoisted_2$8),!Y.inlinePrompt&&(Y.inactiveIcon||Y.inactiveText)?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(T))},[Y.inactiveIcon?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Y.inactiveIcon)))]),_:1})):createCommentVNode("v-if",!0),!Y.inactiveIcon&&Y.inactiveText?(openBlock(),createElementBlock("span",{key:1,"aria-hidden":unref(D)},toDisplayString(Y.inactiveText),9,_hoisted_3$5)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("span",{ref_key:"core",ref:g,class:normalizeClass(unref(i).e("core")),style:normalizeStyle(unref(y))},[Y.inlinePrompt?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(i).e("inner"))},[Y.activeIcon||Y.inactiveIcon?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(i).is("icon"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(D)?Y.activeIcon:Y.inactiveIcon)))]),_:1},8,["class"])):Y.activeText||Y.inactiveText?(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(unref(i).is("text")),"aria-hidden":!unref(D)},toDisplayString(unref(D)?Y.activeText:Y.inactiveText),11,_hoisted_4$4)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{class:normalizeClass(unref(i).e("action"))},[Y.loading?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(i).is("loading"))},{default:withCtx(()=>[createVNode(unref(loading_default))]),_:1},8,["class"])):Y.activeActionIcon&&unref(D)?(openBlock(),createBlock(unref(ElIcon),{key:1},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Y.activeActionIcon)))]),_:1})):Y.inactiveActionIcon&&!unref(D)?(openBlock(),createBlock(unref(ElIcon),{key:2},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Y.inactiveActionIcon)))]),_:1})):createCommentVNode("v-if",!0)],2)],6),!Y.inlinePrompt&&(Y.activeIcon||Y.activeText)?(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(unref(k))},[Y.activeIcon?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Y.activeIcon)))]),_:1})):createCommentVNode("v-if",!0),!Y.activeIcon&&Y.activeText?(openBlock(),createElementBlock("span",{key:1,"aria-hidden":!unref(D)},toDisplayString(Y.activeText),9,_hoisted_5$4)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0)],14,_hoisted_1$9))}});var Switch=_export_sfc(_sfc_main$c,[["__file","/home/runner/work/element-plus/element-plus/packages/components/switch/src/switch.vue"]]);const ElSwitch=withInstall(Switch),LEFT_CHECK_CHANGE_EVENT="left-check-change",RIGHT_CHECK_CHANGE_EVENT="right-check-change",transferProps=buildProps({data:{type:definePropType(Array),default:()=>[]},titles:{type:definePropType(Array),default:()=>[]},buttonTexts:{type:definePropType(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:definePropType(Function)},leftDefaultChecked:{type:definePropType(Array),default:()=>[]},rightDefaultChecked:{type:definePropType(Array),default:()=>[]},renderContent:{type:definePropType(Function)},modelValue:{type:definePropType(Array),default:()=>[]},format:{type:definePropType(Object),default:()=>({})},filterable:Boolean,props:{type:definePropType(Object),default:()=>mutable({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),transferCheckedChangeFn=(t,r)=>[t,r].every(isArray$4)||isArray$4(t)&&isNil(r),transferEmits={[CHANGE_EVENT]:(t,r,e)=>[t,e].every(isArray$4)&&["left","right"].includes(r),[UPDATE_MODEL_EVENT]:t=>isArray$4(t),[LEFT_CHECK_CHANGE_EVENT]:transferCheckedChangeFn,[RIGHT_CHECK_CHANGE_EVENT]:transferCheckedChangeFn},CHECKED_CHANGE_EVENT="checked-change",transferPanelProps=buildProps({data:transferProps.data,optionRender:{type:definePropType(Function)},placeholder:String,title:String,filterable:Boolean,format:transferProps.format,filterMethod:transferProps.filterMethod,defaultChecked:transferProps.leftDefaultChecked,props:transferProps.props}),transferPanelEmits={[CHECKED_CHANGE_EVENT]:transferCheckedChangeFn},usePropsAlias=t=>{const r={label:"label",key:"key",disabled:"disabled"};return computed(()=>({...r,...t.props}))},useCheck=(t,r,e)=>{const n=usePropsAlias(t),o=computed(()=>t.data.filter(c=>isFunction$3(t.filterMethod)?t.filterMethod(r.query,c):String(c[n.value.label]||c[n.value.key]).toLowerCase().includes(r.query.toLowerCase()))),s=computed(()=>o.value.filter(c=>!c[n.value.disabled])),a=computed(()=>{const c=r.checked.length,m=t.data.length,{noChecked:v,hasChecked:g}=t.format;return v&&g?c>0?g.replace(/\${checked}/g,c.toString()).replace(/\${total}/g,m.toString()):v.replace(/\${total}/g,m.toString()):`${c}/${m}`}),i=computed(()=>{const c=r.checked.length;return c>0&&c<s.value.length}),u=()=>{const c=s.value.map(m=>m[n.value.key]);r.allChecked=c.length>0&&c.every(m=>r.checked.includes(m))},d=c=>{r.checked=c?s.value.map(m=>m[n.value.key]):[]};return watch(()=>r.checked,(c,m)=>{if(u(),r.checkChangeByUser){const v=c.concat(m).filter(g=>!c.includes(g)||!m.includes(g));e(CHECKED_CHANGE_EVENT,c,v)}else e(CHECKED_CHANGE_EVENT,c),r.checkChangeByUser=!0}),watch(s,()=>{u()}),watch(()=>t.data,()=>{const c=[],m=o.value.map(v=>v[n.value.key]);r.checked.forEach(v=>{m.includes(v)&&c.push(v)}),r.checkChangeByUser=!1,r.checked=c}),watch(()=>t.defaultChecked,(c,m)=>{if(m&&c.length===m.length&&c.every(b=>m.includes(b)))return;const v=[],g=s.value.map(b=>b[n.value.key]);c.forEach(b=>{g.includes(b)&&v.push(b)}),r.checkChangeByUser=!1,r.checked=v},{immediate:!0}),{filteredData:o,checkableData:s,checkedSummary:a,isIndeterminate:i,updateAllChecked:u,handleAllCheckedChange:d}},useCheckedChange=(t,r)=>({onSourceCheckedChange:(o,s)=>{t.leftChecked=o,s&&r(LEFT_CHECK_CHANGE_EVENT,o,s)},onTargetCheckedChange:(o,s)=>{t.rightChecked=o,s&&r(RIGHT_CHECK_CHANGE_EVENT,o,s)}}),useComputedData=t=>{const r=usePropsAlias(t),e=computed(()=>t.data.reduce((s,a)=>(s[a[r.value.key]]=a)&&s,{})),n=computed(()=>t.data.filter(s=>!t.modelValue.includes(s[r.value.key]))),o=computed(()=>t.targetOrder==="original"?t.data.filter(s=>t.modelValue.includes(s[r.value.key])):t.modelValue.reduce((s,a)=>{const i=e.value[a];return i&&s.push(i),s},[]));return{sourceData:n,targetData:o}},useMove=(t,r,e)=>{const n=usePropsAlias(t),o=(i,u,d)=>{e(UPDATE_MODEL_EVENT,i),e(CHANGE_EVENT,i,u,d)};return{addToLeft:()=>{const i=t.modelValue.slice();r.rightChecked.forEach(u=>{const d=i.indexOf(u);d>-1&&i.splice(d,1)}),o(i,"left",r.rightChecked)},addToRight:()=>{let i=t.modelValue.slice();const u=t.data.filter(d=>{const c=d[n.value.key];return r.leftChecked.includes(c)&&!t.modelValue.includes(c)}).map(d=>d[n.value.key]);i=t.targetOrder==="unshift"?u.concat(i):i.concat(u),t.targetOrder==="original"&&(i=t.data.filter(d=>i.includes(d[n.value.key])).map(d=>d[n.value.key])),o(i,"right",r.leftChecked)}}},__default__$6=defineComponent({name:"ElTransferPanel"}),_sfc_main$b=defineComponent({...__default__$6,props:transferPanelProps,emits:transferPanelEmits,setup(t,{expose:r,emit:e}){const n=t,o=useSlots(),s=({option:D})=>D,{t:a}=useLocale(),i=useNamespace("transfer"),u=reactive({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),d=usePropsAlias(n),{filteredData:c,checkedSummary:m,isIndeterminate:v,handleAllCheckedChange:g}=useCheck(n,u,e),b=computed(()=>!isEmpty(u.query)&&isEmpty(c.value)),T=computed(()=>!isEmpty(o.default()[0].children)),{checked:k,allChecked:y,query:O}=toRefs(u);return r({query:O}),(D,he)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(i).b("panel"))},[createBaseVNode("p",{class:normalizeClass(unref(i).be("panel","header"))},[createVNode(unref(ElCheckbox),{modelValue:unref(y),"onUpdate:modelValue":he[0]||(he[0]=ae=>isRef(y)?y.value=ae:null),indeterminate:unref(v),"validate-event":!1,onChange:unref(g)},{default:withCtx(()=>[createTextVNode(toDisplayString(D.title)+" ",1),createBaseVNode("span",null,toDisplayString(unref(m)),1)]),_:1},8,["modelValue","indeterminate","onChange"])],2),createBaseVNode("div",{class:normalizeClass([unref(i).be("panel","body"),unref(i).is("with-footer",unref(T))])},[D.filterable?(openBlock(),createBlock(unref(ElInput),{key:0,modelValue:unref(O),"onUpdate:modelValue":he[1]||(he[1]=ae=>isRef(O)?O.value=ae:null),class:normalizeClass(unref(i).be("panel","filter")),size:"default",placeholder:D.placeholder,"prefix-icon":unref(search_default),clearable:"","validate-event":!1},null,8,["modelValue","class","placeholder","prefix-icon"])):createCommentVNode("v-if",!0),withDirectives(createVNode(unref(ElCheckboxGroup),{modelValue:unref(k),"onUpdate:modelValue":he[2]||(he[2]=ae=>isRef(k)?k.value=ae:null),"validate-event":!1,class:normalizeClass([unref(i).is("filterable",D.filterable),unref(i).be("panel","list")])},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(c),ae=>(openBlock(),createBlock(unref(ElCheckbox),{key:ae[unref(d).key],class:normalizeClass(unref(i).be("panel","item")),label:ae[unref(d).key],disabled:ae[unref(d).disabled],"validate-event":!1},{default:withCtx(()=>{var Ne;return[createVNode(s,{option:(Ne=D.optionRender)==null?void 0:Ne.call(D,ae)},null,8,["option"])]}),_:2},1032,["class","label","disabled"]))),128))]),_:1},8,["modelValue","class"]),[[vShow,!unref(b)&&!unref(isEmpty)(D.data)]]),withDirectives(createBaseVNode("p",{class:normalizeClass(unref(i).be("panel","empty"))},toDisplayString(unref(b)?unref(a)("el.transfer.noMatch"):unref(a)("el.transfer.noData")),3),[[vShow,unref(b)||unref(isEmpty)(D.data)]])],2),unref(T)?(openBlock(),createElementBlock("p",{key:0,class:normalizeClass(unref(i).be("panel","footer"))},[renderSlot(D.$slots,"default")],2)):createCommentVNode("v-if",!0)],2))}});var TransferPanel=_export_sfc(_sfc_main$b,[["__file","/home/runner/work/element-plus/element-plus/packages/components/transfer/src/transfer-panel.vue"]]);const _hoisted_1$8={key:0},_hoisted_2$7={key:0},__default__$5=defineComponent({name:"ElTransfer"}),_sfc_main$a=defineComponent({...__default__$5,props:transferProps,emits:transferEmits,setup(t,{expose:r,emit:e}){const n=t,o=useSlots(),{t:s}=useLocale(),a=useNamespace("transfer"),{formItem:i}=useFormItem(),u=reactive({leftChecked:[],rightChecked:[]}),d=usePropsAlias(n),{sourceData:c,targetData:m}=useComputedData(n),{onSourceCheckedChange:v,onTargetCheckedChange:g}=useCheckedChange(u,e),{addToLeft:b,addToRight:T}=useMove(n,u,e),k=ref(),y=ref(),O=Y=>{switch(Y){case"left":k.value.query="";break;case"right":y.value.query="";break}},D=computed(()=>n.buttonTexts.length===2),he=computed(()=>n.titles[0]||s("el.transfer.titles.0")),ae=computed(()=>n.titles[1]||s("el.transfer.titles.1")),Ne=computed(()=>n.filterPlaceholder||s("el.transfer.filterPlaceholder"));watch(()=>n.modelValue,()=>{var Y;n.validateEvent&&((Y=i==null?void 0:i.validate)==null||Y.call(i,"change").catch(_e=>void 0))});const ue=computed(()=>Y=>n.renderContent?n.renderContent(h,Y):o.default?o.default({option:Y}):h("span",Y[d.value.label]||Y[d.value.key]));return r({clearQuery:O,leftPanel:k,rightPanel:y}),(Y,_e)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(a).b())},[createVNode(TransferPanel,{ref_key:"leftPanel",ref:k,data:unref(c),"option-render":unref(ue),placeholder:unref(Ne),title:unref(he),filterable:Y.filterable,format:Y.format,"filter-method":Y.filterMethod,"default-checked":Y.leftDefaultChecked,props:n.props,onCheckedChange:unref(v)},{default:withCtx(()=>[renderSlot(Y.$slots,"left-footer")]),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),createBaseVNode("div",{class:normalizeClass(unref(a).e("buttons"))},[createVNode(unref(ElButton),{type:"primary",class:normalizeClass([unref(a).e("button"),unref(a).is("with-texts",unref(D))]),disabled:unref(isEmpty)(u.rightChecked),onClick:unref(b)},{default:withCtx(()=>[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(arrow_left_default))]),_:1}),unref(isUndefined$1)(Y.buttonTexts[0])?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("span",_hoisted_1$8,toDisplayString(Y.buttonTexts[0]),1))]),_:1},8,["class","disabled","onClick"]),createVNode(unref(ElButton),{type:"primary",class:normalizeClass([unref(a).e("button"),unref(a).is("with-texts",unref(D))]),disabled:unref(isEmpty)(u.leftChecked),onClick:unref(T)},{default:withCtx(()=>[unref(isUndefined$1)(Y.buttonTexts[1])?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("span",_hoisted_2$7,toDisplayString(Y.buttonTexts[1]),1)),createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(arrow_right_default))]),_:1})]),_:1},8,["class","disabled","onClick"])],2),createVNode(TransferPanel,{ref_key:"rightPanel",ref:y,data:unref(m),"option-render":unref(ue),placeholder:unref(Ne),filterable:Y.filterable,format:Y.format,"filter-method":Y.filterMethod,title:unref(ae),"default-checked":Y.rightDefaultChecked,props:n.props,onCheckedChange:unref(g)},{default:withCtx(()=>[renderSlot(Y.$slots,"right-footer")]),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});var Transfer=_export_sfc(_sfc_main$a,[["__file","/home/runner/work/element-plus/element-plus/packages/components/transfer/src/transfer.vue"]]);const ElTransfer=withInstall(Transfer),uploadContextKey=Symbol("uploadContextKey"),SCOPE$1="ElUpload";class UploadAjaxError extends Error{constructor(r,e,n,o){super(r),this.name="UploadAjaxError",this.status=e,this.method=n,this.url=o}}function getError(t,r,e){let n;return e.response?n=`${e.response.error||e.response}`:e.responseText?n=`${e.responseText}`:n=`fail to ${r.method} ${t} ${e.status}`,new UploadAjaxError(n,e.status,r.method,t)}function getBody(t){const r=t.responseText||t.response;if(!r)return r;try{return JSON.parse(r)}catch{return r}}const ajaxUpload=t=>{typeof XMLHttpRequest>"u"&&throwError(SCOPE$1,"XMLHttpRequest is undefined");const r=new XMLHttpRequest,e=t.action;r.upload&&r.upload.addEventListener("progress",s=>{const a=s;a.percent=s.total>0?s.loaded/s.total*100:0,t.onProgress(a)});const n=new FormData;if(t.data)for(const[s,a]of Object.entries(t.data))isArray$4(a)&&a.length?n.append(s,...a):n.append(s,a);n.append(t.filename,t.file,t.file.name),r.addEventListener("error",()=>{t.onError(getError(e,t,r))}),r.addEventListener("load",()=>{if(r.status<200||r.status>=300)return t.onError(getError(e,t,r));t.onSuccess(getBody(r))}),r.open(t.method,e,!0),t.withCredentials&&"withCredentials"in r&&(r.withCredentials=!0);const o=t.headers||{};if(o instanceof Headers)o.forEach((s,a)=>r.setRequestHeader(a,s));else for(const[s,a]of Object.entries(o))isNil(a)||r.setRequestHeader(s,String(a));return r.send(n),r},uploadListTypes=["text","picture","picture-card"];let fileId=1;const genFileId=()=>Date.now()+fileId++,uploadBaseProps=buildProps({action:{type:String,default:"#"},headers:{type:definePropType(Object)},method:{type:String,default:"post"},data:{type:definePropType([Object,Function,Promise]),default:()=>mutable({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:definePropType(Array),default:()=>mutable([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:uploadListTypes,default:"text"},httpRequest:{type:definePropType(Function),default:ajaxUpload},disabled:Boolean,limit:Number}),uploadProps=buildProps({...uploadBaseProps,beforeUpload:{type:definePropType(Function),default:NOOP},beforeRemove:{type:definePropType(Function)},onRemove:{type:definePropType(Function),default:NOOP},onChange:{type:definePropType(Function),default:NOOP},onPreview:{type:definePropType(Function),default:NOOP},onSuccess:{type:definePropType(Function),default:NOOP},onProgress:{type:definePropType(Function),default:NOOP},onError:{type:definePropType(Function),default:NOOP},onExceed:{type:definePropType(Function),default:NOOP}}),uploadListProps=buildProps({files:{type:definePropType(Array),default:()=>mutable([])},disabled:{type:Boolean,default:!1},handlePreview:{type:definePropType(Function),default:NOOP},listType:{type:String,values:uploadListTypes,default:"text"}}),uploadListEmits={remove:t=>!!t},_hoisted_1$7=["onKeydown"],_hoisted_2$6=["src"],_hoisted_3$4=["onClick"],_hoisted_4$3=["title"],_hoisted_5$3=["onClick"],_hoisted_6$2=["onClick"],__default__$4=defineComponent({name:"ElUploadList"}),_sfc_main$9=defineComponent({...__default__$4,props:uploadListProps,emits:uploadListEmits,setup(t,{emit:r}){const e=t,{t:n}=useLocale(),o=useNamespace("upload"),s=useNamespace("icon"),a=useNamespace("list"),i=useFormDisabled(),u=ref(!1),d=computed(()=>[o.b("list"),o.bm("list",e.listType),o.is("disabled",e.disabled)]),c=m=>{r("remove",m)};return(m,v)=>(openBlock(),createBlock(TransitionGroup,{tag:"ul",class:normalizeClass(unref(d)),name:unref(a).b()},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(m.files,g=>(openBlock(),createElementBlock("li",{key:g.uid||g.name,class:normalizeClass([unref(o).be("list","item"),unref(o).is(g.status),{focusing:u.value}]),tabindex:"0",onKeydown:withKeys(b=>!unref(i)&&c(g),["delete"]),onFocus:v[0]||(v[0]=b=>u.value=!0),onBlur:v[1]||(v[1]=b=>u.value=!1),onClick:v[2]||(v[2]=b=>u.value=!1)},[renderSlot(m.$slots,"default",{file:g},()=>[m.listType==="picture"||g.status!=="uploading"&&m.listType==="picture-card"?(openBlock(),createElementBlock("img",{key:0,class:normalizeClass(unref(o).be("list","item-thumbnail")),src:g.url,alt:""},null,10,_hoisted_2$6)):createCommentVNode("v-if",!0),g.status==="uploading"||m.listType!=="picture-card"?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(o).be("list","item-info"))},[createBaseVNode("a",{class:normalizeClass(unref(o).be("list","item-name")),onClick:withModifiers(b=>m.handlePreview(g),["prevent"])},[createVNode(unref(ElIcon),{class:normalizeClass(unref(s).m("document"))},{default:withCtx(()=>[createVNode(unref(document_default))]),_:1},8,["class"]),createBaseVNode("span",{class:normalizeClass(unref(o).be("list","item-file-name")),title:g.name},toDisplayString(g.name),11,_hoisted_4$3)],10,_hoisted_3$4),g.status==="uploading"?(openBlock(),createBlock(unref(ElProgress),{key:0,type:m.listType==="picture-card"?"circle":"line","stroke-width":m.listType==="picture-card"?6:2,percentage:Number(g.percentage),style:normalizeStyle(m.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("label",{class:normalizeClass(unref(o).be("list","item-status-label"))},[m.listType==="text"?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass([unref(s).m("upload-success"),unref(s).m("circle-check")])},{default:withCtx(()=>[createVNode(unref(circle_check_default))]),_:1},8,["class"])):["picture-card","picture"].includes(m.listType)?(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass([unref(s).m("upload-success"),unref(s).m("check")])},{default:withCtx(()=>[createVNode(unref(check_default))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],2),unref(i)?createCommentVNode("v-if",!0):(openBlock(),createBlock(unref(ElIcon),{key:2,class:normalizeClass(unref(s).m("close")),onClick:b=>c(g)},{default:withCtx(()=>[createVNode(unref(close_default))]),_:2},1032,["class","onClick"])),createCommentVNode(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),createCommentVNode(" This is a bug which needs to be fixed "),createCommentVNode(" TODO: Fix the incorrect navigation interaction "),unref(i)?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("i",{key:3,class:normalizeClass(unref(s).m("close-tip"))},toDisplayString(unref(n)("el.upload.deleteTip")),3)),m.listType==="picture-card"?(openBlock(),createElementBlock("span",{key:4,class:normalizeClass(unref(o).be("list","item-actions"))},[createBaseVNode("span",{class:normalizeClass(unref(o).be("list","item-preview")),onClick:b=>m.handlePreview(g)},[createVNode(unref(ElIcon),{class:normalizeClass(unref(s).m("zoom-in"))},{default:withCtx(()=>[createVNode(unref(zoom_in_default))]),_:1},8,["class"])],10,_hoisted_5$3),unref(i)?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(o).be("list","item-delete")),onClick:b=>c(g)},[createVNode(unref(ElIcon),{class:normalizeClass(unref(s).m("delete"))},{default:withCtx(()=>[createVNode(unref(delete_default))]),_:1},8,["class"])],10,_hoisted_6$2))],2)):createCommentVNode("v-if",!0)])],42,_hoisted_1$7))),128)),renderSlot(m.$slots,"append")]),_:3},8,["class","name"]))}});var UploadList=_export_sfc(_sfc_main$9,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-list.vue"]]);const uploadDraggerProps=buildProps({disabled:{type:Boolean,default:!1}}),uploadDraggerEmits={file:t=>isArray$4(t)},_hoisted_1$6=["onDrop","onDragover"],COMPONENT_NAME="ElUploadDrag",__default__$3=defineComponent({name:COMPONENT_NAME}),_sfc_main$8=defineComponent({...__default__$3,props:uploadDraggerProps,emits:uploadDraggerEmits,setup(t,{emit:r}){const e=inject(uploadContextKey);e||throwError(COMPONENT_NAME,"usage: <el-upload><el-upload-dragger /></el-upload>");const n=useNamespace("upload"),o=ref(!1),s=useFormDisabled(),a=u=>{if(s.value)return;o.value=!1,u.stopPropagation();const d=Array.from(u.dataTransfer.files),c=e.accept.value;if(!c){r("file",d);return}const m=d.filter(v=>{const{type:g,name:b}=v,T=b.includes(".")?`.${b.split(".").pop()}`:"",k=g.replace(/\/.*$/,"");return c.split(",").map(y=>y.trim()).filter(y=>y).some(y=>y.startsWith(".")?T===y:/\/\*$/.test(y)?k===y.replace(/\/\*$/,""):/^[^/]+\/[^/]+$/.test(y)?g===y:!1)});r("file",m)},i=()=>{s.value||(o.value=!0)};return(u,d)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(n).b("dragger"),unref(n).is("dragover",o.value)]),onDrop:withModifiers(a,["prevent"]),onDragover:withModifiers(i,["prevent"]),onDragleave:d[0]||(d[0]=withModifiers(c=>o.value=!1,["prevent"]))},[renderSlot(u.$slots,"default")],42,_hoisted_1$6))}});var UploadDragger=_export_sfc(_sfc_main$8,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-dragger.vue"]]);const uploadContentProps=buildProps({...uploadBaseProps,beforeUpload:{type:definePropType(Function),default:NOOP},onRemove:{type:definePropType(Function),default:NOOP},onStart:{type:definePropType(Function),default:NOOP},onSuccess:{type:definePropType(Function),default:NOOP},onProgress:{type:definePropType(Function),default:NOOP},onError:{type:definePropType(Function),default:NOOP},onExceed:{type:definePropType(Function),default:NOOP}}),_hoisted_1$5=["onKeydown"],_hoisted_2$5=["name","multiple","accept"],__default__$2=defineComponent({name:"ElUploadContent",inheritAttrs:!1}),_sfc_main$7=defineComponent({...__default__$2,props:uploadContentProps,setup(t,{expose:r}){const e=t,n=useNamespace("upload"),o=useFormDisabled(),s=shallowRef({}),a=shallowRef(),i=T=>{if(T.length===0)return;const{autoUpload:k,limit:y,fileList:O,multiple:D,onStart:he,onExceed:ae}=e;if(y&&O.length+T.length>y){ae(T,O);return}D||(T=T.slice(0,1));for(const Ne of T){const ue=Ne;ue.uid=genFileId(),he(ue),k&&u(ue)}},u=async T=>{if(a.value.value="",!e.beforeUpload)return c(T);let k,y={};try{const D=e.data,he=e.beforeUpload(T);y=isPlainObject$1(e.data)?cloneDeep(e.data):e.data,k=await he,isPlainObject$1(e.data)&&isEqual(D,y)&&(y=cloneDeep(e.data))}catch{k=!1}if(k===!1){e.onRemove(T);return}let O=T;k instanceof Blob&&(k instanceof File?O=k:O=new File([k],T.name,{type:T.type})),c(Object.assign(O,{uid:T.uid}),y)},d=async(T,k)=>isFunction$3(T)?T(k):T,c=async(T,k)=>{const{headers:y,data:O,method:D,withCredentials:he,name:ae,action:Ne,onProgress:ue,onSuccess:Y,onError:_e,httpRequest:Ce}=e;try{k=await d(k??O,T)}catch{e.onRemove(T);return}const{uid:ze}=T,ie={headers:y||{},withCredentials:he,file:T,data:k,method:D,filename:ae,action:Ne,onProgress:Ie=>{ue(Ie,T)},onSuccess:Ie=>{Y(Ie,T),delete s.value[ze]},onError:Ie=>{_e(Ie,T),delete s.value[ze]}},le=Ce(ie);s.value[ze]=le,le instanceof Promise&&le.then(ie.onSuccess,ie.onError)},m=T=>{const k=T.target.files;k&&i(Array.from(k))},v=()=>{o.value||(a.value.value="",a.value.click())},g=()=>{v()};return r({abort:T=>{entriesOf(s.value).filter(T?([y])=>String(T.uid)===y:()=>!0).forEach(([y,O])=>{O instanceof XMLHttpRequest&&O.abort(),delete s.value[y]})},upload:u}),(T,k)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(n).b(),unref(n).m(T.listType),unref(n).is("drag",T.drag)]),tabindex:"0",onClick:v,onKeydown:withKeys(withModifiers(g,["self"]),["enter","space"])},[T.drag?(openBlock(),createBlock(UploadDragger,{key:0,disabled:unref(o),onFile:i},{default:withCtx(()=>[renderSlot(T.$slots,"default")]),_:3},8,["disabled"])):renderSlot(T.$slots,"default",{key:1}),createBaseVNode("input",{ref_key:"inputRef",ref:a,class:normalizeClass(unref(n).e("input")),name:T.name,multiple:T.multiple,accept:T.accept,type:"file",onChange:m,onClick:k[0]||(k[0]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_2$5)],42,_hoisted_1$5))}});var UploadContent=_export_sfc(_sfc_main$7,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-content.vue"]]);const SCOPE="ElUpload",revokeFileObjectURL=t=>{var r;(r=t.url)!=null&&r.startsWith("blob:")&&URL.revokeObjectURL(t.url)},useHandlers=(t,r)=>{const e=useVModel(t,"fileList",void 0,{passive:!0}),n=v=>e.value.find(g=>g.uid===v.uid);function o(v){var g;(g=r.value)==null||g.abort(v)}function s(v=["ready","uploading","success","fail"]){e.value=e.value.filter(g=>!v.includes(g.status))}const a=(v,g)=>{const b=n(g);b&&(console.error(v),b.status="fail",e.value.splice(e.value.indexOf(b),1),t.onError(v,b,e.value),t.onChange(b,e.value))},i=(v,g)=>{const b=n(g);b&&(t.onProgress(v,b,e.value),b.status="uploading",b.percentage=Math.round(v.percent))},u=(v,g)=>{const b=n(g);b&&(b.status="success",b.response=v,t.onSuccess(v,b,e.value),t.onChange(b,e.value))},d=v=>{isNil(v.uid)&&(v.uid=genFileId());const g={name:v.name,percentage:0,status:"ready",size:v.size,raw:v,uid:v.uid};if(t.listType==="picture-card"||t.listType==="picture")try{g.url=URL.createObjectURL(v)}catch(b){b.message,t.onError(b,g,e.value)}e.value=[...e.value,g],t.onChange(g,e.value)},c=async v=>{const g=v instanceof File?n(v):v;g||throwError(SCOPE,"file to be removed not found");const b=T=>{o(T);const k=e.value;k.splice(k.indexOf(T),1),t.onRemove(T,k),revokeFileObjectURL(T)};t.beforeRemove?await t.beforeRemove(g,e.value)!==!1&&b(g):b(g)};function m(){e.value.filter(({status:v})=>v==="ready").forEach(({raw:v})=>{var g;return v&&((g=r.value)==null?void 0:g.upload(v))})}return watch(()=>t.listType,v=>{v!=="picture-card"&&v!=="picture"||(e.value=e.value.map(g=>{const{raw:b,url:T}=g;if(!T&&b)try{g.url=URL.createObjectURL(b)}catch(k){t.onError(k,g,e.value)}return g}))}),watch(e,v=>{for(const g of v)g.uid||(g.uid=genFileId()),g.status||(g.status="success")},{immediate:!0,deep:!0}),{uploadFiles:e,abort:o,clearFiles:s,handleError:a,handleProgress:i,handleStart:d,handleSuccess:u,handleRemove:c,submit:m,revokeFileObjectURL}},__default__$1=defineComponent({name:"ElUpload"}),_sfc_main$6=defineComponent({...__default__$1,props:uploadProps,setup(t,{expose:r}){const e=t,n=useFormDisabled(),o=shallowRef(),{abort:s,submit:a,clearFiles:i,uploadFiles:u,handleStart:d,handleError:c,handleRemove:m,handleSuccess:v,handleProgress:g,revokeFileObjectURL:b}=useHandlers(e,o),T=computed(()=>e.listType==="picture-card"),k=computed(()=>({...e,fileList:u.value,onStart:d,onProgress:g,onSuccess:v,onError:c,onRemove:m}));return onBeforeUnmount(()=>{u.value.forEach(b)}),provide(uploadContextKey,{accept:toRef(e,"accept")}),r({abort:s,submit:a,clearFiles:i,handleStart:d,handleRemove:m}),(y,O)=>(openBlock(),createElementBlock("div",null,[unref(T)&&y.showFileList?(openBlock(),createBlock(UploadList,{key:0,disabled:unref(n),"list-type":y.listType,files:unref(u),"handle-preview":y.onPreview,onRemove:unref(m)},createSlots({append:withCtx(()=>[createVNode(UploadContent,mergeProps({ref_key:"uploadRef",ref:o},unref(k)),{default:withCtx(()=>[y.$slots.trigger?renderSlot(y.$slots,"trigger",{key:0}):createCommentVNode("v-if",!0),!y.$slots.trigger&&y.$slots.default?renderSlot(y.$slots,"default",{key:1}):createCommentVNode("v-if",!0)]),_:3},16)]),_:2},[y.$slots.file?{name:"default",fn:withCtx(({file:D})=>[renderSlot(y.$slots,"file",{file:D})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):createCommentVNode("v-if",!0),!unref(T)||unref(T)&&!y.showFileList?(openBlock(),createBlock(UploadContent,mergeProps({key:1,ref_key:"uploadRef",ref:o},unref(k)),{default:withCtx(()=>[y.$slots.trigger?renderSlot(y.$slots,"trigger",{key:0}):createCommentVNode("v-if",!0),!y.$slots.trigger&&y.$slots.default?renderSlot(y.$slots,"default",{key:1}):createCommentVNode("v-if",!0)]),_:3},16)):createCommentVNode("v-if",!0),y.$slots.trigger?renderSlot(y.$slots,"default",{key:2}):createCommentVNode("v-if",!0),renderSlot(y.$slots,"tip"),!unref(T)&&y.showFileList?(openBlock(),createBlock(UploadList,{key:3,disabled:unref(n),"list-type":y.listType,files:unref(u),"handle-preview":y.onPreview,onRemove:unref(m)},createSlots({_:2},[y.$slots.file?{name:"default",fn:withCtx(({file:D})=>[renderSlot(y.$slots,"file",{file:D})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):createCommentVNode("v-if",!0)]))}});var Upload=_export_sfc(_sfc_main$6,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload.vue"]]);const ElUpload=withInstall(Upload),messageTypes=["success","info","warning","error"],messageDefaults=mutable({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:isClient?document.body:void 0}),messageProps=buildProps({customClass:{type:String,default:messageDefaults.customClass},center:{type:Boolean,default:messageDefaults.center},dangerouslyUseHTMLString:{type:Boolean,default:messageDefaults.dangerouslyUseHTMLString},duration:{type:Number,default:messageDefaults.duration},icon:{type:iconPropType,default:messageDefaults.icon},id:{type:String,default:messageDefaults.id},message:{type:definePropType([String,Object,Function]),default:messageDefaults.message},onClose:{type:definePropType(Function),required:!1},showClose:{type:Boolean,default:messageDefaults.showClose},type:{type:String,values:messageTypes,default:messageDefaults.type},offset:{type:Number,default:messageDefaults.offset},zIndex:{type:Number,default:messageDefaults.zIndex},grouping:{type:Boolean,default:messageDefaults.grouping},repeatNum:{type:Number,default:messageDefaults.repeatNum}}),messageEmits={destroy:()=>!0},instances=shallowReactive([]),getInstance=t=>{const r=instances.findIndex(o=>o.id===t),e=instances[r];let n;return r>0&&(n=instances[r-1]),{current:e,prev:n}},getLastOffset=t=>{const{prev:r}=getInstance(t);return r?r.vm.exposed.bottom.value:0},getOffsetOrSpace=(t,r)=>instances.findIndex(n=>n.id===t)>0?20:r,_hoisted_1$4=["id"],_hoisted_2$4=["innerHTML"],__default__=defineComponent({name:"ElMessage"}),_sfc_main$5=defineComponent({...__default__,props:messageProps,emits:messageEmits,setup(t,{expose:r}){const e=t,{Close:n}=TypeComponents,{ns:o,zIndex:s}=useGlobalComponentSettings("message"),{currentZIndex:a,nextZIndex:i}=s,u=ref(),d=ref(!1),c=ref(0);let m;const v=computed(()=>e.type?e.type==="error"?"danger":e.type:"info"),g=computed(()=>{const ue=e.type;return{[o.bm("icon",ue)]:ue&&TypeComponentsMap[ue]}}),b=computed(()=>e.icon||TypeComponentsMap[e.type]||""),T=computed(()=>getLastOffset(e.id)),k=computed(()=>getOffsetOrSpace(e.id,e.offset)+T.value),y=computed(()=>c.value+k.value),O=computed(()=>({top:`${k.value}px`,zIndex:a.value}));function D(){e.duration!==0&&({stop:m}=useTimeoutFn(()=>{ae()},e.duration))}function he(){m==null||m()}function ae(){d.value=!1}function Ne({code:ue}){ue===EVENT_CODE.esc&&ae()}return onMounted(()=>{D(),i(),d.value=!0}),watch(()=>e.repeatNum,()=>{he(),D()}),useEventListener(document,"keydown",Ne),useResizeObserver(u,()=>{c.value=u.value.getBoundingClientRect().height}),r({visible:d,bottom:y,close:ae}),(ue,Y)=>(openBlock(),createBlock(Transition,{name:unref(o).b("fade"),onBeforeLeave:ue.onClose,onAfterLeave:Y[0]||(Y[0]=_e=>ue.$emit("destroy")),persisted:""},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{id:ue.id,ref_key:"messageRef",ref:u,class:normalizeClass([unref(o).b(),{[unref(o).m(ue.type)]:ue.type&&!ue.icon},unref(o).is("center",ue.center),unref(o).is("closable",ue.showClose),ue.customClass]),style:normalizeStyle(unref(O)),role:"alert",onMouseenter:he,onMouseleave:D},[ue.repeatNum>1?(openBlock(),createBlock(unref(ElBadge),{key:0,value:ue.repeatNum,type:unref(v),class:normalizeClass(unref(o).e("badge"))},null,8,["value","type","class"])):createCommentVNode("v-if",!0),unref(b)?(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass([unref(o).e("icon"),unref(g)])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(b))))]),_:1},8,["class"])):createCommentVNode("v-if",!0),renderSlot(ue.$slots,"default",{},()=>[ue.dangerouslyUseHTMLString?(openBlock(),createElementBlock(Fragment,{key:1},[createCommentVNode(" Caution here, message could've been compromised, never use user's input as message "),createBaseVNode("p",{class:normalizeClass(unref(o).e("content")),innerHTML:ue.message},null,10,_hoisted_2$4)],2112)):(openBlock(),createElementBlock("p",{key:0,class:normalizeClass(unref(o).e("content"))},toDisplayString(ue.message),3))]),ue.showClose?(openBlock(),createBlock(unref(ElIcon),{key:2,class:normalizeClass(unref(o).e("closeBtn")),onClick:withModifiers(ae,["stop"])},{default:withCtx(()=>[createVNode(unref(n))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0)],46,_hoisted_1$4),[[vShow,d.value]])]),_:3},8,["name","onBeforeLeave"]))}});var MessageConstructor=_export_sfc(_sfc_main$5,[["__file","/home/runner/work/element-plus/element-plus/packages/components/message/src/message.vue"]]);let seed=1;const normalizeOptions=t=>{const r=!t||isString$2(t)||isVNode(t)||isFunction$3(t)?{message:t}:t,e={...messageDefaults,...r};if(!e.appendTo)e.appendTo=document.body;else if(isString$2(e.appendTo)){let n=document.querySelector(e.appendTo);isElement(n)||(n=document.body),e.appendTo=n}return e},closeMessage=t=>{const r=instances.indexOf(t);if(r===-1)return;instances.splice(r,1);const{handler:e}=t;e.close()},createMessage=({appendTo:t,...r},e)=>{const n=`message_${seed++}`,o=r.onClose,s=document.createElement("div"),a={...r,id:n,onClose:()=>{o==null||o(),closeMessage(c)},onDestroy:()=>{render(null,s)}},i=createVNode(MessageConstructor,a,isFunction$3(a.message)||isVNode(a.message)?{default:isFunction$3(a.message)?a.message:()=>a.message}:null);i.appContext=e||message._context,render(i,s),t.appendChild(s.firstElementChild);const u=i.component,c={id:n,vnode:i,vm:u,handler:{close:()=>{u.exposed.visible.value=!1}},props:i.component.props};return c},message=(t={},r)=>{if(!isClient)return{close:()=>{}};if(isNumber$1(messageConfig.max)&&instances.length>=messageConfig.max)return{close:()=>{}};const e=normalizeOptions(t);if(e.grouping&&instances.length){const o=instances.find(({vnode:s})=>{var a;return((a=s.props)==null?void 0:a.message)===e.message});if(o)return o.props.repeatNum+=1,o.props.type=e.type,o.handler}const n=createMessage(e,r);return instances.push(n),n.handler};messageTypes.forEach(t=>{message[t]=(r={},e)=>{const n=normalizeOptions(r);return message({...n,type:t},e)}});function closeAll(t){for(const r of instances)(!t||t===r.props.type)&&r.handler.close()}message.closeAll=closeAll;message._context=null;const ElMessage=withInstallFunction(message,"$message"),_sfc_main$4=defineComponent({name:"ElMessageBox",directives:{TrapFocus},components:{ElButton,ElFocusTrap,ElInput,ElOverlay,ElIcon,...TypeComponents},inheritAttrs:!1,props:{buttonSize:{type:String,validator:isValidComponentSize},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(t,{emit:r}){const{locale:e,zIndex:n,ns:o,size:s}=useGlobalComponentSettings("message-box",computed(()=>t.buttonSize)),{t:a}=e,{nextZIndex:i}=n,u=ref(!1),d=reactive({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:i()}),c=computed(()=>{const pe=d.type;return{[o.bm("icon",pe)]:pe&&TypeComponentsMap[pe]}}),m=useId(),v=useId(),g=computed(()=>d.icon||TypeComponentsMap[d.type]||""),b=computed(()=>!!d.message),T=ref(),k=ref(),y=ref(),O=ref(),D=ref(),he=computed(()=>d.confirmButtonClass);watch(()=>d.inputValue,async pe=>{await nextTick(),t.boxType==="prompt"&&pe!==null&&ze()},{immediate:!0}),watch(()=>u.value,pe=>{var qe,$e;pe&&(t.boxType!=="prompt"&&(d.autofocus?y.value=($e=(qe=D.value)==null?void 0:qe.$el)!=null?$e:T.value:y.value=T.value),d.zIndex=i()),t.boxType==="prompt"&&(pe?nextTick().then(()=>{var Lt;O.value&&O.value.$el&&(d.autofocus?y.value=(Lt=ie())!=null?Lt:T.value:y.value=T.value)}):(d.editorErrorMessage="",d.validateError=!1))});const ae=computed(()=>t.draggable);useDraggable(T,k,ae),onMounted(async()=>{await nextTick(),t.closeOnHashChange&&window.addEventListener("hashchange",Ne)}),onBeforeUnmount(()=>{t.closeOnHashChange&&window.removeEventListener("hashchange",Ne)});function Ne(){u.value&&(u.value=!1,nextTick(()=>{d.action&&r("action",d.action)}))}const ue=()=>{t.closeOnClickModal&&Ce(d.distinguishCancelAndClose?"close":"cancel")},Y=useSameTarget(ue),_e=pe=>{if(d.inputType!=="textarea")return pe.preventDefault(),Ce("confirm")},Ce=pe=>{var qe;t.boxType==="prompt"&&pe==="confirm"&&!ze()||(d.action=pe,d.beforeClose?(qe=d.beforeClose)==null||qe.call(d,pe,d,Ne):Ne())},ze=()=>{if(t.boxType==="prompt"){const pe=d.inputPattern;if(pe&&!pe.test(d.inputValue||""))return d.editorErrorMessage=d.inputErrorMessage||a("el.messagebox.error"),d.validateError=!0,!1;const qe=d.inputValidator;if(typeof qe=="function"){const $e=qe(d.inputValue);if($e===!1)return d.editorErrorMessage=d.inputErrorMessage||a("el.messagebox.error"),d.validateError=!0,!1;if(typeof $e=="string")return d.editorErrorMessage=$e,d.validateError=!0,!1}}return d.editorErrorMessage="",d.validateError=!1,!0},ie=()=>{const pe=O.value.$refs;return pe.input||pe.textarea},le=()=>{Ce("close")},Ie=()=>{t.closeOnPressEscape&&le()};return t.lockScroll&&useLockscreen(u),{...toRefs(d),ns:o,overlayEvent:Y,visible:u,hasMessage:b,typeClass:c,contentId:m,inputId:v,btnSize:s,iconComponent:g,confirmButtonClasses:he,rootRef:T,focusStartRef:y,headerRef:k,inputRef:O,confirmRef:D,doClose:Ne,handleClose:le,onCloseRequested:Ie,handleWrapperClick:ue,handleInputEnter:_e,handleAction:Ce,t:a}}}),_hoisted_1$3=["aria-label","aria-describedby"],_hoisted_2$3=["aria-label"],_hoisted_3$3=["id"];function _sfc_render(t,r,e,n,o,s){const a=resolveComponent("el-icon"),i=resolveComponent("close"),u=resolveComponent("el-input"),d=resolveComponent("el-button"),c=resolveComponent("el-focus-trap"),m=resolveComponent("el-overlay");return openBlock(),createBlock(Transition,{name:"fade-in-linear",onAfterLeave:r[11]||(r[11]=v=>t.$emit("vanish")),persisted:""},{default:withCtx(()=>[withDirectives(createVNode(m,{"z-index":t.zIndex,"overlay-class":[t.ns.is("message-box"),t.modalClass],mask:t.modal},{default:withCtx(()=>[createBaseVNode("div",{role:"dialog","aria-label":t.title,"aria-modal":"true","aria-describedby":t.showInput?void 0:t.contentId,class:normalizeClass(`${t.ns.namespace.value}-overlay-message-box`),onClick:r[8]||(r[8]=(...v)=>t.overlayEvent.onClick&&t.overlayEvent.onClick(...v)),onMousedown:r[9]||(r[9]=(...v)=>t.overlayEvent.onMousedown&&t.overlayEvent.onMousedown(...v)),onMouseup:r[10]||(r[10]=(...v)=>t.overlayEvent.onMouseup&&t.overlayEvent.onMouseup(...v))},[createVNode(c,{loop:"",trapped:t.visible,"focus-trap-el":t.rootRef,"focus-start-el":t.focusStartRef,onReleaseRequested:t.onCloseRequested},{default:withCtx(()=>[createBaseVNode("div",{ref:"rootRef",class:normalizeClass([t.ns.b(),t.customClass,t.ns.is("draggable",t.draggable),{[t.ns.m("center")]:t.center}]),style:normalizeStyle(t.customStyle),tabindex:"-1",onClick:r[7]||(r[7]=withModifiers(()=>{},["stop"]))},[t.title!==null&&t.title!==void 0?(openBlock(),createElementBlock("div",{key:0,ref:"headerRef",class:normalizeClass(t.ns.e("header"))},[createBaseVNode("div",{class:normalizeClass(t.ns.e("title"))},[t.iconComponent&&t.center?(openBlock(),createBlock(a,{key:0,class:normalizeClass([t.ns.e("status"),t.typeClass])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.iconComponent)))]),_:1},8,["class"])):createCommentVNode("v-if",!0),createBaseVNode("span",null,toDisplayString(t.title),1)],2),t.showClose?(openBlock(),createElementBlock("button",{key:0,type:"button",class:normalizeClass(t.ns.e("headerbtn")),"aria-label":t.t("el.messagebox.close"),onClick:r[0]||(r[0]=v=>t.handleAction(t.distinguishCancelAndClose?"close":"cancel")),onKeydown:r[1]||(r[1]=withKeys(withModifiers(v=>t.handleAction(t.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"]))},[createVNode(a,{class:normalizeClass(t.ns.e("close"))},{default:withCtx(()=>[createVNode(i)]),_:1},8,["class"])],42,_hoisted_2$3)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{id:t.contentId,class:normalizeClass(t.ns.e("content"))},[createBaseVNode("div",{class:normalizeClass(t.ns.e("container"))},[t.iconComponent&&!t.center&&t.hasMessage?(openBlock(),createBlock(a,{key:0,class:normalizeClass([t.ns.e("status"),t.typeClass])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.iconComponent)))]),_:1},8,["class"])):createCommentVNode("v-if",!0),t.hasMessage?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(t.ns.e("message"))},[renderSlot(t.$slots,"default",{},()=>[t.dangerouslyUseHTMLString?(openBlock(),createBlock(resolveDynamicComponent(t.showInput?"label":"p"),{key:1,for:t.showInput?t.inputId:void 0,innerHTML:t.message},null,8,["for","innerHTML"])):(openBlock(),createBlock(resolveDynamicComponent(t.showInput?"label":"p"),{key:0,for:t.showInput?t.inputId:void 0},{default:withCtx(()=>[createTextVNode(toDisplayString(t.dangerouslyUseHTMLString?"":t.message),1)]),_:1},8,["for"]))])],2)):createCommentVNode("v-if",!0)],2),withDirectives(createBaseVNode("div",{class:normalizeClass(t.ns.e("input"))},[createVNode(u,{id:t.inputId,ref:"inputRef",modelValue:t.inputValue,"onUpdate:modelValue":r[2]||(r[2]=v=>t.inputValue=v),type:t.inputType,placeholder:t.inputPlaceholder,"aria-invalid":t.validateError,class:normalizeClass({invalid:t.validateError}),onKeydown:withKeys(t.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),createBaseVNode("div",{class:normalizeClass(t.ns.e("errormsg")),style:normalizeStyle({visibility:t.editorErrorMessage?"visible":"hidden"})},toDisplayString(t.editorErrorMessage),7)],2),[[vShow,t.showInput]])],10,_hoisted_3$3),createBaseVNode("div",{class:normalizeClass(t.ns.e("btns"))},[t.showCancelButton?(openBlock(),createBlock(d,{key:0,loading:t.cancelButtonLoading,class:normalizeClass([t.cancelButtonClass]),round:t.roundButton,size:t.btnSize,onClick:r[3]||(r[3]=v=>t.handleAction("cancel")),onKeydown:r[4]||(r[4]=withKeys(withModifiers(v=>t.handleAction("cancel"),["prevent"]),["enter"]))},{default:withCtx(()=>[createTextVNode(toDisplayString(t.cancelButtonText||t.t("el.messagebox.cancel")),1)]),_:1},8,["loading","class","round","size"])):createCommentVNode("v-if",!0),withDirectives(createVNode(d,{ref:"confirmRef",type:"primary",loading:t.confirmButtonLoading,class:normalizeClass([t.confirmButtonClasses]),round:t.roundButton,disabled:t.confirmButtonDisabled,size:t.btnSize,onClick:r[5]||(r[5]=v=>t.handleAction("confirm")),onKeydown:r[6]||(r[6]=withKeys(withModifiers(v=>t.handleAction("confirm"),["prevent"]),["enter"]))},{default:withCtx(()=>[createTextVNode(toDisplayString(t.confirmButtonText||t.t("el.messagebox.confirm")),1)]),_:1},8,["loading","class","round","disabled","size"]),[[vShow,t.showConfirmButton]])],2)],6)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,_hoisted_1$3)]),_:3},8,["z-index","overlay-class","mask"]),[[vShow,t.visible]])]),_:3})}var MessageBoxConstructor=_export_sfc(_sfc_main$4,[["render",_sfc_render],["__file","/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue"]]);const messageInstance=new Map,getAppendToElement=t=>{let r=document.body;return t.appendTo&&(isString$2(t.appendTo)&&(r=document.querySelector(t.appendTo)),isElement(t.appendTo)&&(r=t.appendTo),isElement(r)||(r=document.body)),r},initInstance=(t,r,e=null)=>{const n=createVNode(MessageBoxConstructor,t,isFunction$3(t.message)||isVNode(t.message)?{default:isFunction$3(t.message)?t.message:()=>t.message}:null);return n.appContext=e,render(n,r),getAppendToElement(t).appendChild(r.firstElementChild),n.component},genContainer=()=>document.createElement("div"),showMessage=(t,r)=>{const e=genContainer();t.onVanish=()=>{render(null,e),messageInstance.delete(o)},t.onAction=s=>{const a=messageInstance.get(o);let i;t.showInput?i={value:o.inputValue,action:s}:i=s,t.callback?t.callback(i,n.proxy):s==="cancel"||s==="close"?t.distinguishCancelAndClose&&s!=="cancel"?a.reject("close"):a.reject("cancel"):a.resolve(i)};const n=initInstance(t,e,r),o=n.proxy;for(const s in t)hasOwn(t,s)&&!hasOwn(o.$props,s)&&(o[s]=t[s]);return o.visible=!0,o};function MessageBox(t,r=null){if(!isClient)return Promise.reject();let e;return isString$2(t)||isVNode(t)?t={message:t}:e=t.callback,new Promise((n,o)=>{const s=showMessage(t,r??MessageBox._context);messageInstance.set(s,{options:t,callback:e,resolve:n,reject:o})})}const MESSAGE_BOX_VARIANTS=["alert","confirm","prompt"],MESSAGE_BOX_DEFAULT_OPTS={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};MESSAGE_BOX_VARIANTS.forEach(t=>{MessageBox[t]=messageBoxFactory(t)});function messageBoxFactory(t){return(r,e,n,o)=>{let s="";return isObject$2(e)?(n=e,s=""):isUndefined$1(e)?s="":s=e,MessageBox(Object.assign({title:s,message:r,type:"",...MESSAGE_BOX_DEFAULT_OPTS[t]},n,{boxType:t}),o)}}MessageBox.close=()=>{messageInstance.forEach((t,r)=>{r.doClose()}),messageInstance.clear()};MessageBox._context=null;const _MessageBox=MessageBox;_MessageBox.install=t=>{_MessageBox._context=t._context,t.config.globalProperties.$msgbox=_MessageBox,t.config.globalProperties.$messageBox=_MessageBox,t.config.globalProperties.$alert=_MessageBox.alert,t.config.globalProperties.$confirm=_MessageBox.confirm,t.config.globalProperties.$prompt=_MessageBox.prompt};const ElMessageBox=_MessageBox,base="",elContainer="",elAside="",elFooter="",elHeader="",elMain="",elRow="",elCol="",elImage="",elImageViewer="",elButton="",elButtonGroup="",elPopper="",elScrollbar="",elDropdown="",elDropdownMenu="",elDropdownItem="",elIcon="";function bind(t,r){return function(){return t.apply(r,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(t=>r=>{const e=toString.call(r);return t[e]||(t[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=t=>(t=t.toLowerCase(),r=>kindOf(r)===t),typeOfTest=t=>r=>typeof r===t,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(t){return t!==null&&!isUndefined(t)&&t.constructor!==null&&!isUndefined(t.constructor)&&isFunction(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(t){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(t):r=t&&t.buffer&&isArrayBuffer(t.buffer),r}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=t=>t!==null&&typeof t=="object",isBoolean=t=>t===!0||t===!1,isPlainObject=t=>{if(kindOf(t)!=="object")return!1;const r=getPrototypeOf(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=t=>isObject(t)&&isFunction(t.pipe),isFormData=t=>{let r;return t&&(typeof FormData=="function"&&t instanceof FormData||isFunction(t.append)&&((r=kindOf(t))==="formdata"||r==="object"&&isFunction(t.toString)&&t.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),trim=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(t,r,{allOwnKeys:e=!1}={}){if(t===null||typeof t>"u")return;let n,o;if(typeof t!="object"&&(t=[t]),isArray(t))for(n=0,o=t.length;n<o;n++)r.call(null,t[n],n,t);else{const s=e?Object.getOwnPropertyNames(t):Object.keys(t),a=s.length;let i;for(n=0;n<a;n++)i=s[n],r.call(null,t[i],i,t)}}function findKey(t,r){r=r.toLowerCase();const e=Object.keys(t);let n=e.length,o;for(;n-- >0;)if(o=e[n],r===o.toLowerCase())return o;return null}const _global=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),isContextDefined=t=>!isUndefined(t)&&t!==_global;function merge(){const{caseless:t}=isContextDefined(this)&&this||{},r={},e=(n,o)=>{const s=t&&findKey(r,o)||o;isPlainObject(r[s])&&isPlainObject(n)?r[s]=merge(r[s],n):isPlainObject(n)?r[s]=merge({},n):isArray(n)?r[s]=n.slice():r[s]=n};for(let n=0,o=arguments.length;n<o;n++)arguments[n]&&forEach(arguments[n],e);return r}const extend=(t,r,e,{allOwnKeys:n}={})=>(forEach(r,(o,s)=>{e&&isFunction(o)?t[s]=bind(o,e):t[s]=o},{allOwnKeys:n}),t),stripBOM=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),inherits=(t,r,e,n)=>{t.prototype=Object.create(r.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:r.prototype}),e&&Object.assign(t.prototype,e)},toFlatObject=(t,r,e,n)=>{let o,s,a;const i={};if(r=r||{},t==null)return r;do{for(o=Object.getOwnPropertyNames(t),s=o.length;s-- >0;)a=o[s],(!n||n(a,t,r))&&!i[a]&&(r[a]=t[a],i[a]=!0);t=e!==!1&&getPrototypeOf(t)}while(t&&(!e||e(t,r))&&t!==Object.prototype);return r},endsWith=(t,r,e)=>{t=String(t),(e===void 0||e>t.length)&&(e=t.length),e-=r.length;const n=t.indexOf(r,e);return n!==-1&&n===e},toArray=t=>{if(!t)return null;if(isArray(t))return t;let r=t.length;if(!isNumber(r))return null;const e=new Array(r);for(;r-- >0;)e[r]=t[r];return e},isTypedArray=(t=>r=>t&&r instanceof t)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(t,r)=>{const n=(t&&t[Symbol.iterator]).call(t);let o;for(;(o=n.next())&&!o.done;){const s=o.value;r.call(t,s[0],s[1])}},matchAll=(t,r)=>{let e;const n=[];for(;(e=t.exec(r))!==null;)n.push(e);return n},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,n,o){return n.toUpperCase()+o}),hasOwnProperty=(({hasOwnProperty:t})=>(r,e)=>t.call(r,e))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(t,r)=>{const e=Object.getOwnPropertyDescriptors(t),n={};forEach(e,(o,s)=>{let a;(a=r(o,s,t))!==!1&&(n[s]=a||o)}),Object.defineProperties(t,n)},freezeMethods=t=>{reduceDescriptors(t,(r,e)=>{if(isFunction(t)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const n=t[e];if(isFunction(n)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},toObjectSet=(t,r)=>{const e={},n=o=>{o.forEach(s=>{e[s]=!0})};return isArray(t)?n(t):n(String(t).split(r)),e},noop=()=>{},toFiniteNumber=(t,r)=>(t=+t,Number.isFinite(t)?t:r),ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(t=16,r=ALPHABET.ALPHA_DIGIT)=>{let e="";const{length:n}=r;for(;t--;)e+=r[Math.random()*n|0];return e};function isSpecCompliantForm(t){return!!(t&&isFunction(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const toJSONObject=t=>{const r=new Array(10),e=(n,o)=>{if(isObject(n)){if(r.indexOf(n)>=0)return;if(!("toJSON"in n)){r[o]=n;const s=isArray(n)?[]:{};return forEach(n,(a,i)=>{const u=e(a,o+1);!isUndefined(u)&&(s[i]=u)}),r[o]=void 0,s}}return n};return e(t,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=t=>t&&(isObject(t)||isFunction(t))&&isFunction(t.then)&&isFunction(t.catch),utils={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable};function AxiosError(t,r,e,n,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",r&&(this.code=r),e&&(this.config=e),n&&(this.request=n),o&&(this.response=o)}utils.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{descriptors[t]={value:t}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(t,r,e,n,o,s)=>{const a=Object.create(prototype$1);return utils.toFlatObject(t,a,function(u){return u!==Error.prototype},i=>i!=="isAxiosError"),AxiosError.call(a,t.message,r,e,n,o),a.cause=t,a.name=t.name,s&&Object.assign(a,s),a};const httpAdapter=null;function isVisitable(t){return utils.isPlainObject(t)||utils.isArray(t)}function removeBrackets(t){return utils.endsWith(t,"[]")?t.slice(0,-2):t}function renderKey(t,r,e){return t?t.concat(r).map(function(o,s){return o=removeBrackets(o),!e&&s?"["+o+"]":o}).join(e?".":""):r}function isFlatArray(t){return utils.isArray(t)&&!t.some(isVisitable)}const predicates=utils.toFlatObject(utils,{},null,function(r){return/^is[A-Z]/.test(r)});function toFormData(t,r,e){if(!utils.isObject(t))throw new TypeError("target must be an object");r=r||new FormData,e=utils.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(T,k){return!utils.isUndefined(k[T])});const n=e.metaTokens,o=e.visitor||c,s=e.dots,a=e.indexes,u=(e.Blob||typeof Blob<"u"&&Blob)&&utils.isSpecCompliantForm(r);if(!utils.isFunction(o))throw new TypeError("visitor must be a function");function d(b){if(b===null)return"";if(utils.isDate(b))return b.toISOString();if(!u&&utils.isBlob(b))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils.isArrayBuffer(b)||utils.isTypedArray(b)?u&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function c(b,T,k){let y=b;if(b&&!k&&typeof b=="object"){if(utils.endsWith(T,"{}"))T=n?T:T.slice(0,-2),b=JSON.stringify(b);else if(utils.isArray(b)&&isFlatArray(b)||(utils.isFileList(b)||utils.endsWith(T,"[]"))&&(y=utils.toArray(b)))return T=removeBrackets(T),y.forEach(function(D,he){!(utils.isUndefined(D)||D===null)&&r.append(a===!0?renderKey([T],he,s):a===null?T:T+"[]",d(D))}),!1}return isVisitable(b)?!0:(r.append(renderKey(k,T,s),d(b)),!1)}const m=[],v=Object.assign(predicates,{defaultVisitor:c,convertValue:d,isVisitable});function g(b,T){if(!utils.isUndefined(b)){if(m.indexOf(b)!==-1)throw Error("Circular reference detected in "+T.join("."));m.push(b),utils.forEach(b,function(y,O){(!(utils.isUndefined(y)||y===null)&&o.call(r,y,utils.isString(O)?O.trim():O,T,v))===!0&&g(y,T?T.concat(O):[O])}),m.pop()}}if(!utils.isObject(t))throw new TypeError("data must be an object");return g(t),r}function encode$1(t){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return r[n]})}function AxiosURLSearchParams(t,r){this._pairs=[],t&&toFormData(t,this,r)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(r,e){this._pairs.push([r,e])};prototype.toString=function(r){const e=r?function(n){return r.call(this,n,encode$1)}:encode$1;return this._pairs.map(function(o){return e(o[0])+"="+e(o[1])},"").join("&")};function encode(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(t,r,e){if(!r)return t;const n=e&&e.encode||encode,o=e&&e.serialize;let s;if(o?s=o(r,e):s=utils.isURLSearchParams(r)?r.toString():new AxiosURLSearchParams(r,e).toString(n),s){const a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class InterceptorManager{constructor(){this.handlers=[]}use(r,e,n){return this.handlers.push({fulfilled:r,rejected:e,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){utils.forEach(this.handlers,function(n){n!==null&&r(n)})}}const InterceptorManager$1=InterceptorManager,transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,isStandardBrowserEnv=(()=>{let t;return typeof navigator<"u"&&((t=navigator.product)==="ReactNative"||t==="NativeScript"||t==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),isStandardBrowserWebWorkerEnv=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),platform={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},isStandardBrowserEnv,isStandardBrowserWebWorkerEnv,protocols:["http","https","file","blob","url","data"]};function toURLEncodedForm(t,r){return toFormData(t,new platform.classes.URLSearchParams,Object.assign({visitor:function(e,n,o,s){return platform.isNode&&utils.isBuffer(e)?(this.append(n,e.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},r))}function parsePropPath(t){return utils.matchAll(/\w+|\[(\w*)]/g,t).map(r=>r[0]==="[]"?"":r[1]||r[0])}function arrayToObject(t){const r={},e=Object.keys(t);let n;const o=e.length;let s;for(n=0;n<o;n++)s=e[n],r[s]=t[s];return r}function formDataToJSON(t){function r(e,n,o,s){let a=e[s++];const i=Number.isFinite(+a),u=s>=e.length;return a=!a&&utils.isArray(o)?o.length:a,u?(utils.hasOwnProp(o,a)?o[a]=[o[a],n]:o[a]=n,!i):((!o[a]||!utils.isObject(o[a]))&&(o[a]=[]),r(e,n,o[a],s)&&utils.isArray(o[a])&&(o[a]=arrayToObject(o[a])),!i)}if(utils.isFormData(t)&&utils.isFunction(t.entries)){const e={};return utils.forEachEntry(t,(n,o)=>{r(parsePropPath(n),o,e,0)}),e}return null}function stringifySafely(t,r,e){if(utils.isString(t))try{return(r||JSON.parse)(t),utils.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(e||JSON.stringify)(t)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http"],transformRequest:[function(r,e){const n=e.getContentType()||"",o=n.indexOf("application/json")>-1,s=utils.isObject(r);if(s&&utils.isHTMLForm(r)&&(r=new FormData(r)),utils.isFormData(r))return o&&o?JSON.stringify(formDataToJSON(r)):r;if(utils.isArrayBuffer(r)||utils.isBuffer(r)||utils.isStream(r)||utils.isFile(r)||utils.isBlob(r))return r;if(utils.isArrayBufferView(r))return r.buffer;if(utils.isURLSearchParams(r))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let i;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(r,this.formSerializer).toString();if((i=utils.isFileList(r))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return toFormData(i?{"files[]":r}:r,u&&new u,this.formSerializer)}}return s||o?(e.setContentType("application/json",!1),stringifySafely(r)):r}],transformResponse:[function(r){const e=this.transitional||defaults.transitional,n=e&&e.forcedJSONParsing,o=this.responseType==="json";if(r&&utils.isString(r)&&(n&&!this.responseType||o)){const a=!(e&&e.silentJSONParsing)&&o;try{return JSON.parse(r)}catch(i){if(a)throw i.name==="SyntaxError"?AxiosError.from(i,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):i}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils.forEach(["delete","get","head","post","put","patch"],t=>{defaults.headers[t]={}});const defaults$1=defaults,ignoreDuplicateOf=utils.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=t=>{const r={};let e,n,o;return t&&t.split(`
`).forEach(function(a){o=a.indexOf(":"),e=a.substring(0,o).trim().toLowerCase(),n=a.substring(o+1).trim(),!(!e||r[e]&&ignoreDuplicateOf[e])&&(e==="set-cookie"?r[e]?r[e].push(n):r[e]=[n]:r[e]=r[e]?r[e]+", "+n:n)}),r},$internals=Symbol("internals");function normalizeHeader(t){return t&&String(t).trim().toLowerCase()}function normalizeValue(t){return t===!1||t==null?t:utils.isArray(t)?t.map(normalizeValue):String(t)}function parseTokens(t){const r=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=e.exec(t);)r[n[1]]=n[2];return r}const isValidHeaderName=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function matchHeaderValue(t,r,e,n,o){if(utils.isFunction(n))return n.call(this,r,e);if(o&&(r=e),!!utils.isString(r)){if(utils.isString(n))return r.indexOf(n)!==-1;if(utils.isRegExp(n))return n.test(r)}}function formatHeader(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,e,n)=>e.toUpperCase()+n)}function buildAccessors(t,r){const e=utils.toCamelCase(" "+r);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+e,{value:function(o,s,a){return this[n].call(this,r,o,s,a)},configurable:!0})})}class AxiosHeaders{constructor(r){r&&this.set(r)}set(r,e,n){const o=this;function s(i,u,d){const c=normalizeHeader(u);if(!c)throw new Error("header name must be a non-empty string");const m=utils.findKey(o,c);(!m||o[m]===void 0||d===!0||d===void 0&&o[m]!==!1)&&(o[m||u]=normalizeValue(i))}const a=(i,u)=>utils.forEach(i,(d,c)=>s(d,c,u));return utils.isPlainObject(r)||r instanceof this.constructor?a(r,e):utils.isString(r)&&(r=r.trim())&&!isValidHeaderName(r)?a(parseHeaders(r),e):r!=null&&s(e,r,n),this}get(r,e){if(r=normalizeHeader(r),r){const n=utils.findKey(this,r);if(n){const o=this[n];if(!e)return o;if(e===!0)return parseTokens(o);if(utils.isFunction(e))return e.call(this,o,n);if(utils.isRegExp(e))return e.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,e){if(r=normalizeHeader(r),r){const n=utils.findKey(this,r);return!!(n&&this[n]!==void 0&&(!e||matchHeaderValue(this,this[n],n,e)))}return!1}delete(r,e){const n=this;let o=!1;function s(a){if(a=normalizeHeader(a),a){const i=utils.findKey(n,a);i&&(!e||matchHeaderValue(n,n[i],i,e))&&(delete n[i],o=!0)}}return utils.isArray(r)?r.forEach(s):s(r),o}clear(r){const e=Object.keys(this);let n=e.length,o=!1;for(;n--;){const s=e[n];(!r||matchHeaderValue(this,this[s],s,r,!0))&&(delete this[s],o=!0)}return o}normalize(r){const e=this,n={};return utils.forEach(this,(o,s)=>{const a=utils.findKey(n,s);if(a){e[a]=normalizeValue(o),delete e[s];return}const i=r?formatHeader(s):String(s).trim();i!==s&&delete e[s],e[i]=normalizeValue(o),n[i]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const e=Object.create(null);return utils.forEach(this,(n,o)=>{n!=null&&n!==!1&&(e[o]=r&&utils.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,e])=>r+": "+e).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...e){const n=new this(r);return e.forEach(o=>n.set(o)),n}static accessor(r){const n=(this[$internals]=this[$internals]={accessors:{}}).accessors,o=this.prototype;function s(a){const i=normalizeHeader(a);n[i]||(buildAccessors(o,a),n[i]=!0)}return utils.isArray(r)?r.forEach(s):s(r),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils.reduceDescriptors(AxiosHeaders.prototype,({value:t},r)=>{let e=r[0].toUpperCase()+r.slice(1);return{get:()=>t,set(n){this[e]=n}}});utils.freezeMethods(AxiosHeaders);const AxiosHeaders$1=AxiosHeaders;function transformData(t,r){const e=this||defaults$1,n=r||e,o=AxiosHeaders$1.from(n.headers);let s=n.data;return utils.forEach(t,function(i){s=i.call(e,s,o.normalize(),r?r.status:void 0)}),o.normalize(),s}function isCancel(t){return!!(t&&t.__CANCEL__)}function CanceledError(t,r,e){AxiosError.call(this,t??"canceled",AxiosError.ERR_CANCELED,r,e),this.name="CanceledError"}utils.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(t,r,e){const n=e.config.validateStatus;!e.status||!n||n(e.status)?t(e):r(new AxiosError("Request failed with status code "+e.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}const cookies=platform.isStandardBrowserEnv?function(){return{write:function(e,n,o,s,a,i){const u=[];u.push(e+"="+encodeURIComponent(n)),utils.isNumber(o)&&u.push("expires="+new Date(o).toGMTString()),utils.isString(s)&&u.push("path="+s),utils.isString(a)&&u.push("domain="+a),i===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function isAbsoluteURL(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function combineURLs(t,r){return r?t.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):t}function buildFullPath(t,r){return t&&!isAbsoluteURL(r)?combineURLs(t,r):r}const isURLSameOrigin=platform.isStandardBrowserEnv?function(){const r=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let n;function o(s){let a=s;return r&&(e.setAttribute("href",a),a=e.href),e.setAttribute("href",a),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:e.pathname.charAt(0)==="/"?e.pathname:"/"+e.pathname}}return n=o(window.location.href),function(a){const i=utils.isString(a)?o(a):a;return i.protocol===n.protocol&&i.host===n.host}}():function(){return function(){return!0}}();function parseProtocol(t){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return r&&r[1]||""}function speedometer(t,r){t=t||10;const e=new Array(t),n=new Array(t);let o=0,s=0,a;return r=r!==void 0?r:1e3,function(u){const d=Date.now(),c=n[s];a||(a=d),e[o]=u,n[o]=d;let m=s,v=0;for(;m!==o;)v+=e[m++],m=m%t;if(o=(o+1)%t,o===s&&(s=(s+1)%t),d-a<r)return;const g=c&&d-c;return g?Math.round(v*1e3/g):void 0}}function progressEventReducer(t,r){let e=0;const n=speedometer(50,250);return o=>{const s=o.loaded,a=o.lengthComputable?o.total:void 0,i=s-e,u=n(i),d=s<=a;e=s;const c={loaded:s,total:a,progress:a?s/a:void 0,bytes:i,rate:u||void 0,estimated:u&&a&&d?(a-s)/u:void 0,event:o};c[r?"download":"upload"]=!0,t(c)}}const isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(t){return new Promise(function(e,n){let o=t.data;const s=AxiosHeaders$1.from(t.headers).normalize(),a=t.responseType;let i;function u(){t.cancelToken&&t.cancelToken.unsubscribe(i),t.signal&&t.signal.removeEventListener("abort",i)}let d;utils.isFormData(o)&&(platform.isStandardBrowserEnv||platform.isStandardBrowserWebWorkerEnv?s.setContentType(!1):s.getContentType(/^\s*multipart\/form-data/)?utils.isString(d=s.getContentType())&&s.setContentType(d.replace(/^\s*(multipart\/form-data);+/,"$1")):s.setContentType("multipart/form-data"));let c=new XMLHttpRequest;if(t.auth){const b=t.auth.username||"",T=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";s.set("Authorization","Basic "+btoa(b+":"+T))}const m=buildFullPath(t.baseURL,t.url);c.open(t.method.toUpperCase(),buildURL(m,t.params,t.paramsSerializer),!0),c.timeout=t.timeout;function v(){if(!c)return;const b=AxiosHeaders$1.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders()),k={data:!a||a==="text"||a==="json"?c.responseText:c.response,status:c.status,statusText:c.statusText,headers:b,config:t,request:c};settle(function(O){e(O),u()},function(O){n(O),u()},k),c=null}if("onloadend"in c?c.onloadend=v:c.onreadystatechange=function(){!c||c.readyState!==4||c.status===0&&!(c.responseURL&&c.responseURL.indexOf("file:")===0)||setTimeout(v)},c.onabort=function(){c&&(n(new AxiosError("Request aborted",AxiosError.ECONNABORTED,t,c)),c=null)},c.onerror=function(){n(new AxiosError("Network Error",AxiosError.ERR_NETWORK,t,c)),c=null},c.ontimeout=function(){let T=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const k=t.transitional||transitionalDefaults;t.timeoutErrorMessage&&(T=t.timeoutErrorMessage),n(new AxiosError(T,k.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,t,c)),c=null},platform.isStandardBrowserEnv){const b=isURLSameOrigin(m)&&t.xsrfCookieName&&cookies.read(t.xsrfCookieName);b&&s.set(t.xsrfHeaderName,b)}o===void 0&&s.setContentType(null),"setRequestHeader"in c&&utils.forEach(s.toJSON(),function(T,k){c.setRequestHeader(k,T)}),utils.isUndefined(t.withCredentials)||(c.withCredentials=!!t.withCredentials),a&&a!=="json"&&(c.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&c.addEventListener("progress",progressEventReducer(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&c.upload&&c.upload.addEventListener("progress",progressEventReducer(t.onUploadProgress)),(t.cancelToken||t.signal)&&(i=b=>{c&&(n(!b||b.type?new CanceledError(null,t,c):b),c.abort(),c=null)},t.cancelToken&&t.cancelToken.subscribe(i),t.signal&&(t.signal.aborted?i():t.signal.addEventListener("abort",i)));const g=parseProtocol(m);if(g&&platform.protocols.indexOf(g)===-1){n(new AxiosError("Unsupported protocol "+g+":",AxiosError.ERR_BAD_REQUEST,t));return}c.send(o||null)})},knownAdapters={http:httpAdapter,xhr:xhrAdapter};utils.forEach(knownAdapters,(t,r)=>{if(t){try{Object.defineProperty(t,"name",{value:r})}catch{}Object.defineProperty(t,"adapterName",{value:r})}});const renderReason=t=>`- ${t}`,isResolvedHandle=t=>utils.isFunction(t)||t===null||t===!1,adapters={getAdapter:t=>{t=utils.isArray(t)?t:[t];const{length:r}=t;let e,n;const o={};for(let s=0;s<r;s++){e=t[s];let a;if(n=e,!isResolvedHandle(e)&&(n=knownAdapters[(a=String(e)).toLowerCase()],n===void 0))throw new AxiosError(`Unknown adapter '${a}'`);if(n)break;o[a||"#"+s]=n}if(!n){const s=Object.entries(o).map(([i,u])=>`adapter ${i} `+(u===!1?"is not supported by the environment":"is not available in the build"));let a=r?s.length>1?`since :
`+s.map(renderReason).join(`
`):" "+renderReason(s[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return n},adapters:knownAdapters};function throwIfCancellationRequested(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new CanceledError(null,t)}function dispatchRequest(t){return throwIfCancellationRequested(t),t.headers=AxiosHeaders$1.from(t.headers),t.data=transformData.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(t.adapter||defaults$1.adapter)(t).then(function(n){return throwIfCancellationRequested(t),n.data=transformData.call(t,t.transformResponse,n),n.headers=AxiosHeaders$1.from(n.headers),n},function(n){return isCancel(n)||(throwIfCancellationRequested(t),n&&n.response&&(n.response.data=transformData.call(t,t.transformResponse,n.response),n.response.headers=AxiosHeaders$1.from(n.response.headers))),Promise.reject(n)})}const headersToObject=t=>t instanceof AxiosHeaders$1?t.toJSON():t;function mergeConfig(t,r){r=r||{};const e={};function n(d,c,m){return utils.isPlainObject(d)&&utils.isPlainObject(c)?utils.merge.call({caseless:m},d,c):utils.isPlainObject(c)?utils.merge({},c):utils.isArray(c)?c.slice():c}function o(d,c,m){if(utils.isUndefined(c)){if(!utils.isUndefined(d))return n(void 0,d,m)}else return n(d,c,m)}function s(d,c){if(!utils.isUndefined(c))return n(void 0,c)}function a(d,c){if(utils.isUndefined(c)){if(!utils.isUndefined(d))return n(void 0,d)}else return n(void 0,c)}function i(d,c,m){if(m in r)return n(d,c);if(m in t)return n(void 0,d)}const u={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:i,headers:(d,c)=>o(headersToObject(d),headersToObject(c),!0)};return utils.forEach(Object.keys(Object.assign({},t,r)),function(c){const m=u[c]||o,v=m(t[c],r[c],c);utils.isUndefined(v)&&m!==i||(e[c]=v)}),e}const VERSION="1.6.0",validators$1={};["object","boolean","number","function","string","symbol"].forEach((t,r)=>{validators$1[t]=function(n){return typeof n===t||"a"+(r<1?"n ":" ")+t}});const deprecatedWarnings={};validators$1.transitional=function(r,e,n){function o(s,a){return"[Axios v"+VERSION+"] Transitional option '"+s+"'"+a+(n?". "+n:"")}return(s,a,i)=>{if(r===!1)throw new AxiosError(o(a," has been removed"+(e?" in "+e:"")),AxiosError.ERR_DEPRECATED);return e&&!deprecatedWarnings[a]&&(deprecatedWarnings[a]=!0,console.warn(o(a," has been deprecated since v"+e+" and will be removed in the near future"))),r?r(s,a,i):!0}};function assertOptions(t,r,e){if(typeof t!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let o=n.length;for(;o-- >0;){const s=n[o],a=r[s];if(a){const i=t[s],u=i===void 0||a(i,s,t);if(u!==!0)throw new AxiosError("option "+s+" must be "+u,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new AxiosError("Unknown option "+s,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(r){this.defaults=r,this.interceptors={request:new InterceptorManager$1,response:new InterceptorManager$1}}request(r,e){typeof r=="string"?(e=e||{},e.url=r):e=r||{},e=mergeConfig(this.defaults,e);const{transitional:n,paramsSerializer:o,headers:s}=e;n!==void 0&&validator.assertOptions(n,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),o!=null&&(utils.isFunction(o)?e.paramsSerializer={serialize:o}:validator.assertOptions(o,{encode:validators.function,serialize:validators.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let a=s&&utils.merge(s.common,s[e.method]);s&&utils.forEach(["delete","get","head","post","put","patch","common"],b=>{delete s[b]}),e.headers=AxiosHeaders$1.concat(a,s);const i=[];let u=!0;this.interceptors.request.forEach(function(T){typeof T.runWhen=="function"&&T.runWhen(e)===!1||(u=u&&T.synchronous,i.unshift(T.fulfilled,T.rejected))});const d=[];this.interceptors.response.forEach(function(T){d.push(T.fulfilled,T.rejected)});let c,m=0,v;if(!u){const b=[dispatchRequest.bind(this),void 0];for(b.unshift.apply(b,i),b.push.apply(b,d),v=b.length,c=Promise.resolve(e);m<v;)c=c.then(b[m++],b[m++]);return c}v=i.length;let g=e;for(m=0;m<v;){const b=i[m++],T=i[m++];try{g=b(g)}catch(k){T.call(this,k);break}}try{c=dispatchRequest.call(this,g)}catch(b){return Promise.reject(b)}for(m=0,v=d.length;m<v;)c=c.then(d[m++],d[m++]);return c}getUri(r){r=mergeConfig(this.defaults,r);const e=buildFullPath(r.baseURL,r.url);return buildURL(e,r.params,r.paramsSerializer)}}utils.forEach(["delete","get","head","options"],function(r){Axios.prototype[r]=function(e,n){return this.request(mergeConfig(n||{},{method:r,url:e,data:(n||{}).data}))}});utils.forEach(["post","put","patch"],function(r){function e(n){return function(s,a,i){return this.request(mergeConfig(i||{},{method:r,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}Axios.prototype[r]=e(),Axios.prototype[r+"Form"]=e(!0)});const Axios$1=Axios;class CancelToken{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(s){e=s});const n=this;this.promise.then(o=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](o);n._listeners=null}),this.promise.then=o=>{let s;const a=new Promise(i=>{n.subscribe(i),s=i}).then(o);return a.cancel=function(){n.unsubscribe(s)},a},r(function(s,a,i){n.reason||(n.reason=new CanceledError(s,a,i),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const e=this._listeners.indexOf(r);e!==-1&&this._listeners.splice(e,1)}static source(){let r;return{token:new CancelToken(function(o){r=o}),cancel:r}}}const CancelToken$1=CancelToken;function spread(t){return function(e){return t.apply(null,e)}}function isAxiosError(t){return utils.isObject(t)&&t.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([t,r])=>{HttpStatusCode[r]=t});const HttpStatusCode$1=HttpStatusCode;function createInstance(t){const r=new Axios$1(t),e=bind(Axios$1.prototype.request,r);return utils.extend(e,Axios$1.prototype,r,{allOwnKeys:!0}),utils.extend(e,r,null,{allOwnKeys:!0}),e.create=function(o){return createInstance(mergeConfig(t,o))},e}const axios=createInstance(defaults$1);axios.Axios=Axios$1;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function(r){return Promise.all(r)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=t=>formDataToJSON(utils.isHTMLForm(t)?new FormData(t):t);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const axios$1=axios;var QCHAT_BROWSER_SDK={exports:{}};(function(t,r){(function(e,n){t.exports=n()})(commonjsGlobal,function(){var e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{};function n(S){return S&&S.__esModule&&Object.prototype.hasOwnProperty.call(S,"default")?S.default:S}function o(S){var x={exports:{}};return S(x,x.exports),x.exports}var s,a,i=n(o(function(S){S.exports=function(V){if(V===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return V},S.exports.__esModule=!0,S.exports.default=S.exports})),u=function(S){return S&&S.Math==Math&&S},d=u(typeof globalThis=="object"&&globalThis)||u(typeof window=="object"&&window)||u(typeof self=="object"&&self)||u(typeof e=="object"&&e)||function(){return this}()||Function("return this")(),c=function(S){try{return!!S()}catch{return!0}},m=!c(function(){var S=(function(){}).bind();return typeof S!="function"||S.hasOwnProperty("prototype")}),v=Function.prototype,g=v.apply,b=v.call,T=typeof Reflect=="object"&&Reflect.apply||(m?b.bind(g):function(){return b.apply(g,arguments)}),k=Function.prototype,y=k.bind,O=k.call,D=m&&y.bind(O,O),he=m?function(S){return S&&D(S)}:function(S){return S&&function(){return O.apply(S,arguments)}},ae=function(S){return typeof S=="function"},Ne=!c(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),ue=Function.prototype.call,Y=m?ue.bind(ue):function(){return ue.apply(ue,arguments)},_e={}.propertyIsEnumerable,Ce=Object.getOwnPropertyDescriptor,ze={f:Ce&&!_e.call({1:2},1)?function(x){var V=Ce(this,x);return!!V&&V.enumerable}:_e},ie=function(S,x){return{enumerable:!(1&S),configurable:!(2&S),writable:!(4&S),value:x}},le=he({}.toString),Ie=he("".slice),pe=function(S){return Ie(le(S),8,-1)},qe=Object,$e=he("".split),Lt=c(function(){return!qe("z").propertyIsEnumerable(0)})?function(S){return pe(S)=="String"?$e(S,""):qe(S)}:qe,Dt=function(S){return S==null},dr=TypeError,pr=function(S){if(Dt(S))throw dr("Can't call method on "+S);return S},sr=function(S){return Lt(pr(S))},hr=typeof document=="object"&&document.all,Fe=hr===void 0&&hr!==void 0?function(S){return typeof S=="object"?S!==null:ae(S)||S===hr}:function(S){return typeof S=="object"?S!==null:ae(S)},nr={},ir=function(S){return ae(S)?S:void 0},Ue=function(S,x){return arguments.length<2?ir(nr[S])||ir(d[S]):nr[S]&&nr[S][x]||d[S]&&d[S][x]},rr=he({}.isPrototypeOf),or=Ue("navigator","userAgent")||"",Pt=d.process,Et=d.Deno,kt=Pt&&Pt.versions||Et&&Et.version,er=kt&&kt.v8;er&&(a=(s=er.split("."))[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&or&&(!(s=or.match(/Edge\/(\d+)/))||s[1]>=74)&&(s=or.match(/Chrome\/(\d+)/))&&(a=+s[1]);var cr,mr=a,vr=!!Object.getOwnPropertySymbols&&!c(function(){var S=Symbol();return!String(S)||!(Object(S)instanceof Symbol)||!Symbol.sham&&mr&&mr<41}),Tr=vr&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Ir=Object,kr=Tr?function(S){return typeof S=="symbol"}:function(S){var x=Ue("Symbol");return ae(x)&&rr(x.prototype,Ir(S))},Ar=String,Rr=function(S){try{return Ar(S)}catch{return"Object"}},Cn=TypeError,Or=function(S){if(ae(S))return S;throw Cn(Rr(S)+" is not a function")},Pr=function(S,x){var V=S[x];return Dt(V)?void 0:Or(V)},Nr=TypeError,Qr=Object.defineProperty,hn="__core-js_shared__",Ur=d[hn]||function(S,x){try{Qr(d,S,{value:x,configurable:!0,writable:!0})}catch{d[S]=x}return x}(hn,{}),qr=o(function(S){(S.exports=function(x,V){return Ur[x]||(Ur[x]=V!==void 0?V:{})})("versions",[]).push({version:"3.25.0",mode:"pure",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),Gn=Object,$n=function(S){return Gn(pr(S))},Jr=he({}.hasOwnProperty),Lr=Object.hasOwn||function(x,V){return Jr($n(x),V)},Kn=0,vo=Math.random(),bo=he(1 .toString),so=function(S){return"Symbol("+(S===void 0?"":S)+")_"+bo(++Kn+vo,36)},co=qr("wks"),No=d.Symbol,An=No&&No.for,Aa=Tr?No:No&&No.withoutSetter||so,to=function(S){if(!Lr(co,S)||!vr&&typeof co[S]!="string"){var x="Symbol."+S;vr&&Lr(No,S)?co[S]=No[S]:co[S]=Tr&&An?An(x):Aa(x)}return co[S]},Br=TypeError,Gr=to("toPrimitive"),Bn=function(S,x){if(!Fe(S)||kr(S))return S;var V,F=Pr(S,Gr);if(F){if(x===void 0&&(x="default"),V=Y(F,S,x),!Fe(V)||kr(V))return V;throw Br("Can't convert object to primitive value")}return x===void 0&&(x="number"),function(A,oe){var xe,z;if(oe==="string"&&ae(xe=A.toString)&&!Fe(z=Y(xe,A))||ae(xe=A.valueOf)&&!Fe(z=Y(xe,A))||oe!=="string"&&ae(xe=A.toString)&&!Fe(z=Y(xe,A)))return z;throw Nr("Can't convert object to primitive value")}(S,x)},Xn=function(S){var x=Bn(S,"string");return kr(x)?x:x+""},_o=d.document,oo=Fe(_o)&&Fe(_o.createElement),Ca=function(S){return oo?_o.createElement(S):{}},is=!Ne&&!c(function(){return Object.defineProperty(Ca("div"),"a",{get:function(){return 7}}).a!=7}),cs=Object.getOwnPropertyDescriptor,Es={f:Ne?cs:function(x,V){if(x=sr(x),V=Xn(V),is)try{return cs(x,V)}catch{}if(Lr(x,V))return ie(!Y(ze.f,x,V),x[V])}},Wh=/#|\.prototype\./,xa=function(S,x){var V=Zy[Li(S)];return V==tb||V!=eb&&(ae(x)?c(x):!!x)},Li=xa.normalize=function(S){return String(S).replace(Wh,".").toLowerCase()},Zy=xa.data={},eb=xa.NATIVE="N",tb=xa.POLYFILL="P",af=xa,rb=he(he.bind),$o=function(S,x){return Or(S),x===void 0?S:m?rb(S,x):function(){return S.apply(x,arguments)}},sf=Ne&&c(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),nb=String,ob=TypeError,Vn=function(S){if(Fe(S))return S;throw ob(nb(S)+" is not an object")},ab=TypeError,ru=Object.defineProperty,sb=Object.getOwnPropertyDescriptor,ib="enumerable",cb="configurable",lb="writable",ua={f:Ne?sf?function(x,V,F){if(Vn(x),V=Xn(V),Vn(F),typeof x=="function"&&V==="prototype"&&"value"in F&&lb in F&&!F.writable){var A=sb(x,V);A&&A.writable&&(x[V]=F.value,F={configurable:cb in F?F.configurable:A.configurable,enumerable:ib in F?F.enumerable:A.enumerable,writable:!1})}return ru(x,V,F)}:ru:function(x,V,F){if(Vn(x),V=Xn(V),Vn(F),is)try{return ru(x,V,F)}catch{}if("get"in F||"set"in F)throw ab("Accessors not supported");return"value"in F&&(x[V]=F.value),x}},Jo=Ne?function(S,x,V){return ua.f(S,x,ie(1,V))}:function(S,x,V){return S[x]=V,S},ub=Es.f,db=function(S){var x=function(V,F,A){if(this instanceof x){switch(arguments.length){case 0:return new S;case 1:return new S(V);case 2:return new S(V,F)}return new S(V,F,A)}return T(S,this,arguments)};return x.prototype=S.prototype,x},Vr=function(S,x){var V,F,A,oe,xe,z,Ve,jt,lr=S.target,fr=S.global,Sr=S.stat,br=S.proto,Er=fr?d:Sr?d[lr]:(d[lr]||{}).prototype,Dr=fr?nr:nr[lr]||Jo(nr,lr,{})[lr],$r=Dr.prototype;for(A in x)V=!af(fr?A:lr+(Sr?".":"#")+A,S.forced)&&Er&&Lr(Er,A),xe=Dr[A],V&&(z=S.dontCallGetSet?(jt=ub(Er,A))&&jt.value:Er[A]),oe=V&&z?z:x[A],V&&typeof xe==typeof oe||(Ve=S.bind&&V?$o(oe,d):S.wrap&&V?db(oe):br&&ae(oe)?he(oe):oe,(S.sham||oe&&oe.sham||xe&&xe.sham)&&Jo(Ve,"sham",!0),Jo(Dr,A,Ve),br&&(Lr(nr,F=lr+"Prototype")||Jo(nr,F,{}),Jo(nr[F],A,oe),S.real&&$r&&!$r[A]&&Jo($r,A,oe)))},pb=Math.ceil,fb=Math.floor,mb=Math.trunc||function(x){var V=+x;return(V>0?fb:pb)(V)},$i=function(S){var x=+S;return x!=x||x===0?0:mb(x)},gb=Math.max,hb=Math.min,ni=function(S,x){var V=$i(S);return V<0?gb(V+x,0):hb(V,x)},vb=Math.min,Ia=function(S){return(x=S.length)>0?vb($i(x),9007199254740991):0;var x},cf=function(S){return function(x,V,F){var A,oe=sr(x),xe=Ia(oe),z=ni(F,xe);if(S&&V!=V){for(;xe>z;)if((A=oe[z++])!=A)return!0}else for(;xe>z;z++)if((S||z in oe)&&oe[z]===V)return S||z||0;return!S&&-1}},nu={includes:cf(!0),indexOf:cf(!1)},oi={},yb=nu.indexOf,lf=he([].push),uf=function(S,x){var V,F=sr(S),A=0,oe=[];for(V in F)!Lr(oi,V)&&Lr(F,V)&&lf(oe,V);for(;x.length>A;)Lr(F,V=x[A++])&&(~yb(oe,V)||lf(oe,V));return oe},$c=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],gs=Object.keys||function(x){return uf(x,$c)},bb=Ne&&!sf?Object.defineProperties:function(x,V){Vn(x);for(var F,A=sr(V),oe=gs(V),xe=oe.length,z=0;xe>z;)ua.f(x,F=oe[z++],A[F]);return x},df={f:bb},ou=Ue("document","documentElement"),pf=qr("keys"),jc=function(S){return pf[S]||(pf[S]=so(S))},ff=jc("IE_PROTO"),au=function(){},mf=function(S){return"<script>"+S+"<\/script>"},gf=function(S){S.write(mf("")),S.close();var x=S.parentWindow.Object;return S=null,x},Dc=function(){try{cr=new ActiveXObject("htmlfile")}catch{}var S,x;Dc=typeof document<"u"?document.domain&&cr?gf(cr):((x=Ca("iframe")).style.display="none",ou.appendChild(x),x.src="javascript:",(S=x.contentWindow.document).open(),S.write(mf("document.F=Object")),S.close(),S.F):gf(cr);for(var V=$c.length;V--;)delete Dc.prototype[$c[V]];return Dc()};oi[ff]=!0;var Ea=Object.create||function(x,V){var F;return x!==null?(au.prototype=Vn(x),F=new au,au.prototype=null,F[ff]=x):F=Dc(),V===void 0?F:df.f(F,V)};Vr({target:"Object",stat:!0,sham:!Ne},{create:Ea});var Tb=nr.Object,Ja=function(x,V){return Tb.create(x,V)},Sb=String,Cb=TypeError,ji=Object.setPrototypeOf||("__proto__"in{}?function(){var S,x=!1,V={};try{(S=he(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(V,[]),x=V instanceof Array}catch{}return function(A,oe){return Vn(A),function(xe){if(typeof xe=="object"||ae(xe))return xe;throw Cb("Can't set "+Sb(xe)+" as a prototype")}(oe),x?S(A,oe):A.__proto__=oe,A}}():void 0);Vr({target:"Object",stat:!0},{setPrototypeOf:ji});var Rs=nr.Object.setPrototypeOf,hs=he([].slice),hf=Function,Mb=he([].concat),kb=he([].join),su={},_b=function(S,x,V){if(!Lr(su,x)){for(var F=[],A=0;A<x;A++)F[A]="a["+A+"]";su[x]=hf("C,a","return new C("+kb(F,",")+")")}return su[x](S,V)},iu=m?hf.bind:function(x){var V=Or(this),F=V.prototype,A=hs(arguments,1),oe=function(){var z=Mb(A,hs(arguments));return this instanceof oe?_b(V,z.length,z):V.apply(x,z)};return Fe(F)&&(oe.prototype=F),oe};Vr({target:"Function",proto:!0,forced:Function.bind!==iu},{bind:iu});var Uo=function(S){return nr[S+"Prototype"]},wb=Uo("Function").bind,cu=Function.prototype,Oo=function(S){var x=S.bind;return S===cu||rr(cu,S)&&x===cu.bind?wb:x},lu=o(function(S){function x(V,F){var A;return S.exports=x=Rs?Oo(A=Rs).call(A):function(xe,z){return xe.__proto__=z,xe},S.exports.__esModule=!0,S.exports.default=S.exports,x(V,F)}S.exports=x,S.exports.__esModule=!0,S.exports.default=S.exports}),Ro=n(o(function(S){S.exports=function(V,F){V.prototype=Ja(F.prototype),V.prototype.constructor=V,lu(V,F)},S.exports.__esModule=!0,S.exports.default=S.exports})),Ya=Array.isArray||function(x){return pe(x)=="Array"},xb=TypeError,uu=function(S){if(S>9007199254740991)throw xb("Maximum allowed index exceeded");return S},Bs=function(S,x,V){var F=Xn(x);F in S?ua.f(S,F,ie(0,V)):S[F]=V},vf={};vf[to("toStringTag")]="z";var du=String(vf)==="[object z]",Ib=to("toStringTag"),Eb=Object,Pb=pe(function(){return arguments}())=="Arguments",Fs=du?pe:function(S){var x,V,F;return S===void 0?"Undefined":S===null?"Null":typeof(V=function(A,oe){try{return A[oe]}catch{}}(x=Eb(S),Ib))=="string"?V:Pb?pe(x):(F=pe(x))=="Object"&&ae(x.callee)?"Arguments":F},Ab=he(Function.toString);ae(Ur.inspectSource)||(Ur.inspectSource=function(S){return Ab(S)});var yf=Ur.inspectSource,bf=function(){},Ob=[],Tf=Ue("Reflect","construct"),pu=/^\s*(?:class|function)\b/,Nb=he(pu.exec),Rb=!pu.exec(bf),Di=function(x){if(!ae(x))return!1;try{return Tf(bf,Ob,x),!0}catch{return!1}},Sf=function(x){if(!ae(x))return!1;switch(Fs(x)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Rb||!!Nb(pu,yf(x))}catch{return!0}};Sf.sham=!0;var Uc=!Tf||c(function(){var S;return Di(Di.call)||!Di(Object)||!Di(function(){S=!0})||S})?Sf:Di,Bb=to("species"),Cf=Array,fu=function(S,x){return new(function(V){var F;return Ya(V)&&(F=V.constructor,(Uc(F)&&(F===Cf||Ya(F.prototype))||Fe(F)&&(F=F[Bb])===null)&&(F=void 0)),F===void 0?Cf:F}(S))(x===0?0:x)},Fb=to("species"),Ui=function(S){return mr>=51||!c(function(){var x=[];return(x.constructor={})[Fb]=function(){return{foo:1}},x[S](Boolean).foo!==1})},Mf=to("isConcatSpreadable"),Lb=mr>=51||!c(function(){var S=[];return S[Mf]=!1,S.concat()[0]!==S}),$b=Ui("concat"),jb=function(S){if(!Fe(S))return!1;var x=S[Mf];return x!==void 0?!!x:Ya(S)};Vr({target:"Array",proto:!0,arity:1,forced:!Lb||!$b},{concat:function(x){var V,F,A,oe,xe,z=$n(this),Ve=fu(z,0),jt=0;for(V=-1,A=arguments.length;V<A;V++)if(jb(xe=V===-1?z:arguments[V]))for(oe=Ia(xe),uu(jt+oe),F=0;F<oe;F++,jt++)F in xe&&Bs(Ve,jt,xe[F]);else uu(jt+1),Bs(Ve,jt++,xe);return Ve.length=jt,Ve}});var qc,qi,Vc,Db=String,Oa=function(S){if(Fs(S)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Db(S)},Ub=$c.concat("length","prototype"),Vi={f:Object.getOwnPropertyNames||function(x){return uf(x,Ub)}},qb=Array,Vb=Math.max,mu=function(S,x,V){for(var F=Ia(S),A=ni(x,F),oe=ni(V===void 0?F:V,F),xe=qb(Vb(oe-A,0)),z=0;A<oe;A++,z++)Bs(xe,z,S[A]);return xe.length=z,xe},kf=Vi.f,_f=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],gu={f:function(x){return _f&&pe(x)=="Window"?function(V){try{return kf(V)}catch{return mu(_f)}}(x):kf(sr(x))}},Hi={f:Object.getOwnPropertySymbols},vs=function(S,x,V,F){return F&&F.enumerable?S[x]=V:Jo(S,x,V),S},hu={f:to},Hb=ua.f,wo=function(S){var x=nr.Symbol||(nr.Symbol={});Lr(x,S)||Hb(x,S,{value:hu.f(S)})},wf=function(){var S=Ue("Symbol"),x=S&&S.prototype,V=x&&x.valueOf,F=to("toPrimitive");x&&!x[F]&&vs(x,F,function(A){return Y(V,this)},{arity:1})},zb=du?{}.toString:function(){return"[object "+Fs(this)+"]"},Kb=ua.f,xf=to("toStringTag"),Ls=function(S,x,V,F){if(S){var A=V?S:S.prototype;Lr(A,xf)||Kb(A,xf,{configurable:!0,value:x}),F&&!du&&Jo(A,"toString",zb)}},If=d.WeakMap,Wb=ae(If)&&/native code/.test(String(If)),Ef="Object already initialized",vu=d.TypeError,Gb=d.WeakMap;if(Wb||Ur.state){var $s=Ur.state||(Ur.state=new Gb),Qb=he($s.get),Pf=he($s.has),Jb=he($s.set);qc=function(S,x){if(Pf($s,S))throw vu(Ef);return x.facade=S,Jb($s,S,x),x},qi=function(S){return Qb($s,S)||{}},Vc=function(S){return Pf($s,S)}}else{var ai=jc("state");oi[ai]=!0,qc=function(S,x){if(Lr(S,ai))throw vu(Ef);return x.facade=S,Jo(S,ai,x),x},qi=function(S){return Lr(S,ai)?S[ai]:{}},Vc=function(S){return Lr(S,ai)}}var Pa={set:qc,get:qi,has:Vc,enforce:function(S){return Vc(S)?qi(S):qc(S,{})},getterFor:function(S){return function(x){var V;if(!Fe(x)||(V=qi(x)).type!==S)throw vu("Incompatible receiver, "+S+" required");return V}}},Af=he([].push),ys=function(S){var x=S==1,V=S==2,F=S==3,A=S==4,oe=S==6,xe=S==7,z=S==5||oe;return function(Ve,jt,lr,fr){for(var Sr,br,Er=$n(Ve),Dr=Lt(Er),$r=$o(jt,lr),vn=Ia(Dr),Yr=0,wn=fr||fu,Zr=x?wn(Ve,vn):V||xe?wn(Ve,0):void 0;vn>Yr;Yr++)if((z||Yr in Dr)&&(br=$r(Sr=Dr[Yr],Yr,Er),S))if(x)Zr[Yr]=br;else if(br)switch(S){case 3:return!0;case 5:return Sr;case 6:return Yr;case 2:Af(Zr,Sr)}else switch(S){case 4:return!1;case 7:Af(Zr,Sr)}return oe?-1:F||A?A:Zr}},bs={forEach:ys(0),map:ys(1),filter:ys(2),some:ys(3),every:ys(4),find:ys(5),findIndex:ys(6),filterReject:ys(7)},Hc=bs.forEach,da=jc("hidden"),zc="Symbol",Yb=Pa.set,Of=Pa.getterFor(zc),Ba=Object.prototype,js=d.Symbol,zi=js&&js.prototype,Xb=d.TypeError,yu=d.QObject,Nf=Es.f,Ts=ua.f,Rf=gu.f,Zb=ze.f,Bf=he([].push),Xa=qr("symbols"),Ki=qr("op-symbols"),e0=qr("wks"),bu=!yu||!yu.prototype||!yu.prototype.findChild,Tu=Ne&&c(function(){return Ea(Ts({},"a",{get:function(){return Ts(this,"a",{value:7}).a}})).a!=7})?function(S,x,V){var F=Nf(Ba,x);F&&delete Ba[x],Ts(S,x,V),F&&S!==Ba&&Ts(Ba,x,F)}:Ts,Su=function(S,x){var V=Xa[S]=Ea(zi);return Yb(V,{type:zc,tag:S,description:x}),Ne||(V.description=x),V},Kc=function(x,V,F){x===Ba&&Kc(Ki,V,F),Vn(x);var A=Xn(V);return Vn(F),Lr(Xa,A)?(F.enumerable?(Lr(x,da)&&x[da][A]&&(x[da][A]=!1),F=Ea(F,{enumerable:ie(0,!1)})):(Lr(x,da)||Ts(x,da,ie(1,{})),x[da][A]=!0),Tu(x,A,F)):Ts(x,A,F)},Cu=function(x,V){Vn(x);var F=sr(V),A=gs(F).concat(jf(F));return Hc(A,function(oe){Ne&&!Y(Ff,F,oe)||Kc(x,oe,F[oe])}),x},Ff=function(x){var V=Xn(x),F=Y(Zb,this,V);return!(this===Ba&&Lr(Xa,V)&&!Lr(Ki,V))&&(!(F||!Lr(this,V)||!Lr(Xa,V)||Lr(this,da)&&this[da][V])||F)},Lf=function(x,V){var F=sr(x),A=Xn(V);if(F!==Ba||!Lr(Xa,A)||Lr(Ki,A)){var oe=Nf(F,A);return!oe||!Lr(Xa,A)||Lr(F,da)&&F[da][A]||(oe.enumerable=!0),oe}},$f=function(x){var V=Rf(sr(x)),F=[];return Hc(V,function(A){Lr(Xa,A)||Lr(oi,A)||Bf(F,A)}),F},jf=function(S){var x=S===Ba,V=Rf(x?Ki:sr(S)),F=[];return Hc(V,function(A){!Lr(Xa,A)||x&&!Lr(Ba,A)||Bf(F,Xa[A])}),F};vr||(js=function(){if(rr(zi,this))throw Xb("Symbol is not a constructor");var x=arguments.length&&arguments[0]!==void 0?Oa(arguments[0]):void 0,V=so(x),F=function(A){this===Ba&&Y(F,Ki,A),Lr(this,da)&&Lr(this[da],V)&&(this[da][V]=!1),Tu(this,V,ie(1,A))};return Ne&&bu&&Tu(Ba,V,{configurable:!0,set:F}),Su(V,x)},zi=js.prototype,vs(zi,"toString",function(){return Of(this).tag}),vs(js,"withoutSetter",function(S){return Su(so(S),S)}),ze.f=Ff,ua.f=Kc,df.f=Cu,Es.f=Lf,Vi.f=gu.f=$f,Hi.f=jf,hu.f=function(S){return Su(to(S),S)},Ne&&Ts(zi,"description",{configurable:!0,get:function(){return Of(this).description}})),Vr({global:!0,constructor:!0,wrap:!0,forced:!vr,sham:!vr},{Symbol:js}),Hc(gs(e0),function(S){wo(S)}),Vr({target:zc,stat:!0,forced:!vr},{useSetter:function(){bu=!0},useSimple:function(){bu=!1}}),Vr({target:"Object",stat:!0,forced:!vr,sham:!Ne},{create:function(x,V){return V===void 0?Ea(x):Cu(Ea(x),V)},defineProperty:Kc,defineProperties:Cu,getOwnPropertyDescriptor:Lf}),Vr({target:"Object",stat:!0,forced:!vr},{getOwnPropertyNames:$f}),wf(),Ls(js,zc),oi[da]=!0;var Df=vr&&!!Symbol.for&&!!Symbol.keyFor,Mu=qr("string-to-symbol-registry"),t0=qr("symbol-to-string-registry");Vr({target:"Symbol",stat:!0,forced:!Df},{for:function(S){var x=Oa(S);if(Lr(Mu,x))return Mu[x];var V=Ue("Symbol")(x);return Mu[x]=V,t0[V]=x,V}});var Uf=qr("symbol-to-string-registry");Vr({target:"Symbol",stat:!0,forced:!Df},{keyFor:function(x){if(!kr(x))throw TypeError(Rr(x)+" is not a symbol");if(Lr(Uf,x))return Uf[x]}});var Ss=Ue("JSON","stringify"),Wc=he(/./.exec),qf=he("".charAt),r0=he("".charCodeAt),n0=he("".replace),o0=he(1 .toString),a0=/[\uD800-\uDFFF]/g,Vf=/^[\uD800-\uDBFF]$/,Hf=/^[\uDC00-\uDFFF]$/,zf=!vr||c(function(){var S=Ue("Symbol")();return Ss([S])!="[null]"||Ss({a:S})!="{}"||Ss(Object(S))!="{}"}),Kf=c(function(){return Ss("\uDF06\uD834")!=='"\\udf06\\ud834"'||Ss("\uDEAD")!=='"\\udead"'}),s0=function(S,x){var V=hs(arguments),F=x;if((Fe(x)||S!==void 0)&&!kr(S))return Ya(x)||(x=function(A,oe){if(ae(F)&&(oe=Y(F,this,A,oe)),!kr(oe))return oe}),V[1]=x,T(Ss,null,V)},i0=function(S,x,V){var F=qf(V,x-1),A=qf(V,x+1);return Wc(Vf,S)&&!Wc(Hf,A)||Wc(Hf,S)&&!Wc(Vf,F)?"\\u"+o0(r0(S,0),16):S};Ss&&Vr({target:"JSON",stat:!0,arity:3,forced:zf||Kf},{stringify:function(x,V,F){var A=hs(arguments),oe=T(zf?s0:Ss,null,A);return Kf&&typeof oe=="string"?n0(oe,a0,i0):oe}});var c0=!vr||c(function(){Hi.f(1)});Vr({target:"Object",stat:!0,forced:c0},{getOwnPropertySymbols:function(x){var V=Hi.f;return V?V($n(x)):[]}}),wo("asyncIterator"),wo("hasInstance"),wo("isConcatSpreadable"),wo("iterator"),wo("match"),wo("matchAll"),wo("replace"),wo("search"),wo("species"),wo("split"),wo("toPrimitive"),wf(),wo("toStringTag"),Ls(Ue("Symbol"),"Symbol"),wo("unscopables"),Ls(d.JSON,"JSON",!0);var Cs,Wf,Gf,l0=nr.Symbol,Za={},Qf=Function.prototype,u0=Ne&&Object.getOwnPropertyDescriptor,ku=Lr(Qf,"name"),d0={EXISTS:ku,PROPER:ku&&(function(){}).name==="something",CONFIGURABLE:ku&&(!Ne||Ne&&u0(Qf,"name").configurable)},Jf=!c(function(){function S(){}return S.prototype.constructor=null,Object.getPrototypeOf(new S)!==S.prototype}),Yf=jc("IE_PROTO"),_u=Object,p0=_u.prototype,si=Jf?_u.getPrototypeOf:function(S){var x=$n(S);if(Lr(x,Yf))return x[Yf];var V=x.constructor;return ae(V)&&x instanceof V?V.prototype:x instanceof _u?p0:null},wu=to("iterator"),Xf=!1;[].keys&&("next"in(Gf=[].keys())?(Wf=si(si(Gf)))!==Object.prototype&&(Cs=Wf):Xf=!0);var f0=!Fe(Cs)||c(function(){var S={};return Cs[wu].call(S)!==S});Cs=f0?{}:Ea(Cs),ae(Cs[wu])||vs(Cs,wu,function(){return this});var Zf={IteratorPrototype:Cs,BUGGY_SAFARI_ITERATORS:Xf},m0=Zf.IteratorPrototype,g0=function(){return this},h0=d0.PROPER,Gc=Zf.BUGGY_SAFARI_ITERATORS,xu=to("iterator"),em="keys",Qc="values",tm="entries",v0=function(){return this},Iu=function(S,x,V,F,A,oe,xe){(function(vn,Yr,wn,Zr){var Qn=Yr+" Iterator";vn.prototype=Ea(m0,{next:ie(+!Zr,wn)}),Ls(vn,Qn,!1,!0),Za[Qn]=g0})(V,x,F);var z,Ve,jt,lr=function(vn){if(vn===A&&Dr)return Dr;if(!Gc&&vn in br)return br[vn];switch(vn){case em:return function(){return new V(this,vn)};case Qc:return function(){return new V(this,vn)};case tm:return function(){return new V(this,vn)}}return function(){return new V(this)}},fr=x+" Iterator",Sr=!1,br=S.prototype,Er=br[xu]||br["@@iterator"]||A&&br[A],Dr=!Gc&&Er||lr(A),$r=x=="Array"&&br.entries||Er;if($r&&(z=si($r.call(new S)))!==Object.prototype&&z.next&&(Ls(z,fr,!0,!0),Za[fr]=v0),h0&&A==Qc&&Er&&Er.name!==Qc&&(Sr=!0,Dr=function(){return Y(Er,this)}),A)if(Ve={values:lr(Qc),keys:oe?Dr:lr(em),entries:lr(tm)},xe)for(jt in Ve)(Gc||Sr||!(jt in br))&&vs(br,jt,Ve[jt]);else Vr({target:x,proto:!0,forced:Gc||Sr},Ve);return xe&&br[xu]!==Dr&&vs(br,xu,Dr,{name:A}),Za[x]=Dr,Ve};ua.f;var rm="Array Iterator",y0=Pa.set,b0=Pa.getterFor(rm);Iu(Array,"Array",function(S,x){y0(this,{type:rm,target:sr(S),index:0,kind:x})},function(){var S=b0(this),x=S.target,V=S.kind,F=S.index++;return!x||F>=x.length?(S.target=void 0,{value:void 0,done:!0}):V=="keys"?{value:F,done:!1}:V=="values"?{value:x[F],done:!1}:{value:[F,x[F]],done:!1}},"values"),Za.Arguments=Za.Array;var nm=to("toStringTag");for(var Eu in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var om=d[Eu],Pu=om&&om.prototype;Pu&&Fs(Pu)!==nm&&Jo(Pu,nm,Eu),Za[Eu]=Za.Array}var T0=l0;wo("asyncDispose"),wo("dispose"),wo("matcher"),wo("metadataKey"),wo("observable"),wo("metadata"),wo("patternMatch"),wo("replaceAll");var ga=T0,S0=he("".charAt),am=he("".charCodeAt),C0=he("".slice),sm=function(S){return function(x,V){var F,A,oe=Oa(pr(x)),xe=$i(V),z=oe.length;return xe<0||xe>=z?S?"":void 0:(F=am(oe,xe))<55296||F>56319||xe+1===z||(A=am(oe,xe+1))<56320||A>57343?S?S0(oe,xe):F:S?C0(oe,xe,xe+2):A-56320+(F-55296<<10)+65536}},M0={codeAt:sm(!1),charAt:sm(!0)}.charAt,im="String Iterator",k0=Pa.set,_0=Pa.getterFor(im);Iu(String,"String",function(S){k0(this,{type:im,string:Oa(S),index:0})},function(){var x,V=_0(this),F=V.string,A=V.index;return A>=F.length?{value:void 0,done:!0}:(x=M0(F,A),V.index+=x.length,{value:x,done:!1})});var cm=hu.f("iterator"),w0=o(function(S){function x(V){return S.exports=x=typeof ga=="function"&&typeof cm=="symbol"?function(F){return typeof F}:function(F){return F&&typeof ga=="function"&&F.constructor===ga&&F!==ga.prototype?"symbol":typeof F},S.exports.__esModule=!0,S.exports.default=S.exports,x(V)}S.exports=x,S.exports.__esModule=!0,S.exports.default=S.exports}),lm=ua.f;Vr({target:"Object",stat:!0,forced:Object.defineProperty!==lm,sham:!Ne},{defineProperty:lm});var x0=o(function(S){var x=nr.Object,V=S.exports=function(A,oe,xe){return x.defineProperty(A,oe,xe)};x.defineProperty.sham&&(V.sham=!0)}),Wi=x0,I0=c(function(){si(1)});Vr({target:"Object",stat:!0,forced:I0,sham:!Jf},{getPrototypeOf:function(x){return si($n(x))}});var Ds=nr.Object.getPrototypeOf,Us=function(S,x){var V=[][S];return!!V&&c(function(){V.call(null,x||function(){return 1},1)})},E0=bs.forEach,um=Us("forEach")?[].forEach:function(x){return E0(this,x,arguments.length>1?arguments[1]:void 0)};Vr({target:"Array",proto:!0,forced:[].forEach!=um},{forEach:um});var P0=Uo("Array").forEach,Au=Array.prototype,A0={DOMTokenList:!0,NodeList:!0},In=function(S){var x=S.forEach;return S===Au||rr(Au,S)&&x===Au.forEach||Lr(A0,Fs(S))?P0:x},O0=he([].concat),N0=Ue("Reflect","ownKeys")||function(x){var V=Vi.f(Vn(x)),F=Hi.f;return F?O0(V,F(x)):V},dm=Error,R0=he("".replace),B0=String(dm("zxcasd").stack),pm=/\n\s*at [^:]*:[^\n]*/,F0=pm.test(B0),L0=function(S,x){if(F0&&typeof S=="string"&&!dm.prepareStackTrace)for(;x--;)S=R0(S,pm,"");return S},$0=function(S,x){Fe(x)&&"cause"in x&&Jo(S,"cause",x.cause)},j0=to("iterator"),D0=Array.prototype,fm=function(S){return S!==void 0&&(Za.Array===S||D0[j0]===S)},U0=to("iterator"),Jc=function(S){if(!Dt(S))return Pr(S,U0)||Pr(S,"@@iterator")||Za[Fs(S)]},q0=TypeError,Gi=function(S,x){var V=arguments.length<2?Jc(S):x;if(Or(V))return Vn(Y(V,S));throw q0(Rr(S)+" is not iterable")},Ou=function(S,x,V){var F,A;Vn(S);try{if(!(F=Pr(S,"return"))){if(x==="throw")throw V;return V}F=Y(F,S)}catch(oe){A=!0,F=oe}if(x==="throw")throw V;if(A)throw F;return Vn(F),V},V0=TypeError,Yc=function(S,x){this.stopped=S,this.result=x},mm=Yc.prototype,lo=function(S,x,V){var F,A,oe,xe,z,Ve,jt,lr=V&&V.that,fr=!(!V||!V.AS_ENTRIES),Sr=!(!V||!V.IS_RECORD),br=!(!V||!V.IS_ITERATOR),Er=!(!V||!V.INTERRUPTED),Dr=$o(x,lr),$r=function(Yr){return F&&Ou(F,"normal",Yr),new Yc(!0,Yr)},vn=function(Yr){return fr?(Vn(Yr),Er?Dr(Yr[0],Yr[1],$r):Dr(Yr[0],Yr[1])):Er?Dr(Yr,$r):Dr(Yr)};if(Sr)F=S.iterator;else if(br)F=S;else{if(!(A=Jc(S)))throw V0(Rr(S)+" is not iterable");if(fm(A)){for(oe=0,xe=Ia(S);xe>oe;oe++)if((z=vn(S[oe]))&&rr(mm,z))return z;return new Yc(!1)}F=Gi(S,A)}for(Ve=Sr?S.next:F.next;!(jt=Y(Ve,F)).done;){try{z=vn(jt.value)}catch(Yr){Ou(F,"throw",Yr)}if(typeof z=="object"&&z&&rr(mm,z))return z}return new Yc(!1)},H0=function(S,x){return S===void 0?arguments.length<2?"":x:Oa(S)},z0=!c(function(){var S=Error("a");return!("stack"in S)||(Object.defineProperty(S,"stack",ie(1,7)),S.stack!==7)}),K0=to("toStringTag"),Xc=Error,W0=[].push,Qi=function(x,V){var F,A=arguments.length>2?arguments[2]:void 0,oe=rr(Nu,this);ji?F=ji(Xc(),oe?si(this):Nu):(F=oe?this:Ea(Nu),Jo(F,K0,"Error")),V!==void 0&&Jo(F,"message",H0(V)),z0&&Jo(F,"stack",L0(F.stack,1)),$0(F,A);var xe=[];return lo(x,W0,{that:xe}),Jo(F,"errors",xe),F};ji?ji(Qi,Xc):function(S,x,V){for(var F=N0(x),A=ua.f,oe=Es.f,xe=0;xe<F.length;xe++){var z=F[xe];Lr(S,z)||V&&Lr(V,z)||A(S,z,oe(x,z))}}(Qi,Xc,{name:!0});var Nu=Qi.prototype=Ea(Xc.prototype,{constructor:ie(1,Qi),message:ie(1,""),name:ie(1,"AggregateError")});Vr({global:!0,constructor:!0,arity:2},{AggregateError:Qi});var Ji,ii,gm,Ru,Ua=pe(d.process)=="process",hm=to("species"),vm=function(S){var x=Ue(S),V=ua.f;Ne&&x&&!x[hm]&&V(x,hm,{configurable:!0,get:function(){return this}})},G0=TypeError,Bu=function(S,x){if(rr(x,S))return S;throw G0("Incorrect invocation")},Q0=TypeError,Zc=function(S){if(Uc(S))return S;throw Q0(Rr(S)+" is not a constructor")},J0=to("species"),Ms=function(S,x){var V,F=Vn(S).constructor;return F===void 0||Dt(V=Vn(F)[J0])?x:Zc(V)},Y0=TypeError,ym=function(S,x){if(S<x)throw Y0("Not enough arguments");return S},bm=/(?:ipad|iphone|ipod).*applewebkit/i.test(or),Fu=d.setImmediate,Lu=d.clearImmediate,X0=d.process,$u=d.Dispatch,Z0=d.Function,Tm=d.MessageChannel,e1=d.String,ju=0,Yi={},t1="onreadystatechange";try{Ji=d.location}catch{}var Du=function(S){if(Lr(Yi,S)){var x=Yi[S];delete Yi[S],x()}},Uu=function(S){return function(){Du(S)}},Sm=function(S){Du(S.data)},Cm=function(S){d.postMessage(e1(S),Ji.protocol+"//"+Ji.host)};Fu&&Lu||(Fu=function(x){ym(arguments.length,1);var V=ae(x)?x:Z0(x),F=hs(arguments,1);return Yi[++ju]=function(){T(V,void 0,F)},ii(ju),ju},Lu=function(x){delete Yi[x]},Ua?ii=function(S){X0.nextTick(Uu(S))}:$u&&$u.now?ii=function(S){$u.now(Uu(S))}:Tm&&!bm?(Ru=(gm=new Tm).port2,gm.port1.onmessage=Sm,ii=$o(Ru.postMessage,Ru)):d.addEventListener&&ae(d.postMessage)&&!d.importScripts&&Ji&&Ji.protocol!=="file:"&&!c(Cm)?(ii=Cm,d.addEventListener("message",Sm,!1)):ii=t1 in Ca("script")?function(S){ou.appendChild(Ca("script")).onreadystatechange=function(){ou.removeChild(this),Du(S)}}:function(S){setTimeout(Uu(S),0)});var Xi,qs,Zi,ci,qu,Vu,Hu,Mm,km={set:Fu,clear:Lu},r1=/ipad|iphone|ipod/i.test(or)&&d.Pebble!==void 0,n1=/web0s(?!.*chrome)/i.test(or),o1=Es.f,zu=km.set,_m=d.MutationObserver||d.WebKitMutationObserver,wm=d.document,xm=d.process,el=d.Promise,Im=o1(d,"queueMicrotask"),Em=Im&&Im.value;Em||(Xi=function(){var S,x;for(Ua&&(S=xm.domain)&&S.exit();qs;){x=qs.fn,qs=qs.next;try{x()}catch(V){throw qs?ci():Zi=void 0,V}}Zi=void 0,S&&S.enter()},bm||Ua||n1||!_m||!wm?!r1&&el&&el.resolve?((Hu=el.resolve(void 0)).constructor=el,Mm=$o(Hu.then,Hu),ci=function(){Mm(Xi)}):Ua?ci=function(){xm.nextTick(Xi)}:(zu=$o(zu,d),ci=function(){zu(Xi)}):(qu=!0,Vu=wm.createTextNode(""),new _m(Xi).observe(Vu,{characterData:!0}),ci=function(){Vu.data=qu=!qu}));var Ku=Em||function(S){var x={fn:S,next:void 0};Zi&&(Zi.next=x),qs||(qs=x,ci()),Zi=x},li=function(S){try{return{error:!1,value:S()}}catch(x){return{error:!0,value:x}}},Pm=function(){this.head=null,this.tail=null};Pm.prototype={add:function(S){var x={item:S,next:null};this.head?this.tail.next=x:this.head=x,this.tail=x},get:function(){var S=this.head;if(S)return this.head=S.next,this.tail===S&&(this.tail=null),S.item}};var Wu,Am,a1=Pm,ra=d.Promise,Om=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",s1=!Om&&!Ua&&typeof window=="object"&&typeof document=="object",Nm=ra&&ra.prototype,i1=to("species"),Rm=!1,Bm=ae(d.PromiseRejectionEvent),c1=af("Promise",function(){var S=yf(ra),x=S!==String(ra);if(!x&&mr===66||!Nm.catch||!Nm.finally)return!0;if(!mr||mr<51||!/native code/.test(S)){var V=new ra(function(A){A(1)}),F=function(A){A(function(){},function(){})};if((V.constructor={})[i1]=F,!(Rm=V.then(function(){})instanceof F))return!0}return!x&&(s1||Om)&&!Bm}),ui={CONSTRUCTOR:c1,REJECTION_EVENT:Bm,SUBCLASSING:Rm},l1=TypeError,u1=function(S){var x,V;this.promise=new S(function(F,A){if(x!==void 0||V!==void 0)throw l1("Bad Promise constructor");x=F,V=A}),this.resolve=Or(x),this.reject=Or(V)},es={f:function(S){return new u1(S)}},Fm=km.set,tl="Promise",Lm=ui.CONSTRUCTOR,d1=ui.REJECTION_EVENT,Gu=Pa.getterFor(tl),p1=Pa.set,f1=ra&&ra.prototype,ec=ra,Qu=f1,$m=d.TypeError,Ju=d.document,Yu=d.process,Xu=es.f,m1=Xu,g1=!!(Ju&&Ju.createEvent&&d.dispatchEvent),jm="unhandledrejection",Dm=function(S){var x;return!(!Fe(S)||!ae(x=S.then))&&x},Um=function(S,x){var V,F,A,oe=x.value,xe=x.state==1,z=xe?S.ok:S.fail,Ve=S.resolve,jt=S.reject,lr=S.domain;try{z?(xe||(x.rejection===2&&v1(x),x.rejection=1),z===!0?V=oe:(lr&&lr.enter(),V=z(oe),lr&&(lr.exit(),A=!0)),V===S.promise?jt($m("Promise-chain cycle")):(F=Dm(V))?Y(F,V,Ve,jt):Ve(V)):jt(oe)}catch(fr){lr&&!A&&lr.exit(),jt(fr)}},qm=function(S,x){S.notified||(S.notified=!0,Ku(function(){for(var V,F=S.reactions;V=F.get();)Um(V,S);S.notified=!1,x&&!S.rejection&&h1(S)}))},Vm=function(S,x,V){var F,A;g1?((F=Ju.createEvent("Event")).promise=x,F.reason=V,F.initEvent(S,!1,!0),d.dispatchEvent(F)):F={promise:x,reason:V},!d1&&(A=d["on"+S])?A(F):S===jm&&function(oe,xe){var z=d.console;z&&z.error&&(arguments.length==1?z.error(oe):z.error(oe,xe))}("Unhandled promise rejection",V)},h1=function(S){Y(Fm,d,function(){var x,V=S.facade,F=S.value;if(Hm(S)&&(x=li(function(){Ua?Yu.emit("unhandledRejection",F,V):Vm(jm,V,F)}),S.rejection=Ua||Hm(S)?2:1,x.error))throw x.value})},Hm=function(S){return S.rejection!==1&&!S.parent},v1=function(S){Y(Fm,d,function(){var x=S.facade;Ua?Yu.emit("rejectionHandled",x):Vm("rejectionhandled",x,S.value)})},di=function(S,x,V){return function(F){S(x,F,V)}},pi=function(S,x,V){S.done||(S.done=!0,V&&(S=V),S.value=x,S.state=2,qm(S,!0))},Zu=function(S,x,V){if(!S.done){S.done=!0,V&&(S=V);try{if(S.facade===x)throw $m("Promise can't be resolved itself");var F=Dm(x);F?Ku(function(){var A={done:!1};try{Y(F,x,di(Zu,A,S),di(pi,A,S))}catch(oe){pi(A,oe,S)}}):(S.value=x,S.state=1,qm(S,!1))}catch(A){pi({done:!1},A,S)}}};Lm&&(Qu=(ec=function(x){Bu(this,Qu),Or(x),Y(Wu,this);var V=Gu(this);try{x(di(Zu,V),di(pi,V))}catch(F){pi(V,F)}}).prototype,(Wu=function(x){p1(this,{type:tl,done:!1,notified:!1,parent:!1,reactions:new a1,rejection:!1,state:0,value:void 0})}).prototype=vs(Qu,"then",function(x,V){var F=Gu(this),A=Xu(Ms(this,ec));return F.parent=!0,A.ok=!ae(x)||x,A.fail=ae(V)&&V,A.domain=Ua?Yu.domain:void 0,F.state==0?F.reactions.add(A):Ku(function(){Um(A,F)}),A.promise}),Am=function(){var S=new Wu,x=Gu(S);this.promise=S,this.resolve=di(Zu,x),this.reject=di(pi,x)},es.f=Xu=function(S){return S===ec||S===void 0?new Am(S):m1(S)}),Vr({global:!0,constructor:!0,wrap:!0,forced:Lm},{Promise:ec}),Ls(ec,tl,!1,!0),vm(tl);var zm=to("iterator"),Km=!1;try{var y1=0,Wm={next:function(){return{done:!!y1++}},return:function(){Km=!0}};Wm[zm]=function(){return this},Array.from(Wm,function(){throw 2})}catch{}var Gm=function(S,x){if(!x&&!Km)return!1;var V=!1;try{var F={};F[zm]=function(){return{next:function(){return{done:V=!0}}}},S(F)}catch{}return V},Qm=ui.CONSTRUCTOR||!Gm(function(S){ra.all(S).then(void 0,function(){})});Vr({target:"Promise",stat:!0,forced:Qm},{all:function(x){var V=this,F=es.f(V),A=F.resolve,oe=F.reject,xe=li(function(){var z=Or(V.resolve),Ve=[],jt=0,lr=1;lo(x,function(fr){var Sr=jt++,br=!1;lr++,Y(z,V,fr).then(function(Er){br||(br=!0,Ve[Sr]=Er,--lr||A(Ve))},oe)}),--lr||A(Ve)});return xe.error&&oe(xe.value),F.promise}});var b1=ui.CONSTRUCTOR;ra&&ra.prototype,Vr({target:"Promise",proto:!0,forced:b1,real:!0},{catch:function(S){return this.then(void 0,S)}}),Vr({target:"Promise",stat:!0,forced:Qm},{race:function(x){var V=this,F=es.f(V),A=F.reject,oe=li(function(){var xe=Or(V.resolve);lo(x,function(z){Y(xe,V,z).then(F.resolve,A)})});return oe.error&&A(oe.value),F.promise}}),Vr({target:"Promise",stat:!0,forced:ui.CONSTRUCTOR},{reject:function(x){var V=es.f(this);return Y(V.reject,void 0,x),V.promise}});var ed=function(S,x){if(Vn(S),Fe(x)&&x.constructor===S)return x;var V=es.f(S);return(0,V.resolve)(x),V.promise},T1=ui.CONSTRUCTOR,S1=Ue("Promise"),C1=!T1;Vr({target:"Promise",stat:!0,forced:!0},{resolve:function(x){return ed(C1&&this===S1?ra:this,x)}}),Vr({target:"Promise",stat:!0},{allSettled:function(x){var V=this,F=es.f(V),A=F.resolve,oe=F.reject,xe=li(function(){var z=Or(V.resolve),Ve=[],jt=0,lr=1;lo(x,function(fr){var Sr=jt++,br=!1;lr++,Y(z,V,fr).then(function(Er){br||(br=!0,Ve[Sr]={status:"fulfilled",value:Er},--lr||A(Ve))},function(Er){br||(br=!0,Ve[Sr]={status:"rejected",reason:Er},--lr||A(Ve))})}),--lr||A(Ve)});return xe.error&&oe(xe.value),F.promise}});var Jm="No one promise resolved";Vr({target:"Promise",stat:!0},{any:function(x){var V=this,F=Ue("AggregateError"),A=es.f(V),oe=A.resolve,xe=A.reject,z=li(function(){var Ve=Or(V.resolve),jt=[],lr=0,fr=1,Sr=!1;lo(x,function(br){var Er=lr++,Dr=!1;fr++,Y(Ve,V,br).then(function($r){Dr||Sr||(Sr=!0,oe($r))},function($r){Dr||Sr||(Dr=!0,jt[Er]=$r,--fr||xe(new F(jt,Jm)))})}),--fr||xe(new F(jt,Jm))});return z.error&&xe(z.value),A.promise}});var M1=ra&&ra.prototype,k1=!!ra&&c(function(){M1.finally.call({then:function(){}},function(){})});Vr({target:"Promise",proto:!0,real:!0,forced:k1},{finally:function(S){var x=Ms(this,Ue("Promise")),V=ae(S);return this.then(V?function(F){return ed(x,S()).then(function(){return F})}:S,V?function(F){return ed(x,S()).then(function(){throw F})}:S)}});var _1=nr.Promise;Vr({target:"Promise",stat:!0,forced:!0},{try:function(S){var x=es.f(this),V=li(S);return(V.error?x.reject:x.resolve)(V.value),x.promise}});var uo=_1,w1=he([].reverse),Ym=[1,2];Vr({target:"Array",proto:!0,forced:String(Ym)===String(Ym.reverse())},{reverse:function(){return Ya(this)&&(this.length=this.length),w1(this)}});var x1=Uo("Array").reverse,td=Array.prototype,kl=function(S){var x=S.reverse;return S===td||rr(td,S)&&x===td.reverse?x1:x},I1=Ui("slice"),E1=to("species"),rd=Array,P1=Math.max;Vr({target:"Array",proto:!0,forced:!I1},{slice:function(x,V){var F,A,oe,xe=sr(this),z=Ia(xe),Ve=ni(x,z),jt=ni(V===void 0?z:V,z);if(Ya(xe)&&(F=xe.constructor,(Uc(F)&&(F===rd||Ya(F.prototype))||Fe(F)&&(F=F[E1])===null)&&(F=void 0),F===rd||F===void 0))return hs(xe,Ve,jt);for(A=new(F===void 0?rd:F)(P1(jt-Ve,0)),oe=0;Ve<jt;Ve++,oe++)Ve in xe&&Bs(A,oe,xe[Ve]);return A.length=oe,A}});var A1=Uo("Array").slice,nd=Array.prototype,Co=function(S){var x=S.slice;return S===nd||rr(nd,S)&&x===nd.slice?A1:x},O1=o(function(S){var x=w0.default;function V(){S.exports=V=function(){return F},S.exports.__esModule=!0,S.exports.default=S.exports;var F={},A=Object.prototype,oe=A.hasOwnProperty,xe=typeof ga=="function"?ga:{},z=xe.iterator||"@@iterator",Ve=xe.asyncIterator||"@@asyncIterator",jt=xe.toStringTag||"@@toStringTag";function lr(Mn,Xr,On){return Wi(Mn,Xr,{value:On,enumerable:!0,configurable:!0,writable:!0}),Mn[Xr]}try{lr({},"")}catch{lr=function(On,Un,eo){return On[Un]=eo}}function fr(Mn,Xr,On,Un){var eo=Xr&&Xr.prototype instanceof Er?Xr:Er,ro=Ja(eo.prototype),Do=new wr(Un||[]);return ro._invoke=function(go,Zo,So){var Io="suspendedStart";return function(ea,Mi){if(Io==="executing")throw new Error("Generator is already running");if(Io==="completed"){if(ea==="throw")throw Mi;return Nn()}for(So.method=ea,So.arg=Mi;;){var Eo=So.delegate;if(Eo){var ki=Dn(Eo,So);if(ki){if(ki===br)continue;return ki}}if(So.method==="next")So.sent=So._sent=So.arg;else if(So.method==="throw"){if(Io==="suspendedStart")throw Io="completed",So.arg;So.dispatchException(So.arg)}else So.method==="return"&&So.abrupt("return",So.arg);Io="executing";var $a=Sr(go,Zo,So);if($a.type==="normal"){if(Io=So.done?"completed":"suspendedYield",$a.arg===br)continue;return{value:$a.arg,done:So.done}}$a.type==="throw"&&(Io="completed",So.method="throw",So.arg=$a.arg)}}}(Mn,On,Do),ro}function Sr(Mn,Xr,On){try{return{type:"normal",arg:Mn.call(Xr,On)}}catch(Un){return{type:"throw",arg:Un}}}F.wrap=fr;var br={};function Er(){}function Dr(){}function $r(){}var vn={};lr(vn,z,function(){return this});var Yr=Ds&&Ds(Ds(xn([])));Yr&&Yr!==A&&oe.call(Yr,z)&&(vn=Yr);var wn=$r.prototype=Er.prototype=Ja(vn);function Zr(Mn){var Xr;In(Xr=["next","throw","return"]).call(Xr,function(On){lr(Mn,On,function(Un){return this._invoke(On,Un)})})}function Qn(Mn,Xr){function On(eo,ro,Do,go){var Zo=Sr(Mn[eo],Mn,ro);if(Zo.type!=="throw"){var So=Zo.arg,Io=So.value;return Io&&x(Io)=="object"&&oe.call(Io,"__await")?Xr.resolve(Io.__await).then(function(ea){On("next",ea,Do,go)},function(ea){On("throw",ea,Do,go)}):Xr.resolve(Io).then(function(ea){So.value=ea,Do(So)},function(ea){return On("throw",ea,Do,go)})}go(Zo.arg)}var Un;this._invoke=function(eo,ro){function Do(){return new Xr(function(go,Zo){On(eo,ro,go,Zo)})}return Un=Un?Un.then(Do,Do):Do()}}function Dn(Mn,Xr){var On=Mn.iterator[Xr.method];if(On===void 0){if(Xr.delegate=null,Xr.method==="throw"){if(Mn.iterator.return&&(Xr.method="return",Xr.arg=void 0,Dn(Mn,Xr),Xr.method==="throw"))return br;Xr.method="throw",Xr.arg=new TypeError("The iterator does not provide a 'throw' method")}return br}var Un=Sr(On,Mn.iterator,Xr.arg);if(Un.type==="throw")return Xr.method="throw",Xr.arg=Un.arg,Xr.delegate=null,br;var eo=Un.arg;return eo?eo.done?(Xr[Mn.resultName]=eo.value,Xr.next=Mn.nextLoc,Xr.method!=="return"&&(Xr.method="next",Xr.arg=void 0),Xr.delegate=null,br):eo:(Xr.method="throw",Xr.arg=new TypeError("iterator result is not an object"),Xr.delegate=null,br)}function jo(Mn){var Xr={tryLoc:Mn[0]};1 in Mn&&(Xr.catchLoc=Mn[1]),2 in Mn&&(Xr.finallyLoc=Mn[2],Xr.afterLoc=Mn[3]),this.tryEntries.push(Xr)}function jn(Mn){var Xr=Mn.completion||{};Xr.type="normal",delete Xr.arg,Mn.completion=Xr}function wr(Mn){this.tryEntries=[{tryLoc:"root"}],In(Mn).call(Mn,jo,this),this.reset(!0)}function xn(Mn){if(Mn){var Xr=Mn[z];if(Xr)return Xr.call(Mn);if(typeof Mn.next=="function")return Mn;if(!isNaN(Mn.length)){var On=-1,Un=function eo(){for(;++On<Mn.length;)if(oe.call(Mn,On))return eo.value=Mn[On],eo.done=!1,eo;return eo.value=void 0,eo.done=!0,eo};return Un.next=Un}}return{next:Nn}}function Nn(){return{value:void 0,done:!0}}return Dr.prototype=$r,lr(wn,"constructor",$r),lr($r,"constructor",Dr),Dr.displayName=lr($r,jt,"GeneratorFunction"),F.isGeneratorFunction=function(Mn){var Xr=typeof Mn=="function"&&Mn.constructor;return!!Xr&&(Xr===Dr||(Xr.displayName||Xr.name)==="GeneratorFunction")},F.mark=function(Mn){return Rs?Rs(Mn,$r):(Mn.__proto__=$r,lr(Mn,jt,"GeneratorFunction")),Mn.prototype=Ja(wn),Mn},F.awrap=function(Mn){return{__await:Mn}},Zr(Qn.prototype),lr(Qn.prototype,Ve,function(){return this}),F.AsyncIterator=Qn,F.async=function(Mn,Xr,On,Un,eo){eo===void 0&&(eo=uo);var ro=new Qn(fr(Mn,Xr,On,Un),eo);return F.isGeneratorFunction(Xr)?ro:ro.next().then(function(Do){return Do.done?Do.value:ro.next()})},Zr(wn),lr(wn,jt,"Generator"),lr(wn,z,function(){return this}),lr(wn,"toString",function(){return"[object Generator]"}),F.keys=function(Mn){var Xr=[];for(var On in Mn)Xr.push(On);return kl(Xr).call(Xr),function Un(){for(;Xr.length;){var eo=Xr.pop();if(eo in Mn)return Un.value=eo,Un.done=!1,Un}return Un.done=!0,Un}},F.values=xn,wr.prototype={constructor:wr,reset:function(Xr){var On;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,In(On=this.tryEntries).call(On,jn),!Xr)for(var Un in this)Un.charAt(0)==="t"&&oe.call(this,Un)&&!isNaN(+Co(Un).call(Un,1))&&(this[Un]=void 0)},stop:function(){this.done=!0;var Xr=this.tryEntries[0].completion;if(Xr.type==="throw")throw Xr.arg;return this.rval},dispatchException:function(Xr){if(this.done)throw Xr;var On=this;function Un(So,Io){return Do.type="throw",Do.arg=Xr,On.next=So,Io&&(On.method="next",On.arg=void 0),!!Io}for(var eo=this.tryEntries.length-1;eo>=0;--eo){var ro=this.tryEntries[eo],Do=ro.completion;if(ro.tryLoc==="root")return Un("end");if(ro.tryLoc<=this.prev){var go=oe.call(ro,"catchLoc"),Zo=oe.call(ro,"finallyLoc");if(go&&Zo){if(this.prev<ro.catchLoc)return Un(ro.catchLoc,!0);if(this.prev<ro.finallyLoc)return Un(ro.finallyLoc)}else if(go){if(this.prev<ro.catchLoc)return Un(ro.catchLoc,!0)}else{if(!Zo)throw new Error("try statement without catch or finally");if(this.prev<ro.finallyLoc)return Un(ro.finallyLoc)}}}},abrupt:function(Xr,On){for(var Un=this.tryEntries.length-1;Un>=0;--Un){var eo=this.tryEntries[Un];if(eo.tryLoc<=this.prev&&oe.call(eo,"finallyLoc")&&this.prev<eo.finallyLoc){var ro=eo;break}}ro&&(Xr==="break"||Xr==="continue")&&ro.tryLoc<=On&&On<=ro.finallyLoc&&(ro=null);var Do=ro?ro.completion:{};return Do.type=Xr,Do.arg=On,ro?(this.method="next",this.next=ro.finallyLoc,br):this.complete(Do)},complete:function(Xr,On){if(Xr.type==="throw")throw Xr.arg;return Xr.type==="break"||Xr.type==="continue"?this.next=Xr.arg:Xr.type==="return"?(this.rval=this.arg=Xr.arg,this.method="return",this.next="end"):Xr.type==="normal"&&On&&(this.next=On),br},finish:function(Xr){for(var On=this.tryEntries.length-1;On>=0;--On){var Un=this.tryEntries[On];if(Un.finallyLoc===Xr)return this.complete(Un.completion,Un.afterLoc),jn(Un),br}},catch:function(Xr){for(var On=this.tryEntries.length-1;On>=0;--On){var Un=this.tryEntries[On];if(Un.tryLoc===Xr){var eo=Un.completion;if(eo.type==="throw"){var ro=eo.arg;jn(Un)}return ro}}throw new Error("illegal catch attempt")},delegateYield:function(Xr,On,Un){return this.delegate={iterator:xn(Xr),resultName:On,nextLoc:Un},this.method==="next"&&(this.arg=void 0),br}},F}S.exports=V,S.exports.__esModule=!0,S.exports.default=S.exports}),rl=O1(),ar=rl;try{regeneratorRuntime=rl}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=rl:Function("r","regeneratorRuntime = r")(rl)}Vr({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991});var Xm=9007199254740991,_l=Object.assign,Vo=Object.defineProperty,wl=he([].concat),Zm=!_l||c(function(){if(Ne&&_l({b:1},_l(Vo({},"a",{enumerable:!0,get:function(){Vo(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var S={},x={},V=Symbol(),F="abcdefghijklmnopqrst";return S[V]=7,F.split("").forEach(function(A){x[A]=A}),_l({},S)[V]!=7||gs(_l({},x)).join("")!=F})?function(x,V){for(var F=$n(x),A=arguments.length,oe=1,xe=Hi.f,z=ze.f;A>oe;)for(var Ve,jt=Lt(arguments[oe++]),lr=xe?wl(gs(jt),xe(jt)):gs(jt),fr=lr.length,Sr=0;fr>Sr;)Ve=lr[Sr++],Ne&&!Y(z,jt,Ve)||(F[Ve]=jt[Ve]);return F}:_l;Vr({target:"Object",stat:!0,arity:2,forced:Object.assign!==Zm},{assign:Zm});var Tn=nr.Object.assign;function xl(S,x){var V={};for(var F in S)Object.prototype.hasOwnProperty.call(S,F)&&x.indexOf(F)<0&&(V[F]=S[F]);if(S!=null&&typeof Object.getOwnPropertySymbols=="function"){var A=0;for(F=Object.getOwnPropertySymbols(S);A<F.length;A++)x.indexOf(F[A])<0&&Object.prototype.propertyIsEnumerable.call(S,F[A])&&(V[F[A]]=S[F[A]])}return V}function Mr(S,x,V,F){return new(V||(V=Promise))(function(A,oe){function xe(jt){try{Ve(F.next(jt))}catch(lr){oe(lr)}}function z(jt){try{Ve(F.throw(jt))}catch(lr){oe(lr)}}function Ve(jt){jt.done?A(jt.value):function(fr){return fr instanceof V?fr:new V(function(Sr){Sr(fr)})}(jt.value).then(xe,z)}Ve((F=F.apply(S,x||[])).next())})}var Gh=c(function(){if(typeof ArrayBuffer=="function"){var S=new ArrayBuffer(8);Object.isExtensible(S)&&Object.defineProperty(S,"a",{value:8})}}),Wo=Object.isExtensible,eg=c(function(){Wo(1)})||Gh?function(x){return!!Fe(x)&&(!Gh||pe(x)!="ArrayBuffer")&&(!Wo||Wo(x))}:Wo,tg=!c(function(){return Object.isExtensible(Object.preventExtensions({}))}),rg=o(function(S){var x=ua.f,V=!1,F=so("meta"),A=0,oe=function(z){x(z,F,{value:{objectID:"O"+A++,weakData:{}}})},xe=S.exports={enable:function(){xe.enable=function(){},V=!0;var z=Vi.f,Ve=he([].splice),jt={};jt[F]=1,z(jt).length&&(Vi.f=function(lr){for(var fr=z(lr),Sr=0,br=fr.length;Sr<br;Sr++)if(fr[Sr]===F){Ve(fr,Sr,1);break}return fr},Vr({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:gu.f}))},fastKey:function(z,Ve){if(!Fe(z))return typeof z=="symbol"?z:(typeof z=="string"?"S":"P")+z;if(!Lr(z,F)){if(!eg(z))return"F";if(!Ve)return"E";oe(z)}return z[F].objectID},getWeakData:function(z,Ve){if(!Lr(z,F)){if(!eg(z))return!0;if(!Ve)return!1;oe(z)}return z[F].weakData},onFreeze:function(z){return tg&&V&&eg(z)&&!Lr(z,F)&&oe(z),z}};oi[F]=!0}),N1=ua.f,R1=bs.forEach,ng=Pa.set,Ma=Pa.getterFor,Qh=function(S,x,V){var F,A=S.indexOf("Map")!==-1,oe=S.indexOf("Weak")!==-1,xe=A?"set":"add",z=d[S],Ve=z&&z.prototype,jt={};if(Ne&&ae(z)&&(oe||Ve.forEach&&!c(function(){new z().entries().next()}))){var lr=(F=x(function(Sr,br){ng(Bu(Sr,lr),{type:S,collection:new z}),br!=null&&lo(br,Sr[xe],{that:Sr,AS_ENTRIES:A})})).prototype,fr=Ma(S);R1(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(Sr){var br=Sr=="add"||Sr=="set";!(Sr in Ve)||oe&&Sr=="clear"||Jo(lr,Sr,function(Er,Dr){var $r=fr(this).collection;if(!br&&oe&&!Fe(Er))return Sr=="get"&&void 0;var vn=$r[Sr](Er===0?0:Er,Dr);return br?this:vn})}),oe||N1(lr,"size",{configurable:!0,get:function(){return fr(this).collection.size}})}else F=V.getConstructor(x,S,A,xe),rg.enable();return Ls(F,S,!1,!0),jt[S]=F,Vr({global:!0,forced:!0},jt),oe||V.setStrong(F,S,A),F},Qd=function(S,x,V){for(var F in x)V&&V.unsafe&&S[F]?S[F]=x[F]:vs(S,F,x[F],V);return S},ks=ua.f,Ps=rg.fastKey,Sn=Pa.set,Jd=Pa.getterFor,od={getConstructor:function(S,x,V,F){var A=S(function(jt,lr){Bu(jt,oe),Sn(jt,{type:x,index:Ea(null),first:void 0,last:void 0,size:0}),Ne||(jt.size=0),Dt(lr)||lo(lr,jt[F],{that:jt,AS_ENTRIES:V})}),oe=A.prototype,xe=Jd(x),z=function(jt,lr,fr){var Sr,br,Er=xe(jt),Dr=Ve(jt,lr);return Dr?Dr.value=fr:(Er.last=Dr={index:br=Ps(lr,!0),key:lr,value:fr,previous:Sr=Er.last,next:void 0,removed:!1},Er.first||(Er.first=Dr),Sr&&(Sr.next=Dr),Ne?Er.size++:jt.size++,br!=="F"&&(Er.index[br]=Dr)),jt},Ve=function(jt,lr){var fr,Sr=xe(jt),br=Ps(lr);if(br!=="F")return Sr.index[br];for(fr=Sr.first;fr;fr=fr.next)if(fr.key==lr)return fr};return Qd(oe,{clear:function(){for(var lr=xe(this),fr=lr.index,Sr=lr.first;Sr;)Sr.removed=!0,Sr.previous&&(Sr.previous=Sr.previous.next=void 0),delete fr[Sr.index],Sr=Sr.next;lr.first=lr.last=void 0,Ne?lr.size=0:this.size=0},delete:function(jt){var lr=this,fr=xe(lr),Sr=Ve(lr,jt);if(Sr){var br=Sr.next,Er=Sr.previous;delete fr.index[Sr.index],Sr.removed=!0,Er&&(Er.next=br),br&&(br.previous=Er),fr.first==Sr&&(fr.first=br),fr.last==Sr&&(fr.last=Er),Ne?fr.size--:lr.size--}return!!Sr},forEach:function(lr){for(var fr,Sr=xe(this),br=$o(lr,arguments.length>1?arguments[1]:void 0);fr=fr?fr.next:Sr.first;)for(br(fr.value,fr.key,this);fr&&fr.removed;)fr=fr.previous},has:function(lr){return!!Ve(this,lr)}}),Qd(oe,V?{get:function(lr){var fr=Ve(this,lr);return fr&&fr.value},set:function(lr,fr){return z(this,lr===0?0:lr,fr)}}:{add:function(lr){return z(this,lr=lr===0?0:lr,lr)}}),Ne&&ks(oe,"size",{get:function(){return xe(this).size}}),A},setStrong:function(S,x,V){var F=x+" Iterator",A=Jd(x),oe=Jd(F);Iu(S,x,function(xe,z){Sn(this,{type:F,target:xe,state:A(xe),kind:z,last:void 0})},function(){for(var xe=oe(this),z=xe.kind,Ve=xe.last;Ve&&Ve.removed;)Ve=Ve.previous;return xe.target&&(xe.last=Ve=Ve?Ve.next:xe.state.first)?z=="keys"?{value:Ve.key,done:!1}:z=="values"?{value:Ve.value,done:!1}:{value:[Ve.key,Ve.value],done:!1}:(xe.target=void 0,{value:void 0,done:!0})},V?"entries":"values",!V,!0),vm(x)}};Qh("Map",function(S){return function(){return S(this,arguments.length?arguments[0]:void 0)}},od);var og=nr.Map,Jh=[].push,ag=function(x){var V,F,A,oe,xe=arguments.length,z=xe>1?arguments[1]:void 0;return Zc(this),(V=z!==void 0)&&Or(z),Dt(x)?new this:(F=[],V?(A=0,oe=$o(z,xe>2?arguments[2]:void 0),lo(x,function(Ve){Y(Jh,F,oe(Ve,A++))})):lo(x,Jh,{that:F}),new this(F))};Vr({target:"Map",stat:!0,forced:!0},{from:ag});var Yh=function(){return new this(hs(arguments))};Vr({target:"Map",stat:!0,forced:!0},{of:Yh});var Xh=function(){for(var x,V=Vn(this),F=Or(V.delete),A=!0,oe=0,xe=arguments.length;oe<xe;oe++)x=Y(F,V,arguments[oe]),A=A&&x;return!!A};Vr({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:Xh}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function(x,V){var F,A,oe=Vn(this),xe=Or(oe.get),z=Or(oe.has),Ve=Or(oe.set);return Y(z,oe,x)?(F=Y(xe,oe,x),"update"in V&&(F=V.update(F,x,oe),Y(Ve,oe,x,F)),F):(A=V.insert(x,oe),Y(Ve,oe,x,A),A)}});var _i=Gi;Vr({target:"Map",proto:!0,real:!0,forced:!0},{every:function(x){var V=Vn(this),F=_i(V),A=$o(x,arguments.length>1?arguments[1]:void 0);return!lo(F,function(oe,xe,z){if(!A(xe,oe,V))return z()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(x){var V=Vn(this),F=_i(V),A=$o(x,arguments.length>1?arguments[1]:void 0),oe=new(Ms(V,Ue("Map"))),xe=Or(oe.set);return lo(F,function(z,Ve){A(Ve,z,V)&&Y(xe,oe,z,Ve)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),oe}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{find:function(x){var V=Vn(this),F=_i(V),A=$o(x,arguments.length>1?arguments[1]:void 0);return lo(F,function(oe,xe,z){if(A(xe,oe,V))return z(xe)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(x){var V=Vn(this),F=_i(V),A=$o(x,arguments.length>1?arguments[1]:void 0);return lo(F,function(oe,xe,z){if(A(xe,oe,V))return z(oe)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var B1=he([].push);Vr({target:"Map",stat:!0,forced:!0},{groupBy:function(x,V){Or(V);var F=Gi(x),A=new this,oe=Or(A.has),xe=Or(A.get),z=Or(A.set);return lo(F,function(Ve){var jt=V(Ve);Y(oe,A,jt)?B1(Y(xe,A,jt),Ve):Y(z,A,jt,[Ve])},{IS_ITERATOR:!0}),A}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(x){return lo(_i(Vn(this)),function(V,F,A){if((oe=F)===(xe=x)||oe!=oe&&xe!=xe)return A();var oe,xe},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Vr({target:"Map",stat:!0,forced:!0},{keyBy:function(x,V){var F=new this;Or(V);var A=Or(F.set);return lo(x,function(oe){Y(A,F,V(oe),oe)}),F}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(x){return lo(_i(Vn(this)),function(V,F,A){if(F===x)return A(V)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(x){var V=Vn(this),F=_i(V),A=$o(x,arguments.length>1?arguments[1]:void 0),oe=new(Ms(V,Ue("Map"))),xe=Or(oe.set);return lo(F,function(z,Ve){Y(xe,oe,A(Ve,z,V),Ve)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),oe}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(x){var V=Vn(this),F=_i(V),A=$o(x,arguments.length>1?arguments[1]:void 0),oe=new(Ms(V,Ue("Map"))),xe=Or(oe.set);return lo(F,function(z,Ve){Y(xe,oe,z,A(Ve,z,V))},{AS_ENTRIES:!0,IS_ITERATOR:!0}),oe}}),Vr({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(x){for(var V=Vn(this),F=Or(V.set),A=arguments.length,oe=0;oe<A;)lo(arguments[oe++],F,{that:V,AS_ENTRIES:!0});return V}});var Zh=TypeError;Vr({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(x){var V=Vn(this),F=_i(V),A=arguments.length<2,oe=A?void 0:arguments[1];if(Or(x),lo(F,function(xe,z){A?(A=!1,oe=z):oe=x(oe,z,xe,V)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),A)throw Zh("Reduce of empty map with no initial value");return oe}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{some:function(x){var V=Vn(this),F=_i(V),A=$o(x,arguments.length>1?arguments[1]:void 0);return lo(F,function(oe,xe,z){if(A(xe,oe,V))return z()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var F1=TypeError;Vr({target:"Map",proto:!0,real:!0,forced:!0},{update:function(x,V){var F=Vn(this),A=Or(F.get),oe=Or(F.has),xe=Or(F.set),z=arguments.length;Or(V);var Ve=Y(oe,F,x);if(!Ve&&z<3)throw F1("Updating absent value");var jt=Ve?Y(A,F,x):Or(z>2?arguments[2]:void 0)(x,F);return Y(xe,F,x,V(jt,x,F)),F}});var ev=TypeError,sg=function(x,V){var F,A=Vn(this),oe=Or(A.get),xe=Or(A.has),z=Or(A.set),Ve=arguments.length>2?arguments[2]:void 0;if(!ae(V)&&!ae(Ve))throw ev("At least one callback required");return Y(xe,A,x)?(F=Y(oe,A,x),ae(V)&&(F=V(F),Y(z,A,x,F))):ae(Ve)&&(F=Ve(),Y(z,A,x,F)),F};Vr({target:"Map",proto:!0,real:!0,forced:!0},{upsert:sg}),Vr({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:sg});var nl=og,tv=Date,L1=he(tv.prototype.getTime);Vr({target:"Date",stat:!0},{now:function(){return L1(new tv)}});var ts=nr.Date.now,wi=Uo("Array").concat,ig=Array.prototype,Vs=function(S){var x=S.concat;return S===ig||rr(ig,S)&&x===ig.concat?wi:x},$1=/MSIE .\./.test(or),j1=d.Function,cg=function(S){return $1?function(x,V){var F=ym(arguments.length,1)>2,A=ae(x)?x:j1(x),oe=F?hs(arguments,2):void 0;return S(F?function(){T(A,this,oe)}:A,V)}:S},tc={setTimeout:cg(d.setTimeout),setInterval:cg(d.setInterval)},lg=tc.setInterval;Vr({global:!0,bind:!0,forced:d.setInterval!==lg},{setInterval:lg});var rv=tc.setTimeout;Vr({global:!0,bind:!0,forced:d.setTimeout!==rv},{setTimeout:rv});var sa=nr.setTimeout;nr.JSON||(nr.JSON={stringify:JSON.stringify});var D1=function(x,V,F){return T(nr.JSON.stringify,null,arguments)},mo=D1,nv=bs.map,ov=Ui("map");Vr({target:"Array",proto:!0,forced:!ov},{map:function(x){return nv(this,x,arguments.length>1?arguments[1]:void 0)}});var av=Uo("Array").map,Yd=Array.prototype,ho=function(S){var x=S.map;return S===Yd||rr(Yd,S)&&x===Yd.map?av:x},ug=o(function(S){var x=Object.prototype.hasOwnProperty,V="~";function F(){}function A(Ve,jt,lr){this.fn=Ve,this.context=jt,this.once=lr||!1}function oe(Ve,jt,lr,fr,Sr){if(typeof lr!="function")throw new TypeError("The listener must be a function");var br=new A(lr,fr||Ve,Sr),Er=V?V+jt:jt;return Ve._events[Er]?Ve._events[Er].fn?Ve._events[Er]=[Ve._events[Er],br]:Ve._events[Er].push(br):(Ve._events[Er]=br,Ve._eventsCount++),Ve}function xe(Ve,jt){--Ve._eventsCount==0?Ve._events=new F:delete Ve._events[jt]}function z(){this._events=new F,this._eventsCount=0}Object.create&&(F.prototype=Object.create(null),new F().__proto__||(V=!1)),z.prototype.eventNames=function(){var jt,lr,fr=[];if(this._eventsCount===0)return fr;for(lr in jt=this._events)x.call(jt,lr)&&fr.push(V?lr.slice(1):lr);return Object.getOwnPropertySymbols?fr.concat(Object.getOwnPropertySymbols(jt)):fr},z.prototype.listeners=function(jt){var lr=V?V+jt:jt,fr=this._events[lr];if(!fr)return[];if(fr.fn)return[fr.fn];for(var Sr=0,br=fr.length,Er=new Array(br);Sr<br;Sr++)Er[Sr]=fr[Sr].fn;return Er},z.prototype.listenerCount=function(jt){var lr=V?V+jt:jt,fr=this._events[lr];return fr?fr.fn?1:fr.length:0},z.prototype.emit=function(jt,lr,fr,Sr,br,Er){var Dr=V?V+jt:jt;if(!this._events[Dr])return!1;var $r,vn,Yr=this._events[Dr],wn=arguments.length;if(Yr.fn){switch(Yr.once&&this.removeListener(jt,Yr.fn,void 0,!0),wn){case 1:return Yr.fn.call(Yr.context),!0;case 2:return Yr.fn.call(Yr.context,lr),!0;case 3:return Yr.fn.call(Yr.context,lr,fr),!0;case 4:return Yr.fn.call(Yr.context,lr,fr,Sr),!0;case 5:return Yr.fn.call(Yr.context,lr,fr,Sr,br),!0;case 6:return Yr.fn.call(Yr.context,lr,fr,Sr,br,Er),!0}for(vn=1,$r=new Array(wn-1);vn<wn;vn++)$r[vn-1]=arguments[vn];Yr.fn.apply(Yr.context,$r)}else{var Zr,Qn=Yr.length;for(vn=0;vn<Qn;vn++)switch(Yr[vn].once&&this.removeListener(jt,Yr[vn].fn,void 0,!0),wn){case 1:Yr[vn].fn.call(Yr[vn].context);break;case 2:Yr[vn].fn.call(Yr[vn].context,lr);break;case 3:Yr[vn].fn.call(Yr[vn].context,lr,fr);break;case 4:Yr[vn].fn.call(Yr[vn].context,lr,fr,Sr);break;default:if(!$r)for(Zr=1,$r=new Array(wn-1);Zr<wn;Zr++)$r[Zr-1]=arguments[Zr];Yr[vn].fn.apply(Yr[vn].context,$r)}}return!0},z.prototype.on=function(jt,lr,fr){return oe(this,jt,lr,fr,!1)},z.prototype.once=function(jt,lr,fr){return oe(this,jt,lr,fr,!0)},z.prototype.removeListener=function(jt,lr,fr,Sr){var br=V?V+jt:jt;if(!this._events[br])return this;if(!lr)return xe(this,br),this;var Er=this._events[br];if(Er.fn)Er.fn!==lr||Sr&&!Er.once||fr&&Er.context!==fr||xe(this,br);else{for(var Dr=0,$r=[],vn=Er.length;Dr<vn;Dr++)(Er[Dr].fn!==lr||Sr&&!Er[Dr].once||fr&&Er[Dr].context!==fr)&&$r.push(Er[Dr]);$r.length?this._events[br]=$r.length===1?$r[0]:$r:xe(this,br)}return this},z.prototype.removeAllListeners=function(jt){var lr;return jt?(lr=V?V+jt:jt,this._events[lr]&&xe(this,lr)):(this._events=new F,this._eventsCount=0),this},z.prototype.off=z.prototype.removeListener,z.prototype.addListener=z.prototype.on,z.prefixed=V,z.EventEmitter=z,S.exports=z}),U1=Il;function Il(S){S=S||{},this.ms=S.min||100,this.max=S.max||1e4,this.factor=S.factor||2,this.jitter=S.jitter>0&&S.jitter<=1?S.jitter:0,this.attempts=0}Il.prototype.duration=function(){var S=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var x=Math.random(),V=Math.floor(x*this.jitter*S);S=1&Math.floor(10*x)?S+V:S-V}return 0|Math.min(S,this.max)},Il.prototype.reset=function(){this.attempts=0},Il.prototype.setMin=function(S){this.ms=S},Il.prototype.setMax=function(S){this.max=S},Il.prototype.setJitter=function(S){this.jitter=S};var Xd=typeof e=="object"&&e&&e.Object===Object&&e,To=typeof self=="object"&&self&&self.Object===Object&&self,Hs=Xd||To||Function("return this")(),xi=Hs.Symbol,ol=Object.prototype,sv=ol.hasOwnProperty,q1=ol.toString,As=xi?xi.toStringTag:void 0,Qs=function(x){var V=sv.call(x,As),F=x[As];try{x[As]=void 0;var A=!0}catch{}var oe=q1.call(x);return A&&(V?x[As]=F:delete x[As]),oe},iv=Object.prototype.toString,V1=function(x){return iv.call(x)},cv=xi?xi.toStringTag:void 0,Js=function(x){return x==null?x===void 0?"[object Undefined]":"[object Null]":cv&&cv in Object(x)?Qs(x):V1(x)},fi=function(x){var V=typeof x;return x!=null&&(V=="object"||V=="function")},Zd=function(x){if(!fi(x))return!1;var V=Js(x);return V=="[object Function]"||V=="[object GeneratorFunction]"||V=="[object AsyncFunction]"||V=="[object Proxy]"},lv={deviceId:"",timeout:8e3},uv={account:"",appkey:"",token:"",debugLevel:"off",needReconnect:!0,reconnectionAttempts:Xm,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},yc=nu.includes,mi=c(function(){return!Array(1).includes()});Vr({target:"Array",proto:!0,forced:mi},{includes:function(x){return yc(this,x,arguments.length>1?arguments[1]:void 0)}});var ep=Uo("Array").includes,dv=to("match"),H1=TypeError,pv=function(S){if(function(x){var V;return Fe(x)&&((V=x[dv])!==void 0?!!V:pe(x)=="RegExp")}(S))throw H1("The method doesn't accept regular expressions");return S},z1=to("match"),K1=he("".indexOf);Vr({target:"String",proto:!0,forced:!function(S){var x=/./;try{"/./"[S](x)}catch{try{return x[z1]=!1,"/./"[S](x)}catch{}}return!1}("includes")},{includes:function(x){return!!~K1(Oa(pr(this)),Oa(pv(x)),arguments.length>1?arguments[1]:void 0)}});var W1=Uo("String").includes,dg=Array.prototype,pg=String.prototype,gi=function(S){var x=S.includes;return S===dg||rr(dg,S)&&x===dg.includes?ep:typeof S=="string"||S===pg||rr(pg,S)&&x===pg.includes?W1:x},G1=bs.findIndex,Q1="findIndex",fv=!0;Q1 in[]&&Array(1).findIndex(function(){fv=!1}),Vr({target:"Array",proto:!0,forced:fv},{findIndex:function(x){return G1(this,x,arguments.length>1?arguments[1]:void 0)}});var fg=Uo("Array").findIndex,ad=Array.prototype,bc=function(S){var x=S.findIndex;return S===ad||rr(ad,S)&&x===ad.findIndex?fg:x},J1=o(function(S){function x(V){var F;return S.exports=x=Rs?Oo(F=Ds).call(F):function(oe){return oe.__proto__||Ds(oe)},S.exports.__esModule=!0,S.exports.default=S.exports,x(V)}S.exports=x,S.exports.__esModule=!0,S.exports.default=S.exports}),Y1=nu.indexOf,tp=he([].indexOf),mv=!!tp&&1/tp([1],1,-0)<0,mg=Us("indexOf");Vr({target:"Array",proto:!0,forced:mv||!mg},{indexOf:function(x){var V=arguments.length>1?arguments[1]:void 0;return mv?tp(this,x,V)||0:Y1(this,x,V)}});var X1=Uo("Array").indexOf,gg=Array.prototype,pa=function(S){var x=S.indexOf;return S===gg||rr(gg,S)&&x===gg.indexOf?X1:x},hg=o(function(S){S.exports=function(V){var F;return pa(F=Function.toString.call(V)).call(F,"[native code]")!==-1},S.exports.__esModule=!0,S.exports.default=S.exports}),vg=Ue("Reflect","construct"),Z1=Object.prototype,gv=[].push,yg=c(function(){function S(){}return!(vg(function(){},[],S)instanceof S)}),bg=!c(function(){vg(function(){})}),Ii=yg||bg;Vr({target:"Reflect",stat:!0,forced:Ii,sham:Ii},{construct:function(x,V){Zc(x),Vn(V);var F=arguments.length<3?x:Zc(arguments[2]);if(bg&&!yg)return vg(x,V,F);if(x==F){switch(V.length){case 0:return new x;case 1:return new x(V[0]);case 2:return new x(V[0],V[1]);case 3:return new x(V[0],V[1],V[2]);case 4:return new x(V[0],V[1],V[2],V[3])}var A=[null];return T(gv,A,V),new(T(iu,x,A))}var oe=F.prototype,xe=Ea(Fe(oe)?oe:Z1),z=T(x,xe,V);return Fe(z)?z:xe}});var rc=nr.Reflect.construct,eT=o(function(S){S.exports=function(){if(typeof Reflect>"u"||!rc||rc.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(rc(Boolean,[],function(){})),!0}catch{return!1}},S.exports.__esModule=!0,S.exports.default=S.exports}),tT=o(function(S){function x(V,F,A){var oe;return eT()?(S.exports=x=Oo(oe=rc).call(oe),S.exports.__esModule=!0,S.exports.default=S.exports):(S.exports=x=function(z,Ve,jt){var lr=[null];lr.push.apply(lr,Ve);var fr=new(Oo(Function).apply(z,lr));return jt&&lu(fr,jt.prototype),fr},S.exports.__esModule=!0,S.exports.default=S.exports),x.apply(null,arguments)}S.exports=x,S.exports.__esModule=!0,S.exports.default=S.exports}),nc=o(function(S){function x(V){var F=typeof nl=="function"?new nl:void 0;return S.exports=x=function(oe){if(oe===null||!hg(oe))return oe;if(typeof oe!="function")throw new TypeError("Super expression must either be null or a function");if(F!==void 0){if(F.has(oe))return F.get(oe);F.set(oe,xe)}function xe(){return tT(oe,arguments,J1(this).constructor)}return xe.prototype=Ja(oe.prototype,{constructor:{value:xe,enumerable:!1,writable:!0,configurable:!0}}),lu(xe,oe)},S.exports.__esModule=!0,S.exports.default=S.exports,x(V)}S.exports=x,S.exports.__esModule=!0,S.exports.default=S.exports}),yo=function(S){function x(V,F,A){var oe;return F===void 0&&(F={}),A===void 0&&(A=400),(oe=S.call(this,V)||this).data=F,oe.code=A,oe.name="customError",oe}return Ro(x,S),x}(n(nc)(Error)),al=function(S){function x(V,F,A){var oe;return F===void 0&&(F={}),(oe=S.call(this,V,F,414)||this).code=414,oe.name="validateError",oe.rules=A,oe}return Ro(x,S),x}(yo),rp={200:null,406:null,808:null,810:null,201:"The client version is incorrect. You need to upgrade the SDK",302:"The user name or password is incorrect. Please check whether the appkey and token are valid and whether the account and token match",403:"Illegal operation or no permission",404:"Target object does not exist",405:"Parameter length too long",408:"Client request timed out",414:"Request parameter error",415:"Service unavailable",416:"Frequency control",417:"Repeat operation",422:"Account disabled",500:"Server internal error",503:"Server busy",508:"Expiration date",509:"Invalid",7101:"Be pulled black",700:"Partial failure of batch operation",801:"The number of people in the team has reached the upper limit",802:"No permission",803:"The team does not exist or has not changed",804:"The user is not in the team",805:"Team type mismatch",806:"The number of teams created has reached the limit",807:"Team member not valid",809:"Already in the team",811:"The number of accounts in the forced push list exceeds the limit",812:"The team is muted",813:"Due to the limited number of team, some pull people successfully",814:"Disable team message read service",815:"Maximum number of team administrators",816:"Batch operation partial failure",997:"The packet has expired",998:"Deserialize packet error",999:"Serialize packet error",9102:"Channel failure",9103:"This call has been answered / rejected at another end",10201:"Signaling: target NIM client is offline",10202:"Signaling: push is unreachable",10404:"Signaling: channel not exists",10405:"Signaling: channel already exists",10406:"Signaling: member of channel not exists",10407:"Signaling: member of channel already exists",10408:"Signaling: the invitation request does not exist or has expired",10409:"Signaling: the invitation request has been rejected",10410:"Signaling: the invitation request has been accepted",10414:"Signaling: request parameter error",10417:"Signaling: uid conflict",10419:"Signaling: the number of members of channel exceed the limit",10420:"Signaling: member is already in the channel on other client",10700:"Signaling: phased success",13002:"Abnormal chatroom status",13003:"In the blacklist",13004:"In the mute list",13006:"All members are muted, and only the administrator can speak"},Tg=function(S){function x(V,F,A,oe,xe){var z;return A===void 0&&(A=""),oe===void 0&&(oe=new Date().getTime()),xe===void 0&&(xe={}),A=A||rp[V],(z=S.call(this,A,xe,V)||this).name="cmdError",z.cmd=F,z.timetag=oe,z}return Ro(x,S),x}(yo),El=function(S){function x(V,F,A){var oe;return(oe=S.call(this,V,{},412)||this).code=412,oe.name="formatError",oe.key=F,oe.reason=A,oe}return Ro(x,S),x}(yo),Tc=function(S){function x(V,F,A,oe,xe){var z;return(z=S.call(this,V,{file:xe},400)||this).name="uploadError",z.rawError=F,z.curProvider=A||1,z.mixStorePolicy=oe,z}return Ro(x,S),x}(yo),sl=["error","warn","log","debug"],sd=function(){},np=["off","error","warn","log","debug"],hv=function(){function S(V,F){this.name=F,this.strategies={debug:console.log,log:console.log,warn:console.warn,error:console.error},this.debug=sd,this.log=sd,this.warn=sd,this.error=sd,this.name=F,S.instancesName.push(F),gi(np).call(np,V)||(V="off"),this.setLogFunc(V)}var x=S.prototype;return x.setLogFunc=function(F){var A=this,oe=bc(sl).call(sl,function(xe){return xe===F});In(sl).call(sl,function(xe,z){z<=oe&&(A[xe]=function(){var Ve=Co(Array.prototype).call(arguments),jt=this.formatArgs(Ve,xe);this.strategies[xe](jt)})})},x.formatArgs=function(F,A){var oe=new Date,xe=oe.getMonth()+1+"-"+oe.getDate()+" "+oe.getHours()+":"+oe.getMinutes()+":"+oe.getSeconds()+":"+oe.getMilliseconds();return"[NIM "+A+" "+this.name+" "+xe+"] "+ho(F).call(F,function(z){return z instanceof yo?z.name+", "+z.code+", "+z.message:z instanceof Error?z&&z.message?z.message:z:typeof z=="object"?mo(z):z}).join(" ")},S}();hv.instancesName=[],Vr({global:!0},{globalThis:d});var rT=c(function(){gs(1)});Vr({target:"Object",stat:!0,forced:rT},{keys:function(x){return gs($n(x))}});var na=nr.Object.keys,Sg=bs.filter,ls=Ui("filter");Vr({target:"Array",proto:!0,forced:!ls},{filter:function(x){return Sg(this,x,arguments.length>1?arguments[1]:void 0)}});var nT=Uo("Array").filter,Ho=Array.prototype,Ys=function(S){var x=S.filter;return S===Ho||rr(Ho,S)&&x===Ho.filter?nT:x},vv=o(function(S,x){S.exports=function(){function V(jt,lr){if(!(jt instanceof lr))throw new TypeError("Cannot call a class as a function")}function F(jt,lr){for(var fr=0;fr<lr.length;fr++){var Sr=lr[fr];Sr.enumerable=Sr.enumerable||!1,Sr.configurable=!0,"value"in Sr&&(Sr.writable=!0),Wi(jt,Sr.key,Sr)}}function A(jt,lr,fr){return lr&&F(jt.prototype,lr),fr&&F(jt,fr),Wi(jt,"prototype",{writable:!1}),jt}var oe={reportUrl:"https://statistic.live.126.net/statics/report/common/form",maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0},xe="https://statistic.live.126.net/dispatcher/req",z=function(){},Ve=function(){function jt(lr){V(this,jt),this.enable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=oe,this.msgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=ts(),this.timer=null,this.setConfig(lr),this.reportConfig.autoStart&&this.initUploadConfig()}return A(jt,[{key:"setConfig",value:function(fr){this.reportConfig=Tn({},this.reportConfig,fr)}},{key:"reportImmediately",value:function(fr,Sr){var br=this;this.reportConfig.request(fr,Tn({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},Sr)).catch(function(Er){var Dr,$r;($r=(Dr=br.reportConfig)===null||Dr===void 0?void 0:Dr.logger)===null||$r===void 0||$r.warn("Reporter immediately upload failed",Er)})}},{key:"report",value:function(fr,Sr){var br=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(fr){var Er=ts();br?this.lowPriorityMsgList.push({module:fr,msg:Sr,createTime:Er}):this.msgList.push({module:fr,msg:Sr,createTime:Er}),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function(fr,Sr){if(fr&&!this.traceMsgCache[fr]){var br=Tn(Tn({start_time:ts()},Sr),{extension:[]});this.traceMsgCache[fr]=br}}},{key:"reportTraceUpdate",value:function(fr){}},{key:"reportTraceUpdateV2",value:function(fr,Sr){if(this.traceMsgCache[fr]){var br=this.traceMsgCache[fr].extension.length,Er=new Date().getTime();Sr.duration=br===0?Er-this.traceMsgCache[fr].start_time:Er-this.traceMsgCache[fr].extension[br-1].end_time,this.traceMsgCache[fr].extension.push(Tn({end_time:Er},Sr))}}},{key:"reportTraceEnd",value:function(fr){var Sr,br=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.traceMsgCache[fr]&&(fr!=="nos"||br===!1?(typeof br=="boolean"?this.traceMsgCache[fr].succeed=!!br:this.traceMsgCache[fr].state=br,this.traceMsgCache[fr].duration=ts()-this.traceMsgCache[fr].start_time,In(Sr=this.traceMsgCache[fr].extension).call(Sr,function(Er){delete Er.end_time}),this.report(fr,this.traceMsgCache[fr]),this.traceMsgCache[fr]=null):this.traceMsgCache[fr]=null)}},{key:"reportTraceCancel",value:function(fr){this.traceMsgCache[fr]=null}},{key:"pause",value:function(){this.enable=!1}},{key:"restore",value:function(){this.enable=!0,this.initConfigLoaded||this.initUploadConfig()}},{key:"destroy",value:function(){var fr,Sr=this;In(fr=na(this.traceMsgCache)).call(fr,function(br){Sr.reportTraceEnd(br,1)}),this.timer!==null&&clearTimeout(this.timer),this.setConfig=z,this.report=z,this.reportTraceStart=z,this.reportTraceUpdate=z,this.reportTraceEnd=z,this.pause=z,this.restore=z,this.destroy=z,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.reportConfig={},this.isDestroyed=!0}},{key:"initUploadConfig",value:function(){var fr,Sr,br=this;if(!this.loading){this.loading=!0;var Er=this.reportConfig.common||{};try{this.reportConfig.request(xe,{method:"GET",dataType:"json",params:{deviceId:Er.dev_id,sdkVer:Er.sdk_ver,platform:Er.platform,appkey:Er.app_key},timeout:this.reportConfig.timeout}).then(function(Dr){var $r,vn;if(!br.isDestroyed){if(Dr.status===200&&Dr.data&&Dr.data.code===200){var Yr=Dr.data.data||{};br.reportConfig.maxSize=Yr.maxSize>1e3?1e3:Yr.maxSize,br.reportConfig.maxInterval=Yr.maxInterval>1e4?1e4:Yr.maxInterval,br.reportConfig.maxInterval=Yr.maxInterval<10?10:Yr.maxInterval,br.reportConfig.minInterval=Yr.minInterval<2?2:Yr.minInterval,br.reportConfig.maxDelay=Yr.maxDelay||300,br.reportConfig.maxInterval=1e3*br.reportConfig.maxInterval,br.reportConfig.minInterval=1e3*br.reportConfig.minInterval,br.reportConfig.maxDelay=1e3*br.reportConfig.maxDelay,br.enable=!0,br.initConfigLoaded=!0,br.loading=!1,br.reportHeartBeat()}(vn=($r=br.reportConfig)===null||$r===void 0?void 0:$r.logger)===null||vn===void 0||vn.log("Get reporter upload config success")}}).catch(function(Dr){var $r,vn;br.loading=!1,(vn=($r=br.reportConfig)===null||$r===void 0?void 0:$r.logger)===null||vn===void 0||vn.error("Get reporter upload config failed",Dr)})}catch(Dr){this.loading=!1,(Sr=(fr=this.reportConfig)===null||fr===void 0?void 0:fr.logger)===null||Sr===void 0||Sr.error("Exec reporter request failed",Dr)}}}},{key:"reportHeartBeat",value:function(){var fr=this;this.isDestroyed||(this.timer=sa(function(){fr.reportHeartBeat()},this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function(){if(!this.isDestroyed){var fr=this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;ts()-this.lastReportTime>=fr&&this.upload()}}},{key:"getUploadMsg",value:function(){var fr,Sr,br,Er,Dr,$r=this,vn={},Yr=ts();this.msgList=Ys(fr=this.msgList).call(fr,function(xn){return Yr-xn.createTime<$r.reportConfig.maxDelay}),this.lowPriorityMsgList=Ys(Sr=this.lowPriorityMsgList).call(Sr,function(xn){return Yr-xn.createTime<$r.reportConfig.maxDelay}),this.cacheMsgList=Ys(br=this.cacheMsgList).call(br,function(xn){return Yr-xn.createTime<$r.reportConfig.maxDelay});var wn=Co(Er=this.msgList).call(Er,0,this.reportConfig.maxSize);if(this.msgList=Co(Dr=this.msgList).call(Dr,wn.length),wn.length<this.reportConfig.maxSize){var Zr,Qn,Dn=this.reportConfig.maxSize-wn.length;wn=Vs(wn).call(wn,Co(Zr=this.lowPriorityMsgList).call(Zr,0,Dn)),this.lowPriorityMsgList=Co(Qn=this.lowPriorityMsgList).call(Qn,Dn)}if(wn.length<this.reportConfig.maxSize){var jo,jn,wr=this.reportConfig.maxSize-wn.length;wn=Vs(wn).call(wn,Co(jo=this.cacheMsgList).call(jo,0,wr)),this.cacheMsgList=Co(jn=this.cacheMsgList).call(jn,wr)}return In(wn).call(wn,function(xn){vn[xn.module]?vn[xn.module].push(xn.msg):vn[xn.module]=[xn.msg]}),{uploadMsgArr:wn,uploadMsg:vn}}},{key:"upload",value:function(){var fr,Sr,br=this;if(this.enable&&!(this.lastReportTime&&ts()-this.lastReportTime<this.reportConfig.minInterval)){var Er=this.getUploadMsg(),Dr=Er.uploadMsgArr,$r=Er.uploadMsg;if(Dr.length){this.lastReportTime=ts();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:$r},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch(function(vn){var Yr,wn,Zr,Qn;br.cacheMsgList=Co(Yr=Vs(wn=br.cacheMsgList).call(wn,Dr)).call(Yr,0,br.reportConfig.cacheMaxSize),(Qn=(Zr=br.reportConfig)===null||Zr===void 0?void 0:Zr.logger)===null||Qn===void 0||Qn.warn("Reporter upload failed",vn)})}catch(vn){(Sr=(fr=this.reportConfig)===null||fr===void 0?void 0:fr.logger)===null||Sr===void 0||Sr.warn("Exec reporter request failed",vn)}clearTimeout(this.timer),this.reportHeartBeat()}}}}]),jt}();return Ve}()}),ta={setLogger:function(x){throw new Error("Function not implemented.")},platform:"",WebSocket:function(){function S(V,F){throw this.CONNECTING=0,this.OPEN=1,this.CLOSING=2,this.CLOSED=3,new Error("Method not implemented.")}var x=S.prototype;return x.close=function(F,A){throw new Error("Method not implemented.")},x.send=function(F){throw new Error("Method not implemented.")},x.onclose=function(F){throw new Error("Method not implemented.")},x.onerror=function(F){throw new Error("Method not implemented.")},x.onmessage=function(F){throw new Error("Method not implemented.")},x.onopen=function(F){throw new Error("Method not implemented.")},S}(),localStorage:{},request:function(x,V){throw new Error("Function not implemented.")},uploadFile:function(x){throw new Error("Function not implemented.")},getSystemInfo:function(){throw new Error("Function not implemented.")}},oT=TypeError,yv=function(S){return function(x,V,F,A){Or(V);var oe=$n(x),xe=Lt(oe),z=Ia(oe),Ve=S?z-1:0,jt=S?-1:1;if(F<2)for(;;){if(Ve in xe){A=xe[Ve],Ve+=jt;break}if(Ve+=jt,S?Ve<0:z<=Ve)throw oT("Reduce of empty array with no initial value")}for(;S?Ve>=0:z>Ve;Ve+=jt)Ve in xe&&(A=V(A,xe[Ve],Ve,oe));return A}},Cg={left:yv(!1),right:yv(!0)}.left,op=Us("reduce");Vr({target:"Array",proto:!0,forced:!op||!Ua&&mr>79&&mr<83},{reduce:function(x){var V=arguments.length;return Cg(this,x,V,V>1?arguments[1]:void 0)}});var bv=Uo("Array").reduce,Pl=Array.prototype,Sc=function(S){var x=S.reduce;return S===Pl||rr(Pl,S)&&x===Pl.reduce?bv:x},Tv=function(x){return x===void 0},id={},Ei={};function qa(S,x){var V,F,A;try{A=JSON.parse(S)}catch(br){throw x.error("Parse command error: ",S),br}var oe=A.sid+"_"+A.cid,xe=A.r;if(gi(V=["4_1","4_2","4_10","4_11"]).call(V,oe)){var z=A.r[1].headerPacket;oe=z.sid+"_"+z.cid,xe=A.r[1].body}var Ve,jt=Ei[oe],lr=id[jt],fr=function(Er,Dr){var $r=rp[Er];return $r===null?null:new Tg(Er,Dr,$r,new Date().getTime())}(A.code,jt),Sr={cmd:jt,raw:A,error:fr,service:lr==null?void 0:lr.service,content:{}};if(Sr.error){if(Sr.error.cmd=jt,Sr.error.callFunc="parseCmd",!(!((F=lr==null?void 0:lr.ignoreErrCodes)===null||F===void 0)&&gi(F).call(F,A.code)))return Sr;x.warn("parseCmd:: ignore error ",Sr.error),Sr.error.ignore=!0}return!jt||!lr?(Sr.notFound=!0,Sr):(lr.response&&In(Ve=lr.response).call(Ve,function(br,Er){var Dr=xe[Er],$r=br.type,vn=br.name,Yr=br.reflectMapper;if(!Tv(Dr))switch($r){case"Property":Sr.content[vn]=Yr?Na(Dr,Yr):Dr;break;case"PropertyArray":Sr.content[vn]=ho(Dr).call(Dr,function(wn){return Yr?Na(wn,Yr):wn});break;case"long":case"Long":case"byte":case"Byte":case"Number":Sr.content[vn]=+Dr;break;default:Sr.content[vn]=Dr}}),Sr)}function rs(S,x){var V={};for(var F in S)x[F]!==void 0&&(V[x[F]]=S[F]);return V}function Na(S,x){var V={};for(var F in S)x[F]!==void 0&&(V[x[F]]=S[F]);return V}function Pi(S){id=Tn(id,S.cmdConfig),Ei=Tn(Ei,S.cmdMap)}function Cc(S){var x;return Sc(x=na(S)).call(x,function(V,F){var A,oe=S[F];return V[F]=Sc(A=na(oe)).call(A,function(xe,z){return xe[oe[z]]=z,xe},{}),V},{})}var Mg=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],kg=["transport not supported","client not handshaken","unauthorized"],ap=["reconnect"],aT=function(S){function x(F,A,oe){var xe;return(xe=S.call(this)||this).url=A,xe.logger=oe,xe.websocket=null,xe.core=F,xe.url=A,xe.status="disconnected",xe.logger=oe,xe.connect(),xe}Ro(x,S);var V=x.prototype;return V.connect=function(){var A=this;this.status!=="connecting"&&this.status!=="connected"?(this.status="connecting",this.core.adapters.request("https://"+this.url+"/socket.io/1/?t="+ts(),{method:"GET",dataType:"text",timeout:8e3}).then(function(oe){var xe=oe.data.split(":"),z=xe[0],Ve=xe[1];return A.sessionId=z,A.closeTimeout=1e3*Ve,A._createWebsocket("wss://"+A.url+"/socket.io/1/websocket/"+z)}).catch(function(oe){A.logger.error("imsocket::handshake fail. ",oe&&oe.message),A.status="disconnected",A.emit("handshakeFailed")})):this.logger.warn("imsocket::socket is connecting or connected",this.status)},V.close=function(){if(this.websocket){this.logger.log("imsocket:: close websocket");try{this.websocket.send(this.encodePacket({type:"disconnect"})),this.websocket.close()}catch(A){this.logger.warn("attempt to close websocket error",A)}this.clean()}},V.clean=function(){this.status="disconnected",this.websocket&&(this.websocket.onmessage=null,this.websocket.onopen=null,this.websocket.onerror=null,this.websocket.onclose=null,this.websocket=null,this.emit("disconnect"))},V.onConnect=function(){this.status="connected",this.resetCloseTimer(),this.emit("connect")},V._createWebsocket=function(A){var oe,xe=this;this.websocket=new ta.WebSocket(A),this.websocket.onmessage=Oo(oe=this.onMessage).call(oe,this),this.websocket.onclose=function(){xe.logger.log("imsocket:: receive websocket onclose event, current status",xe.status),xe.clean()},this.websocket.onerror=function(z){xe.logger.error("imsocket:: onerror",z)}},V.onMessage=function(A){var oe;this.resetCloseTimer();var xe=this.decodePacket(A.data);if(xe)switch(xe.type){case"connect":this.onConnect();break;case"disconnect":this.close();break;case"message":case"json":this.emit("message",xe.data);break;case"event":xe.name&&this.emit(xe.name,xe.args);break;case"error":xe.reason==="unauthorized"?this.emit("connect_failed",xe.reason):this.emit("error",xe.reason);break;case"heartbeat":(oe=this.websocket)===null||oe===void 0||oe.send(this.encodePacket({type:"heartbeat"}));break;default:this.logger.warn("imsocket::no handler type",xe.type)}},V.encodePacket=function(A){var oe,xe,z=A.type,Ve=A.id,jt=Ve===void 0?"":Ve,lr=A.endpoint,fr=lr===void 0?"":lr,Sr=A.ack,br=null;if(!z)return"";switch(z){case"error":oe=A.reason?pa(kg).call(kg,A.reason):"",xe=A.advice?pa(ap).call(ap,A.advice):"",oe===""&&xe===""||(br=oe+(xe!==""?"+"+xe:""));break;case"message":A.data!==""&&(br=A.data);break;case"event":oe={name:A.name},oe=A.args&&A.args.length?{name:A.name,args:A.args}:{name:A.name},br=mo(oe);break;case"json":br=mo(A.data);break;case"connect":A.qs&&(br=A.qs);break;case"ack":br=A.ackId+(A.args&&A.args.length?"+"+mo(A.args):"")}var Er=[pa(Mg).call(Mg,z),jt+(Sr==="data"?"+":""),fr];return br!=null&&Er.push(br),Er.join(":")},V.decodePacket=function(A){if(A)if(A.charAt(0)!=""){var oe=A.match(/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/);if(oe){var xe,z=oe[1],Ve=oe[2],jt=oe[3],lr=oe[4],fr=oe[5],Sr={type:Mg[+z],endpoint:lr};switch(Ve&&(Sr.id=Ve,Sr.ack=!jt||"data"),Sr.type){case"error":xe=fr.split("+"),Sr.reason=kg[+xe[0]]||"";break;case"message":Sr.data=fr||"";break;case"connect":Sr.qs=fr||"";break;case"event":try{var br=JSON.parse(fr);Sr.name=br.name,Sr.args=br.args}catch(Er){this.logger.error("imsocket::parseData::type::event error",Er)}Sr.args=Sr.args||[];break;case"json":try{Sr.data=JSON.parse(fr)}catch(Er){this.logger.error("imsocket::parseData::type::json error",Er)}break;case"ack":if((xe=fr.match(/^([0-9]+)(\+)?(.*)/))&&(Sr.ackId=xe[1],Sr.args=[],xe[3]))try{Sr.args=xe[3]?JSON.parse(xe[3]):[]}catch(Er){this.logger.error("imsocket::parseData::type::ack error",Er)}}return Sr}}else this.logger.error("imsocket::unrecognize dataStr",Co(A).call(A,0,20))},V.send=function(A){var oe,xe={data:A,type:"message",endpoint:""};(oe=this.websocket)===null||oe===void 0||oe.send(this.encodePacket(xe))},V.resetCloseTimer=function(){var A=this;this.closeTimeout&&(clearTimeout(this.closeTimer),this.closeTimer=sa(function(){A.close()},this.closeTimeout))},x}(ug),sp=Uo("Array").values,hi=Array.prototype,sT={DOMTokenList:!0,NodeList:!0},ip=function(S){var x=S.values;return S===hi||rr(hi,S)&&x===hi.values||Lr(sT,Fs(S))?sp:x};Vr({target:"Array",stat:!0},{isArray:Ya});var ns=nr.Array.isArray,_g=bs.every,iT=Us("every");Vr({target:"Array",proto:!0,forced:!iT},{every:function(x){return _g(this,x,arguments.length>1?arguments[1]:void 0)}});var vi=Uo("Array").every,wg=Array.prototype,Al=function(S){var x=S.every;return S===wg||rr(wg,S)&&x===wg.every?vi:x},us=function(x){return x!=null&&typeof x=="object"},Sv=function(x){return us(x)&&Js(x)=="[object RegExp]"},xg=function(x){return function(V){return x(V)}},Ol=o(function(S,x){var V=x&&!x.nodeType&&x,F=V&&S&&!S.nodeType&&S,A=F&&F.exports===V&&Xd.process,oe=function(){try{var xe=F&&F.require&&F.require("util").types;return xe||A&&A.binding&&A.binding("util")}catch{}}();S.exports=oe}),Ig=Ol&&Ol.isRegExp,cT=Ig?xg(Ig):Sv,Eg=Hs["__core-js_shared__"],Mc=function(){var S=/[^.]+$/.exec(Eg&&Eg.keys&&Eg.keys.IE_PROTO||"");return S?"Symbol(src)_1."+S:""}(),lT=function(x){return!!Mc&&Mc in x},uT=Function.prototype.toString,il=function(x){if(x!=null){try{return uT.call(x)}catch{}try{return x+""}catch{}}return""},dT=/^\[object .+?Constructor\]$/,pT=Function.prototype,fT=Object.prototype,mT=pT.toString,gT=fT.hasOwnProperty,cl=RegExp("^"+mT.call(gT).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),cd=function(x){return!(!fi(x)||lT(x))&&(Zd(x)?cl:dT).test(il(x))},hT=function(x,V){return x==null?void 0:x[V]},ll=function(x,V){var F=hT(x,V);return cd(F)?F:void 0},ld=ll(Object,"create"),vT=function(){this.__data__=ld?ld(null):{},this.size=0},yT=function(x){var V=this.has(x)&&delete this.__data__[x];return this.size-=V?1:0,V},bT=Object.prototype.hasOwnProperty,TT=function(x){var V=this.__data__;if(ld){var F=V[x];return F==="__lodash_hash_undefined__"?void 0:F}return bT.call(V,x)?V[x]:void 0},Nl=Object.prototype.hasOwnProperty,Cv=function(x){var V=this.__data__;return ld?V[x]!==void 0:Nl.call(V,x)},ST=function(x,V){var F=this.__data__;return this.size+=this.has(x)?0:1,F[x]=ld&&V===void 0?"__lodash_hash_undefined__":V,this};function oc(S){var x=-1,V=S==null?0:S.length;for(this.clear();++x<V;){var F=S[x];this.set(F[0],F[1])}}oc.prototype.clear=vT,oc.prototype.delete=yT,oc.prototype.get=TT,oc.prototype.has=Cv,oc.prototype.set=ST;var ud=oc,CT=function(){this.__data__=[],this.size=0},cp=function(x,V){return x===V||x!=x&&V!=V},lp=function(x,V){for(var F=x.length;F--;)if(cp(x[F][0],V))return F;return-1},MT=Array.prototype.splice,kT=function(x){var V=this.__data__,F=lp(V,x);return!(F<0)&&(F==V.length-1?V.pop():MT.call(V,F,1),--this.size,!0)},Rl=function(x){var V=this.__data__,F=lp(V,x);return F<0?void 0:V[F][1]},up=function(x){return lp(this.__data__,x)>-1},dd=function(x,V){var F=this.__data__,A=lp(F,x);return A<0?(++this.size,F.push([x,V])):F[A][1]=V,this};function Bl(S){var x=-1,V=S==null?0:S.length;for(this.clear();++x<V;){var F=S[x];this.set(F[0],F[1])}}Bl.prototype.clear=CT,Bl.prototype.delete=kT,Bl.prototype.get=Rl,Bl.prototype.has=up,Bl.prototype.set=dd;var dp=Bl,kc=ll(Hs,"Map"),_T=function(){this.size=0,this.__data__={hash:new ud,map:new(kc||dp),string:new ud}},wT=function(x){var V=typeof x;return V=="string"||V=="number"||V=="symbol"||V=="boolean"?x!=="__proto__":x===null},pp=function(x,V){var F=x.__data__;return wT(V)?F[typeof V=="string"?"string":"hash"]:F.map},xT=function(x){var V=pp(this,x).delete(x);return this.size-=V?1:0,V},Fl=function(x){return pp(this,x).get(x)},fp=function(x){return pp(this,x).has(x)},IT=function(x,V){var F=pp(this,x),A=F.size;return F.set(x,V),this.size+=F.size==A?0:1,this};function Ll(S){var x=-1,V=S==null?0:S.length;for(this.clear();++x<V;){var F=S[x];this.set(F[0],F[1])}}Ll.prototype.clear=_T,Ll.prototype.delete=xT,Ll.prototype.get=Fl,Ll.prototype.has=fp,Ll.prototype.set=IT;var ul=Ll,Pg=function(x){return this.__data__.set(x,"__lodash_hash_undefined__"),this},Mv=function(x){return this.__data__.has(x)};function mp(S){var x=-1,V=S==null?0:S.length;for(this.__data__=new ul;++x<V;)this.add(S[x])}mp.prototype.add=mp.prototype.push=Pg,mp.prototype.has=Mv;var Ag=mp,ET=function(x,V,F,A){for(var oe=x.length,xe=F+(A?1:-1);A?xe--:++xe<oe;)if(V(x[xe],xe,x))return xe;return-1},kv=function(x){return x!=x},_v=function(x,V,F){for(var A=F-1,oe=x.length;++A<oe;)if(x[A]===V)return A;return-1},Og=function(x,V,F){return V==V?_v(x,V,F):ET(x,kv,F)},gp=function(x,V){return!!(x!=null&&x.length)&&Og(x,V,0)>-1},wv=function(x,V,F){for(var A=-1,oe=x==null?0:x.length;++A<oe;)if(F(V,x[A]))return!0;return!1},$l=function(x,V){for(var F=-1,A=x==null?0:x.length,oe=Array(A);++F<A;)oe[F]=V(x[F],F,x);return oe},Ng=function(x,V){return x.has(V)},Rg=function(x,V,F,A){var oe=-1,xe=gp,z=!0,Ve=x.length,jt=[],lr=V.length;if(!Ve)return jt;F&&(V=$l(V,xg(F))),A?(xe=wv,z=!1):V.length>=200&&(xe=Ng,z=!1,V=new Ag(V));e:for(;++oe<Ve;){var fr=x[oe],Sr=F==null?fr:F(fr);if(fr=A||fr!==0?fr:0,z&&Sr==Sr){for(var br=lr;br--;)if(V[br]===Sr)continue e;jt.push(fr)}else xe(V,Sr,A)||jt.push(fr)}return jt},hp=function(x){return x},xv=function(x,V,F){switch(F.length){case 0:return x.call(V);case 1:return x.call(V,F[0]);case 2:return x.call(V,F[0],F[1]);case 3:return x.call(V,F[0],F[1],F[2])}return x.apply(V,F)},pd=Math.max,Iv=function(x,V,F){return V=pd(V===void 0?x.length-1:V,0),function(){for(var A=arguments,oe=-1,xe=pd(A.length-V,0),z=Array(xe);++oe<xe;)z[oe]=A[V+oe];oe=-1;for(var Ve=Array(V+1);++oe<V;)Ve[oe]=A[oe];return Ve[V]=F(z),xv(x,this,Ve)}},PT=function(x){return function(){return x}},vp=function(){try{var S=ll(Object,"defineProperty");return S({},"",{}),S}catch{}}(),Ev=vp?function(S,x){return vp(S,"toString",{configurable:!0,enumerable:!1,value:PT(x),writable:!0})}:hp,Bg=Date.now,yp=function(x){var V=0,F=0;return function(){var A=Bg(),oe=16-(A-F);if(F=A,oe>0){if(++V>=800)return arguments[0]}else V=0;return x.apply(void 0,arguments)}},Pv=yp(Ev),Av=function(x,V){return Pv(Iv(x,V,hp),x+"")},Fg=function(x){return typeof x=="number"&&x>-1&&x%1==0&&x<=9007199254740991},bp=function(x){return x!=null&&Fg(x.length)&&!Zd(x)},En=function(x){return us(x)&&bp(x)},AT=Av(function(S,x){return En(S)?Rg(S,x):[]}),jl=AT;function OT(S,x){return x instanceof RegExp?"__REGEXP "+x.toString():x}function Wr(S,x,V){var F;x===void 0&&(x={});var A={};return In(F=na(S)).call(F,function(oe){var xe=S[oe].type,z=V?"In "+V+", ":"";if(x[oe]===void 0){if(S[oe].required===!1)return void(A[oe]=x[oe]);throw new al(z+'param "'+oe+'" is required',{key:oe},"required")}var Ve=NT[xe];if(Ve&&!Ve(x,oe,S[oe]))throw new al(z+'param "'+oe+'" expects '+mo(S[oe],OT),{key:oe,value:x[oe]},mo(S[oe]));A[oe]=x[oe]}),A}var NT={string:function(x,V,F){var A=F.allowEmpty,oe=F.max,xe=F.min,z=F.regExp,Ve=x[V];return typeof Ve=="string"&&(A!==!1||Ve!=="")&&!(typeof oe=="number"&&Ve.length>oe)&&!(typeof xe=="number"&&Ve.length<xe)&&!(cT(z)&&!z.test(Ve))},number:function(x,V,F){var A=F.min,oe=F.max,xe=x[V];return typeof xe=="number"&&!(typeof A=="number"&&xe<A)&&!(typeof oe=="number"&&xe>oe)},boolean:function(x,V){return typeof x[V]=="boolean"},enum:function(x,V,F){var A=ip(F),oe=x[V];return!A||pa(A).call(A,oe)>-1},array:function(x,V,F){var A,oe=F.itemType,xe=F.rules,z=F.min,Ve=F.max,jt=ip(F),lr=x[V];return!!ns(lr)&&!(typeof Ve=="number"&&lr.length>Ve)&&!(typeof z=="number"&&lr.length<z)&&!(oe&&oe!=="enum"&&!Al(lr).call(lr,function(fr){return typeof fr===oe}))&&(oe!=="enum"||!jt||!jl.apply(void 0,Vs(A=[lr]).call(A,jt)).length)&&(xe&&In(lr).call(lr,function(fr,Sr){return Wr(xe,fr,V+"["+Sr+"]")}),!0)},object:function(x,V,F){var A=F.rules,oe=x[V];return A&&Wr(A,oe,V),!0}},Dl=ll(Hs,"Set"),RT=function(){},Tp=function(x){var V=-1,F=Array(x.size);return x.forEach(function(A){F[++V]=A}),F},Lg=Dl&&1/Tp(new Dl([,-0]))[1]==1/0?function(S){return new Dl(S)}:RT,Ov=Lg,Sp=function(x,V,F){var A=-1,oe=gp,xe=x.length,z=!0,Ve=[],jt=Ve;if(F)z=!1,oe=wv;else if(xe>=200){var lr=V?null:Ov(x);if(lr)return Tp(lr);z=!1,oe=Ng,jt=new Ag}else jt=V?[]:Ve;e:for(;++A<xe;){var fr=x[A],Sr=V?V(fr):fr;if(fr=F||fr!==0?fr:0,z&&Sr==Sr){for(var br=jt.length;br--;)if(jt[br]===Sr)continue e;V&&jt.push(Sr),Ve.push(fr)}else oe(jt,Sr,F)||(jt!==Ve&&jt.push(Sr),Ve.push(fr))}return Ve},BT=function(x){return x&&x.length?Sp(x):[]},$g=`	
\v\f\r \u2028\u2029\uFEFF`,Cp=he("".replace),Mp="["+$g+"]",fd=RegExp("^"+Mp+Mp+"*"),Nv=RegExp(Mp+Mp+"*$"),kp=function(S){return function(x){var V=Oa(pr(x));return 1&S&&(V=Cp(V,fd,"")),2&S&&(V=Cp(V,Nv,"")),V}},Rv={start:kp(1),end:kp(2),trim:kp(3)}.trim,md=d.parseInt,jg=d.Symbol,Ai=jg&&jg.iterator,ko=/^[+-]?0x/i,_p=he(ko.exec),yi=md($g+"08")!==8||md($g+"0x16")!==22||Ai&&!c(function(){md(Object(Ai))})?function(x,V){var F=Rv(Oa(x));return md(F,V>>>0||(_p(ko,F)?16:10))}:md;Vr({global:!0,forced:parseInt!=yi},{parseInt:yi});var Oi,Lo=nr.parseInt,Dg=(Oi=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return Oi()+Oi()+Oi()+Oi()+Oi()+Oi()+Oi()+Oi()});function ia(S){var x;return Ys(x=na(S)).call(x,function(V){return!(+V>=0)})}function Bv(S,x){var V,F=Ys(V=na(S)).call(V,function(A){return S[A]==x});return F.length>0?F[0]:void 0}var FT=TypeError,wp=Object.getOwnPropertyDescriptor,LT=Ne&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(S){return S instanceof TypeError}}()?function(S,x){if(Ya(S)&&!wp(S,"length").writable)throw FT("Cannot set read only .length");return S.length=x}:function(S,x){return S.length=x},$T=TypeError,xp=function(S,x){if(!delete S[x])throw $T("Cannot delete property "+Rr(x)+" of "+Rr(S))},jT=Ui("splice"),Ug=Math.max,qg=Math.min;Vr({target:"Array",proto:!0,forced:!jT},{splice:function(x,V){var F,A,oe,xe,z,Ve,jt=$n(this),lr=Ia(jt),fr=ni(x,lr),Sr=arguments.length;for(Sr===0?F=A=0:Sr===1?(F=0,A=lr-fr):(F=Sr-2,A=qg(Ug($i(V),0),lr-fr)),uu(lr+F-A),oe=fu(jt,A),xe=0;xe<A;xe++)(z=fr+xe)in jt&&Bs(oe,xe,jt[z]);if(oe.length=A,F<A){for(xe=fr;xe<lr-A;xe++)Ve=xe+F,(z=xe+A)in jt?jt[Ve]=jt[z]:xp(jt,Ve);for(xe=lr;xe>lr-A+F;xe--)xp(jt,xe-1)}else if(F>A)for(xe=lr-A;xe>fr;xe--)Ve=xe+F-1,(z=xe+A-1)in jt?jt[Ve]=jt[z]:xp(jt,Ve);for(xe=0;xe<F;xe++)jt[xe+fr]=arguments[xe+2];return LT(jt,lr-A+F),oe}});var DT=Uo("Array").splice,Ip=Array.prototype,Fv=function(S){var x=S.splice;return S===Ip||rr(Ip,S)&&x===Ip.splice?DT:x},Ep=function(S,x,V,F){try{return F?x(Vn(V)[0],V[1]):x(V)}catch(A){Ou(S,"throw",A)}},gd=Array,Lv=!Gm(function(S){Array.from(S)});Vr({target:"Array",stat:!0,forced:Lv},{from:function(x){var V=$n(x),F=Uc(this),A=arguments.length,oe=A>1?arguments[1]:void 0,xe=oe!==void 0;xe&&(oe=$o(oe,A>2?arguments[2]:void 0));var z,Ve,jt,lr,fr,Sr,br=Jc(V),Er=0;if(!br||this===gd&&fm(br))for(z=Ia(V),Ve=F?new this(z):gd(z);z>Er;Er++)Sr=xe?oe(V[Er],Er):V[Er],Bs(Ve,Er,Sr);else for(fr=(lr=Gi(V,br)).next,Ve=F?new this:[];!(jt=Y(fr,lr)).done;Er++)Sr=xe?Ep(lr,oe,[jt.value,Er],!0):jt.value,Bs(Ve,Er,Sr);return Ve.length=Er,Ve}});var _c=nr.Array.from,Va=Jc;function $v(S,x){var V,F=ga!==void 0&&Va(S)||S["@@iterator"];if(F)return Oo(V=(F=F.call(S)).next).call(V,F);if(ns(S)||(F=function(xe,z){var Ve;if(xe){if(typeof xe=="string")return jv(xe,z);var jt=Co(Ve=Object.prototype.toString.call(xe)).call(Ve,8,-1);if(jt==="Object"&&xe.constructor&&(jt=xe.constructor.name),jt==="Map"||jt==="Set")return _c(xe);if(jt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(jt))return jv(xe,z)}}(S))||x&&S&&typeof S.length=="number"){F&&(S=F);var A=0;return function(){return A>=S.length?{done:!0}:{done:!1,value:S[A++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jv(S,x){(x==null||x>S.length)&&(x=S.length);for(var V=0,F=new Array(x);V<x;V++)F[V]=S[V];return F}var ds,Dv=function(){function S(){this.timerList=[],this.id=0,this.timer=null,this.timeout=0}var x=S.prototype;return x.addTimer=function(F,A,oe){A===void 0&&(A=0),oe===void 0&&(oe=1);var xe=new Date().getTime(),z=this.id;return this.timerList.push({id:z,loop:oe,count:0,timeout:xe+A,interval:A,callback:F}),this.id++,this.checkTimer(xe),z},x.checkTimer=function(F){if(F===void 0&&(F=new Date().getTime()),this.removeFinished(),this.timerList.length!==0||this.timer==null){for(var A,oe,xe=0,z=$v(this.timerList);!(A=z()).done;){var Ve=A.value;(xe===0||xe>Ve.timeout)&&(xe=Ve.timeout)}this.timerList.length!==0&&(this.timer===null||xe<this.timeout||this.timeout<F)&&(this.timer=sa(Oo(oe=this.nowTime).call(oe,this),xe-F),this.timeout=xe)}},x.nowTime=function(){for(var F,A=new Date().getTime(),oe=$v(this.timerList);!(F=oe()).done;){var xe=F.value;A>=xe.timeout&&(xe.callback(),xe.count++,xe.timeout=A+xe.interval)}this.clerTime(),this.checkTimer(A)},x.clerTime=function(){this.timer!==null&&(clearTimeout(this.timer),this.timer=null)},x.deleteTimer=function(F){for(var A=this.timerList.length-1;A>=0;A--){var oe;this.timerList[A].id===F&&Fv(oe=this.timerList).call(oe,A,1)}},x.removeFinished=function(){for(var F=this.timerList.length-1;F>=0;F--){var A,oe=this.timerList[F];oe.loop>=0&&oe.count>=oe.loop&&Fv(A=this.timerList).call(A,F,1)}},x.destroy=function(){this.clerTime(),this.timerList=[],this.id=0,this.timer=null},S}(),Uv=function(){function S(V){this.core=V}var x=S.prototype;return x.request=function(F,A){var oe=this,xe=new Date().getTime();return ta.request(F,A).catch(function(z){var Ve,jt,lr=z;throw oe.core.reporter.reportTraceStart("exceptions",{user_id:oe.core.options.account,trace_id:(jt=(Ve=oe.core)===null||Ve===void 0?void 0:Ve.socket)===null||jt===void 0?void 0:jt.sessionId,start_time:xe,action:1}),oe.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof lr.code=="number"?lr.code:0,description:lr.message||""+lr.code,operation_type:0,target:F,context:A?mo(A):""}),oe.core.reporter.reportTraceEnd("exceptions",1),z})},x.uploadFile=function(F){var A=this,oe=new Date().getTime();return ta.uploadFile(F).catch(function(xe){var z,Ve,jt=xe;A.core.reporter.reportTraceStart("exceptions",{user_id:A.core.options.account,trace_id:(Ve=(z=A.core)===null||z===void 0?void 0:z.socket)===null||Ve===void 0?void 0:Ve.sessionId,start_time:oe,action:1});var lr=ta.platform==="BROWSER"?F.chunkUploadHost:F.commonUploadHost?F.commonUploadHost+"/"+(F.nosToken&&F.nosToken.bucket):"https://nos.netease.com/nim";throw A.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof jt.code=="number"?jt.code:0,description:jt.message||""+jt.code,operation_type:1,target:lr}),A.core.reporter.reportTraceEnd("exceptions",1),xe})},S}();(function(S){S[S.ACTIVE=1]="ACTIVE",S[S.KICKED=2]="KICKED",S[S.OFFLINE=3]="OFFLINE"})(ds||(ds={}));var qv=window&&Zd(window.addEventListener)&&Zd(window.removeEventListener),hd=function(S){function x(F,A){var oe;(oe=S.call(this)||this).status="unconnected",oe.linkUrls=[],oe.eventBus=new ug,oe.packetSer=1,oe.retryCount=0,oe.reconnectTimer=0,oe.backoff=new U1({max:8e3,min:1600,jitter:.01}),oe.sendingCmdMap=new nl,oe.pingTimer=0,oe.config=lv,oe.abtInfo={},Wr({linkUrls:{type:"array",itemType:"string",required:!1}},F),oe.options=Tn(Tn({},uv),F),oe.adapters=new Uv(i(oe));var xe=ta.localStorage.getItem("__NIM_DEVC_ID__");oe.options.isFixedDeviceId?(xe=ta.localStorage.getItem("__NIM_DEVC_ID__")||Dg(),ta.localStorage.setItem("__NIM_DEVC_ID__",xe)):xe=Dg(),oe.config=Tn(Tn(Tn({},lv),A),{deviceId:xe}),oe.timerManager=new Dv,oe.logger=new hv(oe.options.debugLevel,oe.options.account);var z=ta.getSystemInfo();return oe.reporter=new vv({common:{app_key:F.appkey,dev_id:xe,platform:"Web",sdk_ver:"0.13.1",env:"online",os_name:z.os,os_ver:z.osVer,model:z.hostEnvVer,manufactor:z.hostEnv,host_env:z.hostEnv,host_info:z.hostInfo,host_env_ver:z.hostEnvVer},request:ta.request,logger:oe.logger,autoStart:ta.platform==="BROWSER"}),ta.setLogger(oe.logger),oe.logger.log("Core init, version ","0.13.1"," sdk version ",91001," appkey ",F.appkey),oe}Ro(x,S);var V=x.prototype;return V.emit=function(A){try{for(var oe,xe,z=ts(),Ve=arguments.length,jt=new Array(Ve>1?Ve-1:0),lr=1;lr<Ve;lr++)jt[lr-1]=arguments[lr];var fr=(oe=S.prototype.emit).call.apply(oe,Vs(xe=[this,A]).call(xe,jt)),Sr=ts()-z;return Sr>=10&&this.logger.warn("Core::emit event: "+A+" process takes: "+Sr+"ms"),fr}catch(br){return this.logger.error("Core::emit event: "+A+". Error: "+br),!1}},V.connect=function(A,oe){return A===void 0&&(A={}),Mr(this,void 0,void 0,ar.mark(function xe(){var z,Ve,jt,lr,fr,Sr;return ar.wrap(function(Er){for(;;)switch(Er.prev=Er.next){case 0:if(Wr({linkUrls:{type:"array",itemType:"string",required:!1}},A),/^(unconnected|waitReconnect)$/.test(this.status)){Er.next=5;break}return z="Core socket status is "+this.status+", and would not connect",this.logger.warn(z),Er.abrupt("return",uo.reject(z));case 5:this.status="connecting",A.linkUrls&&A.linkUrls.length>0&&(this.linkUrls=Vs(Ve=A.linkUrls).call(Ve,this.linkUrls),this.linkUrls=BT(this.linkUrls)),this.linkUrls.length===0&&this.linkUrls.push("weblink.netease.im:443"),jt=0;case 9:if(!(jt<this.linkUrls.length)){Er.next=32;break}return lr=this.linkUrls[jt],fr=new Date().getTime(),Er.prev=12,Er.next=15,this.doConnect(lr);case 15:return this.status="connected",this.logger.log("core:: connect success with url: "+lr),this.abtRequest(),Er.abrupt("return",lr);case 21:Er.prev=21,Er.t0=Er.catch(12),Sr=Er.t0,oe&&oe(Sr,lr),this.reporter.reportTraceStart("exceptions",{user_id:this.options.account,start_time:fr,action:0}),this.reporter.reportTraceUpdateV2("exceptions",{code:typeof Sr.code=="number"?Sr.code:0,description:Sr.message||""+Sr.code,operation_type:0,target:lr}),this.reporter.reportTraceEnd("exceptions",1),this.logger.warn("core:: connect failed with url: "+lr,Er.t0);case 29:jt++,Er.next=9;break;case 32:throw this.retryCount===0?this.doDisconnect(ds.ACTIVE,"SocketHandshakeFailed"):this.doDisconnect(ds.OFFLINE,"ReconnectHadRetryAllLinks"),new Error("core: socket handshake failed");case 34:case"end":return Er.stop()}},xe,this,[[12,21]])}))},V.doConnect=function(A){var oe=this;return new uo(function(xe,z){var Ve;oe.socket=new aT(oe,A,oe.logger),oe.socket.on("connect",function(){oe.logger.log("socket on connect",A),xe()}),oe.socket.on("message",Oo(Ve=oe.onMessage).call(Ve,oe)),oe.socket.on("disconnect",function(jt){oe.logger.log("core:: socket on disconnect",jt),oe.doDisconnect(ds.OFFLINE,"SocketOnDisconnect")}),oe.socket.on("handshakeFailed",function(){oe.logger.warn("core:: socket handshake failed"),z(new yo("handshake failed",{},408))})})},V.resetConnectStatus=function(){clearTimeout(this.reconnectTimer),this.backoff.reset(),this.retryCount=0,this.initOnlineListener()},V.doDisconnect=function(A,oe){if(this.logger.log("doDisconnect: type "+A+", description "+oe),this.status!=="unconnected"){this.markAllCmdInvaild(new yo("Packet timeout due to instance disconnect",{},408)),this.timerManager.destroy(),clearTimeout(this.pingTimer),this.socket&&(typeof this.socket.removeAllListeners=="function"&&this.socket.removeAllListeners(),typeof this.socket.close=="function"&&this.socket.close(),this.socket=void 0);var xe=!this.options.needReconnect||this.retryCount>=this.options.reconnectionAttempts;if(A===ds.ACTIVE||xe)this.logger.log("doDisconnect: emit disconnect, type "+A,xe),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.eventBus.emit("disconnect"),this.emit("disconnect"),this.destroyOnlineListener();else if(A===ds.KICKED){this.logger.log("doDisconnect: kicked"),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer);var z=typeof oe=="string"?{reason:"unknow",message:oe}:oe;this.eventBus.emit("kicked",z),this.emit("kicked",z),this.destroyOnlineListener()}else A===ds.OFFLINE?(this.logger.log("doDisconnect: start to reconnect"),this.attempToReconnect()):this.logger.log("doDisconnect: nothing to do")}else this.logger.warn("doDisconnect: already unconnected")},V.attempToReconnect=function(){var A=this;if(this.status!=="waitReconnect"){var oe=this.backoff.duration();this.retryCount++,this.logger.log("willReconnect "+this.retryCount+" "+oe),this.eventBus.emit("willReconnect",{retryCount:this.retryCount,duration:oe}),this.emit("willReconnect",{retryCount:this.retryCount,duration:oe}),this.status="waitReconnect",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=sa(function(){A.status==="waitReconnect"?A.connect({isAutoReconnect:!0}).catch(function(){A.logger.error("core::attempToReconnect failed "+A.retryCount)}):A.logger.warn("doDisconnect: reconnectTimer status is "+A.status+", would not go on reconnecting")},oe)}else this.logger.warn("doDisconnect: already is waiting reconnect")},V.sendCmd=function(A,oe,xe){var z=this;if(this.status!=="logined"&&A!=="login"&&A!=="chatroomLogin"&&A!=="qchatLogin")return this.logger.warn("nim status is "+this.status+", so can not sendCmd "+A),uo.reject({cmd:A,error:{code:"No_connected",message:"Connection not established",timetag:new Date().getTime()}});if(!this.socket||!this.socket.send)return uo.reject("No_socket");var Ve=A!=="heartbeat",jt=Ve?this.packetSer++:0,lr=function(vn,Yr,wn,Zr){var Qn=id[vn];if(!Qn)return wn.error("createCmd:: can not find cmd config: ",vn),null;var Dn,jo={SER:Yr,SID:Qn.sid,CID:Qn.cid,Q:[]};return Qn.params&&Zr&&In(Dn=Qn.params).call(Dn,function(jn){var wr=Zr[jn.name];if(!Tv(wr)){var xn=jn.type,Nn=jn.reflectMapper;switch(jn.type){case"PropertyArray":xn="ArrayMable",wr=ho(wr).call(wr,function(Mn){return{t:"Property",v:Nn?rs(Mn,Nn):Mn}});break;case"Property":wr=Nn?rs(wr,Nn):wr;break;case"Bool":case"bool":wr=wr?"true":"false"}jo.Q.push({t:xn,v:wr})}}),{packet:jo,isNoResponse:Qn.isNoResponse||!1}}(A,jt,this.logger,oe);if(!lr){var fr="SendCmd "+jt+" "+A+" error";return this.logger.error(fr),uo.reject(fr)}var Sr=lr.packet,br=lr.isNoResponse,Er=mo(Sr);Ve&&(this.options.debugLevel==="debug"?this.logger.debug("core::sendCmd",A,"ser:"+jt,Er):this.logger.log("core::sendCmd",A,"ser:"+jt));var Dr=new Date().getTime();return new uo(function($r,vn){z.sendingCmdMap.set(jt,{cmd:A,params:oe,callback:[$r,vn],timer:br?null:sa(function(){var wn,Zr=new Tg(504,A,"Packet Timeout",new Date().getTime(),{message:"ser "+jt+" cmd "+A+" timeout"});Zr.callFunc="sendCmd",z.markCmdInvalid(jt,Zr,A),z.reporter.reportTraceStart("exceptions",{user_id:z.options.account,trace_id:(wn=z.socket)===null||wn===void 0?void 0:wn.sessionId,start_time:Dr,action:2}),z.reporter.reportTraceUpdateV2("exceptions",{code:408,description:"Packet timeout",operation_type:1,target:Sr.SID+"-"+Sr.CID,context:""+Sr.SER}),z.reporter.reportTraceEnd("exceptions",1)},xe&&xe.timeout?xe.timeout:z.config.timeout)});try{z.socket.send(Er)}catch(wn){var Yr=new Tg(415,A,wn&&wn.message||"Unable to send packet",new Date().getTime(),{message:"send json error",rawError:wn});Yr.callFunc="sendCmd",z.markCmdInvalid(jt,Yr,A),vn(wn)}})},V.onMessage=function(A){var oe=qa(A,this.logger);if(oe){var xe=oe.raw.ser;if(oe.error&&this.logger.error("core:onMessage packet error",oe.raw.sid+"_"+oe.raw.cid+", ser:"+xe+",",oe.error),!oe.notFound)return oe.cmd!=="heartbeat"&&(this.options.debugLevel==="debug"?this.logger.debug("imsocket::recvCmd ser:"+xe,oe.cmd,oe.content):this.logger.log("imsocket::recvCmd ser:"+xe,oe.cmd)),oe.__receiveTime=ts(),oe;this.logger.warn("core::onMessage packet not found",oe.raw.sid+"_"+oe.raw.cid+", ser:"+xe)}},V.markCmdInvalid=function(A,oe,xe){var z=this.sendingCmdMap.get(A);if(z){var Ve=z.callback,jt=z.timer;jt&&clearTimeout(jt),this.sendingCmdMap.delete(A),this.logger.warn("packet "+A+", "+xe+" is invalid:",oe),Ve[1](oe)}},V.markAllCmdInvaild=function(A){var oe;this.logger.log("markAllCmdInvaild"),In(oe=this.sendingCmdMap).call(oe,function(xe){var z=xe.callback,Ve=xe.timer;Ve&&clearTimeout(Ve),z[1](A)}),this.sendingCmdMap.clear()},V.ping=function(){return Mr(this,void 0,void 0,ar.mark(function A(){var oe=this;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return clearTimeout(this.pingTimer),z.prev=1,z.next=4,this.sendCmd("heartbeat");case 4:z.next=14;break;case 6:return z.prev=6,z.t0=z.catch(1),z.next=10,this.testHeartBeat5Timeout();case 10:if(!z.sent){z.next=14;break}return this.doDisconnect(ds.OFFLINE,"PingError"),z.abrupt("return");case 14:this.pingTimer=sa(function(){oe.ping()},3e4);case 15:case"end":return z.stop()}},A,this,[[1,6]])}))},V.testHeartBeat5Timeout=function(){return Mr(this,void 0,void 0,ar.mark(function A(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:clearTimeout(this.pingTimer),oe=0;case 2:if(!(oe<5)){z.next=15;break}return z.prev=3,z.next=6,this.sendCmd("heartbeat",{},{timeout:3e3});case 6:return z.abrupt("return",!1);case 9:z.prev=9,z.t0=z.catch(3),this.logger.debug("core:: test heartbeat "+oe+" Timeout");case 12:oe++,z.next=2;break;case 15:return z.abrupt("return",!0);case 16:case"end":return z.stop()}},A,this,[[3,9]])}))},V.initOnlineListener=function(){var A,oe;this.onlineListener||(qv?(this.onlineListener=Oo(A=function(){this.status==="logined"&&this.ping()}).call(A,this),this.offlineListener=Oo(oe=function(){this.logger.log("offline"),this.doDisconnect(ds.OFFLINE,"OfflineListener")}).call(oe,this),window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener)):this.logger.warn("initOnlineListener not support add listener"))},V.destroyOnlineListener=function(){this.onlineListener&&(window.removeEventListener("online",this.onlineListener),this.onlineListener=void 0),this.offlineListener&&(window.removeEventListener("offline",this.offlineListener),this.offlineListener=void 0)},V.disconnect=function(){switch(this.status){case"connected":case"logined":case"connecting":case"waitReconnect":return this.doDisconnect(ds.ACTIVE,"UserActiveDisconnect"),uo.resolve();case"unconnected":case"destroyed":return uo.resolve()}},V.destroy=function(){var A=this;return this.disconnect().then(function(){A.status="destroyed",A.removeAllListeners(),A.eventBus.removeAllListeners(),A.reporter.destroy(),A.connect=function(){return uo.resolve()},A.disconnect=function(){return uo.resolve()},A.destroy=function(){return uo.resolve()}})},V.abtRequest=function(){var A,oe;return Mr(this,void 0,void 0,ar.mark(function xe(){var z,Ve;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:if(this.options.isAbtestEnable){lr.next=2;break}return lr.abrupt("return");case 2:if(!this.abtInfo.experiments){lr.next=4;break}return lr.abrupt("return");case 4:if(this.options.abtestUrl){lr.next=6;break}return lr.abrupt("return");case 6:return lr.prev=6,lr.next=9,this.adapters.request(this.options.abtestUrl,{method:"POST",dataType:"json",headers:{sdktype:"ABTest"},data:{clientInfo:{projectKey:this.options.abtestProjectKey,appKey:this.options.appkey,osType:"Web",sdkVersion:"0.13.1",deviceId:this.config.deviceId},useLocalCache:!0}});case 9:z=lr.sent,lr.next=15;break;case 12:lr.prev=12,lr.t0=lr.catch(6),this.logger.warn("ABTest request failed");case 15:this.abtInfo=((oe=(A=z==null?void 0:z.data)===null||A===void 0?void 0:A.data)===null||oe===void 0?void 0:oe.abtInfo)||{},this.abtInfo.experiments&&this.abtInfo.experiments.length>0&&this.reporter.reportImmediately("https://statistic.live.126.net/statics/report/abtest/result",{params:{app_key:this.options.appkey,biz_sdk_type:"IM",sdk_ver:"0.13.1",device_id:this.config.deviceId,platform:"Web",projectKey:this.options.abtestProjectKey,experiments:ho(Ve=this.abtInfo.experiments).call(Ve,function(fr){return{experimentKey:fr.experimentKey,schemeKey:fr.schemeKey}})},headers:{sdktype:"ABTest"},method:"POST",dataType:"json"});case 17:case"end":return lr.stop()}},xe,this,[[6,12]])}))},x}(ug);hd.setAdapters=function(x){Tn(ta,x)};var Vv=bs.some,bi=Us("some");Vr({target:"Array",proto:!0,forced:!bi},{some:function(x){return Vv(this,x,arguments.length>1?arguments[1]:void 0)}});var Pp=Uo("Array").some,Vg=Array.prototype,Ap=function(S){var x=S.some;return S===Vg||rr(Vg,S)&&x===Vg.some?Pp:x},Hg=function(){this.__data__=new dp,this.size=0},zg=function(x){var V=this.__data__,F=V.delete(x);return this.size=V.size,F},UT=function(x){return this.__data__.get(x)},qT=function(x){return this.__data__.has(x)},VT=function(x,V){var F=this.__data__;if(F instanceof dp){var A=F.__data__;if(!kc||A.length<199)return A.push([x,V]),this.size=++F.size,this;F=this.__data__=new ul(A)}return F.set(x,V),this.size=F.size,this};function Ul(S){var x=this.__data__=new dp(S);this.size=x.size}Ul.prototype.clear=Hg,Ul.prototype.delete=zg,Ul.prototype.get=UT,Ul.prototype.has=qT,Ul.prototype.set=VT;var Op=Ul,Hv=function(x,V){for(var F=-1,A=x==null?0:x.length;++F<A;)if(V(x[F],F,x))return!0;return!1},Kg=function(x,V,F,A,oe,xe){var z=1&F,Ve=x.length,jt=V.length;if(Ve!=jt&&!(z&&jt>Ve))return!1;var lr=xe.get(x),fr=xe.get(V);if(lr&&fr)return lr==V&&fr==x;var Sr=-1,br=!0,Er=2&F?new Ag:void 0;for(xe.set(x,V),xe.set(V,x);++Sr<Ve;){var Dr=x[Sr],$r=V[Sr];if(A)var vn=z?A($r,Dr,Sr,V,x,xe):A(Dr,$r,Sr,x,V,xe);if(vn!==void 0){if(vn)continue;br=!1;break}if(Er){if(!Hv(V,function(Yr,wn){if(!Ng(Er,wn)&&(Dr===Yr||oe(Dr,Yr,F,A,xe)))return Er.push(wn)})){br=!1;break}}else if(Dr!==$r&&!oe(Dr,$r,F,A,xe)){br=!1;break}}return xe.delete(x),xe.delete(V),br},zv=Hs.Uint8Array,HT=function(x){var V=-1,F=Array(x.size);return x.forEach(function(A,oe){F[++V]=[oe,A]}),F},vd=xi?xi.prototype:void 0,dl=vd?vd.valueOf:void 0,Wg=function(x,V,F,A,oe,xe,z){switch(F){case"[object DataView]":if(x.byteLength!=V.byteLength||x.byteOffset!=V.byteOffset)return!1;x=x.buffer,V=V.buffer;case"[object ArrayBuffer]":return!(x.byteLength!=V.byteLength||!xe(new zv(x),new zv(V)));case"[object Boolean]":case"[object Date]":case"[object Number]":return cp(+x,+V);case"[object Error]":return x.name==V.name&&x.message==V.message;case"[object RegExp]":case"[object String]":return x==V+"";case"[object Map]":var Ve=HT;case"[object Set]":var jt=1&A;if(Ve||(Ve=Tp),x.size!=V.size&&!jt)return!1;var lr=z.get(x);if(lr)return lr==V;A|=2,z.set(x,V);var fr=Kg(Ve(x),Ve(V),A,oe,xe,z);return z.delete(x),fr;case"[object Symbol]":if(dl)return dl.call(x)==dl.call(V)}return!1},Os=function(x,V){for(var F=-1,A=V.length,oe=x.length;++F<A;)x[oe+F]=V[F];return x},Ni=Array.isArray,Np=function(x,V,F){var A=V(x);return Ni(x)?A:Os(A,F(x))},Fa=function(x,V){for(var F=-1,A=x==null?0:x.length,oe=0,xe=[];++F<A;){var z=x[F];V(z,F,x)&&(xe[oe++]=z)}return xe},Kv=function(){return[]},Gg=Object.prototype.propertyIsEnumerable,Qg=Object.getOwnPropertySymbols,zT=Qg?function(S){return S==null?[]:(S=Object(S),Fa(Qg(S),function(x){return Gg.call(S,x)}))}:Kv,Jg=zT,KT=function(x,V){for(var F=-1,A=Array(x);++F<x;)A[F]=V(F);return A},Rp=function(x){return us(x)&&Js(x)=="[object Arguments]"},Yg=Object.prototype,ql=Yg.hasOwnProperty,WT=Yg.propertyIsEnumerable,Xg=Rp(function(){return arguments}())?Rp:function(S){return us(S)&&ql.call(S,"callee")&&!WT.call(S,"callee")},Zg=Xg,GT=function(){return!1},eh=o(function(S,x){var V=x&&!x.nodeType&&x,F=V&&S&&!S.nodeType&&S,A=F&&F.exports===V?Hs.Buffer:void 0,oe=(A?A.isBuffer:void 0)||GT;S.exports=oe}),Wv=/^(?:0|[1-9]\d*)$/,yd=function(x,V){var F=typeof x;return!!(V=V??9007199254740991)&&(F=="number"||F!="symbol"&&Wv.test(x))&&x>-1&&x%1==0&&x<V},Ta={};Ta["[object Float32Array]"]=Ta["[object Float64Array]"]=Ta["[object Int8Array]"]=Ta["[object Int16Array]"]=Ta["[object Int32Array]"]=Ta["[object Uint8Array]"]=Ta["[object Uint8ClampedArray]"]=Ta["[object Uint16Array]"]=Ta["[object Uint32Array]"]=!0,Ta["[object Arguments]"]=Ta["[object Array]"]=Ta["[object ArrayBuffer]"]=Ta["[object Boolean]"]=Ta["[object DataView]"]=Ta["[object Date]"]=Ta["[object Error]"]=Ta["[object Function]"]=Ta["[object Map]"]=Ta["[object Number]"]=Ta["[object Object]"]=Ta["[object RegExp]"]=Ta["[object Set]"]=Ta["[object String]"]=Ta["[object WeakMap]"]=!1;var Gv=function(x){return us(x)&&Fg(x.length)&&!!Ta[Js(x)]},th=Ol&&Ol.isTypedArray,ac=th?xg(th):Gv,Qv=Object.prototype.hasOwnProperty,Jv=function(x,V){var F=Ni(x),A=!F&&Zg(x),oe=!F&&!A&&eh(x),xe=!F&&!A&&!oe&&ac(x),z=F||A||oe||xe,Ve=z?KT(x.length,String):[],jt=Ve.length;for(var lr in x)!V&&!Qv.call(x,lr)||z&&(lr=="length"||oe&&(lr=="offset"||lr=="parent")||xe&&(lr=="buffer"||lr=="byteLength"||lr=="byteOffset")||yd(lr,jt))||Ve.push(lr);return Ve},QT=Object.prototype,Yv=function(x){var V=x&&x.constructor;return x===(typeof V=="function"&&V.prototype||QT)},Xv=function(x,V){return function(F){return x(V(F))}},Zv=Xv(Object.keys,Object),JT=Object.prototype.hasOwnProperty,rh=function(x){if(!Yv(x))return Zv(x);var V=[];for(var F in Object(x))JT.call(x,F)&&F!="constructor"&&V.push(F);return V},wc=function(x){return bp(x)?Jv(x):rh(x)},nh=function(x){return Np(x,wc,Jg)},YT=Object.prototype.hasOwnProperty,ey=function(x,V,F,A,oe,xe){var z=1&F,Ve=nh(x),jt=Ve.length;if(jt!=nh(V).length&&!z)return!1;for(var lr=jt;lr--;){var fr=Ve[lr];if(!(z?fr in V:YT.call(V,fr)))return!1}var Sr=xe.get(x),br=xe.get(V);if(Sr&&br)return Sr==V&&br==x;var Er=!0;xe.set(x,V),xe.set(V,x);for(var Dr=z;++lr<jt;){var $r=x[fr=Ve[lr]],vn=V[fr];if(A)var Yr=z?A(vn,$r,fr,V,x,xe):A($r,vn,fr,x,V,xe);if(!(Yr===void 0?$r===vn||oe($r,vn,F,A,xe):Yr)){Er=!1;break}Dr||(Dr=fr=="constructor")}if(Er&&!Dr){var wn=x.constructor,Zr=V.constructor;wn==Zr||!("constructor"in x)||!("constructor"in V)||typeof wn=="function"&&wn instanceof wn&&typeof Zr=="function"&&Zr instanceof Zr||(Er=!1)}return xe.delete(x),xe.delete(V),Er},sc=ll(Hs,"DataView"),Da=ll(Hs,"Promise"),Vl=ll(Hs,"WeakMap"),ha="[object Map]",Xs="[object Promise]",ty="[object Set]",os="[object WeakMap]",oh="[object DataView]",ah=il(sc),XT=il(kc),ZT=il(Da),ry=il(Dl),eS=il(Vl),pl=Js;(sc&&pl(new sc(new ArrayBuffer(1)))!=oh||kc&&pl(new kc)!=ha||Da&&pl(Da.resolve())!=Xs||Dl&&pl(new Dl)!=ty||Vl&&pl(new Vl)!=os)&&(pl=function(S){var x=Js(S),V=x=="[object Object]"?S.constructor:void 0,F=V?il(V):"";if(F)switch(F){case ah:return oh;case XT:return ha;case ZT:return Xs;case ry:return ty;case eS:return os}return x});var bd=pl,Zs="[object Arguments]",sh="[object Array]",Bp="[object Object]",Td=Object.prototype.hasOwnProperty,ny=function(x,V,F,A,oe,xe){var z=Ni(x),Ve=Ni(V),jt=z?sh:bd(x),lr=Ve?sh:bd(V),fr=(jt=jt==Zs?Bp:jt)==Bp,Sr=(lr=lr==Zs?Bp:lr)==Bp,br=jt==lr;if(br&&eh(x)){if(!eh(V))return!1;z=!0,fr=!1}if(br&&!fr)return xe||(xe=new Op),z||ac(x)?Kg(x,V,F,A,oe,xe):Wg(x,V,jt,F,A,oe,xe);if(!(1&F)){var Er=fr&&Td.call(x,"__wrapped__"),Dr=Sr&&Td.call(V,"__wrapped__");if(Er||Dr){var $r=Er?x.value():x,vn=Dr?V.value():V;return xe||(xe=new Op),oe($r,vn,F,A,xe)}}return!!br&&(xe||(xe=new Op),ey(x,V,F,A,oe,xe))},ih=function S(x,V,F,A,oe){return x===V||(x==null||V==null||!us(x)&&!us(V)?x!=x&&V!=V:ny(x,V,F,A,S,oe))},tS=function(x,V,F,A){var oe=F.length,xe=oe,z=!A;if(x==null)return!xe;for(x=Object(x);oe--;){var Ve=F[oe];if(z&&Ve[2]?Ve[1]!==x[Ve[0]]:!(Ve[0]in x))return!1}for(;++oe<xe;){var jt=(Ve=F[oe])[0],lr=x[jt],fr=Ve[1];if(z&&Ve[2]){if(lr===void 0&&!(jt in x))return!1}else{var Sr=new Op;if(A)var br=A(lr,fr,jt,x,V,Sr);if(!(br===void 0?ih(fr,lr,3,A,Sr):br))return!1}}return!0},oy=function(x){return x==x&&!fi(x)},rS=function(x){for(var V=wc(x),F=V.length;F--;){var A=V[F],oe=x[A];V[F]=[A,oe,oy(oe)]}return V},ch=function(x,V){return function(F){return F!=null&&F[x]===V&&(V!==void 0||x in Object(F))}},ay=function(x){var V=rS(x);return V.length==1&&V[0][2]?ch(V[0][0],V[0][1]):function(F){return F===x||tS(F,x,V)}},Fp=function(x){return typeof x=="symbol"||us(x)&&Js(x)=="[object Symbol]"},nS=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,oS=/^\w*$/,Sd=function(x,V){if(Ni(x))return!1;var F=typeof x;return!(F!="number"&&F!="symbol"&&F!="boolean"&&x!=null&&!Fp(x))||oS.test(x)||!nS.test(x)||V!=null&&x in Object(V)};function lh(S,x){if(typeof S!="function"||x!=null&&typeof x!="function")throw new TypeError("Expected a function");var V=function(){var F=arguments,A=x?x.apply(this,F):F[0],oe=V.cache;if(oe.has(A))return oe.get(A);var xe=S.apply(this,F);return V.cache=oe.set(A,xe)||oe,xe};return V.cache=new(lh.Cache||ul),V}lh.Cache=ul;var Lp=lh,aS=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$p=/\\(\\)?/g,Sa=function(x){var V=Lp(x,function(A){return F.size===500&&F.clear(),A}),F=V.cache;return V}(function(S){var x=[];return S.charCodeAt(0)===46&&x.push(""),S.replace(aS,function(V,F,A,oe){x.push(A?oe.replace($p,"$1"):F||V)}),x}),sS=Sa,uh=xi?xi.prototype:void 0,dh=uh?uh.toString:void 0,iS=function S(x){if(typeof x=="string")return x;if(Ni(x))return $l(x,S)+"";if(Fp(x))return dh?dh.call(x):"";var V=x+"";return V=="0"&&1/x==-1/0?"-0":V},sy=function(x){return x==null?"":iS(x)},jp=function(x,V){return Ni(x)?x:Sd(x,V)?[x]:sS(sy(x))},fl=function(x){if(typeof x=="string"||Fp(x))return x;var V=x+"";return V=="0"&&1/x==-1/0?"-0":V},ph=function(x,V){for(var F=0,A=(V=jp(V,x)).length;x!=null&&F<A;)x=x[fl(V[F++])];return F&&F==A?x:void 0},Wa=function(x,V,F){var A=x==null?void 0:ph(x,V);return A===void 0?F:A},cS=function(x,V){return x!=null&&V in Object(x)},Cd=function(x,V,F){for(var A=-1,oe=(V=jp(V,x)).length,xe=!1;++A<oe;){var z=fl(V[A]);if(!(xe=x!=null&&F(x,z)))break;x=x[z]}return xe||++A!=oe?xe:!!(oe=x==null?0:x.length)&&Fg(oe)&&yd(z,oe)&&(Ni(x)||Zg(x))},iy=function(x,V){return x!=null&&Cd(x,V,cS)},lS=function(x,V){return Sd(x)&&oy(V)?ch(fl(x),V):function(F){var A=Wa(F,x);return A===void 0&&A===V?iy(F,x):ih(V,A,3)}},fh=function(x){return function(V){return V==null?void 0:V[x]}},uS=function(x){return function(V){return ph(V,x)}},dS=function(x){return Sd(x)?fh(fl(x)):uS(x)},Ga=function(x){return typeof x=="function"?x:x==null?hp:typeof x=="object"?Ni(x)?lS(x[0],x[1]):ay(x):dS(x)},pS=function(x,V,F){V=="__proto__"&&vp?vp(x,V,{configurable:!0,enumerable:!0,value:F,writable:!0}):x[V]=F},mh=Object.prototype.hasOwnProperty,cy=function(x,V,F){var A=x[V];mh.call(x,V)&&cp(A,F)&&(F!==void 0||V in x)||pS(x,V,F)},fS=function(x,V,F,A){if(!fi(x))return x;for(var oe=-1,xe=(V=jp(V,x)).length,z=xe-1,Ve=x;Ve!=null&&++oe<xe;){var jt=fl(V[oe]),lr=F;if(jt==="__proto__"||jt==="constructor"||jt==="prototype")return x;if(oe!=z){var fr=Ve[jt];(lr=A?A(fr,jt,Ve):void 0)===void 0&&(lr=fi(fr)?fr:yd(V[oe+1])?[]:{})}cy(Ve,jt,lr),Ve=Ve[jt]}return x},ly=function(x,V,F){for(var A=-1,oe=V.length,xe={};++A<oe;){var z=V[A],Ve=ph(x,z);F(Ve,z)&&fS(xe,jp(z,x),Ve)}return xe},uy=Xv(Object.getPrototypeOf,Object),Md=Object.getOwnPropertySymbols?function(S){for(var x=[];S;)Os(x,Jg(S)),S=uy(S);return x}:Kv,mS=function(x){var V=[];if(x!=null)for(var F in Object(x))V.push(F);return V},gS=Object.prototype.hasOwnProperty,dy=function(x){if(!fi(x))return mS(x);var V=Yv(x),F=[];for(var A in x)(A!="constructor"||!V&&gS.call(x,A))&&F.push(A);return F},hS=function(x){return bp(x)?Jv(x,!0):dy(x)},vS=function(x){return Np(x,hS,Md)},gh,py,fy=function(x,V){if(x==null)return{};var F=$l(vS(x),function(A){return[A]});return V=Ga(V),ly(x,F,function(A,oe){return V(A,oe[0])})},gy={"6_2":"getNosToken","6_22":"getOriginUrl","6_26":"getNosCdnHost","6_27":"getGrayscaleConfig","6_28":"getMixStorePolicy","6_29":"getMixStoreToken","6_30":"getFileAuthToken"},Hl={nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},mixStoreTokenReqTag:{provider:0,tokenCount:1,fileExpireSec:2,tag:3,returnBody:4},nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4},grayConfigTag:{config:0,ttl:1},mixStorePolicyTag:{providers:0,ttl:1,mixEnable:2,nosPolicy:3,s3Policy:4},mixStoreTokenResTag:{provider:0,accessKeyId:1,secretAccessKey:2,sessionToken:3,token:4,expireTime:5,bucket:6,objectName:7,fileExpireSec:8,tag:9,shortUrl:10,region:11},nosSafeUrlTag:{safeUrl:0,originUrl:1},mixStoreAuthTokenReqTag:{type:1,urls:2},mixStoreAuthTokenResTag:{type:1,tokens:2,token:3,ttl:4}},ml=Cc(Hl),hh={getNosToken:{sid:6,cid:2,service:"cloudStorage",response:[{type:"Property",name:"nosToken",reflectMapper:ml.nosToken}],params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken",reflectMapper:Hl.nosToken}]},getOriginUrl:{sid:6,cid:22,service:"cloudStorage",response:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:ml.nosSafeUrlTag}],params:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:Hl.nosSafeUrlTag}]},getNosCdnHost:{sid:6,cid:26,service:"misc",response:[{type:"Property",name:"nosConfigTag",reflectMapper:ml.nosConfigTag}]},getGrayscaleConfig:{sid:6,cid:27,service:"cloudStorage",response:[{type:"Property",name:"grayConfigTag",reflectMapper:ml.grayConfigTag}],params:[{type:"Property",name:"config"}]},getMixStorePolicy:{sid:6,cid:28,service:"cloudStorage",params:[{type:"LongArray",name:"supportType"}],response:[{type:"Property",name:"mixStorePolicyTag",reflectMapper:ml.mixStorePolicyTag}]},getMixStoreToken:{sid:6,cid:29,service:"cloudStorage",params:[{type:"Property",name:"mixStoreTokenReqTag",reflectMapper:Hl.mixStoreTokenReqTag}],response:[{type:"Property",name:"mixStoreTokenResTag",reflectMapper:ml.mixStoreTokenResTag}]},getFileAuthToken:{sid:6,cid:30,service:"cloudStorage",params:[{type:"Property",name:"mixStoreAuthTokenReqTag",reflectMapper:Hl.mixStoreAuthTokenReqTag}],response:[{type:"Property",name:"mixStoreAuthTokenResTag",reflectMapper:ml.mixStoreAuthTokenResTag}]}};(function(S){S[S.nos=1]="nos",S[S.s3=2]="s3"})(gh||(gh={})),function(S){S[S.dontNeed=-1]="dontNeed",S[S.time=2]="time",S[S.urls=3]="urls"}(py||(py={}));var zs,Ri,yS={chunkUploadHost:"https://wanproxy-web.127.net",commonUploadHost:"https://nos.netease.com",chunkMaxSize:4194304e4,commonMaxSize:104857600,uploadReplaceFormat:"https://{host}/{object}",cdn:{defaultCdnDomain:"nim.nosdn.127.net",cdnDomain:"",bucket:"",objectNamePrefix:""},downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHostList:["nos.netease.com"],nosCdnEnable:!0,isNeedToGetUploadPolicyFromServer:!0},xc={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},vh={accessKeyId:"",secretAccessKey:"",sessionToken:"",region:"",maxRetries:0,bucket:"",objectName:"",token:"",shortUrl:""};function yh(S){return S===void 0&&(S="file"),mo(xc[S]||{}).replace(/"/gi,'\\"')}(function(S){S[S.nos=1]="nos",S[S.s3=2]="s3"})(zs||(zs={})),function(S){S[S.dontNeed=-1]="dontNeed",S[S.time=2]="time",S[S.urls=3]="urls"}(Ri||(Ri={}));var hy=function(){function S(V,F){F===void 0&&(F={}),this.GRAYKEY="AllGrayscaleConfig",this.MIXSTOREKEY="AllMixStorePolicy",this.config={},this.nosCdnHostTimer=0,this.grayConfig={mixStoreEnable:!1,timeStamp:0,ttl:0},this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=zs.nos,this.s3=null,this.mixStoreErrorCount=10,this.nosErrorCount=0,this.circuitTimer=0,this.name="cloudStorage",this.logger=V.logger,this.core=V,Pi({cmdMap:gy,cmdConfig:hh}),this.setOptions(F)}var x=S.prototype;return x.setOptions=function(F){F===void 0&&(F={});var A=F.storageKeyPrefix||"NIMClient";this.GRAYKEY=A+"-AllGrayscaleConfig",this.MIXSTOREKEY=A+"-AllMixStorePolicy";var oe=F.s3,xe=xl(F,["s3"]),z=Tn({},yS,this.config);if(xe&&Object.prototype.hasOwnProperty.call(xe,"cdn")){var Ve={cdn:Tn(Tn({},z.cdn),xe.cdn)};this.config=Tn({},z,xe,Ve)}else this.config=Tn({},z,xe);oe&&(this.s3=oe)},x.init=function(){return Mr(this,void 0,void 0,ar.mark(function F(){return ar.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:if(this.grayConfig=null,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=zs.nos,this.mixStoreErrorCount=10,!this.config.isNeedToGetUploadPolicyFromServer){oe.next=9;break}return oe.next=7,this.getGrayscaleConfig(this.core.options.appkey);case 7:return oe.next=9,this.getNosCdnHost();case 9:case"end":return oe.stop()}},F,this)}))},x.uploadFile=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(Wr({maxSize:{type:"number",required:!1},type:{type:"enum",values:["file","image","audio","video"]}},F),F.fileInput||F.file||F.filePath){jt.next=3;break}throw new Error("uploadFile needs target file object or a filePath");case 3:if(!F.type||F.type==="file"){jt.next=7;break}if(typeof(oe=Wa(F,"file.type"))!="string"||pa(oe).call(oe,F.type)!==-1){jt.next=7;break}throw new Error('The meta type "'+oe+'" does not match "'+F.type+'"');case 7:if(this.grayConfig&&this.grayConfig.mixStoreEnable&&this.mixStorePolicy.providers.length){jt.next=10;break}return this.logger.log("uploadFile:: uploadFile begin, use old nos"),jt.abrupt("return",this.nosUpload(F));case 10:return this.logger.log("uploadFile:: uploadFile begin,Current settings grayConfig mixStoreEnable:"+this.grayConfig.mixStoreEnable+" curProvider:"+this.curProvider),this.s3||(this.curProvider=zs.nos),xe=vh,jt.prev=13,jt.next=16,this.core.sendCmd("getMixStoreToken",{mixStoreTokenReqTag:{provider:this.curProvider,tokenCount:1,tag:"qchat",returnBody:yh(F.type)}});case 16:z=jt.sent,xe=z.content.mixStoreTokenResTag,jt.next=24;break;case 20:throw jt.prev=20,jt.t0=jt.catch(13),this.core.logger.error("uploadFile:: getMixStoreToken error",jt.t0),new Tc("getMixStoreToken error",jt.t0,this.curProvider,this.mixStorePolicy);case 24:return jt.abrupt("return",this.curProvider===zs.s3?this.s3Upload(F,xe):this.nosUpload(F,xe));case 25:case"end":return jt.stop()}},A,this,[[13,20]])}))},x.nosUpload=function(F,A){var oe,xe;return Mr(this,void 0,void 0,ar.mark(function z(){var Ve,jt,lr,fr,Sr,br,Er,Dr,$r,vn,Yr,wn,Zr;return ar.wrap(function(Dn){for(;;)switch(Dn.prev=Dn.next){case 0:if(Ve=Wa(this.core,"config.cdn.bucket"),jt={tag:F.nosScenes||Ve||"nim",expireSec:F.nosSurvivalTime},A){Dn.next=13;break}return Dn.prev=3,Dn.next=6,this.core.sendCmd("getNosToken",{responseBody:yh(F.type),nosToken:jt});case 6:lr=Dn.sent,Dn.next=13;break;case 9:throw Dn.prev=9,Dn.t0=Dn.catch(3),this.core.logger.error("uploadFile:: getNosToken error",Dn.t0),new Tc("getNosToken error",Dn.t0,1);case 13:return Dn.prev=13,Sr=lr?lr.content.nosToken:A,this.core.logger.debug("uploadFile:: uploadFile params",{nosToken:Sr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,platform:ta.platform}),Dn.next=18,this.core.adapters.uploadFile(Tn(Tn({},F),{nosToken:Sr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,maxSize:F.maxSize||this.config.chunkMaxSize}));case 18:fr=Dn.sent,Dn.next=42;break;case 21:if(Dn.prev=21,Dn.t1=Dn.catch(13),this.core.logger.error("uploadFile::nos uploadFile error",Dn.t1),!A){Dn.next=41;break}if(this.nosErrorCount!==0){Dn.next=37;break}Dn.prev=26,this._addCircuitTimer(),Dn.next=33;break;case 30:throw Dn.prev=30,Dn.t2=Dn.catch(26),new Tc("upload file error",Dn.t2,this.curProvider,this.mixStorePolicy,F.file||F.filePath);case 33:return this.nosErrorCount=(oe=this.mixStorePolicy.nosPolicy)===null||oe===void 0?void 0:oe.uploadConfig.retryPolicy.retry,Dn.abrupt("return",this.uploadFile(F));case 37:return this.nosErrorCount--,Dn.abrupt("return",this.nosUpload(F,A));case 39:Dn.next=42;break;case 41:throw new Tc("nos uploadFile error",Dn.t1,1);case 42:if(br=fr==null?void 0:fr.type,Er=br&&pa(br).call(br,"/")>-1?Co(br).call(br,0,pa(br).call(br,"/")):"",Dr={image:"imageInfo",video:"vinfo",audio:"vinfo"},$r=this.config.uploadReplaceFormat.replace("{host}",this.config.cdn.cdnDomain||this.config.cdn.defaultCdnDomain).replace("{object}",lr?lr.content.nosToken.objectName:A==null?void 0:A.objectName),A&&A.shortUrl&&($r=A.shortUrl),Dr[Er]){Dn.next=49;break}return Dn.abrupt("return",Tn({url:$r},fr));case 49:if(Dn.prev=49,!(pa($r).call($r,"_im_url=1")<0)){Dn.next=54;break}return Dn.next=53,this.core.adapters.request($r+"?"+Dr[Er],{method:"GET",dataType:"json",timeout:5e3});case 53:vn=Dn.sent;case 54:Dn.next=60;break;case 56:return Dn.prev=56,Dn.t3=Dn.catch(49),this.core.logger.error("uploadFile:: fetch file info error",Dn.t3),Dn.abrupt("return",Tn({url:$r},fr));case 60:if(!vn){Dn.next=67;break}return Yr=vn.data,wn=Dr[Er]==="imageInfo"?Yr:(xe=Yr==null?void 0:Yr.GetVideoInfo)===null||xe===void 0?void 0:xe.VideoInfo,Zr={url:$r,name:fr.name,size:fr.size,ext:fr.ext,w:wn.Width,h:wn.Height,orientation:wn.Orientation,dur:wn.Duration,audioCodec:wn.AudioCodec,videoCodec:wn.VideoCodec,container:wn.Container},Dn.abrupt("return",fy(Zr,function(jo,jn){return jn!==void 0}));case 67:return Dn.abrupt("return",Tn({url:$r},fr));case 68:case"end":return Dn.stop()}},z,this,[[3,9],[13,21],[26,30],[49,56]])}))},x.getNosCdnHost=function(){var F;return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve=this;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return lr.prev=0,lr.next=3,this.core.sendCmd("getNosCdnHost");case 3:oe=lr.sent,lr.next=10;break;case 6:return lr.prev=6,lr.t0=lr.catch(0),this.logger.error("getNosCdnHost::error",lr.t0),lr.abrupt("return");case 10:if(oe){lr.next=12;break}return lr.abrupt("return");case 12:xe=(F=oe==null?void 0:oe.content)===null||F===void 0?void 0:F.nosConfigTag,(z=Lo(xe==null?void 0:xe.expire))!==0&&xe.cdnDomain?z===-1?(this.config.cdn.bucket=xe.bucket,this.config.cdn.cdnDomain=xe.cdnDomain,this.config.cdn.objectNamePrefix=xe.objectNamePrefix):(this.config.cdn.bucket=xe.bucket,this.config.cdn.cdnDomain=xe.cdnDomain,this.config.cdn.objectNamePrefix=xe.objectNamePrefix,this.nosCdnHostTimer=this.core.timerManager.addTimer(function(){Ve.getNosCdnHost()},1e3*z)):(this.config.cdn.bucket="",this.config.cdn.cdnDomain="",this.config.cdn.objectNamePrefix="");case 15:case"end":return lr.stop()}},A,this,[[0,6]])}))},x.getGrayscaleConfig=function(F){var A;return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(ta.localStorage)try{ta.localStorage.getItem&&ta.localStorage.getItem(this.GRAYKEY)&&(this.grayConfig=JSON.parse(ta.localStorage.getItem(this.GRAYKEY))[F])}catch(lr){ta.localStorage.getItem(this.GRAYKEY)&&this.core.logger.error("uploadFile:: JSON.parse grayscaleConfig error ",lr)}if(this.grayConfig&&!(this.grayConfig.timeStamp+1e3*this.grayConfig.ttl<new Date().getTime())){jt.next=17;break}return jt.next=4,this.core.sendCmd("getGrayscaleConfig",{config:{}});case 4:if(!(xe=jt.sent).content||!xe.content.grayConfigTag){jt.next=16;break}this.logger.log("uploadFile::getAppGrayConfigRequest success ");try{this.grayConfig=JSON.parse(xe.content.grayConfigTag.config),this.grayConfig.ttl=JSON.parse(xe.content.grayConfigTag.ttl)}catch(lr){this.logger.error("getGrayscaleConfig error",lr)}if(this.grayConfig){jt.next=10;break}return jt.abrupt("return");case 10:z=ta.localStorage.getItem(this.GRAYKEY)?JSON.parse(ta.localStorage.getItem(this.GRAYKEY)):{},this.grayConfig.timeStamp=new Date().getTime(),z[F]=this.grayConfig,ta.localStorage.setItem(this.GRAYKEY,mo(z)),jt.next=17;break;case 16:this.logger.debug("uploadFile:: result grayConfig:",xe.content);case 17:if(!(!((A=this.grayConfig)===null||A===void 0)&&A.mixStoreEnable)){jt.next=20;break}return jt.next=20,this._getMixStorePolicy(F);case 20:case"end":return jt.stop()}},oe,this)}))},x._getMixStorePolicy=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve,jt,lr,fr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(oe=new Date().getTime(),ta.localStorage)try{this.mixStorePolicy=JSON.parse(ta.localStorage.getItem(this.MIXSTOREKEY))[F],this.curProvider=Lo(this.mixStorePolicy.providers[0]),this.mixStorePolicy.timeStamp&&this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl>oe&&(z=this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl-oe,this.core.timerManager.addTimer(Oo(xe=this._getMixStorePolicy).call(xe,this,F),z))}catch(Er){ta.localStorage.getItem(this.MIXSTOREKEY)&&JSON.parse(ta.localStorage.getItem(this.MIXSTOREKEY))[F]&&this.core.logger.error("uploadFile:: JSON.parse mixStorePolicy error ",Er)}if(this.mixStorePolicy&&!(this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl<=oe)){br.next=30;break}return br.prev=3,br.next=6,this.core.sendCmd("getMixStorePolicy",{supportType:this.s3?[1,2]:[1]});case 6:jt=br.sent,lr=jt.content.mixStorePolicyTag,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.mixStorePolicy.ttl=Number(lr.ttl),this.mixStorePolicy.providers=lr.providers.split(","),this.circuitTimer&&this.core.timerManager.deleteTimer(this.circuitTimer),this.curProvider=Lo(this.mixStorePolicy.providers[0]),this.mixStorePolicy.nosPolicy=lr.nosPolicy?JSON.parse(lr.nosPolicy):null,this.mixStorePolicy.s3Policy=lr.s3Policy?JSON.parse(lr.s3Policy):null,this.mixStorePolicy.s3Policy===null?this.mixStorePolicy.providers=["1"]:this.mixStorePolicy.nosPolicy===null?this.mixStorePolicy.providers=["2"]:this.mixStorePolicy.providers=this.mixStorePolicy.s3Policy.priority<this.mixStorePolicy.nosPolicy.priority?["2","1"]:["1","2"],this.core.timerManager.addTimer(Oo(Ve=this._getMixStorePolicy).call(Ve,this,F),1e3*this.mixStorePolicy.ttl),fr=ta.localStorage.getItem(this.MIXSTOREKEY)?JSON.parse(ta.localStorage.getItem(this.MIXSTOREKEY)):{},this.mixStorePolicy.timeStamp=new Date().getTime(),fr[F]=this.mixStorePolicy,ta.localStorage.setItem(this.MIXSTOREKEY,mo(fr)),br.next=30;break;case 23:if(br.prev=23,br.t0=br.catch(3),this.logger.error("getMixStorePolicy error",br.t0),this.mixStoreErrorCount!==0){br.next=28;break}throw new Error("getMixStorePolicy all count error");case 28:this._getMixStorePolicy(F),this.mixStoreErrorCount--;case 30:this.mixStorePolicy.nosPolicy&&(this.nosErrorCount=this.mixStorePolicy.nosPolicy.uploadConfig.retryPolicy.retry);case 31:case"end":return br.stop()}},A,this,[[3,23]])}))},x.s3Upload=function(F,A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt,lr,fr,Sr,br,Er,Dr,$r=this;return ar.wrap(function(Yr){for(;;)switch(Yr.prev=Yr.next){case 0:if(!F.file){Yr.next=4;break}xe=F.file,Yr.next=19;break;case 4:if(typeof F.fileInput!="string"){Yr.next=14;break}if(this.logger.warn("fileInput will abandon,Please use file or filepath"),!((z=document.getElementById(F.fileInput))&&z.files&&z.files[0])){Yr.next=11;break}xe=z.files[0],Yr.next=12;break;case 11:throw new Error("Can not get file from fileInput");case 12:Yr.next=19;break;case 14:if(!(F.fileInput&&F.fileInput.files&&F.fileInput.files[0])){Yr.next=18;break}xe=F.fileInput.files[0],Yr.next=19;break;case 18:throw new Error("Can not get file from fileInput "+F.fileInput);case 19:if(this.mixStorePolicy.s3Policy){Yr.next=21;break}throw new Error("dont get s3 policy");case 21:return Ve={accessKeyId:A.accessKeyId,secretAccessKey:A.secretAccessKey,sessionToken:A.sessionToken,region:A.region,maxRetries:this.mixStorePolicy.s3Policy.uploadConfig.retryPolicy.retry},jt=this.s3,(lr=new jt).config.update(Ve),fr=decodeURIComponent(A.bucket),Sr=decodeURIComponent(A.objectName),Er={Bucket:fr,Key:Sr,Body:br=xe,Metadata:{token:A.token},ContentType:br.type||"application/octet-stream"},this.core.logger.debug("uploadFile:: s3 upload params:",Er),Dr=lr.upload(Er),Yr.abrupt("return",new uo(function(wn){var Zr=new Date().getTime();Dr.send(function(Qn,Dn){var jo,jn;if(Qn){$r.logger.error("uploadFile:","api::s3:upload file failed",Qn),$r.core.reporter.reportTraceStart("exceptions",{user_id:$r.core.options.account,trace_id:(jn=(jo=$r.core)===null||jo===void 0?void 0:jo.socket)===null||jn===void 0?void 0:jn.sessionId,start_time:Zr,action:1}),$r.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof Qn.status=="number"?Qn.status:typeof Qn.code=="number"?Qn.code:0,description:Qn.message||""+Qn.code,operation_type:1,target:Qn.hostname}),$r.core.reporter.reportTraceEnd("exceptions",1);try{$r._addCircuitTimer()}catch(xn){throw new Tc("upload file error",xn,$r.curProvider,$r.mixStorePolicy,F.file||F.filePath)}wn($r.uploadFile(F))}else{var wr=$r.mixStorePolicy.s3Policy.cdnSchema;wr=(wr=wr.replace("{cdnDomain}",$r.mixStorePolicy.s3Policy.dlcdn)).replace("{objectName}",Dn.Key),wn({size:br.size,name:br.name,url:A.shortUrl?A.shortUrl:wr,ext:br.name.split(".")[1]||"unknown"})}})}));case 32:case"end":return Yr.stop()}},oe,this)}))},x.getPrivateUrl=function(F){var A;if(!new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?/).test(F))return this.logger.error("illegal file url:"+F),"";var oe=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/.exec(F);oe[0];var xe=oe[1];oe[2];var z=oe[3];oe[4];var Ve=oe[5];if(oe[6],oe[7],(A=this.grayConfig)===null||A===void 0?void 0:A.mixStoreEnable){var jt=this._getUrlType(F);return jt===zs.s3&&this.mixStorePolicy.s3Policy&&(F=this.mixStorePolicy.s3Policy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.s3Policy.dlcdn).replace("{objectName}",Ve)),jt===zs.nos&&this.mixStorePolicy.nosPolicy&&(F=this.mixStorePolicy.nosPolicy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.nosPolicy.dlcdn).replace("{objectName}",Ve)),F}var lr=this.config,fr=lr.downloadUrl,Sr=lr.downloadHostList,br=lr.nosCdnEnable,Er=this.config.cdn.cdnDomain,Dr=this.config.cdn.objectNamePrefix?decodeURIComponent(this.config.cdn.objectNamePrefix):"",$r=decodeURIComponent(Ve),vn=pa($r).call($r,Dr);if(Er&&vn>-1&&br)return""+xe+Er+"/"+Co($r).call($r,vn);if(gi(Sr).call(Sr,z)&&gi(Ve).call(Ve,"/")){var Yr=pa(Ve).call(Ve,"/"),wn=Ve.substring(0,Yr),Zr=Ve.substring(Yr+1);return fr.replace("{bucket}",wn).replace("{object}",Zr)}var Qn=Ys(Sr).call(Sr,function(jo){return typeof z=="string"&&gi(z).call(z,jo)})[0],Dn=Qn?z.replace(Qn,"").replace(/\W/g,""):null;return Dn?fr.replace("{bucket}",Dn).replace("{object}",Ve):F},x.getOriginUrl=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.core.sendCmd("getOriginUrl",{nosSafeUrlTag:{safeUrl:F}});case 2:return oe=z.sent,z.abrupt("return",oe.content.nosSafeUrlTag.originUrl);case 4:case"end":return z.stop()}},A,this)}))},x.getFileToken=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve,jt,lr=this;return ar.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:if(Wr({type:{type:"number",min:2,max:3},urls:{type:"array",required:!1,itemType:"string"}},F),oe=this.mixStorePolicy.nosPolicy?this.mixStorePolicy.nosPolicy.authPolicy.policyType:null,xe=this.mixStorePolicy.s3Policy?this.mixStorePolicy.s3Policy.authPolicy.policyType:null,oe!==String(Ri.dontNeed)||xe!==String(Ri.dontNeed)){Sr.next=8;break}throw this.logger.error("don't need token"),new Error("don't need token");case 8:if(F.type!==Ri.time){Sr.next=17;break}if(!(oe&&pa(oe).call(oe,String(Ri.time))>=0||xe&&pa(xe).call(xe,String(Ri.time))>0)){Sr.next=13;break}return Sr.abrupt("return",this.getFileAuthToken(F));case 13:throw this.logger.error("don't support time token "),new Error("don't support type time token ");case 15:Sr.next=33;break;case 17:if(F.urls&&F.urls.length){Sr.next=20;break}throw this.logger.error("urls is required when urls token"),new Error("urls is required when urls token");case 20:if(Ve=[],jt=[],In(z=F.urls).call(z,function(br){var Er=lr._getUrlType(br);Er===zs.nos&&jt.push(br),Er===zs.s3&&Ve.push(br)}),(!xe||Ve.length!==0&&pa(xe).call(xe,String(Ri.urls))<0)&&(this.logger.warn("s3 url don't support url token"),Ve=[]),(!oe||jt.length!==0&&pa(oe).call(oe,String(Ri.urls))<0)&&(this.logger.warn("nos url don't support url token"),jt=[]),Ve.length!==0||jt.length!==0){Sr.next=30;break}throw this.logger.error("not support urls"),new Error("not support urls");case 30:if(Ve.length!==0&&jt.length!==0){Sr.next=33;break}return F.urls=mo(F.urls),Sr.abrupt("return",this.getFileAuthToken(F));case 33:case"end":return Sr.stop()}},A,this)}))},x.getFileAuthToken=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.core.sendCmd("getFileAuthToken",{mixStoreAuthTokenReqTag:F});case 2:return oe=z.sent,z.abrupt("return",oe.content.mixStoreAuthTokenResTag);case 4:case"end":return z.stop()}},A,this)}))},x._getUrlType=function(F){var A,oe;return this.mixStorePolicy.nosPolicy&&Ap(A=this.mixStorePolicy.nosPolicy.dlcdns).call(A,function(xe){return pa(F).call(F,xe)>=0})?zs.nos:this.mixStorePolicy.s3Policy&&Ap(oe=this.mixStorePolicy.s3Policy.dlcdns).call(oe,function(xe){return pa(F).call(F,xe)>=0})?zs.s3:null},x._addCircuitTimer=function(){var F=this,A=this.mixStorePolicy.providers,oe=A[(pa(A).call(A,String(this.curProvider))+1)%A.length];if(oe===A[0])throw new Error("uploadFile all policy fail");var xe=Wa(this.mixStorePolicy,"s3Policy.uploadConfig.retryPolicy");if(xe&&xe.retryNext&&oe&&(this.logger.log("uploadFile:: upload policy will change,now policy:"+this.curProvider+" nextProvider:"+oe),this.curProvider=Lo(oe),this.mixStorePolicy.nosPolicy&&this.mixStorePolicy.s3Policy)){var z=this.mixStorePolicy[this.curProvider===zs.nos?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!z||z===0)return;this.circuitTimer=this.core.timerManager.addTimer(function(){F.logger.log("uploadFile:: upload policy will change,now policy:"+F.curProvider+" nextProvider:"+Lo(F.mixStorePolicy.providers[0])),F.curProvider=Lo(F.mixStorePolicy.providers[0]),F.core.timerManager.deleteTimer(F.circuitTimer)},1e3*z)}},x.process=function(F){var A=this[F.cmd+"Handler"];return typeof A=="function"?A.call(this,F):F.error&&!F.error.ignore?uo.reject(F.error):uo.resolve(F)},S}(),kd=Math.floor,Dp=function(S,x){var V=S.length,F=kd(V/2);return V<8?vy(S,x):bS(S,Dp(mu(S,0,F),x),Dp(mu(S,F),x),x)},vy=function(S,x){for(var V,F,A=S.length,oe=1;oe<A;){for(F=oe,V=S[oe];F&&x(S[F-1],V)>0;)S[F]=S[--F];F!==oe++&&(S[F]=V)}return S},bS=function(S,x,V,F){for(var A=x.length,oe=V.length,xe=0,z=0;xe<A||z<oe;)S[xe+z]=xe<A&&z<oe?F(x[xe],V[z])<=0?x[xe++]:V[z++]:xe<A?x[xe++]:V[z++];return S},zl=Dp,yy=or.match(/firefox\/(\d+)/i),ic=!!yy&&+yy[1],as=/MSIE|Trident/.test(or),by=or.match(/AppleWebKit\/(\d+)\./),Ty=!!by&&+by[1],cc=[],Kl=he(cc.sort),TS=he(cc.push),Sy=c(function(){cc.sort(void 0)}),SS=c(function(){cc.sort(null)}),Cy=Us("sort"),bh=!c(function(){if(mr)return mr<70;if(!(ic&&ic>3)){if(as)return!0;if(Ty)return Ty<603;var S,x,V,F,A="";for(S=65;S<76;S++){switch(x=String.fromCharCode(S),S){case 66:case 69:case 70:case 72:V=3;break;case 68:case 71:V=4;break;default:V=2}for(F=0;F<47;F++)cc.push({k:x+F,v:V})}for(cc.sort(function(oe,xe){return xe.v-oe.v}),F=0;F<cc.length;F++)x=cc[F].k.charAt(0),A.charAt(A.length-1)!==x&&(A+=x);return A!=="DGBEFHACIJK"}});Vr({target:"Array",proto:!0,forced:Sy||!SS||!Cy||!bh},{sort:function(x){x!==void 0&&Or(x);var V=$n(this);if(bh)return x===void 0?Kl(V):Kl(V,x);var F,A,oe=[],xe=Ia(V);for(A=0;A<xe;A++)A in V&&TS(oe,V[A]);for(zl(oe,function(z){return function(Ve,jt){return jt===void 0?-1:Ve===void 0?1:z!==void 0?+z(Ve,jt)||0:Oa(Ve)>Oa(jt)?1:-1}}(x)),F=Ia(oe),A=0;A<F;)V[A]=oe[A++];for(;A<xe;)xp(V,A++);return V}});var Ic,Ti,Up,Bi=Uo("Array").sort,_d=Array.prototype,Wl=function(S){var x=S.sort;return S===_d||rr(_d,S)&&x===_d.sort?Bi:x};(function(S){S[S.ASC=1]="ASC",S[S.DESC=2]="DESC"})(Ic||(Ic={})),function(S){S[S.reorderWeight=0]="reorderWeight",S[S.createTime=1]="createTime",S[S.totalMember=2]="totalMember"}(Ti||(Ti={})),function(S){S[S.square=1]="square",S[S.person=2]="person"}(Up||(Up={}));var gl=function(){function S(x,V){this.name=x,this.core=V,this.name=x,this.logger=V.logger,this.core=V}return S.prototype.process=function(V){var F=this[V.cmd+"Handler"];return typeof F=="function"?F.call(this,V):V.error&&!V.error.ignore?uo.reject(V.error):uo.resolve(V)},S}(),wd={"24_15":"qchatSubscribe","24_27":"qchatGetUnreadInfo","24_48":"qchatCreateChannel","24_49":"qchatDeleteChannel","24_50":"qchatUpdateChannel","24_51":"qchatGetChannels","24_52":"qchatGetChannelsByPage","24_53":"qchatGetMembersByPage","24_54":"qchatUpdateWhiteBlackRole","24_55":"qchatGetWhiteBlackRolesPage","24_56":"qchatUpdateWhiteBlackMembers","24_57":"qchatGetWhiteBlackMembersPage","24_58":"qchatGetExistingWhiteBlackRoles","24_59":"qchatGetExistingWhiteBlackMembers","24_60":"qchatUpdateCategoryInfoOfChannel","24_109":"qchatCreateChannelCategory","24_110":"qchatRemoveChannelCategory","24_111":"qchatUpdateChannelCategory","24_112":"qchatGetChannelCategoriesByID","24_113":"qchatUpdateChannelCategoryWhiteBlackRole","24_114":"qchatGetChannelCategoryWhiteBlackRolesPage","24_115":"qchatUpdateChannelCategoryWhiteBlackMembers","24_116":"qchatGetChannelCategoryWhiteBlackMembersPage","24_117":"qchatGetChannelCategoryWhiteBlackRoles","24_118":"qchatGetChannelCategoryWhiteBlackMembers","24_119":"qchatGetChannelCategoriesPage","24_120":"qchatGetChannelCategoryChannelsPage","24_93":"qchatGetChannelSearchByPage","24_95":"qchatChannelMemberSearch","25_8":"qchatGetRoleIdsByServerId","25_9":"qchatSubscribeAsVisitor"},Th={serverId:1,channelId:2,ackTimestamp:3,unreadCount:4,mentionedCount:5,maxCount:6,lastMsgTime:7},Yo={channelInfo:{channelId:1,serverId:2,name:4,topic:5,ext:6,type:7,validFlag:8,createTime:9,updateTime:10,owner:11,viewMode:12,categoryId:13,syncMode:14,reorderWeight:15,visitorMode:16},antispamTag:{antiSpamBusinessId:1},memberInfo:{serverId:1,accid:3,nick:4,avatar:5,ext:6,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},serverRole:{serverId:1,roleId:2,name:3,icon:4,ext:5,auths:6,type:7,memberCount:8,priority:9,createTime:10,updateTime:11},qchatSubReqTag:{type:1,opeType:2},qchatChannelIdInfoTag:{serverId:1,channelId:2},unreadInfo:Th,qchatGetChannelListPageTag:{serverId:1,timetag:2,limit:3},qchatGetMembersByPageTag:{serverId:1,channelId:2,timetag:3,limit:4},qchatUpdateWhiteBlackRoleTag:{serverId:1,channelId:2,type:3,opeType:4,roleId:5},qchatGetWhiteBlackRolesPageTag:{serverId:1,channelId:2,type:3,timetag:4,limit:5},qchatUpdateWhiteBlackMembersTag:{serverId:1,channelId:2,type:3,opeType:4,toAccids:5},qchatGetWhiteBlackMembersPageTag:{serverId:1,channelId:2,type:3,timetag:4,limit:5},qchatGetExistingWhiteBlackRolesTag:{serverId:1,channelId:2,type:3,roleIds:4},qchatGetExistingWhiteBlackMembersTag:{serverId:1,channelId:2,type:3,accids:4},QChatChannelCategoryInfo:{categoryId:1,serverId:2,name:4,ext:5,owner:6,viewMode:7,validFlag:8,createTime:9,updateTime:10,channelNumber:11},qchatUpdateChannelCategoryWhiteBlackRoleTag:{serverId:1,categoryId:2,type:3,opeType:4,roleId:5},qchatGetChannelCategoryWhiteBlackRolesPageTag:{serverId:1,categoryId:2,type:3,timetag:4,limit:5},qchatUpdateChannelCategoryWhiteBlackMembersTag:{serverId:1,categoryId:2,type:3,opeType:4,toAccids:5},qchatGetChannelCategoryWhiteBlackMembersPageTag:{serverId:1,categoryId:2,type:3,timetag:4,limit:5},qchatGetChannelCategoryWhiteBlackRolesTag:{serverId:1,categoryId:2,type:3,roleIds:4},qchatGetChannelCategoryWhiteBlackMembersTag:{serverId:1,categoryId:2,type:3,accids:4},qchatGetChannelCategoriesPageTag:{serverId:1,timetag:2,limit:3},qchatGetChannelCategoryChannelsPageTag:{serverId:1,categoryId:2,timetag:3,limit:4},qchatGetChannelSearchByPageTag:{keyword:1,startTime:2,endTime:3,order:4,limit:5,serverId:6,sort:7,cursor:8},qchatUpdateChannelTag:{channelId:1,name:4,topic:5,ext:6,viewMode:12,visitorMode:16},serverRoles:{serverId:1,roleIds:2,timeTag:3},qchatChannelMemberSearchTag:{serverId:1,channelId:2,keyword:3,limit:4},qchatChannelMemberInfo:{serverId:1,channelId:2,avatar:3,accid:4,nick:5,createTime:6,updateTime:7}},zo=Cc(Yo),Sh={qchatCreateChannel:{sid:24,cid:48,service:"qchatChannel",params:[{type:"Property",name:"channelInfo",reflectMapper:Yo.channelInfo},{type:"Property",name:"antispamTag",reflectMapper:Yo.antispamTag}],response:[{type:"Property",name:"channelInfo",reflectMapper:zo.channelInfo}]},qchatDeleteChannel:{sid:24,cid:49,service:"qchatChannel",params:[{type:"Long",name:"channelId"}]},qchatUpdateChannel:{sid:24,cid:50,service:"qchatChannel",params:[{type:"Property",name:"channelInfo",reflectMapper:Yo.qchatUpdateChannelTag},{type:"Property",name:"antispamTag",reflectMapper:Yo.antispamTag}],response:[{type:"Property",name:"channelInfo",reflectMapper:zo.channelInfo}]},qchatGetChannels:{sid:24,cid:51,service:"qchatChannel",params:[{type:"LongArray",name:"channelIds"}],response:[{type:"PropertyArray",name:"channelList",reflectMapper:zo.channelInfo}]},qchatGetChannelsByPage:{sid:24,cid:52,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelListPageTag",reflectMapper:Yo.qchatGetChannelListPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.channelInfo}]},qchatGetMembersByPage:{sid:24,cid:53,service:"qchatChannel",params:[{type:"Property",name:"qchatGetMembersByPageTag",reflectMapper:Yo.qchatGetMembersByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.memberInfo}]},qchatUpdateWhiteBlackRole:{sid:24,cid:54,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateWhiteBlackRoleTag",reflectMapper:Yo.qchatUpdateWhiteBlackRoleTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.memberInfo}]},qchatGetWhiteBlackRolesPage:{sid:24,cid:55,service:"qchatChannel",params:[{type:"Property",name:"qchatGetWhiteBlackRolesPageTag",reflectMapper:Yo.qchatGetWhiteBlackRolesPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.serverRole}]},qchatUpdateWhiteBlackMembers:{sid:24,cid:56,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateWhiteBlackMembersTag",reflectMapper:Yo.qchatUpdateWhiteBlackMembersTag}]},qchatGetWhiteBlackMembersPage:{sid:24,cid:57,service:"qchatChannel",params:[{type:"Property",name:"qchatGetWhiteBlackMembersPageTag",reflectMapper:Yo.qchatGetWhiteBlackMembersPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.memberInfo}]},qchatGetExistingWhiteBlackRoles:{sid:24,cid:58,service:"qchatChannel",params:[{type:"Property",name:"qchatGetExistingWhiteBlackRolesTag",reflectMapper:Yo.qchatGetExistingWhiteBlackRolesTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:zo.serverRole}]},qchatGetExistingWhiteBlackMembers:{sid:24,cid:59,service:"qchatChannel",params:[{type:"Property",name:"qchatGetExistingWhiteBlackMembersTag",reflectMapper:Yo.qchatGetExistingWhiteBlackMembersTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:zo.memberInfo}]},qchatUpdateCategoryInfoOfChannel:{sid:24,cid:60,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateCategoryInfoOfChannelTag",reflectMapper:Yo.channelInfo}],response:[{type:"Property",name:"channelInfo",reflectMapper:zo.channelInfo}]},qchatCreateChannelCategory:{sid:24,cid:109,service:"qchatChannel",params:[{type:"Property",name:"qchatCreateChannelCategoryTag",reflectMapper:Yo.QChatChannelCategoryInfo}],response:[{type:"Property",name:"QChatChannelCategoryInfo",reflectMapper:zo.QChatChannelCategoryInfo}]},qchatRemoveChannelCategory:{sid:24,cid:110,service:"qchatChannel",params:[{type:"Long",name:"categoryId"}]},qchatUpdateChannelCategory:{sid:24,cid:111,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateChannelCategoryTag",reflectMapper:Yo.QChatChannelCategoryInfo}],response:[{type:"Property",name:"QChatChannelCategoryInfo",reflectMapper:zo.QChatChannelCategoryInfo}]},qchatGetChannelCategoriesByID:{sid:24,cid:112,service:"qchatChannel",params:[{type:"LongArray",name:"categoryIds"}],response:[{type:"PropertyArray",name:"channelCategoryList",reflectMapper:zo.QChatChannelCategoryInfo}]},qchatUpdateChannelCategoryWhiteBlackRole:{sid:24,cid:113,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateChannelCategoryWhiteBlackRoleTag",reflectMapper:Yo.qchatUpdateChannelCategoryWhiteBlackRoleTag}]},qchatGetChannelCategoryWhiteBlackRolesPage:{sid:24,cid:114,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackRolesPageTag",reflectMapper:Yo.qchatGetChannelCategoryWhiteBlackRolesPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.serverRole}]},qchatUpdateChannelCategoryWhiteBlackMembers:{sid:24,cid:115,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateChannelCategoryWhiteBlackMembersTag",reflectMapper:Yo.qchatUpdateChannelCategoryWhiteBlackMembersTag}]},qchatGetChannelCategoryWhiteBlackMembersPage:{sid:24,cid:116,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackMembersPageTag",reflectMapper:Yo.qchatGetChannelCategoryWhiteBlackMembersPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.memberInfo}]},qchatGetChannelCategoryWhiteBlackRoles:{sid:24,cid:117,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackRolesTag",reflectMapper:Yo.qchatGetChannelCategoryWhiteBlackRolesTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:zo.serverRole}]},qchatGetChannelCategoryWhiteBlackMembers:{sid:24,cid:118,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackMembersTag",reflectMapper:Yo.qchatGetChannelCategoryWhiteBlackMembersTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:zo.memberInfo}]},qchatGetChannelCategoriesPage:{sid:24,cid:119,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoriesPageTag",reflectMapper:Yo.qchatGetChannelCategoriesPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.QChatChannelCategoryInfo}]},qchatGetChannelCategoryChannelsPage:{sid:24,cid:120,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryChannelsPageTag",reflectMapper:Yo.qchatGetChannelCategoryChannelsPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.channelInfo}]},qchatSubscribe:{sid:24,cid:15,service:"qchatChannel",params:[{type:"Property",name:"qchatSubReqTag",reflectMapper:Yo.qchatSubReqTag},{type:"PropertyArray",name:"channels",reflectMapper:Yo.qchatChannelIdInfoTag}],response:[{type:"PropertyArray",name:"unreadInfos",reflectMapper:zo.unreadInfo},{type:"PropertyArray",name:"failedChannels",reflectMapper:zo.qchatChannelIdInfoTag}]},qchatGetUnreadInfo:{sid:24,cid:27,service:"qchatChannel",params:[{type:"PropertyArray",name:"channels",reflectMapper:Yo.qchatChannelIdInfoTag}],response:[{type:"PropertyArray",name:"unreadInfos",reflectMapper:zo.unreadInfo}]},qchatGetChannelSearchByPage:{sid:24,cid:93,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelSearchByPageTag",reflectMapper:Yo.qchatGetChannelSearchByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag",3:"cursor"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.channelInfo}]},qchatGetRoleIdsByServerId:{sid:25,cid:8,service:"qchatChannel",params:[{type:"Property",name:"qchatGetRoleIdsByServerIdTag",reflectMapper:{serverIdTimeTags:1}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:zo.serverRoles},{type:"LongArray",name:"failServerIds"}]},qchatChannelMemberSearch:{sid:24,cid:95,service:"qchatChannel",params:[{type:"Property",name:"qchatChannelMemberSearchTag",reflectMapper:Yo.qchatChannelMemberSearchTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:zo.qchatChannelMemberInfo}]},qchatSubscribeAsVisitor:{sid:25,cid:9,service:"qchatChannel",params:[{type:"Property",name:"tag",reflectMapper:Yo.qchatSubReqTag},{type:"PropertyArray",name:"datas",reflectMapper:Yo.qchatChannelIdInfoTag}],response:[{type:"PropertyArray",name:"failedArr",reflectMapper:zo.qchatChannelIdInfoTag}]}},My={"24_31":"qchatCreateServer","24_32":"qchatDeleteServer","24_33":"qchatUpdateServer","24_34":"qchatGetServers","24_35":"qchatGetServersByPage","24_36":"qchatInviteServerMembers","24_37":"qchatAcceptServerInvite","24_38":"qchatRejectInviteServer","24_39":"qchatApplyServerJoin","24_40":"qchatAcceptServerApply","24_41":"qchatRejectServerApply","24_42":"qchatKickServerMembers","24_43":"qchatLeaveServer","24_44":"qchatUpdateMyMemberInfo","24_45":"qchatUpdateServerMemberInfo","24_46":"qchatGetServerMembers","24_47":"qchatGetServerMembersByPage","24_104":"qchatUpdateServerMemberBan","24_105":"qchatGetBannedMembersByPage","24_91":"qchatServerSearchByPage","24_92":"qchatServerMemberSearchByPage","24_122":"qchatGenerateInviteCode","24_123":"qchatJoinByInviteCode","24_124":"qchatGetInviteApplyRecordOfServer","24_125":"qchatGetInviteApplyRecordOfSelf","25_5":"qchatClearServersUnread","25_7":"qchatSubscribeChannelsByServers","25_10":"qchatEnterAsVisitor","25_11":"qchatLeaveAsVisitor"},Ha={serverInfo:{serverId:1,name:3,icon:4,ext:5,owner:6,memberNumber:7,inviteMode:8,applyMode:9,validFlag:10,createTime:11,updateTime:12,channelNumber:13,categoryNumber:14,searchType:15,searchEnable:16,reorderWeight:17},antispamTag:{antiSpamBusinessId:1},memberInfo:{serverId:1,accid:3,nick:4,avatar:5,ext:6,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},otherMemberInfo:{serverId:1,accid:3,nick:4,avatar:5,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},getServerListPageTag:{timestamp:1,limit:2},getServerMemberListPageTag:{serverId:1,timetag:2,limit:3},updateServerMemberBanTag:{serverId:1,opeType:2,accid:3,ext:4},getBannedMembersByPageTag:{serverId:1,timetag:2,limit:3},serverMemberBanInfo:{serverId:1,appid:2,accid:3,ext:4,banTime:5,validFlag:6,createTime:7,updateTime:8},serverSearchByPageTag:{keyword:1,startTime:2,endTime:3,order:4,limit:5,serverType:6,searchType:7,sort:8,cursor:9},serverMemberSearchByPageTag:{serverId:1,keyword:3,limit:4},inviteRespParamTag:{requestId:1},applyRespParamTag:{requestId:1,expireTime:2},inviteApplyRecord:{accid:1,type:2,serverId:3,status:4,requestId:5,createTime:6,updateTime:7,expireTime:8,data:9,recordId:10},clearServersUnreadTag:{successServerIds:1,failServerIds:2,ackTimestamp:3},unreadInfo:Th},La=Cc(Ha),Ec={qchatCreateServer:{sid:24,cid:31,service:"qchatServer",params:[{type:"Property",name:"serverInfo",reflectMapper:Ha.serverInfo},{type:"Property",name:"antispamTag",reflectMapper:Ha.antispamTag}],response:[{type:"Property",name:"serverInfo",reflectMapper:La.serverInfo}]},qchatDeleteServer:{sid:24,cid:32,service:"qchatServer",params:[{type:"Long",name:"serverId"}]},qchatUpdateServer:{sid:24,cid:33,service:"qchatServer",params:[{type:"Property",name:"serverInfo",reflectMapper:Ha.serverInfo},{type:"Property",name:"antispamTag",reflectMapper:Ha.antispamTag}],response:[{type:"Property",name:"serverInfo",reflectMapper:La.serverInfo}]},qchatGetServers:{sid:24,cid:34,service:"qchatServer",params:[{type:"LongArray",name:"serverIds"}],response:[{type:"PropertyArray",name:"serverList",reflectMapper:La.serverInfo}]},qchatGetServersByPage:{sid:24,cid:35,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:Ha.getServerListPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:La.serverInfo}]},qchatInviteServerMembers:{sid:24,cid:36,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"StrArray",name:"accids"},{type:"String",name:"ps"},{type:"Property",name:"params",reflectMapper:{ttl:1}}],response:[{type:"StrArray",name:"failByOverAccids"},{type:"StrArray",name:"failByBanAccids"},{type:"Property",name:"record",reflectMapper:La.applyRespParamTag}]},qchatAcceptServerInvite:{sid:24,cid:37,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"Property",name:"recordInfo",reflectMapper:Ha.inviteRespParamTag}]},qchatRejectInviteServer:{sid:24,cid:38,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"String",name:"ps"},{type:"Property",name:"recordInfo",reflectMapper:Ha.inviteRespParamTag}]},qchatApplyServerJoin:{sid:24,cid:39,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"ps"},{type:"Property",name:"params",reflectMapper:{ttl:1}}],response:[{type:"Property",name:"data",reflectMapper:La.applyRespParamTag}]},qchatAcceptServerApply:{sid:24,cid:40,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"Property",name:"recordInfo",reflectMapper:Ha.applyRespParamTag}]},qchatRejectServerApply:{sid:24,cid:41,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"String",name:"ps"},{type:"Property",name:"recordInfo",reflectMapper:Ha.applyRespParamTag}]},qchatKickServerMembers:{sid:24,cid:42,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"StrArray",name:"accids"}]},qchatLeaveServer:{sid:24,cid:43,service:"qchatServer",params:[{type:"Long",name:"serverId"}]},qchatUpdateMyMemberInfo:{sid:24,cid:44,service:"qchatServer",params:[{type:"Property",name:"memberInfo",reflectMapper:Ha.memberInfo},{type:"Property",name:"antispamTag",reflectMapper:Ha.antispamTag}],response:[{type:"Property",name:"memberInfo",reflectMapper:La.memberInfo}]},qchatUpdateServerMemberInfo:{sid:24,cid:45,service:"qchatServer",params:[{type:"Property",name:"memberInfo",reflectMapper:Ha.otherMemberInfo},{type:"Property",name:"antispamTag",reflectMapper:Ha.antispamTag}],response:[{type:"Property",name:"memberInfo",reflectMapper:La.memberInfo}]},qchatGetServerMembers:{sid:24,cid:46,service:"qchatServer",params:[{type:"StrArray",name:"accids"}],response:[{type:"PropertyArray",name:"accidList",reflectMapper:La.memberInfo}]},qchatGetServerMembersByPage:{sid:24,cid:47,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:Ha.getServerMemberListPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:La.memberInfo}]},qchatUpdateServerMemberBan:{sid:24,cid:104,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:Ha.updateServerMemberBanTag}]},qchatGetBannedMembersByPage:{sid:24,cid:105,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:Ha.getBannedMembersByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:La.serverMemberBanInfo}]},qchatServerSearchByPage:{sid:24,cid:91,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:Ha.serverSearchByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag",3:"cursor"}},{type:"PropertyArray",name:"datas",reflectMapper:La.serverInfo}]},qchatServerMemberSearchByPage:{sid:24,cid:92,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:Ha.serverMemberSearchByPageTag}],response:[{type:"PropertyArray",name:"members",reflectMapper:La.serverMemberBanInfo}]},qchatGenerateInviteCode:{sid:24,cid:122,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,ttl:2}}],response:[{type:"Property",name:"data",reflectMapper:{1:"serverId",2:"requestId",3:"inviteCode",4:"expireTime"}}]},qchatJoinByInviteCode:{sid:24,cid:123,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,inviteCode:2,ps:3}}]},qchatGetInviteApplyRecordOfServer:{sid:24,cid:124,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,fromTime:2,toTime:3,reverse:4,limit:5,cursor:6}}],response:[{type:"PropertyArray",name:"data",reflectMapper:La.inviteApplyRecord}]},qchatGetInviteApplyRecordOfSelf:{sid:24,cid:125,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{fromTime:1,toTime:2,reverse:3,limit:4,cursor:5}}],response:[{type:"PropertyArray",name:"data",reflectMapper:La.inviteApplyRecord}]},qchatClearServersUnread:{sid:25,cid:5,service:"qchatServer",params:[{type:"LongArray",name:"serverIds"}],response:[{type:"Property",name:"clearServersUnreadTag",reflectMapper:La.clearServersUnreadTag}]},qchatSubscribeChannelsByServers:{sid:25,cid:7,service:"qchatServer",params:[{type:"int",name:"type"},{type:"LongArray",name:"serverIds"}],response:[{type:"PropertyArray",name:"unreadInfos",reflectMapper:La.unreadInfo},{type:"LongArray",name:"failServerIds"}]},qchatEnterAsVisitor:{sid:25,cid:10,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverIds:1}}],response:[{type:"LongArray",name:"failServerIds"}]},qchatLeaveAsVisitor:{sid:25,cid:11,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverIds:1}}],response:[{type:"LongArray",name:"failServerIds"}]}},ss=Function.prototype,CS=Object.prototype,ky=ss.toString,MS=CS.hasOwnProperty,kS=ky.call(Object),qp=function(x){if(!us(x)||Js(x)!="[object Object]")return!1;var V=uy(x);if(V===null)return!0;var F=MS.call(V,"constructor")&&V.constructor;return typeof F=="function"&&F instanceof F&&ky.call(F)==kS};function va(S,x){if(!qp(x))return{};var V=JSON.parse(mo(x)),F=_y(S,V);return JSON.parse(mo(Tn(Tn({},V),F)))}function _y(S,x){if(!qp(x))return{};var V={},F=na(S);return In(F).call(F,function(A){var oe=S[A].type;if(typeof oe!="string"){var xe=_y(S[A],x);na(xe).length>0&&(V[A]=xe)}else{var z=S[A],Ve=z.rawKey||A,jt=_S[oe](x,Ve,z);jt!==void 0&&(x[Ve]=void 0,V[A]=jt)}}),V}var _S={number:function(x,V){if(x[V]!==void 0)return+x[V]},string:function(x,V){if(x[V]!==void 0)return x[V]},boolean:function(x,V){return+x[V]>0||+x[V]!=0&&void 0},enum:function(x,V,F){return ip(F)[x[V]]},object:function(x,V){if(x[V]!==void 0)try{return JSON.parse(x[V])}catch{return{}}}};function Gl(S,x){if(!qp(x))return{};var V=JSON.parse(mo(x)),F=wy(S,V);return JSON.parse(mo(Tn(Tn({},V),F)))}function wy(S,x){var V;if(!qp(x))return Sc(V=na(S)).call(V,function(oe,xe){return oe[S[xe].rawKey||xe]=void 0,oe},{});var F={},A=na(S);return In(A).call(A,function(oe){var xe=S[oe].type;if(typeof xe!="string"){var z=wy(S[oe],x[oe]);return Tn(F,z),void(x[oe]=void 0)}var Ve=S[oe],jt=Ve.rawKey||oe,lr=Vp[xe](x,oe,Ve);x[jt]=void 0,F[jt]=lr}),F}var Vp={number:function(x,V){return x[V]},string:function(x,V){return x[V]},boolean:function(x,V){return x[V]===!0?1:x[V]===!1?0:void 0},enum:function(x,V,F){return ip(F)[x[V]]},object:function(x,V){if(x[V]!==void 0)try{return mo(x[V])}catch{return""}}},Ch=Vp,xy={serverId:{type:"string"},name:{type:"string"},icon:{type:"string"},ext:{type:"string"},owner:{type:"string"},memberNumber:{type:"number"},inviteMode:{type:"number"},applyMode:{type:"number"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},channelNumber:{type:"number"},categoryNumber:{type:"number"},searchType:{type:"number"},searchEnable:{type:"boolean"},reorderWeight:{type:"string"}},wS={serverId:{type:"string"},uid:{type:"string"},accid:{type:"string"},nick:{type:"string"},avatar:{type:"string"},ext:{type:"string"},type:{type:"number"},joinTime:{type:"number"},inviter:{type:"string"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"}},xS={serverId:{type:"string"},appid:{type:"string"},accid:{type:"string"},ext:{type:"string"},banTime:{type:"number"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"}};function xd(S){return va(xy,S)}function Mh(S){return ns(S)&&S.length>0?ho(S).call(S,function(x){return xd(x)}):[]}function Ql(S){return va(wS,S)}function lc(S){return ns(S)&&S.length>0?ho(S).call(S,function(x){return Ql(x)}):[]}function IS(S){return ns(S)&&S.length>0?ho(S).call(S,function(x){return function(F){return va(xS,F)}(x)}):[]}function Pc(S){var x,V,F;if(!S.antispamTag)return{};var A=Tn({},S.antispamTag);return!((x=S.antispamTag)===null||x===void 0)&&x.antiSpamBusinessId&&typeof((V=S.antispamTag)===null||V===void 0?void 0:V.antiSpamBusinessId)!="string"&&(A.antiSpamBusinessId=mo((F=S.antispamTag)===null||F===void 0?void 0:F.antiSpamBusinessId)),A}var ES={accid:{type:"string"},type:{type:"number"},serverId:{type:"string"},status:{type:"number"},requestId:{type:"string"},createTime:{type:"number"},updateTime:{type:"number"},expireTime:{type:"number"},data:{type:"object"}};function Id(S){return va(ES,S)}function Iy(S){return ns(S)&&S.length>0?ho(S).call(S,function(x){return Id(x)}):[]}var Hp,ca,ei,hl,PS={successServerIds:{type:"object"},failServerIds:{type:"object"},ackTimestamp:{type:"number"}};function vl(S){return va(PS,S)}(function(S){S[S.reorderWeight=0]="reorderWeight",S[S.createTime=1]="createTime"})(Hp||(Hp={})),function(S){S[S.white=1]="white",S[S.black=2]="black"}(ca||(ca={})),function(S){S[S.add=1]="add",S[S.remove=2]="remove"}(ei||(ei={})),function(S){S[S.message=0]="message",S[S.media=1]="media",S[S.ext=100]="ext"}(hl||(hl={}));var Ed={channelId:{type:"string"},serverId:{type:"string"},name:{type:"string"},topic:{type:"string"},ext:{type:"string"},type:{type:"enum",values:hl},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},viewMode:{type:"number"},categoryId:{type:"string"},syncMode:{type:"number"},visitorMode:{type:"number"},reorderWeight:{type:"string"}},AS={serverId:{type:"string"},channelId:{type:"string"},ackTimestamp:{type:"number"},unreadCount:{type:"number"},mentionedCount:{type:"number"},maxCount:{type:"number"},lastMsgTime:{type:"number"}},Ey={serverId:{type:"string"},channelId:{type:"string"},type:{type:"enum",values:ca},opeType:{type:"enum",values:ei},toAccids:{type:"object"}},zp={serverId:{type:"string"},channelId:{type:"string"},type:{type:"enum",values:ca},opeType:{type:"enum",values:ei},roleId:{type:"string"}},OS={categoryId:{type:"string"},serverId:{type:"string"},name:{type:"string"},ext:{type:"string"},owner:{type:"string"},viewMode:{type:"number"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},channelNumber:{type:"number"}},Py={serverId:{type:"string"},channelId:{type:"string"},accid:{type:"string"},avatar:{type:"string"},nick:{type:"string"},createTime:{type:"number"},updateTime:{type:"number"}};function Pd(S){return va(zp,S)}function Ad(S){return va(Ed,S)}function Od(S){return ns(S)&&S.length>0?ho(S).call(S,function(x){return Ad(x)}):[]}function kh(S){return va(AS,S)}function Nd(S){return ns(S)&&S.length>0?ho(S).call(S,function(x){return kh(x)}):[]}function Rd(S){return va(OS,S)}function _h(S){return ns(S)&&S.length>0?ho(S).call(S,function(x){return Rd(x)}):[]}function NS(S){return ns(S)&&S.length>0?ho(S).call(S,function(x){return function(F){return va(Py,F)}(x)}):[]}function Bd(S){try{return JSON.parse(S)}catch{return[]}}var Kp=xi?xi.isConcatSpreadable:void 0,RS=function(x){return Ni(x)||Zg(x)||!!(Kp&&x&&x[Kp])},Ay=function S(x,V,F,A,oe){var xe=-1,z=x.length;for(F||(F=RS),oe||(oe=[]);++xe<z;){var Ve=x[xe];V>0&&F(Ve)?V>1?S(Ve,V-1,F,A,oe):Os(oe,Ve):A||(oe[oe.length]=Ve)}return oe},wh=Av(function(S,x){return En(S)?Rg(S,Ay(x,1,En,!0)):[]}),Wp=wh;function xh(S,x){var V,F=ga!==void 0&&Va(S)||S["@@iterator"];if(F)return Oo(V=(F=F.call(S)).next).call(V,F);if(ns(S)||(F=function(xe,z){var Ve;if(xe){if(typeof xe=="string")return Ih(xe,z);var jt=Co(Ve=Object.prototype.toString.call(xe)).call(Ve,8,-1);if(jt==="Object"&&xe.constructor&&(jt=xe.constructor.name),jt==="Map"||jt==="Set")return _c(xe);if(jt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(jt))return Ih(xe,z)}}(S))||x&&S&&typeof S.length=="number"){F&&(S=F);var A=0;return function(){return A>=S.length?{done:!0}:{done:!1,value:S[A++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ih(S,x){(x==null||x>S.length)&&(x=S.length);for(var V=0,F=new Array(x);V<x;V++)F[V]=S[V];return F}var Jl,Fd,yl,bl,BS=function(S){function x(F){var A;return(A=S.call(this,"qchatServer",F)||this).core=F,Pi({cmdMap:My,cmdConfig:Ec}),A}Ro(x,S);var V=x.prototype;return V.createServer=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({icon:{type:"string",required:!1},name:{type:"string",required:!1},ext:{type:"string",required:!1},searchType:{type:"number",required:!1,min:0},searchEnable:{type:"boolean",required:!1},inviteMode:{type:"number",min:0,max:1,required:!1},applyMode:{type:"number",min:0,max:1,required:!1}},A),Ve.next=3,this.core.sendCmd("qchatCreateServer",{serverInfo:Tn(Tn({},A),{searchEnable:A.searchEnable===!1?0:1}),antispamTag:Pc(A)});case 3:return xe=Ve.sent,Ve.abrupt("return",xd(xe.content.serverInfo));case 5:case"end":return Ve.stop()}},oe,this)}))},V.deleteServer=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",min:1}},A),z.next=3,this.core.sendCmd("qchatDeleteServer",A);case 3:case"end":return z.stop()}},oe,this)}))},V.updateServer=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",min:1},icon:{type:"string",required:!1},name:{type:"string",required:!1},ext:{type:"string",required:!1},searchType:{type:"number",required:!1,min:0},searchEnable:{type:"boolean",required:!1},inviteMode:{type:"number",min:0,max:1,required:!1},applyMode:{type:"number",min:0,max:1,required:!1}},A),Ve.next=3,this.core.sendCmd("qchatUpdateServer",{serverInfo:Tn(Tn({},A),{searchEnable:A.searchEnable===!1?0:1}),antispamTag:Pc(A)});case 3:return xe=Ve.sent,Ve.abrupt("return",xd(xe.content.serverInfo));case 5:case"end":return Ve.stop()}},oe,this)}))},V.getServers=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverIds:{type:"array",itemType:"string",min:1}},A),Ve.next=3,this.core.sendCmd("qchatGetServers",A);case 3:return xe=Ve.sent,Ve.abrupt("return",Mh(xe.content.serverList));case 5:case"end":return Ve.stop()}},oe,this)}))},V.getServersByPage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Wr({timestamp:{type:"number"},limit:{type:"number",min:1,required:!1}},A),fr.next=3,this.core.sendCmd("qchatGetServersByPage",{tag:A});case 3:return xe=fr.sent,z=xe.content,Ve=z.datas,jt=z.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+jt.hasMore==1,nextTimetag:Lo(jt.nextTimetag)},datas:Mh(Ve)});case 6:case"end":return fr.stop()}},oe,this)}))},V.inviteServerMembers=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return Wr({serverId:{type:"string",min:1},accids:{type:"array",itemType:"string",min:1},ps:{type:"string"},params:{type:"object",rules:{ttl:{type:"number"}},required:!1}},A),jt.next=3,this.core.sendCmd("qchatInviteServerMembers",A);case 3:return xe=jt.sent,z=xe.content.record||{},jt.abrupt("return",{failByOverAccids:xe.content.failByOverAccids,failByBanAccids:xe.content.failByBanAccids,recordInfo:Id(z)});case 6:case"end":return jt.stop()}},oe,this)}))},V.acceptServerInvite=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},A),z.next=3,this.core.sendCmd("qchatAcceptServerInvite",A);case 3:case"end":return z.stop()}},oe,this)}))},V.rejectInviteServer=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",min:1},accid:{type:"string",min:1},ps:{type:"string"},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},A),z.next=3,this.core.sendCmd("qchatRejectInviteServer",A);case 3:case"end":return z.stop()}},oe,this)}))},V.applyServerJoin=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",min:1},ps:{type:"string"},params:{type:"object",rules:{ttl:{type:"number"}},required:!1}},A),Ve.next=3,this.core.sendCmd("qchatApplyServerJoin",A);case 3:return xe=Ve.sent,Ve.abrupt("return",Id(xe.content.data));case 5:case"end":return Ve.stop()}},oe,this)}))},V.acceptServerApply=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",min:1},accid:{type:"string",min:1},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},A),z.next=3,this.core.sendCmd("qchatAcceptServerApply",A);case 3:case"end":return z.stop()}},oe,this)}))},V.rejectServerApply=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",min:1},accid:{type:"string",min:1},ps:{type:"string"},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},A),z.next=3,this.core.sendCmd("qchatRejectServerApply",A);case 3:case"end":return z.stop()}},oe,this)}))},V.kickServerMembers=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",min:1},accids:{type:"array",itemType:"string",min:1}},A),z.next=3,this.core.sendCmd("qchatKickServerMembers",A);case 3:case"end":return z.stop()}},oe,this)}))},V.leaveServer=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",min:1}},A),z.next=3,this.core.sendCmd("qchatLeaveServer",A);case 3:case"end":return z.stop()}},oe,this)}))},V.updateMyMemberInfo=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",min:1},accid:{type:"string",required:!1},nick:{type:"string",required:!1},avatar:{type:"string",required:!1},ext:{type:"string",required:!1}},A),Ve.next=3,this.core.sendCmd("qchatUpdateMyMemberInfo",{memberInfo:A,antispamTag:Pc(A)});case 3:return xe=Ve.sent,Ve.abrupt("return",Ql(xe.content.memberInfo));case 5:case"end":return Ve.stop()}},oe,this)}))},V.updateServerMemberInfo=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",min:1},accid:{type:"string",min:1},nick:{type:"string",required:!1},avatar:{type:"string",required:!1}},A),Ve.next=3,this.core.sendCmd("qchatUpdateServerMemberInfo",{memberInfo:A,antispamTag:Pc(A)});case 3:return xe=Ve.sent,Ve.abrupt("return",Ql(xe.content.memberInfo));case 5:case"end":return Ve.stop()}},oe,this)}))},V.getServerMembers=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt,lr;return ar.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:if(Wr({accids:{type:"array"}},A),xe=[],A.accids.length)for(z=xh(A.accids);!(Ve=z()).done;)jt=Ve.value,xe.push(jt.serverId+"|"+jt.accid);return Sr.next=5,this.core.sendCmd("qchatGetServerMembers",{accids:xe});case 5:return lr=Sr.sent,Sr.abrupt("return",lc(lr.content.accidList));case 7:case"end":return Sr.stop()}},oe,this)}))},V.getServerMembersByPage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Wr({serverId:{type:"string",min:1},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},A),fr.next=3,this.core.sendCmd("qchatGetServerMembersByPage",{tag:A});case 3:return xe=fr.sent,z=xe.content,Ve=z.datas,jt=z.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+jt.hasMore==1,nextTimetag:Lo(jt.nextTimetag)},datas:lc(Ve)});case 6:case"end":return fr.stop()}},oe,this)}))},V.subscribeServer=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:if(Wr({type:{type:"number",min:4,max:4,required:!1},opeType:{type:"number",min:1,max:2}},A),A.type||(A.type=4),!A.servers.length){fr.next=10;break}return z=Tn(Tn({},A),{channels:ho(xe=A.servers).call(xe,function(Sr){return{serverId:Sr.serverId,channelId:""}})}),fr.next=6,this.core.qchatChannel.subscribeModuleService.subscribe(z);case 6:return Ve=fr.sent,jt=Ve.failedChannels,this.core.qchatChannel.subscribeModuleService.cacheSubscribe(z),fr.abrupt("return",{failedServers:jt});case 10:case"end":return fr.stop()}},oe,this)}))},V.banServerMember=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},A),z.next=3,this.core.sendCmd("qchatUpdateServerMemberBan",{tag:Tn(Tn({},A),{opeType:1})});case 3:case"end":return z.stop()}},oe,this)}))},V.unbanServerMember=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},A),z.next=3,this.core.sendCmd("qchatUpdateServerMemberBan",{tag:Tn(Tn({},A),{opeType:2})});case 3:case"end":return z.stop()}},oe,this)}))},V.getBannedMembersByPage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},A),fr.next=3,this.core.sendCmd("qchatGetBannedMembersByPage",{tag:A});case 3:return xe=fr.sent,z=xe.content,Ve=z.datas,jt=z.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+jt.hasMore==1,nextTimetag:Lo(jt.nextTimetag)},datas:IS(Ve)});case 6:case"end":return fr.stop()}},oe,this)}))},V.serverSearchByPage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:if(Wr({keyword:{type:"string",allowEmpty:!1},startTime:{type:"number",min:0,required:!1},endTime:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1},serverType:{type:"array",itemType:"number",min:0,required:!1},order:{type:"enum",values:ia(Ic),required:!1},searchType:{type:"enum",values:ia(Up)},sort:{type:"enum",values:ia(Ti),required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},A),!(A.startTime&&A.endTime&&A.startTime>=A.endTime)){fr.next=3;break}throw new al("startTime more than endTime",A,"timeRule");case 3:return fr.next=5,this.core.sendCmd("qchatServerSearchByPage",{tag:Tn(Tn({},A),{order:A.order&&Ic[A.order],searchType:Up[A.searchType],sort:Wl(A)&&Ti[Wl(A)],serverType:mo(A.serverType)})});case 5:return xe=fr.sent,z=xe.content,Ve=z.datas,jt=z.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+jt.hasMore==1,nextTimetag:Lo(jt.nextTimetag),cursor:jt.cursor},datas:Mh(Ve)});case 8:case"end":return fr.stop()}},oe,this)}))},V.serverMemberSearchByPage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},keyword:{type:"string",allowEmpty:!1},limit:{type:"number",min:1,required:!1}},A),Ve.next=3,this.core.sendCmd("qchatServerMemberSearchByPage",{tag:A});case 3:return xe=Ve.sent,Ve.abrupt("return",lc(xe.content.members));case 5:case"end":return Ve.stop()}},oe,this)}))},V.generateInviteCode=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},ttl:{type:"number",min:0,required:!1}},A),Ve.next=3,this.core.sendCmd("qchatGenerateInviteCode",{tag:A});case 3:return xe=Ve.sent,Ve.abrupt("return",va({expireTime:{type:"number"}},xe.content.data));case 5:case"end":return Ve.stop()}},oe,this)}))},V.joinByInviteCode=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},inviteCode:{type:"string",allowEmpty:!1},ps:{type:"string",required:!1}},A),z.next=3,this.core.sendCmd("qchatJoinByInviteCode",{tag:A});case 3:case"end":return z.stop()}},oe,this)}))},V.getInviteApplyRecordOfServer=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},fromTime:{type:"number",min:0},toTime:{type:"number",min:0},reverse:{type:"boolean",required:!1},limit:{type:"number",min:1,required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},A),Ve.next=3,this.core.sendCmd("qchatGetInviteApplyRecordOfServer",{tag:Tn(Tn({},A),{reverse:kl(A)?1:0})});case 3:return xe=Ve.sent,Ve.abrupt("return",Iy(xe.content.data));case 5:case"end":return Ve.stop()}},oe,this)}))},V.getInviteApplyRecordOfSelf=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({fromTime:{type:"number",min:0},toTime:{type:"number",min:0},reverse:{type:"boolean",required:!1},limit:{type:"number",min:1,required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},A),Ve.next=3,this.core.sendCmd("qchatGetInviteApplyRecordOfSelf",{tag:Tn(Tn({},A),{reverse:kl(A)?1:0})});case 3:return xe=Ve.sent,Ve.abrupt("return",Iy(xe.content.data));case 5:case"end":return Ve.stop()}},oe,this)}))},V.markRead=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Wr({serverIds:{type:"array",itemType:"string",required:!0}},A),fr.next=3,this.core.sendCmd("qchatClearServersUnread",A);case 3:return xe=fr.sent,z=vl(xe.content.clearServersUnreadTag),Ve=z.successServerIds,jt=z.ackTimestamp,this.logger.log("qchatServer::clearServersUnread:: begin auto clear servers unreadInfo"),this.core.eventBus.emit("qchatChannel/clearUnreadCountByServers",Ve,jt),fr.abrupt("return",z);case 9:case"end":return fr.stop()}},oe,this)}))},V.subscribeAllChannel=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return Wr({type:{type:"number",required:!0},serverIds:{type:"array",itemType:"string",required:!0,max:10}},A),lr.next=3,this.core.sendCmd("qchatSubscribeChannelsByServers",A,{timeout:3e4});case 3:return(z=lr.sent).content.unreadInfos=Nd(z.content.unreadInfos),z.content.failServerIds=Bd(z.content.failServerIds),Ve={type:A.type,opeType:1,channels:ho(xe=z.content.unreadInfos).call(xe,function(fr){return{serverId:fr.serverId,channelId:fr.channelId}})},this.core.eventBus.emit("qchatChannel/cacheSubscribe",Ve),this.core.eventBus.emit("qchatChannel/getRoleIdsByServerId",A.serverIds),this.core.eventBus.emit("qchatChannel/updateUnreads",z.content.unreadInfos),lr.abrupt("return",z.content);case 11:case"end":return lr.stop()}},oe,this)}))},V.enterAsVisitor=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return Wr({serverIds:{type:"array",itemType:"string",min:1}},A),lr.next=3,this.core.sendCmd("qchatEnterAsVisitor",{tag:{serverIds:mo(A.serverIds)}});case 3:return xe=lr.sent,z=Bd(xe.content.failServerIds),Ve=Wp(A.serverIds,z),this.core.qchatChannel.subscribeForVisitorService.cacheServer(Ve),lr.abrupt("return",{failedServers:z});case 8:case"end":return lr.stop()}},oe,this)}))},V.leaveAsVisitor=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt=this;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Wr({serverIds:{type:"array",itemType:"string",min:1}},A),fr.next=3,this.core.sendCmd("qchatLeaveAsVisitor",{tag:{serverIds:mo(A.serverIds)}});case 3:return xe=fr.sent,z=Bd(xe.content.failServerIds),Ve=Wp(A.serverIds,z),In(Ve).call(Ve,function(Sr){jt.core.qchatChannel.subscribeForVisitorService.deleteServer(Sr)}),fr.abrupt("return",{failedServers:z});case 8:case"end":return fr.stop()}},oe,this)}))},V.subscribeAsVisitor=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(Wr({opeType:{type:"number",min:1,max:2},type:{type:"number",required:!1},serverIds:{type:"array",itemType:"string",min:1}},A),!A.serverIds.length){z.next=5;break}return z.next=4,this.core.qchatChannel.subscribeForVisitorService.subscribeServerAsVisitor(A);case 4:return z.abrupt("return",z.sent);case 5:return z.abrupt("return",{failedServers:[]});case 6:case"end":return z.stop()}},oe,this)}))},x}(gl);(function(S){S[S.everyone=1]="everyone",S[S.custom=2]="custom"})(Jl||(Jl={})),function(S){S[S.normal=0]="normal",S[S.owner=1]="owner"}(Fd||(Fd={})),function(S){S[S.ignore=0]="ignore",S[S.deny=-1]="deny",S[S.allow=1]="allow"}(yl||(yl={})),function(S){S[S.manageServer=1]="manageServer",S[S.manageChannel=2]="manageChannel",S[S.manageRole=3]="manageRole",S[S.sendMsg=4]="sendMsg",S[S.accountInfoSelf=5]="accountInfoSelf",S[S.inviteServer=6]="inviteServer",S[S.kickServer=7]="kickServer",S[S.accountInfoOther=8]="accountInfoOther",S[S.recallMsg=9]="recallMsg",S[S.deleteMsg=10]="deleteMsg",S[S.remindOther=11]="remindOther",S[S.remindEveryone=12]="remindEveryone",S[S.manageBlackWhiteList=13]="manageBlackWhiteList",S[S.banServerMember=14]="banServerMember",S[S.RTCChannelConnect=15]="RTCChannelConnect",S[S.RTCChannelDisconnectOther=16]="RTCChannelDisconnectOther",S[S.RTCChannelOpenMicrophone=17]="RTCChannelOpenMicrophone",S[S.RTCChannelOpenCamera=18]="RTCChannelOpenCamera",S[S.RTCChannelOpenCloseOtherMicrophone=19]="RTCChannelOpenCloseOtherMicrophone",S[S.RTCChannelOpenCloseOtherCamera=20]="RTCChannelOpenCloseOtherCamera",S[S.RTCChannelOpenCloseEveryoneMicrophone=21]="RTCChannelOpenCloseEveryoneMicrophone",S[S.RTCChannelOpenCloseEveryoneCamera=22]="RTCChannelOpenCloseEveryoneCamera",S[S.RTCChannelOpenShareScreen=23]="RTCChannelOpenShareScreen",S[S.RTCChannelCloseOtherShareScreen=24]="RTCChannelCloseOtherShareScreen",S[S.manageInviteApply=25]="manageInviteApply",S[S.manageInviteApplyHistory=26]="manageInviteApplyHistory",S[S.mentionedRole=27]="mentionedRole"}(bl||(bl={}));var Oy={type:{type:"enum",values:Jl},memberType:{type:"enum",values:Fd},createTime:{type:"number"},updateTime:{type:"number"},priority:{type:"number"},memberCount:{type:"number"},joinTime:{type:"number"}},FS={roleId:{type:"string"},categoryId:{type:"string"},serverId:{type:"string"},type:{type:"enum",values:Jl},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},name:{type:"string"},icon:{type:"string"},ext:{type:"string"}},LS={id:{type:"string"},accid:{type:"string"},categoryId:{type:"string"},serverId:{type:"string"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},nick:{type:"string"},avatar:{type:"string"},ext:{type:"string"},memberType:{type:"enum",values:Fd},joinTime:{type:"number"},inviter:{type:"string"}};function Ac(S){var x=Tn({},S),V=Gl(Oy,x);return V.auths&&(V.auths=function(A){var oe,xe=Sc(oe=na(A)).call(oe,function(z,Ve){var jt=bl[Ve];return jt?z[jt]=yl[A[Ve]]:z[Ve]=yl[A[Ve]],z},{});return mo(xe)}(V.auths)),V}function Si(S){var x;return Sc(x=na(S)).call(x,function(V,F){var A=Bv(bl,F);return A?V[A]=yl[S[F]]:V[Lo(F)]=yl[S[F]],V},{})}function ps(S){var x=va(Oy,S);return S.auths&&(x.auths=Si(JSON.parse(x.auths))),x.isMember&&delete x.isMember,x}function Ks(S){return ns(S)&&S.length>0?ho(S).call(S,function(x){return ps(x)}):[]}function Gp(S){return S.auths&&(S.auths=Si(JSON.parse(S.auths))),va(FS,S)}function Yl(S){return S.auths&&(S.auths=Si(JSON.parse(S.auths))),va(LS,S)}Qh("Set",function(S){return function(){return S(this,arguments.length?arguments[0]:void 0)}},od);var Ny=nr.Set;Vr({target:"Set",stat:!0,forced:!0},{from:ag}),Vr({target:"Set",stat:!0,forced:!0},{of:Yh}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{addAll:function(){for(var x=Vn(this),V=Or(x.add),F=0,A=arguments.length;F<A;F++)Y(V,x,arguments[F]);return x}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{deleteAll:Xh});var Tl=Gi;Vr({target:"Set",proto:!0,real:!0,forced:!0},{every:function(x){var V=Vn(this),F=Tl(V),A=$o(x,arguments.length>1?arguments[1]:void 0);return!lo(F,function(oe,xe){if(!A(oe,oe,V))return xe()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{difference:function(x){var V=Vn(this),F=new(Ms(V,Ue("Set")))(V),A=Or(F.delete);return lo(x,function(oe){Y(A,F,oe)}),F}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{filter:function(x){var V=Vn(this),F=Tl(V),A=$o(x,arguments.length>1?arguments[1]:void 0),oe=new(Ms(V,Ue("Set"))),xe=Or(oe.add);return lo(F,function(z){A(z,z,V)&&Y(xe,oe,z)},{IS_ITERATOR:!0}),oe}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{find:function(x){var V=Vn(this),F=Tl(V),A=$o(x,arguments.length>1?arguments[1]:void 0);return lo(F,function(oe,xe){if(A(oe,oe,V))return xe(oe)},{IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{intersection:function(x){var V=Vn(this),F=new(Ms(V,Ue("Set"))),A=Or(V.has),oe=Or(F.add);return lo(x,function(xe){Y(A,V,xe)&&Y(oe,F,xe)}),F}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{isDisjointFrom:function(x){var V=Vn(this),F=Or(V.has);return!lo(x,function(A,oe){if(Y(F,V,A)===!0)return oe()},{INTERRUPTED:!0}).stopped}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{isSubsetOf:function(x){var V=Gi(this),F=Vn(x),A=F.has;return ae(A)||(F=new(Ue("Set"))(x),A=Or(F.has)),!lo(V,function(oe,xe){if(Y(A,F,oe)===!1)return xe()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{isSupersetOf:function(x){var V=Vn(this),F=Or(V.has);return!lo(x,function(A,oe){if(Y(F,V,A)===!1)return oe()},{INTERRUPTED:!0}).stopped}});var Ry=he([].join),$S=[].push;Vr({target:"Set",proto:!0,real:!0,forced:!0},{join:function(x){var V=Vn(this),F=Tl(V),A=x===void 0?",":Oa(x),oe=[];return lo(F,$S,{that:oe,IS_ITERATOR:!0}),Ry(oe,A)}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{map:function(x){var V=Vn(this),F=Tl(V),A=$o(x,arguments.length>1?arguments[1]:void 0),oe=new(Ms(V,Ue("Set"))),xe=Or(oe.add);return lo(F,function(z){Y(xe,oe,A(z,z,V))},{IS_ITERATOR:!0}),oe}});var By=TypeError;Vr({target:"Set",proto:!0,real:!0,forced:!0},{reduce:function(x){var V=Vn(this),F=Tl(V),A=arguments.length<2,oe=A?void 0:arguments[1];if(Or(x),lo(F,function(xe){A?(A=!1,oe=xe):oe=x(oe,xe,xe,V)},{IS_ITERATOR:!0}),A)throw By("Reduce of empty set with no initial value");return oe}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{some:function(x){var V=Vn(this),F=Tl(V),A=$o(x,arguments.length>1?arguments[1]:void 0);return lo(F,function(oe,xe){if(A(oe,oe,V))return xe()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{symmetricDifference:function(x){var V=Vn(this),F=new(Ms(V,Ue("Set")))(V),A=Or(F.delete),oe=Or(F.add);return lo(x,function(xe){Y(A,F,xe)||Y(oe,F,xe)}),F}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{union:function(x){var V=Vn(this),F=new(Ms(V,Ue("Set")))(V);return lo(x,Or(F.add),{that:F}),F}});var Qp,Ld,Ci,$d,Oc,Xo,uc,Xl=Ny;(function(S){S[S.sendTime=1]="sendTime"})(Qp||(Qp={})),function(S){S[S.text=0]="text",S[S.image=1]="image",S[S.audio=2]="audio",S[S.video=3]="video",S[S.geo=4]="geo",S[S.notification=5]="notification",S[S.file=6]="file",S[S.tip=10]="tip",S[S.robot=11]="robot",S[S.g2=12]="g2",S[S.custom=100]="custom"}(Ld||(Ld={})),function(S){S[S.sending=1]="sending",S[S.success=2]="success",S[S.failed=3]="failed"}(Ci||(Ci={})),function(S){S[S.notifyAll=1]="notifyAll",S[S.notifySubscribe=2]="notifySubscribe"}($d||($d={})),function(S){S[S.unknown=0]="unknown",S[S.server=1]="server",S[S.channel=2]="channel",S[S.serverAccids=3]="serverAccids",S[S.channelAccids=4]="channelAccids",S[S.accids=5]="accids"}(Oc||(Oc={})),function(S){S[S.serverMemberInvite=1]="serverMemberInvite",S[S.serverMemberInviteReject=2]="serverMemberInviteReject",S[S.serverMemberApply=3]="serverMemberApply",S[S.serverMemberApplyReject=4]="serverMemberApplyReject",S[S.serverCreate=5]="serverCreate",S[S.serverRemove=6]="serverRemove",S[S.serverUpdate=7]="serverUpdate",S[S.serverMemberInviteDone=8]="serverMemberInviteDone",S[S.serverMemberInviteAccept=9]="serverMemberInviteAccept",S[S.serverMemberApplyDone=10]="serverMemberApplyDone",S[S.serverMemberApplyAccept=11]="serverMemberApplyAccept",S[S.serverMemberKick=12]="serverMemberKick",S[S.serverMemberLeave=13]="serverMemberLeave",S[S.serverMemberUpdate=14]="serverMemberUpdate",S[S.channelCreate=15]="channelCreate",S[S.channelRemove=16]="channelRemove",S[S.channelUpdate=17]="channelUpdate",S[S.channelUpdateWhiteBlackIdentify=18]="channelUpdateWhiteBlackIdentify",S[S.channelUpdateWhiteBlackIdentifyUser=19]="channelUpdateWhiteBlackIdentifyUser",S[S.updateQuickComment=20]="updateQuickComment",S[S.channelCategoryCreate=21]="channelCategoryCreate",S[S.channelCategoryRemove=22]="channelCategoryRemove",S[S.channelCategoryUpdate=23]="channelCategoryUpdate",S[S.channelCategoryUpdateWhiteBlackIdentify=24]="channelCategoryUpdateWhiteBlackIdentify",S[S.channelCategoryUpdateWhiteBlackIdentifyUser=25]="channelCategoryUpdateWhiteBlackIdentifyUser",S[S.serverIdentifyAdd=26]="serverIdentifyAdd",S[S.serverIdentifyRemove=27]="serverIdentifyRemove",S[S.serverIdentifyUpdate=28]="serverIdentifyUpdate",S[S.channelIdentifyUpdate=29]="channelIdentifyUpdate",S[S.userIdentifyUpdate=30]="userIdentifyUpdate",S[S.channelVisibilityUpdate=31]="channelVisibilityUpdate",S[S.serverEnterLeave=32]="serverEnterLeave",S[S.serverMemberJoinByInviteCode=33]="serverMemberJoinByInviteCode",S[S.channelVisibilityToVisitorUpdate=34]="channelVisibilityToVisitorUpdate",S[S.myMemberInfoUpdated=35]="myMemberInfoUpdated",S[S.custom=100]="custom",S[S.msgTyping=101]="msgTyping"}(Xo||(Xo={})),function(S){S[S.reply=1]="reply",S[S.thread=2]="thread",S[S.all=3]="all"}(uc||(uc={}));var Eh=function(){return Hs.Date.now()},jS=/\s/,DS=function(x){for(var V=x.length;V--&&jS.test(x.charAt(V)););return V},US=/^\s+/,qS=function(x){return x&&x.slice(0,DS(x)+1).replace(US,"")},VS=/^[-+]0x[0-9a-f]+$/i,HS=/^0b[01]+$/i,zS=/^0o[0-7]+$/i,KS=parseInt,Ph=function(x){if(typeof x=="number")return x;if(Fp(x))return NaN;if(fi(x)){var V=typeof x.valueOf=="function"?x.valueOf():x;x=fi(V)?V+"":V}if(typeof x!="string")return x===0?x:+x;x=qS(x);var F=HS.test(x);return F||zS.test(x)?KS(x.slice(2),F?2:8):VS.test(x)?NaN:+x},WS=Math.max,Fy=Math.min,GS=function(x,V,F){var A,oe,xe,z,Ve,jt,lr=0,fr=!1,Sr=!1,br=!0;if(typeof x!="function")throw new TypeError("Expected a function");function Er(Zr){var Qn=A,Dn=oe;return A=oe=void 0,lr=Zr,z=x.apply(Dn,Qn)}function Dr(Zr){return lr=Zr,Ve=setTimeout(vn,V),fr?Er(Zr):z}function $r(Zr){var Qn=Zr-jt;return jt===void 0||Qn>=V||Qn<0||Sr&&Zr-lr>=xe}function vn(){var Zr=Eh();if($r(Zr))return Yr(Zr);Ve=setTimeout(vn,function(Dn){var jo=V-(Dn-jt);return Sr?Fy(jo,xe-(Dn-lr)):jo}(Zr))}function Yr(Zr){return Ve=void 0,br&&A?Er(Zr):(A=oe=void 0,z)}function wn(){var Zr=Eh(),Qn=$r(Zr);if(A=arguments,oe=this,jt=Zr,Qn){if(Ve===void 0)return Dr(jt);if(Sr)return clearTimeout(Ve),Ve=setTimeout(vn,V),Er(jt)}return Ve===void 0&&(Ve=setTimeout(vn,V)),z}return V=Ph(V)||0,fi(F)&&(fr=!!F.leading,xe=(Sr="maxWait"in F)?WS(Ph(F.maxWait)||0,V):xe,br="trailing"in F?!!F.trailing:br),wn.cancel=function(){Ve!==void 0&&clearTimeout(Ve),lr=0,A=jt=oe=Ve=void 0},wn.flush=function(){return Ve===void 0?z:Yr(Eh())},wn},Ah=function(x,V,F){var A=!0,oe=!0;if(typeof x!="function")throw new TypeError("Expected a function");return fi(F)&&(A="leading"in F?!!F.leading:A,oe="trailing"in F?!!F.trailing:oe),GS(x,V,{leading:A,maxWait:V,trailing:oe})},QS=function(x,V,F){var A=-1,oe=x.length;V<0&&(V=-V>oe?0:oe+V),(F=F>oe?oe:F)<0&&(F+=oe),oe=V>F?0:F-V>>>0,V>>>=0;for(var xe=Array(oe);++A<oe;)xe[A]=x[A+V];return xe},Zl=function(x,V,F){if(!fi(F))return!1;var A=typeof V;return!!(A=="number"?bp(F)&&yd(V,F.length):A=="string"&&V in F)&&cp(F[V],x)},dc=1/0,JS=function(x){return x?(x=Ph(x))===dc||x===-1/0?17976931348623157e292*(x<0?-1:1):x==x?x:0:x===0?x:0},YS=function(x){var V=JS(x),F=V%1;return V==V?F?V-F:V:0},Jp=Math.ceil,XS=Math.max,jd,eu=function(x,V,F){V=(F?Zl(x,V,F):V===void 0)?1:XS(YS(V),0);var A=x==null?0:x.length;if(!A||V<1)return[];for(var oe=0,xe=0,z=Array(Jp(A/V));oe<A;)z[xe++]=QS(x,oe,oe+=V);return z};(function(S){S[S.sub=1]="sub",S[S.unSub=2]="unSub"})(jd||(jd={}));var Oh,ZS=function(){function S(V){var F=this;this.unreadCount={},this.autoSubscribeUnreadMap={},this.autoSubscribeServerMap={},this.autoSubscribeTypingMap={},this.unreadServerCount={},this.serverRoleIdsMap={},this._serverUnreadInfo=Ah(function(A){F.core.emit("serverUnreadInfo",F.getServerUnreadInfo(A))},100),this.core=V}var x=S.prototype;return x.changeCacheServerRoleIds=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve,jt,lr,fr,Sr=this;return ar.wrap(function(Er){for(;;)switch(Er.prev=Er.next){case 0:if(xe=F.attach.serverIdentifyInfo,z=xe.serverId,Ve=xe.roleId,this.serverRoleIdsMap[z]){Er.next=4;break}return Er.next=4,this.getRoleIdsByServerId([z]);case 4:if(jt=this.serverRoleIdsMap[z],!(F.time<jt.timeTag)){Er.next=7;break}return Er.abrupt("return");case 7:if(F.type===Xo[Xo.serverIdentifyAdd]?jt.roleIds.add(Ve):jt.roleIds.delete(Ve),this.core.logger.debug("QChatChannel::qchatChannel/serverIdentifyChange::now "+z+" roleIds is",Vs(oe=[]).call(oe,jt.roleIds)),lr=this.unreadServerCount[z]){Er.next=12;break}return Er.abrupt("return");case 12:fr=eu(na(lr),100),In(fr).call(fr,function(Dr){Sr.core.qchatChannel.getChannelUnreadInfos({channels:ho(Dr).call(Dr,function($r){return{serverId:z,channelId:$r}})})});case 14:case"end":return Er.stop()}},A,this)}))},x.getRoleIdsByServerId=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve,jt=this;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:if((xe=Ys(F).call(F,function(Sr){return!jt.serverRoleIdsMap[Sr]})).length){fr.next=3;break}return fr.abrupt("return");case 3:return z={serverIdTimeTags:xe},fr.next=6,this.core.sendCmd("qchatGetRoleIdsByServerId",{qchatGetRoleIdsByServerIdTag:z});case 6:Ve=fr.sent,this.core.logger.debug("QChatChannel:: getRoleIdsByServerId, params is ",z,"result is",Ve),In(oe=Ve.content.serverRoles).call(oe,function(Sr){try{Sr.roleIds=JSON.parse(Sr.roleIds)}catch(br){jt.core.logger.error("QChatChannel:: getRoleIdsByServerId JSON parse roleIds error",br)}jt.serverRoleIdsMap[Sr.serverId]={roleIds:new Xl(Sr.roleIds),timeTag:Sr.timeTag}});case 9:case"end":return fr.stop()}},A,this)}))},x._unSubscribeChannel=function(F,A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(xe=F+"_"+A,z=this.autoSubscribeUnreadMap[xe]){jt.next=4;break}return jt.abrupt("return");case 4:this.subscribe({opeType:jd.unSub,type:z,channels:[{serverId:F,channelId:A}]}),this.autoSubscribeUnreadMap[xe]=void 0;case 6:case"end":return jt.stop()}},oe,this)}))},x.subscribe=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve,jt=this;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Wr({type:{type:"number",min:1,max:5},opeType:{type:"number",min:1,max:2}},F),fr.next=3,this.core.sendCmd("qchatSubscribe",{qchatSubReqTag:{type:F.type,opeType:F.opeType},channels:F.channels});case 3:return xe=fr.sent,z=new Xl,In(oe=F.channels).call(oe,function(Sr){return Mr(jt,void 0,void 0,ar.mark(function br(){return ar.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:this.serverRoleIdsMap[Sr.serverId]||z.add(Sr.serverId);case 1:case"end":return Dr.stop()}},br,this)}))}),Ve=eu(_c(z),10),In(Ve).call(Ve,function(Sr){jt.getRoleIdsByServerId(Sr)}),fr.abrupt("return",xe.content);case 9:case"end":return fr.stop()}},A,this)}))},x.resumeSubscribe=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve,jt,lr,fr,Sr=this;return ar.wrap(function(Er){for(;;)switch(Er.prev=Er.next){case 0:if(this.serverRoleIdsMap={},this.unreadServerCount={},this.unreadCount={},jt=100,F.isAutoReconnect){Er.next=6;break}return Er.abrupt("return");case 6:return lr={},In(oe=na(this.autoSubscribeUnreadMap)).call(oe,function(Dr){var $r=Sr.autoSubscribeUnreadMap[Dr];if($r){var vn=Dr.split("_"),Yr={serverId:vn[0],channelId:vn[1]};lr[$r]=lr[$r]||[],lr[$r].push(Yr)}}),lr[5]=[],In(xe=na(this.autoSubscribeTypingMap)).call(xe,function(Dr){return Mr(Sr,void 0,void 0,ar.mark(function $r(){var vn,Yr,wn,Zr;return ar.wrap(function(Dn){for(;;)switch(Dn.prev=Dn.next){case 0:this.autoSubscribeTypingMap[Dr]&&(vn=Dr.split("_"),Yr=vn[0],wn=vn[1],Zr={serverId:Yr,channelId:wn},lr[5].push(Zr));case 2:case"end":return Dn.stop()}},$r,this)}))}),lr[4]=[],In(z=na(this.autoSubscribeServerMap)).call(z,function(Dr){return Mr(Sr,void 0,void 0,ar.mark(function $r(){var vn;return ar.wrap(function(wn){for(;;)switch(wn.prev=wn.next){case 0:this.autoSubscribeServerMap[Dr]&&(vn={serverId:Dr},lr[4].push(vn));case 2:case"end":return wn.stop()}},$r,this)}))}),fr=[],In(Ve=na(lr)).call(Ve,function(Dr){var $r=lr[Dr];if($r&&$r.length===0)return uo.resolve();if($r.length>jt){var vn=eu($r,100);return In(vn).call(vn,function(Yr){fr.push(Sr.createSubscribePromise(Yr,Dr))})}fr.push(Sr.createSubscribePromise($r,Dr))}),Er.next=16,uo.all(fr);case 16:case"end":return Er.stop()}},A,this)}))},x.createSubscribePromise=function(F,A){var oe=this,xe={type:Lo(A),opeType:1,channels:F};return this.core.logger.debug("qchatChannel:: autoSubscribeUnread params",xe),this.subscribe(xe).then(function(z){var Ve=z.unreadInfos;Ve&&Ve.length>0&&(Ve=Nd(Ve),oe.cacheUnreadCount(Ve))}).catch(function(z){oe.core.logger.error("qchatChannel:: autoSubscribeUnread error ",z)})},x.cacheSubscribe=function(F){var A,oe=this;In(A=F.channels).call(A,function(xe){var z=xe.channelId?xe.serverId+"_"+xe.channelId:""+xe.serverId,Ve=F.type===5?oe.autoSubscribeTypingMap:F.type===4?oe.autoSubscribeServerMap:oe.autoSubscribeUnreadMap;F.opeType===jd.sub?Ve[z]=F.type:F.opeType===jd.unSub&&(Ve[z]=void 0)})},x.cacheUnreadCount=function(F){var A=this;In(F).call(F,function(oe){var xe=oe.serverId+"_"+oe.channelId;A.unreadCount[xe]=Tn({},oe),A.unreadServerCount[oe.serverId]||(A.unreadServerCount[oe.serverId]={}),A.unreadServerCount[oe.serverId][oe.channelId]=!0})},x.getServerUnreadInfo=function(F){var A,oe=this,xe={serverId:F,unreadCount:0,mentionedCount:0,maxCount:0},z=this.unreadServerCount[F];return z&&(In(A=na(z)).call(A,function(Ve){var jt=F+"_"+Ve,lr=oe.unreadCount[jt];xe.unreadCount+=lr.unreadCount,xe.mentionedCount+=lr.mentionedCount,lr.maxCount!==void 0&&(xe.maxCount=lr.maxCount)}),xe.unreadCount=xe.unreadCount>xe.maxCount?xe.maxCount:xe.unreadCount,xe.mentionedCount=xe.mentionedCount>xe.maxCount?xe.maxCount:xe.mentionedCount),xe},x.getUnreadInfo=function(F){Wr({serverId:{type:"string"},channelId:{type:"string"}},F);var A=F.serverId+"_"+F.channelId;return this.unreadCount[A]?this.unreadCount[A]:null},x.shouldChangeUnread=function(F,A){if(!F.serverId||!F.channelId||this.core.qchatChannel.subscribeForVisitorService.isInSubscribeChannels(F.serverId,F.channelId)||F.historyEnable===!1||F.needBadge===!1||F.fromAccount===this.core.account||A&&(F==null?void 0:F.status)!==2)return!1;if(F.notifyReason&&F.notifyReason===Bv($d,$d.notifySubscribe)){if(!F.serverId||!F.channelId)return!1;var oe=this.getUnreadInfo({serverId:F.serverId,channelId:F.channelId}),xe=A?"ackTimestamp":"lastMsgTime";if(!oe||F.time&&oe[xe]&&oe[xe]>F.time)return!1}return!0},x.shouldChangeMentionedUnread=function(F,A){return A===void 0&&(A=!1),Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(!F.accidsOfMentionedRoles||!gi(xe=F.accidsOfMentionedRoles).call(xe,this.core.account)){jt.next=2;break}return jt.abrupt("return",!0);case 2:if(!F.mentionRoleIds||!F.serverId){jt.next=16;break}if(this.serverRoleIdsMap[F.serverId]){jt.next=9;break}if(A){jt.next=7;break}return this.handledRoleMsg(F),jt.abrupt("return",!1);case 7:return jt.next=9,this.getRoleIdsByServerId([F.serverId]);case 9:z=0;case 10:if(!(z<F.mentionRoleIds.length)){jt.next=16;break}if(!this.serverRoleIdsMap[F.serverId].roleIds.has(F.mentionRoleIds[z])){jt.next=13;break}return jt.abrupt("return",!0);case 13:z++,jt.next=10;break;case 16:return jt.abrupt("return",!1);case 17:case"end":return jt.stop()}},oe,this)}))},x.handledRoleMsg=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve,jt,lr=this;return ar.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:if(F.mentionRoleIds){Sr.next=2;break}return Sr.abrupt("return");case 2:if(this.serverRoleIdsMap[F.serverId]){Sr.next=5;break}return Sr.next=5,this.getRoleIdsByServerId([F.serverId]);case 5:if(this.serverRoleIdsMap[F.serverId]){Sr.next=8;break}return this.core.logger.warn("QChatChannel::handledRoleMsg::can not get serverRoleIds,server id",F.serverId),Sr.abrupt("return");case 8:if(xe=!1,In(oe=F.mentionRoleIds).call(oe,function(br){lr.serverRoleIdsMap[F.serverId].roleIds.has(br)&&(xe=!0,lr.core.logger.debug("QChatChannel::handledRoleMsg::will update message mentionedCountmessage is ",F))}),xe){Sr.next=12;break}return Sr.abrupt("return");case 12:if(z=this.unreadCount[F.serverId+"_"+F.channelId],Ve=(F==null?void 0:F.status)===2,z.mentionedCount=Ve?z.mentionedCount?z.mentionedCount-1:0:z.mentionedCount?z.mentionedCount+1:1,typeof z.maxCount!="number"){Sr.next=24;break}if(!((jt=(jt=z.mentionedCount)>z.maxCount?z.maxCount:jt)>z.maxCount)){Sr.next=21;break}return this.core.logger.debug("QChatChannel::handledRoleMsg::tempUnreadCount more than maxCount"),Sr.abrupt("return");case 21:this.core.emit("unreadInfo",Tn(Tn({},z),{mentionedCount:jt})),this.core.emit("unreadInfos",[Tn(Tn({},z),{mentionedCount:jt})]),this._serverUnreadInfo(F.serverId);case 24:case"end":return Sr.stop()}},A,this)}))},x.getMentionedFlag=function(F,A){return A===void 0&&(A=!1),Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:if(!F.mentionAll){Ve.next=4;break}return Ve.abrupt("return",!0);case 4:if(!F.mentionRoleIds&&!F.accidsOfMentionedRoles){Ve.next=10;break}return Ve.next=7,this.shouldChangeMentionedUnread(F,A);case 7:return Ve.abrupt("return",Ve.sent);case 10:if(!F.mentionAccids||!gi(xe=F.mentionAccids).call(xe,this.core.account)){Ve.next=12;break}return Ve.abrupt("return",!0);case 12:return Ve.abrupt("return",!1);case 13:case"end":return Ve.stop()}},oe,this)}))},x.changeUnread=function(F,A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt,lr,fr,Sr;return ar.wrap(function(Er){for(;;)switch(Er.prev=Er.next){case 0:if(xe=F.serverId,z=F.channelId,Ve=xe+"_"+z,this.shouldChangeUnread(F,A)){Er.next=6;break}return this.core.logger.debug("changeUnread: "+Ve+" does not need to update unreadInfo"),Er.abrupt("return");case 6:if(this.unreadCount[Ve]){Er.next=11;break}return Er.next=9,this.core.qchatChannel.getChannelUnreadInfos({channels:[{serverId:xe,channelId:z}]});case 9:return!this.serverRoleIdsMap[xe]&&F.mentionRoleIds&&this.getRoleIdsByServerId([xe]),Er.abrupt("return");case 11:return jt=this.unreadCount[Ve],lr=(F==null?void 0:F.status)===2,Er.next=15,this.getMentionedFlag(F);case 15:if(fr=Er.sent,lr?(jt.unreadCount=jt.unreadCount?jt.unreadCount-1:0,fr&&(jt.mentionedCount=jt.mentionedCount?jt.mentionedCount-1:0),delete jt.lastMsgTime,this.core.logger.debug("changeUnread: "+Ve+" unread reduce ",jt)):(jt.unreadCount=jt.unreadCount?jt.unreadCount+1:1,fr&&(jt.mentionedCount=jt.mentionedCount?jt.mentionedCount+1:1),F.time&&(jt.lastMsgTime=F.time),this.core.logger.debug("changeUnread: "+Ve+" unread add ",jt)),Sr=typeof jt.maxCount=="number"?jt.maxCount:100,!(jt.unreadCount>Sr)){Er.next=21;break}return this.core.logger.debug("QChatChannel::subscribe::tempUnreadCount more than maxCount"),Er.abrupt("return");case 21:this.core.logger.warn("unreadInfo event will abandon,please use unreadInfos"),this.core.emit("unreadInfo",Tn(Tn({},jt),{mentionedCount:jt.mentionedCount>Sr?Sr:jt.mentionedCount,unreadCount:jt.unreadCount>Sr?Sr:jt.unreadCount})),this.core.emit("unreadInfos",[Tn(Tn({},jt),{mentionedCount:jt.mentionedCount>Sr?Sr:jt.mentionedCount,unreadCount:jt.unreadCount>Sr?Sr:jt.unreadCount})]),this._serverUnreadInfo(xe);case 25:case"end":return Er.stop()}},oe,this)}))},x.updateUnreads=function(F){var A,oe=this;if(F&&F.length>0){var xe=this.getServerUnreadInfo(F[0].serverId),z=this.unreadServerCount[F[0].serverId],Ve=ho(A=Ys(F).call(F,function(Dr){var $r=Dr.serverId+"_"+Dr.channelId,vn=oe.unreadCount[$r],Yr=Wa(vn,"ackTimestamp"),wn=Wa(Dr,"ackTimestamp");return!(Yr&&wn&&wn<Yr)&&(Wa(vn,"unreadCount")!==Wa(Dr,"unreadCount")||Wa(vn,"mentionedCount")!==Wa(Dr,"mentionedCount"))})).call(A,function(Dr){var $r=Dr.serverId,vn=Dr.channelId,Yr=$r+"_"+vn;return oe.core.logger.debug("qchat channel updateUnread: ",Dr),oe.unreadCount[Yr]=Tn({},Dr),oe.unreadServerCount[$r]||(oe.unreadServerCount[$r]={}),oe.unreadServerCount[$r][vn]=!0,Dr});if(Ve.length>0){this.core.emit("unreadInfos",Ve);var jt=this.getServerUnreadInfo(F[0].serverId),lr=this.unreadServerCount[F[0].serverId],fr=xe.unreadCount!==jt.unreadCount,Sr=!z||na(z).length===0,br=lr&&na(lr).length>0,Er=xe.mentionedCount!==jt.mentionedCount;(fr||Er||Sr&&br)&&this._serverUnreadInfo(Ve[0].serverId)}In(Ve).call(Ve,function(Dr){oe.core.emit("unreadInfo",Dr)})}},x.clearUnreadCountByServers=function(F,A){var oe=this,xe=[];In(F).call(F,function(Ve){var jt;oe.unreadServerCount[Ve]&&In(jt=na(oe.unreadServerCount[Ve])).call(jt,function(lr){xe.push(Ve+"_"+lr)})});var z=[];In(xe).call(xe,function(Ve){z.push(Tn(Tn({},oe.unreadCount[Ve]),{unreadCount:0,mentionedCount:0,ackTimestamp:A}))}),this.updateUnreads(z)},S}(),eC=function(){function S(V){this.limitForBatchEnter=10,this.limitForBatchSubscribe=100,this.autoServers=new Xl,this.autoVisitorSubscribeServer=new Xl,this.autoVisitorSubscribeChannel=new Xl,this.core=V}var x=S.prototype;return x.subscribeChannelAsVisitor=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve,jt=this;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return fr.next=2,this.core.sendCmd("qchatSubscribeAsVisitor",{tag:{type:F.type||6,opeType:F.opeType},datas:F.channels});case 2:return xe=fr.sent,z=xe.content.failedArr,Ve=Ys(oe=F.channels).call(oe,function(Sr){return!Ap(z).call(z,function(br){return br.channelId===Sr.channelId&&br.serverId===Sr.serverId})}),In(Ve).call(Ve,function(Sr){F.opeType===1?jt.autoVisitorSubscribeChannel.add(Sr.serverId+"&"+Sr.channelId):jt.autoVisitorSubscribeChannel.delete(Sr.serverId+"&"+Sr.channelId)}),fr.abrupt("return",{failedChannels:z});case 7:case"end":return fr.stop()}},A,this)}))},x.subscribeServerAsVisitor=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve,jt,lr,fr=this;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return br.next=2,this.core.sendCmd("qchatSubscribeAsVisitor",{tag:{type:F.type||7,opeType:F.opeType},datas:ho(oe=F.serverIds).call(oe,function(Er){return{serverId:Er}})});case 2:return Ve=br.sent,jt=Ve.content.failedArr,lr=Ys(xe=F.serverIds).call(xe,function(Er){return!Ap(jt).call(jt,function(Dr){return Dr.serverId===Er})}),In(lr).call(lr,function(Er){F.opeType===1?fr.autoVisitorSubscribeServer.add(Er):fr.autoVisitorSubscribeServer.delete(Er)}),br.abrupt("return",{failedServers:ho(z=Ve.content.failedArr).call(z,function(Er){return Er.serverId})});case 7:case"end":return br.stop()}},A,this)}))},x.deleteServer=function(F){var A;this.autoServers.delete(F),this.autoVisitorSubscribeServer.has(F)&&this.subscribeServerAsVisitor({opeType:2,serverIds:[F]});var oe=[];In(A=this.autoVisitorSubscribeChannel).call(A,function(xe){if(pa(xe).call(xe,F)===0){var z=xe.replace(F+"&","");oe.push({serverId:F,channelId:z})}}),oe.length>0&&this.subscribeChannelAsVisitor({opeType:2,channels:oe})},x.deleteAutoSetInServerId=function(F){var A,oe=this;this.autoServers.delete(F),this.autoVisitorSubscribeServer.delete(F),In(A=this.autoVisitorSubscribeChannel).call(A,function(xe){pa(xe).call(xe,F)===0&&oe.autoVisitorSubscribeChannel.delete(xe)})},x.deleteAutoSetInChannel=function(F,A){this.autoVisitorSubscribeChannel.delete(F+"&"+A)},x.unSubscribeChannel=function(F,A){this.subscribeChannelAsVisitor({opeType:2,channels:[{serverId:F,channelId:A}]})},x.isInSubscribeChannels=function(F,A){return this.autoVisitorSubscribeChannel.has(F+"&"+A)},x.isInAutoServers=function(F){return this.autoServers.has(F)},x.doAutoSubscribe=function(){var F=this,A=[],oe=eu(_c(this.autoVisitorSubscribeServer),this.limitForBatchSubscribe);In(oe).call(oe,function(z){A.push(F.subscribeServerAsVisitor({opeType:1,serverIds:z}))});var xe=eu(_c(this.autoVisitorSubscribeChannel),this.limitForBatchSubscribe);return In(xe).call(xe,function(z){A.push(F.subscribeChannelAsVisitor({opeType:1,channels:ho(z).call(z,function(Ve){var jt=pa(Ve).call(Ve,"&");return{serverId:Co(Ve).call(Ve,0,jt),channelId:Co(Ve).call(Ve,jt+1)}})}))}),uo.all(A)},x.doAutoEnterServer=function(){return Mr(this,void 0,void 0,ar.mark(function F(){var A,oe,xe,z=this;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return A=eu(_c(this.autoServers),this.limitForBatchEnter),oe=[],In(A).call(A,function(lr){oe.push(z.core.qchatServer.enterAsVisitor({serverIds:lr}))}),jt.next=5,uo.all(oe);case 5:xe=jt.sent,In(xe).call(xe,function(lr){var fr;In(fr=lr.failedServers).call(fr,function(Sr){z.deleteAutoSetInServerId(Sr)})});case 7:case"end":return jt.stop()}},F,this)}))},x.resumeSubscribe=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){return ar.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:if(!F.isAutoReconnect){xe.next=7;break}return xe.next=3,this.doAutoEnterServer();case 3:return xe.next=5,this.doAutoSubscribe();case 5:xe.next=10;break;case 7:this.autoServers.clear(),this.autoVisitorSubscribeChannel.clear(),this.autoVisitorSubscribeServer.clear();case 10:case"end":return xe.stop()}},A,this)}))},x.cacheServer=function(F){var A=this;In(F).call(F,function(oe){return A.autoServers.add(oe)})},S}();(function(S){S[S.sub=1]="sub",S[S.unSub=2]="unSub"})(Oh||(Oh={}));var tC=function(S){function x(F){var A,oe,xe,z,Ve,jt;return(jt=S.call(this,"qchatChannel",F)||this).core=F,Pi({cmdMap:wd,cmdConfig:Sh}),jt.subscribeModuleService=new ZS(F),jt.subscribeForVisitorService=new eC(F),jt.core.eventBus.on("qchatChannel/changeUnread",Oo(A=jt.subscribeModuleService.changeUnread).call(A,jt.subscribeModuleService)),jt.core.eventBus.on("qchatChannel/updateUnreads",Oo(oe=jt.subscribeModuleService.updateUnreads).call(oe,jt.subscribeModuleService)),jt.core.eventBus.on("qchatChannel/cacheSubscribe",Oo(xe=jt.subscribeModuleService.cacheSubscribe).call(xe,jt.subscribeModuleService)),jt.core.eventBus.on("qchatChannel/clearUnreadCountByServers",Oo(z=jt.subscribeModuleService.clearUnreadCountByServers).call(z,jt.subscribeModuleService)),jt.core.eventBus.on("qchatChannel/getRoleIdsByServerId",Oo(Ve=jt.subscribeModuleService.getRoleIdsByServerId).call(Ve,jt.subscribeModuleService)),jt.core.eventBus.on("logined",function(lr){jt.subscribeModuleService.resumeSubscribe(lr),jt.subscribeForVisitorService.resumeSubscribe(lr)}),jt.core.eventBus.on("qchatChannel/autoUnSubscribe",function(lr){if(jt.logger.log("QChatChannel::enter autoUnSubscribe sysMsg is",lr),lr.type===Xo[Xo.channelVisibilityUpdate])jt.logger.log("QChatChannel::begin autoUnSubscribe channel key is",lr.serverId+"_"+lr.channelId),jt.subscribeModuleService._unSubscribeChannel(lr.serverId,lr.channelId),jt.logger.log("QChatChannel::autoUnSubscribe channel done key is",lr.serverId+"_"+lr.channelId);else if(lr.type===Xo[Xo.serverEnterLeave]){var fr;jt.subscribeModuleService.autoSubscribeServerMap[lr.serverId]&&(jt.logger.log("QChatChannel::begin autoUnSubscribe server key is",lr.serverId),jt.subscribeModuleService.subscribe({type:4,opeType:Oh.unSub,channels:[{serverId:lr.serverId,channelId:""}]}),jt.logger.log("QChatChannel::autoUnSubscribe server done key is",lr.serverId));var Sr=jt.subscribeModuleService.unreadServerCount[lr.serverId];if(!Sr)return;jt.logger.log("QChatChannel::begin autoUnSubscribe channels key is",na(Sr)),In(fr=na(Sr)).call(fr,function(br){jt.subscribeModuleService._unSubscribeChannel(lr.serverId,br)}),jt.logger.log("QChatChannel::autoUnSubscribe channels done key is",na(Sr))}}),jt.core.eventBus.on("qchatChannel/serverIdentifyChange",function(lr){jt.subscribeModuleService.changeCacheServerRoleIds(lr)}),jt}Ro(x,S);var V=x.prototype;return V.createChannel=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",min:1},type:{type:"enum",values:ia(hl)},name:{type:"string",required:!1},topic:{type:"string",required:!1},ext:{type:"string",required:!1},visitorMode:{type:"number",required:!1}},A),Ve.next=3,this.core.sendCmd("qchatCreateChannel",{channelInfo:Tn(Tn({},A),{type:hl[A.type]}),antispamTag:Pc(A)});case 3:return xe=Ve.sent,Ve.abrupt("return",Ad(xe.content.channelInfo));case 5:case"end":return Ve.stop()}},oe,this)}))},V.deleteChannel=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({channelId:{type:"string",allowEmpty:!1}},A),z.next=3,this.core.sendCmd("qchatDeleteChannel",A);case 3:case"end":return z.stop()}},oe,this)}))},V.updateChannel=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return Wr({channelId:{type:"string",min:1},serverId:{type:"string",required:!1},type:{type:"enum",values:ia(hl),required:!1},name:{type:"string",required:!1},topic:{type:"string",required:!1},ext:{type:"string",required:!1},visitorMode:{type:"number",required:!1}},A),xe=A,A.type&&(xe.type=hl[A.type]),jt.next=5,this.core.sendCmd("qchatUpdateChannel",{channelInfo:xe,antispamTag:Pc(A)});case 5:return z=jt.sent,jt.abrupt("return",Ad(z.content.channelInfo));case 7:case"end":return jt.stop()}},oe,this)}))},V.getChannels=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({channelIds:{type:"array",itemType:"string",min:1}},A),Ve.next=3,this.core.sendCmd("qchatGetChannels",A);case 3:return xe=Ve.sent,Ve.abrupt("return",Od(xe.content.channelList));case 5:case"end":return Ve.stop()}},oe,this)}))},V.getChannelsByPage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Wr({serverId:{type:"string",min:1},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},A),fr.next=3,this.core.sendCmd("qchatGetChannelsByPage",{qchatGetChannelListPageTag:Tn({limit:100},A)});case 3:return xe=fr.sent,z=xe.content,Ve=z.datas,jt=z.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+jt.hasMore==1,nextTimetag:Lo(jt.nextTimetag)},datas:Od(Ve)});case 6:case"end":return fr.stop()}},oe,this)}))},V.getMembersByPage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Wr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},A),fr.next=3,this.core.sendCmd("qchatGetMembersByPage",{qchatGetMembersByPageTag:A});case 3:return xe=fr.sent,z=xe.content,Ve=z.datas,jt=z.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+jt.hasMore==1,nextTimetag:Lo(jt.nextTimetag)},datas:lc(Ve)});case 6:case"end":return fr.stop()}},oe,this)}))},V.updateWhiteBlackRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},roleId:{type:"string",min:1},type:{type:"enum",values:ia(ca)},opeType:{type:"enum",values:ia(ei)}},A),z.next=3,this.core.sendCmd("qchatUpdateWhiteBlackRole",{qchatUpdateWhiteBlackRoleTag:Tn(Tn({},A),{type:ca[A.type],opeType:ei[A.opeType]})});case 3:case"end":return z.stop()}},oe,this)}))},V.getWhiteBlackRolesPage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Wr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:ia(ca)},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},A),fr.next=3,this.core.sendCmd("qchatGetWhiteBlackRolesPage",{qchatGetWhiteBlackRolesPageTag:Tn(Tn({},A),{type:ca[A.type]})});case 3:return xe=fr.sent,z=xe.content,Ve=z.datas,jt=z.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+jt.hasMore==1,nextTimetag:Lo(jt.nextTimetag)},datas:Ks(Ve)});case 6:case"end":return fr.stop()}},oe,this)}))},V.updateWhiteBlackMembers=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:ia(ca)},opeType:{type:"enum",values:ia(ei)},toAccids:{type:"array",itemType:"string",min:1}},A),z.next=3,this.core.sendCmd("qchatUpdateWhiteBlackMembers",{qchatUpdateWhiteBlackMembersTag:Tn(Tn({},A),{type:ca[A.type],opeType:ei[A.opeType],toAccids:mo(A.toAccids)})});case 3:case"end":return z.stop()}},oe,this)}))},V.getWhiteBlackMembersPage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Wr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:ia(ca)},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},A),fr.next=3,this.core.sendCmd("qchatGetWhiteBlackMembersPage",{qchatGetWhiteBlackMembersPageTag:Tn(Tn({limit:100},A),{type:ca[A.type]})});case 3:return xe=fr.sent,z=xe.content,Ve=z.datas,jt=z.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+jt.hasMore==1,nextTimetag:Lo(jt.nextTimetag)},datas:lc(Ve)});case 6:case"end":return fr.stop()}},oe,this)}))},V.getExistingWhiteBlackRoles=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return Wr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:ia(ca)},roleIds:{type:"array",itemType:"string",min:1}},A),jt.next=3,this.core.sendCmd("qchatGetExistingWhiteBlackRoles",{qchatGetExistingWhiteBlackRolesTag:Tn(Tn({},A),{type:ca[A.type],roleIds:mo(A.roleIds)})});case 3:return xe=jt.sent,z=xe.content.datas,jt.abrupt("return",{datas:Ks(z)});case 6:case"end":return jt.stop()}},oe,this)}))},V.getExistingWhiteBlackMembers=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return Wr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:ia(ca)},accids:{type:"array",itemType:"string",min:1}},A),jt.next=3,this.core.sendCmd("qchatGetExistingWhiteBlackMembers",{qchatGetExistingWhiteBlackMembersTag:Tn(Tn({},A),{type:ca[A.type],accids:mo(A.accids)})});case 3:return xe=jt.sent,z=xe.content.datas,jt.abrupt("return",{datas:lc(z)});case 6:case"end":return jt.stop()}},oe,this)}))},V.updateCategoryInfoOfChannel=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({channelId:{type:"string",min:1},categoryId:{type:"string",allowEmpty:!1,required:!1},syncMode:{type:"number",min:0,max:1,required:!1}},A),Ve.next=3,this.core.sendCmd("qchatUpdateCategoryInfoOfChannel",{qchatUpdateCategoryInfoOfChannelTag:A});case 3:return xe=Ve.sent,Ve.abrupt("return",Ad(xe.content.channelInfo));case 5:case"end":return Ve.stop()}},oe,this)}))},V.createChannelCategory=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},name:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",required:!1},viewMode:{type:"number",min:0,max:1,required:!1}},A),Ve.next=3,this.core.sendCmd("qchatCreateChannelCategory",{qchatCreateChannelCategoryTag:A});case 3:return xe=Ve.sent,Ve.abrupt("return",Rd(xe.content.QChatChannelCategoryInfo));case 5:case"end":return Ve.stop()}},oe,this)}))},V.removeChannelCategory=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({categoryId:{type:"string",allowEmpty:!1}},A),z.next=3,this.core.sendCmd("qchatRemoveChannelCategory",A);case 3:case"end":return z.stop()}},oe,this)}))},V.updateChannelCategory=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({categoryId:{type:"string",allowEmpty:!1},name:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",required:!1},viewMode:{type:"number",min:0,max:1,required:!1}},A),Ve.next=3,this.core.sendCmd("qchatUpdateChannelCategory",{qchatUpdateChannelCategoryTag:A});case 3:return xe=Ve.sent,Ve.abrupt("return",Rd(xe.content.QChatChannelCategoryInfo));case 5:case"end":return Ve.stop()}},oe,this)}))},V.getChannelCategoriesByID=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({categoryIds:{type:"array",itemType:"string",min:1}},A),Ve.next=3,this.core.sendCmd("qchatGetChannelCategoriesByID",A);case 3:return xe=Ve.sent,Ve.abrupt("return",_h(xe.content.channelCategoryList));case 5:case"end":return Ve.stop()}},oe,this)}))},V.updateChannelCategoryWhiteBlackRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(ca)},opeType:{type:"enum",values:ia(ei)},roleId:{type:"string",allowEmpty:!1}},A),z.next=3,this.core.sendCmd("qchatUpdateChannelCategoryWhiteBlackRole",{qchatUpdateChannelCategoryWhiteBlackRoleTag:Tn(Tn({},A),{type:ca[A.type],opeType:ei[A.opeType]})});case 3:case"end":return z.stop()}},oe,this)}))},V.getChannelCategoryWhiteBlackRolesPage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Wr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(ca)},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},A),fr.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackRolesPage",{qchatGetChannelCategoryWhiteBlackRolesPageTag:Tn(Tn({},A),{type:ca[A.type]})});case 3:return xe=fr.sent,z=xe.content,Ve=z.datas,jt=z.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+jt.hasMore==1,nextTimetag:Lo(jt.nextTimetag)},datas:Ks(Ve)});case 6:case"end":return fr.stop()}},oe,this)}))},V.updateChannelCategoryWhiteBlackMembers=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(ca)},opeType:{type:"enum",values:ia(ei)},toAccids:{type:"array",itemType:"string",min:1}},A),z.next=3,this.core.sendCmd("qchatUpdateChannelCategoryWhiteBlackMembers",{qchatUpdateChannelCategoryWhiteBlackMembersTag:Tn(Tn({},A),{type:ca[A.type],opeType:ei[A.opeType],toAccids:mo(A.toAccids)})});case 3:case"end":return z.stop()}},oe,this)}))},V.getChannelCategoryWhiteBlackMembersPage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Wr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(ca)},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},A),fr.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackMembersPage",{qchatGetChannelCategoryWhiteBlackMembersPageTag:Tn(Tn({},A),{type:ca[A.type]})});case 3:return xe=fr.sent,z=xe.content,Ve=z.datas,jt=z.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+jt.hasMore==1,nextTimetag:Lo(jt.nextTimetag)},datas:lc(Ve)});case 6:case"end":return fr.stop()}},oe,this)}))},V.getChannelCategoryWhiteBlackRoles=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return Wr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(ca)},roleIds:{type:"array",itemType:"string",min:1}},A),jt.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackRoles",{qchatGetChannelCategoryWhiteBlackRolesTag:Tn(Tn({},A),{type:ca[A.type],roleIds:mo(A.roleIds)})});case 3:return xe=jt.sent,z=xe.content.datas,jt.abrupt("return",Ks(z));case 6:case"end":return jt.stop()}},oe,this)}))},V.getChannelCategoryWhiteBlackMembers=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return Wr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(ca)},accids:{type:"array",itemType:"string",min:1}},A),jt.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackMembers",{qchatGetChannelCategoryWhiteBlackMembersTag:Tn(Tn({},A),{type:ca[A.type],accids:mo(A.accids)})});case 3:return xe=jt.sent,z=xe.content.datas,jt.abrupt("return",lc(z));case 6:case"end":return jt.stop()}},oe,this)}))},V.getChannelCategoriesPage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},A),fr.next=3,this.core.sendCmd("qchatGetChannelCategoriesPage",{qchatGetChannelCategoriesPageTag:A});case 3:return xe=fr.sent,z=xe.content,Ve=z.datas,jt=z.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+jt.hasMore==1,nextTimetag:Lo(jt.nextTimetag)},datas:_h(Ve)});case 6:case"end":return fr.stop()}},oe,this)}))},V.getChannelCategoryChannelsPage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},A),fr.next=3,this.core.sendCmd("qchatGetChannelCategoryChannelsPage",{qchatGetChannelCategoryChannelsPageTag:A});case 3:return xe=fr.sent,z=xe.content,Ve=z.datas,jt=z.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+jt.hasMore==1,nextTimetag:Lo(jt.nextTimetag)},datas:Od(Ve)});case 6:case"end":return fr.stop()}},oe,this)}))},V.subscribeChannel=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return Wr({type:{type:"number",min:1,max:5},opeType:{type:"number",min:1,max:2}},A),jt.next=3,this.subscribeModuleService.subscribe(A);case 3:if((xe=jt.sent).unreadInfos=Nd(xe.unreadInfos),A.opeType===1&&(A.channels=ho(z=xe.unreadInfos).call(z,function(lr){return{serverId:lr.serverId,channelId:lr.channelId}})),this.logger.debug("QChatChannel::subscribeChannel:: cacheSubscribe ",A),this.subscribeModuleService.cacheSubscribe(A),A.type!==5){jt.next=10;break}return jt.abrupt("return");case 10:return this.subscribeModuleService.updateUnreads(xe.unreadInfos),jt.abrupt("return",xe);case 12:case"end":return jt.stop()}},oe,this)}))},V.getChannelUnreadInfos=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return jt.next=2,this.core.sendCmd("qchatGetUnreadInfo",A);case 2:return xe=jt.sent,z=Nd(xe.content.unreadInfos),this.subscribeModuleService.updateUnreads(z),jt.abrupt("return",z);case 6:case"end":return jt.stop()}},oe,this)}))},V.getChannelSearchByPage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:if(Wr({keyword:{type:"string",allowEmpty:!1},startTime:{type:"number",min:0,required:!1},endTime:{type:"number",min:1,required:!1},order:{type:"enum",values:ia(Ic),required:!1},limit:{type:"number",min:1,required:!1},serverId:{type:"string",required:!1},sort:{type:"enum",values:ia(Hp),required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},A),!(A.startTime&&A.endTime&&A.startTime>=A.endTime)){fr.next=3;break}throw new al("startTime more than endTime",A,"timeRule");case 3:return fr.next=5,this.core.sendCmd("qchatGetChannelSearchByPage",{qchatGetChannelSearchByPageTag:Tn(Tn({},A),{order:A.order&&Ic[A.order],sort:Wl(A)&&Hp[Wl(A)]})});case 5:return xe=fr.sent,z=xe.content,Ve=z.datas,jt=z.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+jt.hasMore==1,nextTimetag:Lo(jt.nextTimetag),cursor:jt.cursor},datas:Od(Ve)});case 8:case"end":return fr.stop()}},oe,this)}))},V.channelMemberSearch=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},keyword:{type:"string",allowEmpty:!1},limit:{type:"number",min:1,required:!1}},A),Ve.next=3,this.core.sendCmd("qchatChannelMemberSearch",{qchatChannelMemberSearchTag:A});case 3:return xe=Ve.sent,Ve.abrupt("return",NS(xe.content.datas));case 5:case"end":return Ve.stop()}},oe,this)}))},V.subscribeAsVisitor=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({opeType:{type:"number",min:1,max:2},type:{type:"number",required:!1},channels:{type:"array",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1}},min:1}},A),z.next=3,this.subscribeForVisitorService.subscribeChannelAsVisitor(A);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},x}(gl),Ly={"24_61":"qchatCreateServerRole","24_62":"qchatDeleteServerRole","24_63":"qchatUpdateServerRole","24_64":"qchatGetServerRoles","24_65":"qchatAddChannelRole","24_66":"qchatRemoveChannelRole","24_67":"qchatUpdateChannelRole","24_68":"qchatGetChannelRoles","24_69":"qchatAddMemberRole","24_70":"qchatRemoveMemberRole","24_71":"qchatUpdateMemberRole","24_72":"qchatGetMemberRoles","24_73":"qchatAddMembersToServerRole","24_74":"qchatRemoveMembersFromServerRole","24_75":"qchatGetMembersFromServerRole","24_76":"qchatGetServerRolesByAccid","24_77":"qchatGetExistingServerRolesByAccids","24_78":"qchatGetExistingChannelRolesByServerRoleIds","24_79":"qchatGetExistingAccidsOfMemberRoles","24_80":"qchatUpdateServerRolePriorities","24_81":"qchatGetExistingAccidsInServerRole","24_82":"qchatCheckPermission","24_83":"qchatAddChannelCategoryRole","24_84":"qchatRemoveChannelCategoryRole","24_85":"qchatUpdateChannelCategoryRole","24_86":"qchatGetChannelCategoryRole","24_87":"qchatAddChannelCategoryMemberRole","24_88":"qchatRemoveChannelCategoryMemberRole","24_89":"qchatUpdateChannelCategoryMemberRole","24_90":"qchatGetChannelCategoryMemberRole","24_126":"qchatCheckPermissions"},za={channelRole:{serverId:1,roleId:2,parentRoleId:3,channelId:4,name:5,icon:6,ext:7,auths:8,type:9,createTime:10,updateTime:11},memberRole:{serverId:1,id:2,accid:3,channelId:4,auths:5,createTime:6,updateTime:7,nick:8,avatar:9,ext:10,memberType:11,joinTime:12,inviter:13},antispamTag:{antiSpamBusinessId:1},serverRole:{serverId:1,roleId:2,name:3,icon:4,ext:5,auths:6,type:7,memberCount:8,priority:9,createTime:10,updateTime:11,isMember:12},getRoleByPagesTag:{serverId:1,channelId:2,time:3,limit:4},checkPermissionTag:{serverId:1,channelId:2,auth:3},member:{serverId:1,roleId:2,accid:3,createTime:4,updateTime:5,nick:6,avatar:7,ext:8,type:9,joinTime:10,inviter:11},qchatAddChannelCategoryRoleTag:{categoryId:3,serverId:4,parentRoleId:5},channelCategoryRole:{roleId:1,categoryId:3,serverId:4,parentRoleId:5,type:6,validFlag:7,createTime:8,updateTime:9,auths:10,name:11,icon:12,ext:13},qchatGetChannelCategoryRoleTag:{serverId:1,categoryId:2,timetag:3,limit:4},channelCategoryMemberRole:{id:1,accid:3,categoryId:4,serverId:5,validFlag:6,createTime:7,updateTime:8,auths:9,nick:10,avatar:11,ext:12,memberType:13,joinTime:14,inviter:15},qchatGetChannelCategoryMemberRoleTag:{serverId:1,categoryId:2,timetag:3,limit:4},checkPermissionsTag:{serverId:1,channelId:2,auths:3}},la=Cc(za),rC={qchatCreateServerRole:{service:"qchatRole",sid:24,cid:61,params:[{type:"Property",name:"serverRole",reflectMapper:za.serverRole},{type:"Property",name:"antispamTag",reflectMapper:za.antispamTag}],response:[{type:"Property",name:"serverRole",reflectMapper:la.serverRole}]},qchatDeleteServerRole:{service:"qchatRole",sid:24,cid:62,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"}]},qchatUpdateServerRole:{service:"qchatRole",sid:24,cid:63,params:[{type:"Property",name:"updateServerRoleTag",reflectMapper:{serverId:1,roleId:2,name:3,icon:4,ext:5,auths:6,priority:7}},{type:"Property",name:"antispamTag",reflectMapper:za.antispamTag}],response:[{type:"Property",name:"serverRole",reflectMapper:la.serverRole}]},qchatGetServerRoles:{service:"qchatRole",sid:24,cid:64,params:[{type:"Property",name:"getServerRolesTag",reflectMapper:{serverId:1,timetag:2,limit:3,priority:4,channelId:5,categoryId:6}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:la.serverRole}]},qchatAddChannelRole:{service:"qchatRole",sid:24,cid:65,params:[{type:"Property",name:"channelRole",reflectMapper:za.channelRole}],response:[{type:"Property",name:"channelRole",reflectMapper:la.channelRole}]},qchatRemoveChannelRole:{service:"qchatRole",sid:24,cid:66,params:[{type:"Long",name:"serverId"},{type:"Long",name:"channelId"},{type:"Long",name:"roleId"}]},qchatUpdateChannelRole:{service:"qchatRole",sid:24,cid:67,params:[{type:"Property",name:"updateChannelRoleTag",reflectMapper:{serverId:1,roleId:2,channelId:3,auths:4}}],response:[{type:"Property",name:"channelRole",reflectMapper:la.channelRole}]},qchatGetChannelRoles:{service:"qchatRole",sid:24,cid:68,params:[{type:"Property",name:"getChannelRolesTag",reflectMapper:{serverId:1,channelId:2,timetag:3,limit:4}}],response:[{type:"PropertyArray",name:"channelRoles",reflectMapper:la.channelRole}]},qchatAddMemberRole:{service:"qchatRole",sid:24,cid:69,params:[{type:"Property",name:"memberRole",reflectMapper:za.memberRole}],response:[{type:"Property",name:"memberRole",reflectMapper:la.memberRole}]},qchatRemoveMemberRole:{service:"qchatRole",sid:24,cid:70,params:[{type:"Property",name:"memberRole",reflectMapper:za.memberRole}]},qchatUpdateMemberRole:{service:"qchatRole",sid:24,cid:71,params:[{type:"Property",name:"updateMemberRoleTag",reflectMapper:{serverId:1,accid:2,channelId:3,auths:4}}],response:[{type:"Property",name:"memberRole",reflectMapper:la.memberRole}]},qchatGetMemberRoles:{service:"qchatRole",sid:24,cid:72,params:[{type:"Property",name:"getMemberRolesTag",reflectMapper:{serverId:1,channelId:2,timetag:3,limit:4}}],response:[{type:"PropertyArray",name:"memberRoles",reflectMapper:la.memberRole}]},qchatAddMembersToServerRole:{service:"qchatRole",sid:24,cid:73,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"},{type:"String",name:"accids"}],response:[{type:"Property",name:"accids",reflectMapper:{1:"successAccids",2:"failedAccids"}}]},qchatRemoveMembersFromServerRole:{service:"qchatRole",sid:24,cid:74,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"},{type:"String",name:"accids"}],response:[{type:"Property",name:"accids",reflectMapper:{1:"successAccids",2:"failedAccids"}}]},qchatGetMembersFromServerRole:{service:"qchatRole",sid:24,cid:75,params:[{type:"Property",name:"getMembersFromServerRoleTag",reflectMapper:{serverId:1,roleId:2,timetag:3,accid:4,limit:5}}],response:[{type:"PropertyArray",name:"members",reflectMapper:la.member}]},qchatGetServerRolesByAccid:{service:"qchatRole",sid:24,cid:76,params:[{type:"Property",name:"getServerRolesByAccidTag",reflectMapper:{serverId:1,accid:2,timetag:3,limit:4}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:la.serverRole}]},qchatGetExistingServerRolesByAccids:{service:"qchatRole",sid:24,cid:77,params:[{type:"Long",name:"serverId"},{type:"String",name:"accids"}],response:[{type:"String",name:"serverRoles"}]},qchatGetExistingChannelRolesByServerRoleIds:{service:"qchatRole",sid:24,cid:78,params:[{type:"Long",name:"serverId"},{type:"Long",name:"channelId"},{type:"String",name:"roleIds"}],response:[{type:"PropertyArray",name:"channelRoles",reflectMapper:la.channelRole}]},qchatGetExistingAccidsOfMemberRoles:{service:"qchatRole",sid:24,cid:79,params:[{type:"Long",name:"serverId"},{type:"Long",name:"channelId"},{type:"String",name:"accids"}],response:[{type:"PropertyArray",name:"memberRoles",reflectMapper:la.memberRole}]},qchatUpdateServerRolePriorities:{service:"qchatRole",sid:24,cid:80,params:[{type:"Long",name:"serverId"},{type:"PropertyArray",name:"serverRoles",reflectMapper:{serverId:1,roleId:2,priority:7}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:la.serverRole}]},qchatGetExistingAccidsInServerRole:{service:"qchatRole",sid:24,cid:81,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"},{type:"String",name:"accids"}],response:[{type:"PropertyArray",name:"members",reflectMapper:la.member}]},qchatCheckPermission:{service:"qchatRole",sid:24,cid:82,params:[{type:"Property",name:"checkPermissionTag",reflectMapper:za.checkPermissionTag}],response:[{type:"Boolean",name:"checked"}]},qchatAddChannelCategoryRole:{service:"qchatRole",sid:24,cid:83,params:[{type:"Property",name:"qchatAddChannelCategoryRoleTag",reflectMapper:za.channelCategoryRole}],response:[{type:"Property",name:"channelCategoryRole",reflectMapper:la.channelCategoryRole}]},qchatRemoveChannelCategoryRole:{service:"qchatRole",sid:24,cid:84,params:[{type:"Long",name:"serverId"},{type:"Long",name:"categoryId"},{type:"Long",name:"roleId"}]},qchatUpdateChannelCategoryRole:{service:"qchatRole",sid:24,cid:85,params:[{type:"Property",name:"qchatUpdateChannelCategoryRoleTag",reflectMapper:za.channelCategoryRole}],response:[{type:"Property",name:"channelCategoryRole",reflectMapper:la.channelCategoryRole}]},qchatGetChannelCategoryRole:{service:"qchatRole",sid:24,cid:86,params:[{type:"Property",name:"qchatGetChannelCategoryRoleTag",reflectMapper:za.qchatGetChannelCategoryRoleTag}],response:[{type:"PropertyArray",name:"list",reflectMapper:la.channelCategoryRole}]},qchatAddChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:87,params:[{type:"Property",name:"qchatAddChannelCategoryMemberRoleTag",reflectMapper:za.channelCategoryMemberRole}],response:[{type:"Property",name:"channelCategoryMemberRole",reflectMapper:la.channelCategoryMemberRole}]},qchatRemoveChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:88,params:[{type:"Long",name:"serverId"},{type:"Long",name:"categoryId"},{type:"String",name:"accid"}]},qchatUpdateChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:89,params:[{type:"Property",name:"qchatUpdateChannelCategoryMemberRoleTag",reflectMapper:za.channelCategoryMemberRole}],response:[{type:"Property",name:"channelCategoryMemberRole",reflectMapper:la.channelCategoryMemberRole}]},qchatGetChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:90,params:[{type:"Property",name:"qchatGetChannelCategoryMemberRoleTag",reflectMapper:za.qchatGetChannelCategoryMemberRoleTag}],response:[{type:"PropertyArray",name:"list",reflectMapper:la.channelCategoryMemberRole}]},qchatCheckPermissions:{service:"qchatRole",sid:24,cid:126,params:[{type:"Property",name:"checkPermissionsTag",reflectMapper:za.checkPermissionsTag}],response:[{type:"PropertyArray",name:"checkPermissionsResult",reflectMapper:{1:"auth",2:"isAllow"}}]}},nC=function(){function S(V){this.core=V}var x=S.prototype;return x.addChannelCategoryRole=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},parentRoleId:{type:"string",allowEmpty:!1}},F),z.next=3,this.core.sendCmd("qchatAddChannelCategoryRole",{qchatAddChannelCategoryRoleTag:F});case 3:return oe=z.sent,z.abrupt("return",Gp(oe.content.channelCategoryRole));case 5:case"end":return z.stop()}},A,this)}))},x.removeChannelCategoryRole=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){return ar.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1}},F),xe.next=3,this.core.sendCmd("qchatRemoveChannelCategoryRole",F);case 3:case"end":return xe.stop()}},A,this)}))},x.updateChannelCategoryRole=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},auths:{type:"object"}},F),z.next=3,this.core.sendCmd("qchatUpdateChannelCategoryRole",{qchatUpdateChannelCategoryRoleTag:Ac(F)});case 3:if((oe=z.sent).raw.code!==406){z.next=6;break}throw new yo("No update required",{},406);case 6:return z.abrupt("return",Gp(oe.content.channelCategoryRole));case 7:case"end":return z.stop()}},A,this)}))},x.getChannelCategoryRole=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1}},F),z.next=3,this.core.sendCmd("qchatGetChannelCategoryRole",{qchatGetChannelCategoryRoleTag:F});case 3:return oe=z.sent,z.abrupt("return",(Ve=oe.content.list,ns(Ve)&&Ve.length>0?ho(Ve).call(Ve,function(jt){return Gp(jt)}):[]));case 5:case"end":return z.stop()}var Ve},A,this)}))},x.addChannelCategoryMemberRole=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},F),z.next=3,this.core.sendCmd("qchatAddChannelCategoryMemberRole",{qchatAddChannelCategoryMemberRoleTag:F});case 3:return oe=z.sent,z.abrupt("return",Yl(oe.content.channelCategoryMemberRole));case 5:case"end":return z.stop()}},A,this)}))},x.removeChannelCategoryMemberRole=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){return ar.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},F),xe.next=3,this.core.sendCmd("qchatRemoveChannelCategoryMemberRole",F);case 3:case"end":return xe.stop()}},A,this)}))},x.updateChannelCategoryMemberRole=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},auths:{type:"object"}},F),z.next=3,this.core.sendCmd("qchatUpdateChannelCategoryMemberRole",{qchatUpdateChannelCategoryMemberRoleTag:Ac(F)});case 3:if((oe=z.sent).raw.code!==406){z.next=6;break}throw new yo("No update required",{},406);case 6:return z.abrupt("return",Yl(oe.content.channelCategoryMemberRole));case 7:case"end":return z.stop()}},A,this)}))},x.getChannelCategoryMemberRole=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1}},F),z.next=3,this.core.sendCmd("qchatGetChannelCategoryMemberRole",{qchatGetChannelCategoryMemberRoleTag:F});case 3:return oe=z.sent,z.abrupt("return",(Ve=oe.content.list,ns(Ve)&&Ve.length>0?ho(Ve).call(Ve,function(jt){return Yl(jt)}):[]));case 5:case"end":return z.stop()}var Ve},A,this)}))},S}(),oC=function(S){function x(F){var A;return(A=S.call(this,"qchatRole",F)||this).core=F,Pi({cmdMap:Ly,cmdConfig:rC}),A.category=new nC(F),A}Ro(x,S);var V=x.prototype;return V.createServerRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},name:{type:"string",allowEmpty:!1},priority:{type:"number",min:1},icon:{type:"string",required:!1},ext:{type:"string",required:!1}},A),Ve.next=3,this.core.sendCmd("qchatCreateServerRole",{serverRole:Tn(Tn({},Ac(A)),{type:Jl.custom}),antispamTag:Pc(A)});case 3:return xe=Ve.sent,Ve.abrupt("return",ps(xe.content.serverRole));case 5:case"end":return Ve.stop()}},oe,this)}))},V.updateServerRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},name:{type:"string",required:!1},icon:{type:"string",required:!1},ext:{type:"string",required:!1},priority:{type:"number",required:!1},auths:{type:"object",required:!1}},A),Ve.next=3,this.core.sendCmd("qchatUpdateServerRole",{updateServerRoleTag:Ac(A),antispamTag:Pc(A)});case 3:return xe=Ve.sent,Ve.abrupt("return",ps(xe.content.serverRole));case 5:case"end":return Ve.stop()}},oe,this)}))},V.deleteServerRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1}},A),z.next=3,this.core.sendCmd("qchatDeleteServerRole",A);case 3:case"end":return z.stop()}},oe,this)}))},V.getServerRoles=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},categoryId:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,required:!1},priority:{type:"number",required:!1}},A),lr.next=3,this.core.sendCmd("qchatGetServerRoles",{getServerRolesTag:Ac(A)});case 3:return z=lr.sent,Ve=Ys(xe=z.content.serverRoles).call(xe,function(fr){return Lo(fr.isMember)===1}),Ve=ho(Ve).call(Ve,function(fr){return fr.roleId}),lr.abrupt("return",{roles:Ks(z.content.serverRoles),isMemberRoles:Ve});case 7:case"end":return lr.stop()}},oe,this)}))},V.addChannelRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},parentRoleId:{type:"string",allowEmpty:!1}},A),Ve.next=3,this.core.sendCmd("qchatAddChannelRole",{channelRole:Ac(A)});case 3:return xe=Ve.sent,Ve.abrupt("return",ps(xe.content.channelRole));case 5:case"end":return Ve.stop()}},oe,this)}))},V.getChannelRoles=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},limit:{type:"number",min:1,required:!1}},A),Ve.next=3,this.core.sendCmd("qchatGetChannelRoles",{getChannelRolesTag:A});case 3:return xe=Ve.sent,Ve.abrupt("return",Ks(xe.content.channelRoles));case 5:case"end":return Ve.stop()}},oe,this)}))},V.removeChannelRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1}},A),z.next=3,this.core.sendCmd("qchatRemoveChannelRole",A);case 3:case"end":return z.stop()}},oe,this)}))},V.updateChannelRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},auths:{type:"object",required:!1}},A),Ve.next=3,this.core.sendCmd("qchatUpdateChannelRole",{updateChannelRoleTag:Ac(A)});case 3:if((xe=Ve.sent).raw.code!==406){Ve.next=6;break}throw new yo("No update required",{},406);case 6:return Ve.abrupt("return",ps(xe.content.channelRole));case 7:case"end":return Ve.stop()}},oe,this)}))},V.addMemberRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},A),Ve.next=3,this.core.sendCmd("qchatAddMemberRole",{memberRole:A});case 3:return xe=Ve.sent,Ve.abrupt("return",ps(xe.content.memberRole));case 5:case"end":return Ve.stop()}},oe,this)}))},V.getMemberRoles=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},limit:{type:"number",min:1,required:!1}},A),Ve.next=3,this.core.sendCmd("qchatGetMemberRoles",{getMemberRolesTag:A});case 3:return xe=Ve.sent,Ve.abrupt("return",Ks(xe.content.memberRoles));case 5:case"end":return Ve.stop()}},oe,this)}))},V.removeMemberRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},A),z.next=3,this.core.sendCmd("qchatRemoveMemberRole",{memberRole:A});case 3:case"end":return z.stop()}},oe,this)}))},V.updateMemberRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},auths:{type:"object",required:!1}},A),Ve.next=3,this.core.sendCmd("qchatUpdateMemberRole",{updateMemberRoleTag:Ac(A)});case 3:if((xe=Ve.sent).raw.code!==406){Ve.next=6;break}throw new yo("No update required",{},406);case 6:return Ve.abrupt("return",ps(xe.content.memberRole));case 7:case"end":return Ve.stop()}},oe,this)}))},V.addMembersToServerRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string",min:1}},A),lr.next=3,this.core.sendCmd("qchatAddMembersToServerRole",Tn(Tn({},A),{accids:mo(A.accids)}));case 3:return xe=lr.sent,z=Wa(xe,"content.accids.successAccids"),Ve=Wa(xe,"content.accids.failedAccids"),lr.abrupt("return",{successAccids:z?JSON.parse(z):[],failedAccids:Ve?JSON.parse(Ve):[]});case 7:case"end":return lr.stop()}},oe,this)}))},V.removeMembersFromServerRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string",min:1}},A),lr.next=3,this.core.sendCmd("qchatRemoveMembersFromServerRole",Tn(Tn({},A),{accids:mo(A.accids)}));case 3:return xe=lr.sent,z=Wa(xe,"content.accids.successAccids"),Ve=Wa(xe,"content.accids.failedAccids"),lr.abrupt("return",{successAccids:z?JSON.parse(z):[],failedAccids:Ve?JSON.parse(Ve):[]});case 7:case"end":return lr.stop()}},oe,this)}))},V.getMembersFromServerRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},accid:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,required:!1}},A),Ve.next=3,this.core.sendCmd("qchatGetMembersFromServerRole",{getMembersFromServerRoleTag:A});case 3:return xe=Ve.sent,Ve.abrupt("return",Ks(xe.content.members));case 5:case"end":return Ve.stop()}},oe,this)}))},V.getServerRolesByAccid=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},limit:{type:"number",min:1,required:!1}},A),Ve.next=3,this.core.sendCmd("qchatGetServerRolesByAccid",{getServerRolesByAccidTag:A});case 3:return xe=Ve.sent,Ve.abrupt("return",Ks(xe.content.serverRoles));case 5:case"end":return Ve.stop()}},oe,this)}))},V.getExistingServerRolesByAccids=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string"}},A),lr.next=3,this.core.sendCmd("qchatGetExistingServerRolesByAccids",{serverId:A.serverId,accids:mo(A.accids)});case 3:return xe=lr.sent,lr.prev=4,Ve=JSON.parse(xe.content.serverRoles),In(z=na(Ve)).call(z,function(fr){var Sr;In(Sr=Ve[fr]).call(Sr,function(br,Er){Ve[fr][Er]=Na(br,la.serverRole)}),Ve[fr]=Ks(Ve[fr])}),lr.abrupt("return",Ve);case 10:throw lr.prev=10,lr.t0=lr.catch(4),this.logger.error("can not parse serverRolesGroupByAccid from "+A.serverId+" and "+A.accids,xe.content.serverRoles),lr.t0;case 14:case"end":return lr.stop()}},oe,this,[[4,10]])}))},V.getExistingChannelRolesByServerRoleIds=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},roleIds:{type:"array",itemType:"string"}},A),Ve.next=3,this.core.sendCmd("qchatGetExistingChannelRolesByServerRoleIds",{serverId:A.serverId,channelId:A.channelId,roleIds:mo(A.roleIds)});case 3:return xe=Ve.sent,Ve.abrupt("return",Ks(xe.content.channelRoles));case 5:case"end":return Ve.stop()}},oe,this)}))},V.getExistingAccidsOfMemberRoles=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string"}},A),jt.next=3,this.core.sendCmd("qchatGetExistingAccidsOfMemberRoles",{serverId:A.serverId,channelId:A.channelId,accids:mo(A.accids)});case 3:return xe=jt.sent,z=xe.content.memberRoles,jt.abrupt("return",z&&z.length>0?ho(z).call(z,function(lr){return lr.accid}):[]);case 6:case"end":return jt.stop()}},oe,this)}))},V.getExistingAccidsInServerRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string"}},A),jt.next=3,this.core.sendCmd("qchatGetExistingAccidsInServerRole",{serverId:A.serverId,roleId:A.roleId,accids:mo(A.accids)});case 3:return xe=jt.sent,z=xe.content.members,jt.abrupt("return",z&&z.length>0?ho(z).call(z,function(lr){return lr.accid}):[]);case 6:case"end":return jt.stop()}},oe,this)}))},V.updateServerRolePriorities=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},serverRoles:{type:"array"}},A),jt.next=3,this.core.sendCmd("qchatUpdateServerRolePriorities",{serverId:A.serverId,serverRoles:ho(xe=A.serverRoles).call(xe,function(lr){return{serverId:lr.serverId,roleId:lr.roleId,priority:lr.priority}})});case 3:return z=jt.sent,jt.abrupt("return",Ks(z.content.serverRoles));case 5:case"end":return jt.stop()}},oe,this)}))},V.checkPermission=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},auth:{type:"string"}},A),Ve.next=3,this.core.sendCmd("qchatCheckPermission",{checkPermissionTag:Tn(Tn({},A),{auth:bl[A.auth]||A.auth})});case 3:return xe=Ve.sent,Ve.abrupt("return",xe.content.checked);case 5:case"end":return Ve.stop()}},oe,this)}))},V.addChannelCategoryRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.addChannelCategoryRole(A);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},V.removeChannelCategoryRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.removeChannelCategoryRole(A);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},V.updateChannelCategoryRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.updateChannelCategoryRole(A);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},V.getChannelCategoryRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.getChannelCategoryRole(A);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},V.addChannelCategoryMemberRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.addChannelCategoryMemberRole(A);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},V.removeChannelCategoryMemberRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.removeChannelCategoryMemberRole(A);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},V.updateChannelCategoryMemberRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.updateChannelCategoryMemberRole(A);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},V.getChannelCategoryMemberRole=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.getChannelCategoryMemberRole(A);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},V.checkPermissions=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},auths:{type:"array",itemType:"string"}},A),this.core.logger.log("qchatRole::checkPermission options is",A),fr.next=4,this.core.sendCmd("qchatCheckPermissions",{checkPermissionsTag:Tn(Tn({},A),{auths:mo(ho(xe=A.auths).call(xe,function(Sr){return bl[Sr]||Sr}))})});case 4:return Ve=fr.sent,this.core.logger.log("qchatRole::checkPermission result is",Ve.content),jt={},In(z=Ve.content.checkPermissionsResult).call(z,function(Sr){jt[Sr.auth]=Sr.isAllow}),this.core.logger.log("qchatRole::checkPermission auths is",jt),fr.abrupt("return",Si(jt));case 10:case"end":return fr.stop()}},oe,this)}))},x}(gl),Yp=function(x,V){return ly(x,V,function(F,A){return iy(x,A)})},aC=function(x){return x!=null&&x.length?Ay(x,1):[]},pc,Ns,Xp=function(x){return Pv(Iv(x,void 0,aC),x+"")}(function(S,x){return S==null?{}:Yp(S,x)}),Nh={"24_10":"qchatSendMsg","24_11":"qchatOnMsg","24_12":"qchatOnRecvUnreadInfo","24_13":"qchatSendCustomSysMsg","24_14":"qchatOnSysMsg","24_16":"qchatGetHistoryMsg","24_17":"qchatMarkMessageRead","24_18":"qchatMultiSyncMessageRead","24_22":"qchatUpdateSystemNotification","24_23":"qchatMultiSyncSystemNotificationUpdate","24_24":"qchatSyncSystemNotification","24_25":"qchatUpdateMessage","24_26":"qchatRecvMessageUpdate","24_28":"qchatMarkSysMsgRead","24_94":"qchatMessageSearchByPage","24_100":"qchatGetMessageHistoryByIds","24_101":"qchatGetThreadMessages","24_102":"qchatUpdateQuickComment","24_103":"qchatGetQuickComments","24_108":"qchatGetThreadRootMessagesMeta","24_121":"qchatGetLastMessageOfChannels","24_127":"qchatGetMentionedMeMessages","25_6":"qchatMultiSyncServersMessageRead"},fs={getHistoryMsgTag:{serverId:1,channelId:2,beginTime:3,endTime:4,excludeMsgId:5,limit:6,reverse:7},getThreadHistoryMsgTag:{beginTime:1,endTime:2,excludeMsgId:3,limit:4,reverse:5},qchatMsgTag:{serverId:1,channelId:2,fromAccount:3,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,updateTime:8,type:9,body:10,attach:11,ext:12,msgIdClient:13,msgIdServer:14,resendFlag:15,status:16,pushPayload:17,pushContent:18,mentionAccids:19,mentionAll:20,env:21,callbackExt:22,replyMsgFromAccount:23,replyMsgTime:24,replyMsgIdServer:25,replyMsgIdClient:26,threadMsgFromAccount:27,threadMsgTime:28,threadMsgIdServer:29,threadMsgIdClient:30,useCustomContent:31,antiSpamContent:32,antiSpamBusinessId:33,antiSpamUsingYidun:34,yidunCallback:35,yidunAntiCheating:36,yidunAntiSpamExt:37,yidunAntiSpamRes:38,mentionRoleIds:41,accidsOfMentionedRoles:42,updateContent:39,updateOperatorInfo:40,subType:61,historyEnable:100,pushEnable:101,needBadge:102,needPushNick:103,notifyReason:104,routeEnable:105,isAntispam:106},sysMsg:{toType:1,serverId:2,channelId:3,toAccids:4,fromAccount:5,fromClientType:6,fromDeviceId:7,fromNick:8,time:9,updateTime:10,type:11,msgIdClient:12,msgIdServer:13,body:14,attach:15,ext:16,resendFlag:17,status:18,pushPayload:19,pushContent:20,env:21,callbackExt:22,persistEnable:100,pushEnable:101,needBadge:102,needPushNick:103,routeEnable:104},qchatMsgUpdateTag:{operatorAccount:1,operatorClientType:2,ps:3,ext:4,pushContent:5,pushPayload:6,env:7,routeEnable:100},markMsgReadTag:{serverId:1,channelId:2,time:3},qchatQuickCommentRequestTag:{serverId:1,channelId:2,fromAccount:3,msgIdServer:4,time:5,type:6,opeType:7,opeAccid:8},qchatQuickCommentQueryTag:{serverId:1,channelId:2,msgIdServerList:3},qchatGetLastMessageOfChannelsTag:{serverId:1,channelIdList:2},qchatMultiSyncServersMessageReadTag:{successServerIds:1,failServerIds:2,ackTimestamp:3},qchatMessageSearchByPageTag:{keyword:1,serverId:2,channelId:3,fromAccid:4,fromTime:5,toTime:6,msgTypes:7,subTypes:8,includeSelf:9,order:10,limit:11,sort:12,cursor:13},qchatPageQueryTag:{hasMore:1,nextTimetag:2,cursor:3},unreadInfo:Th},fa=Cc(fs),sC={qchatSendMsg:{service:"qchatMsg",sid:24,cid:10,params:[{type:"Property",name:"qchatMsg",reflectMapper:fs.qchatMsgTag}],response:[{type:"Property",name:"qchatMsg",reflectMapper:fa.qchatMsgTag}]},qchatOnMsg:{service:"qchatMsg",sid:24,cid:11,response:[{type:"Property",name:"qchatMsg",reflectMapper:fa.qchatMsgTag}]},qchatOnRecvUnreadInfo:{service:"qchatMsg",sid:24,cid:12,response:[{type:"Property",name:"qchatMsg",reflectMapper:fa.qchatMsgTag}]},qchatSendCustomSysMsg:{service:"qchatMsg",sid:24,cid:13,params:[{type:"Property",name:"sysMsg",reflectMapper:fs.sysMsg}],response:[{type:"Property",name:"sysMsg",reflectMapper:fa.sysMsg}]},qchatOnSysMsg:{service:"qchatMsg",sid:24,cid:14,response:[{type:"Property",name:"sysMsg",reflectMapper:fa.sysMsg}]},qchatGetHistoryMsg:{service:"qchatMsg",sid:24,cid:16,params:[{type:"Property",name:"getHistoryMsgTag",reflectMapper:fs.getHistoryMsgTag}],response:[{type:"PropertyArray",name:"qchatMsgs",reflectMapper:fa.qchatMsgTag}]},qchatUpdateMessage:{service:"qchatMsg",sid:24,cid:25,params:[{type:"Property",name:"qchatMsgUpdateTag",reflectMapper:fs.qchatMsgUpdateTag},{type:"Property",name:"qchatMsg",reflectMapper:fs.qchatMsgTag}],response:[{type:"Property",name:"qchatMsg",reflectMapper:fa.qchatMsgTag}]},qchatRecvMessageUpdate:{service:"qchatMsg",sid:24,cid:26,response:[{type:"Property",name:"qchatMsgUpdateInfo",reflectMapper:fa.qchatMsgUpdateTag},{type:"Property",name:"qchatMsg",reflectMapper:fa.qchatMsgTag}]},qchatMarkMessageRead:{sid:24,cid:17,service:"qchatMsg",params:[{type:"Property",name:"markMsgReadTag",reflectMapper:fs.markMsgReadTag}],response:[{type:"Property",name:"unreadInfo",reflectMapper:fa.unreadInfo}]},qchatMultiSyncMessageRead:{sid:24,cid:18,service:"qchatMsg",response:[{type:"Property",name:"unreadInfo",reflectMapper:fa.unreadInfo}]},qchatUpdateSystemNotification:{service:"qchatMsg",sid:24,cid:22,params:[{type:"Property",name:"qchatMsgUpdateTag",reflectMapper:fs.qchatMsgUpdateTag},{type:"Property",name:"sysMsg",reflectMapper:fs.sysMsg}],response:[{type:"Property",name:"sysMsg",reflectMapper:fa.sysMsg}]},qchatMultiSyncSystemNotificationUpdate:{service:"qchatMsg",sid:24,cid:23,response:[{type:"Property",name:"qchatMsgUpdateTag",reflectMapper:fa.qchatMsgUpdateTag},{type:"Property",name:"sysMsg",reflectMapper:fa.sysMsg}]},qchatSyncSystemNotification:{service:"qchatMsg",sid:24,cid:24,response:[{type:"PropertyArray",name:"systemNotifications",reflectMapper:fa.sysMsg}]},qchatMarkSysMsgRead:{service:"qchatMsg",sid:24,cid:28,params:[{type:"PropertyArray",name:"sysMsgs",reflectMapper:fs.sysMsg}]},qchatMessageSearchByPage:{service:"qchatMsg",sid:24,cid:94,params:[{type:"Property",name:"qchatMessageSearchByPageTag",reflectMapper:fs.qchatMessageSearchByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:fa.qchatPageQueryTag},{type:"PropertyArray",name:"datas",reflectMapper:fa.qchatMsgTag}]},qchatGetMessageHistoryByIds:{service:"qchatMsg",sid:24,cid:100,params:[{type:"Property",name:"channelInfo",reflectMapper:{serverId:1,channelId:2}},{type:"PropertyArray",name:"messageReferList",reflectMapper:{msgIdServer:1,time:2}}],response:[{type:"PropertyArray",name:"qchatMsgs",reflectMapper:fa.qchatMsgTag}]},qchatGetThreadMessages:{service:"qchatMsg",sid:24,cid:101,params:[{type:"Property",name:"qchatMsg",reflectMapper:fs.qchatMsgTag},{type:"Property",name:"getThreadHistoryMsgTag",reflectMapper:fs.getThreadHistoryMsgTag}],response:[{type:"Property",name:"thread",reflectMapper:fa.qchatMsgTag},{type:"Property",name:"threadInfo",reflectMapper:{1:"messageCount",2:"lastMessageTimestamp"}},{type:"PropertyArray",name:"qchatMsgs",reflectMapper:fa.qchatMsgTag}]},qchatUpdateQuickComment:{service:"qchatMsg",sid:24,cid:102,params:[{type:"Property",name:"tag",reflectMapper:fs.qchatQuickCommentRequestTag}]},qchatGetQuickComments:{service:"qchatMsg",sid:24,cid:103,params:[{type:"Property",name:"tag",reflectMapper:fs.qchatQuickCommentQueryTag}],response:[{type:"PropertyArray",name:"quickCommentResponse",reflectMapper:{1:"serverId",2:"channelId",3:"msgIdServer",4:"totalCount",5:"lastUpdateTime",6:"details"}}]},qchatGetThreadRootMessagesMeta:{service:"qchatMsg",sid:24,cid:108,params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,channelId:2}},{type:"PropertyArray",name:"qchatMsgs",reflectMapper:{time:7,msgIdServer:14}}],response:[{type:"PropertyArray",name:"metas",reflectMapper:{1:"total",2:"timestamp",3:"msgIdServer",4:"msgTime"}}]},qchatGetLastMessageOfChannels:{service:"qchatMsg",sid:24,cid:121,params:[{type:"Property",name:"tag",reflectMapper:fs.qchatGetLastMessageOfChannelsTag}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:fa.qchatMsgTag}]},qchatMultiSyncServersMessageRead:{service:"qchatMsg",sid:25,cid:6,response:[{type:"Property",name:"qchatMultiSyncServersMessageReadTag",reflectMapper:fa.qchatMultiSyncServersMessageReadTag}]},qchatGetMentionedMeMessages:{service:"qchatMsg",sid:24,cid:127,params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,channelId:2,timestamp:3,limit:4}}],response:[{type:"Property",name:"page",reflectMapper:fa.qchatPageQueryTag},{type:"PropertyArray",name:"datas",reflectMapper:fa.qchatMsgTag}]}};(function(S){S[S.Android=1]="Android",S[S.iOS=2]="iOS",S[S.PC=4]="PC",S[S.WindowsPhone=8]="WindowsPhone",S[S.Web=16]="Web",S[S.Server=32]="Server",S[S.Mac=64]="Mac"})(pc||(pc={}));var $y=["image","audio","video","file"],Zp={time:{type:"number"},updateTime:{type:"number"},resendFlag:{type:"boolean"},persistEnable:{type:"boolean"},routeEnable:{type:"boolean"},pushEnable:{type:"boolean"},needBadge:{type:"boolean"},needPushNick:{type:"boolean"},type:{type:"enum",values:Xo},fromClientType:{type:"enum",values:pc},status:{type:"number"},toAccids:{type:"object"},toType:{type:"number"},attach:{type:"object"},pushPayload:{type:"object"}};function Rh(S,x){var V=Tn({},S),F=Tn({type:x||Xo.custom},Gl(Zp,V));return F.serverId&&F.channelId&&F.toAccids?F.toType=Oc.channelAccids:F.serverId&&F.toAccids?F.toType=Oc.serverAccids:F.serverId&&F.channelId?F.toType=Oc.channel:F.serverId?F.toType=Oc.server:F.toAccids?F.toType=Oc.accids:F.toType=Oc.unknown,F}function jy(S){var x=Xp(S,["msgIdServer","type"]);return Gl(Zp,x)}var Dy=((Ns={})[Xo.channelUpdateWhiteBlackIdentify]=function(S){return S.notify=Pd(Na(S.notify,zo.qchatUpdateWhiteBlackRoleTag)),S},Ns[Xo.channelUpdateWhiteBlackIdentifyUser]=function(S){return S.notify=function(V){return va(Ey,V)}(Na(S.notify,zo.qchatUpdateWhiteBlackMembersTag)),S},Ns[Xo.updateQuickComment]=function(S){return S.notify=function(V){return va(lC,V)}(Na(S.notify,fa.qchatQuickCommentRequestTag)),S},Ns[Xo.channelCategoryCreate]=function(S){return S.categoryInfo=Rd(Na(S.categoryInfo,zo.QChatChannelCategoryInfo)),S},Ns[Xo.channelCategoryUpdate]=function(S){return S.categoryInfo=Rd(Na(S.categoryInfo,zo.QChatChannelCategoryInfo)),S},Ns[Xo.channelCategoryUpdateWhiteBlackIdentify]=function(S){return S.notify=Pd(Na(S.notify,zo.qchatUpdateChannelCategoryWhiteBlackRoleTag)),S},Ns[Xo.channelCategoryUpdateWhiteBlackIdentifyUser]=function(S){return S.notify=Pd(Na(S.notify,zo.qchatUpdateChannelCategoryWhiteBlackMembersTag)),S},Ns[Xo.serverIdentifyAdd]=function(S){return S.serverIdentifyInfo=ps(Na(S.serverIdentifyInfo,la.serverRole)),S},Ns[Xo.serverIdentifyRemove]=function(S){return S.serverIdentifyInfo=ps(Na(S.serverIdentifyInfo,la.serverRole)),S},Ns[Xo.serverIdentifyUpdate]=function(S){return S.serverIdentifyInfo=ps(Na(S.serverIdentifyInfo,la.serverRole)),S},Ns[Xo.channelIdentifyUpdate]=function(S){return S.channelIdentifyInfo=ps(Na(S.channelIdentifyInfo,la.channelRole)),S},Ns[Xo.userIdentifyUpdate]=function(S){return S.userIdentifyInfo=ps(Na(S.userIdentifyInfo,la.memberRole)),S},Ns[Xo.myMemberInfoUpdated]=function(S){var x,V=Wa(S,"userInfo.name"),F=Wa(S,"userInfo.icon");return S.updatedInfos=ho(x=S.reuseServers).call(x,function(A){var oe={serverId:A.serverId};return(1&A.bits)==1&&typeof V=="string"&&Tn(oe,{nickChanged:!0,nick:V}),(2&A.bits)==2&&typeof F=="string"&&Tn(oe,{avatarChanged:!0,avatar:F}),oe}),delete S.userInfo,delete S.reuseServers,S},Ns);function Dd(S,x){var V=va(Zp,S);if(!V.attach)return V;if(V.attach.serverInfo&&(V.attach.serverInfo=xd(Na(V.attach.serverInfo,La.serverInfo))),V.attach.channelInfo&&(V.attach.channelInfo=Ad(Na(V.attach.channelInfo,zo.channelInfo))),V.attach.serverMember&&(V.attach.serverMember=Ql(Na(V.attach.serverMember,La.memberInfo))),Dy[V.attach.type]&&(V.attach=Dy[V.attach.type](V.attach)),V.attach.updateAuths)try{V.attach.updateAuths=Si(JSON.parse(V.attach.updateAuths))}catch(F){x.error("formatSystemNotification:JSON parse updateAuths error: ",F)}return V.attach.type&&(V.attach.rawType=V.attach.type,V.attach.type=Xo[V.attach.type]),V}var ef={type:{type:"enum",values:Ld},fromClientType:{type:"enum",values:pc},status:{type:"number"},resendFlag:{type:"boolean"},mentionAll:{type:"boolean"},notifyReason:{type:"enum",values:$d},pushEnable:{type:"boolean"},historyEnable:{type:"boolean"},needBadge:{type:"boolean"},needPushNick:{type:"boolean"},routeEnable:{type:"boolean"},time:{type:"number"},updateTime:{type:"number"},mentionAccids:{type:"object"},mentionRoleIds:{type:"object"},accidsOfMentionedRoles:{type:"object"},attach:{type:"object"},pushPayload:{type:"object"},isAntispam:{type:"boolean"},antiSpamInfo:{useCustomContent:{type:"boolean"},antiSpamContent:{type:"string"},antiSpamBusinessId:{type:"string"},antiSpamUsingYidun:{type:"boolean"},yidunCallback:{type:"string"},yidunAntiCheating:{type:"object"},yidunAntiSpamExt:{type:"object"},yidunAntiSpamRes:{type:"string"}},replyRefer:{fromAccount:{type:"string",rawKey:"replyMsgFromAccount"},time:{type:"number",rawKey:"replyMsgTime"},msgIdServer:{type:"string",rawKey:"replyMsgIdServer"},msgIdClient:{type:"string",rawKey:"replyMsgIdClient"}},threadRefer:{fromAccount:{type:"string",rawKey:"threadMsgFromAccount"},time:{type:"number",rawKey:"threadMsgTime"},msgIdServer:{type:"string",rawKey:"threadMsgIdServer"},msgIdClient:{type:"string",rawKey:"threadMsgIdClient"}}};function Bh(S){S.onSendBefore,S.onUploadStart,S.onUploadDone,S.onUploadProgress;var x=xl(S,["onSendBefore","onUploadStart","onUploadDone","onUploadProgress"]),V=Gl(ef,x);if(V.msgIdClient=S.resendFlag?S.msgIdClient:Dg(),!V.msgIdClient)throw new El("msgIdClient is required for resend a message","msgIdClient","required");return S.replyMessage&&S.replyMessage.msgIdServer&&(V.replyMsgFromAccount=S.replyMessage.fromAccount,V.replyMsgTime=+S.replyMessage.time,V.replyMsgIdServer=S.replyMessage.msgIdServer,V.replyMsgIdClient=S.replyMessage.msgIdClient,S.replyMessage.threadRefer&&S.replyMessage.threadRefer.msgIdServer?(V.threadMsgFromAccount=S.replyMessage.threadRefer.fromAccount,V.threadMsgTime=+S.replyMessage.threadRefer.time,V.threadMsgIdServer=S.replyMessage.threadRefer.msgIdServer,V.threadMsgIdClient=S.replyMessage.threadRefer.msgIdClient):(V.threadMsgFromAccount=S.replyMessage.fromAccount,V.threadMsgTime=+S.replyMessage.time,V.threadMsgIdServer=S.replyMessage.msgIdServer,V.threadMsgIdClient=S.replyMessage.msgIdClient),delete V.replyMessage),V}function Uy(S){return va({operatorClientType:{type:"enum",values:pc},pushPayload:{type:"object"}},S)}function _s(S,x,V){var F,A;return x===void 0&&(x={}),Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return(xe=va(ef,S)).deliveryStatus=x.deliveryStatus?Ci[x.deliveryStatus]:Ci[Ci.success],x.time&&(xe.time=x.time),xe.updateContent&&(z=va({status:{type:"number"}},z=Na(z=JSON.parse(xe.updateContent),fa.qchatMsgTag)),xe.updateContent=z),xe.updateOperatorInfo&&(Ve=Uy(Na(Ve=JSON.parse(xe.updateOperatorInfo),fa.qchatMsgUpdateTag)),xe.updateOperatorInfo=Ve),((F=xe==null?void 0:xe.threadRefer)===null||F===void 0?void 0:F.fromAccount)===""&&delete xe.threadRefer,((A=xe==null?void 0:xe.replyRefer)===null||A===void 0?void 0:A.fromAccount)===""&&delete xe.replyRefer,xe.attach&&x.attachUrl&&(xe.attach.url=x.attachUrl),lr.next=10,qy(xe,V);case 10:return lr.abrupt("return",lr.sent);case 11:case"end":return lr.stop()}},oe)}))}function qy(S,x){return Mr(this,void 0,void 0,ar.mark(function V(){var F;return ar.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:if(gi($y).call($y,S.type)&&S.attach&&S.attach.url){oe.next=2;break}return oe.abrupt("return",S);case 2:if(x&&x.cloudStorage&&typeof x.cloudStorage.getPrivateUrl=="function"&&typeof x.cloudStorage.getOriginUrl=="function"){oe.next=4;break}return oe.abrupt("return",S);case 4:if(!(pa(F=S.attach.url).call(F,"_im_url=1")<0)){oe.next=7;break}return S.attach.url=x.cloudStorage.getPrivateUrl(S.attach.url),oe.abrupt("return",S);case 7:return oe.prev=7,oe.next=10,x.cloudStorage.getOriginUrl(S.attach.url);case 10:S.attach.url=oe.sent,oe.next=16;break;case 13:throw oe.prev=13,oe.t0=oe.catch(7),new El('url "'+S.attach.url+'" parse error',"message.attach.url","parse error");case 16:return oe.abrupt("return",S);case 17:case"end":return oe.stop()}},V,null,[[7,13]])}))}function Fh(S,x,V){return x===void 0&&(x={}),Mr(this,void 0,void 0,ar.mark(function F(){var A;return ar.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:if(ns(S)&&S.length>0){xe.next=2;break}return xe.abrupt("return",[]);case 2:return A=ho(S).call(S,function(z){return _s(z,x,V)}),xe.next=5,uo.all(A);case 5:return xe.abrupt("return",xe.sent);case 6:case"end":return xe.stop()}},F)}))}var iC={totalCount:{type:"number"},lastUpdateTime:{type:"number"},details:{type:"object"}};function cC(S){var x=ho(S).call(S,function(F){var A,oe=va(iC,F);return oe.details=ho(A=oe.details).call(A,function(xe){return{count:xe.count,hasSelf:xe.self,severalAccids:xe.topN,type:xe.type}}),oe}),V={};return In(x).call(x,function(F){return V[F.msgIdServer]=F}),V}var lC={type:{type:"number"},time:{type:"number"},opeType:{type:"number"}},Vy={includeSelf:{type:"number"},order:{type:"enum",values:Ic},sort:{type:"enum",values:Qp},msgTypes:{type:"object"},subTypes:{type:"object"}},uC={hasMore:{type:"boolean"},nextTimetag:{type:"number"},cursor:{type:"string"}},dC={6:function(x){return this.core.qchatChannel.subscribeForVisitorService.deleteAutoSetInServerId(x.serverId),!0},16:function(x){return this.core.qchatChannel.subscribeForVisitorService.deleteAutoSetInChannel(x.serverId,x.channelId),!0},26:function(x){var V=Wa(x,"attach.addAccids");return V&&gi(V).call(V,this.core.account)&&this.core.eventBus.emit("qchatChannel/serverIdentifyChange",x),!0},27:function(x){var V=Wa(x,"attach.deleteAccids");return V&&gi(V).call(V,this.core.account)&&this.core.eventBus.emit("qchatChannel/serverIdentifyChange",x),!0},31:function(x){return x.attach.event===2&&(this.core.eventBus.emit("qchatChannel/autoUnSubscribe",x),this.core.eventBus.emit("qchatMedia/serverOrChannelLeave",x)),!0},32:function(x){return x.attach.event===2?(this.core.eventBus.emit("qchatChannel/autoUnSubscribe",x),this.core.eventBus.emit("qchatMedia/serverOrChannelLeave",x)):x.attach.event===1&&this.core.qchatChannel.subscribeForVisitorService.deleteServer(x.serverId),!0},34:function(x){return x.attach.event===2&&this.core.qchatChannel.subscribeForVisitorService.unSubscribeChannel(x.serverId,x.channelId),!0},101:function(x){var V=Xp(x,["serverId","channelId","ext","fromAccount","fromNick","time"]);return this.logger.log("qchat on recvTypingEvent: ",V),this.core.emit("recvTypingEvent",V),!1}},pC=function(){function S(V){this.core=V,this.logger=V.logger}var x=S.prototype;return x.sendSystemNotification=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Ve.next=2,this.core.sendCmd("qchatSendCustomSysMsg",{sysMsg:Rh(F)});case 2:return oe=Ve.sent,xe=Dd(oe.content.sysMsg,this.logger),this.core.options.debugLevel==="debug"?this.logger.debug("sendCustomSysMsg success",xe):this.logger.log("sendCustomSysMsg success",xe.serverId,xe.channelId,xe.msgIdServer),Ve.abrupt("return",xe);case 6:case"end":return Ve.stop()}},A,this)}))},x.updateSystemNotification=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return oe=F.systemNotification,xe=xl(F,["systemNotification"]),z=Xp(oe,["msgIdServer","type","body","ext","status"]),Ve=Rh(z),fr.next=5,this.core.sendCmd("qchatUpdateSystemNotification",{sysMsg:Ve,qchatMsgUpdateTag:Tn(Tn({},xe),{operatorAccount:this.core.account,operatorClientType:pc.Web,pushPayload:mo(F.pushPayload),routeEnable:Ch.boolean(F,"routeEnable")})});case 5:return jt=fr.sent,fr.abrupt("return",Dd(jt.content.sysMsg,this.logger));case 7:case"end":return fr.stop()}},A,this)}))},x.markSystemNotificationsRead=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.core.sendCmd("qchatMarkSysMsgRead",{sysMsgs:ho(oe=F.systemNotifications).call(oe,function(Ve){return jy(Ve)})});case 2:case"end":return z.stop()}},A,this)}))},x.onSysMsg=function(F){var A=F.content.sysMsg;if(A){var oe=Dd(A,this.core.logger),xe=dC[Xo[oe.type]];if(xe&&xe.call(this,oe)===!1)return;var z={feature:"default",systemNotifications:[oe]};this.logger.log("qchat on systemNotification: ",z),this.core.emit("systemNotification",z)}else this.core.logger.warn("No sysMsg in onSysMsg packet")},x.onMultiSysMsg=function(F){var A=F.content.sysMsg;if(A){var oe=Dd(A,this.logger);this.core.emit("systemNotificationUpdate",oe)}},x.onSyncSysMsg=function(F){var A=this,oe=F.content.systemNotifications;if(oe&&oe.length>0){var xe=ho(oe).call(oe,function(z){return Dd(z,A.logger)});this.core.emit("systemNotification",{feature:"sync",systemNotifications:xe})}else this.logger.warn("sync system notification not exist")},S}(),Lh=["image","audio","video","file"],fC=function(){function S(V){var F=this;this.markMessageRead=Ah(function(A){return Mr(F,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return jt.next=2,this.core.sendCmd("qchatMarkMessageRead",{markMsgReadTag:A});case 2:xe=jt.sent,z=kh(xe.content.unreadInfo),this.core.eventBus.emit("qchatChannel/updateUnreads",[z]);case 5:case"end":return jt.stop()}},oe,this)}))},200),this.core=V,this.logger=V.logger}var x=S.prototype;return x.sendMessage=function(F){var A,oe,xe,z;return Mr(this,void 0,void 0,ar.mark(function Ve(){var jt,lr,fr,Sr,br,Er;return ar.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:if(!(pa(Lh).call(Lh,F.type)>-1)){$r.next=4;break}return $r.next=3,this.doSendFile(F);case 3:F.attach=$r.sent;case 4:return jt=Bh(Tn({fromAccount:this.core.account},F)),$r.next=7,_s(jt,{time:new Date().getTime(),deliveryStatus:Ci.sending},this.core);case 7:lr=$r.sent;try{F.onSendBefore&&F.onSendBefore(lr)}catch(vn){this.logger.error("sendMsg: options.onSendBefore error",vn)}return $r.prev=9,$r.next=12,this.core.sendCmd("qchatSendMsg",{qchatMsg:jt});case 12:fr=$r.sent,$r.next=22;break;case 15:return $r.prev=15,$r.t0=$r.catch(9),$r.next=19,_s(jt,{time:new Date().getTime(),deliveryStatus:Ci.failed,attachUrl:(A=lr.attach)===null||A===void 0?void 0:A.url},this.core);case 19:throw Sr=$r.sent,$r.t0.msg=Sr,$r.t0;case 22:return br=fr.content,$r.next=25,_s(Tn({},br.qchatMsg),{deliveryStatus:Ci.success,attachUrl:(oe=lr.attach)===null||oe===void 0?void 0:oe.url},this.core);case 25:if(!(Er=$r.sent).isAntispam){$r.next=29;break}throw{code:10403,msg:Er,message:((xe=Er==null?void 0:Er.antiSpamInfo)===null||xe===void 0?void 0:xe.yidunAntiSpamRes)||"message has be antispam",isAntispam:!0,yidunAntiSpamRes:((z=Er==null?void 0:Er.antiSpamInfo)===null||z===void 0?void 0:z.yidunAntiSpamRes)||""};case 29:return $r.abrupt("return",Er);case 30:case"end":return $r.stop()}},Ve,this,[[9,15]])}))},x.doSendFile=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(Wr({type:{type:"enum",values:["image","audio","video","file"]},attach:{type:"object",rules:{url:{type:"string",allowEmpty:!1}},required:!1},maxSize:{type:"number",min:1,required:!1}},F),oe=F.attach){z.next=23;break}if(this.core.cloudStorage&&this.core.cloudStorage.uploadFile){z.next=5;break}throw new Error('Service "cloudStorage" does not exist');case 5:return z.prev=5,z.next=8,this.core.cloudStorage.uploadFile(F);case 8:oe=z.sent,z.next=15;break;case 11:throw z.prev=11,z.t0=z.catch(5),this.logger.error("sendFile:: upload File error or abort",z.t0),z.t0;case 15:z.prev=15,F.onUploadDone&&F.onUploadDone(oe),z.next=23;break;case 19:throw z.prev=19,z.t1=z.catch(15),this.logger.error("sendFile options.onUploadDone err",z.t1),z.t1;case 23:return z.abrupt("return",oe);case 24:case"end":return z.stop()}},A,this,[[5,11],[15,19]])}))},x.resendMessage=function(F){var A,oe;return Mr(this,void 0,void 0,ar.mark(function xe(){var z,Ve,jt,lr,fr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return(z=Bh(Tn(Tn({},F),{resendFlag:!0}))).deliveryStatus=Ci.sending,br.prev=2,br.next=5,this.core.sendCmd("qchatSendMsg",{qchatMsg:z});case 5:Ve=br.sent,br.next=15;break;case 8:return br.prev=8,br.t0=br.catch(2),br.next=12,_s(z,{time:new Date().getTime(),deliveryStatus:Ci.failed},this.core);case 12:throw jt=br.sent,br.t0.msg=jt,br.t0;case 15:return lr=Ve.content,br.next=18,_s(Tn({},lr.qchatMsg),{deliveryStatus:Ci.success},this.core);case 18:if(!(fr=br.sent).isAntispam){br.next=22;break}throw{code:10403,msg:fr,message:((A=fr==null?void 0:fr.antiSpamInfo)===null||A===void 0?void 0:A.yidunAntiSpamRes)||"message has be antispam",isAntispam:!0,yidunAntiSpamRes:((oe=fr==null?void 0:fr.antiSpamInfo)===null||oe===void 0?void 0:oe.yidunAntiSpamRes)||""};case 22:return br.abrupt("return",fr);case 23:case"end":return br.stop()}},xe,this,[[2,8]])}))},x.doUpdateMessage=function(F){var A,oe;return Mr(this,void 0,void 0,ar.mark(function xe(){var z,Ve,jt,lr,fr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return z=F.message,Ve=xl(F,["message"]),(jt=Bh(z)).msgIdClient=void 0,jt.time=z.time,br.next=6,this.core.sendCmd("qchatUpdateMessage",{qchatMsg:jt,qchatMsgUpdateTag:Tn(Tn({},Ve),{operatorAccount:this.core.account,operatorClientType:pc.Web,pushPayload:mo(F.pushPayload),routeEnable:Ch.boolean(F,"routeEnable")})});case 6:return lr=br.sent,br.next=9,_s(lr.content.qchatMsg,{},this.core);case 9:if(fr=br.sent,this.core.eventBus.emit("qchatChannel/changeUnread",fr,!0),!lr.content.qchatMsg.isAntispam){br.next=14;break}throw{code:10403,msg:jt,message:((A=lr.content.qchatMsg)===null||A===void 0?void 0:A.yidunAntiSpamRes)||"message has be antispam",isAntispam:!0,yidunAntiSpamRes:((oe=lr.content.qchatMsg)===null||oe===void 0?void 0:oe.yidunAntiSpamRes)||""};case 14:return br.abrupt("return",fr);case 15:case"end":return br.stop()}},xe,this)}))},x.getHistoryMessage=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve=this;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return lr.next=2,this.core.sendCmd("qchatGetHistoryMsg",{getHistoryMsgTag:Tn(Tn({},F),{reverse:kl(F)?1:0})});case 2:return xe=lr.sent,z=xe.content,lr.next=6,uo.all(ho(oe=z.qchatMsgs).call(oe,function(fr){return _s(fr,{},Ve.core)}));case 6:return lr.abrupt("return",lr.sent);case 7:case"end":return lr.stop()}},A,this)}))},x.getMentionedMeMessages=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve,jt,lr=this;return ar.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:return Sr.next=2,this.core.sendCmd("qchatGetMentionedMeMessages",{tag:F});case 2:return xe=Sr.sent,z=xe.content,br=z.page,Ve=va(uC,br),Sr.next=7,uo.all(ho(oe=z.datas).call(oe,function(Er){return _s(Er,{},lr.core)}));case 7:return jt=Sr.sent,Sr.abrupt("return",{pageInfo:Ve,messages:jt});case 9:case"end":return Sr.stop()}var br},A,this)}))},x.areMentionedMeMessages=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:oe={},xe=0;case 2:if(!(xe<F.length)){jt.next=13;break}if((z=F[xe]).fromAccount!==this.core.account){jt.next=7;break}return oe[z.msgIdClient]=!1,jt.abrupt("continue",10);case 7:return jt.next=9,this.core.qchatChannel.subscribeModuleService.getMentionedFlag(z,!0);case 9:oe[z.msgIdClient]=jt.sent;case 10:xe++,jt.next=2;break;case 13:return jt.abrupt("return",oe);case 14:case"end":return jt.stop()}},A,this)}))},x.getLastMessageOfChannels=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return jt.next=2,this.core.sendCmd("qchatGetLastMessageOfChannels",{tag:F});case 2:return oe=jt.sent,xe=oe.content.msgs,jt.next=6,Fh(xe,{},this.core);case 6:return z=jt.sent,jt.abrupt("return",Sc(z).call(z,function(lr,fr){return lr[fr.channelId]=fr,lr},{}));case 8:case"end":return jt.stop()}},A,this)}))},x.messageSearchByPage=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return fr.next=2,this.core.sendCmd("qchatMessageSearchByPage",{qchatMessageSearchByPageTag:Tn(Tn({},(Sr=F,Gl(Vy,Sr))),{includeSelf:F.includeSelf?1:""})});case 2:return oe=fr.sent,xe=oe.content,z=xe.datas,Ve=xe.listQueryTag,fr.next=6,Fh(z,{},this.core);case 6:return jt=fr.sent,fr.abrupt("return",{listQueryTag:{hasMore:+Ve.hasMore==1,nextTimetag:Ve.nextTimetag?Lo(Ve.nextTimetag):0,cursor:Ve.cursor},datas:jt});case 8:case"end":return fr.stop()}var Sr},A,this)}))},x.onMsg=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:if(oe=F.content.qchatMsg){Ve.next=4;break}return this.logger.warn("No qchatMsg in qchatMsg packet"),Ve.abrupt("return");case 4:return Ve.next=6,_s(oe,{},this.core);case 6:xe=Ve.sent,this.core.eventBus.emit("qchatChannel/changeUnread",xe,!1),this.core.emit("message",xe);case 9:case"end":return Ve.stop()}},A,this)}))},x.onRecvUnreadInfo=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:if(oe=F.content.qchatMsg){Ve.next=3;break}return Ve.abrupt("return");case 3:return Ve.next=5,_s(oe);case 5:xe=Ve.sent,this.core.eventBus.emit("qchatChannel/changeUnread",xe,!1);case 7:case"end":return Ve.stop()}},A,this)}))},x.onMultiSyncRead=function(F){var A=F.content.unreadInfo;if(A){var oe=kh(A);this.core.eventBus.emit("qchatChannel/updateUnreads",[oe])}},x.onMultiSyncServersRead=function(F){var A=F.content.qchatMultiSyncServersMessageReadTag;if(A){var oe=vl(A),xe=oe.successServerIds,z=oe.ackTimestamp;this.core.eventBus.emit("qchatChannel/clearUnreadCountByServers",xe,z)}},x.onRecvMsgUpdate=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:if(oe=F.content.qchatMsg,xe=F.content.qchatMsgUpdateInfo,oe){lr.next=4;break}return lr.abrupt("return");case 4:return lr.next=6,_s(oe,{},this.core);case 6:z=lr.sent,Ve=Uy(xe),this.core.eventBus.emit("qchatChannel/changeUnread",z,!0),this.core.emit("messageUpdate",z,Ve);case 10:case"end":return lr.stop()}},A,this)}))},S}(),mC=function(){function S(V){var F=this;this._sendTypingEvent=Ah(function(A){return Mr(F,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.core.sendCmd("qchatSendCustomSysMsg",{sysMsg:Rh(Tn(Tn({},A),{resendFlag:!1,persistEnable:!1,routeEnable:!1,pushEnable:!1,needBadge:!1,needPushNick:!1}),Xo.msgTyping)});case 2:case"end":return z.stop()}},oe,this)}))},3e3),this.core=V,this.logger=V.logger,this.lastChannelIdInTyping=""}var x=S.prototype;return x.getMessageHistoryByIds=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Ve.next=2,this.core.sendCmd("qchatGetMessageHistoryByIds",{channelInfo:{serverId:F.serverId,channelId:F.channelId},messageReferList:F.messageReferList});case 2:return xe=Ve.sent,Ve.abrupt("return",uo.all(ho(oe=xe.content.qchatMsgs).call(oe,function(jt){return _s(jt)})));case 4:case"end":return Ve.stop()}},A,this)}))},x.getReferMessages=function(F){var A,oe;return Mr(this,void 0,void 0,ar.mark(function xe(){var z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(!((A=F.message.replyRefer)===null||A===void 0)&&A.msgIdServer&&(!((oe=F.message.threadRefer)===null||oe===void 0)&&oe.msgIdServer)){jt.next=2;break}throw new Error("Message has no reply");case 2:return jt.next=4,this.getMessageHistoryByIds({serverId:F.message.serverId,channelId:F.message.channelId,messageReferList:[F.message.replyRefer,F.message.threadRefer]});case 4:if(z=jt.sent,F.referType!==uc[uc.all]){jt.next=9;break}return jt.abrupt("return",{replyMessage:z[0],threadMessage:z[1]});case 9:if(F.referType!==uc[uc.reply]){jt.next=13;break}return jt.abrupt("return",{replyMessage:z[0]});case 13:if(F.referType!==uc[uc.thread]){jt.next=15;break}return jt.abrupt("return",{threadMessage:z[1]});case 15:return jt.abrupt("return",{replyMessage:z[0],threadMessage:z[1]});case 16:case"end":return jt.stop()}},xe,this)}))},x.getThreadMessages=function(F){var A;return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt,lr;return ar.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:return z=!((A=F.message.threadRefer)===null||A===void 0)&&A.msgIdServer?Tn({serverId:F.message.serverId,channelId:F.message.channelId},F.message.threadRefer):F.message,Sr.next=3,this.core.sendCmd("qchatGetThreadMessages",{qchatMsg:z,getThreadHistoryMsgTag:Tn(Tn({},F.messageQueryOption),{reverse:Ch.boolean(F.messageQueryOption,"reverse")})});case 3:return Ve=Sr.sent,Sr.next=6,_s(Ve.content.thread);case 6:return jt=Sr.sent,Sr.next=9,uo.all(ho(xe=Ve.content.qchatMsgs).call(xe,function(br){return _s(br)}));case 9:return lr=Sr.sent,Sr.abrupt("return",{thread:jt,threadInfo:{messageCount:+Ve.content.threadInfo.messageCount,lastMessageTimestamp:+Ve.content.threadInfo.lastMessageTimestamp},messages:lr});case 11:case"end":return Sr.stop()}},oe,this)}))},x.getThreadRootMessagesMeta=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z,Ve;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return oe=F.threadRootMessages,xe=xl(F,["threadRootMessages"]),lr.next=3,this.core.sendCmd("qchatGetThreadRootMessagesMeta",{qchatMsgs:oe,tag:xe});case 3:if(z=lr.sent,!((Ve=z.content.metas)&&Ve.length>0)){lr.next=7;break}return lr.abrupt("return",ho(Ve).call(Ve,function(fr){return Tn(Tn({},fr),{total:Lo(fr.total),timestamp:Lo(fr.timestamp),msgTime:Lo(fr.msgTime)})}));case 7:return lr.abrupt("return",[]);case 8:case"end":return lr.stop()}},A,this)}))},x.getQuickComments=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){var oe,xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return jt.next=2,this.core.sendCmd("qchatGetQuickComments",{tag:{serverId:F.serverId,channelId:F.channelId,msgIdServerList:mo(ho(oe=F.msgList).call(oe,function(lr){return lr.msgIdServer}))}});case 2:return xe=jt.sent,z=xe.content.quickCommentResponse,jt.abrupt("return",cC(z));case 5:case"end":return jt.stop()}},A,this)}))},x.updateQuickComment=function(F,A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt,lr,fr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return Wr({type:{type:"number"},commentMessage:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1}}}},F),xe=F.commentMessage,z=xe.serverId,Ve=xe.channelId,jt=xe.fromAccount,lr=xe.msgIdServer,fr=xe.time,br.next=4,this.core.sendCmd("qchatUpdateQuickComment",{tag:{serverId:z,channelId:Ve,fromAccount:jt,msgIdServer:lr,time:fr,type:F.type,opeType:A,opeAccid:this.core.account}});case 4:case"end":return br.stop()}},oe,this)}))},x.sendTypingEvent=function(F){return Mr(this,void 0,void 0,ar.mark(function A(){return ar.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:if(F.channelId!==this.lastChannelIdInTyping){xe.next=4;break}return this.logger.log("qchatMsg sendTypingEvent throttle"),this._sendTypingEvent(F),xe.abrupt("return");case 4:this.lastChannelIdInTyping=F.channelId,this._sendTypingEvent.flush(),this._sendTypingEvent(F);case 7:case"end":return xe.stop()}},A,this)}))},S}(),Hy=function(S){function x(F){var A;return(A=S.call(this,"qchatMsg",F)||this).core=F,A.lastChannelIdInMark="",Pi({cmdMap:Nh,cmdConfig:sC}),A.notificationModuleService=new pC(F),A.messageModuleService=new fC(F),A.extendModuleService=new mC(F),A}Ro(x,S);var V=x.prototype;return V.sendMessage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(Ld)},ext:{type:"string",required:!1},mentionAll:{type:"boolean",required:!1},mentionAccids:{type:"array",itemType:"string",required:!1},mentionRoleIds:{type:"array",itemType:"string",required:!1,min:1},historyEnable:{type:"boolean",required:!1},pushEnable:{type:"boolean",required:!1}},A),z.next=3,this.messageModuleService.sendMessage(A);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},V.updateMessage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(Wr({message:{type:"object",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number",min:0},body:{type:"string",required:!1},ext:{type:"string",required:!1}}}},A),!(typeof A.message.status=="number"&&A.message.status<1e4)){z.next=3;break}throw new yo("Status should be greater than or equal to 10000");case 3:return z.next=5,this.messageModuleService.doUpdateMessage(A);case 5:return z.abrupt("return",z.sent);case 6:case"end":return z.stop()}},oe,this)}))},V.resendMessage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdClient:{type:"string",allowEmpty:!1}},A),z.next=3,this.messageModuleService.resendMessage(A);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},V.deleteMessage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({message:{type:"object",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number",min:0}}}},A),(xe=JSON.parse(mo(A))).message.status=2,Ve.next=5,this.messageModuleService.doUpdateMessage(xe);case 5:return Ve.abrupt("return",Ve.sent);case 6:case"end":return Ve.stop()}},oe,this)}))},V.revokeMessage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({message:{type:"object",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number",min:0}}}},A),(xe=JSON.parse(mo(A))).message=Xp(xe.message,["serverId","channelId","msgIdServer","time"]),xe.message.status=1,Ve.next=6,this.messageModuleService.doUpdateMessage(xe);case 6:return Ve.abrupt("return",Ve.sent);case 7:case"end":return Ve.stop()}},oe,this)}))},V.markMessageRead=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:Wr({serverId:{type:"string"},channelId:{type:"string"},time:{type:"number",min:0}},A),A.channelId!==this.lastChannelIdInMark&&this.messageModuleService.markMessageRead.flush(),this.lastChannelIdInMark=A.channelId,this.messageModuleService.markMessageRead(A);case 4:case"end":return z.stop()}},oe,this)}))},V.replyMessage=function(A){Wr({replyMessage:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1}}}},A);var oe=A.replyMessage;if(A.serverId!==oe.serverId||A.channelId!==oe.channelId)throw new yo("Forbid replying to message from other server, channel");return this.sendMessage(A)},V.getMessageHistoryByIds=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},messageReferList:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}}},A),z.next=3,this.extendModuleService.getMessageHistoryByIds(A);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},V.getReferMessages=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({message:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}},referType:{type:"enum",values:ia(uc),required:!1}},A),z.next=3,this.extendModuleService.getReferMessages(A);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},V.getThreadMessages=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({message:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}},messageQueryOption:{type:"object",rules:{beginTime:{type:"number",required:!1},endTime:{type:"number",required:!1},excludeMsgId:{type:"string",required:!1},limit:{type:"number",required:!1},reverse:{type:"boolean",required:!1}}}},A),z.next=3,this.extendModuleService.getThreadMessages(A);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},V.getThreadRootMessagesMeta=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},threadRootMessages:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}}},A),z.next=3,this.extendModuleService.getThreadRootMessagesMeta(A);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},V.sendSystemNotification=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},attach:{type:"object",required:!1}},A),z.next=3,this.notificationModuleService.sendSystemNotification(A);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},V.updateSystemNotification=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({systemNotification:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(Xo)},body:{type:"string",required:!1},ext:{type:"string",required:!1},status:{type:"number",required:!1}}}},A),z.next=3,this.notificationModuleService.updateSystemNotification(A);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},V.markSystemNotificationsRead=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({systemNotifications:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1},type:{type:"string",allowEmpty:!1}},min:1}},A),z.next=3,this.notificationModuleService.markSystemNotificationsRead(A);case 3:case"end":return z.stop()}},oe,this)}))},V.getHistoryMessage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},beginTime:{type:"number",min:0,required:!1},endTime:{type:"number",min:0,required:!1},excludeMsgId:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,required:!1},reverse:{type:"boolean",required:!1}},A),z.next=3,this.messageModuleService.getHistoryMessage(A);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},V.getMentionedMeMessages=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},timestamp:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1}},A),z.next=3,this.messageModuleService.getMentionedMeMessages(A);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},V.areMentionedMeMessages=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:if(Wr({messages:{type:"array",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1}},min:1}},A),Al(xe=A.messages).call(xe,function(jt){return A.messages[0].serverId===jt.serverId})){Ve.next=4;break}throw new yo("Different serverId",A,10414);case 4:if(!this.core.qchatChannel.subscribeForVisitorService.isInAutoServers(A.messages[0].serverId)){Ve.next=7;break}throw new yo("Not allowed for visitor",A,10403);case 7:return Ve.next=9,this.messageModuleService.areMentionedMeMessages(A.messages);case 9:return Ve.abrupt("return",Ve.sent);case 10:case"end":return Ve.stop()}},oe,this)}))},V.addQuickComment=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.extendModuleService.updateQuickComment(A,1);case 2:case"end":return z.stop()}},oe,this)}))},V.removeQuickComment=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.extendModuleService.updateQuickComment(A,2);case 2:case"end":return z.stop()}},oe,this)}))},V.getQuickComments=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgList:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1}},min:1}},A),z.next=3,this.extendModuleService.getQuickComments(A);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},V.sendTypingEvent=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},A),z.next=3,this.extendModuleService.sendTypingEvent(A);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},V.getLastMessageOfChannels=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelIdList:{type:"array",itemType:"string"}},A),z.next=3,this.messageModuleService.getLastMessageOfChannels(A);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},V.qchatOnMsgHandler=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:this.messageModuleService.onMsg(A);case 1:case"end":return z.stop()}},oe,this)}))},V.qchatOnRecvUnreadInfoHandler=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:this.messageModuleService.onRecvUnreadInfo(A);case 1:case"end":return z.stop()}},oe,this)}))},V.qchatOnSysMsgHandler=function(A){this.notificationModuleService.onSysMsg(A)},V.qchatMultiSyncMessageReadHandler=function(A){this.messageModuleService.onMultiSyncRead(A)},V.qchatMultiSyncSystemNotificationUpdateHandler=function(A){this.notificationModuleService.onMultiSysMsg(A)},V.qchatSyncSystemNotificationHandler=function(A){this.notificationModuleService.onSyncSysMsg(A)},V.qchatRecvMessageUpdateHandler=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:this.messageModuleService.onRecvMsgUpdate(A);case 1:case"end":return z.stop()}},oe,this)}))},V.searchMsgByPage=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({keyword:{type:"string",allowEmpty:!1,required:!1},serverId:{type:"string",allowEmpty:!1,required:!0},channelId:{type:"string",allowEmpty:!1,required:!1},fromAccid:{type:"string",allowEmpty:!1,required:!1},fromTime:{type:"number",allowEmpty:!1,required:!1},toTime:{type:"number",allowEmpty:!1,required:!1},msgTypes:{type:"array",itemType:"string",allowEmpty:!1,required:!0},subTypes:{type:"array",itemType:"string",allowEmpty:!1,required:!1},includeSelf:{type:"boolean",allowEmpty:!1,required:!1},order:{type:"enum",values:ia(Ic),required:!1},limit:{type:"number",min:0,required:!1},sort:{type:"enum",values:ia(Qp),required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},A),z.next=3,this.messageModuleService.messageSearchByPage(A);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},V.qchatMultiSyncServersMessageReadHandler=function(A){this.messageModuleService.onMultiSyncServersRead(A)},x}(gl);function $h(S,x){x===void 0&&(x=1);var V=va({clientPort:{type:"number"},clientType:{type:"enum",values:pc},customClientType:{type:"number"},loginTime:{type:"number"},hasTokenPreviously:{type:"boolean"},pushType:{type:"number"}},S);return Tn(Tn({},V),{account:V.account,connectionId:V.connectionId,deviceId:V.deviceId,ip:V.ip,mac:V.ip,os:V.os,clientType:V.clientType,time:V.time,online:x!==2})}var zy={1:{reason:"samePlatformKick",message:"The same account is not allowed to multiple login at the same time"},2:{reason:"serverKick",message:"Kicked out by IM server"},3:{reason:"otherPlatformKick",message:"Kicked out by other client of your account"},4:{reason:"silentlyKick",message:"Quietly kicked"}},jh,ws,ya={BROWSER:0,RN:2,UNIAPP:3,WECHAT:6},gC=function(S){function x(F){var A;return(A=S.call(this,"qchatAuth",F)||this).syncTimeTag=0,A}Ro(x,S);var V=x.prototype;return V.doLogin=function(A){var oe;return A===void 0&&(A=!1),Mr(this,void 0,void 0,ar.mark(function xe(){var z,Ve,jt,lr,fr,Sr,br;return ar.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:return z=this.core.options,Ve=ta.getSystemInfo(),jt=Tn(Tn({},z),{appLogin:A?0:1,clientType:16,clientSession:(oe=this.core.socket)===null||oe===void 0?void 0:oe.sessionId,deviceId:this.core.config.deviceId,sdkVersion:91001,sdkType:ya[ta.platform]||0,userAgent:"Native/0.13.1",sdkHumanVersion:"0.13.1",os:Ve.os,browser:Ve.browser}),Dr.next=5,this.core.sendCmd("qchatLogin",{qchatLoginReqTag:jt});case 5:if(!(lr=Dr.sent).error){Dr.next=8;break}throw lr.error;case 8:return fr=lr.content,Sr=fr.qchatLoginResTag,br=fr.qchatMultiLoginResult,Sr.isAutoReconnect=A,Dr.abrupt("return",{loginResult:$h(Sr),multiLoginResults:ho(br).call(br,function($r){return $h($r)})});case 11:case"end":return Dr.stop()}},xe,this)}))},V.kick=function(A){var oe;return Mr(this,void 0,void 0,ar.mark(function xe(){var z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return jt.next=2,this.core.sendCmd("qchatKick",A);case 2:return z=jt.sent,jt.abrupt("return",(oe=z.content)===null||oe===void 0?void 0:oe.deviceIds);case 4:case"end":return jt.stop()}},xe,this)}))},V.sync=function(){return Mr(this,void 0,void 0,ar.mark(function A(){return ar.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return xe.next=2,this.core.sendCmd("qchatSync",{qchatSyncTag:{systemNotification:this.syncTimeTag||0}});case 2:case"end":return xe.stop()}},A,this)}))},V.qchatSyncHandler=function(A){var oe,xe;this.logger.log("sync: emit syncdone",(oe=A.content)===null||oe===void 0?void 0:oe.timetag),this.core.emit("syncdone"),this.syncTimeTag=((xe=A.content)===null||xe===void 0?void 0:xe.timetag)||0},V.qchatMultiSpotLoginHandler=function(A){if(A.error)this.logger.error("qchatMultiPortLoginHandler:: error, ",A.error);else{var oe=A.content,xe=$h(oe.qchatLoginResTag,oe.state);this.core.emit("multiSpotLogin",[xe])}},V.qchatBeKickedHandler=function(A){if(A.error)this.logger.error("qchatBeKickedHandler error, ",A.error);else{var oe=function(z){var Ve=va({clientType:{type:"enum",values:pc},customClientType:{type:"number"}},z),jt=zy[Ve.reason];return Tn(Ve,jt=jt||{reason:"unknow",message:"Unknown reason"})}(A.content.beKickedTag);this.logger.warn("bekicked::",oe),this.core.doDisconnect(ds.KICKED,oe)}},x}(gl);(function(S){S.UNKNOWN="UNKNOWN",S.LOGIN_STATE_ERROR="LOGIN_STATE_ERROR",S.CLOSE_BY_BACKEND="CLOSE_BY_BACKEND",S.ALL_MEMBERS_OUT="ALL_MEMBERS_OUT",S.END_OF_LIFE="END_OF_LIFE",S.CLOSE_BY_MEMBER="CLOSE_BY_MEMBER",S.KICK_OUT="KICK_OUT",S.SYNC_DATA_ERROR="SYNC_DATA_ERROR",S.LEAVE_BY_SELF="LEAVE_BY_SELF",S.kICK_BY_SELF="kICK_BY_SELF"})(jh||(jh={})),function(S){S.offNotAllowSelfOn="offNotAllowSelfOn",S.offAllowSelfOn="offAllowSelfOn",S.disable="disable"}(ws||(ws={}));var Nc={serverId:{type:"string"},uid:{type:"string"},accid:{type:"string"},nick:{type:"string"},avatar:{type:"string"},ext:{type:"string"},type:{type:"number"},joinTime:{type:"number"},inviter:{type:"string"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"}},fc={limit:{type:"number"}};function mc(S){return ns(S)&&S.length>0?ho(S).call(S,function(x){return function(F){return va(Nc,F)}(x)}):[]}function hC(S){try{S.audio&&(S.audio=JSON.parse(S.audio))}catch{throw new al('result "audio" JSON parse error',{key:"audio"},"JSON parse error")}try{S.video&&(S.video=JSON.parse(S.video))}catch{throw new al('result "video" JSON parse error',{key:"video"},"JSON parse error")}return va(fc,S)}var Ud={"25_1":"qchatGetNeroomToken","25_2":"qchatUpdateRTCChannelConfig","25_3":"qchatGetRTCChannelConfig","25_4":"qchatGetRTCChannelMembers"},qd={QChatRTCChannelConfigTag:{serverId:1,channelId:2,limit:3,audio:4,video:5},QChatRTCChannelConfigResultTag:{limit:1,audio:2,video:3},QChatGetRTCParams:{serverId:1,channelId:2},qchatGetRTCChannelMembersTag:{serverId:1,channelId:2},memberInfo:{serverId:1,accid:3,nick:4,avatar:5,ext:6,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},QChatGetNeroomTokenResultTag:{token:1,expire:2},QChatGetNeroomTokenParams:{neroomDeviceId:1}},tf=Cc(qd),Vd={qchatGetNeroomToken:{sid:25,cid:1,service:"qchatMedia",params:[{type:"Property",name:"qchatGetNeroomTokenTag",reflectMapper:qd.QChatGetNeroomTokenParams}],response:[{type:"Property",name:"neroomToken",reflectMapper:tf.QChatGetNeroomTokenResultTag}]},qchatUpdateRTCChannelConfig:{sid:25,cid:2,service:"qchatMedia",params:[{type:"Property",name:"RTCChannelConfig",reflectMapper:qd.QChatRTCChannelConfigTag}]},qchatGetRTCChannelConfig:{sid:25,cid:3,service:"qchatMedia",params:[{type:"Property",name:"qchatGetRTCChannelConfigTag",reflectMapper:qd.QChatGetRTCParams}],response:[{type:"Property",name:"RTCChannelConfig",reflectMapper:tf.QChatRTCChannelConfigResultTag}]},qchatGetRTCChannelMembers:{sid:25,cid:4,service:"qchatMedia",params:[{type:"Property",name:"qchatGetRTCChannelMembersTag",reflectMapper:qd.QChatGetRTCParams}],response:[{type:"PropertyArray",name:"memberList",reflectMapper:tf.memberInfo}]}},vC=function(S){function x(F){var A;return(A=S.call(this,"qchatMedia",F)||this).tokenExpireTime=24e4,A.getTokenState=!1,A.core=F,Pi({cmdMap:Ud,cmdConfig:Vd}),A.core.on("disconnect",function(){return Mr(i(A),void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(!this.roomContext){z.next=3;break}return z.next=3,this.disconnectChannel();case 3:this.tokenTimer&&(this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0);case 4:case"end":return z.stop()}},oe,this)}))}),A.core.on("kicked",function(){return Mr(i(A),void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(!this.roomContext){z.next=3;break}return z.next=3,this.disconnectChannel();case 3:this.tokenTimer&&(this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0);case 4:case"end":return z.stop()}},oe,this)}))}),A.core.eventBus.on("qchatMedia/serverOrChannelLeave",function(oe){return Mr(i(A),void 0,void 0,ar.mark(function xe(){return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:if(!(oe.type===Xo[Xo.channelVisibilityUpdate]&&oe.channelId===this.channelId||oe.type===Xo[Xo.serverEnterLeave]&&oe.serverId===this.serverId)){Ve.next=4;break}if(!this.roomContext||!this.roomContext.roomUuid){Ve.next=4;break}return Ve.next=4,this.disconnectChannel();case 4:case"end":return Ve.stop()}},xe,this)}))}),A.tokenExpireTime=24e4,A.channelId="",A.serverId="",A}Ro(x,S);var V=x.prototype;return V.setNeroom=function(A){this.neroom=new A},V._checkPermission=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Ve.next=2,this.core.qchatRole.checkPermission(A);case 2:return xe=Ve.sent,Ve.abrupt("return",xe);case 4:case"end":return Ve.stop()}},oe,this)}))},V._checkConnectState=function(){if(this.state!=="connect")throw new yo("QChatMedia::you should connect first")},V.kickMemberOut=function(A){var oe;return Mr(this,void 0,void 0,ar.mark(function xe(){return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return this._checkConnectState(),Wr({accid:{type:"string",allowEmpty:!1}},A),Ve.prev=2,Ve.next=5,(oe=this.roomContext)===null||oe===void 0?void 0:oe.kickMemberOut(A.accid);case 5:Ve.next=11;break;case 7:throw Ve.prev=7,Ve.t0=Ve.catch(2),this.logger.error("QChatMedia::kickMemberOut error params is "+mo(A),Ve.t0),new yo("QChatMedia::kickMemberOut error",Ve.t0);case 11:case"end":return Ve.stop()}},xe,this,[[2,7]])}))},V.disconnectChannel=function(){var A;return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this._checkConnectState(),this.logger.debug("QChatMedia::disconnect begin disconnect"),z.prev=2,z.next=5,(A=this.roomContext)===null||A===void 0?void 0:A.leaveRoom();case 5:z.next=10;break;case 7:z.prev=7,z.t0=z.catch(2),this.logger.error("QChatMedia::disconnect error",z.t0);case 10:if(!this.authService){z.next=13;break}return z.next=13,this.authService.logout();case 13:this._setStateInit(),this.core.emit("qchatMediaDisconnect");case 15:case"end":return z.stop()}},oe,this,[[2,7]])}))},V._setStateInit=function(){this.logger.debug("QChatMedia::disconnect end"),this.roomContext=void 0,this.rtcController=void 0,this.state="init",this.tokenTimer&&(this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0),this.channelId="",this.serverId=""},V.muteAudio=function(A){var oe,xe,z,Ve,jt;return Mr(this,void 0,void 0,ar.mark(function lr(){var fr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(this._checkConnectState(),Wr({accid:{type:"string",allowEmpty:!1}},A),((oe=this.roomContext)===null||oe===void 0?void 0:oe.localMember.uuid)!==A.accid){br.next=14;break}return br.prev=3,br.next=6,(xe=this.rtcController)===null||xe===void 0?void 0:xe.muteMyAudio();case 6:br.next=12;break;case 8:throw br.prev=8,br.t0=br.catch(3),this.logger.error("QChatMedia::muteAudio error",br.t0),new yo("QChatMedia::muteAudio error",br.t0);case 12:case 25:br.next=31;break;case 14:if(br.prev=14,!(fr=(z=this.roomContext)===null||z===void 0?void 0:z.roomProperties.audioOff)||((Ve=fr.value)===null||Ve===void 0?void 0:Ve.split("_")[0])!==ws.offNotAllowSelfOn){br.next=23;break}return br.next=19,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 19:if(br.sent){br.next=23;break}return this.logger.error("QChatMedia::unMuteAudio not allow open auido"),br.abrupt("return");case 23:return br.next=25,(jt=this.rtcController)===null||jt===void 0?void 0:jt.muteMemberAudio(A.accid);case 27:throw br.prev=27,br.t1=br.catch(14),this.logger.error("QChatMedia::muteAudio error params is "+mo(A),br.t1),new yo("QChatMedia::muteAudio error",br.t1);case 31:case"end":return br.stop()}},lr,this,[[3,8],[14,27]])}))},V.unMuteAudio=function(A){var oe,xe,z,Ve,jt;return Mr(this,void 0,void 0,ar.mark(function lr(){var fr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(this._checkConnectState(),Wr({accid:{type:"string",allowEmpty:!1}},A),!(fr=(oe=this.roomContext)===null||oe===void 0?void 0:oe.roomProperties.audioOff)||((xe=fr.value)===null||xe===void 0?void 0:xe.split("_")[0])!==ws.offNotAllowSelfOn){br.next=10;break}return br.next=6,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 6:if(br.sent){br.next=10;break}return this.logger.error("QChatMedia::unMuteAudio not allow open auido"),br.abrupt("return");case 10:if(((z=this.roomContext)===null||z===void 0?void 0:z.localMember.uuid)!==A.accid){br.next=22;break}return br.prev=11,br.next=14,(Ve=this.rtcController)===null||Ve===void 0?void 0:Ve.unmuteMyAudio();case 14:br.next=20;break;case 16:throw br.prev=16,br.t0=br.catch(11),this.logger.error("QChatMedia::unMuteAudio error",br.t0),new yo("QChatMedia::unMuteAudio error",br.t0);case 20:case 25:br.next=31;break;case 22:return br.prev=22,br.next=25,(jt=this.rtcController)===null||jt===void 0?void 0:jt.unmuteMemberAudio(A.accid);case 27:throw br.prev=27,br.t1=br.catch(22),this.logger.error("QChatMedia::unMuteAudio error params is "+mo(A),br.t1),new yo("QChatMedia::unMuteAudio error",br.t1);case 31:case"end":return br.stop()}},lr,this,[[11,16],[22,27]])}))},V.muteVideo=function(A){var oe,xe,z,Ve,jt;return Mr(this,void 0,void 0,ar.mark(function lr(){var fr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(this._checkConnectState(),Wr({accid:{type:"string",allowEmpty:!1}},A),((oe=this.roomContext)===null||oe===void 0?void 0:oe.localMember.uuid)!==A.accid){br.next=14;break}return br.prev=3,br.next=6,(xe=this.rtcController)===null||xe===void 0?void 0:xe.muteMyVideo();case 6:br.next=12;break;case 8:throw br.prev=8,br.t0=br.catch(3),this.logger.error("QChatMedia::muteVideo error",br.t0),new yo("QChatMedia::muteVideo error",br.t0);case 12:case 25:br.next=31;break;case 14:if(br.prev=14,!(fr=(z=this.roomContext)===null||z===void 0?void 0:z.roomProperties.videoOff)||((Ve=fr.value)===null||Ve===void 0?void 0:Ve.split("_")[0])!==ws.offNotAllowSelfOn){br.next=23;break}return br.next=19,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 19:if(br.sent){br.next=23;break}return this.logger.error("QChatMedia::unMuteVideo not allow open video"),br.abrupt("return");case 23:return br.next=25,(jt=this.rtcController)===null||jt===void 0?void 0:jt.muteMemberVideo(A.accid);case 27:throw br.prev=27,br.t1=br.catch(14),this.logger.error("QChatMedia::muteVideo error params is "+mo(A),br.t1),new yo("QChatMedia::muteVideo error",br.t1);case 31:case"end":return br.stop()}},lr,this,[[3,8],[14,27]])}))},V.unMuteVideo=function(A){var oe,xe,z,Ve,jt;return Mr(this,void 0,void 0,ar.mark(function lr(){var fr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(this._checkConnectState(),Wr({accid:{type:"string",allowEmpty:!1}},A),!(fr=(oe=this.roomContext)===null||oe===void 0?void 0:oe.roomProperties.videoOff)||((xe=fr.value)===null||xe===void 0?void 0:xe.split("_")[0])!==ws.offNotAllowSelfOn){br.next=10;break}return br.next=6,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 6:if(br.sent){br.next=10;break}return this.logger.error("QChatMedia::unMuteVideo not allow open video"),br.abrupt("return");case 10:if(((z=this.roomContext)===null||z===void 0?void 0:z.localMember.uuid)!==A.accid){br.next=22;break}return br.prev=11,br.next=14,(Ve=this.rtcController)===null||Ve===void 0?void 0:Ve.unmuteMyVideo();case 14:br.next=20;break;case 16:throw br.prev=16,br.t0=br.catch(11),this.logger.error("QChatMedia::unMuteVideo error",br.t0),new yo("QChatMedia::unMuteVideo error",br.t0);case 20:br.next=30;break;case 22:br.prev=22,(jt=this.rtcController)===null||jt===void 0||jt.unmuteMemberVideo(A.accid),br.next=30;break;case 26:throw br.prev=26,br.t1=br.catch(22),this.logger.error("QChatMedia::unMuteVideo error",br.t1),new yo("QChatMedia::unMuteVideo error",br.t1);case 30:case"end":return br.stop()}},lr,this,[[11,16],[22,26]])}))},V.startScreenShare=function(){var A;return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:this._checkConnectState(),z.prev=1,(A=this.rtcController)===null||A===void 0||A.startScreenShare(),z.next=9;break;case 5:throw z.prev=5,z.t0=z.catch(1),this.logger.error("QChatMedia::startScreenShare error",z.t0),new yo("QChatMedia::startScreenShare error",z.t0);case 9:case"end":return z.stop()}},oe,this,[[1,5]])}))},V.stopScreenShare=function(){var A;return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:this._checkConnectState(),z.prev=1,(A=this.rtcController)===null||A===void 0||A.stopScreenShare(),z.next=9;break;case 5:throw z.prev=5,z.t0=z.catch(1),this.logger.error("QChatMedia::stopScreenShare error",z.t0),new yo("QChatMedia::stopScreenShare error",z.t0);case 9:case"end":return z.stop()}},oe,this,[[1,5]])}))},V.stopMemberScreenShare=function(A){var oe;return Mr(this,void 0,void 0,ar.mark(function xe(){return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:this._checkConnectState(),Wr({accid:{type:"string",allowEmpty:!1}},A),Ve.prev=2,(oe=this.rtcController)===null||oe===void 0||oe.stopMemberScreenShare(A.accid),Ve.next=10;break;case 6:throw Ve.prev=6,Ve.t0=Ve.catch(2),this.logger.error("QChatMedia::stopMemberScreenShare error",Ve.t0),new yo("QChatMedia::stopMemberScreenShare error",Ve.t0);case 10:case"end":return Ve.stop()}},xe,this,[[2,6]])}))},V.subscribeRemoteVideoStream=function(A){var oe;return Mr(this,void 0,void 0,ar.mark(function xe(){return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:this._checkConnectState(),Wr({accid:{type:"string",allowEmpty:!1},streamType:{type:"number",allowEmpty:!1,min:0,max:1}},A),Ve.prev=2,(oe=this.rtcController)===null||oe===void 0||oe.subscribeRemoteVideoStream(A.accid,A.streamType),Ve.next=10;break;case 6:throw Ve.prev=6,Ve.t0=Ve.catch(2),this.logger.error("QChatMedia::subscribeRemoteVideoStream error",Ve.t0),new yo("QChatMedia::subscribeRemoteVideoStream error",Ve.t0);case 10:case"end":return Ve.stop()}},xe,this,[[2,6]])}))},V.unSubscribeRemoteVideoStream=function(A){var oe;return Mr(this,void 0,void 0,ar.mark(function xe(){return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:this._checkConnectState(),Wr({accid:{type:"string",allowEmpty:!1},streamType:{type:"number",allowEmpty:!1,min:0,max:1}},A),Ve.prev=2,(oe=this.rtcController)===null||oe===void 0||oe.unsubscribeRemoteVideoStream(A.accid,A.streamType),Ve.next=10;break;case 6:throw Ve.prev=6,Ve.t0=Ve.catch(2),this.logger.error("QChatMedia::unSubscribeRemoteVideoStream error",Ve.t0),new yo("QChatMedia::unSubscribeRemoteVideoStream error",Ve.t0);case 10:case"end":return Ve.stop()}},xe,this,[[2,6]])}))},V.setupVideoCanvas=function(A){var oe;if(this._checkConnectState(),((oe=this.roomContext)===null||oe===void 0?void 0:oe.localMember.uuid)===A.accid)try{return this.rtcController.setupLocalVideoCanvas(A.videoView)}catch(xe){throw this.logger.error("QChatMedia::setupVideoCanvas error",xe),new yo("QChatMedia::setupVideoCanvas error",xe)}else try{return this.rtcController.setupRemoteVideoCanvas(A.videoView,A.accid)}catch(xe){throw this.logger.error("QChatMedia::setupVideoCanvas error",xe),new yo("QChatMedia::setupVideoCanvas error",xe)}},V.setupRemoteVideoSubStreamCanvas=function(A){this._checkConnectState(),Wr({accid:{type:"string",allowEmpty:!1}},A);try{return this.rtcController.setupRemoteVideoSubStreamCanvas(A.videoView,A.accid)}catch(oe){throw this.logger.error("QChatMedia::setupRemoteVideoSubStreamCanvas error",oe),new yo("QChatMedia::setupRemoteVideoSubStreamCanvas error",oe)}},V.getScreenSharingUserUuid=function(){this._checkConnectState();try{return this.rtcController.getScreenSharingUserUuid()}catch(A){throw this.logger.error("QChatMedia::getScreenSharingUserUuid error",A),new yo("QChatMedia::getScreenSharingUserUuid error",A)}},V.initQChatMedia=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(this.neroom){z.next=3;break}return this.logger.warn("QChatMedia::init::you should import neroom SDK"),z.abrupt("return");case 3:if(this.state===void 0){z.next=6;break}return this.logger.error("QChatMedia::init::you already init QChatMedia"),z.abrupt("return");case 6:z.prev=6,this.neroom.initialize({appKey:this.core.options.appkey,serverConfig:A.serverConfig}),z.next=14;break;case 10:throw z.prev=10,z.t0=z.catch(6),this.logger.error("QChatMedia::initQChatMedia error",z.t0),new yo("QChatMedia::initQChatMedia error",z.t0);case 14:this.authService=this.neroom.authService,this.roomService=this.neroom.roomService,this.messageChannelService=this.neroom.messageChannelService,this.state="init";case 18:case"end":return z.stop()}},oe,this,[[6,10]])}))},V.loginByIM=function(){var A;return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(this.state==="init"){jt.next=3;break}return this.logger.error("QChatMedia::connect::you should init before login"),jt.abrupt("return");case 3:return xe=this.core.options,jt.next=6,this._getToken();case 6:return z=jt.sent,jt.prev=7,jt.next=10,(A=this.authService)===null||A===void 0?void 0:A.loginByIM(xe.account,z,xe.token);case 10:jt.next=16;break;case 12:throw jt.prev=12,jt.t0=jt.catch(7),this.logger.error("QChatMedia::loginByIM error",jt.t0),new yo("QChatMedia::loginByIM error",jt.t0);case 16:this.state="login";case 17:case"end":return jt.stop()}},oe,this,[[7,12]])}))},V._getToken=function(){var A;return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,Ve,jt,lr=this;return ar.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:return this.logger.log("QChatMedia::getToken begin getToken"),Sr.next=3,this.core.sendCmd("qchatGetNeroomToken",{qchatGetNeroomTokenTag:{neroomDeviceId:(A=this.neroom)===null||A===void 0?void 0:A.deviceId}});case 3:return xe=Sr.sent,z=xe.content.neroomToken,Ve=z.token,jt=z.expire,this.logger.log("QChatMedia::getToken success token is "+Ve+",expire is "+jt+" "),this.tokenTimer||(this.logger.debug("QChatMedia::getToken set token timer,expire is "+(1e3*jt-this.tokenExpireTime)+" "),this.tokenTimer=this.core.timerManager.addTimer(function(){return Mr(lr,void 0,void 0,ar.mark(function br(){var Er;return ar.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:return this.tokenTimer&&this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0,$r.next=4,this._getToken();case 4:Er=$r.sent,this.authService&&this.authService.renewToken(Er);case 6:case"end":return $r.stop()}},br,this)}))},1e3*jt-this.tokenExpireTime)),Sr.abrupt("return",Ve);case 8:case"end":return Sr.stop()}},oe,this)}))},V.connectChannel=function(A){var oe,xe;return Mr(this,void 0,void 0,ar.mark(function z(){var Ve;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:if(this.state!==void 0){lr.next=3;break}return this.logger.error("QChatMedia::connect::you should init before login"),lr.abrupt("return");case 3:if(this.state!=="init"){lr.next=6;break}return lr.next=6,this.loginByIM();case 6:return this.serverId=A.serverId,this.channelId=A.channelId,lr.prev=8,lr.next=11,(oe=this.roomService)===null||oe===void 0?void 0:oe.joinRoom({roomUuid:A.channelId,role:"qchatAudience",userName:this.core.options.account,initialProperties:{}},{});case 11:lr.next=17;break;case 13:throw lr.prev=13,lr.t0=lr.catch(8),this.logger.error("QChatMedia::connectChannel error",lr.t0),new yo("QChatMedia::connectChannel error",lr.t0);case 17:if(!(Ve=(xe=this.roomService)===null||xe===void 0?void 0:xe.getRoomContext(A.channelId))){lr.next=27;break}return this.roomContext=Ve,this.rtcController=this.roomContext.rtcController,this.state="connect",lr.next=24,this.rtcController.joinRtcChannel();case 24:this.core.emit("connectChannel"),lr.next=28;break;case 27:this.logger.error("QChatMedia::connect room not exited");case 28:case"end":return lr.stop()}},z,this,[[8,13]])}))},V.updateRTCChannelInfo=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},limit:{type:"number",allowEmpty:!1}},A),z.next=3,this.core.sendCmd("qchatUpdateRTCChannelConfig",{RTCChannelConfig:Tn(Tn({},A),{audio:mo(A.audio),video:mo(A.video)})});case 3:case"end":return z.stop()}},oe,this)}))},V.getRTCChannelInfo=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1}},A),Ve.next=3,this.core.sendCmd("qchatGetRTCChannelConfig",{qchatGetRTCChannelConfigTag:A});case 3:return xe=Ve.sent,Ve.abrupt("return",hC(xe.content.RTCChannelConfig));case 5:case"end":return Ve.stop()}},oe,this)}))},V.getRTCChannelOnlineMembers=function(A){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Wr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1}},A),Ve.next=3,this.core.sendCmd("qchatGetRTCChannelMembers",{qchatGetRTCChannelMembersTag:A});case 3:return xe=Ve.sent,Ve.abrupt("return",mc(xe.content.memberList));case 5:case"end":return Ve.stop()}},oe,this)}))},V.addRTCChannelListener=function(){var A,oe,xe=this;this._checkConnectState();try{(A=this.authService)===null||A===void 0||A.addAuthListener({onAuthEvent:function(Ve){return Mr(xe,void 0,void 0,ar.mark(function jt(){var lr;return ar.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:if(Ve!==1026||this.getTokenState){Sr.next=10;break}return this.logger.log("QChatMedia::loginByIM token expire,begin get new token "),this.getTokenState=!0,Sr.next=5,this._getToken();case 5:if(lr=Sr.sent,!this.authService){Sr.next=9;break}return Sr.next=9,this.authService.renewToken(lr);case 9:this.getTokenState=!1;case 10:case"end":return Sr.stop()}},jt,this)}))}})}catch(z){throw this.getTokenState=!1,this.logger.error("QChatMedia::loginByIM addAuthListener error",z),new yo("QChatMedia::loginByIM addAuthListener error",z)}(oe=this.roomContext)===null||oe===void 0||oe.addRoomListener({onRoomPropertiesChanged:function(Ve){var jt,lr,fr,Sr,br,Er;if(xe.logger.log("QChatMedia::addRTCChannelListener::onRoomPropertiesChanged",Ve),Ve.audioOff){var Dr=(jt=Ve.audioOff.value)===null||jt===void 0?void 0:jt.split("_")[0];Dr!==ws.offNotAllowSelfOn&&Dr!==ws.offAllowSelfOn||!((lr=xe.roomContext)===null||lr===void 0)&&lr.localMember.isAudioOn&&((fr=xe.rtcController)===null||fr===void 0||fr.muteMyAudio())}else if(Ve.videoOff){var $r=(Sr=Ve.videoOff.value)===null||Sr===void 0?void 0:Sr.split("_")[0];$r!==ws.offNotAllowSelfOn&&$r!==ws.offAllowSelfOn||!((br=xe.roomContext)===null||br===void 0)&&br.localMember.isVideoOn&&((Er=xe.rtcController)===null||Er===void 0||Er.muteMyVideo())}},onRoomPropertiesDeleted:function(Ve){xe.logger.log("QChatMedia::addRTCChannelListener::onRoomPropertiesDeleted",Ve)},onMemberJoinRtcChannel:function(Ve){xe.logger.log("QChatMedia::addRTCChannelListener::onMemberJoinRTCChannel",Ve);var jt=ho(Ve).call(Ve,function(lr){return lr.uuid});xe.core.emit("memberJoinRTCChannel",jt)},onMemberLeaveRoom:function(Ve){xe.logger.log("QChatMedia::addRTCChannelListener::onMemberLeaveRoom",Ve);var jt=ho(Ve).call(Ve,function(lr){return lr.uuid});xe.core.emit("memberLeaveRTCChannel",jt)},onRoomEnded:function(Ve){xe.authService&&xe.authService.logout(),xe._setStateInit(),xe.logger.log("QChatMedia::addRTCChannelListener::onRoomEnded",Ve),xe.core.emit("RTCChannelEnded",Ve)},onRtcChannelError:function(Ve){xe.logger.log("QChatMedia::addRTCChannelListener::onRtcChannelError",Ve),Ve==="SOCKET_ERROR"&&xe.disconnectChannel(),xe.core.emit("RTCChannelError",Ve)},onRtcAudioVolumeIndication:function(Ve){xe.logger.log("QChatMedia::addRTCChannelListener::onRtcAudioVolumeIndication",Ve),xe.core.emit("onRtcAudioVolumeIndication",Ve)},onMemberAudioMuteChanged:function(Ve,jt,lr){xe.logger.log("QChatMedia::addRTCChannelListener::onMemberAudioMuteChanged",Ve,jt),xe.core.emit("memberAudioMuteChanged",{memberAccId:Ve.uuid,mute:jt,operateByAccId:lr.uuid})},onMemberScreenShareStateChanged:function(Ve,jt,lr){xe.logger.log("QChatMedia::addRTCChannelListener::onMemberScreenShareStateChanged",Ve,jt),xe.core.emit("memberScreenShareStateChanged",{memberAccId:Ve.uuid,isSharing:jt,operateByAccId:lr.uuid})},onMemberVideoMuteChanged:function(Ve,jt,lr){xe.logger.log("QChatMedia::addRTCChannelListener::onMemberVideoMuteChanged",Ve,jt),xe.core.emit("memberVideoMuteChanged",{memberAccId:Ve.uuid,mute:jt,operateByAccId:lr.uuid})}})},V.enumCameraDevices=function(){var A=this;return this._checkConnectState(),this.rtcController.enumCameraDevices().then(function(oe){return oe.data},function(oe){throw A.logger.error("QChatMedia::enumCameraDevices error",oe),new yo("QChatMedia::enumCameraDevices error",oe)})},V.enumPlayoutDevices=function(){var A=this;return this._checkConnectState(),this.rtcController.enumPlayoutDevices().then(function(oe){return oe.data},function(oe){throw A.logger.error("QChatMedia::enumPlayoutDevices error",oe),new yo("QChatMedia::enumPlayoutDevices error",oe)})},V.enumRecordDevices=function(){var A=this;return this._checkConnectState(),this.rtcController.enumRecordDevices().then(function(oe){return oe.data},function(oe){throw A.logger.error("QChatMedia::enumRecordDevices error",oe),new yo("QChatMedia::enumRecordDevices error",oe)})},V.removeRTCChannelListener=function(){var A,oe;this._checkConnectState(),(A=this.roomContext)===null||A===void 0||A.removeRoomListener({}),(oe=this.authService)===null||oe===void 0||oe.removeAuthListener({})},V.setSelectedCameraDevice=function(A){var oe=this;return this._checkConnectState(),Wr({deviceId:{type:"string",allowEmpty:!1}},A),this.rtcController.setSelectedCameraDevice(A.deviceId).then(function(xe){return xe.data},function(xe){throw oe.logger.error("QChatMedia::setSelectedCameraDevice error",xe),new yo("QChatMedia::setSelectedCameraDevice error",xe)})},V.setSelectedPlayoutDevice=function(A){var oe=this;return this._checkConnectState(),Wr({deviceId:{type:"string",allowEmpty:!1}},A),this.rtcController.setSelectedPlayoutDevice(A.deviceId).then(function(xe){return xe.data},function(xe){throw oe.logger.error("QChatMedia::setSelectedPlayoutDevice error",xe),new yo("QChatMedia::setSelectedPlayoutDevice error",xe)})},V.setSelectedRecordDevice=function(A){var oe=this;return this._checkConnectState(),Wr({deviceId:{type:"string",allowEmpty:!1}},A),this.rtcController.setSelectedRecordDevice(A.deviceId).then(function(xe){return xe.data},function(xe){throw oe.logger.error("QChatMedia::setSelectedRecordDevice error",xe),new yo("QChatMedia::setSelectedRecordDevice error",xe)})},V.getRTCMembers=function(){var A,oe;return this._checkConnectState(),ho(A=Ys(oe=this.roomContext.remoteMembers).call(oe,function(xe){return xe.isInRtcChannel})).call(A,function(xe){return{accid:xe.uuid,isAudioOn:!!xe.isAudioOn,isVideoOn:!!xe.isVideoOn,isSharingScreen:!!xe.isSharingScreen,properties:xe.properties}})},V.subscribeRemoteVideoSubStream=function(A){var oe;return Mr(this,void 0,void 0,ar.mark(function xe(){return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:this._checkConnectState(),Wr({accid:{type:"string",allowEmpty:!1}},A),Ve.prev=2,(oe=this.rtcController)===null||oe===void 0||oe.subscribeRemoteVideoSubStream(A.accid),Ve.next=10;break;case 6:throw Ve.prev=6,Ve.t0=Ve.catch(2),this.logger.error("QChatMedia::subscribeRemoteVideoSubStream error",Ve.t0),new yo("QChatMedia::subscribeRemoteVideoSubStream error",Ve.t0);case 10:case"end":return Ve.stop()}},xe,this,[[2,6]])}))},V.unsubscribeRemoteVideoSubStream=function(A){var oe;return Mr(this,void 0,void 0,ar.mark(function xe(){return ar.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:this._checkConnectState(),Wr({accid:{type:"string",allowEmpty:!1}},A),Ve.prev=2,(oe=this.rtcController)===null||oe===void 0||oe.unsubscribeRemoteVideoSubStream(A.accid),Ve.next=10;break;case 6:throw Ve.prev=6,Ve.t0=Ve.catch(2),this.logger.error("QChatMedia::unsubscribeRemoteVideoSubStream error",Ve.t0),new yo("QChatMedia::unsubscribeRemoteVideoSubStream error",Ve.t0);case 10:case"end":return Ve.stop()}},xe,this,[[2,6]])}))},V.muteAllAudio=function(){var A;return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this._checkConnectState(),z.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 3:if(z.sent){z.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneMicrophone auth"),z.abrupt("return");case 7:z.prev=7,(A=this.roomContext)===null||A===void 0||A.updateRoomProperty("audioOff",mo({value:ws.offNotAllowSelfOn+"_"+new Date().getTime()})),z.next=15;break;case 11:throw z.prev=11,z.t0=z.catch(7),this.logger.error("QChatMedia::muteAllAudio error",z.t0),new yo("QChatMedia::muteAllAudio error",z.t0);case 15:case"end":return z.stop()}},oe,this,[[7,11]])}))},V.muteAllVideo=function(){var A;return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this._checkConnectState(),z.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 3:if(z.sent){z.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneCamera auth"),z.abrupt("return");case 7:z.prev=7,(A=this.roomContext)===null||A===void 0||A.updateRoomProperty("videoOff",mo({value:ws.offNotAllowSelfOn+"_"+new Date().getTime()})),z.next=15;break;case 11:throw z.prev=11,z.t0=z.catch(7),this.logger.error("QChatMedia::muteAllVideo error",z.t0),new yo("QChatMedia::muteAllVideo error",z.t0);case 15:case"end":return z.stop()}},oe,this,[[7,11]])}))},V.unMuteAllAudio=function(){var A;return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this._checkConnectState(),z.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 3:if(z.sent){z.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneMicrophone auth"),z.abrupt("return");case 7:z.prev=7,(A=this.roomContext)===null||A===void 0||A.updateRoomProperty("audioOff",mo({value:ws.disable+"_"+new Date().getTime()})),z.next=15;break;case 11:throw z.prev=11,z.t0=z.catch(7),this.logger.error("QChatMedia::unMuteAllAudio error",z.t0),new yo("QChatMedia::unMuteAllAudio error",z.t0);case 15:case"end":return z.stop()}},oe,this,[[7,11]])}))},V.unMuteAllVideo=function(){var A;return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this._checkConnectState(),z.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 3:if(z.sent){z.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneCamera auth"),z.abrupt("return");case 7:z.prev=7,(A=this.roomContext)===null||A===void 0||A.updateRoomProperty("videoOff",mo({value:ws.disable+"_"+new Date().getTime()})),z.next=15;break;case 11:throw z.prev=11,z.t0=z.catch(7),this.logger.error("QChatMedia::unMuteAllVideo error",z.t0),new yo("QChatMedia::unMuteAllVideo error",z.t0);case 15:case"end":return z.stop()}},oe,this,[[7,11]])}))},x}(gl),yC={"1_2":"heartbeat","24_2":"qchatLogin","24_4":"qchatExit","24_5":"qchatBeKicked","24_8":"qchatMultiSpotLogin","24_9":"qchatKick","24_19":"qchatSync"},Hd={qchatLoginTag:{appkey:1,account:2,authType:3,token:4,loginExt:5,clientType:6,clientSession:7,deviceId:8,sdkVersion:9,sdkType:10,userAgent:11,customTag:12,customClientType:13,sdkHumanVersion:14,pushTokenName:20,pushToken:21,pushkitTokenName:22,pushkitToken:23,deviceInfo:24,customPushContentType:25,os:30,mac:31,bundleId:32,simCarrierCode:33,simCountryCode:34,networkCode:35,browser:36,deviceModel:37,androidid:38,imei:39,idfv:40,openuuid:41,pushType:100,hasTokenPreviously:101,consid:102,clientIP:103,clientPort:104,loginTime:105}},Sl=Cc(Hd),bC={heartbeat:{sid:1,cid:2,service:"qchatAuth"},qchatLogin:{sid:24,cid:2,service:"qchatAuth",params:[{type:"Property",name:"qchatLoginReqTag",reflectMapper:Hd.qchatLoginTag}],response:[{type:"Property",name:"qchatLoginResTag",reflectMapper:Sl.qchatLoginTag},{type:"PropertyArray",name:"qchatMultiLoginResult",reflectMapper:Sl.qchatLoginTag}]},qchatExit:{sid:24,cid:4,service:"qchatAuth"},qchatBeKicked:{sid:24,cid:5,service:"qchatAuth",response:[{type:"Property",name:"beKickedTag",reflectMapper:{1:"clientType",2:"reason",3:"ext",4:"customClientType"}}]},qchatMultiSpotLogin:{sid:24,cid:8,service:"qchatAuth",response:[{type:"Number",name:"state"},{type:"Property",name:"qchatLoginResTag",reflectMapper:Sl.qchatLoginTag}]},qchatKick:{sid:24,cid:9,service:"qchatAuth",params:[{type:"StrArray",name:"deviceIds"}],response:[{type:"StrArray",name:"deviceIds"}]},qchatSync:{sid:24,cid:19,service:"qchatAuth",isNoResponse:!0,params:[{type:"Property",name:"qchatSyncTag",reflectMapper:{systemNotification:1,pushConfig:2}}],response:[{type:"Number",name:"timetag"}]}},TC={debugLevel:"off",needReconnect:!0,reconnectionAttempts:Xm,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},zd=function(S){function x(F,A){var oe;return A===void 0&&(A={cloudStorageConfig:{}}),(oe=S.call(this,F)||this).instanceName="QChat",oe.account="",oe.options={},oe.qchatAuth={},oe.qchatServer={},oe.qchatChannel={},oe.qchatMsg={},oe.qchatRole={},oe.qchatMedia={},oe.cloudStorage={},oe.setOptions(F),Pi({cmdMap:yC,cmdConfig:bC}),Pi({cmdMap:gy,cmdConfig:hh}),oe.qchatAuth=new gC(i(oe)),oe.qchatServer=new BS(i(oe)),oe.qchatChannel=new tC(i(oe)),oe.qchatMsg=new Hy(i(oe)),oe.qchatRole=new oC(i(oe)),oe.qchatMedia=new vC(i(oe)),oe.cloudStorage=new hy(i(oe),Tn({storageKeyPrefix:oe.instanceName},A.cloudStorageConfig)),A&&oe.setOtherOptions(A),x.instance=i(oe),oe}Ro(x,S),x.getInstance=function(A,oe){if(!x.instance){if(A)return new x(A,oe);throw new Error("Instance not exist, please input options")}if(A){if(x.instance.options.account===A.account&&x.instance.options.appkey===A.appkey)return x.instance.setOptions(A),oe&&x.instance.setOtherOptions(oe),x.instance;throw new Error("Unexpected login")}return x.instance};var V=x.prototype;return V.connect=function(A){A===void 0&&(A={});var oe=Ja(null,{connect:{get:function(){return S.prototype.connect}}});return Mr(this,void 0,void 0,ar.mark(function xe(){var z,Ve,jt;return ar.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:if(/^(unconnected|waitReconnect)$/.test(this.status)){fr.next=4;break}return z="QChat status is "+this.status+", and would not connect",this.logger.warn(z),fr.abrupt("return",uo.reject(z));case 4:return Ve=A.isAutoReconnect||!1,fr.next=7,oe.connect.call(this,{linkUrls:this.options.linkAddresses,isAutoReconnect:Ve});case 7:return fr.prev=7,fr.next=10,this.qchatAuth.doLogin(Ve);case 10:jt=fr.sent,fr.next=21;break;case 13:if(fr.prev=13,fr.t0=fr.catch(7),this.logger.warn("qchat connect:: login failed",fr.t0),this.retryCount!==0){fr.next=19;break}throw this.doDisconnect(ds.ACTIVE,"FailedToInitializeLogin"),fr.t0;case 19:return this.doDisconnect(ds.OFFLINE,"ReconnectLoginFailed"),fr.abrupt("return");case 21:return this.status="logined",jt.loginResult.appkey=this.options.appkey,this.eventBus.emit("logined",jt.loginResult),this.emit("logined",jt.loginResult),jt.multiLoginResults&&jt.multiLoginResults.length>0&&this.emit("multiSpotLogin",jt.multiLoginResults),this.resetConnectStatus(),this.ping(),fr.prev=28,fr.next=31,this.cloudStorage.init();case 31:fr.next=36;break;case 33:fr.prev=33,fr.t1=fr.catch(28),this.logger.error("NIM:login cloudStorage init failed ",fr.t1);case 36:return fr.next=38,this.qchatAuth.sync();case 38:case"end":return fr.stop()}},xe,this,[[7,13],[28,33]])}))},V.login=function(A){return A===void 0&&(A={}),this.connect(A)},V.setOptions=function(A){Wr({account:{type:"string"},appkey:{type:"string"},token:{type:"string"},linkAddresses:{type:"array",itemType:"string",min:1},needReconnect:{type:"boolean",required:!1},reconnectionAttempts:{type:"number",required:!1},debugLevel:{type:"enum",values:np,required:!1}},A),this.logger.log("QChat::setOptions options is",A),this.account=A.account,this.options=Tn(Tn({},TC),A)},V.setOtherOptions=function(A){var oe;!((oe=A==null?void 0:A.QChatMedia)===null||oe===void 0)&&oe.neroom&&this.qchatMedia.setNeroom(A.QChatMedia.neroom)},V.onMessage=function(A){var oe,xe,z=S.prototype.onMessage.call(this,A);if(z){var Ve=z.raw.ser,jt=this.sendingCmdMap.get(Ve);if(jt&&jt.cmd===z.cmd){var lr=jt.callback,fr=jt.timer,Sr=jt.params;if(clearTimeout(fr),z.params=Sr,this.sendingCmdMap.delete(Ve),z.cmd==="heartbeat")return void lr[0]();var br=(oe=this[z.service])===null||oe===void 0?void 0:oe.process(z);br&&typeof br.then=="function"?br.then(function(Er){lr[0](Er)}).catch(function(Er){lr[1](Er)}):(this.logger.log("imsocket:: handlerFn without promise",z.service,z.cmd),lr[0]())}else(xe=this[z.service])===null||xe===void 0||xe.process(z)}},V.disconnect=function(){var A=this;switch(this.status){case"logined":return this.sendCmd("qchatExit").then(function(){S.prototype.doDisconnect.call(A,ds.ACTIVE,"UserActiveDisconnect")});case"connected":case"connecting":case"waitReconnect":return S.prototype.doDisconnect.call(this,ds.ACTIVE,"UserActiveDisconnect"),uo.resolve();case"unconnected":case"destroyed":return uo.resolve()}},V.logout=function(){return this.disconnect()},V.destroy=function(){return x.instance=null,S.prototype.destroy.call(this)},V.kickOtherClients=function(A){return Wr({deviceIds:{type:"array",itemType:"string"}},A),this.qchatAuth.kick(A)},x}(hd);zd.instance=null;var SC=Math.min,Dh=[].lastIndexOf,rf=!!Dh&&1/[1].lastIndexOf(1,-0)<0,nf=Us("lastIndexOf"),Ky=rf||!nf?function(x){if(rf)return T(Dh,this,arguments)||0;var V=sr(this),F=Ia(V),A=F-1;for(arguments.length>1&&(A=SC(A,$i(arguments[1]))),A<0&&(A=F+A);A>=0;A--)if(A in V&&V[A]===x)return A||0;return-1}:Dh;Vr({target:"Array",proto:!0,forced:Ky!==[].lastIndexOf},{lastIndexOf:Ky});var CC=Uo("Array").lastIndexOf,Uh=Array.prototype,Wy=function(S){var x=S.lastIndexOf;return S===Uh||rr(Uh,S)&&x===Uh.lastIndexOf?CC:x},Rc=o(function(S,x){(function(){var V={function:!0,object:!0}[typeof window]&&window||this,F=x,A=S&&!S.nodeType&&S,oe=F&&A&&typeof e=="object"&&e;!oe||oe.global!==oe&&oe.window!==oe&&oe.self!==oe||(V=oe);var xe=Math.pow(2,53)-1,z=/\bOpera/,Ve=Object.prototype,jt=Ve.hasOwnProperty,lr=Ve.toString;function fr(wn){return(wn=String(wn)).charAt(0).toUpperCase()+wn.slice(1)}function Sr(wn){return wn=vn(wn),/^(?:webOS|i(?:OS|P))/.test(wn)?wn:fr(wn)}function br(wn,Zr){for(var Qn in wn)jt.call(wn,Qn)&&Zr(wn[Qn],Qn,wn)}function Er(wn){return wn==null?fr(wn):lr.call(wn).slice(8,-1)}function Dr(wn){return String(wn).replace(/([ -])(?!$)/g,"$1?")}function $r(wn,Zr){var Qn=null;return function(jo,jn){var wr=-1,xn=jo?jo.length:0;if(typeof xn=="number"&&xn>-1&&xn<=xe)for(;++wr<xn;)jn(jo[wr],wr,jo);else br(jo,jn)}(wn,function(Dn,jo){Qn=Zr(Qn,Dn,jo,wn)}),Qn}function vn(wn){return String(wn).replace(/^ +| +$/g,"")}var Yr=function wn(Zr){var Qn=V,Dn=Zr&&typeof Zr=="object"&&Er(Zr)!="String";Dn&&(Qn=Zr,Zr=null);var jo=Qn.navigator||{},jn=jo.userAgent||"";Zr||(Zr=jn);var wr,xn,Nn=Dn?!!jo.likeChrome:/\bChrome\b/.test(Zr)&&!/internal|\n/i.test(lr.toString()),Mn="Object",Xr=Dn?Mn:"ScriptBridgingProxyObject",On=Dn?Mn:"Environment",Un=Dn&&Qn.java?"JavaPackage":Er(Qn.java),eo=Dn?Mn:"RuntimeObject",ro=/\bJava/.test(Un)&&Qn.java,Do=ro&&Er(Qn.environment)==On,go=ro?"a":"",Zo=ro?"b":"",So=Qn.document||{},Io=Qn.operamini||Qn.opera,ea=z.test(ea=Dn&&Io?Io["[[Class]]"]:Er(Io))?ea:Io=null,Mi=Zr,Eo=[],ki=null,$a=Zr==jn,po=$a&&Io&&typeof Io.version=="function"&&Io.version(),Go=function(ka){return $r(ka,function(Qo,ma){return Qo||RegExp("\\b"+(ma.pattern||Dr(ma))+"\\b","i").exec(Zr)&&(ma.label||ma)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),zn=function(ka){return $r(ka,function(Qo,ma){return Qo||RegExp("\\b"+(ma.pattern||Dr(ma))+"\\b","i").exec(Zr)&&(ma.label||ma)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),Bo=Qy([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Qa=function(ka){return $r(ka,function(Qo,ma,Kd){return Qo||(ma[Bo]||ma[/^[a-z]+(?: +[a-z]+\b)*/i.exec(Bo)]||RegExp("\\b"+Dr(Kd)+"(?:\\b|\\w*\\d)","i").exec(Zr))&&Kd})}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),Jn=function(ka){return $r(ka,function(Qo,ma){var Kd=ma.pattern||Dr(ma);return!Qo&&(Qo=RegExp("\\b"+Kd+"(?:/[\\d.]+|[ \\w.]*)","i").exec(Zr))&&(Qo=function(Ws,Wd,of){var Vh={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return Wd&&of&&/^Win/i.test(Ws)&&!/^Windows Phone /i.test(Ws)&&(Vh=Vh[/[\d.]+$/.exec(Ws)])&&(Ws="Windows "+Vh),Ws=String(Ws),Wd&&of&&(Ws=Ws.replace(RegExp(Wd,"i"),of)),Sr(Ws.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(Qo,Kd,ma.label||ma)),Qo})}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Qy(Is){return $r(Is,function(ka,Qo){var ma=Qo.pattern||Dr(Qo);return!ka&&(ka=RegExp("\\b"+ma+" *\\d+[.\\w_]*","i").exec(Zr)||RegExp("\\b"+ma+" *\\w+-[\\w]*","i").exec(Zr)||RegExp("\\b"+ma+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(Zr))&&((ka=String(Qo.label&&!RegExp(ma,"i").test(Qo.label)?Qo.label:ka).split("/"))[1]&&!/[\d.]+/.test(ka[0])&&(ka[0]+=" "+ka[1]),Qo=Qo.label||Qo,ka=Sr(ka[0].replace(RegExp(ma,"i"),Qo).replace(RegExp("; *(?:"+Qo+"[_-])?","i")," ").replace(RegExp("("+Qo+")[-_.]?(\\w)","i"),"$1 $2"))),ka})}function qh(Is){return $r(Is,function(ka,Qo){return ka||(RegExp(Qo+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(Zr)||0)[1]||null})}if(Go&&(Go=[Go]),/\bAndroid\b/.test(Jn)&&!Bo&&(wr=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(Zr))&&(Bo=vn(wr[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),Qa&&!Bo?Bo=Qy([Qa]):Qa&&Bo&&(Bo=Bo.replace(RegExp("^("+Dr(Qa)+")[-_.\\s]","i"),Qa+" ").replace(RegExp("^("+Dr(Qa)+")[-_.]?(\\w)","i"),Qa+" $2")),(wr=/\bGoogle TV\b/.exec(Bo))&&(Bo=wr[0]),/\bSimulator\b/i.test(Zr)&&(Bo=(Bo?Bo+" ":"")+"Simulator"),zn=="Opera Mini"&&/\bOPiOS\b/.test(Zr)&&Eo.push("running in Turbo/Uncompressed mode"),zn=="IE"&&/\blike iPhone OS\b/.test(Zr)?(Qa=(wr=wn(Zr.replace(/like iPhone OS/,""))).manufacturer,Bo=wr.product):/^iP/.test(Bo)?(zn||(zn="Safari"),Jn="iOS"+((wr=/ OS ([\d_]+)/i.exec(Zr))?" "+wr[1].replace(/_/g,"."):"")):zn=="Konqueror"&&/^Linux\b/i.test(Jn)?Jn="Kubuntu":Qa&&Qa!="Google"&&(/Chrome/.test(zn)&&!/\bMobile Safari\b/i.test(Zr)||/\bVita\b/.test(Bo))||/\bAndroid\b/.test(Jn)&&/^Chrome/.test(zn)&&/\bVersion\//i.test(Zr)?(zn="Android Browser",Jn=/\bAndroid\b/.test(Jn)?Jn:"Android"):zn=="Silk"?(/\bMobi/i.test(Zr)||(Jn="Android",Eo.unshift("desktop mode")),/Accelerated *= *true/i.test(Zr)&&Eo.unshift("accelerated")):zn=="UC Browser"&&/\bUCWEB\b/.test(Zr)?Eo.push("speed mode"):zn=="PaleMoon"&&(wr=/\bFirefox\/([\d.]+)\b/.exec(Zr))?Eo.push("identifying as Firefox "+wr[1]):zn=="Firefox"&&(wr=/\b(Mobile|Tablet|TV)\b/i.exec(Zr))?(Jn||(Jn="Firefox OS"),Bo||(Bo=wr[1])):!zn||(wr=!/\bMinefield\b/i.test(Zr)&&/\b(?:Firefox|Safari)\b/.exec(zn))?(zn&&!Bo&&/[\/,]|^[^(]+?\)/.test(Zr.slice(Zr.indexOf(wr+"/")+8))&&(zn=null),(wr=Bo||Qa||Jn)&&(Bo||Qa||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(Jn))&&(zn=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(Jn)?Jn:wr)+" Browser")):zn=="Electron"&&(wr=(/\bChrome\/([\d.]+)\b/.exec(Zr)||0)[1])&&Eo.push("Chromium "+wr),po||(po=qh(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",Dr(zn),"(?:Firefox|Minefield|NetFront)"])),(wr=(Go=="iCab"&&parseFloat(po)>3?"WebKit":/\bOpera\b/.test(zn)&&(/\bOPR\b/.test(Zr)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(Zr)&&!/^(?:Trident|EdgeHTML)$/.test(Go)&&"WebKit"||!Go&&/\bMSIE\b/i.test(Zr)&&(Jn=="Mac OS"?"Tasman":"Trident")||Go=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(zn)&&"NetFront")&&(Go=[wr]),zn=="IE"&&(wr=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(Zr)||0)[1])?(zn+=" Mobile",Jn="Windows Phone "+(/\+$/.test(wr)?wr:wr+".x"),Eo.unshift("desktop mode")):/\bWPDesktop\b/i.test(Zr)?(zn="IE Mobile",Jn="Windows Phone 8.x",Eo.unshift("desktop mode"),po||(po=(/\brv:([\d.]+)/.exec(Zr)||0)[1])):zn!="IE"&&Go=="Trident"&&(wr=/\brv:([\d.]+)/.exec(Zr))&&(zn&&Eo.push("identifying as "+zn+(po?" "+po:"")),zn="IE",po=wr[1]),$a){if(function(ka,Qo){var ma=ka!=null?typeof ka[Qo]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(ma)||ma=="object"&&!ka[Qo])}(Qn,"global"))if(ro&&(Mi=(wr=ro.lang.System).getProperty("os.arch"),Jn=Jn||wr.getProperty("os.name")+" "+wr.getProperty("os.version")),Do){try{po=Qn.require("ringo/engine").version.join("."),zn="RingoJS"}catch{(wr=Qn.system)&&wr.global.system==Qn.system&&(zn="Narwhal",Jn||(Jn=wr[0].os||null))}zn||(zn="Rhino")}else typeof Qn.process=="object"&&!Qn.process.browser&&(wr=Qn.process)&&(typeof wr.versions=="object"&&(typeof wr.versions.electron=="string"?(Eo.push("Node "+wr.versions.node),zn="Electron",po=wr.versions.electron):typeof wr.versions.nw=="string"&&(Eo.push("Chromium "+po,"Node "+wr.versions.node),zn="NW.js",po=wr.versions.nw)),zn||(zn="Node.js",Mi=wr.arch,Jn=wr.platform,po=(po=/[\d.]+/.exec(wr.version))?po[0]:null));else Er(wr=Qn.runtime)==Xr?(zn="Adobe AIR",Jn=wr.flash.system.Capabilities.os):Er(wr=Qn.phantom)==eo?(zn="PhantomJS",po=(wr=wr.version||null)&&wr.major+"."+wr.minor+"."+wr.patch):typeof So.documentMode=="number"&&(wr=/\bTrident\/(\d+)/i.exec(Zr))?(po=[po,So.documentMode],(wr=+wr[1]+4)!=po[1]&&(Eo.push("IE "+po[1]+" mode"),Go&&(Go[1]=""),po[1]=wr),po=zn=="IE"?String(po[1].toFixed(1)):po[0]):typeof So.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(zn)&&(Eo.push("masking as "+zn+" "+po),zn="IE",po="11.0",Go=["Trident"],Jn="Windows");Jn=Jn&&Sr(Jn)}if(po&&(wr=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(po)||/(?:alpha|beta)(?: ?\d)?/i.exec(Zr+";"+($a&&jo.appMinorVersion))||/\bMinefield\b/i.test(Zr)&&"a")&&(ki=/b/i.test(wr)?"beta":"alpha",po=po.replace(RegExp(wr+"\\+?$"),"")+(ki=="beta"?Zo:go)+(/\d+\+?/.exec(wr)||"")),zn=="Fennec"||zn=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(Jn))zn="Firefox Mobile";else if(zn=="Maxthon"&&po)po=po.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(Bo))Bo=="Xbox 360"&&(Jn=null),Bo=="Xbox 360"&&/\bIEMobile\b/.test(Zr)&&Eo.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(zn)&&(!zn||Bo||/Browser|Mobi/.test(zn))||Jn!="Windows CE"&&!/Mobi/i.test(Zr))if(zn=="IE"&&$a)try{Qn.external===null&&Eo.unshift("platform preview")}catch{Eo.unshift("embedded")}else(/\bBlackBerry\b/.test(Bo)||/\bBB10\b/.test(Zr))&&(wr=(RegExp(Bo.replace(/ +/g," *")+"/([.\\d]+)","i").exec(Zr)||0)[1]||po)?(Jn=((wr=[wr,/BB10/.test(Zr)])[1]?(Bo=null,Qa="BlackBerry"):"Device Software")+" "+wr[0],po=null):this!=br&&Bo!="Wii"&&($a&&Io||/Opera/.test(zn)&&/\b(?:MSIE|Firefox)\b/i.test(Zr)||zn=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(Jn)||zn=="IE"&&(Jn&&!/^Win/.test(Jn)&&po>5.5||/\bWindows XP\b/.test(Jn)&&po>8||po==8&&!/\bTrident\b/.test(Zr)))&&!z.test(wr=wn.call(br,Zr.replace(z,"")+";"))&&wr.name&&(wr="ing as "+wr.name+((wr=wr.version)?" "+wr:""),z.test(zn)?(/\bIE\b/.test(wr)&&Jn=="Mac OS"&&(Jn=null),wr="identify"+wr):(wr="mask"+wr,zn=ea?Sr(ea.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(wr)&&(Jn=null),$a||(po=null)),Go=["Presto"],Eo.push(wr));else zn+=" Mobile";(wr=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(Zr)||0)[1])&&(wr=[parseFloat(wr.replace(/\.(\d)$/,".0$1")),wr],zn=="Safari"&&wr[1].slice(-1)=="+"?(zn="WebKit Nightly",ki="alpha",po=wr[1].slice(0,-1)):po!=wr[1]&&po!=(wr[2]=(/\bSafari\/([\d.]+\+?)/i.exec(Zr)||0)[1])||(po=null),wr[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(Zr)||0)[1],wr[0]==537.36&&wr[2]==537.36&&parseFloat(wr[1])>=28&&Go=="WebKit"&&(Go=["Blink"]),$a&&(Nn||wr[1])?(Go&&(Go[1]="like Chrome"),wr=wr[1]||((wr=wr[0])<530?1:wr<532?2:wr<532.05?3:wr<533?4:wr<534.03?5:wr<534.07?6:wr<534.1?7:wr<534.13?8:wr<534.16?9:wr<534.24?10:wr<534.3?11:wr<535.01?12:wr<535.02?"13+":wr<535.07?15:wr<535.11?16:wr<535.19?17:wr<536.05?18:wr<536.1?19:wr<537.01?20:wr<537.11?"21+":wr<537.13?23:wr<537.18?24:wr<537.24?25:wr<537.36?26:Go!="Blink"?"27":"28")):(Go&&(Go[1]="like Safari"),wr=(wr=wr[0])<400?1:wr<500?2:wr<526?3:wr<533?4:wr<534?"4+":wr<535?5:wr<537?6:wr<538?7:wr<601?8:wr<602?9:wr<604?10:wr<606?11:wr<608?12:"12"),Go&&(Go[1]+=" "+(wr+=typeof wr=="number"?".x":/[.+]/.test(wr)?"":"+")),zn=="Safari"&&(!po||parseInt(po)>45)?po=wr:zn=="Chrome"&&/\bHeadlessChrome/i.test(Zr)&&Eo.unshift("headless")),zn=="Opera"&&(wr=/\bzbov|zvav$/.exec(Jn))?(zn+=" ",Eo.unshift("desktop mode"),wr=="zvav"?(zn+="Mini",po=null):zn+="Mobile",Jn=Jn.replace(RegExp(" *"+wr+"$"),"")):zn=="Safari"&&/\bChrome\b/.exec(Go&&Go[1])?(Eo.unshift("desktop mode"),zn="Chrome Mobile",po=null,/\bOS X\b/.test(Jn)?(Qa="Apple",Jn="iOS 4.3+"):Jn=null):/\bSRWare Iron\b/.test(zn)&&!po&&(po=qh("Chrome")),po&&po.indexOf(wr=/[\d.]+$/.exec(Jn))==0&&Zr.indexOf("/"+wr+"-")>-1&&(Jn=vn(Jn.replace(wr,""))),Jn&&Jn.indexOf(zn)!=-1&&!RegExp(zn+" OS").test(Jn)&&(Jn=Jn.replace(RegExp(" *"+Dr(zn)+" *"),"")),Go&&!/\b(?:Avant|Nook)\b/.test(zn)&&(/Browser|Lunascape|Maxthon/.test(zn)||zn!="Safari"&&/^iOS/.test(Jn)&&/\bSafari\b/.test(Go[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(zn)&&Go[1])&&(wr=Go[Go.length-1])&&Eo.push(wr),Eo.length&&(Eo=["("+Eo.join("; ")+")"]),Qa&&Bo&&Bo.indexOf(Qa)<0&&Eo.push("on "+Qa),Bo&&Eo.push((/^on /.test(Eo[Eo.length-1])?"":"on ")+Bo),Jn&&(wr=/ ([\d.+]+)$/.exec(Jn),xn=wr&&Jn.charAt(Jn.length-wr[0].length-1)=="/",Jn={architecture:32,family:wr&&!xn?Jn.replace(wr[0],""):Jn,version:wr?wr[1]:null,toString:function(){var Is=this.version;return this.family+(Is&&!xn?" "+Is:"")+(this.architecture==64?" 64-bit":"")}}),(wr=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Mi))&&!/\bi686\b/i.test(Mi)?(Jn&&(Jn.architecture=64,Jn.family=Jn.family.replace(RegExp(" *"+wr),"")),zn&&(/\bWOW64\b/i.test(Zr)||$a&&/\w(?:86|32)$/.test(jo.cpuClass||jo.platform)&&!/\bWin64; x64\b/i.test(Zr))&&Eo.unshift("32-bit")):Jn&&/^OS X/.test(Jn.family)&&zn=="Chrome"&&parseFloat(po)>=39&&(Jn.architecture=64),Zr||(Zr=null);var xs={};return xs.description=Zr,xs.layout=Go&&Go[0],xs.manufacturer=Qa,xs.name=zn,xs.prerelease=ki,xs.product=Bo,xs.ua=Zr,xs.version=zn&&po,xs.os=Jn||{architecture:null,family:null,version:null,toString:function(){return"null"}},xs.parse=wn,xs.toString=function(){return this.description||""},xs.version&&Eo.unshift(po),xs.name&&Eo.unshift(zn),Jn&&zn&&(Jn!=String(Jn).split(" ")[0]||Jn!=zn.split(" ")[0]&&!Bo)&&Eo.push(Bo?"("+Jn+")":"on "+Jn),Eo.length&&(xs.description=Eo.join(" ")),xs}();F&&A?br(Yr,function(wn,Zr){F[Zr]=wn}):V.platform=Yr}).call(e)}),Gy=o(function(S,x){S.exports=function(){var V={d:function(wr,xn){for(var Nn in xn)V.o(xn,Nn)&&!V.o(wr,Nn)&&Wi(wr,Nn,{enumerable:!0,get:xn[Nn]})},o:function(wr,xn){return Object.prototype.hasOwnProperty.call(wr,xn)}},F={};V.d(F,{default:function(){return jo}});var A=function jn(wr){for(var xn in function(Nn,Mn){if(!(Nn instanceof Mn))throw new TypeError("Cannot call a class as a function")}(this,jn),this.directUploadAddr="https://wanproxy-web.127.net",this.retryCount=4,this.trunkSize=4194304,this.trunkUploadTimeout=5e4,this.getOffsetTimeout=1e4,this.version="1.0",this.enableCache=!0,this.logger=console,this.onError=function(Nn){},this.onProgress=function(Nn){},this.onUploadProgress=function(Nn){},this.onComplete=function(Nn){},wr)this[xn]=wr[xn]};function oe(jn,wr){var xn=ga!==void 0&&Va(jn)||jn["@@iterator"];if(!xn){if(ns(jn)||(xn=function(eo,ro){if(eo){var Do;if(typeof eo=="string")return xe(eo,ro);var go=Co(Do=Object.prototype.toString.call(eo)).call(Do,8,-1);return go==="Object"&&eo.constructor&&(go=eo.constructor.name),go==="Map"||go==="Set"?_c(eo):go==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(go)?xe(eo,ro):void 0}}(jn))||wr&&jn&&typeof jn.length=="number"){xn&&(jn=xn);var Nn=0,Mn=function(){};return{s:Mn,n:function(){return Nn>=jn.length?{done:!0}:{done:!1,value:jn[Nn++]}},e:function(ro){throw ro},f:Mn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Xr,On=!0,Un=!1;return{s:function(){xn=xn.call(jn)},n:function(){var ro=xn.next();return On=ro.done,ro},e:function(ro){Un=!0,Xr=ro},f:function(){try{On||xn.return==null||xn.return()}finally{if(Un)throw Xr}}}}function xe(jn,wr){(wr==null||wr>jn.length)&&(wr=jn.length);for(var xn=0,Nn=new Array(wr);xn<wr;xn++)Nn[xn]=jn[xn];return Nn}var z=window.localStorage;window.localStorage&&typeof window.localStorage.getItem=="function"&&typeof window.localStorage.setItem=="function"&&typeof window.localStorage.removeItem=="function"||(z={privateObj:{},setItem:function(wr,xn){z.privateObj[wr]=xn},getItem:function(wr){return z.privateObj[wr]},removeItem:function(wr){delete z.privateObj[wr]},getKeys:function(){return na(z.privateObj)}});var Ve={getFileKey:function(wr){var xn=wr.size.toString(),Nn=wr.lastModified.toString();return"_NosUploader_"+wr.name+Co(xn).call(xn,xn.length-5)+Co(Nn).call(Nn,Nn.length-5)},getFileInfo:function(wr){var xn=z.getItem(wr);if(!xn)return null;try{return JSON.parse(xn)}catch{return null}},initFile:function(wr,xn,Nn){Ve.clearExpiredInfo();var Mn=this.getFileKey(xn),Xr={ctx:wr.ctx!==void 0?wr.ctx:"",bucket:wr.bucketName,obj:wr.objectName,token:wr.token,modifyAt:ts(),end:!1};return wr.payload&&(Xr.payload=wr.payload),Nn&&z.setItem(Mn,mo(Xr)),Mn},setUploadContext:function(wr,xn,Nn){var Mn=this.getFileInfo(wr);Mn&&(Mn.ctx=xn,Nn&&z.setItem(wr,mo(Mn)))},setComplete:function(wr,xn){var Nn=this.getFileInfo(wr);Nn&&(Nn.modifyAt=ts(),Nn.end=!0,xn&&z.setItem(wr,mo(Nn)))},getUploadContext:function(wr){var xn=this.getFileInfo(wr);return xn?xn.ctx:""},removeFileInfo:function(wr){pa(wr).call(wr,"_NosUploader_")===0&&z.removeItem(wr)},clearExpiredInfo:function(){var wr,xn=typeof z.getKeys=="function"?z.getKeys():na(z),Nn=ts(),Mn=[],Xr=oe(xn);try{for(Xr.s();!(wr=Xr.n()).done;){var On=wr.value;if(pa(On).call(On,"_NosUploader_")===0){var Un=Ve.getFileInfo(On);Un===null||Nn-Un.modifyAt>jo.expireTime?z.removeItem(On):Mn.push({fileInfo:Un,key:On})}}}catch(So){Xr.e(So)}finally{Xr.f()}if(Mn.length>jo.maxFileCache){var eo,ro,Do=oe(Co(eo=Wl(Mn).call(Mn,function(So,Io){return Io.fileInfo.modifyAt-So.fileInfo.modifyAt})).call(eo,jo.maxFileCache));try{for(Do.s();!(ro=Do.n()).done;){var go,Zo=ro.value;pa(go=Zo.key).call(go,"_NosUploader_")===0&&z.removeItem(Zo.key)}}catch(So){Do.e(So)}finally{Do.f()}}}},jt=Ve;function lr(jn){return(lr=typeof ga=="function"&&typeof cm=="symbol"?function(wr){return typeof wr}:function(wr){return wr&&typeof ga=="function"&&wr.constructor===ga&&wr!==ga.prototype?"symbol":typeof wr})(jn)}function fr(jn,wr){return!wr||lr(wr)!=="object"&&typeof wr!="function"?function(xn){if(xn===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return xn}(jn):wr}function Sr(jn){var wr=typeof nl=="function"?new nl:void 0;return(Sr=function(Nn){var Mn,Xr;if(Nn===null||(Xr=Nn,pa(Mn=Function.toString.call(Xr)).call(Mn,"[native code]")===-1))return Nn;if(typeof Nn!="function")throw new TypeError("Super expression must either be null or a function");if(wr!==void 0){if(wr.has(Nn))return wr.get(Nn);wr.set(Nn,On)}function On(){return br(Nn,arguments,$r(this).constructor)}return On.prototype=Ja(Nn.prototype,{constructor:{value:On,enumerable:!1,writable:!0,configurable:!0}}),Dr(On,Nn)})(jn)}function br(jn,wr,xn){return(br=Er()?rc:function(Nn,Mn,Xr){var On=[null];On.push.apply(On,Mn);var Un=new(Oo(Function).apply(Nn,On));return Xr&&Dr(Un,Xr.prototype),Un}).apply(null,arguments)}function Er(){if(typeof Reflect>"u"||!rc||rc.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(rc(Boolean,[],function(){})),!0}catch{return!1}}function Dr(jn,wr){return(Dr=Rs||function(xn,Nn){return xn.__proto__=Nn,xn})(jn,wr)}function $r(jn){return($r=Rs?Ds:function(wr){return wr.__proto__||Ds(wr)})(jn)}var vn=function(jn){(function(Xr,On){if(typeof On!="function"&&On!==null)throw new TypeError("Super expression must either be null or a function");Xr.prototype=Ja(On&&On.prototype,{constructor:{value:Xr,writable:!0,configurable:!0}}),On&&Dr(Xr,On)})(Mn,jn);var wr,xn,Nn=(wr=Mn,xn=Er(),function(){var Xr,On=$r(wr);if(xn){var Un=$r(this).constructor;Xr=rc(On,arguments,Un)}else Xr=On.apply(this,arguments);return fr(this,Xr)});function Mn(Xr,On){var Un;return function(eo,ro){if(!(eo instanceof ro))throw new TypeError("Cannot call a class as a function")}(this,Mn),(Un=Nn.call(this,"NosUploadError:"+Xr)).errCode=On,Un.errMsg=Xr,Un}return Mn}(Sr(Error)),Yr=function jn(wr,xn,Nn){if(wr.uploadState==="uploading"){var Mn=wr.config,Xr=wr.param,On=jt.getUploadContext(wr.fileKey);if(!On)return Nn(0);var Un=new XMLHttpRequest,eo=Mn.directUploadAddr+"/".concat(Xr.bucketName)+"/".concat(encodeURIComponent(Xr.objectName))+"?uploadContext"+"&context=".concat(On)+"&version=".concat(Mn.version);Un.onreadystatechange=function(){var ro;if(wr.uploadState!=="abort"&&Un.readyState===4){var Do,go,Zo,So;try{So=JSON.parse(Un.responseText)}catch{So={errMsg:"JsonParseError in getOffset",errCode:500}}Un.status===200?So.errCode?wr.config.onError(new vn(So.errMsg,So.errCode)):Nn(So.offset):Un.status.toString().match(/^5/)?jn(wr,xn-1,Nn):xn>0?(typeof((ro=Mn.logger)===null||ro===void 0?void 0:ro.error)=="function"&&Mn.logger.error(Vs(Do="getOffset(".concat(eo,") error. retry after 3 seconds. ")).call(Do,new Date().toTimeString())),sa(function(){jn(wr,xn-1,Nn)},3500)):(jt.removeFileInfo(wr.fileKey),Un.status?Mn.onError(new vn(Vs(go=Vs(Zo="getOffset(".concat(eo,") error: ")).call(Zo,Un.status," ")).call(go,Un.statusText))):Mn.onError(new vn("getOffset(".concat(eo,") error. no Error Code"))))}},Un.open("get",eo),Un.setRequestHeader("x-nos-token",Xr.token),Un.timeout=Mn.getOffsetTimeout,Un.send()}},wn=function jn(wr,xn,Nn,Mn){if(wr.uploadState==="uploading"){var Xr=wr.param,On=wr.config,Un=Co(File.prototype),eo=Xr.ctx!==void 0?Xr.ctx:"",ro=xn+On.trunkSize>wr.file.size,Do=ro?wr.file.size:xn+On.trunkSize,go=new XMLHttpRequest,Zo=On.directUploadAddr+"/".concat(Xr.bucketName)+"/".concat(encodeURIComponent(Xr.objectName));if(go.upload.onprogress=function(Io){if(wr.uploadState!=="abort"){var ea=0;Io.lengthComputable?(ea=(xn+Io.loaded)/wr.file.size,On.onProgress(ea),On.onUploadProgress({loaded:Io.loaded,total:wr.file.size,percentage:ea,percentageText:(100*ea).toFixed(2)+"%"})):On.onError(new vn("browser does not support query upload progress"))}},go.onreadystatechange=function(){var Io,ea;if(wr.uploadState!=="abort"&&go.readyState===4){var Mi,Eo,ki,$a;try{$a=JSON.parse(go.responseText)}catch(po){typeof((Io=On.logger)===null||Io===void 0?void 0:Io.error)=="function"&&On.logger.error("JsonParseError in uploadTrunk",po),$a={errMsg:"JsonParseError in uploadTrunk"}}go.status===200?(wr.setContext($a.context),ro?(Mn(),wr.setComplete()):jn(wr,$a.offset,On.retryCount,Mn)):go.status.toString().match(/^5/)?Nn>0?jn(wr,xn,Nn-1,Mn):(jt.removeFileInfo(wr.fileKey),On.onError(new vn($a.errMsg,$a.errCode))):Nn>0?(typeof((ea=On.logger)===null||ea===void 0?void 0:ea.error)=="function"&&On.logger.error(Vs(Mi="uploadTrunk(".concat(Zo,") error. retry after 3 seconds. ")).call(Mi,new Date().toTimeString())),sa(function(){jn(wr,xn,Nn-1,Mn)},3500)):(jt.removeFileInfo(wr.fileKey),go.status?On.onError(new vn(Vs(Eo=Vs(ki="uploadTrunk(".concat(Zo,") error: ")).call(ki,go.status," ")).call(Eo,go.statusText))):On.onError(new vn("uploadTrunk(".concat(Zo,") error. no Error Code. Please check your network"))))}},go.open("post",Zo+"?offset=".concat(xn)+"&complete=".concat(ro)+"&context=".concat(eo)+"&version=".concat(On.version)),go.setRequestHeader("x-nos-token",Xr.token),wr.file.type&&go.setRequestHeader("content-type",wr.file.type),go.timeout=On.trunkUploadTimeout,typeof FileReader<"u"){var So=new FileReader;So.addEventListener("load",function(Io){var ea;!((ea=Io==null?void 0:Io.target)===null||ea===void 0)&&ea.result?go.send(Io.target.result):On.onError(new vn("Read ArrayBuffer failed"))}),So.addEventListener("error",function(Io){var ea=Io.target.error;On.onError(new vn("Read ArrayBuffer error. ".concat(ea.toString()),ea.code))}),So.readAsArrayBuffer(Un.call(wr.file,xn,Do))}else go.send(Un.call(wr.file,xn,Do))}};function Zr(jn,wr){for(var xn=0;xn<wr.length;xn++){var Nn=wr[xn];Nn.enumerable=Nn.enumerable||!1,Nn.configurable=!0,"value"in Nn&&(Nn.writable=!0),Wi(jn,Nn.key,Nn)}}var Qn=function(){function jn(xn,Nn,Mn){(function(Xr,On){if(!(Xr instanceof On))throw new TypeError("Cannot call a class as a function")})(this,jn),this.uploadState="paused",this.config=Mn,this.file=xn,this.param=Nn,this.fileKey=jt.initFile(Nn,xn,this.config.enableCache),this.resume()}var wr;return(wr=[{key:"resume",value:function(){var Nn=this;if(this.uploadState!=="uploading"){this.setUploadState("uploading");var Mn=this.config;Yr(this,Mn.retryCount,function(Xr){wn(Nn,Xr,Mn.retryCount,function(){Nn.setUploadState("ended"),typeof Mn.onComplete=="function"&&Mn.onComplete(Nn.param)})})}}},{key:"pause",value:function(){this.setUploadState("paused")}},{key:"abort",value:function(){this.setUploadState("abort"),jt.removeFileInfo(this.fileKey),this.config.onError(new vn("Upload Aborted",10499))}},{key:"setUploadState",value:function(Nn){Nn!==this.uploadState&&(this.uploadState=Nn)}},{key:"setContext",value:function(Nn){jt.setUploadContext(this.fileKey,Nn,this.config.enableCache),this.param.ctx=Nn}},{key:"setComplete",value:function(){jt.setComplete(this.fileKey,this.config.enableCache),this.setUploadState("ended")}}])&&Zr(jn.prototype,wr),jn}(),Dn={maxFileCache:6,expireTime:864e5,getFileUploadInformation:function(wr){var xn=jt.getFileKey(wr),Nn=jt.getFileInfo(xn);return Nn===null?null:ts()-Nn.modifyAt>Dn.expireTime?(jt.removeFileInfo(xn),null):{uploadInfo:Tn({bucketName:Nn.bucket,objectName:Nn.obj,token:Nn.token,ctx:Nn.ctx},Nn.payload?{payload:Nn.payload}:{}),complete:Nn.end}},setMaxFileCache:function(wr){Dn.maxFileCache=wr},setExpireTime:function(wr){Dn.expireTime=wr},printCaches:function(){for(var wr=0,xn=na(localStorage);wr<xn.length;wr++){var Nn=xn[wr],Mn=jt.getFileInfo(Nn);Mn&&console.log(Mn,"modifiedAt",new Date(Mn.modifyAt).toTimeString())}},createConfig:function(wr){return new A(wr)},createTask:function(wr,xn,Nn){return new Qn(wr,xn,Nn)}},jo=Dn;return F.default}()}),Cl=o(function(S,x){S.exports=function(){function V(xe){if(xe){var z,Ve="";return In(z=na(xe)).call(z,function(jt,lr){Ve+=lr===0?"?":"&",Ve+=jt+"="+xe[jt]}),Ve}return""}function F(xe,z,Ve,jt){return Error.call(this,Ve),this.source=xe,this.code=z,this.desc=Ve,this.detail=jt||{},this}function A(xe,z){var Ve=Ja(z.prototype);Ve.constructor=xe,xe.prototype=Ve}function oe(xe,z){z===void 0&&(z={dataType:"json",method:"GET",timeout:5e3});var Ve=z.dataType==="text"?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",jt=z.method==="GET"?V(z.params):"";return new uo(function(lr,fr){if(window.XMLHttpRequest){var Sr,br=new XMLHttpRequest;if(br.onreadystatechange=function(){if(br.readyState===4)if(br.status===200){try{Sr=JSON.parse(br.response||"{}")}catch{Sr=br.response}lr({status:br.status,data:Sr})}else fr(new F(1,br.status,br.statusText))},br.open(z.method,""+xe+jt),br.timeout=z.timeout||5e3,br.setRequestHeader("Content-Type",Ve),z.headers)for(var Er in z.headers)br.setRequestHeader(Er,z.headers[Er]);br.ontimeout=function(Dr){fr(new F(1,408,Dr&&Dr.message?Dr.message:"request timeout"))},br.send(mo(z.data))}else fr(new F(2,10400,"request no suppout"))})}return A(F,Error),oe}()}),tu=console,MC={setLogger:function(x){tu=x},platform:"BROWSER",localStorage:window.localStorage,request:Cl,WebSocket:window.WebSocket,uploadFile:function(x){return Mr(this,void 0,void 0,ar.mark(function V(){var F,A,oe,xe,z,Ve;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:if(x.fileInput||x.file){lr.next=2;break}throw new Error("File not exist");case 2:if(!x.file){lr.next=6;break}xe=x.file,lr.next=20;break;case 6:if(typeof x.fileInput!="string"){lr.next=15;break}if(!((z=document.getElementById(x.fileInput))&&z.files&&z.files[0])){lr.next=12;break}xe=z.files[0],lr.next=13;break;case 12:throw new Error("Can not get file from fileInput");case 13:lr.next=20;break;case 15:if(!(x.fileInput&&x.fileInput.files&&x.fileInput.files[0])){lr.next=19;break}xe=x.fileInput.files[0],lr.next=20;break;case 19:throw new Error("Can not get file from fileInput "+x.fileInput);case 20:if(!(x.maxSize&&xe.size>x.maxSize)){lr.next=22;break}throw new Error("The file exceeds maxSize limit. maxSize: "+x.maxSize+", get "+xe.size);case 22:return lr.next=24,new uo(function(fr,Sr){var br=Gy.createConfig({enableCache:!1,directUploadAddr:x.chunkUploadHost,onError:function($r){Sr($r)},onProgress:x.onUploadProgress||function(){},onComplete:function($r){fr($r)}}),Er=Gy.createTask(xe,{bucketName:x.nosToken.bucket,objectName:decodeURIComponent(x.nosToken.objectName),token:x.nosToken.token},br);try{x.onUploadStart&&x.onUploadStart(Er)}catch(Dr){tu.error("Adapter uploadFile: options.onUploadStart error",Dr&&Dr.message),Er.abort(),Sr(Dr)}});case 24:return(Ve=lr.sent).name=xe.name,Ve.size=xe.size,Ve.type=xe.type,Ve.ext=Wy(F=Ve.name).call(F,".")>-1?Co(A=Ve.name).call(A,Wy(oe=Ve.name).call(oe,".")+1).toLowerCase():"",lr.abrupt("return",Ve);case 30:case"end":return lr.stop()}},V)}))},getSystemInfo:function(){var x,V;return{os:((x=Rc.os)===null||x===void 0?void 0:x.family)||"",osVer:((V=Rc.os)===null||V===void 0?void 0:V.version)||"",browser:Rc.name||"",browserVer:Rc.version||"",hostEnv:"BROWSER",hostEnvVer:Rc.version||"",hostInfo:Rc.ua||""}}};return zd.setAdapters(MC),zd})})(QCHAT_BROWSER_SDK);var QCHAT_BROWSER_SDKExports=QCHAT_BROWSER_SDK.exports;const QChatSDK=getDefaultExportFromCjs(QCHAT_BROWSER_SDKExports);var NIM_BROWSER_SDK={exports:{}};(function(t,r){(function(e,n){t.exports=n()})(commonjsGlobal,function(){var e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{};function n(w){return w&&w.__esModule&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w}function o(w){var M={exports:{}};return w(M,M.exports),M.exports}var s,a,i=n(o(function(w){w.exports=function(L){if(L===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L},w.exports.__esModule=!0,w.exports.default=w.exports})),u=function(w){return w&&w.Math==Math&&w},d=u(typeof globalThis=="object"&&globalThis)||u(typeof window=="object"&&window)||u(typeof self=="object"&&self)||u(typeof e=="object"&&e)||function(){return this}()||Function("return this")(),c=function(w){try{return!!w()}catch{return!0}},m=!c(function(){var w=(function(){}).bind();return typeof w!="function"||w.hasOwnProperty("prototype")}),v=Function.prototype,g=v.apply,b=v.call,T=typeof Reflect=="object"&&Reflect.apply||(m?b.bind(g):function(){return b.apply(g,arguments)}),k=Function.prototype,y=k.bind,O=k.call,D=m&&y.bind(O,O),he=m?function(w){return w&&D(w)}:function(w){return w&&function(){return O.apply(w,arguments)}},ae=function(w){return typeof w=="function"},Ne=!c(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),ue=Function.prototype.call,Y=m?ue.bind(ue):function(){return ue.apply(ue,arguments)},_e={}.propertyIsEnumerable,Ce=Object.getOwnPropertyDescriptor,ze={f:Ce&&!_e.call({1:2},1)?function(M){var L=Ce(this,M);return!!L&&L.enumerable}:_e},ie=function(w,M){return{enumerable:!(1&w),configurable:!(2&w),writable:!(4&w),value:M}},le=he({}.toString),Ie=he("".slice),pe=function(w){return Ie(le(w),8,-1)},qe=Object,$e=he("".split),Lt=c(function(){return!qe("z").propertyIsEnumerable(0)})?function(w){return pe(w)=="String"?$e(w,""):qe(w)}:qe,Dt=function(w){return w==null},dr=TypeError,pr=function(w){if(Dt(w))throw dr("Can't call method on "+w);return w},sr=function(w){return Lt(pr(w))},hr=typeof document=="object"&&document.all,Fe=hr===void 0&&hr!==void 0?function(w){return typeof w=="object"?w!==null:ae(w)||w===hr}:function(w){return typeof w=="object"?w!==null:ae(w)},nr={},ir=function(w){return ae(w)?w:void 0},Ue=function(w,M){return arguments.length<2?ir(nr[w])||ir(d[w]):nr[w]&&nr[w][M]||d[w]&&d[w][M]},rr=he({}.isPrototypeOf),or=Ue("navigator","userAgent")||"",Pt=d.process,Et=d.Deno,kt=Pt&&Pt.versions||Et&&Et.version,er=kt&&kt.v8;er&&(a=(s=er.split("."))[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&or&&(!(s=or.match(/Edge\/(\d+)/))||s[1]>=74)&&(s=or.match(/Chrome\/(\d+)/))&&(a=+s[1]);var cr,mr=a,vr=!!Object.getOwnPropertySymbols&&!c(function(){var w=Symbol();return!String(w)||!(Object(w)instanceof Symbol)||!Symbol.sham&&mr&&mr<41}),Tr=vr&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Ir=Object,kr=Tr?function(w){return typeof w=="symbol"}:function(w){var M=Ue("Symbol");return ae(M)&&rr(M.prototype,Ir(w))},Ar=String,Rr=function(w){try{return Ar(w)}catch{return"Object"}},Cn=TypeError,Or=function(w){if(ae(w))return w;throw Cn(Rr(w)+" is not a function")},Pr=function(w,M){var L=w[M];return Dt(L)?void 0:Or(L)},Nr=TypeError,Qr=Object.defineProperty,hn="__core-js_shared__",Ur=d[hn]||function(w,M){try{Qr(d,w,{value:M,configurable:!0,writable:!0})}catch{d[w]=M}return M}(hn,{}),qr=o(function(w){(w.exports=function(M,L){return Ur[M]||(Ur[M]=L!==void 0?L:{})})("versions",[]).push({version:"3.25.0",mode:"pure",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),Gn=Object,$n=function(w){return Gn(pr(w))},Jr=he({}.hasOwnProperty),Lr=Object.hasOwn||function(M,L){return Jr($n(M),L)},Kn=0,vo=Math.random(),bo=he(1 .toString),so=function(w){return"Symbol("+(w===void 0?"":w)+")_"+bo(++Kn+vo,36)},co=qr("wks"),No=d.Symbol,An=No&&No.for,Aa=Tr?No:No&&No.withoutSetter||so,to=function(w){if(!Lr(co,w)||!vr&&typeof co[w]!="string"){var M="Symbol."+w;vr&&Lr(No,w)?co[w]=No[w]:co[w]=Tr&&An?An(M):Aa(M)}return co[w]},Br=TypeError,Gr=to("toPrimitive"),Bn=function(w,M){if(!Fe(w)||kr(w))return w;var L,$=Pr(w,Gr);if($){if(M===void 0&&(M="default"),L=Y($,w,M),!Fe(L)||kr(L))return L;throw Br("Can't convert object to primitive value")}return M===void 0&&(M="number"),function(_,re){var Oe,de;if(re==="string"&&ae(Oe=_.toString)&&!Fe(de=Y(Oe,_))||ae(Oe=_.valueOf)&&!Fe(de=Y(Oe,_))||re!=="string"&&ae(Oe=_.toString)&&!Fe(de=Y(Oe,_)))return de;throw Nr("Can't convert object to primitive value")}(w,M)},Xn=function(w){var M=Bn(w,"string");return kr(M)?M:M+""},_o=d.document,oo=Fe(_o)&&Fe(_o.createElement),Ca=function(w){return oo?_o.createElement(w):{}},is=!Ne&&!c(function(){return Object.defineProperty(Ca("div"),"a",{get:function(){return 7}}).a!=7}),cs=Object.getOwnPropertyDescriptor,Es={f:Ne?cs:function(M,L){if(M=sr(M),L=Xn(L),is)try{return cs(M,L)}catch{}if(Lr(M,L))return ie(!Y(ze.f,M,L),M[L])}},Wh=/#|\.prototype\./,xa=function(w,M){var L=Zy[Li(w)];return L==tb||L!=eb&&(ae(M)?c(M):!!M)},Li=xa.normalize=function(w){return String(w).replace(Wh,".").toLowerCase()},Zy=xa.data={},eb=xa.NATIVE="N",tb=xa.POLYFILL="P",af=xa,rb=he(he.bind),$o=function(w,M){return Or(w),M===void 0?w:m?rb(w,M):function(){return w.apply(M,arguments)}},sf=Ne&&c(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),nb=String,ob=TypeError,Vn=function(w){if(Fe(w))return w;throw ob(nb(w)+" is not an object")},ab=TypeError,ru=Object.defineProperty,sb=Object.getOwnPropertyDescriptor,ib="enumerable",cb="configurable",lb="writable",ua={f:Ne?sf?function(M,L,$){if(Vn(M),L=Xn(L),Vn($),typeof M=="function"&&L==="prototype"&&"value"in $&&lb in $&&!$.writable){var _=sb(M,L);_&&_.writable&&(M[L]=$.value,$={configurable:cb in $?$.configurable:_.configurable,enumerable:ib in $?$.enumerable:_.enumerable,writable:!1})}return ru(M,L,$)}:ru:function(M,L,$){if(Vn(M),L=Xn(L),Vn($),is)try{return ru(M,L,$)}catch{}if("get"in $||"set"in $)throw ab("Accessors not supported");return"value"in $&&(M[L]=$.value),M}},Jo=Ne?function(w,M,L){return ua.f(w,M,ie(1,L))}:function(w,M,L){return w[M]=L,w},ub=Es.f,db=function(w){var M=function(L,$,_){if(this instanceof M){switch(arguments.length){case 0:return new w;case 1:return new w(L);case 2:return new w(L,$)}return new w(L,$,_)}return T(w,this,arguments)};return M.prototype=w.prototype,M},Vr=function(w,M){var L,$,_,re,Oe,de,At,tr,ur=w.target,gr=w.global,yr=w.stat,Cr=w.proto,xr=gr?d:yr?d[ur]:(d[ur]||{}).prototype,Fr=gr?nr:nr[ur]||Jo(nr,ur,{})[ur],jr=Fr.prototype;for(_ in M)L=!af(gr?_:ur+(yr?".":"#")+_,w.forced)&&xr&&Lr(xr,_),Oe=Fr[_],L&&(de=w.dontCallGetSet?(tr=ub(xr,_))&&tr.value:xr[_]),re=L&&de?de:M[_],L&&typeof Oe==typeof re||(At=w.bind&&L?$o(re,d):w.wrap&&L?db(re):Cr&&ae(re)?he(re):re,(w.sham||re&&re.sham||Oe&&Oe.sham)&&Jo(At,"sham",!0),Jo(Fr,_,At),Cr&&(Lr(nr,$=ur+"Prototype")||Jo(nr,$,{}),Jo(nr[$],_,re),w.real&&jr&&!jr[_]&&Jo(jr,_,re)))},pb=Math.ceil,fb=Math.floor,mb=Math.trunc||function(M){var L=+M;return(L>0?fb:pb)(L)},$i=function(w){var M=+w;return M!=M||M===0?0:mb(M)},gb=Math.max,hb=Math.min,ni=function(w,M){var L=$i(w);return L<0?gb(L+M,0):hb(L,M)},vb=Math.min,Ia=function(w){return(M=w.length)>0?vb($i(M),9007199254740991):0;var M},cf=function(w){return function(M,L,$){var _,re=sr(M),Oe=Ia(re),de=ni($,Oe);if(w&&L!=L){for(;Oe>de;)if((_=re[de++])!=_)return!0}else for(;Oe>de;de++)if((w||de in re)&&re[de]===L)return w||de||0;return!w&&-1}},nu={includes:cf(!0),indexOf:cf(!1)},oi={},yb=nu.indexOf,lf=he([].push),uf=function(w,M){var L,$=sr(w),_=0,re=[];for(L in $)!Lr(oi,L)&&Lr($,L)&&lf(re,L);for(;M.length>_;)Lr($,L=M[_++])&&(~yb(re,L)||lf(re,L));return re},$c=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],gs=Object.keys||function(M){return uf(M,$c)},bb=Ne&&!sf?Object.defineProperties:function(M,L){Vn(M);for(var $,_=sr(L),re=gs(L),Oe=re.length,de=0;Oe>de;)ua.f(M,$=re[de++],_[$]);return M},df={f:bb},ou=Ue("document","documentElement"),pf=qr("keys"),jc=function(w){return pf[w]||(pf[w]=so(w))},ff=jc("IE_PROTO"),au=function(){},mf=function(w){return"<script>"+w+"<\/script>"},gf=function(w){w.write(mf("")),w.close();var M=w.parentWindow.Object;return w=null,M},Dc=function(){try{cr=new ActiveXObject("htmlfile")}catch{}var w,M;Dc=typeof document<"u"?document.domain&&cr?gf(cr):((M=Ca("iframe")).style.display="none",ou.appendChild(M),M.src="javascript:",(w=M.contentWindow.document).open(),w.write(mf("document.F=Object")),w.close(),w.F):gf(cr);for(var L=$c.length;L--;)delete Dc.prototype[$c[L]];return Dc()};oi[ff]=!0;var Ea=Object.create||function(M,L){var $;return M!==null?(au.prototype=Vn(M),$=new au,au.prototype=null,$[ff]=M):$=Dc(),L===void 0?$:df.f($,L)};Vr({target:"Object",stat:!0,sham:!Ne},{create:Ea});var Tb=nr.Object,Ja=function(M,L){return Tb.create(M,L)},Sb=String,Cb=TypeError,ji=Object.setPrototypeOf||("__proto__"in{}?function(){var w,M=!1,L={};try{(w=he(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(L,[]),M=L instanceof Array}catch{}return function(_,re){return Vn(_),function(Oe){if(typeof Oe=="object"||ae(Oe))return Oe;throw Cb("Can't set "+Sb(Oe)+" as a prototype")}(re),M?w(_,re):_.__proto__=re,_}}():void 0);Vr({target:"Object",stat:!0},{setPrototypeOf:ji});var Rs=nr.Object.setPrototypeOf,hs=he([].slice),hf=Function,Mb=he([].concat),kb=he([].join),su={},_b=function(w,M,L){if(!Lr(su,M)){for(var $=[],_=0;_<M;_++)$[_]="a["+_+"]";su[M]=hf("C,a","return new C("+kb($,",")+")")}return su[M](w,L)},iu=m?hf.bind:function(M){var L=Or(this),$=L.prototype,_=hs(arguments,1),re=function(){var de=Mb(_,hs(arguments));return this instanceof re?_b(L,de.length,de):L.apply(M,de)};return Fe($)&&(re.prototype=$),re};Vr({target:"Function",proto:!0,forced:Function.bind!==iu},{bind:iu});var Uo=function(w){return nr[w+"Prototype"]},wb=Uo("Function").bind,cu=Function.prototype,Oo=function(w){var M=w.bind;return w===cu||rr(cu,w)&&M===cu.bind?wb:M},lu=o(function(w){function M(L,$){var _;return w.exports=M=Rs?Oo(_=Rs).call(_):function(Oe,de){return Oe.__proto__=de,Oe},w.exports.__esModule=!0,w.exports.default=w.exports,M(L,$)}w.exports=M,w.exports.__esModule=!0,w.exports.default=w.exports}),Ro=n(o(function(w){w.exports=function(L,$){L.prototype=Ja($.prototype),L.prototype.constructor=L,lu(L,$)},w.exports.__esModule=!0,w.exports.default=w.exports})),Ya=Array.isArray||function(M){return pe(M)=="Array"},xb=TypeError,uu=function(w){if(w>9007199254740991)throw xb("Maximum allowed index exceeded");return w},Bs=function(w,M,L){var $=Xn(M);$ in w?ua.f(w,$,ie(0,L)):w[$]=L},vf={};vf[to("toStringTag")]="z";var du=String(vf)==="[object z]",Ib=to("toStringTag"),Eb=Object,Pb=pe(function(){return arguments}())=="Arguments",Fs=du?pe:function(w){var M,L,$;return w===void 0?"Undefined":w===null?"Null":typeof(L=function(_,re){try{return _[re]}catch{}}(M=Eb(w),Ib))=="string"?L:Pb?pe(M):($=pe(M))=="Object"&&ae(M.callee)?"Arguments":$},Ab=he(Function.toString);ae(Ur.inspectSource)||(Ur.inspectSource=function(w){return Ab(w)});var yf=Ur.inspectSource,bf=function(){},Ob=[],Tf=Ue("Reflect","construct"),pu=/^\s*(?:class|function)\b/,Nb=he(pu.exec),Rb=!pu.exec(bf),Di=function(M){if(!ae(M))return!1;try{return Tf(bf,Ob,M),!0}catch{return!1}},Sf=function(M){if(!ae(M))return!1;switch(Fs(M)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Rb||!!Nb(pu,yf(M))}catch{return!0}};Sf.sham=!0;var Uc=!Tf||c(function(){var w;return Di(Di.call)||!Di(Object)||!Di(function(){w=!0})||w})?Sf:Di,Bb=to("species"),Cf=Array,fu=function(w,M){return new(function(L){var $;return Ya(L)&&($=L.constructor,(Uc($)&&($===Cf||Ya($.prototype))||Fe($)&&($=$[Bb])===null)&&($=void 0)),$===void 0?Cf:$}(w))(M===0?0:M)},Fb=to("species"),Ui=function(w){return mr>=51||!c(function(){var M=[];return(M.constructor={})[Fb]=function(){return{foo:1}},M[w](Boolean).foo!==1})},Mf=to("isConcatSpreadable"),Lb=mr>=51||!c(function(){var w=[];return w[Mf]=!1,w.concat()[0]!==w}),$b=Ui("concat"),jb=function(w){if(!Fe(w))return!1;var M=w[Mf];return M!==void 0?!!M:Ya(w)};Vr({target:"Array",proto:!0,arity:1,forced:!Lb||!$b},{concat:function(M){var L,$,_,re,Oe,de=$n(this),At=fu(de,0),tr=0;for(L=-1,_=arguments.length;L<_;L++)if(jb(Oe=L===-1?de:arguments[L]))for(re=Ia(Oe),uu(tr+re),$=0;$<re;$++,tr++)$ in Oe&&Bs(At,tr,Oe[$]);else uu(tr+1),Bs(At,tr++,Oe);return At.length=tr,At}});var qc,qi,Vc,Db=String,Oa=function(w){if(Fs(w)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Db(w)},Ub=$c.concat("length","prototype"),Vi={f:Object.getOwnPropertyNames||function(M){return uf(M,Ub)}},qb=Array,Vb=Math.max,mu=function(w,M,L){for(var $=Ia(w),_=ni(M,$),re=ni(L===void 0?$:L,$),Oe=qb(Vb(re-_,0)),de=0;_<re;_++,de++)Bs(Oe,de,w[_]);return Oe.length=de,Oe},kf=Vi.f,_f=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],gu={f:function(M){return _f&&pe(M)=="Window"?function(L){try{return kf(L)}catch{return mu(_f)}}(M):kf(sr(M))}},Hi={f:Object.getOwnPropertySymbols},vs=function(w,M,L,$){return $&&$.enumerable?w[M]=L:Jo(w,M,L),w},hu={f:to},Hb=ua.f,wo=function(w){var M=nr.Symbol||(nr.Symbol={});Lr(M,w)||Hb(M,w,{value:hu.f(w)})},wf=function(){var w=Ue("Symbol"),M=w&&w.prototype,L=M&&M.valueOf,$=to("toPrimitive");M&&!M[$]&&vs(M,$,function(_){return Y(L,this)},{arity:1})},zb=du?{}.toString:function(){return"[object "+Fs(this)+"]"},Kb=ua.f,xf=to("toStringTag"),Ls=function(w,M,L,$){if(w){var _=L?w:w.prototype;Lr(_,xf)||Kb(_,xf,{configurable:!0,value:M}),$&&!du&&Jo(_,"toString",zb)}},If=d.WeakMap,Wb=ae(If)&&/native code/.test(String(If)),Ef="Object already initialized",vu=d.TypeError,Gb=d.WeakMap;if(Wb||Ur.state){var $s=Ur.state||(Ur.state=new Gb),Qb=he($s.get),Pf=he($s.has),Jb=he($s.set);qc=function(w,M){if(Pf($s,w))throw vu(Ef);return M.facade=w,Jb($s,w,M),M},qi=function(w){return Qb($s,w)||{}},Vc=function(w){return Pf($s,w)}}else{var ai=jc("state");oi[ai]=!0,qc=function(w,M){if(Lr(w,ai))throw vu(Ef);return M.facade=w,Jo(w,ai,M),M},qi=function(w){return Lr(w,ai)?w[ai]:{}},Vc=function(w){return Lr(w,ai)}}var Pa={set:qc,get:qi,has:Vc,enforce:function(w){return Vc(w)?qi(w):qc(w,{})},getterFor:function(w){return function(M){var L;if(!Fe(M)||(L=qi(M)).type!==w)throw vu("Incompatible receiver, "+w+" required");return L}}},Af=he([].push),ys=function(w){var M=w==1,L=w==2,$=w==3,_=w==4,re=w==6,Oe=w==7,de=w==5||re;return function(At,tr,ur,gr){for(var yr,Cr,xr=$n(At),Fr=Lt(xr),jr=$o(tr,ur),zr=Ia(Fr),Hr=0,Kr=gr||fu,kn=M?Kr(At,zr):L||Oe?Kr(At,0):void 0;zr>Hr;Hr++)if((de||Hr in Fr)&&(Cr=jr(yr=Fr[Hr],Hr,xr),w))if(M)kn[Hr]=Cr;else if(Cr)switch(w){case 3:return!0;case 5:return yr;case 6:return Hr;case 2:Af(kn,yr)}else switch(w){case 4:return!1;case 7:Af(kn,yr)}return re?-1:$||_?_:kn}},bs={forEach:ys(0),map:ys(1),filter:ys(2),some:ys(3),every:ys(4),find:ys(5),findIndex:ys(6),filterReject:ys(7)},Hc=bs.forEach,da=jc("hidden"),zc="Symbol",Yb=Pa.set,Of=Pa.getterFor(zc),Ba=Object.prototype,js=d.Symbol,zi=js&&js.prototype,Xb=d.TypeError,yu=d.QObject,Nf=Es.f,Ts=ua.f,Rf=gu.f,Zb=ze.f,Bf=he([].push),Xa=qr("symbols"),Ki=qr("op-symbols"),e0=qr("wks"),bu=!yu||!yu.prototype||!yu.prototype.findChild,Tu=Ne&&c(function(){return Ea(Ts({},"a",{get:function(){return Ts(this,"a",{value:7}).a}})).a!=7})?function(w,M,L){var $=Nf(Ba,M);$&&delete Ba[M],Ts(w,M,L),$&&w!==Ba&&Ts(Ba,M,$)}:Ts,Su=function(w,M){var L=Xa[w]=Ea(zi);return Yb(L,{type:zc,tag:w,description:M}),Ne||(L.description=M),L},Kc=function(M,L,$){M===Ba&&Kc(Ki,L,$),Vn(M);var _=Xn(L);return Vn($),Lr(Xa,_)?($.enumerable?(Lr(M,da)&&M[da][_]&&(M[da][_]=!1),$=Ea($,{enumerable:ie(0,!1)})):(Lr(M,da)||Ts(M,da,ie(1,{})),M[da][_]=!0),Tu(M,_,$)):Ts(M,_,$)},Cu=function(M,L){Vn(M);var $=sr(L),_=gs($).concat(jf($));return Hc(_,function(re){Ne&&!Y(Ff,$,re)||Kc(M,re,$[re])}),M},Ff=function(M){var L=Xn(M),$=Y(Zb,this,L);return!(this===Ba&&Lr(Xa,L)&&!Lr(Ki,L))&&(!($||!Lr(this,L)||!Lr(Xa,L)||Lr(this,da)&&this[da][L])||$)},Lf=function(M,L){var $=sr(M),_=Xn(L);if($!==Ba||!Lr(Xa,_)||Lr(Ki,_)){var re=Nf($,_);return!re||!Lr(Xa,_)||Lr($,da)&&$[da][_]||(re.enumerable=!0),re}},$f=function(M){var L=Rf(sr(M)),$=[];return Hc(L,function(_){Lr(Xa,_)||Lr(oi,_)||Bf($,_)}),$},jf=function(w){var M=w===Ba,L=Rf(M?Ki:sr(w)),$=[];return Hc(L,function(_){!Lr(Xa,_)||M&&!Lr(Ba,_)||Bf($,Xa[_])}),$};vr||(js=function(){if(rr(zi,this))throw Xb("Symbol is not a constructor");var M=arguments.length&&arguments[0]!==void 0?Oa(arguments[0]):void 0,L=so(M),$=function(_){this===Ba&&Y($,Ki,_),Lr(this,da)&&Lr(this[da],L)&&(this[da][L]=!1),Tu(this,L,ie(1,_))};return Ne&&bu&&Tu(Ba,L,{configurable:!0,set:$}),Su(L,M)},zi=js.prototype,vs(zi,"toString",function(){return Of(this).tag}),vs(js,"withoutSetter",function(w){return Su(so(w),w)}),ze.f=Ff,ua.f=Kc,df.f=Cu,Es.f=Lf,Vi.f=gu.f=$f,Hi.f=jf,hu.f=function(w){return Su(to(w),w)},Ne&&Ts(zi,"description",{configurable:!0,get:function(){return Of(this).description}})),Vr({global:!0,constructor:!0,wrap:!0,forced:!vr,sham:!vr},{Symbol:js}),Hc(gs(e0),function(w){wo(w)}),Vr({target:zc,stat:!0,forced:!vr},{useSetter:function(){bu=!0},useSimple:function(){bu=!1}}),Vr({target:"Object",stat:!0,forced:!vr,sham:!Ne},{create:function(M,L){return L===void 0?Ea(M):Cu(Ea(M),L)},defineProperty:Kc,defineProperties:Cu,getOwnPropertyDescriptor:Lf}),Vr({target:"Object",stat:!0,forced:!vr},{getOwnPropertyNames:$f}),wf(),Ls(js,zc),oi[da]=!0;var Df=vr&&!!Symbol.for&&!!Symbol.keyFor,Mu=qr("string-to-symbol-registry"),t0=qr("symbol-to-string-registry");Vr({target:"Symbol",stat:!0,forced:!Df},{for:function(w){var M=Oa(w);if(Lr(Mu,M))return Mu[M];var L=Ue("Symbol")(M);return Mu[M]=L,t0[L]=M,L}});var Uf=qr("symbol-to-string-registry");Vr({target:"Symbol",stat:!0,forced:!Df},{keyFor:function(M){if(!kr(M))throw TypeError(Rr(M)+" is not a symbol");if(Lr(Uf,M))return Uf[M]}});var Ss=Ue("JSON","stringify"),Wc=he(/./.exec),qf=he("".charAt),r0=he("".charCodeAt),n0=he("".replace),o0=he(1 .toString),a0=/[\uD800-\uDFFF]/g,Vf=/^[\uD800-\uDBFF]$/,Hf=/^[\uDC00-\uDFFF]$/,zf=!vr||c(function(){var w=Ue("Symbol")();return Ss([w])!="[null]"||Ss({a:w})!="{}"||Ss(Object(w))!="{}"}),Kf=c(function(){return Ss("\uDF06\uD834")!=='"\\udf06\\ud834"'||Ss("\uDEAD")!=='"\\udead"'}),s0=function(w,M){var L=hs(arguments),$=M;if((Fe(M)||w!==void 0)&&!kr(w))return Ya(M)||(M=function(_,re){if(ae($)&&(re=Y($,this,_,re)),!kr(re))return re}),L[1]=M,T(Ss,null,L)},i0=function(w,M,L){var $=qf(L,M-1),_=qf(L,M+1);return Wc(Vf,w)&&!Wc(Hf,_)||Wc(Hf,w)&&!Wc(Vf,$)?"\\u"+o0(r0(w,0),16):w};Ss&&Vr({target:"JSON",stat:!0,arity:3,forced:zf||Kf},{stringify:function(M,L,$){var _=hs(arguments),re=T(zf?s0:Ss,null,_);return Kf&&typeof re=="string"?n0(re,a0,i0):re}});var c0=!vr||c(function(){Hi.f(1)});Vr({target:"Object",stat:!0,forced:c0},{getOwnPropertySymbols:function(M){var L=Hi.f;return L?L($n(M)):[]}}),wo("asyncIterator"),wo("hasInstance"),wo("isConcatSpreadable"),wo("iterator"),wo("match"),wo("matchAll"),wo("replace"),wo("search"),wo("species"),wo("split"),wo("toPrimitive"),wf(),wo("toStringTag"),Ls(Ue("Symbol"),"Symbol"),wo("unscopables"),Ls(d.JSON,"JSON",!0);var Cs,Wf,Gf,l0=nr.Symbol,Za={},Qf=Function.prototype,u0=Ne&&Object.getOwnPropertyDescriptor,ku=Lr(Qf,"name"),d0={EXISTS:ku,PROPER:ku&&(function(){}).name==="something",CONFIGURABLE:ku&&(!Ne||Ne&&u0(Qf,"name").configurable)},Jf=!c(function(){function w(){}return w.prototype.constructor=null,Object.getPrototypeOf(new w)!==w.prototype}),Yf=jc("IE_PROTO"),_u=Object,p0=_u.prototype,si=Jf?_u.getPrototypeOf:function(w){var M=$n(w);if(Lr(M,Yf))return M[Yf];var L=M.constructor;return ae(L)&&M instanceof L?L.prototype:M instanceof _u?p0:null},wu=to("iterator"),Xf=!1;[].keys&&("next"in(Gf=[].keys())?(Wf=si(si(Gf)))!==Object.prototype&&(Cs=Wf):Xf=!0);var f0=!Fe(Cs)||c(function(){var w={};return Cs[wu].call(w)!==w});Cs=f0?{}:Ea(Cs),ae(Cs[wu])||vs(Cs,wu,function(){return this});var Zf={IteratorPrototype:Cs,BUGGY_SAFARI_ITERATORS:Xf},m0=Zf.IteratorPrototype,g0=function(){return this},h0=d0.PROPER,Gc=Zf.BUGGY_SAFARI_ITERATORS,xu=to("iterator"),em="keys",Qc="values",tm="entries",v0=function(){return this},Iu=function(w,M,L,$,_,re,Oe){(function(zr,Hr,Kr,kn){var Yn=Hr+" Iterator";zr.prototype=Ea(m0,{next:ie(+!kn,Kr)}),Ls(zr,Yn,!1,!0),Za[Yn]=g0})(L,M,$);var de,At,tr,ur=function(zr){if(zr===_&&Fr)return Fr;if(!Gc&&zr in Cr)return Cr[zr];switch(zr){case em:return function(){return new L(this,zr)};case Qc:return function(){return new L(this,zr)};case tm:return function(){return new L(this,zr)}}return function(){return new L(this)}},gr=M+" Iterator",yr=!1,Cr=w.prototype,xr=Cr[xu]||Cr["@@iterator"]||_&&Cr[_],Fr=!Gc&&xr||ur(_),jr=M=="Array"&&Cr.entries||xr;if(jr&&(de=si(jr.call(new w)))!==Object.prototype&&de.next&&(Ls(de,gr,!0,!0),Za[gr]=v0),h0&&_==Qc&&xr&&xr.name!==Qc&&(yr=!0,Fr=function(){return Y(xr,this)}),_)if(At={values:ur(Qc),keys:re?Fr:ur(em),entries:ur(tm)},Oe)for(tr in At)(Gc||yr||!(tr in Cr))&&vs(Cr,tr,At[tr]);else Vr({target:M,proto:!0,forced:Gc||yr},At);return Oe&&Cr[xu]!==Fr&&vs(Cr,xu,Fr,{name:_}),Za[M]=Fr,At};ua.f;var rm="Array Iterator",y0=Pa.set,b0=Pa.getterFor(rm);Iu(Array,"Array",function(w,M){y0(this,{type:rm,target:sr(w),index:0,kind:M})},function(){var w=b0(this),M=w.target,L=w.kind,$=w.index++;return!M||$>=M.length?(w.target=void 0,{value:void 0,done:!0}):L=="keys"?{value:$,done:!1}:L=="values"?{value:M[$],done:!1}:{value:[$,M[$]],done:!1}},"values"),Za.Arguments=Za.Array;var nm=to("toStringTag");for(var Eu in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var om=d[Eu],Pu=om&&om.prototype;Pu&&Fs(Pu)!==nm&&Jo(Pu,nm,Eu),Za[Eu]=Za.Array}var T0=l0;wo("asyncDispose"),wo("dispose"),wo("matcher"),wo("metadataKey"),wo("observable"),wo("metadata"),wo("patternMatch"),wo("replaceAll");var ga=T0,S0=he("".charAt),am=he("".charCodeAt),C0=he("".slice),sm=function(w){return function(M,L){var $,_,re=Oa(pr(M)),Oe=$i(L),de=re.length;return Oe<0||Oe>=de?w?"":void 0:($=am(re,Oe))<55296||$>56319||Oe+1===de||(_=am(re,Oe+1))<56320||_>57343?w?S0(re,Oe):$:w?C0(re,Oe,Oe+2):_-56320+($-55296<<10)+65536}},M0={codeAt:sm(!1),charAt:sm(!0)}.charAt,im="String Iterator",k0=Pa.set,_0=Pa.getterFor(im);Iu(String,"String",function(w){k0(this,{type:im,string:Oa(w),index:0})},function(){var M,L=_0(this),$=L.string,_=L.index;return _>=$.length?{value:void 0,done:!0}:(M=M0($,_),L.index+=M.length,{value:M,done:!1})});var cm=hu.f("iterator"),w0=o(function(w){function M(L){return w.exports=M=typeof ga=="function"&&typeof cm=="symbol"?function($){return typeof $}:function($){return $&&typeof ga=="function"&&$.constructor===ga&&$!==ga.prototype?"symbol":typeof $},w.exports.__esModule=!0,w.exports.default=w.exports,M(L)}w.exports=M,w.exports.__esModule=!0,w.exports.default=w.exports}),lm=ua.f;Vr({target:"Object",stat:!0,forced:Object.defineProperty!==lm,sham:!Ne},{defineProperty:lm});var x0=o(function(w){var M=nr.Object,L=w.exports=function(_,re,Oe){return M.defineProperty(_,re,Oe)};M.defineProperty.sham&&(L.sham=!0)}),Wi=x0,I0=c(function(){si(1)});Vr({target:"Object",stat:!0,forced:I0,sham:!Jf},{getPrototypeOf:function(M){return si($n(M))}});var Ds=nr.Object.getPrototypeOf,Us=function(w,M){var L=[][w];return!!L&&c(function(){L.call(null,M||function(){return 1},1)})},E0=bs.forEach,um=Us("forEach")?[].forEach:function(M){return E0(this,M,arguments.length>1?arguments[1]:void 0)};Vr({target:"Array",proto:!0,forced:[].forEach!=um},{forEach:um});var P0=Uo("Array").forEach,Au=Array.prototype,A0={DOMTokenList:!0,NodeList:!0},In=function(w){var M=w.forEach;return w===Au||rr(Au,w)&&M===Au.forEach||Lr(A0,Fs(w))?P0:M},O0=he([].concat),N0=Ue("Reflect","ownKeys")||function(M){var L=Vi.f(Vn(M)),$=Hi.f;return $?O0(L,$(M)):L},dm=Error,R0=he("".replace),B0=String(dm("zxcasd").stack),pm=/\n\s*at [^:]*:[^\n]*/,F0=pm.test(B0),L0=function(w,M){if(F0&&typeof w=="string"&&!dm.prepareStackTrace)for(;M--;)w=R0(w,pm,"");return w},$0=function(w,M){Fe(M)&&"cause"in M&&Jo(w,"cause",M.cause)},j0=to("iterator"),D0=Array.prototype,fm=function(w){return w!==void 0&&(Za.Array===w||D0[j0]===w)},U0=to("iterator"),Jc=function(w){if(!Dt(w))return Pr(w,U0)||Pr(w,"@@iterator")||Za[Fs(w)]},q0=TypeError,Gi=function(w,M){var L=arguments.length<2?Jc(w):M;if(Or(L))return Vn(Y(L,w));throw q0(Rr(w)+" is not iterable")},Ou=function(w,M,L){var $,_;Vn(w);try{if(!($=Pr(w,"return"))){if(M==="throw")throw L;return L}$=Y($,w)}catch(re){_=!0,$=re}if(M==="throw")throw L;if(_)throw $;return Vn($),L},V0=TypeError,Yc=function(w,M){this.stopped=w,this.result=M},mm=Yc.prototype,lo=function(w,M,L){var $,_,re,Oe,de,At,tr,ur=L&&L.that,gr=!(!L||!L.AS_ENTRIES),yr=!(!L||!L.IS_RECORD),Cr=!(!L||!L.IS_ITERATOR),xr=!(!L||!L.INTERRUPTED),Fr=$o(M,ur),jr=function(Hr){return $&&Ou($,"normal",Hr),new Yc(!0,Hr)},zr=function(Hr){return gr?(Vn(Hr),xr?Fr(Hr[0],Hr[1],jr):Fr(Hr[0],Hr[1])):xr?Fr(Hr,jr):Fr(Hr)};if(yr)$=w.iterator;else if(Cr)$=w;else{if(!(_=Jc(w)))throw V0(Rr(w)+" is not iterable");if(fm(_)){for(re=0,Oe=Ia(w);Oe>re;re++)if((de=zr(w[re]))&&rr(mm,de))return de;return new Yc(!1)}$=Gi(w,_)}for(At=yr?w.next:$.next;!(tr=Y(At,$)).done;){try{de=zr(tr.value)}catch(Hr){Ou($,"throw",Hr)}if(typeof de=="object"&&de&&rr(mm,de))return de}return new Yc(!1)},H0=function(w,M){return w===void 0?arguments.length<2?"":M:Oa(w)},z0=!c(function(){var w=Error("a");return!("stack"in w)||(Object.defineProperty(w,"stack",ie(1,7)),w.stack!==7)}),K0=to("toStringTag"),Xc=Error,W0=[].push,Qi=function(M,L){var $,_=arguments.length>2?arguments[2]:void 0,re=rr(Nu,this);ji?$=ji(Xc(),re?si(this):Nu):($=re?this:Ea(Nu),Jo($,K0,"Error")),L!==void 0&&Jo($,"message",H0(L)),z0&&Jo($,"stack",L0($.stack,1)),$0($,_);var Oe=[];return lo(M,W0,{that:Oe}),Jo($,"errors",Oe),$};ji?ji(Qi,Xc):function(w,M,L){for(var $=N0(M),_=ua.f,re=Es.f,Oe=0;Oe<$.length;Oe++){var de=$[Oe];Lr(w,de)||L&&Lr(L,de)||_(w,de,re(M,de))}}(Qi,Xc,{name:!0});var Nu=Qi.prototype=Ea(Xc.prototype,{constructor:ie(1,Qi),message:ie(1,""),name:ie(1,"AggregateError")});Vr({global:!0,constructor:!0,arity:2},{AggregateError:Qi});var Ji,ii,gm,Ru,Ua=pe(d.process)=="process",hm=to("species"),vm=function(w){var M=Ue(w),L=ua.f;Ne&&M&&!M[hm]&&L(M,hm,{configurable:!0,get:function(){return this}})},G0=TypeError,Bu=function(w,M){if(rr(M,w))return w;throw G0("Incorrect invocation")},Q0=TypeError,Zc=function(w){if(Uc(w))return w;throw Q0(Rr(w)+" is not a constructor")},J0=to("species"),Ms=function(w,M){var L,$=Vn(w).constructor;return $===void 0||Dt(L=Vn($)[J0])?M:Zc(L)},Y0=TypeError,ym=function(w,M){if(w<M)throw Y0("Not enough arguments");return w},bm=/(?:ipad|iphone|ipod).*applewebkit/i.test(or),Fu=d.setImmediate,Lu=d.clearImmediate,X0=d.process,$u=d.Dispatch,Z0=d.Function,Tm=d.MessageChannel,e1=d.String,ju=0,Yi={},t1="onreadystatechange";try{Ji=d.location}catch{}var Du=function(w){if(Lr(Yi,w)){var M=Yi[w];delete Yi[w],M()}},Uu=function(w){return function(){Du(w)}},Sm=function(w){Du(w.data)},Cm=function(w){d.postMessage(e1(w),Ji.protocol+"//"+Ji.host)};Fu&&Lu||(Fu=function(M){ym(arguments.length,1);var L=ae(M)?M:Z0(M),$=hs(arguments,1);return Yi[++ju]=function(){T(L,void 0,$)},ii(ju),ju},Lu=function(M){delete Yi[M]},Ua?ii=function(w){X0.nextTick(Uu(w))}:$u&&$u.now?ii=function(w){$u.now(Uu(w))}:Tm&&!bm?(Ru=(gm=new Tm).port2,gm.port1.onmessage=Sm,ii=$o(Ru.postMessage,Ru)):d.addEventListener&&ae(d.postMessage)&&!d.importScripts&&Ji&&Ji.protocol!=="file:"&&!c(Cm)?(ii=Cm,d.addEventListener("message",Sm,!1)):ii=t1 in Ca("script")?function(w){ou.appendChild(Ca("script")).onreadystatechange=function(){ou.removeChild(this),Du(w)}}:function(w){setTimeout(Uu(w),0)});var Xi,qs,Zi,ci,qu,Vu,Hu,Mm,km={set:Fu,clear:Lu},r1=/ipad|iphone|ipod/i.test(or)&&d.Pebble!==void 0,n1=/web0s(?!.*chrome)/i.test(or),o1=Es.f,zu=km.set,_m=d.MutationObserver||d.WebKitMutationObserver,wm=d.document,xm=d.process,el=d.Promise,Im=o1(d,"queueMicrotask"),Em=Im&&Im.value;Em||(Xi=function(){var w,M;for(Ua&&(w=xm.domain)&&w.exit();qs;){M=qs.fn,qs=qs.next;try{M()}catch(L){throw qs?ci():Zi=void 0,L}}Zi=void 0,w&&w.enter()},bm||Ua||n1||!_m||!wm?!r1&&el&&el.resolve?((Hu=el.resolve(void 0)).constructor=el,Mm=$o(Hu.then,Hu),ci=function(){Mm(Xi)}):Ua?ci=function(){xm.nextTick(Xi)}:(zu=$o(zu,d),ci=function(){zu(Xi)}):(qu=!0,Vu=wm.createTextNode(""),new _m(Xi).observe(Vu,{characterData:!0}),ci=function(){Vu.data=qu=!qu}));var Ku=Em||function(w){var M={fn:w,next:void 0};Zi&&(Zi.next=M),qs||(qs=M,ci()),Zi=M},li=function(w){try{return{error:!1,value:w()}}catch(M){return{error:!0,value:M}}},Pm=function(){this.head=null,this.tail=null};Pm.prototype={add:function(w){var M={item:w,next:null};this.head?this.tail.next=M:this.head=M,this.tail=M},get:function(){var w=this.head;if(w)return this.head=w.next,this.tail===w&&(this.tail=null),w.item}};var Wu,Am,a1=Pm,ra=d.Promise,Om=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",s1=!Om&&!Ua&&typeof window=="object"&&typeof document=="object",Nm=ra&&ra.prototype,i1=to("species"),Rm=!1,Bm=ae(d.PromiseRejectionEvent),c1=af("Promise",function(){var w=yf(ra),M=w!==String(ra);if(!M&&mr===66||!Nm.catch||!Nm.finally)return!0;if(!mr||mr<51||!/native code/.test(w)){var L=new ra(function(_){_(1)}),$=function(_){_(function(){},function(){})};if((L.constructor={})[i1]=$,!(Rm=L.then(function(){})instanceof $))return!0}return!M&&(s1||Om)&&!Bm}),ui={CONSTRUCTOR:c1,REJECTION_EVENT:Bm,SUBCLASSING:Rm},l1=TypeError,u1=function(w){var M,L;this.promise=new w(function($,_){if(M!==void 0||L!==void 0)throw l1("Bad Promise constructor");M=$,L=_}),this.resolve=Or(M),this.reject=Or(L)},es={f:function(w){return new u1(w)}},Fm=km.set,tl="Promise",Lm=ui.CONSTRUCTOR,d1=ui.REJECTION_EVENT,Gu=Pa.getterFor(tl),p1=Pa.set,f1=ra&&ra.prototype,ec=ra,Qu=f1,$m=d.TypeError,Ju=d.document,Yu=d.process,Xu=es.f,m1=Xu,g1=!!(Ju&&Ju.createEvent&&d.dispatchEvent),jm="unhandledrejection",Dm=function(w){var M;return!(!Fe(w)||!ae(M=w.then))&&M},Um=function(w,M){var L,$,_,re=M.value,Oe=M.state==1,de=Oe?w.ok:w.fail,At=w.resolve,tr=w.reject,ur=w.domain;try{de?(Oe||(M.rejection===2&&v1(M),M.rejection=1),de===!0?L=re:(ur&&ur.enter(),L=de(re),ur&&(ur.exit(),_=!0)),L===w.promise?tr($m("Promise-chain cycle")):($=Dm(L))?Y($,L,At,tr):At(L)):tr(re)}catch(gr){ur&&!_&&ur.exit(),tr(gr)}},qm=function(w,M){w.notified||(w.notified=!0,Ku(function(){for(var L,$=w.reactions;L=$.get();)Um(L,w);w.notified=!1,M&&!w.rejection&&h1(w)}))},Vm=function(w,M,L){var $,_;g1?(($=Ju.createEvent("Event")).promise=M,$.reason=L,$.initEvent(w,!1,!0),d.dispatchEvent($)):$={promise:M,reason:L},!d1&&(_=d["on"+w])?_($):w===jm&&function(re,Oe){var de=d.console;de&&de.error&&(arguments.length==1?de.error(re):de.error(re,Oe))}("Unhandled promise rejection",L)},h1=function(w){Y(Fm,d,function(){var M,L=w.facade,$=w.value;if(Hm(w)&&(M=li(function(){Ua?Yu.emit("unhandledRejection",$,L):Vm(jm,L,$)}),w.rejection=Ua||Hm(w)?2:1,M.error))throw M.value})},Hm=function(w){return w.rejection!==1&&!w.parent},v1=function(w){Y(Fm,d,function(){var M=w.facade;Ua?Yu.emit("rejectionHandled",M):Vm("rejectionhandled",M,w.value)})},di=function(w,M,L){return function($){w(M,$,L)}},pi=function(w,M,L){w.done||(w.done=!0,L&&(w=L),w.value=M,w.state=2,qm(w,!0))},Zu=function(w,M,L){if(!w.done){w.done=!0,L&&(w=L);try{if(w.facade===M)throw $m("Promise can't be resolved itself");var $=Dm(M);$?Ku(function(){var _={done:!1};try{Y($,M,di(Zu,_,w),di(pi,_,w))}catch(re){pi(_,re,w)}}):(w.value=M,w.state=1,qm(w,!1))}catch(_){pi({done:!1},_,w)}}};Lm&&(Qu=(ec=function(M){Bu(this,Qu),Or(M),Y(Wu,this);var L=Gu(this);try{M(di(Zu,L),di(pi,L))}catch($){pi(L,$)}}).prototype,(Wu=function(M){p1(this,{type:tl,done:!1,notified:!1,parent:!1,reactions:new a1,rejection:!1,state:0,value:void 0})}).prototype=vs(Qu,"then",function(M,L){var $=Gu(this),_=Xu(Ms(this,ec));return $.parent=!0,_.ok=!ae(M)||M,_.fail=ae(L)&&L,_.domain=Ua?Yu.domain:void 0,$.state==0?$.reactions.add(_):Ku(function(){Um(_,$)}),_.promise}),Am=function(){var w=new Wu,M=Gu(w);this.promise=w,this.resolve=di(Zu,M),this.reject=di(pi,M)},es.f=Xu=function(w){return w===ec||w===void 0?new Am(w):m1(w)}),Vr({global:!0,constructor:!0,wrap:!0,forced:Lm},{Promise:ec}),Ls(ec,tl,!1,!0),vm(tl);var zm=to("iterator"),Km=!1;try{var y1=0,Wm={next:function(){return{done:!!y1++}},return:function(){Km=!0}};Wm[zm]=function(){return this},Array.from(Wm,function(){throw 2})}catch{}var Gm=function(w,M){if(!M&&!Km)return!1;var L=!1;try{var $={};$[zm]=function(){return{next:function(){return{done:L=!0}}}},w($)}catch{}return L},Qm=ui.CONSTRUCTOR||!Gm(function(w){ra.all(w).then(void 0,function(){})});Vr({target:"Promise",stat:!0,forced:Qm},{all:function(M){var L=this,$=es.f(L),_=$.resolve,re=$.reject,Oe=li(function(){var de=Or(L.resolve),At=[],tr=0,ur=1;lo(M,function(gr){var yr=tr++,Cr=!1;ur++,Y(de,L,gr).then(function(xr){Cr||(Cr=!0,At[yr]=xr,--ur||_(At))},re)}),--ur||_(At)});return Oe.error&&re(Oe.value),$.promise}});var b1=ui.CONSTRUCTOR;ra&&ra.prototype,Vr({target:"Promise",proto:!0,forced:b1,real:!0},{catch:function(w){return this.then(void 0,w)}}),Vr({target:"Promise",stat:!0,forced:Qm},{race:function(M){var L=this,$=es.f(L),_=$.reject,re=li(function(){var Oe=Or(L.resolve);lo(M,function(de){Y(Oe,L,de).then($.resolve,_)})});return re.error&&_(re.value),$.promise}}),Vr({target:"Promise",stat:!0,forced:ui.CONSTRUCTOR},{reject:function(M){var L=es.f(this);return Y(L.reject,void 0,M),L.promise}});var ed=function(w,M){if(Vn(w),Fe(M)&&M.constructor===w)return M;var L=es.f(w);return(0,L.resolve)(M),L.promise},T1=ui.CONSTRUCTOR,S1=Ue("Promise"),C1=!T1;Vr({target:"Promise",stat:!0,forced:!0},{resolve:function(M){return ed(C1&&this===S1?ra:this,M)}}),Vr({target:"Promise",stat:!0},{allSettled:function(M){var L=this,$=es.f(L),_=$.resolve,re=$.reject,Oe=li(function(){var de=Or(L.resolve),At=[],tr=0,ur=1;lo(M,function(gr){var yr=tr++,Cr=!1;ur++,Y(de,L,gr).then(function(xr){Cr||(Cr=!0,At[yr]={status:"fulfilled",value:xr},--ur||_(At))},function(xr){Cr||(Cr=!0,At[yr]={status:"rejected",reason:xr},--ur||_(At))})}),--ur||_(At)});return Oe.error&&re(Oe.value),$.promise}});var Jm="No one promise resolved";Vr({target:"Promise",stat:!0},{any:function(M){var L=this,$=Ue("AggregateError"),_=es.f(L),re=_.resolve,Oe=_.reject,de=li(function(){var At=Or(L.resolve),tr=[],ur=0,gr=1,yr=!1;lo(M,function(Cr){var xr=ur++,Fr=!1;gr++,Y(At,L,Cr).then(function(jr){Fr||yr||(yr=!0,re(jr))},function(jr){Fr||yr||(Fr=!0,tr[xr]=jr,--gr||Oe(new $(tr,Jm)))})}),--gr||Oe(new $(tr,Jm))});return de.error&&Oe(de.value),_.promise}});var M1=ra&&ra.prototype,k1=!!ra&&c(function(){M1.finally.call({then:function(){}},function(){})});Vr({target:"Promise",proto:!0,real:!0,forced:k1},{finally:function(w){var M=Ms(this,Ue("Promise")),L=ae(w);return this.then(L?function($){return ed(M,w()).then(function(){return $})}:w,L?function($){return ed(M,w()).then(function(){throw $})}:w)}});var _1=nr.Promise;Vr({target:"Promise",stat:!0,forced:!0},{try:function(w){var M=es.f(this),L=li(w);return(L.error?M.reject:M.resolve)(L.value),M.promise}});var uo=_1,w1=he([].reverse),Ym=[1,2];Vr({target:"Array",proto:!0,forced:String(Ym)===String(Ym.reverse())},{reverse:function(){return Ya(this)&&(this.length=this.length),w1(this)}});var x1=Uo("Array").reverse,td=Array.prototype,kl=function(w){var M=w.reverse;return w===td||rr(td,w)&&M===td.reverse?x1:M},I1=Ui("slice"),E1=to("species"),rd=Array,P1=Math.max;Vr({target:"Array",proto:!0,forced:!I1},{slice:function(M,L){var $,_,re,Oe=sr(this),de=Ia(Oe),At=ni(M,de),tr=ni(L===void 0?de:L,de);if(Ya(Oe)&&($=Oe.constructor,(Uc($)&&($===rd||Ya($.prototype))||Fe($)&&($=$[E1])===null)&&($=void 0),$===rd||$===void 0))return hs(Oe,At,tr);for(_=new($===void 0?rd:$)(P1(tr-At,0)),re=0;At<tr;At++,re++)At in Oe&&Bs(_,re,Oe[At]);return _.length=re,_}});var A1=Uo("Array").slice,nd=Array.prototype,Co=function(w){var M=w.slice;return w===nd||rr(nd,w)&&M===nd.slice?A1:M},O1=o(function(w){var M=w0.default;function L(){w.exports=L=function(){return $},w.exports.__esModule=!0,w.exports.default=w.exports;var $={},_=Object.prototype,re=_.hasOwnProperty,Oe=typeof ga=="function"?ga:{},de=Oe.iterator||"@@iterator",At=Oe.asyncIterator||"@@asyncIterator",tr=Oe.toStringTag||"@@toStringTag";function ur(_n,bn,Rn){return Wi(_n,bn,{value:Rn,enumerable:!0,configurable:!0,writable:!0}),_n[bn]}try{ur({},"")}catch{ur=function(Rn,qn,no){return Rn[qn]=no}}function gr(_n,bn,Rn,qn){var no=bn&&bn.prototype instanceof xr?bn:xr,ao=Ja(no.prototype),Ko=new _r(qn||[]);return ao._invoke=function(Po,ja,Mo){var Ao="suspendedStart";return function(oa,Lc){if(Ao==="executing")throw new Error("Generator is already running");if(Ao==="completed"){if(oa==="throw")throw Lc;return Fn()}for(Mo.method=oa,Mo.arg=Lc;;){var Fo=Mo.delegate;if(Fo){var vc=Hn(Fo,Mo);if(vc){if(vc===Cr)continue;return vc}}if(Mo.method==="next")Mo.sent=Mo._sent=Mo.arg;else if(Mo.method==="throw"){if(Ao==="suspendedStart")throw Ao="completed",Mo.arg;Mo.dispatchException(Mo.arg)}else Mo.method==="return"&&Mo.abrupt("return",Mo.arg);Ao="executing";var Ka=yr(Po,ja,Mo);if(Ka.type==="normal"){if(Ao=Mo.done?"completed":"suspendedYield",Ka.arg===Cr)continue;return{value:Ka.arg,done:Mo.done}}Ka.type==="throw"&&(Ao="completed",Mo.method="throw",Mo.arg=Ka.arg)}}}(_n,Rn,Ko),ao}function yr(_n,bn,Rn){try{return{type:"normal",arg:_n.call(bn,Rn)}}catch(qn){return{type:"throw",arg:qn}}}$.wrap=gr;var Cr={};function xr(){}function Fr(){}function jr(){}var zr={};ur(zr,de,function(){return this});var Hr=Ds&&Ds(Ds(Pn([])));Hr&&Hr!==_&&re.call(Hr,de)&&(zr=Hr);var Kr=jr.prototype=xr.prototype=Ja(zr);function kn(_n){var bn;In(bn=["next","throw","return"]).call(bn,function(Rn){ur(_n,Rn,function(qn){return this._invoke(Rn,qn)})})}function Yn(_n,bn){function Rn(no,ao,Ko,Po){var ja=yr(_n[no],_n,ao);if(ja.type!=="throw"){var Mo=ja.arg,Ao=Mo.value;return Ao&&M(Ao)=="object"&&re.call(Ao,"__await")?bn.resolve(Ao.__await).then(function(oa){Rn("next",oa,Ko,Po)},function(oa){Rn("throw",oa,Ko,Po)}):bn.resolve(Ao).then(function(oa){Mo.value=oa,Ko(Mo)},function(oa){return Rn("throw",oa,Ko,Po)})}Po(ja.arg)}var qn;this._invoke=function(no,ao){function Ko(){return new bn(function(Po,ja){Rn(no,ao,Po,ja)})}return qn=qn?qn.then(Ko,Ko):Ko()}}function Hn(_n,bn){var Rn=_n.iterator[bn.method];if(Rn===void 0){if(bn.delegate=null,bn.method==="throw"){if(_n.iterator.return&&(bn.method="return",bn.arg=void 0,Hn(_n,bn),bn.method==="throw"))return Cr;bn.method="throw",bn.arg=new TypeError("The iterator does not provide a 'throw' method")}return Cr}var qn=yr(Rn,_n.iterator,bn.arg);if(qn.type==="throw")return bn.method="throw",bn.arg=qn.arg,bn.delegate=null,Cr;var no=qn.arg;return no?no.done?(bn[_n.resultName]=no.value,bn.next=_n.nextLoc,bn.method!=="return"&&(bn.method="next",bn.arg=void 0),bn.delegate=null,Cr):no:(bn.method="throw",bn.arg=new TypeError("iterator result is not an object"),bn.delegate=null,Cr)}function xo(_n){var bn={tryLoc:_n[0]};1 in _n&&(bn.catchLoc=_n[1]),2 in _n&&(bn.finallyLoc=_n[2],bn.afterLoc=_n[3]),this.tryEntries.push(bn)}function Ln(_n){var bn=_n.completion||{};bn.type="normal",delete bn.arg,_n.completion=bn}function _r(_n){this.tryEntries=[{tryLoc:"root"}],In(_n).call(_n,xo,this),this.reset(!0)}function Pn(_n){if(_n){var bn=_n[de];if(bn)return bn.call(_n);if(typeof _n.next=="function")return _n;if(!isNaN(_n.length)){var Rn=-1,qn=function no(){for(;++Rn<_n.length;)if(re.call(_n,Rn))return no.value=_n[Rn],no.done=!1,no;return no.value=void 0,no.done=!0,no};return qn.next=qn}}return{next:Fn}}function Fn(){return{value:void 0,done:!0}}return Fr.prototype=jr,ur(Kr,"constructor",jr),ur(jr,"constructor",Fr),Fr.displayName=ur(jr,tr,"GeneratorFunction"),$.isGeneratorFunction=function(_n){var bn=typeof _n=="function"&&_n.constructor;return!!bn&&(bn===Fr||(bn.displayName||bn.name)==="GeneratorFunction")},$.mark=function(_n){return Rs?Rs(_n,jr):(_n.__proto__=jr,ur(_n,tr,"GeneratorFunction")),_n.prototype=Ja(Kr),_n},$.awrap=function(_n){return{__await:_n}},kn(Yn.prototype),ur(Yn.prototype,At,function(){return this}),$.AsyncIterator=Yn,$.async=function(_n,bn,Rn,qn,no){no===void 0&&(no=uo);var ao=new Yn(gr(_n,bn,Rn,qn),no);return $.isGeneratorFunction(bn)?ao:ao.next().then(function(Ko){return Ko.done?Ko.value:ao.next()})},kn(Kr),ur(Kr,tr,"Generator"),ur(Kr,de,function(){return this}),ur(Kr,"toString",function(){return"[object Generator]"}),$.keys=function(_n){var bn=[];for(var Rn in _n)bn.push(Rn);return kl(bn).call(bn),function qn(){for(;bn.length;){var no=bn.pop();if(no in _n)return qn.value=no,qn.done=!1,qn}return qn.done=!0,qn}},$.values=Pn,_r.prototype={constructor:_r,reset:function(bn){var Rn;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,In(Rn=this.tryEntries).call(Rn,Ln),!bn)for(var qn in this)qn.charAt(0)==="t"&&re.call(this,qn)&&!isNaN(+Co(qn).call(qn,1))&&(this[qn]=void 0)},stop:function(){this.done=!0;var bn=this.tryEntries[0].completion;if(bn.type==="throw")throw bn.arg;return this.rval},dispatchException:function(bn){if(this.done)throw bn;var Rn=this;function qn(Mo,Ao){return Ko.type="throw",Ko.arg=bn,Rn.next=Mo,Ao&&(Rn.method="next",Rn.arg=void 0),!!Ao}for(var no=this.tryEntries.length-1;no>=0;--no){var ao=this.tryEntries[no],Ko=ao.completion;if(ao.tryLoc==="root")return qn("end");if(ao.tryLoc<=this.prev){var Po=re.call(ao,"catchLoc"),ja=re.call(ao,"finallyLoc");if(Po&&ja){if(this.prev<ao.catchLoc)return qn(ao.catchLoc,!0);if(this.prev<ao.finallyLoc)return qn(ao.finallyLoc)}else if(Po){if(this.prev<ao.catchLoc)return qn(ao.catchLoc,!0)}else{if(!ja)throw new Error("try statement without catch or finally");if(this.prev<ao.finallyLoc)return qn(ao.finallyLoc)}}}},abrupt:function(bn,Rn){for(var qn=this.tryEntries.length-1;qn>=0;--qn){var no=this.tryEntries[qn];if(no.tryLoc<=this.prev&&re.call(no,"finallyLoc")&&this.prev<no.finallyLoc){var ao=no;break}}ao&&(bn==="break"||bn==="continue")&&ao.tryLoc<=Rn&&Rn<=ao.finallyLoc&&(ao=null);var Ko=ao?ao.completion:{};return Ko.type=bn,Ko.arg=Rn,ao?(this.method="next",this.next=ao.finallyLoc,Cr):this.complete(Ko)},complete:function(bn,Rn){if(bn.type==="throw")throw bn.arg;return bn.type==="break"||bn.type==="continue"?this.next=bn.arg:bn.type==="return"?(this.rval=this.arg=bn.arg,this.method="return",this.next="end"):bn.type==="normal"&&Rn&&(this.next=Rn),Cr},finish:function(bn){for(var Rn=this.tryEntries.length-1;Rn>=0;--Rn){var qn=this.tryEntries[Rn];if(qn.finallyLoc===bn)return this.complete(qn.completion,qn.afterLoc),Ln(qn),Cr}},catch:function(bn){for(var Rn=this.tryEntries.length-1;Rn>=0;--Rn){var qn=this.tryEntries[Rn];if(qn.tryLoc===bn){var no=qn.completion;if(no.type==="throw"){var ao=no.arg;Ln(qn)}return ao}}throw new Error("illegal catch attempt")},delegateYield:function(bn,Rn,qn){return this.delegate={iterator:Pn(bn),resultName:Rn,nextLoc:qn},this.method==="next"&&(this.arg=void 0),Cr}},$}w.exports=L,w.exports.__esModule=!0,w.exports.default=w.exports}),rl=O1(),ar=rl;try{regeneratorRuntime=rl}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=rl:Function("r","regeneratorRuntime = r")(rl)}Vr({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991});var Xm=9007199254740991,_l=c(function(){gs(1)});Vr({target:"Object",stat:!0,forced:_l},{keys:function(M){return gs($n(M))}});var Vo=nr.Object.keys,wl=Object.assign,Zm=Object.defineProperty,Tn=he([].concat),xl=!wl||c(function(){if(Ne&&wl({b:1},wl(Zm({},"a",{enumerable:!0,get:function(){Zm(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var w={},M={},L=Symbol(),$="abcdefghijklmnopqrst";return w[L]=7,$.split("").forEach(function(_){M[_]=_}),wl({},w)[L]!=7||gs(wl({},M)).join("")!=$})?function(M,L){for(var $=$n(M),_=arguments.length,re=1,Oe=Hi.f,de=ze.f;_>re;)for(var At,tr=Lt(arguments[re++]),ur=Oe?Tn(gs(tr),Oe(tr)):gs(tr),gr=ur.length,yr=0;gr>yr;)At=ur[yr++],Ne&&!Y(de,tr,At)||($[At]=tr[At]);return $}:wl;Vr({target:"Object",stat:!0,arity:2,forced:Object.assign!==xl},{assign:xl});var Mr=nr.Object.assign;nr.JSON||(nr.JSON={stringify:JSON.stringify});var Gh=function(M,L,$){return T(nr.JSON.stringify,null,arguments)},Wo=Gh,eg=nu.indexOf,tg=he([].indexOf),rg=!!tg&&1/tg([1],1,-0)<0,N1=Us("indexOf");Vr({target:"Array",proto:!0,forced:rg||!N1},{indexOf:function(M){var L=arguments.length>1?arguments[1]:void 0;return rg?tg(this,M,L)||0:eg(this,M,L)}});var R1=Uo("Array").indexOf,ng=Array.prototype,Ma=function(w){var M=w.indexOf;return w===ng||rr(ng,w)&&M===ng.indexOf?R1:M},Qh=Uo("Array").concat,Qd=Array.prototype,ks=function(w){var M=w.concat;return w===Qd||rr(Qd,w)&&M===Qd.concat?Qh:M};function Ps(w,M){var L={};for(var $ in w)Object.prototype.hasOwnProperty.call(w,$)&&M.indexOf($)<0&&(L[$]=w[$]);if(w!=null&&typeof Object.getOwnPropertySymbols=="function"){var _=0;for($=Object.getOwnPropertySymbols(w);_<$.length;_++)M.indexOf($[_])<0&&Object.prototype.propertyIsEnumerable.call(w,$[_])&&(L[$[_]]=w[$[_]])}return L}function Sn(w,M,L,$){return new(L||(L=Promise))(function(_,re){function Oe(tr){try{At($.next(tr))}catch(ur){re(ur)}}function de(tr){try{At($.throw(tr))}catch(ur){re(ur)}}function At(tr){tr.done?_(tr.value):function(gr){return gr instanceof L?gr:new L(function(yr){yr(gr)})}(tr.value).then(Oe,de)}At(($=$.apply(w,M||[])).next())})}var Jd=c(function(){if(typeof ArrayBuffer=="function"){var w=new ArrayBuffer(8);Object.isExtensible(w)&&Object.defineProperty(w,"a",{value:8})}}),od=Object.isExtensible,og=c(function(){od(1)})||Jd?function(M){return!!Fe(M)&&(!Jd||pe(M)!="ArrayBuffer")&&(!od||od(M))}:od,Jh=!c(function(){return Object.isExtensible(Object.preventExtensions({}))}),ag=o(function(w){var M=ua.f,L=!1,$=so("meta"),_=0,re=function(de){M(de,$,{value:{objectID:"O"+_++,weakData:{}}})},Oe=w.exports={enable:function(){Oe.enable=function(){},L=!0;var de=Vi.f,At=he([].splice),tr={};tr[$]=1,de(tr).length&&(Vi.f=function(ur){for(var gr=de(ur),yr=0,Cr=gr.length;yr<Cr;yr++)if(gr[yr]===$){At(gr,yr,1);break}return gr},Vr({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:gu.f}))},fastKey:function(de,At){if(!Fe(de))return typeof de=="symbol"?de:(typeof de=="string"?"S":"P")+de;if(!Lr(de,$)){if(!og(de))return"F";if(!At)return"E";re(de)}return de[$].objectID},getWeakData:function(de,At){if(!Lr(de,$)){if(!og(de))return!0;if(!At)return!1;re(de)}return de[$].weakData},onFreeze:function(de){return Jh&&L&&og(de)&&!Lr(de,$)&&re(de),de}};oi[$]=!0}),Yh=ua.f,Xh=bs.forEach,_i=Pa.set,B1=Pa.getterFor,Zh=function(w,M,L){for(var $ in M)L&&L.unsafe&&w[$]?w[$]=M[$]:vs(w,$,M[$],L);return w},F1=ua.f,ev=ag.fastKey,sg=Pa.set,nl=Pa.getterFor,tv={getConstructor:function(w,M,L,$){var _=w(function(tr,ur){Bu(tr,re),sg(tr,{type:M,index:Ea(null),first:void 0,last:void 0,size:0}),Ne||(tr.size=0),Dt(ur)||lo(ur,tr[$],{that:tr,AS_ENTRIES:L})}),re=_.prototype,Oe=nl(M),de=function(tr,ur,gr){var yr,Cr,xr=Oe(tr),Fr=At(tr,ur);return Fr?Fr.value=gr:(xr.last=Fr={index:Cr=ev(ur,!0),key:ur,value:gr,previous:yr=xr.last,next:void 0,removed:!1},xr.first||(xr.first=Fr),yr&&(yr.next=Fr),Ne?xr.size++:tr.size++,Cr!=="F"&&(xr.index[Cr]=Fr)),tr},At=function(tr,ur){var gr,yr=Oe(tr),Cr=ev(ur);if(Cr!=="F")return yr.index[Cr];for(gr=yr.first;gr;gr=gr.next)if(gr.key==ur)return gr};return Zh(re,{clear:function(){for(var ur=Oe(this),gr=ur.index,yr=ur.first;yr;)yr.removed=!0,yr.previous&&(yr.previous=yr.previous.next=void 0),delete gr[yr.index],yr=yr.next;ur.first=ur.last=void 0,Ne?ur.size=0:this.size=0},delete:function(tr){var ur=this,gr=Oe(ur),yr=At(ur,tr);if(yr){var Cr=yr.next,xr=yr.previous;delete gr.index[yr.index],yr.removed=!0,xr&&(xr.next=Cr),Cr&&(Cr.previous=xr),gr.first==yr&&(gr.first=Cr),gr.last==yr&&(gr.last=xr),Ne?gr.size--:ur.size--}return!!yr},forEach:function(ur){for(var gr,yr=Oe(this),Cr=$o(ur,arguments.length>1?arguments[1]:void 0);gr=gr?gr.next:yr.first;)for(Cr(gr.value,gr.key,this);gr&&gr.removed;)gr=gr.previous},has:function(ur){return!!At(this,ur)}}),Zh(re,L?{get:function(ur){var gr=At(this,ur);return gr&&gr.value},set:function(ur,gr){return de(this,ur===0?0:ur,gr)}}:{add:function(ur){return de(this,ur=ur===0?0:ur,ur)}}),Ne&&F1(re,"size",{get:function(){return Oe(this).size}}),_},setStrong:function(w,M,L){var $=M+" Iterator",_=nl(M),re=nl($);Iu(w,M,function(Oe,de){sg(this,{type:$,target:Oe,state:_(Oe),kind:de,last:void 0})},function(){for(var Oe=re(this),de=Oe.kind,At=Oe.last;At&&At.removed;)At=At.previous;return Oe.target&&(Oe.last=At=At?At.next:Oe.state.first)?de=="keys"?{value:At.key,done:!1}:de=="values"?{value:At.value,done:!1}:{value:[At.key,At.value],done:!1}:(Oe.target=void 0,{value:void 0,done:!0})},L?"entries":"values",!L,!0),vm(M)}};(function(w,M,L){var $,_=w.indexOf("Map")!==-1,re=w.indexOf("Weak")!==-1,Oe=_?"set":"add",de=d[w],At=de&&de.prototype,tr={};if(Ne&&ae(de)&&(re||At.forEach&&!c(function(){new de().entries().next()}))){var ur=($=M(function(yr,Cr){_i(Bu(yr,ur),{type:w,collection:new de}),Cr!=null&&lo(Cr,yr[Oe],{that:yr,AS_ENTRIES:_})})).prototype,gr=B1(w);Xh(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(yr){var Cr=yr=="add"||yr=="set";!(yr in At)||re&&yr=="clear"||Jo(ur,yr,function(xr,Fr){var jr=gr(this).collection;if(!Cr&&re&&!Fe(xr))return yr=="get"&&void 0;var zr=jr[yr](xr===0?0:xr,Fr);return Cr?this:zr})}),re||Yh(ur,"size",{configurable:!0,get:function(){return gr(this).collection.size}})}else $=L.getConstructor(M,w,_,Oe),ag.enable();Ls($,w,!1,!0),tr[w]=$,Vr({global:!0,forced:!0},tr),re||L.setStrong($,w,_)})("Map",function(w){return function(){return w(this,arguments.length?arguments[0]:void 0)}},tv);var L1=nr.Map,ts=[].push;Vr({target:"Map",stat:!0,forced:!0},{from:function(M){var L,$,_,re,Oe=arguments.length,de=Oe>1?arguments[1]:void 0;return Zc(this),(L=de!==void 0)&&Or(de),Dt(M)?new this:($=[],L?(_=0,re=$o(de,Oe>2?arguments[2]:void 0),lo(M,function(At){Y(ts,$,re(At,_++))})):lo(M,ts,{that:$}),new this($))}}),Vr({target:"Map",stat:!0,forced:!0},{of:function(){return new this(hs(arguments))}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:function(){for(var M,L=Vn(this),$=Or(L.delete),_=!0,re=0,Oe=arguments.length;re<Oe;re++)M=Y($,L,arguments[re]),_=_&&M;return!!_}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function(M,L){var $,_,re=Vn(this),Oe=Or(re.get),de=Or(re.has),At=Or(re.set);return Y(de,re,M)?($=Y(Oe,re,M),"update"in L&&($=L.update($,M,re),Y(At,re,M,$)),$):(_=L.insert(M,re),Y(At,re,M,_),_)}});var wi=Gi;Vr({target:"Map",proto:!0,real:!0,forced:!0},{every:function(M){var L=Vn(this),$=wi(L),_=$o(M,arguments.length>1?arguments[1]:void 0);return!lo($,function(re,Oe,de){if(!_(Oe,re,L))return de()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(M){var L=Vn(this),$=wi(L),_=$o(M,arguments.length>1?arguments[1]:void 0),re=new(Ms(L,Ue("Map"))),Oe=Or(re.set);return lo($,function(de,At){_(At,de,L)&&Y(Oe,re,de,At)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),re}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{find:function(M){var L=Vn(this),$=wi(L),_=$o(M,arguments.length>1?arguments[1]:void 0);return lo($,function(re,Oe,de){if(_(Oe,re,L))return de(Oe)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(M){var L=Vn(this),$=wi(L),_=$o(M,arguments.length>1?arguments[1]:void 0);return lo($,function(re,Oe,de){if(_(Oe,re,L))return de(re)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var ig=he([].push);Vr({target:"Map",stat:!0,forced:!0},{groupBy:function(M,L){Or(L);var $=Gi(M),_=new this,re=Or(_.has),Oe=Or(_.get),de=Or(_.set);return lo($,function(At){var tr=L(At);Y(re,_,tr)?ig(Y(Oe,_,tr),At):Y(de,_,tr,[At])},{IS_ITERATOR:!0}),_}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(M){return lo(wi(Vn(this)),function(L,$,_){if((re=$)===(Oe=M)||re!=re&&Oe!=Oe)return _();var re,Oe},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Vr({target:"Map",stat:!0,forced:!0},{keyBy:function(M,L){var $=new this;Or(L);var _=Or($.set);return lo(M,function(re){Y(_,$,L(re),re)}),$}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(M){return lo(wi(Vn(this)),function(L,$,_){if($===M)return _(L)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(M){var L=Vn(this),$=wi(L),_=$o(M,arguments.length>1?arguments[1]:void 0),re=new(Ms(L,Ue("Map"))),Oe=Or(re.set);return lo($,function(de,At){Y(Oe,re,_(At,de,L),At)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),re}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(M){var L=Vn(this),$=wi(L),_=$o(M,arguments.length>1?arguments[1]:void 0),re=new(Ms(L,Ue("Map"))),Oe=Or(re.set);return lo($,function(de,At){Y(Oe,re,de,_(At,de,L))},{AS_ENTRIES:!0,IS_ITERATOR:!0}),re}}),Vr({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(M){for(var L=Vn(this),$=Or(L.set),_=arguments.length,re=0;re<_;)lo(arguments[re++],$,{that:L,AS_ENTRIES:!0});return L}});var Vs=TypeError;Vr({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(M){var L=Vn(this),$=wi(L),_=arguments.length<2,re=_?void 0:arguments[1];if(Or(M),lo($,function(Oe,de){_?(_=!1,re=de):re=M(re,de,Oe,L)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),_)throw Vs("Reduce of empty map with no initial value");return re}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{some:function(M){var L=Vn(this),$=wi(L),_=$o(M,arguments.length>1?arguments[1]:void 0);return lo($,function(re,Oe,de){if(_(Oe,re,L))return de()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var $1=TypeError;Vr({target:"Map",proto:!0,real:!0,forced:!0},{update:function(M,L){var $=Vn(this),_=Or($.get),re=Or($.has),Oe=Or($.set),de=arguments.length;Or(L);var At=Y(re,$,M);if(!At&&de<3)throw $1("Updating absent value");var tr=At?Y(_,$,M):Or(de>2?arguments[2]:void 0)(M,$);return Y(Oe,$,M,L(tr,M,$)),$}});var j1=TypeError,cg=function(M,L){var $,_=Vn(this),re=Or(_.get),Oe=Or(_.has),de=Or(_.set),At=arguments.length>2?arguments[2]:void 0;if(!ae(L)&&!ae(At))throw j1("At least one callback required");return Y(Oe,_,M)?($=Y(re,_,M),ae(L)&&($=L($),Y(de,_,M,$))):ae(At)&&($=At(),Y(de,_,M,$)),$};Vr({target:"Map",proto:!0,real:!0,forced:!0},{upsert:cg}),Vr({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:cg});var tc=L1,lg=Date,rv=he(lg.prototype.getTime);Vr({target:"Date",stat:!0},{now:function(){return rv(new lg)}});var sa=nr.Date.now,D1=/MSIE .\./.test(or),mo=d.Function,nv=function(w){return D1?function(M,L){var $=ym(arguments.length,1)>2,_=ae(M)?M:mo(M),re=$?hs(arguments,2):void 0;return w($?function(){T(_,this,re)}:_,L)}:w},ov={setTimeout:nv(d.setTimeout),setInterval:nv(d.setInterval)},av=ov.setInterval;Vr({global:!0,bind:!0,forced:d.setInterval!==av},{setInterval:av});var Yd=ov.setTimeout;Vr({global:!0,bind:!0,forced:d.setTimeout!==Yd},{setTimeout:Yd});var ho=nr.setTimeout,ug=bs.map,U1=Ui("map");Vr({target:"Array",proto:!0,forced:!U1},{map:function(M){return ug(this,M,arguments.length>1?arguments[1]:void 0)}});var Il=Uo("Array").map,Xd=Array.prototype,To=function(w){var M=w.map;return w===Xd||rr(Xd,w)&&M===Xd.map?Il:M},Hs=o(function(w){var M=Object.prototype.hasOwnProperty,L="~";function $(){}function _(At,tr,ur){this.fn=At,this.context=tr,this.once=ur||!1}function re(At,tr,ur,gr,yr){if(typeof ur!="function")throw new TypeError("The listener must be a function");var Cr=new _(ur,gr||At,yr),xr=L?L+tr:tr;return At._events[xr]?At._events[xr].fn?At._events[xr]=[At._events[xr],Cr]:At._events[xr].push(Cr):(At._events[xr]=Cr,At._eventsCount++),At}function Oe(At,tr){--At._eventsCount==0?At._events=new $:delete At._events[tr]}function de(){this._events=new $,this._eventsCount=0}Object.create&&($.prototype=Object.create(null),new $().__proto__||(L=!1)),de.prototype.eventNames=function(){var tr,ur,gr=[];if(this._eventsCount===0)return gr;for(ur in tr=this._events)M.call(tr,ur)&&gr.push(L?ur.slice(1):ur);return Object.getOwnPropertySymbols?gr.concat(Object.getOwnPropertySymbols(tr)):gr},de.prototype.listeners=function(tr){var ur=L?L+tr:tr,gr=this._events[ur];if(!gr)return[];if(gr.fn)return[gr.fn];for(var yr=0,Cr=gr.length,xr=new Array(Cr);yr<Cr;yr++)xr[yr]=gr[yr].fn;return xr},de.prototype.listenerCount=function(tr){var ur=L?L+tr:tr,gr=this._events[ur];return gr?gr.fn?1:gr.length:0},de.prototype.emit=function(tr,ur,gr,yr,Cr,xr){var Fr=L?L+tr:tr;if(!this._events[Fr])return!1;var jr,zr,Hr=this._events[Fr],Kr=arguments.length;if(Hr.fn){switch(Hr.once&&this.removeListener(tr,Hr.fn,void 0,!0),Kr){case 1:return Hr.fn.call(Hr.context),!0;case 2:return Hr.fn.call(Hr.context,ur),!0;case 3:return Hr.fn.call(Hr.context,ur,gr),!0;case 4:return Hr.fn.call(Hr.context,ur,gr,yr),!0;case 5:return Hr.fn.call(Hr.context,ur,gr,yr,Cr),!0;case 6:return Hr.fn.call(Hr.context,ur,gr,yr,Cr,xr),!0}for(zr=1,jr=new Array(Kr-1);zr<Kr;zr++)jr[zr-1]=arguments[zr];Hr.fn.apply(Hr.context,jr)}else{var kn,Yn=Hr.length;for(zr=0;zr<Yn;zr++)switch(Hr[zr].once&&this.removeListener(tr,Hr[zr].fn,void 0,!0),Kr){case 1:Hr[zr].fn.call(Hr[zr].context);break;case 2:Hr[zr].fn.call(Hr[zr].context,ur);break;case 3:Hr[zr].fn.call(Hr[zr].context,ur,gr);break;case 4:Hr[zr].fn.call(Hr[zr].context,ur,gr,yr);break;default:if(!jr)for(kn=1,jr=new Array(Kr-1);kn<Kr;kn++)jr[kn-1]=arguments[kn];Hr[zr].fn.apply(Hr[zr].context,jr)}}return!0},de.prototype.on=function(tr,ur,gr){return re(this,tr,ur,gr,!1)},de.prototype.once=function(tr,ur,gr){return re(this,tr,ur,gr,!0)},de.prototype.removeListener=function(tr,ur,gr,yr){var Cr=L?L+tr:tr;if(!this._events[Cr])return this;if(!ur)return Oe(this,Cr),this;var xr=this._events[Cr];if(xr.fn)xr.fn!==ur||yr&&!xr.once||gr&&xr.context!==gr||Oe(this,Cr);else{for(var Fr=0,jr=[],zr=xr.length;Fr<zr;Fr++)(xr[Fr].fn!==ur||yr&&!xr[Fr].once||gr&&xr[Fr].context!==gr)&&jr.push(xr[Fr]);jr.length?this._events[Cr]=jr.length===1?jr[0]:jr:Oe(this,Cr)}return this},de.prototype.removeAllListeners=function(tr){var ur;return tr?(ur=L?L+tr:tr,this._events[ur]&&Oe(this,ur)):(this._events=new $,this._eventsCount=0),this},de.prototype.off=de.prototype.removeListener,de.prototype.addListener=de.prototype.on,de.prefixed=L,de.EventEmitter=de,w.exports=de}),xi=ol;function ol(w){w=w||{},this.ms=w.min||100,this.max=w.max||1e4,this.factor=w.factor||2,this.jitter=w.jitter>0&&w.jitter<=1?w.jitter:0,this.attempts=0}ol.prototype.duration=function(){var w=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var M=Math.random(),L=Math.floor(M*this.jitter*w);w=1&Math.floor(10*M)?w+L:w-L}return 0|Math.min(w,this.max)},ol.prototype.reset=function(){this.attempts=0},ol.prototype.setMin=function(w){this.ms=w},ol.prototype.setMax=function(w){this.max=w},ol.prototype.setJitter=function(w){this.jitter=w};var sv=typeof e=="object"&&e&&e.Object===Object&&e,q1=typeof self=="object"&&self&&self.Object===Object&&self,As=sv||q1||Function("return this")(),Qs=As.Symbol,iv=Object.prototype,V1=iv.hasOwnProperty,cv=iv.toString,Js=Qs?Qs.toStringTag:void 0,fi=function(M){var L=V1.call(M,Js),$=M[Js];try{M[Js]=void 0;var _=!0}catch{}var re=cv.call(M);return _&&(L?M[Js]=$:delete M[Js]),re},Zd=Object.prototype.toString,lv=function(M){return Zd.call(M)},uv=Qs?Qs.toStringTag:void 0,yc=function(M){return M==null?M===void 0?"[object Undefined]":"[object Null]":uv&&uv in Object(M)?fi(M):lv(M)},mi=function(M){var L=typeof M;return M!=null&&(L=="object"||L=="function")},ep=function(M){if(!mi(M))return!1;var L=yc(M);return L=="[object Function]"||L=="[object GeneratorFunction]"||L=="[object AsyncFunction]"||L=="[object Proxy]"},dv={deviceId:"",timeout:8e3},H1={account:"",appkey:"",token:"",debugLevel:"off",needReconnect:!0,reconnectionAttempts:Xm,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},pv="weblink.netease.im:443",z1=nu.includes,K1=c(function(){return!Array(1).includes()});Vr({target:"Array",proto:!0,forced:K1},{includes:function(M){return z1(this,M,arguments.length>1?arguments[1]:void 0)}});var W1=Uo("Array").includes,dg=to("match"),pg=TypeError,gi=function(w){if(function(M){var L;return Fe(M)&&((L=M[dg])!==void 0?!!L:pe(M)=="RegExp")}(w))throw pg("The method doesn't accept regular expressions");return w},G1=to("match"),Q1=he("".indexOf);Vr({target:"String",proto:!0,forced:!function(w){var M=/./;try{"/./"[w](M)}catch{try{return M[G1]=!1,"/./"[w](M)}catch{}}return!1}("includes")},{includes:function(M){return!!~Q1(Oa(pr(this)),Oa(gi(M)),arguments.length>1?arguments[1]:void 0)}});var fv=Uo("String").includes,fg=Array.prototype,ad=String.prototype,bc=function(w){var M=w.includes;return w===fg||rr(fg,w)&&M===fg.includes?W1:typeof w=="string"||w===ad||rr(ad,w)&&M===ad.includes?fv:M},J1=bs.findIndex,Y1="findIndex",tp=!0;Y1 in[]&&Array(1).findIndex(function(){tp=!1}),Vr({target:"Array",proto:!0,forced:tp},{findIndex:function(M){return J1(this,M,arguments.length>1?arguments[1]:void 0)}});var mv=Uo("Array").findIndex,mg=Array.prototype,X1=function(w){var M=w.findIndex;return w===mg||rr(mg,w)&&M===mg.findIndex?mv:M},gg=o(function(w){function M(L){var $;return w.exports=M=Rs?Oo($=Ds).call($):function(re){return re.__proto__||Ds(re)},w.exports.__esModule=!0,w.exports.default=w.exports,M(L)}w.exports=M,w.exports.__esModule=!0,w.exports.default=w.exports}),pa=o(function(w){w.exports=function(L){var $;return Ma($=Function.toString.call(L)).call($,"[native code]")!==-1},w.exports.__esModule=!0,w.exports.default=w.exports}),hg=Ue("Reflect","construct"),vg=Object.prototype,Z1=[].push,gv=c(function(){function w(){}return!(hg(function(){},[],w)instanceof w)}),yg=!c(function(){hg(function(){})}),bg=gv||yg;Vr({target:"Reflect",stat:!0,forced:bg,sham:bg},{construct:function(M,L){Zc(M),Vn(L);var $=arguments.length<3?M:Zc(arguments[2]);if(yg&&!gv)return hg(M,L,$);if(M==$){switch(L.length){case 0:return new M;case 1:return new M(L[0]);case 2:return new M(L[0],L[1]);case 3:return new M(L[0],L[1],L[2]);case 4:return new M(L[0],L[1],L[2],L[3])}var _=[null];return T(Z1,_,L),new(T(iu,M,_))}var re=$.prototype,Oe=Ea(Fe(re)?re:vg),de=T(M,Oe,L);return Fe(de)?de:Oe}});var Ii=nr.Reflect.construct,rc=o(function(w){w.exports=function(){if(typeof Reflect>"u"||!Ii||Ii.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Ii(Boolean,[],function(){})),!0}catch{return!1}},w.exports.__esModule=!0,w.exports.default=w.exports}),eT=o(function(w){function M(L,$,_){var re;return rc()?(w.exports=M=Oo(re=Ii).call(re),w.exports.__esModule=!0,w.exports.default=w.exports):(w.exports=M=function(de,At,tr){var ur=[null];ur.push.apply(ur,At);var gr=new(Oo(Function).apply(de,ur));return tr&&lu(gr,tr.prototype),gr},w.exports.__esModule=!0,w.exports.default=w.exports),M.apply(null,arguments)}w.exports=M,w.exports.__esModule=!0,w.exports.default=w.exports}),tT=o(function(w){function M(L){var $=typeof tc=="function"?new tc:void 0;return w.exports=M=function(re){if(re===null||!pa(re))return re;if(typeof re!="function")throw new TypeError("Super expression must either be null or a function");if($!==void 0){if($.has(re))return $.get(re);$.set(re,Oe)}function Oe(){return eT(re,arguments,gg(this).constructor)}return Oe.prototype=Ja(re.prototype,{constructor:{value:Oe,enumerable:!1,writable:!0,configurable:!0}}),lu(Oe,re)},w.exports.__esModule=!0,w.exports.default=w.exports,M(L)}w.exports=M,w.exports.__esModule=!0,w.exports.default=w.exports}),nc=function(w){function M(L,$,_){var re;return $===void 0&&($={}),_===void 0&&(_=400),(re=w.call(this,L)||this).data=$,re.code=_,re.name="customError",re}return Ro(M,w),M}(n(tT)(Error)),yo=function(w){function M(L,$,_){var re;return $===void 0&&($={}),(re=w.call(this,L,$,414)||this).code=414,re.name="validateError",re.rules=_,re}return Ro(M,w),M}(nc),al={200:null,406:null,808:null,810:null,201:"The client version is incorrect. You need to upgrade the SDK",302:"The user name or password is incorrect. Please check whether the appkey and token are valid and whether the account and token match",403:"Illegal operation or no permission",404:"Target object does not exist",405:"Parameter length too long",408:"Client request timed out",414:"Request parameter error",415:"Service unavailable",416:"Frequency control",417:"Repeat operation",422:"Account disabled",500:"Server internal error",503:"Server busy",508:"Expiration date",509:"Invalid",7101:"Be pulled black",700:"Partial failure of batch operation",801:"The number of people in the team has reached the upper limit",802:"No permission",803:"The team does not exist or has not changed",804:"The user is not in the team",805:"Team type mismatch",806:"The number of teams created has reached the limit",807:"Team member not valid",809:"Already in the team",811:"The number of accounts in the forced push list exceeds the limit",812:"The team is muted",813:"Due to the limited number of team, some pull people successfully",814:"Disable team message read service",815:"Maximum number of team administrators",816:"Batch operation partial failure",997:"The packet has expired",998:"Deserialize packet error",999:"Serialize packet error",9102:"Channel failure",9103:"This call has been answered / rejected at another end",10201:"Signaling: target NIM client is offline",10202:"Signaling: push is unreachable",10404:"Signaling: channel not exists",10405:"Signaling: channel already exists",10406:"Signaling: member of channel not exists",10407:"Signaling: member of channel already exists",10408:"Signaling: the invitation request does not exist or has expired",10409:"Signaling: the invitation request has been rejected",10410:"Signaling: the invitation request has been accepted",10414:"Signaling: request parameter error",10417:"Signaling: uid conflict",10419:"Signaling: the number of members of channel exceed the limit",10420:"Signaling: member is already in the channel on other client",10700:"Signaling: phased success",13002:"Abnormal chatroom status",13003:"In the blacklist",13004:"In the mute list",13006:"All members are muted, and only the administrator can speak"},rp=function(w){function M(L,$,_,re,Oe){var de;return _===void 0&&(_=""),re===void 0&&(re=new Date().getTime()),Oe===void 0&&(Oe={}),_=_||al[L],(de=w.call(this,_,Oe,L)||this).name="cmdError",de.cmd=$,de.timetag=re,de}return Ro(M,w),M}(nc),Tg=function(w){function M(L,$,_){var re;return(re=w.call(this,L,{},412)||this).code=412,re.name="formatError",re.key=$,re.reason=_,re}return Ro(M,w),M}(nc),El=function(w){function M(L,$,_,re,Oe){var de;return(de=w.call(this,L,{file:Oe},400)||this).name="uploadError",de.rawError=$,de.curProvider=_||1,de.mixStorePolicy=re,de}return Ro(M,w),M}(nc),Tc=["error","warn","log","debug"],sl=function(){},sd=["off","error","warn","log","debug"],np=function(){function w(L,$){this.name=$,this.strategies={debug:console.log,log:console.log,warn:console.warn,error:console.error},this.debug=sl,this.log=sl,this.warn=sl,this.error=sl,this.name=$,w.instancesName.push($),bc(sd).call(sd,L)||(L="off"),this.setLogFunc(L)}var M=w.prototype;return M.setLogFunc=function($){var _=this,re=X1(Tc).call(Tc,function(Oe){return Oe===$});In(Tc).call(Tc,function(Oe,de){de<=re&&(_[Oe]=function(){var At=Co(Array.prototype).call(arguments),tr=this.formatArgs(At,Oe);this.strategies[Oe](tr)})})},M.formatArgs=function($,_){var re=new Date,Oe=re.getMonth()+1+"-"+re.getDate()+" "+re.getHours()+":"+re.getMinutes()+":"+re.getSeconds()+":"+re.getMilliseconds();return"[NIM "+_+" "+this.name+" "+Oe+"] "+To($).call($,function(de){return de instanceof nc?de.name+", "+de.code+", "+de.message:de instanceof Error?de&&de.message?de.message:de:typeof de=="object"?Wo(de):de}).join(" ")},w}();np.instancesName=[],Vr({global:!0},{globalThis:d});var hv=bs.filter,rT=Ui("filter");Vr({target:"Array",proto:!0,forced:!rT},{filter:function(M){return hv(this,M,arguments.length>1?arguments[1]:void 0)}});var na=Uo("Array").filter,Sg=Array.prototype,ls=function(w){var M=w.filter;return w===Sg||rr(Sg,w)&&M===Sg.filter?na:M},nT=o(function(w,M){w.exports=function(){function L(tr,ur){if(!(tr instanceof ur))throw new TypeError("Cannot call a class as a function")}function $(tr,ur){for(var gr=0;gr<ur.length;gr++){var yr=ur[gr];yr.enumerable=yr.enumerable||!1,yr.configurable=!0,"value"in yr&&(yr.writable=!0),Wi(tr,yr.key,yr)}}function _(tr,ur,gr){return ur&&$(tr.prototype,ur),gr&&$(tr,gr),Wi(tr,"prototype",{writable:!1}),tr}var re={reportUrl:"https://statistic.live.126.net/statics/report/common/form",maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0},Oe="https://statistic.live.126.net/dispatcher/req",de=function(){},At=function(){function tr(ur){L(this,tr),this.enable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=re,this.msgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=sa(),this.timer=null,this.setConfig(ur),this.reportConfig.autoStart&&this.initUploadConfig()}return _(tr,[{key:"setConfig",value:function(gr){this.reportConfig=Mr({},this.reportConfig,gr)}},{key:"reportImmediately",value:function(gr,yr){var Cr=this;this.reportConfig.request(gr,Mr({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},yr)).catch(function(xr){var Fr,jr;(jr=(Fr=Cr.reportConfig)===null||Fr===void 0?void 0:Fr.logger)===null||jr===void 0||jr.warn("Reporter immediately upload failed",xr)})}},{key:"report",value:function(gr,yr){var Cr=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(gr){var xr=sa();Cr?this.lowPriorityMsgList.push({module:gr,msg:yr,createTime:xr}):this.msgList.push({module:gr,msg:yr,createTime:xr}),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function(gr,yr){if(gr&&!this.traceMsgCache[gr]){var Cr=Mr(Mr({start_time:sa()},yr),{extension:[]});this.traceMsgCache[gr]=Cr}}},{key:"reportTraceUpdate",value:function(gr){}},{key:"reportTraceUpdateV2",value:function(gr,yr){if(this.traceMsgCache[gr]){var Cr=this.traceMsgCache[gr].extension.length,xr=new Date().getTime();yr.duration=Cr===0?xr-this.traceMsgCache[gr].start_time:xr-this.traceMsgCache[gr].extension[Cr-1].end_time,this.traceMsgCache[gr].extension.push(Mr({end_time:xr},yr))}}},{key:"reportTraceEnd",value:function(gr){var yr,Cr=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.traceMsgCache[gr]&&(gr!=="nos"||Cr===!1?(typeof Cr=="boolean"?this.traceMsgCache[gr].succeed=!!Cr:this.traceMsgCache[gr].state=Cr,this.traceMsgCache[gr].duration=sa()-this.traceMsgCache[gr].start_time,In(yr=this.traceMsgCache[gr].extension).call(yr,function(xr){delete xr.end_time}),this.report(gr,this.traceMsgCache[gr]),this.traceMsgCache[gr]=null):this.traceMsgCache[gr]=null)}},{key:"reportTraceCancel",value:function(gr){this.traceMsgCache[gr]=null}},{key:"pause",value:function(){this.enable=!1}},{key:"restore",value:function(){this.enable=!0,this.initConfigLoaded||this.initUploadConfig()}},{key:"destroy",value:function(){var gr,yr=this;In(gr=Vo(this.traceMsgCache)).call(gr,function(Cr){yr.reportTraceEnd(Cr,1)}),this.timer!==null&&clearTimeout(this.timer),this.setConfig=de,this.report=de,this.reportTraceStart=de,this.reportTraceUpdate=de,this.reportTraceEnd=de,this.pause=de,this.restore=de,this.destroy=de,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.reportConfig={},this.isDestroyed=!0}},{key:"initUploadConfig",value:function(){var gr,yr,Cr=this;if(!this.loading){this.loading=!0;var xr=this.reportConfig.common||{};try{this.reportConfig.request(Oe,{method:"GET",dataType:"json",params:{deviceId:xr.dev_id,sdkVer:xr.sdk_ver,platform:xr.platform,appkey:xr.app_key},timeout:this.reportConfig.timeout}).then(function(Fr){var jr,zr;if(!Cr.isDestroyed){if(Fr.status===200&&Fr.data&&Fr.data.code===200){var Hr=Fr.data.data||{};Cr.reportConfig.maxSize=Hr.maxSize>1e3?1e3:Hr.maxSize,Cr.reportConfig.maxInterval=Hr.maxInterval>1e4?1e4:Hr.maxInterval,Cr.reportConfig.maxInterval=Hr.maxInterval<10?10:Hr.maxInterval,Cr.reportConfig.minInterval=Hr.minInterval<2?2:Hr.minInterval,Cr.reportConfig.maxDelay=Hr.maxDelay||300,Cr.reportConfig.maxInterval=1e3*Cr.reportConfig.maxInterval,Cr.reportConfig.minInterval=1e3*Cr.reportConfig.minInterval,Cr.reportConfig.maxDelay=1e3*Cr.reportConfig.maxDelay,Cr.enable=!0,Cr.initConfigLoaded=!0,Cr.loading=!1,Cr.reportHeartBeat()}(zr=(jr=Cr.reportConfig)===null||jr===void 0?void 0:jr.logger)===null||zr===void 0||zr.log("Get reporter upload config success")}}).catch(function(Fr){var jr,zr;Cr.loading=!1,(zr=(jr=Cr.reportConfig)===null||jr===void 0?void 0:jr.logger)===null||zr===void 0||zr.error("Get reporter upload config failed",Fr)})}catch(Fr){this.loading=!1,(yr=(gr=this.reportConfig)===null||gr===void 0?void 0:gr.logger)===null||yr===void 0||yr.error("Exec reporter request failed",Fr)}}}},{key:"reportHeartBeat",value:function(){var gr=this;this.isDestroyed||(this.timer=ho(function(){gr.reportHeartBeat()},this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function(){if(!this.isDestroyed){var gr=this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;sa()-this.lastReportTime>=gr&&this.upload()}}},{key:"getUploadMsg",value:function(){var gr,yr,Cr,xr,Fr,jr=this,zr={},Hr=sa();this.msgList=ls(gr=this.msgList).call(gr,function(Pn){return Hr-Pn.createTime<jr.reportConfig.maxDelay}),this.lowPriorityMsgList=ls(yr=this.lowPriorityMsgList).call(yr,function(Pn){return Hr-Pn.createTime<jr.reportConfig.maxDelay}),this.cacheMsgList=ls(Cr=this.cacheMsgList).call(Cr,function(Pn){return Hr-Pn.createTime<jr.reportConfig.maxDelay});var Kr=Co(xr=this.msgList).call(xr,0,this.reportConfig.maxSize);if(this.msgList=Co(Fr=this.msgList).call(Fr,Kr.length),Kr.length<this.reportConfig.maxSize){var kn,Yn,Hn=this.reportConfig.maxSize-Kr.length;Kr=ks(Kr).call(Kr,Co(kn=this.lowPriorityMsgList).call(kn,0,Hn)),this.lowPriorityMsgList=Co(Yn=this.lowPriorityMsgList).call(Yn,Hn)}if(Kr.length<this.reportConfig.maxSize){var xo,Ln,_r=this.reportConfig.maxSize-Kr.length;Kr=ks(Kr).call(Kr,Co(xo=this.cacheMsgList).call(xo,0,_r)),this.cacheMsgList=Co(Ln=this.cacheMsgList).call(Ln,_r)}return In(Kr).call(Kr,function(Pn){zr[Pn.module]?zr[Pn.module].push(Pn.msg):zr[Pn.module]=[Pn.msg]}),{uploadMsgArr:Kr,uploadMsg:zr}}},{key:"upload",value:function(){var gr,yr,Cr=this;if(this.enable&&!(this.lastReportTime&&sa()-this.lastReportTime<this.reportConfig.minInterval)){var xr=this.getUploadMsg(),Fr=xr.uploadMsgArr,jr=xr.uploadMsg;if(Fr.length){this.lastReportTime=sa();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:jr},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch(function(zr){var Hr,Kr,kn,Yn;Cr.cacheMsgList=Co(Hr=ks(Kr=Cr.cacheMsgList).call(Kr,Fr)).call(Hr,0,Cr.reportConfig.cacheMaxSize),(Yn=(kn=Cr.reportConfig)===null||kn===void 0?void 0:kn.logger)===null||Yn===void 0||Yn.warn("Reporter upload failed",zr)})}catch(zr){(yr=(gr=this.reportConfig)===null||gr===void 0?void 0:gr.logger)===null||yr===void 0||yr.warn("Exec reporter request failed",zr)}clearTimeout(this.timer),this.reportHeartBeat()}}}}]),tr}();return At}()}),Ho={setLogger:function(M){throw new Error("Function not implemented.")},platform:"",WebSocket:function(){function w(L,$){throw this.CONNECTING=0,this.OPEN=1,this.CLOSING=2,this.CLOSED=3,new Error("Method not implemented.")}var M=w.prototype;return M.close=function($,_){throw new Error("Method not implemented.")},M.send=function($){throw new Error("Method not implemented.")},M.onclose=function($){throw new Error("Method not implemented.")},M.onerror=function($){throw new Error("Method not implemented.")},M.onmessage=function($){throw new Error("Method not implemented.")},M.onopen=function($){throw new Error("Method not implemented.")},w}(),localStorage:{},request:function(M,L){throw new Error("Function not implemented.")},uploadFile:function(M){throw new Error("Function not implemented.")},getSystemInfo:function(){throw new Error("Function not implemented.")}},Ys=TypeError,vv=function(w){return function(M,L,$,_){Or(L);var re=$n(M),Oe=Lt(re),de=Ia(re),At=w?de-1:0,tr=w?-1:1;if($<2)for(;;){if(At in Oe){_=Oe[At],At+=tr;break}if(At+=tr,w?At<0:de<=At)throw Ys("Reduce of empty array with no initial value")}for(;w?At>=0:de>At;At+=tr)At in Oe&&(_=L(_,Oe[At],At,re));return _}},ta={left:vv(!1),right:vv(!0)}.left,oT=Us("reduce");Vr({target:"Array",proto:!0,forced:!oT||!Ua&&mr>79&&mr<83},{reduce:function(M){var L=arguments.length;return ta(this,M,L,L>1?arguments[1]:void 0)}});var yv=Uo("Array").reduce,Cg=Array.prototype,op=function(w){var M=w.reduce;return w===Cg||rr(Cg,w)&&M===Cg.reduce?yv:M},bv=function(M){return M===void 0},Pl={},Sc={};function Tv(w,M){var L,$,_;try{_=JSON.parse(w)}catch(Cr){throw M.error("Parse command error: ",w),Cr}var re=_.sid+"_"+_.cid,Oe=_.r;if(bc(L=["4_1","4_2","4_10","4_11"]).call(L,re)){var de=_.r[1].headerPacket;re=de.sid+"_"+de.cid,Oe=_.r[1].body}var At,tr=Sc[re],ur=Pl[tr],gr=function(xr,Fr){var jr=al[xr];return jr===null?null:new rp(xr,Fr,jr,new Date().getTime())}(_.code,tr),yr={cmd:tr,raw:_,error:gr,service:ur==null?void 0:ur.service,content:{}};if(yr.error){if(yr.error.cmd=tr,yr.error.callFunc="parseCmd",!(!(($=ur==null?void 0:ur.ignoreErrCodes)===null||$===void 0)&&bc($).call($,_.code)))return yr;M.warn("parseCmd:: ignore error ",yr.error),yr.error.ignore=!0}return!tr||!ur?(yr.notFound=!0,yr):(ur.response&&In(At=ur.response).call(At,function(Cr,xr){var Fr=Oe[xr],jr=Cr.type,zr=Cr.name,Hr=Cr.reflectMapper;if(!bv(Fr))switch(jr){case"Property":yr.content[zr]=Hr?Ei(Fr,Hr):Fr;break;case"PropertyArray":yr.content[zr]=To(Fr).call(Fr,function(Kr){return Hr?Ei(Kr,Hr):Kr});break;case"long":case"Long":case"byte":case"Byte":case"Number":yr.content[zr]=+Fr;break;default:yr.content[zr]=Fr}}),yr)}function id(w,M){var L={};for(var $ in w)M[$]!==void 0&&(L[M[$]]=w[$]);return L}function Ei(w,M){var L={};for(var $ in w)M[$]!==void 0&&(L[M[$]]=w[$]);return L}function qa(w){Pl=Mr(Pl,w.cmdConfig),Sc=Mr(Sc,w.cmdMap)}function rs(w){var M;return op(M=Vo(w)).call(M,function(L,$){var _,re=w[$];return L[$]=op(_=Vo(re)).call(_,function(Oe,de){return Oe[re[de]]=de,Oe},{}),L},{})}var Na=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],Pi=["transport not supported","client not handshaken","unauthorized"],Cc=["reconnect"],Mg=function(w){function M($,_,re){var Oe;return(Oe=w.call(this)||this).url=_,Oe.logger=re,Oe.websocket=null,Oe.core=$,Oe.url=_,Oe.status="disconnected",Oe.logger=re,Oe.connect(),Oe}Ro(M,w);var L=M.prototype;return L.connect=function(){var _=this;this.status!=="connecting"&&this.status!=="connected"?(this.status="connecting",this.core.adapters.request("https://"+this.url+"/socket.io/1/?t="+sa(),{method:"GET",dataType:"text",timeout:8e3}).then(function(re){var Oe=re.data.split(":"),de=Oe[0],At=Oe[1];return _.sessionId=de,_.closeTimeout=1e3*At,_._createWebsocket("wss://"+_.url+"/socket.io/1/websocket/"+de)}).catch(function(re){_.logger.error("imsocket::handshake fail. ",re&&re.message),_.status="disconnected",_.emit("handshakeFailed")})):this.logger.warn("imsocket::socket is connecting or connected",this.status)},L.close=function(){if(this.websocket){this.logger.log("imsocket:: close websocket");try{this.websocket.send(this.encodePacket({type:"disconnect"})),this.websocket.close()}catch(_){this.logger.warn("attempt to close websocket error",_)}this.clean()}},L.clean=function(){this.status="disconnected",this.websocket&&(this.websocket.onmessage=null,this.websocket.onopen=null,this.websocket.onerror=null,this.websocket.onclose=null,this.websocket=null,this.emit("disconnect"))},L.onConnect=function(){this.status="connected",this.resetCloseTimer(),this.emit("connect")},L._createWebsocket=function(_){var re,Oe=this;this.websocket=new Ho.WebSocket(_),this.websocket.onmessage=Oo(re=this.onMessage).call(re,this),this.websocket.onclose=function(){Oe.logger.log("imsocket:: receive websocket onclose event, current status",Oe.status),Oe.clean()},this.websocket.onerror=function(de){Oe.logger.error("imsocket:: onerror",de)}},L.onMessage=function(_){var re;this.resetCloseTimer();var Oe=this.decodePacket(_.data);if(Oe)switch(Oe.type){case"connect":this.onConnect();break;case"disconnect":this.close();break;case"message":case"json":this.emit("message",Oe.data);break;case"event":Oe.name&&this.emit(Oe.name,Oe.args);break;case"error":Oe.reason==="unauthorized"?this.emit("connect_failed",Oe.reason):this.emit("error",Oe.reason);break;case"heartbeat":(re=this.websocket)===null||re===void 0||re.send(this.encodePacket({type:"heartbeat"}));break;default:this.logger.warn("imsocket::no handler type",Oe.type)}},L.encodePacket=function(_){var re,Oe,de=_.type,At=_.id,tr=At===void 0?"":At,ur=_.endpoint,gr=ur===void 0?"":ur,yr=_.ack,Cr=null;if(!de)return"";switch(de){case"error":re=_.reason?Ma(Pi).call(Pi,_.reason):"",Oe=_.advice?Ma(Cc).call(Cc,_.advice):"",re===""&&Oe===""||(Cr=re+(Oe!==""?"+"+Oe:""));break;case"message":_.data!==""&&(Cr=_.data);break;case"event":re={name:_.name},re=_.args&&_.args.length?{name:_.name,args:_.args}:{name:_.name},Cr=Wo(re);break;case"json":Cr=Wo(_.data);break;case"connect":_.qs&&(Cr=_.qs);break;case"ack":Cr=_.ackId+(_.args&&_.args.length?"+"+Wo(_.args):"")}var xr=[Ma(Na).call(Na,de),tr+(yr==="data"?"+":""),gr];return Cr!=null&&xr.push(Cr),xr.join(":")},L.decodePacket=function(_){if(_)if(_.charAt(0)!=""){var re=_.match(/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/);if(re){var Oe,de=re[1],At=re[2],tr=re[3],ur=re[4],gr=re[5],yr={type:Na[+de],endpoint:ur};switch(At&&(yr.id=At,yr.ack=!tr||"data"),yr.type){case"error":Oe=gr.split("+"),yr.reason=Pi[+Oe[0]]||"";break;case"message":yr.data=gr||"";break;case"connect":yr.qs=gr||"";break;case"event":try{var Cr=JSON.parse(gr);yr.name=Cr.name,yr.args=Cr.args}catch(xr){this.logger.error("imsocket::parseData::type::event error",xr)}yr.args=yr.args||[];break;case"json":try{yr.data=JSON.parse(gr)}catch(xr){this.logger.error("imsocket::parseData::type::json error",xr)}break;case"ack":if((Oe=gr.match(/^([0-9]+)(\+)?(.*)/))&&(yr.ackId=Oe[1],yr.args=[],Oe[3]))try{yr.args=Oe[3]?JSON.parse(Oe[3]):[]}catch(xr){this.logger.error("imsocket::parseData::type::ack error",xr)}}return yr}}else this.logger.error("imsocket::unrecognize dataStr",Co(_).call(_,0,20))},L.send=function(_){var re,Oe={data:_,type:"message",endpoint:""};(re=this.websocket)===null||re===void 0||re.send(this.encodePacket(Oe))},L.resetCloseTimer=function(){var _=this;this.closeTimeout&&(clearTimeout(this.closeTimer),this.closeTimer=ho(function(){_.close()},this.closeTimeout))},M}(Hs),kg=Uo("Array").values,ap=Array.prototype,aT={DOMTokenList:!0,NodeList:!0},sp=function(w){var M=w.values;return w===ap||rr(ap,w)&&M===ap.values||Lr(aT,Fs(w))?kg:M};Vr({target:"Array",stat:!0},{isArray:Ya});var hi=nr.Array.isArray,sT=bs.every,ip=Us("every");Vr({target:"Array",proto:!0,forced:!ip},{every:function(M){return sT(this,M,arguments.length>1?arguments[1]:void 0)}});var ns=Uo("Array").every,_g=Array.prototype,iT=function(w){var M=w.every;return w===_g||rr(_g,w)&&M===_g.every?ns:M},vi=function(M){return M!=null&&typeof M=="object"},wg=function(M){return vi(M)&&yc(M)=="[object RegExp]"},Al=function(M){return function(L){return M(L)}},us=o(function(w,M){var L=M&&!M.nodeType&&M,$=L&&w&&!w.nodeType&&w,_=$&&$.exports===L&&sv.process,re=function(){try{var Oe=$&&$.require&&$.require("util").types;return Oe||_&&_.binding&&_.binding("util")}catch{}}();w.exports=re}),Sv=us&&us.isRegExp,xg=Sv?Al(Sv):wg,Ol=As["__core-js_shared__"],Ig=function(){var w=/[^.]+$/.exec(Ol&&Ol.keys&&Ol.keys.IE_PROTO||"");return w?"Symbol(src)_1."+w:""}(),cT=function(M){return!!Ig&&Ig in M},Eg=Function.prototype.toString,Mc=function(M){if(M!=null){try{return Eg.call(M)}catch{}try{return M+""}catch{}}return""},lT=/^\[object .+?Constructor\]$/,uT=Function.prototype,il=Object.prototype,dT=uT.toString,pT=il.hasOwnProperty,fT=RegExp("^"+dT.call(pT).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),mT=function(M){return!(!mi(M)||cT(M))&&(ep(M)?fT:lT).test(Mc(M))},gT=function(M,L){return M==null?void 0:M[L]},cl=function(M,L){var $=gT(M,L);return mT($)?$:void 0},cd=cl(Object,"create"),hT=function(){this.__data__=cd?cd(null):{},this.size=0},ll=function(M){var L=this.has(M)&&delete this.__data__[M];return this.size-=L?1:0,L},ld=Object.prototype.hasOwnProperty,vT=function(M){var L=this.__data__;if(cd){var $=L[M];return $==="__lodash_hash_undefined__"?void 0:$}return ld.call(L,M)?L[M]:void 0},yT=Object.prototype.hasOwnProperty,bT=function(M){var L=this.__data__;return cd?L[M]!==void 0:yT.call(L,M)},TT=function(M,L){var $=this.__data__;return this.size+=this.has(M)?0:1,$[M]=cd&&L===void 0?"__lodash_hash_undefined__":L,this};function Nl(w){var M=-1,L=w==null?0:w.length;for(this.clear();++M<L;){var $=w[M];this.set($[0],$[1])}}Nl.prototype.clear=hT,Nl.prototype.delete=ll,Nl.prototype.get=vT,Nl.prototype.has=bT,Nl.prototype.set=TT;var Cv=Nl,ST=function(){this.__data__=[],this.size=0},oc=function(M,L){return M===L||M!=M&&L!=L},ud=function(M,L){for(var $=M.length;$--;)if(oc(M[$][0],L))return $;return-1},CT=Array.prototype.splice,cp=function(M){var L=this.__data__,$=ud(L,M);return!($<0)&&($==L.length-1?L.pop():CT.call(L,$,1),--this.size,!0)},lp=function(M){var L=this.__data__,$=ud(L,M);return $<0?void 0:L[$][1]},MT=function(M){return ud(this.__data__,M)>-1},kT=function(M,L){var $=this.__data__,_=ud($,M);return _<0?(++this.size,$.push([M,L])):$[_][1]=L,this};function Rl(w){var M=-1,L=w==null?0:w.length;for(this.clear();++M<L;){var $=w[M];this.set($[0],$[1])}}Rl.prototype.clear=ST,Rl.prototype.delete=cp,Rl.prototype.get=lp,Rl.prototype.has=MT,Rl.prototype.set=kT;var up=Rl,dd=cl(As,"Map"),Bl=function(){this.size=0,this.__data__={hash:new Cv,map:new(dd||up),string:new Cv}},dp=function(M){var L=typeof M;return L=="string"||L=="number"||L=="symbol"||L=="boolean"?M!=="__proto__":M===null},kc=function(M,L){var $=M.__data__;return dp(L)?$[typeof L=="string"?"string":"hash"]:$.map},_T=function(M){var L=kc(this,M).delete(M);return this.size-=L?1:0,L},wT=function(M){return kc(this,M).get(M)},pp=function(M){return kc(this,M).has(M)},xT=function(M,L){var $=kc(this,M),_=$.size;return $.set(M,L),this.size+=$.size==_?0:1,this};function Fl(w){var M=-1,L=w==null?0:w.length;for(this.clear();++M<L;){var $=w[M];this.set($[0],$[1])}}Fl.prototype.clear=Bl,Fl.prototype.delete=_T,Fl.prototype.get=wT,Fl.prototype.has=pp,Fl.prototype.set=xT;var fp=Fl,IT=function(M){return this.__data__.set(M,"__lodash_hash_undefined__"),this},Ll=function(M){return this.__data__.has(M)};function ul(w){var M=-1,L=w==null?0:w.length;for(this.__data__=new fp;++M<L;)this.add(w[M])}ul.prototype.add=ul.prototype.push=IT,ul.prototype.has=Ll;var Pg=ul,Mv=function(M,L,$,_){for(var re=M.length,Oe=$+(_?1:-1);_?Oe--:++Oe<re;)if(L(M[Oe],Oe,M))return Oe;return-1},mp=function(M){return M!=M},Ag=function(M,L,$){for(var _=$-1,re=M.length;++_<re;)if(M[_]===L)return _;return-1},ET=function(M,L,$){return L==L?Ag(M,L,$):Mv(M,mp,$)},kv=function(M,L){return!!(M!=null&&M.length)&&ET(M,L,0)>-1},_v=function(M,L,$){for(var _=-1,re=M==null?0:M.length;++_<re;)if($(L,M[_]))return!0;return!1},Og=function(M,L){for(var $=-1,_=M==null?0:M.length,re=Array(_);++$<_;)re[$]=L(M[$],$,M);return re},gp=function(M,L){return M.has(L)},wv=function(M,L,$,_){var re=-1,Oe=kv,de=!0,At=M.length,tr=[],ur=L.length;if(!At)return tr;$&&(L=Og(L,Al($))),_?(Oe=_v,de=!1):L.length>=200&&(Oe=gp,de=!1,L=new Pg(L));e:for(;++re<At;){var gr=M[re],yr=$==null?gr:$(gr);if(gr=_||gr!==0?gr:0,de&&yr==yr){for(var Cr=ur;Cr--;)if(L[Cr]===yr)continue e;tr.push(gr)}else Oe(L,yr,_)||tr.push(gr)}return tr},$l=function(M){return M},Ng=function(M,L,$){switch($.length){case 0:return M.call(L);case 1:return M.call(L,$[0]);case 2:return M.call(L,$[0],$[1]);case 3:return M.call(L,$[0],$[1],$[2])}return M.apply(L,$)},Rg=Math.max,hp=function(M,L,$){return L=Rg(L===void 0?M.length-1:L,0),function(){for(var _=arguments,re=-1,Oe=Rg(_.length-L,0),de=Array(Oe);++re<Oe;)de[re]=_[L+re];re=-1;for(var At=Array(L+1);++re<L;)At[re]=_[re];return At[L]=$(de),Ng(M,this,At)}},xv=function(M){return function(){return M}},pd=function(){try{var w=cl(Object,"defineProperty");return w({},"",{}),w}catch{}}(),Iv=pd?function(w,M){return pd(w,"toString",{configurable:!0,enumerable:!1,value:xv(M),writable:!0})}:$l,PT=Date.now,vp=function(M){var L=0,$=0;return function(){var _=PT(),re=16-(_-$);if($=_,re>0){if(++L>=800)return arguments[0]}else L=0;return M.apply(void 0,arguments)}},Ev=vp(Iv),Bg=function(M){return typeof M=="number"&&M>-1&&M%1==0&&M<=9007199254740991},yp=function(M){return M!=null&&Bg(M.length)&&!ep(M)},Pv=function(M){return vi(M)&&yp(M)},Av=function(M,L){return Ev(hp(M,L,$l),M+"")}(function(w,M){return Pv(w)?wv(w,M):[]}),Fg=Av;function bp(w,M){return M instanceof RegExp?"__REGEXP "+M.toString():M}function En(w,M,L){var $;M===void 0&&(M={});var _={};return In($=Vo(w)).call($,function(re){var Oe=w[re].type,de=L?"In "+L+", ":"";if(M[re]===void 0){if(w[re].required===!1)return void(_[re]=M[re]);throw new yo(de+'param "'+re+'" is required',{key:re},"required")}var At=AT[Oe];if(At&&!At(M,re,w[re]))throw new yo(de+'param "'+re+'" expects '+Wo(w[re],bp),{key:re,value:M[re]},Wo(w[re]));_[re]=M[re]}),_}var AT={string:function(M,L,$){var _=$.allowEmpty,re=$.max,Oe=$.min,de=$.regExp,At=M[L];return typeof At=="string"&&(_!==!1||At!=="")&&!(typeof re=="number"&&At.length>re)&&!(typeof Oe=="number"&&At.length<Oe)&&!(xg(de)&&!de.test(At))},number:function(M,L,$){var _=$.min,re=$.max,Oe=M[L];return typeof Oe=="number"&&!(typeof _=="number"&&Oe<_)&&!(typeof re=="number"&&Oe>re)},boolean:function(M,L){return typeof M[L]=="boolean"},enum:function(M,L,$){var _=sp($),re=M[L];return!_||Ma(_).call(_,re)>-1},array:function(M,L,$){var _,re=$.itemType,Oe=$.rules,de=$.min,At=$.max,tr=sp($),ur=M[L];return!!hi(ur)&&!(typeof At=="number"&&ur.length>At)&&!(typeof de=="number"&&ur.length<de)&&!(re&&re!=="enum"&&!iT(ur).call(ur,function(gr){return typeof gr===re}))&&(re!=="enum"||!tr||!Fg.apply(void 0,ks(_=[ur]).call(_,tr)).length)&&(Oe&&In(ur).call(ur,function(gr,yr){return En(Oe,gr,L+"["+yr+"]")}),!0)},object:function(M,L,$){var _=$.rules,re=M[L];return _&&En(_,re,L),!0}},jl=cl(As,"Set"),OT=function(){},Wr=function(M){var L=-1,$=Array(M.size);return M.forEach(function(_){$[++L]=_}),$},NT=jl&&1/Wr(new jl([,-0]))[1]==1/0?function(w){return new jl(w)}:OT,Dl=NT,RT=function(M,L,$){var _=-1,re=kv,Oe=M.length,de=!0,At=[],tr=At;if($)de=!1,re=_v;else if(Oe>=200){var ur=L?null:Dl(M);if(ur)return Wr(ur);de=!1,re=gp,tr=new Pg}else tr=L?[]:At;e:for(;++_<Oe;){var gr=M[_],yr=L?L(gr):gr;if(gr=$||gr!==0?gr:0,de&&yr==yr){for(var Cr=tr.length;Cr--;)if(tr[Cr]===yr)continue e;L&&tr.push(yr),At.push(gr)}else re(tr,yr,$)||(tr!==At&&tr.push(yr),At.push(gr))}return At},Tp=function(M){return M&&M.length?RT(M):[]},Lg=`	
\v\f\r \u2028\u2029\uFEFF`,Ov=he("".replace),Sp="["+Lg+"]",BT=RegExp("^"+Sp+Sp+"*"),$g=RegExp(Sp+Sp+"*$"),Cp=function(w){return function(M){var L=Oa(pr(M));return 1&w&&(L=Ov(L,BT,"")),2&w&&(L=Ov(L,$g,"")),L}},Mp={start:Cp(1),end:Cp(2),trim:Cp(3)}.trim,fd=d.parseInt,Nv=d.Symbol,kp=Nv&&Nv.iterator,Rv=/^[+-]?0x/i,md=he(Rv.exec),jg=fd(Lg+"08")!==8||fd(Lg+"0x16")!==22||kp&&!c(function(){fd(Object(kp))})?function(M,L){var $=Mp(Oa(M));return fd($,L>>>0||(md(Rv,$)?16:10))}:fd;Vr({global:!0,forced:parseInt!=jg},{parseInt:jg});var Ai,ko=nr.parseInt,_p=(Ai=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return Ai()+Ai()+Ai()+Ai()+Ai()+Ai()+Ai()+Ai()});function yi(w){var M;return ls(M=Vo(w)).call(M,function(L){return!(+L>=0)})}function Oi(w,M){var L,$=ls(L=Vo(w)).call(L,function(_){return w[_]==M});return $.length>0?$[0]:void 0}function Lo(w,M){if(M===void 0&&(M="-"),!w)throw new nc("No sessionId",{},400);var L=Ma(w).call(w,M);if(L===-1)throw new nc("Can not find conjunctions",{},400);var $=Co(w).call(w,0,L);return{accid:Co(w).call(w,L+1),scene:$==="super_team"?"superTeam":$}}var Dg=TypeError,ia=Object.getOwnPropertyDescriptor,Bv=Ne&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(w){return w instanceof TypeError}}()?function(w,M){if(Ya(w)&&!ia(w,"length").writable)throw Dg("Cannot set read only .length");return w.length=M}:function(w,M){return w.length=M},FT=TypeError,wp=function(w,M){if(!delete w[M])throw FT("Cannot delete property "+Rr(M)+" of "+Rr(w))},LT=Ui("splice"),$T=Math.max,xp=Math.min;Vr({target:"Array",proto:!0,forced:!LT},{splice:function(M,L){var $,_,re,Oe,de,At,tr=$n(this),ur=Ia(tr),gr=ni(M,ur),yr=arguments.length;for(yr===0?$=_=0:yr===1?($=0,_=ur-gr):($=yr-2,_=xp($T($i(L),0),ur-gr)),uu(ur+$-_),re=fu(tr,_),Oe=0;Oe<_;Oe++)(de=gr+Oe)in tr&&Bs(re,Oe,tr[de]);if(re.length=_,$<_){for(Oe=gr;Oe<ur-_;Oe++)At=Oe+$,(de=Oe+_)in tr?tr[At]=tr[de]:wp(tr,At);for(Oe=ur;Oe>ur-_+$;Oe--)wp(tr,Oe-1)}else if($>_)for(Oe=ur-_;Oe>gr;Oe--)At=Oe+$-1,(de=Oe+_-1)in tr?tr[At]=tr[de]:wp(tr,At);for(Oe=0;Oe<$;Oe++)tr[Oe+gr]=arguments[Oe+2];return Bv(tr,ur-_+$),re}});var jT=Uo("Array").splice,Ug=Array.prototype,qg=function(w){var M=w.splice;return w===Ug||rr(Ug,w)&&M===Ug.splice?jT:M},DT=function(w,M,L,$){try{return $?M(Vn(L)[0],L[1]):M(L)}catch(_){Ou(w,"throw",_)}},Ip=Array,Fv=!Gm(function(w){Array.from(w)});Vr({target:"Array",stat:!0,forced:Fv},{from:function(M){var L=$n(M),$=Uc(this),_=arguments.length,re=_>1?arguments[1]:void 0,Oe=re!==void 0;Oe&&(re=$o(re,_>2?arguments[2]:void 0));var de,At,tr,ur,gr,yr,Cr=Jc(L),xr=0;if(!Cr||this===Ip&&fm(Cr))for(de=Ia(L),At=$?new this(de):Ip(de);de>xr;xr++)yr=Oe?re(L[xr],xr):L[xr],Bs(At,xr,yr);else for(gr=(ur=Gi(L,Cr)).next,At=$?new this:[];!(tr=Y(gr,ur)).done;xr++)yr=Oe?DT(ur,re,[tr.value,xr],!0):tr.value,Bs(At,xr,yr);return At.length=xr,At}});var Ep=nr.Array.from,gd=Jc;function Lv(w,M){var L,$=ga!==void 0&&gd(w)||w["@@iterator"];if($)return Oo(L=($=$.call(w)).next).call(L,$);if(hi(w)||($=function(Oe,de){var At;if(Oe){if(typeof Oe=="string")return _c(Oe,de);var tr=Co(At=Object.prototype.toString.call(Oe)).call(At,8,-1);if(tr==="Object"&&Oe.constructor&&(tr=Oe.constructor.name),tr==="Map"||tr==="Set")return Ep(Oe);if(tr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(tr))return _c(Oe,de)}}(w))||M&&w&&typeof w.length=="number"){$&&(w=$);var _=0;return function(){return _>=w.length?{done:!0}:{done:!1,value:w[_++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _c(w,M){(M==null||M>w.length)&&(M=w.length);for(var L=0,$=new Array(M);L<M;L++)$[L]=w[L];return $}var Va,$v=function(){function w(){this.timerList=[],this.id=0,this.timer=null,this.timeout=0}var M=w.prototype;return M.addTimer=function($,_,re){_===void 0&&(_=0),re===void 0&&(re=1);var Oe=new Date().getTime(),de=this.id;return this.timerList.push({id:de,loop:re,count:0,timeout:Oe+_,interval:_,callback:$}),this.id++,this.checkTimer(Oe),de},M.checkTimer=function($){if($===void 0&&($=new Date().getTime()),this.removeFinished(),this.timerList.length!==0||this.timer==null){for(var _,re,Oe=0,de=Lv(this.timerList);!(_=de()).done;){var At=_.value;(Oe===0||Oe>At.timeout)&&(Oe=At.timeout)}this.timerList.length!==0&&(this.timer===null||Oe<this.timeout||this.timeout<$)&&(this.timer=ho(Oo(re=this.nowTime).call(re,this),Oe-$),this.timeout=Oe)}},M.nowTime=function(){for(var $,_=new Date().getTime(),re=Lv(this.timerList);!($=re()).done;){var Oe=$.value;_>=Oe.timeout&&(Oe.callback(),Oe.count++,Oe.timeout=_+Oe.interval)}this.clerTime(),this.checkTimer(_)},M.clerTime=function(){this.timer!==null&&(clearTimeout(this.timer),this.timer=null)},M.deleteTimer=function($){for(var _=this.timerList.length-1;_>=0;_--){var re;this.timerList[_].id===$&&qg(re=this.timerList).call(re,_,1)}},M.removeFinished=function(){for(var $=this.timerList.length-1;$>=0;$--){var _,re=this.timerList[$];re.loop>=0&&re.count>=re.loop&&qg(_=this.timerList).call(_,$,1)}},M.destroy=function(){this.clerTime(),this.timerList=[],this.id=0,this.timer=null},w}(),jv=function(){function w(L){this.core=L}var M=w.prototype;return M.request=function($,_){var re=this,Oe=new Date().getTime();return Ho.request($,_).catch(function(de){var At,tr,ur=de;throw re.core.reporter.reportTraceStart("exceptions",{user_id:re.core.options.account,trace_id:(tr=(At=re.core)===null||At===void 0?void 0:At.socket)===null||tr===void 0?void 0:tr.sessionId,start_time:Oe,action:1}),re.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof ur.code=="number"?ur.code:0,description:ur.message||""+ur.code,operation_type:0,target:$,context:_?Wo(_):""}),re.core.reporter.reportTraceEnd("exceptions",1),de})},M.uploadFile=function($){var _=this,re=new Date().getTime();return Ho.uploadFile($).catch(function(Oe){var de,At,tr=Oe;_.core.reporter.reportTraceStart("exceptions",{user_id:_.core.options.account,trace_id:(At=(de=_.core)===null||de===void 0?void 0:de.socket)===null||At===void 0?void 0:At.sessionId,start_time:re,action:1});var ur=Ho.platform==="BROWSER"?$.chunkUploadHost:$.commonUploadHost?$.commonUploadHost+"/"+($.nosToken&&$.nosToken.bucket):"https://nos.netease.com/nim";throw _.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof tr.code=="number"?tr.code:0,description:tr.message||""+tr.code,operation_type:1,target:ur}),_.core.reporter.reportTraceEnd("exceptions",1),Oe})},w}();(function(w){w[w.ACTIVE=1]="ACTIVE",w[w.KICKED=2]="KICKED",w[w.OFFLINE=3]="OFFLINE"})(Va||(Va={}));var ds=window&&ep(window.addEventListener)&&ep(window.removeEventListener),Dv=function(w){function M($,_){var re;(re=w.call(this)||this).status="unconnected",re.linkUrls=[],re.eventBus=new Hs,re.packetSer=1,re.retryCount=0,re.reconnectTimer=0,re.backoff=new xi({max:8e3,min:1600,jitter:.01}),re.sendingCmdMap=new tc,re.pingTimer=0,re.config=dv,re.abtInfo={},En({linkUrls:{type:"array",itemType:"string",required:!1}},$),re.options=Mr(Mr({},H1),$),re.adapters=new jv(i(re));var Oe=Ho.localStorage.getItem("__NIM_DEVC_ID__");re.options.isFixedDeviceId?(Oe=Ho.localStorage.getItem("__NIM_DEVC_ID__")||_p(),Ho.localStorage.setItem("__NIM_DEVC_ID__",Oe)):Oe=_p(),re.config=Mr(Mr(Mr({},dv),_),{deviceId:Oe}),re.timerManager=new $v,re.logger=new np(re.options.debugLevel,re.options.account);var de=Ho.getSystemInfo();return re.reporter=new nT({common:{app_key:$.appkey,dev_id:Oe,platform:"Web",sdk_ver:"0.13.1",env:"online",os_name:de.os,os_ver:de.osVer,model:de.hostEnvVer,manufactor:de.hostEnv,host_env:de.hostEnv,host_info:de.hostInfo,host_env_ver:de.hostEnvVer},request:Ho.request,logger:re.logger,autoStart:Ho.platform==="BROWSER"}),Ho.setLogger(re.logger),re.logger.log("Core init, version ","0.13.1"," sdk version ",91001," appkey ",$.appkey),re}Ro(M,w);var L=M.prototype;return L.emit=function(_){try{for(var re,Oe,de=sa(),At=arguments.length,tr=new Array(At>1?At-1:0),ur=1;ur<At;ur++)tr[ur-1]=arguments[ur];var gr=(re=w.prototype.emit).call.apply(re,ks(Oe=[this,_]).call(Oe,tr)),yr=sa()-de;return yr>=10&&this.logger.warn("Core::emit event: "+_+" process takes: "+yr+"ms"),gr}catch(Cr){return this.logger.error("Core::emit event: "+_+". Error: "+Cr),!1}},L.connect=function(_,re){return _===void 0&&(_={}),Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr,ur,gr,yr;return ar.wrap(function(xr){for(;;)switch(xr.prev=xr.next){case 0:if(En({linkUrls:{type:"array",itemType:"string",required:!1}},_),/^(unconnected|waitReconnect)$/.test(this.status)){xr.next=5;break}return de="Core socket status is "+this.status+", and would not connect",this.logger.warn(de),xr.abrupt("return",uo.reject(de));case 5:this.status="connecting",_.linkUrls&&_.linkUrls.length>0&&(this.linkUrls=ks(At=_.linkUrls).call(At,this.linkUrls),this.linkUrls=Tp(this.linkUrls)),this.linkUrls.length===0&&this.linkUrls.push(pv),tr=0;case 9:if(!(tr<this.linkUrls.length)){xr.next=32;break}return ur=this.linkUrls[tr],gr=new Date().getTime(),xr.prev=12,xr.next=15,this.doConnect(ur);case 15:return this.status="connected",this.logger.log("core:: connect success with url: "+ur),this.abtRequest(),xr.abrupt("return",ur);case 21:xr.prev=21,xr.t0=xr.catch(12),yr=xr.t0,re&&re(yr,ur),this.reporter.reportTraceStart("exceptions",{user_id:this.options.account,start_time:gr,action:0}),this.reporter.reportTraceUpdateV2("exceptions",{code:typeof yr.code=="number"?yr.code:0,description:yr.message||""+yr.code,operation_type:0,target:ur}),this.reporter.reportTraceEnd("exceptions",1),this.logger.warn("core:: connect failed with url: "+ur,xr.t0);case 29:tr++,xr.next=9;break;case 32:throw this.retryCount===0?this.doDisconnect(Va.ACTIVE,"SocketHandshakeFailed"):this.doDisconnect(Va.OFFLINE,"ReconnectHadRetryAllLinks"),new Error("core: socket handshake failed");case 34:case"end":return xr.stop()}},Oe,this,[[12,21]])}))},L.doConnect=function(_){var re=this;return new uo(function(Oe,de){var At;re.socket=new Mg(re,_,re.logger),re.socket.on("connect",function(){re.logger.log("socket on connect",_),Oe()}),re.socket.on("message",Oo(At=re.onMessage).call(At,re)),re.socket.on("disconnect",function(tr){re.logger.log("core:: socket on disconnect",tr),re.doDisconnect(Va.OFFLINE,"SocketOnDisconnect")}),re.socket.on("handshakeFailed",function(){re.logger.warn("core:: socket handshake failed"),de(new nc("handshake failed",{},408))})})},L.resetConnectStatus=function(){clearTimeout(this.reconnectTimer),this.backoff.reset(),this.retryCount=0,this.initOnlineListener()},L.doDisconnect=function(_,re){if(this.logger.log("doDisconnect: type "+_+", description "+re),this.status!=="unconnected"){this.markAllCmdInvaild(new nc("Packet timeout due to instance disconnect",{},408)),this.timerManager.destroy(),clearTimeout(this.pingTimer),this.socket&&(typeof this.socket.removeAllListeners=="function"&&this.socket.removeAllListeners(),typeof this.socket.close=="function"&&this.socket.close(),this.socket=void 0);var Oe=!this.options.needReconnect||this.retryCount>=this.options.reconnectionAttempts;if(_===Va.ACTIVE||Oe)this.logger.log("doDisconnect: emit disconnect, type "+_,Oe),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.eventBus.emit("disconnect"),this.emit("disconnect"),this.destroyOnlineListener();else if(_===Va.KICKED){this.logger.log("doDisconnect: kicked"),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer);var de=typeof re=="string"?{reason:"unknow",message:re}:re;this.eventBus.emit("kicked",de),this.emit("kicked",de),this.destroyOnlineListener()}else _===Va.OFFLINE?(this.logger.log("doDisconnect: start to reconnect"),this.attempToReconnect()):this.logger.log("doDisconnect: nothing to do")}else this.logger.warn("doDisconnect: already unconnected")},L.attempToReconnect=function(){var _=this;if(this.status!=="waitReconnect"){var re=this.backoff.duration();this.retryCount++,this.logger.log("willReconnect "+this.retryCount+" "+re),this.eventBus.emit("willReconnect",{retryCount:this.retryCount,duration:re}),this.emit("willReconnect",{retryCount:this.retryCount,duration:re}),this.status="waitReconnect",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=ho(function(){_.status==="waitReconnect"?_.connect({isAutoReconnect:!0}).catch(function(){_.logger.error("core::attempToReconnect failed "+_.retryCount)}):_.logger.warn("doDisconnect: reconnectTimer status is "+_.status+", would not go on reconnecting")},re)}else this.logger.warn("doDisconnect: already is waiting reconnect")},L.sendCmd=function(_,re,Oe){var de=this;if(this.status!=="logined"&&_!=="login"&&_!=="chatroomLogin"&&_!=="qchatLogin")return this.logger.warn("nim status is "+this.status+", so can not sendCmd "+_),uo.reject({cmd:_,error:{code:"No_connected",message:"Connection not established",timetag:new Date().getTime()}});if(!this.socket||!this.socket.send)return uo.reject("No_socket");var At=_!=="heartbeat",tr=At?this.packetSer++:0,ur=function(zr,Hr,Kr,kn){var Yn=Pl[zr];if(!Yn)return Kr.error("createCmd:: can not find cmd config: ",zr),null;var Hn,xo={SER:Hr,SID:Yn.sid,CID:Yn.cid,Q:[]};return Yn.params&&kn&&In(Hn=Yn.params).call(Hn,function(Ln){var _r=kn[Ln.name];if(!bv(_r)){var Pn=Ln.type,Fn=Ln.reflectMapper;switch(Ln.type){case"PropertyArray":Pn="ArrayMable",_r=To(_r).call(_r,function(_n){return{t:"Property",v:Fn?id(_n,Fn):_n}});break;case"Property":_r=Fn?id(_r,Fn):_r;break;case"Bool":case"bool":_r=_r?"true":"false"}xo.Q.push({t:Pn,v:_r})}}),{packet:xo,isNoResponse:Yn.isNoResponse||!1}}(_,tr,this.logger,re);if(!ur){var gr="SendCmd "+tr+" "+_+" error";return this.logger.error(gr),uo.reject(gr)}var yr=ur.packet,Cr=ur.isNoResponse,xr=Wo(yr);At&&(this.options.debugLevel==="debug"?this.logger.debug("core::sendCmd",_,"ser:"+tr,xr):this.logger.log("core::sendCmd",_,"ser:"+tr));var Fr=new Date().getTime();return new uo(function(jr,zr){de.sendingCmdMap.set(tr,{cmd:_,params:re,callback:[jr,zr],timer:Cr?null:ho(function(){var Kr,kn=new rp(504,_,"Packet Timeout",new Date().getTime(),{message:"ser "+tr+" cmd "+_+" timeout"});kn.callFunc="sendCmd",de.markCmdInvalid(tr,kn,_),de.reporter.reportTraceStart("exceptions",{user_id:de.options.account,trace_id:(Kr=de.socket)===null||Kr===void 0?void 0:Kr.sessionId,start_time:Fr,action:2}),de.reporter.reportTraceUpdateV2("exceptions",{code:408,description:"Packet timeout",operation_type:1,target:yr.SID+"-"+yr.CID,context:""+yr.SER}),de.reporter.reportTraceEnd("exceptions",1)},Oe&&Oe.timeout?Oe.timeout:de.config.timeout)});try{de.socket.send(xr)}catch(Kr){var Hr=new rp(415,_,Kr&&Kr.message||"Unable to send packet",new Date().getTime(),{message:"send json error",rawError:Kr});Hr.callFunc="sendCmd",de.markCmdInvalid(tr,Hr,_),zr(Kr)}})},L.onMessage=function(_){var re=Tv(_,this.logger);if(re){var Oe=re.raw.ser;if(re.error&&this.logger.error("core:onMessage packet error",re.raw.sid+"_"+re.raw.cid+", ser:"+Oe+",",re.error),!re.notFound)return re.cmd!=="heartbeat"&&(this.options.debugLevel==="debug"?this.logger.debug("imsocket::recvCmd ser:"+Oe,re.cmd,re.content):this.logger.log("imsocket::recvCmd ser:"+Oe,re.cmd)),re.__receiveTime=sa(),re;this.logger.warn("core::onMessage packet not found",re.raw.sid+"_"+re.raw.cid+", ser:"+Oe)}},L.markCmdInvalid=function(_,re,Oe){var de=this.sendingCmdMap.get(_);if(de){var At=de.callback,tr=de.timer;tr&&clearTimeout(tr),this.sendingCmdMap.delete(_),this.logger.warn("packet "+_+", "+Oe+" is invalid:",re),At[1](re)}},L.markAllCmdInvaild=function(_){var re;this.logger.log("markAllCmdInvaild"),In(re=this.sendingCmdMap).call(re,function(Oe){var de=Oe.callback,At=Oe.timer;At&&clearTimeout(At),de[1](_)}),this.sendingCmdMap.clear()},L.ping=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var re=this;return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return clearTimeout(this.pingTimer),de.prev=1,de.next=4,this.sendCmd("heartbeat");case 4:de.next=14;break;case 6:return de.prev=6,de.t0=de.catch(1),de.next=10,this.testHeartBeat5Timeout();case 10:if(!de.sent){de.next=14;break}return this.doDisconnect(Va.OFFLINE,"PingError"),de.abrupt("return");case 14:this.pingTimer=ho(function(){re.ping()},3e4);case 15:case"end":return de.stop()}},_,this,[[1,6]])}))},L.testHeartBeat5Timeout=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var re;return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:clearTimeout(this.pingTimer),re=0;case 2:if(!(re<5)){de.next=15;break}return de.prev=3,de.next=6,this.sendCmd("heartbeat",{},{timeout:3e3});case 6:return de.abrupt("return",!1);case 9:de.prev=9,de.t0=de.catch(3),this.logger.debug("core:: test heartbeat "+re+" Timeout");case 12:re++,de.next=2;break;case 15:return de.abrupt("return",!0);case 16:case"end":return de.stop()}},_,this,[[3,9]])}))},L.initOnlineListener=function(){var _,re;this.onlineListener||(ds?(this.onlineListener=Oo(_=function(){this.status==="logined"&&this.ping()}).call(_,this),this.offlineListener=Oo(re=function(){this.logger.log("offline"),this.doDisconnect(Va.OFFLINE,"OfflineListener")}).call(re,this),window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener)):this.logger.warn("initOnlineListener not support add listener"))},L.destroyOnlineListener=function(){this.onlineListener&&(window.removeEventListener("online",this.onlineListener),this.onlineListener=void 0),this.offlineListener&&(window.removeEventListener("offline",this.offlineListener),this.offlineListener=void 0)},L.disconnect=function(){switch(this.status){case"connected":case"logined":case"connecting":case"waitReconnect":return this.doDisconnect(Va.ACTIVE,"UserActiveDisconnect"),uo.resolve();case"unconnected":case"destroyed":return uo.resolve()}},L.destroy=function(){var _=this;return this.disconnect().then(function(){_.status="destroyed",_.removeAllListeners(),_.eventBus.removeAllListeners(),_.reporter.destroy(),_.connect=function(){return uo.resolve()},_.disconnect=function(){return uo.resolve()},_.destroy=function(){return uo.resolve()}})},L.abtRequest=function(){var _,re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:if(this.options.isAbtestEnable){ur.next=2;break}return ur.abrupt("return");case 2:if(!this.abtInfo.experiments){ur.next=4;break}return ur.abrupt("return");case 4:if(this.options.abtestUrl){ur.next=6;break}return ur.abrupt("return");case 6:return ur.prev=6,ur.next=9,this.adapters.request(this.options.abtestUrl,{method:"POST",dataType:"json",headers:{sdktype:"ABTest"},data:{clientInfo:{projectKey:this.options.abtestProjectKey,appKey:this.options.appkey,osType:"Web",sdkVersion:"0.13.1",deviceId:this.config.deviceId},useLocalCache:!0}});case 9:de=ur.sent,ur.next=15;break;case 12:ur.prev=12,ur.t0=ur.catch(6),this.logger.warn("ABTest request failed");case 15:this.abtInfo=((re=(_=de==null?void 0:de.data)===null||_===void 0?void 0:_.data)===null||re===void 0?void 0:re.abtInfo)||{},this.abtInfo.experiments&&this.abtInfo.experiments.length>0&&this.reporter.reportImmediately("https://statistic.live.126.net/statics/report/abtest/result",{params:{app_key:this.options.appkey,biz_sdk_type:"IM",sdk_ver:"0.13.1",device_id:this.config.deviceId,platform:"Web",projectKey:this.options.abtestProjectKey,experiments:To(At=this.abtInfo.experiments).call(At,function(gr){return{experimentKey:gr.experimentKey,schemeKey:gr.schemeKey}})},headers:{sdktype:"ABTest"},method:"POST",dataType:"json"});case 17:case"end":return ur.stop()}},Oe,this,[[6,12]])}))},M}(Hs);Dv.setAdapters=function(M){Mr(Ho,M)};var Uv={"1_2":"heartbeat","2_3":"login","2_5":"kicked","2_6":"logout","2_7":"multiPortLogin","2_8":"kick"},qv={login:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appkey:18,account:19,browser:24,session:26,deviceInfo:32,isReactNative:112,token:1e3,customTag:38,customClientType:39,sdkHumanVersion:40,sdkType:41,userAgent:42,authType:115,loginExt:116},loginRes:{lastLoginDeviceId:17,customTag:38,connectionId:102,ip:103,port:104,country:106,hasXMPush:111},loginPort:{type:3,os:4,mac:5,deviceId:13,account:19,deviceInfo:32,customTag:38,connectionId:102,ip:103,time:109},aosPushInfo:{pushType:110,hasTokenPreviously:111}},hd=rs(qv),Vv={login:{sid:2,cid:3,service:"auth",params:[{type:"Property",name:"login",reflectMapper:qv.login}],response:[{type:"Property",name:"loginRes",reflectMapper:hd.loginRes},{type:"PropertyArray",name:"loginPorts",reflectMapper:hd.loginPort},{type:"Property",name:"aosPushInfo",reflectMapper:hd.aosPushInfo}]},logout:{sid:2,cid:6,service:"auth"},heartbeat:{sid:1,cid:2,service:"auth"},kicked:{sid:2,cid:5,service:"auth",response:[{type:"Number",name:"clientType"},{type:"Number",name:"reason"},{type:"String",name:"ext"},{type:"Number",name:"customClientType"}]},multiPortLogin:{sid:2,cid:7,service:"auth",response:[{type:"Number",name:"state"},{type:"PropertyArray",name:"loginPorts",reflectMapper:hd.loginPort}]},kick:{sid:2,cid:8,service:"auth",params:[{type:"StrArray",name:"deviceIds"}],response:[{type:"StrArray",name:"deviceIds"}]}},bi=Array.isArray,Pp=function(M){return typeof M=="symbol"||vi(M)&&yc(M)=="[object Symbol]"},Vg=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ap=/^\w*$/,Hg=function(M,L){if(bi(M))return!1;var $=typeof M;return!($!="number"&&$!="symbol"&&$!="boolean"&&M!=null&&!Pp(M))||Ap.test(M)||!Vg.test(M)||L!=null&&M in Object(L)};function zg(w,M){if(typeof w!="function"||M!=null&&typeof M!="function")throw new TypeError("Expected a function");var L=function(){var $=arguments,_=M?M.apply(this,$):$[0],re=L.cache;if(re.has(_))return re.get(_);var Oe=w.apply(this,$);return L.cache=re.set(_,Oe)||re,Oe};return L.cache=new(zg.Cache||fp),L}zg.Cache=fp;var UT=zg,qT=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,VT=/\\(\\)?/g,Ul=function(M){var L=UT(M,function(_){return $.size===500&&$.clear(),_}),$=L.cache;return L}(function(w){var M=[];return w.charCodeAt(0)===46&&M.push(""),w.replace(qT,function(L,$,_,re){M.push(_?re.replace(VT,"$1"):$||L)}),M}),Op=Ul,Hv=Qs?Qs.prototype:void 0,Kg=Hv?Hv.toString:void 0,zv=function w(M){if(typeof M=="string")return M;if(bi(M))return Og(M,w)+"";if(Pp(M))return Kg?Kg.call(M):"";var L=M+"";return L=="0"&&1/M==-1/0?"-0":L},HT=function(M){return M==null?"":zv(M)},vd=function(M,L){return bi(M)?M:Hg(M,L)?[M]:Op(HT(M))},dl=function(M){if(typeof M=="string"||Pp(M))return M;var L=M+"";return L=="0"&&1/M==-1/0?"-0":L},Wg=function(M,L){for(var $=0,_=(L=vd(L,M)).length;M!=null&&$<_;)M=M[dl(L[$++])];return $&&$==_?M:void 0},Os=function(M,L,$){var _=M==null?void 0:Wg(M,L);return _===void 0?$:_},Ni={debugLevel:"off",needReconnect:!0,reconnectionAttempts:Xm,lbsUrls:["https://lbs.netease.im/lbs/webconf.jsp"],linkUrl:pv,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},Np={},Fa=function(w){function M($,_){var re,Oe;_===void 0&&(_={serverConfig:{},syncOptions:{},sessionConfig:{}}),(Oe=w.call(this,$)||this).instanceName="NIM",Oe.account="",Oe.options={},Oe.auth={},Oe.offlinePush={},Oe.sync={},Oe.msg={},Oe.msgLog={},Oe.session={},Oe.cloudSession={},Oe.misc={},Oe.user={},Oe.friend={},Oe.systemMessage={},Oe.team={},Oe.event={},Oe.msgExtend={},Oe.cloudStorage={},Oe.passThrough={},Oe.superTeam={},Oe.plugin={},Oe.signaling={},Oe.setOptions($),qa({cmdMap:Uv,cmdConfig:Vv});var de=null;return In(re=Vo(Np)).call(re,function(At){var tr=Np[At];At==="sync"?de=tr:Oe[At]=At==="session"?new tr(i(Oe),_.sessionConfig):At==="cloudStorage"?new tr(i(Oe),Mr({storageKeyPrefix:Oe.instanceName},_.serverConfig,_.cloudStorageConfig)):new tr(i(Oe))}),de&&(Oe.sync=new de(i(Oe),_.syncOptions)),M.instance=i(Oe),Oe}Ro(M,w),M.getInstance=function(_,re){if(!M.instance){if(_)return new M(_,re);throw new Error("Instance not exist, please input options")}if(_){if(M.instance.options.account===_.account&&M.instance.options.appkey===_.appkey)return M.instance.setOptions(_),M.instance;throw new Error("Unexpected login")}return M.instance};var L=M.prototype;return L.setOptions=function(_){En({account:{type:"string"},appkey:{type:"string"},token:{type:"string"},needReconnect:{type:"boolean",required:!1},reconnectionAttempts:{type:"number",required:!1},customClientType:{type:"number",min:1,required:!1},authType:{type:"number",min:0,max:2,required:!1},lbsUrls:{type:"array",itemType:"string",min:1,required:!1},linkUrl:{type:"string",allowEmpty:!1,required:!1}},_),this.logger.log("NIM::setOptions options is",_),this.account=_.account,this.options=Mr(Mr({},Ni),_)},L.connect=function(_){_===void 0&&(_={});var re=Ja(null,{connect:{get:function(){return w.prototype.connect}}});return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr=this;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:if(/^(unconnected|waitReconnect)$/.test(this.status)){gr.next=4;break}return de="NIM status is "+this.status+", and would not connect",this.logger.warn(de),gr.abrupt("return",uo.reject(de));case 4:return this.reporter.reportTraceCancel("login"),this.reporter.reportTraceStart("login",{user_id:this.options.account,action:_.isAutoReconnect?"auto_login":"manual_login"}),this.reporter.reportTraceUpdateV2("login",{code:0,description:Wo(Mr(Mr({},this.options),{account:"***",token:"***"})),operation_type:"conf_init",succeed:!0,duration:0,target:""}),gr.next=9,this.getLbsInfos();case 9:return gr.prev=9,gr.next=12,re.connect.call(this,_,function(yr,Cr){tr.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:Cr,code:yr.code||408,description:"ws_handshake_failed:"+yr.message,succeed:!1})});case 12:(At=gr.sent)&&this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:At,code:200,succeed:!0}),gr.next=20;break;case 16:throw gr.prev=16,gr.t0=gr.catch(9),this.reporter.reportTraceEnd("login",!1),gr.t0;case 20:return gr.next=22,this.login(_.isAutoReconnect);case 22:case"end":return gr.stop()}},Oe,this,[[9,16]])}))},L.login=function(_){return _===void 0&&(_=!1),Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return tr.prev=0,tr.next=3,this.auth.doLogin(_);case 3:Oe=tr.sent,this.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",code:200,succeed:!0}),this.reporter.reportTraceEnd("login",!0),this.status="logined",tr.next=20;break;case 9:if(tr.prev=9,tr.t0=tr.catch(0),de=tr.t0,this.logger.warn("nim login:: login failed",tr.t0),this.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",code:de.code||0,succeed:!1,description:de.message}),this.reporter.reportTraceEnd("login",!1),this.retryCount!==0){tr.next=18;break}throw this.doDisconnect(Va.ACTIVE,"FailedToInitializeLogin"),tr.t0;case 18:return this.doDisconnect(Va.OFFLINE,"ReconnectLoginFailed"),tr.abrupt("return");case 20:return tr.prev=20,tr.next=23,this.cloudStorage.init();case 23:tr.next=28;break;case 25:tr.prev=25,tr.t1=tr.catch(20),this.logger.error("NIM:login cloudStorage init failed ",tr.t1);case 28:if(this.eventBus.emit("logined",Oe),this.emit("logined",Oe),this.logger.log("login done"),this.resetConnectStatus(),!this.sync||!this.sync.doSync){tr.next=35;break}return tr.next=35,this.sync.doSync();case 35:this.ping();case 36:case"end":return tr.stop()}},re,this,[[0,9],[20,25]])}))},L.onMessage=function(_){var re,Oe,de=w.prototype.onMessage.call(this,_);if(de){var At=de.raw.ser,tr=this.sendingCmdMap.get(At);if(tr&&tr.cmd===de.cmd){var ur=tr.callback,gr=tr.timer,yr=tr.params;if(clearTimeout(gr),de.params=yr,this.sendingCmdMap.delete(At),de.cmd==="heartbeat")return void ur[0]();var Cr=(re=this[de.service])===null||re===void 0?void 0:re.process(de);Cr&&typeof Cr.then=="function"?Cr.then(function(xr){ur[0](xr)}).catch(function(xr){ur[1](xr)}):(this.logger.log("imsocket:: handlerFn without promise",de.service,de.cmd),ur[0]())}else(Oe=this[de.service])===null||Oe===void 0||Oe.process(de)}},L.getLbsInfos=function(){var _;return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de,At,tr,ur,gr,yr,Cr,xr;return ar.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Oe=this.options.lbsUrls[0],de=Ma(Oe).call(Oe,"?")>-1?"&":"?",At=Oe+de+"k="+this.options.appkey+"&id="+this.options.account+"&sv=180&pv=1&networkType=0",jr.prev=3,this.logger.log("getLbsInfos ",At),jr.next=7,this.adapters.request(At,{method:"GET",dataType:"json",timeout:1e4});case 7:if((ur=jr.sent).status===200&&ur.data){jr.next=11;break}throw this.logger.error("getLbsInfos::error status",ur.status,ur),new Error("getLbsInfos failed, status "+ur.status);case 11:this.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:At,code:200,succeed:!0}),gr=ur.data,yr=[this.options.linkUrl],Os(gr,"common.link")&&(yr=ks(Cr=Os(gr,"common.link")).call(Cr,yr)),Os(gr,'common["link.default"]')&&(yr=ks(yr).call(yr,Os(gr,'common["link.default"]'))),this.linkUrls=Tp(yr),ur.data["nos-chunk"]&&((_=this.cloudStorage)===null||_===void 0||_.setOptions({chunkUploadHost:ur.data["nos-chunk"]})),this.logger.log("getLbsInfos success, socket link:",Co(tr=this.linkUrls).call(tr,0),"chunkUploadHost: ",ur.data["nos-chunk"]),jr.next=27;break;case 21:jr.prev=21,jr.t0=jr.catch(3),xr=jr.t0,this.logger.error("getLbsInfos::error",xr),this.linkUrls=[this.options.linkUrl],this.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:At,description:xr.message,code:xr.code||0,succeed:!1});case 27:case"end":return jr.stop()}},re,this,[[3,21]])}))},L.disconnect=function(){var _=this;switch(this.status){case"logined":return this.sendCmd("logout",void 0,{timeout:1e3}).then(function(){w.prototype.doDisconnect.call(_,Va.ACTIVE,"UserActiveDisconnect")}).catch(function(re){_.logger.error("NIM::disconnect sendCmd:logout error",re),w.prototype.doDisconnect.call(_,Va.ACTIVE,"UserActiveDisconnect")});case"connected":case"connecting":case"waitReconnect":return w.prototype.doDisconnect.call(this,Va.ACTIVE,"UserActiveDisconnect"),uo.resolve();case"unconnected":case"destroyed":return uo.resolve()}},L.destroy=function(){return M.instance=null,w.prototype.destroy.call(this)},L.kick=function(_){return En({deviceIds:{type:"array",itemType:"string"}},_),this.auth.kick(_)},M.registerService=function(_,re){Np[re]=_},M}(Dv);Fa.instance=null;var Kv=Math.min,Gg=[].lastIndexOf,Qg=!!Gg&&1/[1].lastIndexOf(1,-0)<0,zT=Us("lastIndexOf"),Jg=Qg||!zT?function(M){if(Qg)return T(Gg,this,arguments)||0;var L=sr(this),$=Ia(L),_=$-1;for(arguments.length>1&&(_=Kv(_,$i(arguments[1]))),_<0&&(_=$+_);_>=0;_--)if(_ in L&&L[_]===M)return _||0;return-1}:Gg;Vr({target:"Array",proto:!0,forced:Jg!==[].lastIndexOf},{lastIndexOf:Jg});var KT=Uo("Array").lastIndexOf,Rp=Array.prototype,Yg=function(w){var M=w.lastIndexOf;return w===Rp||rr(Rp,w)&&M===Rp.lastIndexOf?KT:M},ql=o(function(w,M){(function(){var L={function:!0,object:!0}[typeof window]&&window||this,$=M,_=w&&!w.nodeType&&w,re=$&&_&&typeof e=="object"&&e;!re||re.global!==re&&re.window!==re&&re.self!==re||(L=re);var Oe=Math.pow(2,53)-1,de=/\bOpera/,At=Object.prototype,tr=At.hasOwnProperty,ur=At.toString;function gr(Kr){return(Kr=String(Kr)).charAt(0).toUpperCase()+Kr.slice(1)}function yr(Kr){return Kr=zr(Kr),/^(?:webOS|i(?:OS|P))/.test(Kr)?Kr:gr(Kr)}function Cr(Kr,kn){for(var Yn in Kr)tr.call(Kr,Yn)&&kn(Kr[Yn],Yn,Kr)}function xr(Kr){return Kr==null?gr(Kr):ur.call(Kr).slice(8,-1)}function Fr(Kr){return String(Kr).replace(/([ -])(?!$)/g,"$1?")}function jr(Kr,kn){var Yn=null;return function(xo,Ln){var _r=-1,Pn=xo?xo.length:0;if(typeof Pn=="number"&&Pn>-1&&Pn<=Oe)for(;++_r<Pn;)Ln(xo[_r],_r,xo);else Cr(xo,Ln)}(Kr,function(Hn,xo){Yn=kn(Yn,Hn,xo,Kr)}),Yn}function zr(Kr){return String(Kr).replace(/^ +| +$/g,"")}var Hr=function Kr(kn){var Yn=L,Hn=kn&&typeof kn=="object"&&xr(kn)!="String";Hn&&(Yn=kn,kn=null);var xo=Yn.navigator||{},Ln=xo.userAgent||"";kn||(kn=Ln);var _r,Pn,Fn=Hn?!!xo.likeChrome:/\bChrome\b/.test(kn)&&!/internal|\n/i.test(ur.toString()),_n="Object",bn=Hn?_n:"ScriptBridgingProxyObject",Rn=Hn?_n:"Environment",qn=Hn&&Yn.java?"JavaPackage":xr(Yn.java),no=Hn?_n:"RuntimeObject",ao=/\bJava/.test(qn)&&Yn.java,Ko=ao&&xr(Yn.environment)==Rn,Po=ao?"a":"",ja=ao?"b":"",Mo=Yn.document||{},Ao=Yn.operamini||Yn.opera,oa=de.test(oa=Hn&&Ao?Ao["[[Class]]"]:xr(Ao))?oa:Ao=null,Lc=kn,Fo=[],vc=null,Ka=kn==Ln,fo=Ka&&Ao&&typeof Ao.version=="function"&&Ao.version(),aa=function(Ra){return jr(Ra,function(ba,wa){return ba||RegExp("\\b"+(wa.pattern||Fr(wa))+"\\b","i").exec(kn)&&(wa.label||wa)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),Wn=function(Ra){return jr(Ra,function(ba,wa){return ba||RegExp("\\b"+(wa.pattern||Fr(wa))+"\\b","i").exec(kn)&&(wa.label||wa)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),qo=AC([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),ms=function(Ra){return jr(Ra,function(ba,wa,Kh){return ba||(wa[qo]||wa[/^[a-z]+(?: +[a-z]+\b)*/i.exec(qo)]||RegExp("\\b"+Fr(Kh)+"(?:\\b|\\w*\\d)","i").exec(kn))&&Kh})}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),Zn=function(Ra){return jr(Ra,function(ba,wa){var Kh=wa.pattern||Fr(wa);return!ba&&(ba=RegExp("\\b"+Kh+"(?:/[\\d.]+|[ \\w.]*)","i").exec(kn))&&(ba=function(Ml,xC,IC){var EC={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return xC&&IC&&/^Win/i.test(Ml)&&!/^Windows Phone /i.test(Ml)&&(EC=EC[/[\d.]+$/.exec(Ml)])&&(Ml="Windows "+EC),Ml=String(Ml),xC&&IC&&(Ml=Ml.replace(RegExp(xC,"i"),IC)),yr(Ml.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(ba,Kh,wa.label||wa)),ba})}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function AC(ri){return jr(ri,function(Ra,ba){var wa=ba.pattern||Fr(ba);return!Ra&&(Ra=RegExp("\\b"+wa+" *\\d+[.\\w_]*","i").exec(kn)||RegExp("\\b"+wa+" *\\w+-[\\w]*","i").exec(kn)||RegExp("\\b"+wa+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(kn))&&((Ra=String(ba.label&&!RegExp(wa,"i").test(ba.label)?ba.label:Ra).split("/"))[1]&&!/[\d.]+/.test(Ra[0])&&(Ra[0]+=" "+Ra[1]),ba=ba.label||ba,Ra=yr(Ra[0].replace(RegExp(wa,"i"),ba).replace(RegExp("; *(?:"+ba+"[_-])?","i")," ").replace(RegExp("("+ba+")[-_.]?(\\w)","i"),"$1 $2"))),Ra})}function OC(ri){return jr(ri,function(Ra,ba){return Ra||(RegExp(ba+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(kn)||0)[1]||null})}if(aa&&(aa=[aa]),/\bAndroid\b/.test(Zn)&&!qo&&(_r=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(kn))&&(qo=zr(_r[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),ms&&!qo?qo=AC([ms]):ms&&qo&&(qo=qo.replace(RegExp("^("+Fr(ms)+")[-_.\\s]","i"),ms+" ").replace(RegExp("^("+Fr(ms)+")[-_.]?(\\w)","i"),ms+" $2")),(_r=/\bGoogle TV\b/.exec(qo))&&(qo=_r[0]),/\bSimulator\b/i.test(kn)&&(qo=(qo?qo+" ":"")+"Simulator"),Wn=="Opera Mini"&&/\bOPiOS\b/.test(kn)&&Fo.push("running in Turbo/Uncompressed mode"),Wn=="IE"&&/\blike iPhone OS\b/.test(kn)?(ms=(_r=Kr(kn.replace(/like iPhone OS/,""))).manufacturer,qo=_r.product):/^iP/.test(qo)?(Wn||(Wn="Safari"),Zn="iOS"+((_r=/ OS ([\d_]+)/i.exec(kn))?" "+_r[1].replace(/_/g,"."):"")):Wn=="Konqueror"&&/^Linux\b/i.test(Zn)?Zn="Kubuntu":ms&&ms!="Google"&&(/Chrome/.test(Wn)&&!/\bMobile Safari\b/i.test(kn)||/\bVita\b/.test(qo))||/\bAndroid\b/.test(Zn)&&/^Chrome/.test(Wn)&&/\bVersion\//i.test(kn)?(Wn="Android Browser",Zn=/\bAndroid\b/.test(Zn)?Zn:"Android"):Wn=="Silk"?(/\bMobi/i.test(kn)||(Zn="Android",Fo.unshift("desktop mode")),/Accelerated *= *true/i.test(kn)&&Fo.unshift("accelerated")):Wn=="UC Browser"&&/\bUCWEB\b/.test(kn)?Fo.push("speed mode"):Wn=="PaleMoon"&&(_r=/\bFirefox\/([\d.]+)\b/.exec(kn))?Fo.push("identifying as Firefox "+_r[1]):Wn=="Firefox"&&(_r=/\b(Mobile|Tablet|TV)\b/i.exec(kn))?(Zn||(Zn="Firefox OS"),qo||(qo=_r[1])):!Wn||(_r=!/\bMinefield\b/i.test(kn)&&/\b(?:Firefox|Safari)\b/.exec(Wn))?(Wn&&!qo&&/[\/,]|^[^(]+?\)/.test(kn.slice(kn.indexOf(_r+"/")+8))&&(Wn=null),(_r=qo||ms||Zn)&&(qo||ms||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(Zn))&&(Wn=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(Zn)?Zn:_r)+" Browser")):Wn=="Electron"&&(_r=(/\bChrome\/([\d.]+)\b/.exec(kn)||0)[1])&&Fo.push("Chromium "+_r),fo||(fo=OC(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",Fr(Wn),"(?:Firefox|Minefield|NetFront)"])),(_r=(aa=="iCab"&&parseFloat(fo)>3?"WebKit":/\bOpera\b/.test(Wn)&&(/\bOPR\b/.test(kn)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(kn)&&!/^(?:Trident|EdgeHTML)$/.test(aa)&&"WebKit"||!aa&&/\bMSIE\b/i.test(kn)&&(Zn=="Mac OS"?"Tasman":"Trident")||aa=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(Wn)&&"NetFront")&&(aa=[_r]),Wn=="IE"&&(_r=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(kn)||0)[1])?(Wn+=" Mobile",Zn="Windows Phone "+(/\+$/.test(_r)?_r:_r+".x"),Fo.unshift("desktop mode")):/\bWPDesktop\b/i.test(kn)?(Wn="IE Mobile",Zn="Windows Phone 8.x",Fo.unshift("desktop mode"),fo||(fo=(/\brv:([\d.]+)/.exec(kn)||0)[1])):Wn!="IE"&&aa=="Trident"&&(_r=/\brv:([\d.]+)/.exec(kn))&&(Wn&&Fo.push("identifying as "+Wn+(fo?" "+fo:"")),Wn="IE",fo=_r[1]),Ka){if(function(Ra,ba){var wa=Ra!=null?typeof Ra[ba]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(wa)||wa=="object"&&!Ra[ba])}(Yn,"global"))if(ao&&(Lc=(_r=ao.lang.System).getProperty("os.arch"),Zn=Zn||_r.getProperty("os.name")+" "+_r.getProperty("os.version")),Ko){try{fo=Yn.require("ringo/engine").version.join("."),Wn="RingoJS"}catch{(_r=Yn.system)&&_r.global.system==Yn.system&&(Wn="Narwhal",Zn||(Zn=_r[0].os||null))}Wn||(Wn="Rhino")}else typeof Yn.process=="object"&&!Yn.process.browser&&(_r=Yn.process)&&(typeof _r.versions=="object"&&(typeof _r.versions.electron=="string"?(Fo.push("Node "+_r.versions.node),Wn="Electron",fo=_r.versions.electron):typeof _r.versions.nw=="string"&&(Fo.push("Chromium "+fo,"Node "+_r.versions.node),Wn="NW.js",fo=_r.versions.nw)),Wn||(Wn="Node.js",Lc=_r.arch,Zn=_r.platform,fo=(fo=/[\d.]+/.exec(_r.version))?fo[0]:null));else xr(_r=Yn.runtime)==bn?(Wn="Adobe AIR",Zn=_r.flash.system.Capabilities.os):xr(_r=Yn.phantom)==no?(Wn="PhantomJS",fo=(_r=_r.version||null)&&_r.major+"."+_r.minor+"."+_r.patch):typeof Mo.documentMode=="number"&&(_r=/\bTrident\/(\d+)/i.exec(kn))?(fo=[fo,Mo.documentMode],(_r=+_r[1]+4)!=fo[1]&&(Fo.push("IE "+fo[1]+" mode"),aa&&(aa[1]=""),fo[1]=_r),fo=Wn=="IE"?String(fo[1].toFixed(1)):fo[0]):typeof Mo.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(Wn)&&(Fo.push("masking as "+Wn+" "+fo),Wn="IE",fo="11.0",aa=["Trident"],Zn="Windows");Zn=Zn&&yr(Zn)}if(fo&&(_r=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(fo)||/(?:alpha|beta)(?: ?\d)?/i.exec(kn+";"+(Ka&&xo.appMinorVersion))||/\bMinefield\b/i.test(kn)&&"a")&&(vc=/b/i.test(_r)?"beta":"alpha",fo=fo.replace(RegExp(_r+"\\+?$"),"")+(vc=="beta"?ja:Po)+(/\d+\+?/.exec(_r)||"")),Wn=="Fennec"||Wn=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(Zn))Wn="Firefox Mobile";else if(Wn=="Maxthon"&&fo)fo=fo.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(qo))qo=="Xbox 360"&&(Zn=null),qo=="Xbox 360"&&/\bIEMobile\b/.test(kn)&&Fo.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(Wn)&&(!Wn||qo||/Browser|Mobi/.test(Wn))||Zn!="Windows CE"&&!/Mobi/i.test(kn))if(Wn=="IE"&&Ka)try{Yn.external===null&&Fo.unshift("platform preview")}catch{Fo.unshift("embedded")}else(/\bBlackBerry\b/.test(qo)||/\bBB10\b/.test(kn))&&(_r=(RegExp(qo.replace(/ +/g," *")+"/([.\\d]+)","i").exec(kn)||0)[1]||fo)?(Zn=((_r=[_r,/BB10/.test(kn)])[1]?(qo=null,ms="BlackBerry"):"Device Software")+" "+_r[0],fo=null):this!=Cr&&qo!="Wii"&&(Ka&&Ao||/Opera/.test(Wn)&&/\b(?:MSIE|Firefox)\b/i.test(kn)||Wn=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(Zn)||Wn=="IE"&&(Zn&&!/^Win/.test(Zn)&&fo>5.5||/\bWindows XP\b/.test(Zn)&&fo>8||fo==8&&!/\bTrident\b/.test(kn)))&&!de.test(_r=Kr.call(Cr,kn.replace(de,"")+";"))&&_r.name&&(_r="ing as "+_r.name+((_r=_r.version)?" "+_r:""),de.test(Wn)?(/\bIE\b/.test(_r)&&Zn=="Mac OS"&&(Zn=null),_r="identify"+_r):(_r="mask"+_r,Wn=oa?yr(oa.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(_r)&&(Zn=null),Ka||(fo=null)),aa=["Presto"],Fo.push(_r));else Wn+=" Mobile";(_r=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(kn)||0)[1])&&(_r=[parseFloat(_r.replace(/\.(\d)$/,".0$1")),_r],Wn=="Safari"&&_r[1].slice(-1)=="+"?(Wn="WebKit Nightly",vc="alpha",fo=_r[1].slice(0,-1)):fo!=_r[1]&&fo!=(_r[2]=(/\bSafari\/([\d.]+\+?)/i.exec(kn)||0)[1])||(fo=null),_r[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(kn)||0)[1],_r[0]==537.36&&_r[2]==537.36&&parseFloat(_r[1])>=28&&aa=="WebKit"&&(aa=["Blink"]),Ka&&(Fn||_r[1])?(aa&&(aa[1]="like Chrome"),_r=_r[1]||((_r=_r[0])<530?1:_r<532?2:_r<532.05?3:_r<533?4:_r<534.03?5:_r<534.07?6:_r<534.1?7:_r<534.13?8:_r<534.16?9:_r<534.24?10:_r<534.3?11:_r<535.01?12:_r<535.02?"13+":_r<535.07?15:_r<535.11?16:_r<535.19?17:_r<536.05?18:_r<536.1?19:_r<537.01?20:_r<537.11?"21+":_r<537.13?23:_r<537.18?24:_r<537.24?25:_r<537.36?26:aa!="Blink"?"27":"28")):(aa&&(aa[1]="like Safari"),_r=(_r=_r[0])<400?1:_r<500?2:_r<526?3:_r<533?4:_r<534?"4+":_r<535?5:_r<537?6:_r<538?7:_r<601?8:_r<602?9:_r<604?10:_r<606?11:_r<608?12:"12"),aa&&(aa[1]+=" "+(_r+=typeof _r=="number"?".x":/[.+]/.test(_r)?"":"+")),Wn=="Safari"&&(!fo||parseInt(fo)>45)?fo=_r:Wn=="Chrome"&&/\bHeadlessChrome/i.test(kn)&&Fo.unshift("headless")),Wn=="Opera"&&(_r=/\bzbov|zvav$/.exec(Zn))?(Wn+=" ",Fo.unshift("desktop mode"),_r=="zvav"?(Wn+="Mini",fo=null):Wn+="Mobile",Zn=Zn.replace(RegExp(" *"+_r+"$"),"")):Wn=="Safari"&&/\bChrome\b/.exec(aa&&aa[1])?(Fo.unshift("desktop mode"),Wn="Chrome Mobile",fo=null,/\bOS X\b/.test(Zn)?(ms="Apple",Zn="iOS 4.3+"):Zn=null):/\bSRWare Iron\b/.test(Wn)&&!fo&&(fo=OC("Chrome")),fo&&fo.indexOf(_r=/[\d.]+$/.exec(Zn))==0&&kn.indexOf("/"+_r+"-")>-1&&(Zn=zr(Zn.replace(_r,""))),Zn&&Zn.indexOf(Wn)!=-1&&!RegExp(Wn+" OS").test(Zn)&&(Zn=Zn.replace(RegExp(" *"+Fr(Wn)+" *"),"")),aa&&!/\b(?:Avant|Nook)\b/.test(Wn)&&(/Browser|Lunascape|Maxthon/.test(Wn)||Wn!="Safari"&&/^iOS/.test(Zn)&&/\bSafari\b/.test(aa[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(Wn)&&aa[1])&&(_r=aa[aa.length-1])&&Fo.push(_r),Fo.length&&(Fo=["("+Fo.join("; ")+")"]),ms&&qo&&qo.indexOf(ms)<0&&Fo.push("on "+ms),qo&&Fo.push((/^on /.test(Fo[Fo.length-1])?"":"on ")+qo),Zn&&(_r=/ ([\d.+]+)$/.exec(Zn),Pn=_r&&Zn.charAt(Zn.length-_r[0].length-1)=="/",Zn={architecture:32,family:_r&&!Pn?Zn.replace(_r[0],""):Zn,version:_r?_r[1]:null,toString:function(){var ri=this.version;return this.family+(ri&&!Pn?" "+ri:"")+(this.architecture==64?" 64-bit":"")}}),(_r=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Lc))&&!/\bi686\b/i.test(Lc)?(Zn&&(Zn.architecture=64,Zn.family=Zn.family.replace(RegExp(" *"+_r),"")),Wn&&(/\bWOW64\b/i.test(kn)||Ka&&/\w(?:86|32)$/.test(xo.cpuClass||xo.platform)&&!/\bWin64; x64\b/i.test(kn))&&Fo.unshift("32-bit")):Zn&&/^OS X/.test(Zn.family)&&Wn=="Chrome"&&parseFloat(fo)>=39&&(Zn.architecture=64),kn||(kn=null);var Gs={};return Gs.description=kn,Gs.layout=aa&&aa[0],Gs.manufacturer=ms,Gs.name=Wn,Gs.prerelease=vc,Gs.product=qo,Gs.ua=kn,Gs.version=Wn&&fo,Gs.os=Zn||{architecture:null,family:null,version:null,toString:function(){return"null"}},Gs.parse=Kr,Gs.toString=function(){return this.description||""},Gs.version&&Fo.unshift(fo),Gs.name&&Fo.unshift(Wn),Zn&&Wn&&(Zn!=String(Zn).split(" ")[0]||Zn!=Wn.split(" ")[0]&&!qo)&&Fo.push(qo?"("+Zn+")":"on "+Zn),Fo.length&&(Gs.description=Fo.join(" ")),Gs}();$&&_?Cr(Hr,function(Kr,kn){$[kn]=Kr}):L.platform=Hr}).call(e)}),WT=Math.floor,Xg=function(w,M){var L=w.length,$=WT(L/2);return L<8?Zg(w,M):GT(w,Xg(mu(w,0,$),M),Xg(mu(w,$),M),M)},Zg=function(w,M){for(var L,$,_=w.length,re=1;re<_;){for($=re,L=w[re];$&&M(w[$-1],L)>0;)w[$]=w[--$];$!==re++&&(w[$]=L)}return w},GT=function(w,M,L,$){for(var _=M.length,re=L.length,Oe=0,de=0;Oe<_||de<re;)w[Oe+de]=Oe<_&&de<re?$(M[Oe],L[de])<=0?M[Oe++]:L[de++]:Oe<_?M[Oe++]:L[de++];return w},eh=Xg,Wv=or.match(/firefox\/(\d+)/i),yd=!!Wv&&+Wv[1],Ta=/MSIE|Trident/.test(or),Gv=or.match(/AppleWebKit\/(\d+)\./),th=!!Gv&&+Gv[1],ac=[],Qv=he(ac.sort),Jv=he(ac.push),QT=c(function(){ac.sort(void 0)}),Yv=c(function(){ac.sort(null)}),Xv=Us("sort"),Zv=!c(function(){if(mr)return mr<70;if(!(yd&&yd>3)){if(Ta)return!0;if(th)return th<603;var w,M,L,$,_="";for(w=65;w<76;w++){switch(M=String.fromCharCode(w),w){case 66:case 69:case 70:case 72:L=3;break;case 68:case 71:L=4;break;default:L=2}for($=0;$<47;$++)ac.push({k:M+$,v:L})}for(ac.sort(function(re,Oe){return Oe.v-re.v}),$=0;$<ac.length;$++)M=ac[$].k.charAt(0),_.charAt(_.length-1)!==M&&(_+=M);return _!=="DGBEFHACIJK"}});Vr({target:"Array",proto:!0,forced:QT||!Yv||!Xv||!Zv},{sort:function(M){M!==void 0&&Or(M);var L=$n(this);if(Zv)return M===void 0?Qv(L):Qv(L,M);var $,_,re=[],Oe=Ia(L);for(_=0;_<Oe;_++)_ in L&&Jv(re,L[_]);for(eh(re,function(de){return function(At,tr){return tr===void 0?-1:At===void 0?1:de!==void 0?+de(At,tr)||0:Oa(At)>Oa(tr)?1:-1}}(M)),$=Ia(re),_=0;_<$;)L[_]=re[_++];for(;_<Oe;)wp(L,_++);return L}});var JT=Uo("Array").sort,rh=Array.prototype,wc=function(w){var M=w.sort;return w===rh||rr(rh,w)&&M===rh.sort?JT:M},nh=o(function(w,M){w.exports=function(){var L={d:function(_r,Pn){for(var Fn in Pn)L.o(Pn,Fn)&&!L.o(_r,Fn)&&Wi(_r,Fn,{enumerable:!0,get:Pn[Fn]})},o:function(_r,Pn){return Object.prototype.hasOwnProperty.call(_r,Pn)}},$={};L.d($,{default:function(){return xo}});var _=function Ln(_r){for(var Pn in function(Fn,_n){if(!(Fn instanceof _n))throw new TypeError("Cannot call a class as a function")}(this,Ln),this.directUploadAddr="https://wanproxy-web.127.net",this.retryCount=4,this.trunkSize=4194304,this.trunkUploadTimeout=5e4,this.getOffsetTimeout=1e4,this.version="1.0",this.enableCache=!0,this.logger=console,this.onError=function(Fn){},this.onProgress=function(Fn){},this.onUploadProgress=function(Fn){},this.onComplete=function(Fn){},_r)this[Pn]=_r[Pn]};function re(Ln,_r){var Pn=ga!==void 0&&gd(Ln)||Ln["@@iterator"];if(!Pn){if(hi(Ln)||(Pn=function(no,ao){if(no){var Ko;if(typeof no=="string")return Oe(no,ao);var Po=Co(Ko=Object.prototype.toString.call(no)).call(Ko,8,-1);return Po==="Object"&&no.constructor&&(Po=no.constructor.name),Po==="Map"||Po==="Set"?Ep(no):Po==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Po)?Oe(no,ao):void 0}}(Ln))||_r&&Ln&&typeof Ln.length=="number"){Pn&&(Ln=Pn);var Fn=0,_n=function(){};return{s:_n,n:function(){return Fn>=Ln.length?{done:!0}:{done:!1,value:Ln[Fn++]}},e:function(ao){throw ao},f:_n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var bn,Rn=!0,qn=!1;return{s:function(){Pn=Pn.call(Ln)},n:function(){var ao=Pn.next();return Rn=ao.done,ao},e:function(ao){qn=!0,bn=ao},f:function(){try{Rn||Pn.return==null||Pn.return()}finally{if(qn)throw bn}}}}function Oe(Ln,_r){(_r==null||_r>Ln.length)&&(_r=Ln.length);for(var Pn=0,Fn=new Array(_r);Pn<_r;Pn++)Fn[Pn]=Ln[Pn];return Fn}var de=window.localStorage;window.localStorage&&typeof window.localStorage.getItem=="function"&&typeof window.localStorage.setItem=="function"&&typeof window.localStorage.removeItem=="function"||(de={privateObj:{},setItem:function(_r,Pn){de.privateObj[_r]=Pn},getItem:function(_r){return de.privateObj[_r]},removeItem:function(_r){delete de.privateObj[_r]},getKeys:function(){return Vo(de.privateObj)}});var At={getFileKey:function(_r){var Pn=_r.size.toString(),Fn=_r.lastModified.toString();return"_NosUploader_"+_r.name+Co(Pn).call(Pn,Pn.length-5)+Co(Fn).call(Fn,Fn.length-5)},getFileInfo:function(_r){var Pn=de.getItem(_r);if(!Pn)return null;try{return JSON.parse(Pn)}catch{return null}},initFile:function(_r,Pn,Fn){At.clearExpiredInfo();var _n=this.getFileKey(Pn),bn={ctx:_r.ctx!==void 0?_r.ctx:"",bucket:_r.bucketName,obj:_r.objectName,token:_r.token,modifyAt:sa(),end:!1};return _r.payload&&(bn.payload=_r.payload),Fn&&de.setItem(_n,Wo(bn)),_n},setUploadContext:function(_r,Pn,Fn){var _n=this.getFileInfo(_r);_n&&(_n.ctx=Pn,Fn&&de.setItem(_r,Wo(_n)))},setComplete:function(_r,Pn){var Fn=this.getFileInfo(_r);Fn&&(Fn.modifyAt=sa(),Fn.end=!0,Pn&&de.setItem(_r,Wo(Fn)))},getUploadContext:function(_r){var Pn=this.getFileInfo(_r);return Pn?Pn.ctx:""},removeFileInfo:function(_r){Ma(_r).call(_r,"_NosUploader_")===0&&de.removeItem(_r)},clearExpiredInfo:function(){var _r,Pn=typeof de.getKeys=="function"?de.getKeys():Vo(de),Fn=sa(),_n=[],bn=re(Pn);try{for(bn.s();!(_r=bn.n()).done;){var Rn=_r.value;if(Ma(Rn).call(Rn,"_NosUploader_")===0){var qn=At.getFileInfo(Rn);qn===null||Fn-qn.modifyAt>xo.expireTime?de.removeItem(Rn):_n.push({fileInfo:qn,key:Rn})}}}catch(Mo){bn.e(Mo)}finally{bn.f()}if(_n.length>xo.maxFileCache){var no,ao,Ko=re(Co(no=wc(_n).call(_n,function(Mo,Ao){return Ao.fileInfo.modifyAt-Mo.fileInfo.modifyAt})).call(no,xo.maxFileCache));try{for(Ko.s();!(ao=Ko.n()).done;){var Po,ja=ao.value;Ma(Po=ja.key).call(Po,"_NosUploader_")===0&&de.removeItem(ja.key)}}catch(Mo){Ko.e(Mo)}finally{Ko.f()}}}},tr=At;function ur(Ln){return(ur=typeof ga=="function"&&typeof cm=="symbol"?function(_r){return typeof _r}:function(_r){return _r&&typeof ga=="function"&&_r.constructor===ga&&_r!==ga.prototype?"symbol":typeof _r})(Ln)}function gr(Ln,_r){return!_r||ur(_r)!=="object"&&typeof _r!="function"?function(Pn){if(Pn===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Pn}(Ln):_r}function yr(Ln){var _r=typeof tc=="function"?new tc:void 0;return(yr=function(Fn){var _n,bn;if(Fn===null||(bn=Fn,Ma(_n=Function.toString.call(bn)).call(_n,"[native code]")===-1))return Fn;if(typeof Fn!="function")throw new TypeError("Super expression must either be null or a function");if(_r!==void 0){if(_r.has(Fn))return _r.get(Fn);_r.set(Fn,Rn)}function Rn(){return Cr(Fn,arguments,jr(this).constructor)}return Rn.prototype=Ja(Fn.prototype,{constructor:{value:Rn,enumerable:!1,writable:!0,configurable:!0}}),Fr(Rn,Fn)})(Ln)}function Cr(Ln,_r,Pn){return(Cr=xr()?Ii:function(Fn,_n,bn){var Rn=[null];Rn.push.apply(Rn,_n);var qn=new(Oo(Function).apply(Fn,Rn));return bn&&Fr(qn,bn.prototype),qn}).apply(null,arguments)}function xr(){if(typeof Reflect>"u"||!Ii||Ii.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Ii(Boolean,[],function(){})),!0}catch{return!1}}function Fr(Ln,_r){return(Fr=Rs||function(Pn,Fn){return Pn.__proto__=Fn,Pn})(Ln,_r)}function jr(Ln){return(jr=Rs?Ds:function(_r){return _r.__proto__||Ds(_r)})(Ln)}var zr=function(Ln){(function(bn,Rn){if(typeof Rn!="function"&&Rn!==null)throw new TypeError("Super expression must either be null or a function");bn.prototype=Ja(Rn&&Rn.prototype,{constructor:{value:bn,writable:!0,configurable:!0}}),Rn&&Fr(bn,Rn)})(_n,Ln);var _r,Pn,Fn=(_r=_n,Pn=xr(),function(){var bn,Rn=jr(_r);if(Pn){var qn=jr(this).constructor;bn=Ii(Rn,arguments,qn)}else bn=Rn.apply(this,arguments);return gr(this,bn)});function _n(bn,Rn){var qn;return function(no,ao){if(!(no instanceof ao))throw new TypeError("Cannot call a class as a function")}(this,_n),(qn=Fn.call(this,"NosUploadError:"+bn)).errCode=Rn,qn.errMsg=bn,qn}return _n}(yr(Error)),Hr=function Ln(_r,Pn,Fn){if(_r.uploadState==="uploading"){var _n=_r.config,bn=_r.param,Rn=tr.getUploadContext(_r.fileKey);if(!Rn)return Fn(0);var qn=new XMLHttpRequest,no=_n.directUploadAddr+"/".concat(bn.bucketName)+"/".concat(encodeURIComponent(bn.objectName))+"?uploadContext"+"&context=".concat(Rn)+"&version=".concat(_n.version);qn.onreadystatechange=function(){var ao;if(_r.uploadState!=="abort"&&qn.readyState===4){var Ko,Po,ja,Mo;try{Mo=JSON.parse(qn.responseText)}catch{Mo={errMsg:"JsonParseError in getOffset",errCode:500}}qn.status===200?Mo.errCode?_r.config.onError(new zr(Mo.errMsg,Mo.errCode)):Fn(Mo.offset):qn.status.toString().match(/^5/)?Ln(_r,Pn-1,Fn):Pn>0?(typeof((ao=_n.logger)===null||ao===void 0?void 0:ao.error)=="function"&&_n.logger.error(ks(Ko="getOffset(".concat(no,") error. retry after 3 seconds. ")).call(Ko,new Date().toTimeString())),ho(function(){Ln(_r,Pn-1,Fn)},3500)):(tr.removeFileInfo(_r.fileKey),qn.status?_n.onError(new zr(ks(Po=ks(ja="getOffset(".concat(no,") error: ")).call(ja,qn.status," ")).call(Po,qn.statusText))):_n.onError(new zr("getOffset(".concat(no,") error. no Error Code"))))}},qn.open("get",no),qn.setRequestHeader("x-nos-token",bn.token),qn.timeout=_n.getOffsetTimeout,qn.send()}},Kr=function Ln(_r,Pn,Fn,_n){if(_r.uploadState==="uploading"){var bn=_r.param,Rn=_r.config,qn=Co(File.prototype),no=bn.ctx!==void 0?bn.ctx:"",ao=Pn+Rn.trunkSize>_r.file.size,Ko=ao?_r.file.size:Pn+Rn.trunkSize,Po=new XMLHttpRequest,ja=Rn.directUploadAddr+"/".concat(bn.bucketName)+"/".concat(encodeURIComponent(bn.objectName));if(Po.upload.onprogress=function(Ao){if(_r.uploadState!=="abort"){var oa=0;Ao.lengthComputable?(oa=(Pn+Ao.loaded)/_r.file.size,Rn.onProgress(oa),Rn.onUploadProgress({loaded:Ao.loaded,total:_r.file.size,percentage:oa,percentageText:(100*oa).toFixed(2)+"%"})):Rn.onError(new zr("browser does not support query upload progress"))}},Po.onreadystatechange=function(){var Ao,oa;if(_r.uploadState!=="abort"&&Po.readyState===4){var Lc,Fo,vc,Ka;try{Ka=JSON.parse(Po.responseText)}catch(fo){typeof((Ao=Rn.logger)===null||Ao===void 0?void 0:Ao.error)=="function"&&Rn.logger.error("JsonParseError in uploadTrunk",fo),Ka={errMsg:"JsonParseError in uploadTrunk"}}Po.status===200?(_r.setContext(Ka.context),ao?(_n(),_r.setComplete()):Ln(_r,Ka.offset,Rn.retryCount,_n)):Po.status.toString().match(/^5/)?Fn>0?Ln(_r,Pn,Fn-1,_n):(tr.removeFileInfo(_r.fileKey),Rn.onError(new zr(Ka.errMsg,Ka.errCode))):Fn>0?(typeof((oa=Rn.logger)===null||oa===void 0?void 0:oa.error)=="function"&&Rn.logger.error(ks(Lc="uploadTrunk(".concat(ja,") error. retry after 3 seconds. ")).call(Lc,new Date().toTimeString())),ho(function(){Ln(_r,Pn,Fn-1,_n)},3500)):(tr.removeFileInfo(_r.fileKey),Po.status?Rn.onError(new zr(ks(Fo=ks(vc="uploadTrunk(".concat(ja,") error: ")).call(vc,Po.status," ")).call(Fo,Po.statusText))):Rn.onError(new zr("uploadTrunk(".concat(ja,") error. no Error Code. Please check your network"))))}},Po.open("post",ja+"?offset=".concat(Pn)+"&complete=".concat(ao)+"&context=".concat(no)+"&version=".concat(Rn.version)),Po.setRequestHeader("x-nos-token",bn.token),_r.file.type&&Po.setRequestHeader("content-type",_r.file.type),Po.timeout=Rn.trunkUploadTimeout,typeof FileReader<"u"){var Mo=new FileReader;Mo.addEventListener("load",function(Ao){var oa;!((oa=Ao==null?void 0:Ao.target)===null||oa===void 0)&&oa.result?Po.send(Ao.target.result):Rn.onError(new zr("Read ArrayBuffer failed"))}),Mo.addEventListener("error",function(Ao){var oa=Ao.target.error;Rn.onError(new zr("Read ArrayBuffer error. ".concat(oa.toString()),oa.code))}),Mo.readAsArrayBuffer(qn.call(_r.file,Pn,Ko))}else Po.send(qn.call(_r.file,Pn,Ko))}};function kn(Ln,_r){for(var Pn=0;Pn<_r.length;Pn++){var Fn=_r[Pn];Fn.enumerable=Fn.enumerable||!1,Fn.configurable=!0,"value"in Fn&&(Fn.writable=!0),Wi(Ln,Fn.key,Fn)}}var Yn=function(){function Ln(Pn,Fn,_n){(function(bn,Rn){if(!(bn instanceof Rn))throw new TypeError("Cannot call a class as a function")})(this,Ln),this.uploadState="paused",this.config=_n,this.file=Pn,this.param=Fn,this.fileKey=tr.initFile(Fn,Pn,this.config.enableCache),this.resume()}var _r;return(_r=[{key:"resume",value:function(){var Fn=this;if(this.uploadState!=="uploading"){this.setUploadState("uploading");var _n=this.config;Hr(this,_n.retryCount,function(bn){Kr(Fn,bn,_n.retryCount,function(){Fn.setUploadState("ended"),typeof _n.onComplete=="function"&&_n.onComplete(Fn.param)})})}}},{key:"pause",value:function(){this.setUploadState("paused")}},{key:"abort",value:function(){this.setUploadState("abort"),tr.removeFileInfo(this.fileKey),this.config.onError(new zr("Upload Aborted",10499))}},{key:"setUploadState",value:function(Fn){Fn!==this.uploadState&&(this.uploadState=Fn)}},{key:"setContext",value:function(Fn){tr.setUploadContext(this.fileKey,Fn,this.config.enableCache),this.param.ctx=Fn}},{key:"setComplete",value:function(){tr.setComplete(this.fileKey,this.config.enableCache),this.setUploadState("ended")}}])&&kn(Ln.prototype,_r),Ln}(),Hn={maxFileCache:6,expireTime:864e5,getFileUploadInformation:function(_r){var Pn=tr.getFileKey(_r),Fn=tr.getFileInfo(Pn);return Fn===null?null:sa()-Fn.modifyAt>Hn.expireTime?(tr.removeFileInfo(Pn),null):{uploadInfo:Mr({bucketName:Fn.bucket,objectName:Fn.obj,token:Fn.token,ctx:Fn.ctx},Fn.payload?{payload:Fn.payload}:{}),complete:Fn.end}},setMaxFileCache:function(_r){Hn.maxFileCache=_r},setExpireTime:function(_r){Hn.expireTime=_r},printCaches:function(){for(var _r=0,Pn=Vo(localStorage);_r<Pn.length;_r++){var Fn=Pn[_r],_n=tr.getFileInfo(Fn);_n&&console.log(_n,"modifiedAt",new Date(_n.modifyAt).toTimeString())}},createConfig:function(_r){return new _(_r)},createTask:function(_r,Pn,Fn){return new Yn(_r,Pn,Fn)}},xo=Hn;return $.default}()}),YT=o(function(w,M){w.exports=function(){function L(Oe){if(Oe){var de,At="";return In(de=Vo(Oe)).call(de,function(tr,ur){At+=ur===0?"?":"&",At+=tr+"="+Oe[tr]}),At}return""}function $(Oe,de,At,tr){return Error.call(this,At),this.source=Oe,this.code=de,this.desc=At,this.detail=tr||{},this}function _(Oe,de){var At=Ja(de.prototype);At.constructor=Oe,Oe.prototype=At}function re(Oe,de){de===void 0&&(de={dataType:"json",method:"GET",timeout:5e3});var At=de.dataType==="text"?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",tr=de.method==="GET"?L(de.params):"";return new uo(function(ur,gr){if(window.XMLHttpRequest){var yr,Cr=new XMLHttpRequest;if(Cr.onreadystatechange=function(){if(Cr.readyState===4)if(Cr.status===200){try{yr=JSON.parse(Cr.response||"{}")}catch{yr=Cr.response}ur({status:Cr.status,data:yr})}else gr(new $(1,Cr.status,Cr.statusText))},Cr.open(de.method,""+Oe+tr),Cr.timeout=de.timeout||5e3,Cr.setRequestHeader("Content-Type",At),de.headers)for(var xr in de.headers)Cr.setRequestHeader(xr,de.headers[xr]);Cr.ontimeout=function(Fr){gr(new $(1,408,Fr&&Fr.message?Fr.message:"request timeout"))},Cr.send(Wo(de.data))}else gr(new $(2,10400,"request no suppout"))})}return _($,Error),re}()}),ey=console,sc,Da,Vl,ha,Xs,ty={setLogger:function(M){ey=M},platform:"BROWSER",localStorage:window.localStorage,request:YT,WebSocket:window.WebSocket,uploadFile:function(M){return Sn(this,void 0,void 0,ar.mark(function L(){var $,_,re,Oe,de,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:if(M.fileInput||M.file){ur.next=2;break}throw new Error("File not exist");case 2:if(!M.file){ur.next=6;break}Oe=M.file,ur.next=20;break;case 6:if(typeof M.fileInput!="string"){ur.next=15;break}if(!((de=document.getElementById(M.fileInput))&&de.files&&de.files[0])){ur.next=12;break}Oe=de.files[0],ur.next=13;break;case 12:throw new Error("Can not get file from fileInput");case 13:ur.next=20;break;case 15:if(!(M.fileInput&&M.fileInput.files&&M.fileInput.files[0])){ur.next=19;break}Oe=M.fileInput.files[0],ur.next=20;break;case 19:throw new Error("Can not get file from fileInput "+M.fileInput);case 20:if(!(M.maxSize&&Oe.size>M.maxSize)){ur.next=22;break}throw new Error("The file exceeds maxSize limit. maxSize: "+M.maxSize+", get "+Oe.size);case 22:return ur.next=24,new uo(function(gr,yr){var Cr=nh.createConfig({enableCache:!1,directUploadAddr:M.chunkUploadHost,onError:function(jr){yr(jr)},onProgress:M.onUploadProgress||function(){},onComplete:function(jr){gr(jr)}}),xr=nh.createTask(Oe,{bucketName:M.nosToken.bucket,objectName:decodeURIComponent(M.nosToken.objectName),token:M.nosToken.token},Cr);try{M.onUploadStart&&M.onUploadStart(xr)}catch(Fr){ey.error("Adapter uploadFile: options.onUploadStart error",Fr&&Fr.message),xr.abort(),yr(Fr)}});case 24:return(At=ur.sent).name=Oe.name,At.size=Oe.size,At.type=Oe.type,At.ext=Yg($=At.name).call($,".")>-1?Co(_=At.name).call(_,Yg(re=At.name).call(re,".")+1).toLowerCase():"",ur.abrupt("return",At);case 30:case"end":return ur.stop()}},L)}))},getSystemInfo:function(){var M,L;return{os:((M=ql.os)===null||M===void 0?void 0:M.family)||"",osVer:((L=ql.os)===null||L===void 0?void 0:L.version)||"",browser:ql.name||"",browserVer:ql.version||"",hostEnv:"BROWSER",hostEnvVer:ql.version||"",hostInfo:ql.ua||""}}},os=function(){function w(M,L){this.name=M,this.core=L,this.name=M,this.logger=L.logger,this.core=L}return w.prototype.process=function(L){var $=this[L.cmd+"Handler"];return typeof $=="function"?$.call(this,L):L.error&&!L.error.ignore?uo.reject(L.error):uo.resolve(L)},w}();(function(w){w[w.text=0]="text",w[w.image=1]="image",w[w.audio=2]="audio",w[w.video=3]="video",w[w.geo=4]="geo",w[w.notification=5]="notification",w[w.file=6]="file",w[w.tip=10]="tip",w[w.robot=11]="robot",w[w.g2=12]="g2",w[w.custom=100]="custom"})(sc||(sc={})),function(w){w[w.p2p=0]="p2p",w[w.team=1]="team",w[w.superTeam=5]="superTeam"}(Da||(Da={})),function(w){w[w.Android=1]="Android",w[w.iOS=2]="iOS",w[w.PC=4]="PC",w[w.WindowsPhone=8]="WindowsPhone",w[w.Web=16]="Web",w[w.Server=32]="Server",w[w.Mac=64]="Mac"}(Vl||(Vl={})),function(w){w[w.unread=1]="unread",w[w.read=2]="read",w[w.deleted=3]="deleted",w[w.sending=4]="sending",w[w.sendFailed=5]="sendFailed",w[w.sent=6]="sent",w[w.receipt=7]="receipt",w[w.refused=10]="refused"}(ha||(ha={})),function(w){w[w.default=0]="default",w[w.leave=1]="leave",w[w.roam=2]="roam"}(Xs||(Xs={}));var oh=function(M,L){return function($){return M(L($))}},ah=oh(Object.getPrototypeOf,Object),XT=Function.prototype,ZT=Object.prototype,ry=XT.toString,eS=ZT.hasOwnProperty,pl=ry.call(Object),bd=function(M){if(!vi(M)||yc(M)!="[object Object]")return!1;var L=ah(M);if(L===null)return!0;var $=eS.call(L,"constructor")&&L.constructor;return typeof $=="function"&&$ instanceof $&&ry.call($)==pl};function Zs(w,M){if(!bd(M))return{};var L=JSON.parse(Wo(M)),$=sh(w,L);return JSON.parse(Wo(Mr(Mr({},L),$)))}function sh(w,M){if(!bd(M))return{};var L={},$=Vo(w);return In($).call($,function(_){var re=w[_].type;if(typeof re!="string"){var Oe=sh(w[_],M);Vo(Oe).length>0&&(L[_]=Oe)}else{var de=w[_],At=de.rawKey||_,tr=Bp[re](M,At,de);tr!==void 0&&(M[At]=void 0,L[_]=tr)}}),L}var Bp={number:function(M,L){if(M[L]!==void 0)return+M[L]},string:function(M,L){if(M[L]!==void 0)return M[L]},boolean:function(M,L){return+M[L]>0||+M[L]!=0&&void 0},enum:function(M,L,$){return sp($)[M[L]]},object:function(M,L){if(M[L]!==void 0)try{return JSON.parse(M[L])}catch{return{}}}};function Td(w,M){if(!bd(M))return{};var L=JSON.parse(Wo(M)),$=ny(w,L);return JSON.parse(Wo(Mr(Mr({},L),$)))}function ny(w,M){var L;if(!bd(M))return op(L=Vo(w)).call(L,function(re,Oe){return re[w[Oe].rawKey||Oe]=void 0,re},{});var $={},_=Vo(w);return In(_).call(_,function(re){var Oe=w[re].type;if(typeof Oe!="string"){var de=ny(w[re],M[re]);return Mr($,de),void(M[re]=void 0)}var At=w[re],tr=At.rawKey||re,ur=ih[Oe](M,re,At);M[tr]=void 0,$[tr]=ur}),$}var ih={number:function(M,L){return M[L]},string:function(M,L){return M[L]},boolean:function(M,L){return M[L]===!0?1:M[L]===!1?0:void 0},enum:function(M,L,$){return sp($)[M[L]]},object:function(M,L){if(M[L]!==void 0)try{return Wo(M[L])}catch{return""}}},tS=ih,oy=function(M){return function(L,$,_){for(var re=-1,Oe=Object(L),de=_(L),At=de.length;At--;){var tr=de[M?At:++re];if($(Oe[tr],tr,Oe)===!1)break}return L}}(),rS=function(M,L){for(var $=-1,_=Array(M);++$<M;)_[$]=L($);return _},ch=function(M){return vi(M)&&yc(M)=="[object Arguments]"},ay=Object.prototype,Fp=ay.hasOwnProperty,nS=ay.propertyIsEnumerable,oS=ch(function(){return arguments}())?ch:function(w){return vi(w)&&Fp.call(w,"callee")&&!nS.call(w,"callee")},Sd=oS,lh=function(){return!1},Lp=o(function(w,M){var L=M&&!M.nodeType&&M,$=L&&w&&!w.nodeType&&w,_=$&&$.exports===L?As.Buffer:void 0,re=(_?_.isBuffer:void 0)||lh;w.exports=re}),aS=/^(?:0|[1-9]\d*)$/,$p=function(M,L){var $=typeof M;return!!(L=L??9007199254740991)&&($=="number"||$!="symbol"&&aS.test(M))&&M>-1&&M%1==0&&M<L},Sa={};Sa["[object Float32Array]"]=Sa["[object Float64Array]"]=Sa["[object Int8Array]"]=Sa["[object Int16Array]"]=Sa["[object Int32Array]"]=Sa["[object Uint8Array]"]=Sa["[object Uint8ClampedArray]"]=Sa["[object Uint16Array]"]=Sa["[object Uint32Array]"]=!0,Sa["[object Arguments]"]=Sa["[object Array]"]=Sa["[object ArrayBuffer]"]=Sa["[object Boolean]"]=Sa["[object DataView]"]=Sa["[object Date]"]=Sa["[object Error]"]=Sa["[object Function]"]=Sa["[object Map]"]=Sa["[object Number]"]=Sa["[object Object]"]=Sa["[object RegExp]"]=Sa["[object Set]"]=Sa["[object String]"]=Sa["[object WeakMap]"]=!1;var sS=function(M){return vi(M)&&Bg(M.length)&&!!Sa[yc(M)]},uh=us&&us.isTypedArray,dh=uh?Al(uh):sS,iS=Object.prototype.hasOwnProperty,sy=function(M,L){var $=bi(M),_=!$&&Sd(M),re=!$&&!_&&Lp(M),Oe=!$&&!_&&!re&&dh(M),de=$||_||re||Oe,At=de?rS(M.length,String):[],tr=At.length;for(var ur in M)!L&&!iS.call(M,ur)||de&&(ur=="length"||re&&(ur=="offset"||ur=="parent")||Oe&&(ur=="buffer"||ur=="byteLength"||ur=="byteOffset")||$p(ur,tr))||At.push(ur);return At},jp=Object.prototype,fl=function(M){var L=M&&M.constructor;return M===(typeof L=="function"&&L.prototype||jp)},ph=oh(Object.keys,Object),Wa=Object.prototype.hasOwnProperty,cS=function(M){if(!fl(M))return ph(M);var L=[];for(var $ in Object(M))Wa.call(M,$)&&$!="constructor"&&L.push($);return L},Cd=function(M){return yp(M)?sy(M):cS(M)},iy=function(M,L){return M&&oy(M,L,Cd)},lS=function(M,L,$,_){return iy(M,function(re,Oe,de){L(_,$(re),Oe,de)}),_},fh,uS=function(M,L){return function($,_){return lS($,M,L(_),{})}},dS=Object.prototype.toString,Ga=uS(function(w,M,L){M!=null&&typeof M.toString!="function"&&(M=dS.call(M)),w[M]=L},xv($l)),pS=Ga({Android:1,iOS:2,PC:4,WindowsPhone:8,Web:16,Server:32,Mac:64}),mh={p2p:0,team:1,superTeam:5};function cy(w,M){return w&&w.length>0?To(w).call(w,function(L){return Mr(Mr({},L),{account:L.account,connectionId:L.connectionId,deviceId:L.deviceId,ip:L.ip,mac:L.mac,os:L.os,type:pS[L.type]||L.type,time:ko(L.time),online:M!==3})}):[]}Ga(mh),function(w){w[w.text=0]="text",w[w.image=1]="image",w[w.audio=2]="audio",w[w.video=3]="video",w[w.geo=4]="geo",w[w.notification=5]="notification",w[w.file=6]="file",w[w.tip=10]="tip",w[w.robot=11]="robot",w[w.g2=12]="g2",w[w.custom=100]="custom"}(fh||(fh={}));var fS={1:{reason:"samePlatformKick",message:"The same account is not allowed to multiple login at the same time"},2:{reason:"serverKick",message:"Kicked out by IM server"},3:{reason:"otherPlatformKick",message:"Kicked out by other client of your account"},4:{reason:"silentlyKick",message:"Quietly kicked"}},ly={BROWSER:0,RN:2,UNIAPP:3,WECHAT:6},uy=function(w){function M($){var _;return _=w.call(this,"auth",$)||this,qa({cmdMap:Uv,cmdConfig:Vv}),_}Ro(M,w);var L=M.prototype;return L.doLogin=function(_){var re,Oe;return _===void 0&&(_=!1),Sn(this,void 0,void 0,ar.mark(function de(){var At,tr,ur,gr,yr,Cr,xr,Fr,jr,zr;return ar.wrap(function(Kr){for(;;)switch(Kr.prev=Kr.next){case 0:return At=this.core.options,tr=Ho.getSystemInfo(),ur=Mr(Mr({},At),{appLogin:_?0:1,appkey:At.appkey,account:At.account,token:At.token,deviceId:this.core.config.deviceId,clientType:16,protocolVersion:1,sdkVersion:91001,sdkHumanVersion:"0.13.1",os:tr.os,browser:tr.browser,session:(re=this.core.socket)===null||re===void 0?void 0:re.sessionId,sdkType:ly[Ho.platform]||0,userAgent:"Native/0.13.1"}),gr=tr.os.toLowerCase(),Ho.platform!=="UNIAPP"||gr!=="ios"&&gr!=="android"||(ur.isReactNative=1,ur.clientType=gr==="ios"?2:1,tr.pushDeviceInfo&&tr.pushDeviceInfo.MANUFACTURER&&(ur.deviceInfo=Wo(tr.pushDeviceInfo))),this.logger.log("auth::do login ",At.account,(Oe=this.core.socket)===null||Oe===void 0?void 0:Oe.sessionId),Kr.next=8,this.core.sendCmd("login",{login:ur});case 8:if(!(yr=Kr.sent).error){Kr.next=11;break}throw yr.error;case 11:return Cr=yr.content,xr=Cr.loginRes,Fr=Cr.loginPorts,jr=Cr.aosPushInfo,zr=cy(Fr,2),(zr=ls(zr).call(zr,function(kn){return kn.connectionId!==xr.connectionId})).length>0&&this.core.emit("multiPortLogin",zr),Kr.abrupt("return",Mr(Mr({},xr),{aosPushInfo:jr}));case 16:case"end":return Kr.stop()}},de,this)}))},L.kick=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return tr.next=2,this.core.sendCmd("kick",_);case 2:return de=tr.sent,tr.abrupt("return",(re=de.content)===null||re===void 0?void 0:re.deviceIds);case 4:case"end":return tr.stop()}},Oe,this)}))},L.multiPortLoginHandler=function(_){if(_.error)this.logger.error("multiPortLoginHandler:: error, ",_.error);else{var re=_.content,Oe=cy(re.loginPorts,re.state);Oe.length>0&&this.core.emit("multiPortLogin",Oe)}},L.kickedHandler=function(_){if(_.error)this.logger.error("kickedHandler:: error, ",_.error);else{var re=function(de){var At=Zs({clientType:{type:"enum",values:Vl},customClientType:{type:"number"}},de),tr=fS[At.reason];return Mr(At,tr=tr||{reason:"unknow",message:"Unknown reason"})}(_.content);this.logger.warn("kicked::",re),this.core.doDisconnect(Va.KICKED,re)}},M}(os);Vr({target:"Number",stat:!0},{isNaN:function(M){return M!=M}});var Md,mS=nr.Number.isNaN,gS=Ga({none:0,normal:1,all:3}),dy={normal:0,advanced:1},hS=Ga(dy),vS=Ga({normal:0,owner:1,manager:2}),gh={noVerify:0,needVerify:1,rejectAll:2},py=Ga(gh),fy={needVerify:0,noVerify:1},gy=Ga(fy),Hl={manager:0,all:1},ml=Ga(Hl),hh={manager:0,all:1},zs=Ga(hh),Ri={manager:0,all:1},yS=Ga(Ri);function xc(w){var M,L=["teamId"],$=["level","memberNum","memberUpdateTime","createTime","updateTime"],_=["valid","validToCurrentUser","mute"],re={type:hS,muteType:gS,joinMode:py,beInviteMode:gy,inviteMode:ml,updateTeamMode:zs,updateExtMode:yS};w.bits;var Oe=Ps(w,["bits"]);return In(L).call(L,function(de){Oe[de]&&(Oe[de]=Oe[de].toString())}),In($).call($,function(de){Oe[de]!==void 0&&(Oe[de]=ko(Oe[de]))}),In(_).call(_,function(de){Oe[de]!==void 0&&(Oe[de]=ko(Oe[de])===1)}),In(M=Vo(re)).call(M,function(de){Oe[de]!==void 0&&(Oe[de]=re[de][Oe[de]]||Oe[de])}),Oe}function vh(w){return w&&w.length>0?To(w).call(w,function(M){return xc(M)}):[]}function yh(w){var M,L=Mr({},w),$=["avatar","name","intro","announcement","ext"],_={type:dy,joinMode:gh,beInviteMode:fy,inviteMode:Hl,updateTeamMode:hh,updateExtMode:Ri};return In($).call($,function(re){L[re]!==void 0&&(L[re]=L[re].toString())}),In(M=Vo(_)).call(M,function(re){L[re]!==void 0&&(L[re]=_[re][L[re]])}),L}function hy(w){var M=["teamId","ext","account","nickInTeam"],L={};return w.bitConfigMask!==void 0&&(L.bits=ko(w.bitConfigMask)),In(M).call(M,function($){w[$]&&(L[$]=w[$].toString())}),L}function kd(w){var M,L=["teamId"],$=["joinTime","updateTime","bitConfigMask"],_=["active","valid","mute"],re={type:vS},Oe=w.bits,de=Ps(w,["bits"]);return Oe!==void 0&&(de.muteTeam=ko(Oe)===1,de.bitConfigMask=Oe),de.id=de.teamId+"-"+de.account,In(L).call(L,function(At){de[At]&&(de[At]=de[At].toString())}),In($).call($,function(At){de[At]!==void 0&&(de[At]=ko(de[At]))}),In(_).call(_,function(At){de[At]!==void 0&&(de[At]=ko(de[At])===1)}),In(M=Vo(re)).call(M,function(At){de[At]!==void 0&&(de[At]=re[At][de[At]]||de[At])}),de}function Dp(w){return w&&w.length>0?To(w).call(w,function(M){return kd(M)}):[]}function vy(w,M,L){return L===void 0&&(L="normal"),{id:w.teamId+"-"+M,teamId:w.teamId,account:M,type:L,nickInTeam:"",muteTeam:!1,mute:!1,joinTime:w.memberUpdateTime,updateTime:w.memberUpdateTime,active:!0,valid:!0}}function bS(w,M,L){return L===void 0&&(L="normal"),M&&M.length>0?To(M).call(M,function($){return vy(w,$,L)}):[]}function zl(w){var M=Mr({},w);return M.createTime&&(M.createTime=+M.createTime),M.updateTime&&(M.updateTime=+M.updateTime),M.gender&&(M.gender=Md[+M.gender]),M}(function(w){w[w.unknown=0]="unknown",w[w.male=1]="male",w[w.female=2]="female"})(Md||(Md={}));var yy={"8_1":"createTeam","8_5":"addTeamMembers","8_6":"removeTeamMembers","8_7":"updateTeamInfo","8_8":"leaveTeam","8_9":"getTeamInfo","8_10":"getTeams","8_11":"getTeamMembers","8_12":"dismissTeam","8_13":"applyTeam","8_14":"passTeamApply","8_15":"rejectTeamApply","8_16":"addTeamManagers","8_17":"removeTeamManagers","8_18":"transferTeam","8_19":"updateMyMemberInfo","8_20":"updateNickInTeam","8_21":"acceptTeamInvite","8_22":"rejectTeamInvite","8_25":"muteTeamMember","8_27":"getMutedTeamMembers","8_28":"sendTeamMsgReceipt","8_29":"getTeamMsgReads","8_30":"getTeamMsgReadAccounts","8_31":"notifyTeamMsgReceipts","8_32":"muteTeam","8_33":"getTeamMemberInvitorAccid","8_34":"getTeamsById","8_101":"syncCreateTeam","8_109":"syncTeams","8_119":"syncUpdateTeamMember","8_126":"syncMyTeamMembers"},ic={team:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,ext:18,serverExt:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateExtMode:24,mute:100,muteType:101},teamMsgReceiptTag:{teamId:0,idServer:1,read:100,unread:101,idClient:102,account:103},teamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,joinTime:10,updateTime:11,ext:12,mute:13,invitorAccid:14}},as=rs(ic),by={getTeamInfo:{sid:8,cid:9,service:"team",params:[{type:"Long",name:"teamId"}],response:[{type:"Property",name:"team",reflectMapper:as.team}]},getTeams:{sid:8,cid:10,service:"team",params:[{type:"long",name:"timetag"}],response:[{type:"PropertyArray",name:"teams",reflectMapper:as.team},{type:"Number",name:"timetag"}],ignoreErrCodes:[803]},createTeam:{sid:8,cid:1,service:"team",params:[{type:"Property",name:"team",reflectMapper:ic.team},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}],response:[{type:"Property",name:"team",reflectMapper:as.team},{type:"StrArray",name:"abortedAccidList"}]},sendTeamMsgReceipt:{sid:8,cid:28,service:"team",params:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:ic.teamMsgReceiptTag}],response:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:as.teamMsgReceiptTag}]},getTeamMsgReads:{sid:8,cid:29,service:"team",params:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:ic.teamMsgReceiptTag}],response:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:as.teamMsgReceiptTag}]},getTeamMsgReadAccounts:{sid:8,cid:30,service:"team",params:[{type:"Property",name:"teamMsgReceiptTag",reflectMapper:ic.teamMsgReceiptTag}],response:[{type:"Property",name:"teamMsgReceipt",reflectMapper:as.teamMsgReceiptTag},{type:"StrArray",name:"readAccounts"},{type:"StrArray",name:"unreadAccounts"}]},notifyTeamMsgReceipts:{sid:8,cid:31,service:"team",response:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:as.teamMsgReceiptTag}]},dismissTeam:{sid:8,cid:12,service:"team",params:[{type:"Long",name:"teamId"}]},leaveTeam:{sid:8,cid:8,service:"team",params:[{type:"Long",name:"teamId"}]},transferTeam:{sid:8,cid:18,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},updateTeamInfo:{sid:8,cid:7,service:"team",params:[{type:"Property",name:"team",reflectMapper:ic.team}],response:[{type:"Number",name:"id"},{type:"Number",name:"time"}]},getTeamsById:{sid:8,cid:34,service:"team",params:[{type:"LongArray",name:"teamIds"}],response:[{type:"PropertyArray",name:"teams",reflectMapper:as.team},{type:"StrArray",name:"tids"}],ignoreErrCodes:[816]},getTeamMembers:{sid:8,cid:11,service:"team",params:[{type:"Long",name:"teamId"},{type:"Long",name:"timetag"}],response:[{type:"String",name:"teamId"},{type:"PropertyArray",name:"teamMembers",reflectMapper:as.teamMember},{type:"Number",name:"timetag"}]},getMutedTeamMembers:{sid:8,cid:27,service:"team",params:[{type:"Long",name:"teamId"}],response:[{type:"String",name:"teamId"},{type:"PropertyArray",name:"teamMembers",reflectMapper:as.teamMember}]},addTeamMembers:{sid:8,cid:5,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"},{type:"String",name:"attach"}],response:[{type:"Long",name:"time"},{type:"StrArray",name:"abortedAccidList"}]},removeTeamMembers:{sid:8,cid:6,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},applyTeam:{sid:8,cid:13,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"ps"}],response:[{type:"Property",name:"team",reflectMapper:as.team}]},addTeamManagers:{sid:8,cid:16,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeTeamManagers:{sid:8,cid:17,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateMyMemberInfo:{sid:8,cid:19,service:"team",params:[{type:"Property",name:"teamMember",reflectMapper:ic.teamMember}]},updateNickInTeam:{sid:8,cid:20,service:"team",params:[{type:"Property",name:"teamMember",reflectMapper:ic.teamMember}]},muteTeamMember:{sid:8,cid:25,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"Int",name:"mute"}]},getTeamMemberInvitorAccid:{sid:8,cid:33,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}],response:[{type:"Object",name:"accountsMap"}]},muteTeam:{sid:8,cid:32,service:"team",params:[{type:"Long",name:"teamId"},{type:"Int",name:"mute"}]},passTeamApply:{sid:8,cid:14,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamApply:{sid:8,cid:15,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},acceptTeamInvite:{sid:8,cid:21,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamInvite:{sid:8,cid:22,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},syncTeams:{sid:8,cid:109,service:"team",response:[{type:"Number",name:"timetag"},{type:"PropertyArray",name:"teams",reflectMapper:as.team}]},syncCreateTeam:{sid:8,cid:101,service:"team",response:[{type:"Property",name:"team",reflectMapper:as.team}]},syncUpdateTeamMember:{sid:8,cid:119,service:"team",response:[{type:"Property",name:"teamMember",reflectMapper:as.teamMember}]},syncMyTeamMembers:{sid:8,cid:126,ext:"sync",service:"team",response:[{type:"PropertyArray",name:"teamMembers",entity:"teamMember",reflectMapper:as.teamMember},{type:"Number",name:"timetag"}]}},Ty={"3_7":"getUsersNameCardFromServer","3_10":"updateMyNameCard","3_109":"syncMyNameCard","3_110":"onUpdateMyNameCard","3_3":"setBlack","3_103":"onUpdateBlackList","3_5":"setMute","3_105":"onUpdateMuteList","3_8":"syncRelations"},cc={user:{account:1,nick:3,avatar:4,signature:5,gender:6,email:7,birth:8,tel:9,ext:10,createTime:12,updateTime:13},relationMember:{account:0,isMuted:1,isBlack:2,createTime:3,updateTime:4}},Kl=rs(cc),TS={syncMyNameCard:{sid:3,cid:109,service:"user",response:[{type:"Property",name:"user",reflectMapper:Kl.user},{type:"Number",name:"timetag"}]},setBlack:{service:"user",sid:3,cid:3,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},onUpdateBlackList:{service:"user",sid:3,cid:103,response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},setMute:{service:"user",sid:3,cid:5,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},onUpdateMuteList:{service:"user",sid:3,cid:105,response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},syncRelations:{service:"user",sid:3,cid:8,params:[{type:"long",name:"timetag"}],response:[{type:"PropertyArray",name:"list",reflectMapper:Kl.relationMember},{type:"Number",name:"timetag"}]},getUsersNameCardFromServer:{service:"user",sid:3,cid:7,params:[{type:"StrArray",name:"accounts"}],response:[{type:"PropertyArray",name:"users",reflectMapper:Kl.user}]},updateMyNameCard:{service:"user",sid:3,cid:10,params:[{type:"Property",name:"user",reflectMapper:cc.user}],response:[{type:"Number",name:"timetag"}]},onUpdateMyNameCard:{service:"user",sid:3,cid:110,response:[{type:"Property",name:"user",reflectMapper:Kl.user}]}},Sy={needPush:{type:"boolean",required:!1},needPushBadge:{type:"boolean",required:!1},needPushNick:{type:"boolean",required:!1},pushContent:{type:"string",allowEmpty:!1,required:!1},pushPayload:{type:"string",allowEmpty:!1,required:!1},needForcePush:{type:"boolean",required:!1},forcePushIDsList:{type:"string",allowEmpty:!1,required:!1},forcePushContent:{type:"string",allowEmpty:!1,required:!1}};function SS(w,M){var L,$=ga!==void 0&&gd(w)||w["@@iterator"];if($)return Oo(L=($=$.call(w)).next).call(L,$);if(hi(w)||($=function(Oe,de){var At;if(Oe){if(typeof Oe=="string")return Cy(Oe,de);var tr=Co(At=Object.prototype.toString.call(Oe)).call(At,8,-1);if(tr==="Object"&&Oe.constructor&&(tr=Oe.constructor.name),tr==="Map"||tr==="Set")return Ep(Oe);if(tr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(tr))return Cy(Oe,de)}}(w))||M&&w&&typeof w.length=="number"){$&&(w=$);var _=0;return function(){return _>=w.length?{done:!0}:{done:!1,value:w[_++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cy(w,M){(M==null||M>w.length)&&(M=w.length);for(var L=0,$=new Array(M);L<M;L++)$[L]=w[L];return $}var bh={subType:{type:"string"},setting:{resendFlag:{type:"boolean"},envConfig:{type:"string"},needSaveHistory:{type:"boolean"},needRoaming:{type:"boolean"},needOffline:{type:"boolean"},needSelfSync:{type:"boolean"},needRouted:{type:"boolean"},needUpdateSession:{type:"boolean"},isMuted:{type:"boolean"}},antiSpamInfo:{needAntiSpam:{type:"boolean"},antiSpamContent:{type:"string"},antiSpamBIZID:{type:"string"},clientAntispamHitting:{type:"boolean"},antiSpamUsingYidun:{type:"boolean"},yidunCallbackURL:{type:"string"},yidunAntiCheating:{type:"string"},yidunAntiSpamExtension:{type:"string"},yidunAntiSpamResult:{type:"string"}},pushInfo:Sy,teamSpecializationInfo:{needACK:{type:"boolean"},isACKSent:{type:"boolean"},ackSnapshot:{type:"number"}},threadMessageInfo:{replyMsgFromAccount:{type:"string"},replyMsgToAccount:{type:"string"},replyMsgTime:{type:"number"},replyMsgIdServer:{type:"string"},replyMsgIdClient:{type:"string"},threadMsgFromAccount:{type:"string"},threadMsgToAccount:{type:"string"},threadMsgTime:{type:"number"},threadMsgIdServer:{type:"string"},threadMsgIdClient:{type:"string"}}},Ic={0:"addTeamMembers",1:"removeTeamMembers",2:"leaveTeam",3:"updateTeam",4:"dismissTeam",5:"passTeamApply",6:"transferTeam",7:"addTeamManagers",8:"removeTeamManagers",9:"acceptTeamInvite",10:"updateTeamMemberMute",101:"netcallMiss",102:"netcallBill",103:"netcallReject",401:"addSuperTeamMembers",402:"removeSuperTeamMembers",403:"leaveSuperTeam",404:"updateSuperTeam",405:"dismissSuperTeam",406:"transferSuperTeam",407:"addSuperTeamManagers",408:"removeSuperTeamManagers",409:"updateSuperTeamMembersMute",410:"passSuperTeamApply",411:"acceptSuperTeamInvite"};function Ti(w,M){return Da[w.scene]+"-"+(w.to===M?w.from:w.to)}function Up(w,M){return w.from===M?w.to===M?"in":"out":"in"}function Bi(w,M){var L=M.account,$=M.featureValue,_=M.statusValue,re=M.sessionAck,Oe=M.msgReceiptTime,de=Da[w.scene],At=w.to===L?w.from:w.to,tr=Xs.default,ur=ha.unread;ko(w.isInBlackList)>0?(ur=ha.refused,delete w.isInBlackList):ur=w.from===L?Oe&&Oe>=+w.time?ha.receipt:ha.sent:re&&re>=+w.time?ha.read:ha.unread;var gr=Mr(Mr({},Zs(bh,w)),{scene:de,type:sc[w.type],fromClientType:Vl[w.fromClientType],flow:Up(w,L),target:At,to:w.to,from:w.from,time:w.time?+w.time:void 0,userUpdateTime:w.userUpdateTime?+w.userUpdateTime:void 0,idClient:w.idClient,sessionId:de+"-"+At,status:ha[_||ur],feature:Xs[$||tr]});if(typeof gr.attach=="string")try{gr.attach=JSON.parse(gr.attach)}catch{}return gr.type==="notification"&&(gr.attach=gr.attach?function(Cr){var xr,Fr={};if(Fr.type=Ic[Cr.id]||Cr.id,!Cr.data)return Fr;var jr,zr={ids:"accounts",id:"account",attach:"custom",channel:"channelId",calltype:"netcallType",mute:"mute",duration:"duration",time:"time",from:"from",ext:"ext"},Hr=Cr.data;return In(xr=Vo(zr)).call(xr,function(Kr){Hr[Kr]!==void 0&&(Fr[zr[Kr]]=Hr[Kr])}),Hr.tinfo&&(Fr.team=xc(Ei(Hr.tinfo,as.team))),Hr.uinfos&&(Fr.users=To(jr=Hr.uinfos).call(jr,function(Kr){return zl(Ei(Kr,Kl.user))})),Hr.mute!==void 0&&(Fr.mute=ko(Hr.mute)===1),Fr}(gr.attach):{}),gr}function _d(w,M){return w&&w.length>0?Wl(To(w).call(w,function(L){return Bi(L,M)})):[]}function Wl(w){for(var M,L,$={},_=SS(w);!(L=_()).done;){var re=L.value,Oe=$[re.idClient];Oe&&Oe.time>re.time||($[re.idClient]=re)}return To(M=Vo($)).call(M,function(de){return $[de]})}function gl(w,M){M===void 0&&(M=!0);var L=Mr({},w);if(L.pushInfo&&M){for(var $ in L.pushInfo)typeof L.pushInfo[$]=="boolean"?L[$]=L.pushInfo[$]?1:0:L[$]=L.pushInfo[$];delete L.pushInfo}return L.scene===Da.team&&L.needForcePush&&(L.forcePushContent=L.forcePushContent||L.pushContent,L.forcePushIDsList=L.forcePushIDsList?L.forcePushIDsList:"#%@all@%#"),L}function wd(w,M){return To(w).call(w,function(L){var $;return $=M||(mS(ko(L.scene))?L.scene:ko(L.scene)===1?"p2p":"team"),{deletedTime:ko(L.time),from:L.from,idClient:L.deletedIdClient||L.idClient,idServer:L.deletedIdServer||L.idServer,scene:$,time:ko(L.time),to:L.to}})}var Th=Array.prototype.reverse,Yo=function(M){return M==null?M:Th.call(M)},zo=function(){function w(M){this.core=M}return w.prototype.processBroadcastMsg=function(L){var $=To(L).call(L,function(_){return Mr(Mr({},_),{time:ko(_.time)})});return this.core.sendCmd("batchMarkRead",{sid:7,cid:17,ids:To($).call($,function(_){return _.id})}),$},w}(),Sh={needPush:{type:"boolean",required:!1},needPushBadge:{type:"boolean",required:!1},needPushNick:{type:"boolean",required:!1},pushContent:{type:"string",allowEmpty:!1,required:!1},pushPayload:{type:"string",allowEmpty:!1,required:!1}},My={pushContent:8,pushPayload:9,needPush:107,needPushBadge:109,needPushNick:110},Ha={"4_4":"syncOfflineMsgs","4_9":"syncRoamingMsgs","4_17":"syncRoamingMsgs","4_21":"syncDeleteSelfMsgs","7_1":"sendMsg","8_23":"getHistoryTeamMsgs","21_14":"getHistorySuperTeamMsgs","8_2":"sendTeamMsg","21_2":"sendSuperTeamMsg","7_11":"sendMsgReceipt","7_13":"recallMsg","7_24":"deleteSelfMsgs","21_17":"recallSuperTeamMsg","7_2":"onMsg","8_3":"onMsg","21_3":"onMsg","7_101":"onMsg","8_102":"onMsg","21_102":"onMsg","8_4":"nimOnTeamMsgs","4_16":"syncBroadcastMsg","7_17":"onBroadcastMsg","7_123":"onDeleteSelfMsg","7_124":"onDeleteSelfMsgs"},La=Mr({scene:0,to:1,from:2,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,type:8,body:9,attach:10,idClient:11,idServer:12,resendFlag:13,userUpdateTime:14,ext:15,needAntiSpam:21,antiSpamContent:22,antiSpamBIZID:23,clientAntispamHitting:24,antiSpamUsingYidun:25,needACK:26,yidunCallbackURL:27,needUpdateSession:28,replyMsgFromAccount:29,replyMsgToAccount:30,replyMsgTime:31,replyMsgIdServer:32,replyMsgIdClient:33,threadMsgFromAccount:34,threadMsgToAccount:35,threadMsgTime:36,threadMsgIdServer:37,threadMsgIdClient:38,isDeleted:39,callbackExt:40,subType:41,yidunAntiCheating:42,envConfig:43,yidunAntiSpamExtension:44,yidunAntiSpamResult:45,needSaveHistory:100,needRoaming:101,needSelfSync:102,isMuted:104,needRouted:105,isInBlackList:106,needOffline:108,isReplyMsg:111,ackSnapshot:112},{pushContent:17,pushPayload:16,forcePushIDsList:18,forcePushContent:19,needForcePush:20,needPush:107,needPushBadge:109,needPushNick:110}),Ec={msg:La,recallMsgTag:Mr({time:0,type:1,to:2,from:3,ps:4,attach:5,deletedIdClient:10,deletedIdServer:11,opeAccount:16,env:21},My),deleteSelfMsgTag:{scene:1,from:2,to:3,idServer:4,idClient:5,time:6,deletedTime:7,ext:8},msgReceiptTag:{to:1,from:2,time:7,idClient:11},broadcastMsg:{id:1,fromAccid:2,time:4,body:5}},ss=rs(Ec),CS={sendMsg:{sid:7,cid:1,service:"msg",params:[{type:"Property",name:"msg",reflectMapper:Ec.msg}],response:[{type:"Property",name:"msg",reflectMapper:ss.msg}],ignoreErrCodes:[7101]},sendTeamMsg:{sid:8,cid:2,service:"msg",params:[{type:"Property",name:"msg",reflectMapper:Ec.msg}],response:[{type:"Property",name:"msg",reflectMapper:ss.msg}]},sendSuperTeamMsg:{sid:21,cid:2,service:"msg",params:[{type:"Property",name:"msg",reflectMapper:Ec.msg}],response:[{type:"Property",name:"msg",reflectMapper:ss.msg}]},onMsg:{sid:7,cid:2,service:"msg",response:[{type:"Property",name:"msg",reflectMapper:ss.msg}]},nimOnTeamMsgs:{sid:8,cid:4,service:"msg",response:[{type:"PropertyArray",name:"datas",reflectMapper:ss.msg}]},getHistoryTeamMsgs:{sid:8,cid:23,service:"msg",params:[{type:"Long",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:ss.msg}]},getHistorySuperTeamMsgs:{sid:21,cid:14,params:[{type:"Long",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:ss.msg}],service:"msg"},recallMsg:{sid:7,cid:13,service:"msg",params:[{type:"Property",name:"recallMsgTag",reflectMapper:Ec.recallMsgTag}]},deleteSelfMsgs:{sid:7,cid:24,service:"msg",params:[{type:"PropertyArray",name:"deletedMsgs",reflectMapper:Ec.deleteSelfMsgTag}],response:[{type:"Long",name:"timetag"}]},recallSuperTeamMsg:{sid:21,cid:17,service:"msg",params:[{type:"Property",name:"recallMsgTag",reflectMapper:Ec.recallMsgTag}]},sendMsgReceipt:{sid:7,cid:11,service:"msg",params:[{type:"Property",name:"msgReceiptTag",reflectMapper:Ec.msgReceiptTag}],response:[{type:"Property",name:"msgReceiptTag",reflectMapper:ss.msgReceiptTag}]},batchMarkRead:{sid:4,cid:5,service:"msg",isNoResponse:!0,params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]},syncMsgReceipts:{sid:4,cid:12,service:"msg",response:[{type:"PropertyArray",name:"msgReceipts",reflectMapper:ss.msgReceiptTag},{type:"Number",name:"timetag"}]},syncOfflineMsgs:{sid:4,cid:4,service:"msg",response:[{type:"PropertyArray",name:"msgs",reflectMapper:ss.msg}]},syncRoamingMsgs:{sid:4,cid:9,service:"msg",response:[{type:"PropertyArray",name:"msgs",reflectMapper:ss.msg}]},syncBroadcastMsg:{sid:4,cid:16,service:"msg",response:[{type:"PropertyArray",name:"msgs",reflectMapper:ss.broadcastMsg}]},onBroadcastMsg:{sid:7,cid:17,service:"msg",response:[{type:"Property",name:"msg",reflectMapper:ss.broadcastMsg}]},onDeleteSelfMsg:{sid:7,cid:123,service:"msg",response:[{type:"Property",name:"deletedMsg",reflectMapper:ss.deleteSelfMsgTag}]},onDeleteSelfMsgs:{sid:7,cid:124,service:"msg",response:[{type:"PropertyArray",name:"deletedMsgs",reflectMapper:ss.deleteSelfMsgTag}]},syncDeleteSelfMsgs:{sid:4,cid:21,service:"msg",response:[{type:"PropertyArray",name:"deletedMsgs",reflectMapper:ss.deleteSelfMsgTag}]}},ky=function(w){function M($){var _;return(_=w.call(this,"msg",$)||this).service=new zo($),qa({cmdMap:Ha,cmdConfig:CS}),_}Ro(M,w);var L=M.prototype;return L.sendTextMsg=function(_){return En({body:{type:"string",allowEmpty:!1}},_),this.sendMsg(Mr(Mr({},_),{type:"text"}))},L.sendTipMsg=function(_){return En({body:{type:"string",allowEmpty:!1}},_),this.sendMsg(Mr(Mr({},_),{type:"tip"}))},L.sendGeoLocationMsg=function(_){return En({attach:{type:"object",rules:{title:{type:"string",allowEmpty:!1},lat:{type:"number"},lng:{type:"number"}}}},_),this.sendMsg(Mr(Mr({},_),{type:"geo",attach:Wo(_.attach)}))},L.sendCustomMsg=function(_){return En({attach:{type:"string",allowEmpty:!1}},_),this.sendMsg(Mr(Mr({},_),{type:"custom"}))},L.sendMsg=function(_){var re,Oe,de=this;!((re=this.core.sync)===null||re===void 0)&&re.getSyncDoneFlag()||this.logger.warn("Please send message after syncdone event"),En({scene:{type:"enum",values:yi(Da)},type:{type:"enum",values:yi(sc)},to:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1},setting:{type:"object",rules:{resendFlag:{type:"boolean",required:!1},needSaveHistory:{type:"boolean",required:!1},needRoaming:{type:"boolean",required:!1},needOffline:{type:"boolean",required:!1},needSelfSync:{type:"boolean",required:!1},needRouted:{type:"boolean",required:!1},needUpdateSession:{type:"boolean",required:!1}},required:!1},antiSpamInfo:{type:"object",required:!1,rules:{clientAntispamHitting:{type:"boolean",required:!1},antiSpamUsingYidun:{type:"boolean",required:!1}}},pushInfo:{type:"object",required:!1,rules:Sy},teamSpecializationInfo:{type:"object",required:!1,rules:{needACK:{type:"boolean",required:!1}}}},_);var At,tr=_.scene==="p2p"?"sendMsg":_.scene==="team"?"sendTeamMsg":"sendSuperTeamMsg",ur=function(Cr,xr,Fr,jr){Cr.onSendBefore,Cr.onUploadStart,Cr.onUploadDone;var zr=Cr.replyMsg,Hr=Ps(Cr,["onSendBefore","onUploadStart","onUploadDone","replyMsg"]),Kr=Mr(Mr({},Td(bh,Hr)),{scene:Da[Cr.scene],type:sc[Cr.type],from:xr,fromClientType:16,fromDeviceId:Fr,fromNick:jr==null?void 0:jr.nick,userUpdateTime:jr==null?void 0:jr.updateTime,status:ha[ha.sending]});if(Kr.idClient=Kr.resendFlag?Cr.idClient:_p(),!Kr.idClient)throw new Tg("idClient is required to resend a message","idClient","required");return Kr=gl(Kr,!1),zr&&(Kr.replyMsgFromAccount=zr.from,Kr.replyMsgToAccount=zr.to,Kr.replyMsgTime=+zr.time,Kr.replyMsgIdServer=zr.idServer,Kr.replyMsgIdClient=zr.idClient,Kr.threadMsgFromAccount=zr.from,Kr.threadMsgToAccount=zr.to,Kr.threadMsgTime=+zr.time,Kr.threadMsgIdServer=zr.idServer,Kr.threadMsgIdClient=zr.idClient,zr.threadMessageInfo&&zr.threadMessageInfo.threadMsgIdServer&&(Kr.threadMsgFromAccount=zr.threadMessageInfo.threadMsgFromAccount,Kr.threadMsgToAccount=zr.threadMessageInfo.threadMsgToAccount,Kr.threadMsgTime=zr.threadMessageInfo.threadMsgTime,Kr.threadMsgIdServer=zr.threadMessageInfo.threadMsgIdServer,Kr.threadMsgIdClient=zr.threadMessageInfo.threadMsgIdClient)),Kr}(_,this.core.account,this.core.config.deviceId,(Oe=this.core.user)===null||Oe===void 0?void 0:Oe.myInfo),gr=Bi(Mr(Mr({},ur),{time:new Date().getTime()}),{account:this.core.account,featureValue:Xs.default,statusValue:ha.sending});try{_.onSendBefore&&_.onSendBefore(gr)}catch(yr){this.logger.error("sendMsg: options.onSendBefore error",yr)}return this.core.eventBus.emit("session/updateForNewMsg",gr),this.core.sendCmd(tr,{msg:ur}).then(function(yr){var Cr=yr.content,xr=yr.error;if(At=Cr.msg,xr)throw xr;var Fr=Bi(Mr(Mr({},ur),Cr.msg),{account:de.core.account,featureValue:Xs.default,statusValue:ha.sent});return Fr.from===Fr.to&&de.markMsgsAck([Fr]),de.core.eventBus.emit("session/updateForNewMsg",Fr),de.core.reporter.report("msgSend",{msgId:Fr.idServer,clientId:Fr.idClient,msgTime:Fr.time,fromAccid:_.scene==="p2p"?de.core.account:"",toAccid:Fr.to,type:Da[Fr.scene],roomId:"",tid:_.scene==="p2p"?"":Fr.to,result:200,faiReason:"",rt:sa()-gr.time}),Fr}).catch(function(yr){var Cr=Bi(Mr(Mr(Mr({},ur),{time:new Date().getTime()}),At),{account:de.core.account,featureValue:Xs.default,statusValue:yr.code===7101?ha.refused:ha.sendFailed});throw yr.msg=Cr,de.core.eventBus.emit("session/updateForNewMsg",Cr),de.core.reporter.report("msgSend",{msgId:Cr.idServer,clientId:Cr.idClient,msgTime:Cr.time,fromAccid:_.scene==="p2p"?de.core.account:"",toAccid:Cr.to,type:Da[Cr.scene],roomId:"",tid:_.scene==="p2p"?"":Cr.to,result:yr==null?void 0:yr.code,faiReason:(yr==null?void 0:yr.message)||"",rt:sa()-gr.time}),yr})},L.resendMsg=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:if(En({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1}}}},_),Oe=_.msg,de=Mr(Mr({},Oe),{attach:Oe.attach?Wo(Oe.attach):void 0,setting:{resendFlag:!0}}),Oe.from===this.core.account){tr.next=5;break}throw new Error("You can only resend messages that you sent: "+Oe.idClient);case 5:return tr.abrupt("return",this.sendMsg(de));case 6:case"end":return tr.stop()}},re,this)}))},L.forwardMsg=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return En({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1}}},scene:{type:"enum",values:yi(Da)},to:{type:"string",allowEmpty:!1}},_),Oe=_.msg,de=Mr(Mr({},Oe),{scene:_.scene,to:_.to,attach:Oe.attach?Wo(Oe.attach):void 0}),tr.abrupt("return",this.sendMsg(de));case 4:case"end":return tr.stop()}},re,this)}))},L.sendImageMsg=function(_){return this.doSendFile(Mr(Mr({},_),{type:"image"}))},L.sendFileMsg=function(_){return this.doSendFile(Mr(Mr({},_),{type:"file"}))},L.sendAudioMsg=function(_){return this.doSendFile(Mr(Mr({},_),{type:"audio"}))},L.sendVideoMsg=function(_){return this.doSendFile(Mr(Mr({},_),{type:"video"}))},L.doSendFile=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:if(En({scene:{type:"enum",values:yi(Da)},to:{type:"string",allowEmpty:!1},type:{type:"string",allowEmpty:!1},attach:{type:"object",rules:{url:{type:"string",allowEmpty:!1}},required:!1},maxSize:{type:"number",min:1,required:!1}},_),Oe=_.attach){tr.next=28;break}if(this.core.cloudStorage&&this.core.cloudStorage.uploadFile){tr.next=5;break}throw new Error('Service "cloudStorage" does not exist');case 5:return tr.prev=5,this.core.reporter.reportTraceStart("nos",{user_id:this.core.account,action:"upload"}),tr.next=9,this.core.cloudStorage.uploadFile(_);case 9:Oe=tr.sent,this.core.reporter.reportTraceEnd("nos",!0),tr.next=20;break;case 13:throw tr.prev=13,tr.t0=tr.catch(5),de=tr.t0,this.core.reporter.reportTraceUpdateV2("nos",{operation_type:"transfer",description:de.message,code:de.code||0,target:"",succeed:!1}),this.core.reporter.reportTraceEnd("nos",!1),this.logger.error("sendFile:: upload File error or abort",tr.t0),tr.t0;case 20:tr.prev=20,_.onUploadDone&&_.onUploadDone(Oe),tr.next=28;break;case 24:throw tr.prev=24,tr.t1=tr.catch(20),this.logger.error("sendFile options.onUploadDone err",tr.t1),tr.t1;case 28:return tr.abrupt("return",this.sendMsg(Mr(Mr({},_),{attach:Wo(Oe),type:_.type})));case 29:case"end":return tr.stop()}},re,this,[[5,13],[20,24]])}))},L.recallMsg=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return!((re=this.core.sync)===null||re===void 0)&&re.getSyncDoneFlag()||this.logger.warn("Please call recallMsg after syncdone event"),En({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1},scene:{type:"enum",values:yi(Da)},time:{type:"number"}}},pushInfo:{type:"object",required:!1,rules:Sh},ps:{type:"string",allowEmpty:!1,required:!1}},_),de=_.msg,At={p2p:"recallMsg",team:"recallMsg",superTeam:"recallSuperTeamMsg"},tr={p2p:7,team:8,superTeam:12},gr.next=7,this.core.sendCmd(At[de.scene],{recallMsgTag:gl({time:de.time,type:tr[de.scene],to:de.to,from:de.from,ps:_.ps,attach:_.attach,deletedIdClient:de.idClient,deletedIdServer:de.idServer,opeAccount:de.from,env:_.env,pushInfo:_.pushInfo})});case 7:return this.core.eventBus.emit("session/updateForDeletedMsg",wd([de])),gr.abrupt("return",de);case 9:case"end":return gr.stop()}},Oe,this)}))},L.deleteSelfMsgs=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return!((re=this.core.sync)===null||re===void 0)&&re.getSyncDoneFlag()||this.logger.warn("Please call deleteSelfMsgs after syncdone event"),En({msgs:{type:"array",rules:{scene:{type:"enum",values:["p2p","team"]},from:{type:"string",allowEmpty:!1},to:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},time:{type:"number",allowEmpty:!1}}},ext:{type:"string",allowEmpty:!1,required:!1}},_),de=_.msgs,At=To(de).call(de,function(yr){return{scene:yr.scene==="p2p"?1:2,from:yr.from,to:yr.to,idServer:yr.idServer,idClient:yr.idClient,time:yr.time,ext:_.ext}}),gr.next=6,this.core.sendCmd("deleteSelfMsgs",{deletedMsgs:At});case 6:return tr=wd(At),this.core.eventBus.emit("session/updateForDeletedMsg",tr),gr.abrupt("return",tr);case 9:case"end":return gr.stop()}},Oe,this)}))},L.sendMsgReceipt=function(_){var re,Oe,de;return Sn(this,void 0,void 0,ar.mark(function At(){var tr,ur,gr,yr;return ar.wrap(function(xr){for(;;)switch(xr.prev=xr.next){case 0:if(!((re=this.core.sync)===null||re===void 0)&&re.getSyncDoneFlag()||this.logger.warn("Please call sendMsgReceipt after syncdone event"),En({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1},target:{type:"string",allowEmpty:!1},time:{type:"number"}}}},_),(tr=_.msg).scene==="p2p"&&tr.flow==="in"){xr.next=6;break}return this.logger.warn("Msg scene: "+tr.scene+", flow: "+tr.flow+" is not allowed to send msg receipt"),xr.abrupt("return",void 0);case 6:return ur={to:tr.target,idClient:tr.idClient,time:tr.time},xr.next=9,this.core.sendCmd("sendMsgReceipt",{msgReceiptTag:ur});case 9:return gr=xr.sent,yr=ko((de=(Oe=gr.content)===null||Oe===void 0?void 0:Oe.msgReceiptTag)===null||de===void 0?void 0:de.time),xr.abrupt("return",Mr(Mr({},ur),{time:yr?Math.min(yr,ur.time):ur.time}));case 12:case"end":return xr.stop()}},At,this)}))},L.sendTeamMsgReceipt=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return!((re=this.core.sync)===null||re===void 0)&&re.getSyncDoneFlag()||this.logger.warn("Please call sendTeamMsgReceipt after syncdone event"),En({teamMsgReceipts:{type:"array",rules:{teamId:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1}},max:50}},_),de=_.teamMsgReceipts,this.core.sendCmd("sendTeamMsgReceipt",{teamMsgReceipts:de}),tr.abrupt("return",void 0);case 5:case"end":return tr.stop()}},Oe,this)}))},L.getTeamMsgReads=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return En({teamMsgReceipts:{type:"array",rules:{teamId:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1}}}},_),de=_.teamMsgReceipts,gr.next=4,this.core.sendCmd("getTeamMsgReads",{teamMsgReceipts:de});case 4:return At=gr.sent,tr=(tr=(re=At.content)===null||re===void 0?void 0:re.teamMsgReceipts)?To(tr).call(tr,function(yr){return Mr(Mr({},yr),{read:ko(yr.read),unread:ko(yr.unread)})}):[],gr.abrupt("return",tr);case 8:case"end":return gr.stop()}},Oe,this)}))},L.getTeamMsgReadAccounts=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return En({teamMsgReceipt:{type:"object",rules:{teamId:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1}}}},_),Oe=_.teamMsgReceipt,tr.next=4,this.core.sendCmd("getTeamMsgReadAccounts",{teamMsgReceiptTag:Oe});case 4:return de=tr.sent,tr.abrupt("return",de.content);case 6:case"end":return tr.stop()}},re,this)}))},L.markMsgsAck=function(_){if(_&&_.length>0){var re=[],Oe=[];In(_).call(_,function(de){de.scene==="p2p"&&de.flow==="in"?re.push(de):de.scene==="team"&&de.flow==="in"&&Oe.push(de)}),re.length>0&&this.core.sendCmd("batchMarkRead",{sid:7,cid:2,ids:To(re).call(re,function(de){return de.idServer})}),Oe.length>0&&this.core.sendCmd("batchMarkRead",{sid:8,cid:3,ids:To(Oe).call(Oe,function(de){return de.idServer})})}},L.onMsgHandler=function(_){var re;if(_.error)this.logger.error("msgHandler::recvError",_.error);else{var Oe=typeof Os(_,"raw.r[0]")=="number"?""+_.raw.r[0]:void 0,de=_.content.msg;de.idServer=de.idServer||Oe;var At=sa(),tr=Ti(de,this.core.account),ur=(re=this.core.session)===null||re===void 0?void 0:re.getSessionWithUncomplete({id:tr}),gr=Bi(de,ur?{account:this.core.account,sessionAck:ur.ack,msgReceiptTime:ur.msgReceiptTime}:{account:this.core.account});if(this.core.options.debugLevel==="debug"?this.logger.debug("msgHandler::recvMsg",gr.idClient,gr.idServer,gr):this.logger.log("msgHandler::recvMsg",gr.idClient,gr.idServer),this.markMsgsAck([gr]),this.core.eventBus.emit("session/updateForNewMsg",gr),this.core.emit("msg",gr),gr.type==="notification")this.core.eventBus.emit("team/onNotification",gr);else if(gr.flow!=="out"){var yr=gr.scene==="p2p",Cr={msgId:gr.idServer,clientId:gr.idClient,receiveTime:_.__receiveTime,serverTime:gr.time,callbackTime:sa(),preHandleTime:At,fromAccid:gr.from,toAccid:this.core.account,type:Da[gr.scene],tid:yr?"":gr.to,result:200,failReason:"",rt:sa()-gr.time};this.core.reporter.report("msgReceive",Cr,!0)}}},L.nimOnTeamMsgsHandler=function(_){var re,Oe=this;In(re=_.content.datas).call(re,function(de){Oe.onMsgHandler(Mr({},_,{content:{msg:de}}))})},L.syncRoamingMsgsHandler=function(_){var re,Oe,de=_.content.msgs||[];if(de.length!==0){var At=Ti(de[0],this.core.account),tr=(re=this.core.session)===null||re===void 0?void 0:re.getSessionWithUncomplete({id:At}),ur=(de=_d(de,tr?{account:this.core.account,featureValue:Xs.roam,sessionAck:tr.ack,msgReceiptTime:tr.msgReceiptTime}:{account:this.core.account,featureValue:Xs.roam}))[0].time,gr={timetag:ur,sessionId:At,msgs:Yo(de)};!((Oe=this.core.sync)===null||Oe===void 0)&&Oe.getSyncDoneFlag()||this.core.eventBus.emit("session/syncMsgs",gr),this.core.emit("syncRoamingMsgs",gr),this.core.eventBus.emit("sync/updateTimetag",{roamingMsgs:ur})}},L.syncOfflineMsgsHandler=function(_){var re,Oe=this,de=_.content.msgs||[];if(de.length!==0){var At={},tr=[];In(de).call(de,function(gr){var yr=Ti(gr,Oe.core.account),Cr=Oe.core.session.getSessionWithUncomplete({id:yr}),xr=Bi(gr,Cr?{account:Oe.core.account,featureValue:Xs.leave,sessionAck:Cr.ack,msgReceiptTime:Cr.msgReceiptTime}:{account:Oe.core.account,featureValue:Xs.leave});tr.push(xr),At[xr.sessionId]?At[xr.sessionId].push(xr):At[xr.sessionId]=[xr]}),this.markMsgsAck(tr);var ur=0;In(re=Vo(At)).call(re,function(gr){var yr,Cr=wc(yr=At[gr]).call(yr,function(Fr,jr){return jr.time-Fr.time});(Cr=Wl(Cr))[0].time>ur&&(ur=Cr[0].time);var xr={timetag:Cr[0].time,sessionId:gr,msgs:Cr};Oe.core.eventBus.emit("session/syncMsgs",xr),Oe.core.emit("syncOfflineMsgs",xr)}),this.core.eventBus.emit("sync/updateTimetag",{offlineMsgs:ur})}},L.syncDeleteSelfMsgsHandler=function(_){var re,Oe=(re=_.content)===null||re===void 0?void 0:re.deletedMsgs;Oe&&Oe.length>0||this.logger.warn("syncDeleteSelfMsgs:: no msgs");var de=Oe[Oe.length-1].time;this.core.eventBus.emit("sync/updateTimetag",{deleteSelfMsgs:de})},L.onDeleteSelfMsgHandler=function(_){var re=wd([_.content.deletedMsg]);this.core.eventBus.emit("session/updateForDeletedMsg",re),this.core.emit("deleteSelfMsgs",re)},L.onDeleteSelfMsgsHandler=function(_){var re=wd(_.content.deletedMsgs);this.core.eventBus.emit("session/updateForDeletedMsg",re),this.core.emit("deleteSelfMsgs",re)},L.onBroadcastMsgHandler=function(_){var re=_.content.msg,Oe=this.service.processBroadcastMsg([re]);this.core.emit("broadcastMsgs",Oe)},L.syncBroadcastMsgHandler=function(_){var re=_.content.msgs,Oe=this.service.processBroadcastMsg(re);this.core.emit("broadcastMsgs",Oe)},M}(os),MS={"5_1":"sync"},kS={sync:{sid:5,cid:1,service:"sync",isNoResponse:!0,params:[{type:"Property",name:"sync",reflectMapper:{myInfo:1,offlineMsgs:2,teams:3,roamingMsgs:7,relations:9,friends:11,friendUsers:13,msgReceipts:14,myTeamMembers:15,donnop:16,recallMsg:17,sessionAck:18,broadcastMsgs:20,signaling:21,superTeams:22,mySuperTeamMembers:23,superTeamRoamingMsgs:24,deleteSuperTeamMsg:25,superTeamSessionAck:26,deleteSelfMsgs:27,stickTopSessions:28,sessionHistoryMsgsDelete:29}}],response:[{type:"Number",name:"timetag"}]}},qp=function(w){function M($,_){var re;return _===void 0&&(_={}),(re=w.call(this,"sync",$)||this).options=_,re.syncDoneFlag=!1,re.options=Mr({myInfo:!!$.user.name,offlineMsgs:!!$.msg.name,teams:!!$.team.name,myTeamMembers:!!$.team.name,roamingMsgs:!!$.msg.name,relations:!!$.user.name,friends:!!$.friend.name,friendUsers:!!$.user.name,msgReceipts:!!$.msg.name,recallMsg:!!$.msg.name,sessionAck:!!$.session.name,superTeamSessionAck:!!$.session.name,superTeams:!!$.superTeam.name,mySuperTeamMembers:!!$.superTeam.name,superTeamRoamingMsgs:!!$.superTeam.name,deleteSuperTeamMsg:!!$.superTeam.name,deleteSelfMsgs:!!$.msg.name,sessionHistoryMsgsDelete:!!$.msgLog.name,signaling:!!$.signaling.name},_),re.timetags={},re.pArray=[],re.initEventListeners(),qa({cmdMap:MS,cmdConfig:kS}),re}Ro(M,w);var L=M.prototype;return L.getSyncDoneFlag=function(){return this.syncDoneFlag},L.doSync=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var re;return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return re=this.genSyncParams(),this.logger.log("doSync: ",re),de.next=4,this.core.sendCmd("sync",{sync:re});case 4:case"end":return de.stop()}},_,this)}))},L.initEventListeners=function(){var _=this;this.core.eventBus.on("sync/updateTimetag",function(re){var Oe;In(Oe=Vo(re)).call(Oe,function(de){re[de]>(_.timetags[de]||0)&&(_.timetags[de]=re[de])})}),this.core.eventBus.on("logined",function(){_.syncDoneFlag=!1})},L.genSyncParams=function(){var _,re,Oe=this;return op(_=ls(re=Vo(this.options)).call(re,function(de){var At=de;return Oe.options[At]})).call(_,function(de,At){var tr=At;return de[tr]=Oe.timetags[tr]||0,de},{})},L.handleImmediate=function(_){var re;this.core.session&&this.core.session.onSyncDone&&this.core.session.onSyncDone(),this.logger.log("sync: emit syncdone",(re=_.content)===null||re===void 0?void 0:re.timetag),this.syncDoneFlag=!0,this.core.emit("syncdone")},L.syncHandler=function(_){var re=this;(function(){return typeof tt<"u"&&tt.getSystemInfo?"TT":typeof swan<"u"&&swan.getSystemInfo?"BAIDU":typeof my<"u"&&my.getSystemInfo?"ALI":typeof wx<"u"&&wx.getSystemInfo?"WX":"unknow environment"})()==="ALI"?(this.logger.log("sync: emit ALIAPP sycnHandler, handle later"),ho(function(){re.handleImmediate(_)},100)):this.handleImmediate(_)},M}(os),va={"6_26":"getNosCdnHost"},_y={getNosCdnHost:{sid:6,cid:26,service:"misc",response:[{type:"Property",name:"nosConfigTag",reflectMapper:rs({nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4}}).nosConfigTag}]}},_S=function(w){function M(L){var $;return($=w.call(this,"misc",L)||this).core=L,$.nosCdnHostTimer=0,qa({cmdMap:va,cmdConfig:_y}),$}return Ro(M,w),M}(os),Gl=function(M,L,$){L=="__proto__"&&pd?pd(M,L,{configurable:!0,enumerable:!0,value:$,writable:!0}):M[L]=$},wy=Object.prototype.hasOwnProperty,Vp=function(M,L,$){var _=M[L];wy.call(M,L)&&oc(_,$)&&($!==void 0||L in M)||Gl(M,L,$)},Ch=function(M,L,$,_){if(!mi(M))return M;for(var re=-1,Oe=(L=vd(L,M)).length,de=Oe-1,At=M;At!=null&&++re<Oe;){var tr=dl(L[re]),ur=$;if(tr==="__proto__"||tr==="constructor"||tr==="prototype")return M;if(re!=de){var gr=At[tr];(ur=_?_(gr,tr,At):void 0)===void 0&&(ur=mi(gr)?gr:$p(L[re+1])?[]:{})}Vp(At,tr,ur),At=At[tr]}return M},xy=function(M,L,$){for(var _=-1,re=L.length,Oe={};++_<re;){var de=L[_],At=Wg(M,de);$(At,de)&&Ch(Oe,vd(de,M),At)}return Oe},wS=function(M,L){return M!=null&&L in Object(M)},xS=function(M,L,$){for(var _=-1,re=(L=vd(L,M)).length,Oe=!1;++_<re;){var de=dl(L[_]);if(!(Oe=M!=null&&$(M,de)))break;M=M[de]}return Oe||++_!=re?Oe:!!(re=M==null?0:M.length)&&Bg(re)&&$p(de,re)&&(bi(M)||Sd(M))},xd=function(M,L){return M!=null&&xS(M,L,wS)},Mh=function(M,L){return xy(M,L,function($,_){return xd(M,_)})},Ql=function(M,L){for(var $=-1,_=L.length,re=M.length;++$<_;)M[re+$]=L[$];return M},lc=Qs?Qs.isConcatSpreadable:void 0,IS=function(M){return bi(M)||Sd(M)||!!(lc&&M&&M[lc])},Pc=function w(M,L,$,_,re){var Oe=-1,de=M.length;for($||($=IS),re||(re=[]);++Oe<de;){var At=M[Oe];L>0&&$(At)?L>1?w(At,L-1,$,_,re):Ql(re,At):_||(re[re.length]=At)}return re},ES=function(M){return M!=null&&M.length?Pc(M,1):[]},Id=function(M){return Ev(hp(M,void 0,ES),M+"")}(function(w,M){return w==null?{}:Mh(w,M)}),Iy=function(w){function M($){var _;return(_=w.call(this,"user",$)||this).myInfo=zl({}),qa({cmdMap:Ty,cmdConfig:TS}),_}Ro(M,w);var L=M.prototype;return L.setBlack=function(_){return En({account:{type:"string",allowEmpty:!1},isAdd:{type:"boolean"}},_),this.core.sendCmd("setBlack",_).then(function(){})},L.setMute=function(_){return En({account:{type:"string",allowEmpty:!1},isAdd:{type:"boolean"}},_),this.core.sendCmd("setMute",_).then(function(){})},L.getRelations=function(){return this.core.sendCmd("syncRelations",{timetag:0})},L.getBlackList=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var re;return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return de.next=2,this.core.sendCmd("syncRelations",{timetag:0});case 2:return re=de.sent,de.abrupt("return",re.blackList||[]);case 4:case"end":return de.stop()}},_,this)}))},L.getMuteList=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var re;return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return de.next=2,this.core.sendCmd("syncRelations",{timetag:0});case 2:return re=de.sent,de.abrupt("return",re.muteList||[]);case 4:case"end":return de.stop()}},_,this)}))},L.updatePushToken=function(){return Sn(this,void 0,void 0,ar.mark(function _(){return ar.wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:this.logger.error("This function is deprecated, please use nim.offlinePush.setOfflinePushConfig instead");case 1:case"end":return Oe.stop()}},_,this)}))},L.updateAppBackground=function(){return Sn(this,void 0,void 0,ar.mark(function _(){return ar.wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:this.logger.error("This function is deprecated, please use nim.offlinePush.setOfflinePushConfig instead");case 1:case"end":return Oe.stop()}},_,this)}))},L.getUsersNameCardFromServer=function(_){var re=this;return En({accounts:{type:"array",max:150,itemType:"string"}},_),this.core.sendCmd("getUsersNameCardFromServer",Id(_,["accounts"])).then(function(Oe){var de,At=Oe.content;return re.logger.log("user:: getUsers done",_.accounts),At&&At.users?To(de=At.users).call(de,function(tr){return zl(tr)}):[]})},L.updateMyNameCard=function(_){var re=this;if(En({nick:{type:"string",required:!1},avatar:{type:"string",required:!1},signature:{type:"string",required:!1},gender:{type:"enum",values:yi(Md),required:!1},email:{type:"string",required:!1},birth:{type:"string",required:!1},tel:{type:"string",required:!1},ext:{type:"string",required:!1}},_),Vo(_).length===0)return uo.resolve(this.myInfo);var Oe=Id(_,["nick","avatar","signature","email","birth","tel","ext"]);return _.gender&&(Oe.gender=Md[_.gender]),this.core.sendCmd("updateMyNameCard",{user:Oe}).then(function(de){var At=de.content;return At&&At.timetag&&re.core.eventBus.emit("sync/updateTimetag",{myInfo:+At.timetag}),_.gender&&(Oe.gender=_.gender),re.myInfo=Mr({},re.myInfo,Oe),re.myInfo})},L.onUpdateBlackListHandler=function(_){var re=_.content;re.account?this.core.emit("updateBlackList",re):this.logger.warn("onUpdateBlackListHandler: no account")},L.onUpdateMuteListHandler=function(_){var re=_.content;re.account?this.core.emit("updateMuteList",re):this.logger.warn("onUpdateBlackListHandler: no account")},L.syncRelationsHandler=function(_){var re=_.content,Oe=re.list,de=re.timetag,At={blackList:[],muteList:[]};return de&&this.core.eventBus.emit("sync/updateTimetag",{relations:de}),Oe&&Oe.length&&In(Oe).call(Oe,function(tr){var ur=function(yr){var Cr={account:yr.account,updateTime:+yr.updateTime,createTime:+yr.createTime};return yr.isMuted==="1"&&(Cr.isMuted=!0),yr.isBlack==="1"&&(Cr.isBlack=!0),Cr}(tr);ur.isBlack&&At.blackList.push(ur),ur.isMuted&&At.muteList.push(ur)}),this.core.emit("relations",At),uo.resolve(At)},L.syncMyNameCardHandler=function(_){_.content.user&&(this.myInfo=zl(_.content.user),this.core.emit("syncMyNameCard",this.myInfo),this.core.eventBus.emit("sync/updateTimetag",{myInfo:_.content.timetag}))},L.onUpdateMyNameCardHandler=function(_){var re=_.content.user;re?(Mr(this.myInfo,zl(re)),this.core.emit("updateMyNameCard",this.myInfo)):this.logger.warn("onUpdateMyNameCardHandler no user info")},M}(os),Hp=function(){this.__data__=new up,this.size=0},ca=function(M){var L=this.__data__,$=L.delete(M);return this.size=L.size,$},ei=function(M){return this.__data__.get(M)},hl=function(M){return this.__data__.has(M)},PS=function(M,L){var $=this.__data__;if($ instanceof up){var _=$.__data__;if(!dd||_.length<199)return _.push([M,L]),this.size=++$.size,this;$=this.__data__=new fp(_)}return $.set(M,L),this.size=$.size,this};function vl(w){var M=this.__data__=new up(w);this.size=M.size}vl.prototype.clear=Hp,vl.prototype.delete=ca,vl.prototype.get=ei,vl.prototype.has=hl,vl.prototype.set=PS;var Ed=vl,AS=function(M,L){for(var $=-1,_=M==null?0:M.length;++$<_;)if(L(M[$],$,M))return!0;return!1},Ey=function(M,L,$,_,re,Oe){var de=1&$,At=M.length,tr=L.length;if(At!=tr&&!(de&&tr>At))return!1;var ur=Oe.get(M),gr=Oe.get(L);if(ur&&gr)return ur==L&&gr==M;var yr=-1,Cr=!0,xr=2&$?new Pg:void 0;for(Oe.set(M,L),Oe.set(L,M);++yr<At;){var Fr=M[yr],jr=L[yr];if(_)var zr=de?_(jr,Fr,yr,L,M,Oe):_(Fr,jr,yr,M,L,Oe);if(zr!==void 0){if(zr)continue;Cr=!1;break}if(xr){if(!AS(L,function(Hr,Kr){if(!gp(xr,Kr)&&(Fr===Hr||re(Fr,Hr,$,_,Oe)))return xr.push(Kr)})){Cr=!1;break}}else if(Fr!==jr&&!re(Fr,jr,$,_,Oe)){Cr=!1;break}}return Oe.delete(M),Oe.delete(L),Cr},zp=As.Uint8Array,OS=function(M){var L=-1,$=Array(M.size);return M.forEach(function(_,re){$[++L]=[re,_]}),$},Py=Qs?Qs.prototype:void 0,Pd=Py?Py.valueOf:void 0,Ad=function(M,L,$,_,re,Oe,de){switch($){case"[object DataView]":if(M.byteLength!=L.byteLength||M.byteOffset!=L.byteOffset)return!1;M=M.buffer,L=L.buffer;case"[object ArrayBuffer]":return!(M.byteLength!=L.byteLength||!Oe(new zp(M),new zp(L)));case"[object Boolean]":case"[object Date]":case"[object Number]":return oc(+M,+L);case"[object Error]":return M.name==L.name&&M.message==L.message;case"[object RegExp]":case"[object String]":return M==L+"";case"[object Map]":var At=OS;case"[object Set]":var tr=1&_;if(At||(At=Wr),M.size!=L.size&&!tr)return!1;var ur=de.get(M);if(ur)return ur==L;_|=2,de.set(M,L);var gr=Ey(At(M),At(L),_,re,Oe,de);return de.delete(M),gr;case"[object Symbol]":if(Pd)return Pd.call(M)==Pd.call(L)}return!1},Od=function(M,L,$){var _=L(M);return bi(M)?_:Ql(_,$(M))},kh=function(M,L){for(var $=-1,_=M==null?0:M.length,re=0,Oe=[];++$<_;){var de=M[$];L(de,$,M)&&(Oe[re++]=de)}return Oe},Nd=function(){return[]},Rd=Object.prototype.propertyIsEnumerable,_h=Object.getOwnPropertySymbols,NS=_h?function(w){return w==null?[]:(w=Object(w),kh(_h(w),function(M){return Rd.call(w,M)}))}:Nd,Bd=NS,Kp=function(M){return Od(M,Cd,Bd)},RS=Object.prototype.hasOwnProperty,Ay=function(M,L,$,_,re,Oe){var de=1&$,At=Kp(M),tr=At.length;if(tr!=Kp(L).length&&!de)return!1;for(var ur=tr;ur--;){var gr=At[ur];if(!(de?gr in L:RS.call(L,gr)))return!1}var yr=Oe.get(M),Cr=Oe.get(L);if(yr&&Cr)return yr==L&&Cr==M;var xr=!0;Oe.set(M,L),Oe.set(L,M);for(var Fr=de;++ur<tr;){var jr=M[gr=At[ur]],zr=L[gr];if(_)var Hr=de?_(zr,jr,gr,L,M,Oe):_(jr,zr,gr,M,L,Oe);if(!(Hr===void 0?jr===zr||re(jr,zr,$,_,Oe):Hr)){xr=!1;break}Fr||(Fr=gr=="constructor")}if(xr&&!Fr){var Kr=M.constructor,kn=L.constructor;Kr==kn||!("constructor"in M)||!("constructor"in L)||typeof Kr=="function"&&Kr instanceof Kr&&typeof kn=="function"&&kn instanceof kn||(xr=!1)}return Oe.delete(M),Oe.delete(L),xr},wh=cl(As,"DataView"),Wp=cl(As,"Promise"),xh=cl(As,"WeakMap"),Ih="[object Map]",Jl="[object Promise]",Fd="[object Set]",yl="[object WeakMap]",bl="[object DataView]",BS=Mc(wh),Oy=Mc(dd),FS=Mc(Wp),LS=Mc(jl),Ac=Mc(xh),Si=yc;(wh&&Si(new wh(new ArrayBuffer(1)))!=bl||dd&&Si(new dd)!=Ih||Wp&&Si(Wp.resolve())!=Jl||jl&&Si(new jl)!=Fd||xh&&Si(new xh)!=yl)&&(Si=function(w){var M=yc(w),L=M=="[object Object]"?w.constructor:void 0,$=L?Mc(L):"";if($)switch($){case BS:return bl;case Oy:return Ih;case FS:return Jl;case LS:return Fd;case Ac:return yl}return M});var ps=Si,Ks="[object Arguments]",Gp="[object Array]",Yl="[object Object]",Ny=Object.prototype.hasOwnProperty,Tl=function(M,L,$,_,re,Oe){var de=bi(M),At=bi(L),tr=de?Gp:ps(M),ur=At?Gp:ps(L),gr=(tr=tr==Ks?Yl:tr)==Yl,yr=(ur=ur==Ks?Yl:ur)==Yl,Cr=tr==ur;if(Cr&&Lp(M)){if(!Lp(L))return!1;de=!0,gr=!1}if(Cr&&!gr)return Oe||(Oe=new Ed),de||dh(M)?Ey(M,L,$,_,re,Oe):Ad(M,L,tr,$,_,re,Oe);if(!(1&$)){var xr=gr&&Ny.call(M,"__wrapped__"),Fr=yr&&Ny.call(L,"__wrapped__");if(xr||Fr){var jr=xr?M.value():M,zr=Fr?L.value():L;return Oe||(Oe=new Ed),re(jr,zr,$,_,Oe)}}return!!Cr&&(Oe||(Oe=new Ed),Ay(M,L,$,_,re,Oe))},Ry=function w(M,L,$,_,re){return M===L||(M==null||L==null||!vi(M)&&!vi(L)?M!=M&&L!=L:Tl(M,L,$,_,w,re))},$S=function(M,L,$,_){var re=$.length,Oe=re,de=!_;if(M==null)return!Oe;for(M=Object(M);re--;){var At=$[re];if(de&&At[2]?At[1]!==M[At[0]]:!(At[0]in M))return!1}for(;++re<Oe;){var tr=(At=$[re])[0],ur=M[tr],gr=At[1];if(de&&At[2]){if(ur===void 0&&!(tr in M))return!1}else{var yr=new Ed;if(_)var Cr=_(ur,gr,tr,M,L,yr);if(!(Cr===void 0?Ry(gr,ur,3,_,yr):Cr))return!1}}return!0},By=function(M){return M==M&&!mi(M)},Qp=function(M){for(var L=Cd(M),$=L.length;$--;){var _=L[$],re=M[_];L[$]=[_,re,By(re)]}return L},Ld=function(M,L){return function($){return $!=null&&$[M]===L&&(L!==void 0||M in Object($))}},Ci=function(M){var L=Qp(M);return L.length==1&&L[0][2]?Ld(L[0][0],L[0][1]):function($){return $===M||$S($,M,L)}},$d=function(M,L){return Hg(M)&&By(L)?Ld(dl(M),L):function($){var _=Os($,M);return _===void 0&&_===L?xd($,M):Ry(L,_,3)}},Oc=function(M){return function(L){return L==null?void 0:L[M]}},Xo=function(M){return function(L){return Wg(L,M)}},uc=function(M){return Hg(M)?Oc(dl(M)):Xo(M)},Xl=function(M){return typeof M=="function"?M:M==null?$l:typeof M=="object"?bi(M)?$d(M[0],M[1]):Ci(M):uc(M)},Eh=/\s/,jS=function(M){for(var L=M.length;L--&&Eh.test(M.charAt(L)););return L},DS=/^\s+/,US=function(M){return M&&M.slice(0,jS(M)+1).replace(DS,"")},qS=/^[-+]0x[0-9a-f]+$/i,VS=/^0b[01]+$/i,HS=/^0o[0-7]+$/i,zS=parseInt,KS=function(M){if(typeof M=="number")return M;if(Pp(M))return NaN;if(mi(M)){var L=typeof M.valueOf=="function"?M.valueOf():M;M=mi(L)?L+"":L}if(typeof M!="string")return M===0?M:+M;M=US(M);var $=VS.test(M);return $||HS.test(M)?zS(M.slice(2),$?2:8):qS.test(M)?NaN:+M},Ph=1/0,WS=function(M){return M?(M=KS(M))===Ph||M===-1/0?17976931348623157e292*(M<0?-1:1):M==M?M:0:M===0?M:0},Fy=function(M){var L=WS(M),$=L%1;return L==L?$?L-$:L:0},GS=Math.max,Ah=function(M,L,$){var _=M==null?0:M.length;if(!_)return-1;var re=$==null?0:Fy($);return re<0&&(re=GS(_+re,0)),Mv(M,Xl(L),re)},QS={"4_12":"syncMsgReceipts","4_14":"syncSessionAck","4_20":"syncSuperTeamSessionAck","4_22":"nimSyncSessionsWithMoreRoaming","4_25":"syncSessionReliableInfo","7_12":"multiSyncMsgReceipt","7_16":"markSessionAck","7_25":"markMultSessionsAck","7_116":"syncMarkSessionAck","21_25":"markSuperTeamSessionAck","21_32":"markMultSuperTeamSessionsAck","21_125":"syncMarkSuperTeamSessionAck","4_23":"nimSyncStickTopSessions","23_12":"nimAddStickTopSession","23_13":"nimDeleteStickTopSession","23_14":"nimUpdateStickTopSession","23_112":"nimMultiSyncAddStickTopSession","23_113":"nimMultiSyncDeleteStickTopSession","23_114":"nimMultiSyncUpdateStickTopSession"},Zl={msgReceiptTag:{to:1,from:2,time:7,idClient:11},stickTopSessionTag:{id:1,ext:2,createTime:3,updateTime:4},sessionAckTag:{scene:1,to:2,timetag:3},sessionReliableSyncTag:{scene:1,sessionId:2,syncStatus:3,syncEndMsgId:4,syncEndMsgidClient:5,syncEndMsgTime:6,syncStartMsgid:7,syncStartMsgidClient:8,syncStartMsgTime:9,nextMsgid:10,nextMsgidClient:11,nextMsgTime:12,roamMsgSync:13,offlineMsgSync:14,netCallOfflineMsgSync:15}},dc=rs(Zl),JS={syncMsgReceipts:{sid:4,cid:12,service:"session",response:[{type:"PropertyArray",name:"msgReceipts",reflectMapper:dc.msgReceiptTag},{type:"Number",name:"timetag"}]},syncSessionAck:{sid:4,cid:14,service:"session",response:[{type:"StrLongMap",name:"p2p"},{type:"LongLongMap",name:"team"},{type:"Number",name:"timetag"}]},syncSuperTeamSessionAck:{sid:4,cid:20,service:"session",response:[{type:"LongLongMap",name:"superTeam"},{type:"Number",name:"timetag"}]},multiSyncMsgReceipt:{sid:7,cid:12,service:"session",response:[{type:"Property",name:"msgReceiptTag",reflectMapper:dc.msgReceiptTag}]},markSessionAck:{sid:7,cid:16,service:"session",params:[{type:"byte",name:"scene"},{type:"String",name:"to"},{type:"long",name:"timetag"}]},syncMarkSessionAck:{sid:7,cid:116,service:"session",response:[{type:"byte",name:"scene"},{type:"String",name:"to"},{type:"long",name:"timetag"}]},syncMarkSuperTeamSessionAck:{sid:21,cid:125,service:"session",response:[{type:"String",name:"to"},{type:"long",name:"timetag"}]},markMultSessionsAck:{sid:7,cid:25,service:"session",ignoreErrCodes:[700],params:[{type:"PropertyArray",name:"datas",reflectMapper:Zl.sessionAckTag}]},markSuperTeamSessionAck:{sid:21,cid:25,service:"session",params:[{type:"long",name:"to"},{type:"long",name:"timetag"}]},nimAddStickTopSession:{sid:23,cid:12,service:"session",params:[{type:"Property",name:"tag",reflectMapper:Zl.stickTopSessionTag}],response:[{type:"Property",name:"data",reflectMapper:dc.stickTopSessionTag}]},nimDeleteStickTopSession:{sid:23,cid:13,service:"session",params:[{type:"Property",name:"tag",reflectMapper:Zl.stickTopSessionTag}],response:[{type:"Number",name:"timetag"}]},nimUpdateStickTopSession:{sid:23,cid:14,service:"session",params:[{type:"Property",name:"tag",reflectMapper:Zl.stickTopSessionTag}],response:[{type:"Property",name:"data",reflectMapper:dc.stickTopSessionTag}]},nimMultiSyncAddStickTopSession:{sid:23,cid:112,service:"session",response:[{type:"Property",name:"data",reflectMapper:dc.stickTopSessionTag}]},nimMultiSyncDeleteStickTopSession:{sid:23,cid:113,service:"session",response:[{type:"Number",name:"timetag"},{type:"Property",name:"data",reflectMapper:dc.stickTopSessionTag}]},nimMultiSyncUpdateStickTopSession:{sid:23,cid:114,service:"session",response:[{type:"Property",name:"data",reflectMapper:dc.stickTopSessionTag}]},nimSyncStickTopSessions:{sid:4,cid:23,service:"session",response:[{type:"Number",name:"timetag"},{type:"Boolean",name:"isThereAnyChange"},{type:"PropertyArray",name:"datas",reflectMapper:dc.stickTopSessionTag}]},markMultSuperTeamSessionsAck:{sid:21,cid:32,service:"session",ignoreErrCodes:[700],params:[{type:"PropertyArray",name:"datas",reflectMapper:Zl.sessionAckTag}]},nimSyncSessionsWithMoreRoaming:{sid:21,cid:22,service:"session",response:[{type:"PropertyArray",name:"datas",reflectMapper:{0:"scene",1:"to",2:"from",7:"time",12:"idServer"}}]},syncSessionReliableInfo:{sid:4,cid:25,service:"session",response:[{type:"Property",name:"context",reflectMapper:{1:"timetag",2:"type"}},{type:"PropertyArray",name:"datas",reflectMapper:dc.sessionReliableSyncTag}]}},YS={id:{type:"string"},ext:{type:"string"},createTime:{type:"number"},updateTime:{type:"number"}};function Jp(w,M,L){L===void 0&&(L=!0);var $=Zs(YS,w);return $.isStickOnTop=L,$.id=M.id,Mr(Mr({},M),{stickTopInfo:M.stickTopInfo?Mr({},M.stickTopInfo,$):$})}var XS={scene:{type:"enum",values:Da},time:{type:"number"}},jd=function(){function w(L){this.core=L}var M=w.prototype;return M.getSession=function($){return this.core.session.getSessionWithUncomplete({id:$})||this.core.session.createSession($)},M.addStickTopSession=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var re,Oe,de,At,tr,ur;return ar.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return En({id:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},$),re=Lo($.id),Oe=re.scene,de=re.accid,yr.next=4,this.core.sendCmd("nimAddStickTopSession",{tag:{id:(Oe==="superTeam"?"super_team":Oe)+"|"+de,ext:$.ext}});case 4:return At=yr.sent,tr=this.getSession($.id),ur=Jp(At.content.data,tr),yr.abrupt("return",ur);case 8:case"end":return yr.stop()}},_,this)}))},M.deleteStickTopSession=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var re,Oe,de,At,tr,ur;return ar.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return En({id:{type:"string",allowEmpty:!1}},$),re=Lo($.id),Oe=re.scene,de=re.accid,yr.next=4,this.core.sendCmd("nimDeleteStickTopSession",{tag:{id:(Oe==="superTeam"?"super_team":Oe)+"|"+de}});case 4:return At=yr.sent,tr=this.getSession($.id),ur=Jp({updateTime:At.content.timetag},tr,!1),yr.abrupt("return",ur);case 8:case"end":return yr.stop()}},_,this)}))},M.updateStickTopSession=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var re,Oe,de,At,tr,ur;return ar.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return En({id:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},$),re=Lo($.id),Oe=re.scene,de=re.accid,yr.next=4,this.core.sendCmd("nimUpdateStickTopSession",{tag:{id:(Oe==="superTeam"?"super_team":Oe)+"|"+de,ext:$.ext}});case 4:return At=yr.sent,tr=this.getSession($.id),ur=Jp(At.content.data,tr),yr.abrupt("return",ur);case 8:case"end":return yr.stop()}},_,this)}))},M.stickTopSessionHandler=function($,_){_===void 0&&(_=!0);var re=Lo($.id,"|"),Oe=re.scene+"-"+re.accid;return Jp($,this.getSession(Oe),_)},w}(),eu=function(){function w(L){this.core=L,this.logger=L.logger}var M=w.prototype;return M.canSessionResetUnreadCount=function($){var _=$.id;if($.lastMsg===void 0)throw new Error("Session::canSessionResetUnreadCount: session "+_+" is not completly, lastMsg undefined");return $.lastMsg!==null||$.unread>0?!($.ack&&$.lastMsg&&$.ack>=$.lastMsg.time)||(this.logger.log("Session::canSessionResetUnreadCount: session "+_+" reset failed, ack time is greater than last message time"),!1):(this.logger.log("Session::canSessionResetUnreadCount: session "+_+" doesn't need to be updated, lastMsg null and unread 0"),!1)},M.filterSessionForResetUnreadCount=function($){var _=this,re={cmd:"markMultSuperTeamSessionsAck",params:[]},Oe={cmd:"markMultSessionsAck",params:[]};return In($).call($,function(de){var At;try{if(!_.canSessionResetUnreadCount(de))return;var tr=Lo(de.id),ur=tr.accid,gr=tr.scene,yr={to:ur,sessionId:de.id,timetag:((At=de==null?void 0:de.lastMsg)===null||At===void 0?void 0:At.time)||de.updateTime||0},Cr=function(Fr){return Td({scene:{type:"enum",values:Da}},Fr)}({scene:gr});gr==="superTeam"?re.params.push(yr):Oe.params.push(Mr(Mr({},yr),Cr))}catch(xr){_.logger.warn(xr)}}),{superTeam:re,p2pOrTeam:Oe}},w}(),Oh=function(M,L,$){var _=-1,re=M.length;L<0&&(L=-L>re?0:re+L),($=$>re?re:$)<0&&($+=re),re=L>$?0:$-L>>>0,L>>>=0;for(var Oe=Array(re);++_<re;)Oe[_]=M[_+L];return Oe},ZS=function(M,L,$){if(!mi($))return!1;var _=typeof L;return!!(_=="number"?yp($)&&$p(L,$.length):_=="string"&&L in $)&&oc($[L],M)},eC=Math.ceil,tC=Math.max,Ly=function(M,L,$){L=($?ZS(M,L,$):L===void 0)?1:tC(Fy(L),0);var _=M==null?0:M.length;if(!_||L<1)return[];for(var re=0,Oe=0,de=Array(eC(_/L));re<_;)de[Oe++]=Oh(M,re,re+=L);return de};function za(w,M){var L,$=ga!==void 0&&gd(w)||w["@@iterator"];if($)return Oo(L=($=$.call(w)).next).call(L,$);if(hi(w)||($=function(Oe,de){var At;if(Oe){if(typeof Oe=="string")return la(Oe,de);var tr=Co(At=Object.prototype.toString.call(Oe)).call(At,8,-1);if(tr==="Object"&&Oe.constructor&&(tr=Oe.constructor.name),tr==="Map"||tr==="Set")return Ep(Oe);if(tr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(tr))return la(Oe,de)}}(w))||M&&w&&typeof w.length=="number"){$&&(w=$);var _=0;return function(){return _>=w.length?{done:!0}:{done:!1,value:w[_++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function la(w,M){(M==null||M>w.length)&&(M=w.length);for(var L=0,$=new Array(M);L<M;L++)$[L]=w[L];return $}var rC=function(w){function M($,_){var re;return(re=w.call(this,"session",$)||this).list=new tc,re.unreadCountFilterFn=function(Oe){return!0},re.lastMessageFilterFn=function(Oe){return!0},re.initEventListeners(),qa({cmdMap:QS,cmdConfig:JS}),typeof(_==null?void 0:_.unreadCountFilterFn)=="function"&&(re.unreadCountFilterFn=_.unreadCountFilterFn),typeof(_==null?void 0:_.lastMessageFilterFn)=="function"&&(re.lastMessageFilterFn=_.lastMessageFilterFn),re.stickTopService=new jd($),re.unreadModule=new eu($),re}Ro(M,w);var L=M.prototype;return L.initEventListeners=function(){var _,re,Oe,de=this;this.core.eventBus.on("session/syncMsgs",Oo(_=this.onSyncMsgs).call(_,this)),this.core.eventBus.on("session/updateForNewMsg",Oo(re=this.updateSessionWithMsg).call(re,this)),this.core.eventBus.on("session/updateForClearMsg",function(At,tr){tr===void 0&&(tr=!0),At&&At.length>0&&In(At).call(At,function(ur){de.updateSession({id:ur.sessionId,lastMsg:null,unread:0,unreadMsgs:[]},tr)})}),this.core.eventBus.on("session/updateForDeletedMsg",Oo(Oe=this.updateSessionForDeletedMsg).call(Oe,this))},L.createSession=function(_,re){try{var Oe=Lo(_);return{id:_,scene:Oe.scene,to:Oe.accid,lastMsg:re,updateTime:re?re.time:0,unread:0,unreadMsgs:[],ack:0}}catch(de){throw this.logger.error("Failed to create session with "+_,de),new Error("Failed to create session with "+_)}},L.getSession=function(_){En({id:{type:"string",allowEmpty:!1}},_);var re=this.list.get(_.id);if(this.isSessionComplete(re))return re},L.getSessionWithUncomplete=function(_){return this.list.get(_.id)},L.getAllSessions=function(){for(var _,re=[],Oe=za(this.list);!(_=Oe()).done;){var de=_.value;de[0];var At=de[1];this.isSessionComplete(At)&&re.push(At)}return re},L.getSessions=function(_){En({limit:{type:"number",required:!1},lastSessionId:{type:"string",allowEmpty:!1,required:!1},desc:{type:"boolean",required:!1}},_);var re=[],Oe=_.limit,de=Oe===void 0?100:Oe,At=_.desc,tr=At===void 0||At,ur=_.lastSessionId,gr=0;if(tr){for(var yr,Cr,xr=za(this.list);!(Cr=xr()).done;){var Fr=Cr.value,jr=Fr[0],zr=Fr[1];if(ur===jr)break;this.isSessionComplete(zr)&&re.push(zr)}return kl(yr=Co(re).call(re,-de)).call(yr)}for(var Hr,Kr=za(this.list);!(Hr=Kr()).done;){var kn=Hr.value,Yn=kn[0],Hn=kn[1];if(ur)Yn===ur&&(ur=void 0);else if(this.isSessionComplete(Hn)){if(++gr>de)break;re.push(Hn)}}return re},L.resetSessionUnreadCount=function(_){var re,Oe;return Sn(this,void 0,void 0,ar.mark(function de(){var At,tr,ur,gr,yr,Cr,xr,Fr,jr=this;return ar.wrap(function(Hr){for(;;)switch(Hr.prev=Hr.next){case 0:if(!((re=this.core.sync)===null||re===void 0)&&re.getSyncDoneFlag()||this.logger.warn("Please call resetSessionUnreadCount after syncdone event"),En({id:{type:"string",allowEmpty:!1}},_),En({id:{type:"string",allowEmpty:!1}},_),At=_.id,tr=this.list.get(At)){Hr.next=8;break}throw this.logger.warn("resetSessionUnreadCount: can not find session "+At),new Error("Session::canSessionResetUnreadCount: can not find session "+At);case 8:ur=!1;try{ur=this.unreadModule.canSessionResetUnreadCount(tr)}catch(Kr){this.logger.warn(Kr)}if(ur!==!1){Hr.next=12;break}return Hr.abrupt("return");case 12:return gr=Lo(At),yr=gr.accid,Cr=gr.scene,xr={to:yr,timetag:((Oe=tr==null?void 0:tr.lastMsg)===null||Oe===void 0?void 0:Oe.time)||tr.updateTime||0},Fr="markSuperTeamSessionAck",Cr!=="superTeam"&&(xr.scene=Cr==="p2p"?0:1,Fr="markSessionAck"),Hr.abrupt("return",this.core.sendCmd(Fr,xr).then(function(){var Kr=jr.storeUnreadByAck(At,xr.timetag);Kr&&jr.core.emit("updateSession",Kr)}));case 17:case"end":return Hr.stop()}},de,this)}))},L.resetMultiSessionUnreadCount=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr,ur,gr,yr,Cr,xr,Fr,jr,zr,Hr,Kr,kn,Yn=this;return ar.wrap(function(xo){for(;;)switch(xo.prev=xo.next){case 0:!((re=this.core.sync)===null||re===void 0)&&re.getSyncDoneFlag()||this.logger.warn("Please call resetMultiSessionUnreadCount after syncdone event"),En({ids:{type:"array",itemType:"string",min:1}},_),tr=ls(de=To(At=_.ids).call(At,function(Ln){return Yn.list.get(Ln)})).call(de,function(Ln,_r){return!!Ln||(Yn.logger.warn("Session::canSessionResetUnreadCount: can not find session "+_.ids[_r]),!1)}),ur=this.unreadModule.filterSessionForResetUnreadCount(tr),gr=ur.superTeam,yr=ur.p2pOrTeam,Cr=Ly(gr.params,10),xr=Ly(yr.params,10),Fr=za(Cr);case 7:if((jr=Fr()).done){xo.next=14;break}return zr=jr.value,xo.next=11,this.core.sendCmd(gr.cmd,{datas:zr});case 11:In(zr).call(zr,function(Ln){var _r=Yn.storeUnreadByAck(Ln.sessionId,Ln.timetag);_r&&Yn.core.emit("updateSession",_r)});case 12:xo.next=7;break;case 14:Hr=za(xr);case 15:if((Kr=Hr()).done){xo.next=22;break}return kn=Kr.value,xo.next=19,this.core.sendCmd(yr.cmd,{datas:kn});case 19:In(kn).call(kn,function(Ln){var _r=Yn.storeUnreadByAck(Ln.sessionId,Ln.timetag);_r&&Yn.core.emit("updateSession",_r)});case 20:xo.next=15;break;case 22:case"end":return xo.stop()}},Oe,this)}))},L.resetAllSessionsUnreadCount=function(){var _,re;!((re=this.core.sync)===null||re===void 0)&&re.getSyncDoneFlag()||this.logger.warn("Please call resetAllSessionsUnreadCount after syncdone event");var Oe=[];return In(_=this.list).call(_,function(de){Oe.push(de.id)}),this.resetMultiSessionUnreadCount({ids:Oe})},L.deleteSession=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:if(En({id:{type:"string",allowEmpty:!1},isSyncToServer:{type:"boolean",required:!1}},_),this.list.delete(_.id),!this.core.msgLog||!_.isSyncToServer){de.next=5;break}return de.next=5,this.core.msgLog.deleteRoamingMsgs({ids:[_.id]});case 5:case"end":return de.stop()}},re,this)}))},L.deleteAllSessionsFromLocal=function(){this.list.clear()},L.addStickTopSession=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return At.next=2,this.stickTopService.addStickTopSession(_);case 2:return Oe=At.sent,this.list.set(Oe.id,Oe),At.abrupt("return",Oe);case 5:case"end":return At.stop()}},re,this)}))},L.deleteStickTopSession=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return At.next=2,this.stickTopService.deleteStickTopSession(_);case 2:return Oe=At.sent,this.list.set(Oe.id,Oe),At.abrupt("return",Oe);case 5:case"end":return At.stop()}},re,this)}))},L.updateStickTopSession=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return At.next=2,this.stickTopService.updateStickTopSession(_);case 2:return Oe=At.sent,this.list.set(Oe.id,Oe),At.abrupt("return",Oe);case 5:case"end":return At.stop()}},re,this)}))},L.nimMultiSyncAddStickTopSessionHandler=function(_){var re=this.stickTopService.stickTopSessionHandler(_.content.data);this.list.set(re.id,re),this.core.emit("updateSession",re)},L.nimMultiSyncDeleteStickTopSessionHandler=function(_){var re=this.stickTopService.stickTopSessionHandler({id:_.content.data.id,updateTime:_.content.timetag},!1);this.list.set(re.id,re),this.core.emit("updateSession",re)},L.nimMultiSyncUpdateStickTopSessionHandler=function(_){var re=this.stickTopService.stickTopSessionHandler(_.content.data);this.list.set(re.id,re),this.core.emit("updateSession",re)},L.nimSyncStickTopSessionsHandler=function(_){var re=this,Oe=_.content.datas;In(Oe).call(Oe,function(de){var At=re.stickTopService.stickTopSessionHandler(de);re.list.set(At.id,At)})},L.updateSessionWithMsg=function(_){var re=!0,Oe=!0;try{re=!!this.unreadCountFilterFn(_)}catch(ur){this.logger.error("session:updateSessionWithMsg, unreadCountFilterFn error",ur)}try{Oe=!!this.lastMessageFilterFn(_)}catch(ur){this.logger.error("session:updateSessionWithMsg, lastMessageFilterFn error",ur)}var de=this.list.get(_.sessionId)||this.createSession(_.sessionId),At=!1;if(this.logger.log("session:updateSessionWithMsg, pending ",_.sessionId,_.idClient,_.idServer,Oe,re),Oe&&(!de.lastMsg||de.lastMsg.time<_.time||_.status===ha[ha.sending]||de.lastMsg.status===ha[ha.sending])&&(de.lastMsg=_,de.updateTime=_.time,At=!0),re&&_.status===ha[ha.unread]&&_.time>(de.ack||0)){de.unread++;var tr=de.unreadMsgs||[];tr.unshift(_),wc(tr).call(tr,function(ur,gr){return gr.time-ur.time}),At=!0}At&&(this.logger.log("session:updateSessionWithMsg updating ",de.id,de.unread,de.lastMsg&&de.lastMsg.idClient),this.list.set(de.id,de),this.core.emit("updateSession",de))},L.storeUnreadByAck=function(_,re){var Oe=this.list.get(_)||this.createSession(_);if(!(Oe.ack&&re<Oe.ack)){var de=Oe.unreadMsgs||[],At=[],tr=0;return Oe.unreadMsgs=[],de.length>0&&(In(de).call(de,function(ur){ur.time>re&&(tr++,At.push(ur))}),Oe.unreadMsgs=wc(At).call(At,function(ur,gr){return gr.time-ur.time})),Oe.ack=re,Oe.unread=tr,Oe.lastMsg&&Oe.lastMsg.status==="unread"&&re>=Oe.lastMsg.time&&(Oe.lastMsg.status="read"),this.list.set(_,Oe),Oe}this.logger.warn("storeUnreadByAck: not need update ack",_,re,Oe.ack)},L.updateSession=function(_,re){re===void 0&&(re=!0);var Oe=_.id,de=this.list.get(Oe)||this.createSession(_.id),At=Mr(de,_);return this.list.set(Oe,At),this.logger.log("updateSession: update",re,Id(_,["id","ack","unread"]),At.lastMsg&&At.lastMsg.idClient),re&&this.core.emit("updateSession",At),At},L.isSessionComplete=function(_){return!!_&&!!(_.id&&_.scene&&_.to)&&_.lastMsg!==void 0},L.syncSessionAckHandler=function(_){var re,Oe,de=this,At=_.content.p2p||{},tr=_.content.team.m_map||{};this.logger.log("syncSessionAck::",At,tr),In(re=Vo(At)).call(re,function(ur){de.updateSession({id:"p2p-"+ur,ack:At[ur]},!1)}),In(Oe=Vo(tr)).call(Oe,function(ur){de.updateSession({id:"team-"+ur,ack:tr[ur]},!1)})},L.syncSuperTeamSessionAckHandler=function(_){var re,Oe=this,de=_.content.superTeam.m_map;this.logger.log("syncSuperTeamSessionAck::",de),In(re=Vo(de)).call(re,function(At){Oe.updateSession({id:"superTeam-"+At,ack:de[At]},!1)})},L.syncMarkSessionAckHandler=function(_){var re=_.content,Oe=(re.scene===0?"p2p":re.scene===1?"team":"superTeam")+"-"+re.to,de=this.list.get(Oe);if(de&&de.ack&&re.timetag<de.ack)this.logger.warn("syncMarkSessionAckHandler: "+Oe+" do not need update ack",de.ack,re.timetag);else{var At=this.storeUnreadByAck(Oe,re.timetag);At&&this.core.emit("updateSession",At)}},L.syncMarkSuperTeamSessionAckHandler=function(_){_.content.scene=5,this.syncMarkSessionAckHandler(_)},L.onSyncDone=function(){var _,re,Oe,de=this,At=[];In(_=this.list).call(_,function(tr,ur){At.push(de.storeUnreadByAck(ur,tr.ack||0))}),this.list.clear(),In(re=wc(At).call(At,function(tr,ur){return tr.updateTime-ur.updateTime})).call(re,function(tr){de.list.set(tr.id,tr)}),(At=wc(Oe=ls(At).call(At,function(tr){return de.isSessionComplete(tr)})).call(Oe,function(tr,ur){return ur.updateTime-tr.updateTime})).length>0&&this.core.emit("sessions",At)},L.onSyncMsgs=function(_){var re,Oe=this,de=this.list.get(_.sessionId),At=[];try{var tr;At=ls(tr=_.msgs).call(tr,function(xr){return Oe.unreadCountFilterFn(JSON.parse(Wo(xr)))})}catch(xr){this.logger.error("session:onSyncMsgs, unreadCountFilterFn error ",xr)}var ur,gr=[];try{var yr;gr=ls(yr=_.msgs).call(yr,function(xr){return Oe.lastMessageFilterFn(JSON.parse(Wo(xr)))})}catch(xr){this.logger.error("session:onSyncMsgs, lastMessageFilterFn error ",xr)}gr&&gr.length>0&&(ur=gr[gr.length-1],ur=gr[0].time>ur.time?gr[0]:ur);var Cr=ur?ur.time:0;de||(de=ur?this.createSession(_.sessionId,ur):this.createSession(_.sessionId)),de.unreadMsgs=de.unreadMsgs?ls(re=ks(At).call(At,de.unreadMsgs)).call(re,function(xr){return xr.status===ha[ha.unread]}):ls(At).call(At,function(xr){return xr.status===ha[ha.unread]}),de.updateTime&&de.updateTime>=Cr||(de.updateTime=Cr),de.lastMsg&&de.lastMsg.time>=Cr||(de.lastMsg=ur),this.list.set(de.id,de)},L.updateSessionForDeletedMsg=function(_){var re,Oe=this,de={};In(_).call(_,function(At){var tr=At.to===Oe.core.account?At.from:At.to,ur=At.scene+"-"+tr,gr=Oe.list.get(ur);if(gr){if((gr.ack||0)<At.time&&At.from!==Oe.core.account&&gr.unread>0&&(gr.unread=gr.unread-1,gr.unreadMsgs&&gr.unreadMsgs.length>0)){var yr,Cr=Ah(gr.unreadMsgs,{idClient:At.idClient});Cr>=0&&qg(yr=gr.unreadMsgs).call(yr,Cr,1)}gr.lastMsg&&gr.lastMsg.idClient===At.idClient&&(gr.lastMsg=null),de[gr.id]=!0}}),In(re=Vo(de)).call(re,function(At){var tr=Oe.list.get(At);tr&&Oe.core.emit("updateSession",tr)})},L.multiSyncMsgReceiptHandler=function(_){var re,Oe=(re=_.content)===null||re===void 0?void 0:re.msgReceiptTag;if(Oe){this.updateSessionMsgReceiptTime([Oe],!0),Oe.msgReceiptTime=Oe.time,Oe.sessionId="p2p-"+Oe.from,Oe.time,Oe.from;var de=Ps(Oe,["time","from"]);this.core.emit("msgReceipts",[de])}},L.syncMsgReceiptsHandler=function(_){var re,Oe=(re=_.content)===null||re===void 0?void 0:re.msgReceipts;Oe&&this.updateSessionMsgReceiptTime(Oe,!1)},L.updateSessionMsgReceiptTime=function(_,re){var Oe=this;re===void 0&&(re=!0),_&&_.length>0&&In(_).call(_,function(de){var At=Oe.list.get("p2p-"+de.from);At||(At=Oe.createSession("p2p-"+de.from));var tr=ko(de.time);At.msgReceiptTime&&At.msgReceiptTime>=tr||(At.msgReceiptTime=tr,At.lastMsg&&At.lastMsg.status==="sent"&&tr>=At.lastMsg.time&&(At.lastMsg.status="receipt"),Oe.logger.log("session: update session "+At.id+" msgReceiptTime: "+At.msgReceiptTime),Oe.list.set(At.id,At),re&&Oe.core.emit("updateSession",At))})},L.nimSyncSessionsWithMoreRoamingHandler=function(_){var re=function(de,At){return To(de).call(de,function(tr){var ur=Zs(XS,tr);return ur.sessionId=Ti(tr,At),ur})}(_.content.datas,this.core.account);this.logger.log("session:syncSessionsWithMoreRoaming",re)},M}(os),nC=function(){function w(L){this.core=L}var M=w.prototype;return M.notifyAddTeamMembers=function($,_){this.core.emit("addTeamMembers",{team:$,accounts:_,members:bS($,_)})},M.notifyUpdateTeamManagers=function($,_,re,Oe){this.core.emit("updateTeamManagers",{team:{teamId:$,memberUpdateTime:Oe},accounts:_,isManager:re,members:To(_).call(_,function(de){return{id:$+"-"+de,account:de,type:"manager",updateTime:Oe}})})},M.notifyRemoveTeamMembers=function($,_){this.core.emit("removeTeamMembers",{team:$,accounts:_})},M.notifyTransferTeam=function($,_,re){this.core.emit("transferTeam",{team:$,from:{id:$.teamId+"-"+_,type:"normal",account:_,updateTime:$.memberUpdateTime},to:{id:$.teamId+"-"+re,type:"owner",account:re,updateTime:$.memberUpdateTime}})},M.notifyUpdateTeamMembersMute=function($,_,re){this.core.emit("updateTeamMembersMute",{team:$,accounts:_,members:To(_).call(_,function(Oe){return{id:$.teamId+"-"+Oe,account:Oe,teamId:$.teamId,mute:re,updateTime:$.memberUpdateTime}}),mute:re})},w}(),oC=function(M,L){for(var $=-1,_=M==null?0:M.length;++$<_&&L(M[$],$,M)!==!1;);return M},Yp=function(M,L,$,_){var re=!$;$||($={});for(var Oe=-1,de=L.length;++Oe<de;){var At=L[Oe],tr=_?_($[At],M[At],At,$,M):void 0;tr===void 0&&(tr=M[At]),re?Gl($,At,tr):Vp($,At,tr)}return $},aC=function(M,L){return M&&Yp(L,Cd(L),M)},pc=function(M){var L=[];if(M!=null)for(var $ in Object(M))L.push($);return L},Ns=Object.prototype.hasOwnProperty,Xp=function(M){if(!mi(M))return pc(M);var L=fl(M),$=[];for(var _ in M)(_!="constructor"||!L&&Ns.call(M,_))&&$.push(_);return $},Nh=function(M){return yp(M)?sy(M,!0):Xp(M)},fs=function(M,L){return M&&Yp(L,Nh(L),M)},fa=o(function(w,M){var L=M&&!M.nodeType&&M,$=L&&w&&!w.nodeType&&w,_=$&&$.exports===L?As.Buffer:void 0,re=_?_.allocUnsafe:void 0;w.exports=function(de,At){if(At)return de.slice();var tr=de.length,ur=re?re(tr):new de.constructor(tr);return de.copy(ur),ur}}),sC=function(M,L){var $=-1,_=M.length;for(L||(L=Array(_));++$<_;)L[$]=M[$];return L},$y=function(M,L){return Yp(M,Bd(M),L)},Zp=Object.getOwnPropertySymbols?function(w){for(var M=[];w;)Ql(M,Bd(w)),w=ah(w);return M}:Nd,Rh=function(M,L){return Yp(M,Zp(M),L)},jy=function(M){return Od(M,Nh,Zp)},Dy=Object.prototype.hasOwnProperty,Dd=function(M){var L=M.length,$=new M.constructor(L);return L&&typeof M[0]=="string"&&Dy.call(M,"index")&&($.index=M.index,$.input=M.input),$},ef=function(M){var L=new M.constructor(M.byteLength);return new zp(L).set(new zp(M)),L},Bh=function(M,L){var $=L?ef(M.buffer):M.buffer;return new M.constructor($,M.byteOffset,M.byteLength)},Uy=/\w*$/,_s=function(M){var L=new M.constructor(M.source,Uy.exec(M));return L.lastIndex=M.lastIndex,L},qy=Qs?Qs.prototype:void 0,Fh=qy?qy.valueOf:void 0,iC=function(M){return Fh?Object(Fh.call(M)):{}},cC=function(M,L){var $=L?ef(M.buffer):M.buffer;return new M.constructor($,M.byteOffset,M.length)},lC=function(M,L,$){var _=M.constructor;switch(L){case"[object ArrayBuffer]":return ef(M);case"[object Boolean]":case"[object Date]":return new _(+M);case"[object DataView]":return Bh(M,$);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return cC(M,$);case"[object Map]":case"[object Set]":return new _;case"[object Number]":case"[object String]":return new _(M);case"[object RegExp]":return _s(M);case"[object Symbol]":return iC(M)}},Vy=Object.create,uC=function(){function w(){}return function(M){if(!mi(M))return{};if(Vy)return Vy(M);w.prototype=M;var L=new w;return w.prototype=void 0,L}}(),dC=function(M){return typeof M.constructor!="function"||fl(M)?{}:uC(ah(M))},pC=function(M){return vi(M)&&ps(M)=="[object Map]"},Lh=us&&us.isMap,fC=Lh?Al(Lh):pC,mC=function(M){return vi(M)&&ps(M)=="[object Set]"},Hy=us&&us.isSet,$h=Hy?Al(Hy):mC,zy="[object Arguments]",jh="[object Function]",ws="[object Object]",ya={};ya[zy]=ya["[object Array]"]=ya["[object ArrayBuffer]"]=ya["[object DataView]"]=ya["[object Boolean]"]=ya["[object Date]"]=ya["[object Float32Array]"]=ya["[object Float64Array]"]=ya["[object Int8Array]"]=ya["[object Int16Array]"]=ya["[object Int32Array]"]=ya["[object Map]"]=ya["[object Number]"]=ya[ws]=ya["[object RegExp]"]=ya["[object Set]"]=ya["[object String]"]=ya["[object Symbol]"]=ya["[object Uint8Array]"]=ya["[object Uint8ClampedArray]"]=ya["[object Uint16Array]"]=ya["[object Uint32Array]"]=!0,ya["[object Error]"]=ya[jh]=ya["[object WeakMap]"]=!1;var gC=function w(M,L,$,_,re,Oe){var de,At=1&L,tr=2&L,ur=4&L;if($&&(de=re?$(M,_,re,Oe):$(M)),de!==void 0)return de;if(!mi(M))return M;var gr=bi(M);if(gr){if(de=Dd(M),!At)return sC(M,de)}else{var yr=ps(M),Cr=yr==jh||yr=="[object GeneratorFunction]";if(Lp(M))return fa(M,At);if(yr==ws||yr==zy||Cr&&!re){if(de=tr||Cr?{}:dC(M),!At)return tr?Rh(M,fs(de,M)):$y(M,aC(de,M))}else{if(!ya[yr])return re?M:{};de=lC(M,yr,At)}}Oe||(Oe=new Ed);var xr=Oe.get(M);if(xr)return xr;Oe.set(M,de),$h(M)?M.forEach(function(jr){de.add(w(jr,L,$,jr,M,Oe))}):fC(M)&&M.forEach(function(jr,zr){de.set(zr,w(jr,L,$,zr,M,Oe))});var Fr=gr?void 0:(ur?tr?jy:Kp:tr?Nh:Cd)(M);return oC(Fr||M,function(jr,zr){Fr&&(jr=M[zr=jr]),Vp(de,zr,w(jr,L,$,zr,M,Oe))}),de},Nc,fc,mc=function(M){return gC(M,5)},hC=function(w){function M($){var _;return(_=w.call(this,"team",$)||this).myTeamMembersMap=new tc,_.service=new nC($),_.core.eventBus.on("team/onNotification",function(re){return _.notificationHandler(re)}),qa({cmdMap:yy,cmdConfig:by}),_}Ro(M,w);var L=M.prototype;return L.mergeMyTeamMembers=function(_){var re=this;In(_).call(_,function(Oe){var de=Oe.teamId,At=re.myTeamMembersMap.get(de),tr=Mr({},At,Oe);re.myTeamMembersMap.set(de,tr)})},L.getTeamInfo=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_),tr.next=3,this.core.sendCmd("getTeamInfo",{teamId:_.teamId});case 3:return Oe=tr.sent,de=Oe.content.team,tr.abrupt("return",xc(de));case 6:case"end":return tr.stop()}},re,this)}))},L.getTeams=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var re,Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return At.next=2,this.core.sendCmd("getTeams",{timetag:0});case 2:return re=At.sent,Oe=re.content.teams,At.abrupt("return",vh(Oe));case 5:case"end":return At.stop()}},_,this)}))},L.getTeamsById=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return En({teamIds:{type:"array",itemType:"string"}},_),tr.next=3,this.core.sendCmd("getTeamsById",{teamIds:_.teamIds});case 3:return Oe=tr.sent,de=vh(Oe.content.teams),tr.abrupt("return",{teams:de,tids:Oe.content.tids});case 6:case"end":return tr.stop()}},re,this)}))},L.createTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({type:{type:"enum",values:["advanced","normal"]},name:{type:"string",allowEmpty:!1},level:{type:"number",required:!1},accounts:{type:"array",itemType:"string",required:!1},ps:{type:"string",allowEmpty:!1,max:5e3,required:!1},joinMode:{type:"enum",values:["noVerify","needVerify","rejectAll"],required:!1},beInviteMode:{type:"enum",values:["noVerify","needVerify"],required:!1},inviteMode:{type:"enum",values:["manager","all"],required:!1},updateTeamMode:{type:"enum",values:["manager","all"],required:!1},updateExtMode:{type:"enum",values:["manager","all"],required:!1},intro:{type:"string",allowEmpty:!1,required:!1},announcement:{type:"string",allowEmpty:!1,required:!1},avatar:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",allowEmpty:!1,required:!1}},_),Oe=yh(_),ur.next=4,this.core.sendCmd("createTeam",{team:Oe,accounts:_.accounts||[],ps:_.ps||""});case 4:return de=ur.sent,At=xc(de.content.team),ur.abrupt("return",At);case 7:case"end":return ur.stop()}},re,this)}))},L.dismissTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_),de.next=3,this.core.sendCmd("dismissTeam",{teamId:_.teamId});case 3:case"end":return de.stop()}},re,this)}))},L.leaveTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_),de.next=3,this.core.sendCmd("leaveTeam",{teamId:_.teamId});case 3:case"end":return de.stop()}},re,this)}))},L.transferTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},leave:{type:"boolean"}},_),de.next=3,this.core.sendCmd("transferTeam",_);case 3:case"end":return de.stop()}},re,this)}))},L.updateTeamInfo=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},joinMode:{type:"enum",values:["noVerify","needVerify","rejectAll"],required:!1},beInviteMode:{type:"enum",values:["noVerify","needVerify"],required:!1},inviteMode:{type:"enum",values:["manager","all"],required:!1},updateTeamMode:{type:"enum",values:["manager","all"],required:!1},updateExtMode:{type:"enum",values:["manager","all"],required:!1},intro:{type:"string",allowEmpty:!1,required:!1},announcement:{type:"string",allowEmpty:!1,required:!1},avatar:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",allowEmpty:!1,required:!1}},_),Oe=yh(_),At.next=4,this.core.sendCmd("updateTeamInfo",{team:Oe});case 4:return At.abrupt("return",xc(Oe));case 5:case"end":return At.stop()}},re,this)}))},L.getTeamMembers=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",required:!1}},_),ur.next=3,this.core.sendCmd("getTeamMembers",{teamId:_.teamId,timetag:0});case 3:if(de=ur.sent,At=Dp((re=de.content)===null||re===void 0?void 0:re.teamMembers),_.accounts&&_.accounts.length>0){ur.next=7;break}return ur.abrupt("return",At);case 7:return ur.abrupt("return",ls(At).call(At,function(gr){var yr;return(yr=_.accounts)===null||yr===void 0?void 0:bc(yr).call(yr,gr.account)}));case 8:case"end":return ur.stop()}},Oe,this)}))},L.getMutedTeamMembers=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_),tr.next=3,this.core.sendCmd("getMutedTeamMembers",{teamId:_.teamId});case 3:return Oe=tr.sent,de=Oe.content,tr.abrupt("return",Dp(de.teamMembers));case 6:case"end":return tr.stop()}},re,this)}))},L.addTeamMembers=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},_),de.next=3,this.core.sendCmd("addTeamMembers",{teamId:_.teamId,accounts:_.accounts,ps:_.ps||"",attach:_.ext||""});case 3:case"end":return de.stop()}},re,this)}))},L.removeTeamMembers=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1}},_),de.next=3,this.core.sendCmd("removeTeamMembers",{teamId:_.teamId,accounts:_.accounts});case 3:case"end":return de.stop()}},re,this)}))},L.applyTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},_),At.next=3,this.core.sendCmd("applyTeam",{teamId:_.teamId,ps:_.ps||""});case 3:return Oe=At.sent,At.abrupt("return",xc(Oe.content.team));case 5:case"end":return At.stop()}},re,this)}))},L.addTeamManagers=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},_),de.next=3,this.core.sendCmd("addTeamManagers",_);case 3:case"end":return de.stop()}},re,this)}))},L.removeTeamManagers=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},_),de.next=3,this.core.sendCmd("removeTeamManagers",_);case 3:case"end":return de.stop()}},re,this)}))},L.updateMyMemberInfo=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1,required:!1},bitConfigMask:{type:"number",min:0,max:2,required:!1},ext:{type:"string",required:!1}},_),Oe=hy({teamId:_.teamId,nickInTeam:_.nickInTeam,bitConfigMask:_.bitConfigMask,ext:_.ext}),ur.next=4,this.core.sendCmd("updateMyMemberInfo",{teamMember:Oe});case 4:return de=kd(Mr({updateTime:new Date().getTime(),account:this.core.account},Oe)),this.mergeMyTeamMembers([de]),this.core.emit("updateTeamMember",de),At=mc(this.myTeamMembersMap.get(de.teamId)),this.core.emit("myTeamMembers",[At]),ur.abrupt("return",de);case 10:case"end":return ur.stop()}},re,this)}))},L.updateMemberNick=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1}},_),Oe=hy({teamId:_.teamId,nickInTeam:_.nickInTeam,account:_.account}),tr.next=4,this.core.sendCmd("updateNickInTeam",{teamMember:Oe});case 4:return de=kd(Mr({updateTime:new Date().getTime()},Oe)),tr.abrupt("return",de);case 6:case"end":return tr.stop()}},re,this)}))},L.muteTeamMember=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},mute:{type:"boolean"}},_),de.next=3,this.core.sendCmd("muteTeamMember",{teamId:_.teamId,account:_.account,mute:_.mute?1:0});case 3:case"end":return de.stop()}},re,this)}))},L.getTeamMemberInvitorAccid=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",max:200}},_),de={teamId:_.teamId},_.accounts&&_.accounts.length>0&&(de.accounts=_.accounts),ur.next=5,this.core.sendCmd("getTeamMemberInvitorAccid",de);case 5:return At=ur.sent,ur.abrupt("return",((re=At.content)===null||re===void 0?void 0:re.accountsMap)||{});case 7:case"end":return ur.stop()}},Oe,this)}))},L.muteTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},mute:{type:"boolean"}},_),de.next=3,this.core.sendCmd("muteTeam",{teamId:_.teamId,mute:_.mute?1:0});case 3:case"end":return de.stop()}},re,this)}))},L.passTeamApply=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},_),de.next=3,this.core.sendCmd("passTeamApply",_);case 3:case"end":return de.stop()}},re,this)}))},L.rejectTeamApply=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},_),de.next=3,this.core.sendCmd("rejectTeamApply",{teamId:_.teamId,from:_.from,ps:_.ps||""});case 3:case"end":return de.stop()}},re,this)}))},L.acceptTeamInvite=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},_),de.next=3,this.core.sendCmd("acceptTeamInvite",_);case 3:case"end":return de.stop()}},re,this)}))},L.rejectTeamInvite=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},_),de.next=3,this.core.sendCmd("rejectTeamInvite",{teamId:_.teamId,from:_.from,ps:_.ps||""});case 3:case"end":return de.stop()}},re,this)}))},L.notifyTeamMsgReceiptsHandler=function(_){var re,Oe=(re=_.content)===null||re===void 0?void 0:re.teamMsgReceipts;Oe&&Oe.length>0&&(this.core.emit("teamMsgReceipts",Oe),this.core.emit("msgReceipts",Oe))},L.syncTeamsHandler=function(_){var re=_.content;this.core.eventBus.emit("sync/updateTimetag",{teams:ko(re.timetag)});var Oe=re==null?void 0:re.teams;if(Oe&&Oe.length){var de=vh(Oe);this.core.emit("teams",de)}},L.syncCreateTeamHandler=function(_){var re=_.content,Oe=xc(re==null?void 0:re.team),de=vy(Oe,Oe.owner,"owner");this.core.emit("createTeam",Oe,de)},L.syncUpdateTeamMemberHandler=function(_){var re=_.content,Oe=kd(re==null?void 0:re.teamMember);Oe.updateTime||(Oe.updateTime=new Date().getTime()),this.mergeMyTeamMembers([Oe]),this.core.emit("updateTeamMember",Oe);var de=mc(this.myTeamMembersMap.get(Oe.teamId));this.core.emit("myTeamMembers",[de])},L.syncMyTeamMembersHandler=function(_){var re,Oe=_.content;this.core.eventBus.emit("sync/updateTimetag",{myTeamMembers:ko(Oe.timetag)});var de=Oe==null?void 0:To(re=Oe.teamMembers).call(re,function(At){return kd(At)});this.mergeMyTeamMembers(de),this.core.emit("myTeamMembers",mc(de))},L.notificationHandler=function(_){var re=_.attach,Oe=_.scene,de=_.from,At=_.to,tr=_.time,ur=_.idServer,gr=_.idClient,yr=re.team,Cr=re.account,xr=re.accounts,Fr=re.type;if(Oe==="team")switch(this.core.options.debugLevel==="debug"?this.logger.debug("team::recvNotification",ur,gr,re):this.logger.log("team::recvNotification",ur,gr,At,Fr,Cr,xr),Fr){case"updateTeam":yr.updateTime=tr,this.core.emit("updateTeam",yr);break;case"addTeamMembers":this.service.notifyAddTeamMembers(yr,xr);break;case"acceptTeamInvite":this.service.notifyAddTeamMembers(yr,[de]);break;case"passTeamApply":this.service.notifyAddTeamMembers(yr,[Cr]);break;case"addTeamManagers":this.service.notifyUpdateTeamManagers(At,xr,!0,tr);break;case"removeTeamManagers":this.service.notifyUpdateTeamManagers(At,xr,!1,tr);break;case"removeTeamMembers":this.service.notifyRemoveTeamMembers(yr,xr);break;case"leaveTeam":this.service.notifyRemoveTeamMembers(yr,[de]);break;case"dismissTeam":this.core.emit("dismissTeam",{teamId:At});break;case"transferTeam":this.service.notifyTransferTeam(yr,de,Cr);break;case"updateTeamMemberMute":this.service.notifyUpdateTeamMembersMute(yr,[Cr],re.mute)}},M}(os);(function(w){w[w.none=0]="none",w[w.pass=1]="pass",w[w.decline=2]="decline",w[w.read=3]="read",w[w.deleted=4]="deleted",w[w.invalid=5]="invalid"})(Nc||(Nc={})),function(w){w[w.default=0]="default",w[w.leave=1]="leave",w[w.roam=2]="roam"}(fc||(fc={}));var Ud={applyTeam:0,rejectTeamApply:1,teamInvite:2,rejectTeamInvite:3,friendRequest:5,deleteFriend:6,recallMsgP2p:7,recallMsgTeam:8,recallMsgSuperTeam:12,deleteMsgP2pOneWay:13,deleteMsgTeamOneWay:14,applySuperTeam:15,rejectSuperTeamApply:16,superTeamInvite:17,rejectSuperTeamInvite:18,customP2p:100,customTeam:101,customSuperTeam:103},qd={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"},tf={setting:{needSaveOffline:{type:"boolean"},isRoutable:{type:"boolean"},envConfig:{type:"string"}},antiSpamInfo:{needAntiSpam:{type:"boolean"},antiSpamContent:{type:"boolean"}},pushInfo:Sh,recallMessageInfo:{idClient:{type:"string",rawKey:"deletedIdClient"},idServer:{type:"string",rawKey:"deletedIdServer"},createTime:{type:"number",rawKey:"deletedMsgTime"},fromNick:{type:"string",rawKey:"deletedMsgFromNick"},opeAccount:{type:"string"}}};function Vd(w,M,L){var $=+w.type,_=Oi(Ud,$);L=L||fc.default;var re=Mr(Mr({},Zs(tf,w)),{type:_,time:+w.time,to:w.to,from:w.from,idServer:w.idServer,state:Nc[Nc.none],feature:fc[L]});if(typeof re.attach=="string")try{re.attach=JSON.parse(re.attach)}catch(Oe){M.error("formatSystemMessage: "+re.idServer+" parse attach error",Oe&&Oe.message)}return $===5&&re.attach?(re.attach.type=qd[+re.attach.vt],re.attach.type==="passFriendApply"?re.state=Nc[Nc.pass]:re.attach.type==="rejectFriendApply"&&(re.state=Nc[Nc.decline])):$<=3&&re.attach&&(re.attach=function(de){var At=de.attach,tr=de.tinfo,ur=Ps(de,["attach","tinfo"]);return ur.ext=At,tr!==void 0&&(ur.team=xc(Ei(de.tinfo,as.team))),ur}(re.attach)),re}function vC(w){var M=Mr({},w);return Mr(Mr({},Td(tf,M)),{type:Ud[M.type],to:M.to,attach:M.attach})}var yC={"4_6":"syncOfflineSysMsgs","4_18":"syncOfflineSysMsgs","4_19":"syncRecallMsgOfflineAndRoaming","4_101":"syncOfflineSysMsgs","7_3":"onSysMsg","7_7":"sendCustomSysMsg","7_14":"onRecallMsg","21_18":"onRecallMsg","21_117":"onRecallMsg","7_15":"syncRecallMsgOfflineAndRoaming","21_19":"onSysMsg","21_16":"sendSuperTeamCustomSysMsg","101_3":"onSysMsg","101_7":"sendFilterCustomSysMsg"},Hd={sysMsg:Mr({time:0,type:1,to:2,from:3,content:4,attach:5,idServer:6,needSaveOffline:7,deletedIdClient:10,deletedIdServer:11,needcAntiSpam:12,antiSpamContent:13,deletedMsgTime:14,deletedMsgFromNick:15,opeAccount:16,envConfig:21,callbackExt:22,isRoutable:105},My)},Sl=rs(Hd),bC={onSysMsg:{service:"systemMessage",sid:7,cid:3,response:[{type:"Property",name:"sysMsg",reflectMapper:Sl.sysMsg}]},sendCustomSysMsg:{service:"systemMessage",sid:7,cid:7,params:[{type:"Property",name:"sysMsg",reflectMapper:Hd.sysMsg}]},sendSuperTeamCustomSysMsg:{service:"systemMessage",sid:21,cid:16,params:[{type:"Property",name:"sysMsg",reflectMapper:Hd.sysMsg}]},sendFilterCustomSysMsg:{service:"systemMessage",sid:101,cid:7,params:[{type:"Property",name:"sysMsg",reflectMapper:Hd.sysMsg}]},batchMarkRead:{service:"systemMessage",sid:4,cid:5,isNoResponse:!0,params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]},onRecallMsg:{sid:7,cid:14,service:"systemMessage",response:[{type:"Property",name:"sysMsg",reflectMapper:Sl.sysMsg}]},syncRecallMsgOfflineAndRoaming:{sid:7,cid:15,service:"systemMessage",response:[{type:"PropertyArray",name:"sysMsgs",reflectMapper:Sl.sysMsg},{type:"Number",name:"timetag"},{type:"Number",name:"type"}]},syncOfflineSysMsgs:{sid:4,cid:9,service:"systemMessage",response:[{type:"PropertyArray",name:"sysMsgs",reflectMapper:Sl.sysMsg}]}},TC=function(w){function M($){var _;return(_=w.call(this,"systemMessage",$)||this).sysMsgUnread={total:0,friend:0,msg:0,team:0,superTeam:0},_.core.eventBus.on("logined",function(){_.initEventListeners()}),qa({cmdMap:yC,cmdConfig:bC}),_}Ro(M,w);var L=M.prototype;return L.initEventListeners=function(){var _=this;this.core.eventBus.on("systemMessage/passFriendApply",function(re){_.core.emit("updateSystemMessages",[{idServer:re.idServer,from:re.account,state:"pass",type:"friendRequest"}])}),this.core.eventBus.on("systemMessage/rejectFriendApply",function(re){_.core.emit("updateSystemMessages",[{idServer:re.idServer,from:re.account,state:"decline",type:"friendRequest"}])})},L.doMarkSysMsgAck=function(_){var re=[],Oe=[],de=["applySuperTeam","rejectSuperTeamApply","superTeamInvite","rejectSuperTeamInvite","customSuperTeam"];In(_).call(_,function(At){At.idServer&&(bc(de).call(de,At.type)?Oe.push(At.idServer):re.push(At.idServer))}),re.length>0&&this.core.sendCmd("batchMarkRead",{sid:"7",cid:"3",ids:re}),Oe.length>0&&this.core.sendCmd("batchMarkRead",{sid:"21",cid:"19",ids:Oe})},L.sendCustomSysMsg=function(_){var re=this;En({to:{type:"string",allowEmpty:!1},type:{type:"enum",values:["customP2p","customTeam","customSuperTeam"]},attach:{type:"string",allowEmpty:!1},setting:{type:"object",rules:{needSaveOffline:{type:"boolean",required:!1},env:{type:"string",allowEmpty:!1,required:!1}},required:!1},pushInfo:{type:"object",required:!1,rules:Sh}},_);var Oe=_.type==="customSuperTeam"?"sendSuperTeamCustomSysMsg":"sendCustomSysMsg";return this.core.sendCmd(Oe,{sysMsg:vC(_)}).then(function(){re.logger.log("sendCustomSysMsg success")}).catch(function(de){throw re.logger.error("sendCustomSysMsg failed",de.message),de})},L.onSysMsgHandler=function(_){var re,Oe=(re=_.content)===null||re===void 0?void 0:re.sysMsg;if(Oe){var de=typeof Os(_,"raw.r[0]")=="number"?""+_.raw.r[0]:void 0;Oe.idServer=Oe.idServer||de;var At=Vd(Oe,this.logger,fc.default);this.core.emit("sysMsg",At),this.doMarkSysMsgAck([At])}else this.logger.warn("onSysMsg no content.sysMsg")},L.syncOfflineSysMsgsHandler=function(_){var re,Oe=this;if(_.content.sysMsgs&&_.content.sysMsgs.length>0){var de=To(re=_.content.sysMsgs).call(re,function(At){return Vd(At,Oe.logger,fc.leave)});this.core.emit("syncSysMsgs",de),this.doMarkSysMsgAck(de)}},L.onRecallMsgHandler=function(_){var re,Oe=(re=_.content)===null||re===void 0?void 0:re.sysMsg;if(Oe){var de=typeof Os(_,"raw.r[0]")=="number"?""+_.raw.r[0]:void 0;Oe.idServer=Oe.idServer||de;var At=wd([Oe],function(gr){return gr===Ud.recallMsgP2p?"p2p":gr===Ud.recallMsgTeam?"team":gr===Ud.recallMsgSuperTeam?"superTeam":""}(+Oe.type));this.core.eventBus.emit("session/updateForDeletedMsg",At);var tr=Vd(Oe,this.logger,fc.default);this.core.emit("sysMsg",tr),this.doMarkSysMsgAck([tr])}else this.logger.warn("onSysMsg no content.sysMsg")},L.syncRecallMsgOfflineAndRoamingHandler=function(_){var re=this,Oe=_.content,de=Oe.timetag,At=Oe.type,tr=Oe.sysMsgs,ur=ko(At),gr=ur===1?fc.leave:fc.roam,yr=To(tr).call(tr,function(Cr){return Vd(Cr,re.logger,gr)});ur===1&&this.doMarkSysMsgAck(yr),this.core.eventBus.emit("sync/updateTimetag",{recallMsg:de}),this.core.emit("syncSysMsgs",yr)},M}(os);function zd(w){var M=["bitsExtension","createTime","updateTime","passRelationShip","relationShip","source"],L=Mr({},w);return In(M).call(M,function($){L[$]!==void 0&&(L[$]=ko(L[$]))}),L.relationShip!==void 0&&(L.valid=L.relationShip===1),L}var SC={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"},Dh={"12_4":"getFriends","12_1":"friendReuqest","12_2":"deleteFriend","12_3":"updateFriend","12_5":"syncFriends","12_6":"syncFriendUsers","12_101":"syncFriendRequest","12_102":"syncDeleteFriend","12_103":"syncUpdateFriend"},rf={updateFriendTag:{account:4,alias:8,ext:10},delFriendParams:{delAlias:1},friendTag:{account:4,relationShip:5,passRelationShip:6,source:7,alias:8,bitsExtension:9,ext:10,createTime:11,updateTime:12,serverex:13},userTag:{account:1,nick:3,avatar:4,sign:5,gender:6,email:7,birth:8,tel:9,ext:10,createTime:12,updateTime:13}},nf=rs(rf),Ky={getFriends:{sid:12,cid:4,service:"friend",params:[{type:"Long",name:"timetag"}],response:[{type:"PropertyArray",name:"friends",reflectMapper:nf.friendTag},{type:"Number",name:"timetag"}]},friendReuqest:{sid:12,cid:1,service:"friend",params:[{type:"String",name:"account"},{type:"Byte",name:"type"},{type:"String",name:"ps"}]},deleteFriend:{sid:12,cid:2,service:"friend",params:[{type:"String",name:"account"},{type:"Property",name:"delFriendParams",reflectMapper:rf.delFriendParams}]},updateFriend:{sid:12,cid:3,service:"friend",params:[{type:"Property",name:"updateFriendTag",reflectMapper:rf.updateFriendTag}]},syncFriends:{sid:12,cid:5,service:"friend",response:[{type:"PropertyArray",name:"friends",entity:"friendTag",reflectMapper:nf.friendTag},{type:"Number",name:"timetag"}]},syncFriendUsers:{sid:12,cid:6,service:"friend",response:[{type:"PropertyArray",name:"users",entity:"userTag",reflectMapper:nf.userTag},{type:"Number",name:"timetag"}]},syncFriendRequest:{sid:12,cid:101,service:"friend",params:[{type:"String",name:"account"},{type:"Number",name:"type"},{type:"String",name:"ps"}],response:[{type:"String",name:"account"},{type:"Number",name:"type"},{type:"String",name:"ps"}]},syncDeleteFriend:{sid:12,cid:102,service:"friend",response:[{type:"String",name:"account"}]},syncUpdateFriend:{sid:12,cid:103,service:"friend",response:[{type:"Property",name:"friend",reflectMapper:nf.friendTag}]}},CC=function(w){function M($){var _;return _=w.call(this,"friend",$)||this,qa({cmdMap:Dh,cmdConfig:Ky}),_}Ro(M,w);var L=M.prototype;return L.getFriends=function(){var _;return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return tr.next=2,this.core.sendCmd("getFriends",{timetag:0});case 2:return Oe=tr.sent,de=((_=Oe.content)===null||_===void 0?void 0:_.friends)||[],de=To(de).call(de,function(ur){return zd(ur)}),tr.abrupt("return",de);case 6:case"end":return tr.stop()}},re,this)}))},L.addFriend=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({account:{type:"string",allowEmpty:!1},ps:{type:"string",allowEmpty:!1,required:!1}},_),At.next=3,this.core.sendCmd("friendReuqest",{account:_.account,type:1,ps:_.ps||""});case 3:return Oe=new Date().getTime(),At.abrupt("return",{account:_.account,createTime:Oe,updateTime:Oe,valid:!0,source:0,passRelationShip:1,relationShip:1,bitsExtension:0});case 5:case"end":return At.stop()}},re,this)}))},L.applyFriend=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({account:{type:"string",allowEmpty:!1}},_),de.next=3,this.core.sendCmd("friendReuqest",{account:_.account,type:2,ps:_.ps||""});case 3:case"end":return de.stop()}},re,this)}))},L.passFriendApply=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe=this;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({account:{type:"string",allowEmpty:!1}},_),At.next=3,this.core.sendCmd("friendReuqest",{account:_.account,type:3,ps:_.ps||""}).then(function(tr){return Oe.core.eventBus.emit("systemMessage/passFriendApply",_),tr});case 3:case"end":return At.stop()}},re,this)}))},L.rejectFriendApply=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe=this;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({account:{type:"string",allowEmpty:!1}},_),At.next=3,this.core.sendCmd("friendReuqest",{account:_.account,type:4,ps:_.ps||""}).then(function(tr){return Oe.core.eventBus.emit("systemMessage/rejectFriendApply",_),tr});case 3:case"end":return At.stop()}},re,this)}))},L.deleteFriend=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({account:{type:"string",allowEmpty:!1},delAlias:{type:"boolean"}},_),de.next=3,this.core.sendCmd("deleteFriend",{account:_.account,delFriendParams:{delAlias:_.delAlias===!0?1:0}});case 3:case"end":return de.stop()}},re,this)}))},L.updateFriend=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({account:{type:"string",allowEmpty:!1},alias:{type:"string"},ext:{type:"string",required:!1}},_),de.next=3,this.core.sendCmd("updateFriend",{updateFriendTag:_});case 3:case"end":return de.stop()}},re,this)}))},L.syncFriendRequestHandler=function(_){var re=function(de){var At=Mr({},de);try{At.ps=At.ps&&JSON.parse(At.ps)}catch{}if(At.type=SC[At.type],At.type==="addFriend"||At.type==="passFriendApply"){var tr=new Date().getTime();At.friend={account:de.account,alias:"",createTime:tr,ext:"",updateTime:tr,valid:!0}}return At}(_.content);this.core.emit("syncFriend",re)},L.syncDeleteFriendHandler=function(_){var re=_.content.account;this.logger.log("friend::emit syncFriendAction: deleteFriend "+re),this.core.emit("syncFriend",{type:"deleteFriend",account:re})},L.syncUpdateFriendHandler=function(_){var re=zd(_.content.friend);this.logger.log("friend::emit syncFriendAction: updateFriend, ",re==null?void 0:re.account),this.core.emit("syncFriend",{type:"updateFriend",friend:re})},L.syncFriendsHandler=function(_){var re=_.content;this.core.eventBus.emit("sync/updateTimetag",{friends:ko(re.timetag)});var Oe=re==null?void 0:re.friends;if(Oe&&Oe.length){var de=To(Oe).call(Oe,function(At){return zd(At)});this.core.emit("friends",de)}},L.syncFriendUsersHandler=function(_){var re=_.content;this.core.eventBus.emit("sync/updateTimetag",{friendUsers:ko(re.timetag)});var Oe=re==null?void 0:re.users;if(Oe&&Oe.length){var de=To(Oe).call(Oe,function(At){return zl(At)});this.core.emit("users",de)}},M}(os),Uh={1:"Android",2:"iOS",4:"PC",8:"WindowsPhone",16:"Web",32:"Server",64:"Mac"};function Wy(w){return w&&w.length>0?To(w).call(w,function(M){return function($){var _=Mr({},$),re=["subscribeTime","time"];return In(re).call(re,function(Oe){_[Oe]&&(_[Oe]=ko(_[Oe]))}),_}(M)}):[]}function Rc(w){if(!w)return w;var M=w.serverExt,L=Ps(w,["serverExt"]),$=["time","type","value"];if(In($).call($,function(_){L[_]&&(L[_]=ko(L[_]))}),L.clientType&&(L.clientType=Uh[L.clientType]||""),M)try{L.ext=JSON.parse(M),typeof L.ext[0]=="string"&&(L.ext=L.ext[0])}catch{}return L}var Gy={"14_1":"publishEvent","14_2":"pushEvent","14_3":"subscribeEvent","14_4":"unSubscribeEventsByAccounts","14_5":"unSubscribeEventsByType","14_6":"querySubscribeEventsByAccounts","14_7":"querySubscribeEventsByType","14_9":"pushEvents"},Cl={msgEvent:{type:1,value:2,idClient:3,ext:4,validTime:5,broadcastType:6,sync:7,validTimeType:8,durable:9,time:10,idServer:11,clientType:12,serverConfig:13,serverExt:14,appid:101,account:103,enableMultiClient:104,consid:106},msgEventSubscribe:{type:1,subscribeTime:2,sync:3,to:102,from:104,time:105}},tu=rs(Cl),MC={publishEvent:{sid:14,cid:1,service:"event",params:[{type:"Property",name:"msgEvent",reflectMapper:Cl.msgEvent}],response:[{type:"Property",name:"msgEvent",reflectMapper:tu.msgEvent}]},pushEvent:{sid:14,cid:2,service:"event",response:[{type:"Property",name:"msgEvent",reflectMapper:tu.msgEvent}]},subscribeEvent:{sid:14,cid:3,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:Cl.msgEventSubscribe},{type:"StrArray",name:"accounts"}],response:[{type:"StrArray",name:"accounts"}]},unSubscribeEventsByAccounts:{sid:14,cid:4,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:Cl.msgEventSubscribe},{type:"StrArray",name:"accounts"}],response:[{type:"StrArray",name:"accounts"}]},unSubscribeEventsByType:{sid:14,cid:5,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:Cl.msgEventSubscribe}]},querySubscribeEventsByAccounts:{sid:14,cid:6,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:Cl.msgEventSubscribe},{type:"StrArray",name:"accounts"}],response:[{type:"PropertyArray",name:"msgEventSubscribes",reflectMapper:tu.msgEventSubscribe}]},querySubscribeEventsByType:{sid:14,cid:7,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:Cl.msgEventSubscribe}],response:[{type:"PropertyArray",name:"msgEventSubscribes",reflectMapper:tu.msgEventSubscribe}]},pushEvents:{sid:14,cid:9,service:"event",response:[{type:"PropertyArray",name:"msgEvents",reflectMapper:tu.msgEvent}]}},S=function(w){function M($){var _;return _=w.call(this,"event",$)||this,qa({cmdMap:Gy,cmdConfig:MC}),_}Ro(M,w);var L=M.prototype;return L.publishEvent=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return En({type:{type:"number"},value:{type:"number"},ext:{type:"string",required:!1},validTime:{type:"number",min:60,max:2592e3,required:!1},broadcastType:{type:"number",required:!1},sync:{type:"boolean",required:!1}},_),de=Mr(Mr({validTime:604800},_),{idClient:_p(),sync:_.sync===!0?1:0}),gr.next=4,this.core.sendCmd("publishEvent",{msgEvent:de});case 4:return At=gr.sent,tr=((re=At.content)===null||re===void 0?void 0:re.msgEvent)||{},gr.abrupt("return",Rc(tr));case 7:case"end":return gr.stop()}},Oe,this)}))},L.subscribeEvent=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return En({type:{type:"number"},accounts:{type:"array",itemType:"string",max:100},subscribeTime:{type:"number",min:60,max:2592e3,required:!1}},_),de=Mr(Mr({subscribeTime:2592e3},_),{sync:_.sync===!0?1:0}),gr.next=4,this.core.sendCmd("subscribeEvent",{msgEventSubscribe:de,accounts:_.accounts});case 4:return At=gr.sent,tr=((re=At.content)===null||re===void 0?void 0:re.accounts)||[],gr.abrupt("return",{failedAccounts:tr});case 7:case"end":return gr.stop()}},Oe,this)}))},L.unSubscribeEvents=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:if(En({type:{type:"number"},accounts:{type:"array",itemType:"string",max:100,required:!1}},_),de={type:_.type},!(_.accounts&&_.accounts.length>0)){gr.next=9;break}return gr.next=5,this.core.sendCmd("unSubscribeEventsByAccounts",{msgEventSubscribe:de,accounts:_.accounts});case 5:tr=gr.sent,At=((re=tr.content)===null||re===void 0?void 0:re.accounts)||[],gr.next=12;break;case 9:return gr.next=11,this.core.sendCmd("unSubscribeEventsByType",{msgEventSubscribe:de});case 11:At=[];case 12:return gr.abrupt("return",{failedAccounts:At});case 13:case"end":return gr.stop()}},Oe,this)}))},L.querySubscribeEvents=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:if(En({type:{type:"number"},accounts:{type:"array",itemType:"string",max:100,required:!1}},_),!(_.accounts&&_.accounts.length>0)){tr.next=7;break}return tr.next=4,this.core.sendCmd("querySubscribeEventsByAccounts",{msgEventSubscribe:{type:_.type},accounts:_.accounts});case 4:de=tr.sent,tr.next=10;break;case 7:return tr.next=9,this.core.sendCmd("querySubscribeEventsByType",{msgEventSubscribe:{type:_.type}});case 9:de=tr.sent;case 10:return tr.abrupt("return",Wy((re=de.content)===null||re===void 0?void 0:re.msgEventSubscribes));case 11:case"end":return tr.stop()}},Oe,this)}))},L.pushEventHandler=function(_){var re,Oe=((re=_.content)===null||re===void 0?void 0:re.msgEvent)||{};this.core.emit("pushEvents",[Rc(Oe)])},L.pushEventsHandler=function(_){var re,Oe=((re=_.content)===null||re===void 0?void 0:re.msgEvents)||{};this.core.emit("pushEvents",function(At){return hi(At)&&At.length>0?To(At).call(At,function(tr){return Rc(tr)}):[]}(Oe))},M}(os);function x(w){var M={scene:mh[w.scene],from:w.threadMsgFromAccount,to:w.threadMsgToAccount,time:w.threadMsgTime,idServer:w.threadMsgIdServer},L={limit:w.limit<100?w.limit:100,beginTime:typeof w.beginTime=="number"?w.beginTime:0,reverse:kl(w)===!0?1:0};return w.lastMsgId&&(L.lastMsgId=w.lastMsgId),{msg:M,threadMsgReq:L}}var V,F={"23_1":"getThreadMsgs","23_2":"getMsgsByIdServer"},A={msg:La,threadMsgReq:{beginTime:1,endTime:2,lastMsgId:3,limit:4,reverse:5},threadMsgsMeta:{total:1,lastMsgTime:2}},oe=rs(A),xe={getThreadMsgs:{sid:23,cid:1,service:"msgExtend",params:[{type:"Property",name:"msg",reflectMapper:A.msg},{type:"Property",name:"threadMsgReq",reflectMapper:A.threadMsgReq}],response:[{type:"Property",name:"threadMsg",reflectMapper:oe.msg},{type:"Property",name:"threadMsgsMeta",reflectMapper:oe.threadMsgsMeta},{type:"PropertyArray",name:"msgs",reflectMapper:oe.msg}]},getMsgsByIdServer:{sid:23,cid:2,service:"msgExtend",params:[{type:"PropertyArray",name:"reqMsgs",reflectMapper:A.msg}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:oe.msg}]}},z=function(w){function M($){var _;return _=w.call(this,"msgExtend",$)||this,qa({cmdMap:F,cmdConfig:xe}),_}Ro(M,w);var L=M.prototype;return L.getThreadMsgs=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr,ur,gr,yr,Cr;return ar.wrap(function(Fr){for(;;)switch(Fr.prev=Fr.next){case 0:return En({scene:{type:"enum",values:yi(Da)},threadMsgFromAccount:{type:"string",allowEmpty:!1},threadMsgIdServer:{type:"string",allowEmpty:!1},threadMsgTime:{type:"number"},threadMsgToAccount:{type:"string",allowEmpty:!1},beginTime:{type:"number",required:!1},endTime:{type:"number",required:!1},lastMsgId:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,max:100,required:!1},reverse:{type:"boolean",required:!1}},_),Fr.next=3,this.core.sendCmd("getThreadMsgs",x(_));case 3:return de=Fr.sent,At=de.content,tr=At.msgs,ur=At.threadMsg,gr=de.content.threadMsgsMeta,yr=Ti(ur,this.core.account),Cr=(re=this.core.session)===null||re===void 0?void 0:re.getSessionWithUncomplete({id:yr}),tr=_d(tr,Cr?{account:this.core.account,sessionAck:Cr.ack,msgReceiptTime:Cr.msgReceiptTime}:{account:this.core.account}),ur=Bi(ur,Cr?{account:this.core.account,sessionAck:Cr.ack,msgReceiptTime:Cr.msgReceiptTime}:{account:this.core.account}),Fr.abrupt("return",{msgs:tr,threadMsg:ur,total:ko(gr.total),timetag:ko(gr.lastMsgTime)});case 11:case"end":return Fr.stop()}},Oe,this)}))},L.getMsgsByIdServer=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de,At,tr,ur=this;return ar.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return En({reqMsgs:{type:"array",rules:{scene:{type:"enum",values:yi(Da)},from:{type:"string",allowEmpty:!1},to:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1},time:{type:"number"}},min:1,max:100}},_),yr.next=3,this.core.sendCmd("getMsgsByIdServer",{reqMsgs:To(Oe=_.reqMsgs).call(Oe,function(Cr){return Mr(Mr({},Cr),{scene:Oi(Da,Cr.scene)})})});case 3:return At=yr.sent,tr=To(de=At.content.msgs).call(de,function(Cr){var xr,Fr=Ti(Cr,ur.core.account),jr=(xr=ur.core.session)===null||xr===void 0?void 0:xr.getSessionWithUncomplete({id:Fr});return Bi(Cr,jr?{account:ur.core.account,sessionAck:jr.ack,msgReceiptTime:jr.msgReceiptTime}:{account:ur.core.account})}),yr.abrupt("return",tr);case 6:case"end":return yr.stop()}},re,this)}))},M}(os);(function(w){w[w.ASC=1]="ASC",w[w.DESC=2]="DESC"})(V||(V={}));var Ve,jt={"7_6":"getHistoryMsgs","7_9":"deleteRoamingMsgs","4_24":"syncClearServerHistoryMsgs","7_18":"clearHistoryMsgsFromServer","7_118":"multiSyncClearServerHistoryMsgs","7_26":"nimFtsCloudMsgLogsAggWithSession","7_27":"nimFtsCloudMsgLogs"},lr={msg:La,clearHistoryMsgsFromServerReqTag:{type:0,otherAccid:1,isDeleteRoam:2,toTid:3,isSyncSelf:4,ext:7},clearMsgsParamsWithSync:{type:0,otherAccid:1,isDeleteRoam:2,toTid:3,isSyncSelf:4,fromAccid:5,time:6,ext:7},ftsReqTag:{keyword:1,fromTime:2,toTime:3,sessionLimit:4,msglogsLimit:5,orderRule:6,p2pSessionList:7,teamSessionList:8,senderList:9,msgTypeList:10,msgSubTypeList:11}},fr=rs(lr),Sr={deleteRoamingMsgs:{sid:7,cid:9,service:"msgLog",params:[{type:"StrArray",name:"ids"}]},getHistoryMsgs:{sid:7,cid:6,params:[{type:"String",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:fr.msg}],service:"msgLog"},clearHistoryMsgsFromServer:{sid:7,cid:18,params:[{type:"Property",name:"clearHistoryMsgsFromServerReqTag",reflectMapper:lr.clearHistoryMsgsFromServerReqTag}],response:[{type:"Long",name:"timetag"}],service:"msgLog"},multiSyncClearServerHistoryMsgs:{sid:7,cid:118,response:[{type:"Property",name:"data",reflectMapper:fr.clearMsgsParamsWithSync}],service:"msgLog"},syncClearServerHistoryMsgs:{sid:4,cid:24,service:"msgLog",response:[{type:"PropertyArray",name:"datas",reflectMapper:fr.clearMsgsParamsWithSync}]},nimFtsCloudMsgLogsAggWithSession:{sid:7,cid:26,service:"msgLog",params:[{type:"Property",name:"tag",reflectMapper:lr.ftsReqTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:fr.msg}]},nimFtsCloudMsgLogs:{sid:7,cid:27,service:"msgLog",params:[{type:"Property",name:"tag",reflectMapper:lr.ftsReqTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:fr.msg}]}};(function(w){w[w.p2p=1]="p2p",w[w.team=2]="team"})(Ve||(Ve={}));var br={type:{type:"enum",values:Ve},isDeleteRoam:{type:"boolean"},isSyncSelf:{type:"boolean"},time:{type:"number"}};function Er(w){var M=Zs(br,w);return{sessionId:M.type==="p2p"?"p2p-"+M.otherAccid:"team-"+M.toTid,time:M.time}}var Dr={orderRule:{type:"enum",values:V}};function $r(w){var M,L=Zs(Dr,w);hi(L.msgTypeList)&&(L.msgTypeList=To(M=L.msgTypeList).call(M,function(_){return sc[_]}).join(","));var $=["p2pSessionList","teamSessionList","senderList","msgSubTypeList"];return In($).call($,function(_){hi(L[_])&&(L[_]=L[_].join(","))}),L}var vn=function(w){function M($){var _;return _=w.call(this,"msgLog",$)||this,qa({cmdMap:jt,cmdConfig:Sr}),_}Ro(M,w);var L=M.prototype;return L.deleteRoamingMsgs=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:En({ids:{type:"array",itemType:"string"}},_),Oe=[],tr.prev=2,Oe=To(de=_.ids).call(de,function(ur){var gr=Lo(ur);return gr.scene+"|"+gr.accid}),tr.next=10;break;case 6:throw tr.prev=6,tr.t0=tr.catch(2),this.logger.error("Failed to delete roaming msgs with "+_.ids,tr.t0),new Error("Failed to create session with "+_.ids);case 10:return tr.next=12,this.core.sendCmd("deleteRoamingMsgs",{ids:Oe});case 12:case"end":return tr.stop()}},re,this,[[2,6]])}))},L.getHistoryMsgs=function(_){var re,Oe;return Sn(this,void 0,void 0,ar.mark(function de(){var At,tr,ur,gr,yr,Cr,xr;return ar.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return!((re=this.core.sync)===null||re===void 0)&&re.getSyncDoneFlag()||this.logger.warn("Please call getHistoryMsgs after syncdone event"),En({scene:{type:"enum",values:Vo(mh)},to:{type:"string",allowEmpty:!1},beginTime:{type:"number",required:!1},endTime:{type:"number",required:!1},limit:{type:"number",min:1,max:100,required:!1},reverse:{type:"boolean",required:!1},lastMsgId:{type:"string",required:!1,allowEmpty:!1},asc:{type:"boolean",required:!1},msgTypes:{type:"array",itemType:"string",required:!1}},_),tr=_.scene==="p2p"?"getHistoryMsgs":_.scene==="team"?"getHistoryTeamMsgs":"getHistorySuperTeamMsgs",jr.next=5,this.core.sendCmd(tr,Mr(Mr({beginTime:0,endTime:0,lastMsgId:0,limit:100,reverse:!1},_),{msgTypes:_.msgTypes?To(At=_.msgTypes).call(At,function(zr){return fh[zr]}):[]}));case 5:if(ur=jr.sent,(gr=ur.content).msgs&&gr.msgs.length>0){jr.next=9;break}return jr.abrupt("return",[]);case 9:if(yr=Ti(gr.msgs[0],this.core.account),Cr=(Oe=this.core.session)===null||Oe===void 0?void 0:Oe.getSessionWithUncomplete({id:yr}),xr=_d(gr.msgs,Cr?{account:this.core.account,sessionAck:Cr.ack,msgReceiptTime:Cr.msgReceiptTime}:{account:this.core.account}),_.asc!==!0){jr.next=14;break}return jr.abrupt("return",wc(xr).call(xr,function(zr,Hr){return zr.time-Hr.time}));case 14:return jr.abrupt("return",xr);case 15:case"end":return jr.stop()}},de,this)}))},L.clearHistoryMsgsFromServer=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({scene:{type:"enum",values:["p2p","team"]},to:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1},isSyncSelf:{type:"boolean",required:!1}},_),(Oe=Mr(Mr({isDeleteRoam:1},_),{type:_.scene==="team"?2:1,isSyncSelf:_.isSyncSelf===!0?1:0}))[Oe.type===2?"toTid":"otherAccid"]=_.to,ur.next=5,this.core.sendCmd("clearHistoryMsgsFromServer",{clearHistoryMsgsFromServerReqTag:Oe});case 5:return de=ur.sent,At=de.content,this.core.eventBus.emit("session/updateForClearMsg",[{sessionId:_.scene+"-"+_.to}],!0),ur.abrupt("return",At);case 9:case"end":return ur.stop()}},re,this)}))},L.multiSyncClearServerHistoryMsgsHandler=function(_){var re=Er(_.content.data);this.core.eventBus.emit("session/updateForClearMsg",[re],!0),this.core.emit("clearServerHistoryMsgs",[re])},L.ftsCloudMsgLogs=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return de.abrupt("return",this.baseFtsCloudMsgLogs(_,"nimFtsCloudMsgLogs"));case 1:case"end":return de.stop()}},re,this)}))},L.ftsCloudMsgLogsAggWithSession=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return de.abrupt("return",this.baseFtsCloudMsgLogs(_,"nimFtsCloudMsgLogsAggWithSession"));case 1:case"end":return de.stop()}},re,this)}))},L.baseFtsCloudMsgLogs=function(_,re){return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr,ur=this;return ar.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:if(En({keyword:{type:"string",allowEmpty:!1},fromTime:{type:"number",required:!1},toTime:{type:"number",required:!1},sessionLimit:{type:"number",required:!1},msglogsLimit:{type:"number",required:!1},orderRule:{type:"enum",values:yi(V),required:!1},p2pSessionList:{type:"array",itemType:"string",required:!1},teamSessionList:{type:"array",itemType:"string",required:!1},senderList:{type:"array",itemType:"string",required:!1},msgTypeList:{type:"array",itemType:"enum",values:yi(sc),required:!1},msgSubTypeList:{type:"array",itemType:"number",required:!1}},_),!(_.fromTime&&_.toTime&&_.toTime<_.fromTime)){yr.next=3;break}throw new yo("Request parameter error: toTime should be greater than fromTime",_,"");case 3:return At=$r(_),yr.next=6,this.core.sendCmd(re,{tag:At});case 6:return tr=yr.sent,yr.abrupt("return",To(de=tr.content.datas).call(de,function(Cr){var xr,Fr=Ti(Cr,ur.core.account),jr=(xr=ur.core.session)===null||xr===void 0?void 0:xr.getSessionWithUncomplete({id:Fr});return Bi(Cr,jr?{account:ur.core.account,sessionAck:jr.ack,msgReceiptTime:jr.msgReceiptTime}:{account:ur.core.account})}));case 8:case"end":return yr.stop()}},Oe,this)}))},L.syncClearServerHistoryMsgsHandler=function(_){var re=function(de){return hi(de)&&de.length>0?To(de).call(de,function(At){return Er(At)}):[]}(_.content.datas);this.core.emit("clearServerHistoryMsgs",re)},M}(os),Yr={"22_1":"requestProxy","22_2":"onRequestProxy"},wn={requestProxyTag:{zone:1,path:2,method:3,header:4,body:5},requestProxyMsgTag:{from:1,body:2,time:3}},Zr=rs(wn),Qn={requestProxy:{sid:22,cid:1,service:"passThrough",params:[{type:"Property",name:"requestProxyTag",reflectMapper:wn.requestProxyTag}],response:[{type:"Property",name:"requestProxyTag",reflectMapper:Zr.requestProxyTag}]},onRequestProxy:{sid:22,cid:2,service:"passThrough",response:[{type:"Property",name:"proxyMsg",reflectMapper:Zr.requestProxyMsgTag}]}},Dn=function(w){function M($){var _;return(_=w.call(this,"passThrough",$)||this).core=$,qa({cmdMap:Yr,cmdConfig:Qn}),_}Ro(M,w);var L=M.prototype;return L.request=function(_){return En({path:{type:"string",allowEmpty:!1}},_),this.core.sendCmd("requestProxy",{requestProxyTag:_}).then(function(re){return re.content.proxyTag})},L.onRequestProxyHandler=function(_){var re=_.content.proxyMsg;re&&re.time&&(re.time=+re.time),this.core.emit("proxyMsg",re)},M}(os),jo=bs.some,jn=Us("some");Vr({target:"Array",proto:!0,forced:!jn},{some:function(M){return jo(this,M,arguments.length>1?arguments[1]:void 0)}});var wr=Uo("Array").some,xn=Array.prototype,Nn=function(w){var M=w.some;return w===xn||rr(xn,w)&&M===xn.some?wr:M},Mn,Xr,On=function(M,L){if(M==null)return{};var $=Og(jy(M),function(_){return[_]});return L=Xl(L),xy(M,$,function(_,re){return L(_,re[0])})},Un={"6_2":"getNosToken","6_22":"getOriginUrl","6_26":"getNosCdnHost","6_27":"getGrayscaleConfig","6_28":"getMixStorePolicy","6_29":"getMixStoreToken","6_30":"getFileAuthToken"},eo={nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},mixStoreTokenReqTag:{provider:0,tokenCount:1,fileExpireSec:2,tag:3,returnBody:4},nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4},grayConfigTag:{config:0,ttl:1},mixStorePolicyTag:{providers:0,ttl:1,mixEnable:2,nosPolicy:3,s3Policy:4},mixStoreTokenResTag:{provider:0,accessKeyId:1,secretAccessKey:2,sessionToken:3,token:4,expireTime:5,bucket:6,objectName:7,fileExpireSec:8,tag:9,shortUrl:10,region:11},nosSafeUrlTag:{safeUrl:0,originUrl:1},mixStoreAuthTokenReqTag:{type:1,urls:2},mixStoreAuthTokenResTag:{type:1,tokens:2,token:3,ttl:4}},ro=rs(eo),Do={getNosToken:{sid:6,cid:2,service:"cloudStorage",response:[{type:"Property",name:"nosToken",reflectMapper:ro.nosToken}],params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken",reflectMapper:eo.nosToken}]},getOriginUrl:{sid:6,cid:22,service:"cloudStorage",response:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:ro.nosSafeUrlTag}],params:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:eo.nosSafeUrlTag}]},getNosCdnHost:{sid:6,cid:26,service:"misc",response:[{type:"Property",name:"nosConfigTag",reflectMapper:ro.nosConfigTag}]},getGrayscaleConfig:{sid:6,cid:27,service:"cloudStorage",response:[{type:"Property",name:"grayConfigTag",reflectMapper:ro.grayConfigTag}],params:[{type:"Property",name:"config"}]},getMixStorePolicy:{sid:6,cid:28,service:"cloudStorage",params:[{type:"LongArray",name:"supportType"}],response:[{type:"Property",name:"mixStorePolicyTag",reflectMapper:ro.mixStorePolicyTag}]},getMixStoreToken:{sid:6,cid:29,service:"cloudStorage",params:[{type:"Property",name:"mixStoreTokenReqTag",reflectMapper:eo.mixStoreTokenReqTag}],response:[{type:"Property",name:"mixStoreTokenResTag",reflectMapper:ro.mixStoreTokenResTag}]},getFileAuthToken:{sid:6,cid:30,service:"cloudStorage",params:[{type:"Property",name:"mixStoreAuthTokenReqTag",reflectMapper:eo.mixStoreAuthTokenReqTag}],response:[{type:"Property",name:"mixStoreAuthTokenResTag",reflectMapper:ro.mixStoreAuthTokenResTag}]}};(function(w){w[w.nos=1]="nos",w[w.s3=2]="s3"})(Mn||(Mn={})),function(w){w[w.dontNeed=-1]="dontNeed",w[w.time=2]="time",w[w.urls=3]="urls"}(Xr||(Xr={}));var go,Zo,So={chunkUploadHost:"https://wanproxy-web.127.net",commonUploadHost:"https://nos.netease.com",chunkMaxSize:4194304e4,commonMaxSize:104857600,uploadReplaceFormat:"https://{host}/{object}",cdn:{defaultCdnDomain:"nim.nosdn.127.net",cdnDomain:"",bucket:"",objectNamePrefix:""},downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHostList:["nos.netease.com"],nosCdnEnable:!0,isNeedToGetUploadPolicyFromServer:!0},Io={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},ea={accessKeyId:"",secretAccessKey:"",sessionToken:"",region:"",maxRetries:0,bucket:"",objectName:"",token:"",shortUrl:""};function Mi(w){return w===void 0&&(w="file"),Wo(Io[w]||{}).replace(/"/gi,'\\"')}(function(w){w[w.nos=1]="nos",w[w.s3=2]="s3"})(go||(go={})),function(w){w[w.dontNeed=-1]="dontNeed",w[w.time=2]="time",w[w.urls=3]="urls"}(Zo||(Zo={}));var Eo=function(){function w(L,$){$===void 0&&($={}),this.GRAYKEY="AllGrayscaleConfig",this.MIXSTOREKEY="AllMixStorePolicy",this.config={},this.nosCdnHostTimer=0,this.grayConfig={mixStoreEnable:!1,timeStamp:0,ttl:0},this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=go.nos,this.s3=null,this.mixStoreErrorCount=10,this.nosErrorCount=0,this.circuitTimer=0,this.name="cloudStorage",this.logger=L.logger,this.core=L,qa({cmdMap:Un,cmdConfig:Do}),this.setOptions($)}var M=w.prototype;return M.setOptions=function($){$===void 0&&($={});var _=$.storageKeyPrefix||"NIMClient";this.GRAYKEY=_+"-AllGrayscaleConfig",this.MIXSTOREKEY=_+"-AllMixStorePolicy";var re=$.s3,Oe=Ps($,["s3"]),de=Mr({},So,this.config);if(Oe&&Object.prototype.hasOwnProperty.call(Oe,"cdn")){var At={cdn:Mr(Mr({},de.cdn),Oe.cdn)};this.config=Mr({},de,Oe,At)}else this.config=Mr({},de,Oe);re&&(this.s3=re)},M.init=function(){return Sn(this,void 0,void 0,ar.mark(function $(){return ar.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(this.grayConfig=null,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=go.nos,this.mixStoreErrorCount=10,!this.config.isNeedToGetUploadPolicyFromServer){re.next=9;break}return re.next=7,this.getGrayscaleConfig(this.core.options.appkey);case 7:return re.next=9,this.getNosCdnHost();case 9:case"end":return re.stop()}},$,this)}))},M.uploadFile=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var re,Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:if(En({maxSize:{type:"number",required:!1},type:{type:"enum",values:["file","image","audio","video"]}},$),$.fileInput||$.file||$.filePath){tr.next=3;break}throw new Error("uploadFile needs target file object or a filePath");case 3:if(!$.type||$.type==="file"){tr.next=7;break}if(typeof(re=Os($,"file.type"))!="string"||Ma(re).call(re,$.type)!==-1){tr.next=7;break}throw new Error('The meta type "'+re+'" does not match "'+$.type+'"');case 7:if(this.grayConfig&&this.grayConfig.mixStoreEnable&&this.mixStorePolicy.providers.length){tr.next=10;break}return this.logger.log("uploadFile:: uploadFile begin, use old nos"),tr.abrupt("return",this.nosUpload($));case 10:return this.logger.log("uploadFile:: uploadFile begin,Current settings grayConfig mixStoreEnable:"+this.grayConfig.mixStoreEnable+" curProvider:"+this.curProvider),this.s3||(this.curProvider=go.nos),Oe=ea,tr.prev=13,tr.next=16,this.core.sendCmd("getMixStoreToken",{mixStoreTokenReqTag:{provider:this.curProvider,tokenCount:1,tag:"qchat",returnBody:Mi($.type)}});case 16:de=tr.sent,Oe=de.content.mixStoreTokenResTag,tr.next=24;break;case 20:throw tr.prev=20,tr.t0=tr.catch(13),this.core.logger.error("uploadFile:: getMixStoreToken error",tr.t0),new El("getMixStoreToken error",tr.t0,this.curProvider,this.mixStorePolicy);case 24:return tr.abrupt("return",this.curProvider===go.s3?this.s3Upload($,Oe):this.nosUpload($,Oe));case 25:case"end":return tr.stop()}},_,this,[[13,20]])}))},M.nosUpload=function($,_){var re,Oe;return Sn(this,void 0,void 0,ar.mark(function de(){var At,tr,ur,gr,yr,Cr,xr,Fr,jr,zr,Hr,Kr,kn;return ar.wrap(function(Hn){for(;;)switch(Hn.prev=Hn.next){case 0:if(At=Os(this.core,"config.cdn.bucket"),tr={tag:$.nosScenes||At||"nim",expireSec:$.nosSurvivalTime},_){Hn.next=13;break}return Hn.prev=3,Hn.next=6,this.core.sendCmd("getNosToken",{responseBody:Mi($.type),nosToken:tr});case 6:ur=Hn.sent,Hn.next=13;break;case 9:throw Hn.prev=9,Hn.t0=Hn.catch(3),this.core.logger.error("uploadFile:: getNosToken error",Hn.t0),new El("getNosToken error",Hn.t0,1);case 13:return Hn.prev=13,yr=ur?ur.content.nosToken:_,this.core.logger.debug("uploadFile:: uploadFile params",{nosToken:yr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,platform:Ho.platform}),Hn.next=18,this.core.adapters.uploadFile(Mr(Mr({},$),{nosToken:yr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,maxSize:$.maxSize||this.config.chunkMaxSize}));case 18:gr=Hn.sent,Hn.next=42;break;case 21:if(Hn.prev=21,Hn.t1=Hn.catch(13),this.core.logger.error("uploadFile::nos uploadFile error",Hn.t1),!_){Hn.next=41;break}if(this.nosErrorCount!==0){Hn.next=37;break}Hn.prev=26,this._addCircuitTimer(),Hn.next=33;break;case 30:throw Hn.prev=30,Hn.t2=Hn.catch(26),new El("upload file error",Hn.t2,this.curProvider,this.mixStorePolicy,$.file||$.filePath);case 33:return this.nosErrorCount=(re=this.mixStorePolicy.nosPolicy)===null||re===void 0?void 0:re.uploadConfig.retryPolicy.retry,Hn.abrupt("return",this.uploadFile($));case 37:return this.nosErrorCount--,Hn.abrupt("return",this.nosUpload($,_));case 39:Hn.next=42;break;case 41:throw new El("nos uploadFile error",Hn.t1,1);case 42:if(Cr=gr==null?void 0:gr.type,xr=Cr&&Ma(Cr).call(Cr,"/")>-1?Co(Cr).call(Cr,0,Ma(Cr).call(Cr,"/")):"",Fr={image:"imageInfo",video:"vinfo",audio:"vinfo"},jr=this.config.uploadReplaceFormat.replace("{host}",this.config.cdn.cdnDomain||this.config.cdn.defaultCdnDomain).replace("{object}",ur?ur.content.nosToken.objectName:_==null?void 0:_.objectName),_&&_.shortUrl&&(jr=_.shortUrl),Fr[xr]){Hn.next=49;break}return Hn.abrupt("return",Mr({url:jr},gr));case 49:if(Hn.prev=49,!(Ma(jr).call(jr,"_im_url=1")<0)){Hn.next=54;break}return Hn.next=53,this.core.adapters.request(jr+"?"+Fr[xr],{method:"GET",dataType:"json",timeout:5e3});case 53:zr=Hn.sent;case 54:Hn.next=60;break;case 56:return Hn.prev=56,Hn.t3=Hn.catch(49),this.core.logger.error("uploadFile:: fetch file info error",Hn.t3),Hn.abrupt("return",Mr({url:jr},gr));case 60:if(!zr){Hn.next=67;break}return Hr=zr.data,Kr=Fr[xr]==="imageInfo"?Hr:(Oe=Hr==null?void 0:Hr.GetVideoInfo)===null||Oe===void 0?void 0:Oe.VideoInfo,kn={url:jr,name:gr.name,size:gr.size,ext:gr.ext,w:Kr.Width,h:Kr.Height,orientation:Kr.Orientation,dur:Kr.Duration,audioCodec:Kr.AudioCodec,videoCodec:Kr.VideoCodec,container:Kr.Container},Hn.abrupt("return",On(kn,function(xo,Ln){return Ln!==void 0}));case 67:return Hn.abrupt("return",Mr({url:jr},gr));case 68:case"end":return Hn.stop()}},de,this,[[3,9],[13,21],[26,30],[49,56]])}))},M.getNosCdnHost=function(){var $;return Sn(this,void 0,void 0,ar.mark(function _(){var re,Oe,de,At=this;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return ur.prev=0,ur.next=3,this.core.sendCmd("getNosCdnHost");case 3:re=ur.sent,ur.next=10;break;case 6:return ur.prev=6,ur.t0=ur.catch(0),this.logger.error("getNosCdnHost::error",ur.t0),ur.abrupt("return");case 10:if(re){ur.next=12;break}return ur.abrupt("return");case 12:Oe=($=re==null?void 0:re.content)===null||$===void 0?void 0:$.nosConfigTag,(de=ko(Oe==null?void 0:Oe.expire))!==0&&Oe.cdnDomain?de===-1?(this.config.cdn.bucket=Oe.bucket,this.config.cdn.cdnDomain=Oe.cdnDomain,this.config.cdn.objectNamePrefix=Oe.objectNamePrefix):(this.config.cdn.bucket=Oe.bucket,this.config.cdn.cdnDomain=Oe.cdnDomain,this.config.cdn.objectNamePrefix=Oe.objectNamePrefix,this.nosCdnHostTimer=this.core.timerManager.addTimer(function(){At.getNosCdnHost()},1e3*de)):(this.config.cdn.bucket="",this.config.cdn.cdnDomain="",this.config.cdn.objectNamePrefix="");case 15:case"end":return ur.stop()}},_,this,[[0,6]])}))},M.getGrayscaleConfig=function($){var _;return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:if(Ho.localStorage)try{Ho.localStorage.getItem&&Ho.localStorage.getItem(this.GRAYKEY)&&(this.grayConfig=JSON.parse(Ho.localStorage.getItem(this.GRAYKEY))[$])}catch(ur){Ho.localStorage.getItem(this.GRAYKEY)&&this.core.logger.error("uploadFile:: JSON.parse grayscaleConfig error ",ur)}if(this.grayConfig&&!(this.grayConfig.timeStamp+1e3*this.grayConfig.ttl<new Date().getTime())){tr.next=17;break}return tr.next=4,this.core.sendCmd("getGrayscaleConfig",{config:{}});case 4:if(!(Oe=tr.sent).content||!Oe.content.grayConfigTag){tr.next=16;break}this.logger.log("uploadFile::getAppGrayConfigRequest success ");try{this.grayConfig=JSON.parse(Oe.content.grayConfigTag.config),this.grayConfig.ttl=JSON.parse(Oe.content.grayConfigTag.ttl)}catch(ur){this.logger.error("getGrayscaleConfig error",ur)}if(this.grayConfig){tr.next=10;break}return tr.abrupt("return");case 10:de=Ho.localStorage.getItem(this.GRAYKEY)?JSON.parse(Ho.localStorage.getItem(this.GRAYKEY)):{},this.grayConfig.timeStamp=new Date().getTime(),de[$]=this.grayConfig,Ho.localStorage.setItem(this.GRAYKEY,Wo(de)),tr.next=17;break;case 16:this.logger.debug("uploadFile:: result grayConfig:",Oe.content);case 17:if(!(!((_=this.grayConfig)===null||_===void 0)&&_.mixStoreEnable)){tr.next=20;break}return tr.next=20,this._getMixStorePolicy($);case 20:case"end":return tr.stop()}},re,this)}))},M._getMixStorePolicy=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var re,Oe,de,At,tr,ur,gr;return ar.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:if(re=new Date().getTime(),Ho.localStorage)try{this.mixStorePolicy=JSON.parse(Ho.localStorage.getItem(this.MIXSTOREKEY))[$],this.curProvider=ko(this.mixStorePolicy.providers[0]),this.mixStorePolicy.timeStamp&&this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl>re&&(de=this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl-re,this.core.timerManager.addTimer(Oo(Oe=this._getMixStorePolicy).call(Oe,this,$),de))}catch(xr){Ho.localStorage.getItem(this.MIXSTOREKEY)&&JSON.parse(Ho.localStorage.getItem(this.MIXSTOREKEY))[$]&&this.core.logger.error("uploadFile:: JSON.parse mixStorePolicy error ",xr)}if(this.mixStorePolicy&&!(this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl<=re)){Cr.next=30;break}return Cr.prev=3,Cr.next=6,this.core.sendCmd("getMixStorePolicy",{supportType:this.s3?[1,2]:[1]});case 6:tr=Cr.sent,ur=tr.content.mixStorePolicyTag,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.mixStorePolicy.ttl=Number(ur.ttl),this.mixStorePolicy.providers=ur.providers.split(","),this.circuitTimer&&this.core.timerManager.deleteTimer(this.circuitTimer),this.curProvider=ko(this.mixStorePolicy.providers[0]),this.mixStorePolicy.nosPolicy=ur.nosPolicy?JSON.parse(ur.nosPolicy):null,this.mixStorePolicy.s3Policy=ur.s3Policy?JSON.parse(ur.s3Policy):null,this.mixStorePolicy.s3Policy===null?this.mixStorePolicy.providers=["1"]:this.mixStorePolicy.nosPolicy===null?this.mixStorePolicy.providers=["2"]:this.mixStorePolicy.providers=this.mixStorePolicy.s3Policy.priority<this.mixStorePolicy.nosPolicy.priority?["2","1"]:["1","2"],this.core.timerManager.addTimer(Oo(At=this._getMixStorePolicy).call(At,this,$),1e3*this.mixStorePolicy.ttl),gr=Ho.localStorage.getItem(this.MIXSTOREKEY)?JSON.parse(Ho.localStorage.getItem(this.MIXSTOREKEY)):{},this.mixStorePolicy.timeStamp=new Date().getTime(),gr[$]=this.mixStorePolicy,Ho.localStorage.setItem(this.MIXSTOREKEY,Wo(gr)),Cr.next=30;break;case 23:if(Cr.prev=23,Cr.t0=Cr.catch(3),this.logger.error("getMixStorePolicy error",Cr.t0),this.mixStoreErrorCount!==0){Cr.next=28;break}throw new Error("getMixStorePolicy all count error");case 28:this._getMixStorePolicy($),this.mixStoreErrorCount--;case 30:this.mixStorePolicy.nosPolicy&&(this.nosErrorCount=this.mixStorePolicy.nosPolicy.uploadConfig.retryPolicy.retry);case 31:case"end":return Cr.stop()}},_,this,[[3,23]])}))},M.s3Upload=function($,_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de,At,tr,ur,gr,yr,Cr,xr,Fr,jr=this;return ar.wrap(function(Hr){for(;;)switch(Hr.prev=Hr.next){case 0:if(!$.file){Hr.next=4;break}Oe=$.file,Hr.next=19;break;case 4:if(typeof $.fileInput!="string"){Hr.next=14;break}if(this.logger.warn("fileInput will abandon,Please use file or filepath"),!((de=document.getElementById($.fileInput))&&de.files&&de.files[0])){Hr.next=11;break}Oe=de.files[0],Hr.next=12;break;case 11:throw new Error("Can not get file from fileInput");case 12:Hr.next=19;break;case 14:if(!($.fileInput&&$.fileInput.files&&$.fileInput.files[0])){Hr.next=18;break}Oe=$.fileInput.files[0],Hr.next=19;break;case 18:throw new Error("Can not get file from fileInput "+$.fileInput);case 19:if(this.mixStorePolicy.s3Policy){Hr.next=21;break}throw new Error("dont get s3 policy");case 21:return At={accessKeyId:_.accessKeyId,secretAccessKey:_.secretAccessKey,sessionToken:_.sessionToken,region:_.region,maxRetries:this.mixStorePolicy.s3Policy.uploadConfig.retryPolicy.retry},tr=this.s3,(ur=new tr).config.update(At),gr=decodeURIComponent(_.bucket),yr=decodeURIComponent(_.objectName),xr={Bucket:gr,Key:yr,Body:Cr=Oe,Metadata:{token:_.token},ContentType:Cr.type||"application/octet-stream"},this.core.logger.debug("uploadFile:: s3 upload params:",xr),Fr=ur.upload(xr),Hr.abrupt("return",new uo(function(Kr){var kn=new Date().getTime();Fr.send(function(Yn,Hn){var xo,Ln;if(Yn){jr.logger.error("uploadFile:","api::s3:upload file failed",Yn),jr.core.reporter.reportTraceStart("exceptions",{user_id:jr.core.options.account,trace_id:(Ln=(xo=jr.core)===null||xo===void 0?void 0:xo.socket)===null||Ln===void 0?void 0:Ln.sessionId,start_time:kn,action:1}),jr.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof Yn.status=="number"?Yn.status:typeof Yn.code=="number"?Yn.code:0,description:Yn.message||""+Yn.code,operation_type:1,target:Yn.hostname}),jr.core.reporter.reportTraceEnd("exceptions",1);try{jr._addCircuitTimer()}catch(Pn){throw new El("upload file error",Pn,jr.curProvider,jr.mixStorePolicy,$.file||$.filePath)}Kr(jr.uploadFile($))}else{var _r=jr.mixStorePolicy.s3Policy.cdnSchema;_r=(_r=_r.replace("{cdnDomain}",jr.mixStorePolicy.s3Policy.dlcdn)).replace("{objectName}",Hn.Key),Kr({size:Cr.size,name:Cr.name,url:_.shortUrl?_.shortUrl:_r,ext:Cr.name.split(".")[1]||"unknown"})}})}));case 32:case"end":return Hr.stop()}},re,this)}))},M.getPrivateUrl=function($){var _;if(!new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?/).test($))return this.logger.error("illegal file url:"+$),"";var re=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/.exec($);re[0];var Oe=re[1];re[2];var de=re[3];re[4];var At=re[5];if(re[6],re[7],(_=this.grayConfig)===null||_===void 0?void 0:_.mixStoreEnable){var tr=this._getUrlType($);return tr===go.s3&&this.mixStorePolicy.s3Policy&&($=this.mixStorePolicy.s3Policy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.s3Policy.dlcdn).replace("{objectName}",At)),tr===go.nos&&this.mixStorePolicy.nosPolicy&&($=this.mixStorePolicy.nosPolicy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.nosPolicy.dlcdn).replace("{objectName}",At)),$}var ur=this.config,gr=ur.downloadUrl,yr=ur.downloadHostList,Cr=ur.nosCdnEnable,xr=this.config.cdn.cdnDomain,Fr=this.config.cdn.objectNamePrefix?decodeURIComponent(this.config.cdn.objectNamePrefix):"",jr=decodeURIComponent(At),zr=Ma(jr).call(jr,Fr);if(xr&&zr>-1&&Cr)return""+Oe+xr+"/"+Co(jr).call(jr,zr);if(bc(yr).call(yr,de)&&bc(At).call(At,"/")){var Hr=Ma(At).call(At,"/"),Kr=At.substring(0,Hr),kn=At.substring(Hr+1);return gr.replace("{bucket}",Kr).replace("{object}",kn)}var Yn=ls(yr).call(yr,function(xo){return typeof de=="string"&&bc(de).call(de,xo)})[0],Hn=Yn?de.replace(Yn,"").replace(/\W/g,""):null;return Hn?gr.replace("{bucket}",Hn).replace("{object}",At):$},M.getOriginUrl=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var re;return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return de.next=2,this.core.sendCmd("getOriginUrl",{nosSafeUrlTag:{safeUrl:$}});case 2:return re=de.sent,de.abrupt("return",re.content.nosSafeUrlTag.originUrl);case 4:case"end":return de.stop()}},_,this)}))},M.getFileToken=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var re,Oe,de,At,tr,ur=this;return ar.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:if(En({type:{type:"number",min:2,max:3},urls:{type:"array",required:!1,itemType:"string"}},$),re=this.mixStorePolicy.nosPolicy?this.mixStorePolicy.nosPolicy.authPolicy.policyType:null,Oe=this.mixStorePolicy.s3Policy?this.mixStorePolicy.s3Policy.authPolicy.policyType:null,re!==String(Zo.dontNeed)||Oe!==String(Zo.dontNeed)){yr.next=8;break}throw this.logger.error("don't need token"),new Error("don't need token");case 8:if($.type!==Zo.time){yr.next=17;break}if(!(re&&Ma(re).call(re,String(Zo.time))>=0||Oe&&Ma(Oe).call(Oe,String(Zo.time))>0)){yr.next=13;break}return yr.abrupt("return",this.getFileAuthToken($));case 13:throw this.logger.error("don't support time token "),new Error("don't support type time token ");case 15:yr.next=33;break;case 17:if($.urls&&$.urls.length){yr.next=20;break}throw this.logger.error("urls is required when urls token"),new Error("urls is required when urls token");case 20:if(At=[],tr=[],In(de=$.urls).call(de,function(Cr){var xr=ur._getUrlType(Cr);xr===go.nos&&tr.push(Cr),xr===go.s3&&At.push(Cr)}),(!Oe||At.length!==0&&Ma(Oe).call(Oe,String(Zo.urls))<0)&&(this.logger.warn("s3 url don't support url token"),At=[]),(!re||tr.length!==0&&Ma(re).call(re,String(Zo.urls))<0)&&(this.logger.warn("nos url don't support url token"),tr=[]),At.length!==0||tr.length!==0){yr.next=30;break}throw this.logger.error("not support urls"),new Error("not support urls");case 30:if(At.length!==0&&tr.length!==0){yr.next=33;break}return $.urls=Wo($.urls),yr.abrupt("return",this.getFileAuthToken($));case 33:case"end":return yr.stop()}},_,this)}))},M.getFileAuthToken=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var re;return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return de.next=2,this.core.sendCmd("getFileAuthToken",{mixStoreAuthTokenReqTag:$});case 2:return re=de.sent,de.abrupt("return",re.content.mixStoreAuthTokenResTag);case 4:case"end":return de.stop()}},_,this)}))},M._getUrlType=function($){var _,re;return this.mixStorePolicy.nosPolicy&&Nn(_=this.mixStorePolicy.nosPolicy.dlcdns).call(_,function(Oe){return Ma($).call($,Oe)>=0})?go.nos:this.mixStorePolicy.s3Policy&&Nn(re=this.mixStorePolicy.s3Policy.dlcdns).call(re,function(Oe){return Ma($).call($,Oe)>=0})?go.s3:null},M._addCircuitTimer=function(){var $=this,_=this.mixStorePolicy.providers,re=_[(Ma(_).call(_,String(this.curProvider))+1)%_.length];if(re===_[0])throw new Error("uploadFile all policy fail");var Oe=Os(this.mixStorePolicy,"s3Policy.uploadConfig.retryPolicy");if(Oe&&Oe.retryNext&&re&&(this.logger.log("uploadFile:: upload policy will change,now policy:"+this.curProvider+" nextProvider:"+re),this.curProvider=ko(re),this.mixStorePolicy.nosPolicy&&this.mixStorePolicy.s3Policy)){var de=this.mixStorePolicy[this.curProvider===go.nos?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!de||de===0)return;this.circuitTimer=this.core.timerManager.addTimer(function(){$.logger.log("uploadFile:: upload policy will change,now policy:"+$.curProvider+" nextProvider:"+ko($.mixStorePolicy.providers[0])),$.curProvider=ko($.mixStorePolicy.providers[0]),$.core.timerManager.deleteTimer($.circuitTimer)},1e3*de)}},M.process=function($){var _=this[$.cmd+"Handler"];return typeof _=="function"?_.call(this,$):$.error&&!$.error.ignore?uo.reject($.error):uo.resolve($)},w}(),ki=Ga({none:0,normal:1,all:3}),$a=Ga({normal:0,advanced:1}),po=Ga({normal:0,owner:1,manager:2}),Go={noVerify:0,needVerify:1,rejectAll:2},zn=Ga(Go),Bo={needVerify:0,noVerify:1},Qa=Ga(Bo),Jn={manager:0,all:1},Qy=Ga(Jn),qh={manager:0,all:1},xs=Ga(qh),Is={manager:0,all:1},ka=Ga(Is);function Qo(w){var M,L=["teamId"],$=["level","memberNum","memberUpdateTime","createTime","updateTime"],_=["valid","validToCurrentUser","mute"],re={type:$a,muteType:ki,joinMode:zn,beInviteMode:Qa,inviteMode:Qy,updateTeamMode:xs,updateExtMode:ka};w.bits;var Oe=Ps(w,["bits"]);return In(L).call(L,function(de){Oe[de]&&(Oe[de]=Oe[de].toString())}),In($).call($,function(de){Oe[de]!==void 0&&(Oe[de]=ko(Oe[de]))}),In(_).call(_,function(de){Oe[de]!==void 0&&(Oe[de]=ko(Oe[de])===1)}),In(M=Vo(re)).call(M,function(de){Oe[de]!==void 0&&(Oe[de]=re[de][Oe[de]]||Oe[de])}),Oe}function ma(w){return w&&w.length>0?To(w).call(w,function(M){return Qo(M)}):[]}function Kd(w){var M,L=Mr({},w),$=["avatar","name","intro","announcement","ext"],_={joinMode:Go,beInviteMode:Bo,inviteMode:Jn,updateTeamMode:qh,updateExtMode:Is};return In($).call($,function(re){L[re]!==void 0&&(L[re]=L[re].toString())}),In(M=Vo(_)).call(M,function(re){L[re]!==void 0&&(L[re]=_[re][L[re]])}),L}function kC(w){var M=["teamId","ext","account","nickInTeam"],L={};return w.bitConfigMask!==void 0&&(L.bits=ko(w.bitConfigMask)),In(M).call(M,function($){w[$]&&(L[$]=w[$].toString())}),L}function Ws(w){var M,L=["teamId"],$=["joinTime","updateTime","bitConfigMask"],_=["active","valid","mute"],re={type:po},Oe=w.bits,de=Ps(w,["bits"]);return Oe!==void 0&&(de.muteTeam=ko(Oe)===1,de.bitConfigMask=Oe),de.id=de.teamId+"-"+de.account,In(L).call(L,function(At){de[At]&&(de[At]=de[At].toString())}),In($).call($,function(At){de[At]!==void 0&&(de[At]=ko(de[At]))}),In(_).call(_,function(At){de[At]!==void 0&&(de[At]=ko(de[At])===1)}),In(M=Vo(re)).call(M,function(At){de[At]!==void 0&&(de[At]=re[At][de[At]]||de[At])}),de}function Wd(w){return w&&w.length>0?To(w).call(w,function(M){return Ws(M)}):[]}function of(w,M,L){return L===void 0&&(L="normal"),{id:w.teamId+"-"+M,teamId:w.teamId,account:M,type:L,nickInTeam:"",muteTeam:!1,mute:!1,joinTime:w.memberUpdateTime,updateTime:w.memberUpdateTime,active:!0,valid:!0}}function Vh(w,M,L){return L===void 0&&(L="normal"),M&&M.length>0?To(M).call(M,function($){return of(w,$,L)}):[]}var NC=function(){function w(L){this.core=L}var M=w.prototype;return M.notifyAddSuperTeamMembers=function($,_){this.core.emit("addSuperTeamMembers",{team:$,accounts:_,members:Vh($,_)})},M.notifyUpdateSuperTeamManagers=function($,_,re,Oe){this.core.emit("updateSuperTeamManagers",{team:{teamId:$,memberUpdateTime:Oe},accounts:_,isManager:re,members:To(_).call(_,function(de){return{id:$+"-"+de,type:"manager",account:de,updateTime:Oe}})})},M.notifyRemoveSuperTeamMembers=function($,_){this.core.emit("removeSuperTeamMembers",{team:$,accounts:_})},M.notifyTransferSuperTeam=function($,_,re){this.core.emit("transferSuperTeam",{team:$,from:{id:$.teamId+"-"+_,account:_,type:"normal",updateTime:$.memberUpdateTime},to:{id:$.teamId+"-"+re,account:re,type:"owner",updateTime:$.memberUpdateTime}})},M.notifyUpdateSuperTeamMembersMute=function($,_,re){this.core.emit("updateSuperTeamMembersMute",{team:$,accounts:_,members:To(_).call(_,function(Oe){return{id:$.teamId+"-"+Oe,account:Oe,teamId:$.teamId,mute:re,updateTime:$.memberUpdateTime}}),mute:re})},w}(),RC={"21_5":"addSuperTeamMembers","21_6":"removeSuperTeamMembers","21_7":"leaveSuperTeam","21_8":"updateSuperTeamInfo","21_9":"getSuperTeamInfo","21_12":"getSuperTeams","21_15":"getSuperTeamMembers","21_10":"updateMySuperTeamMemberInfo","21_20":"applySuperTeam","21_21":"passSuperTeamApply","21_22":"rejectSuperTeamApply","21_23":"acceptSuperTeamInvite","21_24":"rejectSuperTeamInvite","21_26":"addSuperTeamManagers","21_27":"removeSuperTeamManagers","21_28":"muteSuperTeam","21_29":"muteSuperTeamMembers","21_30":"updateSuperTeamMemberNick","21_31":"transferSuperTeam","21_33":"getSuperTeamMembersByAccounts","21_34":"queryMuteSuperTeamMembers","21_101":"syncCreateSuperTeam","21_109":"syncSuperTeams","21_110":"syncUpdateSuperTeamMember","21_111":"syncMySuperTeamMembers"},Jy={superTeam:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,ext:18,serverExt:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateExtMode:24,mute:100,muteType:101},superTeamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,updateTime:11,ext:12,mute:13,invitorAccid:14,joinTime:15}},Bc=rs(Jy),BC={getSuperTeamInfo:{sid:21,cid:9,service:"superTeam",params:[{type:"Long",name:"teamId"}],response:[{type:"Property",name:"superTeam",reflectMapper:Bc.superTeam}]},getSuperTeams:{sid:21,cid:12,service:"superTeam",params:[{type:"long",name:"timetag"}],response:[{type:"PropertyArray",name:"superTeams",reflectMapper:Bc.superTeam},{type:"Number",name:"timetag"}]},updateSuperTeamInfo:{sid:21,cid:8,service:"superTeam",params:[{type:"Property",name:"superTeam",reflectMapper:Jy.superTeam}],response:[{type:"Number",name:"time"}]},addSuperTeamMembers:{sid:21,cid:5,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}],response:[{type:"StrArray",name:"abortedAccidList"},{type:"Long",name:"time"}]},removeSuperTeamMembers:{sid:21,cid:6,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},addSuperTeamManagers:{sid:21,cid:26,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeSuperTeamManagers:{sid:21,cid:27,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},applySuperTeam:{sid:21,cid:20,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"ps"}],response:[{type:"Property",name:"superTeam",reflectMapper:Bc.superTeam}]},transferSuperTeam:{sid:21,cid:31,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},muteSuperTeam:{sid:21,cid:28,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"Int",name:"mute"}]},muteSuperTeamMembers:{sid:21,cid:29,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"Int",name:"mute"}]},updateSuperTeamMemberNick:{sid:21,cid:30,service:"superTeam",params:[{type:"Property",name:"teamMember",reflectMapper:Jy.superTeamMember}]},updateMySuperTeamMemberInfo:{sid:21,cid:10,service:"superTeam",params:[{type:"Property",name:"teamMember",reflectMapper:Jy.superTeamMember}]},getSuperTeamMembersByAccounts:{sid:21,cid:33,service:"superTeam",params:[{type:"StrArray",name:"memberIds"}],response:[{type:"PropertyArray",name:"superTeamMembers",reflectMapper:Bc.superTeamMember}]},getSuperTeamMembers:{sid:21,cid:15,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"Long",name:"joinTime"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"}],response:[{type:"PropertyArray",name:"superTeamMembers",reflectMapper:Bc.superTeamMember}]},queryMuteSuperTeamMembers:{sid:21,cid:34,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"Long",name:"joinTime"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"}],response:[{type:"PropertyArray",name:"superTeamMembers",reflectMapper:Bc.superTeamMember}]},leaveSuperTeam:{sid:21,cid:7,service:"superTeam",params:[{type:"Long",name:"teamId"}]},passSuperTeamApply:{sid:21,cid:21,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamApply:{sid:21,cid:22,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},acceptSuperTeamInvite:{sid:21,cid:23,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamInvite:{sid:21,cid:24,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},syncSuperTeams:{sid:21,cid:109,service:"superTeam",response:[{type:"PropertyArray",name:"teams",reflectMapper:Bc.superTeam},{type:"Bool",name:"isAll"},{type:"Long",name:"timetag"}]},syncCreateSuperTeam:{sid:21,cid:101,service:"superTeam",response:[{type:"Property",name:"superTeam",reflectMapper:Bc.superTeam}]},syncUpdateSuperTeamMember:{sid:21,cid:110,service:"superTeam",response:[{type:"Property",name:"teamMember",reflectMapper:Bc.superTeamMember}]},syncMySuperTeamMembers:{sid:21,cid:111,ext:"sync",service:"superTeam",response:[{type:"PropertyArray",name:"teamMembers",reflectMapper:Bc.superTeamMember},{type:"Number",name:"timetag"}]}},FC=function(w){function M($){var _;return(_=w.call(this,"superTeam",$)||this).mySuperTeamMembersMap=new tc,_.service=new NC($),qa({cmdMap:RC,cmdConfig:BC}),_.core.eventBus.on("team/onNotification",function(re){return _.notificationHandler(re)}),_}Ro(M,w);var L=M.prototype;return L.mergeMySuperTeamMembers=function(_){var re=this;In(_).call(_,function(Oe){var de=Oe.teamId,At=re.mySuperTeamMembersMap.get(de),tr=Mr({},At,Oe);re.mySuperTeamMembersMap.set(de,tr)})},L.getSuperTeamInfo=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_),tr.next=3,this.core.sendCmd("getSuperTeamInfo",{teamId:_.teamId});case 3:return Oe=tr.sent,de=Oe.content.superTeam,tr.abrupt("return",Qo(de));case 6:case"end":return tr.stop()}},re,this)}))},L.getSuperTeams=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var re,Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return At.next=2,this.core.sendCmd("getSuperTeams",{timetag:0});case 2:return re=At.sent,Oe=re.content.superTeams,At.abrupt("return",ma(Oe));case 5:case"end":return At.stop()}},_,this)}))},L.updateSuperTeamInfo=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},name:{type:"string",allowEmpty:!1,required:!1},joinMode:{type:"enum",values:["noVerify","needVerify","rejectAll"],required:!1},beInviteMode:{type:"enum",values:["noVerify","needVerify"],required:!1},inviteMode:{type:"enum",values:["manager","all"],required:!1},updateTeamMode:{type:"enum",values:["manager","all"],required:!1},updateExtMode:{type:"enum",values:["manager","all"],required:!1},intro:{type:"string",allowEmpty:!1,required:!1},announcement:{type:"string",allowEmpty:!1,required:!1},avatar:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",allowEmpty:!1,required:!1}},_),Oe=Kd(_),At.next=4,this.core.sendCmd("updateSuperTeamInfo",{superTeam:Oe});case 4:return At.abrupt("return",Qo(Oe));case 5:case"end":return At.stop()}},re,this)}))},L.addSuperTeamMembers=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},_),de.next=3,this.core.sendCmd("addSuperTeamMembers",{teamId:_.teamId,accounts:_.accounts,ps:_.ps||"",attach:_.ext||""});case 3:case"end":return de.stop()}},re,this)}))},L.removeSuperTeamMembers=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1}},_),de.next=3,this.core.sendCmd("removeSuperTeamMembers",{teamId:_.teamId,accounts:_.accounts});case 3:case"end":return de.stop()}},re,this)}))},L.addSuperTeamManagers=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},_),de.next=3,this.core.sendCmd("addSuperTeamManagers",_);case 3:case"end":return de.stop()}},re,this)}))},L.removeSuperTeamManagers=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},_),de.next=3,this.core.sendCmd("removeSuperTeamManagers",_);case 3:case"end":return de.stop()}},re,this)}))},L.applySuperTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},_),At.next=3,this.core.sendCmd("applySuperTeam",{teamId:_.teamId,ps:_.ps||""});case 3:return Oe=At.sent,At.abrupt("return",Qo(Oe.content.superTeam));case 5:case"end":return At.stop()}},re,this)}))},L.transferSuperTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},leave:{type:"boolean"}},_),de.next=3,this.core.sendCmd("transferSuperTeam",_);case 3:case"end":return de.stop()}},re,this)}))},L.muteSuperTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},mute:{type:"boolean"}},_),de.next=3,this.core.sendCmd("muteSuperTeam",{teamId:_.teamId,mute:_.mute?1:0});case 3:case"end":return de.stop()}},re,this)}))},L.muteSuperTeamMembers=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string"},mute:{type:"boolean"}},_),de.next=3,this.core.sendCmd("muteSuperTeamMembers",{teamId:_.teamId,accounts:_.accounts,mute:_.mute?1:0});case 3:case"end":return de.stop()}},re,this)}))},L.updateMemberNick=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1}},_),Oe=kC({teamId:_.teamId,nickInTeam:_.nickInTeam,account:_.account}),tr.next=4,this.core.sendCmd("updateSuperTeamMemberNick",{teamMember:Oe});case 4:return de=Ws(Mr({updateTime:new Date().getTime()},Oe)),tr.abrupt("return",de);case 6:case"end":return tr.stop()}},re,this)}))},L.updateMyMemberInfo=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1,required:!1},bitConfigMask:{type:"number",min:0,max:2,required:!1},ext:{type:"string",required:!1}},_),Oe=kC({teamId:_.teamId,nickInTeam:_.nickInTeam,bitConfigMask:_.bitConfigMask,ext:_.ext}),ur.next=4,this.core.sendCmd("updateMySuperTeamMemberInfo",{teamMember:Oe});case 4:return de=Ws(Mr({updateTime:new Date().getTime(),account:this.core.account},Oe)),this.mergeMySuperTeamMembers([de]),this.core.emit("updateSuperTeamMember",de),At=mc(this.mySuperTeamMembersMap.get(de.teamId)),this.core.emit("mySuperTeamMembers",[At]),ur.abrupt("return",de);case 10:case"end":return ur.stop()}},re,this)}))},L.getSuperTeamMembersByAccounts=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",max:20,min:1}},_),At=To(de=_.accounts).call(de,function(yr){return _.teamId+"|"+yr}),gr.next=4,this.core.sendCmd("getSuperTeamMembersByAccounts",{memberIds:At});case 4:return tr=gr.sent,gr.abrupt("return",Wd((re=tr.content)===null||re===void 0?void 0:re.superTeamMembers));case 6:case"end":return gr.stop()}},Oe,this)}))},L.getSuperTeamMembers=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},joinTime:{type:"number",min:0,required:!1},limit:{type:"number",min:1,max:1e3,required:!1},reverse:{type:"boolean",required:!1}},_),tr.next=3,this.core.sendCmd("getSuperTeamMembers",Mr({joinTime:0,limit:100,reverse:!1},_));case 3:return de=tr.sent,tr.abrupt("return",Wd((re=de.content)===null||re===void 0?void 0:re.superTeamMembers));case 5:case"end":return tr.stop()}},Oe,this)}))},L.queryMuteMembers=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},joinTime:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1},reverse:{type:"boolean",required:!1}},_),tr.next=3,this.core.sendCmd("queryMuteSuperTeamMembers",Mr({limit:100,joinTime:0,reverse:!1},_));case 3:return Oe=tr.sent,de=Oe.content,tr.abrupt("return",Wd(de.superTeamMembers));case 6:case"end":return tr.stop()}},re,this)}))},L.leaveSuperTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_),de.next=3,this.core.sendCmd("leaveSuperTeam",{teamId:_.teamId});case 3:case"end":return de.stop()}},re,this)}))},L.passSuperTeamApply=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},_),de.next=3,this.core.sendCmd("passSuperTeamApply",_);case 3:case"end":return de.stop()}},re,this)}))},L.rejectSuperTeamApply=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},_),de.next=3,this.core.sendCmd("rejectSuperTeamApply",{teamId:_.teamId,from:_.from,ps:_.ps||""});case 3:case"end":return de.stop()}},re,this)}))},L.acceptSuperTeamInvite=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},_),de.next=3,this.core.sendCmd("acceptSuperTeamInvite",_);case 3:case"end":return de.stop()}},re,this)}))},L.rejectSuperTeamInvite=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},_),de.next=3,this.core.sendCmd("rejectSuperTeamInvite",{teamId:_.teamId,from:_.from,ps:_.ps||""});case 3:case"end":return de.stop()}},re,this)}))},L.syncSuperTeamsHandler=function(_){var re=_.content;this.core.eventBus.emit("sync/updateTimetag",{superTeams:ko(re.timetag)});var Oe=re==null?void 0:re.superTeams;if(Oe&&Oe.length){var de=ma(Oe);this.core.emit("superTeams",de)}},L.syncCreateSuperTeamHandler=function(_){var re=_.content,Oe=Qo(re==null?void 0:re.superTeam),de=of(Oe,Oe.owner,"owner");this.core.emit("createSuperTeam",Oe,de)},L.syncUpdateSuperTeamMemberHandler=function(_){var re=_.content,Oe=Ws(re==null?void 0:re.teamMember);Oe.updateTime||(Oe.updateTime=new Date().getTime()),this.mergeMySuperTeamMembers([Oe]),this.core.emit("updateSuperTeamMember",Oe);var de=mc(this.mySuperTeamMembersMap.get(Oe.teamId));this.core.emit("mySuperTeamMembers",[de])},L.syncMySuperTeamMembersHandler=function(_){var re,Oe=_.content;this.core.eventBus.emit("sync/updateTimetag",{mySuperTeamMembers:ko(Oe.timetag)});var de=Oe==null?void 0:To(re=Oe.teamMembers).call(re,function(At){return Ws(At)});this.mergeMySuperTeamMembers(de),this.core.emit("mySuperTeamMembers",mc(de))},L.notificationHandler=function(_){var re=_.attach,Oe=_.scene,de=_.from,At=_.to,tr=_.time,ur=_.idServer,gr=_.idClient,yr=re.team,Cr=re.account,xr=re.accounts,Fr=re.type;if(Oe==="superTeam")switch(this.core.options.debugLevel==="debug"?this.logger.debug("superTeam::recvNotification",ur,gr,re):this.logger.log("superTeam::recvNotification",ur,gr,At,Fr,Cr,xr),Fr){case"updateSuperTeam":yr.updateTime=tr,this.core.emit("updateSuperTeam",yr);break;case"addSuperTeamMembers":this.service.notifyAddSuperTeamMembers(yr,xr);break;case"acceptSuperTeamInvite":this.service.notifyAddSuperTeamMembers(yr,[de]);break;case"passSuperTeamApply":this.service.notifyAddSuperTeamMembers(yr,[Cr]);break;case"addSuperTeamManagers":this.service.notifyUpdateSuperTeamManagers(At,xr,!0,tr);break;case"removeSuperTeamManagers":this.service.notifyUpdateSuperTeamManagers(At,xr,!1,tr);break;case"removeSuperTeamMembers":this.service.notifyRemoveSuperTeamMembers(yr,xr);break;case"leaveSuperTeam":this.service.notifyRemoveSuperTeamMembers(yr,[de]);break;case"dismissSuperTeam":this.core.emit("dismissSuperTeam",{teamId:At});break;case"transferSuperTeam":this.service.notifyTransferSuperTeam(yr,de,Cr);break;case"updateSuperTeamMembersMute":this.service.notifyUpdateSuperTeamMembersMute(yr,xr,re.mute)}},M}(os),LC={"13_1":"getChatroomAddress","24_1":"getQChatAddress"},$C={getChatroomAddress:{sid:13,cid:1,service:"plugin",params:[{type:"Long",name:"chatroomId"},{type:"Boolean",name:"isWeixinApp"},{type:"Number",name:"ipType"}],response:[{type:"StrArray",name:"address"}]},getQChatAddress:{sid:24,cid:1,service:"plugin",params:[{type:"Property",name:"getQChatAddressTag",reflectMapper:{ipType:1}}],response:[{type:"StrArray",name:"address"}]}},jC=function(w){function M($){var _;return(_=w.call(this,"plugin",$)||this).core=$,qa({cmdMap:LC,cmdConfig:$C}),_}Ro(M,w);var L=M.prototype;return L.getChatroomAddress=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({chatroomId:{type:"string",allowEmpty:!1},ipType:{type:"number",required:!1}},_),At.next=3,this.core.sendCmd("getChatroomAddress",{chatroomId:_.chatroomId,isWeixinApp:Ho.platform==="WXAPP",ipType:_.ipType||0});case 3:return Oe=At.sent,At.abrupt("return",Oe.content.address);case 5:case"end":return At.stop()}},re,this)}))},L.getQChatAddress=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({ipType:{type:"number",required:!1}},_),At.next=3,this.core.sendCmd("getQChatAddress",{getQChatAddressTag:{ipType:(_==null?void 0:_.ipType)||0}});case 3:return Oe=At.sent,At.abrupt("return",Oe.content.address);case 5:case"end":return At.stop()}},re,this)}))},M}(os),DC={"7_19":"nimQueryCloudSessionList","7_20":"nimQueryCloudSession","7_21":"nimUpdateCloudSession","7_22":"nimDeleteCloudSessionList","7_121":"nimMultiSyncUpdateCloudSession"},Hh={sessionReqTag:{minTimestamp:1,maxTimestamp:2,includedLastMsg:3,limit:4,hasMore:5},sessionTag:{sessionId:1,updateTime:2,ext:3,lastMsg:4,lastMsgType:5}},Yy=rs(Hh),UC={nimQueryCloudSessionList:{sid:7,cid:19,service:"cloudSession",params:[{type:"Property",name:"tag",reflectMapper:Hh.sessionReqTag}],response:[{type:"Property",name:"tag",reflectMapper:Yy.sessionReqTag},{type:"PropertyArray",name:"sessions",reflectMapper:Yy.sessionTag}]},nimQueryCloudSession:{sid:7,cid:20,service:"cloudSession",params:[{type:"Property",name:"tag",reflectMapper:Hh.sessionTag}],response:[{type:"Property",name:"session",reflectMapper:Yy.sessionTag}]},nimUpdateCloudSession:{sid:7,cid:21,service:"cloudSession",params:[{type:"Property",name:"tag",reflectMapper:Hh.sessionTag}]},nimDeleteCloudSessionList:{sid:7,cid:22,service:"cloudSession",params:[{type:"PropertyArray",name:"tags",reflectMapper:Hh.sessionTag}]},nimMultiSyncUpdateCloudSession:{sid:7,cid:121,service:"cloudSession",response:[{type:"Property",name:"session",reflectMapper:Yy.sessionTag}]}},qC={sessionId:{type:"string"},updateTime:{type:"number"},ext:{type:"string"},lastMsg:{type:"object"},lastMsgType:{type:"number"}};function _C(w,M,L){var $=Zs(qC,w),_=Lo($.sessionId,"|"),re=_.accid,Oe=_.scene;if($.sessionId=Oe+"-"+re,$.lastMsg){var de=$.lastMsgType===1;$.lastMsgInfo=de?{isLastMsgRecalled:de,revokedMsg:Vd(Ei($.lastMsg,Sl.sysMsg),L)}:{isLastMsgRecalled:de,lastMsg:Bi(Ei($.lastMsg,ss.msg),{account:M})}}return delete $.lastMsg,delete $.lastMsgType,$}function VC(w,M,L){return w&&w.length>0?To(w).call(w,function($){return _C($,M,L)}):[]}var PC,Fc,zh,HC=function(w){function M($){var _;return _=w.call(this,"cloudSession",$)||this,qa({cmdMap:DC,cmdConfig:UC}),_}Ro(M,w);var L=M.prototype;return L.queryCloudSessionList=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr,ur;return ar.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return En({minTimestamp:{type:"number",min:0,required:!1},maxTimestamp:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1},includedLastMsg:{type:"boolean",required:!1}},_),(de=Mr({limit:100,includedLastMsg:!0},_)).includedLastMsg=tS.boolean(_,"includedLastMsg"),yr.next=5,this.core.sendCmd("nimQueryCloudSessionList",{tag:de});case 5:return At=yr.sent,tr=((re=At.content)===null||re===void 0?void 0:re.tag)||{},ur=At.content.sessions,yr.abrupt("return",{hasMore:+tr.hasMore>0,sessionList:VC(ur,this.core.account,this.logger)});case 9:case"end":return yr.stop()}},Oe,this)}))},L.queryCloudSession=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de,At,tr;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return En({sessionId:{type:"string",allowEmpty:!1}},_),Oe=Lo(_.sessionId,"-"),de=Oe.accid,At=Oe.scene,gr.next=4,this.core.sendCmd("nimQueryCloudSession",{tag:{sessionId:At==="superTeam"?"super_team|"+de:At+"|"+de}});case 4:return tr=gr.sent,gr.abrupt("return",_C(tr.content.session,this.core.account,this.logger));case 6:case"end":return gr.stop()}},re,this)}))},L.updateCloudSession=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({sessionId:{type:"string",allowEmpty:!1},ext:{type:"string",allowEmpty:!1,required:!1}},_),Oe=Lo(_.sessionId,"-"),de=Oe.accid,At=Oe.scene,ur.next=4,this.core.sendCmd("nimUpdateCloudSession",{tag:{sessionId:At==="superTeam"?"super_team|"+de:At+"|"+de,ext:_.ext}});case 4:case"end":return ur.stop()}},re,this)}))},L.deleteCloudSessionList=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return En({sessionIdList:{type:"array",itemType:"string"}},_),de=To(Oe=_.sessionIdList).call(Oe,function(ur){var gr=Lo(ur,"-"),yr=gr.accid,Cr=gr.scene;return{sessionId:Cr==="superTeam"?"super_team|"+yr:Cr+"|"+yr}}),tr.next=4,this.core.sendCmd("nimDeleteCloudSessionList",{tags:de});case 4:case"end":return tr.stop()}},re,this)}))},L.nimMultiSyncUpdateCloudSessionHandler=function(_){var re=_C(_.content.session,this.core.account,this.logger);this.core.emit("multiSyncUpdateCloudSession",re)},M}(os);(function(w){w[w.audio=1]="audio",w[w.video=2]="video",w[w.custom=3]="custom"})(PC||(PC={})),function(w){w[w.kClose=1]="kClose",w[w.kJoin=2]="kJoin",w[w.kInvite=3]="kInvite",w[w.kCancelInvite=4]="kCancelInvite",w[w.kReject=5]="kReject",w[w.kAccept=6]="kAccept",w[w.kLeave=7]="kLeave",w[w.kCustom=8]="kCustom"}(Fc||(Fc={})),function(w){w[w.kDefault=0]="kDefault",w[w.kLeave=1]="kLeave",w[w.kSelfSync=3]="kSelfSync"}(zh||(zh={}));var wC={needPush:{type:"boolean",required:!1},pushTitle:{type:"string",required:!1},pushContent:{type:"string",required:!1},pushPayload:{type:"string",required:!1},needPushBadge:{type:"boolean",required:!1}},zC={"15_1":"signalingCreate","15_2":"signalingDelay","15_3":"signalingClose","15_4":"signalingJoin","15_5":"signalingLeave","15_6":"signalingInvite","15_7":"signalingCancelInvite","15_8":"signalingReject","15_9":"signalingAccept","15_10":"signalingSendCustomCommand","15_11":"signalingRecvNotification","15_12":"signalingMultiSyncNotification","15_13":"signalingSyncNotification","15_14":"singalingSyncChannels","15_15":"signalingQueryInfo","15_16":"signalingCallEx","15_17":"signalingJoinAndAccept"},ti={avSignalTag:Mr({type:1,name:2,channelId:3,createTime:4,expireTime:5,creatorAccid:6,ext:7,invalid:8,fromAccid:10,toAccid:11,requestId:12,members:18,attach:19,attachExt:20,needOffline:21,msgId:22,uid:23,time:24,nertcChannelName:25,nertcTokenTtl:26,nertcToken:27,nertcJoinRoomQueryParamMap:28,nertcJoinRoomResponse:29,callStatus:30},{needPush:13,pushTitle:14,pushContent:15,pushPayload:16,needPushBadge:17})},gc=rs(ti),KC={signalingCreate:{sid:15,cid:1,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ti.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:gc.avSignalTag}]},signalingDelay:{sid:15,cid:2,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ti.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:gc.avSignalTag}]},signalingClose:{sid:15,cid:3,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ti.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:gc.avSignalTag}]},signalingJoin:{sid:15,cid:4,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ti.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:gc.avSignalTag}]},signalingLeave:{sid:15,cid:5,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ti.avSignalTag}]},signalingInvite:{sid:15,cid:6,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ti.avSignalTag}]},signalingCancelInvite:{sid:15,cid:7,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ti.avSignalTag}]},signalingReject:{sid:15,cid:8,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ti.avSignalTag}]},signalingAccept:{sid:15,cid:9,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ti.avSignalTag}]},signalingSendCustomCommand:{sid:15,cid:10,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ti.avSignalTag}]},signalingRecvNotification:{sid:15,cid:11,service:"signaling",response:[{type:"Property",name:"data",reflectMapper:gc.avSignalTag}]},signalingMultiSyncNotification:{sid:15,cid:12,service:"signaling",response:[{type:"Property",name:"data",reflectMapper:gc.avSignalTag}]},signalingSyncNotification:{sid:15,cid:13,service:"signaling",response:[{type:"PropertyArray",name:"datas",reflectMapper:gc.avSignalTag}]},singalingSyncChannels:{sid:15,cid:14,service:"signaling",response:[{type:"PropertyArray",name:"datas",reflectMapper:gc.avSignalTag}]},signalingQueryInfo:{sid:15,cid:15,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ti.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:gc.avSignalTag}]},signalingCallEx:{sid:15,cid:16,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ti.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:gc.avSignalTag}]},signalingJoinAndAccept:{sid:15,cid:17,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ti.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:gc.avSignalTag}]},signalingBatchMarkRead:{sid:4,cid:5,isNoResponse:!0,service:"signaling",params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]}},Xy={type:{type:"number"},createTime:{type:"number"},expireTime:{type:"number"},invalid:{type:"boolean"},pushInfo:wC,pluginSetting:{nertcInfo:{nertcChannelName:{type:"string"},nertcTokenTtl:{type:"number"},nertcToken:{type:"string"},nertcJoinRoomQueryParamMap:{type:"string"},callStatus:{type:"number"}}},attach:{type:"object"},members:{type:"object"},needOffline:{type:"boolean"},uid:{type:"number"},time:{type:"number"}};function Gd(w){var M,L=Zs(Xy,w),$=[];return L.members&&L.members.length>0&&($=To(M=L.members).call(M,function(_){return function(Oe){return Zs(Xy,Ei(Oe,{1:"accid",2:"uid",3:"createTime",4:"expireTime"}))}(_)}),delete L.members),$.length>0?{channelInfo:L,memberList:$}:{channelInfo:L}}function hc(w){return Td(Xy,w)}var WC=function(w){function M($){var _;return(_=w.call(this)||this).timer=0,_.pollingInterval=12e4,_.name="signaling",_.logger=$.logger,_.core=$,_.channels={},qa({cmdMap:zC,cmdConfig:KC}),_}Ro(M,w);var L=M.prototype;return L.callEx=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr,ur;return ar.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return En({type:{type:"number"},toAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},needOffline:{type:"boolean",required:!1},pushInfo:{type:"object",required:!1,rules:wC},pluginSetting:{type:"object",required:!1,rules:{nertcInfo:{type:"object",required:!1}}}},_),yr.next=3,this.core.sendCmd("signalingCallEx",{tag:hc(_)});case 3:return de=yr.sent,At=((re=de.content)===null||re===void 0?void 0:re.data)||{},tr=Gd(At),this.channels[tr.channelInfo.channelId]=mc(tr.channelInfo),this.timer||(this.timer=this.core.timerManager.addTimer(Oo(ur=this.aotoDelay).call(ur,this),this.pollingInterval,-1)),yr.abrupt("return",tr);case 9:case"end":return yr.stop()}},Oe,this)}))},L.joinAndAccept=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr,ur,gr,yr;return ar.wrap(function(xr){for(;;)switch(xr.prev=xr.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",required:!1},needOffline:{type:"boolean",required:!1},uid:{type:"number",required:!1},pluginSetting:{type:"object",required:!1,rules:{nertcInfo:{type:"object",required:!1}}}},_),de=_.fromAccid,(At=Ps(_,["fromAccid"])).toAccid=de,xr.next=5,this.core.sendCmd("signalingJoinAndAccept",{tag:hc(At)});case 5:return tr=xr.sent,ur=((re=tr.content)===null||re===void 0?void 0:re.data)||{},gr=Gd(ur),this.channels[gr.channelInfo.channelId]=mc(gr.channelInfo),this.timer||(this.timer=this.core.timerManager.addTimer(Oo(yr=this.aotoDelay).call(yr,this),this.pollingInterval,-1)),xr.abrupt("return",gr);case 11:case"end":return xr.stop()}},Oe,this)}))},L.create=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({type:{type:"number"},ext:{type:"string",required:!1}},_),ur.next=3,this.core.sendCmd("signalingCreate",{tag:hc(_)});case 3:return de=ur.sent,At=((re=de.content)===null||re===void 0?void 0:re.data)||{},ur.abrupt("return",Gd(At));case 6:case"end":return ur.stop()}},Oe,this)}))},L.close=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},_),de.next=3,this.core.sendCmd("signalingClose",{tag:hc(_)});case 3:case"end":return de.stop()}},re,this)}))},L.queryInfo=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({name:{type:"string",allowEmpty:!1}},_),ur.next=3,this.core.sendCmd("signalingQueryInfo",{tag:_});case 3:return de=ur.sent,At=((re=de.content)===null||re===void 0?void 0:re.data)||{},ur.abrupt("return",Gd(At));case 6:case"end":return ur.stop()}},Oe,this)}))},L.join=function(_){var re;return Sn(this,void 0,void 0,ar.mark(function Oe(){var de,At,tr,ur;return ar.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},uid:{type:"number",min:0,required:!1},needOffline:{type:"boolean",required:!1}},_),yr.next=3,this.core.sendCmd("signalingJoin",{tag:hc(_)});case 3:return de=yr.sent,At=((re=de.content)===null||re===void 0?void 0:re.data)||{},tr=Gd(At),this.channels[tr.channelInfo.channelId]=mc(tr.channelInfo),this.timer||(this.timer=this.core.timerManager.addTimer(Oo(ur=this.aotoDelay).call(ur,this),this.pollingInterval,-1)),yr.abrupt("return",tr);case 9:case"end":return yr.stop()}},Oe,this)}))},L.aotoDelay=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var re,Oe,de,At,tr;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:if((re=Vo(this.channels)).length!==0){gr.next=4;break}return this.timer&&this.core.timerManager.deleteTimer(this.timer),gr.abrupt("return");case 4:this.logger.log("signling:autoDelay",re),Oe=0;case 6:if(!(Oe<re.length)){gr.next=23;break}return de=re[Oe],gr.prev=8,gr.next=11,this.core.sendCmd("signalingDelay",{tag:{channelId:de}});case 11:At=gr.sent,tr=Gd(At.content.data),this.channels[de]=tr.channelInfo,gr.next=20;break;case 16:gr.prev=16,gr.t0=gr.catch(8),this.logger.warn("signling:autoDelay "+de+" failed",gr.t0),delete this.channels[de];case 20:Oe++,gr.next=6;break;case 23:case"end":return gr.stop()}},_,this,[[8,16]])}))},L.leave=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},_),de.next=3,this.core.sendCmd("signalingLeave",{tag:hc(_)});case 3:delete this.channels[_.channelId];case 4:case"end":return de.stop()}},re,this)}))},L.invite=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},toAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1},pushInfo:{type:"object",required:!1,rules:wC}},_),de.next=3,this.core.sendCmd("signalingInvite",{tag:hc(_)});case 3:case"end":return de.stop()}},re,this)}))},L.cancelInvite=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},toAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},_),de.next=3,this.core.sendCmd("signalingCancelInvite",{tag:hc(_)});case 3:case"end":return de.stop()}},re,this)}))},L.reject=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de;return ar.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},_),Oe=_.fromAccid,(de=Ps(_,["fromAccid"])).toAccid=Oe,tr.next=5,this.core.sendCmd("signalingReject",{tag:hc(de)});case 5:case"end":return tr.stop()}},re,this)}))},L.accept=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){var Oe,de,At,tr,ur;return ar.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1},autoJoin:{type:"boolean",required:!1},uid:{type:"number",min:0,required:!1},joinAttachExt:{type:"string",required:!1}},_),Oe=_.autoJoin,de=_.joinAttachExt,At=_.fromAccid,(tr=Ps(_,["autoJoin","joinAttachExt","fromAccid"])).toAccid=At,yr.next=5,this.core.sendCmd("signalingAccept",{tag:hc(tr)});case 5:if(this.logger.log("Signaling:accept, accept success, autoJoin "+_.autoJoin),!Oe){yr.next=10;break}return ur={channelId:_.channelId,needOffline:_.needOffline,attachExt:de,uid:_.uid},yr.next=10,this.join(ur);case 10:case"end":return yr.stop()}},re,this)}))},L.sendCustomCommand=function(_){return Sn(this,void 0,void 0,ar.mark(function re(){return ar.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1,required:!1},attachExt:{type:"string",required:!1}},_),de.next=3,this.core.sendCmd("signalingSendCustomCommand",{tag:hc(_)});case 3:case"end":return de.stop()}},re,this)}))},L.signalingRecvNotificationHandler=function(_){var re=typeof Os(_,"raw.r[0]")=="number"?""+_.raw.r[0]:void 0;_.content.data.msgId=re,this.doNotify(_.content.data),re&&ko(re)&&this.core.sendCmd("signalingBatchMarkRead",{sid:15,cid:11,ids:[re]})},L.signalingMultiSyncNotificationHandler=function(_){this.doNotify(_.content.data,zh.kSelfSync)},L.doNotify=function(_,re){re===void 0&&(re=zh.kDefault);var Oe=function(jr,zr){zr===void 0&&(zr=zh.kDefault);var Hr=Zs(Xy,jr),Kr=Hr.attach,kn=Hr.time,Yn=Hr.msgId;Hr.fromAccid,Hr.toAccid,Hr.members,Hr.requestId,Hr.pushInfo;var Hn=Ps(Hr,["attach","time","msgId","fromAccid","toAccid","members","requestId","pushInfo"]),xo=Kr.type,Ln=Hr.ext;return delete Hr.attach,{metaData:{eventType:xo,channelInfo:Hn,feature:zr,ext:Ln,time:kn,msgId:Yn},rawData:Hr}}(_,re),de=Oe.metaData,At=Oe.rawData,tr=At.fromAccid,ur=At.toAccid,gr=At.members,yr=At.requestId,Cr=At.pushInfo,xr=At.msgId;switch(de.eventType){case Fc.kClose:this.emit("signalingClose",{fromAccid:tr,metaData:de});break;case Fc.kJoin:this.emit("signalingJoin",{member:gr,metaData:de});break;case Fc.kInvite:this.emit("signalingInvite",{fromAccid:tr,toAccid:ur,requestId:yr,pushInfo:Cr,metaData:de});break;case Fc.kCancelInvite:this.emit("signalingCancelInvite",{fromAccid:tr,toAccid:ur,requestId:yr,metaData:de});break;case Fc.kReject:this.emit("signalingReject",{toAccid:ur,requestId:yr,metaData:de});break;case Fc.kAccept:this.emit("signalingAccept",{toAccid:ur,requestId:yr,metaData:de});break;case Fc.kLeave:this.emit("signalingLeave",{fromAccid:tr,metaData:de});break;case Fc.kCustom:this.emit("signalingCustomCommand",{fromAccid:tr,metaData:de});break;default:this.logger.warn("signaling:notification, no such a type "+de.eventType,At)}return xr},L.signalingSyncNotificationHandler=function(_){var re,Oe,de=this;if(_.content.datas&&_.content.datas.length>0){var At=ls(re=To(Oe=_.content.datas).call(Oe,function(tr){return de.doNotify(tr)})).call(re,function(tr){return tr});At.length>0&&this.core.sendCmd("signalingBatchMarkRead",{sid:15,cid:11,ids:At})}},L.singalingSyncChannelsHandler=function(_){var re;if(this.timer=0,this.channels={},_.content.datas&&_.content.datas.length>0){var Oe=To(re=_.content.datas).call(re,function(de){return Gd(de)});this.emit("singalingSyncChannels",Oe)}},L.process=function(_){var re=this[_.cmd+"Handler"];return typeof re=="function"?(re.call(this,_),uo.resolve(_)):_.error&&!_.error.ignore?uo.reject(_.error):uo.resolve(_)},M}(Hs.EventEmitter);return Fa.setAdapters(ty),Fa.registerService(uy,"auth"),Fa.registerService(ky,"msg"),Fa.registerService(_S,"misc"),Fa.registerService(Iy,"user"),Fa.registerService(rC,"session"),Fa.registerService(hC,"team"),Fa.registerService(TC,"systemMessage"),Fa.registerService(CC,"friend"),Fa.registerService(S,"event"),Fa.registerService(z,"msgExtend"),Fa.registerService(vn,"msgLog"),Fa.registerService(Dn,"passThrough"),Fa.registerService(Eo,"cloudStorage"),Fa.registerService(FC,"superTeam"),Fa.registerService(qp,"sync"),Fa.registerService(jC,"plugin"),Fa.registerService(HC,"cloudSession"),Fa.registerService(WC,"signaling"),Fa})})(NIM_BROWSER_SDK);var NIM_BROWSER_SDKExports=NIM_BROWSER_SDK.exports;const NIMSDK=getDefaultExportFromCjs(NIM_BROWSER_SDKExports);var NIM_Web_SDK={exports:{}};/*!
 * 
 * VERSION: 9.13.0
 * Git Hash: b7e3ed4d45a88d8c78898efb66610b01c72f8323
 * 
 * Create At: 2023/9/5 6:28:51
 * 
 * Target: NIM_Web_SDK
 */(function(module,exports){(function(t,r){module.exports=r()})(window,function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=r,e.d=function(n,o,s){e.o(n,o)||Object.defineProperty(n,o,{enumerable:!0,get:s})},e.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,o){if(1&o&&(n=e(n)),8&o||4&o&&typeof n=="object"&&n&&n.__esModule)return n;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:n}),2&o&&typeof n!="string")for(var a in n)e.d(s,a,(function(i){return n[i]}).bind(null,a));return s},e.n=function(n){var o=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(o,"a",o),o},e.o=function(n,o){return Object.prototype.hasOwnProperty.call(n,o)},e.p="",e(e.s=910)}([function(t,r,e){var n=e(58),o=e(2),s=e(6),a=e(15),i=e(5),u=e(171),d=e(69),c=e(138),m=e(32),v=e(7),g=e(8),b=e(10),T=e(197),k=e(139),y=e(23),O=e(17),D=e(463),he=e(3),ae=e(85),Ne=e(86),ue=e(70),Y=e(59),_e=e(60),Ce=e(61),ze=e(62),ie=e(47),le=e(26);function Ie(Pt,Et){var kt=i(Pt);if(Y){var er=Y(Pt);Et&&(er=O(er).call(er,function(cr){return _e(Pt,cr).enumerable})),kt.push.apply(kt,er)}return kt}function pe(Pt,Et){var kt=Ne!==void 0&&ue(Pt)||Pt["@@iterator"];if(!kt){if(m(Pt)||(kt=function(Ir,kr){var Ar;if(Ir){if(typeof Ir=="string")return qe(Ir,kr);var Rr=a(Ar=Object.prototype.toString.call(Ir)).call(Ar,8,-1);if(Rr==="Object"&&Ir.constructor&&(Rr=Ir.constructor.name),Rr==="Map"||Rr==="Set")return ae(Ir);if(Rr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Rr))return qe(Ir,kr)}}(Pt))||Et&&Pt&&typeof Pt.length=="number"){kt&&(Pt=kt);var er=0,cr=function(){};return{s:cr,n:function(){return er>=Pt.length?{done:!0}:{done:!1,value:Pt[er++]}},e:function(Ir){throw Ir},f:cr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var mr,vr=!0,Tr=!1;return{s:function(){kt=kt.call(Pt)},n:function(){var Ir=kt.next();return vr=Ir.done,Ir},e:function(Ir){Tr=!0,mr=Ir},f:function(){try{vr||kt.return==null||kt.return()}finally{if(Tr)throw mr}}}}function qe(Pt,Et){(Et==null||Et>Pt.length)&&(Et=Pt.length);for(var kt=0,er=new Array(Et);kt<Et;kt++)er[kt]=Pt[kt];return er}var $e=e(255),Lt=e(198);function Dt(Pt){le(Pt)==="object"?(this.callFunc=Pt.callFunc||null,this.message=Pt.message||"UNKNOW ERROR"):this.message=Pt,this.time=new Date,this.timetag=+this.time}e(486);var dr,pr,sr=e(54),hr=sr.getGlobal(),Fe=/\s+/;sr.deduplicate=function(Pt){var Et=[];return o(Pt).call(Pt,function(kt){s(Et).call(Et,kt)===-1&&Et.push(kt)}),Et},sr.capFirstLetter=function(Pt){return Pt?a(Pt=""+Pt).call(Pt,0,1).toUpperCase()+a(Pt).call(Pt,1):""},sr.guid=(dr=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return dr()+dr()+dr()+dr()+dr()+dr()+dr()+dr()}),sr.extend=function(Pt,Et,kt){for(var er in Et)Pt[er]!==void 0&&kt!==!0||(Pt[er]=Et[er])},sr.filterObj=function(Pt,Et){var kt={};return sr.isString(Et)&&(Et=Et.split(Fe)),o(Et).call(Et,function(er){Pt.hasOwnProperty(er)&&(kt[er]=Pt[er])}),kt},sr.copy=function(Pt,Et){var kt;return Et=Et||{},Pt&&o(kt=i(Pt)).call(kt,function(er){sr.exist(Pt[er])&&(Et[er]=Pt[er])}),Et},sr.copyWithNull=function(Pt,Et){var kt;return Et=Et||{},Pt&&o(kt=i(Pt)).call(kt,function(er){(sr.exist(Pt[er])||sr.isnull(Pt[er]))&&(Et[er]=Pt[er])}),Et},sr.findObjIndexInArray=function(Pt,Et){Pt=Pt||[];var kt=Et.keyPath||"id",er=-1;return u(Pt).call(Pt,function(cr,mr){if(Lt(cr,kt)===Et.value)return er=mr,!0}),er},sr.findObjInArray=function(Pt,Et){var kt=sr.findObjIndexInArray(Pt,Et);return kt===-1?null:Pt[kt]},sr.mergeObjArray=function(){var Pt=[],Et=a([]).call(arguments,0,-1),kt=arguments[arguments.length-1];sr.isArray(kt)&&(Et.push(kt),kt={});var er,cr=kt.keyPath=kt.keyPath||"id";for(kt.sortPath=kt.sortPath||cr;!Pt.length&&Et.length;)Pt=Et.shift()||[],Pt=a(Pt).call(Pt,0);return o(Et).call(Et,function(mr){mr&&o(mr).call(mr,function(vr){(er=sr.findObjIndexInArray(Pt,{keyPath:cr,value:Lt(vr,cr)}))!==-1?Pt[er]=sr.merge({},Pt[er],vr):Pt.push(vr)})}),kt.notSort||(Pt=sr.sortObjArray(Pt,kt)),Pt},sr.cutObjArray=function(Pt){var Et=a(Pt).call(Pt,0),kt=arguments.length,er=a([]).call(arguments,1,kt-1),cr=arguments[kt-1];sr.isObject(cr)||(er.push(cr),cr={});var mr,vr=cr.keyPath=cr.keyPath||"id";return o(er).call(er,function(Tr){sr.isArray(Tr)||(Tr=[Tr]),o(Tr).call(Tr,function(Ir){Ir&&(cr.value=Lt(Ir,vr),(mr=sr.findObjIndexInArray(Et,cr))!==-1&&d(Et).call(Et,mr,1))})}),Et},sr.sortObjArray=function(Pt,Et){var kt=(Et=Et||{}).sortPath||"id";$e.insensitive=!!Et.insensitive;var er,cr,mr,vr=!!Et.desc;return mr=sr.isFunction(Et.compare)?Et.compare:function(Tr,Ir){return er=Lt(Tr,kt),cr=Lt(Ir,kt),vr?$e(cr,er):$e(er,cr)},c(Pt).call(Pt,mr)},sr.emptyFunc=function(){},sr.isEmptyFunc=function(Pt){return Pt===sr.emptyFunc},sr.notEmptyFunc=function(Pt){return Pt!==sr.emptyFunc},sr.splice=function(Pt,Et,kt){return d([]).call(Pt,Et,kt)},sr.reshape2d=function(Pt,Et){if(m(Pt)){sr.verifyParamType("type",Et,"number","util::reshape2d");var kt=Pt.length;if(kt<=Et)return[Pt];for(var er=Math.ceil(kt/Et),cr=[],mr=0;mr<er;mr++)cr.push(a(Pt).call(Pt,mr*Et,(mr+1)*Et));return cr}return Pt},sr.flatten2d=function(Pt){if(m(Pt)){var Et=[];return o(Pt).call(Pt,function(kt){Et=v(Et).call(Et,kt)}),Et}return Pt},sr.dropArrayDuplicates=function(Pt){if(m(Pt)){for(var Et={},kt=[];Pt.length>0;)Et[Pt.shift()]=!0;for(var er in Et)Et[er]===!0&&kt.push(er);return kt}return Pt},sr.onError=function(Pt){throw new Dt(Pt)},sr.verifyParamPresent=function(Pt,Et,kt,er){kt=kt||"";var cr=!1;switch(sr.typeOf(Et)){case"undefined":case"null":cr=!0;break;case"string":Et===""&&(cr=!0);break;case"StrStrMap":case"object":i(Et).length||(cr=!0);break;case"array":Et.length?u(Et).call(Et,function(mr){if(sr.notexist(mr))return cr=!0,!0}):cr=!0}cr&&sr.onParamAbsent(kt+Pt,er)},sr.onParamAbsent=function(Pt,Et){sr.onParamError(" ".concat(Pt,",  nullundefined,  null/undefined"),Et)},sr.verifyParamAbsent=function(Pt,Et,kt,er){kt=kt||"",Et!==void 0&&sr.onParamPresent(kt+Pt,er)},sr.onParamPresent=function(Pt,Et){sr.onParamError(" ".concat(Pt),Et)},sr.verifyParamType=function(Pt,Et,kt,er){var cr=sr.typeOf(Et).toLowerCase();sr.isArray(kt)||(kt=[kt]),kt=g(kt).call(kt,function(vr){return vr.toLowerCase()});var mr=!0;switch(s(kt).call(kt,cr)===-1&&(mr=!1),cr){case"number":isNaN(Et)&&(mr=!1);break;case"string":kt.join("")==="numeric or numeric string"&&(mr=!!/^[0-9]+$/.test(Et))}mr||sr.onParamInvalidType(Pt,kt,"",er)},sr.onParamInvalidType=function(Pt,Et,kt,er){kt=kt||"",Et=sr.isArray(Et)?(Et=g(Et).call(Et,function(cr){return'"'+cr+'"'})).join(", "):'"'+Et+'"',sr.onParamError('"'+kt+Pt+'", : ['+Et+"]",er)},sr.verifyParamValid=function(Pt,Et,kt,er){sr.isArray(kt)||(kt=[kt]),s(kt).call(kt,Et)===-1&&sr.onParamInvalidValue(Pt,kt,er)},sr.onParamInvalidValue=function(Pt,Et,kt){var er;sr.isArray(Et)||(Et=[Et]),Et=g(Et).call(Et,function(cr){return'"'+cr+'"'}),sr.isArray(Et)&&(Et=Et.join(", ")),sr.onParamError(v(er=" ".concat(Pt,", : [")).call(er,b(Et),"]"),kt)},sr.verifyParamMin=function(Pt,Et,kt,er){Et<kt&&sr.onParamError(""+Pt+""+kt,er)},sr.verifyParamMax=function(Pt,Et,kt,er){Et>kt&&sr.onParamError(""+Pt+""+kt,er)},sr.verifyArrayMax=function(Pt,Et,kt,er){Et.length>kt&&sr.onParamError(""+Pt+""+kt,er)},sr.verifyEmail=(pr=/^\S+@\S+$/,function(Pt,Et,kt){pr.test(Et)||sr.onParamError(""+Pt+", @, @",kt)}),sr.verifyTel=function(){var Pt=/^[+\-()\d]+$/;return function(Et,kt,er){Pt.test(kt)||sr.onParamError(""+Et+", +-",er)}}(),sr.verifyBirth=function(){var Pt=/^(\d{4})-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/;return function(Et,kt,er){Pt.test(kt)||sr.onParamError(""+Et+', "yyyy-MM-dd"',er)}}(),sr.onParamError=function(Pt,Et){sr.onError({message:Pt,callFunc:Et})},sr.verifyOptions=function(Pt,Et,kt,er,cr){if(Pt=Pt||{},Et&&(sr.isString(Et)&&(Et=Et.split(Fe)),sr.isArray(Et))){typeof kt!="boolean"&&(cr=kt||null,kt=!0,er="");var mr=kt?sr.verifyParamPresent:sr.verifyParamAbsent;o(Et).call(Et,function(vr){mr.call(sr,vr,Pt[vr],er,cr)})}return Pt},sr.verifyParamAtLeastPresentOne=function(Pt,Et,kt){Et&&(sr.isString(Et)&&(Et=Et.split(Fe)),sr.isArray(Et)&&(u(Et).call(Et,function(er){return sr.exist(Pt[er])})||sr.onParamError("["+Et.join(", ")+"]",kt)))},sr.verifyParamPresentJustOne=function(Pt,Et,kt){Et&&(sr.isString(Et)&&(Et=Et.split(Fe)),sr.isArray(Et)&&T(Et).call(Et,function(er,cr){return sr.exist(Pt[cr])&&er++,er},0)!==1&&sr.onParamError("["+Et.join(", ")+"]",kt))},sr.verifyBooleanWithDefault=function(Pt,Et,kt,er,cr){sr.undef(kt)&&(kt=!0),Fe.test(Et)&&(Et=Et.split(Fe)),sr.isArray(Et)?o(Et).call(Et,function(mr){sr.verifyBooleanWithDefault(Pt,mr,kt,er,cr)}):Pt[Et]===void 0?Pt[Et]=kt:sr.isBoolean(Pt[Et])||sr.onParamInvalidType(Et,"boolean",er,cr)},sr.verifyFileInput=function(Pt,Et){var kt;return sr.verifyParamPresent("fileInput",Pt,"",Et),sr.isString(Pt)&&((Pt=typeof document>"u"?void 0:document.getElementById(Pt))||sr.onParamError("input, fileInput id ".concat(Pt),Et)),Pt.tagName&&Pt.tagName.toLowerCase()==="input"&&Pt.type.toLowerCase()==="file"||sr.onParamError(v(kt=" fileInput,  file  input  tagname:".concat(Pt.tagName,", filetype:")).call(kt,Pt.type),Et),Pt},sr.verifyFileType=function(Pt,Et){sr.verifyParamValid("type",Pt,sr.validFileTypes,Et)},sr.verifyCallback=function(Pt,Et,kt){Fe.test(Et)&&(Et=Et.split(Fe)),sr.isArray(Et)?o(Et).call(Et,function(er){sr.verifyCallback(Pt,er,kt)}):Pt[Et]?sr.isFunction(Pt[Et])||sr.onParamInvalidType(Et,"function","",kt):Pt[Et]=sr.emptyFunc},sr.verifyFileUploadCallback=function(Pt,Et){sr.verifyCallback(Pt,"uploadprogress uploaddone uploaderror uploadcancel",Et)},sr.validFileTypes=["image","audio","video","file"],sr.validFileExts={image:["bmp","gif","jpg","jpeg","jng","png","webp"],audio:["mp3","wav","aac","wma","wmv","amr","mp2","flac","vorbis","ac3"],video:["mp4","rm","rmvb","wmv","avi","mpg","mpeg","mov"]},sr.filterFiles=function(Pt,Et){var kt,er,cr=(Et=Et.toLowerCase())==="file",mr=[];return o([]).call(Pt,function(vr){var Tr,Ir;if(cr)mr.push(vr);else if(kt=a(Tr=vr.name).call(Tr,k(Ir=vr.name).call(Ir,".")+1),(er=vr.type.split("/"))[0]&&er[1]){var kr,Ar=!1;er[0].toLowerCase()===Et?Ar=!0:Ar=s(kr=sr.validFileExts[Et]).call(kr,kt)!==-1,Ar&&mr.push(vr)}}),mr};var nr,ir,Ue=sr.supportFormData=sr.notundef(hr.FormData);sr.getFileName=function(Pt){return Pt=sr.verifyFileInput(Pt),Ue?Pt.files[0].name:a(Et=Pt.value).call(Et,k(kt=Pt.value).call(kt,"\\")+1);var Et,kt},sr.getFileInfo=(nr={ppt:1,pptx:2,pdf:3,doc:6,docx:7},function(Pt){var Et={};if(!(Pt=sr.verifyFileInput(Pt)).files)return Et;var kt=Pt.files[0];return Ue&&(Et.name=kt.name,Et.size=kt.size,Et.type=kt.name.match(/\.(\w+)$/),Et.type=Et.type&&Et.type[1].toLowerCase(),Et.transcodeType=nr[Et.type]||0),Et}),sr.sizeText=(ir=["B","KB","MB","GB","TB","PB","EB","ZB","BB"],function(Pt){var Et,kt=0;do Et=(Pt=Math.floor(100*Pt)/100)+ir[kt],Pt/=1024,kt++;while(Pt>1);return Et}),sr.promises2cmds=function(Pt){return g(Pt).call(Pt,function(Et){return Et.cmd})},sr.objs2accounts=function(Pt){return g(Pt).call(Pt,function(Et){return Et.account})},sr.teams2ids=function(Pt){return g(Pt).call(Pt,function(Et){return Et.teamId})},sr.objs2ids=function(Pt){return g(Pt).call(Pt,function(Et){return Et.id})},sr.getMaxUpdateTime=function(Pt){var Et=g(Pt).call(Pt,function(kt){return+kt.updateTime});return Math.max.apply(Math,Et)},sr.genCheckUniqueFunc=function(Pt){return Pt=Pt||"id",function(Et){this.uniqueSet=this.uniqueSet||{},this.uniqueSet[Pt]=this.uniqueSet[Pt]||{};var kt=this.uniqueSet[Pt],er=Et[Pt];return!kt[er]&&(kt[er]=!0,!0)}},sr.fillPropertyWithDefault=function(Pt,Et,kt){return!!sr.undef(Pt[Et])&&(Pt[Et]=kt,!0)},sr.throttle=function(Pt,Et,kt,er){var cr,mr,vr=null,Tr=0;kt||(kt={});var Ir=function(){Tr=kt.leading===!1?0:new Date().getTime(),vr=null,Pt.apply(cr,mr),vr||(cr=mr=null)};return function(){var kr=new Date().getTime();Tr||kt.leading!==!1||(Tr=kr);var Ar=Et-(kr-Tr);return cr=this,mr=arguments,Ar<=0||Ar>Et?(clearTimeout(vr),vr=null,Tr=kr,Pt.apply(cr,mr),vr||(cr=mr=null)):vr||kt.trailing===!1?vr&&er&&er.apply(cr,mr):(vr=y(Ir,Ar),er&&er.apply(cr,mr)),vr}},sr.get=function(Pt,Et){var kt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;if(le(Pt)!=="object")return kt;var er,cr=Et.replace(/\[(\d+)\]/g,".$1").split("."),mr=Pt,vr=pe(cr);try{for(vr.s();!(er=vr.n()).done;){var Tr=er.value;if((mr=Object(mr)[Tr])===void 0)return kt}}catch(Ir){vr.e(Ir)}finally{vr.f()}return mr},sr.pickAsString=function(Pt,Et){var kt;return Pt?g(kt=O(Et).call(Et,function(er){return Pt[er]!==void 0})).call(kt,function(er){var cr;return v(cr="".concat(er,"=")).call(cr,Pt[er])}).join(","):""},sr.omitAsString=function(Pt,Et){var kt,er;if(!Pt)return"";var cr={};return o(Et).call(Et,function(mr){cr[mr]=!0}),g(kt=O(er=i(Pt)).call(er,function(mr){return!cr[mr]})).call(kt,function(mr){var vr;return v(vr="".concat(mr,"=")).call(vr,Pt[mr])}).join(",")};var rr={session:function(Pt){var Et=function(er){for(var cr=1;cr<arguments.length;cr++){var mr,vr,Tr=arguments[cr]!=null?arguments[cr]:{};cr%2?o(mr=Ie(Object(Tr),!0)).call(mr,function(Ir){n(er,Ir,Tr[Ir])}):Ce?ze(er,Ce(Tr)):o(vr=Ie(Object(Tr))).call(vr,function(Ir){ie(er,Ir,_e(Tr,Ir))})}return er}({},Pt),kt=["topCustom","localCustom","extra"];return o(kt).call(kt,function(er){Et[er]&&(Et[er]="***")}),Et.lastMsg&&(Et.lastMsg={idServer:Et.lastMsg.idServer,idClient:Et.lastMsg.idClient}),Et}};sr.secureOutput=function(Pt,Et){m(Et)||(Et=[Et]);var kt=rr[Pt];return(Et=g(Et).call(Et,function(er){return kt(er)})).length===1?Et[0]:Et};var or={string:function(Pt,Et,kt){var er=kt.required,cr=kt.allowEmpty,mr=Pt[Et];return er===!1&&mr===void 0||typeof mr=="string"&&!(!cr&&mr==="")},number:function(Pt,Et,kt){var er=kt.required,cr=kt.min,mr=Pt[Et];return er===!1&&mr===void 0||typeof mr=="number"&&!(mr<cr)},enum:function(Pt,Et,kt){var er=kt.required,cr=D(kt),mr=Pt[Et];return er===!1&&mr===void 0||s(cr).call(cr,mr)>-1},array:function(Pt,Et,kt){var er=kt.required,cr=Pt[Et];return er===!1&&cr===void 0||!!m(cr)}};sr.validate=function(Pt,Et,kt){var er,cr={};return o(er=i(Pt)).call(er,function(mr){var vr,Tr=Pt[mr].type,Ir=or[Tr];Ir&&!Ir(Et,mr,Pt[mr])?sr.onError({message:v(vr="Error in parameter verification, ".concat(mr," expected value is ")).call(vr,b(Pt[mr])),callFunc:kt}):cr[mr]=Et[mr]}),cr},sr.asyncPool=function(Pt,Et,kt){if(typeof Pt!="number"||typeof kt!="function"||!Et||!Et.length)return he.resolve();var er=0,cr=[],mr=[];return function vr(){if(er===Et.length)return he.resolve();var Tr=Et[er++],Ir=he.resolve().then(function(){return kt(Tr,Et)});cr.push(Ir);var kr=he.resolve();if(Pt<=Et.length){var Ar=Ir.then(function(){return d(mr).call(mr,s(mr).call(mr,Ar),1)});mr.push(Ar),mr.length>=Pt&&(kr=he.race(mr))}return kr.then(function(){return vr()})}().then(function(){return he.all(cr)})},sr.getIdArray=function(Pt){if(!Pt||typeof Pt!="string")throw new Error("id type error");var Et=s(Pt).call(Pt,"-");if(Et<0||Et===Pt.length-1)throw new Error("id format error");return[a(Pt).call(Pt,0,Et),a(Pt).call(Pt,Et+1)]},t.exports=sr},function(t,r,e){var n=e(14),o=e(76),s=e(156),a=e(16),i=e(90).f,u=e(210),d=e(12),c=e(34),m=e(53),v=e(29),g=function(b){var T=function(k,y,O){if(this instanceof T){switch(arguments.length){case 0:return new b;case 1:return new b(k);case 2:return new b(k,y)}return new b(k,y,O)}return o(b,this,arguments)};return T.prototype=b.prototype,T};t.exports=function(b,T){var k,y,O,D,he,ae,Ne,ue,Y,_e=b.target,Ce=b.global,ze=b.stat,ie=b.proto,le=Ce?n:ze?n[_e]:(n[_e]||{}).prototype,Ie=Ce?d:d[_e]||m(d,_e,{})[_e],pe=Ie.prototype;for(D in T)y=!(k=u(Ce?D:_e+(ze?".":"#")+D,b.forced))&&le&&v(le,D),ae=Ie[D],y&&(Ne=b.dontCallGetSet?(Y=i(le,D))&&Y.value:le[D]),he=y&&Ne?Ne:T[D],y&&typeof ae==typeof he||(ue=b.bind&&y?c(he,n):b.wrap&&y?g(he):ie&&a(he)?s(he):he,(b.sham||he&&he.sham||ae&&ae.sham)&&m(ue,"sham",!0),m(Ie,D,ue),ie&&(v(d,O=_e+"Prototype")||m(d,O,{}),m(d[O],D,he),b.real&&pe&&(k||!pe[D])&&m(pe,D,he)))}},function(t,r,e){t.exports=e(229)},function(t,r,e){t.exports=e(231)},function(t,r){t.exports=function(e){try{return!!e()}catch{return!0}}},function(t,r,e){t.exports=e(230)},function(t,r,e){t.exports=e(206)},function(t,r,e){t.exports=e(324)},function(t,r,e){t.exports=e(441)},function(t,r,e){t.exports=e(275)},function(t,r,e){t.exports=e(385)},function(t,r,e){var n=e(107),o=Function.prototype,s=o.call,a=n&&o.bind.bind(s,s);t.exports=n?a:function(i){return function(){return s.apply(i,arguments)}}},function(t,r){t.exports={}},function(t,r,e){var n=e(6),o=e(7),s=!1;try{typeof localStorage.setItem=="function"&&typeof localStorage.getItem=="function"&&(localStorage.setItem("nim_localstorage_exist_test","1"),s=localStorage.getItem("nim_localstorage_exist_test")==="1",localStorage.removeItem("nim_localstorage_exist_test"))}catch{s=!1}var a={nodeEnv:"production",info:{hash:"b7e3ed4d45a88d8c78898efb66610b01c72f8323",shortHash:"b7e3ed4d",version:"9.13.0",sdkVersion:"91300",sdkHumanVersion:"9.13.0",protocolVersion:1},lbsUrl:"https://lbs.netease.im/lbs/webconf.jsp",needToXHR:!0,connectTimeout:1e4,xhrTimeout:8e3,reconnectionDelay:1600,reconnectionDelayMax:8e3,reconnectionJitter:.01,reconnectiontimer:null,heartbeatInterval:3e4,cmdTimeout:8e3,hbCmdTimeout:5e3,isWeixinApp:!1,isNodejs:!1,isRN:!1,ipVersion:0,PUSHTOKEN:"",PUSHCONFIG:{},CLIENTTYPE:16,PushPermissionAsked:!1,iosPushConfig:null,androidPushConfig:null,optionDefaultLinkUrl:"",defaultLinkUrl:"weblink.netease.im",ipv6DefaultLinkUrl:"weblink.netease.im",optionIpv6DefaultLinkUrl:"",wxDefaultLinkUrl:"wlnimsc0.netease.im",serverNosConfig:s?{cdnDomain:localStorage.getItem("nim_cdn_domain")||"",objectPrefix:localStorage.getItem("nim_object_prefix")||""}:{},hasLocalStorage:s,privateConf:{isABTestEnable:!0,isDataReportEnable:!0,isMixStoreEnable:!0,reportConfigUrl:"https://statistic.live.126.net/dispatcher/req",reportUrl:"https://statistic.live.126.net/statics/report/common/form"},getDefaultLinkUrl:function(i){var u,d;a.ipVersion===1?(u=a.optionIpv6DefaultLinkUrl,d=a.ipv6DefaultLinkUrl):(u=a.optionDefaultLinkUrl,d=a.defaultLinkUrl);var c=u||(a.isWeixinApp?a.wxDefaultLinkUrl:d);if(!c)return!1;var m=i?"https":"http",v=i?"443":"80",g=c;return n(c).call(c,"http")===-1&&(g=m+"://"+g),n(c).call(c,":")===-1&&(g=g+":"+v),g},ipProbeAddr:{ipv4:"https://check-ipv4.netease.im/test/",ipv6:"https://check-ipv6.netease.im/test/"},formatSocketUrl:function(i){var u=i.url,d=i.secure?"https":"http";return n(u).call(u,"http")===-1?d+"://"+u:u},uploadUrl:"https://nos.netease.com",chunkUploadUrl:"https://wanproxy-web.127.net",commonMaxSize:104857600,chunkSize:4194304,chunkMaxSize:4194304e4,replaceUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHost:"nos.netease.com",downloadHostList:["nos.netease.com"],downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",nosCdnEnable:!0,httpsEnabled:!1,threshold:0,nosLbsUrls:[],edgeList:["https://wanproxy-web.127.net","https://nosup-hz1.127.net"],genUploadUrl:function(i){return a.uploadUrl+"/"+i},genChunkUploadUrl:function(i){return a.chunkUploadUrl?a.chunkUploadUrl+"/"+i.bucket+"/"+i.objectName:""},genDownloadUrl:function(i,u,d){var c,m,v,g,b,T=i.bucket,k=i.expireSec,y=+new Date,O=k?"&survivalTime=".concat(k):"";if(d)return o(v=o(g=o(b="https://".concat(d,"/")).call(b,u,"?createTime=")).call(g,y)).call(v,O);var D=o(c=o(m="".concat(a.replaceUrl,"?createTime=")).call(m,y)).call(c,O);return(D=a.genNosProtocolUrl(D)).replace("{bucket}",T).replace("{object}",u)},genFileUrl:function(i){var u=i.bucket,d=i.objectName;return a.genNosProtocolUrl(a.replaceUrl).replace("{bucket}",u).replace("{object}",d)},genNosProtocolUrl:function(i){return/^http/.test(i)?a.httpsEnabled&&n(i).call(i,"https://")!==0&&(i=i.replace("http","https")):i=a.httpsEnabled?"https://".concat(i):"http://".concat(i),i}};a.hostEnv="BROWSER",t.exports=a},function(t,r,e){(function(n){var o=function(s){return s&&s.Math==Math&&s};t.exports=o(typeof globalThis=="object"&&globalThis)||o(typeof window=="object"&&window)||o(typeof self=="object"&&self)||o(typeof n=="object"&&n)||function(){return this}()||Function("return this")()}).call(this,e(56))},function(t,r,e){t.exports=e(250)},function(t,r,e){var n=e(207),o=n.all;t.exports=n.IS_HTMLDDA?function(s){return typeof s=="function"||s===o}:function(s){return typeof s=="function"}},function(t,r,e){t.exports=e(459)},function(t,r,e){t.exports=e(215)},function(t,r,e){var n=e(107),o=Function.prototype.call;t.exports=n?o.bind(o):function(){return o.apply(o,arguments)}},function(t,r,e){var n=e(14),o=e(109),s=e(29),a=e(127),i=e(92),u=e(208),d=o("wks"),c=n.Symbol,m=c&&c.for,v=u?c:c&&c.withoutSetter||a;t.exports=function(g){if(!s(d,g)||!i&&typeof d[g]!="string"){var b="Symbol."+g;i&&s(c,g)?d[g]=c[g]:d[g]=u&&m?m(b):v(b)}return d[g]}},function(t,r,e){var n=e(11);t.exports=n({}.isPrototypeOf)},function(t,r,e){var n=e(12),o=e(29),s=e(133),a=e(38).f;t.exports=function(i){var u=n.Symbol||(n.Symbol={});o(u,i)||a(u,i,{value:s.f(i)})}},function(t,r,e){t.exports=e(455)},function(t,r,e){var n=e(58),o=e(57),s=e(7),a=e(23),i=e(10),u=e(32),d=e(5),c=e(59),m=e(17),v=e(60),g=e(2),b=e(61),T=e(62),k=e(47),y=e(15),O=e(85),D=e(86),he=e(70);function ae(le,Ie){var pe=D!==void 0&&he(le)||le["@@iterator"];if(!pe){if(u(le)||(pe=function(pr,sr){var hr;if(pr){if(typeof pr=="string")return Ne(pr,sr);var Fe=y(hr=Object.prototype.toString.call(pr)).call(hr,8,-1);if(Fe==="Object"&&pr.constructor&&(Fe=pr.constructor.name),Fe==="Map"||Fe==="Set")return O(pr);if(Fe==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Fe))return Ne(pr,sr)}}(le))||Ie&&le&&typeof le.length=="number"){pe&&(le=pe);var qe=0,$e=function(){};return{s:$e,n:function(){return qe>=le.length?{done:!0}:{done:!1,value:le[qe++]}},e:function(pr){throw pr},f:$e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Lt,Dt=!0,dr=!1;return{s:function(){pe=pe.call(le)},n:function(){var pr=pe.next();return Dt=pr.done,pr},e:function(pr){dr=!0,Lt=pr},f:function(){try{Dt||pe.return==null||pe.return()}finally{if(dr)throw Lt}}}}function Ne(le,Ie){(Ie==null||Ie>le.length)&&(Ie=le.length);for(var pe=0,qe=new Array(Ie);pe<Ie;pe++)qe[pe]=le[pe];return qe}function ue(le,Ie){var pe=d(le);if(c){var qe=c(le);Ie&&(qe=m(qe).call(qe,function($e){return v(le,$e).enumerable})),pe.push.apply(pe,qe)}return pe}function Y(le){for(var Ie=1;Ie<arguments.length;Ie++){var pe,qe,$e=arguments[Ie]!=null?arguments[Ie]:{};Ie%2?g(pe=ue(Object($e),!0)).call(pe,function(Lt){n(le,Lt,$e[Lt])}):b?T(le,b($e)):g(qe=ue(Object($e))).call(qe,function(Lt){k(le,Lt,v($e,Lt))})}return le}var _e=e(44),Ce=e(0);function ze(le){return Ce.get(le,"code")||Ce.get(le,"msg.code")||Ce.get(le,"statusCode")||Ce.get(le,"event.code")||0}function ie(le){var Ie,pe,qe=typeof le=="string"?le:Ce.get(le,"msg")||Ce.get(le,"message")||Ce.get(le,"error")||Ce.get(le,"event.msg")||Ce.get(le,"event.message")||Ce.get(le,"event")||"unknown",$e="",Lt="";le&&typeof le.toString=="function"&&($e=le.toString());try{Lt=i(le)}catch{}return s(Ie=s(pe=`
errMsg: `.concat(qe,`
errStr: `)).call(pe,$e,`
errJsonStr: `)).call(Ie,Lt,`
  `)}t.exports={reportAPI:function(le){var Ie=le.instance,pe=le.className,qe=le.funcName,$e=le.hasCallback,Lt=$e===void 0||$e,Dt=le.done;if(!function(sr){if(!sr||!u(sr.experiments))return!1;var hr,Fe=ae(sr.experiments);try{for(Fe.s();!(hr=Fe.n()).done;){var nr=hr.value;if(nr.experimentKey==="api_trace_collection"&&nr.schemeKey==="open_flow"&&u(nr.variates)){var ir,Ue=ae(nr.variates);try{for(Ue.s();!(ir=Ue.n()).done;){var rr=ir.value;if(rr.key==="open"&&rr.value===!0)return!0}}catch(or){Ue.e(or)}finally{Ue.f()}}}}catch(or){Fe.e(or)}finally{Fe.f()}return!1}(Ie.abtInfo)||!Ie.reporter||!Ie.reporter.isUploadEnable)return Dt;var dr,pr={user_id:Ce.get(Ie,"options.account")||"",trace_id:Ce.get(Ie,"socket.socket.sessionid"),class_name:pe,api_name:qe,action:Lt?1:0,active_id:_e.deviceId,start_time:o()};return Lt?(dr=a(function(){Ie&&Ie.logger&&Ie.logger.warn("API ",pr),Ie&&Ie.reporter&&Ie.reporter.report("nim_api_trace",Y(Y({},pr),{},{state:1,error_code:408,error_msg:"API",duration:o()-pr.start_time}))},1e4),function(sr){if(clearTimeout(dr),typeof Dt=="function"){for(var hr,Fe=arguments.length,nr=new Array(Fe>1?Fe-1:0),ir=1;ir<Fe;ir++)nr[ir-1]=arguments[ir];Dt.apply(void 0,s(hr=[sr]).call(hr,nr))}try{if(!Ie||!Ie.reporter)return;sr?Ie.reporter.report("nim_api_trace",Y(Y({},pr),{},{state:1,error_code:ze(sr),error_msg:ie(sr),duration:o()-pr.start_time})):Ie.reporter.report("nim_api_trace",Y(Y({},pr),{},{state:0,duration:o()-pr.start_time}))}catch(Ue){Ie&&Ie.logger&&Ie.logger.error("api report error",Ue)}}):(Ie.reporter.report("nim_api_trace",Y(Y({},pr),{},{state:0,duration:1})),Dt)}}},function(t,r,e){t.exports=e(272)},function(t,r,e){var n=e(153),o=e(366);function s(a){return t.exports=s=typeof n=="function"&&typeof o=="symbol"?function(i){return typeof i}:function(i){return i&&typeof n=="function"&&i.constructor===n&&i!==n.prototype?"symbol":typeof i},t.exports.__esModule=!0,t.exports.default=t.exports,s(a)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(4);t.exports=!n(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},function(t,r,e){var n=e(16),o=e(207),s=o.all;t.exports=o.IS_HTMLDDA?function(a){return typeof a=="object"?a!==null:n(a)||a===s}:function(a){return typeof a=="object"?a!==null:n(a)}},function(t,r,e){var n=e(11),o=e(42),s=n({}.hasOwnProperty);t.exports=Object.hasOwn||function(a,i){return s(o(a),i)}},function(t,r,e){var n=e(12);t.exports=function(o){return n[o+"Prototype"]}},function(t,r,e){var n=e(16),o=e(78),s=TypeError;t.exports=function(a){if(n(a))return a;throw s(o(a)+" is not a function")}},function(t,r,e){t.exports=e(299)},function(t,r,e){var n=e(12),o=e(14),s=e(16),a=function(i){return s(i)?i:void 0};t.exports=function(i,u){return arguments.length<2?a(n[i])||a(o[i]):n[i]&&n[i][u]||o[i]&&o[i][u]}},function(t,r,e){var n=e(156),o=e(31),s=e(107),a=n(n.bind);t.exports=function(i,u){return o(i),u===void 0?i:s?a(i,u):function(){return i.apply(u,arguments)}}},function(t,r,e){var n=e(18),o=e(25),s=e(3),a=e(71),i=e(75),u=e(13),d=e(0),c=e(290),m=d.undef,v=e(309),g=e(147),b=e(151),T=e(779);function k(D){var he,ae,Ne,ue=this;d.verifyOptions(D,"appKey account token","protocol::IMProtocol"),d.verifyCallback(D,["onconnect","onerror","onwillreconnect","ondisconnect","onloginportschange","onmyinfo","onblacklist","onmutelist","onfriends","onusers","onrobots","onteams","onSuperTeams","onsessions","onSessionsWithMoreRoaming","onStickTopSessions","onroamingmsgs","onofflinemsgs","onofflinefiltermsgs","onroamingsysmsgs","onofflinesysmsgs","onofflinefiltersysmsgs","onofflinecustomsysmsgs","onofflinefiltercustomsysmsgs","onbroadcastmsg","onbroadcastmsgs","onsysmsgunread","onsyncdone","onteammembers","onsyncteammembersdone","onmsg","onsysmsg","oncustomsysmsg","onupdatemyinfo","onupdateuser","onSyncUpdateServerSession","onUpdateSuperTeamMember","onMySuperTeamMembers","onCreateSuperTeam","onUpdateSuperTeam","onAddSuperTeamMembers","onRemoveSuperTeamMembers","onUpdateSuperTeamManagers","onDismissSuperTeam","onTransferSuperTeam","onUpdateSuperTeamMembersMute","onupdateteammember","onMyTeamMembers","onMsgReceipts","onCreateTeam","onUpdateTeam","onAddTeamMembers","onRemoveTeamMembers","onUpdateTeamManagers","onDismissTeam","onTransferTeam","onUpdateTeamMembersMute","onTeamMsgReceipt","onupdatesession","onQuickComment","onDeleteQuickComment","onPinMsgChange","onupdatesysmsgunread","onupdatesysmsg","onsynccreateteam","onsyncsupercreateteam","onsyncmarkinblacklist","onsyncmarkinmutelist","onsyncfriendaction","shouldIgnoreNotification","shouldIgnoreMsg","onDeleteMsgSelf","shouldCountNotifyUnread","onPushNotificationMultiportConfig","onPushNotificationMultiportConfigUpdate","onpushevents"],"protocol::IMProtocol"),he=typeof d.get(D,"privateConf.isDataReportEnable")=="boolean"?D.privateConf.isDataReportEnable:u.privateConf.isDataReportEnable,ae=typeof d.get(D,"privateConf.reportConfigUrl")=="string"?D.privateConf.reportConfigUrl:u.privateConf.reportConfigUrl,Ne=typeof d.get(D,"privateConf.reportUrl")=="string"?D.privateConf.reportUrl:u.privateConf.reportUrl,ue.reporter=c.initReporter({isDataReportEnable:he,reportConfigUrl:ae,reportUrl:Ne,appKey:D.appKey,logger:ue.logger}),ue.db=D.api.db=new a({logger:D.logger,reporter:ue.reporter,account:D.account,core:ue,notifyError:function(Y){ue.notifyError&&ue.notifyError("DB error",Y)}}),i.call(ue,D)}var y=i.fn,O=k.fn=k.prototype=n(y);O.init=function(){var D,he;y.init.call(this),g.IM.setProtocol(this),this.parser=g.IM,o(D=this.sendCmd).call(D,this),this.socketUrls=[],this.syncing=!0,this.canHandleDeletedMsgInSyncing=!1,this.hasSynced=!1,this.hasSyncedTeamMembers=!1,this.syncPromiseArray=[],this.syncResult={},this.syncTeamMembersPromiseArray=[],this.syncSuperTeamMembersPromiseArray=[],this.syncTeamMembersResult={},this.timetags={},this.superTeamMembersData={},this.saveAck={},this.sysMsgUnread=b.completeUnread({}),this.resetUnsettledMsgs(),this.resetUnsettledSysMsgs(),this.msgPromise=s.resolve(),this.sysMsgPromise=s.resolve(),this.msgDelayArr=[],this.msgDelayTimer=null,this.msgStatEnable=!1,this.nosCdnHostTimer=null,this.relativeServerTime=0,this.sessionSet={},this.msgReceiptTasks={},this.userSet={},this.pushNotificationMultiportConfig=v.getDefaultConfig(),this.msgAckBufferManager=new T({processFn:o(he=this.handleMsgsAck).call(he,this),throttleTime:500})},O.reset=function(){y.reset.call(this);var D=this.options;this.db.reset(D.db),m(D.lbsUrl)&&(D.lbsUrl=u.lbsUrl),this.autoconnect=!!D.autoconnect,this.resetAutoMarkRead()},O.resetAutoMarkRead=function(){var D=this.options;d.verifyBooleanWithDefault(D,"autoMarkRead",!0,"","protocol::resetAutoMarkRead")},O.resetUnsettledMsgs=function(){this.unhandledMsgs=[],this.unupdatedMsgs=[]},O.resetUnsettledSysMsgs=function(){this.unhandledSysMsgs=[],this.unhandledSysMsgsForDeletedMsgs=[],this.unupdatedSysMsgs=[]},O.packetFromSync=function(D){return!D.obj||!!D.obj.sync},t.exports=k,e(780),e(781),e(782),e(802),e(804),e(805),e(806),e(807),e(808),e(809),e(810),e(815),e(816),e(817),e(818),e(822),e(823),e(824),e(825),e(826),e(827)},function(t,r,e){var n=e(28),o=String,s=TypeError;t.exports=function(a){if(n(a))return a;throw s(o(a)+" is not an object")}},function(t,r,e){var n=e(78);t.exports=function(o){if(typeof o=="object"&&"size"in o&&"has"in o&&"get"in o&&"set"in o&&"delete"in o&&"entries"in o)return o;throw TypeError(n(o)+" is not a map")}},function(t,r,e){var n=e(27),o=e(209),s=e(211),a=e(36),i=e(125),u=TypeError,d=Object.defineProperty,c=Object.getOwnPropertyDescriptor;r.f=n?s?function(m,v,g){if(a(m),v=i(v),a(g),typeof m=="function"&&v==="prototype"&&"value"in g&&"writable"in g&&!g.writable){var b=c(m,v);b&&b.writable&&(m[v]=g.value,g={configurable:"configurable"in g?g.configurable:b.configurable,enumerable:"enumerable"in g?g.enumerable:b.enumerable,writable:!1})}return d(m,v,g)}:d:function(m,v,g){if(a(m),v=i(v),a(g),o)try{return d(m,v,g)}catch{}if("get"in g||"set"in g)throw u("Accessors not supported");return"value"in g&&(m[v]=g.value),m}},function(t,r,e){var n=e(18),o=e(73),s=e(35),a=e(13),i=e(828),u=e(147).IM,d=e(154);function c(v){var g=d(v);return this.subType="im",this.nosScene=g.nosScene||"im",this.nosSurvivalTime=g.nosSurvivalTime,g.Protocol=s,g.Message=i,g.constructor=c,this.init(g)}c.Protocol=s,c.parser=u,c.use=o.use,c.getInstance=o.getInstance,c.rmAllInstances=o.rmAllInstances,c.genInstanceName=function(v){return"NIM-account-"+v.account};var m=c.fn=c.prototype=n(o.prototype);c.info=m.info=a.info,t.exports=c,e(839),e(840),e(841),e(842),e(843),e(844),e(845),e(846),e(847),e(857),e(868),e(869),e(870),e(871),e(872),e(873),e(874),e(875),e(876),e(879),e(880)},function(t,r,e){var n=e(18),o=e(2),s=e(26);function a(d,c){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},v=this;v.message=d||m.message||"",s(c)==="object"?(v.event=c,v.code="Other_Error"):c!==void 0&&(v.code=c),v.timetag=+new Date,m!==void 0&&(v.event=m),v.event&&(v.callFunc=v.event.callFunc||null,delete v.event.callFunc)}a.prototype=n(Error.prototype),a.prototype.name="NIMError";var i={201:", sdk",302:", appKeytoken, accounttoken",403:"",404:"(//)",405:"",408:"",414:"",415:"/",416:"",417:"",422:"",500:"",501:"",503:"",508:"",509:"",7101:"",700:"",801:"",802:"",803:"",804:"",805:"",806:"",807:"",809:"",811:"",812:"",813:"",814:"",815:"",816:"",997:"",998:"",999:"",9102:"",9103:"/",11001:", ",13002:"",13003:"",13004:"",13006:",",Connect_Failed:",  ping/telnet ; IE8/9,  HTTPS ",Error_Internet_Disconnected:"",Error_Connection_is_not_Established:"",Error_Connection_Socket_State_not_Match:"socket",Error_Timeout:"",Param_Error:"",No_File_Selected:"",Wrong_File_Type:"",File_Too_Large:"",Cross_Origin_Iframe:"Iframe",Not_Support:"",NO_DB:"",DB:"",Still_In_Team:"",Session_Exist:"",Session_Not_Exist:"",Error_Unknown:"",Operation_Canceled:"",Sync_Error:""},u=[200,406,808,810];o(u).call(u,function(d){i[d]=null}),a.genError=function(d){var c=i[d];return c===void 0&&(c=""),c===null?null:new a(c,d)},a.multiInstance=function(d){return new a("","Not_Allow_Multi_Instance",d)},a.newNetworkError=function(d){var c="Error_Internet_Disconnected";return new a(i[c],c,d)},a.newConnectError=function(d){var c="Connect_Failed";return new a(i[c]||null,c,d)},a.newConnectionError=function(d){var c="Error_Connection_is_not_Established";return new a(i[c],c,d)},a.newSocketStateError=function(d){var c="Error_Connection_Socket_State_not_Match";return new a(i[c],c,d)},a.newTimeoutError=function(d){var c="Error_Timeout";return new a(i[c],c,d)},a.newFrequencyControlError=function(d){var c=new a(i[416],416,d);return c.from="local",c},a.newParamError=function(d,c){return new a(d||i.Param_Error,"Param_Error",c)},a.newNoFileError=function(d,c){var m="No_File_Selected";return new a(d||i[m],m,c)},a.newWrongFileTypeError=function(d,c){var m="Wrong_File_Type";return new a(d||i[m],m,c)},a.newFileTooLargeError=function(d,c){var m="File_Too_Large";return new a(d||i[m],m,c)},a.newCORSIframeError=function(d){var c="Cross_Origin_Iframe";return new a(i[c],c,d)},a.newSupportError=function(d,c,m){return new a(""+d,"Not_Support_"+c,m)},a.newSupportDBError=function(d){return a.newSupportError("","DB",d)},a.noDBError=function(d){return new a(i.NO_DB,"NO_DB",d)},a.newDBError=function(d){return new a(i.DB,"DB",d)},a.newUnknownError=function(d){var c="Error_Unknown";return new a(i[c],c,d)},a.stillInTeamError=function(d){var c="Still_In_Team";return new a(i[c],c,d)},a.sessionExist=function(d){var c="Session_Exist";return new a(i[c],c,d)},a.sessionNotExist=function(d){var c="Session_Not_Exist";return new a(i[c],c,d)},a.cancel=function(d){var c="Operation_Canceled";return new a(i[c],c,d)},a.syncError=function(d){return new a(i.Sync_Error,"Sync_Error",d)},a.customError=function(d,c){d=d||"Other_Error";var m="";return(c=c||{}).message||(m=i[d]||d),s(d)!=="object"?new a(m,d,c):new a(m,"Other_Error",c===void 0?d:c)},t.exports=a},function(t,r,e){t.exports=e(304)},function(t,r,e){var n=e(108),o=Object;t.exports=function(s){return o(n(s))}},function(t,r,e){var n=e(124),o=e(108);t.exports=function(s){return n(o(s))}},function(t,r,e){var n=e(0),o={init:function(){o.deviceId=n.guid()}};o.init(),o.clientTypeMap={1:"Android",2:"iOS",4:"PC",8:"WindowsPhone",16:"Web",32:"Server",64:"Mac"},o.db={open:function(){}},o.rnfs=null,t.exports=o},function(t,r,e){var n=e(323);t.exports=function(o){return n(o.length)}},function(t,r,e){var n=e(34),o=e(19),s=e(36),a=e(78),i=e(234),u=e(45),d=e(21),c=e(235),m=e(136),v=e(236),g=TypeError,b=function(k,y){this.stopped=k,this.result=y},T=b.prototype;t.exports=function(k,y,O){var D,he,ae,Ne,ue,Y,_e,Ce=O&&O.that,ze=!(!O||!O.AS_ENTRIES),ie=!(!O||!O.IS_RECORD),le=!(!O||!O.IS_ITERATOR),Ie=!(!O||!O.INTERRUPTED),pe=n(y,Ce),qe=function(Lt){return D&&v(D,"normal",Lt),new b(!0,Lt)},$e=function(Lt){return ze?(s(Lt),Ie?pe(Lt[0],Lt[1],qe):pe(Lt[0],Lt[1])):Ie?pe(Lt,qe):pe(Lt)};if(ie)D=k.iterator;else if(le)D=k;else{if(!(he=m(k)))throw g(a(k)+" is not iterable");if(i(he)){for(ae=0,Ne=u(k);Ne>ae;ae++)if((ue=$e(k[ae]))&&d(T,ue))return ue;return new b(!1)}D=c(k,he)}for(Y=ie?k.next:D.next;!(_e=o(Y,D)).done;){try{ue=$e(_e.value)}catch(Lt){v(D,"throw",Lt)}if(typeof ue=="object"&&ue&&d(T,ue))return ue}return new b(!1)}},function(t,r,e){t.exports=e(248)},function(t,r){t.exports=!0},function(t,r,e){var n=e(65),o=String;t.exports=function(s){if(n(s)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return o(s)}},function(t,r,e){var n=e(257),o=typeof self=="object"&&self&&self.Object===Object&&self,s=n||o||Function("return this")();t.exports=s},function(t,r,e){var n=e(716);t.exports=function(o,s,a){return a?n(o.entries(),function(i){return s(i[1],i[0])}):o.forEach(s)}},function(t,r,e){t.exports=e(559)},function(t,r,e){var n=e(27),o=e(38),s=e(77);t.exports=n?function(a,i,u){return o.f(a,i,s(1,u))}:function(a,i,u){return a[i]=u,a}},function(t,r,e){(function(n){var o=e(15),s=e(23),a=e(6),i=e(139),u=e(2),d=e(10),c=e(5),m=e(138),v=e(3),g=e(85),b=e(86),T=e(70),k=e(32);function y(kt,er){var cr=b!==void 0&&T(kt)||kt["@@iterator"];if(!cr){if(k(kt)||(cr=function(Ar,Rr){var Cn;if(Ar){if(typeof Ar=="string")return O(Ar,Rr);var Or=o(Cn=Object.prototype.toString.call(Ar)).call(Cn,8,-1);if(Or==="Object"&&Ar.constructor&&(Or=Ar.constructor.name),Or==="Map"||Or==="Set")return g(Ar);if(Or==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Or))return O(Ar,Rr)}}(kt))||er&&kt&&typeof kt.length=="number"){cr&&(kt=cr);var mr=0,vr=function(){};return{s:vr,n:function(){return mr>=kt.length?{done:!0}:{done:!1,value:kt[mr++]}},e:function(Ar){throw Ar},f:vr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Tr,Ir=!0,kr=!1;return{s:function(){cr=cr.call(kt)},n:function(){var Ar=cr.next();return Ir=Ar.done,Ar},e:function(Ar){kr=!0,Tr=Ar},f:function(){try{Ir||cr.return==null||cr.return()}finally{if(kr)throw Tr}}}}function O(kt,er){(er==null||er>kt.length)&&(er=kt.length);for(var cr=0,mr=new Array(er);cr<er;cr++)mr[cr]=kt[cr];return mr}var D=e(154);function he(){return typeof window<"u"?window:n!==void 0?n:typeof self<"u"?self:{}}function ae(kt){var er;return o(er=Object.prototype.toString.call(kt)).call(er,8,-1)}function Ne(kt){return ae(kt).toLowerCase()}function ue(kt){return Ne(kt)==="string"}function Y(kt){return Ne(kt)==="number"}function _e(kt){return Ne(kt)==="array"}function Ce(kt){return typeof kt=="function"}function ze(kt){return Ne(kt)==="date"}function ie(kt){return kt===null}function le(kt){return kt!==null}function Ie(kt){return kt===void 0}function pe(kt){return kt!==void 0}function qe(kt){return pe(kt)&&le(kt)}function $e(kt){return Ie(kt)||ie(kt)}function Lt(kt){return qe(kt)&&Ne(kt)==="object"}var Dt=function(kt,er,cr){kt.addEventListener?kt.addEventListener(er,cr,!1):kt.attachEvent&&kt.attachEvent("on"+er,cr)},dr=Dt,pr=function(kt,er,cr){kt.removeEventListener?kt.removeEventListener(er,cr,!1):kt.detachEvent&&kt.detachEvent("on"+er,cr)},sr=pr;function hr(){var kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},er=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){},cr=arguments.length>2?arguments[2]:void 0;for(var mr in kt)kt.hasOwnProperty(mr)&&er.call(cr,mr,kt[mr])}function Fe(kt,er){hr(er,function(cr,mr){kt[cr]=mr})}var nr,ir=(nr=0,function(){return""+nr++});function Ue(kt){return ue(kt)&&a(kt).call(kt,"{")===0&&i(kt).call(kt,"}")===kt.length-1}function rr(kt,er,cr){if(!kt)return"";var mr=[];return hr(kt,function(vr,Tr){Ce(Tr)||(ze(Tr)?Tr=Tr.getTime():_e(Tr)?Tr=Tr.join(","):Lt(Tr)&&(Tr=d(Tr)),cr&&(Tr=encodeURIComponent(Tr)),mr.push(encodeURIComponent(vr)+"="+Tr))}),mr.join(er||",")}var or,Pt=(or=/^([\w]+?:\/\/.*?(?=\/|$))/i,function(kt){return or.test(kt||"")?RegExp.$1.toLowerCase():""});function Et(kt){var er=he();return kt.tagName&&kt.tagName.toUpperCase()==="INPUT"||er.Blob&&kt instanceof er.Blob}t.exports={o:{},emptyObj:{},f:function(){},emptyFunc:function(){},regBlank:/\s+/gi,regWhiteSpace:/\s+/gi,getGlobal:he,getClass:ae,typeOf:Ne,isString:ue,isNumber:Y,isInt:function(kt){return Y(kt)&&kt%1==0},isBoolean:function(kt){return Ne(kt)==="boolean"},isArray:_e,isFunction:Ce,isDate:ze,isRegExp:function(kt){return Ne(kt)==="regexp"},isError:function(kt){return Ne(kt)==="error"},isnull:ie,notnull:le,undef:Ie,notundef:pe,exist:qe,notexist:$e,isObject:Lt,isEmpty:function(kt){return $e(kt)||(ue(kt)||_e(kt))&&kt.length===0},remove:function(kt){kt.parentNode&&kt.parentNode.removeChild(kt)},dataset:function(kt,er,cr){if(!qe(cr))return kt.getAttribute("data-"+er);kt.setAttribute("data-"+er,cr)},addEventListener:Dt,on:dr,removeEventListener:pr,off:sr,target:function(kt){return kt.target||kt.srcElement},createIframe:function(kt){if(typeof document<"u"){var er;if((kt=kt||{}).name)try{(er=document.createElement('<iframe name="'+kt.name+'"></iframe>')).frameBorder=0}catch{(er=document.createElement("iframe")).name=kt.name}else er=document.createElement("iframe");kt.visible||(er.style.display="none"),Ce(kt.onload)&&dr(er,"load",function mr(vr){er.src&&(kt.multi||sr(er,"load",mr),kt.onload(vr))}),(kt.parent||document.body).appendChild(er);var cr=kt.src||"about:blank";return s(function(){er.src=cr},0),er}},html2node:function(kt){if(typeof document<"u"){var er=document.createElement("div");er.innerHTML=kt;var cr,mr,vr=[];if(er.children)for(cr=0,mr=er.children.length;cr<mr;cr++)vr.push(er.children[cr]);else for(cr=0,mr=er.childNodes.length;cr<mr;cr++){var Tr=er.childNodes[cr];Tr.nodeType===1&&vr.push(Tr)}return vr.length>1?er:vr[0]}},forOwn:hr,mixin:Fe,uniqueID:ir,isJSON:Ue,parseJSON:function kt(er){try{Ue(er)&&(er=JSON.parse(er)),Lt(er)&&hr(er,function(cr,mr){switch(Ne(mr)){case"string":case"object":er[cr]=kt(mr)}})}catch{}return er},simpleClone:function(kt){return D(kt)},merge:function(){for(var kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},er=arguments.length,cr=new Array(er>1?er-1:0),mr=1;mr<er;mr++)cr[mr-1]=arguments[mr];return u(cr).call(cr,function(vr){Fe(kt,vr)}),kt},fillUndef:function(kt,er){return hr(er,function(cr,mr){Ie(kt[cr])&&(kt[cr]=mr)}),kt},checkWithDefault:function(kt,er,cr){var mr=kt[er]||kt[er.toLowerCase()];return $e(mr)&&(mr=cr,kt[er]=mr),mr},fetch:function(kt,er){return hr(kt,function(cr){qe(er[cr])&&(kt[cr]=er[cr])}),kt},string2object:function(){var kt,er=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",cr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",",mr={};return u(kt=er.split(cr)).call(kt,function(vr){var Tr=vr.split("="),Ir=Tr.shift();Ir&&(mr[decodeURIComponent(Ir)]=decodeURIComponent(Tr.join("=")))}),mr},object2string:rr,genUrlSep:function(kt){return a(kt).call(kt,"?")<0?"?":"&"},object2query:function(kt){return rr(kt,"&",!0)},url2origin:Pt,isFileInput:Et,getKeys:function(kt,er){var cr=c(kt);return er&&m(cr).call(cr,function(mr,vr){var Tr=Et(kt[mr]);return Tr===Et(kt[vr])?0:Tr?1:-1}),cr},_get:function(kt,er){var cr,mr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,vr=er.replace(/\[(\d+)\]/g,".$1").split("."),Tr=kt,Ir=y(vr);try{for(Ir.s();!(cr=Ir.n()).done;){var kr=cr.value;if((Tr=Object(Tr)[kr])===void 0)return mr}}catch(Ar){Ir.e(Ar)}finally{Ir.f()}return Tr},getPromiseWithAbort:function(kt){var er={},cr=new v(function(mr,vr){er.abort=vr});return er.promise=v.race([kt,cr]),er}}}).call(this,e(56))},function(t,r,e){var n=e(33),o=e(713),s=n("Map");t.exports={Map:s,set:o("set",2),get:o("get",1),has:o("has",1),remove:o("delete",1),proto:s.prototype}},function(t,r){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch{typeof window=="object"&&(e=window)}t.exports=e},function(t,r,e){t.exports=e(581)},function(t,r,e){var n=e(137),o=e(249);t.exports=function(s,a,i){return(a=o(a))in s?n(s,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[a]=i,s},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(254)},function(t,r,e){t.exports=e(477)},function(t,r,e){t.exports=e(480)},function(t,r,e){t.exports=e(483)},function(t,r,e){var n=e(11),o=n({}.toString),s=n("".slice);t.exports=function(a){return s(o(a),8,-1)}},function(t,r,e){var n=e(33);t.exports=n("navigator","userAgent")||""},function(t,r,e){var n=e(162),o=e(16),s=e(63),a=e(20)("toStringTag"),i=Object,u=s(function(){return arguments}())=="Arguments";t.exports=n?s:function(d){var c,m,v;return d===void 0?"Undefined":d===null?"Null":typeof(m=function(g,b){try{return g[b]}catch{}}(c=i(d),a))=="string"?m:u?s(c):(v=s(c))=="Object"&&o(c.callee)?"Arguments":v}},function(t,r,e){var n=e(53);t.exports=function(o,s,a,i){return i&&i.enumerable?o[s]=a:n(o,s,a),o}},function(t,r,e){e(82);var n=e(357),o=e(14),s=e(65),a=e(53),i=e(99),u=e(20)("toStringTag");for(var d in n){var c=o[d],m=c&&c.prototype;m&&s(m)!==u&&a(m,u,d),i[d]=i.Array}},function(t,r,e){var n=e(31),o=TypeError,s=function(a){var i,u;this.promise=new a(function(d,c){if(i!==void 0||u!==void 0)throw o("Bad Promise constructor");i=d,u=c}),this.resolve=n(i),this.reject=n(u)};t.exports.f=function(a){return new s(a)}},function(t,r,e){t.exports=e(428)},function(t,r,e){t.exports=e(471)},function(t,r,e){var n=e(766);n.fn=n.prototype,t.exports=n,e(768),e(769),e(770),e(771),e(772),e(773),e(774),e(775),e(776),e(777),e(778)},function(t,r,e){var n=e(26),o=e(5),s=e(10),a=e(17),i=e(2),u=e(8),d=e(15),c=e(85),m=e(86),v=e(70),g=e(32);function b(ie,le){var Ie=m!==void 0&&v(ie)||ie["@@iterator"];if(!Ie){if(g(ie)||(Ie=function(dr,pr){var sr;if(dr){if(typeof dr=="string")return T(dr,pr);var hr=d(sr=Object.prototype.toString.call(dr)).call(sr,8,-1);if(hr==="Object"&&dr.constructor&&(hr=dr.constructor.name),hr==="Map"||hr==="Set")return c(dr);if(hr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(hr))return T(dr,pr)}}(ie))||le&&ie&&typeof ie.length=="number"){Ie&&(ie=Ie);var pe=0,qe=function(){};return{s:qe,n:function(){return pe>=ie.length?{done:!0}:{done:!1,value:ie[pe++]}},e:function(dr){throw dr},f:qe}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var $e,Lt=!0,Dt=!1;return{s:function(){Ie=Ie.call(ie)},n:function(){var dr=Ie.next();return Lt=dr.done,dr},e:function(dr){Dt=!0,$e=dr},f:function(){try{Lt||Ie.return==null||Ie.return()}finally{if(Dt)throw $e}}}}function T(ie,le){(le==null||le>ie.length)&&(le=ie.length);for(var Ie=0,pe=new Array(le);Ie<le;Ie++)pe[Ie]=ie[Ie];return pe}var k=e(0),y=k.undef,O=k.notundef,D=k.exist,he=e(193),ae=e(296),Ne={p2p:0,team:1,superTeam:5},ue={0:"p2p",1:"team",5:"superTeam"},Y=o(Ne),_e=ae.typeMap,Ce=ae.validTypes;function ze(ie){k.verifyOptions(ie,"scene to type","msg::Message"),k.verifyParamValid("scene",ie.scene,Y,"msg::Message"),this.scene=Ne[ie.scene],this.to=""+ie.to,this.type=_e[ie.type],this.resend=ie.resend?1:0,ie.resend?(k.verifyOptions(ie,"idClient","msg::Message"),this.idClient=ie.idClient):this.idClient=k.guid(),O(ie.subType)&&(k.isInt(+ie.subType)&&+ie.subType>0?this.subType=+ie.subType:k.onParamError("subType0","msg::Message"));var le=ie.replyMsg;le&&le.idServer&&le.from&&le.to&&le.time&&(this.replyMsgFromAccount=le.from,this.replyMsgToAccount=le.to,this.replyMsgTime=le.time,this.replyMsgIdServer=le.idServer,this.replyMsgIdClient=le.idClient,le.threadMsgFromAccount&&le.threadMsgIdServer&&le.threadMsgTime&&le.threadMsgToAccount?(this.threadMsgFromAccount=le.threadMsgFromAccount,this.threadMsgToAccount=le.threadMsgToAccount,this.threadMsgTime=le.threadMsgTime,this.threadMsgIdServer=le.threadMsgIdServer,this.threadMsgIdClient=le.threadMsgIdClient):(this.threadMsgFromAccount=le.from,this.threadMsgToAccount=le.to,this.threadMsgTime=le.time,this.threadMsgIdServer=le.idServer,this.threadMsgIdClient=le.idClient)),O(ie.text)&&(this.body=""+ie.text),O(ie.custom)&&(n(ie.custom)==="object"?this.custom=s(ie.custom):this.custom=""+ie.custom),O(ie.body)&&(this.body=""+ie.body),O(ie.pushContent)&&(this.pushContent=""+ie.pushContent),O(ie.pushPayload)&&(this.pushPayload=""+ie.pushPayload);var Ie=ie.apns;if(O(Ie)&&ie.scene==="team"){var pe=Ie.accounts;O(pe)&&k.verifyParamType("apns.accounts",pe,"array","msg::Message"),this.apnsAccounts=pe?s(pe):"#%@all@%#",this.apnsContent=Ie.content||ie.pushContent||"",k.verifyBooleanWithDefault(Ie,"forcePush",!0,"options.apns","msg::Message"),this.apnsForcePush=Ie.forcePush?1:0}var qe=ie.robotInfo;O(qe)&&(ie.scene==="team"&&k.verifyOptions(ie.robotInfo,"account","msg::Message::robotInfo scene === team"),qe.function&&(this.robotInfoFunction=qe.function),qe.topic&&(this.robotInfoTopic=qe.topic),qe.customContent&&(this.robotInfoCustomContent=qe.customContent),qe.account&&(this.robotInfoAccount=qe.account)),O(ie.isHistoryable)&&(this.isHistoryable=ie.isHistoryable?1:0),O(ie.isRoamingable)&&(this.isRoamingable=ie.isRoamingable?1:0),O(ie.isSyncable)&&(this.isSyncable=ie.isSyncable?1:0),O(ie.cc)&&(this.cc=ie.cc?1:0),O(ie.env)&&(this.env=ie.env),O(ie.isPushable)&&(this.isPushable=ie.isPushable?1:0),O(ie.isOfflinable)&&(this.isOfflinable=ie.isOfflinable?1:0),O(ie.isUnreadable)&&(this.isUnreadable=ie.isUnreadable?1:0),O(ie.needPushNick)&&(this.needPushNick=ie.needPushNick?1:0),O(ie.needMsgReceipt)&&(this.needMsgReceipt=ie.needMsgReceipt?1:0),O(ie.yidunEnable)&&(this.yidunEnable=ie.yidunEnable?1:0),this.needUpdateSession=ie.needUpdateSession===!1?0:1,O(ie.antiSpamUsingYidun)&&(this.antiSpamUsingYidun=ie.antiSpamUsingYidun?1:0),O(ie.clientAntiSpam)&&(this.clientAntiSpam=ie.clientAntiSpam?1:0),O(ie.antiSpamContent)&&(n(ie.antiSpamContent)==="object"?this.antiSpamContent=s(ie.antiSpamContent):this.antiSpamContent=""+ie.antiSpamContent),O(ie.antiSpamBusinessId)&&(n(ie.antiSpamBusinessId)==="object"?this.antiSpamBusinessId=s(ie.antiSpamBusinessId):this.antiSpamBusinessId=""+ie.antiSpamBusinessId),O(ie.yidunAntiCheating)&&(this.yidunAntiCheating=ie.yidunAntiCheating),O(ie.yidunAntiSpamExt)&&(this.yidunAntiSpamExt=ie.yidunAntiSpamExt)}k.merge(ze.prototype,ae.prototype),ze.prototype.getScene=function(){return ue[this.scene]},ze.getType=ae.getType,ze.setFlow=ae.setFlow,ze.reverse=function(ie){var le,Ie=ue[ie.scene];if(le=ie.delete==="1"?{delete:!0,scene:Ie||ie.scene,from:ie.from,time:+ie.time,to:""+ie.to}:{scene:Ie||ie.scene,from:ie.from,fromNick:ie.fromNick,fromClientType:he.reverseType(ie.fromClientType),fromDeviceId:ie.fromDeviceId,to:""+ie.to,time:+ie.time,type:ze.getType(ie),text:D(ie.body)?ie.body:ie.text||"",isHistoryable:y(ie.isHistoryable)||+ie.isHistoryable==1,isRoamingable:y(ie.isRoamingable)||+ie.isRoamingable==1,isSyncable:y(ie.isSyncable)||+ie.isSyncable==1,cc:y(ie.cc)||+ie.cc==1,isPushable:y(ie.isPushable)||+ie.isPushable==1,isOfflinable:y(ie.isOfflinable)||+ie.isOfflinable==1,isUnreadable:y(ie.isUnreadable)||+ie.isUnreadable==1,isReplyMsg:y(ie.isReplyMsg)||+ie.isReplyMsg==1,needPushNick:y(ie.needPushNick)||+ie.needPushNick==1,needMsgReceipt:+ie.needMsgReceipt==1,isLocal:!1},ie.isInBlackList&&(le.isInBlackList=+ie.isInBlackList==1,le.isInBlackList&&(ie.status="fail")),O(ie.isMuted)&&(le.isMuted=+ie.isMuted==1),O(ie.resend)&&(le.resend=+ie.resend==1),O(ie.idClient)&&(le.idClient=ie.idClient),O(ie.idServer)&&(le.idServer=""+ie.idServer),O(ie.userUpdateTime)&&(le.userUpdateTime=+ie.userUpdateTime),O(ie.custom)&&(le.custom=ie.custom),O(ie.callbackExt)&&(le.callbackExt=ie.callbackExt),O(ie.subType)&&(le.subType=+ie.subType),O(ie.pushContent)&&(le.pushContent=ie.pushContent),O(ie.pushPayload)&&(le.pushPayload=ie.pushPayload),O(ie.tempTeamMemberCount)&&(le.tempTeamMemberCount=+ie.tempTeamMemberCount),O(ie.yidunAntiSpamRes)&&(le.yidunAntiSpamRes=ie.yidunAntiSpamRes),O(ie.apnsAccounts)){if(le.apns={},ie.apnsAccounts!=="#%@all@%#"){var pe=ie.apnsAccounts;try{le.apns.accounts=JSON.parse(pe)}catch{le.apns.accounts=[]}}le.apns.content=ie.apnsContent||"",le.apns.forcePush=+ie.apnsForcePush==1}if(O(ie.robotInfoFunction)&&(le.robotInfo=le.robotInfo||{},ie.robotInfoFunction&&(le.robotInfo.function=ie.robotInfoFunction)),O(ie.robotInfoCustomContent)&&(le.robotInfo=le.robotInfo||{},ie.robotInfoCustomContent&&(le.robotInfo.customContent=ie.robotInfoCustomContent)),O(ie.robotInfoTopic)&&(le.robotInfo=le.robotInfo||{},ie.robotInfoTopic&&(le.robotInfo.topic=ie.robotInfoTopic)),O(ie.robotInfoAccount)&&(le.robotInfo=le.robotInfo||{},ie.robotInfoAccount&&(le.robotInfo.account=ie.robotInfoAccount)),O(ie.needUpdateSession)&&(le.needUpdateSession=+ie.needUpdateSession==1),le.status=ie.status||"success",O(a(ie))&&(le.filter=a(ie)),ie.replyMsgIdServer&&ie.threadMsgIdServer){var qe=["replyMsgFromAccount","replyMsgToAccount","replyMsgTime","replyMsgIdServer","replyMsgIdClient","threadMsgFromAccount","threadMsgToAccount","threadMsgTime","threadMsgIdServer","threadMsgIdClient"];i(qe).call(qe,function($e){le[$e]=ie[$e]}),le.replyMsgTime=+le.replyMsgTime,le.threadMsgTime=+le.threadMsgTime}return le},ze.setExtra=function(ie,le){ie.target=ze.getMsgTarget(ie,le),ie.sessionId=ie.scene+"-"+ie.target,ae.setFlow(ie,le)},ze.getMsgTarget=function(ie,le){return ie.scene==="p2p"?ie.to===le?ie.from:ie.to:ie.scene==="team"||ie.scene==="superTeam"?ie.to:void 0},ze.deduplication=function(ie){var le,Ie,pe={},qe=b(ie);try{for(qe.s();!(Ie=qe.n()).done;){var $e=Ie.value,Lt=pe[$e.idClient];Lt&&Lt.time>$e.time||(pe[$e.idClient]=$e)}}catch(Dt){qe.e(Dt)}finally{qe.f()}return u(le=o(pe)).call(le,function(Dt){return pe[Dt]})},ze.sortMsgs=function(ie){return ie=d(ie).call(ie,0),k.sortObjArray(ie,{sortPath:"time"}),ie},ze.getLastMsg=function(ie){return(ie=ze.sortMsgs(ie))[ie.length-1]},ze.getLastNotIgnoredMsg=function(ie){for(var le=null,Ie=(ie=ze.sortMsgs(ie)).length-1;Ie>=0;Ie--)if(!(le=ie[Ie]).ignore)return le;return null},ze.getMaxTimetag=function(ie){return ze.getLastMsg(ie).time},ze.validScenes=Y,ze.validTypes=Ce,ze.sceneMap=Ne,ze.sceneReverseMap=ue,t.exports=ze},function(t,r,e){var n=e(26),o=e(18),s=e(32),a=e(2),i=e(379),u=e(6),d=e(5),c=e(10),m=e(3),v=e(170),g=e(0),b=g.notundef,T=e(554),k=e(13),y=(e(184),e(44)),O=e(580).wrapSafeCallback,D=e(24).reportAPI,he=e(154);function ae(){}var Ne={};ae.getInstance=function(Ce){Ce=Y(Ce),g.verifyOptions(Ce,"account","api::Base.getInstance");var ze=this.genInstanceName(Ce),ie=Ne[ze];return ie?ae.updateInstance(ie,Ce):ie=Ne[ze]=new this(Ce),ie},ae.updateInstance=function(Ce,ze){Ce.setOptions(ze),Ce.connect()};var ue=ae.fn=ae.prototype=o(new v),Y=function(Ce){return Ce.nosSurvivalTime?(g.verifyParamType("nosSurvivalTime",Ce.nosSurvivalTime,"number","api::Base.getInstance"),g.verifyParamMin("nosSurvivalTime",Ce.nosSurvivalTime,86400,"api::Base.getInstance")):Ce.nosSurvivalTime=1/0,Ce};ue.updatePrivateConf=function(Ce){if(D({instance:this,className:"ApiBaseFn",funcName:"updatePrivateConf",hasCallback:!1}),Ce&&n(Ce.privateConf)==="object"){var ze=Ce.privateConf;typeof ze.lbs_web=="string"&&(Ce.lbsUrl=ze.lbs_web),typeof ze.link_ssl_web=="boolean"&&(Ce.secure=ze.link_ssl_web),typeof ze.https_enabled=="boolean"&&(Ce.httpsEnabled=ze.https_enabled),Ce.uploadUrl=ze.nos_uploader_web?ze.nos_uploader_web:null,Ce.chunkUploadUrl=ze.nos_uploader_web?ze.nos_uploader_web:null,Ce.replaceUrl=ze.nos_downloader?ze.nos_downloader:null,Ce.downloadUrl=ze.nos_accelerate?ze.nos_accelerate:null,Ce.downloadHost=ze.nos_accelerate_host?ze.nos_accelerate_host:null,Ce.downloadHostList=ze.nos_accelerate_host_list||[],Ce.downloadHost&&Ce.downloadHostList.push(Ce.downloadHost),Ce.nosCdnEnable=ze.nos_cdn_enable!==!1,Ce.ntServerAddress=ze.nt_server||null,Ce.kibanaServer=ze.kibana_server,Ce.statisticServer=ze.statistic_server,Ce.reportGlobalServer=ze.report_global_server,Ce.ipVersion=ze.ip_protocol_version||Ce.ipVersion,Ce.defaultLink=ze.link_web||Ce.defaultLink,Ce.ipv6DefaultLink=ze.link_ipv6_web||Ce.ipv6DefaultLink,typeof ze.nos_lbs=="string"?Ce.nosLbsUrls=[ze.nos_lbs]:Ce.nosLbsUrls=[],s(ze.nos_edge_list)&&(Ce.edgeList=ze.nos_edge_list)}return Ce.ntServerAddress===null||Ce.ntServerAddress===""?k.ntServerAddress=null:k.ntServerAddress=Ce.ntServerAddress,k.uploadUrl=Ce.uploadUrl||k.uploadUrl,k.chunkUploadUrl=Ce.chunkUploadUrl||k.chunkUploadUrl,k.downloadUrl=Ce.downloadUrl||k.downloadUrl,k.downloadHost=Ce.downloadHost||k.downloadHost,k.downloadHostList=Ce.downloadHostList&&Ce.downloadHostList.length>0?Ce.downloadHostList:k.downloadHostList,k.nosCdnEnable=Ce.nosCdnEnable!==!1,k.replaceUrl=Ce.replaceUrl||k.replaceUrl,k.httpsEnabled=Ce.httpsEnabled||k.httpsEnabled,Ce.probe_ipv4_url&&(k.ipProbeAddr.ipv4=Ce.probe_ipv4_url),Ce.probe_ipv6_url&&(k.ipProbeAddr.ipv6=Ce.probe_ipv6_url),Ce},ue.init=function(Ce){g.verifyOptions(Ce,"account","api::Base.init"),Ce=this.updatePrivateConf(Ce),g.verifyBooleanWithDefault(Ce,"exifOrientation",!0,"","api::Base.init"),Ce.lbsBackup=Ce.lbsBackup===void 0||Ce.lbsBackup;var ze=this.account=Ce.account=Ce.account+"",ie=Ce.constructor.genInstanceName(Ce),le=Ne[ie];if(Ce._disableSingleton&&(le=null),le)return ae.updateInstance(le,Ce),le;this.logger=Ce.logger=new T({debug:Ce.debug,logFunc:Ce.logFunc,prefix:this.subType,dbLog:Ce.dbLog!==!1,account:Ce.account,expire:Ce.expire,logLevel:Ce.logLevel}),this.options=O(Ce,this),Ce.api=this;var Ie=this.protocol=new Ce.Protocol(Ce);return Ie.name="Protocol-"+ie,Ie.account=ze,Ie.api=this,Ie.message=this.message=new Ce.Message({account:ze}),this.reporter=Ie.reporter,this.statusProtector=Ie.statusProtector,this.reporterHook=Ie.reporterHook,this.abtInfo={},(typeof g.get(Ce,"privateConf.isABTestEnable")=="boolean"?Ce.privateConf.isABTestEnable:k.privateConf.isABTestEnable)&&this.abTestConfigRequset(),this.name=ie,Ne[ie]=this,this},ue.destroy=function(Ce){var ze=this;(Ce=Ce||{}).done=D({instance:this,className:"ApiBaseFn",funcName:"destroy",done:Ce.done});var ie=this;if(!ie.__beginDestroy){var le;ie.__beginDestroy=!0,Ce=Ce||{};var Ie,pe=this.name;if(this.logger.warn("destroy::start"),!pe)return this.logger&&this.logger.warn&&this.logger.warn("destroy::no instanceName"),void(ie.__beginDestroy=void 0);this.protocol&&(le=this.protocol.connectTimer),this.protocol&&this.protocol.resetPush&&this.protocol.resetPush(),this.eventNames&&typeof this.eventNames=="function"&&a(Ie=this.eventNames()).call(Ie,function(qe){delete ze._events[qe]}),this.disconnect({done:function(qe){var $e,Lt,Dt;ie.logger.warn(`ApiBase::destroy: instance destroyed ...

`),ie.__beginDestroy=void 0,ie.reporter.destroy(),ie.statusProtector.destroy(),ie.reporterHook.destroy(),a($e=i(ie.options)).call($e,function(pr){u(pr).call(pr,"on")===0&&(ie.options[pr]=function(){},ie.protocol.options[pr]=function(){},ie.protocol.api.options[pr]=function(){})}),ie.logger.destroy(),n(ie.protocol.sessionSet)==="object"&&a(Lt=d(ie.protocol.sessionSet)).call(Lt,function(pr){ie.protocol.sessionSet[pr].unreadMsgs=[],ie.protocol.sessionSet[pr]=void 0}),ie.protocol.syncResult={},ie.db&&ie.db.close();var dr=ie.protocol;a(Dt=i(ie)).call(Dt,function(pr){ie[pr]=void 0}),Ne&&(Ne[pe]=null,clearTimeout(le)),dr&&(dr.__destroyed=!0),Ce.done instanceof Function&&Ce.done(qe)}})}},ue.setOptions=function(Ce){var ze=he(Ce);ze=O(ze,this),this.protocol.setOptions(ze)},ue.abTestConfigRequset=function(){var Ce=this,ze=Ce.options.abTestUrl||"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",ie={projectKey:"im1_sdk_abtest_web",appKey:Ce.options.appKey,osType:"Web",sdkVersion:Ce.info.version,deviceId:y.deviceId},le=c({clientInfo:ie});this.protocol.adaptersRequest(ze,{method:"POST",timeout:5e3,headers:{"Content-Type":"application/json"},data:le,onload:function(Ie){var pe=JSON.parse(Ie);Ce.abtInfo=pe.data.abtInfo||{},Ce.logger&&Ce.logger.info("abTestConfigRequset::success",Ce.abtInfo)},onerror:function(){Ce.logger&&Ce.logger.info("abTestConfigRequset::fail")}},{exception_service:7})},ue.processCallback=function(Ce,ze){_e(Ce,ze)},ue.processCallbackPromise=function(Ce,ze){return new m(function(ie,le){_e(Ce,ze,!0,ie,le)})};var _e=function(Ce,ze,ie,le,Ie){var pe="api::processCallback";ie&&(pe="api::processCallbackPromise"),g.verifyCallback(Ce,"done",pe),Ce.callback=function(qe,$e,Lt){var Dt=Ce.callback.options;if($e=$e||Dt,ze&&($e=Dt),g.isFunction(Ce.cbaop)){var dr=Ce.cbaop(qe,$e);b(dr)&&($e=dr)}var pr=Ce.done;g.isObject($e)&&(delete $e.done,delete $e.cb,delete $e.callback),ie?qe?Ie({message:"",callFunc:pe,event:qe}):le($e):pr(qe,$e,Lt)},Ce.callback.options=g.copy(Ce)};ue.processPs=function(Ce){g.notexist(Ce.ps)&&(Ce.ps=""),g.verifyArrayMax("ps",Ce.ps,5e3)},ue.processCustom=function(Ce){g.notexist(Ce.custom)&&(Ce.custom="")},ue.sendCmd=function(){this.protocol.sendCmd.apply(this.protocol,arguments)},ue.sendCmdWithResp=function(Ce,ze,ie){this.sendCmd(Ce,ze,function(le,Ie,pe){g.isFunction(ie)&&(le?ie(le,Ie):ie(null,pe))})},ue.cbAndSendCmd=function(Ce,ze){var ie=this.processCallbackPromise(ze);return this.sendCmd(Ce,ze),ie},ue.sendCmdUsePromise=function(Ce,ze){var ie=this,le=D({instance:this,className:"ApiBaseFn",funcName:Ce,hasCallback:!0});return new m(function(Ie,pe){ie.sendCmd(Ce,ze,function(qe,$e,Lt){if(qe)typeof le=="function"&&le(qe),pe(qe);else{var Dt=g.merge({},$e,Lt);typeof le=="function"&&le(void 0),Ie(Dt)}})})},ae.use=function(Ce,ze){Ce&&Ce.install&&g.isFunction(Ce.install)&&Ce.install(this,ze)},ae.rmAllInstances=function(){for(var Ce in Ne)Ne[Ce].destroy();Ne={}},ue.logout=function(){var Ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ce.callback=D({instance:this,className:"ApiBaseFn",funcName:"logout",done:Ce.callback}),Ce=Ce||{},this.protocol.shouldReconnect=!1,this.protocol.doLogout=!0,this.processCallback(Ce),this.sendCmd("logout",Ce,Ce.callback),this.protocol.statusProtector.emit("auth/loginLifeCycleLogout")},t.exports=ae,e(584),e(585),e(627),e(628),e(638),e(642)},function(t,r,e){(function(n){var o=e(15),s=e(6),a=e(302),i=e(52),u=e(26),d=function(){var c=(n===void 0?"undefined":u(n))==="object"?n:window,m=Math.pow(2,53)-1,v=/\bOpera/,g=Object.prototype,b=g.hasOwnProperty,T=g.toString;function k(ue){return(ue=String(ue)).charAt(0).toUpperCase()+o(ue).call(ue,1)}function y(ue){return ue=Ne(ue),/^(?:webOS|i(?:OS|P))/.test(ue)?ue:k(ue)}function O(ue,Y){for(var _e in ue)b.call(ue,_e)&&Y(ue[_e],_e,ue)}function D(ue){var Y;return ue==null?k(ue):o(Y=T.call(ue)).call(Y,8,-1)}function he(ue){return String(ue).replace(/([ -])(?!$)/g,"$1?")}function ae(ue,Y){var _e=null;return function(Ce,ze){var ie=-1,le=Ce?Ce.length:0;if(typeof le=="number"&&le>-1&&le<=m)for(;++ie<le;)ze(Ce[ie],ie,Ce);else O(Ce,ze)}(ue,function(Ce,ze){_e=Y(_e,Ce,ze,ue)}),_e}function Ne(ue){return String(ue).replace(/^ +| +$/g,"")}return function ue(Y){var _e=c,Ce=Y&&u(Y)==="object"&&D(Y)!="String";Ce&&(_e=Y,Y=null);var ze=_e.navigator||{},ie=ze.userAgent||"";Y||(Y=ie);var le,Ie,pe,qe,$e,Lt=Ce?!!ze.likeChrome:/\bChrome\b/.test(Y)&&!/internal|\n/i.test(T.toString()),Dt=Ce?"Object":"ScriptBridgingProxyObject",dr=Ce?"Object":"Environment",pr=Ce&&_e.java?"JavaPackage":D(_e.java),sr=Ce?"Object":"RuntimeObject",hr=/\bJava/.test(pr)&&_e.java,Fe=hr&&D(_e.environment)==dr,nr=hr?"a":"",ir=hr?"b":"",Ue=_e.document||{},rr=_e.operamini||_e.opera,or=v.test(or=Ce&&rr?rr["[[Class]]"]:D(rr))?or:rr=null,Pt=Y,Et=[],kt=null,er=Y==ie,cr=er&&rr&&typeof rr.version=="function"&&rr.version(),mr=ae([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(Pr,Nr){return Pr||RegExp("\\b"+(Nr.pattern||he(Nr))+"\\b","i").exec(Y)&&(Nr.label||Nr)}),vr=function(Pr){return ae(Pr,function(Nr,Qr){return Nr||RegExp("\\b"+(Qr.pattern||he(Qr))+"\\b","i").exec(Y)&&(Qr.label||Qr)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),Tr=Ar([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Ir=function(Pr){return ae(Pr,function(Nr,Qr,hn){return Nr||(Qr[Tr]||Qr[/^[a-z]+(?: +[a-z]+\b)*/i.exec(Tr)]||RegExp("\\b"+he(hn)+"(?:\\b|\\w*\\d)","i").exec(Y))&&hn})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),kr=function(Pr){return ae(Pr,function(Nr,Qr){var hn=Qr.pattern||he(Qr);return!Nr&&(Nr=RegExp("\\b"+hn+"(?:/[\\d.]+|[ \\w.]*)","i").exec(Y))&&(Nr=function(Ur,qr,Gn){var $n={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return qr&&Gn&&/^Win/i.test(Ur)&&!/^Windows Phone /i.test(Ur)&&($n=$n[/[\d.]+$/.exec(Ur)])&&(Ur="Windows "+$n),Ur=String(Ur),qr&&Gn&&(Ur=Ur.replace(RegExp(qr,"i"),Gn)),Ur=y(Ur.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(Nr,hn,Qr.label||Qr)),Nr})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Ar(Pr){return ae(Pr,function(Nr,Qr){var hn=Qr.pattern||he(Qr);return!Nr&&(Nr=RegExp("\\b"+hn+" *\\d+[.\\w_]*","i").exec(Y)||RegExp("\\b"+hn+" *\\w+-[\\w]*","i").exec(Y)||RegExp("\\b"+hn+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(Y))&&((Nr=String(Qr.label&&!RegExp(hn,"i").test(Qr.label)?Qr.label:Nr).split("/"))[1]&&!/[\d.]+/.test(Nr[0])&&(Nr[0]+=" "+Nr[1]),Qr=Qr.label||Qr,Nr=y(Nr[0].replace(RegExp(hn,"i"),Qr).replace(RegExp("; *(?:"+Qr+"[_-])?","i")," ").replace(RegExp("("+Qr+")[-_.]?(\\w)","i"),"$1 $2"))),Nr})}if(mr&&(mr=[mr]),Ir&&!Tr&&(Tr=Ar([Ir])),(le=/\bGoogle TV\b/.exec(Tr))&&(Tr=le[0]),/\bSimulator\b/i.test(Y)&&(Tr=(Tr?Tr+" ":"")+"Simulator"),vr=="Opera Mini"&&/\bOPiOS\b/.test(Y)&&Et.push("running in Turbo/Uncompressed mode"),vr=="IE"&&/\blike iPhone OS\b/.test(Y)?(Ir=(le=ue(Y.replace(/like iPhone OS/,""))).manufacturer,Tr=le.product):/^iP/.test(Tr)?(vr||(vr="Safari"),kr="iOS"+((le=/ OS ([\d_]+)/i.exec(Y))?" "+le[1].replace(/_/g,"."):"")):vr!="Konqueror"||/buntu/i.test(kr)?Ir&&Ir!="Google"&&(/Chrome/.test(vr)&&!/\bMobile Safari\b/i.test(Y)||/\bVita\b/.test(Tr))||/\bAndroid\b/.test(kr)&&/^Chrome/.test(vr)&&/\bVersion\//i.test(Y)?(vr="Android Browser",kr=/\bAndroid\b/.test(kr)?kr:"Android"):vr=="Silk"?(/\bMobi/i.test(Y)||(kr="Android",Et.unshift("desktop mode")),/Accelerated *= *true/i.test(Y)&&Et.unshift("accelerated")):vr=="PaleMoon"&&(le=/\bFirefox\/([\d.]+)\b/.exec(Y))?Et.push("identifying as Firefox "+le[1]):vr=="Firefox"&&(le=/\b(Mobile|Tablet|TV)\b/i.exec(Y))?(kr||(kr="Firefox OS"),Tr||(Tr=le[1])):!vr||(le=!/\bMinefield\b/i.test(Y)&&/\b(?:Firefox|Safari)\b/.exec(vr))?(vr&&!Tr&&/[\/,]|^[^(]+?\)/.test(o(Y).call(Y,s(Y).call(Y,le+"/")+8))&&(vr=null),(le=Tr||Ir||kr)&&(Tr||Ir||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(kr))&&(vr=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(kr)?kr:le)+" Browser")):vr=="Electron"&&(le=(/\bChrome\/([\d.]+)\b/.exec(Y)||0)[1])&&Et.push("Chromium "+le):kr="Kubuntu",cr||(cr=ae(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version","HeadlessChrome",he(vr),"(?:Firefox|Minefield|NetFront)"],function(Pr,Nr){return Pr||(RegExp(Nr+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(Y)||0)[1]||null})),(le=(mr=="iCab"&&a(cr)>3?"WebKit":/\bOpera\b/.test(vr)&&(/\bOPR\b/.test(Y)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(Y)&&!/^(?:Trident|EdgeHTML)$/.test(mr)&&"WebKit"||!mr&&/\bMSIE\b/i.test(Y)&&(kr=="Mac OS"?"Tasman":"Trident")||mr=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(vr)&&"NetFront")&&(mr=[le]),vr=="IE"&&(le=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(Y)||0)[1])?(vr+=" Mobile",kr="Windows Phone "+(/\+$/.test(le)?le:le+".x"),Et.unshift("desktop mode")):/\bWPDesktop\b/i.test(Y)?(vr="IE Mobile",kr="Windows Phone 8.x",Et.unshift("desktop mode"),cr||(cr=(/\brv:([\d.]+)/.exec(Y)||0)[1])):vr!="IE"&&mr=="Trident"&&(le=/\brv:([\d.]+)/.exec(Y))&&(vr&&Et.push("identifying as "+vr+(cr?" "+cr:"")),vr="IE",cr=le[1]),er){if(qe="global",$e=(pe=_e)!=null?u(pe[qe]):"number",/^(?:boolean|number|string|undefined)$/.test($e)||$e=="object"&&!pe[qe])D(le=_e.runtime)==Dt?(vr="Adobe AIR",kr=le.flash.system.Capabilities.os):D(le=_e.phantom)==sr?(vr="PhantomJS",cr=(le=le.version||null)&&le.major+"."+le.minor+"."+le.patch):typeof Ue.documentMode=="number"&&(le=/\bTrident\/(\d+)/i.exec(Y))?(cr=[cr,Ue.documentMode],(le=+le[1]+4)!=cr[1]&&(Et.push("IE "+cr[1]+" mode"),mr&&(mr[1]=""),cr[1]=le),cr=vr=="IE"?String(cr[1].toFixed(1)):cr[0]):typeof Ue.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(vr)&&(Et.push("masking as "+vr+" "+cr),vr="IE",cr="11.0",mr=["Trident"],kr="Windows");else if(hr&&(Pt=(le=hr.lang.System).getProperty("os.arch"),kr=kr||le.getProperty("os.name")+" "+le.getProperty("os.version")),Fe){try{cr=_e.require("ringo/engine").version.join("."),vr="RingoJS"}catch{(le=_e.system)&&le.global.system==_e.system&&(vr="Narwhal",kr||(kr=le[0].os||null))}vr||(vr="Rhino")}else u(_e.process)==="object"&&!_e.process.browser&&(le=_e.process)&&(u(le.versions)==="object"&&(typeof le.versions.electron=="string"?(Et.push("Node "+le.versions.node),vr="Electron",cr=le.versions.electron):typeof le.versions.nw=="string"&&(Et.push("Chromium "+cr,"Node "+le.versions.node),vr="NW.js",cr=le.versions.nw)),vr||(vr="Node.js",Pt=le.arch,kr=le.platform,cr=(cr=/[\d.]+/.exec(le.version))?cr[0]:null));kr=kr&&y(kr)}if(cr&&(le=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(cr)||/(?:alpha|beta)(?: ?\d)?/i.exec(Y+";"+(er&&ze.appMinorVersion))||/\bMinefield\b/i.test(Y)&&"a")&&(kt=/b/i.test(le)?"beta":"alpha",cr=cr.replace(RegExp(le+"\\+?$"),"")+(kt=="beta"?ir:nr)+(/\d+\+?/.exec(le)||"")),vr=="Fennec"||vr=="Firefox"&&/\b(?:Android|Firefox OS)\b/.test(kr))vr="Firefox Mobile";else if(vr=="Maxthon"&&cr)cr=cr.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(Tr))Tr=="Xbox 360"&&(kr=null),Tr=="Xbox 360"&&/\bIEMobile\b/.test(Y)&&Et.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(vr)&&(!vr||Tr||/Browser|Mobi/.test(vr))||kr!="Windows CE"&&!/Mobi/i.test(Y))if(vr=="IE"&&er)try{_e.external===null&&Et.unshift("platform preview")}catch{Et.unshift("embedded")}else(/\bBlackBerry\b/.test(Tr)||/\bBB10\b/.test(Y))&&(le=(RegExp(Tr.replace(/ +/g," *")+"/([.\\d]+)","i").exec(Y)||0)[1]||cr)?(kr=((le=[le,/BB10/.test(Y)])[1]?(Tr=null,Ir="BlackBerry"):"Device Software")+" "+le[0],cr=null):this!=O&&Tr!="Wii"&&(er&&rr||/Opera/.test(vr)&&/\b(?:MSIE|Firefox)\b/i.test(Y)||vr=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(kr)||vr=="IE"&&(kr&&!/^Win/.test(kr)&&cr>5.5||/\bWindows XP\b/.test(kr)&&cr>8||cr==8&&!/\bTrident\b/.test(Y)))&&!v.test(le=ue.call(O,Y.replace(v,"")+";"))&&le.name&&(le="ing as "+le.name+((le=le.version)?" "+le:""),v.test(vr)?(/\bIE\b/.test(le)&&kr=="Mac OS"&&(kr=null),le="identify"+le):(le="mask"+le,vr=or?y(or.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(le)&&(kr=null),er||(cr=null)),mr=["Presto"],Et.push(le));else vr+=" Mobile";if(le=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(Y)||0)[1]){var Rr,Cn;le=[a(le.replace(/\.(\d)$/,".0$1")),le],vr=="Safari"&&o(Rr=le[1]).call(Rr,-1)=="+"?(vr="WebKit Nightly",kt="alpha",cr=o(Cn=le[1]).call(Cn,0,-1)):cr!=le[1]&&cr!=(le[2]=(/\bSafari\/([\d.]+\+?)/i.exec(Y)||0)[1])||(cr=null),le[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(Y)||0)[1],le[0]==537.36&&le[2]==537.36&&a(le[1])>=28&&mr=="WebKit"&&(mr=["Blink"]),er&&(Lt||le[1])?(mr&&(mr[1]="like Chrome"),le=le[1]||((le=le[0])<530?1:le<532?2:le<532.05?3:le<533?4:le<534.03?5:le<534.07?6:le<534.1?7:le<534.13?8:le<534.16?9:le<534.24?10:le<534.3?11:le<535.01?12:le<535.02?"13+":le<535.07?15:le<535.11?16:le<535.19?17:le<536.05?18:le<536.1?19:le<537.01?20:le<537.11?"21+":le<537.13?23:le<537.18?24:le<537.24?25:le<537.36?26:mr!="Blink"?"27":"28")):(mr&&(mr[1]="like Safari"),le=(le=le[0])<400?1:le<500?2:le<526?3:le<533?4:le<534?"4+":le<535?5:le<537?6:le<538?7:le<601?8:"8"),mr&&(mr[1]+=" "+(le+=typeof le=="number"?".x":/[.+]/.test(le)?"":"+")),vr=="Safari"&&(!cr||i(cr)>45)&&(cr=le)}vr=="Opera"&&(le=/\bzbov|zvav$/.exec(kr))?(vr+=" ",Et.unshift("desktop mode"),le=="zvav"?(vr+="Mini",cr=null):vr+="Mobile",kr=kr.replace(RegExp(" *"+le+"$"),"")):vr=="Safari"&&/\bChrome\b/.exec(mr&&mr[1])&&(Et.unshift("desktop mode"),vr="Chrome Mobile",cr=null,/\bOS X\b/.test(kr)?(Ir="Apple",kr="iOS 4.3+"):kr=null),cr&&s(cr).call(cr,le=/[\d.]+$/.exec(kr))==0&&s(Y).call(Y,"/"+le+"-")>-1&&(kr=Ne(kr.replace(le,""))),mr&&!/\b(?:Avant|Nook)\b/.test(vr)&&(/Browser|Lunascape|Maxthon/.test(vr)||vr!="Safari"&&/^iOS/.test(kr)&&/\bSafari\b/.test(mr[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(vr)&&mr[1])&&(le=mr[mr.length-1])&&Et.push(le),Et.length&&(Et=["("+Et.join("; ")+")"]),Ir&&Tr&&s(Tr).call(Tr,Ir)<0&&Et.push("on "+Ir),Tr&&Et.push((/^on /.test(Et[Et.length-1])?"":"on ")+Tr),kr&&(le=/ ([\d.+]+)$/.exec(kr),Ie=le&&kr.charAt(kr.length-le[0].length-1)=="/",kr={architecture:32,family:le&&!Ie?kr.replace(le[0],""):kr,version:le?le[1]:null,toString:function(){var Pr=this.version;return this.family+(Pr&&!Ie?" "+Pr:"")+(this.architecture==64?" 64-bit":"")}}),(le=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Pt))&&!/\bi686\b/i.test(Pt)?(kr&&(kr.architecture=64,kr.family=kr.family.replace(RegExp(" *"+le),"")),vr&&(/\bWOW64\b/i.test(Y)||er&&/\w(?:86|32)$/.test(ze.cpuClass||ze.platform)&&!/\bWin64; x64\b/i.test(Y))&&Et.unshift("32-bit")):kr&&/^OS X/.test(kr.family)&&vr=="Chrome"&&a(cr)>=39&&(kr.architecture=64),Y||(Y=null);var Or={};return Or.description=Y,Or.layout=mr&&mr[0],Or.manufacturer=Ir,Or.name=vr,Or.prerelease=kt,Or.product=Tr,Or.ua=Y,Or.version=vr&&cr,Or.os=kr||{architecture:null,family:null,version:null,toString:function(){return"null"}},Or.parse=ue,Or.toString=function(){return this.description||""},Or.version&&Et.unshift(cr),Or.name&&Et.unshift(vr),kr&&vr&&(kr!=String(kr).split(" ")[0]||kr!=vr.split(" ")[0]&&!Tr)&&Et.push(Tr?"("+kr+")":"on "+kr),Et.length&&(Or.description=Et.join(" ")),Or}()}();t.exports=d}).call(this,e(56))},function(t,r,e){var n=e(87),o=e(32),s=e(5),a=e(17),i=e(201),u=e(6),d=e(69),c=e(7),m=e(2),v=e(10),g=e(23),b=e(57),T=e(25),k=e(0),y=k.undef,O=e(13),D=e(40),he=e(155),ae=he.StatusProtector,Ne=(he.V2NIMLoginStatus,e(105)),ue=Ne.ReporterHook,Y=Ne.EMSyncType,_e=e(643),Ce=e(644);function ze(le){k.undef(le.secure)&&(le.secure=!0),this.options=le,this.keepNosSafeUrl=this.options.keepNosSafeUrl||!1;var Ie=le.defaultLink||le.defaultLinkUrl;k.notundef(Ie)&&k.isString(Ie)&&(O.optionDefaultLinkUrl=n(Ie).call(Ie)),k.notundef(le.ipv6DefaultLink)&&k.isString(le.ipv6DefaultLink)&&(O.optionIpv6DefaultLinkUrl=le.ipv6DefaultLink),typeof le.heartbeatInterval=="number"&&(O.heartbeatInterval=le.heartbeatInterval),o(le.nosLbsUrls)&&(O.nosLbsUrls=le.nosLbsUrls);var pe=this.options.socketConcurrent;pe=typeof pe=="number"&&pe>=1&&pe<=3?pe:1,this.options.socketConcurrent=pe,this.options.rollbackDelMsgUnread!==void 0&&typeof this.options.rollbackDelMsgUnread=="boolean"||(this.options.rollbackDelMsgUnread=!0),this.init(),this.connect()}var ie=ze.fn=ze.prototype;ie.init=function(){var le=this;this.logger=this.options.logger,this.getNosOriginUrlReqNum=0,this.checkNosReqNum=0,this.cmdTaskArray=[],this.timerMap={},this.cmdCallbackMap={},this.cmdContentMap={},this.initConnect(),this.reset(),this.statusProtector=new ae(this),this.reporterHook=new ue(this,this.options.reporterHookConfig),this.promiseAbortManager=new _e,this.imsocket=new Ce(this,{socketConcurrent:this.options.socketConcurrent}),this.statusProtector.on("auth/loginLifeCycleLogout",function(){le.promiseAbortManager.clear()}),this.statusProtector.on("auth/loginLifeCycleLoginSucc",function(){le.reporterHook.reset(),le.reporterHook.setOriginTimetick()})},ie.reset=function(){y(this.options.thumbnailToStatic)&&(this.options.thumbnailToStatic=!0),this.resetConnect()},ie.setOptions=function(le){var Ie=this.options,pe=s(Ie),qe=s(le),$e=["onconnect","onerror","onwillreconnect","ondisconnect","onloginportschange","onmyinfo","onblacklist","onmutelist","onfriends","onusers","onrobots","onteams","onSuperTeams","onsessions","onSessionsWithMoreRoaming","onStickTopSessions","onroamingmsgs","onofflinemsgs","onofflinefiltermsgs","onroamingsysmsgs","onofflinesysmsgs","onofflinefiltersysmsgs","onofflinecustomsysmsgs","onofflinefiltercustomsysmsgs","onbroadcastmsg","onbroadcastmsgs","onsysmsgunread","onsyncdone","onteammembers","onsyncteammembersdone","onmsg","onsysmsg","oncustomsysmsg","onupdatemyinfo","onupdateuser","onSyncUpdateServerSession","onUpdateSuperTeamMember","onMySuperTeamMembers","onCreateSuperTeam","onUpdateSuperTeam","onAddSuperTeamMembers","onRemoveSuperTeamMembers","onUpdateSuperTeamManagers","onDismissSuperTeam","onTransferSuperTeam","onUpdateSuperTeamMembersMute","onupdateteammember","onMyTeamMembers","onMsgReceipts","onCreateTeam","onUpdateTeam","onAddTeamMembers","onRemoveTeamMembers","onUpdateTeamManagers","onDismissTeam","onTransferTeam","onUpdateTeamMembersMute","onTeamMsgReceipt","onupdatesession","onQuickComment","onDeleteQuickComment","onPinMsgChange","onupdatesysmsgunread","onupdatesysmsg","onsynccreateteam","onsyncsupercreateteam","onsyncmarkinblacklist","onsyncmarkinmutelist","onsyncfriendaction","shouldIgnoreNotification","shouldIgnoreMsg","onDeleteMsgSelf","shouldCountNotifyUnread","onPushNotificationMultiportConfig","onPushNotificationMultiportConfigUpdate","onpushevents"],Lt=a(qe).call(qe,function(dr){return i($e).call($e,dr)}),Dt=u(pe).call(pe,"account");k.verifyCallback(le,Lt,"protocol::IMProtocol"),this.logger.info("setOptions::",k.omitAsString(le,["appKey","token","loginExt","customTag"])),Dt!==-1&&d(pe).call(pe,Dt,1),le=k.filterObj(le,pe),this.options=k.merge(Ie,le),this.reset()},ie.sendCmd=function(le){var Ie,pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",qe=arguments.length>2?arguments[2]:void 0,$e=this;$e.heartbeat();var Lt,Dt=le,dr=(le=$e.parser.createCmd(le,pe)).SER;pe=pe||{},$e.cmdContentMap[dr]=pe,pe.single&&(delete pe.single,(Lt=s(pe)).length===1&&($e.cmdContentMap[dr]=pe[Lt[0]])),pe.__exceptionInfo={target:c(Ie="".concat(le.SID,"-")).call(Ie,le.CID),context:dr,startTime:$e.reporterHook.getSafeClock()},pe.NOTSTORE&&(Lt=pe.NOTSTORE.split(" "),m(Lt).call(Lt,function(pr){delete pe[pr]}),delete pe.NOTSTORE),(qe=qe||pe.callback)&&($e.cmdCallbackMap[dr]=qe),$e.cmdTaskArray.push({cmdName:Dt,cmd:v(le)}),$e.startCmdTaskTimer()},ie.startCmdTaskTimer=function(){var le=this;le.cmdTaskTimer||(le.cmdTaskTimer=g(function(){var Ie=le.cmdTaskArray.shift();le.cmdTaskTimer=null,Ie&&le.executeCmdTask(Ie),le.cmdTaskArray.length&&le.startCmdTaskTimer()},0))},ie.executeCmdTask=function(le){var Ie=le.cmdName,pe=le.cmd,qe=(pe=JSON.parse(pe)).SER;this.isFrequencyControlled(Ie)?(this.logger.warn("protocol::executeCmdTask: ".concat(Ie," hit freq control")),this.markCallbackInvalid(qe,D.newFrequencyControlError({callFunc:"protocol::executeCmdTask",message:"".concat(Ie," hit freq control")}))):this.hasLogin?(Ie!=="heartbeat"&&(this.logger.debugEnable?this.logger.debug("protocol::sendCmd: ".concat(le.cmd)):this.logger.info("protocol::sendCmd: ".concat(Ie))),this.doSendCmd(pe)):Ie==="login"&&this.isConnected()?(this.logger.debugEnable?this.logger.debug("protocol::sendCmd: ".concat(le.cmd)):this.logger.info("protocol::sendCmd: ".concat(Ie)),this.doSendCmd(pe)):(this.logger.warn("protocol::executeCmdTask: ".concat(Ie," not connected or login")),this.markCallbackInvalid(qe,D.newSocketStateError({callFunc:"protocol::executeCmdTask",message:"".concat(Ie," not connected or not login")})))},ie.isFrequencyControlled=function(le){var Ie=this.frequencyControlMap&&this.frequencyControlMap[le];if(Ie){if(b()<Ie.from+Ie.duration)return!0;delete this.frequencyControlMap[le]}},ie.doSendCmd=function(le){var Ie=this,pe=le.SER,qe=pe===0?O.hbCmdTimeout:O.cmdTimeout,$e=new Date().getTime(),Lt=Ie.cmdContentMap[pe];function Dt(){Ie.markCallbackInvalid(pe,D.newSocketStateError({callFunc:"protocol::doSendCmd",message:"ser ".concat(pe," socketSendJson Error")})),Ie.onDisconnect("protocol::doSendCmd:socketSendJson","broken")}Lt&&Lt.__exceptionInfo&&(Lt.__exceptionInfo.startTime=b()),le.isAwaitable&&(Ie.timerMap[pe]=g(function(){var dr;Ie.markCallbackInvalid(pe,D.newTimeoutError({callFunc:"protocol::doSendCmd",message:"ser ".concat(pe," Timeout Error")})),Ie.reporter.reportTraceStart("exceptions",{user_id:k.get(Ie,"options.account")||"",trace_id:k.get(Ie,"socket.socket.sessionid"),start_time:$e,action:2,exception_service:6}),Ie.reporter.reportTraceUpdateV2("exceptions",{code:408,description:"Packet timeout",operation_type:1,target:c(dr="".concat(le.SID,"-")).call(dr,le.CID),context:"".concat(le.SER),net_connect:Ie.checkNetworkAvailable()}),Ie.reporter.reportTraceEnd("exceptions",1)},qe));try{Ie.socket&&Ie.socket.send?Ie.socket.send(v(le)):Dt()}catch{Dt()}},ie.getObjWithSer=function(le){var Ie=this.cmdContentMap[le];return Ie&&!Ie.isImSyncDataObj&&delete this.cmdContentMap[le],Ie&&k.copy(Ie)},ie.getCallbackWithSer=function(le){var Ie=this.cmdCallbackMap[le];return Ie&&!Ie.isImSyncDataCb&&delete this.cmdCallbackMap[le],Ie},ie.getTimerWithSer=function(le){var Ie=this.timerMap[le];return delete this.timerMap[le],Ie},ie.clearTimerWithSer=function(le){var Ie=this.getTimerWithSer(le);Ie&&clearTimeout(Ie)},ie.markCallbackInvalid=function(le,Ie){this.getObjWithSer(le),this.clearTimerWithSer(le);var pe=this.getCallbackWithSer(le);if(pe){var qe=pe.options;g(function(){pe(Ie||D.newUnknownError({ser:le}),qe)},0)}},ie.markAllCallbackInvalid=function(le){var Ie,pe,qe=this;m(Ie=s(this.cmdCallbackMap)).call(Ie,function($e){var Lt=qe.getObjWithSer($e);if(Lt.__exceptionInfo){var Dt=Lt.__exceptionInfo.target,dr=Lt.__exceptionInfo.context,pr=k.get(le,"event.uploadCode")||le&&le.code;pr=typeof pr!="number"?415:pr;var sr=k.get(le,"event.disconnectReason"),hr=sr?v({disconnect_reason:sr}):le&&le.message||"send cmd failed";qe.reporter.reportTraceStart("exceptions",{user_id:k.get(qe,"options.account")||"",trace_id:k.get(qe,"socket.socket.sessionid"),start_time:qe.reporterHook.getNTPTime(Lt.__exceptionInfo.startTime),action:2,exception_service:6}),qe.reporter.reportTraceUpdateV2("exceptions",{code:pr,description:hr,operation_type:1,target:Dt,context:dr,net_connect:qe.checkNetworkAvailable()}),qe.reporter.reportTraceEnd("exceptions",1),delete Lt.__exceptionInfo}}),m(pe=s(this.cmdCallbackMap)).call(pe,function($e){qe.markCallbackInvalid($e,le)}),qe.cmdTaskArray=[]},ie.getPacketObj=function(le){var Ie=null;if(le&&le.raw){var pe=le.raw.ser;k.notundef(pe)&&(Ie=this.getObjWithSer(pe))}return Ie},ie.callPacketAckCallback=function(le){var Ie=this;if(le&&le.raw){var pe=le.raw.ser;if(k.notundef(pe)){Ie.clearTimerWithSer(pe);var qe=Ie.getCallbackWithSer(pe);if(qe){var $e;qe.originUrl&&le.obj&&le.obj.file&&(le.obj.file._url_safe=le.obj.file.url,le.obj.file.url=qe.originUrl,le.obj.type==="audio"&&(le.obj.file.mp3Url=qe.originUrl+(~u($e=qe.originUrl).call($e,"?")?"&":"?")+"audioTrans&type=mp3")),le.promise?le.promise.then(function(){qe(le.error,le.obj)},function(Lt){var Dt,dr;Lt.callFunc="protocol::callPacketAckCallback",Lt.message=c(Dt=c(dr="Resp Promoise Error: cmd: ".concat(le.cmd,", ser: ")).call(dr,pe,", reason: ")).call(Dt,Lt.message);var pr=D.customError("CALLBACK_ACK_ERR",Lt);Ie.logger.error(`protocol::callPacketAckCallback error stack: 
`.concat(Lt.stack||Lt.event&&Lt.event.stack)),qe(pr,le.obj,le.content)}):qe(le.error,le.obj,le.content)}}}},ie.onMessage=function(le){var Ie=this;Ie.heartbeat(),Ie.parser.parseResponse(le).then(function(pe){var qe;if(pe.notFound&&Ie.logger.warn("protocol::onMessage: packet not found ".concat(v(pe))),pe.error){var $e,Lt;pe.error.message=c($e="".concat(pe.cmd," error: ")).call($e,pe.error.message),Ie.logger.error(c(Lt="protocol::onMessage: packet error ".concat(v(pe.error),"raw cmd ")).call(Lt,pe.rawStr));var Dt=pe.raw||{};Dt.code!==408&&Dt.code!==415&&Dt.code!==500||Ie.reporter.report("nimErrEvent",{code:Dt.code,module:pe.cmd,accid:Ie.account})}pe.__receiveTime=Ie.reporterHook.getSafeClock();var dr=Y[c(qe="kSyncType".concat(pe.raw.sid,"_")).call(qe,pe.raw.cid)];if(dr){var pr=k.get(pe,"raw.r"),sr=1;if(pr&&pr.length>0){var hr=a(pr).call(pr,function(Pt){return o(Pt)}),Fe=k.get(hr,"0.length");sr=typeof Fe=="number"?Fe:1}Ie.reporterHook.emit("reporter/syncItem",dr,sr)}pe.frequencyControlDuration&&(Ie.logger.error("protocol::onMessage: server freq control ".concat(v(pe.cmd))),Ie.frequencyControlMap=Ie.frequencyControlMap||{},Ie.frequencyControlMap[pe.cmd]={from:+new Date,duration:pe.frequencyControlDuration}),pe.obj=Ie.getPacketObj(pe),pe.obj&&pe.obj.__exceptionInfo&&delete pe.obj.__exceptionInfo,pe.cmd!=="heartbeat"&&(Ie.logger.debugEnable?Ie.logger.debug("protocol::recvCmd: ".concat(pe.rawStr)):Ie.logger.log("protocol::recvCmd: ".concat(pe.cmd)));var nr="process"+k.capFirstLetter(pe.service);if(Ie[nr])if(pe.cmd==="syncDone"){if(Ie.cmdCallbackMap[pe.raw.ser]&&Ie.cmdCallbackMap[pe.raw.ser].isImSyncDataCb){var ir;Ie.cmdCallbackMap[pe.raw.ser].isImSyncDataCb=!1;var Ue=T(ir=function(Pt,Et){this.checkNosReqNum++,this.getNosOriginUrlReqNum<=0||this.checkNosReqNum>=20?this[Pt](Et):g(Ue,300)}).call(ir,Ie,nr,pe);g(function(){Ue.call(Ie,nr,pe)},10)}}else try{Ie[nr](pe)}catch(Pt){var rr,or;Ie.logger.warn(c(rr=c(or="protocol::onMessage: ".concat(nr,".")).call(or,pe.cmd," excute failed ")).call(rr,pe.obj?"":", maybe the packet timed out",": "),Pt.message)}else Ie.logger.warn("protocol::onMessage: ".concat(nr," not found"));Ie.callPacketAckCallback(pe)})},ie.onMiscError=function(le,Ie,pe){Ie&&this.notifyError(le,Ie,pe)},ie.onCustomError=function(le,Ie){var pe=D.customError(le,Ie),qe=Ie.message||"";this.onMiscError(qe,pe)},ie.notifyError=function(le,Ie,pe){var qe;this.isConnected()&&(this.logger.error(c(qe="".concat(le||""," ")).call(qe,this.name),Ie,pe),this.options.onerror(Ie,pe))},ie.emitAPI=function(le){var Ie=le.type,pe=le.obj;this.api.emit(Ie,pe)},t.exports=ze,e(664),e(680),e(681),e(682),e(683),e(684)},function(t,r,e){var n=e(107),o=Function.prototype,s=o.apply,a=o.call;t.exports=typeof Reflect=="object"&&Reflect.apply||(n?a.bind(s):function(){return a.apply(s,arguments)})},function(t,r){t.exports=function(e,n){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:n}}},function(t,r){var e=String;t.exports=function(n){try{return e(n)}catch{return"Object"}}},function(t,r,e){var n=e(63);t.exports=Array.isArray||function(o){return n(o)=="Array"}},function(t,r,e){var n,o=e(36),s=e(163),a=e(164),i=e(112),u=e(217),d=e(159),c=e(130),m=c("IE_PROTO"),v=function(){},g=function(k){return"<script>"+k+"<\/script>"},b=function(k){k.write(g("")),k.close();var y=k.parentWindow.Object;return k=null,y},T=function(){try{n=new ActiveXObject("htmlfile")}catch{}var k,y;T=typeof document<"u"?document.domain&&n?b(n):((y=d("iframe")).style.display="none",u.appendChild(y),y.src="javascript:",(k=y.contentWindow.document).open(),k.write(g("document.F=Object")),k.close(),k.F):b(n);for(var O=a.length;O--;)delete T.prototype[a[O]];return T()};i[m]=!0,t.exports=Object.create||function(k,y){var O;return k!==null?(v.prototype=o(k),O=new v,v.prototype=null,O[m]=k):O=T(),y===void 0?O:s.f(O,y)}},function(t,r,e){var n=e(162),o=e(38).f,s=e(53),a=e(29),i=e(335),u=e(20)("toStringTag");t.exports=function(d,c,m,v){if(d){var g=m?d:d.prototype;a(g,u)||o(g,u,{configurable:!0,value:c}),v&&!n&&s(g,"toString",i)}}},function(t,r,e){var n=e(43),o=e(196),s=e(99),a=e(97),i=e(38).f,u=e(166),d=e(167),c=e(48),m=e(27),v=a.set,g=a.getterFor("Array Iterator");t.exports=u(Array,"Array",function(T,k){v(this,{type:"Array Iterator",target:n(T),index:0,kind:k})},function(){var T=g(this),k=T.target,y=T.kind,O=T.index++;return!k||O>=k.length?(T.target=void 0,d(void 0,!0)):d(y=="keys"?O:y=="values"?k[O]:[O,k[O]],!1)},"values");var b=s.Arguments=s.Array;if(o("keys"),o("values"),o("entries"),!c&&m&&b.name!=="values")try{i(b,"name",{value:"values"})}catch{}},function(t,r,e){var n=e(499),o=e(504);t.exports=function(s,a){var i=o(s,a);return n(i)?i:void 0}},function(t,r,e){var n=e(34),o=e(11),s=e(124),a=e(42),i=e(45),u=e(161),d=o([].push),c=function(m){var v=m==1,g=m==2,b=m==3,T=m==4,k=m==6,y=m==7,O=m==5||k;return function(D,he,ae,Ne){for(var ue,Y,_e=a(D),Ce=s(_e),ze=n(he,ae),ie=i(Ce),le=0,Ie=Ne||u,pe=v?Ie(D,ie):g||y?Ie(D,0):void 0;ie>le;le++)if((O||le in Ce)&&(Y=ze(ue=Ce[le],le,_e),m))if(v)pe[le]=Y;else if(Y)switch(m){case 3:return!0;case 5:return ue;case 6:return le;case 2:d(pe,ue)}else switch(m){case 4:return!1;case 7:d(pe,ue)}return k?-1:b||T?T:pe}};t.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterReject:c(7)}},function(t,r,e){t.exports=e(300)},function(t,r,e){t.exports=e(218)},function(t,r,e){t.exports=e(573)},function(t,r){t.exports=function(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}},function(t,r,e){(function(n){var o;t.exports=(o=o||function(s,a){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&n!==void 0&&n.crypto&&(i=n.crypto),!i)try{i=e(886)}catch{}var u=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},d=Object.create||function(){function he(){}return function(ae){var Ne;return he.prototype=ae,Ne=new he,he.prototype=null,Ne}}(),c={},m=c.lib={},v=m.Base={extend:function(he){var ae=d(this);return he&&ae.mixIn(he),ae.hasOwnProperty("init")&&this.init!==ae.init||(ae.init=function(){ae.$super.init.apply(this,arguments)}),ae.init.prototype=ae,ae.$super=this,ae},create:function(){var he=this.extend();return he.init.apply(he,arguments),he},init:function(){},mixIn:function(he){for(var ae in he)he.hasOwnProperty(ae)&&(this[ae]=he[ae]);he.hasOwnProperty("toString")&&(this.toString=he.toString)},clone:function(){return this.init.prototype.extend(this)}},g=m.WordArray=v.extend({init:function(he,ae){he=this.words=he||[],this.sigBytes=ae??4*he.length},toString:function(he){return(he||T).stringify(this)},concat:function(he){var ae=this.words,Ne=he.words,ue=this.sigBytes,Y=he.sigBytes;if(this.clamp(),ue%4)for(var _e=0;_e<Y;_e++){var Ce=Ne[_e>>>2]>>>24-_e%4*8&255;ae[ue+_e>>>2]|=Ce<<24-(ue+_e)%4*8}else for(var ze=0;ze<Y;ze+=4)ae[ue+ze>>>2]=Ne[ze>>>2];return this.sigBytes+=Y,this},clamp:function(){var he=this.words,ae=this.sigBytes;he[ae>>>2]&=4294967295<<32-ae%4*8,he.length=s.ceil(ae/4)},clone:function(){var he=v.clone.call(this);return he.words=this.words.slice(0),he},random:function(he){for(var ae=[],Ne=0;Ne<he;Ne+=4)ae.push(u());return new g.init(ae,he)}}),b=c.enc={},T=b.Hex={stringify:function(he){for(var ae=he.words,Ne=he.sigBytes,ue=[],Y=0;Y<Ne;Y++){var _e=ae[Y>>>2]>>>24-Y%4*8&255;ue.push((_e>>>4).toString(16)),ue.push((15&_e).toString(16))}return ue.join("")},parse:function(he){for(var ae=he.length,Ne=[],ue=0;ue<ae;ue+=2)Ne[ue>>>3]|=parseInt(he.substr(ue,2),16)<<24-ue%8*4;return new g.init(Ne,ae/2)}},k=b.Latin1={stringify:function(he){for(var ae=he.words,Ne=he.sigBytes,ue=[],Y=0;Y<Ne;Y++){var _e=ae[Y>>>2]>>>24-Y%4*8&255;ue.push(String.fromCharCode(_e))}return ue.join("")},parse:function(he){for(var ae=he.length,Ne=[],ue=0;ue<ae;ue++)Ne[ue>>>2]|=(255&he.charCodeAt(ue))<<24-ue%4*8;return new g.init(Ne,ae)}},y=b.Utf8={stringify:function(he){try{return decodeURIComponent(escape(k.stringify(he)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(he){return k.parse(unescape(encodeURIComponent(he)))}},O=m.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(he){typeof he=="string"&&(he=y.parse(he)),this._data.concat(he),this._nDataBytes+=he.sigBytes},_process:function(he){var ae,Ne=this._data,ue=Ne.words,Y=Ne.sigBytes,_e=this.blockSize,Ce=Y/(4*_e),ze=(Ce=he?s.ceil(Ce):s.max((0|Ce)-this._minBufferSize,0))*_e,ie=s.min(4*ze,Y);if(ze){for(var le=0;le<ze;le+=_e)this._doProcessBlock(ue,le);ae=ue.splice(0,ze),Ne.sigBytes-=ie}return new g.init(ae,ie)},clone:function(){var he=v.clone.call(this);return he._data=this._data.clone(),he},_minBufferSize:0}),D=(m.Hasher=O.extend({cfg:v.extend(),init:function(he){this.cfg=this.cfg.extend(he),this.reset()},reset:function(){O.reset.call(this),this._doReset()},update:function(he){return this._append(he),this._process(),this},finalize:function(he){return he&&this._append(he),this._doFinalize()},blockSize:16,_createHelper:function(he){return function(ae,Ne){return new he.init(Ne).finalize(ae)}},_createHmacHelper:function(he){return function(ae,Ne){return new D.HMAC.init(he,Ne).finalize(ae)}}}),c.algo={});return c}(Math),o)}).call(this,e(56))},function(t,r,e){var n=e(27),o=e(19),s=e(148),a=e(77),i=e(43),u=e(125),d=e(29),c=e(209),m=Object.getOwnPropertyDescriptor;r.f=n?m:function(v,g){if(v=i(v),g=u(g),c)try{return m(v,g)}catch{}if(d(v,g))return a(!o(s.f,v,g),v[g])}},function(t,r){t.exports=function(e){return e==null}},function(t,r,e){var n=e(93),o=e(4);t.exports=!!Object.getOwnPropertySymbols&&!o(function(){var s=Symbol();return!String(s)||!(Object(s)instanceof Symbol)||!Symbol.sham&&n&&n<41})},function(t,r,e){var n,o,s=e(14),a=e(64),i=s.process,u=s.Deno,d=i&&i.versions||u&&u.version,c=d&&d.v8;c&&(o=(n=c.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!o&&a&&(!(n=a.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=a.match(/Chrome\/(\d+)/))&&(o=+n[1]),t.exports=o},function(t,r,e){var n=e(4);t.exports=function(o,s){var a=[][o];return!!a&&n(function(){a.call(null,s||function(){return 1},1)})}},function(t,r,e){var n=e(125),o=e(38),s=e(77);t.exports=function(a,i,u){var d=n(i);d in a?o.f(a,d,s(0,u)):a[d]=u}},function(t,r){},function(t,r,e){var n,o,s,a=e(336),i=e(14),u=e(28),d=e(53),c=e(29),m=e(158),v=e(130),g=e(112),b=i.TypeError,T=i.WeakMap;if(a||m.state){var k=m.state||(m.state=new T);k.get=k.get,k.has=k.has,k.set=k.set,n=function(O,D){if(k.has(O))throw b("Object already initialized");return D.facade=O,k.set(O,D),D},o=function(O){return k.get(O)||{}},s=function(O){return k.has(O)}}else{var y=v("state");g[y]=!0,n=function(O,D){if(c(O,y))throw b("Object already initialized");return D.facade=O,d(O,y,D),D},o=function(O){return c(O,y)?O[y]:{}},s=function(O){return c(O,y)}}t.exports={set:n,get:o,has:s,enforce:function(O){return s(O)?o(O):n(O,{})},getterFor:function(O){return function(D){var he;if(!u(D)||(he=o(D)).type!==O)throw b("Incompatible receiver, "+O+" required");return he}}}},function(t,r,e){var n=e(11);t.exports=n([].slice)},function(t,r){t.exports={}},function(t,r){t.exports=function(e){try{return{error:!1,value:e()}}catch(n){return{error:!0,value:n}}}},function(t,r,e){var n=e(14);t.exports=n.Promise},function(t,r,e){var n=e(645)();t.exports=n;try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},function(t,r,e){var n=e(287);function o(s,a,i,u,d,c,m){try{var v=s[c](m),g=v.value}catch(b){return void i(b)}v.done?a(g):n.resolve(g).then(u,d)}t.exports=function(s){return function(){var a=this,i=arguments;return new n(function(u,d){var c=s.apply(a,i);function m(g){o(c,u,d,m,v,"next",g)}function v(g){o(c,u,d,m,v,"throw",g)}m(void 0)})}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r){t.exports=function(e){return e!=null&&typeof e=="object"}},function(t,r,e){var n=e(278),o=e(57),s=e(3),a=e(23),i=e(25),u=e(7),d=e(52),c=e(17),m=e(2),v=e(5),g=e(8),b=e(197),T=e(41),k=e(121),y=e(122),O=e(280),D=e(281),he=e(190);function ae(Ie){var pe=function(){if(typeof Reflect>"u"||!n||n.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var qe,$e=he(Ie);if(pe){var Lt=he(this).constructor;qe=n($e,arguments,Lt)}else qe=$e.apply(this,arguments);return D(this,qe)}}var Ne=e(170),ue=e(0),Y=e(13).heartbeatInterval,_e=e(155).V2NIMLoginStatus,Ce=e(13),ze={kSyncAction5_1:0,kSyncAction5_2:1,kSyncAction5_3:2},ie={kKnown:-1,kSucceed:0,kFailed:1,kAborted:2,kCanceled:3},le=function(Ie){O(qe,Ie);var pe=ae(qe);function qe($e){var Lt,Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return k(this,qe),(Lt=pe.call(this)).clientProto=$e,Lt.logger=$e.logger,Lt.reporter=$e.reporter,Lt.timer=null,Lt.setClientOrigin(),Lt.serverOrigin={timeStamp:null,rtt:null,baseTimeStamp:null},Lt.tolerantRTT=Dt.tolerantRTT||3e3,Lt.bestRTT=Dt.bestRTT||100,Lt.maxChances=Dt.maxChances||10,Lt.isSettingNTP=!1,Lt.currentChance=0,Lt.syncTraceData={},Lt.syncTraceMap={},Lt.syncTraceLastItem={},Lt.uploadTraceData={},Lt.setMonitorForSync(),Lt.setMonitorForResources(),Lt}return y(qe,[{key:"hasOriginTimetick",value:function(){return!!this.serverOrigin.timeStamp}},{key:"setOriginTimetick",value:function(){var $e=this,Lt=this.clientProto.options;if((typeof ue.get(Lt,"privateConf.isDataReportEnable")=="boolean"?Lt.privateConf.isDataReportEnable:Ce.privateConf.isDataReportEnable)&&Ce.isBrowser&&performance&&performance.now&&!(this.isSettingNTP||this.currentChance>=this.maxChances)){this.isSettingNTP=!0,this.currentChance++,clearTimeout(this.timer),this.timer=null;var Dt="ReporterHook::setOriginTimetick:",dr=o();return this.logger.info("".concat(Dt," getServerTime start, times ").concat(this.currentChance)),new s(function(pr){$e.clientProto.sendCmd("getServerTime",{},function(sr,hr){if($e.isSettingNTP=!1,sr){var Fe;$e.logger.warn("".concat(Dt," Calculate Delay time, getServerTime error"),sr),$e.clientProto.statusProtector.getLoginStatus()===_e.V2NIM_LOGIN_STATUS_LOGINED&&($e.timer=a(i(Fe=$e.setOriginTimetick).call(Fe,$e),Y)),pr()}else{if(!hr)return $e.logger.warn("".concat(Dt," Calculate Delay time, getServerTime not correct")),void pr();var nr,ir=o()-dr;if(ir>$e.tolerantRTT)$e.logger.warn("".concat(Dt," Denied, cause of exceeding the maximum tolerance range of RTT: ").concat(ir)),$e.timer=a(i(nr=$e.setOriginTimetick).call(nr,$e),Y);else if(ir>$e.bestRTT){var Ue,rr,or;$e.serverOrigin.rtt&&ir>=$e.serverOrigin.rtt?$e.logger.info("".concat(Dt," Denied, cause of current.RTT >= serverOrigin.RTT: ").concat(ir)):($e.setServerOrigin(ir,hr),$e.logger.info(u(rr=u(or="".concat(Dt," Accept within maximum tolerance range of RTT: ").concat(ir,", ntpTimestamp: ")).call(or,$e.serverOrigin.timeStamp,", localClock: ")).call(rr,$e.serverOrigin.baseTimeStamp))),$e.timer=a(i(Ue=$e.setOriginTimetick).call(Ue,$e),Y)}else{var Pt,Et;$e.setServerOrigin(ir,hr),$e.logger.info(u(Pt=u(Et="".concat(Dt," Accept within best RTT: ").concat(ir,", ntpTimestamp: ")).call(Et,$e.serverOrigin.timeStamp,", localClock: ")).call(Pt,$e.serverOrigin.baseTimeStamp))}pr()}})})}}},{key:"getNTPTime",value:function($e){if(typeof $e!="number"&&($e=this.getSafeClock()),this.serverOrigin.timeStamp){var Lt=d($e-this.serverOrigin.baseTimeStamp);return this.serverOrigin.timeStamp+Lt}var Dt=d($e-this.clientOrigin.baseTimeStamp);return this.clientOrigin.timeStamp+Dt}},{key:"getSafeClock",value:function(){return Ce.isBrowser&&performance&&performance.now?performance.now():o()}},{key:"setMonitorForSync",value:function(){var $e=this,Lt="ReporterHook::setMonitorForSync:";this.on("reporter/syncStart",function(){$e.logger.info("".concat(Lt," sync start")),$e.syncTraceData={user_id:$e.clientProto.account,trace_id:ue.get($e.clientProto,"socket.socket.sessionid"),action:ze.kSyncAction5_1,sync_begin_time:$e.getSafeClock(),sync_end_time:0,sync_duration:0,overall_duration:0,extension:[]}}),this.on("reporter/syncRecv",function(){$e.syncTraceData.user_id&&($e.logger.info("".concat(Lt," sync receive packet")),$e.syncTraceData.sync_end_time=$e.getSafeClock(),$e.syncTraceData.sync_duration=d($e.syncTraceData.sync_end_time-$e.syncTraceData.sync_begin_time))}),this.on("reporter/syncItem",function(Dt,dr){var pr;if(typeof Dt=="number"&&$e.syncTraceData.user_id){$e.logger.info(u(pr="".concat(Lt," receive sync item: ").concat(Dt,", total: ")).call(pr,dr));var sr=$e.getSafeClock();$e.syncTraceMap[Dt]=$e.syncTraceMap[Dt]?$e.syncTraceMap[Dt]:{sync_type:Dt,times:0,total:0,sync_duration:0,proc_duration:0,description:"",items:[]};var hr={total:dr,pre_item_recv_time:$e.syncTraceLastItem.cur_item_recv_time?$e.syncTraceLastItem.cur_item_recv_time:$e.syncTraceData.sync_begin_time,cur_item_recv_time:sr};$e.syncTraceMap[Dt].items.push(hr),$e.syncTraceLastItem=hr}}),this.on("reporter/syncItemComplete",function(Dt){var dr;if(typeof Dt=="number"&&$e.syncTraceData.user_id){var pr=$e.syncTraceMap[Dt];if(pr){$e.logger.info("".concat(Lt," sync item ").concat(Dt," callback done"));var sr=c(dr=pr.items).call(dr,function(hr){return!hr.callback_time});sr.length!==0&&(sr[0].callback_time=$e.getSafeClock())}}}),this.on("reporter/syncComplete",function(){var Dt;$e.syncTraceData.user_id&&($e.logger.info("".concat(Lt," sync complete")),m(Dt=v($e.syncTraceMap)).call(Dt,function(dr){var pr,sr=g(pr=$e.syncTraceMap[dr].items).call(pr,function(Fe){return{total:Fe.total,pre_item_recv_time:$e.getNTPTime(Fe.pre_item_recv_time),cur_item_recv_time:$e.getNTPTime(Fe.cur_item_recv_time),callback_time:$e.getNTPTime(Fe.callback_time)}}),hr=b(sr).call(sr,function(Fe,nr){return Fe.times+=1,Fe.total+=nr.total,Fe.sync_duration+=nr.cur_item_recv_time-nr.pre_item_recv_time,Fe.proc_duration+=nr.callback_time-nr.cur_item_recv_time,Fe},{times:0,total:0,sync_duration:0,proc_duration:0});$e.syncTraceMap[dr].items=sr,T($e.syncTraceMap[dr],hr),$e.syncTraceData.extension.push($e.syncTraceMap[dr])}),$e.syncTraceData.sync_begin_time=$e.getNTPTime($e.syncTraceData.sync_begin_time),$e.syncTraceData.sync_end_time=$e.getNTPTime($e.syncTraceData.sync_end_time),$e.syncTraceData.overall_duration=$e.getNTPTime()-$e.syncTraceData.sync_begin_time,$e.reporter.report("nim_sdk_sync",$e.syncTraceData),$e.syncTraceData={},$e.syncTraceMap={})})}},{key:"setMonitorForResources",value:function(){var $e=this,Lt="ReporterHook::setMonitorForResources:";this.on("reporter/uploadStart",function(){$e.logger.info("".concat(Lt," upload start")),$e.uploadTraceData={user_id:$e.clientProto.account,trace_id:ue.get($e.clientProto,"socket.socket.sessionid"),action:0,duration:0,start_time:$e.getSafeClock(),offset:0,full_size:0,transferred_size:0}}),this.on("reporter/uploadUpdate",function(){var Dt,dr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};$e.uploadTraceData.user_id&&($e.logger.info("".concat(Lt," upload update"),dr),m(Dt=v(dr)).call(Dt,function(pr){$e.uploadTraceData[pr]=dr[pr]}))}),this.on("reporter/uploadEnd",function(){var Dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ie.kKnown;$e.uploadTraceData.user_id&&($e.logger.info("".concat(Lt," upload end cause of ").concat(Dt)),$e.uploadTraceData.state=Dt,$e.uploadTraceData.start_time=$e.getNTPTime($e.uploadTraceData.start_time),$e.uploadTraceData.duration=$e.getNTPTime($e.getSafeClock())-$e.uploadTraceData.start_time,$e.reporter.report("nim_sdk_resources",$e.uploadTraceData),$e.uploadTraceData={})})}},{key:"destroy",value:function(){this.reset(),this.removeAllListeners(),this.logger.info("ReporterHook::destroy: complete")}},{key:"reset",value:function(){this.logger.info("ReporterHook::reset"),this.serverOrigin={},this.setClientOrigin(),this.currentChance=0,this.timer&&clearTimeout(this.timer),this.syncTraceData={},this.syncTraceMap={},this.syncTraceLastItem={},this.uploadTraceData={}}},{key:"setClientOrigin",value:function(){this.clientOrigin={timeStamp:o(),baseTimeStamp:this.getSafeClock()}}},{key:"setServerOrigin",value:function($e,Lt){this.serverOrigin={timeStamp:Lt+d($e/2),rtt:$e,baseTimeStamp:this.getSafeClock()}}}]),qe}(Ne);t.exports={EMSyncAction:ze,EMSyncType:{kSyncType3_8:30008,kSyncType3_109:30109,kSyncType4_4:40004,kSyncType4_6:40006,kSyncType4_9:40009,kSyncType4_12:40012,kSyncType4_13:40013,kSyncType4_14:40014,kSyncType4_16:40016,kSyncType4_17:40017,kSyncType4_18:40018,kSyncType4_19:40019,kSyncType4_20:40020,kSyncType4_21:40021,kSyncType4_23:40023,kSyncType4_24:40024,kSyncType4_100:40100,kSyncType4_101:40101,kSyncType7_15:70015,kSyncType8_109:80109,kSyncType8_126:80126,kSyncType12_5:12005,kSyncType12_6:12006,kSyncType15_13:15013,kSyncType21_109:21109,kSyncType21_111:21111},ReporterHook:le,EMExceptionState:ie,EMResourceUploadWay:{kResourceUploadWayNOS:0,kResourceUploadWayAWSPlugin:1,kResourceUploadWayNOSPlugin:2}}},function(t,r,e){var n=e(6),o=e(15),s=e(2),a=e(7),i=e(201),u=e(17),d=e(85),c=e(86),m=e(70),v=e(32);function g(y,O){var D=c!==void 0&&m(y)||y["@@iterator"];if(!D){if(v(y)||(D=function(_e,Ce){var ze;if(_e){if(typeof _e=="string")return b(_e,Ce);var ie=o(ze=Object.prototype.toString.call(_e)).call(ze,8,-1);if(ie==="Object"&&_e.constructor&&(ie=_e.constructor.name),ie==="Map"||ie==="Set")return d(_e);if(ie==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ie))return b(_e,Ce)}}(y))||O&&y&&typeof y.length=="number"){D&&(y=D);var he=0,ae=function(){};return{s:ae,n:function(){return he>=y.length?{done:!0}:{done:!1,value:y[he++]}},e:function(_e){throw _e},f:ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ne,ue=!0,Y=!1;return{s:function(){D=D.call(y)},n:function(){var _e=D.next();return ue=_e.done,_e},e:function(_e){Y=!0,Ne=_e},f:function(){try{ue||D.return==null||D.return()}finally{if(Y)throw Ne}}}}function b(y,O){(O==null||O>y.length)&&(O=y.length);for(var D=0,he=new Array(O);D<O;D++)he[D]=y[D];return he}var T=e(13),k={genUrlSep:function(y){return n(y=""+y).call(y,"?")===-1?"?imageView&":"&"},urlQuery2Object:function(y){if(Object.prototype.toString.call(y)!=="[object String]"||y==="")return{};var O=n(y).call(y,"?");if(O!==-1){var D=o(y).call(y,O+1).split("&"),he={};return s(D).call(D,function(ae){if(~n(ae).call(ae,"=")){var Ne=ae.split("=");he[Ne[0]]=decodeURIComponent(Ne[1])}else he[ae]=""}),he}},url2object:function(y){Object.prototype.toString.call(y)!=="[object String]"&&(y="");var O=n(y=y||"").call(y,"https")>=0?"https://":"http://",D=y.replace(O,"");n(D).call(D,"?")>=0&&(D=D.substring(0,n(D).call(D,"?")));var he=D.split("/");D=he[0];var ae="";if(he.length>0&&(ae=o(he).call(he,1).join("/")),n(y).call(y,"?")===-1)return{protocol:O,hostname:D,path:ae,query:{}};var Ne=y.substr(n(y).call(y,"?")+1).split("&"),ue={};return s(Ne).call(Ne,function(Y){if(n(Y).call(Y,"=")>0){var _e=Y.split("=");ue[_e[0]]=decodeURIComponent(_e[1])}else ue[Y]=""}),{protocol:O,hostname:D,path:ae,query:ue}},object2url:function(y){var O,D=y.protocol,he=y.hostname,ae=y.path,Ne=y.query;D=D||"http://",he=he||"",ae&&(he=a(O="".concat(he,"/")).call(O,ae)),Ne=Ne||{};var ue,Y,_e,Ce=[];for(var ze in Ne){var ie;ze!=="imageView"&&Ce.push(a(ie="".concat(ze,"=")).call(ie,encodeURIComponent(Ne[ze])))}return Ce.length>0?a(ue=a(Y="".concat(D)).call(Y,he,"?imageView&")).call(ue,Ce.join("&")):a(_e="".concat(D)).call(_e,he)},genPrivateUrl:function(y,O,D){if(O&&O.length){var he,ae=g(O);try{for(ae.s();!(he=ae.n()).done;){var Ne=he.value;if(n(y).call(y,Ne)>=0)return Ne!==D&&(y=y.replace(Ne,D)),y;if(n(y).call(y,Ne)>=0&&Ne===D)return y}}catch(Fe){ae.e(Fe)}finally{ae.f()}}var ue,Y,_e=k.url2object(y),Ce=_e.hostname,ze=_e.path,ie=T.downloadUrl,le=T.downloadHostList,Ie=T.nosCdnEnable,pe=T.serverNosConfig.cdnDomain,qe=decodeURIComponent(T.serverNosConfig.objectPrefix),$e=decodeURIComponent(ze),Lt=n($e).call($e,qe);if(pe&&Lt>-1&&Ie)return a(ue=a(Y="".concat(_e.protocol)).call(Y,pe,"/")).call(ue,o($e).call($e,Lt));if(i(le).call(le,Ce)&&i(ze).call(ze,"/")){var Dt=n(ze).call(ze,"/"),dr=ze.substring(0,Dt),pr=ze.substring(Dt+1);return ie.replace("{bucket}",dr).replace("{object}",pr)}var sr=u(le).call(le,function(Fe){return typeof Ce=="string"&&i(Ce).call(Ce,Fe)})[0],hr=sr?Ce.replace(sr,"").replace(/\W/g,""):null;return hr?ie.replace("{bucket}",hr).replace("{object}",ze):y}};t.exports=k},function(t,r,e){var n=e(4);t.exports=!n(function(){var o=(function(){}).bind();return typeof o!="function"||o.hasOwnProperty("prototype")})},function(t,r,e){var n=e(91),o=TypeError;t.exports=function(s){if(n(s))throw o("Can't call method on "+s);return s}},function(t,r,e){var n=e(48),o=e(158);(t.exports=function(s,a){return o[s]||(o[s]=a!==void 0?a:{})})("versions",[]).push({version:"3.27.1",mode:n?"pure":"global",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.27.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(t,r,e){var n=e(322);t.exports=function(o){var s=+o;return s!=s||s===0?0:n(s)}},function(t,r,e){var n=e(4),o=e(20),s=e(93),a=o("species");t.exports=function(i){return s>=51||!n(function(){var u=[];return(u.constructor={})[a]=function(){return{foo:1}},u[i](Boolean).foo!==1})}},function(t,r){t.exports={}},function(t,r,e){var n=e(372).charAt,o=e(49),s=e(97),a=e(166),i=e(167),u=s.set,d=s.getterFor("String Iterator");a(String,"String",function(c){u(this,{type:"String Iterator",string:o(c),index:0})},function(){var c,m=d(this),v=m.string,g=m.index;return g>=v.length?i(void 0,!0):(c=n(v,g),m.index+=c.length,i(c,!1))})},function(t,r,e){var n=e(63),o=e(14);t.exports=n(o.process)=="process"},function(t,r,e){var n=e(14),o=e(101),s=e(16),a=e(210),i=e(214),u=e(20),d=e(401),c=e(242),m=e(48),v=e(93),g=o&&o.prototype,b=u("species"),T=!1,k=s(n.PromiseRejectionEvent),y=a("Promise",function(){var O=i(o),D=O!==String(o);if(!D&&v===66||m&&(!g.catch||!g.finally))return!0;if(!v||v<51||!/native code/.test(O)){var he=new o(function(Ne){Ne(1)}),ae=function(Ne){Ne(function(){},function(){})};if((he.constructor={})[b]=ae,!(T=he.then(function(){})instanceof ae))return!0}return!D&&(d||c)&&!k});t.exports={CONSTRUCTOR:y,REJECTION_EVENT:k,SUBCLASSING:T}},function(t,r,e){var n=e(25),o=e(54),s=e(570),a=e(572),i=e(578),u={},d=o.f;function c(k){var y=k.upload=(k.headers||o.o)["Content-Type"]==="multipart/form-data",O=!1;try{O=(location.protocol+"//"+location.host).toLowerCase()!==o.url2origin(k.url)}catch{}return k.cors=O,y||O||k.mode?function(D){var he=D.mode,ae=s,Ne=o.getGlobal();return!Ne.FormData&&Ne.document&&(he="iframe"),he==="iframe"&&(ae=D.upload?a:i),new ae(D)}(k):new s(k)}function m(k,y,O){var D=u[k];if(D){y==="onload"&&D.result&&(O=function(ae,Ne){Ne={data:Ne};var ue=ae.result.headers;return ue&&(Ne.headers=ae.req.header(ue)),Ne}(D,O)),function(ae){var Ne=u[ae];Ne&&(Ne.req.destroy(),delete u[ae])}(k);var he={type:y,result:O};d(he),he.stopped||D[y](he.result)}}function v(k,y){m(k,"onload",y)}function g(k,y){m(k,"onerror",y)}function b(k,y){var O=o.genUrlSep(k);return y=y||"",o.isObject(y)&&(y=o.object2query(y)),y&&(k+=O+y),k}function T(k,y){y=y||{};var O=o.uniqueID(),D={result:y.result,onload:y.onload||o.f,onerror:y.onerror||o.f};u[O]=D,y.onload=n(v).call(v,null,O),y.onerror=n(g).call(g,null,O),y.query&&(k=b(k,y.query));var he=y.method||"";return he&&!/get/i.test(he)||!y.data||(k=b(k,y.data),y.data=null),y.url=k,D.req=c(y),O}T.filter=function(k){o.isFunction(k)&&(d=k)},T.abort=function(k){var y=u[k];y&&y.req&&y.req.abort()},t.exports=T},function(t,r,e){var n=e(10),o=e(302),s=e(26),a=e(106).genPrivateUrl,i=e(0),u=i.notundef,d=i.exist,c=e(193),m=e(296),v=m.typeMap;function g(b){b.resend?(i.verifyOptions(b,"idClient","msg::Message"),this.idClient=b.idClient):this.idClient=i.guid(),this.type=v[b.type],this.resend=b.resend?1:0,u(b.subType)&&(i.isInt(+b.subType)&&+b.subType>0?this.subType=+b.subType:i.onParamError("subType0","msg::Message")),u(b.custom)&&(s(b.custom)==="object"?this.custom=n(b.custom):this.custom=""+b.custom),u(b.text)&&(this.body=""+b.text),u(b.body)&&(this.body=""+b.body),u(b.yidunEnable)&&(this.yidunEnable=b.yidunEnable?1:0),u(b.antiSpamUsingYidun)&&(this.antiSpamUsingYidun=b.antiSpamUsingYidun?1:0),u(b.antiSpamContent)&&(s(b.antiSpamContent)==="object"?this.antiSpamContent=n(b.antiSpamContent):this.antiSpamContent=""+b.antiSpamContent),u(b.antiSpamBusinessId)&&(s(b.antiSpamBusinessId)==="object"?this.antiSpamBusinessId=n(b.antiSpamBusinessId):this.antiSpamBusinessId=""+b.antiSpamBusinessId),u(b.yidunAntiCheating)&&(this.yidunAntiCheating=b.yidunAntiCheating+""),u(b.skipHistory)&&(this.skipHistory=b.skipHistory?1:0),u(b.highPriority)&&(this.highPriority=b.highPriority?1:0),u(b.clientAntiSpam)&&(this.clientAntiSpam=b.clientAntiSpam?1:0),u(b.env)&&(this.env=b.env),u(b.notifyTargetTags)&&(this.notifyTargetTags=b.notifyTargetTags),u(b.yidunAntiSpamExt)&&(this.yidunAntiSpamExt=b.yidunAntiSpamExt),(u(b.loc_x)||u(b.loc_y)||u(b.loc_z))&&(this.loc_x=b.loc_x,this.loc_y=b.loc_y,this.loc_z=b.loc_z)}g.validTypes=m.validTypes,i.merge(g.prototype,m.prototype),g.getType=m.getType,g.setFlow=m.setFlow,g.reverse=function(b){var T=i.filterObj(b,"chatroomId idClient from fromNick fromAvatar _fromAvatar_safe fromCustom userUpdateTime custom status notifyTargetTags");return u(T.fromAvatar)&&(T.fromAvatar=a(T.fromAvatar)),T=i.merge(T,{fromClientType:c.reverseType(b.fromClientType),time:+b.time,type:g.getType(b),text:d(b.body)?b.body:b.text||"",resend:+b.resend==1}),u(T.userUpdateTime)&&(T.userUpdateTime=+T.userUpdateTime),u(b.callbackExt)&&(T.callbackExt=b.callbackExt),u(b.subType)&&(T.subType=+b.subType),u(b.yidunAntiSpamRes)&&(T.yidunAntiSpamRes=b.yidunAntiSpamRes),u(b.loc_x)&&(T.x=o(b.loc_x),T.y=o(b.loc_y),T.z=o(b.loc_z)),u(b.toAccids)&&(T.toAccids=b.toAccids),T.status=T.status||"success",T},g.setExtra=function(b,T){m.setFlow(b,T)},t.exports=g},function(t,r,e){var n=e(216),o=e(164);t.exports=Object.keys||function(s){return n(s,o)}},function(t,r,e){var n=e(173),o=e(500),s=e(501),a=n?n.toStringTag:void 0;t.exports=function(i){return i==null?i===void 0?"[object Undefined]":"[object Null]":a&&a in Object(i)?o(i):s(i)}},function(t,r,e){var n=e(592),o=e(186),s=e(599);t.exports=function(a,i){if(a==null)return{};var u,d,c=s(a,i);if(n){var m=n(a);for(d=0;d<m.length;d++)u=m[d],o(i).call(i,u)>=0||Object.prototype.propertyIsEnumerable.call(a,u)&&(c[u]=a[u])}return c},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r){t.exports=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(137),o=e(249);function s(a,i){for(var u=0;u<i.length;u++){var d=i[u];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),n(a,o(d.key),d)}}t.exports=function(a,i,u){return i&&s(a.prototype,i),u&&s(a,u),n(a,"prototype",{writable:!1}),a},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(566)},function(t,r,e){var n=e(11),o=e(4),s=e(63),a=Object,i=n("".split);t.exports=o(function(){return!a("z").propertyIsEnumerable(0)})?function(u){return s(u)=="String"?i(u,""):a(u)}:a},function(t,r,e){var n=e(319),o=e(126);t.exports=function(s){var a=n(s,"string");return o(a)?a:a+""}},function(t,r,e){var n=e(33),o=e(16),s=e(21),a=e(208),i=Object;t.exports=a?function(u){return typeof u=="symbol"}:function(u){var d=n("Symbol");return o(d)&&s(d.prototype,i(u))}},function(t,r,e){var n=e(11),o=0,s=Math.random(),a=n(1 .toString);t.exports=function(i){return"Symbol("+(i===void 0?"":i)+")_"+a(++o+s,36)}},function(t,r,e){var n=e(110),o=Math.max,s=Math.min;t.exports=function(a,i){var u=n(a);return u<0?o(u+i,0):s(u,i)}},function(t,r,e){var n=e(11),o=e(4),s=e(16),a=e(65),i=e(33),u=e(214),d=function(){},c=[],m=i("Reflect","construct"),v=/^\s*(?:class|function)\b/,g=n(v.exec),b=!v.exec(d),T=function(y){if(!s(y))return!1;try{return m(d,c,y),!0}catch{return!1}},k=function(y){if(!s(y))return!1;switch(a(y)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return b||!!g(v,u(y))}catch{return!0}};k.sham=!0,t.exports=!m||o(function(){var y;return T(T.call)||!T(Object)||!T(function(){y=!0})||y})?k:T},function(t,r,e){var n=e(109),o=e(127),s=n("keys");t.exports=function(a){return s[a]||(s[a]=o(a))}},function(t,r,e){var n=e(216),o=e(164).concat("length","prototype");r.f=Object.getOwnPropertyNames||function(s){return n(s,o)}},function(t,r){r.f=Object.getOwnPropertySymbols},function(t,r,e){var n=e(20);r.f=n},function(t,r,e){var n=e(29),o=e(16),s=e(42),a=e(130),i=e(228),u=a("IE_PROTO"),d=Object,c=d.prototype;t.exports=i?d.getPrototypeOf:function(m){var v=s(m);if(n(v,u))return v[u];var g=v.constructor;return o(g)&&v instanceof g?g.prototype:v instanceof d?c:null}},function(t,r,e){var n=e(11),o=e(36),s=e(356);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var a,i=!1,u={};try{(a=n(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(u,[]),i=u instanceof Array}catch{}return function(d,c){return o(d),s(c),i?a(d,c):d.__proto__=c,d}}():void 0)},function(t,r,e){var n=e(65),o=e(157),s=e(91),a=e(99),i=e(20)("iterator");t.exports=function(u){if(!s(u))return o(u,i)||o(u,"@@iterator")||a[n(u)]}},function(t,r,e){t.exports=e(408)},function(t,r,e){t.exports=e(433)},function(t,r,e){t.exports=e(450)},function(t,r,e){var n=e(489),o=e(490),s=e(491),a=e(492),i=e(493);function u(d){var c=-1,m=d==null?0:d.length;for(this.clear();++c<m;){var v=d[c];this.set(v[0],v[1])}}u.prototype.clear=n,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=a,u.prototype.set=i,t.exports=u},function(t,r,e){var n=e(199);t.exports=function(o,s){for(var a=o.length;a--;)if(n(o[a][0],s))return a;return-1}},function(t,r,e){var n=e(83)(Object,"create");t.exports=n},function(t,r,e){var n=e(513);t.exports=function(o,s){var a=o.__data__;return n(s)?a[typeof s=="string"?"string":"hash"]:a.map}},function(t,r,e){var n=e(260),o=e(261);t.exports=function(s,a,i,u){var d=!i;i||(i={});for(var c=-1,m=a.length;++c<m;){var v=a[c],g=u?u(i[v],s[v],v,i,s):void 0;g===void 0&&(g=s[v]),d?o(i,v,g):n(i,v,g)}return i}},function(t,r){t.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(t,r){t.exports=`	
\v\f\r \u2028\u2029\uFEFF`},function(t,r,e){var n,o=e(18),s=e(2),a=e(8),i=e(3),u=e(7),d=e(6),c=e(25),m=e(10),v=e(106).urlQuery2Object,g=e(0),b=e(40),T=e(739),k=e(740),y=e(741),O=e(742),D=e(743),he=e(744);function ae(_e){this.mixin(_e)}ae.prototype=o((function(){}).prototype,{protocol:{value:null,writable:!0,enumerable:!0,configurable:!0}}),ae.prototype.setProtocol=function(_e){this.protocol=_e},ae.prototype.mixin=function(_e){var Ce,ze,ie=this;this.configMap=this.configMap||{},s(Ce=["idMap","cmdConfig","packetConfig"]).call(Ce,function(le){ie.configMap[le]=g.merge({},ie.configMap[le],_e.configMap&&_e.configMap[le])}),s(ze=["serializeMap","unserializeMap"]).call(ze,function(le){ie[le]=g.merge({},ie[le],_e[le])})},ae.prototype.createCmd=(n=1,function(_e,Ce){var ze,ie=this,le=this.configMap.cmdConfig[_e],Ie=this.configMap.packetConfig[le.sid+"_"+le.cid],pe=_e==="heartbeat"?0:n++;return pe>32767&&(pe=1,n=2),_e={SID:le.sid,CID:le.cid,SER:pe,isAwaitable:typeof le.isAwaitable=="boolean"?le.isAwaitable:!(!Ie||!Ie.response)},le.params&&(_e.Q=[],s(ze=le.params).call(ze,function(qe){var $e=qe.type,Lt=qe.name,Dt=qe.entity,dr=Ce[Lt];if(!g.undef(dr)){switch($e){case"PropertyArray":$e="ArrayMable",dr=a(dr).call(dr,function(pr){return{t:"Property",v:ie.serialize(pr,Dt)}});break;case"Property":dr=ie.serialize(dr,Lt);break;case"bool":dr=dr?"true":"false"}_e.Q.push({t:$e,v:dr})}})),_e}),ae.prototype.parseResponse=function(_e){var Ce=this;return new i(function(ze){var ie=JSON.parse(_e),le={raw:ie,rawStr:_e,error:b.genError(ie.code)},Ie=Ce.configMap.packetConfig[ie.sid+"_"+ie.cid];if(!Ie)return le.notFound={sid:ie.sid,cid:ie.cid},void ze(le);var pe=ie.r,qe=Ie.service==="notify"&&!Ie.cmd;if(le.isNotify=qe,qe){var $e=ie.r[1].headerPacket;if(Ie=Ce.configMap.packetConfig[$e.sid+"_"+$e.cid],pe=ie.r[1].body,!Ie)return le.notFound={sid:$e.sid,cid:$e.cid},void ze(le)}if(le.service=Ie.service,le.cmd=Ie.cmd,le.error){var Lt,Dt,dr=u(Lt="".concat(ie.sid,"_")).call(Lt,ie.cid);if(qe&&(dr=u(Dt="".concat($e.sid,"_")).call(Dt,$e.cid)),le.error.cmd=le.cmd,le.error.callFunc="protocol::parseResponse: ".concat(dr),le.error.code===416){var pr=pe[0];pr&&(le.frequencyControlDuration=1e3*pr)}}var sr,hr=!1;le.error&&Ie.trivialErrorCodes&&(hr=d(sr=Ie.trivialErrorCodes).call(sr,le.error.code)!==-1);var Fe=[];if((!le.error||hr)&&Ie.response){var nr;le.content={};var ir=function(Ue,rr,or,Pt){if(Ue&&Pt==="msg"||Pt==="sysMsg"){var Et=or.content[Pt];g.isObject(Et)&&!Et.idServer&&(Et.idServer=""+rr.r[0])}};s(nr=Ie.response).call(nr,function(Ue,rr){var or,Pt=pe[rr];if(!g.undef(Pt)){var Et=Ue.type,kt=Ue.name,er=Ue.entity||kt;switch(Et){case"Property":Fe.push(Ce.unserialize(Pt,er).then(c(or=function(cr,mr,vr,Tr,Ir){vr.content[Tr]=Ir,ir(cr,mr,vr,Tr)}).call(or,this,qe,ie,le,kt)));break;case"PropertyArray":le.content[kt]=[],s(Pt).call(Pt,function(cr,mr){var vr;Fe.push(Ce.unserialize(cr,er).then(c(vr=function(Tr,Ir,kr){Tr.content[Ir][mr]=kr}).call(vr,this,le,kt)))});break;case"KVArray":le.content[kt]=Pt,ir(qe,ie,le,kt);break;case"long":case"Long":case"byte":case"Byte":case"Number":le.content[kt]=+Pt;break;default:le.content[kt]=Pt,ir(qe,ie,le,kt)}}})}i.all(Fe).then(function(){ze(le)})})},ae.prototype.serialize=function(_e,Ce){var ze=this.serializeMap[Ce],ie={};for(var le in ze)_e.hasOwnProperty(le)&&(ie[ze[le]]=_e[le]);return ie},ae.prototype.matchNosSafeUrl=function(_e){if(!g.isString(_e)||!~d(_e).call(_e,"_im_url=1"))return!1;var Ce=v(_e);return!(!Ce||!Ce._im_url||Ce._im_url!=1)},ae.prototype.getOneNosOriginUrl=function(_e,Ce,ze){var ie=this;return new i(function(le){ie.protocol.getNosOriginUrlReqNum++,ie.protocol.sendCmd("getNosOriginUrl",{nosFileUrlTag:{safeUrl:_e}},function(Ie,pe,qe){ie.protocol.getNosOriginUrlReqNum--,Ie?ie.protocol.logger.warn("error: get nos originUrl failed",Ie):(Ce["_"+ze+"_safe"]=Ce[ze],Ce[ze]=qe.nosFileUrlTag&&qe.nosFileUrlTag.originUrl),le()})})},ae.prototype.checkObjSafeUrl=function(_e,Ce,ze){var ie=this;for(var le in _e)if(_e.hasOwnProperty(le)){var Ie=_e[le];if(g.isString(Ie)){if(this.matchNosSafeUrl(Ie)){var pe=this.getOneNosOriginUrl(Ie,_e,le);Ce.push(pe),ze.push(pe)}}else g.isObject(Ie)?this.checkObjSafeUrl(Ie,Ce,ze):g.isArray(Ie)&&s(Ie).call(Ie,function(qe){g.isObject(qe)&&ie.checkObjSafeUrl(qe,Ce,ze)})}};var Ne=["url","avatar","fromAvatar","chatroomAvatar"];ae.prototype.unserialize=function(_e,Ce){var ze=this;return new i(function(ie){var le=ze.unserializeMap[Ce],Ie={},pe=[];if(_e)for(var qe in le){var $e,Lt=[];if(_e.hasOwnProperty(qe)&&(Ie[le[qe]]=_e[qe],ze.protocol.hasLogin&&!ze.protocol.keepNosSafeUrl))if(le[qe]==="attach"&&_e[qe]&&d(_e[qe])&&~d($e=_e[qe]).call($e,"_im_url=1"))try{var Dt,dr=JSON.parse(_e[qe]);dr.isS3||ze.checkObjSafeUrl(dr,Lt,pe),i.all(Lt).then(c(Dt=function(pr,sr){pr.attach=m(sr)}).call(Dt,ze,Ie,dr))}catch(pr){ze.logger.warn("unserialize",pr&&pr.message)}else~d(Ne).call(Ne,le[qe])&&_e[qe]&&ze.matchNosSafeUrl(_e[qe])&&pe.push(ze.getOneNosOriginUrl(_e[qe],Ie,le[qe]))}i.all(pe).then(function(){ie(Ie)})})},ae.prototype.syncUnserialize=function(_e,Ce){var ze=this.unserializeMap[Ce],ie={};if(_e)for(var le in ze)_e.hasOwnProperty(le)&&(ie[ze[le]]=_e[le]);return ie};var ue=new ae({configMap:T,serializeMap:k,unserializeMap:y}),Y=new ae({configMap:O,serializeMap:D,unserializeMap:he});t.exports={IM:ue,Chatroom:Y}},function(t,r,e){var n={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,s=o&&!n.call({1:2},1);r.f=s?function(a){var i=o(this,a);return!!i&&i.enumerable}:n},function(t,r,e){t.exports=e(618)},function(t,r,e){var n=e(8),o=e(9),s=e(0),a=s.notundef,i=s.fillPropertyWithDefault,u={0:"normal",1:"owner",2:"manager"};function d(c){s.verifyOptions(c,"teamId","team::TeamMember"),s.verifyParamAtLeastPresentOne(c,"nickInTeam muteTeam muteNotiType custom","team::TeamMember"),this.teamId=c.teamId,a(c.account)&&(this.account=c.account),a(c.nickInTeam)&&(this.nickInTeam=c.nickInTeam),a(c.muteNotiType)?this.bits=c.muteNotiType:a(c.muteTeam)&&(this.bits=0,c.muteTeam&&(this.bits+=1)),a(c.mute)&&(this.mute=c.mute?1:0),a(c.custom)&&(this.custom=""+c.custom)}d.reverse=function(c){var m=s.copy(c);if(a(m.teamId)&&(m.teamId=""+m.teamId),a(m.type)&&(m.type=u[m.type]),a(m.active)&&(m.active=+m.active==1),a(m.valid)&&(m.valid=+m.valid==1),a(m.mute)&&(m.mute=+m.mute==1),a(m.joinTime)&&(m.joinTime=+m.joinTime),a(m.updateTime)&&(m.updateTime=+m.updateTime),a(m.bits)){var v=m.bits;delete m.bits,m.muteTeam=!!(1&v),m.muteNotiType=v}return a(m.teamId)&&a(m.account)&&(m.id=d.genId(m.teamId,m.account)),m},d.reverseMembers=function(c){return n(c).call(c,function(m){return o(d).call(d,m)})},d.fillProperties=function(c){var m=i(c,"mute",!1),v=i(c,"custom","");return m||v},d.genId=function(c,m){return c+"-"+m},d.accounts2ids=function(c,m){return n(m).call(m,function(v){return d.genId(c,v)})},d.assembleMembers=function(c,m){return s.isArray(m)||(m=[m]),n(m).call(m,function(v){return d.assembleMember(c,v)})},d.assembleMember=function(c,m){return{id:d.genId(c.teamId,m),account:m,teamId:c.teamId,type:"normal",nickInTeam:"",muteTeam:!1,mute:!1,joinTime:c.memberUpdateTime,updateTime:c.memberUpdateTime,active:!0,valid:!0,invitorAccid:""}},d.assembleOwner=function(c){var m=d.assembleMember(c,c.owner);return m.type="owner",m},t.exports=d},function(t,r,e){var n,o=e(26),s=e(6),a=e(10),i=e(7),u=e(5),d=e(15),c=e(9),m=e(17),v=e(8),g=e(2),b=e(0),T=b.undef,k=b.notundef,y=e(147).IM,O=e(192),D=e(150),he={customP2p:100,customTeam:101,customSuperTeam:103,deleteMsgP2p:7,deleteMsgTeam:8,deleteMsgSuperTeam:12,deleteOnewayMsgP2p:13,deleteOnewayMsgTeam:14},ae={0:"applyTeam",1:"rejectTeamApply",2:"teamInvite",3:"rejectTeamInvite",5:"friendRequest",6:"deleteFriend",7:"deleteMsgP2p",8:"deleteMsgTeam",12:"deleteMsgSuperTeam",13:"deleteMsgP2pOneWay",14:"deleteMsgTeamOneWay",15:"applySuperTeam",16:"rejectSuperTeamApply",17:"superTeamInvite",18:"rejectSuperTeamInvite",100:"customP2p",101:"customTeam",103:"customSuperTeam",102:"customP2p"},Ne={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"},ue=["team","superTeam","friend","msg"],Y={applyTeam:"team",rejectTeamApply:"team",teamInvite:"team",rejectTeamInvite:"team",applySuperTeam:"superTeam",rejectSuperTeamApply:"superTeam",superTeamInvite:"superTeam",rejectSuperTeamInvite:"superTeam",addFriend:"friend",applyFriend:"friend",passFriendApply:"friend",rejectFriendApply:"friend",deleteFriend:"friend",deleteMsg:"msg"};function _e(Ce){var ze,ie;b.verifyOptions(Ce,"type to","sysmsg::SystemMessage"),b.verifyParamValid("type",Ce.type,_e.validTypes,"sysmsg::SystemMessage"),s(ze=Ce.type).call(ze,"custom")!==-1&&(b.verifyOptions(Ce,"content","sysmsg::SystemMessage"),this.attach=Ce.content,k(Ce.apnsText)&&(this.apnsText=""+Ce.apnsText),k(Ce.pushPayload)&&(o(Ce.pushPayload)==="object"?this.pushPayload=a(Ce.pushPayload):this.pushPayload=""+Ce.pushPayload),k(Ce.sendToOnlineUsersOnly)&&(this.sendToOnlineUsersOnly=Ce.sendToOnlineUsersOnly?0:1),k(Ce.cc)&&(this.cc=Ce.cc?1:0),k(Ce.isPushable)&&(this.isPushable=Ce.isPushable?1:0),k(Ce.isUnreadable)&&(this.isUnreadable=Ce.isUnreadable?1:0),k(Ce.needPushNick)&&(this.needPushNick=Ce.needPushNick?1:0)),s(ie=Ce.type).call(ie,"deleteMsg")===0&&(Ce.apnsText&&(this.apnsText=Ce.apnsText),Ce.pushPayload&&(this.pushPayload=Ce.pushPayload),Ce.attach&&(this.attach=Ce.attach)),this.time=Ce.time||+new Date,this.type=he[Ce.type],this.to=Ce.to,k(Ce.from)&&(this.from=Ce.from),k(Ce.ps)&&(this.ps=Ce.ps),k(Ce.deletedIdClient)&&(this.deletedIdClient=Ce.deletedIdClient),k(Ce.deletedIdServer)&&(this.deletedIdServer=Ce.deletedIdServer),k(Ce.opeAccount)&&(this.opeAccount=Ce.opeAccount),k(Ce.yidunEnable)&&(this.yidunEnable=Ce.yidunEnable?1:0),k(Ce.antiSpamContent)&&(o(Ce.antiSpamContent)==="object"?this.antiSpamContent=a(Ce.antiSpamContent):this.antiSpamContent=""+Ce.antiSpamContent),k(Ce.antiSpamBusinessId)&&(o(Ce.antiSpamBusinessId)==="object"?this.antiSpamBusinessId=a(Ce.antiSpamBusinessId):this.antiSpamBusinessId=""+Ce.antiSpamBusinessId),k(Ce.env)&&(this.env=Ce.env),this.idClient=Ce.idClient||b.guid()}_e.validTypes=i(n=u(he)).call(n,u(Y)),_e.validCategories=["team","friend"],_e.isCustom=function(Ce){return Ce.type==="custom"},_e.reverse=function(Ce){var ze,ie,le={time:+Ce.time,to:Ce.to,type:ae[Ce.type]};if(k(Ce.from)&&(le.from=Ce.from),k(Ce.idClient)&&(le.idClient=Ce.idClient),k(Ce.idServer)&&(le.idServer=""+Ce.idServer),k(Ce.deletedIdClient)&&(le.deletedIdClient=Ce.deletedIdClient),k(Ce.deletedIdServer)&&(le.deletedIdServer=""+Ce.deletedIdServer),k(Ce.deletedMsgTime)&&(le.deletedMsgTime=+Ce.deletedMsgTime),k(Ce.deletedMsgFromNick)&&(le.deletedMsgFromNick=""+Ce.deletedMsgFromNick),k(Ce.opeAccount)&&(le.opeAccount=Ce.opeAccount),k(Ce.ps)&&(le.ps=Ce.ps),k(Ce.callbackExt)&&(le.callbackExt=Ce.callbackExt),Ce.attach=Ce.attach?""+Ce.attach:"",le.type==="customP2p"||le.type==="customTeam"||le.type==="customSuperTeam")le.content=Ce.attach,k(Ce.apnsText)&&(le.apnsText=Ce.apnsText),k(Ce.pushPayload)&&(le.pushPayload=Ce.pushPayload),b.merge(le,{sendToOnlineUsersOnly:T(Ce.sendToOnlineUsersOnly)||+Ce.sendToOnlineUsersOnly==0,cc:T(Ce.cc)||+Ce.cc==1,isPushable:T(Ce.isPushable)||+Ce.isPushable==1,isUnreadable:T(Ce.isUnreadable)||+Ce.isUnreadable==1,needPushNick:k(Ce.needPushNick)&&+Ce.needPushNick==1}),le.scene=d(ie=le.type).call(ie,6).toLowerCase(),le.type="custom";else if(s(ze=le.type).call(ze,"deleteMsg")===0){Ce.apnsText&&(le.apnsText=Ce.apnsText),Ce.pushPayload&&(le.pushPayload=Ce.pushPayload),Ce.attach&&(le.attach=Ce.attach);var Ie=le.type.toLowerCase();s(Ie).call(Ie,"p2p")>-1?le.scene="p2p":s(Ie).call(Ie,"superteam")>-1?le.scene="superTeam":s(Ie).call(Ie,"team")>-1&&(le.scene="team"),le.type="deleteMsg"}else{if(Ce.attach){le.attach={};var pe=JSON.parse(Ce.attach);k(pe.vt)?(le.type=Ne[pe.vt],pe.serverex&&pe.serverex[0]===1&&(le.serverex=pe.serverex[1]),delete le.attach):(k(pe.tinfo)&&(le.attach.team=c(O).call(O,y.syncUnserialize(pe.tinfo,"team"))),k(pe.tlist)&&(le.attach.member=c(D).call(D,y.syncUnserialize(pe.tlist,"teamMember"))),k(pe.attach)&&(le.attach.custom=pe.attach))}le.category=Y[le.type],le.read=!1,le.state="init"}return k(Ce.cc)&&(le.cc=+Ce.cc==1),le.status=Ce.status||"success",k(m(Ce))&&(le.filter=m(Ce)),le},_e.reverseSysMsgs=function(Ce,ze){var ie=(ze=ze||{}).mapper,le=b.isFunction(ie);return v(Ce).call(Ce,function(Ie){return Ie=c(_e).call(_e,Ie),le&&(Ie=ie(Ie)),Ie})},_e.completeUnread=function(Ce){var ze,ie;return Ce=Ce||{},g(ue).call(ue,function(le){delete Ce[le]}),g(ze=u(Y)).call(ze,function(le){Ce[le]=Ce[le]||0,Ce[le]<0&&(Ce[le]=0),Ce[ie=Y[le]]=Ce[ie]||0,Ce[ie]=Ce[ie]+Ce[le]}),Ce.total=0,g(ue).call(ue,function(le){Ce.total+=Ce[le]}),Ce},t.exports=_e},function(t,r,e){var n=e(120),o=["unreadMsgs"],s=e(0);function a(){}a.parse=function(i){var u=i.split("|");return{scene:u[0],to:u[1]}},a.genSessionByMsg=function(i){return{id:i.sessionId,scene:i.scene,to:i.target,updateTime:i.time,lastMsg:i}},a.appendLastMsg=function(i){var u=i.lastMsg;i["last"+s.capFirstLetter(u.type)+"Msg"]=u,i["last"+s.capFirstLetter(u.flow)+"Msg"]=u},a.genSessionByMsgs=function(i,u){var d=i.getLastNotIgnoredMsg(u);return d?a.genSessionByMsg(d):null},a.trim=function(i){var u=i=s.simpleClone(i);return u.unreadMsgs,n(u,o)},a.isComplete=function(i){return i.id&&i.scene&&i.to},t.exports=a},function(t,r,e){t.exports=e(330)},function(t,r,e){var n=e(487);t.exports=function(o){return n(o,5)}},function(t,r,e){var n=e(18),o=e(170),s={V2NIM_LOGIN_STATUS_LOGOUT:0,V2NIM_LOGIN_STATUS_LOGINED:1,V2NIM_LOGIN_STATUS_LOGINING:2},a={V2NIM_CONNECT_STATUS_DISCONNECTED:0,V2NIM_CONNECT_STATUS_CONNECTED:1,V2NIM_CONNECT_STATUS_CONNECTING:2,V2NIM_CONNECT_STATUS_WAITING:3};function i(u){this.loginStatus=s.V2NIM_LOGIN_STATUS_LOGOUT,this.connectStatus=a.V2NIM_CONNECT_STATUS_DISCONNECTED,this.logger=u.logger,this.setMonitor()}i.prototype=n(new o),i.prototype.setMonitor=function(){var u=this;this.on("auth/loginLifeCycleAddressing",function(){u.logger.log("auth::life cycle addressing"),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGINING),u.setConnectStatus(a.V2NIM_CONNECT_STATUS_CONNECTING)}),this.on("auth/loginLifeCycleConnect",function(){u.logger.log("auth::life cycle connecting"),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGINING),u.setConnectStatus(a.V2NIM_CONNECT_STATUS_CONNECTING)}),this.on("auth/loginLifeCycleConnectSucc",function(){u.logger.log("auth::life cycle connect success"),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGINING),u.setConnectStatus(a.V2NIM_CONNECT_STATUS_CONNECTED)}),this.on("auth/loginLifeCycleConnectFail",function(d){u.logger.log("auth::life cycle connect fail"),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGOUT),u.setConnectStatus(a.V2NIM_CONNECT_STATUS_DISCONNECTED,d)}),this.on("auth/loginLifeCycleDisconnected",function(d){u.logger.log("auth::life cycle disconnected:",d&&d.message),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGOUT),u.setConnectStatus(a.V2NIM_CONNECT_STATUS_DISCONNECTED,d)}),this.on("auth/loginLifeCycleLoginSucc",function(){u.logger.log("auth::life cycle login success, verify authentication success"),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGINED)}),this.on("auth/loginLifeCycleLoginFail",function(d){u.logger.log("auth::life cycle login fail due to verify authentication failed:",d),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGOUT,d)}),this.on("auth/loginLifeCycleLogout",function(){u.logger.log("auth::life cycle logout"),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGOUT)}),this.on("auth/loginLifeCycleKicked",function(d){u.logger.log("auth::life cycle kicked",d),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGOUT)}),this.on("auth/loginLifeCycleWaiting",function(){u.logger.log("auth::life cycle waiting to reconnect"),u.getConnectStatus(),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGOUT),u.setConnectStatus(a.V2NIM_CONNECT_STATUS_WAITING)})},i.prototype.getConnectStatus=function(){return this.connectStatus},i.prototype.getLoginStatus=function(){return this.loginStatus},i.prototype.setLoginStatus=function(u,d){if(u!==this.loginStatus){var c=this.loginStatus;this.loginStatus=u,this.emit("loginStatus",u),this.delegateLoginEvent(c,u,d)}},i.prototype.delegateLoginEvent=function(u,d,c){u===s.V2NIM_LOGIN_STATUS_LOGINING&&d===s.V2NIM_LOGIN_STATUS_LOGOUT&&this.emit("loginFailed",c)},i.prototype.setConnectStatus=function(u,d){if(u!==this.connectStatus){var c=this.connectStatus;this.connectStatus=u,this.emit("connectStatus",u),this.delegateConnectEvent(c,u,d)}},i.prototype.delegateConnectEvent=function(u,d,c){u===a.V2NIM_CONNECT_STATUS_CONNECTED&&d===a.V2NIM_CONNECT_STATUS_DISCONNECTED&&this.emit("disconnected",c),u===a.V2NIM_CONNECT_STATUS_CONNECTING&&d===a.V2NIM_CONNECT_STATUS_CONNECTED&&this.emit("connectSuccess"),u===a.V2NIM_CONNECT_STATUS_CONNECTING&&d===a.V2NIM_CONNECT_STATUS_DISCONNECTED&&this.emit("connectFailed",c),u!==a.V2NIM_CONNECT_STATUS_DISCONNECTED&&this.connectStatus!==a.V2NIM_CONNECT_STATUS_WAITING||d!==a.V2NIM_CONNECT_STATUS_CONNECTING||this.emit("connecting")},i.prototype.destroy=function(){this.removeAllListeners()},t.exports={V2NIMLoginStatus:s,V2NIMConnectStatus:a,StatusProtector:i}},function(t,r,e){var n=e(63),o=e(11);t.exports=function(s){if(n(s)==="Function")return o(s)}},function(t,r,e){var n=e(31),o=e(91);t.exports=function(s,a){var i=s[a];return o(i)?void 0:n(i)}},function(t,r,e){var n=e(14),o=e(321),s=n["__core-js_shared__"]||o("__core-js_shared__",{});t.exports=s},function(t,r,e){var n=e(14),o=e(28),s=n.document,a=o(s)&&o(s.createElement);t.exports=function(i){return a?s.createElement(i):{}}},function(t,r,e){var n=e(43),o=e(128),s=e(45),a=function(i){return function(u,d,c){var m,v=n(u),g=s(v),b=o(c,g);if(i&&d!=d){for(;g>b;)if((m=v[b++])!=m)return!0}else for(;g>b;b++)if((i||b in v)&&v[b]===d)return i||b||0;return!i&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},function(t,r,e){var n=e(327);t.exports=function(o,s){return new(n(o))(s===0?0:s)}},function(t,r,e){var n={};n[e(20)("toStringTag")]="z",t.exports=String(n)==="[object z]"},function(t,r,e){var n=e(27),o=e(211),s=e(38),a=e(36),i=e(43),u=e(118);r.f=n&&!o?Object.defineProperties:function(d,c){a(d);for(var m,v=i(c),g=u(c),b=g.length,T=0;b>T;)s.f(d,m=g[T++],v[m]);return d}},function(t,r){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,r,e){var n=e(63),o=e(43),s=e(131).f,a=e(220),i=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(u){return i&&n(u)=="Window"?function(d){try{return s(d)}catch{return a(i)}}(u):s(o(u))}},function(t,r,e){var n=e(1),o=e(19),s=e(48),a=e(226),i=e(16),u=e(355),d=e(134),c=e(135),m=e(81),v=e(53),g=e(66),b=e(20),T=e(99),k=e(227),y=a.PROPER,O=a.CONFIGURABLE,D=k.IteratorPrototype,he=k.BUGGY_SAFARI_ITERATORS,ae=b("iterator"),Ne=function(){return this};t.exports=function(ue,Y,_e,Ce,ze,ie,le){u(_e,Y,Ce);var Ie,pe,qe,$e=function(Fe){if(Fe===ze&&sr)return sr;if(!he&&Fe in dr)return dr[Fe];switch(Fe){case"keys":case"values":case"entries":return function(){return new _e(this,Fe)}}return function(){return new _e(this)}},Lt=Y+" Iterator",Dt=!1,dr=ue.prototype,pr=dr[ae]||dr["@@iterator"]||ze&&dr[ze],sr=!he&&pr||$e(ze),hr=Y=="Array"&&dr.entries||pr;if(hr&&(Ie=d(hr.call(new ue)))!==Object.prototype&&Ie.next&&(s||d(Ie)===D||(c?c(Ie,D):i(Ie[ae])||g(Ie,ae,Ne)),m(Ie,Lt,!0,!0),s&&(T[Lt]=Ne)),y&&ze=="values"&&pr&&pr.name!=="values"&&(!s&&O?v(dr,"name","values"):(Dt=!0,sr=function(){return o(pr,this)})),ze)if(pe={values:$e("values"),keys:ie?sr:$e("keys"),entries:$e("entries")},le)for(qe in pe)(he||Dt||!(qe in dr))&&g(dr,qe,pe[qe]);else n({target:Y,proto:!0,forced:he||Dt},pe);return s&&!le||dr[ae]===sr||g(dr,ae,sr,{name:ze}),T[Y]=sr,pe}},function(t,r){t.exports=function(e,n){return{value:e,done:n}}},function(t,r,e){var n=e(21),o=TypeError;t.exports=function(s,a){if(n(a,s))return s;throw o("Incorrect invocation")}},function(t,r,e){var n=e(129),o=e(78),s=TypeError;t.exports=function(a){if(n(a))return a;throw s(o(a)+" is not a constructor")}},function(t,r,e){var n=Object.prototype.hasOwnProperty,o="~";function s(){}function a(c,m,v){this.fn=c,this.context=m,this.once=v||!1}function i(c,m,v,g,b){if(typeof v!="function")throw new TypeError("The listener must be a function");var T=new a(v,g||c,b),k=o?o+m:m;return c._events[k]?c._events[k].fn?c._events[k]=[c._events[k],T]:c._events[k].push(T):(c._events[k]=T,c._eventsCount++),c}function u(c,m){--c._eventsCount==0?c._events=new s:delete c._events[m]}function d(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(o=!1)),d.prototype.eventNames=function(){var c,m,v=[];if(this._eventsCount===0)return v;for(m in c=this._events)n.call(c,m)&&v.push(o?m.slice(1):m);return Object.getOwnPropertySymbols?v.concat(Object.getOwnPropertySymbols(c)):v},d.prototype.listeners=function(c){var m=o?o+c:c,v=this._events[m];if(!v)return[];if(v.fn)return[v.fn];for(var g=0,b=v.length,T=new Array(b);g<b;g++)T[g]=v[g].fn;return T},d.prototype.listenerCount=function(c){var m=o?o+c:c,v=this._events[m];return v?v.fn?1:v.length:0},d.prototype.emit=function(c,m,v,g,b,T){var k=o?o+c:c;if(!this._events[k])return!1;var y,O,D=this._events[k],he=arguments.length;if(D.fn){switch(D.once&&this.removeListener(c,D.fn,void 0,!0),he){case 1:return D.fn.call(D.context),!0;case 2:return D.fn.call(D.context,m),!0;case 3:return D.fn.call(D.context,m,v),!0;case 4:return D.fn.call(D.context,m,v,g),!0;case 5:return D.fn.call(D.context,m,v,g,b),!0;case 6:return D.fn.call(D.context,m,v,g,b,T),!0}for(O=1,y=new Array(he-1);O<he;O++)y[O-1]=arguments[O];D.fn.apply(D.context,y)}else{var ae,Ne=D.length;for(O=0;O<Ne;O++)switch(D[O].once&&this.removeListener(c,D[O].fn,void 0,!0),he){case 1:D[O].fn.call(D[O].context);break;case 2:D[O].fn.call(D[O].context,m);break;case 3:D[O].fn.call(D[O].context,m,v);break;case 4:D[O].fn.call(D[O].context,m,v,g);break;default:if(!y)for(ae=1,y=new Array(he-1);ae<he;ae++)y[ae-1]=arguments[ae];D[O].fn.apply(D[O].context,y)}}return!0},d.prototype.on=function(c,m,v){return i(this,c,m,v,!1)},d.prototype.once=function(c,m,v){return i(this,c,m,v,!0)},d.prototype.removeListener=function(c,m,v,g){var b=o?o+c:c;if(!this._events[b])return this;if(!m)return u(this,b),this;var T=this._events[b];if(T.fn)T.fn!==m||g&&!T.once||v&&T.context!==v||u(this,b);else{for(var k=0,y=[],O=T.length;k<O;k++)(T[k].fn!==m||g&&!T[k].once||v&&T[k].context!==v)&&y.push(T[k]);y.length?this._events[b]=y.length===1?y[0]:y:u(this,b)}return this},d.prototype.removeAllListeners=function(c){var m;return c?(m=o?o+c:c,this._events[m]&&u(this,m)):(this._events=new s,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=o,d.EventEmitter=d,t.exports=d},function(t,r,e){t.exports=e(424)},function(t,r,e){var n=e(83)(e(50),"Map");t.exports=n},function(t,r,e){var n=e(50).Symbol;t.exports=n},function(t,r,e){var n=e(262),o=e(526),s=e(200);t.exports=function(a){return s(a)?n(a):o(a)}},function(t,r){var e=Array.isArray;t.exports=e},function(t,r){t.exports=function(e){return function(n){return e(n)}}},function(t,r,e){(function(n){var o=e(257),s=r&&!r.nodeType&&r,a=s&&typeof n=="object"&&n&&!n.nodeType&&n,i=a&&a.exports===s&&o.process,u=function(){try{var d=a&&a.require&&a.require("util").types;return d||i&&i.binding&&i.binding("util")}catch{}}();n.exports=u}).call(this,e(145)(t))},function(t,r){var e=Object.prototype;t.exports=function(n){var o=n&&n.constructor;return n===(typeof o=="function"&&o.prototype||e)}},function(t,r,e){var n=e(262),o=e(529),s=e(200);t.exports=function(a){return s(a)?n(a,!0):o(a)}},function(t,r,e){var n=e(534),o=e(266),s=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,i=a?function(u){return u==null?[]:(u=Object(u),n(a(u),function(d){return s.call(u,d)}))}:o;t.exports=i},function(t,r,e){var n=e(538),o=e(172),s=e(539),a=e(271),i=e(540),u=e(119),d=e(258),c=d(n),m=d(o),v=d(s),g=d(a),b=d(i),T=u;(n&&T(new n(new ArrayBuffer(1)))!="[object DataView]"||o&&T(new o)!="[object Map]"||s&&T(s.resolve())!="[object Promise]"||a&&T(new a)!="[object Set]"||i&&T(new i)!="[object WeakMap]")&&(T=function(k){var y=u(k),O=y=="[object Object]"?k.constructor:void 0,D=O?d(O):"";if(D)switch(D){case c:return"[object DataView]";case m:return"[object Map]";case v:return"[object Promise]";case g:return"[object Set]";case b:return"[object WeakMap]"}return y}),t.exports=T},function(t,r,e){var n=e(543);t.exports=function(o){var s=new o.constructor(o.byteLength);return new n(s).set(new n(o)),s}},function(t,r,e){var n=e(11),o=e(108),s=e(49),a=e(146),i=n("".replace),u="["+a+"]",d=RegExp("^"+u+u+"*"),c=RegExp(u+u+"*$"),m=function(v){return function(g){var b=s(o(g));return 1&v&&(b=i(b,d,"")),2&v&&(b=i(b,c,"")),b}};t.exports={start:m(1),end:m(2),trim:m(3)}},function(t,r,e){var n=e(116),o=e(579);n.json=o,t.exports=n},function(t,r,e){var n=e(18),o=e(23),s=e(6),a=e(2),i=e(54),u=i.f,d=e(571);function c(v){v.onload&&this.once("load",v.onload),v.onerror&&this.once("error",v.onerror),v.onbeforesend&&this.once("beforesend",v.onbeforesend),v.onaftersend&&this.once("aftersend",v.onaftersend);var g=(v=this.options=i.fetch({method:"GET",url:"",sync:!1,data:null,headers:{},cookie:!1,timeout:6e4,type:"text",form:null,input:null,putFileAtEnd:!1,proxyUrl:""},v)).headers;i.notexist(g["Content-Type"])&&(g["Content-Type"]="application/x-www-form-urlencoded"),this.send()}var m=c.prototype=n(d.prototype);m.send=function(){var v=this,g=v.options;o(function(){try{try{v.emit("beforesend",g)}catch{}v.doSend()}catch(b){v.onError("serverError",":"+b.message)}},0)},m.doSend=u,m.afterSend=function(){var v=this;o(function(){v.emit("aftersend",v.options)},0)},m.onLoad=function(v){var g,b=this.options,T=v.status,k=v.result;if(typeof T!="number"||T!==0)if(s(g=""+T).call(g,"2")===0){if(b.type==="json")try{k=JSON.parse(k)}catch{return void this.onError("parseError",k)}this.emit("load",k)}else this.onError("serverError","",{status:T,result:k,date:v.date});else this.onError("netError","",{status:408})},m.onError=function(v,g,b){var T=i.isObject(b)?b:{};T.code=v||"error",T.message=g||"",this.emit("error",T)},m.onTimeout=function(){this.onError("timeout","")},m.abort=function(){this.onError("abort","")},m.header=function(v){var g=this;if(!i.isArray(v))return g.getResponseHeader(v||"");var b={};return a(v).call(v,function(T){b[T]=g.header(T)}),b},m.getResponseHeader=u,m.destroy=u,t.exports=c},function(t,r,e){t.exports=e(596)},function(t,r,e){t.exports=e(609)},function(t,r,e){var n=e(189),o=e(149);function s(a,i){var u;return t.exports=s=n?o(u=n).call(u):function(d,c){return d.__proto__=c,d},t.exports.__esModule=!0,t.exports.default=t.exports,s(a,i)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(612)},function(t,r,e){var n=e(189),o=e(149),s=e(282);function a(i){var u;return t.exports=a=n?o(u=s).call(u):function(d){return d.__proto__||s(d)},t.exports.__esModule=!0,t.exports.default=t.exports,a(i)}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r){var e={link:{id:1,heartbeat:2,negotiateTransport:5,initTransport:6},sync:{id:5,sync:1,syncTeamMembers:2},misc:{id:6,getSimpleNosToken:1,getNosToken:2,notifyUploadLog:3,uploadSdkLogUrl:4,audioToText:5,processImage:6,getNosTokenTrans:7,notifyTransLog:8,fetchFile:9,fetchFileList:10,removeFile:11,getClientAntispam:17,fileQuickTransfer:18,getNosOriginUrl:22,getServerTime:23,getNosAccessToken:24,deleteNosAccessToken:25,getNosCdnHost:26,getGrayscaleConfig:27,getMixStorePolicy:28,getMixStoreToken:29,getBackSourceToken:30,uploadDetect:32},avSignal:{id:15,signalingCreate:1,signalingDelay:2,signalingClose:3,signalingJoin:4,signalingLeave:5,signalingInvite:6,signalingCancel:7,signalingReject:8,signalingAccept:9,signalingControl:10,signalingNotify:11,signalingMutilClientSyncNotify:12,signalingUnreadMessageSyncNotify:13,signalingChannelsSyncNotify:14,signalingGetChannelInfo:15,signalingCallEx:16,signalingJoinAndAccept:17}},n={heartbeat:{sid:e.link.id,cid:e.link.heartbeat},negotiateTransport:{sid:e.link.id,cid:e.link.negotiateTransport,params:[{type:"int",name:"sdkVersion"},{type:"Property",name:"negotiateTransportTag"}]},initTransport:{sid:e.link.id,cid:e.link.initTransport,params:[{type:"Property",name:"initTransportTag"}]},getGrayscaleConfig:{sid:e.misc.id,cid:e.misc.getGrayscaleConfig,params:[{type:"Property",name:"providers"}]},getMixStorePolicy:{sid:e.misc.id,cid:e.misc.getMixStorePolicy,params:[{type:"LongArray",name:"providers"}]},getMixStoreToken:{sid:e.misc.id,cid:e.misc.getMixStoreToken,params:[{type:"Property",name:"mixTokenReq"}]},getBackSourceToken:{sid:e.misc.id,cid:e.misc.getBackSourceToken,params:[{type:"Property",name:"mixAuthTokenReq"}]},uploadDetect:{sid:e.misc.id,cid:e.misc.uploadDetect,isAwaitable:!1,params:[{type:"Property",name:"notifyDetectTag"}]},getSimpleNosToken:{sid:e.misc.id,cid:e.misc.getSimpleNosToken,params:[{type:"int",name:"num"}]},getNosToken:{sid:e.misc.id,cid:e.misc.getNosToken,params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken"}]},uploadSdkLogUrl:{sid:e.misc.id,cid:e.misc.uploadSdkLogUrl,params:[{type:"string",name:"url"}]},audioToText:{sid:e.misc.id,cid:e.misc.audioToText,params:[{type:"Property",name:"audioToText"}]},processImage:{sid:e.misc.id,cid:e.misc.processImage,params:[{type:"String",name:"url"},{type:"PropertyArray",name:"imageOps",entity:"imageOp"}]},getClientAntispam:{sid:e.misc.id,cid:e.misc.getClientAntispam,params:[{type:"Property",name:"clientAntispam"}]},fileQuickTransfer:{sid:e.misc.id,cid:e.misc.fileQuickTransfer,params:[{type:"Property",name:"fileQuickTransfer"}]},getNosOriginUrl:{sid:e.misc.id,cid:e.misc.getNosOriginUrl,params:[{type:"Property",name:"nosFileUrlTag"}]},getServerTime:{sid:e.misc.id,cid:e.misc.getServerTime,params:[]},getNosAccessToken:{sid:e.misc.id,cid:e.misc.getNosAccessToken,params:[{type:"Property",name:"nosAccessTokenTag"}]},deleteNosAccessToken:{sid:e.misc.id,cid:e.misc.deleteNosAccessToken,params:[{type:"Property",name:"nosAccessTokenTag"}]},getNosTokenTrans:{sid:e.misc.id,cid:e.misc.getNosTokenTrans,params:[{type:"Property",name:"transToken"}]},fetchFile:{sid:e.misc.id,cid:e.misc.fetchFile,params:[{type:"String",name:"docId"}]},fetchFileList:{sid:e.misc.id,cid:e.misc.fetchFileList,params:[{type:"Property",name:"fileListParam"}]},removeFile:{sid:e.misc.id,cid:e.misc.removeFile,params:[{type:"String",name:"docId"}]},getNosCdnHost:{sid:e.misc.id,cid:e.misc.getNosCdnHost,params:[]},signalingCreate:{sid:e.avSignal.id,cid:e.avSignal.signalingCreate,params:[{type:"Property",name:"avSignalTag"}]},signalingDelay:{sid:e.avSignal.id,cid:e.avSignal.signalingDelay,params:[{type:"Property",name:"avSignalTag"}]},signalingClose:{sid:e.avSignal.id,cid:e.avSignal.signalingClose,params:[{type:"Property",name:"avSignalTag"}]},signalingJoin:{sid:e.avSignal.id,cid:e.avSignal.signalingJoin,params:[{type:"Property",name:"avSignalTag"}]},signalingLeave:{sid:e.avSignal.id,cid:e.avSignal.signalingLeave,params:[{type:"Property",name:"avSignalTag"}]},signalingInvite:{sid:e.avSignal.id,cid:e.avSignal.signalingInvite,params:[{type:"Property",name:"avSignalTag"}]},signalingCancel:{sid:e.avSignal.id,cid:e.avSignal.signalingCancel,params:[{type:"Property",name:"avSignalTag"}]},signalingReject:{sid:e.avSignal.id,cid:e.avSignal.signalingReject,params:[{type:"Property",name:"avSignalTag"}]},signalingAccept:{sid:e.avSignal.id,cid:e.avSignal.signalingAccept,params:[{type:"Property",name:"avSignalTag"}]},signalingControl:{sid:e.avSignal.id,cid:e.avSignal.signalingControl,params:[{type:"Property",name:"avSignalTag"}]},signalingGetChannelInfo:{sid:e.avSignal.id,cid:e.avSignal.signalingGetChannelInfo,params:[{type:"Property",name:"avSignalTag"}]},signalingCallEx:{sid:e.avSignal.id,cid:e.avSignal.signalingCallEx,params:[{type:"Property",name:"avSignalTag"}]},signalingJoinAndAccept:{sid:e.avSignal.id,cid:e.avSignal.signalingJoinAndAccept,params:[{type:"Property",name:"avSignalTag"}]}};t.exports={idMap:e,cmdConfig:n,packetConfig:{"1_2":{service:"link",cmd:"heartbeat"},"1_5":{service:"link",cmd:"negotiateTransport",response:[{type:"Property",name:"negotiateTransportTag"}]},"1_6":{service:"link",cmd:"initTransport",response:[{type:"Property",name:"initTransportTag"}]},"6_1":{service:"misc",cmd:"getSimpleNosToken",response:[{type:"PropertyArray",name:"nosTokens",entity:"nosToken"}]},"6_2":{service:"misc",cmd:"getNosToken",response:[{type:"Property",name:"nosToken"}]},"6_3":{service:"misc",cmd:"notifyUploadLog"},"6_4":{service:"misc",cmd:"uploadSdkLogUrl"},"6_5":{service:"misc",cmd:"audioToText",response:[{type:"String",name:"text"}]},"6_6":{service:"misc",cmd:"processImage",response:[{type:"String",name:"url"}]},"6_7":{service:"misc",cmd:"getNosTokenTrans",response:[{type:"Property",name:"nosToken"},{type:"String",name:"docId"}]},"6_8":{service:"misc",cmd:"notifyTransLog",response:[{type:"Property",name:"transInfo"}]},"6_9":{service:"misc",cmd:"fetchFile",response:[{type:"Property",name:"info",entity:"transInfo"}]},"6_10":{service:"misc",cmd:"fetchFileList",response:[{type:"PropertyArray",name:"list",entity:"transInfo"},{type:"Number",name:"totalCount"}]},"6_11":{service:"misc",cmd:"removeFile",response:[{type:"String",name:"res"}]},"6_17":{service:"misc",cmd:"getClientAntispam",response:[{type:"Property",name:"clientAntispam"}]},"6_18":{service:"misc",cmd:"fileQuickTransfer",response:[{type:"Property",name:"fileQuickTransfer"}]},"6_22":{service:"misc",cmd:"getNosOriginUrl",response:[{type:"Property",name:"nosFileUrlTag"}]},"6_23":{service:"misc",cmd:"getServerTime",response:[{type:"Number",name:"time"}]},"6_24":{service:"misc",cmd:"getNosAccessToken",response:[{type:"Property",name:"nosAccessTokenTag"}]},"6_25":{service:"misc",cmd:"deleteNosAccessToken"},"6_26":{service:"misc",cmd:"getNosCdnHost",response:[{type:"Property",name:"nosConfigTag"}]},"6_27":{service:"misc",cmd:"getGrayscaleConfig",response:[{type:"Property",name:"appGrayConfigTag"}]},"6_28":{service:"misc",cmd:"getMixStorePolicy",response:[{type:"Property",name:"mixStorePolicyTag"}]},"6_29":{service:"misc",cmd:"getMixStoreToken",response:[{type:"Property",name:"mixStoreTokenTag"}]},"6_30":{service:"misc",cmd:"getBackSourceToken",response:[{type:"Property",name:"backSourceTokenTag"}]},"6_31":{service:"link",cmd:"notifyDetect",response:[{type:"Property",name:"notifyDetectTag"}]},"6_32":{service:"link",cmd:"uploadDetect",response:[]},"15_1":{service:"avSignal",cmd:"signalingCreate",response:[{type:"Property",name:"avSignalTag"}]},"15_2":{service:"avSignal",cmd:"signalingDelay",response:[{type:"Property",name:"avSignalTag"}]},"15_3":{service:"avSignal",cmd:"signalingClose",response:[{type:"Property",name:"avSignalTag"}]},"15_4":{service:"avSignal",cmd:"signalingJoin",response:[{type:"Property",name:"avSignalTag"}]},"15_5":{service:"avSignal",cmd:"signalingLeave",response:[]},"15_6":{service:"avSignal",cmd:"signalingInvite",response:[]},"15_7":{service:"avSignal",cmd:"signalingCancel",response:[]},"15_8":{service:"avSignal",cmd:"signalingReject",response:[]},"15_9":{service:"avSignal",cmd:"signalingAccept",response:[]},"15_10":{service:"avSignal",cmd:"signalingControl",response:[]},"15_11":{service:"avSignal",cmd:"signalingNotify",response:[{type:"Property",name:"avSignalTag"}]},"15_12":{service:"avSignal",cmd:"signalingMutilClientSyncNotify",response:[{type:"Property",name:"avSignalTag"}]},"15_13":{service:"avSignal",cmd:"signalingUnreadMessageSyncNotify",response:[{type:"PropertyArray",name:"avSignalTag"}]},"15_14":{service:"avSignal",cmd:"signalingChannelsSyncNotify",response:[{type:"PropertyArray",name:"avSignalTag"}]},"15_15":{service:"avSignal",cmd:"signalingGetChannelInfo",response:[{type:"Property",name:"avSignalTag"}]},"15_16":{service:"avSignal",cmd:"signalingCallEx",response:[{type:"Property",name:"avSignalTag"}]},"15_17":{service:"avSignal",cmd:"signalingJoinAndAccept",response:[{type:"Property",name:"avSignalTag"}]}}}},function(t,r,e){var n=e(5),o=e(2),s=e(25),a=e(0),i=a.notundef,u=a.fillPropertyWithDefault,d=n,c={},m={},v=[],g={},b={normal:0,advanced:1},T={0:"normal",1:"advanced"},k=d(b),y=c.joinMode={noVerify:0,needVerify:1,rejectAll:2};m.joinMode={0:"noVerify",1:"needVerify",2:"rejectAll"},v.push("join"),g.joinMode=d(y);var O=c.beInviteMode={needVerify:0,noVerify:1};m.beInviteMode={0:"needVerify",1:"noVerify"},v.push("beInvite"),g.beInviteMode=d(O);var D=c.inviteMode={manager:0,all:1};m.inviteMode={0:"manager",1:"all"},v.push("invite"),g.inviteMode=d(D);var he=c.updateTeamMode={manager:0,all:1};m.updateTeamMode={0:"manager",1:"all"},v.push("updateTeam"),g.updateTeamMode=d(he);var ae=c.updateCustomMode={manager:0,all:1};function Ne(Y){var _e;switch(a.verifyOptions(Y,"action","team::Team"),Y.action){case"create":a.verifyOptions(Y,"teamId",!1,"team::Team"),a.verifyOptions(Y,"type name","team::Team"),a.verifyParamValid("type",Y.type,k,"team::Team"),i(Y.level)&&(a.verifyParamType("level",Y.level,"number","team::Team"),this.level=Y.level);break;case"update":a.verifyOptions(Y,"teamId","team::Team"),a.verifyOptions(Y,"type",!1,"team::Team")}i(Y.teamId)&&(this.teamId=Y.teamId),i(Y.type)&&(this.type=b[Y.type]),i(Y.avatar)&&(this.avatar=""+Y.avatar),i(Y.name)&&(this.name=""+Y.name),i(Y.intro)&&(this.intro=""+Y.intro),i(Y.announcement)&&(this.announcement=""+Y.announcement),o(v).call(v,s(_e=this.setMode).call(_e,this,Y)),i(Y.custom)&&(this.custom=""+Y.custom)}function ue(Y,_e){i(Y[_e+="Mode"])&&(Y[_e]=m[_e][Y[_e]])}m.updateCustomMode={0:"manager",1:"all"},v.push("updateCustom"),g.updateCustomMode=d(ae),Ne.prototype.setMode=function(Y,_e){i(Y[_e+="Mode"])&&(a.verifyParamValid(_e,Y[_e],g[_e],"team::Team"),this[_e]=c[_e][Y[_e]])},Ne.reverse=function(Y,_e){var Ce=a.copy(Y);if(i(Ce.teamId)&&(Ce.teamId=""+Ce.teamId),i(Ce.type)&&(Ce.type=T[Ce.type]),i(Ce.level)&&(Ce.level=+Ce.level),i(Ce.valid)&&(Ce.valid=+Ce.valid==1),i(Ce.memberNum)&&(Ce.memberNum=+Ce.memberNum),i(Ce.memberUpdateTime)&&(Ce.memberUpdateTime=+Ce.memberUpdateTime),i(Ce.createTime)&&(Ce.createTime=+Ce.createTime),i(Ce.updateTime)&&(Ce.updateTime=+Ce.updateTime),i(Ce.validToCurrentUser)&&(Ce.validToCurrentUser=Ce.validToCurrentUser==="1"),i(Ce.mute)&&(Ce.mute=Ce.mute==="1"),i(Ce.muteType))switch(Ce.muteType){case"0":Ce.mute=!1,Ce.muteType="none";break;case"1":Ce.mute=!0,Ce.muteType="normal";break;case"3":Ce.mute=!0,Ce.muteType="all"}else i(Ce.mute)&&(Ce.mute===1?(Ce.mute=!0,Ce.muteType="normal"):(Ce.mute=!1,Ce.muteType="none"));return o(v).call(v,s(ue).call(ue,null,Ce)),delete Ce.bits,_e||Ne.fillProperties(Ce),Ce},Ne.fillProperties=function(Y){var _e=u(Y,"beInviteMode","needVerify"),Ce=u(Y,"inviteMode","manager"),ze=u(Y,"updateTeamMode","manager"),ie=u(Y,"updateCustomMode","manager"),le=u(Y,"avatar","");return _e||Ce||ze||ie||le},t.exports=Ne},function(t,r,e){var n=e(44).clientTypeMap;function o(){}o.reverse=function(s){var a=s;return a.type=n[a.type],a},o.reverseType=function(s){return n[s]||s},t.exports=o},function(t,r,e){var n=e(18),o=e(41),s=e(10),a=e(73),i=e(195),u=e(13),d=e(762),c=e(894),m=e(0),v=m.verifyOptions,g=m.verifyParamType,b=e(24).reportAPI,T=e(147).Chatroom,k=e(154);function y(D){var he=k(D);return this.subType="chatroom",this.nosScene=he.nosScene||"chatroom",this.nosSurvivalTime=he.nosSurvivalTime,he.Protocol=i,he.Message=c,he.constructor=y,he.isAnonymous&&(he.account=he.account||"nimanon_".concat(m.guid()),he.isAnonymous=1,m.verifyOptions(he,"chatroomNick","api::Chatroom"),he.chatroomAvatar=he.chatroomAvatar||" "),this.init(he)}y.Protocol=i,y.parser=T,y.use=a.use,y.getInstance=function(D){return D.isAnonymous&&(D.account=D.account||"nimanon_".concat(m.guid()),D.isAnonymous=1,m.verifyOptions(D,"chatroomNick","api::Chatroom.getInstance"),D.chatroomAvatar=D.chatroomAvatar||" "),a.getInstance.call(this,D)},y.genInstanceName=function(D){return m.verifyOptions(D,"chatroomId","api::Chatroom.genInstanceName"),"Chatroom-account-"+D.account+"-chatroomId-"+D.chatroomId};var O=y.fn=y.prototype=n(a.prototype);y.info=O.info=u.info,O.getChatroom=function(D){(D=D||{}).done=b({instance:this,className:"ChatroomFn",funcName:"getChatroom",done:D.done}),this.processCallback(D),this.sendCmd("getChatroom",D)},O.updateChatroom=function(D){(D=D||{}).done=b({instance:this,className:"ChatroomFn",funcName:"updateChatroom",done:D.done}),v(D,"chatroom needNotify","api::updateChatroom"),g("needNotify",D.needNotify,"boolean"),this.processCustom(D),this.processCallback(D),D.chatroom=new d(D.chatroom),D.antispamTag={antiSpamBusinessId:D.antiSpamBusinessId},this.sendCmd("updateChatroom",D)},O.closeChatroom=function(D){(D=D||{}).done=b({instance:this,className:"ChatroomFn",funcName:"closeChatroom",done:D.done}),this.processCustom(D),this.processCallback(D),this.sendCmd("closeChatroom",D)},O.updateTags=function(D){(D=D||{}).done=b({instance:this,className:"ChatroomFn",funcName:"updateTags",done:D.done}),m.validate({tags:{type:"array",required:!1},notifyTargetTags:{type:"string",allowEmpty:!0,required:!1},needNotify:{type:"boolean",required:!1}},D,"chatroom::updateTags");var he=o({},D);this.processCallback(he),he.tags&&(he.tags=s(he.tags)),he.needNotify&&(he.needNotify=he.needNotify?1:0),this.sendCmd("updateChatroomTags",{chatRoomTagsUpdateTag:he},he.done)},t.exports=y,e(904),e(905),e(906),e(907)},function(t,r,e){var n=e(18),o=e(25),s=e(8),a=e(9),i=e(75),u=e(0),d=u.undef,c=u.notundef,m=e(290),v=e(13),g=e(147),b=e(762),T=e(311);function k(D){var he,ae,Ne;u.verifyOptions(D,"appKey account chatroomId chatroomAddresses","protocol::ChatroomProtocol"),D.isAnonymous||u.verifyOptions(D,"token","protocol::ChatroomProtocol"),u.verifyParamType("chatroomAddresses",D.chatroomAddresses,"array","protocol::ChatroomProtocol"),u.verifyCallback(D,"onconnect onerror onwillreconnect ondisconnect onmsg onmsgs onrobots","protocol::ChatroomProtocol"),he=typeof u.get(D,"privateConf.isDataReportEnable")=="boolean"?D.privateConf.isDataReportEnable:v.privateConf.isDataReportEnable,ae=typeof u.get(D,"privateConf.reportConfigUrl")=="string"?D.privateConf.reportConfigUrl:v.privateConf.reportConfigUrl,Ne=typeof u.get(D,"privateConf.reportUrl")=="string"?D.privateConf.reportUrl:v.privateConf.reportUrl,this.reporter=m.initReporter({isDataReportEnable:he,reportConfigUrl:ae,reportUrl:Ne,appKey:D.appKey,logger:this.logger}),i.call(this,D)}var y=i.fn,O=k.fn=k.prototype=n(y);O.init=function(){var D;y.init.call(this),g.Chatroom.setProtocol(this),this.parser=g.Chatroom,o(D=this.sendCmd).call(D,this),this.syncResult={},this.timetags={},this.msgBuffer=[]},O.reset=function(){var D=this;y.reset.call(D);var he,ae=D.options;D.autoconnect=!!ae.autoconnect,d(ae.msgBufferInterval)&&(ae.msgBufferInterval=300),u.verifyParamType("msgBufferInterval",ae.msgBufferInterval,"number","protocol::ChatroomProtocol.reset"),d(ae.msgBufferSize)&&(ae.msgBufferSize=500),u.verifyParamType("msgBufferSize",ae.msgBufferSize,"number","protocol::ChatroomProtocol.reset"),c(ae.chatroomAddresses)&&(D.socketUrlsBackup=s(he=ae.chatroomAddresses).call(he,function(Ne){return v.formatSocketUrl({url:Ne,secure:D.options.secure})}))},O.processChatroom=function(D){switch(D.cmd){case"login":D.error||(D.obj={chatroom:a(b).call(b,D.content.chatroom),member:a(T).call(T,D.content.chatroomMember)},this.cdnInfo={},this.initCdnData(),clearTimeout(this.queryCdnTimer),this.onCdnMsgInfo(D.content.chatroomCdnInfo));break;case"kicked":this.onKicked(D);break;case"logout":break;case"sendMsg":this.onSendMsg(D);break;case"msg":this.onMsg(D),this.cdnInfo&&this.cdnInfo.enable&&this.correctCdnTime(+D.content.msg.time);break;case"getChatroomMembers":case"getChatroomMembersByTag":this.onChatroomMembers(D);break;case"getChatroomMemberCountByTag":this.onGetChatroomMemberCountByTag(D);break;case"getHistoryMsgs":case"getHistoryMsgsByTags":this.onHistoryMsgs(D);break;case"markChatroomMember":this.onMarkChatroomMember(D);break;case"closeChatroom":break;case"getChatroom":this.onChatroom(D);break;case"updateChatroom":break;case"updateMyChatroomMemberInfo":delete D.obj.chatroomMember;break;case"getChatroomMembersInfo":this.onChatroomMembersInfo(D);break;case"kickChatroomMember":case"updateChatroomMemberTempMute":break;case"queueList":D.error||(D.obj=D.content);break;case"syncRobot":this.onSyncRobot(D);break;case"notifyCdnInfo":this.onCdnMsgInfo(D.content&&D.content.chatroomCdnInfo);break;case"updateChatroomTag":this.onTagsUpdate(D.content)}},O.onChatroom=function(D){D.error||(D.obj.chatroom=a(b).call(b,D.content.chatroom))},O.onTagsUpdate=function(D){if(this.logger.info("onTagsUpdate:: ",D),this.options.onTagsUpdate&&typeof this.options.onTagsUpdate=="function"){var he=D.updateTags&&D.updateTags.currentTags;try{he=JSON.parse(he)}catch(ae){this.logger.error("onTagsUpdate:: parse tags failed",ae)}this.options.onTagsUpdate(he)}},t.exports=k,e(882),e(883),e(884),e(893)},function(t,r){t.exports=function(){}},function(t,r,e){t.exports=e(445)},function(t,r){t.exports=function(e,n){for(var o=n.split(".");o.length;){var s=o.shift(),a=!1;if(s[s.length-1]=="?"&&(s=s.slice(0,-1),a=!0),!(e=e[s])&&a)return e}return e}},function(t,r){t.exports=function(e,n){return e===n||e!=e&&n!=n}},function(t,r,e){var n=e(256),o=e(264);t.exports=function(s){return s!=null&&o(s.length)&&!n(s)}},function(t,r,e){t.exports=e(629)},function(t,r,e){var n=e(8),o=e(9),s=e(0),a=s.notundef,i=s.fillPropertyWithDefault,u={0:"normal",1:"owner",2:"manager"};function d(c){s.verifyOptions(c,"teamId","superTeam::TeamMember"),s.verifyParamAtLeastPresentOne(c,"nickInTeam muteTeam custom muteNotiType","superTeam::SuperTeamMember"),this.teamId=c.teamId,a(c.account)&&(this.account=c.account),a(c.nickInTeam)&&(this.nickInTeam=c.nickInTeam),a(c.muteNotiType)?this.bits=c.muteNotiType:a(c.muteTeam)&&(this.bits=0,c.muteTeam&&(this.bits+=1)),a(c.mute)&&(this.mute=c.mute?1:0),a(c.custom)&&(this.custom=""+c.custom)}d.reverse=function(c){var m=s.copy(c);if(a(m.teamId)&&(m.teamId=""+m.teamId),a(m.type)&&(m.type=u[m.type]),a(m.active)&&(m.active=+m.active==1),a(m.valid)&&(m.valid=+m.valid==1),a(m.mute)&&(m.mute=+m.mute==1),a(m.joinTime)&&(m.joinTime=+m.joinTime),a(m.updateTime)&&(m.updateTime=+m.updateTime),a(m.bits)){var v=m.bits;delete m.bits,m.muteTeam=!!(1&v),m.muteNotiType=v}return a(m.teamId)&&a(m.account)&&(m.id=d.genId(m.teamId,m.account)),m},d.reverseMembers=function(c){return n(c).call(c,function(m){return o(d).call(d,m)})},d.fillProperties=function(c){var m=i(c,"mute",!1),v=i(c,"custom","");return m||v},d.genId=function(c,m){return c+"-"+m},d.accounts2ids=function(c,m){return n(m).call(m,function(v){return d.genId(c,v)})},d.assembleMembers=function(c,m){return s.isArray(m)||(m=[m]),n(m).call(m,function(v){return d.assembleMember(c,v)})},d.assembleMember=function(c,m){return{id:d.genId(c.teamId,m),account:m,teamId:c.teamId,type:"normal",nickInTeam:"",muteTeam:!1,mute:!1,joinTime:c.memberUpdateTime,updateTime:c.memberUpdateTime,active:!0,valid:!0}},d.assembleOwner=function(c){var m=d.assembleMember(c,c.owner);return m.type="owner",m},t.exports=d},function(t,r,e){var n=e(8),o=e(9),s=e(5),a=e(106).genPrivateUrl,i=e(0),u={unknown:0,male:1,female:2},d={0:"unknown",1:"male",2:"female"};function c(m){i.merge(this,m),i.notundef(this.gender)&&(i.verifyParamValid("gender",this.gender,c.validGenders,"user::User"),this.gender=u[this.gender]),i.notundef(this.email)&&this.email!==""&&i.verifyEmail("email",this.email,"user::User"),i.notundef(this.birth)&&this.birth!==""&&i.verifyBirth("birth",this.birth,"user::User"),i.notundef(this.tel)&&this.tel!==""&&i.verifyTel("tel",this.tel,"user::User")}c.reverse=function(m,v,g){var b=i.filterObj(m,"account nick avatar _avatar_safe sign gender email birth tel custom createTime updateTime");return i.notundef(b.avatar)&&(b.avatar=a(b.avatar,v,g)),i.notundef(b.gender)&&(b.gender=d[b.gender]),i.notundef(b.createTime)&&(b.createTime=+b.createTime),i.notundef(b.updateTime)&&(b.updateTime=+b.updateTime),b},c.reverseUsers=function(m){return n(m).call(m,function(v){return o(c).call(c,v)})},c.validGenders=s(u),t.exports=c},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(6),i=e(106).genPrivateUrl,u=e(72),d=e(0),c=e(13);function m(T,k){switch(d.notundef(T.type)?d.verifyFileType(T.type,"msg::FileMessage"):T.type="file",d.verifyOptions(T,"file","msg::FileMessage"),d.verifyOptions(T.file,"url ext size",!0,"file.","msg::FileMessage"),T.type){case"image":v.verifyFile(T.file,"msg::FileMessage");break;case"audio":g.verifyFile(T.file,"msg::FileMessage");break;case"video":b.verifyFile(T.file,"msg::FileMessage")}u.call(this,T),k&&(this.idClient=k),this.attach=n(T.file)}m.prototype=o(u.prototype),m.reverse=function(T){var k=s(u).call(u,T);if(T.attach=T.attach?""+T.attach:"",T.attach&&(k.file=JSON.parse(T.attach),!k.file.isS3)){var y,O;k.file.url=i(k.file.url)||"",k.type==="audio"&&k.file.url&&!k.file.mp3Url&&(k.file.mp3Url=k.file.url+(~a(O=k.file.url).call(O,"?")?"&":"?")+"audioTrans&type=mp3"),c.httpsEnabled&&a(y=k.file.url).call(y,"https://")!==0&&(k.file.url=k.file.url.replace("http","https"))}return k},t.exports=m;var v=e(830),g=e(831),b=e(832)},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(6),i=e(106).genPrivateUrl,u=e(117),d=e(0),c=e(13);function m(T,k){switch(d.notundef(T.type)?d.verifyFileType(T.type,"msg::FileMessage"):T.type="file",d.verifyOptions(T,"file","msg::FileMessage"),d.verifyOptions(T.file,"url ext size",!0,"file.","msg::FileMessage"),T.type){case"image":v.verifyFile(T.file,"msg::FileMessage");break;case"audio":g.verifyFile(T.file,"msg::FileMessage");break;case"video":b.verifyFile(T.file,"msg::FileMessage")}u.call(this,T),k&&(this.idClient=k),this.attach=n(T.file)}m.prototype=o(u.prototype),m.reverse=function(T){var k=s(u).call(u,T);if(T.attach=T.attach?""+T.attach:"",T.attach&&(k.file=JSON.parse(T.attach),!k.file.isS3)){var y,O;k.file.url=i(k.file.url)||"",k.type==="audio"&&k.file.url&&!k.file.mp3Url&&(k.file.mp3Url=k.file.url+(~a(O=k.file.url).call(O,"?")?"&":"?")+"audioTrans&type=mp3"),c.httpsEnabled&&a(y=k.file.url).call(y,"https://")!==0&&(k.file.url=k.file.url.replace("http","https"))}return k},t.exports=m;var v=e(896),g=e(897),b=e(898)},function(t,r,e){var n=e(316);t.exports=n},function(t,r){var e=typeof document=="object"&&document.all,n=e===void 0&&e!==void 0;t.exports={all:e,IS_HTMLDDA:n}},function(t,r,e){var n=e(92);t.exports=n&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},function(t,r,e){var n=e(27),o=e(4),s=e(159);t.exports=!n&&!o(function(){return Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a!=7})},function(t,r,e){var n=e(4),o=e(16),s=/#|\.prototype\./,a=function(m,v){var g=u[i(m)];return g==c||g!=d&&(o(v)?n(v):!!v)},i=a.normalize=function(m){return String(m).replace(s,".").toLowerCase()},u=a.data={},d=a.NATIVE="N",c=a.POLYFILL="P";t.exports=a},function(t,r,e){var n=e(27),o=e(4);t.exports=n&&o(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},function(t,r,e){var n=e(1),o=e(4),s=e(79),a=e(28),i=e(42),u=e(45),d=e(213),c=e(95),m=e(161),v=e(111),g=e(20),b=e(93),T=g("isConcatSpreadable"),k=b>=51||!o(function(){var D=[];return D[T]=!1,D.concat()[0]!==D}),y=v("concat"),O=function(D){if(!a(D))return!1;var he=D[T];return he!==void 0?!!he:s(D)};n({target:"Array",proto:!0,arity:1,forced:!k||!y},{concat:function(D){var he,ae,Ne,ue,Y,_e=i(this),Ce=m(_e,0),ze=0;for(he=-1,Ne=arguments.length;he<Ne;he++)if(O(Y=he===-1?_e:arguments[he]))for(ue=u(Y),d(ze+ue),ae=0;ae<ue;ae++,ze++)ae in Y&&c(Ce,ze,Y[ae]);else d(ze+1),c(Ce,ze++,Y);return Ce.length=ze,Ce}})},function(t,r){var e=TypeError;t.exports=function(n){if(n>9007199254740991)throw e("Maximum allowed index exceeded");return n}},function(t,r,e){var n=e(11),o=e(16),s=e(158),a=n(Function.toString);o(s.inspectSource)||(s.inspectSource=function(i){return a(i)}),t.exports=s.inspectSource},function(t,r,e){var n=e(328);t.exports=n},function(t,r,e){var n=e(11),o=e(29),s=e(43),a=e(160).indexOf,i=e(112),u=n([].push);t.exports=function(d,c){var m,v=s(d),g=0,b=[];for(m in v)!o(i,m)&&o(v,m)&&u(b,m);for(;c.length>g;)o(v,m=c[g++])&&(~a(b,m)||u(b,m));return b}},function(t,r,e){var n=e(33);t.exports=n("document","documentElement")},function(t,r,e){var n=e(333);e(67),t.exports=n},function(t,r,e){e(334),e(337),e(338),e(223),e(339)},function(t,r,e){var n=e(128),o=e(45),s=e(95),a=Array,i=Math.max;t.exports=function(u,d,c){for(var m=o(u),v=n(d,m),g=n(c===void 0?m:c,m),b=a(i(g-v,0)),T=0;v<g;v++,T++)s(b,T,u[v]);return b.length=T,b}},function(t,r,e){var n=e(19),o=e(33),s=e(20),a=e(66);t.exports=function(){var i=o("Symbol"),u=i&&i.prototype,d=u&&u.valueOf,c=s("toPrimitive");u&&!u[c]&&a(u,c,function(m){return n(d,this)},{arity:1})}},function(t,r,e){var n=e(92);t.exports=n&&!!Symbol.for&&!!Symbol.keyFor},function(t,r,e){var n=e(1),o=e(33),s=e(76),a=e(19),i=e(11),u=e(4),d=e(79),c=e(16),m=e(28),v=e(126),g=e(98),b=e(92),T=o("JSON","stringify"),k=i(/./.exec),y=i("".charAt),O=i("".charCodeAt),D=i("".replace),he=i(1 .toString),ae=/[\uD800-\uDFFF]/g,Ne=/^[\uD800-\uDBFF]$/,ue=/^[\uDC00-\uDFFF]$/,Y=!b||u(function(){var ie=o("Symbol")();return T([ie])!="[null]"||T({a:ie})!="{}"||T(Object(ie))!="{}"}),_e=u(function(){return T("\uDF06\uD834")!=='"\\udf06\\ud834"'||T("\uDEAD")!=='"\\udead"'}),Ce=function(ie,le){var Ie=g(arguments),pe=le;if((m(le)||ie!==void 0)&&!v(ie))return d(le)||(le=function(qe,$e){if(c(pe)&&($e=a(pe,this,qe,$e)),!v($e))return $e}),Ie[1]=le,s(T,null,Ie)},ze=function(ie,le,Ie){var pe=y(Ie,le-1),qe=y(Ie,le+1);return k(Ne,ie)&&!k(ue,qe)||k(ue,ie)&&!k(Ne,pe)?"\\u"+he(O(ie,0),16):ie};T&&n({target:"JSON",stat:!0,arity:3,forced:Y||_e},{stringify:function(ie,le,Ie){var pe=g(arguments),qe=s(Y?Ce:T,null,pe);return _e&&typeof qe=="string"?D(qe,ae,ze):qe}})},function(t,r,e){e(22)("iterator")},function(t,r,e){var n=e(22),o=e(221);n("toPrimitive"),o()},function(t,r,e){var n=e(27),o=e(29),s=Function.prototype,a=n&&Object.getOwnPropertyDescriptor,i=o(s,"name"),u=i&&(function(){}).name==="something",d=i&&(!n||n&&a(s,"name").configurable);t.exports={EXISTS:i,PROPER:u,CONFIGURABLE:d}},function(t,r,e){var n,o,s,a=e(4),i=e(16),u=e(28),d=e(80),c=e(134),m=e(66),v=e(20),g=e(48),b=v("iterator"),T=!1;[].keys&&("next"in(s=[].keys())?(o=c(c(s)))!==Object.prototype&&(n=o):T=!0),!u(n)||a(function(){var k={};return n[b].call(k)!==k})?n={}:g&&(n=d(n)),i(n[b])||m(n,b,function(){return this}),t.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:T}},function(t,r,e){var n=e(4);t.exports=!n(function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype})},function(t,r,e){e(67);var n=e(65),o=e(29),s=e(21),a=e(375),i=Array.prototype,u={DOMTokenList:!0,NodeList:!0};t.exports=function(d){var c=d.forEach;return d===i||s(i,d)&&c===i.forEach||o(u,n(d))?a:c}},function(t,r,e){var n=e(383);t.exports=n},function(t,r,e){var n=e(387);e(67),t.exports=n},function(t,r,e){e(388)},function(t,r,e){var n=e(33),o=e(11),s=e(131),a=e(132),i=e(36),u=o([].concat);t.exports=n("Reflect","ownKeys")||function(d){var c=s.f(i(d)),m=a.f;return m?u(c,m(d)):c}},function(t,r,e){var n=e(20),o=e(99),s=n("iterator"),a=Array.prototype;t.exports=function(i){return i!==void 0&&(o.Array===i||a[s]===i)}},function(t,r,e){var n=e(19),o=e(31),s=e(36),a=e(78),i=e(136),u=TypeError;t.exports=function(d,c){var m=arguments.length<2?i(d):c;if(o(m))return s(n(m,d));throw u(a(d)+" is not iterable")}},function(t,r,e){var n=e(19),o=e(36),s=e(157);t.exports=function(a,i,u){var d,c;o(a);try{if(!(d=s(a,"return"))){if(i==="throw")throw u;return u}d=n(d,a)}catch(m){c=!0,d=m}if(i==="throw")throw u;if(c)throw d;return o(d),u}},function(t,r,e){var n=e(33),o=e(38),s=e(20),a=e(27),i=s("species");t.exports=function(u){var d=n(u),c=o.f;a&&d&&!d[i]&&c(d,i,{configurable:!0,get:function(){return this}})}},function(t,r,e){var n=e(36),o=e(169),s=e(91),a=e(20)("species");t.exports=function(i,u){var d,c=n(i).constructor;return c===void 0||s(d=n(c)[a])?u:o(d)}},function(t,r,e){var n,o,s,a,i=e(14),u=e(76),d=e(34),c=e(16),m=e(29),v=e(4),g=e(217),b=e(98),T=e(159),k=e(240),y=e(241),O=e(114),D=i.setImmediate,he=i.clearImmediate,ae=i.process,Ne=i.Dispatch,ue=i.Function,Y=i.MessageChannel,_e=i.String,Ce=0,ze={};try{n=i.location}catch{}var ie=function(qe){if(m(ze,qe)){var $e=ze[qe];delete ze[qe],$e()}},le=function(qe){return function(){ie(qe)}},Ie=function(qe){ie(qe.data)},pe=function(qe){i.postMessage(_e(qe),n.protocol+"//"+n.host)};D&&he||(D=function(qe){k(arguments.length,1);var $e=c(qe)?qe:ue(qe),Lt=b(arguments,1);return ze[++Ce]=function(){u($e,void 0,Lt)},o(Ce),Ce},he=function(qe){delete ze[qe]},O?o=function(qe){ae.nextTick(le(qe))}:Ne&&Ne.now?o=function(qe){Ne.now(le(qe))}:Y&&!y?(a=(s=new Y).port2,s.port1.onmessage=Ie,o=d(a.postMessage,a)):i.addEventListener&&c(i.postMessage)&&!i.importScripts&&n&&n.protocol!=="file:"&&!v(pe)?(o=pe,i.addEventListener("message",Ie,!1)):o="onreadystatechange"in T("script")?function(qe){g.appendChild(T("script")).onreadystatechange=function(){g.removeChild(this),ie(qe)}}:function(qe){setTimeout(le(qe),0)}),t.exports={set:D,clear:he}},function(t,r){var e=TypeError;t.exports=function(n,o){if(n<o)throw e("Not enough arguments");return n}},function(t,r,e){var n=e(64);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(n)},function(t,r){t.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},function(t,r,e){var n=e(101),o=e(244),s=e(115).CONSTRUCTOR;t.exports=s||!o(function(a){n.all(a).then(void 0,function(){})})},function(t,r,e){var n=e(20)("iterator"),o=!1;try{var s=0,a={next:function(){return{done:!!s++}},return:function(){o=!0}};a[n]=function(){return this},Array.from(a,function(){throw 2})}catch{}t.exports=function(i,u){if(!u&&!o)return!1;var d=!1;try{var c={};c[n]=function(){return{next:function(){return{done:d=!0}}}},i(c)}catch{}return d}},function(t,r,e){var n=e(36),o=e(28),s=e(68);t.exports=function(a,i){if(n(a),o(i)&&i.constructor===a)return i;var u=s.f(a);return(0,u.resolve)(i),u.promise}},function(t,r,e){var n=e(1),o=e(19),s=e(31),a=e(68),i=e(100),u=e(46);n({target:"Promise",stat:!0},{allSettled:function(d){var c=this,m=a.f(c),v=m.resolve,g=m.reject,b=i(function(){var T=s(c.resolve),k=[],y=0,O=1;u(d,function(D){var he=y++,ae=!1;O++,o(T,c,D).then(function(Ne){ae||(ae=!0,k[he]={status:"fulfilled",value:Ne},--O||v(k))},function(Ne){ae||(ae=!0,k[he]={status:"rejected",reason:Ne},--O||v(k))})}),--O||v(k)});return b.error&&g(b.value),m.promise}})},function(t,r,e){var n=e(1),o=e(19),s=e(31),a=e(33),i=e(68),u=e(100),d=e(46);n({target:"Promise",stat:!0},{any:function(c){var m=this,v=a("AggregateError"),g=i.f(m),b=g.resolve,T=g.reject,k=u(function(){var y=s(m.resolve),O=[],D=0,he=1,ae=!1;d(c,function(Ne){var ue=D++,Y=!1;he++,o(y,m,Ne).then(function(_e){Y||ae||(ae=!0,b(_e))},function(_e){Y||ae||(Y=!0,O[ue]=_e,--he||T(new v(O,"No one promise resolved")))})}),--he||T(new v(O,"No one promise resolved"))});return k.error&&T(k.value),g.promise}})},function(t,r,e){var n=e(411);t.exports=n},function(t,r,e){var n=e(26).default,o=e(413);t.exports=function(s){var a=o(s,"string");return n(a)==="symbol"?a:String(a)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(421);t.exports=n},function(t,r,e){var n=e(78),o=TypeError;t.exports=function(s,a){if(!delete s[a])throw o("Cannot delete property "+n(a)+" of "+n(s))}},function(t,r,e){e(456),e(458)},function(t,r,e){var n,o=e(14),s=e(76),a=e(16),i=e(457),u=e(64),d=e(98),c=e(240),m=o.Function,v=/MSIE .\./.test(u)||i&&((n=o.Bun.version.split(".")).length<3||n[0]==0&&(n[1]<3||n[1]==3&&n[2]==0));t.exports=function(g,b){var T=b?2:1;return v?function(k,y){var O=c(arguments.length,1)>T,D=a(k)?k:m(k),he=O?d(arguments,T):[],ae=O?function(){s(D,this,he)}:D;return b?g(ae,y):g(ae)}:g}},function(t,r,e){var n=e(476);t.exports=n},function(t,r){t.exports=function e(n,o){var s,a,i=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,u=/(^[ ]*|[ ]*$)/g,d=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,c=/^0x[0-9a-f]+$/i,m=/^0/,v=function(ae){return e.insensitive&&(""+ae).toLowerCase()||""+ae},g=v(n).replace(u,"")||"",b=v(o).replace(u,"")||"",T=g.replace(i,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),k=b.replace(i,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),y=parseInt(g.match(c),16)||T.length!==1&&g.match(d)&&Date.parse(g),O=parseInt(b.match(c),16)||y&&b.match(d)&&Date.parse(b)||null;if(O){if(y<O)return-1;if(y>O)return 1}for(var D=0,he=Math.max(T.length,k.length);D<he;D++){if(s=!(T[D]||"").match(m)&&parseFloat(T[D])||T[D]||0,a=!(k[D]||"").match(m)&&parseFloat(k[D])||k[D]||0,isNaN(s)!==isNaN(a))return isNaN(s)?1:-1;if(typeof s!=typeof a&&(s+="",a+=""),s<a)return-1;if(s>a)return 1}return 0}},function(t,r,e){var n=e(119),o=e(88);t.exports=function(s){if(!o(s))return!1;var a=n(s);return a=="[object Function]"||a=="[object GeneratorFunction]"||a=="[object AsyncFunction]"||a=="[object Proxy]"}},function(t,r,e){(function(n){var o=typeof n=="object"&&n&&n.Object===Object&&n;t.exports=o}).call(this,e(56))},function(t,r){var e=Function.prototype.toString;t.exports=function(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}},function(t,r,e){var n=e(505),o=e(512),s=e(514),a=e(515),i=e(516);function u(d){var c=-1,m=d==null?0:d.length;for(this.clear();++c<m;){var v=d[c];this.set(v[0],v[1])}}u.prototype.clear=n,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=a,u.prototype.set=i,t.exports=u},function(t,r,e){var n=e(261),o=e(199),s=Object.prototype.hasOwnProperty;t.exports=function(a,i,u){var d=a[i];s.call(a,i)&&o(d,u)&&(u!==void 0||i in a)||n(a,i,u)}},function(t,r,e){var n=e(518);t.exports=function(o,s,a){s=="__proto__"&&n?n(o,s,{configurable:!0,enumerable:!0,value:a,writable:!0}):o[s]=a}},function(t,r,e){var n=e(520),o=e(521),s=e(175),a=e(263),i=e(301),u=e(524),d=Object.prototype.hasOwnProperty;t.exports=function(c,m){var v=s(c),g=!v&&o(c),b=!v&&!g&&a(c),T=!v&&!g&&!b&&u(c),k=v||g||b||T,y=k?n(c.length,String):[],O=y.length;for(var D in c)!m&&!d.call(c,D)||k&&(D=="length"||b&&(D=="offset"||D=="parent")||T&&(D=="buffer"||D=="byteLength"||D=="byteOffset")||i(D,O))||y.push(D);return y}},function(t,r,e){(function(n){var o=e(50),s=e(523),a=r&&!r.nodeType&&r,i=a&&typeof n=="object"&&n&&!n.nodeType&&n,u=i&&i.exports===a?o.Buffer:void 0,d=(u?u.isBuffer:void 0)||s;n.exports=d}).call(this,e(145)(t))},function(t,r){t.exports=function(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=9007199254740991}},function(t,r){t.exports=function(e,n){return function(o){return e(n(o))}}},function(t,r){t.exports=function(){return[]}},function(t,r,e){var n=e(268),o=e(269),s=e(180),a=e(266),i=Object.getOwnPropertySymbols?function(u){for(var d=[];u;)n(d,s(u)),u=o(u);return d}:a;t.exports=i},function(t,r){t.exports=function(e,n){for(var o=-1,s=n.length,a=e.length;++o<s;)e[a+o]=n[o];return e}},function(t,r,e){var n=e(265)(Object.getPrototypeOf,Object);t.exports=n},function(t,r,e){var n=e(268),o=e(175);t.exports=function(s,a,i){var u=a(s);return o(s)?u:n(u,i(s))}},function(t,r,e){var n=e(83)(e(50),"Set");t.exports=n},function(t,r,e){var n=e(567);t.exports=n},function(t,r,e){var n=e(11),o=e(31),s=e(28),a=e(29),i=e(98),u=e(107),d=Function,c=n([].concat),m=n([].join),v={},g=function(b,T,k){if(!a(v,T)){for(var y=[],O=0;O<T;O++)y[O]="a["+O+"]";v[T]=d("C,a","return new C("+m(y,",")+")")}return v[T](b,k)};t.exports=u?d.bind:function(b){var T=o(this),k=T.prototype,y=i(arguments,1),O=function(){var D=c(y,i(arguments));return this instanceof O?g(T,D.length,D):T.apply(b,D)};return s(k)&&(O.prototype=k),O}},function(t,r,e){var n=e(87),o=e(6),s=e(69),a=e(123),i=e(10),u=e(54),d=u.getGlobal(),c={},m=d.name||"_parent",v=[],g=[];c.addMsgListener=function(Ne){v.push(Ne)};var b,T,k,y,O=(b=/^([\w]+?:\/\/.*?(?=\/|$))/i,function(Ne){return Ne=Ne||"",b.test(Ne)?RegExp.$1:"*"}),D=function(){var Ne,ue,Y=n(Ne=unescape(d.name||"")).call(Ne);if(Y&&o(Y).call(Y,"MSG|")===0){d.name="";var _e=u.string2object(Y.replace("MSG|",""),"|"),Ce=(_e.origin||"").toLowerCase();Ce&&Ce!=="*"&&o(ue=location.href.toLowerCase()).call(ue,Ce)!==0||function(ze){for(var ie=0,le=v.length;ie<le;ie++)try{v[ie].call(null,ze)}catch{}}({data:JSON.parse(_e.data||"null"),source:d.frames[_e.self]||_e.self,origin:O(_e.ref||(typeof document>"u"?"":document.referrer))})}},he=(k=function(Ne,ue){for(var Y=0,_e=Ne.length;Y<_e;Y++)if(Ne[Y]===ue)return!0;return!1},function(){if(g.length){T=[];for(var Ne,ue=g.length-1;ue>=0;ue--)Ne=g[ue],k(T,Ne.w)||(T.push(Ne.w),s(g).call(g,ue,1),Ne.w.name=Ne.d);T=null}}),ae=c.startTimer=(y=!1,function(){y||(y=!0,d.postMessage||(a(he,100),a(D,20)))});c.postMessage=function(Ne){var ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(u.fillUndef(ue,{origin:"*",source:m}),d.postMessage){var Y=ue.data;d.FormData||(Y=i(Y)),Ne.postMessage(Y,ue.origin)}else{if(ae(),u.isObject(ue)){var _e={};_e.origin=ue.origin||"",_e.ref=location.href,_e.self=ue.source,_e.data=i(ue.data),ue="MSG|"+u.object2string(_e,"|",!0)}g.unshift({w:Ne,d:escape(ue)})}},t.exports=c},function(t,r,e){var n=e(589);t.exports=n},function(t,r,e){var n=e(0),o={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},s={genResponseBody:function(a){return o[a=a||"file"]},parseResponse:function(a,i){n.notundef(a.size)&&(a.size=+a.size),n.notundef(a.w)&&(a.w=+a.w),n.notundef(a.h)&&(a.h=+a.h),n.notundef(a.dur)&&(a.dur=+a.dur);var u=a.orientation;if(n.notundef(u)&&(delete a.orientation,i&&(u==="right, top"||u==="left, bottom"))){var d=a.w;a.w=a.h,a.h=d}return a}};t.exports=s},function(t,r,e){var n=e(120),o=e(15),s=e(6),a=e(57),i=e(23),u=["Code","code","Message","message"],d=e(13),c=e(0),m=e(40),v=e(605),g=e(606),b=e(105),T=b.EMResourceUploadWay,k=b.EMExceptionState,y=e(184).abort,O=c.supportFormData;function D(ae,Ne){var ue=this,Y=ae.uploadprogress,_e=ae.uploaddone,Ce=ae.beginupload;return{beginupload:typeof Ce=="function"?function(ze){try{Ce(ze,Ne)}catch(ie){ue.logger.error("Upload::options.beginupload execute error",ie)}}:function(){},uploadprogress:typeof Y=="function"?function(ze){ue.reporterHook.emit("reporter/uploadUpdate",{transferred_size:ze.loaded});try{Y(ze,Ne)}catch(ie){ue.logger.error("Upload::options.uploadprogress execute error",ie)}}:function(ze){ue.reporterHook.emit("reporter/uploadUpdate",{transferred_size:ze.loaded})},uploaddone:function(ze,ie){ze?ue.reporterHook.emit("reporter/uploadEnd",ze.code==="RequestAbortedError"||ze.code==="abort"?k.kCanceled:k.kFailed):ue.reporterHook.emit("reporter/uploadEnd",k.kSucceed);try{_e(ze,ie,null,Ne)}catch(le){ue.logger.error("Upload::options.uploaddone execute error",le)}}}}function he(ae,Ne,ue){var Y=this;Y.options=c.copy(ae),ae=Y.options,c.verifyOptions(ae,"url fileName"),c.verifyParamPresentJustOne(ae,"blob fileInput"),c.verifyCallback(ae,"beginupload uploadprogress uploaddone"),Y.reporterHook=Ne.reporterHook,Y.logger=Ne.logger,Y.message=ue;var _e=D.call(this,ae,ue),Ce=_e.beginupload,ze=_e.uploadprogress,ie=_e.uploaddone;Y.options.beginupload=Ce,Y.options.uploadprogress=ze,Y.options.uploaddone=ie,ae.fileInput&&(ae.fileInput=c.verifyFileInput(ae.fileInput)),ae.type&&c.verifyFileType(ae.type),ae.timeout?c.verifyParamType("timeout",ae.timeout,"number"):ae.timeout=6e5,c.verifyFileUploadCallback(ae),ae.data={},ae.params&&c.merge(ae.data,ae.params);var le,Ie,pe=ae.fileName,qe=ae.fileInput;if(O){if(qe){if(!(Ie=ae.type?c.filterFiles(qe.files,ae.type):o([]).call(qe.files,0))||!Ie.length)return void ae.uploaddone(m.newWrongFileTypeError(""+ae.type+", , "+ae.type+""));ae.data[pe]=Ie[0],le=qe.files[0].size}else if(ae.blob){var $e;if(ae.data[pe]=ae.blob,ae.type!=="file"&&ae.blob.type&&s($e=ae.blob.type).call($e,ae.type)===-1)return void ae.uploaddone(m.newWrongFileTypeError(""+ae.type+", "+ae.type+""));le=ae.blob.size}if(Y.reporterHook.emit("reporter/uploadUpdate",{full_size:le}),ae.maxSize&&le>ae.maxSize)return void ae.uploaddone(m.newFileTooLargeError("".concat(ae.maxSize,"")))}function Lt(){if(Y.logger.info("Upload:enter aws upload"),le){if(le>d.chunkMaxSize)ae.uploaddone(m.newFileTooLargeError("".concat(d.commonMaxSize,"")));else if(ae.s3Policy&&ae.s3Policy.uploadConfig&&ae.s3Policy.uploadConfig.retryPolicy){var pr=ae.s3Policy.uploadConfig.retryPolicy,sr={accessKeyId:ae.mixStoreToken.accessKeyId,secretAccessKey:ae.mixStoreToken.secretAccessKey,sessionToken:ae.mixStoreToken.sessionToken,region:ae.mixStoreToken.region,maxRetries:pr.retry},hr=new ae.s3;hr.config.update(sr);var Fe=Y.reporterHook.getNTPTime();hr.config.systemClockOffset=Fe-a();var nr=decodeURIComponent(ae.mixStoreToken.bucket),ir=decodeURIComponent(ae.mixStoreToken.objectName),Ue=ae.data[pe],rr=hr.upload({Bucket:nr,Key:ir,Body:Ue,Metadata:{token:ae.mixStoreToken.token},ContentType:Ue.type||"application/octet-stream"});rr.on("httpUploadProgress",function(or){var Pt=Math.floor(1e4*or.loaded/or.total)/100,Et={docId:ae.docId,total:or.total,loaded:or.loaded,percentage:Pt,percentageText:Pt+"%"};ae.fileInput&&(Et.fileInput=ae.fileInput),ae.blob&&(Et.blob=ae.blob),ae.uploadprogress(Et)}),rr.send(function(or,Pt){if(ae.errorHook({bucket:nr,object:ir},{provider:"s3"}),ae.docId&&(Pt.docId=ae.docId),or&&or.code==="RequestAbortedError")Y.logger.error("uploadFile:","api::s3:upload file abort",or),Y.onError(or);else if(or){var Et;ae.logger.error("error:","api::s3:upload file failed",or);var kt=ae.providers[(s(Et=ae.providers).call(Et,ae.curProvider)+1)%ae.providers.length];pr.retryNext&&kt?(Y.addCircuitTimer(ae,kt),kt===1&&ae.getMixStoreToken(1,function(cr){ae.mixStoreToken=cr,Dt()})):Y.onError(Pt),ae.errorHook(or,{provider:"s3"})}else{var er=Y.options.s3Policy.cdnSchema;er=(er=er.replace("{cdnDomain}",Y.options.s3Policy.dlcdn)).replace("{objectName}",Pt.Key),ae.uploaddone(null,{size:Ue.size,name:Ue.name,url:er,ext:Ue.name.split(".")[1]||"unknown",_url_safe:ae.mixStoreToken.shortUrl,isS3:!0}),ae.logger.info("s3 Upload done: fileObj is",{size:Ue.size,name:Ue.name,url:er,ext:Ue.name.split(".")[1]||"unknown",_url_safe:ae.mixStoreToken.shortUrl,isS3:!0})}}),typeof ae.beginupload=="function"&&ae.beginupload(rr)}}else ae.uploaddone(m.newFileTooLargeError("Browser version is too low"))}function Dt(){if(Y.logger.info("Upload:enter nos upload"),le&&!ae.commonUpload)return Y.logger.info("Upload:use chunk upload, url ".concat(ae.url)),le>d.chunkMaxSize?void ae.uploaddone(m.newFileTooLargeError("".concat(d.chunkMaxSize,""))):void(Y.sn=g(ae,pe,Y,-1));if(Y.logger.info("Upload:use common upload, url ".concat(ae.url)),le&&le>d.commonMaxSize)ae.uploaddone(m.newFileTooLargeError("".concat(d.commonMaxSize,"")));else{le||(c.dataset(qe,"name",pe),ae.data.input=qe);var pr={data:ae.data,onaftersend:function(){ae.beginupload(Y,Y.message)},onuploading:function(sr){var hr=Math.floor(1e4*sr.loaded/sr.total)/100,Fe={docId:ae.docId,total:sr.total,loaded:sr.loaded,percentage:hr,percentageText:hr+"%"};ae.fileInput&&(Fe.fileInput=ae.fileInput),ae.blob&&(Fe.blob=ae.blob),ae.uploadprogress(Fe)},onload:function(sr){var hr;if(ae.docId&&(sr.docId=ae.docId),!sr.Error)return ae.uploaddone(null,sr),void ae.logger.info("nos Upload done: fileObj is",sr);if(ae.mixEnable&&ae.curProvider===1){var Fe=ae.nosPolicy.uploadConfig.retryPolicy,nr=ae.providers[(s(hr=ae.providers).call(hr,ae.curProvider)+1)%ae.providers.length];Fe.retryNext&&nr?(Y.addCircuitTimer(ae,nr),nr===2&&ae.getMixStoreToken(2,function(ir){ae.mixStoreToken=ir,Lt()})):Y.onError(sr)}else Y.onError(sr)},onerror:function(sr){var hr;if(ae.mixEnable&&ae.curProvider===1){var Fe,nr=ae.nosPolicy.uploadConfig.retryPolicy,ir=ae.providers[(s(Fe=ae.providers).call(Fe,ae.curProvider)+1)%ae.providers.length];if(nr.retryNext&&ir)Y.addCircuitTimer(ae,ir),ir===2&&ae.getMixStoreToken(2,function(Ue){ae.mixStoreToken=Ue,Lt()});else try{hr=sr.result?JSON.parse(sr.result):sr,Y.onError(hr)}catch{ae.uploaddone(new m(sr.message,sr.code),Y.options)}}else try{hr=sr.result?JSON.parse(sr.result):sr,Y.onError(hr)}catch{ae.uploaddone(new m(sr.message,sr.code),Y.options)}ae.errorHook(sr,{provider:"nos"})}};O||(pr.mode="iframe"),pr.putFileAtEnd=!0,Y.sn=v(ae.url,pr)}}if(ae.mixEnable&&ae.curProvider===2){var dr=Y.options.s3Policy.cdnSchema;dr=dr.replace("{cdnDomain}",Y.options.s3Policy.dlcdn),Y.reporterHook.emit("reporter/uploadUpdate",{remote_addr:dr,operation_type:T.kResourceUploadWayAWSPlugin}),Lt()}else ae.mixEnable&&ae.curProvider===1?(Y.reporterHook.emit("reporter/uploadUpdate",{remote_addr:ae.url,operation_type:T.kResourceUploadWayNOSPlugin}),Dt()):(Y.reporterHook.emit("reporter/uploadUpdate",{remote_addr:ae.url,operation_type:T.kResourceUploadWayNOS}),Dt())}he.prototype.addCircuitTimer=function(ae,Ne){var ue=this;if(ae.curProvider=Ne,ae.s3Policy&&ae.nosPolicy){var Y=ae[ae.curProvider===1?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!Y||Y===0)return;ue.circuitTimer&&clearTimeout(ue.circuitTimer),ue.circuitTimer=i(function(){ae.curProvider=ae.providers[0],ue.circuitTimer=void 0},1e3*Y)}},he.prototype.onError=function(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ne=this,ue=Ne.options,Y=ae.Error||ae||{},_e=Y.Code,Ce=Y.code,ze=Y.Message,ie=Y.message,le=n(Y,u),Ie=_e||Ce||"unknown",pe=ze||ie||"";ue.uploaddone(new m(Ie+"("+pe+")",Ie,le))},he.prototype.abort=function(){y(this.sn)},t.exports=he},function(t,r,e){t.exports=e(279)},function(t,r,e){var n=e(607);t.exports=n},function(t,r,e){var n=e(187),o=e(137),s=e(188);t.exports=function(a,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=n(i&&i.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),o(a,"prototype",{writable:!1}),i&&s(a,i)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(26).default,o=e(621);t.exports=function(s,a){if(a&&(n(a)==="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o(s)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(622)},function(t,r,e){var n=e(625);t.exports=n},function(t,r,e){var n=e(6),o=e(0),s={fromDataURL:function(a){var i,u,d=o.getGlobal();u=n(i=a.split(",")[0]).call(i,"base64")>=0?d.atob(a.split(",")[1]):d.decodeURIComponent(a.split(",")[1]);for(var c=a.split(",")[0].split(":")[1].split(";")[0],m=new Uint8Array(u.length),v=0;v<u.length;v++)m[v]=u.charCodeAt(v);return new d.Blob([m],{type:c})}};t.exports=s},function(t,r,e){var n=e(5),o=e(8),s=e(9),a=e(0),i={stripmeta:0,blur:2,quality:3,crop:4,rotate:5,thumbnail:7,interlace:9},u={0:"stripmeta",1:"type",2:"blur",3:"quality",4:"crop",5:"rotate",6:"pixel",7:"thumbnail",8:"watermark",9:"interlace",10:"tmp"};function d(c){a.verifyOptions(c,"type","image::ImageOp"),a.verifyParamValid("type",c.type,d.validTypes,"image::ImageOp"),a.merge(this,c),this.type=i[c.type]}d.validTypes=n(i),d.reverse=function(c){var m=a.copy(c);return m.type=u[m.type],m},d.reverseImageOps=function(c){return o(c).call(c,function(m){return s(d).call(d,m)})},t.exports=d},function(t,r,e){var n=e(2),o=e(5),s={1:"ROOM_CLOSE",2:"ROOM_JOIN",3:"INVITE",4:"CANCEL_INVITE",5:"REJECT",6:"ACCEPT",7:"LEAVE",8:"CONTROL"},a={1:"accid",2:"uid",3:"createTime",4:"expireTime",5:"web_uid"},i={10404:"ROOM_NOT_EXISTS",10405:"ROOM_HAS_EXISTS",10406:"ROOM_MEMBER_NOT_EXISTS",10407:"ROOM_MEMBER_HAS_EXISTS",10408:"INVITE_NOT_EXISTS",10409:"INVITE_HAS_REJECT",10410:"INVITE_HAS_ACCEPT",10201:"PEER_NIM_OFFLINE",10202:"PEER_PUSH_OFFLINE",10419:"ROOM_MEMBER_EXCEED",10420:"ROOM_MEMBER_HAS_EXISTS_OTHER_CLIENT",10417:"UID_CONFLICT"};t.exports={parseAvSignalType:function(u){return s[u]||u},parseAvSignalMember:function(u){var d,c={};return n(d=o(u)).call(d,function(m){c[a[m]]=u[m]}),c},parseAvSignalError:function(u){return u.message=i[u.code]||u.message||u,u}}},function(t,r,e){t.exports=e(650)},function(module,exports,__webpack_require__){(function(global,module){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;/*! Socket.IO.js build:0.9.11, development. Copyright(c) 2011 LearnBoost <dev@learnboost.com> MIT Licensed */function getGlobal(){return typeof window<"u"?window:typeof self<"u"?self:global!==void 0?global:{}}var root=getGlobal(),io=module.exports;root.location===void 0&&(root.location=null),root.io?module&&(module.exports=io=root.io):root.io=io,function(){(function(t,r){var e=t;e.version="0.9.11",e.protocol=1,e.transports=[],e.j=[],e.sockets={},e.connect=function(n,o){var s,a,i=e.util.parseUri(n);r&&r.location&&(i.protocol=i.protocol||r.location.protocol.slice(0,-1),i.host=i.host||(r.document?r.document.domain:r.location.hostname),i.port=i.port||r.location.port),s=e.util.uniqueUri(i);var u={host:i.ipv6uri?"["+i.host+"]":i.host,secure:i.protocol==="https",port:i.port||(i.protocol==="https"?443:80),query:i.query||""};return e.util.merge(u,o),!u["force new connection"]&&e.sockets[s]||(a=new e.Socket(u)),!u["force new connection"]&&a&&(e.sockets[s]=a),(a=a||e.sockets[s]).of(i.path.length>1?i.path:"")}})(module.exports,root),function(t,r){var e=t.util={},n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,o=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.parseUri=function(a){var i=a,u=a.indexOf("["),d=a.indexOf("]");u!=-1&&d!=-1&&(a=a.substring(0,u)+a.substring(u,d).replace(/:/g,";")+a.substring(d,a.length));for(var c=n.exec(a||""),m={},v=14;v--;)m[o[v]]=c[v]||"";return u!=-1&&d!=-1&&(m.source=i,m.host=m.host.substring(1,m.host.length-1).replace(/;/g,":"),m.authority=m.authority.replace("[","").replace("]","").replace(/;/g,":"),m.ipv6uri=!0),m},e.uniqueUri=function(a){var i=a.protocol,u=a.host,d=a.port;return"document"in r&&r.document?(u=u||document.domain,d=d||(i=="https"&&document.location.protocol!=="https:"?443:document.location.port)):(u=u||"localhost",d||i!="https"||(d=443)),(i||"http")+"://"+u+":"+(d||80)},e.query=function(a,i){var u=e.chunkQuery(a||""),d=[];for(var c in e.merge(u,e.chunkQuery(i||"")),u)u.hasOwnProperty(c)&&d.push(c+"="+u[c]);return d.length?"?"+d.join("&"):""},e.chunkQuery=function(a){for(var i,u={},d=a.split("&"),c=0,m=d.length;c<m;++c)(i=d[c].split("="))[0]&&(u[i[0]]=i[1]);return u};var s=!1;e.load=function(a){if(typeof document<"u"&&document&&document.readyState==="complete"||s)return a();e.on(r,"load",a,!1)},e.on=function(a,i,u,d){a.attachEvent?a.attachEvent("on"+i,u):a.addEventListener&&a.addEventListener(i,u,d)},e.request=function(a){if(a&&typeof XDomainRequest<"u"&&!e.ua.hasCORS)return new XDomainRequest;if(typeof XMLHttpRequest<"u"&&(!a||e.ua.hasCORS))return new XMLHttpRequest;if(!a)try{return new root[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}return null},root!==void 0&&e.load(function(){s=!0}),e.defer=function(a){if(!e.ua.webkit||typeof importScripts<"u")return a();e.load(function(){setTimeout(a,100)})},e.merge=function(a,i,u,d){var c,m=d||[],v=u===void 0?2:u;for(c in i)i.hasOwnProperty(c)&&e.indexOf(m,c)<0&&(typeof a[c]=="object"&&v?e.merge(a[c],i[c],v-1,m):(a[c]=i[c],m.push(i[c])));return a},e.mixin=function(a,i){e.merge(a.prototype,i.prototype)},e.inherit=function(a,i){function u(){}u.prototype=i.prototype,a.prototype=new u},e.isArray=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},e.intersect=function(a,i){for(var u=[],d=a.length>i.length?a:i,c=a.length>i.length?i:a,m=0,v=c.length;m<v;m++)~e.indexOf(d,c[m])&&u.push(c[m]);return u},e.indexOf=function(a,i,u){var d=a.length;for(u=u<0?u+d<0?0:u+d:u||0;u<d&&a[u]!==i;u++);return d<=u?-1:u},e.toArray=function(a){for(var i=[],u=0,d=a.length;u<d;u++)i.push(a[u]);return i},e.ua={},e.ua.hasCORS=typeof XMLHttpRequest<"u"&&function(){try{var a=new XMLHttpRequest}catch{return!1}return a.withCredentials!=null}(),e.ua.webkit=typeof navigator<"u"&&/webkit/i.test(navigator.userAgent),e.ua.iDevice=typeof navigator<"u"&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}(io!==void 0?io:module.exports,root),function(t,r){function e(){}t.EventEmitter=e,e.prototype.on=function(n,o){return this.$events||(this.$events={}),this.$events[n]?r.util.isArray(this.$events[n])?this.$events[n].push(o):this.$events[n]=[this.$events[n],o]:this.$events[n]=o,this},e.prototype.addListener=e.prototype.on,e.prototype.once=function(n,o){var s=this;function a(){s.removeListener(n,a),o.apply(this,arguments)}return a.listener=o,this.on(n,a),this},e.prototype.removeListener=function(n,o){if(this.$events&&this.$events[n]){var s=this.$events[n];if(r.util.isArray(s)){for(var a=-1,i=0,u=s.length;i<u;i++)if(s[i]===o||s[i].listener&&s[i].listener===o){a=i;break}if(a<0)return this;s.splice(a,1),s.length||delete this.$events[n]}else(s===o||s.listener&&s.listener===o)&&delete this.$events[n]}return this},e.prototype.removeAllListeners=function(n){return n===void 0?(this.$events={},this):(this.$events&&this.$events[n]&&(this.$events[n]=null),this)},e.prototype.removeAllListenersX=function(n){if(n===void 0)return this.$events={},this;for(let o in this.$events)o!==n&&(this.$events[o]=null);return this},e.prototype.listeners=function(n){return this.$events||(this.$events={}),this.$events[n]||(this.$events[n]=[]),r.util.isArray(this.$events[n])||(this.$events[n]=[this.$events[n]]),this.$events[n]},e.prototype.emit=function(n){if(!this.$events)return!1;var o=this.$events[n];if(!o)return!1;var s=Array.prototype.slice.call(arguments,1);if(typeof o=="function")o.apply(this,s);else{if(!r.util.isArray(o))return!1;for(var a=o.slice(),i=0,u=a.length;i<u;i++)a[i].apply(this,s)}return!0}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(exports,nativeJSON){if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={};function f(t){return t<10?"0"+t:t}function date(t,r){return isFinite(t.valueOf())?t.getUTCFullYear()+"-"+f(t.getUTCMonth()+1)+"-"+f(t.getUTCDate())+"T"+f(t.getUTCHours())+":"+f(t.getUTCMinutes())+":"+f(t.getUTCSeconds())+"Z":null}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(r){var e=meta[r];return typeof e=="string"?e:"\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,r){var e,n,o,s,a,i=gap,u=r[t];switch(u instanceof Date&&(u=date(t)),typeof rep=="function"&&(u=rep.call(r,t,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=indent,a=[],Object.prototype.toString.apply(u)==="[object Array]"){for(s=u.length,e=0;e<s;e+=1)a[e]=str(e,u)||"null";return o=a.length===0?"[]":gap?`[
`+gap+a.join(`,
`+gap)+`
`+i+"]":"["+a.join(",")+"]",gap=i,o}if(rep&&typeof rep=="object")for(s=rep.length,e=0;e<s;e+=1)typeof rep[e]=="string"&&(o=str(n=rep[e],u))&&a.push(quote(n)+(gap?": ":":")+o);else for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(o=str(n,u))&&a.push(quote(n)+(gap?": ":":")+o);return o=a.length===0?"{}":gap?`{
`+gap+a.join(`,
`+gap)+`
`+i+"}":"{"+a.join(",")+"}",gap=i,o}}JSON.stringify=function(t,r,e){var n;if(gap="",indent="",typeof e=="number")for(n=0;n<e;n+=1)indent+=" ";else typeof e=="string"&&(indent=e);if(rep=r,r&&typeof r!="function"&&(typeof r!="object"||typeof r.length!="number"))throw new Error("socket.io:: replacer cannot JSON.stringify");return str("",{"":t})},JSON.parse=function(text,reviver){var j;function walk(t,r){var e,n,o=t[r];if(o&&typeof o=="object")for(e in o)Object.prototype.hasOwnProperty.call(o,e)&&((n=walk(o,e))!==void 0?o[e]=n:delete o[e]);return reviver.call(t,r,o)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("socket.io:: reviver cannot JSON.parse")}}(io!==void 0?io:module.exports,typeof JSON<"u"?JSON:void 0),function(t,r){var e=t.parser={},n=e.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],o=e.reasons=["transport not supported","client not handshaken","unauthorized"],s=e.advice=["reconnect"],a=r.JSON,i=r.util.indexOf;e.encodePacket=function(d){var c=i(n,d.type),m=d.id||"",v=d.endpoint||"",g=d.ack,b=null;switch(d.type){case"error":var T=d.reason?i(o,d.reason):"",k=d.advice?i(s,d.advice):"";T===""&&k===""||(b=T+(k!==""?"+"+k:""));break;case"message":d.data!==""&&(b=d.data);break;case"event":var y={name:d.name};d.args&&d.args.length&&(y.args=d.args),b=a.stringify(y);break;case"json":b=a.stringify(d.data);break;case"connect":d.qs&&(b=d.qs);break;case"ack":b=d.ackId+(d.args&&d.args.length?"+"+a.stringify(d.args):"")}var O=[c,m+(g=="data"?"+":""),v];return b!=null&&O.push(b),O.join(":")},e.encodePayload=function(d){var c="";if(d.length==1)return d[0];for(var m=0,v=d.length;m<v;m++)c+=""+d[m].length+""+d[m];return c};var u=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;e.decodePacket=function(d){if(!(v=d.match(u)))return{};var c=v[2]||"",m=(d=v[5]||"",{type:n[v[1]],endpoint:v[4]||""});switch(c&&(m.id=c,v[3]?m.ack="data":m.ack=!0),m.type){case"error":var v=d.split("+");m.reason=o[v[0]]||"",m.advice=s[v[1]]||"";break;case"message":m.data=d||"";break;case"event":try{var g=a.parse(d);m.name=g.name,m.args=g.args}catch{}m.args=m.args||[];break;case"json":try{m.data=a.parse(d)}catch{}break;case"connect":m.qs=d||"";break;case"ack":if((v=d.match(/^([0-9]+)(\+)?(.*)/))&&(m.ackId=v[1],m.args=[],v[3]))try{m.args=v[3]?a.parse(v[3]):[]}catch{}}return m},e.decodePayload=function(d){var c=function(k,y){for(var O=0,D=k;D<y.length;D++){if(y.charAt(D)=="")return O;O++}return O};if(d.charAt(0)==""){for(var m=[],v=1,g="";v<d.length;v++)if(d.charAt(v)==""){var b=d.substr(v+1).substr(0,g);if(d.charAt(v+1+Number(g))!=""&&v+1+Number(g)!=d.length){var T=Number(g);l=c(v+T+1,d),b=d.substr(v+1).substr(0,T+l),v+=l}m.push(e.decodePacket(b)),v+=Number(g)+1,g=""}else g+=d.charAt(v);return m}return[e.decodePacket(d)]}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,r){function e(n,o){this.socket=n,this.sessid=o}t.Transport=e,r.util.mixin(e,r.EventEmitter),e.prototype.heartbeats=function(){return!0},e.prototype.onData=function(n){if(this!==this.socket.transport)return this;if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),n!==""){var o=r.parser.decodePayload(n);if(o&&o.length)for(var s=0,a=o.length;s<a;s++)this.onPacket(o[s])}return this},e.prototype.onPacket=function(n){return this.socket.setHeartbeatTimeout(),n.type=="heartbeat"?this.onHeartbeat():(n.type=="connect"&&n.endpoint==""&&this.onConnect(),n.type=="error"&&n.advice=="reconnect"&&(this.isOpen=!1),this.socket.onPacket(n),this)},e.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var n=this;this.closeTimeout=setTimeout(function(){n.socket&&n.socket.publish("info","socket disconnected by setCloseTimeout"),n.onDisconnect()},this.socket.closeTimeout)}},e.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket?(this.socket.transport===this?this.socket.onDisconnect():this.socket.setBuffer(!1),this):this},e.prototype.onConnect=function(){return this.socket.onConnect(),this},e.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},e.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},e.prototype.packet=function(n){this.send(r.parser.encodePacket(n))},e.prototype.onHeartbeat=function(n){this.packet({type:"heartbeat"})},e.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},e.prototype.onClose=function(){this.socket.publish("info","transport onClose"),this.isOpen=!1,this.socket.transport===this?this.socket.onClose():this.socket.setBuffer(!1),this.onDisconnect(),this.onDisconnectDone instanceof Function&&this.onDisconnectDone(null),this.onConnectionOver instanceof Function&&this.onConnectionOver(null)},e.prototype.onDisconnectDone=function(){},e.prototype.onConnectionOver=function(){},e.prototype.prepareUrl=function(){var n=this.socket.options;return this.scheme()+"://"+n.host+":"+n.port+"/"+n.resource+"/"+r.protocol+"/"+this.name+"/"+this.sessid},e.prototype.ready=function(n,o){o.call(this)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,r,e){function n(s){if(this.options={port:80,secure:!1,document:"document"in e&&document,resource:"socket.io",transports:s.transports||r.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,needToXHR:!0,manualFlush:!1},r.util.merge(this.options,s),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||r.util.ua.hasCORS)){var a=this;r.util.on(e,"beforeunload",function(){a.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function o(){}t.Socket=n,r.util.mixin(n,r.EventEmitter),n.prototype.of=function(s){return this.namespaces[s]||(this.namespaces[s]=new r.SocketNamespace(this,s),s!==""&&this.namespaces[s].packet({type:"connect"})),this.namespaces[s]},n.prototype.publish=function(){var s;for(var a in this.emit.apply(this,arguments),this.namespaces)this.namespaces.hasOwnProperty(a)&&(s=this.of(a)).$emit.apply(s,arguments)},n.prototype.guid=function(){var s=root.crypto||root.msCrypto;if(s){var a=new Uint8Array(16);s.getRandomValues(a),a[6]&=15,a[6]|=64,a[8]&=63,a[8]|=128;for(var i="",u=0;u<a.length;u++){var d=a[u].toString(16);d.length===1&&(d="0"+d),i+=d}return i.substring(0,8)+"-"+i.substring(8,12)+"-"+i.substring(12,16)+"-"+i.substring(16,20)+"-"+i.substring(20)}},n.prototype.handshake=function(s){var a=this,i=this.options;if(!this.options.needToXHR&&this.options.transports.length===1&&this.options.transports[0]==="websocket"){var u=this.guid();if(u)return void setTimeout(function(){a.publish("info","xhr, skip and get:"+u),s.apply(null,[u,"90","60","websocket"])},0)}function d(b){b instanceof Error?(a.connecting=!1,a.publish("info","xhr, status:200, but got error:",b),a.onError("xhr, status:200, but got error:"+b.message,b)):s.apply(null,b.split(":"))}var c=["http"+(i.secure?"s":"")+":/",i.host+":"+i.port,i.resource,r.protocol,r.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!r.util.ua.hasCORS&&typeof document<"u"&&document){var m=document.getElementsByTagName("script")[0],v=document.createElement("script");v.src=c+"&jsonp="+r.j.length,v.onreadystatechange=function(){this.readyState=="loaded"&&v.parentNode&&(v.parentNode.removeChild(v),a.connecting=!1,a.publish("info","xhr, jsonp:Server down or port not open"),!a.reconnecting&&a.onError("Server down or port not open",new Error("xhr, jsonp:server down or port not open")),a.publish("handshake_failed"))},m.parentNode.insertBefore(v,m),r.j.push(function(b){d(b),v.parentNode.removeChild(v)})}else{var g=r.util.request();g.open("GET",c,!0),g.timeout=8e3,this.isXDomain()&&(g.withCredentials=!0),g.onreadystatechange=function(){a.publish("info","xhr, readyState:"+g.readyState+" status:"+g.status),g.readyState==4&&(a.publish("info","xhr, responseText:"+g.responseText),g.onreadystatechange=o,g.status==200?d(g.responseText):g.status==403?(a.connecting=!1,a.onError(g.responseText,new Error("xhr, status:403"+g.responseText)),a.publish("handshake_failed")):(a.connecting=!1,!a.reconnecting&&a.onError(g.responseText,new Error("xhr, status:"+g.status+" "+g.responseText)),a.publish("handshake_failed")))},g.ontimeout=function(b){a.publish("info","xhr, timeout"),a.connecting=!1,!a.reconnecting&&a.onError(g.responseText,new Error("xhr, timeout")),a.publish("handshake_failed")},g.send(null)}},n.prototype.connect=function(s){if(this.connecting)return this;var a=this;return a.connecting=!0,this.handshake(function(i,u,d,c){a.publish("info","SocketIO handshake parameter: sid: "+i+", transports: "+c+", close: "+d+", heartbeat: "+u),a.sessionid=i,a.closeTimeout=1e3*d,a.heartbeatTimeout=1e3*u,a.transports||(a.transports=a.origTransports=c?r.util.intersect(c.split(","),a.options.transports):a.options.transports),a.setHeartbeatTimeout(),a.once("connect",function(){a.publish("info","tcp, clear connect timeout due to recv connect event"),clearTimeout(a.connectTimeoutTimer),a.connectTimeoutTimer=null,s&&typeof s=="function"&&s()}),a.doConnect()}),this},n.prototype.doConnect=function(){var s=this;if(s.transport&&s.transport.clearTimeouts(),s.transport=s.getTransport(s.transports),!s.transport)return s.publish("connect_failed");s.transport.ready(s,function(){s.connecting=!0,s.publish("info","tcp, connecting, transport ready in "+s.transport.name),s.publish("connecting",s.transport.name),s.transport.open(),s.options["connect timeout"]&&(s.connectTimeoutTimer&&clearTimeout(s.connectTimeoutTimer),s.publish("info","set new connect timeout"),s.connectTimeoutTimer=setTimeout(function(){s.publish("info","trigger connect timeout due to setTimeout"),s.transport.close(),s.tryNextTransport()},s.options["connect timeout"]))})},n.prototype.getTransport=function(s){const a=this;for(var i,u=s||this.transports,d=0;i=u[d];d++)if(a.publish("info","check transport: "+i),r.Transport[i]&&r.Transport[i].check(this)&&(!this.isXDomain()||r.Transport[i].xdomainCheck(this)))return a.publish("info","use transport: "+i),new r.Transport[i](this,this.sessionid);return null},n.prototype.tryNextTransport=function(){if(!this.connected&&(this.connecting=!1,this.options["try multiple transports"])){for(var s=this.transports;s.length>0&&s.splice(0,1)[0]!=this.transport.name;);s.length?this.doConnect():this.publish("connect_failed")}},n.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var s=this;this.heartbeatTimeoutTimer=setTimeout(function(){s.transport&&(s.publish("info","transport closed by setHeartbeatTimeout"),s.transport.onClose())},this.heartbeatTimeout)}},n.prototype.packet=function(s){return this.connected&&!this.doBuffer?this.transport.packet(s):this.buffer.push(s),this},n.prototype.setBuffer=function(s){this.doBuffer=s,!s&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},n.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},n.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.publish("info","socket disconnected by IM SDK"),this.onDisconnect("booted")),this},n.prototype.disconnectSync=function(){var s=r.util.request(),a=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,r.protocol,"",this.sessionid].join("/")+"/?disconnect=1";s.open("GET",a,!1),s.send(null),this.publish("info","socket disconnected by disconnectSync before page unload"),this.onDisconnect("booted")},n.prototype.isXDomain=function(){var s=e&&e.location||{},a=s.port||(s.protocol=="https:"?443:80);return this.options.host!==s.hostname||this.options.port!=a},n.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},n.prototype.onOpen=function(){this.publish("info","tcp, websocket onOpen"),this.open=!0},n.prototype.onClose=function(){this.publish("info","tcp, websocket onClose"),this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},n.prototype.onPacket=function(s){this.of(s.endpoint).onPacket(s)},n.prototype.onError=function(s,a){s&&s.advice&&s.advice==="reconnect"&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",s&&s.reason?s.reason:s,a)},n.prototype.onDisconnect=function(s){var a=this.connected,i=this.connecting;this.publish("info",s?"tcp, onDisconnect reason:"+s:"tcp, onDisconnect"),this.connected=!1,this.connecting=!1,this.open=!1,(a||i)&&this.transport&&(this.transport.close(),this.transport.clearTimeouts(),a&&(this.publish("disconnect",s),s!="booted"&&this.options.reconnect&&!this.reconnecting&&this.reconnect()),i&&(this.connectTimeoutTimer&&(this.publish("info","clear connect timeout due to onDisconnect"),clearTimeout(this.connectTimeoutTimer)),this.tryNextTransport()))},n.prototype.reconnect=function(){this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var s=this,a=this.options["max reconnection attempts"],i=this.options["try multiple transports"],u=this.options["reconnection limit"];function d(){if(s.connected){for(var m in s.namespaces)s.namespaces.hasOwnProperty(m)&&m!==""&&s.namespaces[m].packet({type:"connect"});s.publish("reconnect",s.transport.name,s.reconnectionAttempts)}clearTimeout(s.reconnectionTimer),s.removeListener("connect_failed",c),s.removeListener("connect",c),s.reconnecting=!1,delete s.reconnectionAttempts,delete s.reconnectionDelay,delete s.reconnectionTimer,delete s.redoTransports,s.options["try multiple transports"]=i}function c(){if(s.reconnecting)return s.connected?d():s.connecting&&s.reconnecting?s.reconnectionTimer=setTimeout(c,1e3):void(s.reconnectionAttempts++>=a?s.redoTransports?(s.publish("reconnect_failed"),d()):(s.on("connect_failed",c),s.options["try multiple transports"]=!0,s.transports=s.origTransports,s.transport=s.getTransport(),s.redoTransports=!0,s.connect()):(s.reconnectionDelay<u&&(s.reconnectionDelay*=2),s.connect(),s.publish("reconnecting",s.reconnectionDelay,s.reconnectionAttempts),s.reconnectionTimer=setTimeout(c,s.reconnectionDelay)))}this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(c,this.reconnectionDelay),this.on("connect",c)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports,root),function(t,r){function e(o,s){this.socket=o,this.name=s||"",this.flags={},this.json=new n(this,"json"),this.ackPackets=0,this.acks={}}function n(o,s){this.namespace=o,this.name=s}t.SocketNamespace=e,r.util.mixin(e,r.EventEmitter),e.prototype.$emit=r.EventEmitter.prototype.emit,e.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},e.prototype.packet=function(o){return o.endpoint=this.name,this.socket.packet(o),this.flags={},this},e.prototype.send=function(o,s){var a={type:this.flags.json?"json":"message",data:o};return typeof s=="function"&&(a.id=++this.ackPackets,a.ack=!0,this.acks[a.id]=s),this.packet(a)},e.prototype.emit=function(o){var s=Array.prototype.slice.call(arguments,1),a=s[s.length-1],i={type:"event",name:o};return typeof a=="function"&&(i.id=++this.ackPackets,i.ack="data",this.acks[i.id]=a,s=s.slice(0,s.length-1)),i.args=s,this.packet(i)},e.prototype.disconnect=function(){return this.name===""?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},e.prototype.onPacket=function(o){var s=this;function a(){s.packet({type:"ack",args:r.util.toArray(arguments),ackId:o.id})}switch(o.type){case"connect":this.$emit("connect");break;case"disconnect":this.name===""?(this.socket.publish("info","socket disconnected by SocketNameSpace.onPacket"),this.socket.onDisconnect(o.reason||"booted")):this.$emit("disconnect",o.reason);break;case"message":case"json":var i=["message",o.data];o.ack=="data"?i.push(a):o.ack&&this.packet({type:"ack",ackId:o.id}),this.$emit.apply(this,i);break;case"event":i=[o.name].concat(o.args),o.ack=="data"&&i.push(a),this.$emit.apply(this,i);break;case"ack":this.acks[o.ackId]&&(this.acks[o.ackId].apply(this,o.args),delete this.acks[o.ackId]);break;case"error":this.socket.publish("info","packet, type:error",o),o.advice?this.socket.onError(o,new Error("packet, type:error and advice is "+o.advice)):o.reason==="unauthorized"?this.$emit("connect_failed",o.reason):this.$emit("error",o.reason,new Error("packet, type:error and reason is "+o.reason))}},n.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},n.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,r,e){function n(o){r.Transport.apply(this,arguments)}t.websocket=n,r.util.inherit(n,r.Transport),n.prototype.name="websocket",n.prototype.open=function(){var o,s=r.util.query(this.socket.options.query),a=this;return o||(o=e.MozWebSocket||e.WebSocket),this.websocket=new o(this.prepareUrl()+s),this.websocket.onopen=function(){a.onOpen(),a.socket.setBuffer(!1)},this.websocket.onmessage=function(i){a.onData(i.data)},this.websocket.onclose=function(){a.socket.setBuffer(!0),a.onClose()},this.websocket.onerror=function(i){var u="";i&&i.message?u=i.message:i.target&&(u=i.target.readyState?"websocket, readyState:"+i.target.readyState:"websocket event"),a.onError(u,i)},this},r.util.ua.iDevice?n.prototype.send=function(o){var s=this;return setTimeout(function(){s.websocket.send(o)},0),this}:n.prototype.send=function(o){return this.websocket.send(o),this},n.prototype.payload=function(o){for(var s=0,a=o.length;s<a;s++)this.packet(o[s]);return this},n.prototype.close=function(){return this.websocket.close(),this},n.prototype.onError=function(o,s){this.socket.publish("info","tcp, onError",o,s),this.socket.onError(o,s)},n.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},n.check=function(){return"WebSocket"in e&&!("__addTask"in WebSocket)||"MozWebSocket"in e},n.xdomainCheck=function(){return!0},r.transports.push("websocket")}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,root),function(t,r,e){function n(s){s&&(r.Transport.apply(this,arguments),this.sendBuffer=[])}function o(){}t.XHR=n,r.util.inherit(n,r.Transport),n.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},n.prototype.payload=function(s){for(var a=[],i=0,u=s.length;i<u;i++)a.push(r.parser.encodePacket(s[i]));this.send(r.parser.encodePayload(a))},n.prototype.send=function(s){return this.post(s),this},n.prototype.post=function(s){var a=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),e.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=function(){this.onload=o,a.socket.setBuffer(!1)}:this.sendXHR.onreadystatechange=function(){this.readyState==4&&(this.onreadystatechange=o,a.posting=!1,this.status==200?a.socket.setBuffer(!1):a.onClose())},this.sendXHR.send(s)},n.prototype.close=function(){return this.onClose(),this},n.prototype.request=function(s){var a=r.util.request(this.socket.isXDomain()),i=r.util.query(this.socket.options.query,"t="+ +new Date);if(a.open(s||"GET",this.prepareUrl()+i,!0),s=="POST")try{a.setRequestHeader?a.setRequestHeader("Content-type","text/plain;charset=UTF-8"):a.contentType="text/plain"}catch{}return a},n.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},n.check=function(s,a){try{var i=r.util.request(a),u=e.XDomainRequest&&i instanceof XDomainRequest,d=s&&s.options&&s.options.secure?"https:":"http:",c=e.location&&d!=e.location.protocol;if(i&&(!u||!c))return!0}catch{}return!1},n.xdomainCheck=function(s){return n.check(s,!0)}}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,root),function(t,r,e){function n(){r.Transport.XHR.apply(this,arguments)}function o(){}t["xhr-polling"]=n,r.util.inherit(n,r.Transport.XHR),r.util.merge(n,r.Transport.XHR),n.prototype.name="xhr-polling",n.prototype.heartbeats=function(){return!1},n.prototype.open=function(){return r.Transport.XHR.prototype.open.call(this),!1},n.prototype.get=function(){if(this.isOpen){var s=this;this.xhr=this.request(),e.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=function(){this.onload=o,this.onerror=o,s.retryCounter=1,s.onData(this.responseText),s.get()},this.xhr.onerror=function(){s.retryCounter++,!s.retryCounter||s.retryCounter>3?s.onClose():s.get()}):this.xhr.onreadystatechange=function(){this.readyState==4&&(this.onreadystatechange=o,this.status==200?(s.onData(this.responseText),s.get()):s.onClose())},this.xhr.send(null)}},n.prototype.onClose=function(){if(r.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=o;try{this.xhr.abort()}catch{}this.xhr=null}},n.prototype.ready=function(s,a){var i=this;r.util.defer(function(){a.call(i)})},r.transports.push("xhr-polling")}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,root),__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=(function(){return io}).apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__===void 0||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()}).call(this,__webpack_require__(56),__webpack_require__(145)(module))},function(t,r){t.exports=function(e){var n=-1,o=Array(e.size);return e.forEach(function(s){o[++n]=s}),o}},function(t,r,e){var n,o=e(25),s=e(44),a=e(13),i=e(74),u=e(685),d=e(692),c={initReporter:function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},v={app_key:m.appKey,platform:"Web",dev_id:s.deviceId,sdk_ver:a.info.version,env:"online",os_name:i.os?i.os.family:"",os_ver:i.os?i.os.version:"",model:i.version,manufactor:a.hostEnv,host_env:a.hostEnv,host_info:i.ua,host_env_ver:i.version};a.isBrowser||(m.isDataReportEnable=!1);var g=new u({isDataReportEnable:m.isDataReportEnable,reportConfigUrl:m.reportConfigUrl,reportUrl:m.reportUrl,common:v,request:d,logger:m.logger,autoStart:a.isBrowser});return g}};c.sendBeacon=navigator&&navigator.sendBeacon&&o(n=navigator.sendBeacon).call(n,navigator)||function(m,v){var g=new XMLHttpRequest;g.open("POST",m,!0),g.send(v)},t.exports=c},function(t,r,e){t.exports=e(686)},function(t,r,e){var n=e(1),o=e(14);n({global:!0,forced:o.globalThis!==o},{globalThis:o})},function(t,r,e){var n=e(1),o=e(11),s=e(112),a=e(28),i=e(29),u=e(38).f,d=e(131),c=e(165),m=e(703),v=e(127),g=e(705),b=!1,T=v("meta"),k=0,y=function(D){u(D,T,{value:{objectID:"O"+k++,weakData:{}}})},O=t.exports={enable:function(){O.enable=function(){},b=!0;var D=d.f,he=o([].splice),ae={};ae[T]=1,D(ae).length&&(d.f=function(Ne){for(var ue=D(Ne),Y=0,_e=ue.length;Y<_e;Y++)if(ue[Y]===T){he(ue,Y,1);break}return ue},n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:c.f}))},fastKey:function(D,he){if(!a(D))return typeof D=="symbol"?D:(typeof D=="string"?"S":"P")+D;if(!i(D,T)){if(!m(D))return"F";if(!he)return"E";y(D)}return D[T].objectID},getWeakData:function(D,he){if(!i(D,T)){if(!m(D))return!0;if(!he)return!1;y(D)}return D[T].weakData},onFreeze:function(D){return g&&b&&m(D)&&!i(D,T)&&y(D),D}};s[T]=!0},function(t,r,e){var n=e(19),o=e(31),s=e(16),a=e(36),i=TypeError;t.exports=function(u,d){var c,m=a(this),v=o(m.get),g=o(m.has),b=o(m.set),T=arguments.length>2?arguments[2]:void 0;if(!s(d)&&!s(T))throw i("At least one callback required");return n(g,m,u)?(c=n(v,m,u),s(d)&&(c=d(c),n(b,m,u,c))):s(T)&&(c=T(),n(b,m,u,c)),c}},function(t,r,e){t.exports=e(735)},function(t,r,e){var n=e(5);e(44);function o(){}o.typeMap={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,tip:10,robot:11,g2:12,custom:100};var s=o.typeReverseMap={0:"text",1:"image",2:"audio",3:"video",4:"geo",5:"notification",6:"file",10:"tip",11:"robot",12:"g2",100:"custom"};o.validTypes=n(o.typeMap),o.setFlow=function(a,i){a.flow=a.from===i?a.to===i?"in":"out":"in",a.type==="robot"&&a.content&&a.content.msgOut&&(a.flow="in")},o.getType=function(a){var i=a.type;return s[i]||i},t.exports=o},function(t,r,e){t.exports=function(n,o,s,a){var i=self||window;try{try{var u;try{u=new i.Blob([n])}catch{(u=new(i.BlobBuilder||i.WebKitBlobBuilder||i.MozBlobBuilder||i.MSBlobBuilder)).append(n),u=u.getBlob()}var d=i.URL||i.webkitURL,c=d.createObjectURL(u),m=new i[o](c,s);return d.revokeObjectURL(c),m}catch{return new i[o]("data:application/javascript,".concat(encodeURIComponent(n)),s)}}catch{if(!a)throw Error("Inline worker is not supported");return new i[o](a,s)}}},function(t,r,e){e(314).polyfill(),e(13).isBrowser=!0},function(t,r,e){var n=e(373);t.exports=n},function(t,r,e){var n=e(467);t.exports=n},function(t,r){var e=/^(?:0|[1-9]\d*)$/;t.exports=function(n,o){var s=typeof n;return!!(o=o??9007199254740991)&&(s=="number"||s!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<o}},function(t,r,e){t.exports=e(555)},function(t,r,e){(function(n){var o,s=e(26),a=e(3),i=e(123),u=e(15),d=e(32),c=e(2),m=e(47),v=e(7),g=e(5),b=e(17);(function(T,k){var y,O=(T=T!==void 0?T:typeof self<"u"?self:n!==void 0?n:{}).IDBKeyRange||T.webkitIDBKeyRange,D="readonly",he="readwrite",ae=Object.prototype.hasOwnProperty,Ne=function(){if(!y&&!(y=T.indexedDB||T.webkitIndexedDB||T.mozIndexedDB||T.oIndexedDB||T.msIndexedDB||(T.indexedDB===null&&T.shimIndexedDB?T.shimIndexedDB:void 0)))throw"IndexedDB required";return y},ue=!1,Y=navigator&&!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent),_e=function(dr){return dr},Ce=function(dr){var pr;return u(pr=Object.prototype.toString.call(dr)).call(pr,8,-1).toLowerCase()},ze=function(dr){return typeof dr=="function"},ie=function(dr){return Ce(dr)==="number"},le=function(dr){return Ce(dr)==="array"},Ie=function(dr){return dr===void 0},pe=function(dr,pr){var sr=this,hr=!1;this.name=pr,this.getIndexedDB=function(){return dr},this.add=function(ir){if(hr)throw"Database has been closed";for(var Ue=[],rr=0,or=0;or<arguments.length-1;or++)if(d(arguments[or+1]))for(var Pt=0;Pt<arguments[or+1].length;Pt++)Ue[rr]=arguments[or+1][Pt],rr++;else Ue[rr]=arguments[or+1],rr++;var Et=dr.transaction(ir,he),kt=Et.objectStore(ir);return new a(function(er,cr){c(Ue).call(Ue,function(mr){var vr;if(mr.item&&mr.key){var Tr=mr.key;mr=mr.item,vr=kt.add(mr,Tr)}else vr=kt.add(mr);vr.onsuccess=function(Ir){var kr=Ir.target,Ar=kr.source.keyPath;Ar===null&&(Ar="__id__"),m(mr,Ar,{value:kr.result,enumerable:!0})}}),Et.oncomplete=function(){er(Ue,sr)},Et.onerror=function(mr){mr.preventDefault(),cr(mr)},Et.onabort=function(mr){cr(mr)}})},this.updateAndDelete=function(ir,Ue,rr){if(hr)throw"Database has been closed";var or=dr.transaction(ir,he),Pt=or.objectStore(ir),Et=Pt.keyPath;return new a(function(kt,er){c(Ue).call(Ue,function(cr){if(cr.item&&cr.key){var mr=cr.key;cr=cr.item,Pt.put(cr,mr)}else Pt.put(cr)}),c(rr).call(rr,function(cr){Pt.delete(cr[Et])}),or.oncomplete=function(){kt([Ue,rr])},or.onerror=function(cr){er(cr)}})},this.update=function(ir){if(hr)throw"Database has been closed";for(var Ue,rr=[],or=1;or<arguments.length;or++)d(Ue=arguments[or])?rr=v(rr).call(rr,Ue):rr.push(Ue);var Pt=dr.transaction(ir,he),Et=Pt.objectStore(ir);return Et.keyPath,new a(function(kt,er){c(rr).call(rr,function(cr){var mr;if(cr.item&&cr.key){var vr=cr.key;cr=cr.item,mr=Et.put(cr,vr)}else mr=Et.put(cr);mr.onsuccess=function(Tr){},mr.onerror=function(Tr){}}),Pt.oncomplete=function(){kt(rr,sr)},Pt.onerror=function(cr){er(cr)},Pt.onabort=function(cr){er(cr)}})},this.remove=function(ir,Ue,rr,or,Pt,Et,kt){if(hr)throw"Database has been closed";var er=dr.transaction(ir,he),cr=er.objectStore(ir);return new a(function(mr,vr){function Tr(kr){return kr==null}var Ir;Tr(or)&&(or=-1/0),Tr(Pt)&&(Pt=1/0),Ue===null||d(Ue)||(Ue=[Ue]),Tr(rr)?Ue!==null?c(Ue).call(Ue,function(kr){cr.delete(kr)}):cr.delete(range=O.bound(or,Pt,Et,kt)):(Ir=Ue!==null?O.only(Ue[0]):O.bound(or,Pt,Et,kt),cr.index(rr).openCursor(Ir).onsuccess=function(kr){var Ar=kr.target.result;Ar&&(Ar.delete(),Ar.continue())}),er.oncomplete=function(){mr()},er.onerror=function(kr){vr(kr)},er.onabort=function(kr){vr(kr)}})},this.clear=function(ir){if(hr)throw"Database has been closed";var Ue=dr.transaction(ir,he);return Ue.objectStore(ir).clear(),new a(function(rr,or){Ue.oncomplete=function(){rr()},Ue.onerror=function(Pt){or(Pt)}})},this.close=function(){hr||(dr.close(),hr=!0,delete Lt[pr])},this.get=function(ir,Ue){if(hr)throw"Database has been closed";var rr=dr.transaction(ir),or=rr.objectStore(ir).get(Ue);return new a(function(Pt,Et){or.onsuccess=function(kt){Pt(kt.target.result)},rr.onerror=function(kt){Et(kt)}})},this.query=function(ir,Ue){if(hr)throw"Database has been closed";return new qe(ir,dr,Ue)},this.count=function(ir,Ue){if(hr)throw"Database has been closed";dr.transaction(ir).objectStore(ir)};for(var Fe=0,nr=dr.objectStoreNames.length;Fe<nr;Fe++)(function(ir){for(var Ue in sr[ir]={},sr)ae.call(sr,Ue)&&Ue!=="close"&&(sr[ir][Ue]=function(rr){return function(){var or,Pt=v(or=[ir]).call(or,u([]).call(arguments,0));return sr[rr].apply(sr,Pt)}}(Ue))})(dr.objectStoreNames[Fe])},qe=function(dr,pr,sr){var hr,Fe=this,nr=!1,ir=!1,Ue=function(or,Pt,Et,kt,er,cr,mr){return new a(function(vr,Tr){var Ir=nr||ir?he:D,kr=pr.transaction(dr,Ir),Ar=kr.objectStore(dr),Rr=sr?Ar.index(sr):Ar,Cn=or?O[or].apply(null,Pt):null,Or=[],Pr=[Cn],Nr=0;er=er||null,cr=cr||[],Et!=="count"&&Pr.push(kt||"next");var Qr=!!nr&&g(nr);Rr[Et].apply(Rr,Pr).onsuccess=function(hn){var Ur=hn.target.result;if(s(Ur)===s(0))Or=Ur;else if(Ur){if(er!==null&&er[0]>Nr)Nr=er[0],Ur.advance(er[0]);else if(!(er!==null&&Nr>=er[0]+er[1])){var qr=!0,Gn="value"in Ur?Ur.value:Ur.key;c(cr).call(cr,function($n){$n&&$n.length&&($n.length===2?qr=qr&&Gn[$n[0]]===$n[1]:ze($n[0])&&(qr=qr&&$n[0].apply(void 0,[Gn])))}),qr&&(Nr++,Or.push(mr(Gn)),ir?Ur.delete():nr&&(Gn=function($n){for(var Jr=0;Jr<Qr.length;Jr++){var Lr=Qr[Jr],Kn=nr[Lr];Kn instanceof Function&&(Kn=Kn($n)),$n[Lr]=Kn}return $n}(Gn),Ur.update(Gn))),Ur.continue()}}},kr.oncomplete=function(){vr(Or)},kr.onerror=function(hn){Tr(hn)},kr.onabort=function(hn){Tr(hn)}})},rr=function(or,Pt){var Et="next",kt="openCursor",er=[],cr=null,mr=_e,vr=!1,Tr=function(){return Ue(or,Pt,kt,vr?Et+"unique":Et,cr,er,mr)},Ir=function(){return Et=null,kt="count",{execute:Tr}},kr=function Ur(){return(cr=le(arguments[0])?arguments[0]:u(Array.prototype).call(arguments,0,2)).length==1&&cr.unshift(0),ie(cr[1])||(cr=null),{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Cn,desc:Or,distinct:Pr,modify:Nr,limit:Ur,map:Qr,remove:hn}},Ar=function Ur(qr){return(qr=!!Ie(qr)||!!qr)&&(kt="openKeyCursor"),{execute:Tr,keys:Ur,filter:Rr,asc:Cn,desc:Or,distinct:Pr,modify:Nr,limit:kr,map:Qr,remove:hn}},Rr=function Ur(){return er.push(u(Array.prototype).call(arguments,0,2)),{execute:Tr,count:Ir,keys:Ar,filter:Ur,asc:Cn,desc:Or,distinct:Pr,modify:Nr,limit:kr,map:Qr,remove:hn}},Cn=function Ur(qr){return qr=!!Ie(qr)||!!qr,Et=qr?"next":"prev",{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Ur,desc:Or,distinct:Pr,modify:Nr,limit:kr,map:Qr,remove:hn}},Or=function Ur(qr){return qr=!!Ie(qr)||!!qr,Et=qr?"prev":"next",{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Cn,desc:Ur,distinct:Pr,modify:Nr,limit:kr,map:Qr,remove:hn}},Pr=function Ur(qr){return qr=!!Ie(qr)||!!qr,vr=qr,{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Cn,desc:Or,distinct:Ur,modify:Nr,limit:kr,map:Qr,remove:hn}},Nr=function Ur(qr){return nr=qr,{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Cn,desc:Or,distinct:Pr,modify:Ur,limit:kr,map:Qr,remove:hn}},Qr=function Ur(qr){return ze(qr)&&(mr=qr),{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Cn,desc:Or,distinct:Pr,modify:Nr,limit:kr,map:Ur,remove:hn}},hn=function Ur(qr){return qr=!!Ie(qr)||!!qr,ir=qr,{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Cn,desc:Or,distinct:Pr,modify:Nr,limit:kr,map:Qr,remove:Ur}};return{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Cn,desc:Or,distinct:Pr,modify:Nr,limit:kr,map:Qr,remove:hn}};c(hr="only bound upperBound lowerBound".split(" ")).call(hr,function(or){Fe[or]=function(){return new rr(or,arguments)}}),this.filter=function(){var or=new rr(null,null);return b(or).apply(or,arguments)},this.all=function(){var or;return b(or=this).call(or)}},$e=function(dr,pr,sr,hr){var Fe=dr.target.result,nr=new pe(Fe,pr);return Lt[pr]=Fe,a.resolve(nr)},Lt={},Dt={version:"0.10.2",open:function(dr){var pr;return new a(function(sr,hr){var Fe;Lt[dr.server]?$e({target:{result:Lt[dr.server]}},dr.server,dr.version,dr.schema).then(sr,hr):(ue?a.resolve():Y&&Ne().databases?new a(function(nr){var ir=function(){return Ne().databases().finally(nr)};Fe=i(ir,100),ir()}).finally(function(){ue=!0,clearInterval(Fe)}):(ue=!0,a.resolve())).then(function(){try{pr=Ne().open(dr.server,dr.version)}catch(nr){hr(nr)}pr.onsuccess=function(nr){$e(nr,dr.server,dr.version,dr.schema).then(sr,hr)},pr.onupgradeneeded=function(nr){(function(ir,Ue,rr){for(var or in typeof Ue=="function"&&(Ue=Ue()),Ue){var Pt,Et=Ue[or];for(var kt in Pt=!ae.call(Ue,or)||rr.objectStoreNames.contains(or)?ir.currentTarget.transaction.objectStore(or):rr.createObjectStore(or,Et.key),Et.indexes){var er=Et.indexes[kt];try{Pt.index(kt)}catch{Pt.createIndex(kt,er.key||kt,g(er).length?er:{unique:!1})}}}})(nr,dr.schema,nr.target.result)},pr.onerror=function(nr){hr(nr)}})})},remove:function(dr){return new a(function(pr,sr){if(!dr)return pr();var hr,Fe;s(dr)===pe&&(dr=dr.name),typeof dr=="string"&&(hr=Lt[dr]),hr&&typeof hr.close=="function"&&hr.close();try{Fe=Ne().deleteDatabase(dr)}catch(nr){sr(nr)}Fe.onsuccess=function(nr){delete Lt[dr],pr(dr)},Fe.onerror=function(nr){sr(nr)},Fe.onblocked=function(nr){sr(nr)}})}};t.exports!==void 0?t.exports=Dt:(o=(function(){return Dt}).call(r,e,r,t))===void 0||(t.exports=o)})(void 0)}).call(this,e(56))},function(t,r,e){var n=e(586);t.exports=n},function(t,r,e){t.exports=e(639)},function(t,r){var e={set:function(n,o,s){e[n]=o,s&&(s.support=o)}};t.exports=e},function(t,r,e){var n=e(5),o=e(2),s=e(25),a=e(0),i=a.notundef,u=a.fillPropertyWithDefault,d=n,c={},m={},v={},g=[],b={normal:0,advanced:1},T={manager:0,all:1};c.inviteMode=c.updateCustomMode=c.updateTeamMode=T;var k={0:"normal",1:"advanced"},y=c.joinMode={noVerify:0,needVerify:1,rejectAll:2};m.joinMode={0:"noVerify",1:"needVerify",2:"rejectAll"},v.joinMode=d(y),g.push("join");var O=c.beInviteMode={needVerify:0,noVerify:1};function D(ae){var Ne;a.verifyOptions(ae,"action","superTeam::SuperTeam"),a.verifyOptions(ae,"teamId","superTeam::SuperTeam"),i(ae.teamId)&&(this.teamId=ae.teamId),i(ae.type)&&(this.type=b[ae.type]),i(ae.avatar)&&(this.avatar=""+ae.avatar),i(ae.name)&&(this.name=""+ae.name),i(ae.intro)&&(this.intro=""+ae.intro),i(ae.announcement)&&(this.announcement=""+ae.announcement),i(ae.custom)&&(this.custom=""+ae.custom),i(ae.inviteMode)&&(this.inviteMode=T[ae.inviteMode]),i(ae.updateCustomMode)&&(this.updateCustomMode=T[ae.updateCustomMode]),i(ae.updateTeamMode)&&(this.updateTeamMode=T[ae.updateTeamMode]),o(g).call(g,s(Ne=this.setMode).call(Ne,this,ae))}function he(ae,Ne){i(ae[Ne+="Mode"])&&(ae[Ne]=m[Ne][ae[Ne]])}m.beInviteMode={0:"needVerify",1:"noVerify"},g.push("beInvite"),m.inviteMode=m.updateCustomMode=m.updateTeamMode={0:"manager",1:"all"},g.push("invite"),g.push("updateCustom"),g.push("updateTeam"),v.inviteMode=v.updateCustomMode=v.updateTeamMode=d(T),v.beInviteMode=d(O),D.prototype.setMode=function(ae,Ne){i(ae[Ne+="Mode"])&&(a.verifyParamValid(Ne,ae[Ne],v[Ne],"Superteam::Team"),this[Ne]=c[Ne][ae[Ne]])},D.reverse=function(ae,Ne){var ue=a.copy(ae);if(i(ue.teamId)&&(ue.teamId=""+ue.teamId),i(ue.type)&&(ue.type=k[ue.type]),i(ue.level)&&(ue.level=+ue.level),i(ue.valid)&&(ue.valid=+ue.valid==1),i(ue.memberNum)&&(ue.memberNum=+ue.memberNum),i(ue.memberUpdateTime)&&(ue.memberUpdateTime=+ue.memberUpdateTime),i(ue.createTime)&&(ue.createTime=+ue.createTime),i(ue.updateTime)&&(ue.updateTime=+ue.updateTime),i(ue.validToCurrentUser)&&(ue.validToCurrentUser=ue.validToCurrentUser==="1"),i(ue.mute)&&(ue.mute=ue.mute==="1"),i(ue.muteType))switch(ue.muteType){case"0":ue.mute=!1,ue.muteType="none";break;case"1":ue.mute=!0,ue.muteType="normal";break;case"3":ue.mute=!0,ue.muteType="all"}else i(ue.mute)&&(ue.mute===1?(ue.mute=!0,ue.muteType="normal"):(ue.mute=!1,ue.muteType="none"));return o(g).call(g,s(he).call(he,null,ue)),delete ue.bits,Ne||D.fillProperties(ue),ue},D.fillProperties=function(ae){return u(ae,"avatar","")},t.exports=D},function(t,r,e){t.exports=e(661)},function(t,r,e){var n=e(0).notundef;function o(s){n(s.shouldPushNotificationWhenPCOnline)&&(this.open=s.shouldPushNotificationWhenPCOnline?2:1)}o.getDefaultConfig=function(){return{shouldPushNotificationWhenPCOnline:!0}},o.reverse=function(s){return{shouldPushNotificationWhenPCOnline:+s.open!=1}},t.exports=o},function(t,r,e){var n=e(74),o=e(755),s=e(288),a=e(255),i=e(198),u=e(0),d=e(306),c=e(284),m=e(184),v=e(760),g=e(761);t.exports=function(b){u.merge(b,{platform:n,xhr:o,io:s,naturalSort:a,deepAccess:i,util:u,support:d,blob:c,ajax:m,LoggerPlugin:v,usePlugin:g})}},function(t,r,e){var n=e(8),o=e(9),s=e(5),a=e(106).genPrivateUrl,i=e(0),u=i.notundef,d={"-2":"unset","-1":"restricted",0:"common",1:"owner",2:"manager",3:"guest",4:"anonymous"};function c(m){u(m.nick)&&(this.nick=""+m.nick),u(m.avatar)&&(this.avatar=""+m.avatar),u(m.custom)&&(this.custom=""+m.custom)}c.reverse=function(m){var v=i.copy(m);return u(v.chatroomId)&&(v.chatroomId=""+v.chatroomId),u(v.avatar)&&(v.avatar=a(v.avatar)),u(v.type)&&(v.type=d[v.type]),u(v.level)&&(v.level=+v.level),u(v.online)&&(v.online=+v.online==1),u(v.enterTime)&&(v.enterTime=+v.enterTime),u(v.guest)&&(v.guest=+v.guest==1),u(v.blacked)&&(v.blacked=+v.blacked==1),u(v.gaged)&&(v.gaged=+v.gaged==1),u(v.valid)&&(v.valid=+v.valid==1),u(v.updateTime)&&(v.updateTime=+v.updateTime),u(v.tempMuted)?v.tempMuted=+v.tempMuted==1:v.tempMuted=!1,u(v.tempMuteDuration)?v.tempMuteDuration=+v.tempMuteDuration:v.tempMuteDuration=0,v.online||delete v.enterTime,v.guest&&(v.type="guest",delete v.valid),v.type!=="common"&&delete v.level,delete v.guest,v},c.reverseMembers=function(m){return n(m).call(m,function(v){return o(c).call(c,v)})},c.validTypes=s(d),c.typeReverseMap=d,t.exports=c},function(t,r,e){var n,o,s,a,i,u,d,c,m,v,g,b,T,k,y,O,D,he,ae;t.exports=(n=e(89),e(764),void(n.lib.Cipher||(o=n,s=o.lib,a=s.Base,i=s.WordArray,u=s.BufferedBlockAlgorithm,d=o.enc,d.Utf8,c=d.Base64,m=o.algo.EvpKDF,v=s.Cipher=u.extend({cfg:a.extend(),createEncryptor:function(Ne,ue){return this.create(this._ENC_XFORM_MODE,Ne,ue)},createDecryptor:function(Ne,ue){return this.create(this._DEC_XFORM_MODE,Ne,ue)},init:function(Ne,ue,Y){this.cfg=this.cfg.extend(Y),this._xformMode=Ne,this._key=ue,this.reset()},reset:function(){u.reset.call(this),this._doReset()},process:function(Ne){return this._append(Ne),this._process()},finalize:function(Ne){return Ne&&this._append(Ne),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function Ne(ue){return typeof ue=="string"?ae:D}return function(ue){return{encrypt:function(Y,_e,Ce){return Ne(_e).encrypt(ue,Y,_e,Ce)},decrypt:function(Y,_e,Ce){return Ne(_e).decrypt(ue,Y,_e,Ce)}}}}()}),s.StreamCipher=v.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),g=o.mode={},b=s.BlockCipherMode=a.extend({createEncryptor:function(Ne,ue){return this.Encryptor.create(Ne,ue)},createDecryptor:function(Ne,ue){return this.Decryptor.create(Ne,ue)},init:function(Ne,ue){this._cipher=Ne,this._iv=ue}}),T=g.CBC=function(){var Ne=b.extend();function ue(Y,_e,Ce){var ze,ie=this._iv;ie?(ze=ie,this._iv=void 0):ze=this._prevBlock;for(var le=0;le<Ce;le++)Y[_e+le]^=ze[le]}return Ne.Encryptor=Ne.extend({processBlock:function(Y,_e){var Ce=this._cipher,ze=Ce.blockSize;ue.call(this,Y,_e,ze),Ce.encryptBlock(Y,_e),this._prevBlock=Y.slice(_e,_e+ze)}}),Ne.Decryptor=Ne.extend({processBlock:function(Y,_e){var Ce=this._cipher,ze=Ce.blockSize,ie=Y.slice(_e,_e+ze);Ce.decryptBlock(Y,_e),ue.call(this,Y,_e,ze),this._prevBlock=ie}}),Ne}(),k=(o.pad={}).Pkcs7={pad:function(Ne,ue){for(var Y=4*ue,_e=Y-Ne.sigBytes%Y,Ce=_e<<24|_e<<16|_e<<8|_e,ze=[],ie=0;ie<_e;ie+=4)ze.push(Ce);var le=i.create(ze,_e);Ne.concat(le)},unpad:function(Ne){var ue=255&Ne.words[Ne.sigBytes-1>>>2];Ne.sigBytes-=ue}},s.BlockCipher=v.extend({cfg:v.cfg.extend({mode:T,padding:k}),reset:function(){var Ne;v.reset.call(this);var ue=this.cfg,Y=ue.iv,_e=ue.mode;this._xformMode==this._ENC_XFORM_MODE?Ne=_e.createEncryptor:(Ne=_e.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==Ne?this._mode.init(this,Y&&Y.words):(this._mode=Ne.call(_e,this,Y&&Y.words),this._mode.__creator=Ne)},_doProcessBlock:function(Ne,ue){this._mode.processBlock(Ne,ue)},_doFinalize:function(){var Ne,ue=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(ue.pad(this._data,this.blockSize),Ne=this._process(!0)):(Ne=this._process(!0),ue.unpad(Ne)),Ne},blockSize:4}),y=s.CipherParams=a.extend({init:function(Ne){this.mixIn(Ne)},toString:function(Ne){return(Ne||this.formatter).stringify(this)}}),O=(o.format={}).OpenSSL={stringify:function(Ne){var ue=Ne.ciphertext,Y=Ne.salt;return(Y?i.create([1398893684,1701076831]).concat(Y).concat(ue):ue).toString(c)},parse:function(Ne){var ue,Y=c.parse(Ne),_e=Y.words;return _e[0]==1398893684&&_e[1]==1701076831&&(ue=i.create(_e.slice(2,4)),_e.splice(0,4),Y.sigBytes-=16),y.create({ciphertext:Y,salt:ue})}},D=s.SerializableCipher=a.extend({cfg:a.extend({format:O}),encrypt:function(Ne,ue,Y,_e){_e=this.cfg.extend(_e);var Ce=Ne.createEncryptor(Y,_e),ze=Ce.finalize(ue),ie=Ce.cfg;return y.create({ciphertext:ze,key:Y,iv:ie.iv,algorithm:Ne,mode:ie.mode,padding:ie.padding,blockSize:Ne.blockSize,formatter:_e.format})},decrypt:function(Ne,ue,Y,_e){return _e=this.cfg.extend(_e),ue=this._parse(ue,_e.format),Ne.createDecryptor(Y,_e).finalize(ue.ciphertext)},_parse:function(Ne,ue){return typeof Ne=="string"?ue.parse(Ne,this):Ne}}),he=(o.kdf={}).OpenSSL={execute:function(Ne,ue,Y,_e){_e||(_e=i.random(8));var Ce=m.create({keySize:ue+Y}).compute(Ne,_e),ze=i.create(Ce.words.slice(ue),4*Y);return Ce.sigBytes=4*ue,y.create({key:Ce,iv:ze,salt:_e})}},ae=s.PasswordBasedCipher=D.extend({cfg:D.cfg.extend({kdf:he}),encrypt:function(Ne,ue,Y,_e){var Ce=(_e=this.cfg.extend(_e)).kdf.execute(Y,Ne.keySize,Ne.ivSize);_e.iv=Ce.iv;var ze=D.encrypt.call(this,Ne,ue,Ce.key,_e);return ze.mixIn(Ce),ze},decrypt:function(Ne,ue,Y,_e){_e=this.cfg.extend(_e),ue=this._parse(ue,_e.format);var Ce=_e.kdf.execute(Y,Ne.keySize,Ne.ivSize,ue.salt);return _e.iv=Ce.iv,D.decrypt.call(this,Ne,ue,Ce.key,_e)}}))))},function(t,r,e){t.exports=e(283)},function(t,r,e){(function(n,o){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var s;s=function(){function a(nr){return typeof nr=="function"}var i=Array.isArray?Array.isArray:function(nr){return Object.prototype.toString.call(nr)==="[object Array]"},u=0,d=void 0,c=void 0,m=function(nr,ir){O[u]=nr,O[u+1]=ir,(u+=2)===2&&(c?c(D):Y())},v=typeof window<"u"?window:void 0,g=v||{},b=g.MutationObserver||g.WebKitMutationObserver,T=typeof self>"u"&&n!==void 0&&{}.toString.call(n)==="[object process]",k=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function y(){var nr=setTimeout;return function(){return nr(D,1)}}var O=new Array(1e3);function D(){for(var nr=0;nr<u;nr+=2)(0,O[nr])(O[nr+1]),O[nr]=void 0,O[nr+1]=void 0;u=0}var he,ae,Ne,ue,Y=void 0;function _e(nr,ir){var Ue=this,rr=new this.constructor(ie);rr[ze]===void 0&&sr(rr);var or=Ue._state;if(or){var Pt=arguments[or-1];m(function(){return dr(or,rr,Pt,Ue._result)})}else Lt(Ue,rr,nr,ir);return rr}function Ce(nr){if(nr&&typeof nr=="object"&&nr.constructor===this)return nr;var ir=new this(ie);return Ie(ir,nr),ir}T?Y=function(){return n.nextTick(D)}:b?(ae=0,Ne=new b(D),ue=document.createTextNode(""),Ne.observe(ue,{characterData:!0}),Y=function(){ue.data=ae=++ae%2}):k?((he=new MessageChannel).port1.onmessage=D,Y=function(){return he.port2.postMessage(0)}):Y=v===void 0?function(){try{var nr=Function("return this")().require("vertx");return(d=nr.runOnLoop||nr.runOnContext)!==void 0?function(){d(D)}:y()}catch{return y()}}():y();var ze=Math.random().toString(36).substring(2);function ie(){}function le(nr,ir,Ue){ir.constructor===nr.constructor&&Ue===_e&&ir.constructor.resolve===Ce?function(rr,or){or._state===1?qe(rr,or._result):or._state===2?$e(rr,or._result):Lt(or,void 0,function(Pt){return Ie(rr,Pt)},function(Pt){return $e(rr,Pt)})}(nr,ir):Ue===void 0?qe(nr,ir):a(Ue)?function(rr,or,Pt){m(function(Et){var kt=!1,er=function(cr,mr,vr,Tr){try{cr.call(mr,vr,Tr)}catch(Ir){return Ir}}(Pt,or,function(cr){kt||(kt=!0,or!==cr?Ie(Et,cr):qe(Et,cr))},function(cr){kt||(kt=!0,$e(Et,cr))},Et._label);!kt&&er&&(kt=!0,$e(Et,er))},rr)}(nr,ir,Ue):qe(nr,ir)}function Ie(nr,ir){if(nr===ir)$e(nr,new TypeError("You cannot resolve a promise with itself"));else if(or=typeof(rr=ir),rr===null||or!=="object"&&or!=="function")qe(nr,ir);else{var Ue=void 0;try{Ue=ir.then}catch(Pt){return void $e(nr,Pt)}le(nr,ir,Ue)}var rr,or}function pe(nr){nr._onerror&&nr._onerror(nr._result),Dt(nr)}function qe(nr,ir){nr._state===void 0&&(nr._result=ir,nr._state=1,nr._subscribers.length!==0&&m(Dt,nr))}function $e(nr,ir){nr._state===void 0&&(nr._state=2,nr._result=ir,m(pe,nr))}function Lt(nr,ir,Ue,rr){var or=nr._subscribers,Pt=or.length;nr._onerror=null,or[Pt]=ir,or[Pt+1]=Ue,or[Pt+2]=rr,Pt===0&&nr._state&&m(Dt,nr)}function Dt(nr){var ir=nr._subscribers,Ue=nr._state;if(ir.length!==0){for(var rr=void 0,or=void 0,Pt=nr._result,Et=0;Et<ir.length;Et+=3)rr=ir[Et],or=ir[Et+Ue],rr?dr(Ue,rr,or,Pt):or(Pt);nr._subscribers.length=0}}function dr(nr,ir,Ue,rr){var or=a(Ue),Pt=void 0,Et=void 0,kt=!0;if(or){try{Pt=Ue(rr)}catch(er){kt=!1,Et=er}if(ir===Pt)return void $e(ir,new TypeError("A promises callback cannot return that same promise."))}else Pt=rr;ir._state!==void 0||(or&&kt?Ie(ir,Pt):kt===!1?$e(ir,Et):nr===1?qe(ir,Pt):nr===2&&$e(ir,Pt))}var pr=0;function sr(nr){nr[ze]=pr++,nr._state=void 0,nr._result=void 0,nr._subscribers=[]}var hr=function(){function nr(ir,Ue){this._instanceConstructor=ir,this.promise=new ir(ie),this.promise[ze]||sr(this.promise),i(Ue)?(this.length=Ue.length,this._remaining=Ue.length,this._result=new Array(this.length),this.length===0?qe(this.promise,this._result):(this.length=this.length||0,this._enumerate(Ue),this._remaining===0&&qe(this.promise,this._result))):$e(this.promise,new Error("Array Methods must be provided an Array"))}return nr.prototype._enumerate=function(ir){for(var Ue=0;this._state===void 0&&Ue<ir.length;Ue++)this._eachEntry(ir[Ue],Ue)},nr.prototype._eachEntry=function(ir,Ue){var rr=this._instanceConstructor,or=rr.resolve;if(or===Ce){var Pt=void 0,Et=void 0,kt=!1;try{Pt=ir.then}catch(cr){kt=!0,Et=cr}if(Pt===_e&&ir._state!==void 0)this._settledAt(ir._state,Ue,ir._result);else if(typeof Pt!="function")this._remaining--,this._result[Ue]=ir;else if(rr===Fe){var er=new rr(ie);kt?$e(er,Et):le(er,ir,Pt),this._willSettleAt(er,Ue)}else this._willSettleAt(new rr(function(cr){return cr(ir)}),Ue)}else this._willSettleAt(or(ir),Ue)},nr.prototype._settledAt=function(ir,Ue,rr){var or=this.promise;or._state===void 0&&(this._remaining--,ir===2?$e(or,rr):this._result[Ue]=rr),this._remaining===0&&qe(or,this._result)},nr.prototype._willSettleAt=function(ir,Ue){var rr=this;Lt(ir,void 0,function(or){return rr._settledAt(1,Ue,or)},function(or){return rr._settledAt(2,Ue,or)})},nr}(),Fe=function(){function nr(ir){this[ze]=pr++,this._result=this._state=void 0,this._subscribers=[],ie!==ir&&(typeof ir!="function"&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof nr?function(Ue,rr){try{rr(function(or){Ie(Ue,or)},function(or){$e(Ue,or)})}catch(or){$e(Ue,or)}}(this,ir):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return nr.prototype.catch=function(ir){return this.then(null,ir)},nr.prototype.finally=function(ir){var Ue=this.constructor;return a(ir)?this.then(function(rr){return Ue.resolve(ir()).then(function(){return rr})},function(rr){return Ue.resolve(ir()).then(function(){throw rr})}):this.then(ir,ir)},nr}();return Fe.prototype.then=_e,Fe.all=function(nr){return new hr(this,nr).promise},Fe.race=function(nr){var ir=this;return i(nr)?new ir(function(Ue,rr){for(var or=nr.length,Pt=0;Pt<or;Pt++)ir.resolve(nr[Pt]).then(Ue,rr)}):new ir(function(Ue,rr){return rr(new TypeError("You must pass an array to race."))})},Fe.resolve=Ce,Fe.reject=function(nr){var ir=new this(ie);return $e(ir,nr),ir},Fe._setScheduler=function(nr){c=nr},Fe._setAsap=function(nr){m=nr},Fe._asap=m,Fe.polyfill=function(){var nr=void 0;if(o!==void 0)nr=o;else if(typeof self<"u")nr=self;else try{nr=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var ir=nr.Promise;if(ir){var Ue=null;try{Ue=Object.prototype.toString.call(ir.resolve())}catch{}if(Ue==="[object Promise]"&&!ir.cast)return}nr.Promise=Fe},Fe.Promise=Fe,Fe},t.exports=s()}).call(this,e(315),e(56))},function(t,r){var e,n,o=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function i(k){if(e===setTimeout)return setTimeout(k,0);if((e===s||!e)&&setTimeout)return e=setTimeout,setTimeout(k,0);try{return e(k,0)}catch{try{return e.call(null,k,0)}catch{return e.call(this,k,0)}}}(function(){try{e=typeof setTimeout=="function"?setTimeout:s}catch{e=s}try{n=typeof clearTimeout=="function"?clearTimeout:a}catch{n=a}})();var u,d=[],c=!1,m=-1;function v(){c&&u&&(c=!1,u.length?d=u.concat(d):m=-1,d.length&&g())}function g(){if(!c){var k=i(v);c=!0;for(var y=d.length;y;){for(u=d,d=[];++m<y;)u&&u[m].run();m=-1,y=d.length}u=null,c=!1,function(O){if(n===clearTimeout)return clearTimeout(O);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(O);try{n(O)}catch{try{return n.call(null,O)}catch{return n.call(this,O)}}}(k)}}function b(k,y){this.fun=k,this.array=y}function T(){}o.nextTick=function(k){var y=new Array(arguments.length-1);if(arguments.length>1)for(var O=1;O<arguments.length;O++)y[O-1]=arguments[O];d.push(new b(k,y)),d.length!==1||c||i(g)},b.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=T,o.addListener=T,o.once=T,o.off=T,o.removeListener=T,o.removeAllListeners=T,o.emit=T,o.prependListener=T,o.prependOnceListener=T,o.listeners=function(k){return[]},o.binding=function(k){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(k){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,r,e){var n=e(21),o=e(317),s=Array.prototype;t.exports=function(a){var i=a.indexOf;return a===s||n(s,a)&&i===s.indexOf?o:i}},function(t,r,e){e(318);var n=e(30);t.exports=n("Array").indexOf},function(t,r,e){var n=e(1),o=e(156),s=e(160).indexOf,a=e(94),i=o([].indexOf),u=!!i&&1/i([1],1,-0)<0,d=a("indexOf");n({target:"Array",proto:!0,forced:u||!d},{indexOf:function(c){var m=arguments.length>1?arguments[1]:void 0;return u?i(this,c,m)||0:s(this,c,m)}})},function(t,r,e){var n=e(19),o=e(28),s=e(126),a=e(157),i=e(320),u=e(20),d=TypeError,c=u("toPrimitive");t.exports=function(m,v){if(!o(m)||s(m))return m;var g,b=a(m,c);if(b){if(v===void 0&&(v="default"),g=n(b,m,v),!o(g)||s(g))return g;throw d("Can't convert object to primitive value")}return v===void 0&&(v="number"),i(m,v)}},function(t,r,e){var n=e(19),o=e(16),s=e(28),a=TypeError;t.exports=function(i,u){var d,c;if(u==="string"&&o(d=i.toString)&&!s(c=n(d,i))||o(d=i.valueOf)&&!s(c=n(d,i))||u!=="string"&&o(d=i.toString)&&!s(c=n(d,i)))return c;throw a("Can't convert object to primitive value")}},function(t,r,e){var n=e(14),o=Object.defineProperty;t.exports=function(s,a){try{o(n,s,{value:a,configurable:!0,writable:!0})}catch{n[s]=a}return a}},function(t,r){var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(o){var s=+o;return(s>0?n:e)(s)}},function(t,r,e){var n=e(110),o=Math.min;t.exports=function(s){return s>0?o(n(s),9007199254740991):0}},function(t,r,e){var n=e(325);t.exports=n},function(t,r,e){var n=e(21),o=e(326),s=Array.prototype;t.exports=function(a){var i=a.concat;return a===s||n(s,a)&&i===s.concat?o:i}},function(t,r,e){e(212);var n=e(30);t.exports=n("Array").concat},function(t,r,e){var n=e(79),o=e(129),s=e(28),a=e(20)("species"),i=Array;t.exports=function(u){var d;return n(u)&&(d=u.constructor,(o(d)&&(d===i||n(d.prototype))||s(d)&&(d=d[a])===null)&&(d=void 0)),d===void 0?i:d}},function(t,r,e){e(329);var n=e(12).Object;t.exports=function(o,s){return n.create(o,s)}},function(t,r,e){e(1)({target:"Object",stat:!0,sham:!e(27)},{create:e(80)})},function(t,r,e){t.exports=e(331)},function(t,r,e){var n=e(332);e(359),e(360),e(361),e(362),e(363),e(364),e(365),t.exports=n},function(t,r,e){var n=e(218);e(358),t.exports=n},function(t,r,e){e(212),e(96),e(219),e(340),e(341),e(342),e(343),e(224),e(344),e(345),e(346),e(347),e(348),e(349),e(225),e(350),e(351),e(352),e(353),e(354);var n=e(12);t.exports=n.Symbol},function(t,r,e){var n=e(1),o=e(14),s=e(19),a=e(11),i=e(48),u=e(27),d=e(92),c=e(4),m=e(29),v=e(21),g=e(36),b=e(43),T=e(125),k=e(49),y=e(77),O=e(80),D=e(118),he=e(131),ae=e(165),Ne=e(132),ue=e(90),Y=e(38),_e=e(163),Ce=e(148),ze=e(66),ie=e(109),le=e(130),Ie=e(112),pe=e(127),qe=e(20),$e=e(133),Lt=e(22),Dt=e(221),dr=e(81),pr=e(97),sr=e(84).forEach,hr=le("hidden"),Fe=pr.set,nr=pr.getterFor("Symbol"),ir=Object.prototype,Ue=o.Symbol,rr=Ue&&Ue.prototype,or=o.TypeError,Pt=o.QObject,Et=ue.f,kt=Y.f,er=ae.f,cr=Ce.f,mr=a([].push),vr=ie("symbols"),Tr=ie("op-symbols"),Ir=ie("wks"),kr=!Pt||!Pt.prototype||!Pt.prototype.findChild,Ar=u&&c(function(){return O(kt({},"a",{get:function(){return kt(this,"a",{value:7}).a}})).a!=7})?function(Ur,qr,Gn){var $n=Et(ir,qr);$n&&delete ir[qr],kt(Ur,qr,Gn),$n&&Ur!==ir&&kt(ir,qr,$n)}:kt,Rr=function(Ur,qr){var Gn=vr[Ur]=O(rr);return Fe(Gn,{type:"Symbol",tag:Ur,description:qr}),u||(Gn.description=qr),Gn},Cn=function(Ur,qr,Gn){Ur===ir&&Cn(Tr,qr,Gn),g(Ur);var $n=T(qr);return g(Gn),m(vr,$n)?(Gn.enumerable?(m(Ur,hr)&&Ur[hr][$n]&&(Ur[hr][$n]=!1),Gn=O(Gn,{enumerable:y(0,!1)})):(m(Ur,hr)||kt(Ur,hr,y(1,{})),Ur[hr][$n]=!0),Ar(Ur,$n,Gn)):kt(Ur,$n,Gn)},Or=function(Ur,qr){g(Ur);var Gn=b(qr),$n=D(Gn).concat(hn(Gn));return sr($n,function(Jr){u&&!s(Pr,Gn,Jr)||Cn(Ur,Jr,Gn[Jr])}),Ur},Pr=function(Ur){var qr=T(Ur),Gn=s(cr,this,qr);return!(this===ir&&m(vr,qr)&&!m(Tr,qr))&&(!(Gn||!m(this,qr)||!m(vr,qr)||m(this,hr)&&this[hr][qr])||Gn)},Nr=function(Ur,qr){var Gn=b(Ur),$n=T(qr);if(Gn!==ir||!m(vr,$n)||m(Tr,$n)){var Jr=Et(Gn,$n);return!Jr||!m(vr,$n)||m(Gn,hr)&&Gn[hr][$n]||(Jr.enumerable=!0),Jr}},Qr=function(Ur){var qr=er(b(Ur)),Gn=[];return sr(qr,function($n){m(vr,$n)||m(Ie,$n)||mr(Gn,$n)}),Gn},hn=function(Ur){var qr=Ur===ir,Gn=er(qr?Tr:b(Ur)),$n=[];return sr(Gn,function(Jr){!m(vr,Jr)||qr&&!m(ir,Jr)||mr($n,vr[Jr])}),$n};d||(ze(rr=(Ue=function(){if(v(rr,this))throw or("Symbol is not a constructor");var Ur=arguments.length&&arguments[0]!==void 0?k(arguments[0]):void 0,qr=pe(Ur),Gn=function($n){this===ir&&s(Gn,Tr,$n),m(this,hr)&&m(this[hr],qr)&&(this[hr][qr]=!1),Ar(this,qr,y(1,$n))};return u&&kr&&Ar(ir,qr,{configurable:!0,set:Gn}),Rr(qr,Ur)}).prototype,"toString",function(){return nr(this).tag}),ze(Ue,"withoutSetter",function(Ur){return Rr(pe(Ur),Ur)}),Ce.f=Pr,Y.f=Cn,_e.f=Or,ue.f=Nr,he.f=ae.f=Qr,Ne.f=hn,$e.f=function(Ur){return Rr(qe(Ur),Ur)},u&&(kt(rr,"description",{configurable:!0,get:function(){return nr(this).description}}),i||ze(ir,"propertyIsEnumerable",Pr,{unsafe:!0}))),n({global:!0,constructor:!0,wrap:!0,forced:!d,sham:!d},{Symbol:Ue}),sr(D(Ir),function(Ur){Lt(Ur)}),n({target:"Symbol",stat:!0,forced:!d},{useSetter:function(){kr=!0},useSimple:function(){kr=!1}}),n({target:"Object",stat:!0,forced:!d,sham:!u},{create:function(Ur,qr){return qr===void 0?O(Ur):Or(O(Ur),qr)},defineProperty:Cn,defineProperties:Or,getOwnPropertyDescriptor:Nr}),n({target:"Object",stat:!0,forced:!d},{getOwnPropertyNames:Qr}),Dt(),dr(Ue,"Symbol"),Ie[hr]=!0},function(t,r,e){var n=e(162),o=e(65);t.exports=n?{}.toString:function(){return"[object "+o(this)+"]"}},function(t,r,e){var n=e(14),o=e(16),s=n.WeakMap;t.exports=o(s)&&/native code/.test(String(s))},function(t,r,e){var n=e(1),o=e(33),s=e(29),a=e(49),i=e(109),u=e(222),d=i("string-to-symbol-registry"),c=i("symbol-to-string-registry");n({target:"Symbol",stat:!0,forced:!u},{for:function(m){var v=a(m);if(s(d,v))return d[v];var g=o("Symbol")(v);return d[v]=g,c[g]=v,g}})},function(t,r,e){var n=e(1),o=e(29),s=e(126),a=e(78),i=e(109),u=e(222),d=i("symbol-to-string-registry");n({target:"Symbol",stat:!0,forced:!u},{keyFor:function(c){if(!s(c))throw TypeError(a(c)+" is not a symbol");if(o(d,c))return d[c]}})},function(t,r,e){var n=e(1),o=e(92),s=e(4),a=e(132),i=e(42);n({target:"Object",stat:!0,forced:!o||s(function(){a.f(1)})},{getOwnPropertySymbols:function(u){var d=a.f;return d?d(i(u)):[]}})},function(t,r,e){e(22)("asyncIterator")},function(t,r){},function(t,r,e){e(22)("hasInstance")},function(t,r,e){e(22)("isConcatSpreadable")},function(t,r,e){e(22)("match")},function(t,r,e){e(22)("matchAll")},function(t,r,e){e(22)("replace")},function(t,r,e){e(22)("search")},function(t,r,e){e(22)("species")},function(t,r,e){e(22)("split")},function(t,r,e){var n=e(33),o=e(22),s=e(81);o("toStringTag"),s(n("Symbol"),"Symbol")},function(t,r,e){e(22)("unscopables")},function(t,r,e){var n=e(14);e(81)(n.JSON,"JSON",!0)},function(t,r){},function(t,r){},function(t,r,e){var n=e(227).IteratorPrototype,o=e(80),s=e(77),a=e(81),i=e(99),u=function(){return this};t.exports=function(d,c,m,v){var g=c+" Iterator";return d.prototype=o(n,{next:s(+!v,m)}),a(d,g,!1,!0),i[g]=u,d}},function(t,r,e){var n=e(16),o=String,s=TypeError;t.exports=function(a){if(typeof a=="object"||n(a))return a;throw s("Can't set "+o(a)+" as a prototype")}},function(t,r){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,r,e){e(22)("dispose")},function(t,r,e){e(22)("asyncDispose")},function(t,r,e){e(22)("matcher")},function(t,r,e){e(22)("metadataKey")},function(t,r,e){e(22)("observable")},function(t,r,e){e(22)("metadata")},function(t,r,e){e(22)("patternMatch")},function(t,r,e){e(22)("replaceAll")},function(t,r,e){t.exports=e(367)},function(t,r,e){t.exports=e(368)},function(t,r,e){var n=e(369);t.exports=n},function(t,r,e){var n=e(370);t.exports=n},function(t,r,e){var n=e(371);e(67),t.exports=n},function(t,r,e){e(82),e(96),e(113),e(224);var n=e(133);t.exports=n.f("iterator")},function(t,r,e){var n=e(11),o=e(110),s=e(49),a=e(108),i=n("".charAt),u=n("".charCodeAt),d=n("".slice),c=function(m){return function(v,g){var b,T,k=s(a(v)),y=o(g),O=k.length;return y<0||y>=O?m?"":void 0:(b=u(k,y))<55296||b>56319||y+1===O||(T=u(k,y+1))<56320||T>57343?m?i(k,y):b:m?d(k,y,y+2):T-56320+(b-55296<<10)+65536}};t.exports={codeAt:c(!1),charAt:c(!0)}},function(t,r,e){e(374);var n=e(12);t.exports=n.Array.isArray},function(t,r,e){e(1)({target:"Array",stat:!0},{isArray:e(79)})},function(t,r,e){var n=e(376);t.exports=n},function(t,r,e){e(377);var n=e(30);t.exports=n("Array").forEach},function(t,r,e){var n=e(1),o=e(378);n({target:"Array",proto:!0,forced:[].forEach!=o},{forEach:o})},function(t,r,e){var n=e(84).forEach,o=e(94)("forEach");t.exports=o?[].forEach:function(s){return n(this,s,arguments.length>1?arguments[1]:void 0)}},function(t,r,e){t.exports=e(380)},function(t,r,e){var n=e(381);t.exports=n},function(t,r,e){e(382);var n=e(12).Object;t.exports=function(o){return n.getOwnPropertyNames(o)}},function(t,r,e){var n=e(1),o=e(4),s=e(165).f;n({target:"Object",stat:!0,forced:o(function(){return!Object.getOwnPropertyNames(1)})},{getOwnPropertyNames:s})},function(t,r,e){e(384);var n=e(12);t.exports=n.Object.keys},function(t,r,e){var n=e(1),o=e(42),s=e(118);n({target:"Object",stat:!0,forced:e(4)(function(){s(1)})},{keys:function(a){return s(o(a))}})},function(t,r,e){var n=e(386);t.exports=n},function(t,r,e){e(223);var n=e(12),o=e(76);n.JSON||(n.JSON={stringify:JSON.stringify}),t.exports=function(s,a,i){return o(n.JSON.stringify,null,arguments)}},function(t,r,e){e(232),e(82),e(96),e(394),e(246),e(247),e(407),e(113);var n=e(12);t.exports=n.Promise},function(t,r,e){var n=e(1),o=e(21),s=e(134),a=e(135),i=e(389),u=e(80),d=e(53),c=e(77),m=e(390),v=e(391),g=e(46),b=e(392),T=e(20),k=e(393),y=T("toStringTag"),O=Error,D=[].push,he=function(Ne,ue){var Y,_e=arguments.length>2?arguments[2]:void 0,Ce=o(ae,this);a?Y=a(O(),Ce?s(this):ae):(Y=Ce?this:u(ae),d(Y,y,"Error")),ue!==void 0&&d(Y,"message",b(ue)),k&&d(Y,"stack",m(Y.stack,1)),v(Y,_e);var ze=[];return g(Ne,D,{that:ze}),d(Y,"errors",ze),Y};a?a(he,O):i(he,O,{name:!0});var ae=he.prototype=u(O.prototype,{constructor:c(1,he),message:c(1,""),name:c(1,"AggregateError")});n({global:!0,constructor:!0,arity:2},{AggregateError:he})},function(t,r,e){var n=e(29),o=e(233),s=e(90),a=e(38);t.exports=function(i,u,d){for(var c=o(u),m=a.f,v=s.f,g=0;g<c.length;g++){var b=c[g];n(i,b)||d&&n(d,b)||m(i,b,v(u,b))}}},function(t,r,e){var n=e(11),o=Error,s=n("".replace),a=String(o("zxcasd").stack),i=/\n\s*at [^:]*:[^\n]*/,u=i.test(a);t.exports=function(d,c){if(u&&typeof d=="string"&&!o.prepareStackTrace)for(;c--;)d=s(d,i,"");return d}},function(t,r,e){var n=e(28),o=e(53);t.exports=function(s,a){n(a)&&"cause"in a&&o(s,"cause",a.cause)}},function(t,r,e){var n=e(49);t.exports=function(o,s){return o===void 0?arguments.length<2?"":s:n(o)}},function(t,r,e){var n=e(4),o=e(77);t.exports=!n(function(){var s=Error("a");return!("stack"in s)||(Object.defineProperty(s,"stack",o(1,7)),s.stack!==7)})},function(t,r,e){e(395),e(402),e(403),e(404),e(405),e(406)},function(t,r,e){var n,o,s,a=e(1),i=e(48),u=e(114),d=e(14),c=e(19),m=e(66),v=e(135),g=e(81),b=e(237),T=e(31),k=e(16),y=e(28),O=e(168),D=e(238),he=e(239).set,ae=e(396),Ne=e(399),ue=e(100),Y=e(400),_e=e(97),Ce=e(101),ze=e(115),ie=e(68),le=ze.CONSTRUCTOR,Ie=ze.REJECTION_EVENT,pe=ze.SUBCLASSING,qe=_e.getterFor("Promise"),$e=_e.set,Lt=Ce&&Ce.prototype,Dt=Ce,dr=Lt,pr=d.TypeError,sr=d.document,hr=d.process,Fe=ie.f,nr=Fe,ir=!!(sr&&sr.createEvent&&d.dispatchEvent),Ue=function(Tr){var Ir;return!(!y(Tr)||!k(Ir=Tr.then))&&Ir},rr=function(Tr,Ir){var kr,Ar,Rr,Cn=Ir.value,Or=Ir.state==1,Pr=Or?Tr.ok:Tr.fail,Nr=Tr.resolve,Qr=Tr.reject,hn=Tr.domain;try{Pr?(Or||(Ir.rejection===2&&er(Ir),Ir.rejection=1),Pr===!0?kr=Cn:(hn&&hn.enter(),kr=Pr(Cn),hn&&(hn.exit(),Rr=!0)),kr===Tr.promise?Qr(pr("Promise-chain cycle")):(Ar=Ue(kr))?c(Ar,kr,Nr,Qr):Nr(kr)):Qr(Cn)}catch(Ur){hn&&!Rr&&hn.exit(),Qr(Ur)}},or=function(Tr,Ir){Tr.notified||(Tr.notified=!0,ae(function(){for(var kr,Ar=Tr.reactions;kr=Ar.get();)rr(kr,Tr);Tr.notified=!1,Ir&&!Tr.rejection&&Et(Tr)}))},Pt=function(Tr,Ir,kr){var Ar,Rr;ir?((Ar=sr.createEvent("Event")).promise=Ir,Ar.reason=kr,Ar.initEvent(Tr,!1,!0),d.dispatchEvent(Ar)):Ar={promise:Ir,reason:kr},!Ie&&(Rr=d["on"+Tr])?Rr(Ar):Tr==="unhandledrejection"&&Ne("Unhandled promise rejection",kr)},Et=function(Tr){c(he,d,function(){var Ir,kr=Tr.facade,Ar=Tr.value;if(kt(Tr)&&(Ir=ue(function(){u?hr.emit("unhandledRejection",Ar,kr):Pt("unhandledrejection",kr,Ar)}),Tr.rejection=u||kt(Tr)?2:1,Ir.error))throw Ir.value})},kt=function(Tr){return Tr.rejection!==1&&!Tr.parent},er=function(Tr){c(he,d,function(){var Ir=Tr.facade;u?hr.emit("rejectionHandled",Ir):Pt("rejectionhandled",Ir,Tr.value)})},cr=function(Tr,Ir,kr){return function(Ar){Tr(Ir,Ar,kr)}},mr=function(Tr,Ir,kr){Tr.done||(Tr.done=!0,kr&&(Tr=kr),Tr.value=Ir,Tr.state=2,or(Tr,!0))},vr=function(Tr,Ir,kr){if(!Tr.done){Tr.done=!0,kr&&(Tr=kr);try{if(Tr.facade===Ir)throw pr("Promise can't be resolved itself");var Ar=Ue(Ir);Ar?ae(function(){var Rr={done:!1};try{c(Ar,Ir,cr(vr,Rr,Tr),cr(mr,Rr,Tr))}catch(Cn){mr(Rr,Cn,Tr)}}):(Tr.value=Ir,Tr.state=1,or(Tr,!1))}catch(Rr){mr({done:!1},Rr,Tr)}}};if(le&&(dr=(Dt=function(Tr){O(this,dr),T(Tr),c(n,this);var Ir=qe(this);try{Tr(cr(vr,Ir),cr(mr,Ir))}catch(kr){mr(Ir,kr)}}).prototype,(n=function(Tr){$e(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new Y,rejection:!1,state:0,value:void 0})}).prototype=m(dr,"then",function(Tr,Ir){var kr=qe(this),Ar=Fe(D(this,Dt));return kr.parent=!0,Ar.ok=!k(Tr)||Tr,Ar.fail=k(Ir)&&Ir,Ar.domain=u?hr.domain:void 0,kr.state==0?kr.reactions.add(Ar):ae(function(){rr(Ar,kr)}),Ar.promise}),o=function(){var Tr=new n,Ir=qe(Tr);this.promise=Tr,this.resolve=cr(vr,Ir),this.reject=cr(mr,Ir)},ie.f=Fe=function(Tr){return Tr===Dt||Tr===void 0?new o(Tr):nr(Tr)},!i&&k(Ce)&&Lt!==Object.prototype)){s=Lt.then,pe||m(Lt,"then",function(Tr,Ir){var kr=this;return new Dt(function(Ar,Rr){c(s,kr,Ar,Rr)}).then(Tr,Ir)},{unsafe:!0});try{delete Lt.constructor}catch{}v&&v(Lt,dr)}a({global:!0,constructor:!0,wrap:!0,forced:le},{Promise:Dt}),g(Dt,"Promise",!1,!0),b("Promise")},function(t,r,e){var n,o,s,a,i,u,d,c,m=e(14),v=e(34),g=e(90).f,b=e(239).set,T=e(241),k=e(397),y=e(398),O=e(114),D=m.MutationObserver||m.WebKitMutationObserver,he=m.document,ae=m.process,Ne=m.Promise,ue=g(m,"queueMicrotask"),Y=ue&&ue.value;Y||(n=function(){var _e,Ce;for(O&&(_e=ae.domain)&&_e.exit();o;){Ce=o.fn,o=o.next;try{Ce()}catch(ze){throw o?a():s=void 0,ze}}s=void 0,_e&&_e.enter()},T||O||y||!D||!he?!k&&Ne&&Ne.resolve?((d=Ne.resolve(void 0)).constructor=Ne,c=v(d.then,d),a=function(){c(n)}):O?a=function(){ae.nextTick(n)}:(b=v(b,m),a=function(){b(n)}):(i=!0,u=he.createTextNode(""),new D(n).observe(u,{characterData:!0}),a=function(){u.data=i=!i})),t.exports=Y||function(_e){var Ce={fn:_e,next:void 0};s&&(s.next=Ce),o||(o=Ce,a()),s=Ce}},function(t,r,e){var n=e(64),o=e(14);t.exports=/ipad|iphone|ipod/i.test(n)&&o.Pebble!==void 0},function(t,r,e){var n=e(64);t.exports=/web0s(?!.*chrome)/i.test(n)},function(t,r,e){var n=e(14);t.exports=function(o,s){var a=n.console;a&&a.error&&(arguments.length==1?a.error(o):a.error(o,s))}},function(t,r){var e=function(){this.head=null,this.tail=null};e.prototype={add:function(n){var o={item:n,next:null};this.head?this.tail.next=o:this.head=o,this.tail=o},get:function(){var n=this.head;if(n)return this.head=n.next,this.tail===n&&(this.tail=null),n.item}},t.exports=e},function(t,r,e){var n=e(242),o=e(114);t.exports=!n&&!o&&typeof window=="object"&&typeof document=="object"},function(t,r,e){var n=e(1),o=e(19),s=e(31),a=e(68),i=e(100),u=e(46);n({target:"Promise",stat:!0,forced:e(243)},{all:function(d){var c=this,m=a.f(c),v=m.resolve,g=m.reject,b=i(function(){var T=s(c.resolve),k=[],y=0,O=1;u(d,function(D){var he=y++,ae=!1;O++,o(T,c,D).then(function(Ne){ae||(ae=!0,k[he]=Ne,--O||v(k))},g)}),--O||v(k)});return b.error&&g(b.value),m.promise}})},function(t,r,e){var n=e(1),o=e(48),s=e(115).CONSTRUCTOR,a=e(101),i=e(33),u=e(16),d=e(66),c=a&&a.prototype;if(n({target:"Promise",proto:!0,forced:s,real:!0},{catch:function(v){return this.then(void 0,v)}}),!o&&u(a)){var m=i("Promise").prototype.catch;c.catch!==m&&d(c,"catch",m,{unsafe:!0})}},function(t,r,e){var n=e(1),o=e(19),s=e(31),a=e(68),i=e(100),u=e(46);n({target:"Promise",stat:!0,forced:e(243)},{race:function(d){var c=this,m=a.f(c),v=m.reject,g=i(function(){var b=s(c.resolve);u(d,function(T){o(b,c,T).then(m.resolve,v)})});return g.error&&v(g.value),m.promise}})},function(t,r,e){var n=e(1),o=e(19),s=e(68);n({target:"Promise",stat:!0,forced:e(115).CONSTRUCTOR},{reject:function(a){var i=s.f(this);return o(i.reject,void 0,a),i.promise}})},function(t,r,e){var n=e(1),o=e(33),s=e(48),a=e(101),i=e(115).CONSTRUCTOR,u=e(245),d=o("Promise"),c=s&&!i;n({target:"Promise",stat:!0,forced:s||i},{resolve:function(m){return u(c&&this===d?a:this,m)}})},function(t,r,e){var n=e(1),o=e(48),s=e(101),a=e(4),i=e(33),u=e(16),d=e(238),c=e(245),m=e(66),v=s&&s.prototype;if(n({target:"Promise",proto:!0,real:!0,forced:!!s&&a(function(){v.finally.call({then:function(){}},function(){})})},{finally:function(b){var T=d(this,i("Promise")),k=u(b);return this.then(k?function(y){return c(T,b()).then(function(){return y})}:b,k?function(y){return c(T,b()).then(function(){throw y})}:b)}}),!o&&u(s)){var g=i("Promise").prototype.finally;v.finally!==g&&m(v,"finally",g,{unsafe:!0})}},function(t,r,e){t.exports=e(409)},function(t,r,e){var n=e(410);t.exports=n},function(t,r,e){var n=e(248);t.exports=n},function(t,r,e){e(412);var n=e(12).Object,o=t.exports=function(s,a,i){return n.defineProperty(s,a,i)};n.defineProperty.sham&&(o.sham=!0)},function(t,r,e){var n=e(1),o=e(27),s=e(38).f;n({target:"Object",stat:!0,forced:Object.defineProperty!==s,sham:!o},{defineProperty:s})},function(t,r,e){var n=e(414),o=e(26).default;t.exports=function(s,a){if(o(s)!=="object"||s===null)return s;var i=s[n];if(i!==void 0){var u=i.call(s,a||"default");if(o(u)!=="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(s)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(415)},function(t,r,e){t.exports=e(416)},function(t,r,e){var n=e(417);t.exports=n},function(t,r,e){var n=e(418);t.exports=n},function(t,r,e){var n=e(419);t.exports=n},function(t,r,e){e(420),e(225);var n=e(133);t.exports=n.f("toPrimitive")},function(t,r){},function(t,r,e){var n=e(21),o=e(422),s=Array.prototype;t.exports=function(a){var i=a.slice;return a===s||n(s,a)&&i===s.slice?o:i}},function(t,r,e){e(423);var n=e(30);t.exports=n("Array").slice},function(t,r,e){var n=e(1),o=e(79),s=e(129),a=e(28),i=e(128),u=e(45),d=e(43),c=e(95),m=e(20),v=e(111),g=e(98),b=v("slice"),T=m("species"),k=Array,y=Math.max;n({target:"Array",proto:!0,forced:!b},{slice:function(O,D){var he,ae,Ne,ue=d(this),Y=u(ue),_e=i(O,Y),Ce=i(D===void 0?Y:D,Y);if(o(ue)&&(he=ue.constructor,(s(he)&&(he===k||o(he.prototype))||a(he)&&(he=he[T])===null)&&(he=void 0),he===k||he===void 0))return g(ue,_e,Ce);for(ae=new(he===void 0?k:he)(y(Ce-_e,0)),Ne=0;_e<Ce;_e++,Ne++)_e in ue&&c(ae,Ne,ue[_e]);return ae.length=Ne,ae}})},function(t,r,e){var n=e(425);t.exports=n},function(t,r,e){var n=e(21),o=e(426),s=Array.prototype;t.exports=function(a){var i=a.some;return a===s||n(s,a)&&i===s.some?o:i}},function(t,r,e){e(427);var n=e(30);t.exports=n("Array").some},function(t,r,e){var n=e(1),o=e(84).some;n({target:"Array",proto:!0,forced:!e(94)("some")},{some:function(s){return o(this,s,arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(429);t.exports=n},function(t,r,e){var n=e(21),o=e(430),s=Array.prototype;t.exports=function(a){var i=a.splice;return a===s||n(s,a)&&i===s.splice?o:i}},function(t,r,e){e(431);var n=e(30);t.exports=n("Array").splice},function(t,r,e){var n=e(1),o=e(42),s=e(128),a=e(110),i=e(45),u=e(432),d=e(213),c=e(161),m=e(95),v=e(251),g=e(111)("splice"),b=Math.max,T=Math.min;n({target:"Array",proto:!0,forced:!g},{splice:function(k,y){var O,D,he,ae,Ne,ue,Y=o(this),_e=i(Y),Ce=s(k,_e),ze=arguments.length;for(ze===0?O=D=0:ze===1?(O=0,D=_e-Ce):(O=ze-2,D=T(b(a(y),0),_e-Ce)),d(_e+O-D),he=c(Y,D),ae=0;ae<D;ae++)(Ne=Ce+ae)in Y&&m(he,ae,Y[Ne]);if(he.length=D,O<D){for(ae=Ce;ae<_e-D;ae++)ue=ae+O,(Ne=ae+D)in Y?Y[ue]=Y[Ne]:v(Y,ue);for(ae=_e;ae>_e-D+O;ae--)v(Y,ae-1)}else if(O>D)for(ae=_e-D;ae>Ce;ae--)ue=ae+O-1,(Ne=ae+D-1)in Y?Y[ue]=Y[Ne]:v(Y,ue);for(ae=0;ae<O;ae++)Y[ae+Ce]=arguments[ae+2];return u(Y,_e-D+O),he}})},function(t,r,e){var n=e(27),o=e(79),s=TypeError,a=Object.getOwnPropertyDescriptor,i=n&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(u){return u instanceof TypeError}}();t.exports=i?function(u,d){if(o(u)&&!a(u,"length").writable)throw s("Cannot set read only .length");return u.length=d}:function(u,d){return u.length=d}},function(t,r,e){var n=e(434);t.exports=n},function(t,r,e){var n=e(21),o=e(435),s=Array.prototype;t.exports=function(a){var i=a.sort;return a===s||n(s,a)&&i===s.sort?o:i}},function(t,r,e){e(436);var n=e(30);t.exports=n("Array").sort},function(t,r,e){var n=e(1),o=e(11),s=e(31),a=e(42),i=e(45),u=e(251),d=e(49),c=e(4),m=e(437),v=e(94),g=e(438),b=e(439),T=e(93),k=e(440),y=[],O=o(y.sort),D=o(y.push),he=c(function(){y.sort(void 0)}),ae=c(function(){y.sort(null)}),Ne=v("sort"),ue=!c(function(){if(T)return T<70;if(!(g&&g>3)){if(b)return!0;if(k)return k<603;var Y,_e,Ce,ze,ie="";for(Y=65;Y<76;Y++){switch(_e=String.fromCharCode(Y),Y){case 66:case 69:case 70:case 72:Ce=3;break;case 68:case 71:Ce=4;break;default:Ce=2}for(ze=0;ze<47;ze++)y.push({k:_e+ze,v:Ce})}for(y.sort(function(le,Ie){return Ie.v-le.v}),ze=0;ze<y.length;ze++)_e=y[ze].k.charAt(0),ie.charAt(ie.length-1)!==_e&&(ie+=_e);return ie!=="DGBEFHACIJK"}});n({target:"Array",proto:!0,forced:he||!ae||!Ne||!ue},{sort:function(Y){Y!==void 0&&s(Y);var _e=a(this);if(ue)return Y===void 0?O(_e):O(_e,Y);var Ce,ze,ie=[],le=i(_e);for(ze=0;ze<le;ze++)ze in _e&&D(ie,_e[ze]);for(m(ie,function(Ie){return function(pe,qe){return qe===void 0?-1:pe===void 0?1:Ie!==void 0?+Ie(pe,qe)||0:d(pe)>d(qe)?1:-1}}(Y)),Ce=i(ie),ze=0;ze<Ce;)_e[ze]=ie[ze++];for(;ze<le;)u(_e,ze++);return _e}})},function(t,r,e){var n=e(220),o=Math.floor,s=function(u,d){var c=u.length,m=o(c/2);return c<8?a(u,d):i(u,s(n(u,0,m),d),s(n(u,m),d),d)},a=function(u,d){for(var c,m,v=u.length,g=1;g<v;){for(m=g,c=u[g];m&&d(u[m-1],c)>0;)u[m]=u[--m];m!==g++&&(u[m]=c)}return u},i=function(u,d,c,m){for(var v=d.length,g=c.length,b=0,T=0;b<v||T<g;)u[b+T]=b<v&&T<g?m(d[b],c[T])<=0?d[b++]:c[T++]:b<v?d[b++]:c[T++];return u};t.exports=s},function(t,r,e){var n=e(64).match(/firefox\/(\d+)/i);t.exports=!!n&&+n[1]},function(t,r,e){var n=e(64);t.exports=/MSIE|Trident/.test(n)},function(t,r,e){var n=e(64).match(/AppleWebKit\/(\d+)\./);t.exports=!!n&&+n[1]},function(t,r,e){var n=e(442);t.exports=n},function(t,r,e){var n=e(21),o=e(443),s=Array.prototype;t.exports=function(a){var i=a.map;return a===s||n(s,a)&&i===s.map?o:i}},function(t,r,e){e(444);var n=e(30);t.exports=n("Array").map},function(t,r,e){var n=e(1),o=e(84).map;n({target:"Array",proto:!0,forced:!e(111)("map")},{map:function(s){return o(this,s,arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(446);t.exports=n},function(t,r,e){var n=e(21),o=e(447),s=Array.prototype;t.exports=function(a){var i=a.reduce;return a===s||n(s,a)&&i===s.reduce?o:i}},function(t,r,e){e(448);var n=e(30);t.exports=n("Array").reduce},function(t,r,e){var n=e(1),o=e(449).left,s=e(94),a=e(93),i=e(114);n({target:"Array",proto:!0,forced:!s("reduce")||!i&&a>79&&a<83},{reduce:function(u){var d=arguments.length;return o(this,u,d,d>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(31),o=e(42),s=e(124),a=e(45),i=TypeError,u=function(d){return function(c,m,v,g){n(m);var b=o(c),T=s(b),k=a(b),y=d?k-1:0,O=d?-1:1;if(v<2)for(;;){if(y in T){g=T[y],y+=O;break}if(y+=O,d?y<0:k<=y)throw i("Reduce of empty array with no initial value")}for(;d?y>=0:k>y;y+=O)y in T&&(g=m(g,T[y],y,b));return g}};t.exports={left:u(!1),right:u(!0)}},function(t,r,e){var n=e(451);t.exports=n},function(t,r,e){var n=e(21),o=e(452),s=Array.prototype;t.exports=function(a){var i=a.lastIndexOf;return a===s||n(s,a)&&i===s.lastIndexOf?o:i}},function(t,r,e){e(453);var n=e(30);t.exports=n("Array").lastIndexOf},function(t,r,e){var n=e(1),o=e(454);n({target:"Array",proto:!0,forced:o!==[].lastIndexOf},{lastIndexOf:o})},function(t,r,e){var n=e(76),o=e(43),s=e(110),a=e(45),i=e(94),u=Math.min,d=[].lastIndexOf,c=!!d&&1/[1].lastIndexOf(1,-0)<0,m=i("lastIndexOf"),v=c||!m;t.exports=v?function(g){if(c)return n(d,this,arguments)||0;var b=o(this),T=a(b),k=T-1;for(arguments.length>1&&(k=u(k,s(arguments[1]))),k<0&&(k=T+k);k>=0;k--)if(k in b&&b[k]===g)return k||0;return-1}:d},function(t,r,e){e(252);var n=e(12);t.exports=n.setTimeout},function(t,r,e){var n=e(1),o=e(14),s=e(253)(o.setInterval,!0);n({global:!0,bind:!0,forced:o.setInterval!==s},{setInterval:s})},function(t,r){t.exports=typeof Bun=="function"&&Bun&&typeof Bun.version=="string"},function(t,r,e){var n=e(1),o=e(14),s=e(253)(o.setTimeout,!0);n({global:!0,bind:!0,forced:o.setTimeout!==s},{setTimeout:s})},function(t,r,e){var n=e(460);t.exports=n},function(t,r,e){var n=e(21),o=e(461),s=Array.prototype;t.exports=function(a){var i=a.filter;return a===s||n(s,a)&&i===s.filter?o:i}},function(t,r,e){e(462);var n=e(30);t.exports=n("Array").filter},function(t,r,e){var n=e(1),o=e(84).filter;n({target:"Array",proto:!0,forced:!e(111)("filter")},{filter:function(s){return o(this,s,arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){t.exports=e(464)},function(t,r,e){e(67);var n=e(65),o=e(29),s=e(21),a=e(465),i=Array.prototype,u={DOMTokenList:!0,NodeList:!0};t.exports=function(d){var c=d.values;return d===i||s(i,d)&&c===i.values||o(u,n(d))?a:c}},function(t,r,e){var n=e(466);t.exports=n},function(t,r,e){e(82),e(96);var n=e(30);t.exports=n("Array").values},function(t,r,e){e(113),e(468);var n=e(12);t.exports=n.Array.from},function(t,r,e){var n=e(1),o=e(469);n({target:"Array",stat:!0,forced:!e(244)(function(s){Array.from(s)})},{from:o})},function(t,r,e){var n=e(34),o=e(19),s=e(42),a=e(470),i=e(234),u=e(129),d=e(45),c=e(95),m=e(235),v=e(136),g=Array;t.exports=function(b){var T=s(b),k=u(this),y=arguments.length,O=y>1?arguments[1]:void 0,D=O!==void 0;D&&(O=n(O,y>2?arguments[2]:void 0));var he,ae,Ne,ue,Y,_e,Ce=v(T),ze=0;if(!Ce||this===g&&i(Ce))for(he=d(T),ae=k?new this(he):g(he);he>ze;ze++)_e=D?O(T[ze],ze):T[ze],c(ae,ze,_e);else for(Y=(ue=m(T,Ce)).next,ae=k?new this:[];!(Ne=o(Y,ue)).done;ze++)_e=D?a(ue,O,[Ne.value,ze],!0):Ne.value,c(ae,ze,_e);return ae.length=ze,ae}},function(t,r,e){var n=e(36),o=e(236);t.exports=function(s,a,i,u){try{return u?a(n(i)[0],i[1]):a(i)}catch(d){o(s,"throw",d)}}},function(t,r,e){t.exports=e(472)},function(t,r,e){var n=e(473);t.exports=n},function(t,r,e){var n=e(474);t.exports=n},function(t,r,e){var n=e(475);e(67),t.exports=n},function(t,r,e){e(82),e(113);var n=e(136);t.exports=n},function(t,r,e){e(219);var n=e(12);t.exports=n.Object.getOwnPropertySymbols},function(t,r,e){var n=e(478);t.exports=n},function(t,r,e){e(479);var n=e(12).Object,o=t.exports=function(s,a){return n.getOwnPropertyDescriptor(s,a)};n.getOwnPropertyDescriptor.sham&&(o.sham=!0)},function(t,r,e){var n=e(1),o=e(4),s=e(43),a=e(90).f,i=e(27),u=o(function(){a(1)});n({target:"Object",stat:!0,forced:!i||u,sham:!i},{getOwnPropertyDescriptor:function(d,c){return a(s(d),c)}})},function(t,r,e){var n=e(481);t.exports=n},function(t,r,e){e(482);var n=e(12);t.exports=n.Object.getOwnPropertyDescriptors},function(t,r,e){var n=e(1),o=e(27),s=e(233),a=e(43),i=e(90),u=e(95);n({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(d){for(var c,m,v=a(d),g=i.f,b=s(v),T={},k=0;b.length>k;)(m=g(v,c=b[k++]))!==void 0&&u(T,c,m);return T}})},function(t,r,e){var n=e(484);t.exports=n},function(t,r,e){e(485);var n=e(12).Object,o=t.exports=function(s,a){return n.defineProperties(s,a)};n.defineProperties.sham&&(o.sham=!0)},function(t,r,e){var n=e(1),o=e(27),s=e(163).f;n({target:"Object",stat:!0,forced:Object.defineProperties!==s,sham:!o},{defineProperties:s})},function(t,r,e){var n=e(13);typeof window<"u"&&(window.console||n.isWeixinApp||(window.console={log:function(){},info:function(){},warn:function(){},error:function(){}}))},function(t,r,e){var n=e(488),o=e(517),s=e(260),a=e(519),i=e(528),u=e(531),d=e(532),c=e(533),m=e(535),v=e(536),g=e(537),b=e(181),T=e(541),k=e(542),y=e(548),O=e(175),D=e(263),he=e(550),ae=e(88),Ne=e(552),ue=e(174),Y=e(179),_e={};_e["[object Arguments]"]=_e["[object Array]"]=_e["[object ArrayBuffer]"]=_e["[object DataView]"]=_e["[object Boolean]"]=_e["[object Date]"]=_e["[object Float32Array]"]=_e["[object Float64Array]"]=_e["[object Int8Array]"]=_e["[object Int16Array]"]=_e["[object Int32Array]"]=_e["[object Map]"]=_e["[object Number]"]=_e["[object Object]"]=_e["[object RegExp]"]=_e["[object Set]"]=_e["[object String]"]=_e["[object Symbol]"]=_e["[object Uint8Array]"]=_e["[object Uint8ClampedArray]"]=_e["[object Uint16Array]"]=_e["[object Uint32Array]"]=!0,_e["[object Error]"]=_e["[object Function]"]=_e["[object WeakMap]"]=!1,t.exports=function Ce(ze,ie,le,Ie,pe,qe){var $e,Lt=1&ie,Dt=2&ie,dr=4&ie;if(le&&($e=pe?le(ze,Ie,pe,qe):le(ze)),$e!==void 0)return $e;if(!ae(ze))return ze;var pr=O(ze);if(pr){if($e=T(ze),!Lt)return d(ze,$e)}else{var sr=b(ze),hr=sr=="[object Function]"||sr=="[object GeneratorFunction]";if(D(ze))return u(ze,Lt);if(sr=="[object Object]"||sr=="[object Arguments]"||hr&&!pe){if($e=Dt||hr?{}:y(ze),!Lt)return Dt?m(ze,i($e,ze)):c(ze,a($e,ze))}else{if(!_e[sr])return pe?ze:{};$e=k(ze,sr,Lt)}}qe||(qe=new n);var Fe=qe.get(ze);if(Fe)return Fe;qe.set(ze,$e),Ne(ze)?ze.forEach(function(ir){$e.add(Ce(ir,ie,le,ir,ze,qe))}):he(ze)&&ze.forEach(function(ir,Ue){$e.set(Ue,Ce(ir,ie,le,Ue,ze,qe))});var nr=pr?void 0:(dr?Dt?g:v:Dt?Y:ue)(ze);return o(nr||ze,function(ir,Ue){nr&&(ir=ze[Ue=ir]),s($e,Ue,Ce(ir,ie,le,Ue,ze,qe))}),$e}},function(t,r,e){var n=e(140),o=e(494),s=e(495),a=e(496),i=e(497),u=e(498);function d(c){var m=this.__data__=new n(c);this.size=m.size}d.prototype.clear=o,d.prototype.delete=s,d.prototype.get=a,d.prototype.has=i,d.prototype.set=u,t.exports=d},function(t,r){t.exports=function(){this.__data__=[],this.size=0}},function(t,r,e){var n=e(141),o=Array.prototype.splice;t.exports=function(s){var a=this.__data__,i=n(a,s);return!(i<0)&&(i==a.length-1?a.pop():o.call(a,i,1),--this.size,!0)}},function(t,r,e){var n=e(141);t.exports=function(o){var s=this.__data__,a=n(s,o);return a<0?void 0:s[a][1]}},function(t,r,e){var n=e(141);t.exports=function(o){return n(this.__data__,o)>-1}},function(t,r,e){var n=e(141);t.exports=function(o,s){var a=this.__data__,i=n(a,o);return i<0?(++this.size,a.push([o,s])):a[i][1]=s,this}},function(t,r,e){var n=e(140);t.exports=function(){this.__data__=new n,this.size=0}},function(t,r){t.exports=function(e){var n=this.__data__,o=n.delete(e);return this.size=n.size,o}},function(t,r){t.exports=function(e){return this.__data__.get(e)}},function(t,r){t.exports=function(e){return this.__data__.has(e)}},function(t,r,e){var n=e(140),o=e(172),s=e(259);t.exports=function(a,i){var u=this.__data__;if(u instanceof n){var d=u.__data__;if(!o||d.length<199)return d.push([a,i]),this.size=++u.size,this;u=this.__data__=new s(d)}return u.set(a,i),this.size=u.size,this}},function(t,r,e){var n=e(256),o=e(502),s=e(88),a=e(258),i=/^\[object .+?Constructor\]$/,u=Function.prototype,d=Object.prototype,c=u.toString,m=d.hasOwnProperty,v=RegExp("^"+c.call(m).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(g){return!(!s(g)||o(g))&&(n(g)?v:i).test(a(g))}},function(t,r,e){var n=e(173),o=Object.prototype,s=o.hasOwnProperty,a=o.toString,i=n?n.toStringTag:void 0;t.exports=function(u){var d=s.call(u,i),c=u[i];try{u[i]=void 0;var m=!0}catch{}var v=a.call(u);return m&&(d?u[i]=c:delete u[i]),v}},function(t,r){var e=Object.prototype.toString;t.exports=function(n){return e.call(n)}},function(t,r,e){var n,o=e(503),s=(n=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function(a){return!!s&&s in a}},function(t,r,e){var n=e(50)["__core-js_shared__"];t.exports=n},function(t,r){t.exports=function(e,n){return e==null?void 0:e[n]}},function(t,r,e){var n=e(506),o=e(140),s=e(172);t.exports=function(){this.size=0,this.__data__={hash:new n,map:new(s||o),string:new n}}},function(t,r,e){var n=e(507),o=e(508),s=e(509),a=e(510),i=e(511);function u(d){var c=-1,m=d==null?0:d.length;for(this.clear();++c<m;){var v=d[c];this.set(v[0],v[1])}}u.prototype.clear=n,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=a,u.prototype.set=i,t.exports=u},function(t,r,e){var n=e(142);t.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(t,r){t.exports=function(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}},function(t,r,e){var n=e(142),o=Object.prototype.hasOwnProperty;t.exports=function(s){var a=this.__data__;if(n){var i=a[s];return i==="__lodash_hash_undefined__"?void 0:i}return o.call(a,s)?a[s]:void 0}},function(t,r,e){var n=e(142),o=Object.prototype.hasOwnProperty;t.exports=function(s){var a=this.__data__;return n?a[s]!==void 0:o.call(a,s)}},function(t,r,e){var n=e(142);t.exports=function(o,s){var a=this.__data__;return this.size+=this.has(o)?0:1,a[o]=n&&s===void 0?"__lodash_hash_undefined__":s,this}},function(t,r,e){var n=e(143);t.exports=function(o){var s=n(this,o).delete(o);return this.size-=s?1:0,s}},function(t,r){t.exports=function(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}},function(t,r,e){var n=e(143);t.exports=function(o){return n(this,o).get(o)}},function(t,r,e){var n=e(143);t.exports=function(o){return n(this,o).has(o)}},function(t,r,e){var n=e(143);t.exports=function(o,s){var a=n(this,o),i=a.size;return a.set(o,s),this.size+=a.size==i?0:1,this}},function(t,r){t.exports=function(e,n){for(var o=-1,s=e==null?0:e.length;++o<s&&n(e[o],o,e)!==!1;);return e}},function(t,r,e){var n=e(83),o=function(){try{var s=n(Object,"defineProperty");return s({},"",{}),s}catch{}}();t.exports=o},function(t,r,e){var n=e(144),o=e(174);t.exports=function(s,a){return s&&n(a,o(a),s)}},function(t,r){t.exports=function(e,n){for(var o=-1,s=Array(e);++o<e;)s[o]=n(o);return s}},function(t,r,e){var n=e(522),o=e(104),s=Object.prototype,a=s.hasOwnProperty,i=s.propertyIsEnumerable,u=n(function(){return arguments}())?n:function(d){return o(d)&&a.call(d,"callee")&&!i.call(d,"callee")};t.exports=u},function(t,r,e){var n=e(119),o=e(104);t.exports=function(s){return o(s)&&n(s)=="[object Arguments]"}},function(t,r){t.exports=function(){return!1}},function(t,r,e){var n=e(525),o=e(176),s=e(177),a=s&&s.isTypedArray,i=a?o(a):n;t.exports=i},function(t,r,e){var n=e(119),o=e(264),s=e(104),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(i){return s(i)&&o(i.length)&&!!a[n(i)]}},function(t,r,e){var n=e(178),o=e(527),s=Object.prototype.hasOwnProperty;t.exports=function(a){if(!n(a))return o(a);var i=[];for(var u in Object(a))s.call(a,u)&&u!="constructor"&&i.push(u);return i}},function(t,r,e){var n=e(265)(Object.keys,Object);t.exports=n},function(t,r,e){var n=e(144),o=e(179);t.exports=function(s,a){return s&&n(a,o(a),s)}},function(t,r,e){var n=e(88),o=e(178),s=e(530),a=Object.prototype.hasOwnProperty;t.exports=function(i){if(!n(i))return s(i);var u=o(i),d=[];for(var c in i)(c!="constructor"||!u&&a.call(i,c))&&d.push(c);return d}},function(t,r){t.exports=function(e){var n=[];if(e!=null)for(var o in Object(e))n.push(o);return n}},function(t,r,e){(function(n){var o=e(50),s=r&&!r.nodeType&&r,a=s&&typeof n=="object"&&n&&!n.nodeType&&n,i=a&&a.exports===s?o.Buffer:void 0,u=i?i.allocUnsafe:void 0;n.exports=function(d,c){if(c)return d.slice();var m=d.length,v=u?u(m):new d.constructor(m);return d.copy(v),v}}).call(this,e(145)(t))},function(t,r){t.exports=function(e,n){var o=-1,s=e.length;for(n||(n=Array(s));++o<s;)n[o]=e[o];return n}},function(t,r,e){var n=e(144),o=e(180);t.exports=function(s,a){return n(s,o(s),a)}},function(t,r){t.exports=function(e,n){for(var o=-1,s=e==null?0:e.length,a=0,i=[];++o<s;){var u=e[o];n(u,o,e)&&(i[a++]=u)}return i}},function(t,r,e){var n=e(144),o=e(267);t.exports=function(s,a){return n(s,o(s),a)}},function(t,r,e){var n=e(270),o=e(180),s=e(174);t.exports=function(a){return n(a,s,o)}},function(t,r,e){var n=e(270),o=e(267),s=e(179);t.exports=function(a){return n(a,s,o)}},function(t,r,e){var n=e(83)(e(50),"DataView");t.exports=n},function(t,r,e){var n=e(83)(e(50),"Promise");t.exports=n},function(t,r,e){var n=e(83)(e(50),"WeakMap");t.exports=n},function(t,r){var e=Object.prototype.hasOwnProperty;t.exports=function(n){var o=n.length,s=new n.constructor(o);return o&&typeof n[0]=="string"&&e.call(n,"index")&&(s.index=n.index,s.input=n.input),s}},function(t,r,e){var n=e(182),o=e(544),s=e(545),a=e(546),i=e(547);t.exports=function(u,d,c){var m=u.constructor;switch(d){case"[object ArrayBuffer]":return n(u);case"[object Boolean]":case"[object Date]":return new m(+u);case"[object DataView]":return o(u,c);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return i(u,c);case"[object Map]":return new m;case"[object Number]":case"[object String]":return new m(u);case"[object RegExp]":return s(u);case"[object Set]":return new m;case"[object Symbol]":return a(u)}}},function(t,r,e){var n=e(50).Uint8Array;t.exports=n},function(t,r,e){var n=e(182);t.exports=function(o,s){var a=s?n(o.buffer):o.buffer;return new o.constructor(a,o.byteOffset,o.byteLength)}},function(t,r){var e=/\w*$/;t.exports=function(n){var o=new n.constructor(n.source,e.exec(n));return o.lastIndex=n.lastIndex,o}},function(t,r,e){var n=e(173),o=n?n.prototype:void 0,s=o?o.valueOf:void 0;t.exports=function(a){return s?Object(s.call(a)):{}}},function(t,r,e){var n=e(182);t.exports=function(o,s){var a=s?n(o.buffer):o.buffer;return new o.constructor(a,o.byteOffset,o.length)}},function(t,r,e){var n=e(549),o=e(269),s=e(178);t.exports=function(a){return typeof a.constructor!="function"||s(a)?{}:n(o(a))}},function(t,r,e){var n=e(88),o=Object.create,s=function(){function a(){}return function(i){if(!n(i))return{};if(o)return o(i);a.prototype=i;var u=new a;return a.prototype=void 0,u}}();t.exports=s},function(t,r,e){var n=e(551),o=e(176),s=e(177),a=s&&s.isMap,i=a?o(a):n;t.exports=i},function(t,r,e){var n=e(181),o=e(104);t.exports=function(s){return o(s)&&n(s)=="[object Map]"}},function(t,r,e){var n=e(553),o=e(176),s=e(177),a=s&&s.isSet,i=a?o(a):n;t.exports=i},function(t,r,e){var n=e(181),o=e(104);t.exports=function(s){return o(s)&&n(s)=="[object Set]"}},function(t,r,e){var n=e(2),o=e(5),s=e(6),a=e(69),i=e(10),u=e(15),d=e(7),c=e(3),m=e(74),v=e(0),g=e(13),b=e(44),T={};function k(){var Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};!Ne.logLevel&&Ne.debug&&(Ne.logLevel="debug"),v.merge(this,{options:Ne,debugEnable:!1,api:"log",style:"color:blue;",logLevel:Ne.logLevel&&Ne.logLevel.toLowerCase()||"off",debug:v.emptyFunc,log:v.emptyFunc,info:v.emptyFunc,warn:v.emptyFunc,error:v.emptyFunc}),this.prefix=Ne.prefix||"",this.localEnable=T.enable&&Ne.dbLog&&Ne.account,this.setDebug(Ne.debug),this.localEnable&&(this._local=new T(Ne.account,Ne.expire),this._local.logError=this.error)}T=e(563);var y=k.prototype,O=["Chrome","Safari","Firefox"],D={debug:1e3,log:2e3,info:3e3,warn:4e3,error:5e3,off:6e3};function he(Ne){var ue,Y=[];return n(ue=o(D)).call(ue,function(_e){D[_e]>=D[Ne]&&Y.push(_e)}),Y}y.setDebug=function(){var Ne=arguments.length>0&&arguments[0]!==void 0&&arguments[0],ue=this;if(ue.debugEnable=Ne||ue.logLevel==="debug",Ne.style&&(ue.style=Ne.style),v.exist(console)){if(ue.logLevel!=="off"){var Y=console,_e=he(ue.logLevel);n(_e).call(_e,function(ze){ue[ze]=function(){var ie=ue.formatArgsAndSave(arguments,ze);s(O).call(O,m.name)!==-1&&v.isString(ie[0])&&(ie[0]="%c"+ie[0],a(ie).call(ie,1,0,ue.style)),ue._log(ze,ie)}}),ue.options.logFunc?ue._log=function(){}:ue._log=function(ze,ie){if(ze==="debug"&&(ze="log"),Y[ze])try{Y[ze].apply?ue.chrome(ze,ie):ue.ie(ze,ie)}catch{}},ue.chrome=function(ze,ie){s(O).call(O,m.name)!==-1?Y[ze].apply(Y,ie):ue.ie(ze,ie)},ue.ie=function(ze,ie){n(ie).call(ie,function(le){Y[ze](i(le,null,4))})}}else if(g.isRN||this.localEnable||this.options.logFunc){var Ce=!g.isRN&&!this.localEnable;ue.log=function(){ue.formatArgsAndSave(arguments,"log",Ce)},ue.info=function(){ue.formatArgsAndSave(arguments,"info",Ce)},ue.warn=function(){ue.formatArgsAndSave(arguments,"warn",Ce)},ue.error=function(){ue.formatArgsAndSave(arguments,"error",Ce)},ue.debug=function(){ue.formatArgsAndSave(arguments,"error",Ce)}}}},y.destroy=function(){this.localEnable=!1,this.log=function(){},this.info=function(){},this.warn=function(){},this.error=function(){},this.debug=function(){},this._local&&this._local.destroy()},y.formatArgsAndSave=function(Ne,ue,Y){var _e,Ce;Ne=u([]).call(Ne,0);var ze=new Date,ie=ae(ze.getMonth()+1)+"-"+ae(ze.getDate())+" "+ae(ze.getHours())+":"+ae(ze.getMinutes())+":"+ae(ze.getSeconds())+":"+ae(ze.getMilliseconds(),3),le=d(_e=d(Ce="[NIM ".concat(ue.toUpperCase()," ")).call(Ce,ie," ")).call(_e,this.prefix.toUpperCase(),"]  "),Ie="";v.isString(Ne[0])?Ne[0]=le+Ne[0]:a(Ne).call(Ne,0,0,le),n(Ne).call(Ne,function(qe,$e){v.isArray(qe)||v.isObject(qe)?(Ne[$e]=v.simpleClone(qe),Ie+=i(Ne[$e])+" "):Ie+=qe+" "});var pe=this.options.logFunc;return pe&&v.isFunction(pe[ue])&&pe[ue].apply(pe,Ne),!Y&&this.writeLocalLog(Ie,ue,+ze),Ne},y.writeLocalLog=function(Ne,ue,Y){return g.isRN?this.writeLocalLogRN(Ne,ue,Y):g.isBrowser?this.writeLocalLogBrowser(Ne,ue,Y):void 0};var ae=function(Ne,ue){ue=ue||2;for(var Y=""+Ne;Y.length<ue;)Y="0"+Y;return Y};y.writeLocalLogBrowser=function(Ne,ue,Y){this._local&&this._local.saveLog({log:Ne,level:ue,time:Y})},y.writeLocalLogRN=function(Ne,ue){if(b.rnfs&&b.rnfs.writeFile&&b.rnfs.appendFile&&b.rnfs.DocumentDirectoryPath&&/error|warn|info/.test(ue)){var Y,_e=b.rnfs,Ce=_e.size/2-256;Ne+=`\r
`,_e.nimPromise=_e.nimPromise.then(function(){return Y=ze(_e.nimIndex),_e.exists(Y)}).then(function(ie){return ie?_e.appendFile(Y,Ne):_e.writeFile(Y,Ne)}).then(function(){return _e.stat(Y)}).then(function(ie){if(ie.size>Ce)return _e.nimIndex++,_e.nimIndex>1&&(_e.nimIndex=_e.nimIndex%2),_e.unlink(ze(_e.nimIndex)).catch(function(){return c.resolve()})}).catch(function(){})}function ze(ie){return b.rnfs.DocumentDirectoryPath+"/nimlog_"+ie+".log"}},t.exports=k},function(t,r,e){var n=e(556);t.exports=n},function(t,r,e){e(557);var n=e(12);t.exports=n.parseFloat},function(t,r,e){var n=e(1),o=e(558);n({global:!0,forced:parseFloat!=o},{parseFloat:o})},function(t,r,e){var n=e(14),o=e(4),s=e(11),a=e(49),i=e(183).trim,u=e(146),d=s("".charAt),c=n.parseFloat,m=n.Symbol,v=m&&m.iterator,g=1/c(u+"-0")!=-1/0||v&&!o(function(){c(Object(v))});t.exports=g?function(b){var T=i(a(b)),k=c(T);return k===0&&d(T,0)=="-"?-0:k}:c},function(t,r,e){var n=e(560);t.exports=n},function(t,r,e){e(561);var n=e(12);t.exports=n.parseInt},function(t,r,e){var n=e(1),o=e(562);n({global:!0,forced:parseInt!=o},{parseInt:o})},function(t,r,e){var n=e(14),o=e(4),s=e(11),a=e(49),i=e(183).trim,u=e(146),d=n.parseInt,c=n.Symbol,m=c&&c.iterator,v=/^[+-]?0x/i,g=s(v.exec),b=d(u+"08")!==8||d(u+"0x16")!==22||m&&!o(function(){d(Object(m))});t.exports=b?function(T,k){var y=i(a(T));return d(y,k>>>0||(g(v,y)?16:10))}:d},function(t,r,e){var n=e(15),o=e(23),s=e(3),a=e(564),i=e(565),u=e(0).getGlobal(),d=e(74).name,c=typeof a=="function",m=u.indexedDB&&!/^(IE)$/.test(d);function v(b,T){this.logWorker=null,this.db=null,this.logQueue=[],this.callbackList=[],this.preTime=null,this.lastTime=+new Date,this.saveLogTimer=void 0,this.initLogLocal({name:b,expire:T})}var g=v.prototype;v.enable=!0,g.saveLog=function(b){var T=this;try{if(!v.enable)return;var k,y=this.logQueue.length,O=this.logQueue[y-1];if(b.time===this.preTime&&O)return void(O.log+=`\r
`+b.log);this.logQueue.length>50||b.time-this.lastTime>3e3&&this.logQueue.length>0?(this.doSaveLog(n(k=this.logQueue).call(k,0)),this.lastTime=O.time,this.logQueue=[],clearTimeout(this.saveLogTimer)):(clearTimeout(this.saveLogTimer),this.saveLogTimer=o(function(){var D;T.logQueue.length>0&&(O=T.logQueue[T.logQueue.length-1],T.doSaveLog(n(D=T.logQueue).call(D,0)),T.lastTime=O.time,T.logQueue=[])},3e3-(b.time-this.lastTime))),this.logQueue.push(b),this.preTime=b.time}catch(D){console.error("saveLog Error",D)}},g.destroy=function(){if(this.logQueue.length>0){var b,T=this.logQueue[this.logQueue.length-1];this.doSaveLog(n(b=this.logQueue).call(b,0)),this.lastTime=T.time,this.logQueue=[]}clearTimeout(this.saveLogTimer)},g.doSaveLog=function(){},g.initLogLocal=function(){},g.fetchLog=function(){},g.deleteLogs=function(){},g.logError=function(){},m?c?(g.doSaveLog=function(b){this.logWorker.postMessage(b)},g.initLogLocal=function(b){var T=this;this.logWorker=new a({}),this.logWorker.onmessage=function(k){var y=k.data||{};switch(y.type){case"fetchDone":T.fetchLogDone(y.code,y.msg);break;case"error":T.logError(y.msg)}},this.logWorker.postMessage({type:"init",msg:b})},g.fetchLog=function(){var b=this;return new s(function(T,k){b.callbackList.length===0&&b.logWorker.postMessage({type:"fetch"}),b.callbackList.push(T),b.callbackList.push(k)})},g.fetchLogDone=function(b,T){for(var k=b===200?0:1,y=0;y<this.callbackList.length/2;y++)this.callbackList[2*y+k](T);this.callbackList=[]},g.deleteLogs=function(b){return this.logWorker.postMessage({type:"delete",msg:b}),s.resolve()}):(g.doSaveLog=function(b){var T=this;this.db.putLog(b).catch(function(k){T.logError({msg:"putLog error",error:k})})},g.initLogLocal=function(b){var T=this;this.db=new i(b),this.db.init().catch(function(k){T.logError({msg:"dbLog init error",error:k})})},g.fetchLog=function(){return this.db.getAllLogs()},g.deleteLogs=function(b){return this.db.deleteLogs(b)}):v.enable=!1,t.exports=v},function(t,r,e){e.r(r),e.d(r,"default",function(){return s});var n=e(297),o=e.n(n);function s(){return o()(`/*!
 * 
 * VERSION: 9.13.0
 * Git Hash: b7e3ed4d45a88d8c78898efb66610b01c72f8323
 * 
 * Create At: 2023/9/5 6:28:51
 * 
 * Target: NIM_Web_log.worker
 */!function(t){var n={};function r(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)r.d(e,o,function(n){return t[n]}.bind(null,o));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=109)}([function(t,n,r){"use strict";var e=r(1),o=r(41),i=r(78),c=r(2),u=r(43).f,a=r(84),f=r(13),s=r(34),p=r(19),l=r(8),v=function(t){var n=function(r,e,i){if(this instanceof n){switch(arguments.length){case 0:return new t;case 1:return new t(r);case 2:return new t(r,e)}return new t(r,e,i)}return o(t,this,arguments)};return n.prototype=t.prototype,n};t.exports=function(t,n){var r,o,d,y,h,m,g,x,b,w=t.target,S=t.global,j=t.stat,O=t.proto,P=S?e:j?e[w]:(e[w]||{}).prototype,T=S?f:f[w]||p(f,w,{})[w],A=T.prototype;for(y in n)o=!(r=a(S?y:w+(j?".":"#")+y,t.forced))&&P&&l(P,y),m=T[y],o&&(g=t.dontCallGetSet?(b=u(P,y))&&b.value:P[y]),h=o&&g?g:n[y],o&&typeof m==typeof h||(x=t.bind&&o?s(h,e):t.wrap&&o?v(h):O&&c(h)?i(h):h,(t.sham||h&&h.sham||m&&m.sham)&&p(x,"sham",!0),p(T,y,x),O&&(l(f,d=w+"Prototype")||p(f,d,{}),p(f[d],y,h),t.real&&A&&(r||!A[y])&&p(A,y,h)))}},function(t,n,r){(function(n){var r=function(t){return t&&t.Math==Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n&&n)||function(){return this}()||Function("return this")()}).call(this,r(77))},function(t,n,r){var e=r(79),o=e.all;t.exports=e.IS_HTMLDDA?function(t){return"function"==typeof t||t===o}:function(t){return"function"==typeof t}},function(t,n,r){var e=r(13),o=r(8),i=r(75),c=r(16).f;t.exports=function(t){var n=e.Symbol||(e.Symbol={});o(n,t)||c(n,t,{value:i.f(t)})}},function(t,n,r){var e=r(1),o=r(33),i=r(8),c=r(60),u=r(24),a=r(82),f=o("wks"),s=e.Symbol,p=s&&s.for,l=a?s:s&&s.withoutSetter||c;t.exports=function(t){if(!i(f,t)||!u&&"string"!=typeof f[t]){var n="Symbol."+t;u&&i(s,t)?f[t]=s[t]:f[t]=a&&p?p(n):l(n)}return f[t]}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(42),o=Function.prototype,i=o.call,c=e&&o.bind.bind(i,i);t.exports=e?c:function(t){return function(){return i.apply(t,arguments)}}},function(t,n,r){var e=r(42),o=Function.prototype.call;t.exports=e?o.bind(o):function(){return o.apply(o,arguments)}},function(t,n,r){var e=r(6),o=r(25),i=e({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,n){return i(o(t),n)}},function(t,n,r){var e=r(13),o=r(1),i=r(2),c=function(t){return i(t)?t:void 0};t.exports=function(t,n){return arguments.length<2?c(e[t])||c(o[t]):e[t]&&e[t][n]||o[t]&&o[t][n]}},function(t,n,r){var e=r(2),o=r(79),i=o.all;t.exports=o.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:e(t)||t===i}:function(t){return"object"==typeof t?null!==t:e(t)}},function(t,n,r){var e=r(5);t.exports=!e((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,n,r){var e=r(10),o=String,i=TypeError;t.exports=function(t){if(e(t))return t;throw i(o(t)+" is not an object")}},function(t,n){t.exports={}},function(t,n,r){var e=r(6);t.exports=e({}.isPrototypeOf)},function(t,n){t.exports=!0},function(t,n,r){var e=r(11),o=r(83),i=r(85),c=r(12),u=r(45),a=TypeError,f=Object.defineProperty,s=Object.getOwnPropertyDescriptor;n.f=e?i?function(t,n,r){if(c(t),n=u(n),c(r),"function"==typeof t&&"prototype"===n&&"value"in r&&"writable"in r&&!r.writable){var e=s(t,n);e&&e.writable&&(t[n]=r.value,r={configurable:"configurable"in r?r.configurable:e.configurable,enumerable:"enumerable"in r?r.enumerable:e.enumerable,writable:!1})}return f(t,n,r)}:f:function(t,n,r){if(c(t),n=u(n),c(r),o)try{return f(t,n,r)}catch(t){}if("get"in r||"set"in r)throw a("Accessors not supported");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(2),o=r(32),i=TypeError;t.exports=function(t){if(e(t))return t;throw i(o(t)+" is not a function")}},function(t,n,r){var e=r(81),o=r(57);t.exports=function(t){return e(o(t))}},function(t,n,r){var e=r(11),o=r(16),i=r(20);t.exports=e?function(t,n,r){return o.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n,r){var e=r(19);t.exports=function(t,n,r,o){return o&&o.enumerable?t[n]=r:e(t,n,r),t}},function(t,n,r){"use strict";var e=r(17),o=TypeError,i=function(t){var n,r;this.promise=new t((function(t,e){if(void 0!==n||void 0!==r)throw o("Bad Promise constructor");n=t,r=e})),this.resolve=e(n),this.reject=e(r)};t.exports.f=function(t){return new i(t)}},function(t,n,r){var e=r(6),o=e({}.toString),i=e("".slice);t.exports=function(t){return i(o(t),8,-1)}},function(t,n,r){var e=r(47),o=r(5);t.exports=!!Object.getOwnPropertySymbols&&!o((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&e&&e<41}))},function(t,n,r){var e=r(57),o=Object;t.exports=function(t){return o(e(t))}},function(t,n,r){var e=r(124);t.exports=function(t){return e(t.length)}},function(t,n){t.exports={}},function(t,n,r){var e=r(70),o=r(2),i=r(23),c=r(4)("toStringTag"),u=Object,a="Arguments"==i(function(){return arguments}());t.exports=e?i:function(t){var n,r,e;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,n){try{return t[n]}catch(t){}}(n=u(t),c))?r:a?i(n):"Object"==(e=i(n))&&o(n.callee)?"Arguments":e}},function(t,n,r){var e=r(70),o=r(16).f,i=r(19),c=r(8),u=r(136),a=r(4)("toStringTag");t.exports=function(t,n,r,f){if(t){var s=r?t:t.prototype;c(s,a)||o(s,a,{configurable:!0,value:n}),f&&!e&&i(s,"toString",u)}}},function(t,n,r){var e=r(1);t.exports=e.Promise},function(t,n,r){var e=r(9);t.exports=e("navigator","userAgent")||""},function(t,n){var r=String;t.exports=function(t){try{return r(t)}catch(t){return"Object"}}},function(t,n,r){var e=r(15),o=r(59);(t.exports=function(t,n){return o[t]||(o[t]=void 0!==n?n:{})})("versions",[]).push({version:"3.27.1",mode:e?"pure":"global",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.27.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(t,n,r){var e=r(78),o=r(17),i=r(42),c=e(e.bind);t.exports=function(t,n){return o(t),void 0===n?t:i?c(t,n):function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(34),o=r(7),i=r(12),c=r(32),u=r(127),a=r(26),f=r(14),s=r(128),p=r(89),l=r(129),v=TypeError,d=function(t,n){this.stopped=t,this.result=n},y=d.prototype;t.exports=function(t,n,r){var h,m,g,x,b,w,S,j=r&&r.that,O=!(!r||!r.AS_ENTRIES),P=!(!r||!r.IS_RECORD),T=!(!r||!r.IS_ITERATOR),A=!(!r||!r.INTERRUPTED),E=e(n,j),k=function(t){return h&&l(h,"normal",t),new d(!0,t)},I=function(t){return O?(i(t),A?E(t[0],t[1],k):E(t[0],t[1])):A?E(t,k):E(t)};if(P)h=t.iterator;else if(T)h=t;else{if(!(m=p(t)))throw v(c(t)+" is not iterable");if(u(m)){for(g=0,x=a(t);x>g;g++)if((b=I(t[g]))&&f(y,b))return b;return new d(!1)}h=s(t,m)}for(w=P?t.next:h.next;!(S=o(w,h)).done;){try{b=I(S.value)}catch(t){l(h,"throw",t)}if("object"==typeof b&&b&&f(y,b))return b}return new d(!1)}},function(t,n,r){var e=r(28),o=String;t.exports=function(t){if("Symbol"===e(t))throw TypeError("Cannot convert a Symbol value to a string");return o(t)}},function(t,n){t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},function(t,n,r){var e=r(1),o=r(30),i=r(2),c=r(84),u=r(94),a=r(4),f=r(147),s=r(98),p=r(15),l=r(47),v=o&&o.prototype,d=a("species"),y=!1,h=i(e.PromiseRejectionEvent),m=c("Promise",(function(){var t=u(o),n=t!==String(o);if(!n&&66===l)return!0;if(p&&(!v.catch||!v.finally))return!0;if(!l||l<51||!/native code/.test(t)){var r=new o((function(t){t(1)})),e=function(t){t((function(){}),(function(){}))};if((r.constructor={})[d]=e,!(y=r.then((function(){}))instanceof e))return!0}return!n&&(f||s)&&!h}));t.exports={CONSTRUCTOR:m,REJECTION_EVENT:h,SUBCLASSING:y}},function(t,n,r){var e=r(23);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){var e=r(13);t.exports=function(t){return e[t+"Prototype"]}},function(t,n,r){var e=r(42),o=Function.prototype,i=o.apply,c=o.call;t.exports="object"==typeof Reflect&&Reflect.apply||(e?c.bind(i):function(){return c.apply(i,arguments)})},function(t,n,r){var e=r(5);t.exports=!e((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},function(t,n,r){var e=r(11),o=r(7),i=r(80),c=r(20),u=r(18),a=r(45),f=r(8),s=r(83),p=Object.getOwnPropertyDescriptor;n.f=e?p:function(t,n){if(t=u(t),n=a(n),s)try{return p(t,n)}catch(t){}if(f(t,n))return c(!o(i.f,t,n),t[n])}},function(t,n){t.exports=function(t){return null==t}},function(t,n,r){var e=r(115),o=r(46);t.exports=function(t){var n=e(t,"string");return o(n)?n:n+""}},function(t,n,r){var e=r(9),o=r(2),i=r(14),c=r(82),u=Object;t.exports=c?function(t){return"symbol"==typeof t}:function(t){var n=e("Symbol");return o(n)&&i(n.prototype,u(t))}},function(t,n,r){var e,o,i=r(1),c=r(31),u=i.process,a=i.Deno,f=u&&u.versions||a&&a.version,s=f&&f.v8;s&&(o=(e=s.split("."))[0]>0&&e[0]<4?1:+(e[0]+e[1])),!o&&c&&(!(e=c.match(/Edge\\/(\\d+)/))||e[1]>=74)&&(e=c.match(/Chrome\\/(\\d+)/))&&(o=+e[1]),t.exports=o},function(t,n,r){var e=r(33),o=r(60),i=e("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},function(t,n){t.exports={}},function(t,n,r){var e,o=r(12),i=r(87),c=r(67),u=r(49),a=r(88),f=r(61),s=r(48),p=s("IE_PROTO"),l=function(){},v=function(t){return"<script>"+t+"<\\/script>"},d=function(t){t.write(v("")),t.close();var n=t.parentWindow.Object;return t=null,n},y=function(){try{e=new ActiveXObject("htmlfile")}catch(t){}var t,n;y="undefined"!=typeof document?document.domain&&e?d(e):((n=f("iframe")).style.display="none",a.appendChild(n),n.src=String("javascript:"),(t=n.contentWindow.document).open(),t.write(v("document.F=Object")),t.close(),t.F):d(e);for(var r=c.length;r--;)delete y.prototype[c[r]];return y()};u[p]=!0,t.exports=Object.create||function(t,n){var r;return null!==t?(l.prototype=o(t),r=new l,l.prototype=null,r[p]=t):r=y(),void 0===n?r:i.f(r,n)}},function(t,n,r){var e,o,i,c=r(133),u=r(1),a=r(10),f=r(19),s=r(8),p=r(59),l=r(48),v=r(49),d=u.TypeError,y=u.WeakMap;if(c||p.state){var h=p.state||(p.state=new y);h.get=h.get,h.has=h.has,h.set=h.set,e=function(t,n){if(h.has(t))throw d("Object already initialized");return n.facade=t,h.set(t,n),n},o=function(t){return h.get(t)||{}},i=function(t){return h.has(t)}}else{var m=l("state");v[m]=!0,e=function(t,n){if(s(t,m))throw d("Object already initialized");return n.facade=t,f(t,m,n),n},o=function(t){return s(t,m)?t[m]:{}},i=function(t){return s(t,m)}}t.exports={set:e,get:o,has:i,enforce:function(t){return i(t)?o(t):e(t,{})},getterFor:function(t){return function(n){var r;if(!a(n)||(r=o(n)).type!==t)throw d("Incompatible receiver, "+t+" required");return r}}}},function(t,n,r){var e=r(23),o=r(1);t.exports="process"==e(o.process)},function(t,n,r){var e=r(6);t.exports=e([].slice)},function(t,n,r){r(71);var e=r(158),o=r(1),i=r(28),c=r(19),u=r(27),a=r(4)("toStringTag");for(var f in e){var s=o[f],p=s&&s.prototype;p&&i(p)!==a&&c(p,a,f),u[f]=u.Array}},function(t,n,r){var e=r(5),o=r(4),i=r(47),c=o("species");t.exports=function(t){return i>=51||!e((function(){var n=[];return(n.constructor={})[c]=function(){return{foo:1}},1!==n[t](Boolean).foo}))}},function(t,n,r){var e=r(34),o=r(6),i=r(81),c=r(25),u=r(26),a=r(103),f=o([].push),s=function(t){var n=1==t,r=2==t,o=3==t,s=4==t,p=6==t,l=7==t,v=5==t||p;return function(d,y,h,m){for(var g,x,b=c(d),w=i(b),S=e(y,h),j=u(w),O=0,P=m||a,T=n?P(d,j):r||l?P(d,0):void 0;j>O;O++)if((v||O in w)&&(x=S(g=w[O],O,b),t))if(n)T[O]=x;else if(x)switch(t){case 3:return!0;case 5:return g;case 6:return O;case 2:f(T,g)}else switch(t){case 4:return!1;case 7:f(T,g)}return p?-1:o||s?s:T}};t.exports={forEach:s(0),map:s(1),filter:s(2),some:s(3),every:s(4),find:s(5),findIndex:s(6),filterReject:s(7)}},function(t,n,r){var e=r(44),o=TypeError;t.exports=function(t){if(e(t))throw o("Can't call method on "+t);return t}},function(t,n,r){var e=r(17),o=r(44);t.exports=function(t,n){var r=t[n];return o(r)?void 0:e(r)}},function(t,n,r){var e=r(1),o=r(117),i=e["__core-js_shared__"]||o("__core-js_shared__",{});t.exports=i},function(t,n,r){var e=r(6),o=0,i=Math.random(),c=e(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+c(++o+i,36)}},function(t,n,r){var e=r(1),o=r(10),i=e.document,c=o(i)&&o(i.createElement);t.exports=function(t){return c?i.createElement(t):{}}},function(t,n,r){var e=r(8),o=r(2),i=r(25),c=r(48),u=r(118),a=c("IE_PROTO"),f=Object,s=f.prototype;t.exports=u?f.getPrototypeOf:function(t){var n=i(t);if(e(n,a))return n[a];var r=n.constructor;return o(r)&&n instanceof r?r.prototype:n instanceof f?s:null}},function(t,n,r){var e=r(6),o=r(12),i=r(119);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,n=!1,r={};try{(t=e(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),n=r instanceof Array}catch(t){}return function(r,e){return o(r),i(e),n?t(r,e):r.__proto__=e,r}}():void 0)},function(t,n,r){var e=r(86),o=r(67).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,o)}},function(t,n,r){var e=r(66),o=Math.max,i=Math.min;t.exports=function(t,n){var r=e(t);return r<0?o(r+n,0):i(r,n)}},function(t,n,r){var e=r(123);t.exports=function(t){var n=+t;return n!=n||0===n?0:e(n)}},function(t,n){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(86),o=r(67);t.exports=Object.keys||function(t){return e(t,o)}},function(t,n,r){var e={};e[r(4)("toStringTag")]="z",t.exports="[object z]"===String(e)},function(t,n,r){"use strict";var e=r(18),o=r(132),i=r(27),c=r(51),u=r(16).f,a=r(90),f=r(92),s=r(15),p=r(11),l=c.set,v=c.getterFor("Array Iterator");t.exports=a(Array,"Array",(function(t,n){l(this,{type:"Array Iterator",target:e(t),index:0,kind:n})}),(function(){var t=v(this),n=t.target,r=t.kind,e=t.index++;return!n||e>=n.length?(t.target=void 0,f(void 0,!0)):f("keys"==r?e:"values"==r?n[e]:[e,n[e]],!1)}),"values");var d=i.Arguments=i.Array;if(o("keys"),o("values"),o("entries"),!s&&p&&"values"!==d.name)try{u(d,"name",{value:"values"})}catch(t){}},function(t,n){},function(t,n,r){var e=r(6),o=r(5),i=r(2),c=r(28),u=r(9),a=r(94),f=function(){},s=[],p=u("Reflect","construct"),l=/^\\s*(?:class|function)\\b/,v=e(l.exec),d=!l.exec(f),y=function(t){if(!i(t))return!1;try{return p(f,s,t),!0}catch(t){return!1}},h=function(t){if(!i(t))return!1;switch(c(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return d||!!v(l,a(t))}catch(t){return!0}};h.sham=!0,t.exports=!p||o((function(){var t;return y(y.call)||!y(Object)||!y((function(){t=!0}))||t}))?h:y},function(t,n,r){"use strict";var e=r(45),o=r(16),i=r(20);t.exports=function(t,n,r){var c=e(n);c in t?o.f(t,c,i(0,r)):t[c]=r}},function(t,n,r){var e=r(4);n.f=e},function(t,n,r){t.exports=r(111)},function(t,n){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,n,r){var e=r(23),o=r(6);t.exports=function(t){if("Function"===e(t))return o(t)}},function(t,n){var r="object"==typeof document&&document.all,e=void 0===r&&void 0!==r;t.exports={all:r,IS_HTMLDDA:e}},function(t,n,r){"use strict";var e={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!e.call({1:2},1);n.f=i?function(t){var n=o(this,t);return!!n&&n.enumerable}:e},function(t,n,r){var e=r(6),o=r(5),i=r(23),c=Object,u=e("".split);t.exports=o((function(){return!c("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?u(t,""):c(t)}:c},function(t,n,r){var e=r(24);t.exports=e&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,n,r){var e=r(11),o=r(5),i=r(61);t.exports=!e&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},function(t,n,r){var e=r(5),o=r(2),i=/#|\\.prototype\\./,c=function(t,n){var r=a[u(t)];return r==s||r!=f&&(o(n)?e(n):!!n)},u=c.normalize=function(t){return String(t).replace(i,".").toLowerCase()},a=c.data={},f=c.NATIVE="N",s=c.POLYFILL="P";t.exports=c},function(t,n,r){var e=r(11),o=r(5);t.exports=e&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(t,n,r){var e=r(6),o=r(8),i=r(18),c=r(122).indexOf,u=r(49),a=e([].push);t.exports=function(t,n){var r,e=i(t),f=0,s=[];for(r in e)!o(u,r)&&o(e,r)&&a(s,r);for(;n.length>f;)o(e,r=n[f++])&&(~c(s,r)||a(s,r));return s}},function(t,n,r){var e=r(11),o=r(85),i=r(16),c=r(12),u=r(18),a=r(69);n.f=e&&!o?Object.defineProperties:function(t,n){c(t);for(var r,e=u(n),o=a(n),f=o.length,s=0;f>s;)i.f(t,r=o[s++],e[r]);return t}},function(t,n,r){var e=r(9);t.exports=e("document","documentElement")},function(t,n,r){var e=r(28),o=r(58),i=r(44),c=r(27),u=r(4)("iterator");t.exports=function(t){if(!i(t))return o(t,u)||o(t,"@@iterator")||c[e(t)]}},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(15),c=r(134),u=r(2),a=r(135),f=r(62),s=r(63),p=r(29),l=r(19),v=r(21),d=r(4),y=r(27),h=r(91),m=c.PROPER,g=c.CONFIGURABLE,x=h.IteratorPrototype,b=h.BUGGY_SAFARI_ITERATORS,w=d("iterator"),S=function(){return this};t.exports=function(t,n,r,c,d,h,j){a(r,n,c);var O,P,T,A=function(t){if(t===d&&L)return L;if(!b&&t in I)return I[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},E=n+" Iterator",k=!1,I=t.prototype,D=I[w]||I["@@iterator"]||d&&I[d],L=!b&&D||A(d),_="Array"==n&&I.entries||D;if(_&&(O=f(_.call(new t)))!==Object.prototype&&O.next&&(i||f(O)===x||(s?s(O,x):u(O[w])||v(O,w,S)),p(O,E,!0,!0),i&&(y[E]=S)),m&&"values"==d&&D&&"values"!==D.name&&(!i&&g?l(I,"name","values"):(k=!0,L=function(){return o(D,this)})),d)if(P={values:A("values"),keys:h?L:A("keys"),entries:A("entries")},j)for(T in P)(b||k||!(T in I))&&v(I,T,P[T]);else e({target:n,proto:!0,forced:b||k},P);return i&&!j||I[w]===L||v(I,w,L,{name:d}),y[n]=L,P}},function(t,n,r){"use strict";var e,o,i,c=r(5),u=r(2),a=r(10),f=r(50),s=r(62),p=r(21),l=r(4),v=r(15),d=l("iterator"),y=!1;[].keys&&("next"in(i=[].keys())?(o=s(s(i)))!==Object.prototype&&(e=o):y=!0),!a(e)||c((function(){var t={};return e[d].call(t)!==t}))?e={}:v&&(e=f(e)),u(e[d])||p(e,d,(function(){return this})),t.exports={IteratorPrototype:e,BUGGY_SAFARI_ITERATORS:y}},function(t,n){t.exports=function(t,n){return{value:t,done:n}}},function(t,n,r){var e=r(12),o=r(141),i=r(44),c=r(4)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||i(r=e(u)[c])?n:o(r)}},function(t,n,r){var e=r(6),o=r(2),i=r(59),c=e(Function.toString);o(i.inspectSource)||(i.inspectSource=function(t){return c(t)}),t.exports=i.inspectSource},function(t,n,r){var e,o,i,c,u=r(1),a=r(41),f=r(34),s=r(2),p=r(8),l=r(5),v=r(88),d=r(53),y=r(61),h=r(96),m=r(97),g=r(52),x=u.setImmediate,b=u.clearImmediate,w=u.process,S=u.Dispatch,j=u.Function,O=u.MessageChannel,P=u.String,T=0,A={};try{e=u.location}catch(t){}var E=function(t){if(p(A,t)){var n=A[t];delete A[t],n()}},k=function(t){return function(){E(t)}},I=function(t){E(t.data)},D=function(t){u.postMessage(P(t),e.protocol+"//"+e.host)};x&&b||(x=function(t){h(arguments.length,1);var n=s(t)?t:j(t),r=d(arguments,1);return A[++T]=function(){a(n,void 0,r)},o(T),T},b=function(t){delete A[t]},g?o=function(t){w.nextTick(k(t))}:S&&S.now?o=function(t){S.now(k(t))}:O&&!m?(c=(i=new O).port2,i.port1.onmessage=I,o=f(c.postMessage,c)):u.addEventListener&&s(u.postMessage)&&!u.importScripts&&e&&"file:"!==e.protocol&&!l(D)?(o=D,u.addEventListener("message",I,!1)):o="onreadystatechange"in y("script")?function(t){v.appendChild(y("script")).onreadystatechange=function(){v.removeChild(this),E(t)}}:function(t){setTimeout(k(t),0)}),t.exports={set:x,clear:b}},function(t,n){var r=TypeError;t.exports=function(t,n){if(t<n)throw r("Not enough arguments");return t}},function(t,n,r){var e=r(31);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(e)},function(t,n){t.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},function(t,n,r){var e=r(30),o=r(149),i=r(38).CONSTRUCTOR;t.exports=i||!o((function(t){e.all(t).then(void 0,(function(){}))}))},function(t,n,r){var e=r(12),o=r(10),i=r(22);t.exports=function(t,n){if(e(t),o(n)&&n.constructor===t)return n;var r=i.f(t);return(0,r.resolve)(n),r.promise}},function(t,n,r){"use strict";var e=r(157).charAt,o=r(36),i=r(51),c=r(90),u=r(92),a=i.set,f=i.getterFor("String Iterator");c(String,"String",(function(t){a(this,{type:"String Iterator",string:o(t),index:0})}),(function(){var t,n=f(this),r=n.string,o=n.index;return o>=r.length?u(void 0,!0):(t=e(r,o),n.index+=t.length,u(t,!1))}))},function(t,n,r){t.exports=r(159)},function(t,n,r){var e=r(168);t.exports=function(t,n){return new(e(t))(0===n?0:n)}},function(t,n,r){"use strict";var e=r(0),o=r(5),i=r(39),c=r(10),u=r(25),a=r(26),f=r(177),s=r(74),p=r(103),l=r(55),v=r(4),d=r(47),y=v("isConcatSpreadable"),h=d>=51||!o((function(){var t=[];return t[y]=!1,t.concat()[0]!==t})),m=l("concat"),g=function(t){if(!c(t))return!1;var n=t[y];return void 0!==n?!!n:i(t)};e({target:"Array",proto:!0,arity:1,forced:!h||!m},{concat:function(t){var n,r,e,o,i,c=u(this),l=p(c,0),v=0;for(n=-1,e=arguments.length;n<e;n++)if(g(i=-1===n?c:arguments[n]))for(o=a(i),f(v+o),r=0;r<o;r++,v++)r in i&&s(l,v,i[r]);else f(v+1),s(l,v++,i);return l.length=v,l}})},function(t,n,r){var e=r(7),o=r(9),i=r(4),c=r(21);t.exports=function(){var t=o("Symbol"),n=t&&t.prototype,r=n&&n.valueOf,u=i("toPrimitive");n&&!n[u]&&c(n,u,(function(t){return e(r,this)}),{arity:1})}},function(t,n,r){var e=r(24);t.exports=e&&!!Symbol.for&&!!Symbol.keyFor},function(t,n,r){r(3)("iterator")},function(t,n,r){"use strict";var e,o=r(1),i=r(41),c=r(2),u=r(220),a=r(31),f=r(53),s=r(96),p=o.Function,l=/MSIE .\\./.test(a)||u&&((e=o.Bun.version.split(".")).length<3||0==e[0]&&(e[1]<3||3==e[1]&&0==e[2]));t.exports=function(t,n){var r=n?2:1;return l?function(e,o){var u=s(arguments.length,1)>r,a=c(e)?e:p(e),l=u?f(arguments,r):[],v=u?function(){i(a,this,l)}:a;return n?t(v,o):t(v)}:t}},function(t,n,r){var e=r(110),o=null;function i(t){return t&&"string"!=typeof t?t.message?t.message:t.target&&t.target.error?t.target.error.message:"unknown error":t}self.onmessage=function(t){switch(t.data.type){case"init":r=t.data.msg,(o=new e(r)).init().catch((function(t){postMessage({type:"error",msg:{msg:"dbLog init error",error:i(t)}})}));break;case"fetch":o.getAllLogs().then((function(t){postMessage({type:"fetchDone",code:200,msg:t})})).catch((function(t){postMessage({type:"fetchDone",code:500,msg:i(t)})}));break;case"delete":o.deleteLogs(n).catch((function(t){postMessage({type:"deleteLogs",code:500,msg:i(t)})}));break;default:!function(t){if(!o)return;o.putLog(t).then((function(){postMessage(200)})).catch((function(t){postMessage({type:"error",msg:{msg:"putLog error",error:i(t)}})}))}(t.data)}var n,r}},function(t,n,r){var e=r(76),o=r(102),i=r(163),c=r(169),u={log:{key:{keyPath:"time"},indexes:{level:{unique:!1},time:{unique:!0}}}};function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.server=null,this.expire=t.expire||72,this.name=t.name}var f=a.prototype;f.init=function(){var t=this;if(!this.server)return c.open({server:"nim-log-"+this.name,version:1,schema:u}).then((function(n){t.server=n}))},f.putLog=function(t){var n=this;if(!this.server)return e.reject("no db server");var r=o(t).call(t,-1)[0].time-36e5*this.expire;return this.deleteLogs(r).then((function(){return n.server.add("log",t)}))},f.getAllLogs=function(){return this.server?this.server.query("log","time").all().execute().then((function(t){var n={},r=o(t).call(t,-1)[0];return n.logs=i(t).call(t,(function(t){return t.log})).join("\\r\\n"),n.time=r&&r.time,n})):e.reject("no db server")},f.deleteLogs=function(t){return this.server?this.server.remove("log",null,"time",0,t):e.reject("no db server")},t.exports=a},function(t,n,r){var e=r(112);r(54),t.exports=e},function(t,n,r){r(113),r(71),r(72),r(137),r(154),r(155),r(156),r(101);var e=r(13);t.exports=e.Promise},function(t,n,r){r(114)},function(t,n,r){"use strict";var e=r(0),o=r(14),i=r(62),c=r(63),u=r(120),a=r(50),f=r(19),s=r(20),p=r(125),l=r(126),v=r(35),d=r(130),y=r(4),h=r(131),m=y("toStringTag"),g=Error,x=[].push,b=function(t,n){var r,e=arguments.length>2?arguments[2]:void 0,u=o(w,this);c?r=c(g(),u?i(this):w):(r=u?this:a(w),f(r,m,"Error")),void 0!==n&&f(r,"message",d(n)),h&&f(r,"stack",p(r.stack,1)),l(r,e);var s=[];return v(t,x,{that:s}),f(r,"errors",s),r};c?c(b,g):u(b,g,{name:!0});var w=b.prototype=a(g.prototype,{constructor:s(1,b),message:s(1,""),name:s(1,"AggregateError")});e({global:!0,constructor:!0,arity:2},{AggregateError:b})},function(t,n,r){var e=r(7),o=r(10),i=r(46),c=r(58),u=r(116),a=r(4),f=TypeError,s=a("toPrimitive");t.exports=function(t,n){if(!o(t)||i(t))return t;var r,a=c(t,s);if(a){if(void 0===n&&(n="default"),r=e(a,t,n),!o(r)||i(r))return r;throw f("Can't convert object to primitive value")}return void 0===n&&(n="number"),u(t,n)}},function(t,n,r){var e=r(7),o=r(2),i=r(10),c=TypeError;t.exports=function(t,n){var r,u;if("string"===n&&o(r=t.toString)&&!i(u=e(r,t)))return u;if(o(r=t.valueOf)&&!i(u=e(r,t)))return u;if("string"!==n&&o(r=t.toString)&&!i(u=e(r,t)))return u;throw c("Can't convert object to primitive value")}},function(t,n,r){var e=r(1),o=Object.defineProperty;t.exports=function(t,n){try{o(e,t,{value:n,configurable:!0,writable:!0})}catch(r){e[t]=n}return n}},function(t,n,r){var e=r(5);t.exports=!e((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,n,r){var e=r(2),o=String,i=TypeError;t.exports=function(t){if("object"==typeof t||e(t))return t;throw i("Can't set "+o(t)+" as a prototype")}},function(t,n,r){var e=r(8),o=r(121),i=r(43),c=r(16);t.exports=function(t,n,r){for(var u=o(n),a=c.f,f=i.f,s=0;s<u.length;s++){var p=u[s];e(t,p)||r&&e(r,p)||a(t,p,f(n,p))}}},function(t,n,r){var e=r(9),o=r(6),i=r(64),c=r(68),u=r(12),a=o([].concat);t.exports=e("Reflect","ownKeys")||function(t){var n=i.f(u(t)),r=c.f;return r?a(n,r(t)):n}},function(t,n,r){var e=r(18),o=r(65),i=r(26),c=function(t){return function(n,r,c){var u,a=e(n),f=i(a),s=o(c,f);if(t&&r!=r){for(;f>s;)if((u=a[s++])!=u)return!0}else for(;f>s;s++)if((t||s in a)&&a[s]===r)return t||s||0;return!t&&-1}};t.exports={includes:c(!0),indexOf:c(!1)}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=Math.trunc||function(t){var n=+t;return(n>0?e:r)(n)}},function(t,n,r){var e=r(66),o=Math.min;t.exports=function(t){return t>0?o(e(t),9007199254740991):0}},function(t,n,r){var e=r(6),o=Error,i=e("".replace),c=String(o("zxcasd").stack),u=/\\n\\s*at [^:]*:[^\\n]*/,a=u.test(c);t.exports=function(t,n){if(a&&"string"==typeof t&&!o.prepareStackTrace)for(;n--;)t=i(t,u,"");return t}},function(t,n,r){var e=r(10),o=r(19);t.exports=function(t,n){e(n)&&"cause"in n&&o(t,"cause",n.cause)}},function(t,n,r){var e=r(4),o=r(27),i=e("iterator"),c=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||c[i]===t)}},function(t,n,r){var e=r(7),o=r(17),i=r(12),c=r(32),u=r(89),a=TypeError;t.exports=function(t,n){var r=arguments.length<2?u(t):n;if(o(r))return i(e(r,t));throw a(c(t)+" is not iterable")}},function(t,n,r){var e=r(7),o=r(12),i=r(58);t.exports=function(t,n,r){var c,u;o(t);try{if(!(c=i(t,"return"))){if("throw"===n)throw r;return r}c=e(c,t)}catch(t){u=!0,c=t}if("throw"===n)throw r;if(u)throw c;return o(c),r}},function(t,n,r){var e=r(36);t.exports=function(t,n){return void 0===t?arguments.length<2?"":n:e(t)}},function(t,n,r){var e=r(5),o=r(20);t.exports=!e((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",o(1,7)),7!==t.stack)}))},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(1),o=r(2),i=e.WeakMap;t.exports=o(i)&&/native code/.test(String(i))},function(t,n,r){var e=r(11),o=r(8),i=Function.prototype,c=e&&Object.getOwnPropertyDescriptor,u=o(i,"name"),a=u&&"something"===function(){}.name,f=u&&(!e||e&&c(i,"name").configurable);t.exports={EXISTS:u,PROPER:a,CONFIGURABLE:f}},function(t,n,r){"use strict";var e=r(91).IteratorPrototype,o=r(50),i=r(20),c=r(29),u=r(27),a=function(){return this};t.exports=function(t,n,r,f){var s=n+" Iterator";return t.prototype=o(e,{next:i(+!f,r)}),c(t,s,!1,!0),u[s]=a,t}},function(t,n,r){"use strict";var e=r(70),o=r(28);t.exports=e?{}.toString:function(){return"[object "+o(this)+"]"}},function(t,n,r){r(138),r(148),r(150),r(151),r(152),r(153)},function(t,n,r){"use strict";var e,o,i,c=r(0),u=r(15),a=r(52),f=r(1),s=r(7),p=r(21),l=r(63),v=r(29),d=r(139),y=r(17),h=r(2),m=r(10),g=r(140),x=r(93),b=r(95).set,w=r(142),S=r(145),j=r(37),O=r(146),P=r(51),T=r(30),A=r(38),E=r(22),k=A.CONSTRUCTOR,I=A.REJECTION_EVENT,D=A.SUBCLASSING,L=P.getterFor("Promise"),_=P.set,C=T&&T.prototype,M=T,R=C,N=f.TypeError,F=f.document,B=f.process,G=E.f,U=G,z=!!(F&&F.createEvent&&f.dispatchEvent),q=function(t){var n;return!(!m(t)||!h(n=t.then))&&n},V=function(t,n){var r,e,o,i=n.value,c=1==n.state,u=c?t.ok:t.fail,a=t.resolve,f=t.reject,p=t.domain;try{u?(c||(2===n.rejection&&Y(n),n.rejection=1),!0===u?r=i:(p&&p.enter(),r=u(i),p&&(p.exit(),o=!0)),r===t.promise?f(N("Promise-chain cycle")):(e=q(r))?s(e,r,a,f):a(r)):f(i)}catch(t){p&&!o&&p.exit(),f(t)}},H=function(t,n){t.notified||(t.notified=!0,w((function(){for(var r,e=t.reactions;r=e.get();)V(r,t);t.notified=!1,n&&!t.rejection&&K(t)})))},J=function(t,n,r){var e,o;z?((e=F.createEvent("Event")).promise=n,e.reason=r,e.initEvent(t,!1,!0),f.dispatchEvent(e)):e={promise:n,reason:r},!I&&(o=f["on"+t])?o(e):"unhandledrejection"===t&&S("Unhandled promise rejection",r)},K=function(t){s(b,f,(function(){var n,r=t.facade,e=t.value;if(W(t)&&(n=j((function(){a?B.emit("unhandledRejection",e,r):J("unhandledrejection",r,e)})),t.rejection=a||W(t)?2:1,n.error))throw n.value}))},W=function(t){return 1!==t.rejection&&!t.parent},Y=function(t){s(b,f,(function(){var n=t.facade;a?B.emit("rejectionHandled",n):J("rejectionhandled",n,t.value)}))},X=function(t,n,r){return function(e){t(n,e,r)}},$=function(t,n,r){t.done||(t.done=!0,r&&(t=r),t.value=n,t.state=2,H(t,!0))},Q=function(t,n,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===n)throw N("Promise can't be resolved itself");var e=q(n);e?w((function(){var r={done:!1};try{s(e,n,X(Q,r,t),X($,r,t))}catch(n){$(r,n,t)}})):(t.value=n,t.state=1,H(t,!1))}catch(n){$({done:!1},n,t)}}};if(k&&(R=(M=function(t){g(this,R),y(t),s(e,this);var n=L(this);try{t(X(Q,n),X($,n))}catch(t){$(n,t)}}).prototype,(e=function(t){_(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new O,rejection:!1,state:0,value:void 0})}).prototype=p(R,"then",(function(t,n){var r=L(this),e=G(x(this,M));return r.parent=!0,e.ok=!h(t)||t,e.fail=h(n)&&n,e.domain=a?B.domain:void 0,0==r.state?r.reactions.add(e):w((function(){V(e,r)})),e.promise})),o=function(){var t=new e,n=L(t);this.promise=t,this.resolve=X(Q,n),this.reject=X($,n)},E.f=G=function(t){return t===M||void 0===t?new o(t):U(t)},!u&&h(T)&&C!==Object.prototype)){i=C.then,D||p(C,"then",(function(t,n){var r=this;return new M((function(t,n){s(i,r,t,n)})).then(t,n)}),{unsafe:!0});try{delete C.constructor}catch(t){}l&&l(C,R)}c({global:!0,constructor:!0,wrap:!0,forced:k},{Promise:M}),v(M,"Promise",!1,!0),d("Promise")},function(t,n,r){"use strict";var e=r(9),o=r(16),i=r(4),c=r(11),u=i("species");t.exports=function(t){var n=e(t),r=o.f;c&&n&&!n[u]&&r(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(14),o=TypeError;t.exports=function(t,n){if(e(n,t))return t;throw o("Incorrect invocation")}},function(t,n,r){var e=r(73),o=r(32),i=TypeError;t.exports=function(t){if(e(t))return t;throw i(o(t)+" is not a constructor")}},function(t,n,r){var e,o,i,c,u,a,f,s,p=r(1),l=r(34),v=r(43).f,d=r(95).set,y=r(97),h=r(143),m=r(144),g=r(52),x=p.MutationObserver||p.WebKitMutationObserver,b=p.document,w=p.process,S=p.Promise,j=v(p,"queueMicrotask"),O=j&&j.value;O||(e=function(){var t,n;for(g&&(t=w.domain)&&t.exit();o;){n=o.fn,o=o.next;try{n()}catch(t){throw o?c():i=void 0,t}}i=void 0,t&&t.enter()},y||g||m||!x||!b?!h&&S&&S.resolve?((f=S.resolve(void 0)).constructor=S,s=l(f.then,f),c=function(){s(e)}):g?c=function(){w.nextTick(e)}:(d=l(d,p),c=function(){d(e)}):(u=!0,a=b.createTextNode(""),new x(e).observe(a,{characterData:!0}),c=function(){a.data=u=!u})),t.exports=O||function(t){var n={fn:t,next:void 0};i&&(i.next=n),o||(o=n,c()),i=n}},function(t,n,r){var e=r(31),o=r(1);t.exports=/ipad|iphone|ipod/i.test(e)&&void 0!==o.Pebble},function(t,n,r){var e=r(31);t.exports=/web0s(?!.*chrome)/i.test(e)},function(t,n,r){var e=r(1);t.exports=function(t,n){var r=e.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,n))}},function(t,n){var r=function(){this.head=null,this.tail=null};r.prototype={add:function(t){var n={item:t,next:null};this.head?this.tail.next=n:this.head=n,this.tail=n},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}},t.exports=r},function(t,n,r){var e=r(98),o=r(52);t.exports=!e&&!o&&"object"==typeof window&&"object"==typeof document},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(22),u=r(37),a=r(35);e({target:"Promise",stat:!0,forced:r(99)},{all:function(t){var n=this,r=c.f(n),e=r.resolve,f=r.reject,s=u((function(){var r=i(n.resolve),c=[],u=0,s=1;a(t,(function(t){var i=u++,a=!1;s++,o(r,n,t).then((function(t){a||(a=!0,c[i]=t,--s||e(c))}),f)})),--s||e(c)}));return s.error&&f(s.value),r.promise}})},function(t,n,r){var e=r(4)("iterator"),o=!1;try{var i=0,c={next:function(){return{done:!!i++}},return:function(){o=!0}};c[e]=function(){return this},Array.from(c,(function(){throw 2}))}catch(t){}t.exports=function(t,n){if(!n&&!o)return!1;var r=!1;try{var i={};i[e]=function(){return{next:function(){return{done:r=!0}}}},t(i)}catch(t){}return r}},function(t,n,r){"use strict";var e=r(0),o=r(15),i=r(38).CONSTRUCTOR,c=r(30),u=r(9),a=r(2),f=r(21),s=c&&c.prototype;if(e({target:"Promise",proto:!0,forced:i,real:!0},{catch:function(t){return this.then(void 0,t)}}),!o&&a(c)){var p=u("Promise").prototype.catch;s.catch!==p&&f(s,"catch",p,{unsafe:!0})}},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(22),u=r(37),a=r(35);e({target:"Promise",stat:!0,forced:r(99)},{race:function(t){var n=this,r=c.f(n),e=r.reject,f=u((function(){var c=i(n.resolve);a(t,(function(t){o(c,n,t).then(r.resolve,e)}))}));return f.error&&e(f.value),r.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(22);e({target:"Promise",stat:!0,forced:r(38).CONSTRUCTOR},{reject:function(t){var n=i.f(this);return o(n.reject,void 0,t),n.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(9),i=r(15),c=r(30),u=r(38).CONSTRUCTOR,a=r(100),f=o("Promise"),s=i&&!u;e({target:"Promise",stat:!0,forced:i||u},{resolve:function(t){return a(s&&this===f?c:this,t)}})},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(22),u=r(37),a=r(35);e({target:"Promise",stat:!0},{allSettled:function(t){var n=this,r=c.f(n),e=r.resolve,f=r.reject,s=u((function(){var r=i(n.resolve),c=[],u=0,f=1;a(t,(function(t){var i=u++,a=!1;f++,o(r,n,t).then((function(t){a||(a=!0,c[i]={status:"fulfilled",value:t},--f||e(c))}),(function(t){a||(a=!0,c[i]={status:"rejected",reason:t},--f||e(c))}))})),--f||e(c)}));return s.error&&f(s.value),r.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(9),u=r(22),a=r(37),f=r(35);e({target:"Promise",stat:!0},{any:function(t){var n=this,r=c("AggregateError"),e=u.f(n),s=e.resolve,p=e.reject,l=a((function(){var e=i(n.resolve),c=[],u=0,a=1,l=!1;f(t,(function(t){var i=u++,f=!1;a++,o(e,n,t).then((function(t){f||l||(l=!0,s(t))}),(function(t){f||l||(f=!0,c[i]=t,--a||p(new r(c,"No one promise resolved")))}))})),--a||p(new r(c,"No one promise resolved"))}));return l.error&&p(l.value),e.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(15),i=r(30),c=r(5),u=r(9),a=r(2),f=r(93),s=r(100),p=r(21),l=i&&i.prototype;if(e({target:"Promise",proto:!0,real:!0,forced:!!i&&c((function(){l.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var n=f(this,u("Promise")),r=a(t);return this.then(r?function(r){return s(n,t()).then((function(){return r}))}:t,r?function(r){return s(n,t()).then((function(){throw r}))}:t)}}),!o&&a(i)){var v=u("Promise").prototype.finally;l.finally!==v&&p(l,"finally",v,{unsafe:!0})}},function(t,n,r){var e=r(6),o=r(66),i=r(36),c=r(57),u=e("".charAt),a=e("".charCodeAt),f=e("".slice),s=function(t){return function(n,r){var e,s,p=i(c(n)),l=o(r),v=p.length;return l<0||l>=v?t?"":void 0:(e=a(p,l))<55296||e>56319||l+1===v||(s=a(p,l+1))<56320||s>57343?t?u(p,l):e:t?f(p,l,l+2):s-56320+(e-55296<<10)+65536}};t.exports={codeAt:s(!1),charAt:s(!0)}},function(t,n){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,n,r){var e=r(160);t.exports=e},function(t,n,r){var e=r(14),o=r(161),i=Array.prototype;t.exports=function(t){var n=t.slice;return t===i||e(i,t)&&n===i.slice?o:n}},function(t,n,r){r(162);var e=r(40);t.exports=e("Array").slice},function(t,n,r){"use strict";var e=r(0),o=r(39),i=r(73),c=r(10),u=r(65),a=r(26),f=r(18),s=r(74),p=r(4),l=r(55),v=r(53),d=l("slice"),y=p("species"),h=Array,m=Math.max;e({target:"Array",proto:!0,forced:!d},{slice:function(t,n){var r,e,p,l=f(this),d=a(l),g=u(t,d),x=u(void 0===n?d:n,d);if(o(l)&&(r=l.constructor,(i(r)&&(r===h||o(r.prototype))||c(r)&&null===(r=r[y]))&&(r=void 0),r===h||void 0===r))return v(l,g,x);for(e=new(void 0===r?h:r)(m(x-g,0)),p=0;g<x;g++,p++)g in l&&s(e,p,l[g]);return e.length=p,e}})},function(t,n,r){t.exports=r(164)},function(t,n,r){var e=r(165);t.exports=e},function(t,n,r){var e=r(14),o=r(166),i=Array.prototype;t.exports=function(t){var n=t.map;return t===i||e(i,t)&&n===i.map?o:n}},function(t,n,r){r(167);var e=r(40);t.exports=e("Array").map},function(t,n,r){"use strict";var e=r(0),o=r(56).map;e({target:"Array",proto:!0,forced:!r(55)("map")},{map:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){var e=r(39),o=r(73),i=r(10),c=r(4)("species"),u=Array;t.exports=function(t){var n;return e(t)&&(n=t.constructor,(o(n)&&(n===u||e(n.prototype))||i(n)&&null===(n=n[c]))&&(n=void 0)),void 0===n?u:n}},function(t,n,r){(function(e){var o,i=r(170),c=r(76),u=r(216),a=r(102),f=r(222),s=r(226),p=r(233),l=r(237),v=r(241),d=r(245);!function(y,h){"use strict";var m,g=(y=void 0!==y?y:"undefined"!=typeof self?self:void 0!==e?e:{}).IDBKeyRange||y.webkitIDBKeyRange,x="readonly",b="readwrite",w=Object.prototype.hasOwnProperty,S=function(){if(!m&&!(m=y.indexedDB||y.webkitIndexedDB||y.mozIndexedDB||y.oIndexedDB||y.msIndexedDB||(null===y.indexedDB&&y.shimIndexedDB?y.shimIndexedDB:void 0)))throw"IndexedDB required";return m},j=!1,O=navigator&&!navigator.userAgentData&&/Safari\\//.test(navigator.userAgent)&&!/Chrom(e|ium)\\//.test(navigator.userAgent),P=function(t){return t},T=function(t){var n;return a(n=Object.prototype.toString.call(t)).call(n,8,-1).toLowerCase()},A=function(t){return"function"==typeof t},E=function(t){return"number"===T(t)},k=function(t){return"array"===T(t)},I=function(t){return void 0===t},D=function(t,n){var r=this,e=!1;this.name=n,this.getIndexedDB=function(){return t},this.add=function(n){if(e)throw"Database has been closed";for(var o=[],i=0,u=0;u<arguments.length-1;u++)if(f(arguments[u+1]))for(var a=0;a<arguments[u+1].length;a++)o[i]=arguments[u+1][a],i++;else o[i]=arguments[u+1],i++;var l=t.transaction(n,b),v=l.objectStore(n);return new c((function(t,n){s(o).call(o,(function(t){var n;if(t.item&&t.key){var r=t.key;t=t.item,n=v.add(t,r)}else n=v.add(t);n.onsuccess=function(n){var r=n.target,e=r.source.keyPath;null===e&&(e="__id__"),p(t,e,{value:r.result,enumerable:!0})}})),l.oncomplete=function(){t(o,r)},l.onerror=function(t){t.preventDefault(),n(t)},l.onabort=function(t){n(t)}}))},this.updateAndDelete=function(n,r,o){if(e)throw"Database has been closed";var i=t.transaction(n,b),u=i.objectStore(n),a=u.keyPath;return new c((function(t,n){s(r).call(r,(function(t){if(t.item&&t.key){var n=t.key;t=t.item,u.put(t,n)}else u.put(t)})),s(o).call(o,(function(t){u.delete(t[a])})),i.oncomplete=function(){t([r,o])},i.onerror=function(t){n(t)}}))},this.update=function(n){if(e)throw"Database has been closed";for(var o,i=[],u=1;u<arguments.length;u++)f(o=arguments[u])?i=l(i).call(i,o):i.push(o);var a=t.transaction(n,b),p=a.objectStore(n);p.keyPath;return new c((function(t,n){s(i).call(i,(function(t){var n;if(t.item&&t.key){var r=t.key;t=t.item,n=p.put(t,r)}else n=p.put(t);n.onsuccess=function(t){},n.onerror=function(t){}})),a.oncomplete=function(){t(i,r)},a.onerror=function(t){n(t)},a.onabort=function(t){n(t)}}))},this.remove=function(n,r,o,i,u,a,p){if(e)throw"Database has been closed";var l=t.transaction(n,b),v=l.objectStore(n);return new c((function(t,n){function e(t){return null==t}var c;(e(i)&&(i=-1/0),e(u)&&(u=1/0),null===r||f(r)||(r=[r]),e(o))?null!==r?s(r).call(r,(function(t){v.delete(t)})):v.delete(range=g.bound(i,u,a,p)):(c=null!==r?g.only(r[0]):g.bound(i,u,a,p),v.index(o).openCursor(c).onsuccess=function(t){var n=t.target.result;n&&(n.delete(),n.continue())});l.oncomplete=function(){t()},l.onerror=function(t){n(t)},l.onabort=function(t){n(t)}}))},this.clear=function(n){if(e)throw"Database has been closed";var r=t.transaction(n,b);r.objectStore(n).clear();return new c((function(t,n){r.oncomplete=function(){t()},r.onerror=function(t){n(t)}}))},this.close=function(){e||(t.close(),e=!0,delete C[n])},this.get=function(n,r){if(e)throw"Database has been closed";var o=t.transaction(n),i=o.objectStore(n).get(r);return new c((function(t,n){i.onsuccess=function(n){t(n.target.result)},o.onerror=function(t){n(t)}}))},this.query=function(n,r){if(e)throw"Database has been closed";return new L(n,t,r)},this.count=function(n,r){if(e)throw"Database has been closed";t.transaction(n).objectStore(n)};for(var o=0,i=t.objectStoreNames.length;o<i;o++)!function(t){for(var n in r[t]={},r)w.call(r,n)&&"close"!==n&&(r[t][n]=function(n){return function(){var e,o=l(e=[t]).call(e,a([]).call(arguments,0));return r[n].apply(r,o)}}(n))}(t.objectStoreNames[o])},L=function(t,n,r){var e,o=this,u=!1,f=!1,p=function(e,o,a,p,l,d,y){return new c((function(c,h){var m=u||f?b:x,w=n.transaction(t,m),S=w.objectStore(t),j=r?S.index(r):S,O=e?g[e].apply(null,o):null,P=[],T=[O],E=0;l=l||null,d=d||[],"count"!==a&&T.push(p||"next");var k=!!u&&v(u);j[a].apply(j,T).onsuccess=function(t){var n=t.target.result;if(i(n)===i(0))P=n;else if(n)if(null!==l&&l[0]>E)E=l[0],n.advance(l[0]);else if(null!==l&&E>=l[0]+l[1]);else{var r=!0,e="value"in n?n.value:n.key;s(d).call(d,(function(t){t&&t.length&&(2===t.length?r=r&&e[t[0]]===t[1]:A(t[0])&&(r=r&&t[0].apply(void 0,[e])))})),r&&(E++,P.push(y(e)),f?n.delete():u&&(e=function(t){for(var n=0;n<k.length;n++){var r=k[n],e=u[r];e instanceof Function&&(e=e(t)),t[r]=e}return t}(e),n.update(e))),n.continue()}},w.oncomplete=function(){c(P)},w.onerror=function(t){h(t)},w.onabort=function(t){h(t)}}))},l=function(t,n){var r="next",e="openCursor",o=[],i=null,c=P,s=!1,l=function(){return p(t,n,e,s?r+"unique":r,i,o,c)},v=function(){return r=null,e="count",{execute:l}},d=function t(){return 1==(i=k(arguments[0])?arguments[0]:a(Array.prototype).call(arguments,0,2)).length&&i.unshift(0),E(i[1])||(i=null),{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:t,map:w,remove:S}},y=function t(n){return(n=!!I(n)||!!n)&&(e="openKeyCursor"),{execute:l,keys:t,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}},h=function t(){return o.push(a(Array.prototype).call(arguments,0,2)),{execute:l,count:v,keys:y,filter:t,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}},m=function t(n){return n=!!I(n)||!!n,r=n?"next":"prev",{execute:l,count:v,keys:y,filter:h,asc:t,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}},g=function t(n){return n=!!I(n)||!!n,r=n?"prev":"next",{execute:l,count:v,keys:y,filter:h,asc:m,desc:t,distinct:x,modify:b,limit:d,map:w,remove:S}},x=function t(n){return n=!!I(n)||!!n,s=n,{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:t,modify:b,limit:d,map:w,remove:S}},b=function t(n){return u=n,{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:t,limit:d,map:w,remove:S}},w=function t(n){return A(n)&&(c=n),{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:t,remove:S}},S=function t(n){return n=!!I(n)||!!n,f=n,{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:t}};return{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}};s(e="only bound upperBound lowerBound".split(" ")).call(e,(function(t){o[t]=function(){return new l(t,arguments)}})),this.filter=function(){var t=new l(null,null);return d(t).apply(t,arguments)},this.all=function(){var t;return d(t=this).call(t)}},_=function(t,n,r,e){var o=t.target.result,i=new D(o,n);return C[n]=o,c.resolve(i)},C={},M={version:"0.10.2",open:function(t){var n;return new c((function(r,e){var o;C[t.server]?_({target:{result:C[t.server]}},t.server,t.version,t.schema).then(r,e):(j?c.resolve():O&&S().databases?new c((function(t){var n=function(){return S().databases().finally(t)};o=u(n,100),n()})).finally((function(){j=!0,clearInterval(o)})):(j=!0,c.resolve())).then((function(){try{n=S().open(t.server,t.version)}catch(t){e(t)}n.onsuccess=function(n){_(n,t.server,t.version,t.schema).then(r,e)},n.onupgradeneeded=function(n){!function(t,n,r){for(var e in"function"==typeof n&&(n=n()),n){var o,i=n[e];for(var c in o=!w.call(n,e)||r.objectStoreNames.contains(e)?t.currentTarget.transaction.objectStore(e):r.createObjectStore(e,i.key),i.indexes){var u=i.indexes[c];try{o.index(c)}catch(t){o.createIndex(c,u.key||c,v(u).length?u:{unique:!1})}}}}(n,t.schema,n.target.result)},n.onerror=function(t){e(t)}}))}))},remove:function(t){return new c((function(n,r){if(!t)return n();var e,o;i(t)===D&&(t=t.name),"string"==typeof t&&(e=C[t]),e&&"function"==typeof e.close&&e.close();try{o=S().deleteDatabase(t)}catch(t){r(t)}o.onsuccess=function(r){delete C[t],n(t)},o.onerror=function(t){r(t)},o.onblocked=function(t){r(t)}}))}};void 0!==t.exports?t.exports=M:void 0===(o=function(){return M}.call(n,r,n,t))||(t.exports=o)}(void 0)}).call(this,r(77))},function(t,n,r){var e=r(171),o=r(210);function i(n){return t.exports=i="function"==typeof e&&"symbol"==typeof o?function(t){return typeof t}:function(t){return t&&"function"==typeof e&&t.constructor===e&&t!==e.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,i(n)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,r){t.exports=r(172)},function(t,n,r){t.exports=r(173)},function(t,n,r){var e=r(174);r(203),r(204),r(205),r(206),r(207),r(208),r(209),t.exports=e},function(t,n,r){var e=r(175);r(202),t.exports=e},function(t,n,r){var e=r(176);r(54),t.exports=e},function(t,n,r){r(104),r(72),r(178),r(186),r(187),r(188),r(189),r(107),r(190),r(191),r(192),r(193),r(194),r(195),r(196),r(197),r(198),r(199),r(200),r(201);var e=r(13);t.exports=e.Symbol},function(t,n){var r=TypeError;t.exports=function(t){if(t>9007199254740991)throw r("Maximum allowed index exceeded");return t}},function(t,n,r){r(179),r(182),r(183),r(184),r(185)},function(t,n,r){"use strict";var e=r(0),o=r(1),i=r(7),c=r(6),u=r(15),a=r(11),f=r(24),s=r(5),p=r(8),l=r(14),v=r(12),d=r(18),y=r(45),h=r(36),m=r(20),g=r(50),x=r(69),b=r(64),w=r(180),S=r(68),j=r(43),O=r(16),P=r(87),T=r(80),A=r(21),E=r(33),k=r(48),I=r(49),D=r(60),L=r(4),_=r(75),C=r(3),M=r(105),R=r(29),N=r(51),F=r(56).forEach,B=k("hidden"),G=N.set,U=N.getterFor("Symbol"),z=Object.prototype,q=o.Symbol,V=q&&q.prototype,H=o.TypeError,J=o.QObject,K=j.f,W=O.f,Y=w.f,X=T.f,$=c([].push),Q=E("symbols"),Z=E("op-symbols"),tt=E("wks"),nt=!J||!J.prototype||!J.prototype.findChild,rt=a&&s((function(){return 7!=g(W({},"a",{get:function(){return W(this,"a",{value:7}).a}})).a}))?function(t,n,r){var e=K(z,n);e&&delete z[n],W(t,n,r),e&&t!==z&&W(z,n,e)}:W,et=function(t,n){var r=Q[t]=g(V);return G(r,{type:"Symbol",tag:t,description:n}),a||(r.description=n),r},ot=function(t,n,r){t===z&&ot(Z,n,r),v(t);var e=y(n);return v(r),p(Q,e)?(r.enumerable?(p(t,B)&&t[B][e]&&(t[B][e]=!1),r=g(r,{enumerable:m(0,!1)})):(p(t,B)||W(t,B,m(1,{})),t[B][e]=!0),rt(t,e,r)):W(t,e,r)},it=function(t,n){v(t);var r=d(n),e=x(r).concat(ft(r));return F(e,(function(n){a&&!i(ct,r,n)||ot(t,n,r[n])})),t},ct=function(t){var n=y(t),r=i(X,this,n);return!(this===z&&p(Q,n)&&!p(Z,n))&&(!(r||!p(this,n)||!p(Q,n)||p(this,B)&&this[B][n])||r)},ut=function(t,n){var r=d(t),e=y(n);if(r!==z||!p(Q,e)||p(Z,e)){var o=K(r,e);return!o||!p(Q,e)||p(r,B)&&r[B][e]||(o.enumerable=!0),o}},at=function(t){var n=Y(d(t)),r=[];return F(n,(function(t){p(Q,t)||p(I,t)||$(r,t)})),r},ft=function(t){var n=t===z,r=Y(n?Z:d(t)),e=[];return F(r,(function(t){!p(Q,t)||n&&!p(z,t)||$(e,Q[t])})),e};f||(A(V=(q=function(){if(l(V,this))throw H("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?h(arguments[0]):void 0,n=D(t),r=function(t){this===z&&i(r,Z,t),p(this,B)&&p(this[B],n)&&(this[B][n]=!1),rt(this,n,m(1,t))};return a&&nt&&rt(z,n,{configurable:!0,set:r}),et(n,t)}).prototype,"toString",(function(){return U(this).tag})),A(q,"withoutSetter",(function(t){return et(D(t),t)})),T.f=ct,O.f=ot,P.f=it,j.f=ut,b.f=w.f=at,S.f=ft,_.f=function(t){return et(L(t),t)},a&&(W(V,"description",{configurable:!0,get:function(){return U(this).description}}),u||A(z,"propertyIsEnumerable",ct,{unsafe:!0}))),e({global:!0,constructor:!0,wrap:!0,forced:!f,sham:!f},{Symbol:q}),F(x(tt),(function(t){C(t)})),e({target:"Symbol",stat:!0,forced:!f},{useSetter:function(){nt=!0},useSimple:function(){nt=!1}}),e({target:"Object",stat:!0,forced:!f,sham:!a},{create:function(t,n){return void 0===n?g(t):it(g(t),n)},defineProperty:ot,defineProperties:it,getOwnPropertyDescriptor:ut}),e({target:"Object",stat:!0,forced:!f},{getOwnPropertyNames:at}),M(),R(q,"Symbol"),I[B]=!0},function(t,n,r){var e=r(23),o=r(18),i=r(64).f,c=r(181),u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return u&&"Window"==e(t)?function(t){try{return i(t)}catch(t){return c(u)}}(t):i(o(t))}},function(t,n,r){var e=r(65),o=r(26),i=r(74),c=Array,u=Math.max;t.exports=function(t,n,r){for(var a=o(t),f=e(n,a),s=e(void 0===r?a:r,a),p=c(u(s-f,0)),l=0;f<s;f++,l++)i(p,l,t[f]);return p.length=l,p}},function(t,n,r){var e=r(0),o=r(9),i=r(8),c=r(36),u=r(33),a=r(106),f=u("string-to-symbol-registry"),s=u("symbol-to-string-registry");e({target:"Symbol",stat:!0,forced:!a},{for:function(t){var n=c(t);if(i(f,n))return f[n];var r=o("Symbol")(n);return f[n]=r,s[r]=n,r}})},function(t,n,r){var e=r(0),o=r(8),i=r(46),c=r(32),u=r(33),a=r(106),f=u("symbol-to-string-registry");e({target:"Symbol",stat:!0,forced:!a},{keyFor:function(t){if(!i(t))throw TypeError(c(t)+" is not a symbol");if(o(f,t))return f[t]}})},function(t,n,r){var e=r(0),o=r(9),i=r(41),c=r(7),u=r(6),a=r(5),f=r(39),s=r(2),p=r(10),l=r(46),v=r(53),d=r(24),y=o("JSON","stringify"),h=u(/./.exec),m=u("".charAt),g=u("".charCodeAt),x=u("".replace),b=u(1..toString),w=/[\\uD800-\\uDFFF]/g,S=/^[\\uD800-\\uDBFF]$/,j=/^[\\uDC00-\\uDFFF]$/,O=!d||a((function(){var t=o("Symbol")();return"[null]"!=y([t])||"{}"!=y({a:t})||"{}"!=y(Object(t))})),P=a((function(){return'"\\\\udf06\\\\ud834"'!==y("\\udf06\\ud834")||'"\\\\udead"'!==y("\\udead")})),T=function(t,n){var r=v(arguments),e=n;if((p(n)||void 0!==t)&&!l(t))return f(n)||(n=function(t,n){if(s(e)&&(n=c(e,this,t,n)),!l(n))return n}),r[1]=n,i(y,null,r)},A=function(t,n,r){var e=m(r,n-1),o=m(r,n+1);return h(S,t)&&!h(j,o)||h(j,t)&&!h(S,e)?"\\\\u"+b(g(t,0),16):t};y&&e({target:"JSON",stat:!0,arity:3,forced:O||P},{stringify:function(t,n,r){var e=v(arguments),o=i(O?T:y,null,e);return P&&"string"==typeof o?x(o,w,A):o}})},function(t,n,r){var e=r(0),o=r(24),i=r(5),c=r(68),u=r(25);e({target:"Object",stat:!0,forced:!o||i((function(){c.f(1)}))},{getOwnPropertySymbols:function(t){var n=c.f;return n?n(u(t)):[]}})},function(t,n,r){r(3)("asyncIterator")},function(t,n){},function(t,n,r){r(3)("hasInstance")},function(t,n,r){r(3)("isConcatSpreadable")},function(t,n,r){r(3)("match")},function(t,n,r){r(3)("matchAll")},function(t,n,r){r(3)("replace")},function(t,n,r){r(3)("search")},function(t,n,r){r(3)("species")},function(t,n,r){r(3)("split")},function(t,n,r){var e=r(3),o=r(105);e("toPrimitive"),o()},function(t,n,r){var e=r(9),o=r(3),i=r(29);o("toStringTag"),i(e("Symbol"),"Symbol")},function(t,n,r){r(3)("unscopables")},function(t,n,r){var e=r(1);r(29)(e.JSON,"JSON",!0)},function(t,n){},function(t,n){},function(t,n,r){r(3)("dispose")},function(t,n,r){r(3)("asyncDispose")},function(t,n,r){r(3)("matcher")},function(t,n,r){r(3)("metadataKey")},function(t,n,r){r(3)("observable")},function(t,n,r){r(3)("metadata")},function(t,n,r){r(3)("patternMatch")},function(t,n,r){r(3)("replaceAll")},function(t,n,r){t.exports=r(211)},function(t,n,r){t.exports=r(212)},function(t,n,r){var e=r(213);t.exports=e},function(t,n,r){var e=r(214);t.exports=e},function(t,n,r){var e=r(215);r(54),t.exports=e},function(t,n,r){r(71),r(72),r(101),r(107);var e=r(75);t.exports=e.f("iterator")},function(t,n,r){t.exports=r(217)},function(t,n,r){r(218);var e=r(13);t.exports=e.setInterval},function(t,n,r){r(219),r(221)},function(t,n,r){var e=r(0),o=r(1),i=r(108)(o.setInterval,!0);e({global:!0,bind:!0,forced:o.setInterval!==i},{setInterval:i})},function(t,n){t.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},function(t,n,r){var e=r(0),o=r(1),i=r(108)(o.setTimeout,!0);e({global:!0,bind:!0,forced:o.setTimeout!==i},{setTimeout:i})},function(t,n,r){t.exports=r(223)},function(t,n,r){var e=r(224);t.exports=e},function(t,n,r){r(225);var e=r(13);t.exports=e.Array.isArray},function(t,n,r){r(0)({target:"Array",stat:!0},{isArray:r(39)})},function(t,n,r){t.exports=r(227)},function(t,n,r){r(54);var e=r(28),o=r(8),i=r(14),c=r(228),u=Array.prototype,a={DOMTokenList:!0,NodeList:!0};t.exports=function(t){var n=t.forEach;return t===u||i(u,t)&&n===u.forEach||o(a,e(t))?c:n}},function(t,n,r){var e=r(229);t.exports=e},function(t,n,r){r(230);var e=r(40);t.exports=e("Array").forEach},function(t,n,r){"use strict";var e=r(0),o=r(231);e({target:"Array",proto:!0,forced:[].forEach!=o},{forEach:o})},function(t,n,r){"use strict";var e=r(56).forEach,o=r(232)("forEach");t.exports=o?[].forEach:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}},function(t,n,r){"use strict";var e=r(5);t.exports=function(t,n){var r=[][t];return!!r&&e((function(){r.call(null,n||function(){return 1},1)}))}},function(t,n,r){t.exports=r(234)},function(t,n,r){var e=r(235);t.exports=e},function(t,n,r){r(236);var e=r(13).Object,o=t.exports=function(t,n,r){return e.defineProperty(t,n,r)};e.defineProperty.sham&&(o.sham=!0)},function(t,n,r){var e=r(0),o=r(11),i=r(16).f;e({target:"Object",stat:!0,forced:Object.defineProperty!==i,sham:!o},{defineProperty:i})},function(t,n,r){t.exports=r(238)},function(t,n,r){var e=r(239);t.exports=e},function(t,n,r){var e=r(14),o=r(240),i=Array.prototype;t.exports=function(t){var n=t.concat;return t===i||e(i,t)&&n===i.concat?o:n}},function(t,n,r){r(104);var e=r(40);t.exports=e("Array").concat},function(t,n,r){t.exports=r(242)},function(t,n,r){var e=r(243);t.exports=e},function(t,n,r){r(244);var e=r(13);t.exports=e.Object.keys},function(t,n,r){var e=r(0),o=r(25),i=r(69);e({target:"Object",stat:!0,forced:r(5)((function(){i(1)}))},{keys:function(t){return i(o(t))}})},function(t,n,r){t.exports=r(246)},function(t,n,r){var e=r(247);t.exports=e},function(t,n,r){var e=r(14),o=r(248),i=Array.prototype;t.exports=function(t){var n=t.filter;return t===i||e(i,t)&&n===i.filter?o:n}},function(t,n,r){r(249);var e=r(40);t.exports=e("Array").filter},function(t,n,r){"use strict";var e=r(0),o=r(56).filter;e({target:"Array",proto:!0,forced:!r(55)("filter")},{filter:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})}]);`,"Worker",void 0,void 0)}},function(t,r,e){var n=e(3),o=e(15),s=e(8),a=e(303),i={log:{key:{keyPath:"time"},indexes:{level:{unique:!1},time:{unique:!0}}}};function u(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.server=null,this.expire=c.expire||72,this.name=c.name}var d=u.prototype;d.init=function(){var c=this;if(!this.server)return a.open({server:"nim-log-"+this.name,version:1,schema:i}).then(function(m){c.server=m})},d.putLog=function(c){var m=this;if(!this.server)return n.reject("no db server");var v=o(c).call(c,-1)[0].time-36e5*this.expire;return this.deleteLogs(v).then(function(){return m.server.add("log",c)})},d.getAllLogs=function(){return this.server?this.server.query("log","time").all().execute().then(function(c){var m={},v=o(c).call(c,-1)[0];return m.logs=s(c).call(c,function(g){return g.log}).join(`\r
`),m.time=v&&v.time,m}):n.reject("no db server")},d.deleteLogs=function(c){return this.server?this.server.remove("log",null,"time",0,c):n.reject("no db server")},t.exports=u},function(t,r,e){e(252);var n=e(12);t.exports=n.setInterval},function(t,r,e){var n=e(21),o=e(568),s=Function.prototype;t.exports=function(a){var i=a.bind;return a===s||n(s,a)&&i===s.bind?o:i}},function(t,r,e){e(569);var n=e(30);t.exports=n("Function").bind},function(t,r,e){var n=e(1),o=e(273);n({target:"Function",proto:!0,forced:Function.bind!==o},{bind:o})},function(t,r,e){var n=e(18),o=e(25),s=e(2),a=e(23),i=e(5),u=e(54),d=e(185);function c(g){g.onuploading&&this.on("uploading",g.onuploading),d.call(this,g)}var m=d.prototype,v=c.prototype=n(m);v.doSend=function(){var g,b,T,k=this.options,y=k.headers,O=this.xhr=new XMLHttpRequest;if(y["Content-Type"]==="multipart/form-data"){var D,he;delete y["Content-Type"],O.upload.onprogress=o(D=this.onProgress).call(D,this),O.upload.onload=o(he=this.onProgress).call(he,this);var ae,Ne=k.data;k.data=new window.FormData,Ne&&s(ae=u.getKeys(Ne,k.putFileAtEnd)).call(ae,function(_e){var Ce=Ne[_e];Ce.tagName&&Ce.tagName.toUpperCase()==="INPUT"?Ce.type==="file"&&s([]).call(Ce.files,function(ze){k.data.append(u.dataset(Ce,"name")||Ce.name||ze.name||"file-"+u.uniqueID(),ze)}):k.data.append(_e,Ce)})}else if(y["x-nos-token"]){var ue,Y;O.upload.onprogress=o(ue=this.onProgress).call(ue,this),O.upload.onload=o(Y=this.onProgress).call(Y,this)}O.onreadystatechange=o(g=this.onStateChange).call(g,this),k.timeout!==0&&(this.timer=a(o(T=this.onTimeout).call(T,this),k.timeout)),O.open(k.method,k.url,!k.sync),s(b=i(y)).call(b,function(_e){O.setRequestHeader(_e,y[_e])}),k.cookie&&"withCredentials"in O&&(O.withCredentials=!0),O.send(k.data),this.afterSend()},v.onProgress=function(g){g.lengthComputable&&g.loaded<=g.total&&this.emit("uploading",g)},v.onStateChange=function(){var g,b=this.xhr;b.readyState===4&&(g={status:b.status,result:b.responseText||""},this.onLoad(g))},v.getResponseHeader=function(g){var b=this.xhr;return b?b.getResponseHeader(g):""},v.destroy=function(){clearTimeout(this.timer);try{this.xhr.onreadystatechange=u.f,this.xhr.abort()}catch{}m.destroy.call(this)},t.exports=c},function(t,r,e){var n;/*!
 * EventEmitter v5.2.9 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */(function(o){function s(){}var a=s.prototype,i=o.EventEmitter;function u(c,m){for(var v=c.length;v--;)if(c[v].listener===m)return v;return-1}function d(c){return function(){return this[c].apply(this,arguments)}}a.getListeners=function(c){var m,v,g=this._getEvents();if(c instanceof RegExp)for(v in m={},g)g.hasOwnProperty(v)&&c.test(v)&&(m[v]=g[v]);else m=g[c]||(g[c]=[]);return m},a.flattenListeners=function(c){var m,v=[];for(m=0;m<c.length;m+=1)v.push(c[m].listener);return v},a.getListenersAsObject=function(c){var m,v=this.getListeners(c);return v instanceof Array&&((m={})[c]=v),m||v},a.addListener=function(c,m){if(!function T(k){return typeof k=="function"||k instanceof RegExp||!(!k||typeof k!="object")&&T(k.listener)}(m))throw new TypeError("listener must be a function");var v,g=this.getListenersAsObject(c),b=typeof m=="object";for(v in g)g.hasOwnProperty(v)&&u(g[v],m)===-1&&g[v].push(b?m:{listener:m,once:!1});return this},a.on=d("addListener"),a.addOnceListener=function(c,m){return this.addListener(c,{listener:m,once:!0})},a.once=d("addOnceListener"),a.defineEvent=function(c){return this.getListeners(c),this},a.defineEvents=function(c){for(var m=0;m<c.length;m+=1)this.defineEvent(c[m]);return this},a.removeListener=function(c,m){var v,g,b=this.getListenersAsObject(c);for(g in b)b.hasOwnProperty(g)&&(v=u(b[g],m))!==-1&&b[g].splice(v,1);return this},a.off=d("removeListener"),a.addListeners=function(c,m){return this.manipulateListeners(!1,c,m)},a.removeListeners=function(c,m){return this.manipulateListeners(!0,c,m)},a.manipulateListeners=function(c,m,v){var g,b,T=c?this.removeListener:this.addListener,k=c?this.removeListeners:this.addListeners;if(typeof m!="object"||m instanceof RegExp)for(g=v.length;g--;)T.call(this,m,v[g]);else for(g in m)m.hasOwnProperty(g)&&(b=m[g])&&(typeof b=="function"?T.call(this,g,b):k.call(this,g,b));return this},a.removeEvent=function(c){var m,v=typeof c,g=this._getEvents();if(v==="string")delete g[c];else if(c instanceof RegExp)for(m in g)g.hasOwnProperty(m)&&c.test(m)&&delete g[m];else delete this._events;return this},a.removeAllListeners=d("removeEvent"),a.emitEvent=function(c,m){var v,g,b,T,k=this.getListenersAsObject(c);for(T in k)if(k.hasOwnProperty(T))for(v=k[T].slice(0),b=0;b<v.length;b++)(g=v[b]).once===!0&&this.removeListener(c,g.listener),g.listener.apply(this,m||[])===this._getOnceReturnValue()&&this.removeListener(c,g.listener);return this},a.trigger=d("emitEvent"),a.emit=function(c){var m=Array.prototype.slice.call(arguments,1);return this.emitEvent(c,m)},a.setOnceReturnValue=function(c){return this._onceReturnValue=c,this},a._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},a._getEvents=function(){return this._events||(this._events={})},s.noConflict=function(){return o.EventEmitter=i,s},(n=(function(){return s}).call(o,e,o,t))===void 0||(t.exports=n)})(typeof window<"u"?window:this||{})},function(t,r,e){var n=e(18),o=e(6),s=e(2),a=e(25),i=e(87),u=e(54),d=e(185),c=e(274),m="NEJ-UPLOAD-RESULT:",v={};function g(k){this.init(),d.call(this,k)}var b=d.prototype,T=g.prototype=n(b);T.init=function(){var k=!1;function y(O){var D=O.data;if(o(D).call(D,m)===0){var he=(D=JSON.parse(D.replace(m,""))).key,ae=v[he];ae&&(delete v[he],D.result=decodeURIComponent(D.result||""),ae.onLoad(D.result))}}return function(){(function(){if(!k){k=!0;var O=u.getGlobal();O.postMessage?u.on(O,"message",y):(c.addMsgListener(y),c.startTimer())}})()}}(),T.doSend=function(){var k=this,y=k.options,O=k.key="zoro-ajax-upload-iframe-"+u.uniqueID();v[O]=k;var D=k.form=u.html2node('<form style="display:none;"></form>');typeof document>"u"||document.body.appendChild(D),D.target=O,D.method="POST",D.enctype="multipart/form-data",D.encoding="multipart/form-data";var he=y.url,ae=u.genUrlSep(he);D.action=he+ae+"_proxy_=form";var Ne,ue=y.data,Y=[],_e=[];ue&&s(Ne=u.getKeys(ue,y.putFileAtEnd)).call(Ne,function(ie){var le=ue[ie];if(le.tagName&&le.tagName.toUpperCase()==="INPUT"){if(le.type==="file"){var Ie=le,pe=Ie.cloneNode(!0);Ie.parentNode.insertBefore(pe,Ie);var qe=u.dataset(Ie,"name");qe&&(Ie.name=qe),D.appendChild(Ie),u.isFunction(Ie.setAttribute)&&(Ie.setAttribute("form",""),Ie.removeAttribute("form")),Y.push(le),_e.push(pe)}}else{var $e=u.html2node('<input type="hidden"/>');$e.name=ie,$e.value=le,D.appendChild($e)}});function Ce(){s(Y).call(Y,function(ie,le){var Ie=_e[le];Ie.parentNode&&(ie.name=Ie.name,u.isFunction(ie.setAttribute)&&ie.setAttribute("form",Ie.getAttribute("form")),Ie.parentNode.replaceChild(ie,Ie))})}var ze=k.iframe=u.createIframe({name:O,onload:function(){var ie;k.aborted?Ce():(u.on(ze,"load",a(ie=k.checkResult).call(ie,k)),D.submit(),Ce(),k.afterSend())}})},T.checkResult=function(){var k,y;try{var O,D;if(k=this.iframe.contentWindow.document.body,y=i(O=k.innerText||k.textContent||"").call(O),o(y).call(y,m)>=0||o(D=k.innerHTML).call(D,m)>=0)return}catch{return}this.onLoad(y)},T.onLoad=function(k){b.onLoad.call(this,{status:200,result:k}),u.remove(this.form),u.remove(this.iframe),b.destroy.call(this)},T.destroy=function(){u.remove(this.iframe),u.remove(this.form)},T.abort=function(){this.aborted=!0,delete v[this.key],b.abort.call(this)},t.exports=g},function(t,r,e){var n=e(574);t.exports=n},function(t,r,e){var n=e(21),o=e(575),s=String.prototype;t.exports=function(a){var i=a.trim;return typeof a=="string"||a===s||n(s,a)&&i===s.trim?o:i}},function(t,r,e){e(576);var n=e(30);t.exports=n("String").trim},function(t,r,e){var n=e(1),o=e(183).trim;n({target:"String",proto:!0,forced:e(577)("trim")},{trim:function(){return o(this)}})},function(t,r,e){var n=e(226).PROPER,o=e(4),s=e(146);t.exports=function(a){return o(function(){return!!s[a]()||""[a]()!==""||n&&s[a].name!==a})}},function(t,r,e){var n=e(18),o=e(6),s=e(25),a=e(2),i=e(54),u=e(274),d=e(185),c={};function m(b){this.init(),d.call(this,b)}var v=d.prototype,g=m.prototype=n(v);g.init=function(){var b="NEJ-AJAX-DATA:",T=!1;function k(y){var O=y.data;if(o(O).call(O,b)===0){var D=(O=JSON.parse(O.replace(b,""))).key,he=c[D];he&&(delete c[D],O.result=decodeURIComponent(O.result||""),he.onLoad(O))}}return function(){(function(){if(!T){T=!0;var y=i.getGlobal();y.postMessage?i.on(y,"message",k):u.addMsgListener(k)}})()}}(),g.doSend=function(){var b=this.options,T=i.url2origin(b.url),k=b.proxyUrl||T+"/res/nej_proxy_frame.html",y=c[k];if(i.isArray(y)){var O;y.push(s(O=this.doSend).call(O,this,b))}else{var D;if(!y)return c[k]=[s(D=this.doSend).call(D,this,b)],void i.createIframe({src:k,onload:function(Ne){var ue=c[k];c[k]=i.target(Ne).contentWindow,a(ue).call(ue,function(Y){try{Y()}catch{}})}});if(!this.aborted){var he=this.key=i.uniqueID();c[he]=this;var ae=i.fetch({method:"GET",url:"",data:null,headers:{},timeout:0},b);ae.key=he,u.postMessage(y,{data:ae}),this.afterSend()}}},g.abort=function(){this.aborted=!0,delete c[this.key],v.abort.call(this)},t.exports=m},function(t,r,e){var n,o,s=e(10),a=e(54),i=e(116),u=(n=/json/i,o=/post/i,function(d,c){var m=(c=c||{}).data=c.data||{},v=c.headers=c.headers||{},g=a.checkWithDefault(v,"Accept","application/json"),b=a.checkWithDefault(v,"Content-Type","application/json");return n.test(g)&&(c.type="json"),o.test(c.method)&&n.test(b)&&(c.data=s(m)),i(d,c)});t.exports=u},function(t,r,e){var n=e(5),o=e(17),s=e(6),a=e(2),i=e(7),u=e(15),d=e(23);t.exports={wrapSafeCallback:function(c,m){if(c.__wrapSafeCallback__)return c;c.__wrapSafeCallback__=!0;var v=n(c);return v=o(v).call(v,function(g){return s(g).call(g,"on")===0&&Object.prototype.toString.call(c[g])==="[object Function]"}),a(v).call(v,function(g){var b=c[g];c[g]=function(){var T=this;try{var k;return b.call.apply(b,i(k=[this]).call(k,u(Array.prototype).call(arguments)))}catch(O){var y;this.logger.error(i(y="wrapSafeCallback. CallbackName: ".concat(g,". Error: ")).call(y,O)),d(function(){var D;throw T.logger.error(i(D="wrapSafeCallback. throw error in setTimeout. CallbackName: ".concat(g,". Error: ")).call(D,O)),O},0),m.logger&&m.logger.error("userOption:".concat(g," function error"),O)}}}),c}}},function(t,r,e){var n=e(582);t.exports=n},function(t,r,e){e(583);var n=e(12);t.exports=n.Date.now},function(t,r,e){var n=e(1),o=e(11),s=Date,a=o(s.prototype.getTime);n({target:"Date",stat:!0},{now:function(){return a(new s)}})},function(t,r,e){var n=e(73).fn,o=e(24).reportAPI;n.isConnected=function(){return o({instance:this,className:"ApiBaseFn",funcName:"isConnected",hasCallback:!1}),!!this.protocol&&this.protocol.isConnected()},n.connect=function(){o({instance:this,className:"ApiBaseFn",funcName:"connect",hasCallback:!1}),this.protocol.connect()},n.disconnect=function(){}},function(t,r,e){var n=e(26),o=e(10),s=e(25),a=e(8),i=e(41),u=e(15),d=e(139),c=e(87),m=e(6),v=e(52),g=e(23),b=e(9),T=e(32),k=e(2),y=e(7),O=e(5),D=e(59),he=e(17),ae=e(60),Ne=e(61),ue=e(62),Y=e(47),_e=e(58),Ce=e(120),ze=["loc_x","loc_y","loc_z"];function ie(Fe,nr){var ir=O(Fe);if(D){var Ue=D(Fe);nr&&(Ue=he(Ue).call(Ue,function(rr){return ae(Fe,rr).enumerable})),ir.push.apply(ir,Ue)}return ir}function le(Fe){for(var nr=1;nr<arguments.length;nr++){var ir,Ue,rr=arguments[nr]!=null?arguments[nr]:{};nr%2?k(ir=ie(Object(rr),!0)).call(ir,function(or){_e(Fe,or,rr[or])}):Ne?ue(Fe,Ne(rr)):k(Ue=ie(Object(rr))).call(Ue,function(or){Y(Fe,or,ae(rr,or))})}return Fe}var Ie=e(73).fn,pe=e(0),qe=e(604),$e=e(40),Lt=e(13),Dt=e(276),dr=e(277),pr=e(284),sr=e(105).EMExceptionState,hr=e(24).reportAPI;Ie.sendText=function(Fe){(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"sendText",async:!0,done:Fe.done});var nr=Fe,ir=nr.loc_x,Ue=nr.loc_y,rr=nr.loc_z,or=Ce(nr,ze);return ir===void 0||Ue===void 0||rr===void 0?Fe=le({},or):(typeof Fe.loc_x!="number"&&(Fe.loc_x=0),typeof Fe.loc_y!="number"&&(Fe.loc_y=0),typeof Fe.loc_z!="number"&&(Fe.loc_z=0)),this.processCallback(Fe),Fe.msg=new this.message.TextMessage(Fe),this.sendMsg(Fe)},Ie.previewFile=function(Fe,nr){var ir;(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"previewFile",done:Fe.done});var Ue=this,rr=Ue.protocol.appGrayConfig;if(rr&&rr.grayConfig&&rr.grayConfig.mixStoreEnable&&(Fe.mixEnable=!0),pe.verifyOptions(Fe,"done","msg::previewFile"),Fe.type||(Fe.type="file"),pe.verifyParamPresentJustOne(Fe,"dataURL blob fileInput filePath wxFilePath fileObject","msg::previewFile"),pe.exist(Fe.maxSize)&&pe.verifyParamType("maxSize",Fe.maxSize,"number","api::previewFile"),pe.exist(Fe.commonUpload)&&pe.verifyParamType("commonUpload",Fe.commonUpload,"boolean","api::previewFile"),Fe.nosSurvivalTime?(pe.verifyParamType("nosSurvivalTime",Fe.nosSurvivalTime,"number","api::Base.getInstance"),pe.verifyParamMin("nosSurvivalTime",Fe.nosSurvivalTime,86400,"api::Base.getInstance")):Fe.nosSurvivalTime=this.nosSurvivalTime,Fe.filePath=Fe.filePath||Fe.wxFilePath,delete Fe.wxFilePath,Fe.dataURL)Fe.blob=pr.fromDataURL(Fe.dataURL);else if(!Fe.blob){if(Fe.fileInput){if(Fe.fileInput=pe.verifyFileInput(Fe.fileInput,"msg::previewFile"),Fe.fileInput.files){if(!Fe.fileInput.files.length)return void Fe.done($e.newNoFileError(""+Fe.type+"",{callFunc:"msg::previewFile",fileInput:Fe.fileInput}),Fe);Fe.fileSize=Fe.fileInput.files[0].size}Fe.fileInputName=pe.getFileName(Fe.fileInput)}}this.processCallback(Fe);var or=o(Dt.genResponseBody(Fe.type)||{}).replace(/"/gi,'\\"'),Pt=null,Et=Fe.transcode?"getNosTokenTrans":"getNosToken";if(Fe.transcode){pe.verifyOptions(Fe,"fileInput","msg::previewFile");var kt=pe.getFileInfo(Fe.fileInput);Pt={transToken:{name:kt.name,type:kt.transcodeType,transType:Fe.transcode==="png"?11:10,size:kt.size,body:or}}}else Pt=or;this[Et]({responseBody:Pt,nosToken:{nosScene:Fe.nosScene||this.nosScene,nosSurvivalTime:Fe.nosSurvivalTime},callback:s(ir=function(er,cr){if(er)Fe.done(er);else if(Fe.transcode?(Fe.nosToken=cr.nosToken,Fe.docId=cr.docId):Fe.nosToken=cr,Fe.logger=Ue.logger,Fe.mixEnable){var mr,vr;if(!this.protocol.mixStorePolicy)try{this.protocol.mixStorePolicy=JSON.parse(localStorage.getItem("NIM-AllMixStorePolicy"))[this.options.appKey]}catch(Tr){Ue.logger.error("error:","get last mixStorePolicy failed",Tr)}if(!this.protocol.mixStorePolicy)return void Ue.logger.error("error:","get mixStorePolicy failed");Fe.providers=a(mr=this.protocol.mixStorePolicy.providers||[]).call(mr,function(Tr){return Number(Tr)}),Fe.curProvider=Fe.providers[0]?Number(Fe.providers[0]):1,Fe.nosPolicy=this.protocol.mixStorePolicy.nosPolicy,Fe.s3Policy=this.protocol.mixStorePolicy.s3Policy,Ue.getMixStoreToken({curProvider:Fe.curProvider,responseBody:Pt,callback:s(vr=function(Tr,Ir){Tr?Fe.done(Tr):(Fe.mixStoreToken=Ir,Fe.getMixStoreToken=function(kr,Ar){Ue.getMixStoreToken({curProvider:kr,responseBody:Pt,callback:function(Rr,Cn){Rr?Fe.done(Rr):Ar(Cn)}})},Fe.curProvider===1&&(Fe.nosToken=Ir),Ue._doPreviewFile(Fe,nr))}).call(vr,Ue)})}else this._doPreviewFile(Fe,nr)}).call(ir,this)})},Ie._doPreviewFile=function(Fe,nr){var ir=this;Fe=pe.merge(Fe,ir.options.providers);var Ue=Lt.genUploadUrl(Fe.nosToken.bucket);Fe.mixEnable&&Fe.curProvider===1&&(Ue=Lt.genUploadUrl(Fe.mixStoreToken.bucket));var rr,or=Lt.chunkUploadUrl;ir.logger.info("_doPreviewFile: start upload"),Fe.commonUpload||!or||Lt.isWeixinApp||Lt.isNodejs||Lt.isRN?(Fe.commonUpload=!0,rr=Ue):(rr=or,Fe.nosLbsUrls=Lt.nosLbsUrls,ir.options.edgeList?Fe.edgeList=ir.options.edgeList:Fe.updateNosEdgeList=function(cr){ir.options.edgeList=cr}),ir.protocol.reporterHook.emit("reporter/uploadStart");var Pt=this.assembleUploadParams(Fe.nosToken);Fe.mixEnable&&Fe.curProvider===1&&(Pt=this.assembleUploadParams(Fe.mixStoreToken));function Et(cr,mr,vr,Tr){if(cr){var Ir=pe.get(cr,"msg.message")||pe.get(cr,"message")||"Unknown error message",kr=pe.get(cr,"msg.code")||pe.get(cr,"code")||"Unknown error code";ir.logger.warn("_doPreviewFile: upload done, failed ",kr,Ir),ir.protocol.reporterHook.emit("reporter/uploadEnd",cr.code==="RequestAbortedError"||cr.code==="abort"?sr.kCanceled:sr.kFailed);var Ar=i({},Tr||nr,{status:"fail"}),Rr=le(le({},Fe.callback.options),{},{msg:Ar});return Fe.uploaddone&&Fe.uploaddone(cr,Rr,Ar),void Fe.done(cr,Fe.callback.options)}if(ir.logger.info("_doPreviewFile: upload done, success"),ir.protocol.reporterHook.emit("reporter/uploadEnd",sr.kSucceed),Fe.uploaddone&&Fe.uploaddone(null,pe.copy(mr),Tr||nr),mr=Dt.parseResponse(mr,ir.options.exifOrientation),vr||mr.isS3||(mr.url=Lt.genDownloadUrl(Fe.nosToken,Pt.Object,Lt.serverNosConfig.cdnDomain),Fe.nosToken.shortUrl&&(mr._url_safe=Fe.nosToken.shortUrl)),pe.exist(Fe.fileInputName))mr.name=Fe.fileInputName;else if(Fe.blob){var Cn=Fe.blob.name;if(mr.name=Cn||"blob-"+mr.md5,!Cn){var Or=Fe.blob.type;mr.ext=u(Or).call(Or,d(Or).call(Or,"/")+1)}}else Fe.filePath?mr.name=Fe.filePath:Fe.fileObject&&(mr.name=Fe.fileObject.fileName);if(!mr.ext){var Pr,Nr,Qr=d(Pr=mr.name).call(Pr,".");Qr===-1?mr.ext="unknown":mr.ext=u(Nr=mr.name).call(Nr,Qr+1)}mr.size=mr.size||0,mr.isS3&&mr._url_safe?ir.getNosOriginUrl({safeShortUrl:mr._url_safe,done:function(hn,Ur){hn?ir.logger.error("error:","getNosOriginUrl failed",hn):(mr.url=Ur,Fe.done(null,pe.copy(mr)))}}):Fe.done(null,pe.copy(mr))}if(Lt.isWeixinApp)pe.verifyOptions(Fe,"filePath","msg::_doPreviewFile"),ir.fileQuickTransfer(Fe,Et,function(){var cr=wx.uploadFile({url:rr,filePath:Fe.filePath,name:"file",formData:Pt,fail:function(mr){Et({code:"FAILED",msg:mr}),ir.logger.error("error:","api::msg:upload file failed",mr)},success:function(mr){if(mr.statusCode===200)try{Et(null,JSON.parse(mr.data))}catch(vr){ir.logger.error("error:","parse wx upload file res error",vr),Et({code:"PARSE_WX_UPLOAD_FILE_RES_ERROR",str:mr.data,msg:mr.errMsg})}else Et({code:mr.statusCode,msg:mr.errMsg})}});typeof Fe.uploadprogress=="function"&&cr&&(Fe.beginupload(cr,nr),ir.logger.info("_doPreviewFile::mini uploadprogress"),cr.onProgressUpdate(function(mr){Fe.uploadprogress({total:mr.totalBytesExpectedToSend,loaded:mr.totalBytesSent,percentage:mr.progress,percentageText:mr.progress+"%"},nr)}))});else if(Lt.isNodejs){var kt={url:rr,name:"file",formData:Pt,success:function(cr){if(cr.statusCode===200)try{Et(null,JSON.parse(cr.data))}catch(mr){ir.protocol.logger.error("error:","parse nodejs upload file res error",mr),Et({code:"PARSE_NODEJS_UPLOAD_FILE_RES_ERROR",str:cr.data,msg:cr.errMsg})}else Et({code:cr.statusCode,msg:cr.errMsg})},fail:function(cr){Et({code:"FAILED",msg:cr}),ir.protocol.logger.error("error:","api::msg:upload file failed",cr)}};if(Fe.filePath)kt.filePath=Fe.filePath;else{if(n(Fe.fileObject)!=="object")throw new $e("NodejsfileObject {fileName:..,fileData:..} ");kt.fileData=Fe.fileObject.fileData}ir.fileQuickTransfer(Fe,Et,function(){dr.uploadFile(kt)})}else if(Lt.isRN){var er={url:rr,name:"file",formData:Pt,filePath:Fe.filePath,success:function(cr){if(cr.ok&&cr.status===200)try{var mr=a(cr.headers)&&a(cr.headers).etag;cr.md5=mr?typeof mr=="string"?mr:mr[0]:"UNKNOWN",Et(null,cr)}catch(vr){ir.protocol.logger.error("error:","parse React Native upload file res error",vr),Et({code:"PARSE_React_Native_UPLOAD_FILE_RES_ERROR",res:cr})}else Et({code:cr.status,msg:cr.statusText})},fail:function(cr){Et({code:"FAILED",msg:cr}),ir.protocol.logger.error("error:","api::msg:upload file failed",cr)}};ir.fileQuickTransfer(Fe,Et,function(){dr.uploadFile(er)})}else Fe.url=rr,Fe.params=Pt,Fe.fileName="file",ir.fileQuickTransfer(Fe,Et,function(){return ir.protocol.adaptersUploadFile(i({},Fe,{uploaddone:Et}),nr)})},Ie.fileQuickTransfer=function(Fe,nr,ir){var Ue,rr=this;Fe=Fe||{},nr instanceof Function||(nr=function(){}),ir instanceof Function||(ir=function(){});var or=Fe.fastPass;if(or)try{or=JSON.parse(or),Fe.fastPass=or}catch{rr.protocol.logger.error("")}var Pt=Fe.fileInputName||Fe.name||Fe.blob&&Fe.blob.name||"",Et=Fe.fileSize||Fe.size||Fe.blob&&Fe.blob.size||0,kt=or?c(Ue=(or.md5||Fe.digest||"")+"").call(Ue):"",er=Fe.type||Fe.blob&&Fe.blob.type;if(kt&&Et>=Lt.threshold){var cr=!0,mr={name:Pt,md5:kt,ext:u(Pt).call(Pt,d(Pt).call(Pt,".")+1),type:er};switch(er){case"image":or&&or.w&&or.h?(mr.w=or.w,mr.h=or.h):(cr=!1,rr.protocol.logger.error(" image  w  h"));break;case"video":or&&or.w&&or.h&&or.dur?(mr.w=or.w,mr.h=or.h,mr.dur=or.dur):(cr=!1,rr.protocol.logger.error(" video  w  h  dur"));break;case"audio":or&&or.dur?mr.dur=or.dur:(cr=!1,rr.protocol.logger.error(" audio  dur"))}if(!cr)return void ir();var vr={fileQuickTransfer:{md5:kt}};return Et&&(vr.fileQuickTransfer.size=Et),this.protocol.sendCmd("fileQuickTransfer",vr,function(Tr,Ir,kr){!Tr&&kr&&kr.fileQuickTransfer&&kr.fileQuickTransfer.url||(rr.protocol.logger.error("misc::fileQuickTransfer: not found",Tr,Ir),ir()),kr&&kr.fileQuickTransfer&&kr.fileQuickTransfer.threshold&&(Lt.threshold=kr.fileQuickTransfer.threshold||0),kr&&kr.fileQuickTransfer&&kr.fileQuickTransfer.url&&(mr.size=Et||kr.fileQuickTransfer.size,mr.url=kr.fileQuickTransfer.url,kr.fileQuickTransfer._url_safe&&(mr._url_safe=kr.fileQuickTransfer._url_safe),nr(Tr,mr,!0))})}ir()},Ie.sendFile=function(Fe){if((Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"sendFile",done:Fe.done}),Fe.type||(Fe.type="file"),Fe=pe.merge(Fe,this.options.providers),pe.verifyParamPresentJustOne(Fe,"dataURL blob fileInput file filePath wxFilePath fileObject","msg::sendFile"),pe.exist(Fe.maxSize)&&pe.verifyParamType("maxSize",Fe.maxSize,"number","api::previewFile"),pe.exist(Fe.commonUpload)&&pe.verifyParamType("commonUpload",Fe.commonUpload,"boolean","api::previewFile"),this.processCallback(Fe),Fe.filePath=Fe.filePath||Fe.wxFilePath,delete Fe.wxFilePath,Fe.dataURL)return this._previewAndSendFile(Fe);if(Fe.blob)return this._previewAndSendFile(Fe);if(Fe.fileInput)return Fe.fileInput=pe.verifyFileInput(Fe.fileInput,"msg::sendFile"),Fe.fileInput.files&&!Fe.fileInput.files.length?void Fe.done($e.newNoFileError(""+Fe.type+"",{callFunc:"msg::sendFile",fileInput:Fe.fileInput}),Fe.callback.options):this._previewAndSendFile(Fe);if(Fe.filePath||Fe.fileObject)return this._previewAndSendFile(Fe);if(Fe.file){var nr,ir=Fe.file._url_safe;return ir&&(nr=Fe.file.url,Fe.file.url=ir,delete Fe.file._url_safe),Fe.msg=new this.message.FileMessage(Fe),this.sendMsg(Fe,nr)}},Ie._previewAndSendFile=function(Fe){var nr=this;pe.verifyCallback(Fe,"uploaddone beforesend","msg::_previewAndSendFile");var ir=le({},Fe),Ue=new nr.message.Message(ir);Ue.type=Fe.type;var rr=nr.formatReturnMsg(Ue),or=nr.protocol.reporterHook.getSafeClock(),Pt={apiCallingTime:nr.protocol.reporterHook.getNTPTime(or),attachUploadDuration:0},Et=Fe.done;return Fe.done=function(kt,er){if(Fe.done=Et,kt){var cr=i({},rr,{status:"fail"}),mr=le(le({},Fe.callback.options),{},{msg:cr});Fe.done(kt,mr)}else{if(Pt.attachUploadDuration=nr.protocol.reporterHook.getSafeClock()-or,/chatroom/.test(Fe.scene))return;var vr,Tr=er._url_safe;Tr&&!er.isS3&&(vr=er.url,er.url=Tr,delete er._url_safe),Fe.file=er,Fe.msg=new nr.message.FileMessage(Fe,Ue.idClient),Fe.beforesend(nr.sendMsg(Fe,vr,Pt))}},nr.previewFile(Fe,rr),rr},Ie.assembleUploadParams=function(Fe){return Fe?{Object:decodeURIComponent(Fe.objectName),"x-nos-token":Fe.token,"x-nos-entity-type":"json"}:null},Ie.deleteFile=function(Fe){hr({instance:this,className:"ApiBaseFn",funcName:"deleteFile",hasCallback:!1}),pe.verifyParamPresentJustOne(Fe,"docId","msg::deleteFile"),this.removeFile({docId:Fe.docId,callback:function(nr,ir){nr?Fe.error&&Fe.error(nr,ir):Fe.success&&Fe.success(ir)}})},Ie.getFile=function(Fe){hr({instance:this,className:"ApiBaseFn",funcName:"getFile",hasCallback:!1}),pe.verifyParamPresentJustOne(Fe,"docId","msg::getFile"),this.fetchFile({docId:Fe.docId,callback:function(nr,ir){nr?Fe.error&&Fe.error(nr,ir):Fe.success&&Fe.success(ir.info)}})},Ie.getFileList=function(Fe){hr({instance:this,className:"ApiBaseFn",funcName:"getFileList",hasCallback:!1});var nr=Fe.fromDocId,ir=nr===void 0?"":nr,Ue=Fe.limit,rr=Ue===void 0?10:Ue,or={limit:rr};ir&&(or.fromDocId=ir),this.fetchFileList({fileListParam:or,callback:function(Pt,Et){Pt?(rr>30&&(Pt.message=Pt.message+":::30"),Fe.error&&Fe.error(Pt,Et)):Fe.success&&Fe.success(Et)}})},Ie.sendGeo=function(Fe){return(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"sendGeo",done:Fe.done}),this.processCallback(Fe),Fe.msg=new this.message.GeoMessage(Fe),this.sendMsg(Fe)},Ie.sendTipMsg=function(Fe){return(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"sendTipMsg",done:Fe.done}),this.processCallback(Fe),Fe.msg=new this.message.TipMessage(Fe),this.sendMsg(Fe)},Ie.sendCustomMsg=function(Fe){return(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"sendCustomMsg",done:Fe.done}),this.processCallback(Fe),Fe.msg=new this.message.CustomMessage(Fe),this.sendMsg(Fe)},Ie.sendRobotMsg=function(Fe){return(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"sendRobotMsg",done:Fe.done}),this.logger.warn("this api will be abandon"),this.processCallback(Fe),Fe.msg=new this.message.RobotMessage(Fe),this.sendMsg(Fe)},Ie.sendMsg=function(Fe,nr,ir){var Ue=this,rr=Ue.protocol,or=Fe.msg,Pt={};ir=ir||{apiCallingTime:rr.reporterHook.getNTPTime(),attachUploadDuration:0};var Et,kt=!!Fe.isLocal;if(this.logger.warn("sendMsg::start: "+or.idClient),kt&&(Fe.time&&(or.time=Fe.time),Fe.idClient&&(or.idClient=Fe.idClient),Fe.localFrom&&(Et=Fe.localFrom+"")),Fe.resend&&(Fe.flow!=="out"||Fe.status!=="fail"))return pe.onError("");Fe.callback.options.idClient=or.idClient,Ue.beforeSendMsg(Fe,Pt);var er=Fe.rtnMsg=Ue.formatReturnMsg(or,Et);if(nr&&!Ue.options.keepNosSafeUrl&&er.file&&(er.file._url_safe=er.file.url,er.file.url=nr,er.type==="audio"&&(er.file.mp3Url=nr+(~m(nr).call(nr,"?")?"&":"?")+"audioTrans&type=mp3")),er.hasOwnProperty("chatroomId")&&!er.chatroomId)return pe.onError("");if(kt&&(er.status="success",er.isLocal=!0),rr.storeSendMsg&&(Pt.promise=rr.storeSendMsg(er)),Fe.cbaop=function(mr,vr){if(mr)return mr.code===7101&&(er.isInBlackList=!0,er.idServer=vr.idServer,er.time=vr.time),mr.from!=="server"?(er.status="fail",rr.updateSendMsgError&&rr.updateSendMsgError(er),er):void 0},!kt){nr&&!Ue.options.keepNosSafeUrl&&Fe.callback&&(Fe.callback.originUrl=nr),Fe.toAccids&&Fe.toAccids.length&&(or.toAccids=o(Fe.toAccids)),Pt.msg=or,ir.sendTime=rr.reporterHook.getNTPTime(),rr.reporterHook.hasOriginTimetick()&&(Pt.msg.__clientExt=o({statistics:ir}));var cr=or;Ue.sendCmd(Fe.cmd,Pt,function(){if(Lt.isBrowser){var mr=arguments[0],vr=arguments[1]||{},Tr=Ue.subType==="chatroom",Ir=cr.scene===0,kr=rr.reporterHook.getNTPTime(),Ar={msgId:vr.idServer,clientId:cr.idClient,msgTime:vr.time||0,fromAccid:Ue.account,toAccid:Ir?cr.to:"",type:Tr?4:cr.scene,roomId:Tr?Ue.options.chatroomId:"",tid:Tr||Ir?"":cr.to,result:mr?mr.code:200,failReason:mr?mr.message:"",rt:v(kr-ir.apiCallingTime),apiCallingTime:ir.apiCallingTime,sendTime:ir.sendTime,attachUploadDuration:ir.attachUploadDuration,apiCallbackTime:kr};Ue.reporter&&Ue.reporter.report("msgSend",Ar)}Fe.callback&&Fe.callback.apply(Ue,arguments);var Rr=arguments[0],Cn=arguments[1];!Rr&&Cn&&Cn.from===Cn.to&&Ue.protocol.markMsgRead(Cn)})}return Ue.afterSendMsg(Fe),kt&&g(function(){er=pe.simpleClone(er),Fe.done(null,er)},0),pe.copy(er)},Ie.beforeSendMsg=function(){},Ie.afterSendMsg=function(){},Ie.formatReturnMsg=function(Fe,nr){var ir;return Fe=pe.copy(Fe),this.protocol.completeMsg(Fe),Fe.status="sending",nr&&(Fe.from=nr),Fe=b(ir=this.message).call(ir,Fe),Fe=this.protocol.amendMsg(Fe)},Ie.resendMsg=function(Fe){return(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"resendMsg",done:Fe.done}),pe.verifyOptions(Fe,"msg","msg::resendMsg"),this.trimMsgFlag(Fe),Fe.resend=!0,this._sendMsgByType(Fe)},Ie.forwardMsg=function(Fe){return(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"forwardMsg",done:Fe.done}),pe.verifyOptions(Fe,"msg","msg::forwardMsg"),this.trimMsgFlag(Fe),this.beforeForwardMsg(Fe),Fe.forward=!0,Fe.msg.idClient=pe.guid(),this._sendMsgByType(Fe)},Ie.trimMsgFlag=function(Fe){Fe&&Fe.msg&&(Fe.msg=pe.copy(Fe.msg),delete Fe.msg.resend,delete Fe.msg.forward)},Ie.beforeForwardMsg=function(){},Ie._sendMsgByType=function(Fe){switch(pe.verifyOptions(Fe,"msg","msg::_sendMsgByType"),pe.verifyParamValid("msg.type",Fe.msg.type,this.message.validTypes,"msg::_sendMsgByType"),pe.merge(Fe,Fe.msg),Fe.type){case"text":return this.sendText(Fe);case"image":case"audio":case"video":case"file":return this.sendFile(Fe);case"geo":return this.sendGeo(Fe);case"custom":return this.sendCustomMsg(Fe);case"tip":return this.sendTipMsg(Fe);default:throw new $e(" "+Fe.type+" ")}},Ie.parseRobotTemplate=function(Fe){if(this.logger.warn("this api will be abandon"),/<template[^>/]+\/>/.test(Fe))return{raw:Fe,json:[{type:"text",name:"",text:""}]};if(!/<template[^>/]+>/.test(Fe))return{raw:Fe,json:[{type:"text",name:"",text:Fe}]};var nr=new qe({escapeMode:!1});Fe=Fe.replace(/<template [^>]+>/,"<template>");var ir=nr.xml2js(Fe);ir=ir.template.LinearLayout,T(ir)||(ir=[ir]);var Ue=[];return ir=k(ir).call(ir,function(Pt){Pt.image&&(Ue=y(Ue).call(Ue,or(Pt))),Pt.text&&(Ue=y(Ue).call(Ue,rr(Pt))),Pt.link&&(Ue=y(Ue).call(Ue,function(Et){if(Et.link){var kt=Et.link;T(kt)||(kt=[kt]),kt=a(kt).call(kt,function(er){return er.image&&(er.image=or(er)),er.text&&(er.text=rr(er)),er._type==="url"?(er.type="url",er.style=er._style||"",er.target=er._target,delete er._target,delete er._style):er._type==="block"&&(er.type="block",er.style=er._style||"",er.params=er._params||"",er.target=er._target,delete er._params,delete er._target,delete er._style),delete er._type,er}),Et.link=kt}return Et.link}(Pt)))}),{raw:Fe,json:Ue};function rr(Pt){var Et;return T(Pt.text)||(Pt.text=[Pt.text]),Pt.text=a(Et=Pt.text).call(Et,function(kt){return{type:"text",name:kt._name,text:kt.__text}}),Pt.text}function or(Pt){var Et;return T(Pt.image)||(Pt.image=[Pt.image]),Pt.image=a(Et=Pt.image).call(Et,function(kt){return{type:"image",name:kt._name,url:kt._url}}),Pt.image}}},function(t,r,e){e(587);var n=e(12);t.exports=n.Object.assign},function(t,r,e){var n=e(1),o=e(588);n({target:"Object",stat:!0,arity:2,forced:Object.assign!==o},{assign:o})},function(t,r,e){var n=e(27),o=e(11),s=e(19),a=e(4),i=e(118),u=e(132),d=e(148),c=e(42),m=e(124),v=Object.assign,g=Object.defineProperty,b=o([].concat);t.exports=!v||a(function(){if(n&&v({b:1},v(g({},"a",{enumerable:!0,get:function(){g(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var T={},k={},y=Symbol();return T[y]=7,"abcdefghijklmnopqrst".split("").forEach(function(O){k[O]=O}),v({},T)[y]!=7||i(v({},k)).join("")!="abcdefghijklmnopqrst"})?function(T,k){for(var y=c(T),O=arguments.length,D=1,he=u.f,ae=d.f;O>D;)for(var Ne,ue=m(arguments[D++]),Y=he?b(i(ue),he(ue)):i(ue),_e=Y.length,Ce=0;_e>Ce;)Ne=Y[Ce++],n&&!s(ae,ue,Ne)||(y[Ne]=ue[Ne]);return y}:v},function(t,r,e){var n=e(21),o=e(590),s=Array.prototype;t.exports=function(a){var i=a.reverse;return a===s||n(s,a)&&i===s.reverse?o:i}},function(t,r,e){e(591);var n=e(30);t.exports=n("Array").reverse},function(t,r,e){var n=e(1),o=e(11),s=e(79),a=o([].reverse),i=[1,2];n({target:"Array",proto:!0,forced:String(i)===String(i.reverse())},{reverse:function(){return s(this)&&(this.length=this.length),a(this)}})},function(t,r,e){t.exports=e(593)},function(t,r,e){t.exports=e(594)},function(t,r,e){var n=e(595);t.exports=n},function(t,r,e){var n=e(254);t.exports=n},function(t,r,e){t.exports=e(597)},function(t,r,e){var n=e(598);t.exports=n},function(t,r,e){var n=e(206);t.exports=n},function(t,r,e){var n=e(600),o=e(186);t.exports=function(s,a){if(s==null)return{};var i,u,d={},c=n(s);for(u=0;u<c.length;u++)i=c[u],o(a).call(a,i)>=0||(d[i]=s[i]);return d},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(601)},function(t,r,e){t.exports=e(602)},function(t,r,e){var n=e(603);t.exports=n},function(t,r,e){var n=e(230);t.exports=n},function(t,r,e){var n,o,s;(function(a,i){o=[],(s=typeof(n=function(u){return function(d){(d=d||{}).arrayAccessForm=d.arrayAccessForm||"none",d.emptyNodeForm=d.emptyNodeForm||"text",d.jsAttributeFilter=d.jsAttributeFilter,d.jsAttributeConverter=d.jsAttributeConverter,d.attributeConverters=d.attributeConverters||[],d.datetimeAccessFormPaths=d.datetimeAccessFormPaths||[],d.arrayAccessFormPaths=d.arrayAccessFormPaths||[],d.xmldomOptions=d.xmldomOptions||{},d.enableToStringFunc===void 0&&(d.enableToStringFunc=!0),d.skipEmptyTextNodesForObj===void 0&&(d.skipEmptyTextNodesForObj=!0),d.stripWhitespaces===void 0&&(d.stripWhitespaces=!0),d.useDoubleQuotes===void 0&&(d.useDoubleQuotes=!0),d.ignoreRoot===void 0&&(d.ignoreRoot=!1),d.escapeMode===void 0&&(d.escapeMode=!0),d.attributePrefix===void 0&&(d.attributePrefix="_"),d.selfClosingElements===void 0&&(d.selfClosingElements=!0),d.keepCData===void 0&&(d.keepCData=!1),d.keepText===void 0&&(d.keepText=!1),d.jsDateUTC===void 0&&(d.jsDateUTC=!1),function(){function Ie(pe){var qe=String(pe);return qe.length===1&&(qe="0"+qe),qe}typeof String.prototype.trim!="function"&&(String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")}),typeof Date.prototype.toISOString!="function"&&(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+Ie(this.getUTCMonth()+1)+"-"+Ie(this.getUTCDate())+"T"+Ie(this.getUTCHours())+":"+Ie(this.getUTCMinutes())+":"+Ie(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"})}();var c=1,m=3,v=4,g=8,b=9;function T(Ie){var pe=Ie.localName;return pe==null&&(pe=Ie.baseName),pe!=null&&pe!==""||(pe=Ie.nodeName),pe}function k(Ie){return typeof Ie=="string"?Ie.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"):Ie}function y(Ie,pe,qe){switch(d.arrayAccessForm){case"property":Ie[pe]instanceof Array?Ie[pe+"_asArray"]=Ie[pe]:Ie[pe+"_asArray"]=[Ie[pe]]}if(!(Ie[pe]instanceof Array)&&d.arrayAccessFormPaths.length>0){for(var $e=!1,Lt=0;Lt<d.arrayAccessFormPaths.length;Lt++){var Dt=d.arrayAccessFormPaths[Lt];if(typeof Dt=="string"){if(Dt===qe){$e=!0;break}}else if(Dt instanceof RegExp){if(Dt.test(qe)){$e=!0;break}}else if(typeof Dt=="function"&&Dt(pe,qe)){$e=!0;break}}$e&&(Ie[pe]=[Ie[pe]])}}function O(Ie){var pe=Ie.split(/[-T:+Z]/g),qe=new Date(pe[0],pe[1]-1,pe[2]),$e=pe[5].split(".");if(qe.setHours(pe[3],pe[4],$e[0]),$e.length>1&&qe.setMilliseconds($e[1]),pe[6]&&pe[7]){var Lt=60*pe[6]+Number(pe[7]);Lt=0+((/\d\d-\d\d:\d\d$/.test(Ie)?"-":"+")=="-"?-1*Lt:Lt),qe.setMinutes(qe.getMinutes()-Lt-qe.getTimezoneOffset())}else Ie.indexOf("Z",Ie.length-1)!==-1&&(qe=new Date(Date.UTC(qe.getFullYear(),qe.getMonth(),qe.getDate(),qe.getHours(),qe.getMinutes(),qe.getSeconds(),qe.getMilliseconds())));return qe}function D(Ie,pe){for(var qe={__cnt:0},$e=Ie.childNodes,Lt=0;Lt<$e.length;Lt++){var Dt=$e.item(Lt),dr=T(Dt);Dt.nodeType!==g&&(qe.__cnt++,qe[dr]==null?(qe[dr]=he(Dt,pe+"."+dr),y(qe,dr,pe+"."+dr)):(qe[dr]instanceof Array||(qe[dr]=[qe[dr]],y(qe,dr,pe+"."+dr)),qe[dr][qe[dr].length]=he(Dt,pe+"."+dr)))}for(var pr=0;pr<Ie.attributes.length;pr++){var sr=Ie.attributes.item(pr);qe.__cnt++;for(var hr=sr.value,Fe=0;Fe<d.attributeConverters.length;Fe++){var nr=d.attributeConverters[Fe];nr.test.call(null,sr.name,sr.value)&&(hr=nr.convert.call(null,sr.name,sr.value))}qe[d.attributePrefix+sr.name]=hr}var ir=Ie.prefix;return ir&&(qe.__cnt++,qe.__prefix=ir),qe["#text"]&&(qe.__text=qe["#text"],qe.__text instanceof Array&&(qe.__text=qe.__text.join(`
`)),d.escapeMode&&(qe.__text=qe.__text.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&amp;/g,"&")),d.stripWhitespaces&&(qe.__text=qe.__text.trim()),delete qe["#text"],d.arrayAccessForm==="property"&&delete qe["#text_asArray"],qe.__text=function(Ue,rr,or){if(d.datetimeAccessFormPaths.length>0)for(var Pt=or.split(".#")[0],Et=0;Et<d.datetimeAccessFormPaths.length;Et++){var kt=d.datetimeAccessFormPaths[Et];if(typeof kt=="string"){if(kt===Pt)return O(Ue)}else if(kt instanceof RegExp){if(kt.test(Pt))return O(Ue)}else if(typeof kt=="function"&&kt(Pt))return O(Ue)}return Ue}(qe.__text,0,pe+".#text")),qe.hasOwnProperty("#cdata-section")&&(qe.__cdata=qe["#cdata-section"],delete qe["#cdata-section"],d.arrayAccessForm==="property"&&delete qe["#cdata-section_asArray"]),qe.__cnt===1&&qe.__text&&!d.keepText?qe=qe.__text:qe.__cnt===0&&d.emptyNodeForm==="text"?qe="":qe.__cnt>1&&qe.__text!==void 0&&d.skipEmptyTextNodesForObj&&(d.stripWhitespaces&&qe.__text===""||qe.__text.trim()==="")&&delete qe.__text,delete qe.__cnt,d.keepCData||qe.hasOwnProperty("__text")||!qe.hasOwnProperty("__cdata")||Object.keys(qe).length!==1?(d.enableToStringFunc&&(qe.__text||qe.__cdata)&&(qe.toString=function(){return(this.__text?this.__text:"")+(this.__cdata?this.__cdata:"")}),qe):qe.__cdata?qe.__cdata:""}function he(Ie,pe){return Ie.nodeType===b?function(qe){for(var $e={},Lt=qe.childNodes,Dt=0;Dt<Lt.length;Dt++){var dr=Lt.item(Dt);if(dr.nodeType===c){var pr=T(dr);d.ignoreRoot?$e=he(dr,pr):$e[pr]=he(dr,pr)}}return $e}(Ie):Ie.nodeType===c?D(Ie,pe):Ie.nodeType===m||Ie.nodeType===v?Ie.nodeValue:null}function ae(Ie,pe,qe,$e){var Lt="<"+(Ie&&Ie.__prefix?Ie.__prefix+":":"")+pe;if(qe)for(var Dt=0;Dt<qe.length;Dt++){var dr=qe[Dt],pr=Ie[dr];d.escapeMode&&(pr=k(pr)),Lt+=" "+dr.substr(d.attributePrefix.length)+"=",d.useDoubleQuotes?Lt+='"'+pr+'"':Lt+="'"+pr+"'"}return Lt+=$e?" />":">"}function Ne(Ie,pe){return"</"+(Ie&&Ie.__prefix?Ie.__prefix+":":"")+pe+">"}function ue(Ie,pe){return d.arrayAccessForm==="property"&&(qe=pe.toString(),$e="_asArray",qe.indexOf($e,qe.length-$e.length)!==-1)||pe.toString().indexOf(d.attributePrefix)===0||pe.toString().indexOf("__")===0||Ie[pe]instanceof Function;var qe,$e}function Y(Ie){var pe=0;if(Ie instanceof Object)for(var qe in Ie)ue(Ie,qe)||pe++;return pe}function _e(Ie){var pe=[];if(Ie instanceof Object)for(var qe in Ie)qe.toString().indexOf("__")===-1&&qe.toString().indexOf(d.attributePrefix)===0&&pe.push(qe);return pe}function Ce(Ie){var pe="";return Ie instanceof Object?pe+=function(qe){var $e="";return qe.__cdata&&($e+="<![CDATA["+qe.__cdata+"]]>"),(qe.__text||typeof qe.__text=="number"||typeof qe.__text=="boolean")&&(d.escapeMode?$e+=k(qe.__text):$e+=qe.__text),$e}(Ie):Ie!==null&&(d.escapeMode?pe+=k(Ie):pe+=Ie),pe}function ze(Ie,pe,qe){var $e="";return d.jsAttributeFilter&&d.jsAttributeFilter.call(null,pe,Ie)||(d.jsAttributeConverter&&(Ie=d.jsAttributeConverter.call(null,pe,Ie)),Ie!=null&&Ie!==""||!d.selfClosingElements?typeof Ie=="object"?Object.prototype.toString.call(Ie)==="[object Array]"?$e+=function(Lt,Dt,dr){var pr="";if(Lt.length===0)pr+=ae(Lt,Dt,dr,!0);else for(var sr=0;sr<Lt.length;sr++)pr+=ze(Lt[sr],Dt,_e(Lt[sr]));return pr}(Ie,pe,qe):Ie instanceof Date?($e+=ae(Ie,pe,qe,!1),$e+=d.jsDateUTC?Ie.toUTCString():Ie.toISOString(),$e+=Ne(Ie,pe)):Y(Ie)>0||typeof Ie.__text=="number"||typeof Ie.__text=="boolean"||Ie.__text||Ie.__cdata?($e+=ae(Ie,pe,qe,!1),$e+=ie(Ie),$e+=Ne(Ie,pe)):d.selfClosingElements?$e+=ae(Ie,pe,qe,!0):($e+=ae(Ie,pe,qe,!1),$e+=Ne(Ie,pe)):($e+=ae(Ie,pe,qe,!1),$e+=Ce(Ie),$e+=Ne(Ie,pe)):$e+=ae(Ie,pe,qe,!0)),$e}function ie(Ie){var pe="";if(Y(Ie)>0){for(var qe in Ie)if(!ue(Ie,qe)){var $e=Ie[qe];pe+=ze($e,qe,_e($e))}}return pe+=Ce(Ie)}function le(Ie){if(Ie===void 0||typeof Ie!="string")return null;var pe=null,qe=null;if(u)qe=(pe=new u(d.xmldomOptions)).parseFromString(Ie,"text/xml");else if(window&&window.DOMParser){pe=new window.DOMParser;var $e=null;if(!(window.ActiveXObject||"ActiveXObject"in window)&&document.all&&!document.addEventListener)try{$e=pe.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI}catch{$e=null}try{qe=pe.parseFromString(Ie,"text/xml"),$e!==null&&qe.getElementsByTagNameNS($e,"parsererror").length>0&&(qe=null)}catch{qe=null}}else Ie.indexOf("<?")===0&&(Ie=Ie.substr(Ie.indexOf("?>")+2)),(qe=new ActiveXObject("Microsoft.XMLDOM")).async="false",qe.loadXML(Ie);return qe}this.asArray=function(Ie){return Ie==null?[]:Ie instanceof Array?Ie:[Ie]},this.toXmlDateTime=function(Ie){return Ie instanceof Date?Ie.toISOString():typeof Ie=="number"?new Date(Ie).toISOString():null},this.asDateTime=function(Ie){return typeof Ie=="string"?O(Ie):Ie},this.xml2dom=function(Ie){return le(Ie)},this.dom2js=function(Ie){return he(Ie,null)},this.js2dom=function(Ie){return le(this.js2xml(Ie))},this.xml2js=function(Ie){var pe=le(Ie);return pe!=null?this.dom2js(pe):null},this.js2xml=function(Ie){return ie(Ie)},this.getVersion=function(){return"3.4.4"}}})=="function"?n.apply(r,o):n)===void 0||(t.exports=s)})()},function(t,r,e){var n=e(116);t.exports=function(o,s){return s.method="POST",s.headers=s.headers||{},s.headers["Content-Type"]="multipart/form-data",s.timeout=0,s.type=s.type||"json",n(o,s)}},function(t,r,e){var n=e(15),o=e(52),s=e(6),a=e(3),i=e(13),u=i.chunkSize,d=e(116),c={mp4:"video/mp4",avi:"video/x-msvideo",wmv:"video/x-ms-wmv",mpeg:"video/mpeg",mov:"video/quicktime",aac:"audio/x-aac",wma:"audio/x-ms-wma",wav:"audio/x-wav",mp3:"audio/mp3"};t.exports=function m(v,g,b,T){var k={file:v.data[g],fileSize:v.data[g].size,fileUploadedSize:0,percentage:0},y=v.url;function O(ze){var ie=k.fileUploadedSize+ze.loaded,le=Math.floor(1e4*ie/k.fileSize)/100;if(o(le)>=100&&(le=100,O=function(){}),k.percentage!==le){k.percentage=le;var Ie={docId:v.docId,total:k.fileSize,loaded:ie,percentage:le,percentageText:le+"%"};v.fileInput&&(Ie.fileInput=v.fileInput),v.blob&&(Ie.blob=v.blob),v.uploadprogress(Ie)}}function D(ze){try{ze=JSON.parse(ze)}catch(Ie){return void b.onError(Ie)}if(ze.errMsg||ze.errCode)b.onError(ze);else if(ze.offset<k.fileSize)delete ue.onaftersend,k.fileUploadedSize=ze.offset,function(Ie,pe,qe,$e){var Lt=Ie.offset,Dt=Ie.offset+u;if(typeof FileReader<"u"){var dr,pr=new FileReader;pr.readAsArrayBuffer(n(dr=$e.file).call(dr,Lt,Dt)),pr.addEventListener("load",function(hr){pe.data=hr.target.result,pe.query.offset=Ie.offset,pe.query.complete=Dt>=$e.fileSize,pe.query.context=Ie.context,pe.onuploading=O,pe.onload=D,pe.onerror=he,b.sn=d(y,pe)}),pr.addEventListener("error",function(hr){pe.onerror(hr.target.error)})}else{var sr;pe.data=n(sr=$e.file).call(sr,Lt,Dt),pe.query.offset=Ie.offset,pe.query.complete=Dt>=$e.fileSize,pe.query.context=Ie.context,pe.onuploading=O,pe.onload=D,pe.onerror=he,b.sn=d(y,pe)}}(ze,ue,0,k);else{var ie=i.genFileUrl(v.nosToken);v.type==="image"?d(ie+"?imageInfo",{onload:function(Ie){try{Ie=JSON.parse(Ie),v.uploaddone(null,{docId:ze.docId,w:Ie.Width,h:Ie.Height,orientation:Ie.Orientation||"",type:Ie.Type,size:Ie.Size||k.fileSize})}catch(pe){le(pe)}},onerror:function(Ie){if(typeof Image<"u"){var pe=new Image;pe.src=ie,pe.onload=function(){v.uploaddone(null,{docId:ze.docId,w:pe.width,h:pe.height,size:k.fileSize})},pe.onerror=function(qe){le(qe)}}else le(Ie)}}):v.type==="video"||v.type==="audio"?d(ie+"?vinfo",{onload:function(Ie){try{(Ie=JSON.parse(Ie)).GetVideoInfo&&Ie.GetVideoInfo.VideoInfo&&(Ie=Ie.GetVideoInfo.VideoInfo),v.uploaddone(null,{docId:ze.docId,w:Ie.Width,h:Ie.Height,dur:Ie.Duration,orientation:Ie.Rotate,audioCodec:Ie.AudioCodec,videoCodec:Ie.VideoCodec,container:Ie.Container,size:Ie.Size||k.fileSize})}catch(pe){le(pe)}},onerror:le}):v.uploaddone(null,{docId:ze.docId,size:k.fileSize})}function le(Ie){b.onError(Ie)}}function he(ze){v.errorHook(ze,{url:y,provider:"nos"});var ie=ze&&ze.code;function le(){try{if(ze.result)var Ie=JSON.parse(ze.result);else Ie=ze;b.onError(Ie)}catch(pe){b.onError(pe)}}k.fileUploadedSize===0&&ie!=="abort"?v.edgeList?T<v.edgeList.length-1?m(v,g,b,T+1):le():v.nosLbsUrls&&v.nosLbsUrls.length>0?function(Ie,pe,qe,$e,Lt){return new a(function(Dt){function dr(){Lt.adaptersRequest(qe[Ie],{query:{version:"1.0",bucketname:pe},method:"GET",onerror:pr,onload:function(sr){try{(sr=JSON.parse(sr))&&sr.upload&&sr.upload.length?Dt(sr.upload):pr()}catch{pr()}}},{exception_service:3})}function pr(){$e.onLbsUrlFail(qe[Ie]),Ie<qe.length-1?(Ie++,dr()):Dt([])}dr()})}(0,v.nosToken.bucket,v.nosLbsUrls,b,v).then(function(Ie){Ie.length>0?(v.edgeList=Ie,v.updateNosEdgeList&&v.updateNosEdgeList(Ie),m(v,g,b,T+1)):le()}):(v.edgeList=i.edgeList,m(v,g,b,T+1)):le()}typeof T!="number"&&(T=-1),v.edgeList&&v.edgeList.length&&(T=T>0?T:0,y=v.edgeList[T]),y+="/"+v.nosToken.bucket+"/"+v.nosToken.objectName;var ae=v.data.file&&v.data.file.type;if(!ae||s(ae).call(ae,"/")<0){var Ne=(v.fileInputName||"").split(".").pop();v.type==="image"?ae="image/"+(Ne==="jpg"?"jpeg":Ne):v.type!=="audio"&&v.type!=="video"||(ae=c[Ne])}var ue={query:{offset:0,complete:u>=k.fileSize,version:"1.0"},headers:{"Content-Type":ae||"application/octet-stream","x-nos-token":v.nosToken.token},method:"POST",timeout:0,onaftersend:function(){v.beginupload(b)},onuploading:O,onload:D,onerror:he};if(typeof FileReader<"u"){var Y,_e=new FileReader;_e.addEventListener("load",function(ze){ue.data=ze.target.result,b.sn=d(y,ue)}),_e.addEventListener("error",function(ze){ue.onerror(ze.target.error)}),_e.readAsArrayBuffer(n(Y=k.file).call(Y,0,u))}else{var Ce;ue.data=n(Ce=k.file).call(Ce,0,u),b.sn=d(y,ue)}}},function(t,r,e){e(608);var n=e(12);t.exports=n.Reflect.construct},function(t,r,e){var n=e(1),o=e(33),s=e(76),a=e(273),i=e(169),u=e(36),d=e(28),c=e(80),m=e(4),v=o("Reflect","construct"),g=Object.prototype,b=[].push,T=m(function(){function O(){}return!(v(function(){},[],O)instanceof O)}),k=!m(function(){v(function(){})}),y=T||k;n({target:"Reflect",stat:!0,forced:y,sham:y},{construct:function(O,D){i(O),u(D);var he=arguments.length<3?O:i(arguments[2]);if(k&&!T)return v(O,D,he);if(O==he){switch(D.length){case 0:return new O;case 1:return new O(D[0]);case 2:return new O(D[0],D[1]);case 3:return new O(D[0],D[1],D[2]);case 4:return new O(D[0],D[1],D[2],D[3])}var ae=[null];return s(b,ae,D),new(s(a,O,ae))}var Ne=he.prototype,ue=c(d(Ne)?Ne:g),Y=s(O,ue,D);return d(Y)?Y:ue}})},function(t,r,e){t.exports=e(610)},function(t,r,e){var n=e(611);t.exports=n},function(t,r,e){var n=e(215);t.exports=n},function(t,r,e){t.exports=e(613)},function(t,r,e){var n=e(614);t.exports=n},function(t,r,e){var n=e(615);t.exports=n},function(t,r,e){var n=e(616);t.exports=n},function(t,r,e){e(617);var n=e(12);t.exports=n.Object.setPrototypeOf},function(t,r,e){e(1)({target:"Object",stat:!0},{setPrototypeOf:e(135)})},function(t,r,e){t.exports=e(619)},function(t,r,e){var n=e(620);t.exports=n},function(t,r,e){var n=e(272);t.exports=n},function(t,r){t.exports=function(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(623)},function(t,r,e){var n=e(624);t.exports=n},function(t,r,e){var n=e(283);t.exports=n},function(t,r,e){e(626);var n=e(12);t.exports=n.Object.getPrototypeOf},function(t,r,e){var n=e(1),o=e(4),s=e(42),a=e(134),i=e(228);n({target:"Object",stat:!0,forced:o(function(){a(1)}),sham:!i},{getPrototypeOf:function(u){return a(s(u))}})},function(t,r,e){var n,o=e(139),s=e(6),a=e(10),i=e(25),u=e(8),d=e(15),c=e(5),m=e(0),v=e(73).fn,g=e(285),b=e(276),T=e(40),k=e(24).reportAPI;v.transDoc=function(y){var O;m.verifyOptions(y,"fileInput done","nos::transDoc");try{var D=y.fileInput.files[0],he=["ppt","pdf","pptx","doc","docx"],ae=y.fileInputName=D.name,Ne={ppt:1,pptx:2,pdf:3,doc:6,docx:7},ue=ae.substring(o(ae).call(ae,".")+1);if(s(he).call(he,ue)<0)return void y.done(T.newNoFileError("ppt, pptx, pdf, doc, docx",{callFunc:"nos: transDoc",fileInput:y.fileInput}),y)}catch{return void y.done(T.newNoFileError("",{callFunc:"msg::previewFile",fileInput:y.fileInput}),y)}var Y=a(b.genResponseBody("file")||{}).replace(/"/gi,'\\"'),_e={transToken:{name:ae,type:Ne[ue],transType:y.transcode==="png"?11:10,size:D.size,body:Y}};this.getNosTokenTrans({responseBody:_e,nosToken:{nosScene:y.nosScene||this.nosScene,nosSurvivalTime:y.nosSurvivalTime},callback:i(O=function(Ce,ze){Ce?y.done(Ce):(y.nosToken=ze.nosToken,y.docId=ze.docId,this._doPreviewFile(y))}).call(O,this)})},v.getSimpleNosToken=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return y.num=1,m.verifyOptions(y),this.cbAndSendCmd("getSimpleNosToken",y)},v.getNosToken=function(y){var O=y.callback,D=y.nosToken,he=y.responseBody,ae={tag:D.nosScene};D.nosSurvivalTime&&D.nosSurvivalTime!==1/0&&(ae.expireSec=D.nosSurvivalTime),this.sendCmd("getNosToken",{responseBody:he,nosToken:ae},O)},v.getNosTokenTrans=function(y){this.sendCmd("getNosTokenTrans",y.responseBody,y.callback)},v.getMixStoreToken=function(y){this.sendCmd("getMixStoreToken",{mixTokenReq:{provider:y.curProvider,tokenCount:y.tokenCount||1,tag:"im",returnBody:y.responseBody}},y.callback)},v.packFileDownloadName=function(y){k({instance:this,className:"ApiBaseFn",funcName:"packFileDownloadName",hasCallback:!1}),m.verifyOptions(y,"url name",!0,"","nos::packFileDownloadName");var O=y.url;return O+m.genUrlSep(O)+"download="+encodeURIComponent(y.name)},v.audioToMp3=function(y){k({instance:this,className:"ApiBaseFn",funcName:"audioToMp3",hasCallback:!1}),m.verifyOptions(y,"url","nos::audioToMp3");var O=y.url;return O+m.genUrlSep(O)+"audioTrans&type=mp3"},v.removeFile=function(y){this.sendCmd("removeFile",y,y.callback)},v.fetchFile=function(y){this.sendCmd("fetchFile",y,y.callback)},v.fetchFileList=function(y){this.sendCmd("fetchFileList",y,y.callback)},v.stripImageMeta=function(y){return k({instance:this,className:"ApiBaseFn",funcName:"stripImageMeta",hasCallback:!1}),this.beforeProcessImage(y,"stripmeta")},v.qualityImage=function(y){return k({instance:this,className:"ApiBaseFn",funcName:"qualityImage",hasCallback:!1}),this.beforeProcessImage(y,"quality")},v.interlaceImage=function(y){return k({instance:this,className:"ApiBaseFn",funcName:"interlaceImage",hasCallback:!1}),this.beforeProcessImage(y,"interlace")},v.rotateImage=function(y){return k({instance:this,className:"ApiBaseFn",funcName:"rotateImage",hasCallback:!1}),this.beforeProcessImage(y,"rotate")},v.blurImage=function(y){return k({instance:this,className:"ApiBaseFn",funcName:"blurImage",hasCallback:!1}),this.beforeProcessImage(y,"blur")},v.cropImage=function(y){return k({instance:this,className:"ApiBaseFn",funcName:"cropImage",hasCallback:!1}),this.beforeProcessImage(y,"crop")},v.thumbnailImage=function(y){return k({instance:this,className:"ApiBaseFn",funcName:"thumbnailImage",hasCallback:!1}),this.beforeProcessImage(y,"thumbnail")},v.beforeProcessImage=function(y,O){var D=m.copy(y);return D.type=O,y.ops=[D],this.processImage(y)},v.processImage=function(y){var O;y.callback=k({instance:this,className:"ApiBaseFn",funcName:"processImage",done:y.callback});var D=this;m.verifyOptions(y,"url ops",!0,"","nos::processImage"),m.verifyParamType("ops",y.ops,"array","nos::processImage");var he=u(O=y.ops).call(O,function(ae){var Ne,ue;return m.verifyOptions(ae,"type",!0,"","nos::processImage"),m.verifyParamValid("type",ae.type,g.validTypes,"nos::processImage"),D["gen"+d(Ne=ae.type).call(Ne,0,1).toUpperCase()+d(ue=ae.type).call(ue,1)+"Op"](ae)});D.processCallback(y),D.sendCmd("processImage",{url:y.url,imageOps:he},y.callback)},v.genStripmetaOp=function(y){return new g({type:y.type,stripmeta:y.strip?1:0})},v.genQualityOp=function(y){m.verifyOptions(y,"quality",!0,"","nos::genQualityOp"),m.verifyParamType("quality",y.quality,"number","nos::genQualityOp"),m.verifyParamMin("quality",y.quality,0,"nos::genQualityOp"),m.verifyParamMax("quality",y.quality,100,"nos::genQualityOp");var O=Math.round(y.quality);return new g({type:y.type,qualityQuality:O})},v.genInterlaceOp=function(y){return new g({type:y.type})},v.genRotateOp=function(y){for(m.verifyOptions(y,"angle",!0,"","nos::genRotateOp"),m.verifyParamType("angle",y.angle,"number","nos::genRotateOp");y.angle<0;)y.angle=y.angle+360;y.angle=y.angle%360;var O=Math.round(y.angle);return new g({type:y.type,rotateAngle:O})},v.genBlurOp=function(y){m.verifyOptions(y,"radius sigma","nos::genBlurOp"),m.verifyParamType("radius",y.radius,"number","nos::genBlurOp"),m.verifyParamMin("radius",y.radius,1,"nos::genBlurOp"),m.verifyParamMax("radius",y.radius,50,"nos::genBlurOp"),m.verifyParamType("sigma",y.sigma,"number","nos::genBlurOp"),m.verifyParamMin("sigma",y.sigma,0,"nos::genBlurOp");var O=Math.round(y.radius),D=Math.round(y.sigma);return new g({type:y.type,blurRadius:O,blurSigma:D})},v.genCropOp=function(y){m.verifyOptions(y,"x y width height","nos::genCropOp"),m.verifyParamType("x",y.x,"number","nos::genCropOp"),m.verifyParamMin("x",y.x,0,"nos::genCropOp"),m.verifyParamType("y",y.y,"number","nos::genCropOp"),m.verifyParamMin("y",y.y,0,"nos::genCropOp"),m.verifyParamType("width",y.width,"number","nos::genCropOp"),m.verifyParamMin("width",y.width,0,"nos::genCropOp"),m.verifyParamType("height",y.height,"number","nos::genCropOp"),m.verifyParamMin("height",y.height,0,"nos::genCropOp");var O=Math.round(y.x),D=Math.round(y.y),he=Math.round(y.width),ae=Math.round(y.height);return new g({type:y.type,cropX:O,cropY:D,cropWidth:he,cropHeight:ae})},v.genThumbnailOp=(n={cover:"z",contain:"x",crop:"y"},function(y){m.verifyOptions(y,"mode","nos::genThumbnailOp"),m.verifyParamValid("mode",y.mode,c(n),"nos::genThumbnailOp"),y.mode==="contain"?m.verifyParamAtLeastPresentOne(y,"width height","nos::genThumbnailOp"):m.verifyOptions(y,"width height","nos::genThumbnailOp"),m.undef(y.width)&&(y.width=0),m.undef(y.height)&&(y.height=0),m.verifyParamType("width",y.width,"number","nos::genThumbnailOp"),m.verifyParamMin("width",y.width,0,"nos::genThumbnailOp"),m.verifyParamType("height",y.height,"number","nos::genThumbnailOp"),m.verifyParamMin("height",y.height,0,"nos::genThumbnailOp");var O=Math.round(y.width),D=Math.round(y.height),he=new g({type:y.type,thumbnailMode:n[y.mode],thumbnailWidth:O,thumbnailHeight:D});if(y.mode==="crop"&&m.notundef(y.axis)){m.undef(y.axis.x)&&(y.axis.x=5),m.undef(y.axis.y)&&(y.axis.y=5),m.verifyParamMin("axis.x",y.axis.x,0,"nos::genThumbnailOp"),m.verifyParamMax("axis.x",y.axis.x,10,"nos::genThumbnailOp"),m.verifyParamMin("axis.y",y.axis.y,0,"nos::genThumbnailOp"),m.verifyParamMax("axis.y",y.axis.y,10,"nos::genThumbnailOp");var ae=Math.round(y.axis.x),Ne=Math.round(y.axis.y);he.thumbnailAxisX=ae,he.thumbnailAxisY=Ne}return m.notundef(y.enlarge)&&(m.verifyParamType("enlarge",y.enlarge,"boolean","nos::genThumbnailOp"),y.enlarge&&(he.thumbnailEnlarge=1)),he.thumbnailToStatic=this.options.thumbnailToStatic?1:0,he}),v.getNosOriginUrl=function(y){var O;(y=y||{}).done=k({instance:this,className:"ApiBaseFn",funcName:"getNosOriginUrl",done:y.done}),m.verifyOptions(y,"safeShortUrl",!0,"","nos::getNosOriginUrl"),m.verifyParamType("safeShortUrl",y.safeShortUrl,"string","nos::getNosOriginUrl"),/^http(s)?:/.test(y.safeShortUrl)&&~s(O=y.safeShortUrl).call(O,"im_url=1")?(this.processCallback(y),this.sendCmd("getNosOriginUrl",{nosFileUrlTag:{safeUrl:y.safeShortUrl}},y.callback)):y.done(new T(" safeShortUrl ",{callFunc:"nos: getNosOriginUrl"}),y)}},function(t,r,e){var n,o=e(7),s=e(6),a=e(5),i=e(26),u=e(106),d=u.genUrlSep,c=u.url2object,m=u.object2url,v=e(0),g=e(73).fn,b=e(24).reportAPI;g.viewImageSync=function(T){b({instance:this,className:"ApiBaseFn",funcName:"viewImageSync",hasCallback:!1});var k=this.options;v.verifyOptions(T,"url","nos::viewImageSync");var y=T.url,O=c(y),D=O.protocol,he=O.hostname,ae=O.path,Ne=O.query;if(typeof T.strip=="boolean"&&(Ne.stripmeta=T.strip?1:0),typeof T.quality=="number"&&(v.verifyParamMin("quality",T.quality,0,"nos::viewImageSync"),v.verifyParamMax("quality",T.quality,100,"nos::viewImageSync"),Ne.quality=Math.round(T.quality)),typeof T.interlace=="boolean"&&(Ne.interlace=T.interlace?1:0),typeof T.rotate=="number"&&(Ne.rotate=Math.round(T.rotate)),i(T.thumbnail)==="object"){var ue=T.thumbnail.mode||"crop",Y=T.thumbnail.width,_e=T.thumbnail.height;if(Y>=0&&_e>=0&&Y<4096&&_e<4096&&(Y>0||_e>0)){var Ce,ze;switch(ue){case"crop":ue="y";break;case"contain":ue="x";break;case"cover":ue="z";break;default:ue="x"}Ne.thumbnail=o(Ce=o(ze="".concat(Y)).call(ze,ue)).call(Ce,_e)}}if(k.downloadUrl){var ie=c(T.url),le=k.downloadUrl,Ie=ie.path,pe=s(Ie).call(Ie,"/");if(pe!==-1){var qe=Ie.substring(0,pe),$e=Ie.substring(pe+1);le=le.replace("{bucket}",qe).replace("{object}",$e)}var Lt=c(le);return m({protocol:Lt.protocol,hostname:Lt.hostname,path:Lt.path,query:v.merge(Lt.query,Ne)})}return m({protocol:D,hostname:he,path:ae,query:Ne})},g.viewImageStripMeta=function(T){b({instance:this,className:"ApiBaseFn",funcName:"viewImageStripMeta",hasCallback:!1}),v.verifyOptions(T,"url strip","nos::viewImageStripMeta"),v.verifyParamType("strip",T.strip,"boolean","nos::viewImageStripMeta");var k="stripmeta="+(T.strip?1:0),y=d(T.url);return T.url+y+k},g.viewImageQuality=function(T){b({instance:this,className:"ApiBaseFn",funcName:"viewImageQuality",hasCallback:!1}),v.verifyOptions(T,"url quality","nos::viewImageQuality"),v.verifyParamType("quality",T.quality,"number","nos::viewImageQuality"),v.verifyParamMin("quality",T.quality,0,"nos::viewImageQuality"),v.verifyParamMax("quality",T.quality,100,"nos::viewImageQuality");var k="quality="+Math.round(T.quality),y=d(T.url);return T.url+y+k},g.viewImageInterlace=function(T){b({instance:this,className:"ApiBaseFn",funcName:"viewImageInterlace",hasCallback:!1}),v.verifyOptions(T,"url","nos::viewImageInterlace");var k=d(T.url);return T.url+k+"interlace=1"},g.viewImageRotate=function(T){for(b({instance:this,className:"ApiBaseFn",funcName:"viewImageRotate",hasCallback:!1}),v.verifyOptions(T,"url angle","nos::viewImageRotate"),v.verifyParamType("angle",T.angle,"number","nos::viewImageRotate");T.angle<0;)T.angle=T.angle+360;T.angle=T.angle%360;var k="rotate="+Math.round(T.angle),y=d(T.url);return T.url+y+k},g.viewImageBlur=function(T){b({instance:this,className:"ApiBaseFn",funcName:"viewImageBlur",hasCallback:!1}),v.verifyOptions(T,"url radius sigma","nos::viewImageBlur"),v.verifyParamType("radius",T.radius,"number","nos::viewImageBlur"),v.verifyParamMin("radius",T.radius,1,"nos::viewImageBlur"),v.verifyParamMax("radius",T.radius,50,"nos::viewImageBlur"),v.verifyParamType("sigma",T.sigma,"number","nos::viewImageBlur"),v.verifyParamMin("sigma",T.sigma,0,"nos::viewImageBlur");var k="blur="+Math.round(T.radius)+"x"+Math.round(T.sigma),y=d(T.url);return T.url+y+k},g.viewImageCrop=function(T){b({instance:this,className:"ApiBaseFn",funcName:"viewImageCrop",hasCallback:!1}),v.verifyOptions(T,"url x y width height","nos::viewImageCrop"),v.verifyParamType("x",T.x,"number","nos::viewImageCrop"),v.verifyParamMin("x",T.x,0,"nos::viewImageCrop"),v.verifyParamType("y",T.y,"number","nos::viewImageCrop"),v.verifyParamMin("y",T.y,0,"nos::viewImageCrop"),v.verifyParamType("width",T.width,"number","nos::viewImageCrop"),v.verifyParamMin("width",T.width,0,"nos::viewImageCrop"),v.verifyParamType("height",T.height,"number","nos::viewImageCrop"),v.verifyParamMin("height",T.height,0,"nos::viewImageCrop");var k="crop="+Math.round(T.x)+"_"+Math.round(T.y)+"_"+Math.round(T.width)+"_"+Math.round(T.height),y=d(T.url);return T.url+y+k},g.viewImageThumbnail=(n={cover:"z",contain:"x",crop:"y"},function(T){v.verifyOptions(T,"url mode","nos::viewImageThumbnail"),v.verifyParamValid("mode",T.mode,a(n),"nos::viewImageThumbnail"),T.mode==="contain"?v.verifyParamAtLeastPresentOne(T,"width height","nos::viewImageThumbnail"):v.verifyOptions(T,"width height","nos::viewImageThumbnail"),v.undef(T.width)&&(T.width=0),v.undef(T.height)&&(T.height=0),v.verifyParamType("width",T.width,"number","nos::viewImageThumbnail"),v.verifyParamMin("width",T.width,0,"nos::viewImageThumbnail"),v.verifyParamType("height",T.height,"number","nos::viewImageThumbnail"),v.verifyParamMin("height",T.height,0,"nos::viewImageThumbnail");var k=Math.round(T.width),y=Math.round(T.height),O="thumbnail="+k+n[T.mode]+y;T.mode==="crop"&&v.notundef(T.axis)&&(v.undef(T.axis.x)&&(T.axis.x=5),v.undef(T.axis.y)&&(T.axis.y=5),v.verifyParamMin("axis.x",T.axis.x,0,"nos::viewImageThumbnail"),v.verifyParamMax("axis.x",T.axis.x,10,"nos::viewImageThumbnail"),v.verifyParamMin("axis.y",T.axis.y,0,"nos::viewImageThumbnail"),v.verifyParamMax("axis.y",T.axis.y,10,"nos::viewImageThumbnail"),O=O+"&axis="+Math.round(T.axis.x)+"_"+Math.round(T.axis.y)),v.notundef(T.enlarge)&&(v.verifyParamType("enlarge",T.enlarge,"boolean","nos::viewImageThumbnail"),T.enlarge&&(O+="&enlarge=1"));var D=d(T.url);return T.url+D+O})},function(t,r,e){var n=e(630);t.exports=n},function(t,r,e){var n=e(21),o=e(631),s=e(633),a=Array.prototype,i=String.prototype;t.exports=function(u){var d=u.includes;return u===a||n(a,u)&&d===a.includes?o:typeof u=="string"||u===i||n(i,u)&&d===i.includes?s:d}},function(t,r,e){e(632);var n=e(30);t.exports=n("Array").includes},function(t,r,e){var n=e(1),o=e(160).includes,s=e(4),a=e(196);n({target:"Array",proto:!0,forced:s(function(){return!Array(1).includes()})},{includes:function(i){return o(this,i,arguments.length>1?arguments[1]:void 0)}}),a("includes")},function(t,r,e){e(634);var n=e(30);t.exports=n("String").includes},function(t,r,e){var n=e(1),o=e(11),s=e(635),a=e(108),i=e(49),u=e(637),d=o("".indexOf);n({target:"String",proto:!0,forced:!u("includes")},{includes:function(c){return!!~d(i(a(this)),i(s(c)),arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(636),o=TypeError;t.exports=function(s){if(n(s))throw o("The method doesn't accept regular expressions");return s}},function(t,r,e){var n=e(28),o=e(63),s=e(20)("match");t.exports=function(a){var i;return n(a)&&((i=a[s])!==void 0?!!i:o(a)=="RegExp")}},function(t,r,e){var n=e(20)("match");t.exports=function(o){var s=/./;try{"/./"[o](s)}catch{try{return s[n]=!1,"/./"[o](s)}catch{}}return!1}},function(t,r,e){var n=e(26),o=e(10),s=e(6),a=e(305),i=e(0),u=e(73).fn,d=e(13),c=e(24).reportAPI;function m(g,b,T,k){var y=!1,O="";if(T===1?s(g).call(g,b)>=0&&(y=!0,O=b):T===2&&(O=new RegExp(b,"g")).test(g)&&(y=!0),y&&O!=="")switch(k){case 1:return g.replace(O,"**");case 2:return{code:2};case 3:return{code:3}}return g}function v(g,b){for(var T=b.match,k=b.operate,y=g,O=0;O<a(b).length;O++){var D=a(b)[O],he=D.match||T,ae=D.operate||k;try{if(y=m(y,D.key,he,ae),n(y)==="object")return y}catch(Ne){this.logger.warn("misc::filterContent: js cannot parse this regexp ",Ne)}}return y}u.uploadSdkLogUrl=function(g){return i.verifyOptions(g,"url","misc::uploadSdkLogUrl"),this.cbAndSendCmd("uploadSdkLogUrl",g)},u.getClientAntispamLexicon=function(g){var b=this;(g=g||{}).done=c({instance:this,className:"ApiBaseFn",funcName:"getClientAntispamLexicon",done:g.done});var T=(g=g||{}).done;T instanceof Function||(T=function(){}),g={clientAntispam:{version:0}};var k=this;if(d.hasLocalStorage&&localStorage.getItem("antispamLexicon")&&localStorage.getItem("antispamLexicon")!=="{}")try{k.antispamLexicon=JSON.parse(localStorage.getItem("antispamLexicon"))}catch(y){this.logger.error("JSON parse antispamLexicon error",y)}k.antispamLexicon&&T.call(this,null,{clientAntispam:k.antispamLexicon}),this.protocol.sendCmd("getClientAntispam",g,function(y,O,D){y?(k.protocol.logger.error("misc::getClientAntispamLexicon:",y),T.call(b,y,{})):(d.hasLocalStorage&&localStorage.setItem("antispamLexicon",o(D.clientAntispam)),k.antispamLexicon||T.call(b,null,D),k.antispamLexicon=D.clientAntispam||{})})},u.filterClientAntispam=function(g){c({instance:this,className:"ApiBaseFn",funcName:"filterClientAntispam",hasCallback:!1});var b=g.content;if(!b)return{code:404,errmsg:"content"};var T=this.antispamLexicon&&this.antispamLexicon.thesaurus;if(!T)return{code:404,errmsg:""};try{T=JSON.parse(T).thesaurus}catch{return this.protocol.logger.error("misc::filterClientAntispam: parse thesaurus error"),{code:500,errmsg:""}}for(var k=b,y=0;y<T.length;y++)if(k=v.call(this,k,T[y]),n(k)==="object"){if(k.code===2)return{code:200,type:2,errmsg:"",content:b,result:""};if(k.code===3)return{code:200,type:3,errmsg:"clientAntiSpam",content:b,result:b}}return k===b?{code:200,type:0,errmsg:"",content:b,result:k}:{code:200,type:1,errmsg:"",content:b,result:k}},u.getServerTime=function(g){(g=g||{}).done=c({instance:this,className:"ApiBaseFn",funcName:"getServerTime",done:g.done}),this.processCallback(g),this.sendCmd("getServerTime",{},g.callback)},u.getNosAccessToken=function(g){(g=g||{}).done=c({instance:this,className:"ApiBaseFn",funcName:"getNosAccessToken",done:g.done}),i.verifyOptions(g,"url","misc::getNosAccessToken"),this.processCallback(g);var b={url:g.url};g.userAgent&&(b.userAgent=g.userAgent),g.ext&&(b.ext=g.ext),this.sendCmd("getNosAccessToken",{nosAccessTokenTag:b},function(T,k,y){var O=y&&y.nosAccessTokenTag&&y.nosAccessTokenTag.token,D=g.url,he=O?{token:O,resUrl:s(D).call(D,"?")!==-1?D+"&token="+O:D+"?token="+O}:{};g.done(T,he)})},u.deleteNosAccessToken=function(g){(g=g||{}).done=c({instance:this,className:"ApiBaseFn",funcName:"deleteNosAccessToken",done:g.done}),i.verifyOptions(g,"token","misc::deleteNosAccessToken"),this.processCallback(g),this.sendCmd("deleteNosAccessToken",{nosAccessTokenTag:{token:g.token}},g.callback)}},function(t,r,e){e(67);var n=e(65),o=e(29),s=e(21),a=e(640),i=Array.prototype,u={DOMTokenList:!0,NodeList:!0};t.exports=function(d){var c=d.keys;return d===i||s(i,d)&&c===i.keys||o(u,n(d))?a:c}},function(t,r,e){var n=e(641);t.exports=n},function(t,r,e){e(82),e(96);var n=e(30);t.exports=n("Array").keys},function(t,r,e){var n=e(26),o=e(3),s=e(8),a=e(10),i=e(73).fn,u=e(0),d=e(191),c=e(286),m=e(24).reportAPI;i.signalingCreate=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.type,b=v.channelName,T=v.ext;return u.verifyOptions(v,"type","api::signalling"),this.sendCmdUsePromise("signalingCreate",{avSignalTag:{type:g,channelName:b,ext:T}}).then(function(k){var y=k.avSignalTag;return o.resolve(y)}).catch(function(k){return o.reject(c.parseAvSignalError(k))})},i.signalingDelay=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return u.verifyOptions(v,"channelId","api::signalling"),this.sendCmdUsePromise("signalingDelay",{avSignalTag:v}).then(function(g){var b=g.avSignalTag;return o.resolve(b)}).catch(function(g){return o.reject(c.parseAvSignalError(g))})},i.signalingClose=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.offlineEnabled;return u.verifyOptions(v,"channelId","api::signalling"),this.sendCmdUsePromise("signalingClose",{avSignalTag:u.merge(v,{isSave:g===!0?1:0})}).then(function(b){var T=b.avSignalTag;return T.offlineEnabled=T.isSave===1,delete T.isSave,o.resolve(T)}).catch(function(b){return o.reject(c.parseAvSignalError(b))})},i.signalingJoin=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.offlineEnabled;return u.verifyOptions(v,"channelId","api::signalling"),this.sendCmdUsePromise("signalingJoin",{avSignalTag:u.merge(v,{isSave:g===!0?1:0})}).then(function(b){var T,k=b.avSignalTag,y=k.members;return typeof k.members=="string"&&(y=s(T=JSON.parse(k.members)).call(T,function(O){return c.parseAvSignalMember(O)})),k.members=y,o.resolve(k)}).catch(function(b){return o.reject(c.parseAvSignalError(b))})},i.signalingLeave=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.offlineEnabled;return u.verifyOptions(v,"channelId","api::signalling"),this.sendCmdUsePromise("signalingLeave",{avSignalTag:u.merge(v,{isSave:g===!0?1:0})}).then(function(b){var T=b.avSignalTag;return T.offlineEnabled=T.isSave===1,delete T.isSave,o.resolve(T)}).catch(function(b){return o.reject(c.parseAvSignalError(b))})},i.signalingGetChannelInfo=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.channelName;return u.verifyOptions(v,"channelName","api::signalling"),this.sendCmdUsePromise("signalingGetChannelInfo",{avSignalTag:{channelName:g}}).then(function(b){var T,k=b.avSignalTag,y=k.members;return typeof k.members=="string"&&(y=s(T=JSON.parse(k.members)).call(T,function(O){return c.parseAvSignalMember(O)})),k.members=y,o.resolve(k)}).catch(function(b){return o.reject(c.parseAvSignalError(b))})},i.signalingInvite=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.account,b=v.offlineEnabled,T=v.pushInfo,k=T===void 0?{}:T;u.verifyOptions(v,"channelId requestId account","api::signalling"),n(k.pushPayload)==="object"&&(k.pushPayload=a(k.pushPayload));var y=u.merge(v,k,{to:g,isSave:b===!0?1:0,needPush:k.needPush===!0?1:0,needBadge:k.needBadge===!1?0:1});return this.sendCmdUsePromise("signalingInvite",{avSignalTag:y}).then(function(O){var D=O.avSignalTag;return D.offlineEnabled=D.isSave===1,D.needBadge=D.needBadge===1,D.needPush=D.needPush===1,delete D.isSave,o.resolve(D)}).catch(function(O){return o.reject(c.parseAvSignalError(O))})},i.signalingCancel=function(v){var g=v.account,b=v.offlineEnabled;return u.verifyOptions(v,"channelId requestId account","api::signalling"),this.sendCmdUsePromise("signalingCancel",{avSignalTag:u.merge(v,{to:g,isSave:b===!0?1:0})}).then(function(T){var k=T.avSignalTag;return k.offlineEnabled=k.isSave===1,delete k.isSave,o.resolve(k)}).catch(function(T){return o.reject(c.parseAvSignalError(T))})},i.signalingCreateAndJoin=function(v){var g=this,b=m({instance:this,className:"ApiBaseFn",funcName:"signalingCreateAndJoin",hasCallback:!0}),T=v.channelName,k=v.uid,y=k===void 0?0:k,O=v.offlineEnabled,D=O===void 0||O,he=v.attachExt,ae=he===void 0?"":he;return this.signalingCreate(v).catch(function(Ne){return Ne.code===10405?(g.logger.warn("api::avSignal:signalingCall room already exists:",Ne),g.signalingGetChannelInfo({channelName:T})):o.reject(Ne)}).then(function(Ne){var ue={channelId:Ne.channelId,offlineEnabled:D,attachExt:ae,nertcChannelName:v.nertcChannelName,nertcTokenTtl:v.nertcTokenTtl,nertcJoinRoomQueryParamMap:v.nertcJoinRoomQueryParamMap};return y&&u.merge(ue,{uid:y}),g.signalingJoin(ue)}).then(function(Ne){return typeof b=="function"&&b(void 0),Ne}).catch(function(Ne){throw typeof b=="function"&&b(Ne),Ne})},i.signalingCall=function(v){var g=this,b=m({instance:this,className:"ApiBaseFn",funcName:"signalingCall",hasCallback:!0}),T=v.account,k=v.offlineEnabled,y=v.requestId;u.verifyOptions(v,"type requestId account","api::signalling");var O="";return this.signalingCreateAndJoin(v).then(function(D){O=D.channelId||O,g.logger.info("api::avSignal:signalingCall join:",O);var he={channelId:O,account:T,requestId:y,offlineEnabled:k,attachExt:v.attachExt||"",pushInfo:v.pushInfo||{},nertcTokenTtl:D.nertcTokenTtl,nertcToken:D.nertcToken};return g.signalingInvite(he)}).then(function(D){return typeof b=="function"&&b(void 0),D}).catch(function(D){throw typeof b=="function"&&b(D),D})},i.signalingReject=function(v){var g=v.account,b=v.offlineEnabled;return u.verifyOptions(v,"channelId requestId account","api::signalling"),this.sendCmdUsePromise("signalingReject",{avSignalTag:u.merge(v,{to:g,isSave:b===!0?1:0})}).then(function(T){var k=T.avSignalTag;return k.offlineEnabled=k.isSave===1,delete k.isSave,o.resolve(k)}).catch(function(T){return o.reject(c.parseAvSignalError(T))})},i.signalingAccept=function(v){var g=this,b=v.account,T=v.offlineEnabled;return u.verifyOptions(v,"channelId requestId account","api::signalling"),this.sendCmdUsePromise("signalingAccept",{avSignalTag:u.merge(v,{to:b,isSave:T===!0?1:0})}).then(function(k){var y=k.avSignalTag;return y.offlineEnabled=y.isSave===1,delete y.isSave,o.resolve(y)}).catch(function(k){return o.reject(c.parseAvSignalError(k))}).then(function(k){if(v.autoJoin){var y={channelId:v.channelId,offlineEnabled:v.offlineEnabled,attachExt:v.joinAttachExt,uid:v.uid,nertcChannelName:v.nertcChannelName,nertcTokenTtl:v.nertcTokenTtl,nertcJoinRoomQueryParamMap:v.nertcJoinRoomQueryParamMap};return g.signalingJoin(y)}return k})},i.signalingControl=function(v){var g=v.account;return u.verifyOptions(v,"channelId","api::signalling"),this.sendCmdUsePromise("signalingControl",{avSignalTag:u.merge(v,g?{to:g}:{})}).then(function(b){var T=b.avSignalTag;return o.resolve(T)}).catch(function(b){return o.reject(c.parseAvSignalError(b))})},i.signalingSync=function(){return this.sendCmdUsePromise("sync",{sync:{avSignal:0}}).then(function(v){var g=v.avSignalTag;return o.resolve(g)}).catch(function(v){return o.reject(c.parseAvSignalError(v))})},i.signalingMarkMsgRead=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};m({instance:this,className:"ApiBaseFn",funcName:"signalingMarkMsgRead",hasCallback:!1}),u.verifyOptions(v,"msgid","api::signalling");var g,b=d.idMap.avSignal;return g=typeof v.msgid=="string"?[v.msgid]:v.msgid,this.sendCmd("batchMarkRead",{sid:b.id,cid:b.signalingNotify,ids:g})},i.signalingCallEx=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.account,b=v.offlineEnabled,T=v.pushInfo,k=T===void 0?{}:T;n(k.pushPayload)==="object"&&(k.pushPayload=a(k.pushPayload)),u.verifyOptions(v,"type","api::signalling"),u.verifyOptions(v,"account","api::signalling");var y=u.merge(v,k,{to:g,isSave:b===!0?1:0,needPush:k.needPush===!0?1:0,needBadge:k.needBadge===!1?0:1});return this.sendCmdUsePromise("signalingCallEx",{avSignalTag:y}).then(function(O){var D,he=O.avSignalTag,ae=he.members;return typeof he.members=="string"&&(ae=s(D=JSON.parse(he.members)).call(D,function(Ne){return c.parseAvSignalMember(Ne)})),he.members=ae,o.resolve(he)}).catch(function(O){return o.reject(c.parseAvSignalError(O))})},i.signalingJoinAndAccept=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.channelId,b=v.attachExt,T=v.offlineEnabled,k=v.uid,y=v.account,O=v.requestId,D=v.nertcChannelName,he=v.nertcTokenTtl,ae=v.nertcJoinRoomQueryParamMap;return u.verifyOptions(v,"channelId","api::signalling"),u.verifyOptions(v,"account","api::signalling"),u.verifyOptions(v,"requestId","api::signalling"),this.sendCmdUsePromise("signalingJoinAndAccept",{avSignalTag:{channelId:g,attachExt:b,isSave:T===!0?1:0,uid:k,to:y,requestId:O,nertcChannelName:D,nertcTokenTtl:he,nertcJoinRoomQueryParamMap:ae}}).then(function(Ne){var ue,Y=Ne.avSignalTag,_e=Y.members;return typeof Y.members=="string"&&(_e=s(ue=JSON.parse(Y.members)).call(ue,function(Ce){return c.parseAvSignalMember(Ce)})),Y.members=_e,o.resolve(Y)}).catch(function(Ne){return o.reject(c.parseAvSignalError(Ne))})}},function(t,r,e){var n=e(2),o=e(121),s=e(122),a=e(54).getPromiseWithAbort,i=function(){function u(){o(this,u),this.abortFns=[]}return s(u,[{key:"add",value:function(d){var c=a(d);return this.abortFns.push(c.abort),c.promise}},{key:"clear",value:function(){var d;n(d=this.abortFns).call(d,function(c){return c("Request aborted")}),this.abortFns=[]}},{key:"destroy",value:function(){this.clear()}}]),u}();t.exports=i},function(t,r,e){var n=e(102),o=e(103),s=e(2),a=e(69),i=e(3),u=e(8),d=e(57),c=e(15),m=e(7),v=e(10),g=e(25),b=e(121),T=e(122),k=e(0),y=e(13),O=e(74),D=e(288),he=e(40);t.exports=function(){function ae(ue){var Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{socketConcurrent:1};b(this,ae),this.clientProto=ue,this.logger=ue.logger,this.urls=[],this.sockets=[],this.config=Y}var Ne;return T(ae,[{key:"setConfig",value:function(){var ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{socketConcurrent:1};this.config=ue}},{key:"setUrls",value:function(ue){this.urls=ue}},{key:"resetSockets",value:function(){var ue;s(ue=this.sockets).call(ue,function(Y){Y&&(Y.removeAllListenersX("info"),Y.disconnect())}),this.sockets=[]}},{key:"connect",value:(Ne=o(n.mark(function ue(){var Y,_e,Ce,ze=this;return n.wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:if(this.clientProto.statusProtector.emit("auth/loginLifeCycleConnect"),(_e=a(Y=this.urls).call(Y,0,this.config.socketConcurrent)).length!==0){ie.next=4;break}throw new he("no_socket_url",408,{});case 4:return ie.prev=4,ie.next=7,i.any(u(_e).call(_e,function(le,Ie){return ze.doConnect(le,Ie)}));case 7:return ie.abrupt("return",ie.sent);case 10:throw ie.prev=10,ie.t0=ie.catch(4),s(Ce=ie.t0.errors).call(Ce,function(le,Ie){ze.logger.warn("imsocket::connect failed ".concat(Ie),le)}),ie.t0;case 14:case"end":return ie.stop()}},ue,this,[[4,10]])})),function(){return Ne.apply(this,arguments)})},{key:"success",value:function(ue){var Y;return s(Y=this.sockets).call(Y,function(_e,Ce){ue!==Ce&&_e&&(_e.removeAllListenersX("info"),_e.disconnect())}),this.sockets[ue]}},{key:"failed",value:function(ue){var Y=this.sockets[ue];Y&&(Y.removeAllListenersX("info"),Y.disconnect())}},{key:"getTransport",value:function(ue){var Y=k.getGlobal();if(typeof window>"u"){var _e=ue.split(":");return Y&&!Y.location&&_e.length>1&&(Y.location={protocol:_e.shift(),port:_e.pop(),hostname:_e.join("")}),["websocket"]}return this.clientProto.options.transports?this.clientProto.options.transports:O.name!=="IE"||Y.WebSocket?["websocket"]:["xhr-polling"]}},{key:"doConnect",value:function(ue,Y){var _e=this;if(this.clientProto&&this.clientProto.__destroyed===!0)return i.reject("instance has been destroyed");var Ce=this.getTransport(ue),ze=d();return new i(function(ie,le){var Ie,pe,qe,$e;try{$e=D.connect(ue,{transports:c(Ce).call(Ce),reconnect:!1,"force new connection":!0,"connect timeout":y.connectTimeout,needToXHR:typeof _e.clientProto.options.needToXHR=="boolean"?_e.clientProto.options.needToXHR:y.needToXHR}),_e.sockets[Y]=$e}catch(Dt){var Lt;return _e.logger.warn(m(Lt="link::connectToUrl ".concat(Y,":io.connect caught exception: ")).call(Lt,Dt&&Dt.message),Dt),void le(new he("socket_error",408,{startTime:ze,url:ue,reason:Dt.message,rawError:Dt}))}_e.logger.info(m(Ie=m(pe="link::connectToUrl ".concat(Y,": socket url: ")).call(pe,ue,", transports: ")).call(Ie,v(Ce))),$e.on("connect",function(){_e.logger.info("link::connectToUrl ".concat(Y," success")),_e.success(Y),_e.clientProto.url=ue,ie($e)}),$e.on("handshake_failed",function(){_e.failed(Y),le(new he("handshake_failed",408,{startTime:ze,url:ue}))}),$e.on("connect_failed",function(Dt){_e.failed(Y),le(new he("connect_failed",408,{startTime:ze,url:ue,reason:Dt}))}),$e.on("error",function(){var Dt,dr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",pr=arguments.length>1?arguments[1]:void 0,sr=pr&&pr.message||dr;_e.logger.warn(m(Dt="link::onSocketError ".concat(Y,": reason is ")).call(Dt,sr,", error is "),pr),le(new he("socket_error",408,{startTime:ze,url:ue,reason:sr,rawError:pr}))}),$e.on("info",function(Dt,dr){var pr,sr;dr?_e.logger.info(m(pr="link::onSocketInfo ".concat(Y,": ")).call(pr,Dt,", extraInfo:"),dr):_e.logger.info(m(sr="link::onSocketInfo ".concat(Y,": ")).call(sr,Dt,"."))}),$e.on("message",g(qe=_e.clientProto.onMessage).call(qe,_e.clientProto)),$e.on("disconnect",function(Dt){_e.logger.warn("link::onSocketDisconnect: socket url: ".concat(ue,", disconnected"),Dt),_e.clientProto.hasLogin=!1,_e.clientProto.doLogout?_e.clientProto.logout():_e.clientProto.onDisconnect("link::socketDisconnect"),_e.clientProto.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to internal reasons"))})})}},{key:"destroy",value:function(){this.urls=[],this.resetSockets()}}]),ae}()},function(t,r,e){var n=e(26).default,o=e(137),s=e(153),a=e(187),i=e(282),u=e(646),d=e(189),c=e(287),m=e(657),v=e(308);function g(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */t.exports=g=function(){return b},t.exports.__esModule=!0,t.exports.default=t.exports;var b={},T=Object.prototype,k=T.hasOwnProperty,y=o||function(nr,ir,Ue){nr[ir]=Ue.value},O=typeof s=="function"?s:{},D=O.iterator||"@@iterator",he=O.asyncIterator||"@@asyncIterator",ae=O.toStringTag||"@@toStringTag";function Ne(nr,ir,Ue){return o(nr,ir,{value:Ue,enumerable:!0,configurable:!0,writable:!0}),nr[ir]}try{Ne({},"")}catch{Ne=function(ir,Ue,rr){return ir[Ue]=rr}}function ue(nr,ir,Ue,rr){var or=ir&&ir.prototype instanceof Ce?ir:Ce,Pt=a(or.prototype),Et=new sr(rr||[]);return y(Pt,"_invoke",{value:Lt(nr,Ue,Et)}),Pt}function Y(nr,ir,Ue){try{return{type:"normal",arg:nr.call(ir,Ue)}}catch(rr){return{type:"throw",arg:rr}}}b.wrap=ue;var _e={};function Ce(){}function ze(){}function ie(){}var le={};Ne(le,D,function(){return this});var Ie=i&&i(i(hr([])));Ie&&Ie!==T&&k.call(Ie,D)&&(le=Ie);var pe=ie.prototype=Ce.prototype=a(le);function qe(nr){var ir;u(ir=["next","throw","return"]).call(ir,function(Ue){Ne(nr,Ue,function(rr){return this._invoke(Ue,rr)})})}function $e(nr,ir){var Ue;y(this,"_invoke",{value:function(rr,or){function Pt(){return new ir(function(Et,kt){(function er(cr,mr,vr,Tr){var Ir=Y(nr[cr],nr,mr);if(Ir.type!=="throw"){var kr=Ir.arg,Ar=kr.value;return Ar&&n(Ar)=="object"&&k.call(Ar,"__await")?ir.resolve(Ar.__await).then(function(Rr){er("next",Rr,vr,Tr)},function(Rr){er("throw",Rr,vr,Tr)}):ir.resolve(Ar).then(function(Rr){kr.value=Rr,vr(kr)},function(Rr){return er("throw",Rr,vr,Tr)})}Tr(Ir.arg)})(rr,or,Et,kt)})}return Ue=Ue?Ue.then(Pt,Pt):Pt()}})}function Lt(nr,ir,Ue){var rr="suspendedStart";return function(or,Pt){if(rr==="executing")throw new Error("Generator is already running");if(rr==="completed"){if(or==="throw")throw Pt;return Fe()}for(Ue.method=or,Ue.arg=Pt;;){var Et=Ue.delegate;if(Et){var kt=Dt(Et,Ue);if(kt){if(kt===_e)continue;return kt}}if(Ue.method==="next")Ue.sent=Ue._sent=Ue.arg;else if(Ue.method==="throw"){if(rr==="suspendedStart")throw rr="completed",Ue.arg;Ue.dispatchException(Ue.arg)}else Ue.method==="return"&&Ue.abrupt("return",Ue.arg);rr="executing";var er=Y(nr,ir,Ue);if(er.type==="normal"){if(rr=Ue.done?"completed":"suspendedYield",er.arg===_e)continue;return{value:er.arg,done:Ue.done}}er.type==="throw"&&(rr="completed",Ue.method="throw",Ue.arg=er.arg)}}}function Dt(nr,ir){var Ue=ir.method,rr=nr.iterator[Ue];if(rr===void 0)return ir.delegate=null,Ue==="throw"&&nr.iterator.return&&(ir.method="return",ir.arg=void 0,Dt(nr,ir),ir.method==="throw")||Ue!=="return"&&(ir.method="throw",ir.arg=new TypeError("The iterator does not provide a '"+Ue+"' method")),_e;var or=Y(rr,nr.iterator,ir.arg);if(or.type==="throw")return ir.method="throw",ir.arg=or.arg,ir.delegate=null,_e;var Pt=or.arg;return Pt?Pt.done?(ir[nr.resultName]=Pt.value,ir.next=nr.nextLoc,ir.method!=="return"&&(ir.method="next",ir.arg=void 0),ir.delegate=null,_e):Pt:(ir.method="throw",ir.arg=new TypeError("iterator result is not an object"),ir.delegate=null,_e)}function dr(nr){var ir={tryLoc:nr[0]};1 in nr&&(ir.catchLoc=nr[1]),2 in nr&&(ir.finallyLoc=nr[2],ir.afterLoc=nr[3]),this.tryEntries.push(ir)}function pr(nr){var ir=nr.completion||{};ir.type="normal",delete ir.arg,nr.completion=ir}function sr(nr){this.tryEntries=[{tryLoc:"root"}],u(nr).call(nr,dr,this),this.reset(!0)}function hr(nr){if(nr){var ir=nr[D];if(ir)return ir.call(nr);if(typeof nr.next=="function")return nr;if(!isNaN(nr.length)){var Ue=-1,rr=function or(){for(;++Ue<nr.length;)if(k.call(nr,Ue))return or.value=nr[Ue],or.done=!1,or;return or.value=void 0,or.done=!0,or};return rr.next=rr}}return{next:Fe}}function Fe(){return{value:void 0,done:!0}}return ze.prototype=ie,y(pe,"constructor",{value:ie,configurable:!0}),y(ie,"constructor",{value:ze,configurable:!0}),ze.displayName=Ne(ie,ae,"GeneratorFunction"),b.isGeneratorFunction=function(nr){var ir=typeof nr=="function"&&nr.constructor;return!!ir&&(ir===ze||(ir.displayName||ir.name)==="GeneratorFunction")},b.mark=function(nr){return d?d(nr,ie):(nr.__proto__=ie,Ne(nr,ae,"GeneratorFunction")),nr.prototype=a(pe),nr},b.awrap=function(nr){return{__await:nr}},qe($e.prototype),Ne($e.prototype,he,function(){return this}),b.AsyncIterator=$e,b.async=function(nr,ir,Ue,rr,or){or===void 0&&(or=c);var Pt=new $e(ue(nr,ir,Ue,rr),or);return b.isGeneratorFunction(ir)?Pt:Pt.next().then(function(Et){return Et.done?Et.value:Pt.next()})},qe(pe),Ne(pe,ae,"Generator"),Ne(pe,D,function(){return this}),Ne(pe,"toString",function(){return"[object Generator]"}),b.keys=function(nr){var ir=Object(nr),Ue=[];for(var rr in ir)Ue.push(rr);return m(Ue).call(Ue),function or(){for(;Ue.length;){var Pt=Ue.pop();if(Pt in ir)return or.value=Pt,or.done=!1,or}return or.done=!0,or}},b.values=hr,sr.prototype={constructor:sr,reset:function(nr){var ir;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,u(ir=this.tryEntries).call(ir,pr),!nr)for(var Ue in this)Ue.charAt(0)==="t"&&k.call(this,Ue)&&!isNaN(+v(Ue).call(Ue,1))&&(this[Ue]=void 0)},stop:function(){this.done=!0;var nr=this.tryEntries[0].completion;if(nr.type==="throw")throw nr.arg;return this.rval},dispatchException:function(nr){if(this.done)throw nr;var ir=this;function Ue(er,cr){return Pt.type="throw",Pt.arg=nr,ir.next=er,cr&&(ir.method="next",ir.arg=void 0),!!cr}for(var rr=this.tryEntries.length-1;rr>=0;--rr){var or=this.tryEntries[rr],Pt=or.completion;if(or.tryLoc==="root")return Ue("end");if(or.tryLoc<=this.prev){var Et=k.call(or,"catchLoc"),kt=k.call(or,"finallyLoc");if(Et&&kt){if(this.prev<or.catchLoc)return Ue(or.catchLoc,!0);if(this.prev<or.finallyLoc)return Ue(or.finallyLoc)}else if(Et){if(this.prev<or.catchLoc)return Ue(or.catchLoc,!0)}else{if(!kt)throw new Error("try statement without catch or finally");if(this.prev<or.finallyLoc)return Ue(or.finallyLoc)}}}},abrupt:function(nr,ir){for(var Ue=this.tryEntries.length-1;Ue>=0;--Ue){var rr=this.tryEntries[Ue];if(rr.tryLoc<=this.prev&&k.call(rr,"finallyLoc")&&this.prev<rr.finallyLoc){var or=rr;break}}or&&(nr==="break"||nr==="continue")&&or.tryLoc<=ir&&ir<=or.finallyLoc&&(or=null);var Pt=or?or.completion:{};return Pt.type=nr,Pt.arg=ir,or?(this.method="next",this.next=or.finallyLoc,_e):this.complete(Pt)},complete:function(nr,ir){if(nr.type==="throw")throw nr.arg;return nr.type==="break"||nr.type==="continue"?this.next=nr.arg:nr.type==="return"?(this.rval=this.arg=nr.arg,this.method="return",this.next="end"):nr.type==="normal"&&ir&&(this.next=ir),_e},finish:function(nr){for(var ir=this.tryEntries.length-1;ir>=0;--ir){var Ue=this.tryEntries[ir];if(Ue.finallyLoc===nr)return this.complete(Ue.completion,Ue.afterLoc),pr(Ue),_e}},catch:function(nr){for(var ir=this.tryEntries.length-1;ir>=0;--ir){var Ue=this.tryEntries[ir];if(Ue.tryLoc===nr){var rr=Ue.completion;if(rr.type==="throw"){var or=rr.arg;pr(Ue)}return or}}throw new Error("illegal catch attempt")},delegateYield:function(nr,ir,Ue){return this.delegate={iterator:hr(nr),resultName:ir,nextLoc:Ue},this.method==="next"&&(this.arg=void 0),_e}},b}t.exports=g,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(647)},function(t,r,e){t.exports=e(648)},function(t,r,e){var n=e(649);t.exports=n},function(t,r,e){var n=e(229);t.exports=n},function(t,r,e){t.exports=e(651)},function(t,r,e){var n=e(652);e(653),e(654),e(655),e(656),t.exports=n},function(t,r,e){var n=e(231);t.exports=n},function(t,r,e){e(232)},function(t,r,e){e(246)},function(t,r,e){var n=e(1),o=e(68),s=e(100);n({target:"Promise",stat:!0,forced:!0},{try:function(a){var i=o.f(this),u=s(a);return(u.error?i.reject:i.resolve)(u.value),i.promise}})},function(t,r,e){e(247)},function(t,r,e){t.exports=e(658)},function(t,r,e){t.exports=e(659)},function(t,r,e){var n=e(660);t.exports=n},function(t,r,e){var n=e(275);t.exports=n},function(t,r,e){t.exports=e(662)},function(t,r,e){var n=e(663);t.exports=n},function(t,r,e){var n=e(250);t.exports=n},function(t,r,e){var n=e(102),o=e(103),s=e(2),a=e(7),i=e(15),u=e(69),d=e(23),c=e(3),m=e(25),v=e(75).fn,g=e(40),b=e(665),T=e(13),k=e(0),y=e(666);function O(){this.logger.log("offlineListener enter"),this.forceDisconnect(),this.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to network offline")),this.options.ondisconnect&&this.options.ondisconnect({code:"offlineListener",callFunc:"link::offlineListener",message:"offlineListener disconnect"}),this.onDisconnect("link::offlineListener","broken")}function D(){var he=this;this.logger.log("onlineListener start"),this&&this.isConnected()&&!this.connecting?(this.stopHeartbeat(),this.sendCmd("heartbeat",null,function(ae){if(ae){he.logger.info("onlineListener heartbeat detect error",ae);try{he.forceDisconnect(),he.onDisconnect("link::onHeartbeat","broken")}catch(Ne){he.logger.info("onlineListener heartbeat websocket.onclose",Ne)}}else he.logger.log("onlineListener heartbeat detect success")})):this.logger.log("onlineListener disconnected or connecting",this&&this.isConnected(),this.connecting)}v.initConnect=function(){this.socket=null,this.retryCount=0,this.connecting=!1,this.shouldReconnect=!0,this.hasNotifyDisconnected=!1,this.doLogout=!1},v.resetConnect=function(){var he=this.options;k.notundef(he.needReconnect)?(k.verifyParamType("needReconnect",he.needReconnect,"boolean","link::resetConnect"),this.needReconnect=he.needReconnect):this.needReconnect=!0,this.logger.info("link::resetConnect: needReconnect ".concat(this.needReconnect)),k.notundef(he.reconnectionAttempts)&&k.verifyParamType("reconnectionAttempts",he.reconnectionAttempts,"number","link::resetConnect"),k.notundef(he.noCacheLinkUrl)&&k.verifyParamType("noCacheLinkUrl",he.noCacheLinkUrl,"boolean","link::resetConnect"),this.reconnectionAttempts=typeof he.reconnectionAttempts=="number"?he.reconnectionAttempts:1/0,this.backoff=new b({min:T.reconnectionDelay,max:T.reconnectionDelayMax,jitter:T.reconnectionJitter})},v.reportTCPException=function(he){var ae=this;s(he).call(he,function(Ne,ue){var Y,_e=Ne.event,Ce=_e===void 0?{}:_e,ze=Ne.message,ie=Ce.startTime,le=Ce.code,Ie=Ce.reason,pe=Ce.url,qe="";ze==="handshake_failed"?qe="handshake_failed":ze==="connect_failed"?qe=Ie?"connect_failed:".concat(Ie):"connect_failed":ze==="socket_error"&&(qe=Ie?"socket.io error:".concat(Ie):"socket.io error"),ae.logger.warn(a(Y="connect::failed ".concat(ue,", ")).call(Y,qe),Ne),ae.reporter.reportTraceStart("exceptions",{user_id:ae.options.account,trace_id:k.get(self,"socket.socket.sessionid"),start_time:ie,action:0,exception_service:6}),ae.reporter.reportTraceUpdateV2("exceptions",{code:le,description:ze,operation_type:0,target:pe}),ae.reporter.reportTraceEnd("exceptions",1)})},v.connect=o(n.mark(function he(){var ae,Ne,ue,Y,_e;return n.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:if(ue=this,clearTimeout(ue.connectTimer),!ue.isConnected()){Ce.next=5;break}return ue.logger.warn("link::connect: already connected"),Ce.abrupt("return");case 5:if(!ue.connecting){Ce.next=8;break}return ue.logger.warn("link::connect: already connecting"),Ce.abrupt("return");case 8:if(ue.connecting=!0,ue.hasNotifyDisconnected=!1,ue.shouldReconnect=!0,ue.socket&&ue.forceDisconnect(),ue.logger.info("link::connect: connect to new socket, autoconnect is "+ue.autoconnect),typeof ue.options.socketUrl=="string"&&(ue.logger.info("link::connect: try to options.socketUrl ",ue.options.socketUrl),ue.socketUrls=[ue.options.socketUrl]),Ce.prev=14,ue.socketUrls&&ue.socketUrls.length>0){Ce.next=20;break}return Ce.next=18,ue.refreshSocketUrl();case 18:ue.socketUrls=y(ue.socketUrls),ue.logger.info("link::connect: refreshSocketUrl success, socketConcurrent ".concat(ue.imsocket.config.socketConcurrent),ue.socketUrls);case 20:Ce.next=28;break;case 22:return Ce.prev=22,Ce.t0=Ce.catch(14),ue.logger.warn("connect::refreshSocketUrl: catch exception,",Ce.t0&&Ce.t0.message),ue.connecting=!1,this.options.ondisconnect({code:"initConnectFail",callFunc:"ProtocolFn.connect",message:"refresh socket url fail"}),Ce.abrupt("return");case 28:return ue.imsocket.resetSockets(),ue.imsocket.setUrls(i(ae=ue.socketUrls).call(ae,0)),u(Ne=ue.socketUrls).call(Ne,0,ue.imsocket.config.socketConcurrent),Ce.prev=31,Ce.next=34,ue.imsocket.connect();case 34:ue.socket=Ce.sent,ue.onConnect(),Ce.next=46;break;case 38:Ce.prev=38,Ce.t1=Ce.catch(31),_e="",Ce.t1.errors&&(ue.reportTCPException(Ce.t1.errors),Y=Ce.t1.errors[0]),Y.message==="handshake_failed"?(ue.onHandshakeFailed(Y.event.startTime,Y.event.url),_e="link::onHandshakeFailed"):Y.message==="connect_failed"?(ue.onConnectFailed(Y.event.reason,Y.event.startTime,Y.event.url),_e="link::onConnectFailed"):Y.message==="socket_error"?(ue.onSocketError(Y.event.reason,Y.event.startTime,Y.event.url),_e="link::onSocketError"):(_e="link::otherFailed",ue.logger.warn("link::otherFailed",Y)),this.statusProtector.emit("auth/loginLifeCycleConnectFail",new Error("".concat(_e," 408"))),ue.connecting=!1,ue.willReconnect()?ue.onDisconnect(_e):this.options.ondisconnect({code:"initConnectFail",callFunc:"ProtocolFn.connect",message:"init connect fail"});case 46:case"end":return Ce.stop()}},he,this,[[14,22],[31,38]])})),v.isConnected=function(){return!!this.socket&&!!this.socket.socket&&this.socket.socket.connected},v.disconnect=function(){var he=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){},ae=this;function Ne(ue){clearTimeout(ae.disconnectCallbackTimer),ae.msgAckBufferManager&&ae.msgAckBufferManager.clear(),ae.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to active action")),ae.statusProtector.emit("auth/loginLifeCycleLogout"),d(function(){he(ue)},0)}clearTimeout(ae.connectTimer),ae.disconnectCallbackTimer=d(function(){he.call(ae,"mark disconnected due to timeout")},1e4),ae.mixStorePolicy=null,ae.appGrayConfig=null,ae.resetReconnectStatus(),clearTimeout(ae.mixStorePolicyClock),this.onlineListener&&typeof window<"u"&&k.isFunction(window.removeEventListener)&&(window.removeEventListener("online",this.onlineListener),window.removeEventListener("offline",this.offlineListener),this.onlineListener=null,this.offlineListener=null),ae.isConnected()?(ae.logger.warn("link::disconnect: start disconnecting"),ae.logout()):ae.connecting?(ae.logger.warn("link::disconnect: abort connecting"),ae.disconnectSocket()):(ae.logger.warn("link::disconnect: already disconnected"),ae.connecting=!1,ae.shouldReconnect=!1,ae.socket=null,ae.autoconnect=!1,ae.options.ondisconnect({code:"alreadyDisconnected",callFunc:"link::disconnect",message:"manually disconnect status"})),ae.socket&&ae.socket.socket&&ae.socket.socket.transport?ae.socket.socket.transport.onDisconnectDone=function(ue){ae.logger.warn("link::disconnect: invoke [done] when socket closed",ue),Ne(ue)}:(ae.logger.warn("link::disconnect: invoke [done]"),Ne(null))},v.resetReconnectStatus=function(){this.backoff&&(this.backoff.setMin(T.reconnectionDelay),this.backoff.setMax(T.reconnectionDelayMax),this.backoff.reset()),this.retryCount=0,this.autoconnect=!0,this.logger.info("link::resetReconnectStatus: reset retryCount and backoff")},v.onConnect=function(){this.connecting=!1,this.shouldReconnect=!0,this.hasNotifyDisconnected=!1,this.logger.info("link::onConnect success"),this.statusProtector.emit("auth/loginLifeCycleConnectSucc"),this.login()},v.onDisconnect=function(){var he=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,ae=arguments.length>1?arguments[1]:void 0,Ne=this;this.logger.warn("socket::onDisconnect: "+he),Ne.connecting=!1,Ne.markAllCallbackInvalid(g.newNetworkError({callFunc:he,uploadCode:415,disconnectReason:ae})),Ne.msgAckBufferManager&&Ne.msgAckBufferManager.clear(),Ne.stopHeartbeat(),Ne.reconnect()},v.willReconnect=function(){return this.shouldReconnect&&this.needReconnect&&this.retryCount<this.reconnectionAttempts},v.reconnect=function(){var he=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.__destroyed)if(this.willReconnect()){if(this.socket&&(this.logger.info("link::reconnect: try to force disconnect"),this.forceDisconnect()),this.socketUrls.length===0&&!this.options.socketUrl&&typeof he.allFailedCB=="function")return this.logger.log("reconnect: All socket links have been polled, trigger hooks"),void he.allFailedCB();this.doReconnect()}else this.notifyDisconnect({code:"allAttemptsFailed",message:"All attempts failed"})},v.doReconnect=function(){var he,ae=this;ae.socket=null,ae.retryCount++,ae.hasLogin=!1;var Ne,ue=ae.backoff.duration();ae.logger.info(a(he="link::reconnect: will retry after ".concat(ue,"ms, retryCount ")).call(he,ae.retryCount)),Ne=ae.options.onwillreconnect({retryCount:ae.retryCount,duration:ue}),ae.statusProtector.emit("auth/loginLifeCycleWaiting"),clearTimeout(ae.connectTimer),ae.connectTimer=d(function(){+ae.options.authType==1&&Ne instanceof c?(ae.logger.info("link::reconnect: wait onwillreconnect promise"),Ne.finally(function(){return ae.connect()})):ae.connect()},ue)},v.notifyConnectError=function(he){var ae=g.newConnectError({message:he,callFunc:"link::notifyConnectError"});this.logger.error("link::notifyConnectError:",ae),this.options.onerror(ae)},v.notifyDisconnect=function(he){this.hasNotifyDisconnected?this.logger.warn("notifyDisconnect:: already notified"):(this.hasNotifyDisconnected=!0,this.disconnectSocket(),this.forceDisconnect(),(he=he||new g).retryCount=this.retryCount,he.willReconnect=this.willReconnect(),this.backoff&&this.backoff.reset(),this.retryCount=0,this.autoconnect=!1,this.logger.info("link::notifyDisconnect: ondisconnected",he),this.options.ondisconnect(he),this.onWbNotifyHangup instanceof Function&&this.onWbNotifyHangup({content:{account:this.account,channelId:null,timetag:+Date()}}))},v.disconnectSocket=function(){if(this.isConnected()||this.connecting){this.connecting=!1,this.shouldReconnect=!1;try{this.socket&&this.socket.disconnect()}catch(he){this.socket&&typeof this.socket.removeAllListenersX=="function"&&this.socket.removeAllListenersX("info"),this.logger.info("link::disconnectSocket: disconnect failed, error ",he&&he.message)}}},v.initOnlineListener=function(){this.needReconnect&&this.options&&this.options.quickReconnect?typeof window<"u"&&k.isFunction(window.addEventListener)?this.onlineListener||(this.onlineListener=m(D).call(D,this),this.offlineListener=m(O).call(O,this),this.logger.info("initOnlineListener success"),window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener)):this.logger.warn("initOnlineListener no window.addEventListener"):this.logger.warn("initOnlineListener no quickReconnect")},v.forceDisconnect=function(){var he=this.socket||{};this.socket=null;try{typeof he.removeAllListenersX=="function"&&he.removeAllListenersX("info"),typeof he.disconnect=="function"&&he.disconnect()}catch(ae){this.logger.error("forceDisconnect:: oldSocket error",ae||ae.message)}this.hasLogin=!1}},function(t,r){function e(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}t.exports=e,e.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var o=Math.random(),s=Math.floor(o*this.jitter*n);n=1&Math.floor(10*o)?n+s:n-s}return 0|Math.min(n,this.max)},e.prototype.reset=function(){this.attempts=0},e.prototype.setMin=function(n){this.ms=n},e.prototype.setMax=function(n){this.max=n},e.prototype.setJitter=function(n){this.jitter=n}},function(t,r,e){var n=e(667);t.exports=function(o){return o&&o.length?n(o):[]}},function(t,r,e){var n=e(668),o=e(671),s=e(676),a=e(677),i=e(678),u=e(289);t.exports=function(d,c,m){var v=-1,g=o,b=d.length,T=!0,k=[],y=k;if(m)T=!1,g=s;else if(b>=200){var O=c?null:i(d);if(O)return u(O);T=!1,g=a,y=new n}else y=c?[]:k;e:for(;++v<b;){var D=d[v],he=c?c(D):D;if(D=m||D!==0?D:0,T&&he==he){for(var ae=y.length;ae--;)if(y[ae]===he)continue e;c&&y.push(he),k.push(D)}else g(y,he,m)||(y!==k&&y.push(he),k.push(D))}return k}},function(t,r,e){var n=e(259),o=e(669),s=e(670);function a(i){var u=-1,d=i==null?0:i.length;for(this.__data__=new n;++u<d;)this.add(i[u])}a.prototype.add=a.prototype.push=o,a.prototype.has=s,t.exports=a},function(t,r){t.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(t,r){t.exports=function(e){return this.__data__.has(e)}},function(t,r,e){var n=e(672);t.exports=function(o,s){return!!(o!=null&&o.length)&&n(o,s,0)>-1}},function(t,r,e){var n=e(673),o=e(674),s=e(675);t.exports=function(a,i,u){return i==i?s(a,i,u):n(a,o,u)}},function(t,r){t.exports=function(e,n,o,s){for(var a=e.length,i=o+(s?1:-1);s?i--:++i<a;)if(n(e[i],i,e))return i;return-1}},function(t,r){t.exports=function(e){return e!=e}},function(t,r){t.exports=function(e,n,o){for(var s=o-1,a=e.length;++s<a;)if(e[s]===n)return s;return-1}},function(t,r){t.exports=function(e,n,o){for(var s=-1,a=e==null?0:e.length;++s<a;)if(o(n,e[s]))return!0;return!1}},function(t,r){t.exports=function(e,n){return e.has(n)}},function(t,r,e){var n=e(271),o=e(679),s=e(289),a=n&&1/s(new n([,-0]))[1]==1/0?function(i){return new n(i)}:o;t.exports=a},function(t,r){t.exports=function(){}},function(t,r,e){var n,o=e(75).fn,s=e(40),a=e(193),i=e(0),u=e(13),d=e(44),c=e(74),m=i.notundef;o.genSessionKey=(n={},function(){var v=this.name;return n[v]=n[v]||i.guid()}),o.afterLogin=i.emptyFunc,o.assembleIMLogin=function(){var v=this.options,g=v.account;this.sdkSession=this.genSessionKey();var b={appLogin:this.autoconnect?0:1,appKey:v.appKey,account:g,token:v.token,sdkVersion:u.info.sdkVersion,sdkHumanVersion:u.info.sdkHumanVersion,protocolVersion:u.info.protocolVersion,os:c.os.toString()==="[object Object]"?c.os.family:c.os.toString(),browser:c.name+" "+c.version,clientType:u.CLIENTTYPE||16,session:this.sdkSession,deviceId:d.deviceId,isReactNative:u.isRN?1:0,customTag:v.customTag||"",sdkType:0};return b.userAgent="Native/".concat(u.info.sdkHumanVersion),u.isBrowser?b.sdkType=0:u.isRN?b.sdkType=2:u.isWeixinApp&&(b.sdkType=6),v.customClientType&&(b.customClientType=+v.customClientType),v.authType&&(b.authType=+v.authType),v.loginExt&&(b.loginExt=v.loginExt),b},o.notifyLogin=function(v){this.logger.info("link::notifyLogin: on connect",v),this.options.onconnect(v)},o.logout=function(){if(this.doLogout)return this.doLogout=!1,void this.onAuthError(new s("done logout","logout",{disconnectReason:"close",uploadCode:415}),"link::logout");this.isConnected()&&this.onAuthError(new s("done disconnect","logout",{disconnectReason:"close",uploadCode:415}),"link::logout")},o.onKicked=function(v){var g=v.content,b=g.from,T=g.reason,k=g.custom,y=g.customClientType,O={reason:this.kickedReasons[T]||"unknown",message:this.kickedMessages[T]||""};m(b)&&(O.from=a.reverseType(b)),m(k)&&(O.custom=k),+y>0&&(O.customClientType=y),this.logger.warn("link::onKicked:",O);var D=new s("","kicked",{disconnectReason:"kicked",uploadCode:415});i.merge(D,O),this.onAuthError(D,"link::onKicked"),this.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to kicked")),this.statusProtector.emit("auth/loginLifeCycleKicked",O)},o.onAuthError=function(v,g){var b=v&&v.code;if(this.logger.error("onAuthError ",g,b),/^(Error_Internet_Disconnected|Error_Timeout|Error_Connection_Socket_State_not_Match)$/.test(b))return this.forceDisconnect(),void this.onDisconnect("link::onAuthError::"+b,"broken");(v=v||s.newConnectionError({callFunc:g,uploadCode:415,disconnectReason:"close"})).callFunc=v.callFunc||g||null,this.shouldReconnect=!1,this.markAllCallbackInvalid(v),this.notifyDisconnect(v)}},function(t,r,e){var n=e(23),o=e(25),s=e(26),a=e(75).fn,i=e(13),u=e(0);a.processLink=function(d){switch(d.cmd){case"heartbeat":this.startHeartbeat();break;case"notifyDetect":s(u._get(d,"content.notifyDetectTag"))==="object"&&(d.content.notifyDetectTag.t3=new Date().getTime(),this.startDetect(d))}},a.startHeartbeat=function(){var d=this;d.stopHeartbeat(),d.heartbeatTimer=n(function(){var c;d.sendCmd("heartbeat",null,o(c=d.onHeartbeat).call(c,d))},i.heartbeatInterval)},a.startDetect=function(d){var c=d.content.notifyDetectTag;c.t4=new Date().getTime(),this.sendCmd("uploadDetect",{notifyDetectTag:c})},a.stopHeartbeat=function(){this.heartbeatTimer&&(clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null)},a.onHeartbeat=function(d){if(d){if(this.syncing)return this.logger.warn("onHeartbeat::ignore error in connecting"),void this.startHeartbeat();var c;d.callFunc="link::onHeartbeat",this.onCustomError("heartbeat error",d),this.heartbeatFail++,this.logger.warn("onHeartbeat::error ",d.code,d),d.code==="Error_Timeout"&&(this.checkNetworkAvailable()!==!1?this.heartbeatFail>1?(this.forceDisconnect(),this.onDisconnect("link::onHeartbeat","broken")):this.sendCmd("heartbeat",null,o(c=this.onHeartbeat).call(c,this)):this.startHeartbeat())}else this.heartbeatFail=0},a.checkNetworkAvailable=typeof navigator<"u"&&typeof navigator.onLine=="boolean"?function(){return navigator.onLine}:function(){},a.heartbeat=function(){}},function(t,r,e){var n=e(3),o=e(6),s=e(23),a=e(52),i=e(75).fn,u=e(285),d=e(13),c=e(44);i.processMisc=function(m){switch(m.cmd){case"getSimpleNosToken":m.error||(m.obj=m.content.nosTokens[0]);break;case"getNosToken":m.error||(m.obj=m.content.nosToken);break;case"getGrayscaleConfig":m.error||(m.obj=m.content.appGrayConfigTag);break;case"getMixStorePolicy":m.error||(m.obj=m.content.mixStorePolicyTag);break;case"getMixStoreToken":m.error||(m.obj=m.content.mixStoreTokenTag);break;case"getBackSourceToken":m.error||(m.obj=m.content.backSourceTokenTag);break;case"uploadSdkLogUrl":m.error?this.logger.error("uploadSdkLogUrl::error",m.error):this.logger.info("uploadSdkLogUrl::success",m.obj&&m.obj.url);break;case"notifyUploadLog":m.error||(d.isRN?this.uploadLocalLogRN():d.isBrowser&&this.uploadLocalLogWeb(),this.emitAPI({type:"notifyUploadLog"}));break;case"audioToText":m.error||(m.obj.text=m.content.text);break;case"processImage":m.obj.imageOps=u.reverseImageOps(m.obj.imageOps),m.error||(m.obj={url:m.content.url});break;case"getNosTokenTrans":m.error||(m.obj={nosToken:m.content.nosToken,docId:m.content.docId});break;case"getNosOriginUrl":m.error||(m.obj=m.content.nosFileUrlTag.originUrl);break;case"notifyTransLog":m.error||this.emitAPI({type:"notifyTransLog",obj:m.content.transInfo});break;case"fetchFile":case"fetchFileList":case"removeFile":m.error||(m.obj=m.content);break;case"getServerTime":m.obj=m.content&&m.content.time;break;case"getNosCdnHost":this.getNosCdnHost(m)}},i.uploadLocalLogRN=function(){if(d.isRN&&c.rnfs){var m=c.rnfs,v=this,g=m.nimIndex,b=(m.nimIndex+1)%2;m.nimPromise=m.nimPromise.then(function(){return n.all([m.exists(T(g)),m.exists(T(b))])}).then(function(k){return k&&(k[0]||k[1])?k[0]&&k[1]?m.copyFile(T(b),T(2)).then(function(){return m.readFile(T(g))}).then(function(y){return m.appendFile(T(2),y)}):k[0]?m.copyFile(T(g),T(2)):void(k[1]&&m.copyFile(T(b),T(2))):n.reject()}).then(function(){return new n(function(k){v.api.previewFile({filePath:T(2),done:function(y,O){if(n.all([m.unlink(T(2)),m.unlink(T(1)),m.unlink(T(0))]).finally(function(){k()}),y)v.logger.error("nim::uploadLocalLogRN:previewFile:error",y);else{var D=O.url;o(D).call(D,"?")>0?D+="&":D+="?",D+="download="+new Date().getTime()+"_rn.log",v.api.uploadSdkLogUrl({url:D})}}})})}).catch(function(k){m.unlink(T(2)).catch(function(){}),v.logger.error("nim::protocol::uploadLocalLogRN",k)})}function T(k){return m.DocumentDirectoryPath+"/nimlog_"+k+".log"}},i.uploadLocalLogWeb=function(){var m=this;this.options.dbLog!==!1&&this.logger._local?this.logger._local.fetchLog().then(function(v){m.api.previewFile({blob:new Blob([v.logs],{type:"text/plain"}),done:function(g,b){if(g)m.logger.error("uploadLocalLogWeb::previewFile:error",g);else{m.logger.log("uploadLocalLogWeb::previewFile:success",b);var T=b.url;T+=(o(T).call(T,"?")>0?"&":"?")+"download="+new Date().getTime()+"_web.log",m.api.uploadSdkLogUrl({url:T}),m.logger._local.deleteLogs(v.time).then(function(){m.logger.log("uploadLocalLogWeb::deleteLogs success")}).catch(function(k){return m.logger.error("uploadLocalLogWeb::deleteLogs:error ,",k)})}}})}).catch(function(v){m.logger.error("uploadLocalLogWeb::fetchLog:error",v)}):this.logger.warn("uploadLocalLogWeb::no dbLog")},i.getNosCdnHost=function(m){var v=this,g=m.error;if(g&&(g.callFunc="events::getNosCdnHost",v.onCustomError("getNosCdnHost","EVENT_GET_NOS_CDN_HOST_ERROR",g)),m.content&&m.content.nosConfigTag){var b=m.content.nosConfigTag,T="",k="";b.expire!==0&&b.cdnDomain?b.expire===-1?(T=b.cdnDomain,k=b.objectNamePrefix):(T=b.cdnDomain,k=b.objectNamePrefix,v.nosCdnHostTimer&&clearTimeout(v.nosCdnHostTimer),v.nosCdnHostTimer=s(function(){v.sendCmd("getNosCdnHost",{})},800*a(b.expire))):(T="",k=""),d.serverNosConfig.cdnDomain=T,d.serverNosConfig.objectPrefix=k,d.hasLocalStorage&&(localStorage.setItem("nim_cdn_domain",T),localStorage.setItem("nim_object_prefix",k))}}},function(t,r,e){var n=e(8),o=e(32),s=e(75).fn,a=e(0),i=e(286),u=e(105).EMSyncType;s.processAvSignal=function(c){switch(c.cmd){case"signalingCreate":case"signalingDelay":case"signalingClose":case"signalingJoin":case"signalingLeave":case"signalingInvite":case"signalingCancel":case"signalingReject":case"signalingAccept":case"signalingControl":case"signalingSyncMsgRead":case"signalingGetChannelInfo":case"signalingCallEx":break;case"signalingNotify":this.onSignalingNotify(c);break;case"signalingMutilClientSyncNotify":this.onSignalingMutilClientSyncNotify(c);break;case"signalingUnreadMessageSyncNotify":this.onSignalingUnreadMessageSyncNotify(c);break;case"signalingChannelsSyncNotify":this.onSignalingMembersSyncNotify(c);break;default:this.logger.warn("avSignal::unhandled cmd:",c.cmd)}};var d=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(c.needPush&&(c.needPush=c.needPush==="1"),c.needBadge&&(c.needBadge=c.needBadge==="1"),c.channelInValid&&(c.channelInValid=c.channelInValid==="1"),c.attach){var m=JSON.parse(c.attach);c.eventType=i.parseAvSignalType(m.type)}if(c.members){var v=JSON.parse(c.members);c.members=n(v).call(v,function(g){return i.parseAvSignalMember(g)})}return c};s.onSignalingNotify=function(c){if(c.error){var m=c.error;this.logger.error("protocal::avSignal:onSignalingNotify error",m),this.emitAPI({type:"error",error:m}),this.options.onerror(m)}else{c.raw&&c.raw.r&&c.raw.r.length&&c.content&&c.content.avSignalTag&&(c.content.avSignalTag.msgid=c.raw.r[0]);var v=c.content.avSignalTag;v=o(v)?n(v).call(v,function(g){return d(g)}):d(v),this.emitAPI({type:"signalingNotify",obj:v}),a.isFunction(this.options.onSignalingNotify)&&this.options.onSignalingNotify(v)}},s.onSignalingMutilClientSyncNotify=function(c){if(c.error){var m=c.error;this.logger.error("protocal::avSignal:onSignalingMutilClientSyncNotify error",m),this.emitAPI({type:"error",error:m}),this.options.onerror(m)}else{var v=c.content.avSignalTag;v=o(v)?n(v).call(v,function(g){return d(g)}):d(v),this.emitAPI({type:"signalingMutilClientSyncNotify",obj:v}),a.isFunction(this.options.onSignalingMutilClientSyncNotify)&&this.options.onSignalingMutilClientSyncNotify(v)}},s.onSignalingUnreadMessageSyncNotify=function(c){if(c.error){var m=c.error;this.logger.error("protocal::avSignal:onSignalingUnreadMessageSyncNotify error",m),this.emitAPI({type:"error",error:m}),this.options.onerror(m)}else{var v=c.content.avSignalTag;o(v)&&(v=n(v).call(v,function(g){return d(g)})),this.emitAPI({type:"signalingUnreadMessageSyncNotify",obj:v}),this.reporterHook.emit("reporter/syncItemComplete",u.kSyncType15_13),a.isFunction(this.options.onSignalingUnreadMessageSyncNotify)&&this.options.onSignalingUnreadMessageSyncNotify(v)}},s.onSignalingMembersSyncNotify=function(c){if(c.error){var m=c.error;this.logger.error("protocal::avSignal:onSignalingMembersSyncNotify error",m),this.emitAPI({type:"error",error:m}),this.options.onerror(m)}else{var v=c.content.avSignalTag;o(v)||(v=[v]),v=n(v).call(v,function(g){return d(g)}),this.emitAPI({type:"signalingChannelsSyncNotify",obj:v}),a.isFunction(this.options.onSignalingMembersSyncNotify)&&this.options.onSignalingMembersSyncNotify(v)}}},function(t,r,e){var n=e(10),o=e(25),s=e(0),a=e(75).fn,i=e(116),u=e(277);a.adaptersRequest=function(d){var c=this,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},v=arguments.length>2?arguments[2]:void 0,g=m.onerror||function(){},b=new Date().getTime(),T=s.get(v,"exception_service")||0;return m.onerror=function(){g.apply(void 0,arguments);var k=arguments.length<=0?void 0:arguments[0];c.reporter.reportTraceStart("exceptions",{user_id:c.account,trace_id:s.get(self,"socket.socket.sessionid"),start_time:b,action:1,exception_service:T}),c.reporter.reportTraceUpdateV2("exceptions",{code:typeof k.status=="number"?k.status:typeof k.code=="number"?k.code:0,description:k.message||"".concat(k.code),operation_type:0,target:d,context:m?n(m):"",net_connect:c.checkNetworkAvailable()}),c.reporter.reportTraceEnd("exceptions",1)},i(d,m)},a.adaptersUploadFile=function(d,c){var m,v=this;d.adaptersRequest=o(m=a.adaptersRequest).call(m,this);var g=new Date().getTime();return d.errorHook=function(b){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(b){v.reporter.reportTraceStart("exceptions",{user_id:v.account,trace_id:s.get(self,"socket.socket.sessionid"),start_time:g,action:1,exception_service:T.provider==="s3"?4:3});var k=T.url||d.url;b.bucket&&(k=n(b)),v.reporter.reportTraceUpdateV2("exceptions",{code:typeof b.status=="number"?b.status:typeof b.code=="number"?b.code:0,description:b.message||"".concat(b.code),operation_type:1,target:k,net_connect:v.checkNetworkAvailable()}),v.reporter.reportTraceEnd("exceptions",1)}},new u(d,this,c)}},function(t,r,e){e(291);var n,o,s,a=e(47),i=e(57),u=e(41),d=e(2),c=e(3),m=e(5),v=e(23),g=e(17),b=e(15),T=e(7),k=e(26);s=function(){function y(he,ae){for(var Ne=0;Ne<ae.length;Ne++){var ue=ae[Ne];ue.enumerable=ue.enumerable||!1,ue.configurable=!0,"value"in ue&&(ue.writable=!0),a(he,ue.key,ue)}}var O={isDataReportEnable:!0,maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0},D=function(){};return function(){function he(ue){(function(Y,_e){if(!(Y instanceof _e))throw new TypeError("Cannot call a class as a function")})(this,he),this.isUploadEnable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=O,this.traceMsgCache={},this.highPriorityMsgList=[],this.msgList=[],this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=i(),this.timer=null,this.setConfig(ue),this.reportConfig.isDataReportEnable&&this.reportConfig.autoStart&&this.initUploadConfig()}var ae,Ne;return ae=he,(Ne=[{key:"setConfig",value:function(ue){this.reportConfig=u({},this.reportConfig,ue),this.reportConfig.common.sdk_type||(this.reportConfig.common.sdk_type="im")}},{key:"reportImmediately",value:function(ue,Y){var _e=this;this.reportConfig.isDataReportEnable&&this.reportConfig.request(ue,u({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},Y)).catch(function(Ce){var ze,ie;(ie=(ze=_e.reportConfig)===null||ze===void 0?void 0:ze.logger)===null||ie===void 0||ie.warn("Reporter immediately upload failed",Ce)})}},{key:"report",value:function(ue,Y){var _e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(_e.priority||(_e.priority=this.getEventPriority(ue,Y)),this.reportConfig.isDataReportEnable&&ue){var Ce=i();_e.priority==="HIGH"?this.highPriorityMsgList.push({module:ue,msg:Y,createTime:Ce}):_e.priority==="NORMAL"?this.msgList.push({module:ue,msg:Y,createTime:Ce}):_e.priority==="LOW"&&this.lowPriorityMsgList.push({module:ue,msg:Y,createTime:Ce}),this.highPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.highPriorityMsgList.shift(),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function(ue,Y){if(this.reportConfig.isDataReportEnable&&ue&&!this.traceMsgCache[ue]){var _e=u(u({start_time:i()},Y),{extension:[]});this.traceMsgCache[ue]=_e}}},{key:"reportTraceUpdate",value:function(ue){}},{key:"reportTraceUpdateV2",value:function(ue,Y,_e){var Ce,ze=this;if(this.reportConfig.isDataReportEnable&&this.traceMsgCache[ue]){var ie=this.traceMsgCache[ue].extension.length,le=new Date().getTime();Y.duration=ie===0?le-this.traceMsgCache[ue].start_time:le-this.traceMsgCache[ue].extension[ie-1].end_time,this.traceMsgCache[ue].extension.push(u({end_time:le},Y)),_e!=null&&_e.asyncParams&&((Ce=this.traceMsgCache[ue]).asyncPromiseArray||(Ce.asyncPromiseArray=[]),this.traceMsgCache[ue].asyncPromiseArray.push(_e.asyncParams.then(function(Ie){var pe=ze.traceMsgCache[ue].extension.length-1;u(ze.traceMsgCache[ue].extension[pe],Ie)})))}}},{key:"reportTraceEnd",value:function(ue){var Y,_e=this,Ce=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reportConfig.isDataReportEnable&&this.traceMsgCache[ue])if(ue!=="nos"||Ce===!1)if(typeof Ce=="boolean"?this.traceMsgCache[ue].succeed=!!Ce:this.traceMsgCache[ue].state=Ce,this.traceMsgCache[ue].duration=i()-this.traceMsgCache[ue].start_time,d(Y=this.traceMsgCache[ue].extension).call(Y,function(ie){delete ie.end_time}),this.traceMsgCache[ue].asyncPromiseArray){var ze=this.traceMsgCache[ue];c.all(this.traceMsgCache[ue].asyncPromiseArray).finally(function(){ze===_e.traceMsgCache[ue]&&(delete _e.traceMsgCache[ue].asyncPromiseArray,_e.report(ue,_e.traceMsgCache[ue],{priority:_e.getEventPriority(ue,_e.traceMsgCache[ue])}),_e.traceMsgCache[ue]=null)})}else this.report(ue,this.traceMsgCache[ue],{priority:this.getEventPriority(ue,this.traceMsgCache[ue])}),this.traceMsgCache[ue]=null;else this.traceMsgCache[ue]=null}},{key:"getEventPriority",value:function(ue,Y){if(ue==="exceptions"){if(Y.action===0||Y.action===2||Y.action===1&&Y.exception_service!==0)return"HIGH"}else if(ue==="msgReceive"||ue==="nim_api_trace")return"LOW";return"NORMAL"}},{key:"reportTraceCancel",value:function(ue){this.reportConfig.isDataReportEnable&&(this.traceMsgCache[ue]=null)}},{key:"pause",value:function(){this.reportConfig.isDataReportEnable&&(this.isUploadEnable=!1)}},{key:"restore",value:function(){this.reportConfig.isDataReportEnable&&(this.isUploadEnable=!0,this.initConfigLoaded||this.initUploadConfig())}},{key:"destroy",value:function(){var ue,Y=this;this.reportConfig.isDataReportEnable&&(d(ue=m(this.traceMsgCache)).call(ue,function(_e){Y.reportTraceEnd(_e,1)}),this.timer!==null&&clearTimeout(this.timer),this.setConfig=D,this.report=D,this.reportTraceStart=D,this.reportTraceUpdate=D,this.reportTraceEnd=D,this.pause=D,this.restore=D,this.destroy=D,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.highPriorityMsgList=[],this.reportConfig={},this.isDestroyed=!0)}},{key:"initUploadConfig",value:function(){var ue,Y,_e=this;if(!this.loading){this.loading=!0;var Ce=this.reportConfig.common||{};try{this.reportConfig.request(this.reportConfig.reportConfigUrl,{method:"GET",dataType:"json",params:{deviceId:Ce.dev_id,sdkVer:Ce.sdk_ver,platform:Ce.platform,appkey:Ce.app_key},timeout:this.reportConfig.timeout}).then(function(ze){var ie,le;if(!_e.isDestroyed){if(ze.status===200&&ze.data&&ze.data.code===200){var Ie=ze.data.data||{};_e.reportConfig.maxSize=Ie.maxSize>1e3?1e3:Ie.maxSize,_e.reportConfig.maxInterval=Ie.maxInterval>1e4?1e4:Ie.maxInterval,_e.reportConfig.maxInterval=Ie.maxInterval<10?10:Ie.maxInterval,_e.reportConfig.minInterval=Ie.minInterval<2?2:Ie.minInterval,_e.reportConfig.maxDelay=Ie.maxDelay||300,_e.reportConfig.maxInterval=1e3*_e.reportConfig.maxInterval,_e.reportConfig.minInterval=1e3*_e.reportConfig.minInterval,_e.reportConfig.maxDelay=1e3*_e.reportConfig.maxDelay,_e.isUploadEnable=!0,_e.initConfigLoaded=!0,_e.loading=!1,_e.reportHeartBeat()}(le=(ie=_e.reportConfig)===null||ie===void 0?void 0:ie.logger)===null||le===void 0||le.log("Get reporter upload config success")}}).catch(function(ze){var ie,le;_e.loading=!1,(le=(ie=_e.reportConfig)===null||ie===void 0?void 0:ie.logger)===null||le===void 0||le.error("Get reporter upload config failed",ze)})}catch(ze){this.loading=!1,(Y=(ue=this.reportConfig)===null||ue===void 0?void 0:ue.logger)===null||Y===void 0||Y.error("Exec reporter request failed",ze)}}}},{key:"reportHeartBeat",value:function(){var ue=this;this.isDestroyed||(this.timer=v(function(){ue.reportHeartBeat()},this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function(){if(!this.isDestroyed){var ue=this.highPriorityMsgList.length+this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;i()-this.lastReportTime>=ue&&this.upload()}}},{key:"getUploadMsg",value:function(){var ue,Y,_e,Ce,ze,ie,le=this,Ie={},pe=i();this.highPriorityMsgList=g(ue=this.highPriorityMsgList).call(ue,function(ir){return pe-ir.createTime<le.reportConfig.maxDelay}),this.msgList=g(Y=this.msgList).call(Y,function(ir){return pe-ir.createTime<le.reportConfig.maxDelay}),this.lowPriorityMsgList=g(_e=this.lowPriorityMsgList).call(_e,function(ir){return pe-ir.createTime<le.reportConfig.maxDelay}),this.cacheMsgList=g(Ce=this.cacheMsgList).call(Ce,function(ir){return pe-ir.createTime<le.reportConfig.maxDelay});var qe=b(ze=this.highPriorityMsgList).call(ze,0,this.reportConfig.maxSize);if(this.highPriorityMsgList=b(ie=this.highPriorityMsgList).call(ie,qe.length),qe.length<this.reportConfig.maxSize){var $e,Lt,Dt=this.reportConfig.maxSize-qe.length;qe=T(qe).call(qe,b($e=this.msgList).call($e,0,Dt)),this.msgList=b(Lt=this.msgList).call(Lt,Dt)}if(qe.length<this.reportConfig.maxSize){var dr,pr,sr=this.reportConfig.maxSize-qe.length;qe=T(qe).call(qe,b(dr=this.lowPriorityMsgList).call(dr,0,sr)),this.lowPriorityMsgList=b(pr=this.lowPriorityMsgList).call(pr,sr)}if(qe.length<this.reportConfig.maxSize){var hr,Fe,nr=this.reportConfig.maxSize-qe.length;qe=T(qe).call(qe,b(hr=this.cacheMsgList).call(hr,0,nr)),this.cacheMsgList=b(Fe=this.cacheMsgList).call(Fe,nr)}return d(qe).call(qe,function(ir){Ie[ir.module]?Ie[ir.module].push(ir.msg):Ie[ir.module]=[ir.msg]}),{uploadMsgArr:qe,uploadMsg:Ie}}},{key:"upload",value:function(){var ue,Y,_e=this;if(this.isUploadEnable&&!(this.lastReportTime&&i()-this.lastReportTime<this.reportConfig.minInterval)){var Ce=this.getUploadMsg(),ze=Ce.uploadMsgArr,ie=Ce.uploadMsg;if(ze.length){this.lastReportTime=i();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:ie},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch(function(le){var Ie,pe,qe,$e;_e.cacheMsgList=b(Ie=T(pe=_e.cacheMsgList).call(pe,ze)).call(Ie,0,_e.reportConfig.cacheMaxSize),($e=(qe=_e.reportConfig)===null||qe===void 0?void 0:qe.logger)===null||$e===void 0||$e.warn("Reporter upload failed",le)})}catch(le){(Y=(ue=this.reportConfig)===null||ue===void 0?void 0:ue.logger)===null||Y===void 0||Y.warn("Exec reporter request failed",le)}clearTimeout(this.timer),this.reportHeartBeat()}}}}])&&y(ae.prototype,Ne),a(ae,"prototype",{writable:!1}),he}()},k(r)==="object"&&t!==void 0?t.exports=s():(o=typeof(n=s)=="function"?n.call(r,e,r,t):n)===void 0||(t.exports=o)},function(t,r,e){t.exports=e(687)},function(t,r,e){e(688);var n=e(689);t.exports=n},function(t,r,e){e(292)},function(t,r,e){var n=e(690);t.exports=n},function(t,r,e){var n=e(691);t.exports=n},function(t,r,e){e(292),t.exports=e(14)},function(t,r,e){var n,o,s,a=e(122),i=e(121),u=e(280),d=e(281),c=e(190),m=e(693),v=(e(291),e(2)),g=e(5),b=e(7),T=e(3),k=e(23),y=e(10),O=e(278),D=e(26);function he(ae){var Ne=function(){if(typeof Reflect>"u"||!O||O.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(O(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var ue,Y=c(ae);if(Ne){var _e=c(this).constructor;ue=O(Y,arguments,_e)}else ue=Y.apply(this,arguments);return d(this,ue)}}s=function(){function ae(ue){if(ue){var Y,_e="";return v(Y=g(ue)).call(Y,function(Ce,ze){var ie;_e+=ze===0?"?":"&",_e+=b(ie="".concat(Ce,"=")).call(ie,ue[Ce])}),_e}return""}var Ne=function(ue){u(_e,ue);var Y=he(_e);function _e(Ce,ze,ie,le){var Ie;return i(this,_e),(Ie=Y.call(this,ie)).source=Ce,Ie.code=ze,Ie.desc=ie,Ie.detail=le||{},Ie}return a(_e)}(m(Error));return function(ue){var Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{dataType:"json",method:"GET",timeout:5e3},_e=Y.dataType==="text"?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",Ce=Y.method==="GET"?ae(Y.params):"";return new T(function(ze,ie){if(window.XMLHttpRequest){var le,Ie,pe=new XMLHttpRequest;if(pe.onreadystatechange=function(){if(pe.readyState===4)if(pe.status===200){try{Ie=JSON.parse(pe.response||"{}")}catch{Ie=pe.response}ze({status:pe.status,data:Ie})}else k(function(){var $e;ie(new Ne(1,pe.status,b($e="readyState: ".concat(pe.readyState,"; statusText: ")).call($e,pe.statusText)))},0)},pe.open(Y.method,b(le="".concat(ue)).call(le,Ce)),pe.timeout=Y.timeout||5e3,pe.setRequestHeader("Content-Type",_e),Y.headers)for(var qe in Y.headers)pe.setRequestHeader(qe,Y.headers[qe]);pe.ontimeout=function($e){ie(new Ne(1,408,$e&&$e.message?$e.message:"request timeout"))},pe.send(y(Y.data))}else ie(new Ne(2,10400,"request no suppout"))})}},D(r)==="object"&&t!==void 0?t.exports=s():(o=typeof(n=s)=="function"?n.call(r,e,r,t):n)===void 0||(t.exports=o)},function(t,r,e){var n=e(694),o=e(187),s=e(190),a=e(188),i=e(733),u=e(734);function d(c){var m=typeof n=="function"?new n:void 0;return t.exports=d=function(v){if(v===null||!i(v))return v;if(typeof v!="function")throw new TypeError("Super expression must either be null or a function");if(m!==void 0){if(m.has(v))return m.get(v);m.set(v,g)}function g(){return u(v,arguments,s(this).constructor)}return g.prototype=o(v.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),a(g,v)},t.exports.__esModule=!0,t.exports.default=t.exports,d(c)}t.exports=d,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(695)},function(t,r,e){t.exports=e(696)},function(t,r,e){var n=e(697);e(708),e(710),e(712),e(714),e(715),e(717),e(718),e(719),e(720),e(721),e(723),e(724),e(725),e(726),e(727),e(728),e(729),e(730),e(731),e(732),t.exports=n},function(t,r,e){var n=e(698);t.exports=n},function(t,r,e){var n=e(699);e(67),t.exports=n},function(t,r,e){e(82),e(700),e(96),e(113);var n=e(12);t.exports=n.Map},function(t,r,e){e(701)},function(t,r,e){e(702)("Map",function(n){return function(){return n(this,arguments.length?arguments[0]:void 0)}},e(706))},function(t,r,e){var n=e(1),o=e(14),s=e(293),a=e(4),i=e(53),u=e(46),d=e(168),c=e(16),m=e(28),v=e(81),g=e(38).f,b=e(84).forEach,T=e(27),k=e(97),y=k.set,O=k.getterFor;t.exports=function(D,he,ae){var Ne,ue=D.indexOf("Map")!==-1,Y=D.indexOf("Weak")!==-1,_e=ue?"set":"add",Ce=o[D],ze=Ce&&Ce.prototype,ie={};if(T&&c(Ce)&&(Y||ze.forEach&&!a(function(){new Ce().entries().next()}))){var le=(Ne=he(function(pe,qe){y(d(pe,le),{type:D,collection:new Ce}),qe!=null&&u(qe,pe[_e],{that:pe,AS_ENTRIES:ue})})).prototype,Ie=O(D);b(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(pe){var qe=pe=="add"||pe=="set";!(pe in ze)||Y&&pe=="clear"||i(le,pe,function($e,Lt){var Dt=Ie(this).collection;if(!qe&&Y&&!m($e))return pe=="get"&&void 0;var dr=Dt[pe]($e===0?0:$e,Lt);return qe?this:dr})}),Y||g(le,"size",{configurable:!0,get:function(){return Ie(this).collection.size}})}else Ne=ae.getConstructor(he,D,ue,_e),s.enable();return v(Ne,D,!1,!0),ie[D]=Ne,n({global:!0,forced:!0},ie),Y||ae.setStrong(Ne,D,ue),Ne}},function(t,r,e){var n=e(4),o=e(28),s=e(63),a=e(704),i=Object.isExtensible,u=n(function(){});t.exports=u||a?function(d){return!!o(d)&&(!a||s(d)!="ArrayBuffer")&&(!i||i(d))}:i},function(t,r,e){var n=e(4);t.exports=n(function(){if(typeof ArrayBuffer=="function"){var o=new ArrayBuffer(8);Object.isExtensible(o)&&Object.defineProperty(o,"a",{value:8})}})},function(t,r,e){var n=e(4);t.exports=!n(function(){return Object.isExtensible(Object.preventExtensions({}))})},function(t,r,e){var n=e(38).f,o=e(80),s=e(707),a=e(34),i=e(168),u=e(91),d=e(46),c=e(166),m=e(167),v=e(237),g=e(27),b=e(293).fastKey,T=e(97),k=T.set,y=T.getterFor;t.exports={getConstructor:function(O,D,he,ae){var Ne=O(function(ze,ie){i(ze,ue),k(ze,{type:D,index:o(null),first:void 0,last:void 0,size:0}),g||(ze.size=0),u(ie)||d(ie,ze[ae],{that:ze,AS_ENTRIES:he})}),ue=Ne.prototype,Y=y(D),_e=function(ze,ie,le){var Ie,pe,qe=Y(ze),$e=Ce(ze,ie);return $e?$e.value=le:(qe.last=$e={index:pe=b(ie,!0),key:ie,value:le,previous:Ie=qe.last,next:void 0,removed:!1},qe.first||(qe.first=$e),Ie&&(Ie.next=$e),g?qe.size++:ze.size++,pe!=="F"&&(qe.index[pe]=$e)),ze},Ce=function(ze,ie){var le,Ie=Y(ze),pe=b(ie);if(pe!=="F")return Ie.index[pe];for(le=Ie.first;le;le=le.next)if(le.key==ie)return le};return s(ue,{clear:function(){for(var ze=Y(this),ie=ze.index,le=ze.first;le;)le.removed=!0,le.previous&&(le.previous=le.previous.next=void 0),delete ie[le.index],le=le.next;ze.first=ze.last=void 0,g?ze.size=0:this.size=0},delete:function(ze){var ie=Y(this),le=Ce(this,ze);if(le){var Ie=le.next,pe=le.previous;delete ie.index[le.index],le.removed=!0,pe&&(pe.next=Ie),Ie&&(Ie.previous=pe),ie.first==le&&(ie.first=Ie),ie.last==le&&(ie.last=pe),g?ie.size--:this.size--}return!!le},forEach:function(ze){for(var ie,le=Y(this),Ie=a(ze,arguments.length>1?arguments[1]:void 0);ie=ie?ie.next:le.first;)for(Ie(ie.value,ie.key,this);ie&&ie.removed;)ie=ie.previous},has:function(ze){return!!Ce(this,ze)}}),s(ue,he?{get:function(ze){var ie=Ce(this,ze);return ie&&ie.value},set:function(ze,ie){return _e(this,ze===0?0:ze,ie)}}:{add:function(ze){return _e(this,ze=ze===0?0:ze,ze)}}),g&&n(ue,"size",{get:function(){return Y(this).size}}),Ne},setStrong:function(O,D,he){var ae=D+" Iterator",Ne=y(D),ue=y(ae);c(O,D,function(Y,_e){k(this,{type:ae,target:Y,state:Ne(Y),kind:_e,last:void 0})},function(){for(var Y=ue(this),_e=Y.kind,Ce=Y.last;Ce&&Ce.removed;)Ce=Ce.previous;return Y.target&&(Y.last=Ce=Ce?Ce.next:Y.state.first)?m(_e=="keys"?Ce.key:_e=="values"?Ce.value:[Ce.key,Ce.value],!1):(Y.target=void 0,m(void 0,!0))},he?"entries":"values",!he,!0),v(D)}}},function(t,r,e){var n=e(66);t.exports=function(o,s,a){for(var i in s)a&&a.unsafe&&o[i]?o[i]=s[i]:n(o,i,s[i],a);return o}},function(t,r,e){e(1)({target:"Map",stat:!0,forced:!0},{from:e(709)})},function(t,r,e){var n=e(34),o=e(19),s=e(31),a=e(169),i=e(91),u=e(46),d=[].push;t.exports=function(c){var m,v,g,b,T=arguments.length,k=T>1?arguments[1]:void 0;return a(this),(m=k!==void 0)&&s(k),i(c)?new this:(v=[],m?(g=0,b=n(k,T>2?arguments[2]:void 0),u(c,function(y){o(d,v,b(y,g++))})):u(c,d,{that:v}),new this(v))}},function(t,r,e){e(1)({target:"Map",stat:!0,forced:!0},{of:e(711)})},function(t,r,e){var n=e(98);t.exports=function(){return new this(n(arguments))}},function(t,r,e){var n=e(1),o=e(37),s=e(55).remove;n({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:function(){for(var a,i=o(this),u=!0,d=0,c=arguments.length;d<c;d++)a=s(i,arguments[d]),u=u&&a;return!!u}})},function(t,r){t.exports=function(e,n){return n==1?function(o,s){return o[e](s)}:function(o,s,a){return o[e](s,a)}}},function(t,r,e){var n=e(1),o=e(37),s=e(55),a=s.get,i=s.has,u=s.set;n({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function(d,c){var m,v,g=o(this);return i(g,d)?(m=a(g,d),"update"in c&&(m=c.update(m,d,g),u(g,d,m)),m):(v=c.insert(d,g),u(g,d,v),v)}})},function(t,r,e){var n=e(1),o=e(34),s=e(37),a=e(51);n({target:"Map",proto:!0,real:!0,forced:!0},{every:function(i){var u=s(this),d=o(i,arguments.length>1?arguments[1]:void 0);return a(u,function(c,m){if(!d(c,m,u))return!1},!0)!==!1}})},function(t,r,e){var n=e(19);t.exports=function(o,s,a){for(var i,u,d=a||o.next;!(i=n(d,o)).done;)if((u=s(i.value))!==void 0)return u}},function(t,r,e){var n=e(1),o=e(34),s=e(37),a=e(55),i=e(51),u=a.Map,d=a.set;n({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(c){var m=s(this),v=o(c,arguments.length>1?arguments[1]:void 0),g=new u;return i(m,function(b,T){v(b,T,m)&&d(g,T,b)}),g}})},function(t,r,e){var n=e(1),o=e(34),s=e(37),a=e(51);n({target:"Map",proto:!0,real:!0,forced:!0},{find:function(i){var u=s(this),d=o(i,arguments.length>1?arguments[1]:void 0),c=a(u,function(m,v){if(d(m,v,u))return{value:m}},!0);return c&&c.value}})},function(t,r,e){var n=e(1),o=e(34),s=e(37),a=e(51);n({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(i){var u=s(this),d=o(i,arguments.length>1?arguments[1]:void 0),c=a(u,function(m,v){if(d(m,v,u))return{key:v}},!0);return c&&c.key}})},function(t,r,e){var n=e(1),o=e(19),s=e(11),a=e(16),i=e(31),u=e(46),d=e(55).Map,c=s([].push);n({target:"Map",stat:!0,forced:!0},{groupBy:function(m,v){var g=new(a(this)?this:d);i(v);var b=i(g.has),T=i(g.get),k=i(g.set);return u(m,function(y){var O=v(y);o(b,g,O)?c(o(T,g,O),y):o(k,g,O,[y])}),g}})},function(t,r,e){var n=e(1),o=e(722),s=e(37),a=e(51);n({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(i){return a(s(this),function(u){if(o(u,i))return!0},!0)===!0}})},function(t,r){t.exports=function(e,n){return e===n||e!=e&&n!=n}},function(t,r,e){var n=e(1),o=e(19),s=e(46),a=e(16),i=e(31),u=e(55).Map;n({target:"Map",stat:!0,forced:!0},{keyBy:function(d,c){var m=new(a(this)?this:u);i(c);var v=i(m.set);return s(d,function(g){o(v,m,c(g),g)}),m}})},function(t,r,e){var n=e(1),o=e(37),s=e(51);n({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(a){var i=s(o(this),function(u,d){if(u===a)return{key:d}},!0);return i&&i.key}})},function(t,r,e){var n=e(1),o=e(34),s=e(37),a=e(55),i=e(51),u=a.Map,d=a.set;n({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(c){var m=s(this),v=o(c,arguments.length>1?arguments[1]:void 0),g=new u;return i(m,function(b,T){d(g,v(b,T,m),b)}),g}})},function(t,r,e){var n=e(1),o=e(34),s=e(37),a=e(55),i=e(51),u=a.Map,d=a.set;n({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(c){var m=s(this),v=o(c,arguments.length>1?arguments[1]:void 0),g=new u;return i(m,function(b,T){d(g,T,v(b,T,m))}),g}})},function(t,r,e){var n=e(1),o=e(37),s=e(46),a=e(55).set;n({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(i){for(var u=o(this),d=arguments.length,c=0;c<d;)s(arguments[c++],function(m,v){a(u,m,v)},{AS_ENTRIES:!0});return u}})},function(t,r,e){var n=e(1),o=e(31),s=e(37),a=e(51),i=TypeError;n({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(u){var d=s(this),c=arguments.length<2,m=c?void 0:arguments[1];if(o(u),a(d,function(v,g){c?(c=!1,m=v):m=u(m,v,g,d)}),c)throw i("Reduce of empty map with no initial value");return m}})},function(t,r,e){var n=e(1),o=e(34),s=e(37),a=e(51);n({target:"Map",proto:!0,real:!0,forced:!0},{some:function(i){var u=s(this),d=o(i,arguments.length>1?arguments[1]:void 0);return a(u,function(c,m){if(d(c,m,u))return!0},!0)===!0}})},function(t,r,e){var n=e(1),o=e(31),s=e(37),a=e(55),i=TypeError,u=a.get,d=a.has,c=a.set;n({target:"Map",proto:!0,real:!0,forced:!0},{update:function(m,v){var g=s(this),b=arguments.length;o(v);var T=d(g,m);if(!T&&b<3)throw i("Updating absent value");var k=T?u(g,m):o(b>2?arguments[2]:void 0)(m,g);return c(g,m,v(k,m,g)),g}})},function(t,r,e){e(1)({target:"Map",proto:!0,real:!0,forced:!0},{upsert:e(294)})},function(t,r,e){e(1)({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:e(294)})},function(t,r,e){var n=e(186);t.exports=function(o){var s;return n(s=Function.toString.call(o)).call(s,"[native code]")!==-1},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(149),o=e(295),s=e(188),a=e(738);function i(u,d,c){var m;return a()?(t.exports=i=n(m=o).call(m),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=i=function(v,g,b){var T=[null];T.push.apply(T,g);var k=new(n(Function).apply(v,T));return b&&s(k,b.prototype),k},t.exports.__esModule=!0,t.exports.default=t.exports),i.apply(null,arguments)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(736)},function(t,r,e){var n=e(737);t.exports=n},function(t,r,e){var n=e(279);t.exports=n},function(t,r,e){var n=e(295);t.exports=function(){if(typeof Reflect>"u"||!n||n.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],function(){})),!0}catch{return!1}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(17),o=e(0),s=e(191),a=o.merge({},s.idMap,{auth:{id:2,login:3,kicked:5,logout:6,multiPortLogin:7,kick:8},user:{id:3,updatePushToken:1,appBackground:2,markInBlacklist:3,getBlacklist:4,markInMutelist:5,getMutelist:6,getRelations:8,getUsers:7,updateMyInfo:10,updateDonnop:15,syncMyInfo:109,syncUpdateMyInfo:110},notify:{id:4,markRead:3,syncOfflineMsgs:4,batchMarkRead:5,syncOfflineSysMsgs:6,syncOfflineNetcallMsgs:8,syncRoamingMsgs:9,syncMsgReceipts:12,syncRobots:15,syncBroadcastMsgs:16,syncSuperTeamRoamingMsgs:17,syncOfflineSuperTeamSysMsgs:18,syncDeleteSuperTeamMsgOfflineRoaming:19,syncDeleteMsgSelf:21,syncSessionsWithMoreRoaming:22,syncStickTopSessions:23,syncSessionHistoryMsgsDelete:24,syncSessionReliableInfo:25},sync:{id:5,sync:1,syncTeamMembers:2,syncSuperTeamMembers:3},msg:{id:7,sendMsg:1,msg:2,sysMsg:3,getHistoryMsgs:6,sendCustomSysMsg:7,searchHistoryMsgs:8,deleteSessions:9,getSessions:10,syncSendMsg:101,sendMsgReceipt:11,msgReceipt:12,deleteMsg:13,msgDeleted:14,markSessionAck:16,markSessionAckBatch:25,broadcastMsg:17,clearServerHistoryMsgs:18,getServerSessions:19,getServerSession:20,updateServerSession:21,deleteServerSessions:22,deleteMsgSelf:23,deleteMsgSelfBatch:24,msgFtsInServer:26,msgFtsInServerByTiming:27,onClearServerHistoryMsgs:118,syncUpdateServerSession:121,onDeleteMsgSelf:123,onDeleteMsgSelfBatch:124},msgExtend:{id:23,getThreadMsgs:1,getMsgsByIdServer:2,addQuickComment:3,deleteQuickComment:4,onQuickComment:5,onDeleteQuickComment:6,getQuickComments:7,addCollect:8,deleteCollects:9,updateCollect:10,getCollects:11,addStickTopSession:12,deleteStickTopSession:13,updateStickTopSession:14,addMsgPin:15,updateMsgPin:16,deleteMsgPin:17,onAddMsgPin:18,onUpdateMsgPin:19,onDeleteMsgPin:20,getMsgPins:21,syncAddQuickComment:103,syncDeleteQuickComment:104,syncAddStickTopSession:112,syncDeleteStickTopSession:113,syncUpdateStickTopSession:114,syncAddMsgPin:115,syncUpdateMsgPin:116,syncDeleteMsgPin:117},team:{id:8,createTeam:1,sendTeamMsg:2,teamMsg:3,teamMsgs:4,addTeamMembers:5,removeTeamMembers:6,updateTeam:7,leaveTeam:8,getTeam:9,getTeams:10,getTeamMembers:11,dismissTeam:12,applyTeam:13,passTeamApply:14,rejectTeamApply:15,addTeamManagers:16,removeTeamManagers:17,transferTeam:18,updateInfoInTeam:19,updateNickInTeam:20,acceptTeamInvite:21,rejectTeamInvite:22,getTeamHistoryMsgs:23,searchTeamHistoryMsgs:24,updateMuteStateInTeam:25,getMyTeamMembers:26,getMutedTeamMembers:27,sendTeamMsgReceipt:28,getTeamMsgReads:29,getTeamMsgReadAccounts:30,notifyTeamMsgReads:31,muteTeamAll:32,getTeamMemberInvitorAccid:33,getTeamsById:34,syncMyTeamMembers:126,syncTeams:109,syncTeamMembers:111,syncCreateTeam:101,syncSendTeamMsg:102,syncUpdateTeamMember:119},superTeam:{id:21,sendSuperTeamMsg:2,superTeamMsg:3,addSuperTeamMembers:5,removeSuperTeamMembers:6,leaveSuperTeam:7,updateSuperTeam:8,getSuperTeam:9,getSuperTeams:12,updateInfoInSuperTeam:10,getMySuperTeamMembers:11,getSuperTeamMembers:13,getSuperTeamHistoryMsgs:14,getSuperTeamMembersByJoinTime:15,sendSuperTeamCustomSysMsg:16,deleteSuperTeamMsg:17,superTeamMsgDelete:18,superTeamCustomSysMsg:19,applySuperTeam:20,passSuperTeamApply:21,rejectSuperTeamApply:22,acceptSuperTeamInvite:23,rejectSuperTeamInvite:24,markSuperTeamSessionAck:25,addSuperTeamManagers:26,removeSuperTeamManagers:27,updateSuperTeamMute:28,updateSuperTeamMembersMute:29,updateNickInSuperTeam:30,transferSuperTeam:31,markSuperTeamSessionsAck:32,getSuperTeamMembersByAccounts:33,getMutedSuperTeamMembers:34,syncMySuperTeamMembers:111,syncSuperTeams:109,syncSuperTeamMembers:113,syncCreateSuperTeam:101,syncSendSuperTeamMsg:102,syncUpdateSuperTeamMember:110,syncDeleteSuperTeamMsg:117},friend:{id:12,friendRequest:1,syncFriendRequest:101,deleteFriend:2,syncDeleteFriend:102,updateFriend:3,syncUpdateFriend:103,getFriends:4},chatroom:{id:13,getChatroomAddress:1},filter:{id:101,sendFilterMsg:1,filterMsg:2,filterSysMsg:3,sendFilterCustomSysMsg:7},eventService:{id:14,publishEvent:1,pushEvent:2,subscribeEvent:3,unSubscribeEventsByAccounts:4,unSubscribeEventsByType:5,querySubscribeEventsByAccounts:6,querySubscribeEventsByType:7,pushEvents:9},proxyService:{id:22,httpProxy:1,onProxyMsg:2},qchat:{id:24,getQChatAddress:1}}),i=o.merge({},s.cmdConfig,{login:{sid:a.auth.id,cid:a.auth.login,params:[{type:"Property",name:"login"}]},logout:{sid:a.auth.id,cid:a.auth.logout},kick:{sid:a.auth.id,cid:a.auth.kick,params:[{type:"StrArray",name:"deviceIds"}]},updatePushToken:{sid:a.user.id,cid:a.user.updatePushToken,params:[{type:"String",name:"tokenName"},{type:"String",name:"token"},{type:"int",name:"pushkit"}]},appBackground:{sid:a.user.id,cid:a.user.appBackground,params:[{type:"bool",name:"isBackground"},{type:"Int",name:"badge"}]},markInBlacklist:{sid:a.user.id,cid:a.user.markInBlacklist,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},getBlacklist:{sid:a.user.id,cid:a.user.getBlacklist,params:[{type:"long",name:"time"}]},markInMutelist:{sid:a.user.id,cid:a.user.markInMutelist,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},getMutelist:{sid:a.user.id,cid:a.user.getMutelist,params:[{type:"long",name:"time"}]},getRelations:{sid:a.user.id,cid:a.user.getRelations,params:[{type:"long",name:"timetag"}]},getUsers:{sid:a.user.id,cid:a.user.getUsers,params:[{type:"StrArray",name:"accounts"}]},updateMyInfo:{sid:a.user.id,cid:a.user.updateMyInfo,params:[{type:"Property",name:"user"},{type:"Property",name:"antispamTag"}]},updateDonnop:{sid:a.user.id,cid:a.user.updateDonnop,params:[{type:"Property",name:"donnop"}]},markRead:{sid:a.notify.id,cid:a.notify.markRead,params:[{type:"long",name:"id"},{type:"ph",name:"ph"}]},batchMarkRead:{sid:a.notify.id,cid:a.notify.batchMarkRead,params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]},sync:{sid:a.sync.id,cid:a.sync.sync,isAwaitable:!1,params:[{type:"Property",name:"sync"}]},syncTeamMembers:{sid:a.sync.id,cid:a.sync.syncTeamMembers,params:[{type:"LongLongMap",name:"sync"}]},syncSuperTeamMembers:{sid:a.sync.id,cid:a.sync.syncSuperTeamMembers,params:[{type:"LongLongMap",name:"sync"}]},sendMsg:{sid:a.msg.id,cid:a.msg.sendMsg,params:[{type:"Property",name:"msg"}]},getHistoryMsgs:{sid:a.msg.id,cid:a.msg.getHistoryMsgs,params:[{type:"String",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},sendCustomSysMsg:{sid:a.msg.id,cid:a.msg.sendCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},searchHistoryMsgs:{sid:a.msg.id,cid:a.msg.searchHistoryMsgs,params:[{type:"String",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"String",name:"keyword"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},getSessions:{sid:a.msg.id,cid:a.msg.getSessions,params:[{type:"long",name:"time"}]},deleteSessions:{sid:a.msg.id,cid:a.msg.deleteSessions,params:[{type:"StrArray",name:"sessions"}]},sendMsgReceipt:{sid:a.msg.id,cid:a.msg.sendMsgReceipt,params:[{type:"Property",name:"msgReceipt"}]},deleteMsg:{sid:a.msg.id,cid:a.msg.deleteMsg,params:[{type:"Property",name:"sysMsg"}]},markSessionAck:{sid:a.msg.id,cid:a.msg.markSessionAck,params:[{type:"byte",name:"scene"},{type:"String",name:"to"},{type:"long",name:"timetag"}]},markSessionAckBatch:{sid:a.msg.id,cid:a.msg.markSessionAckBatch,params:[{type:"PropertyArray",name:"sessionAckTags",entity:"sessionAckTag"}]},clearServerHistoryMsgs:{sid:a.msg.id,cid:a.msg.clearServerHistoryMsgs,params:[{type:"Property",name:"clearMsgsParams"}]},clearServerHistoryMsgsWithSync:{sid:a.msg.id,cid:a.msg.clearServerHistoryMsgs,params:[{type:"Property",name:"clearMsgsParamsWithSync"}]},msgFtsInServer:{sid:a.msg.id,cid:a.msg.msgFtsInServer,params:[{type:"Property",name:"msgFullSearchRequestTag"}]},msgFtsInServerByTiming:{sid:a.msg.id,cid:a.msg.msgFtsInServerByTiming,params:[{type:"Property",name:"msgTimingFullSearchRequestTag"}]},onClearServerHistoryMsgs:{sid:a.msg.id,cid:a.msg.clearServerHistoryMsgs},getServerSessions:{sid:a.msg.id,cid:a.msg.getServerSessions,params:[{type:"Property",name:"sessionReqTag"}]},getServerSession:{sid:a.msg.id,cid:a.msg.getServerSession,params:[{type:"Property",name:"session"}]},updateServerSession:{sid:a.msg.id,cid:a.msg.updateServerSession,params:[{type:"Property",name:"session"}]},deleteServerSessions:{sid:a.msg.id,cid:a.msg.deleteServerSessions,params:[{type:"PropertyArray",name:"sessions",entity:"session"}]},deleteMsgSelf:{sid:a.msg.id,cid:a.msg.deleteMsgSelf,params:[{type:"Property",name:"deleteMsgSelfTag"}]},deleteMsgSelfBatch:{sid:a.msg.id,cid:a.msg.deleteMsgSelfBatch,params:[{type:"PropertyArray",name:"deleteMsgSelfTags",entity:"deleteMsgSelfTag"}]},onDeleteMsgSelf:{sid:a.msg.id,cid:a.msg.onDeleteMsgSelf},onDeleteMsgSelfBatch:{sid:a.msg.id,cid:a.msg.onDeleteMsgSelfBatch},sendSuperTeamMsg:{sid:a.superTeam.id,cid:a.superTeam.sendSuperTeamMsg,params:[{type:"Property",name:"msg"}]},addSuperTeamMembers:{sid:a.superTeam.id,cid:a.superTeam.addSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}]},removeSuperTeamMembers:{sid:a.superTeam.id,cid:a.superTeam.removeSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},leaveSuperTeam:{sid:a.superTeam.id,cid:a.superTeam.leaveSuperTeam,params:[{type:"long",name:"teamId"}]},updateSuperTeam:{sid:a.superTeam.id,cid:a.superTeam.updateSuperTeam,params:[{type:"Property",name:"team"},{type:"Property",name:"antispamTag"}]},getSuperTeam:{sid:a.superTeam.id,cid:a.superTeam.getSuperTeam,params:[{type:"long",name:"teamId"}]},getSuperTeams:{sid:a.superTeam.id,cid:a.superTeam.getSuperTeams,params:[{type:"long",name:"timetag"}]},getSuperTeamMembers:{sid:a.superTeam.id,cid:a.superTeam.getSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"long",name:"timetag"}]},updateInfoInSuperTeam:{sid:a.superTeam.id,cid:a.superTeam.updateInfoInSuperTeam,params:[{type:"Property",name:"superTeamMember"}]},getSuperTeamHistoryMsgs:{sid:a.superTeam.id,cid:a.superTeam.getSuperTeamHistoryMsgs,params:[{type:"long",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},applySuperTeam:{sid:a.superTeam.id,cid:a.superTeam.applySuperTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"ps"}]},passSuperTeamApply:{sid:a.superTeam.id,cid:a.superTeam.passSuperTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamApply:{sid:a.superTeam.id,cid:a.superTeam.rejectSuperTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},acceptSuperTeamInvite:{sid:a.superTeam.id,cid:a.superTeam.acceptSuperTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamInvite:{sid:a.superTeam.id,cid:a.superTeam.rejectSuperTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},markSuperTeamSessionAck:{sid:a.superTeam.id,cid:a.superTeam.markSuperTeamSessionAck,params:[{type:"long",name:"to"},{type:"long",name:"timetag"}]},addSuperTeamManagers:{sid:a.superTeam.id,cid:a.superTeam.addSuperTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeSuperTeamManagers:{sid:a.superTeam.id,cid:a.superTeam.removeSuperTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateSuperTeamMute:{sid:a.superTeam.id,cid:a.superTeam.updateSuperTeamMute,params:[{type:"long",name:"teamId"},{type:"int",name:"mute"}]},updateSuperTeamMembersMute:{sid:a.superTeam.id,cid:a.superTeam.updateSuperTeamMembersMute,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"int",name:"mute"}]},updateNickInSuperTeam:{sid:a.superTeam.id,cid:a.superTeam.updateNickInSuperTeam,params:[{type:"Property",name:"superTeamMember"}]},transferSuperTeam:{sid:a.superTeam.id,cid:a.superTeam.transferSuperTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},markSuperTeamSessionsAck:{sid:a.superTeam.id,cid:a.superTeam.markSuperTeamSessionsAck,params:[{type:"PropertyArray",name:"sessionAckTags",entity:"sessionAckTag"}]},getSuperTeamMembersByJoinTime:{sid:a.superTeam.id,cid:a.superTeam.getSuperTeamMembersByJoinTime,params:[{type:"long",name:"teamId"},{type:"long",name:"joinTime"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},getSuperTeamMembersByAccounts:{sid:a.superTeam.id,cid:a.superTeam.getSuperTeamMembersByAccounts,params:[{type:"StrArray",name:"memberIds"}]},getMutedSuperTeamMembers:{sid:a.superTeam.id,cid:a.superTeam.getMutedSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"long",name:"joinTime"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},sendSuperTeamCustomSysMsg:{sid:a.superTeam.id,cid:a.superTeam.sendSuperTeamCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},deleteSuperTeamMsg:{sid:a.superTeam.id,cid:a.superTeam.deleteSuperTeamMsg,params:[{type:"Property",name:"sysMsg"}]},getMySuperTeamMembers:{sid:a.superTeam.id,cid:a.superTeam.getMySuperTeamMembers,params:[{type:"LongArray",name:"teamIds"}]},createTeam:{sid:a.team.id,cid:a.team.createTeam,params:[{type:"Property",name:"team"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"},{type:"Property",name:"antispamTag"}]},sendTeamMsg:{sid:a.team.id,cid:a.team.sendTeamMsg,params:[{type:"Property",name:"msg"}]},addTeamMembers:{sid:a.team.id,cid:a.team.addTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"},{type:"String",name:"attach"}]},removeTeamMembers:{sid:a.team.id,cid:a.team.removeTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateTeam:{sid:a.team.id,cid:a.team.updateTeam,params:[{type:"Property",name:"team"},{type:"Property",name:"antispamTag"}]},leaveTeam:{sid:a.team.id,cid:a.team.leaveTeam,params:[{type:"long",name:"teamId"}]},getTeam:{sid:a.team.id,cid:a.team.getTeam,params:[{type:"long",name:"teamId"}]},getTeams:{sid:a.team.id,cid:a.team.getTeams,params:[{type:"long",name:"timetag"}]},getTeamsById:{sid:a.team.id,cid:a.team.getTeamsById,params:[{type:"longArray",name:"teamIds"}]},getTeamMembers:{sid:a.team.id,cid:a.team.getTeamMembers,params:[{type:"long",name:"teamId"},{type:"long",name:"timetag"}]},dismissTeam:{sid:a.team.id,cid:a.team.dismissTeam,params:[{type:"long",name:"teamId"}]},applyTeam:{sid:a.team.id,cid:a.team.applyTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"ps"}]},passTeamApply:{sid:a.team.id,cid:a.team.passTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamApply:{sid:a.team.id,cid:a.team.rejectTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},addTeamManagers:{sid:a.team.id,cid:a.team.addTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeTeamManagers:{sid:a.team.id,cid:a.team.removeTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},transferTeam:{sid:a.team.id,cid:a.team.transferTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},updateInfoInTeam:{sid:a.team.id,cid:a.team.updateInfoInTeam,params:[{type:"Property",name:"teamMember"}]},updateNickInTeam:{sid:a.team.id,cid:a.team.updateNickInTeam,params:[{type:"Property",name:"teamMember"}]},acceptTeamInvite:{sid:a.team.id,cid:a.team.acceptTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamInvite:{sid:a.team.id,cid:a.team.rejectTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},getTeamHistoryMsgs:{sid:a.team.id,cid:a.team.getTeamHistoryMsgs,params:[{type:"long",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},searchTeamHistoryMsgs:{sid:a.team.id,cid:a.team.searchTeamHistoryMsgs,params:[{type:"long",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"String",name:"keyword"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},updateMuteStateInTeam:{sid:a.team.id,cid:a.team.updateMuteStateInTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"account"},{type:"int",name:"mute"}]},getMyTeamMembers:{sid:a.team.id,cid:a.team.getMyTeamMembers,params:[{type:"LongArray",name:"teamIds"}]},getMutedTeamMembers:{sid:a.team.id,cid:a.team.getMutedTeamMembers,params:[{type:"long",name:"teamId"}]},sendTeamMsgReceipt:{sid:a.team.id,cid:a.team.sendTeamMsgReceipt,params:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},getTeamMsgReads:{sid:a.team.id,cid:a.team.getTeamMsgReads,params:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},getTeamMsgReadAccounts:{sid:a.team.id,cid:a.team.getTeamMsgReadAccounts,params:[{type:"Property",name:"teamMsgReceipt"}]},muteTeamAll:{sid:a.team.id,cid:a.team.muteTeamAll,params:[{type:"long",name:"teamId"},{type:"int",name:"mute"}]},getTeamMemberInvitorAccid:{sid:a.team.id,cid:a.team.getTeamMemberInvitorAccid,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},friendRequest:{sid:a.friend.id,cid:a.friend.friendRequest,params:[{type:"String",name:"account"},{type:"byte",name:"type"},{type:"String",name:"ps"}]},deleteFriend:{sid:a.friend.id,cid:a.friend.deleteFriend,params:[{type:"String",name:"account"},{type:"Property",name:"delFriendParams"}]},updateFriend:{sid:a.friend.id,cid:a.friend.updateFriend,params:[{type:"Property",name:"friend"}]},getFriends:{sid:a.friend.id,cid:a.friend.getFriends,params:[{type:"long",name:"timetag"}]},getChatroomAddress:{sid:a.chatroom.id,cid:a.chatroom.getChatroomAddress,params:[{type:"long",name:"chatroomId"},{type:"bool",name:"isWeixinApp"},{type:"number",name:"type"}]},sendFilterMsg:{sid:n(a).id,cid:n(a).sendFilterMsg,params:[{type:"Property",name:"msg"}]},sendFilterCustomSysMsg:{sid:n(a).id,cid:n(a).sendFilterCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},publishEvent:{sid:a.eventService.id,cid:a.eventService.publishEvent,params:[{type:"Property",name:"msgEvent"}]},pushEvent:{sid:a.eventService.id,cid:a.eventService.pushEvent},subscribeEvent:{sid:a.eventService.id,cid:a.eventService.subscribeEvent,params:[{type:"Property",name:"msgEventSubscribe"},{type:"StrArray",name:"accounts"}]},unSubscribeEventsByAccounts:{sid:a.eventService.id,cid:a.eventService.unSubscribeEventsByAccounts,params:[{type:"Property",name:"msgEventSubscribe"},{type:"StrArray",name:"accounts"}]},unSubscribeEventsByType:{sid:a.eventService.id,cid:a.eventService.unSubscribeEventsByType,params:[{type:"Property",name:"msgEventSubscribe"}]},querySubscribeEventsByAccounts:{sid:a.eventService.id,cid:a.eventService.querySubscribeEventsByAccounts,params:[{type:"Property",name:"msgEventSubscribe"},{type:"StrArray",name:"accounts"}]},querySubscribeEventsByType:{sid:a.eventService.id,cid:a.eventService.querySubscribeEventsByType,params:[{type:"Property",name:"msgEventSubscribe"}]},pushEvents:{sid:a.eventService.id,cid:a.eventService.pushEvents},getThreadMsgs:{sid:a.msgExtend.id,cid:a.msgExtend.getThreadMsgs,params:[{type:"Property",name:"msg"},{type:"Property",name:"threadMsgReq"}]},getMsgsByIdServer:{sid:a.msgExtend.id,cid:a.msgExtend.getMsgsByIdServer,params:[{type:"PropertyArray",name:"reqMsgs",entity:"msg"}]},addQuickComment:{sid:a.msgExtend.id,cid:a.msgExtend.addQuickComment,params:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},deleteQuickComment:{sid:a.msgExtend.id,cid:a.msgExtend.deleteQuickComment,params:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},getQuickComments:{sid:a.msgExtend.id,cid:a.msgExtend.getQuickComments,params:[{type:"PropertyArray",name:"commentReq",entity:"commentReq"}]},addCollect:{sid:a.msgExtend.id,cid:a.msgExtend.addCollect,params:[{type:"Property",name:"collect"}]},deleteCollects:{sid:a.msgExtend.id,cid:a.msgExtend.deleteCollects,params:[{type:"PropertyArray",name:"collectList",entity:"collect"}]},updateCollect:{sid:a.msgExtend.id,cid:a.msgExtend.updateCollect,params:[{type:"Property",name:"collect"}]},getCollects:{sid:a.msgExtend.id,cid:a.msgExtend.getCollects,params:[{type:"Property",name:"collectQuery"}]},addStickTopSession:{sid:a.msgExtend.id,cid:a.msgExtend.addStickTopSession,params:[{type:"Property",name:"stickTopSession"}]},updateStickTopSession:{sid:a.msgExtend.id,cid:a.msgExtend.updateStickTopSession,params:[{type:"Property",name:"stickTopSession"}]},deleteStickTopSession:{sid:a.msgExtend.id,cid:a.msgExtend.deleteStickTopSession,params:[{type:"Property",name:"stickTopSession"}]},addMsgPin:{sid:a.msgExtend.id,cid:a.msgExtend.addMsgPin,params:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"}]},updateMsgPin:{sid:a.msgExtend.id,cid:a.msgExtend.updateMsgPin,params:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"}]},deleteMsgPin:{sid:a.msgExtend.id,cid:a.msgExtend.deleteMsgPin,params:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"}]},getMsgPins:{sid:a.msgExtend.id,cid:a.msgExtend.getMsgPins,params:[{type:"Property",name:"msgPinReq"}]},httpProxy:{sid:a.proxyService.id,cid:a.proxyService.httpProxy,params:[{type:"Property",name:"proxyTag"}]},getQChatAddress:{sid:a.qchat.id,cid:a.qchat.getQChatAddress,params:[{type:"Property",name:"getQChatAddressTag"}]}}),u=o.merge({},s.packetConfig,{"2_3":{service:"auth",cmd:"login",response:[{type:"Property",name:"loginRes"},{type:"PropertyArray",name:"loginPorts",entity:"loginPort"},{type:"Property",name:"aosPushInfo"}]},"2_5":{service:"auth",cmd:"kicked",response:[{type:"Number",name:"from"},{type:"Number",name:"reason"},{type:"String",name:"custom"},{type:"Number",name:"customClientType"}]},"2_6":{service:"auth",cmd:"logout"},"2_7":{service:"auth",cmd:"multiPortLogin",response:[{type:"Number",name:"state"},{type:"PropertyArray",name:"loginPorts",entity:"loginPort"}]},"2_8":{service:"auth",cmd:"kick",response:[{type:"StrArray",name:"deviceIds"}]},"3_1":{service:"user",cmd:"updatePushToken"},"3_2":{service:"user",cmd:"appBackground"},"3_3":{service:"user",cmd:"markInBlacklist"},"3_103":{service:"user",cmd:"syncMarkInBlacklist",response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},"3_4":{service:"user",cmd:"getBlacklist",response:[{type:"StrArray",name:"blacklist"}]},"3_5":{service:"user",cmd:"markInMutelist"},"3_105":{service:"user",cmd:"syncMarkInMutelist",response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},"3_6":{service:"user",cmd:"getMutelist",response:[{type:"StrArray",name:"mutelist"}]},"3_8":{service:"user",cmd:"getRelations",response:[{type:"PropertyArray",name:"specialRelations",entity:"specialRelation"},{type:"Number",name:"timetag"}]},"3_7":{service:"user",cmd:"getUsers",response:[{type:"PropertyArray",name:"users",entity:"user"}]},"3_10":{service:"user",cmd:"updateMyInfo",response:[{type:"Number",name:"timetag"}]},"3_15":{service:"user",cmd:"updateDonnop",response:[{type:"Number",name:"timetag"}]},"3_115":{service:"user",cmd:"syncUpdateDonnop",response:[{type:"Property",name:"donnop"},{type:"Number",name:"timetag"}]},"3_109":{service:"user",cmd:"syncMyInfo",response:[{type:"Property",name:"user"},{type:"Number",name:"timetag"}]},"3_110":{service:"user",cmd:"syncUpdateMyInfo",response:[{type:"Property",name:"user"}]},"4_1":{service:"notify"},"4_2":{service:"notify"},"4_3":{service:"notify",cmd:"markRead"},"4_4":{service:"notify",cmd:"syncOfflineMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_5":{service:"notify",cmd:"batchMarkRead"},"4_6":{service:"notify",cmd:"syncOfflineSysMsgs",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"4_8":{service:"notify",cmd:"syncOfflineNetcallMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_9":{service:"notify",cmd:"syncRoamingMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_12":{service:"notify",cmd:"syncMsgReceipts",response:[{type:"PropertyArray",name:"msgReceipts",entity:"msgReceipt"},{type:"Number",name:"timetag"}]},"4_13":{service:"notify",cmd:"syncDonnop",response:[{type:"Property",name:"donnop"},{type:"Number",name:"timetag"}]},"4_14":{service:"notify",cmd:"syncSessionAck",response:[{type:"StrLongMap",name:"p2p"},{type:"LongLongMap",name:"team"},{type:"Number",name:"timetag"}]},"4_15":{service:"notify",cmd:"syncRobots",response:[{type:"PropertyArray",name:"robots",entity:"robot"}]},"4_16":{service:"notify",cmd:"syncBroadcastMsgs",response:[{type:"PropertyArray",name:"broadcastMsgs",entity:"broadcastMsg"}]},"4_17":{service:"notify",cmd:"syncSuperTeamRoamingMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_18":{service:"notify",cmd:"syncOfflineSuperTeamSysMsgs",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"4_19":{service:"notify",cmd:"syncDeleteSuperTeamMsgOfflineRoaming",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"},{type:"Number",name:"timetag"},{type:"Number",name:"type"}]},"4_20":{service:"notify",cmd:"syncSuperTeamSessionAck",response:[{type:"LongLongMap",name:"superTeam"},{type:"Number",name:"timetag"}]},"4_21":{service:"notify",cmd:"syncDeleteMsgSelf",response:[{type:"PropertyArray",name:"deletedMsgs",entity:"deleteMsgSelfTag"}]},"4_22":{service:"notify",cmd:"syncSessionsWithMoreRoaming",response:[{type:"PropertyArray",name:"sessions",entity:"msg"}]},"4_23":{service:"notify",cmd:"syncStickTopSessions",response:[{type:"Number",name:"timetag"},{type:"boolean",name:"modify"},{type:"PropertyArray",name:"sessions",entity:"stickTopSession"}]},"4_24":{service:"notify",cmd:"syncSessionHistoryMsgsDelete",response:[{type:"PropertyArray",name:"sessionHistoryMsgsDeleteTags",entity:"clearMsgsParamsWithSync"}]},"4_25":{service:"notify",cmd:"syncSessionReliableInfo",response:[{type:"Property",name:"context",entity:"sessionReliableSyncContextTag"},{type:"PropertyArray",name:"datas",entity:"sessionReliableSyncTag"}]},"4_100":{service:"notify",cmd:"syncOfflineFilterMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_101":{service:"notify",cmd:"syncOfflineFilterSysMsgs",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"5_1":{service:"sync",cmd:"syncDone",response:[{type:"Number",name:"timetag"}]},"5_2":{service:"sync",cmd:"syncTeamMembersDone",response:[{type:"Number",name:"timetag"}]},"5_3":{service:"sync",cmd:"syncSuperTeamMembersDone",response:[{type:"Number",name:"timetag"}]},"7_1":{service:"msg",cmd:"sendMsg",response:[{type:"Property",name:"msg"}],trivialErrorCodes:[7101]},"7_2":{service:"msg",cmd:"msg",response:[{type:"Property",name:"msg"}]},"7_3":{service:"msg",cmd:"sysMsg",response:[{type:"Property",name:"sysMsg"}]},"7_6":{service:"msg",cmd:"getHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_7":{service:"msg",cmd:"sendCustomSysMsg",trivialErrorCodes:[7101]},"7_8":{service:"msg",cmd:"searchHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_9":{service:"msg",cmd:"deleteSessions"},"7_10":{service:"msg",cmd:"getSessions",response:[{type:"StrArray",name:"sessions"}]},"7_101":{service:"msg",cmd:"syncSendMsg",response:[{type:"Property",name:"msg"}]},"7_11":{service:"msg",cmd:"sendMsgReceipt",response:[{type:"Property",name:"msgReceipt"}]},"7_12":{service:"msg",cmd:"msgReceipt",response:[{type:"Property",name:"msgReceipt"}]},"7_13":{service:"msg",cmd:"onDeleteMsg"},"7_14":{service:"msg",cmd:"onMsgDeleted",response:[{type:"Property",name:"sysMsg"}]},"7_15":{service:"msg",cmd:"onDeleteMsgOfflineRoaming",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"},{type:"Number",name:"timetag"},{type:"Number",name:"type"}]},"7_16":{service:"msg",cmd:"onMarkSessionAck"},"7_17":{service:"msg",cmd:"broadcastMsg",response:[{type:"Property",name:"broadcastMsg"}]},"7_18":{service:"msg",cmd:"clearServerHistoryMsgs",response:[{type:"Long",name:"timetag"}]},"7_19":{service:"session",cmd:"getServerSessions",response:[{type:"Property",name:"sessionReqTag"},{type:"PropertyArray",name:"sessionList",entity:"session"}]},"7_20":{service:"session",cmd:"getServerSession",response:[{type:"Property",name:"session"}]},"7_21":{service:"session",cmd:"updateServerSession"},"7_22":{service:"session",cmd:"deleteServerSessions"},"7_23":{service:"msg",cmd:"deleteMsgSelf",response:[{type:"Long",name:"timetag"}]},"7_24":{service:"msg",cmd:"deleteMsgSelfBatch",response:[{type:"Long",name:"timetag"}]},"7_25":{service:"msg",cmd:"onMarkSessionAckBatch"},"7_26":{service:"msg",cmd:"msgFtsInServer",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_27":{service:"msg",cmd:"msgFtsInServerByTiming",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_118":{service:"msg",cmd:"onClearServerHistoryMsgs",response:[{type:"Property",name:"sessionHistoryMsgsDeleteTag",entity:"clearMsgsParamsWithSync"}]},"7_123":{service:"msg",cmd:"onDeleteMsgSelf",response:[{type:"Property",name:"deleteMsgSelfTag"}]},"7_124":{service:"msg",cmd:"onDeleteMsgSelfBatch",response:[{type:"PropertyArray",name:"deleteMsgSelfTags",entity:"deleteMsgSelfTag"}]},"7_116":{service:"msg",cmd:"syncMarkSessionAck",response:[{type:"Number",name:"scene"},{type:"String",name:"to"},{type:"Number",name:"timetag"}]},"7_121":{service:"msg",cmd:"syncUpdateServerSession",response:[{type:"Property",name:"session"}]},"23_1":{service:"msgExtend",cmd:"getThreadMsgs",response:[{type:"Property",name:"threadMsg",entity:"msg"},{type:"Property",name:"threadMsgsMeta"},{type:"PropertyArray",name:"msgs",entity:"msg"}]},"23_2":{service:"msgExtend",cmd:"getMsgsByIdServer",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"23_3":{service:"msgExtend",cmd:"addQuickComment",response:[{type:"Number",name:"timetag"}]},"23_4":{service:"msgExtend",cmd:"deleteQuickComment",response:[{type:"Number",name:"timetag"}]},"23_5":{service:"msgExtend",cmd:"onQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_6":{service:"msgExtend",cmd:"onDeleteQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_7":{service:"msgExtend",cmd:"getQuickComments",response:[{type:"PropertyArray",name:"commentRes",entity:"commentRes"}]},"23_8":{service:"msgExtend",cmd:"addCollect",response:[{type:"Property",name:"collect"}]},"23_9":{service:"msgExtend",cmd:"deleteCollects",response:[{type:"Number",name:"deleteNum"}]},"23_10":{service:"msgExtend",cmd:"updateCollect",response:[{type:"Property",name:"collect"}]},"23_11":{service:"msgExtend",cmd:"getCollects",response:[{type:"Number",name:"total"},{type:"PropertyArray",name:"collectList",entity:"collect"}]},"23_12":{service:"msgExtend",cmd:"addStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_13":{service:"msgExtend",cmd:"deleteStickTopSession",response:[{type:"Number",name:"timetag"}]},"23_14":{service:"msgExtend",cmd:"updateStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_15":{service:"msgExtend",cmd:"addMsgPin",response:[{type:"Number",name:"timetag"}]},"23_16":{service:"msgExtend",cmd:"updateMsgPin",response:[{type:"Number",name:"timetag"}]},"23_17":{service:"msgExtend",cmd:"deleteMsgPin",response:[{type:"Number",name:"timetag"}]},"23_18":{service:"msgExtend",cmd:"onAddMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_19":{service:"msgExtend",cmd:"onUpdateMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_20":{service:"msgExtend",cmd:"onDeleteMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_21":{service:"msgExtend",cmd:"getMsgPins",response:[{type:"Number",name:"timetag"},{type:"Boolean",name:"modify"},{type:"PropertyArray",name:"pins",entity:"msgPinRes"}]},"23_103":{service:"msgExtend",cmd:"syncAddQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_104":{service:"msgExtend",cmd:"syncDeleteQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_112":{service:"msgExtend",cmd:"syncAddStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_113":{service:"msgExtend",cmd:"syncDeleteStickTopSession",response:[{type:"Number",name:"timetag"},{type:"Property",name:"stickTopSession"}]},"23_114":{service:"msgExtend",cmd:"syncUpdateStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_115":{service:"msgExtend",cmd:"syncAddMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_116":{service:"msgExtend",cmd:"syncUpdateMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_117":{service:"msgExtend",cmd:"syncDeleteMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"21_2":{service:"superTeam",cmd:"sendSuperTeamMsg",response:[{type:"Property",name:"msg"}]},"21_3":{service:"superTeam",cmd:"superTeamMsg",response:[{type:"Property",name:"msg"}]},"21_5":{service:"superTeam",cmd:"addSuperTeamMembers",response:[{type:"StrArray",name:"abortedAccidList"},{type:"long",name:"timetag"}]},"21_6":{service:"superTeam",cmd:"removeSuperTeamMembers"},"21_7":{service:"superTeam",cmd:"leaveSuperTeam"},"21_8":{service:"superTeam",cmd:"updateSuperTeam",response:[{type:"long",name:"timetag"}]},"21_9":{service:"superTeam",cmd:"getSuperTeam",response:[{type:"Property",name:"team"}]},"21_12":{service:"superTeam",cmd:"getSuperTeams",response:[{type:"PropertyArray",name:"teams",entity:"superTeam"},{type:"bool",name:"isAll"},{type:"long",name:"timetag"}]},"21_10":{service:"superTeam",cmd:"updateInfoInSuperTeam"},"21_13":{service:"superTeam",cmd:"getSuperTeamMembers",response:[{type:"long",name:"timetag"}]},"21_11":{service:"superTeam",cmd:"getMySuperTeamMembers",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_14":{service:"superTeam",cmd:"getSuperTeamHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"21_15":{service:"superTeam",cmd:"getSuperTeamMembersByJoinTime",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_16":{service:"superTeam",cmd:"sendSuperTeamCustomSysMsg",trivialErrorCodes:[7101]},"21_17":{service:"superTeam",cmd:"onDeleteSuperTeamMsg"},"21_18":{service:"superTeam",cmd:"onSuperTeamMsgDelete",response:[{type:"Property",name:"sysMsg"}]},"21_19":{service:"superTeam",cmd:"superTeamCustomSysMsg",response:[{type:"Property",name:"sysMsg"}]},"21_20":{service:"superTeam",cmd:"applySuperTeam",response:[{type:"Property",name:"team"}]},"21_21":{service:"superTeam",cmd:"passSuperTeamApply"},"21_22":{service:"superTeam",cmd:"rejectSuperTeamApply"},"21_23":{service:"superTeam",cmd:"acceptSuperTeamInvite",response:[{type:"Property",name:"team"}]},"21_24":{service:"superTeam",cmd:"rejectSuperTeamInvite"},"21_25":{service:"superTeam",cmd:"onMarkSuperTeamSessionAck"},"21_26":{service:"superTeam",cmd:"addSuperTeamManagers"},"21_27":{service:"superTeam",cmd:"removeSuperTeamManagers"},"21_28":{service:"superTeam",cmd:"updateSuperTeamMute"},"21_29":{service:"superTeam",cmd:"updateSuperTeamMembersMute",response:[{type:"long",name:"timetag"}]},"21_30":{service:"superTeam",cmd:"updateNickInSuperTeam"},"21_31":{service:"superTeam",cmd:"transferSuperTeam"},"21_32":{service:"superTeam",cmd:"onMarkSuperTeamSessionsAck"},"21_33":{service:"superTeam",cmd:"getSuperTeamMembersByAccounts",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_34":{service:"superTeam",cmd:"getMutedSuperTeamMembers",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_113":{service:"superTeam",cmd:"syncSuperTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"members",entity:"superTeamMember"},{type:"bool",name:"isAll"},{type:"long",name:"timetag"}]},"21_111":{service:"superTeam",cmd:"syncMySuperTeamMembers",response:[{type:"PropertyArray",name:"teamMembers",entity:"superTeamMember"},{type:"long",name:"timetag"}]},"21_109":{service:"superTeam",cmd:"syncSuperTeams",response:[{type:"PropertyArray",name:"teams",entity:"superTeam"},{type:"bool",name:"isAll"},{type:"long",name:"timetag"}]},"21_101":{service:"superTeam",cmd:"syncCreateSuperTeam",response:[{type:"Property",name:"team"}]},"21_102":{service:"superTeam",cmd:"syncSendSuperTeamMsg",response:[{type:"Property",name:"msg"}]},"21_110":{service:"superTeam",cmd:"syncUpdateSuperTeamMember",response:[{type:"Property",name:"teamMember",entity:"superTeamMember"}]},"21_117":{service:"superTeam",cmd:"syncDeleteSuperTeamMsg",response:[{type:"Property",name:"sysMsg"}]},"21_125":{service:"superTeam",cmd:"syncMarkSuperTeamSessionAck",response:[{type:"Long",name:"to"},{type:"Long",name:"timetag"}]},"8_1":{service:"team",cmd:"createTeam",response:[{type:"Property",name:"team"},{type:"StrArray",name:"abortedAccidList"}]},"8_2":{service:"team",cmd:"sendTeamMsg",response:[{type:"Property",name:"msg"}]},"8_3":{service:"team",cmd:"teamMsg",response:[{type:"Property",name:"msg"}]},"8_4":{service:"team",cmd:"teamMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_5":{service:"team",cmd:"addTeamMembers",response:[{type:"long",name:"time"},{type:"StrArray",name:"abortedAccidList"}]},"8_6":{service:"team",cmd:"removeTeamMembers"},"8_7":{service:"team",cmd:"updateTeam",response:[{type:"Number",name:"id"},{type:"Number",name:"time"}]},"8_8":{service:"team",cmd:"leaveTeam"},"8_9":{service:"team",cmd:"getTeam",response:[{type:"Property",name:"team"}]},"8_10":{service:"team",cmd:"getTeams",response:[{type:"PropertyArray",name:"teams",entity:"team"},{type:"Number",name:"timetag"}]},"8_11":{service:"team",cmd:"getTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"members",entity:"teamMember"},{type:"Number",name:"timetag"}]},"8_12":{service:"team",cmd:"dismissTeam"},"8_13":{service:"team",cmd:"applyTeam",response:[{type:"Property",name:"team"}]},"8_14":{service:"team",cmd:"passTeamApply"},"8_15":{service:"team",cmd:"rejectTeamApply"},"8_16":{service:"team",cmd:"addTeamManagers"},"8_17":{service:"team",cmd:"removeTeamManagers"},"8_18":{service:"team",cmd:"transferTeam"},"8_19":{service:"team",cmd:"updateInfoInTeam"},"8_20":{service:"team",cmd:"updateNickInTeam"},"8_21":{service:"team",cmd:"acceptTeamInvite",response:[{type:"Property",name:"team"}]},"8_22":{service:"team",cmd:"rejectTeamInvite"},"8_23":{service:"team",cmd:"getTeamHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_24":{service:"team",cmd:"searchTeamHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_25":{service:"team",cmd:"updateMuteStateInTeam"},"8_26":{service:"team",cmd:"getMyTeamMembers",response:[{type:"PropertyArray",name:"teamMembers",entity:"teamMember"}]},"8_27":{service:"team",cmd:"getMutedTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"teamMembers",entity:"teamMember"}]},"8_28":{service:"team",cmd:"sendTeamMsgReceipt",response:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},"8_29":{service:"team",cmd:"getTeamMsgReads",response:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},"8_30":{service:"team",cmd:"getTeamMsgReadAccounts",response:[{type:"Property",name:"teamMsgReceipt"},{type:"StrArray",name:"readAccounts"},{type:"StrArray",name:"unreadAccounts"}]},"8_31":{service:"team",cmd:"notifyTeamMsgReads",response:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},"8_32":{service:"team",cmd:"muteTeamAll",response:[]},"8_33":{service:"team",cmd:"getTeamMemberInvitorAccid",response:[{type:"object",name:"accountsMap"}]},"8_34":{service:"team",cmd:"getTeamsById",response:[{type:"PropertyArray",name:"teams",entity:"team"},{type:"StrArray",name:"tids"}],trivialErrorCodes:[816]},"8_126":{service:"team",cmd:"syncMyTeamMembers",response:[{type:"PropertyArray",name:"teamMembers",entity:"teamMember"},{type:"Number",name:"timetag"}]},"8_109":{service:"team",cmd:"syncTeams",response:[{type:"Number",name:"timetag"},{type:"PropertyArray",name:"teams",entity:"team"}]},"8_111":{service:"team",cmd:"syncTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"members",entity:"teamMember"},{type:"Number",name:"timetag"}]},"8_101":{service:"team",cmd:"syncCreateTeam",response:[{type:"Property",name:"team"}]},"8_102":{service:"team",cmd:"syncSendTeamMsg",response:[{type:"Property",name:"msg"}]},"8_119":{service:"team",cmd:"syncUpdateTeamMember",response:[{type:"Property",name:"teamMember"}]},"12_1":{service:"friend",cmd:"friendRequest"},"12_101":{service:"friend",cmd:"syncFriendRequest",response:[{type:"String",name:"account"},{type:"Number",name:"type"},{type:"String",name:"ps"}]},"12_2":{service:"friend",cmd:"deleteFriend"},"12_102":{service:"friend",cmd:"syncDeleteFriend",response:[{type:"String",name:"account"}]},"12_3":{service:"friend",cmd:"updateFriend"},"12_103":{service:"friend",cmd:"syncUpdateFriend",response:[{type:"Property",name:"friend"}]},"12_4":{service:"friend",cmd:"getFriends",response:[{type:"PropertyArray",name:"friends",entity:"friend"},{type:"Number",name:"timetag"}]},"12_5":{service:"friend",cmd:"syncFriends",response:[{type:"PropertyArray",name:"friends",entity:"friend"},{type:"Number",name:"timetag"}]},"12_6":{service:"friend",cmd:"syncFriendUsers",response:[{type:"PropertyArray",name:"users",entity:"user"},{type:"Number",name:"timetag"}]},"13_1":{service:"chatroom",cmd:"getChatroomAddress",response:[{type:"StrArray",name:"address"}]},"14_1":{service:"eventService",cmd:"publishEvent",response:[{type:"Property",name:"msgEvent"}]},"14_2":{service:"eventService",cmd:"pushEvent",response:[{type:"Property",name:"msgEvent"}]},"14_3":{service:"eventService",cmd:"subscribeEvent",response:[{type:"StrArray",name:"accounts"}]},"14_4":{service:"eventService",cmd:"unSubscribeEventsByAccounts",response:[{type:"StrArray",name:"accounts"}]},"14_5":{service:"eventService",cmd:"unSubscribeEventsByType"},"14_6":{service:"eventService",cmd:"querySubscribeEventsByAccounts",response:[{type:"PropertyArray",name:"msgEventSubscribes",entity:"msgEventSubscribe"}]},"14_7":{service:"eventService",cmd:"querySubscribeEventsByType",response:[{type:"PropertyArray",name:"msgEventSubscribes",entity:"msgEventSubscribe"}]},"14_9":{service:"eventService",cmd:"pushEvents",response:[{type:"PropertyArray",name:"msgEvents",entity:"msgEvent"}]},"22_1":{service:"proxyService",cmd:"httpProxy",response:[{type:"Property",name:"proxyTag"}]},"22_2":{service:"proxyService",cmd:"onProxyMsg",response:[{type:"Property",name:"proxyMsg",entity:"proxyMsgTag"}]},"24_1":{service:"qchat",cmd:"getQChatAddress",response:[{type:"StrArray",name:"address"}]},"101_1":{service:"filter",cmd:"sendFilterMsg",response:[{type:"Property",name:"msg"}]},"101_2":{service:"filter",cmd:"filterMsg",response:[{type:"Property",name:"msg"}]},"101_3":{service:"filter",cmd:"filterSysMsg",response:[{type:"Property",name:"sysMsg"}]},"101_7":{service:"filter",cmd:"sendFilterCustomSysMsg"}});t.exports={idMap:a,cmdConfig:i,packetConfig:u}},function(t,r){t.exports={negotiateTransportTag:{version:-1,serializeList:1,serialize:101},initTransportTag:{},nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},audioToText:{url:2},imageOp:{type:0,stripmeta:1,typeType:2,blurRadius:3,blurSigma:4,qualityQuality:5,cropX:6,cropY:7,cropWidth:8,cropHeight:9,rotateAngle:10,pixelPixel:11,thumbnailMode:12,thumbnailWidth:13,thumbnailHeight:14,thumbnailAxisX:15,thumbnailAxisY:16,thumbnailCenterX:17,thumbnailCenterY:18,thumbnailEnlarge:19,thumbnailToStatic:20,watermarkType:21,watermarkGravity:22,watermarkDissolve:23,watermarkDx:24,watermarkDy:25,watermarkImage:26,watermarkText:27,watermarkFont:28,watermarkFontSize:29,watermarkFontColor:30,interlace:31},robot:{account:4,nick:5,avatar:6,intro:7,config:8,valid:9,createTime:10,updateTime:11,custid:12,botid:13,bindTime:14},clientAntispam:{version:1,md5:2,nosurl:3,thesaurus:4},fileQuickTransfer:{md5:1,url:2,size:3,threshold:4},transToken:{name:1,type:2,transType:3,size:4,extra:5,body:6},transInfo:{docId:1,name:2,prefix:3,size:4,type:5,state:6,transType:7,transSize:8,pageCount:9,picInfo:10,extra:11,flag:12},nosFileUrlTag:{safeUrl:0,originUrl:1},nosAccessTokenTag:{token:0,url:1,userAgent:2,ext:3},fileListParam:{fromDocId:1,limit:2},avSignalTag:{type:1,channelName:2,channelId:3,channelCreateTime:4,channelExpireTime:5,creator:6,ext:7,channelInValid:8,from:10,to:11,requestId:12,needPush:13,pushTitle:14,pushContent:15,pushPayload:16,needBadge:17,members:18,attach:19,attachExt:20,isSave:21,msgid:22,uid:23,time:24,nertcChannelName:25,nertcTokenTtl:26,nertcToken:27,nertcJoinRoomQueryParamMap:28,nertcJoinRoomResponse:29,callStatus:30},login:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appKey:18,account:19,browser:24,session:26,deviceInfo:32,sdkType:41,userAgent:42,isReactNative:112,token:1e3,customTag:38,customClientType:39,sdkHumanVersion:40,authType:115,loginExt:116},loginRes:{lastLoginDeviceId:17,customTag:38,connectionId:102,ip:103,port:104,country:106,hasXMPush:111},loginPort:{type:3,os:4,mac:5,deviceId:13,account:19,deviceInfo:32,connectionId:102,ip:103,time:109,customTag:38,customClientType:39},aosPushInfo:{pushType:110,hasTokenPreviously:111},sync:{myInfo:1,offlineMsgs:2,teams:3,netcallMsgs:6,roamingMsgs:7,relations:9,friends:11,sessions:12,friendUsers:13,msgReceipts:14,myTeamMembers:15,donnop:16,deleteMsg:17,sessionAck:18,robots:19,broadcastMsgs:20,avSignal:21,superTeams:22,myInfoInSuperTeams:23,superTeamRoamingMsgs:24,deleteSuperTeamMsg:25,superTeamSessionAck:26,deleteMsgSelf:27,stickTopSessions:28,sessionHistoryMsgsDelete:29,filterMsgs:100},donnop:{open:1},sessionReqTag:{minTimestamp:1,maxTimestamp:2,needLastMsg:3,limit:4,hasMore:5},session:{id:1,updateTime:2,ext:3,lastMsg:4},superTeam:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,custom:18,serverCustom:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateCustomMode:24,mute:100,muteType:101},superTeamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,createTime:10,updateTime:11,custom:12,mute:13,invitoraccid:14,joinTime:15},team:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,custom:18,serverCustom:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateCustomMode:24,mute:100,muteType:101},teamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,joinTime:10,updateTime:11,custom:12,mute:13,invitorAccid:14},msg:{scene:0,to:1,from:2,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,type:8,body:9,attach:10,idClient:11,idServer:12,resend:13,userUpdateTime:14,custom:15,pushPayload:16,pushContent:17,apnsAccounts:18,apnsContent:19,apnsForcePush:20,yidunEnable:21,antiSpamContent:22,antiSpamBusinessId:23,clientAntiSpam:24,antiSpamUsingYidun:25,needMsgReceipt:26,needUpdateSession:28,replyMsgFromAccount:29,replyMsgToAccount:30,replyMsgTime:31,replyMsgIdServer:32,replyMsgIdClient:33,threadMsgFromAccount:34,threadMsgToAccount:35,threadMsgTime:36,threadMsgIdServer:37,threadMsgIdClient:38,delete:39,callbackExt:40,subType:41,yidunAntiCheating:42,env:43,yidunAntiSpamExt:44,yidunAntiSpamRes:45,__clientExt:46,robotInfoFunction:47,robotInfoTopic:48,robotInfoCustomContent:49,robotInfoAccount:50,isHistoryable:100,isRoamingable:101,isSyncable:102,isMuted:104,cc:105,isInBlackList:106,isPushable:107,isOfflinable:108,isUnreadable:109,needPushNick:110,isReplyMsg:111,tempTeamMemberCount:112},threadMsgReq:{beginTime:1,endTime:2,lastMsgId:3,limit:4,reverse:5},threadMsgsMeta:{total:1,lastMsgTime:2},comment:{from:1,body:2,time:3,custom:4,needPush:5,needBadge:6,pushTitle:7,apnsText:8,pushPayload:9},commentReq:{scene:1,from:2,to:3,time:4,idServer:5,idClient:6,timestamp:100},commentRes:{scene:1,from:2,to:3,time:4,idServer:5,idClient:6,detail:7,modify:8,timestamp:100},collect:{id:1,type:2,data:3,custom:4,uniqueId:5,createTime:6,updateTime:7},collectQuery:{beginTime:1,endTime:2,lastMsgId:3,limit:4,reverse:5,type:6},stickTopSession:{id:1,topCustom:2,createTime:3,updateTime:4},pinTag:{pinFrom:1,pinCustom:2,createTime:3,updateTime:4},msgPinReq:{sessionId:1,timetag:2},msgPinRes:{scene:1,from:2,to:3,time:4,idServer:5,idClient:6,pinFrom:7,pinCustom:8},msgReceipt:{to:1,from:2,time:7,idClient:11},teamMsgReceipt:{teamId:0,idServer:1,read:100,unread:101,idClient:102,account:103},deleteMsgSelfTag:{scene:1,from:2,to:3,idServer:4,idClient:5,time:6,deletedTime:7,custom:8},sysMsg:{time:0,type:1,to:2,from:3,ps:4,attach:5,idServer:6,sendToOnlineUsersOnly:7,apnsText:8,pushPayload:9,deletedIdClient:10,deletedIdServer:11,yidunEnable:12,antiSpamContent:13,deletedMsgTime:14,deletedMsgFromNick:15,opeAccount:16,env:21,idClient:23,callbackExt:22,cc:105,isPushable:107,isUnreadable:109,needPushNick:110},broadcastMsg:{broadcastId:1,fromAccid:2,fromUid:3,timestamp:4,body:5},friend:{account:4,flag:5,beflag:6,source:7,alias:8,bits:9,custom:10,createTime:11,updateTime:12,serverex:13},user:{account:1,nick:3,avatar:4,sign:5,gender:6,email:7,birth:8,tel:9,custom:10,createTime:12,updateTime:13},antispamTag:{antiSpamBusinessId:1},specialRelation:{account:0,isMuted:1,isBlacked:2,createTime:3,updateTime:4},msgType:{text:0,picture:1,audio:2,video:3,location:4,notification:5,file:6,netcall_audio:7,netcall_vedio:8,datatunnel_new:9,tips:10,robot:11,custom:100},msgEvent:{type:1,value:2,idClient:3,custom:4,validTime:5,broadcastType:6,sync:7,validTimeType:8,durable:9,time:10,idServer:11,clientType:12,serverConfig:13,serverCustom:14,appid:101,account:103,enableMultiClient:104,consid:106},msgEventSubscribe:{type:1,subscribeTime:2,sync:3,to:102,from:104,time:105},clearMsgsParams:{account:1,delRoam:2},clearMsgsParamsWithSync:{type:0,otherAccid:1,isDeleteRoam:2,toTid:3,isSyncSelf:4,fromAccid:5,time:6,ext:7},msgFullSearchRequestTag:{keyword:1,fromTime:2,toTime:3,sessionLimit:4,msgLimit:5,order:6,p2pList:7,teamList:8,senderList:9,msgTypeList:10,msgSubTypeList:11},msgTimingFullSearchRequestTag:{keyword:1,fromTime:2,toTime:3,msgLimit:5,order:6,p2pList:7,teamList:8,senderList:9,msgTypeList:10,msgSubTypeList:11},delFriendParams:{delAlias:1},proxyTag:{zone:1,path:2,method:3,header:4,body:5},proxyMsgTag:{from:1,body:2,time:3},sessionAckTag:{scene:1,to:2,timetag:3},mixTokenReq:{provider:0,tokenCount:1,fileExpireSec:2,tag:3,returnBody:4},mixAuthTokenReq:{type:1,urls:2},notifyDetectTag:{type:1,params:2,result:3,t1:100,t2:101,t3:102,t4:103,t5:104,t6:105},getQChatAddressTag:{ipType:1}}},function(t,r){t.exports={negotiateTransportTag:{"-1":"version",1:"serializeList",101:"serialize"},initTransportTag:{},nosToken:{1:"objectName",2:"token",3:"bucket",4:"expireTime",7:"expireSec",8:"tag",9:"shortUrl"},audioToText:{2:"url"},imageOp:{0:"type",1:"stripmeta",2:"typeType",3:"blurRadius",4:"blurSigma",5:"qualityQuality",6:"cropX",7:"cropY",8:"cropWidth",9:"cropHeight",10:"rotateAngle",11:"pixelPixel",12:"thumbnailMode",13:"thumbnailWidth",14:"thumbnailHeight",15:"thumbnailAxisX",16:"thumbnailAxisY",17:"thumbnailCenterX",18:"thumbnailCenterY",19:"thumbnailEnlarge",20:"thumbnailToStatic",21:"watermarkType",22:"watermarkGravity",23:"watermarkDissolve",24:"watermarkDx",25:"watermarkDy",26:"watermarkImage",27:"watermarkText",28:"watermarkFont",29:"watermarkFontSize",30:"watermarkFontColor",31:"interlace"},robot:{4:"account",5:"nick",6:"avatar",7:"intro",8:"config",9:"valid",10:"createTime",11:"updateTime",12:"custid",13:"botid",14:"bindTime",_6_safe:"_avatar_safe"},clientAntispam:{1:"version",2:"md5",3:"nosurl",4:"thesaurus"},fileQuickTransfer:{1:"md5",2:"url",3:"size",4:"threshold",_2_safe:"_url_safe"},transToken:{1:"name",2:"type",3:"transType",4:"size",5:"extra",6:"body"},transInfo:{1:"docId",2:"name",3:"prefix",4:"size",5:"type",6:"state",7:"transType",8:"transSize",9:"pageCount",10:"picInfo",11:"extra",12:"flag"},nosFileUrlTag:{0:"safeUrl",1:"originUrl"},nosAccessTokenTag:{0:"token",1:"url",2:"userAgent",3:"ext"},nosConfigTag:{1:"bucket",2:"cdnDomain",3:"expire",4:"objectNamePrefix"},appGrayConfigTag:{0:"grayConfig",1:"ttl"},mixStorePolicyTag:{0:"providers",1:"ttl",2:"mixEnable",3:"nosPolicy",4:"s3Policy"},mixStoreTokenTag:{0:"provider",1:"accessKeyId",2:"secretAccessKey",3:"sessionToken",4:"token",5:"expireAt",6:"bucket",7:"objectName",8:"fileExpireSec",9:"tag",10:"shortUrl",11:"region"},notifyDetectTag:{1:"type",2:"params",3:"result",100:"t1",101:"t2",102:"t3",103:"t4",104:"t5",105:"t6"},backSourceTokenTag:{1:"type",2:"tokens",3:"token",4:"ttl"},fileListParam:{1:"fromDocId",2:"limit"},avSignalTag:{1:"type",2:"channelName",3:"channelId",4:"channelCreateTime",5:"channelExpireTime",6:"creator",7:"ext",8:"channelInValid",10:"from",11:"to",12:"requestId",13:"needPush",14:"pushTitle",15:"pushContent",16:"pushPayload",17:"needBadge",18:"members",19:"attach",20:"attachExt",21:"isSave",22:"msgid",23:"uid",24:"time",25:"nertcChannelName",26:"nertcTokenTtl",27:"nertcToken",28:"nertcJoinRoomQueryParamMap",29:"nertcJoinRoomResponse",30:"callStatus"},login:{3:"clientType",4:"os",6:"sdkVersion",8:"appLogin",9:"protocolVersion",10:"pushTokenName",11:"pushToken",13:"deviceId",18:"appKey",19:"account",24:"browser",26:"session",32:"deviceInfo",38:"customTag",39:"customClientType",40:"sdkHumanVersion",112:"isReactNative",115:"authType",116:"loginExt",1e3:"token"},loginRes:{17:"lastLoginDeviceId",38:"customTag",102:"connectionId",103:"ip",104:"port",106:"country",111:"hasXMPush"},loginPort:{3:"type",4:"os",5:"mac",13:"deviceId",19:"account",32:"deviceInfo",38:"customTag",39:"customClientType",102:"connectionId",103:"ip",109:"time"},aosPushInfo:{110:"pushType",111:"hasTokenPreviously"},sync:{1:"myInfo",2:"offlineMsgs",3:"teams",6:"netcallMsgs",7:"roamingMsgs",9:"relations",11:"friends",12:"sessions",13:"friendUsers",14:"msgReceipts",15:"myTeamMembers",16:"donnop",17:"deleteMsg",18:"sessionAck",19:"robots",20:"broadcastMsgs",21:"avSignal",22:"superTeams",23:"myInfoInSuperTeams",24:"superTeamRoamingMsgs",25:"deleteSuperTeamMsg",26:"superTeamSessionAck",27:"deleteMsgSelf",28:"stickTopSessions",29:"sessionHistoryMsgsDelete",100:"filterMsgs"},donnop:{1:"open"},sessionReqTag:{1:"minTimestamp",2:"maxTimestamp",3:"needLastMsg",4:"limit",5:"hasMore"},session:{1:"id",2:"updateTime",3:"ext",4:"lastMsg",5:"lastMsgType"},superTeam:{1:"teamId",3:"name",4:"type",5:"owner",6:"level",7:"selfCustom",8:"valid",9:"memberNum",10:"memberUpdateTime",11:"createTime",12:"updateTime",13:"validToCurrentUser",14:"intro",15:"announcement",16:"joinMode",17:"bits",18:"custom",19:"serverCustom",20:"avatar",21:"beInviteMode",22:"inviteMode",23:"updateTeamMode",24:"updateCustomMode",100:"mute",101:"muteType",_20_safe:"_avatar_safe"},superTeamMember:{1:"teamId",3:"account",4:"type",5:"nickInTeam",7:"bits",8:"active",9:"valid",10:"createTime",11:"updateTime",12:"custom",13:"mute",14:"invitoraccid",15:"joinTime"},team:{1:"teamId",3:"name",4:"type",5:"owner",6:"level",7:"selfCustom",8:"valid",9:"memberNum",10:"memberUpdateTime",11:"createTime",12:"updateTime",13:"validToCurrentUser",14:"intro",15:"announcement",16:"joinMode",17:"bits",18:"custom",19:"serverCustom",20:"avatar",21:"beInviteMode",22:"inviteMode",23:"updateTeamMode",24:"updateCustomMode",100:"mute",101:"muteType",_20_safe:"_avatar_safe"},teamMember:{1:"teamId",3:"account",4:"type",5:"nickInTeam",7:"bits",8:"active",9:"valid",10:"joinTime",11:"updateTime",12:"custom",13:"mute",14:"invitorAccid"},msg:{0:"scene",1:"to",2:"from",4:"fromClientType",5:"fromDeviceId",6:"fromNick",7:"time",8:"type",9:"body",10:"attach",11:"idClient",12:"idServer",13:"resend",14:"userUpdateTime",15:"custom",16:"pushPayload",17:"pushContent",18:"apnsAccounts",19:"apnsContent",20:"apnsForcePush",21:"yidunEnable",22:"antiSpamContent",23:"antiSpamBusinessId",24:"clientAntiSpam",25:"antiSpamUsingYidun",26:"needMsgReceipt",28:"needUpdateSession",29:"replyMsgFromAccount",30:"replyMsgToAccount",31:"replyMsgTime",32:"replyMsgIdServer",33:"replyMsgIdClient",34:"threadMsgFromAccount",35:"threadMsgToAccount",36:"threadMsgTime",37:"threadMsgIdServer",38:"threadMsgIdClient",39:"delete",40:"callbackExt",41:"subType",42:"yidunAntiCheating",43:"env",44:"yidunAntiSpamExt",45:"yidunAntiSpamRes",46:"__clientExt",47:"robotInfoFunction",48:"robotInfoTopic",49:"robotInfoCustomContent",50:"robotInfoAccount",100:"isHistoryable",101:"isRoamingable",102:"isSyncable",104:"isMuted",105:"cc",106:"isInBlackList",107:"isPushable",108:"isOfflinable",109:"isUnreadable",110:"needPushNick",111:"isReplyMsg",112:"tempTeamMemberCount"},threadMsgReq:{1:"beginTime",2:"endTime",3:"lastMsgId",4:"limit",5:"reverse"},threadMsgsMeta:{1:"total",2:"lastMsgTime"},comment:{1:"from",2:"body",3:"time",4:"custom",5:"needPush",6:"needBadge",7:"pushTitle",8:"apnsText",9:"pushPayload"},commentReq:{1:"scene",2:"from",3:"to",4:"time",5:"idServer",6:"idClient",100:"timestamp"},commentRes:{1:"scene",2:"from",3:"to",4:"time",5:"idServer",6:"idClient",7:"detail",8:"modify",100:"timestamp"},collect:{1:"id",2:"type",3:"data",4:"custom",5:"uniqueId",6:"createTime",7:"updateTime"},collectQuery:{1:"beginTime",2:"endTime",3:"lastMsgId",4:"limit",5:"reverse",6:"type"},stickTopSession:{1:"id",2:"topCustom",3:"createTime",4:"updateTime"},pinTag:{1:"pinFrom",2:"pinCustom",3:"createTime",4:"updateTime"},msgPinReq:{1:"sessionId",2:"timetag"},msgPinRes:{1:"scene",2:"from",3:"to",4:"time",5:"idServer",6:"idClient",7:"pinFrom",8:"pinCustom"},msgReceipt:{1:"to",2:"from",7:"time",11:"idClient"},teamMsgReceipt:{0:"teamId",1:"idServer",100:"read",101:"unread",102:"idClient",103:"account"},deleteMsgSelfTag:{1:"scene",2:"from",3:"to",4:"idServer",5:"idClient",6:"time",7:"deletedTime",8:"custom"},sysMsg:{0:"time",1:"type",2:"to",3:"from",4:"ps",5:"attach",6:"idServer",7:"sendToOnlineUsersOnly",8:"apnsText",9:"pushPayload",10:"deletedIdClient",11:"deletedIdServer",12:"yidunEnable",13:"antiSpamContent",14:"deletedMsgTime",15:"deletedMsgFromNick",16:"opeAccount",21:"env",22:"callbackExt",23:"idClient",105:"cc",107:"isPushable",109:"isUnreadable",110:"needPushNick"},broadcastMsg:{1:"broadcastId",2:"fromAccid",3:"fromUid",4:"timestamp",5:"body"},friend:{4:"account",5:"flag",6:"beflag",7:"source",8:"alias",9:"bits",10:"custom",11:"createTime",12:"updateTime",13:"serverex"},user:{1:"account",3:"nick",4:"avatar",5:"sign",6:"gender",7:"email",8:"birth",9:"tel",10:"custom",12:"createTime",13:"updateTime",_4_safe:"_avatar_safe"},antispamTag:{antiSpamBusinessId:1},specialRelation:{0:"account",1:"isMuted",2:"isBlacked",3:"createTime",4:"updateTime"},msgType:{0:"text",1:"picture",2:"audio",3:"video",4:"location",5:"notification",6:"file",7:"netcall_audio",8:"netcall_vedio",9:"datatunnel_new",10:"tips",11:"robot",100:"custom"},msgEvent:{1:"type",2:"value",3:"idClient",4:"custom",5:"validTime",6:"broadcastType",7:"sync",8:"validTimeType",9:"durable",10:"time",11:"idServer",12:"clientType",13:"serverConfig",14:"serverCustom",101:"appid",103:"account",104:"enableMultiClient",106:"consid"},msgEventSubscribe:{1:"type",2:"subscribeTime",3:"sync",102:"to",104:"from",105:"time"},clearMsgsParams:{1:"account",2:"delRoam"},clearMsgsParamsWithSync:{0:"type",1:"otherAccid",2:"delRoam",3:"toTid",4:"isSyncSelf",5:"fromAccid",6:"time",7:"ext"},msgFullSearchRequestTag:{1:"keyword",2:"fromTime",3:"toTime",4:"sessionLimit",5:"msgLimit",6:"order",7:"p2pList",8:"teamList",9:"senderList",10:"msgTypeList",11:"msgSubTypeList"},delFriendParams:{1:"delAlias"},proxyTag:{1:"zone",2:"path",3:"method",4:"header",5:"body"},proxyMsgTag:{1:"from",2:"body",3:"time"},sessionReliableSyncTag:{1:"scene",2:"sessionId",3:"syncStatus",4:"syncEndMsgId",5:"syncEndMsgidClient",6:"syncEndMsgTime",7:"syncStartMsgid",8:"syncStartMsgidClient",9:"syncStartMsgTime",10:"nextMsgid",11:"nextMsgidClient",12:"nextMsgTime",13:"roamMsgSync",14:"offlineMsgSync",15:"netCallOfflineMsgSync"},sessionReliableSyncContextTag:{1:"timetag",2:"type"}}},function(t,r,e){var n=e(0),o=e(191),s=n.merge({},o.idMap,{chatroom:{id:13,login:2,kicked:3,logout:4,sendMsg:6,msg:7,getChatroomMembers:8,getHistoryMsgs:9,markChatroomMember:11,closeChatroom:12,getChatroom:13,updateChatroom:14,updateMyChatroomMemberInfo:15,getChatroomMembersInfo:16,kickChatroomMember:17,updateChatroomMemberTempMute:19,queueOffer:20,queuePoll:21,queueList:22,peak:23,queueDrop:24,queueInit:25,queueChange:26,updateTagMembersTempMute:30,getChatroomMembersByTag:31,getChatroomMemberCountByTag:32,updateCoordinate:33,updateChatroomTags:34,sendChatroomMsgAck:35,getHistoryMsgsByTags:36,notifyCdnInfo:99},user:{id:3,syncRobot:16}}),a=n.merge({},o.cmdConfig,{login:{sid:s.chatroom.id,cid:s.chatroom.login,params:[{type:"byte",name:"type"},{type:"Property",name:"login"},{type:"Property",name:"imLogin"}]},logout:{sid:s.chatroom.id,cid:s.chatroom.logout},sendMsg:{sid:s.chatroom.id,cid:s.chatroom.sendMsg,params:[{type:"Property",name:"msg"}]},getChatroomMembers:{sid:s.chatroom.id,cid:s.chatroom.getChatroomMembers,params:[{type:"byte",name:"type"},{type:"long",name:"time"},{type:"int",name:"limit"}]},getHistoryMsgs:{sid:s.chatroom.id,cid:s.chatroom.getHistoryMsgs,params:[{type:"long",name:"timetag"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},markChatroomMember:{sid:s.chatroom.id,cid:s.chatroom.markChatroomMember,params:[{type:"string",name:"account"},{type:"int",name:"type"},{type:"bool",name:"isAdd"},{type:"int",name:"level"},{type:"string",name:"custom"}]},closeChatroom:{sid:s.chatroom.id,cid:s.chatroom.closeChatroom,params:[{type:"string",name:"custom"}]},getChatroom:{sid:s.chatroom.id,cid:s.chatroom.getChatroom},updateChatroom:{sid:s.chatroom.id,cid:s.chatroom.updateChatroom,params:[{type:"Property",name:"chatroom"},{type:"bool",name:"needNotify"},{type:"String",name:"custom"},{type:"Property",name:"antispamTag"}]},updateMyChatroomMemberInfo:{sid:s.chatroom.id,cid:s.chatroom.updateMyChatroomMemberInfo,params:[{type:"Property",name:"chatroomMember"},{type:"bool",name:"needNotify"},{type:"String",name:"custom"},{type:"bool",name:"needSave"},{type:"Property",name:"antispamTag"}]},getChatroomMembersInfo:{sid:s.chatroom.id,cid:s.chatroom.getChatroomMembersInfo,params:[{type:"StrArray",name:"accounts"}]},kickChatroomMember:{sid:s.chatroom.id,cid:s.chatroom.kickChatroomMember,params:[{type:"string",name:"account"},{type:"string",name:"custom"}]},updateChatroomMemberTempMute:{sid:s.chatroom.id,cid:s.chatroom.updateChatroomMemberTempMute,params:[{type:"String",name:"account"},{type:"long",name:"duration"},{type:"bool",name:"needNotify"},{type:"String",name:"custom"}]},queueOffer:{sid:s.chatroom.id,cid:s.chatroom.queueOffer,params:[{type:"string",name:"elementKey"},{type:"string",name:"elementValue"},{type:"bool",name:"transient"},{type:"string",name:"elementAccount"}]},queuePoll:{sid:s.chatroom.id,cid:s.chatroom.queuePoll,params:[{type:"string",name:"elementKey"}]},queueList:{sid:s.chatroom.id,cid:s.chatroom.queueList},peak:{sid:s.chatroom.id,cid:s.chatroom.peak},queueDrop:{sid:s.chatroom.id,cid:s.chatroom.queueDrop},queueInit:{sid:s.chatroom.id,cid:s.chatroom.queueInit,params:[{type:"int",name:"limit"}]},queueChange:{sid:s.chatroom.id,cid:s.chatroom.queueChange,params:[{type:"StrStrMap",name:"elementMap"},{type:"bool",name:"needNotify"},{type:"string",name:"notifyExt"}]},updateTagMembersTempMute:{sid:s.chatroom.id,cid:s.chatroom.updateTagMembersTempMute,params:[{type:"Property",name:"tagMuteReq"}]},updateCoordinate:{sid:s.chatroom.id,cid:s.chatroom.updateCoordinate,params:[{type:"Property",name:"coordinateReq"}]},getChatroomMemberCountByTag:{sid:s.chatroom.id,cid:s.chatroom.getChatroomMemberCountByTag,params:[{type:"String",name:"tag"}]},getChatroomMembersByTag:{sid:s.chatroom.id,cid:s.chatroom.getChatroomMembersByTag,params:[{type:"Property",name:"tagMemberReq"}]},updateChatroomTags:{sid:s.chatroom.id,cid:s.chatroom.updateChatroomTags,params:[{type:"Property",name:"chatRoomTagsUpdateTag"}]},sendChatroomMsgAck:{sid:s.chatroom.id,cid:s.chatroom.sendChatroomMsgAck,params:[{type:"Property",name:"chatRoomMsgAckTag"}]},getHistoryMsgsByTags:{sid:s.chatroom.id,cid:s.chatroom.getHistoryMsgsByTags,params:[{type:"Property",name:"chatRoomTagHistoryMsgRequestTag"}]},notifyCdnInfo:{sid:s.chatroom.id,cid:s.chatroom.notifyCdnInfo},syncRobot:{sid:s.user.id,cid:s.user.syncRobot,params:[{type:"long",name:"timetag"}]}}),i=n.merge({},o.packetConfig,{"4_10":{service:"notify"},"4_11":{service:"notify"},"3_16":{service:"chatroom",cmd:"syncRobot",response:[{type:"PropertyArray",name:"robots",entity:"robot"}]},"13_2":{service:"chatroom",cmd:"login",response:[{type:"Property",name:"chatroom"},{type:"Property",name:"chatroomMember"},{type:"Property",name:"chatroomCdnInfo"}]},"13_3":{service:"chatroom",cmd:"kicked",response:[{type:"Number",name:"reason"},{type:"String",name:"custom"}]},"13_4":{service:"chatroom",cmd:"logout"},"13_6":{service:"chatroom",cmd:"sendMsg",response:[{type:"Property",name:"msg"}]},"13_7":{service:"chatroom",cmd:"msg",response:[{type:"Property",name:"msg"}]},"13_8":{service:"chatroom",cmd:"getChatroomMembers",response:[{type:"PropertyArray",name:"members",entity:"chatroomMember"}]},"13_9":{service:"chatroom",cmd:"getHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"13_11":{service:"chatroom",cmd:"markChatroomMember",response:[{type:"Property",name:"chatroomMember"}]},"13_12":{service:"chatroom",cmd:"closeChatroom"},"13_13":{service:"chatroom",cmd:"getChatroom",response:[{type:"Property",name:"chatroom"}]},"13_14":{service:"chatroom",cmd:"updateChatroom"},"13_15":{service:"chatroom",cmd:"updateMyChatroomMemberInfo"},"13_16":{service:"chatroom",cmd:"getChatroomMembersInfo",response:[{type:"PropertyArray",name:"members",entity:"chatroomMember"}]},"13_17":{service:"chatroom",cmd:"kickChatroomMember"},"13_19":{service:"chatroom",cmd:"updateChatroomMemberTempMute"},"13_20":{service:"chatroom",cmd:"queueOffer"},"13_21":{service:"chatroom",cmd:"queuePoll",response:[{type:"String",name:"elementKey"},{type:"String",name:"elementValue"}]},"13_22":{service:"chatroom",cmd:"queueList",response:[{type:"KVArray",name:"queueList"}]},"13_23":{service:"chatroom",cmd:"peak",response:[{type:"String",name:"elementKey"},{type:"String",name:"elementValue"}]},"13_24":{service:"chatroom",cmd:"queueDrop"},"13_25":{service:"chatroom",cmd:"queueInit"},"13_26":{service:"chatroom",cmd:"queueChange",response:[{type:"StrArray",name:"elementKeyArray"}]},"13_30":{service:"chatroom",cmd:"updateTagMembersTempMute"},"13_33":{service:"chatroom",cmd:"updateCoordinate"},"13_31":{service:"chatroom",cmd:"getChatroomMembersByTag",response:[{type:"PropertyArray",name:"members",entity:"chatroomMember"}]},"13_32":{service:"chatroom",cmd:"getChatroomMemberCountByTag",response:[{type:"long",name:"count"}]},"13_34":{service:"chatroom",cmd:"updateChatroomTags"},"13_36":{service:"chatroom",cmd:"getHistoryMsgsByTags",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"13_99":{service:"chatroom",cmd:"notifyCdnInfo",response:[{type:"Property",name:"chatroomCdnInfo"}]},"13_101":{service:"chatroom",cmd:"updateChatroomTag",response:[{type:"Property",name:"updateTags"}]}});t.exports={idMap:s,cmdConfig:a,packetConfig:i}},function(t,r){t.exports={imLogin:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appKey:18,account:19,browser:24,session:26,deviceInfo:32,sdkType:41,userAgent:42,isReactNative:112,authType:115,loginExt:116,token:1e3,customTag:38},nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},audioToText:{url:2},imageOp:{type:0,stripmeta:1,typeType:2,blurRadius:3,blurSigma:4,qualityQuality:5,cropX:6,cropY:7,cropWidth:8,cropHeight:9,rotateAngle:10,pixelPixel:11,thumbnailMode:12,thumbnailWidth:13,thumbnailHeight:14,thumbnailAxisX:15,thumbnailAxisY:16,thumbnailCenterX:17,thumbnailCenterY:18,thumbnailEnlarge:19,thumbnailToStatic:20,watermarkType:21,watermarkGravity:22,watermarkDissolve:23,watermarkDx:24,watermarkDy:25,watermarkImage:26,watermarkText:27,watermarkFont:28,watermarkFontSize:29,watermarkFontColor:30,interlace:31},robot:{account:4,nick:5,avatar:6,intro:7,config:8,valid:9,createTime:10,updateTime:11,custid:12,botid:13,bindTime:14},clientAntispam:{version:1,md5:2,nosurl:3,thesaurus:4},fileQuickTransfer:{md5:1,url:2,size:3,threshold:4},transToken:{name:1,type:2,transType:3,size:4,extra:5,body:6},transInfo:{docId:1,name:2,prefix:3,size:4,type:5,state:6,transType:7,transSize:8,pageCount:9,picInfo:10,extra:11,flag:12},nosFileUrlTag:{safeUrl:0,originUrl:1},nosAccessTokenTag:{token:0,url:1,userAgent:2,ext:3},fileListParam:{fromDocId:1,limit:2},avSignalTag:{type:1,channelName:2,channelId:3,channelCreateTime:4,channelExpireTime:5,creator:6,ext:7,channelInValid:8,from:10,to:11,requestId:12,needPush:13,pushTitle:14,pushContent:15,pushPayload:16,needBadge:17,members:18,attach:19,attachExt:20,isSave:21,msgid:22,uid:23,time:24,nertcChannelName:25,nertcTokenTtl:26,nertcToken:27,nertcJoinRoomQueryParamMap:28,nertcJoinRoomResponse:29,callStatus:30},login:{appKey:1,account:2,deviceId:3,chatroomId:5,appLogin:8,chatroomNick:20,chatroomAvatar:21,chatroomCustom:22,chatroomEnterCustom:23,session:26,isAnonymous:38,tags:39,notifyTargetTags:40,loginAuthType:41,loginExt:42,loc_x:43,loc_y:44,loc_z:45,distance:46,antiSpamBusinessId:47},chatroom:{id:1,name:3,announcement:4,broadcastUrl:5,custom:12,createTime:14,updateTime:15,queuelevel:16,creator:100,onlineMemberNum:101,mute:102},msg:{idClient:1,type:2,attach:3,custom:4,resend:5,userUpdateTime:6,fromNick:7,fromAvatar:8,fromCustom:9,yidunEnable:10,antiSpamContent:11,skipHistory:12,body:13,antiSpamBusinessId:14,clientAntiSpam:15,antiSpamUsingYidun:16,time:20,from:21,chatroomId:22,fromClientType:23,highPriority:25,callbackExt:27,subType:28,yidunAntiCheating:29,env:30,notifyTargetTags:31,yidunAntiSpamExt:32,yidunAntiSpamRes:33,loc_x:34,loc_y:35,loc_z:36,toAccids:37,needHighPriorityMsgAck:38,__clientExt:39},chatroomMember:{chatroomId:1,account:2,type:3,level:4,nick:5,avatar:6,custom:7,online:8,guest:9,enterTime:10,blacked:12,gaged:13,valid:14,updateTime:15,tempMuted:16,tempMuteDuration:17},antispamTag:{antiSpamBusinessId:1},chatroomCdnInfo:{enable:1,cdnUrls:2,timestamp:3,interval:4,decryptType:5,decryptKey:6,timeout:7},tagMemberReq:{tag:1,time:2,limit:3},tagMuteReq:{tag:1,duration:2,needNotify:3,custom:4,notifyTargetTags:5},coordinateReq:{x:1,y:2,z:3,distance:4},chatRoomTagsUpdateTag:{tags:1,notifyTargetTags:2,needNotify:3,ext:4},chatRoomMsgAckTag:{idClient:1,chatroomId:2},chatRoomTagHistoryMsgRequestTag:{tags:1,types:2,fromTime:3,toTime:4,limit:5,reverse:6}}},function(t,r){t.exports={imLogin:{3:"clientType",4:"os",6:"sdkVersion",8:"appLogin",9:"protocolVersion",10:"pushTokenName",11:"pushToken",13:"deviceId",18:"appKey",19:"account",24:"browser",26:"session",32:"deviceInfo",38:"customTag",41:"sdkType",42:"userAgent",112:"isReactNative",1e3:"token"},nosToken:{1:"objectName",2:"token",3:"bucket",4:"expireTime",7:"expireSec",8:"tag",9:"shortUrl"},audioToText:{2:"url"},imageOp:{0:"type",1:"stripmeta",2:"typeType",3:"blurRadius",4:"blurSigma",5:"qualityQuality",6:"cropX",7:"cropY",8:"cropWidth",9:"cropHeight",10:"rotateAngle",11:"pixelPixel",12:"thumbnailMode",13:"thumbnailWidth",14:"thumbnailHeight",15:"thumbnailAxisX",16:"thumbnailAxisY",17:"thumbnailCenterX",18:"thumbnailCenterY",19:"thumbnailEnlarge",20:"thumbnailToStatic",21:"watermarkType",22:"watermarkGravity",23:"watermarkDissolve",24:"watermarkDx",25:"watermarkDy",26:"watermarkImage",27:"watermarkText",28:"watermarkFont",29:"watermarkFontSize",30:"watermarkFontColor",31:"interlace"},robot:{4:"account",5:"nick",6:"avatar",7:"intro",8:"config",9:"valid",10:"createTime",11:"updateTime",12:"custid",13:"botid",14:"bindTime",_6_safe:"_avatar_safe"},clientAntispam:{1:"version",2:"md5",3:"nosurl",4:"thesaurus"},fileQuickTransfer:{1:"md5",2:"url",3:"size",4:"threshold",_2_safe:"_url_safe"},transToken:{1:"name",2:"type",3:"transType",4:"size",5:"extra",6:"body"},transInfo:{1:"docId",2:"name",3:"prefix",4:"size",5:"type",6:"state",7:"transType",8:"transSize",9:"pageCount",10:"picInfo",11:"extra",12:"flag"},nosFileUrlTag:{0:"safeUrl",1:"originUrl"},nosAccessTokenTag:{0:"token",1:"url",2:"userAgent",3:"ext"},fileListParam:{1:"fromDocId",2:"limit"},avSignalTag:{1:"type",2:"channelName",3:"channelId",4:"channelCreateTime",5:"channelExpireTime",6:"creator",7:"ext",8:"channelInValid",10:"from",11:"to",12:"requestId",13:"needPush",14:"pushTitle",15:"pushContent",16:"pushPayload",17:"needBadge",18:"members",19:"attach",20:"attachExt",21:"isSave",22:"msgid",23:"uid",24:"time",25:"nertcChannelName",26:"nertcTokenTtl",27:"nertcToken",28:"nertcJoinRoomQueryParamMap",29:"nertcJoinRoomResponse",30:"callStatus"},login:{1:"appKey",2:"account",3:"deviceId",5:"chatroomId",8:"appLogin",20:"chatroomNick",21:"chatroomAvatar",22:"chatroomCustom",23:"chatroomEnterCustom",26:"session",38:"isAnonymous",39:"tags",40:"notifyTargetTags",41:"loginAuthType",42:"loginExt",43:"loc_x",44:"loc_y",45:"loc_z",46:"distance",47:"antiSpamBusinessId",_21_safe:"_chatroomAvatar_safe"},chatroom:{1:"id",3:"name",4:"announcement",5:"broadcastUrl",12:"custom",14:"createTime",15:"updateTime",16:"queuelevel",100:"creator",101:"onlineMemberNum",102:"mute"},msg:{1:"idClient",2:"type",3:"attach",4:"custom",5:"resend",6:"userUpdateTime",7:"fromNick",8:"fromAvatar",9:"fromCustom",10:"yidunEnable",11:"antiSpamContent",12:"skipHistory",13:"body",14:"antiSpamBusinessId",15:"clientAntiSpam",16:"antiSpamUsingYidun",20:"time",21:"from",22:"chatroomId",23:"fromClientType",25:"highPriority",27:"callbackExt",28:"subType",29:"yidunAntiCheating",30:"env",31:"notifyTargetTags",32:"yidunAntiSpamExt",33:"yidunAntiSpamRes",34:"loc_x",35:"loc_y",36:"loc_z",37:"toAccids",38:"needHighPriorityMsgAck",39:"__clientExt",_8_safe:"_fromAvatar_safe"},chatroomMember:{1:"chatroomId",2:"account",3:"type",4:"level",5:"nick",6:"avatar",7:"custom",8:"online",9:"guest",10:"enterTime",12:"blacked",13:"gaged",14:"valid",15:"updateTime",16:"tempMuted",17:"tempMuteDuration",_6_safe:"_avatar_safe"},antispamTag:{antiSpamBusinessId:1},chatroomCdnInfo:{1:"enable",2:"cdnUrls",3:"timestamp",4:"interval",5:"decryptType",6:"decryptKey",7:"timeout"},nosConfigTag:{1:"bucket",2:"cdnDomain",3:"expire",4:"objectNamePrefix"},updateTags:{1:"currentTags"}}},function(t,r,e){t.exports=e(785)},function(t,r){t.exports=function(e,n){(n==null||n>e.length)&&(n=e.length);for(var o=0,s=new Array(n);o<n;o++)s[o]=e[o];return s},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(789)},function(t,r,e){var n=e(308),o=e(747),s=e(746);t.exports=function(a,i){var u;if(a){if(typeof a=="string")return s(a,i);var d=n(u=Object.prototype.toString.call(a)).call(u,8,-1);return d==="Object"&&a.constructor&&(d=a.constructor.name),d==="Map"||d==="Set"?o(a):d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?s(a,i):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(793)},function(t,r,e){var n=e(5),o=e(41),s=e(0),a=s.notundef,i={addFriend:1,applyFriend:2,passFriendApply:3,rejectFriendApply:4},u={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"};function d(c){s.verifyOptions(c,"account","friend::Friend"),s.verifyParamAtLeastPresentOne(c,"alias custom","friend::Friend"),this.account=c.account,a(c.alias)&&(this.alias=c.alias),a(c.custom)&&(this.custom=c.custom)}d.reverse=function(c){var m=s.filterObj(c,"account alias custom createTime updateTime serverex");return a(c.flag)&&(m.valid=c.flag==="1"),a(m.createTime)&&(m.createTime=+m.createTime),a(m.updateTime)&&(m.updateTime=+m.updateTime),m},d.validTypes=function(){return n(i)},d.getByteFromType=function(c){return i[c]},d.getTypeFromByte=function(c){return u[c]},d.assembleFriend=function(c){var m=+new Date;return o({},c,{alias:"",createTime:m,custom:"",updateTime:m,valid:!0})},t.exports=d},function(t,r,e){var n=e(752),o=e(41),s=e(0),a=s.notundef;function i(u,d){n(u.body)||s.onParamError("body",d),this.body=u.body,this.from=u.from||"",this.custom=u.custom||"",a(u.pushTitle)&&(this.pushTitle=u.pushTitle),a(u.apnsText)&&(this.apnsText=u.apnsText),a(u.pushPayload)&&(this.pushPayload=u.pushPayload),a(u.needPush)&&(this.needPush=u.needPush===!0?1:0),a(u.needBadge)&&(this.needBadge=u.needBadge===!0?1:0)}i.reverse=function(u){var d=o({},u);return a(u.needBadge)&&(d.needBadge=+u.needBadge==1),a(u.needPush)&&(d.needPush=+u.needPush==1),d.body=+u.body,d.time=+u.time,d},t.exports=i},function(t,r,e){t.exports=e(811)},function(t,r,e){var n=e(752),o=e(41),s=e(0);function a(i,u){n(i.type)||s.onParamError("Collect.type",u),s.notundef(i.uniqueId)&&(this.uniqueId=i.uniqueId),this.type=i.type,this.data=i.data||"",this.custom=i.custom||""}a.reverse=function(i){var u=o({},i);return u.type=+u.type,u.createTime=+u.createTime,u.updateTime=+u.updateTime,u},t.exports=a},function(t,r,e){var n=e(819),o=e(820),s=e(748),a=e(821);t.exports=function(i,u){return n(i)||o(i,u)||s(i,u)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(756),o=e(757),s=e(758),a=e(759);function i(c,m,v){var g=c;return o(m)?(v=m,typeof c=="string"&&(g={uri:c})):g=a(m,{uri:c}),g.callback=v,g}function u(c,m,v){return d(m=i(c,m,v))}function d(c){if(c.callback===void 0)throw new Error("callback argument missing");var m=!1,v=function(ze,ie,le){m||(m=!0,c.callback(ze,ie,le))};function g(){var ze=void 0;if(ze=O.response?O.response:O.responseText||function(ie){try{if(ie.responseType==="document")return ie.responseXML;var le=ie.responseXML&&ie.responseXML.documentElement.nodeName==="parsererror";if(ie.responseType===""&&!le)return ie.responseXML}catch{}return null}(O),_e)try{ze=JSON.parse(ze)}catch{}return ze}function b(ze){return clearTimeout(D),ze instanceof Error||(ze=new Error(""+(ze||"Unknown XMLHttpRequest Error"))),ze.statusCode=0,v(ze,Ce)}function T(){if(!y){var ze;clearTimeout(D),ze=c.useXDR&&O.status===void 0?200:O.status===1223?204:O.status;var ie=Ce,le=null;return ze!==0?(ie={body:g(),statusCode:ze,method:ae,headers:{},url:he,rawRequest:O},O.getAllResponseHeaders&&(ie.headers=s(O.getAllResponseHeaders()))):le=new Error("Internal XMLHttpRequest Error"),v(le,ie,ie.body)}}var k,y,O=c.xhr||null;O||(O=c.cors||c.useXDR?new u.XDomainRequest:new u.XMLHttpRequest);var D,he=O.url=c.uri||c.url,ae=O.method=c.method||"GET",Ne=c.body||c.data,ue=O.headers=c.headers||{},Y=!!c.sync,_e=!1,Ce={body:void 0,headers:{},statusCode:0,method:ae,url:he,rawRequest:O};if("json"in c&&c.json!==!1&&(_e=!0,ue.accept||ue.Accept||(ue.Accept="application/json"),ae!=="GET"&&ae!=="HEAD"&&(ue["content-type"]||ue["Content-Type"]||(ue["Content-Type"]="application/json"),Ne=JSON.stringify(c.json===!0?Ne:c.json))),O.onreadystatechange=function(){O.readyState===4&&setTimeout(T,0)},O.onload=T,O.onerror=b,O.onprogress=function(){},O.onabort=function(){y=!0},O.ontimeout=b,O.open(ae,he,!Y,c.username,c.password),Y||(O.withCredentials=!!c.withCredentials),!Y&&c.timeout>0&&(D=setTimeout(function(){if(!y){y=!0,O.abort("timeout");var ze=new Error("XMLHttpRequest timeout");ze.code="ETIMEDOUT",b(ze)}},c.timeout)),O.setRequestHeader)for(k in ue)ue.hasOwnProperty(k)&&O.setRequestHeader(k,ue[k]);else if(c.headers&&!function(ze){for(var ie in ze)if(ze.hasOwnProperty(ie))return!1;return!0}(c.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in c&&(O.responseType=c.responseType),"beforeSend"in c&&typeof c.beforeSend=="function"&&c.beforeSend(O),O.send(Ne||null),O}t.exports=u,t.exports.default=u,u.XMLHttpRequest=n.XMLHttpRequest||function(){},u.XDomainRequest="withCredentials"in new u.XMLHttpRequest?u.XMLHttpRequest:n.XDomainRequest,function(c,m){for(var v=0;v<c.length;v++)m(c[v])}(["get","put","post","patch","head","delete"],function(c){u[c==="delete"?"del":c]=function(m,v,g){return(v=i(m,v,g)).method=c.toUpperCase(),d(v)}})},function(t,r,e){(function(n){var o;o=typeof window<"u"?window:n!==void 0?n:typeof self<"u"?self:{},t.exports=o}).call(this,e(56))},function(t,r){t.exports=function(n){if(!n)return!1;var o=e.call(n);return o==="[object Function]"||typeof n=="function"&&o!=="[object RegExp]"||typeof window<"u"&&(n===window.setTimeout||n===window.alert||n===window.confirm||n===window.prompt)};var e=Object.prototype.toString},function(t,r){var e=function(n){return n.replace(/^\s+|\s+$/g,"")};t.exports=function(n){if(!n)return{};for(var o,s={},a=e(n).split(`
`),i=0;i<a.length;i++){var u=a[i],d=u.indexOf(":"),c=e(u.slice(0,d)).toLowerCase(),m=e(u.slice(d+1));s[c]===void 0?s[c]=m:(o=s[c],Object.prototype.toString.call(o)==="[object Array]"?s[c].push(m):s[c]=[s[c],m])}return s}},function(t,r){t.exports=function(){for(var n={},o=0;o<arguments.length;o++){var s=arguments[o];for(var a in s)e.call(s,a)&&(n[a]=s[a])}return n};var e=Object.prototype.hasOwnProperty},function(t,r,e){var n=e(26),o=e(123),s=e(7),a=e(10);function i(u){var d=this,c=u.url||null;d.level={debug:0,log:1,info:2,warn:3,error:4}[u.level]||0,d.logCache=[],d.logNum=1,d.timeInterval=5e3,window.onerror=function(m,v,g,b,T){d.error(T)},o(function(){d.logCache.length>0&&c&&d.postLogs(c,d.logCache)},d.timeInterval)}i.prototype.debug=function(){var u;this.level>0||(console.debug.apply(this,arguments),this.cacheLogs.apply(this,s(u=["[degbug]"]).call(u,arguments)))},i.prototype.log=function(){var u;this.level>1||(console.log.apply(this,arguments),this.cacheLogs.apply(this,s(u=["[log]"]).call(u,arguments)))},i.prototype.info=function(){var u;this.level>2||(console.info.apply(this,arguments),this.cacheLogs.apply(this,s(u=["[info]"]).call(u,arguments)))},i.prototype.warn=function(){var u;this.level>3||(console.warn.apply(this,arguments),this.cacheLogs.apply(this,s(u=["[warn]"]).call(u,arguments)))},i.prototype.error=function(){var u;this.level>4||(console.error.apply(this,arguments),this.cacheLogs.apply(this,s(u=["[error]"]).call(u,arguments)))},i.prototype.cacheLogs=function(u,d){for(var c=[],m=0;m<d.length;m++){var v=d[m];n(v)==="object"?c.push(a(v)):c.push(v)}var g=this.logNum+++" "+u+" "+c.join("; ");this.logCache.push(g.replace("%c",""))},i.prototype.postLogs=function(u,d){var c=this,m=new XMLHttpRequest;m.onreadystatechange=function(){m.readyState===4&&(m.status===200?(console.info("LoggerPlugin::"),c.logCache=[],c.timeInterval=5e3):c.timeInterval+=5e3)},m.open("POST",u),m.setRequestHeader("Content-Type","plain/text;charset=utf-8"),m.timeout=360,m.send(d.join(`
`))},t.exports=i},function(t,r,e){var n=e(3),o=e(44);t.exports=function(s){var a,i,u,d;s.db&&(o.db=s.db),s.rnfs&&(o.rnfs=s.rnfs,o.rnfs.size||(o.rnfs.size=1048576),o.rnfs.nimPromise=(a=o.rnfs,i=a.size/2-256,d=0,u=o.rnfs.DocumentDirectoryPath+"/nimlog_"+d+".log",a.exists(u).then(function(c){return c?a.stat(u):n.reject(0)}).then(function(c){return c&&c.size>i?n.reject(1):n.reject(0)}).catch(function(c){return typeof c=="number"&&(a.nimIndex=c),n.resolve()})))}},function(t,r,e){var n=e(52),o=e(0),s=o.notundef,a=o.undef;function i(u){s(u.name)&&(this.name=""+u.name),s(u.announcement)&&(this.announcement=""+u.announcement),s(u.broadcastUrl)&&(this.broadcastUrl=""+u.broadcastUrl),s(u.custom)&&(this.custom=""+u.custom),s(u.queuelevel)&&(this.queuelevel=n(u.queuelevel))}i.reverse=function(u){var d=o.copy(u);return a(d.announcement)&&(d.announcement=""),a(d.broadcastUrl)&&(d.broadcastUrl=""),a(d.custom)&&(d.custom=""),s(d.createTime)&&(d.createTime=+d.createTime),s(d.updateTime)&&(d.updateTime=+d.updateTime),s(d.onlineMemberNum)&&(d.onlineMemberNum=+d.onlineMemberNum),s(d.mute)&&(d.mute=d.mute==="1"),d},t.exports=i},function(t,r,e){var n,o,s;t.exports=(s=e(89),o=(n=s).lib.WordArray,n.enc.Base64={stringify:function(a){var i=a.words,u=a.sigBytes,d=this._map;a.clamp();for(var c=[],m=0;m<u;m+=3)for(var v=(i[m>>>2]>>>24-m%4*8&255)<<16|(i[m+1>>>2]>>>24-(m+1)%4*8&255)<<8|i[m+2>>>2]>>>24-(m+2)%4*8&255,g=0;g<4&&m+.75*g<u;g++)c.push(d.charAt(v>>>6*(3-g)&63));var b=d.charAt(64);if(b)for(;c.length%4;)c.push(b);return c.join("")},parse:function(a){var i=a.length,u=this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var c=0;c<u.length;c++)d[u.charCodeAt(c)]=c}var m=u.charAt(64);if(m){var v=a.indexOf(m);v!==-1&&(i=v)}return function(g,b,T){for(var k=[],y=0,O=0;O<b;O++)if(O%4){var D=T[g.charCodeAt(O-1)]<<O%4*2,he=T[g.charCodeAt(O)]>>>6-O%4*2,ae=D|he;k[y>>>2]|=ae<<24-y%4*8,y++}return o.create(k,y)}(a,i,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},s.enc.Base64)},function(t,r,e){var n,o,s,a,i,u,d,c;t.exports=(c=e(89),e(888),e(889),o=(n=c).lib,s=o.Base,a=o.WordArray,i=n.algo,u=i.MD5,d=i.EvpKDF=s.extend({cfg:s.extend({keySize:4,hasher:u,iterations:1}),init:function(m){this.cfg=this.cfg.extend(m)},compute:function(m,v){for(var g,b=this.cfg,T=b.hasher.create(),k=a.create(),y=k.words,O=b.keySize,D=b.iterations;y.length<O;){g&&T.update(g),g=T.update(m).finalize(v),T.reset();for(var he=1;he<D;he++)g=T.finalize(g),T.reset();k.concat(g)}return k.sigBytes=4*O,k}}),n.EvpKDF=function(m,v,g){return d.create(g).compute(m,v)},c.EvpKDF)},function(t,r,e){e(298);var n=e(39);e(310)(n),t.exports=n},function(t,r,e){var n=e(52),o=e(3),s=e(15),a=e(10),i=e(2),u=e(7),d=e(305),c=e(8),m=e(17),v=e(74),g=e(198),b=e(303),T=e(767),k=e(0),y=e(306),O=e(40),D=O.newSupportDBError,he=O.noDBError,ae=!1;function Ne(_e){ae=_e,y.set("db",_e,b)}if(Ne(!!k.getGlobal().indexedDB),v.name==="IE"&&Ne(!1),v.name==="Microsoft Edge"&&Ne(!1),v.name==="Safari")try{n(v.version.split(".")[0],10)<10&&Ne(!1)}catch{}function ue(_e){this.concurrency=0,this.pendingTasks=[],this.queue=o.resolve(),this.logger=_e.logger,this.reporter=_e.reporter,this.core=_e.core,this.account=_e.account,this.notifyError=_e.notifyError}var Y=ue.prototype;Y.reset=k.emptyFunc,ae&&(Y.reset=function(_e){this.enable=_e!==!1}),Y.addTask=function(_e){var Ce=this;return new o(function(ze,ie){function le(Ie){Ce.concurrency--;var pe=Ce.pendingTasks.shift();pe&&Ce.addTask(pe),Ie()}if(Ce.concurrency<100)return Ce.concurrency++,_e().then(function(Ie){le(function(){ze(Ie),_e.resolve&&_e.resolve(Ie)})},function(Ie){le(function(){var pe=(Ie=Ie||{}).event||Ie,qe={event:pe,callFunc:Ie.callFunc||"db::addTask"};Ce.logger.error("db::error event is",pe,k.get(pe,"target.error")),ie(qe),_e.reject&&_e.reject(qe)})});_e.resolve||(_e.resolve=ze,_e.reject=ie),Ce.pendingTasks.push(_e)})},Y.reportError=function(_e){var Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ze=arguments.length>2?arguments[2]:void 0;this.reporter.reportTraceStart("exceptions",{user_id:this.account,trace_id:k.get(this.core,"socket.socket.sessionid"),action:4,exception_service:0});var ie,le=Ce.context||"";if(ze)try{var Ie;ie=s(Ie=a(ze)).call(Ie,0,100),le+=". ".concat(ie)}catch{ie=""}var pe=k.get(_e,"code")||k.get(_e,"target.error.code")||0,qe=k.get(_e,"message")||k.get(_e,"target.error.message")||"unknown";this.reporter.reportTraceUpdateV2("exceptions",{code:pe,description:qe,operation_type:Ce.operation_type,target:Ce.target||this.name,context:le}),this.reporter.reportTraceEnd("exceptions",1)},Y.init=function(_e){var Ce=this;return Ce.addTask(function(){return Ce.enable?Ce.server?o.resolve():(Ce.name="nim-"+_e,b.open({server:Ce.name,version:T.version,schema:T.schema}).then(function(ze){Ce.logger.info("db::init: ".concat(Ce.name)),Ce.server=ze},function(ze){throw Ne(!1),Ce.server=null,Ce.name=null,ze}).catch(function(ze){throw Ce.reportError(ze,{operation_type:0,context:"version ".concat(T.version),target:"nim-"+_e}),ze})):o.reject(D({callFunc:"db::init"}))})},Y.destroy=function(){var _e=this;return _e.addTask(function(){if(!_e.enable)return o.reject(D({callFunc:"db::destroy"}));if(!_e.server)return o.resolve();try{return b.remove(_e.name).then(function(){_e.logger.info("db::destroy: ".concat(_e.name)),_e.server=null,_e.name=null}).catch(function(Ce){throw _e.reportError(Ce,{operation_type:1,context:"remove database failed"}),Ce})}catch(Ce){throw _e.reportError(Ce,{operation_type:1,context:"remove database failed"}),Ce}})},Y.clear=function(){var _e=this;return _e.addTask(function(){return _e.enable?_e.server?_e.server.clear("timetag").then(function(){var Ce=s([]).call(_e.server.getIndexedDB().objectStoreNames),ze=[];if(i(Ce).call(Ce,function(ie){ze.push(_e.server.clear(ie).catch(function(le){throw _e.reportError(le,{operation_type:3,context:"tableName: ".concat(ie,". clear table failed")}),le}))}),ze.length)return o.all(ze).then(function(){_e.logger.info("db::clear: ".concat(_e.name))}).catch(function(ie){return _e.logger.error("db::clear: ",ie),o.reject(ie)})}):o.resolve():o.reject(D({callFunc:"db::clear"}))})},Y.close=function(){this.server&&(this.server.close(),this.server=null,this.name=null)},Y.remove=function(_e,Ce,ze,ie,le,Ie,pe){var qe=this;return qe.addTask(function(){qe.checkDB();try{return qe.server.remove(_e,Ce,ze,ie,le,Ie,pe).then(function(){var $e;qe.logger.info(u($e="db::delete: ".concat(_e," ")).call($e,Ce||ze))}).catch(function($e){throw qe.reportError($e,{operation_type:3,context:"tableName: ".concat(_e,", remove failed")},{name:_e,keys:Ce,keyName:ze,lowerBound:ie,upperBound:le,lowerOpen:Ie,upperOpen:pe}),qe.logger.error("db::remove::server.remove error",$e),$e})}catch($e){throw qe.reportError($e,{operation_type:3,context:"tableName: ".concat(_e,", remove failed")},{name:_e,keys:Ce,keyName:ze,lowerBound:ie,upperBound:le,lowerOpen:Ie,upperOpen:pe}),qe.logger.error("db::remove::server.remove error",$e),$e}})},Y.put=function(_e,Ce){var ze=this;return ze.addTask(function(){ze.checkDB(),k.isArray(Ce)||(Ce=[Ce]);try{return ze.server.update(_e,Ce).then(function(ie){var le=[_e],Ie=T.keyPath(_e),pe=[];return Ie&&(i(ie).call(ie,function(qe){pe.push(g(qe,Ie))}),le.push(pe.length===1?pe[0]:pe)),le.unshift("db::put:"),_e==="timetag"&&le.push(ie[0]),ze.logger.log.apply(ze.logger.log,le),ie}).catch(function(ie){throw ze.reportError(ie,{operation_type:3,context:"tableName: ".concat(_e,". put failed")},Ce),ie})}catch(ie){throw ze.reportError(ie,{operation_type:3,context:"tableName: ".concat(_e,". put failed")},Ce),ie}})},Y.get=function(_e,Ce){var ze=this;return ze.addTask(function(){ze.checkDB();try{return ze.server.get(_e,Ce).catch(function(le){var Ie;throw ze.reportError(le,{operation_type:3,context:u(Ie="tableName: ".concat(_e,". get failed with key ")).call(Ie,Ce)}),le})}catch(le){var ie;throw ze.reportError(le,{operation_type:3,context:u(ie="tableName: ".concat(_e,". get failed with key ")).call(ie,Ce)}),le}})},Y.modifyOrPut=function(_e){var Ce=this,ze=_e.table,ie=k.copy(_e.obj),le=_e.key,Ie=_e.modifyObjWhenPut,pe=k.copy(ie);return delete pe[le],Ce.getOne(ze,null,ie[le],{modifyObj:pe}).then(function(qe){return qe?(pe.idClient?pe={idClient:pe.idClient,server:pe.server,pinFrom:pe.pinFrom}:(pe.lastMsg=pe.lastMsg&&pe.lastMsg.idServer+"_"+pe.lastMsg.idClient,pe.localCustom=pe.localCustom&&"***",pe.topCustom=pe.topCustom&&"***"),Ce.logger.log("db::modifyOrPut: update table ".concat(ze),pe),qe):(ie=k.merge(ie,Ie),Ce.put(ze,ie).then(function($e){return $e[0]}))})},Y.updateAndDelete=function(_e,Ce,ze){var ie=this;return ie.addTask(function(){ie.checkDB();try{return ie.server.updateAndDelete(_e,Ce,ze).catch(function(le){throw ie.reportError(le,{operation_type:3,context:"tableName: ".concat(_e,". updateAndDelete failed")},{updates:Ce,deletes:ze}),le})}catch(le){throw ie.reportError(le,{operation_type:3,context:"tableName: ".concat(_e,". updateAndDelete failed")},{updates:Ce,deletes:ze}),le}})},Y.getAll=function(_e,Ce){var ze=this;return ze.addTask(function(){ze.checkDB(),(Ce=Ce||{}).keys=d(Ce)===!0,Ce.desc=Ce.desc===!0,Ce.distinct=Ce.distinct===!0;try{var ie,le,Ie;return c(ie=d(le=m(Ie=ze.server.query(_e,Ce.index)).call(Ie,m(Ce))).call(le,d(Ce)).desc(Ce.desc).limit(Ce.limit).distinct(Ce.distinct)).call(ie,Ce.mapper).modify(Ce.modifyObj).execute().catch(function(pe){throw ze.reportError(pe,{operation_type:3,context:"tableName: ".concat(_e,". getAll failed")},Ce),pe})}catch(pe){throw ze.reportError(pe,{operation_type:3,context:"tableName: ".concat(_e,". getAll failed")},Ce),pe}})},Y.getOnly=function(_e,Ce,ze,ie){var le=this;return le.addTask(function(){le.checkDB(),(ie=ie||{}).keys=d(ie)===!0,ie.desc=ie.desc===!0,ie.distinct=ie.distinct===!0,ie.remove=ie.remove===!0;try{var Ie,pe,qe;return c(Ie=d(pe=m(qe=le.server.query(_e,Ce).only(ze)).call(qe,m(ie))).call(pe,d(ie)).desc(ie.desc).limit(ie.limit).distinct(ie.distinct)).call(Ie,ie.mapper).modify(ie.modifyObj).remove(ie.remove).execute().catch(function(Dt){var dr,pr;throw le.reportError(Dt,{operation_type:3,context:u(dr=u(pr="tableName: ".concat(_e,". getOnly failed with index: ")).call(pr,Ce,", matchValue: ")).call(dr,ze)},ie),Dt})}catch(Dt){var $e,Lt;throw le.reportError(Dt,{operation_type:3,context:u($e=u(Lt="tableName: ".concat(_e,". getOnly failed with index: ")).call(Lt,Ce,", matchValue: ")).call($e,ze)},ie),Dt}})},Y.getOne=function(){var _e=this;return _e.getOnly.apply(_e,arguments).then(function(Ce){return Ce[0]})},Y.clearTable=function(_e){var Ce=this;return Ce.addTask(function(){Ce.checkDB();try{return Ce.server.clear(_e).catch(function(ze){throw Ce.reportError(ze,{operation_type:3,context:"tableName: ".concat(_e,". clearTable failed")},options),ze})}catch(ze){throw Ce.reportError(ze,{operation_type:3,context:"tableName: ".concat(_e,". clearTable failed")},options),ze}})},Y.checkDB=function(){if(!this.enable)throw D({callFunc:"db::checkDB"});if(!this.server)throw he({callFunc:"db::checkDB"})},t.exports=ue},function(t,r){var e={version:12},n={kv:{key:{keyPath:"key"}},timetag:{key:{keyPath:"name"}},sessionsWithMoreRoaming:{key:{keyPath:"id"}},msgReadDetail:{key:{keyPath:"idClient"}},blacklist:{key:{keyPath:"account"}},mutelist:{key:{keyPath:"account"}},friend:{key:{keyPath:"account"}},user:{key:{keyPath:"account"}},team:{key:{keyPath:"teamId"}},teamMember:{key:{keyPath:"id"},indexes:{teamId:{unique:!1},account:{unique:!1}}},superTeam:{key:{keyPath:"teamId"}},superTeamMember:{key:{keyPath:"id"},indexes:{teamId:{unique:!1},account:{unique:!1},id:{unique:!1}}},msg:{key:{autoIncrement:!0},indexes:{idClient:{unique:!0},sessionId:{unique:!1},time:{unique:!1},type:{unique:!1},sessionType:{unique:!1},status:{unique:!1},sessionTime:{key:["sessionId","time"],unique:!1}}},msg1:{key:{keyPath:"idClient"},indexes:{sessionId:{unique:!1},time:{unique:!1},status:{unique:!1},sessionTime:{key:["sessionId","time"],unique:!1}}},msgPin:{key:{keyPath:"idClient"},indexes:{sessionId:{unique:!1}}},broadcastMsg:{key:{keyPath:"broadcastId"},indexes:{time:{unique:!1}}},sysMsg:{key:{autoIncrement:!0},indexes:{idServer:{unique:!0},category:{unique:!1},type:{unique:!1}}},sysMsgUnread:{key:{keyPath:"type"}},session:{key:{keyPath:"id"},indexes:{updateTime:{unique:!1}}}};e.keyPath=function(o){return n[o].key.keyPath},e.schema=function(){return window._nimForceSyncIM=!0,n},t.exports=e},function(t,r,e){var n=e(71).fn;n.setKey=function(o,s){return this.put("kv",{key:o,value:s})},n.getKey=function(o){return this.get("kv",o).then(function(s){return s&&s.value})},n.setDonnop=function(o){return this.setKey("donnop",o)},n.getDonnop=function(){return this.getKey("donnop")}},function(t,r,e){var n=e(6),o=e(52),s=e(71).fn;s.getTimetags=function(a){var i={};return this.getAll("timetag",{filter:a,mapper:function(u){var d;return n(d=u.name).call(d,"team-")!==-1?i[u.name]=0:i[u.name]=u.value,u}}).then(function(){return i})},s.getTeamMemberTimetags=function(){return this.getTimetags(function(a){var i;return n(i=a.name).call(i,"team-")!==-1})},s.getTimetag=function(a){return this.getOne("timetag",null,a).then(function(i){return(i=i||{value:0}).value})},s.getTeamMemberTimetag=function(){return 0},s.updateTimetag=function(a,i){var u=this,d={name:a,value:i};return this.put("timetag",d).catch(function(c){u.notifyError&&u.notifyError(c)})},s.updateMyInfoTimetag=function(a){return this.updateTimetag("myInfo",a)},s.updateRelationTimetag=function(a){return this.updateTimetag("relations",a)},s.getRelationsTimetag=function(){return this.getTimetag("relations")},s.updateFriendTimetag=function(a){return this.updateTimetag("friends",a)},s.getFriendsTimetag=function(){return this.getTimetag("friends")},s.updateFriendUserTimetag=function(a){return this.updateTimetag("friendUsers",a)},s.updateTeamTimetag=function(a){return this.updateTimetag("teams",a)},s.getTeamsTimetag=function(){return this.getTimetag("teams")},s.updateSuperTeamTimetag=function(a){return this.updateTimetag("superTeams",a)},s.getSuperTeamsTimetag=function(){return this.getTimetag("superTeams")},s.updateTeamMemberTimetag=function(a,i){return this.updateTimetag("team-"+a,i)},s.getTeamMembersTimetag=function(a){return this.getTimetag("team-"+a)},s.updateSuperTeamMemberTimetag=function(a,i){return this.updateTimetag("superTeam-"+a,i)},s.getSuperTeamMembersTimetag=function(a){return this.getTimetag("superTeam-"+a)},s.updateMyTeamMembersTimetag=function(a){return this.updateTimetag("myTeamMembers",a)},s.updateMySuperTeamMembersTimetag=function(a){return this.updateTimetag("myInfoInSuperTeams",a)},s.getBroadcastMsgTimetag=function(){return this.getTimetag("broadcastMsg")},s.updateBroadcastMsgTimetag=function(a){return this.updateTimetag("broadcastMsg",o(a))},s.updateRoamingMsgTimetag=function(a){return this.updateTimetag("roamingMsgs",a)},s.updateSuperTeamRoamingMsgTimetag=function(a){return this.updateTimetag("superTeamRoamingMsgs",a)},s.updateMsgReceiptsTimetag=function(a){return this.updateTimetag("msgReceipts",a)},s.updateDonnopTimetag=function(a){return this.updateTimetag("donnop",a)},s.updateSessionAck=function(a){return this.updateTimetag("sessionAck",a)},s.updateDeleteMsgSelf=function(a){return this.updateTimetag("deleteMsgSelf",a)},s.updateSuperTeamSessionAck=function(a){return this.updateTimetag("superTeamSessionAck",a)},s.deleteTimetag=function(a){return this.remove("timetag",a)},s.deleteTeamMemberTimetag=function(a){return this.deleteTimetag("team-"+a)},s.deleteSuperTeamMemberTimetag=function(a){return this.deleteTimetag("superTeam-"+a)}},function(t,r,e){var n=e(3),o=e(71).fn,s=e(0);o.mergeRelations=function(a,i,u,d,c){var m=this,v=m.updateAndDelete("blacklist",a,i),g=m.updateAndDelete("mutelist",u,d);return n.all([v,g]).then(function(){return m.logger.info("db::mergeRelations: timetag ".concat(c)),m.updateRelationTimetag(c),[a,i,u,d,c]})},o.getRelations=function(){var a=this.getAll("blacklist"),i=this.getAll("mutelist");return n.all([a,i])},o.markInBlacklist=function(a){if((a=s.copy(a)).isAdd){var i=a.record;return this.put("blacklist",i)}var u=a.account;return this.remove("blacklist",u)},o.markInMutelist=function(a){if((a=s.copy(a)).isAdd){var i=a.record;return this.put("mutelist",i)}var u=a.account;return this.remove("mutelist",u)}},function(t,r,e){var n=e(8),o=e(3),s=e(71).fn,a=e(0);s.mergeFriends=function(i,u,d){var c=this;return c.updateAndDelete("friend",i,u).then(function(){return c.logger.log("db::mergeFriends: updateAndDelete done",i&&n(i).call(i,function(m){return m.account}).join(",")),d&&c.updateFriendTimetag(d),[i,u,d]})},s.putFriend=function(i){return this.put("friend",i)},s.updateFriend=function(i){var u=this,d=(i=a.copy(i)).account;return this.getOne("friend",null,d,{modifyObj:i}).then(function(c){return c?u.logger.log("db::updateFriend: ".concat(d)):u.logger.warn("db::updateFriend: no record ".concat(d)),c})},s.deleteFriend=function(i){var u=this.remove("friend",i),d=this.deleteUser(i);return o.all([u,d])},s.getFriends=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=function(d){return i.updateTime!==void 0?d.valid&&d.updateTime>i.updateTime:d.valid};return this.getAll("friend",{filter:u})},s.getFriend=function(i){return this.getOne("friend",null,i)},s.getUserFromBlackList=function(i){return this.getOne("blacklist",null,i)}},function(t,r,e){var n=e(3),o=e(2),s=e(7),a=e(8),i=e(71).fn,u=e(0),d=e(40),c=e(192),m=e(150);function v(T){return T.valid&&T.validToCurrentUser}function g(T){return T&&T.valid}function b(T){return T&&u.fillUndef(T,{mute:!1,custom:""}),T}i.mergeTeams=function(T,k,y){var O=this,D=O.put("team",T),he=O.leaveTeams(k,y);return n.all([D,he]).then(function(){return O.logger.log("db::mergeTeams:"),O.updateTeamTimetag(y),[T,k,y]})},i.putTeam=function(T){if(T)return u.isArray(T)||(T=[T]),o(T).call(T,function(k){k.validToCurrentUser=!0}),this.put("team",T)},i.updateTeam=function(T){var k=this,y=(T=u.copy(T)).teamId;return k.getOne("team",null,y,{modifyObj:T}).then(function(O){if(O)k.logger.log("db::updateTeam: ".concat(y));else if(k.logger.warn("db::updateTeam: no record ".concat(y)),T.validToCurrentUser)return k.putTeam(T);return O})},i.transferTeam=function(T,k,y){var O=this,D=T.teamId,he=T.memberUpdateTime,ae={teamId:D,account:k,type:"normal",updateTime:he},Ne={teamId:D,account:y,type:"owner",updateTime:he};return O.updateTeamMembers([ae,Ne]).then(function(){return O.putTeam(T).then(function(){var ue,Y;return O.logger.info(s(ue=s(Y="db::transferTeam: ".concat(T.teamId," ")).call(Y,k," -> ")).call(ue,y)),[T,k,y]})})},i.leaveTeam=function(T){var k=this;return k.updateTeam({teamId:T,validToCurrentUser:!1}).then(function(){return k.removeAllTeamMembers(T)})},i.dismissTeam=function(T,k){var y=this,O={teamId:T,valid:!1,validToCurrentUser:!1,updateTime:k};return y.updateTeam(O).then(function(){return y.removeAllTeamMembers(T)})},i.leaveTeams=function(T,k){var y,O=this,D=[];return o(T).call(T,function(he){y=O.leaveTeam(he.teamId,k),D.push(y)}),n.all(D)},i.getTeamsByTeamIds=function(T){var k,y=this,O=[];return o(T).call(T,function(D){k=y.getTeam(D),O.push(k)}),n.all(O)},i.getTeam=function(T){T=""+T;var k=this;return k.getOne("team",null,T).then(function(y){return y?(k.updateTeamProperties([y]),y):null})},i.getTeams=function(){var T=this;return T.getAll("team",{filter:v}).then(function(k){return T.updateTeamProperties(k),k})},i.updateTeamProperties=function(T){o(T).call(T,function(k){k&&c.fillProperties(k)})},i.mergeTeamMembers=function(T,k,y,O){var D=this,he=D.putTeamMembers(k),ae=D.updateTeamMembers(y);return n.all([he,ae]).then(function(){return D.logger.log("db::mergeTeamMembers: ".concat(T)),D.updateTeamMemberTimetag(T,O)})},i.putTeamMembers=function(T){return this.put("teamMember",T)},i.getTeamMembersByAccount=function(T){return this.getOnly("teamMember","account",T,{filter:g,mapper:b}).then()},i.getTeamMembers=function(T){var k=this;return T=""+T,k.getOnly("teamMember","teamId",T,{filter:function(y){return y.valid},mapper:b}).then(function(y){return k.updateTeamMemberProperties(y).then(function(){return y})})},i.updateTeamMemberProperties=function(T){var k,y=this,O=[];return o(T).call(T,function(D){m.fillProperties(D)&&(k=y.updateTeamMember(D),O.push(k))}),n.all(O)},i.getInvalidTeamMembers=function(T,k){var y=this;T=""+T;var O,D=[];return o(k).call(k,function(he){O=y.getOne("teamMember",null,m.genId(T,he)).then(function(ae){return b(ae)}),D.push(O)}),n.all(D)},i.updateTeamMember=function(T){var k=this,y=T.teamId,O=T.account,D=m.genId(y,O),he=u.filterObj(T,"nickInTeam muteTeam mute custom updateTime type valid");return this.getOne("teamMember",null,D,{modifyObj:he,mapper:b}).then(function(ae){var Ne,ue;return ae?k.logger.log(s(Ne="db::updateTeamMember: ".concat(y," ")).call(Ne,O),u.pickAsString(he,["muteTeam","mute","updateTime","type","valid"])):k.logger.warn(s(ue="db::updateTeam: no record ".concat(y," ")).call(ue,O)),ae})},i.updateTeamMembers=function(T){var k=this;if(!T.length)return n.resolve();var y,O=[];return o(T).call(T,function(D){y=k.updateTeamMember(D),O.push(y)}),n.all(O)},i.updateTeamManagers=function(T,k,y,O){var D=a(k).call(k,function(he){return{teamId:T,account:he,type:y?"manager":"normal",updateTime:O}});return this.updateTeamMembers(D)},i.removeTeamMembersByAccounts=function(T,k){var y=a(k).call(k,function(O){return{teamId:T,account:O,valid:!1}});return this.updateTeamMembers(y)},i.removeAllTeamMembers=function(T){var k=this;return k.getOnly("teamMember","teamId",T,{modifyObj:{valid:!1}}).then(function(){return k.logger.warn("db::removeAllTeamMembers: ".concat(T)),k.deleteTeamMemberTimetag(T)})},i.deleteTeamMembers=function(T){var k=this;return k.getOnly("teamMember","teamId",T,{remove:!0}).then(function(){k.logger.warn("db::deleteTeamMembers: ".concat(T)),k.deleteTeamMemberTimetag(T)})},i.deleteTeam=function(T){var k,y=this,O=[];return u.isArray(T)||(T=[T]),o(T).call(T,function(D){D=""+D,k=y.get("team",D).then(function(he){if(he&&v(he))throw d.stillInTeamError({callFunc:"team::deleteTeam",team:he});var ae=y.remove("team",D),Ne=y.deleteTeamMembers(D);return n.all([ae,Ne])}),O.push(k)}),O.length===1?O[0]:n.all(O)}},function(t,r,e){var n=e(3),o=e(2),s=e(9),a=e(7),i=e(8),u=e(71).fn,d=e(0),c=e(40),m=e(307),v=e(202);function g(k){return k.valid&&k.validToCurrentUser}function b(k){return k&&k.valid}function T(k){return k&&d.fillUndef(k,{mute:!1,custom:""}),k}u.mergeSuperTeams=function(k,y,O){var D=this,he=D.put("superTeam",k),ae=D.leaveTeams(y,O);return n.all([he,ae]).then(function(){return D.logger.log("db::mergeSuperTeams:"),D.updateSuperTeamTimetag(O),[k,y,O]})},u.putSuperTeam=function(k){if(k)return d.isArray(k)||(k=[k]),o(k).call(k,function(y){y.validToCurrentUser=!0}),this.put("superTeam",k)},u.updateSuperTeam=function(k){var y=this,O=(k=d.copy(k)).teamId;return y.getOne("superTeam",null,O,{modifyObj:k}).then(function(D){return D?(y.logger.info("db::updateSuperTeam: ".concat(O)),D):(y.logger.warn("db::updateSuperTeam: no record ".concat(O)),y.putSuperTeam(k))})},u.leaveSuperTeam=function(k){var y=this;return y.updateSuperTeam({teamId:k,validToCurrentUser:!1}).then(function(){return y.removeAllSuperTeamMembers(k)})},u.dismissSuperTeam=function(k,y){var O=this,D={teamId:k,valid:!1,validToCurrentUser:!1,updateTime:y};return O.updateSuperTeam(D).then(function(){return O.removeAllSuperTeamMembers(k)})},u.leaveSuperTeams=function(k,y){var O,D=this,he=[];return o(k).call(k,function(ae){O=D.leaveSuperTeam(ae.teamId,y),he.push(O)}),n.all(he)},u.getSuperTeamsByTeamIds=function(k){var y,O=this,D=[];return o(k).call(k,function(he){y=O.getSuperTeam(he),D.push(y)}),n.all(D)},u.getSuperTeam=function(k){k=""+k;var y=this;return y.getOne("superTeam",null,k).then(function(O){return O?(y.updateSuperTeamProperties([O]),O):null})},u.getSuperTeams=function(){var k=this;return k.getAll("superTeam",{filter:g}).then(function(y){return k.updateSuperTeamProperties(y),y})},u.updateSuperTeamProperties=function(k){o(k).call(k,function(y){y&&m.fillProperties(y)})},u.mergeSuperTeamMembers=function(k,y,O,D){var he=this,ae=he.putSuperTeamMembers(y),Ne=he.updateSuperTeamMembers(O);return n.all([ae,Ne]).then(function(){return he.logger.log("db::mergeSuperTeamMembers: ".concat(k)),D!=null?he.updateSuperTeamMemberTimetag(k,D):n.resolve()})},u.putSuperTeamMembers=function(k){return this.put("superTeamMember",k)},u.getSuperTeamMemberById=function(k){return this.get("superTeamMember",k)},u.getSuperTeamMembers=function(k,y){var O=this;k=""+k;var D={filter:function(he){return he.valid},mapper:T};if(y){if(typeof y.joinTime!="number")return void O.logger.error("db::getSuperTeamMembers::params.joinTime should be number, not ",y.joinTime);y.limit&&(D.limit=y.limit),s(y)?D.filter=function(he){return he.valid&&he.joinTime<=y.joinTime}:D.filter=function(he){return he.valid&&he.joinTime>=y.joinTime}}return O.getOnly("superTeamMember","teamId",k,D).then(function(he){return O.updateSuperTeamMemberProperties(he).then(function(){return he})})},u.getSuperTeamMembersByAccount=function(k){return this.getOnly("superTeamMember","account",k,{filter:b,mapper:T}).then()},u.updateSuperTeamMemberProperties=function(k){var y,O=this,D=[];return o(k).call(k,function(he){v.fillProperties(he)&&(y=O.updateSuperTeamMember(he),D.push(y))}),n.all(D)},u.getInvalidSuperTeamMembers=function(k,y){var O=this;k=""+k;var D,he=[];return o(y).call(y,function(ae){D=O.getOne("superTeamMember","id",v.genId(k,ae)).then(function(Ne){return T(Ne)}),he.push(D)}),n.all(he)},u.updateSuperTeamMember=function(k){var y=this,O=k.teamId,D=k.account,he=v.genId(O,D),ae=d.filterObj(k,"nickInTeam muteTeam mute custom updateTime type valid");return this.getOne("superTeamMember","id",he,{modifyObj:ae,mapper:T}).then(function(Ne){var ue,Y;return Ne?y.logger.log(a(ue="db::updateSuperTeamMember: ".concat(O," ")).call(ue,D),d.pickAsString(ae,["muteTeam","mute","updateTime","type","valid"])):y.logger.warn(a(Y="db::updateSuperTeam: no record ".concat(O," ")).call(Y,D)),Ne})},u.updateSuperTeamMembers=function(k){var y=this;if(!k.length)return n.resolve();var O,D=[];return o(k).call(k,function(he){O=y.updateSuperTeamMember(he),D.push(O)}),n.all(D)},u.removeSuperTeamMembersByAccounts=function(k,y){var O=i(y).call(y,function(D){return{teamId:k,account:D,valid:!1}});return this.updateSuperTeamMembers(O)},u.removeAllSuperTeamMembers=function(k){var y=this;return y.getOnly("superTeamMember","teamId",k,{modifyObj:{valid:!1}}).then(function(){return y.logger.warn("db::removeAllSuperTeamMembers: ".concat(k)),y.deleteSuperTeamMemberTimetag(k)})},u.deleteSuperTeamMembers=function(k){var y=this;return y.getOnly("superTeamMember","teamId",k,{remove:!0}).then(function(){y.logger.warn("db::deleteSuperTeamMembers: ".concat(k)),y.deleteSuperTeamMemberTimetag(k)})},u.deleteSuperTeam=function(k){var y,O=this,D=[];return d.isArray(k)||(k=[k]),o(k).call(k,function(he){he=""+he,y=O.get("superTeam",he).then(function(ae){if(ae&&g(ae))throw c.stillInTeamError({callFunc:"team::deleteTeam",team:ae});var Ne=O.remove("superTeam",he),ue=O.deleteSuperTeamMembers(he);return n.all([Ne,ue])}),D.push(y)}),D.length===1?D[0]:n.all(D)},u.transferSuperTeam=function(k,y,O){var D=this;return D.updateSuperTeamMembers([y,O]).then(function(){return D.putSuperTeam(k).then(function(){var he,ae;return D.logger.info(a(he=a(ae="db::transferSuperTeam: ".concat(k.teamId," ")).call(ae,y.account," -> ")).call(he,O.account)),[k,y,O]})})}},function(t,r,e){var n=e(2),o=e(3),s=e(6),a=e(71).fn,i=e(0);a.mergeMyInfo=function(u,d){var c=this;return c.put("user",u).then(function(){return d?c.updateMyInfoTimetag(u.updateTime):u})},a.mergeFriendUsers=function(u,d){var c=this;return c.putUsers(u).then(function(){c.updateFriendUserTimetag(d)})},a.putUsers=function(u){return this.put("user",u)},a.putUser=function(u){return this.put("user",u)},a.updateUser=function(u){var d=this,c=(u=i.copy(u)).account;return this.getOne("user",null,c,{modifyObj:u}).then(function(m){return m?d.logger.log("db::updateUser: ".concat(c)):d.logger.warn("db::updateUser: no record ".concat(c)),m})},a.putUsersIfIsFriend=function(u){var d,c=this,m=[],v=[];return n(u).call(u,function(g){d=c.getFriend(g.account).then(function(b){return b&&(d=c.putUser(g),v.push(d)),b}),m.push(d)}),o.all(m).then(function(){return o.all(v).then(function(g){return g})})},a.deleteUser=function(u){return this.remove("user",u)},a.getUser=function(u){return this.getOne("user",null,u)},a.getUsers=function(u){return this.getAll("user",{filter:function(d){return s(u).call(u,d.account)!==-1}})},a.getAllUsers=function(){return this.getAll("user")}},function(t,r,e){var n=e(17),o=e(3),s=e(7),a=e(2),i=e(41),u=e(32),d=e(6),c=e(8),m=e(71).fn,v=e(0),g=e(13);m.putMsg=function(b){var T=this;return v.isArray(b)||(b=[b]),!b.length||n(b[0])?o.resolve():(b=n(b).call(b,function(k){return!k.ignore}),T.put("msg1",b).catch(function(k){return T.notifyError&&T.notifyError(k),o.resolve(b,k)}))},m.putMsgReadDetail=function(b){var T=this;if(b.idClient)return this.put("msgReadDetail",b).catch(function(k){T.logger.error("putMsgReadDetail error",k)})},m.getMsgReadDetail=function(b){return this.getOne("msgReadDetail",null,b)},m.updateMsg=function(b){var T=this;if(!n(b)){var k=b.idClient,y=v.filterObj(b,"resend status idServer time localCustom commentTimetag comments hasSendAck callbackExt");return T.getOne("msg1",null,k,{modifyObj:y}).then(function(O){var D,he,ae;return O?T.logger.info(s(D=s(he=s(ae="db::updateMsg: ".concat(k,"idServer: ")).call(ae,y.idServer,"status: ")).call(he,y.status,"time: ")).call(D,y.time)):T.logger.warn("db::updateMsg: no record ".concat(k)),O}).catch(function(O){return T.notifyError&&T.notifyError(O),o.resolve(b)})}},m.updateMsgBatch=function(b){var T=this;if(g.isRN)this.logger.warn("react native can not support updateMsgBatch");else{this.checkDB();var k=this.server.getIndexedDB().transaction(["msg1"],"readwrite").objectStore("msg1");a(b).call(b,function(y){if(y.idClient){var O=k.get(y.idClient);O.onerror=function(D){T.logger.error("updateMsgBatch::store.get:error",D)},O.onsuccess=function(){var D=O.result||y;k.put(i({},D,y)).onerror=function(he){T.logger.error("updateMsgBatch::store.put:error",he)}}}})}},m.getMsgs=function(b){return g.isBrowser?this.getMsgsIndexedDB(b):g.isRN?this.getMsgsRN(b):o.resolve()},m.getMsgsRN=function(b){var T={};return typeof b.start=="number"&&(T.lowerBound=["time",b.start]),typeof b.end=="number"&&b.end!==1/0&&(T.upperBound=["time",b.end]),T.desc=!1,T.index="time",typeof b.desc=="boolean"&&(T.desc=b.desc),typeof b.limit=="number"&&(T.limit=b.limit),T.searchIndex=[],b.sessionId&&T.searchIndex.push(["sessionId",b.sessionId]),typeof b.type=="string"&&T.searchIndex.push(["type",b.type]),this.getAll("msg1",T)},m.getMsgsIndexedDB=function(b){var T,k=this;k.checkDB();var y="time",O=!1,D=!1,he=(b=b||{}).sessionId||[],ae=b.sessionIds||[];v.isString(he)?he=[he]:u(he)||(he=[]),v.isString(ae)?ae=[ae]:u(ae)||(ae=[]);var Ne=s(he).call(he,ae);Ne.length===1?(O=!0,y="sessionTime",he=Ne[0]):Ne.length>1&&(O=!0,D=!0,ae=Ne);var ue=b.start||0,Y=b.end||1/0,_e=ue,Ce=Y;O&&!D&&(_e=[he,ue],Ce=[he,Y]);var ze=b.desc!==!1,ie=b.limit||100,le=!1,Ie=!1,pe=b.type||[],qe=b.types||[];v.isString(pe)?pe=[pe]:u(pe)||(pe=[]),v.isString(qe)?qe=[qe]:u(qe)||(qe=[]);var $e=s(pe).call(pe,qe);$e.length===1?(le=!0,pe=$e[0]):$e.length>1&&(le=!0,Ie=!0,qe=$e);var Lt,Dt=b.subTypes&&b.subTypes.length,dr=b.keyword||"",pr=b.filterFunc;return(D||le||dr||Dt||v.isFunction(pr))&&(Lt=function(sr){var hr;if(D&&d(ae).call(ae,sr.sessionId)===-1)return!1;if(le){if(Ie){if(d(qe).call(qe,sr.type)===-1)return!1}else if(pe!==sr.type)return!1}if(Dt&&d(hr=b.subTypes).call(hr,sr.subType)===-1)return!1;if(dr){var Fe=sr.text||sr.tip||"";if(d(Fe).call(Fe,dr)===-1)return!1}return!pr||pr(sr)}),n(T=k.server.query("msg1",y).bound(_e,Ce,!0,!0).desc(ze).limit(ie)).call(T,Lt).execute().catch(function(sr){throw k.reportError(sr,{operation_type:3,context:"tableName: ".concat("msg1",", index ").concat(y,", getMsgsIndexedDB error")},b),sr})},m.getMsgCountAfterAck=function(b){return g.isBrowser?this.getMsgCountAfterAckIndexedDB(b):g.isRN?this.getMsgCountAfterAckRN(b):o.resolve()},m.getMsgCountAfterAckRN=function(b){var T=this,k=b=b||{},y=k.sessionId,O=k.ack;return T.checkDB(),T.getAll("msg1",{searchIndex:["sessionId",y],lowerBound:["time",O]}).then(function(D){var he=n(D).call(D,function(ae){if(ae.flow==="out"||ae.isUnreadable===!1)return!1;if(ae.type==="notification")try{return b.shouldCountNotifyUnread(ae)}catch(Ne){throw T.logger.error("userOption:shouldCountNotifyUnread function error",Ne),Ne}return!0});return o.resolve(he.length)})},m.getMsgCountAfterAckIndexedDB=function(b){var T=this,k=(b=b||{}).sessionId;return T.checkDB(),T.server.query("msg1","sessionTime").bound([k,b.ack],[k,1/0],!0,!0).execute().then(function(y){var O=n(y).call(y,function(D){if(D.flow==="out"||D.isUnreadable===!1)return!1;if(D.type==="notification")try{return b.shouldCountNotifyUnread(D)}catch(he){throw T.logger.error("userOption:shouldCountNotifyUnread function error",he),he}return!0});return o.resolve(O.length)}).catch(function(y){throw T.reportError(y,{operation_type:3,context:"tableName: ".concat("msg1",", IndexSessionTime ").concat("sessionTime",", getMsgCountAfterAckIndexedDB error")},b),y})},m.amendMsg=function(b){return b?(v.notexist(b.text)&&(b.text=""),b):null},m.getMsgByIdClient=function(b){var T=this;return T.getOne("msg1",null,b).then(function(k){return T.amendMsg(k)})},m.getMsgsByIdClients=function(b){var T,k=this,y=[];return a(b).call(b,function(O){T=k.getMsgByIdClient(O),y.push(T)}),o.all(y)},m.clearSendingMsgs=function(){var b=this;return b.getOnly("msg1","status","sending",{modifyObj:{status:"fail"}}).then(function(T){b.logger.info("db::clearSendingMsgs: msgs send failed",T&&c(T).call(T,function(k){return k.idClient}).join(","))})},m.deleteMsg=function(b){var T,k=this,y=[];return v.isArray(b)||(b=[b]),a(b).call(b,function(O){T=k.getOne("msg1",null,O,{remove:!0}).then(function(D){return k.logger.info("db::deleteMsg done",O,D&&D.idClient),D}).catch(function(D){throw k.logger.error("db::deleteMsg failed",O,D),D}),y.push(T)}),y.length===1?y[0]:o.all(y)},m.deleteMsgsBySessionId=function(b){var T=this,k=null,y=b.start,O=b.end;return y!==void 0&&O!==void 0?k=function(D){return D>y&&D<O}:y!==void 0?k=function(D){return D>y}:O!==void 0&&(k=function(D){return D<O}),k?T.getOnly("msg1","sessionId",b.sessionId).then(function(D){var he=[];return c(D=D||[]).call(D,function(ae){k(ae.time)&&he.push(ae.idClient)}),T.logger.info("db::deleteMsgsBySessionId: session results",he),T.deleteMsg(he)}):T.getOnly("msg1","sessionId",b.sessionId,{remove:!0})},m.deleteMsgsByTime=function(b){return this.remove("msg1",null,"time",b.start,b.end,!0,!0)},m.getDeletedMsgsCountByTime=function(b){this.checkDB();var T=this.server.getIndexedDB().transaction(["msg1"],"readonly").objectStore("msg1").index("time"),k=IDBKeyRange.bound(b.start,b.end,!0,!0),y=T.count(k);return new o(function(O,D){y.onsuccess=function(he){O(he.target.result)},y.onerror=function(he){this.logger.error("countDeletedMsgsByTime::index.count:error",he),D(he)}})},m.deleteAllMsgs=function(){var b=this.clearTable("msg1"),T=this.clearTable("session");return o.all([b,T])},m.getMsgPins=function(b){return this.getOnly("msgPin","sessionId",b)},m.deleteMsgPins=function(b){return this.getOnly("msgPin","sessionId",b,{remove:!0})},m.putMsgPin=function(b){var T=this;return this.modifyOrPut({table:"msgPin",obj:b,key:"idClient"}).catch(function(k){T.notifyError&&T.notifyError(k)})},m.putMsgPins=function(b){return this.put("msgPin",b)},m.deleteMsgPin=function(b){var T=this;return this.getOne("msgPin",null,b.idClient,{remove:!0}).then(function(k){return T.logger.info("db::deleteMsgPin:",k.idClient),k})}},function(t,r,e){var n=e(3),o=e(17),s=e(2),a=e(9),i=e(5),u=e(71).fn,d=e(0),c=d.notundef;u.putSysMsg=function(m){var v=this;return new n(function(g){if(d.isArray(m)||(m=[m]),!o(m[0])){var b=[],T=m.length;s(m).call(m,function(y){y=d.copy(y),v.put("sysMsg",y).then(function(O){b.push(O[0]),k()},k)})}function k(){--T===0&&g(b)}})},u.getSysMsgs=function(m){var v=!a(m=m||{}),g=m.limit||100,b=null,T=null;m.category&&(b="category",T=m.category),m.type&&(b="type",T=m.type);var k,y=m.lastIdServer,O=!1,D=m.read;return(c(y)||c(D))&&(k=function(he){return c(y)?(y=""+y,O?ae():(he.idServer===y&&(O=!0),!1)):ae();function ae(){return!c(D)||he.read===D}}),m={filter:k,desc:v,limit:g},b?this.getOnly("sysMsg",b,T,m):this.getAll("sysMsg",m)},u.getSysMsgByIdServer=function(m){return this.getOne("sysMsg","idServer",m)},u.updateSysMsg=function(m){var v=this;if(!o(m)){var g=""+m.idServer,b=d.filterObj(m,"read state error localCustom");return this.getOne("sysMsg","idServer",g,{modifyObj:b}).then(function(T){return T?v.logger.log("db::updateSysMsg: ".concat(g),d.pickAsString(b,["read","state","error"])):v.logger.warn("db::updateSession: ".concat(g)),T})}},u.markSysMsgRead=function(m){var v=this;return new n(function(g,b){d.isArray(m)||(m=[m]);var T,k,y=[],O=[];s(m).call(m,function(D){T=v.getSysMsgByIdServer(D.idServer).then(function(he){he&&!he.read&&(k=v.updateSysMsg({idServer:he.idServer,read:!0}),O.push(k))},b),y.push(T)}),n.all(y).then(function(){n.all(O).then(function(D){g(D)},b)},b)})},u.deleteSysMsg=function(m){var v,g=this,b=[];return d.isArray(m)||(m=[m]),s(m).call(m,function(T){T=""+T,v=g.getOne("sysMsg","idServer",T,{remove:!0}),b.push(v)}),b.length===1?b[0]:n.all(b)},u.deleteAllSysMsgs=function(){var m=this.clearTable("sysMsg"),v=this.clearTable("sysMsgUnread");return n.all([m,v])},u.getSysMsgUnread=function(){return this.getAll("sysMsgUnread").then(function(m){var v={};return s(m).call(m,function(g){v[g.type]=g.num}),v})},u.updateSysMsgUnread=function(m){var v,g=this;m=d.copy(m);var b=[];return s(v=i(m)).call(v,function(T){b.push({type:T,num:m[T]})}),this.put("sysMsgUnread",b).then(function(){return g.logger.info("db::updateSysMsgUnread: ",m),m})}},function(t,r,e){var n=e(3),o=e(2),s=e(71).fn,a=e(0);s.putBroadcastMsg=function(i){var u=this;return new n(function(d){a.isArray(i)||(i=[i]);var c=[],m=i.length;function v(){--m===0&&d(c)}o(i).call(i,function(g){g=a.copy(g),u.put("broadcastMsg",g).then(function(b){c.push(b[0]),v()},v)})})},s.getBroadcastMsgs=function(i){return i=i||{},this.getAll("broadcastMsg",i)}},function(t,r,e){var n=e(3),o=e(9),s=e(7),a=e(32),i=e(2),u=e(71).fn,d=e(0),c=d.notundef;u.putSession=function(m){var v=this,g=m.unread;return(m=d.merge({},m)).updateTime===void 0&&m.lastMsg&&m.lastMsg.time&&(m.updateTime=m.lastMsg.time),(m.lastMsg||!m.ack&&!m.msgReceiptTime)&&(m.isDeleted=!1),delete m.unread,this.modifyOrPut({table:"session",obj:m,key:"id",modifyObjWhenPut:{unread:0}}).catch(function(b){return v.notifyError&&v.notifyError(b),m.unread=g,n.resolve(m)})},u.getAllSessions=function(){return this.getAll("session",{index:"updateTime",desc:!0}).catch(function(m){self.notifyError&&self.notifyError(m)})},u.getSessions=function(m){var v=!o(m=m||{}),g=m.limit||100,b=m.lastSessionId,T=m.sessionId,k=!1,y=this,O=function(){return!0},D=function(){return!0};return c(T)?this.getSession(T,m.isDeleted):(c(b)&&(O=function(he){return he.id===b&&(k=!0),k}),m.includeDeleted||(D=function(he){return!he.isDeleted}),this.getAll("session",{index:"updateTime",desc:v,limit:g,filter:function(he){return O(he)&&D(he)}}).catch(function(he){y.notifyError&&y.notifyError(he)}))},u.getSession=function(m,v){var g=this;return this.get("session",m).then(function(b){return n.resolve(!v&&b&&b.isDeleted?void 0:b)}).catch(function(b){throw g.notifyError&&g.notifyError(b),b})},u.updateSession=function(m){var v=this,g=m.id,b=d.filterObj(m,"ack unread lastMsg localCustom msgReceiptTime msgReceiptServerTime isTop topCustom isDeleted");return m.lastMsg&&(b.lastMsg=m.lastMsg),this.getOne("session",null,g,{modifyObj:b}).then(function(T){if(T){var k,y=s(k="db::updateSession: ".concat(g," ")).call(k,d.pickAsString(b,["ack","unread","msgReceiptTime","msgReceiptServerTime","isTop","isDeleted"]));y+=b.lastMsg?" lastMsg.idClient:".concat(d.get(b,"lastMsg.idClient")):"",v.logger.info(y)}else v.logger.warn("db::updateSession: no record ".concat(g));return T}).catch(function(T){v.notifyError&&v.notifyError(T)})},u.getStickTopSessions=function(){var m=this;return this.getAll("session",{filter:function(v){return v&&v.isTop}}).catch(function(v){m.notifyError&&m.notifyError(v)})},u.deleteSession=function(m,v){var g=v&&v.scene||"";return g==="superTeam"?this.updateSuperTeamSessionAck(0):(g==="p2p"||g==="team"||this.updateSuperTeamSessionAck(0),this.updateSessionAck(0)),this.updateMsgReceiptsTimetag(0),this.remove("session",m)},u.deleteSessionLogic=function(m){var v=this;if(!a(m))return this.getOne("session",null,m,{modifyObj:{isDeleted:!0}});var g=[];return i(m).call(m,function(b){g.push(v.getOne("session",null,b,{modifyObj:{isDeleted:!0}}))}),n.all(g)},u.putSessionsWithMoreRoaming=function(m){return this.put("sessionsWithMoreRoaming",m)},u.updateSessionsWithMoreRoaming=function(m){var v=m.id;return delete m.id,this.getOne("sessionsWithMoreRoaming",null,v,{modifyObj:m})},u.deleteSessionsWithMoreRoaming=function(m){return this.remove("sessionsWithMoreRoaming",m)},u.getSessionsWithMoreRoaming=function(m){return m?this.get("sessionsWithMoreRoaming",m):this.getAll("sessionsWithMoreRoaming")}},function(t,r,e){var n=e(7),o=e(121),s=e(122),a=e(0).throttle,i=function(){function u(d){o(this,u),this.arr=[],this.timer=null,this.maxLength=d.maxLength||100,this.throttleTime=d.throttleTime||5e3,this.processFn=d.processFn||function(){},this.throttleFn=d.processFn||function(){},d.processFn&&(this.throttleFn=a(function(c){d.processFn(c),c.length=0},this.throttleTime,{leading:!1}))}return s(u,[{key:"add",value:function(d){var c;Object.prototype.toString.call(d)==="[object Array]"?this.arr=n(c=this.arr).call(c,d):this.arr.push(d),this.arr.length>=this.maxLength&&(this.processFn(this.arr),this.arr=[]),this.timer=this.throttleFn(this.arr)}},{key:"destroy",value:function(){this.arr=[],this.timer&&clearTimeout(this.timer),this.processFn=function(){},this.throttleFn=function(){}}},{key:"clear",value:function(){this.arr=[],this.timer&&clearTimeout(this.timer)}}]),u}();t.exports=i},function(t,r,e){var n=e(26),o=e(58),s=e(57),a=e(10),i=e(313),u=e(7),d=e(3),c=e(23),m=e(17),v=e(6),g=e(15),b=e(25),T=e(2),k=e(123),y=e(5),O=e(59),D=e(60),he=e(61),ae=e(62),Ne=e(47);function ue($e,Lt){var Dt=y($e);if(O){var dr=O($e);Lt&&(dr=m(dr).call(dr,function(pr){return D($e,pr).enumerable})),Dt.push.apply(Dt,dr)}return Dt}function Y($e){for(var Lt=1;Lt<arguments.length;Lt++){var Dt,dr,pr=arguments[Lt]!=null?arguments[Lt]:{};Lt%2?T(Dt=ue(Object(pr),!0)).call(Dt,function(sr){o($e,sr,pr[sr])}):he?ae($e,he(pr)):T(dr=ue(Object(pr))).call(dr,function(sr){Ne($e,sr,D(pr,sr))})}return $e}var _e=e(35).fn,Ce=e(0),ze=e(13),ie=e(155).V2NIMConnectStatus;function le($e,Lt){var Dt,dr,pr,sr,hr=this,Fe=ze.getDefaultLinkUrl(hr.options.secure);hr.socketUrls=[Fe],hr.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:Lt,code:200,net_connect:hr.checkNetworkAvailable(),succeed:!0}),hr.msgStatEnable=!!$e.common["msg.stat.enable"],hr.msgStatEnable&&(hr.msgDelayTimer=c(b(dr=hr.doReportMsgDelay).call(dr,hr),1e4)),$e.common&&$e.common.link&&T(pr=$e.common.link).call(pr,function(Ue){hr.socketUrls.unshift(ze.formatSocketUrl({url:Ue,secure:hr.options.secure}))}),$e.common&&$e.common["link.default"]&&T(sr=$e.common["link.default"]).call(sr,function(Ue){var rr,or;Ue=ze.formatSocketUrl({url:Ue,secure:hr.options.secure}),v(rr=hr.socketUrls).call(rr,Ue)===-1&&(hr.socketUrls=u(or=hr.socketUrls).call(or,Ue))}),hr.socketUrls=m(Dt=hr.socketUrls).call(Dt,function(Ue,rr,or){return v(or).call(or,Ue)===rr});try{ze.uploadUrl=$e.nosup[0]}catch{}if(ze.chunkUploadUrl=$e["nos-chunk"]||ze.chunkUploadUrl||"",hr.logger.info("link::refreshSocketUrl: ".concat(Lt," ajax load , got socket urls "),hr.socketUrls),ze.hasLocalStorage){$e.common["lbs.backup"]&&hr.options.lbsBackup&&localStorage.setItem("nim_lbs_backup",a($e.common["lbs.backup"]));var nr=Ce.get($e,"common.report.apierror.on");$e.common.report&&localStorage.setItem("nim_lbs_fail_report_on",nr===!1?"0":"1")}if($e.common.socketConcurrent){var ir=$e.common.socketConcurrent;typeof ir=="number"&&ir>=1&&ir<=3&&(hr.options.socketConcurrent=ir,hr.imsocket.setConfig({socketConcurrent:ir}))}}function Ie($e,Lt){if(this.statusProtector.getConnectStatus()===ie.V2NIM_CONNECT_STATUS_DISCONNECTED)return d.reject(new Error("already disconnected"));if($e>=Lt){this.logger.warn("doRequestBackupLbsUrls backup lbs all tried");var Dt=ze.getDefaultLinkUrl(this.options.secure);return this.logger.warn("doRequestBackupLbsUrls: use default socket link",Dt),this.socketUrls=[Dt],d.resolve()}return this.logger.warn("doRequestBackupLbsUrls: wait for next lbs request"),d.reject(new Error("lbs request failed"))}function pe($e,Lt){var Dt=Lt.status||10001,dr=typeof Lt=="string"?Lt:Lt&&Lt.message?Lt.message:"Unknown error";this.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:$e,code:Dt,description:dr,net_connect:this.checkNetworkAvailable(),succeed:!1})}function qe($e){var Lt=this;if(!($e&&$e.length>0))throw new Error("No  lbs url to try");var Dt=0,dr=0,pr=!1,sr=null;Lt.logger.log("doRequestBackupLbsUrls: use lbs url in index ",Dt,$e);var hr=function(){var Fe=$e[Dt++],nr=new Date().getTime();return Lt.promiseAbortManager.add(Lt.doRequestLbs(Fe)).then(function(ir){if(sr&&clearInterval(sr),pr===!1)return le.call(Lt,ir,Fe),pr=!0,d.resolve()}).catch(function(ir){return dr+=1,Lt.logger.warn("doRequestBackupLbsUrls: ".concat(Fe," ajax lbs error"),ir),pe.call(Lt,Fe,ir,nr),Ie.call(Lt,dr,$e.length)})};return new d(function(Fe,nr){sr=k(function(){if(!(Dt>=$e.length))return Lt.statusProtector.getConnectStatus()===ie.V2NIM_CONNECT_STATUS_DISCONNECTED?(sr&&clearInterval(sr),void nr(new Error("already disconnected"))):void hr().then(function(){sr&&clearInterval(sr),Fe()}).catch(function(){});sr&&clearInterval(sr)},2e3),hr().then(function(){sr&&clearInterval(sr),Fe()}).catch(function(){})})}_e.connect=function(){if(this.checkNetworkAvailable()===!1&&this.autoconnect)return this.logger.info("connect::skip this reconnection attempt because network is offline"),void this.reconnect();ze.isBrowser&&this.reporter.restore(),this.createConnectTime=s(),this.reporter.reportTraceCancel("login"),this.reporter.reportTraceStart("login",{user_id:this.options.account,action:this.autoconnect?"auto_login":"manual_login"}),this.reporter.reportTraceUpdateV2("login",{code:0,description:a(Y(Y({},this.options),{},{account:"***",token:"***"}),function($e,Lt){return $e===""||typeof Lt!="function"&&n(Lt)!=="object"?Lt:void 0}),operation_type:"conf_init",succeed:!0,target:""}),i(_e).connect.call(this)},_e.onConnect=function(){this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:this.url,code:200,net_connect:this.checkNetworkAvailable(),succeed:!0}),i(_e).onConnect.call(this)},_e.onHandshakeFailed=function($e,Lt){var Dt;this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:Lt,code:408,succeed:!1,net_connect:this.checkNetworkAvailable(),description:"ws_handshake_failed"}),this.reporter.reportTraceEnd("login",!1),this.logger.warn(u(Dt="link::onHandshakeFailed: shandshake failed, startTime: ".concat($e,", targetUrl: ")).call(Dt,Lt))},_e.onConnectFailed=function($e,Lt,Dt){var dr,pr;this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:Dt,code:408,succeed:!1,net_connect:this.checkNetworkAvailable(),description:"ws_connect_failed"}),this.reporter.reportTraceEnd("login",!1),this.logger.warn(u(dr=u(pr="link::onConnectFailed: connect failed due to ".concat($e,", startTime: ")).call(pr,Lt,", targetUrl: ")).call(dr,Dt))},_e.onSocketError=function($e,Lt,Dt){var dr,pr;this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:Dt,description:"ws_onerror:"+$e,code:0,succeed:!1}),this.reporter.reportTraceEnd("login",!1),this.logger.warn(u(dr=u(pr="link::onSocketError: due to ".concat($e,", startTime: ")).call(pr,Lt,", targetUrl: ")).call(dr,Dt))},_e.probeIp=function(){var $e=this,Lt=ze.ipProbeAddr;return new d(function(Dt){var dr=0,pr=-1;function sr(){++dr===2&&(dr=-1,Dt(pr))}$e.adaptersRequest(Lt.ipv4,{timeout:2e3,onerror:sr,onload:function(hr){pr++,sr()}}),$e.adaptersRequest(Lt.ipv6,{timeout:2e3,onerror:sr,onload:function(hr){pr+=2,sr()}}),c(function(){dr||pr===-1||(dr=-1,Dt(pr))},100)})},_e.refreshSocketUrl=function(){var $e=this;return this.statusProtector.emit("auth/loginLifeCycleAddressing"),ze.isWeixinApp?this.doRefreshSocketUrl(2):this.options.ipVersion===2?this.probeIp().then(function(Lt){return $e.doRefreshSocketUrl(Lt)}):this.doRefreshSocketUrl(this.options.ipVersion)},_e.doRefreshSocketUrl=function($e){var Lt,Dt,dr=this.options.lbsUrl||ze.lbsUrl;$e!==1&&$e!==2&&($e=0),ze.ipVersion=$e;var pr=this.options.lbsBackupUrlsCustomer||[],sr=[];this.options.lbsBackup&&ze.hasLocalStorage&&(sr=(sr=localStorage.getItem("nim_lbs_backup"))?JSON.parse(sr):[]);var hr=u(Lt=u(Dt=[dr]).call(Dt,sr)).call(Lt,pr);return hr=m(hr).call(hr,function(Fe,nr,ir){return v(ir).call(ir,Fe)===nr}),qe.call(this,hr)},_e.doRequestLbs=function($e){var Lt=this,Dt=this.options,dr=ze.info;$e=$e+Ce.genUrlSep($e)+"id="+Dt.account+"&sv="+dr.sdkVersion+"&pv="+dr.protocolVersion+"&networkType="+ze.ipVersion+"&hostEnv="+ze.hostEnv+"&k="+Dt.appKey,this.logger.info("doRequestLbs ".concat(g($e).call($e,0,-32)));var pr=this;return new d(function(sr,hr){ze.isWeixinApp?wx.request({url:$e,success:function(Fe){var nr=Fe&&Fe.statusCode,ir=Fe&&Fe.data;nr===200?sr(ir):hr(ir)},fail:function(Fe){hr(Fe)}}):Lt.adaptersRequest($e,{proxyUrl:Ce.url2origin($e)+"/lbs/res/cors/nej_proxy_frame.html",timeout:ze.xhrTimeout,onload:function(Fe){try{var nr=JSON.parse(Fe);sr(nr)}catch(ir){pr.logger.warn("doRequestLbs parse JSON Error. request lbs failed"),hr(ir)}},onerror:function(Fe){hr(Fe)}},{exception_service:1})})},_e.disconnect=function(){var $e=this,Lt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};if(this.isConnected())return this.sendCmd("logout"),void c(function(){i(_e).disconnect.call($e,Lt)},0);this.connecting?this.logger.warn("IMProtocolFn api disconnect:: connecting but exiting"):this.statusProtector.getConnectStatus()!==ie.V2NIM_CONNECT_STATUS_DISCONNECTED?this.logger.warn("IMProtocolFn api disconnect:: has tried to disconnect"):this.logger.warn("IMProtocolFn api disconnect:: other logic entered");var Dt=i(_e);Dt.disconnect.call(this,Lt)},_e.notifyDisconnect=function($e){i(_e).notifyDisconnect.call(this,$e)}},function(t,r,e){var n=e(102),o=e(58),s=e(103),a=e(3),i=e(10),u=e(23),d=e(25),c=e(6),m=e(2),v=e(17),g=e(5),b=e(59),T=e(60),k=e(61),y=e(62),O=e(47);function D(Ie,pe){var qe=g(Ie);if(b){var $e=b(Ie);pe&&($e=v($e).call($e,function(Lt){return T(Ie,Lt).enumerable})),qe.push.apply(qe,$e)}return qe}function he(Ie){for(var pe=1;pe<arguments.length;pe++){var qe,$e,Lt=arguments[pe]!=null?arguments[pe]:{};pe%2?m(qe=D(Object(Lt),!0)).call(qe,function(Dt){o(Ie,Dt,Lt[Dt])}):k?y(Ie,k(Lt)):m($e=D(Object(Lt))).call($e,function(Dt){O(Ie,Dt,T(Lt,Dt))})}return Ie}var ae=e(35).fn,Ne=e(193),ue=e(13),Y="NIM-AllGrayscaleConfig",_e="NIM-AllMixStorePolicy",Ce=e(0);function ze(){var Ie=this;if(ue.hasLocalStorage&&localStorage.getItem(Y)){var pe=null;try{pe=JSON.parse(localStorage.getItem(Y))[Ie.options.appKey]}catch(qe){Ie.logger.error("appGrayConfig error",qe)}pe&&(Ie.appGrayConfig=pe.timeStamp+1e3*pe.ttl>new Date().getTime()?pe:null,Ie.appGrayConfig&&ie.apply(Ie))}Ie.appGrayConfig||Ie.sendCmd("getGrayscaleConfig",{providers:""},function(qe,$e){if(qe)Ie.logger.error("Calculate Delay time, getGrayscaleConfig error",qe);else if($e){var Lt=$e;if(Lt.grayConfig=JSON.parse(Lt.grayConfig),Lt.ttl=Number(Lt.ttl),Lt.timeStamp=new Date().getTime(),Ie.appGrayConfig=Lt,ue.hasLocalStorage){var Dt=localStorage.getItem(Y)?JSON.parse(localStorage.getItem(Y)):{};Dt[Ie.options.appKey]=Lt,localStorage.setItem(Y,i(Dt))}ie.apply(Ie)}else Ie.logger.error("Calculate Delay time, getGrayscaleConfig error",$e)})}function ie(){var Ie=this;if(ue.hasLocalStorage&&localStorage.getItem(_e)){var pe=null;try{pe=JSON.parse(localStorage.getItem(_e))[Ie.options.appKey]}catch(qe){Ie.logger.error("mixStorePolicy error",qe)}pe&&(Ie.mixStorePolicy=pe.timeStamp+1e3*pe.ttl>new Date().getTime()?pe:null,Ie.mixStorePolicy&&pe.ttl&&pe.ttl!==0&&(Ie.mixStorePolicyClock=u(d(ie).call(ie,Ie),1e3*pe.ttl)))}Ie.mixStorePolicy||Ie.sendCmd("getMixStorePolicy",{providers:Ie.options.providers&&Ie.options.providers.s3?[1,2]:[1]},function(qe,$e){if(qe){Ie.logger.error("Calculate Delay time, getMixStorePolicy error",qe);try{$e=JSON.parse(localStorage.getItem("NIM-AllMixStorePolicy"))[Ie.options.appKey]}catch(dr){Ie.logger.error("error:","get last mixStorePolicy failed",dr)}}else if($e){var Lt=$e;if(Lt.ttl=Number(Lt.ttl),Lt.providers=Lt.providers.split(","),Lt.nosPolicy=Lt.nosPolicy?JSON.parse(Lt.nosPolicy):null,Lt.s3Policy=Lt.s3Policy?JSON.parse(Lt.s3Policy):null,Lt.timeStamp=new Date().getTime(),Ie.mixStorePolicy=Lt,Lt.ttl&&Lt.ttl!==0&&(Ie.mixStorePolicyClock=u(d(ie).call(ie,Ie),1e3*Lt.ttl)),ue.hasLocalStorage){var Dt=localStorage.getItem(_e)?JSON.parse(localStorage.getItem(_e)):{};Dt[Ie.options.appKey]=Lt,localStorage.setItem(_e,i(Dt))}}else Ie.logger.error("Calculate Delay time, mixStorePolicy error",$e)})}function le(Ie){var pe=this,qe=this;Ie.code===399?(this.logger.warn("pendingLoginFailed:399, refresh LBS url and reconnecting"),qe.forceDisconnect(),qe.doRefreshSocketUrl(ue.ipVersion).then(function(){qe.reconnect()}).catch(function(){pe.logger.warn("pendingLoginFailed:399, refresh LBS url failed")})):Ie.code===398?(this.logger.warn("pendingLoginFailed:398 try to reconnect socket linkbackoff set min 5s"),qe.backoff.setMin(5e3),qe.reconnect()):(this.logger.error("pendingLoginFailed: ",Ie.code,Ie),qe.onAuthError(Ie,"link::onLogin"))}ae.assembleLogin=function(){var Ie=this.assembleIMLogin();return this.addPushInfo instanceof Function?this.addPushInfo(Ie):a.resolve({login:Ie})},ae.login=s(n.mark(function Ie(){var pe,qe,$e,Lt=this;return n.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return pe=this,Dt.next=3,pe.assembleLogin();case 3:if(qe=Dt.sent,!($e=this.socket&&this.socket.socket&&this.socket.socket.sessionid)){Dt.next=13;break}if(this.socketIds||(this.socketIds={}),!this.socketIds[$e]){Dt.next=10;break}return this.logger.warn("onConnect::repeat login",$e),Dt.abrupt("return");case 10:this.socketIds[$e]=!0,Dt.next=14;break;case 13:this.logger.warn("onConnect:: no socketId ",this.socket&&this.socket.socket);case 14:this.logger.warn("link::doLogin: "+$e+" appLogin is "+qe.login.appLogin),pe.sendCmd("login",he({},qe),function(dr,pr){if(dr){var sr=Ce.get(dr,"event.uploadCode")||dr&&dr.code;sr=typeof sr!="number"?408:sr;var hr=Ce.get(dr,"event.disconnectReason"),Fe=hr?i({disconnect_reason:hr}):dr&&dr.message||"login failed";pe.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",code:sr,description:Fe,net_connect:pe.checkNetworkAvailable(),succeed:!1}),pe.reporter.reportTraceEnd("login",!1),le.call(pe,dr),pe.statusProtector.emit("auth/loginLifeCycleLoginFail",dr)}else pe.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",succeed:!0,net_connect:pe.checkNetworkAvailable(),code:200}),pe.reporter.reportTraceEnd("login",!0),pe.resetReconnectStatus(),Lt.heartbeatFail=0,Lt.hasLogin=!0,Lt.autoconnect=!0,pe.startHeartbeat(),pe.initOnlineListener(),pe.statusProtector.emit("auth/loginLifeCycleLoginSucc"),pe.afterLogin(pr)});case 16:case"end":return Dt.stop()}},Ie,this)})),ae.afterLogin=function(Ie){var pe=this;this.sendCmd("getNosCdnHost",{}),(typeof Ce.get(this.options,"privateConf.isMixStoreEnable")=="boolean"?this.options.privateConf.isMixStoreEnable:ue.privateConf.isMixStoreEnable)&&ze.apply(this),this.initPush instanceof Function&&this.initPush();var qe=this.db;if(qe.enable){var $e=this.account;this.options.appendAppKeyForDBName&&($e+="-"+this.options.appKey),this.db.init($e).then(function(){pe.notifyLogin(Ie),pe.syncData()},function(Lt){pe.logger.warn("link::afterLogin: no db",Lt),qe.reset(!1),pe.notifyLogin(Ie),pe.syncData()})}else this.logger.info("link::afterLogin: no db"),this.notifyLogin(Ie),this.syncData()},ae.getFileAuthToken=function(Ie){var pe=this,qe=pe.mixStorePolicy.nosPolicy.authPolicy.policyType;qe!==-1?c(qe).call(qe,Ie.type)<0?pe.logger.error("this type Token error not support"):Ie.type!=3||Ie.urls&&Ie.urls.length?pe.sendCmd("getBackSourceToken",{mixAuthTokenReq:Ie},function($e,Lt){if($e)return pe.logger.error("getBackSourceToken error",$e),$e;Ie.done&&Ie.done(Lt)}):pe.logger.error("urls is Required when type 3"):pe.logger.error("don't need token")},ae.processAuth=function(Ie){switch(Ie.cmd){case"login":Ie.error||(Ie.content=Ie.content||{},this.loginAndroidPush&&this.loginAndroidPush(Ie.content.aosPushInfo||{}),Ie.obj=Ie.content.loginRes,this.connectionId=Ie.content.loginRes.connectionId,this.onLoginPortsChange(Ie,2));break;case"kicked":return void this.onKicked(Ie);case"multiPortLogin":this.onLoginPortsChange(Ie,Ie.content.state);break;case"kick":Ie.error||(Ie.obj.deviceIds=Ie.content.deviceIds)}},ae.onLoginPortsChange=function(Ie,pe){var qe=this,$e=Ie.content.loginPorts;if($e&&$e.length){var Lt=!0;switch(pe){case 2:Lt=!0;break;case 3:Lt=!1}m($e).call($e,function(Dt){Dt.type=Ne.reverseType(Dt.type),Dt.customClientType&&(Dt.customClientType=+Dt.customClientType),Dt.time=+Dt.time,Dt.online=Lt}),($e=v($e).call($e,function(Dt){return Dt.connectionId!==qe.connectionId})).length&&(qe.logger.info("link::onLoginPortsChange:",$e),qe.options.onloginportschange($e))}},ae.kickedReasons=["","samePlatformKick","serverKick","otherPlatformKick","silentlyKick"],ae.kickedMessages=["","","","",""]},function(t,r,e){var n=e(783),o=e(3),s=e(25),a=e(7),i=e(749),u=e(41),d=e(2),c=e(5),m=e(138),v=e(17),g=e(6),b=e(8),T=e(797),k=e(69),y=e(23),O=e(32),D=e(87),he=e(35).fn,ae=e(0),Ne=e(40),ue=ae.undef,Y=ae.objs2ids,_e=ae.objs2accounts,Ce=ae.teams2ids,ze=e(152),ie=ae.getGlobal(),le=e(105).EMSyncType;he.beforeSync=function(){var Ie=this.db;return Ie.enable?Ie.clearSendingMsgs():o.resolve()},he.syncData=function(){var Ie=this,pe=Ie.db,qe=Ie.options,$e=pe.enable;function Lt(Dt){var dr;Ie.syncPromiseArray=[],Ie.syncResult={},Ie.syncTeamMembersPromiseArray=[],Ie.syncSuperTeamMembersPromiseArray=[],Ie.syncTeamMembersResult={},Ie.checkNosReqNum=0,Ie.getNosOriginUrlReqNum=0,ae.verifyBooleanWithDefault(qe,"syncRelations syncFriends syncFriendUsers syncTeams syncSuperTeams syncRoamingMsgs syncSuperTeamRoamingMsgs syncMsgReceipts syncExtraTeamInfo syncExtraSuperTeamInfo syncAvSignal",!0,"","sync::syncData"),ae.verifyBooleanWithDefault(qe,"syncFilter syncTeamMembers syncSuperTeamMembers",!1,"","sync::syncData");var pr={};Dt=Dt||{},ie._nimForceSyncIM&&(Ie.logger.warn("sync::syncData: nimForceSyncIM"),delete Dt.teams,ie._nimForceSyncIM=!1),pr.myInfo=Dt.myInfo||0,pr.deleteMsgSelf=Dt.deleteMsgSelf||0,pr.offlineMsgs=0,qe.syncRelations&&(pr.relations=Dt.relations||0),qe.syncFriends&&(pr.friends=Dt.friends||0),qe.syncFriendUsers&&(pr.friendUsers=Dt.friendUsers||0),qe.syncRobots&&(pr.robots=Dt.robots||0),qe.syncTeams&&(pr.teams=Dt.teams||0),qe.syncSuperTeams&&(pr.superTeams=Dt.superTeams||0),qe.syncStickTopSessions&&(pr.stickTopSessions=Dt.stickTopSessions||0),qe.syncSessionUnread&&(pr.sessionAck=$e&&Dt.sessionAck||0,pr.superTeamSessionAck=$e&&Dt.superTeamSessionAck||0),qe.syncRoamingMsgs&&(pr.roamingMsgs=$e&&Dt.roamingMsgs||Dt.roamingMsgs||0),qe.syncSuperTeamRoamingMsgs&&(pr.superTeamRoamingMsgs=$e&&Dt.superTeamRoamingMsgs||0),qe.syncMsgReceipts&&(pr.msgReceipts=Dt.msgReceipts||0),qe.syncExtraTeamInfo&&(pr.myTeamMembers=Dt.myTeamMembers||0),qe.syncExtraSuperTeamInfo&&(pr.myInfoInSuperTeams=Dt.myInfoInSuperTeams||0),qe.syncBroadcastMsgs&&(pr.broadcastMsgs=Dt.broadcastMsg||0),pr.donnop=Dt.donnop||0,pr.deleteMsg=Dt.deleteMsg||0,pr.deleteSuperTeamMsg=Dt.deleteSuperTeamMsg||0,pr.sessionHistoryMsgsDelete=Dt.sessionHistoryMsgsDelete||0,pr.netcallMsgs=0,qe.syncFilter&&(pr.filterMsgs=0),qe.syncAvSignal&&(pr.avSignal=0);var sr=s(dr=Ie.onSyncData).call(dr,Ie);sr.isImSyncDataCb=!0,Ie.logger.info("syncData:: start sync",pr),Ie.reporterHook.emit("reporter/syncStart"),Ie.sendCmd("sync",{sync:pr,isImSyncDataObj:!0},sr)}Ie.syncing=!0,$e?Ie.beforeSync().then(function(){return Ie.db.getTimetags()}).then(function(Dt){Lt(Dt)},function(){Lt()}):Lt(Ie.timetags)},he.onSyncData=function(Ie){Ie&&(Ie.callFunc="sync::onSyncData",this.onCustomError("SYNC_DATA_ERROR",Ie))},he.processSync=function(Ie){switch(this.logger.log("sync::processSync cmd: ".concat(Ie.cmd)),Ie.cmd){case"syncDone":if(Ie.error){var pe,qe=ae.get(Ie.error,"message"),$e=ae.get(Ie.error,"code");this.logger.error(a(pe="sync::processSync syncDoneError errMsg: ".concat(qe,", errCode: ")).call(pe,$e)),this.logger.error("sync::processSync disconnect because syncDone failed");var Lt=Ne.syncError({errMsg:qe,errCode:$e});this.shouldReconnect=!1,this.markAllCallbackInvalid(Lt),this.notifyDisconnect(Lt)}else this.timetags.sync=Ie.content.timetag,this.reporterHook.emit("reporter/syncRecv"),this.onSyncDone();break;case"syncTeamMembersDone":this.onSyncTeamMembersDone()}},he.onSyncDone=function(){var Ie,pe,qe,$e,Lt,Dt,dr,pr,sr,hr,Fe,nr,ir,Ue,rr,or,Pt,Et,kt,er,cr,mr,vr,Tr,Ir,kr,Ar,Rr,Cn,Or,Pr=this,Nr=Pr.db,Qr=Nr.enable,hn=Pr.options,Ur=Pr.syncPromiseArray,qr=Pr.syncResult;function Gn(){if(Ur){Pr.logger.info("sync::onSyncDone: after sync",ae.promises2cmds(Ur)),Ur=[],pe=qr.blacklist||[],qe=qr.invalidBlacklist||[],$e=qr.mutelist||[],Lt=qr.invalidMutelist||[],Dt=qr.friends,sr=qr.myTeamMembers,hr=qr.mySuperTeamMembers,dr=qr.invalidFriends||[],pr=qr.myInfo,Fe=qr.users,ir=qr.superTeams,rr=qr.invalidSuperTeams,nr=qr.teams,Ue=qr.invalidTeams||[],or=qr.sessions||{},Pt=i(u({},Pr.sessionSet)),Et=qr.ackMap,qr.msgReceipts,kt=qr.roamingMsgs,er=qr.offlineMsgs,cr=qr.offlineFilterMsgs,vr=qr.offlineSysMsgs,Tr=qr.offlineCustomSysMsgs,Ir=qr.offlineFilterSysMsgs,kr=qr.offlineFilterCustomSysMsgs,Ar=qr.sysMsgUnread,Rr=qr.sessionsWithMoreRoaming,Or=qr.clearServerHistoryMsgs||[];var bo=o.resolve();(function(){if(Qr){var so,co=[$n()];or&&d(so=c(or)).call(so,function(to){co.push(Nr.putSession(or[to]))}),bo=o.all(co).then(function(){var to,Br=a(to=[]).call(to,n(c(Et||{})),n(c(or||{})));Br=v(Br).call(Br,function(Bn,Xn,_o){return g(_o).call(_o,Bn)===Xn});var Gr=[];return d(Br).call(Br,function(Bn){var Xn,_o=or[Bn];(_o.lastMsg||_o.ack)&&(Xn=(Xn=_o.ack?o.resolve(_o):Nr.getSession(_o.id)).then(function(oo){var Ca=oo.ack||0;return Nr.getMsgCountAfterAck({shouldCountNotifyUnread:Pr.options.shouldCountNotifyUnread,sessionId:Bn,ack:Ca}).then(function(is){return oo.unread=is||0,or[Bn]=Pr.mergeSession(oo),Nr.updateSession(oo)})}),Gr.push(Xn))}),o.all(Gr)}).then(function(){var to=[];return Pr.saveAck.p2pTeam&&to.push(Nr.updateSessionAck(Pr.saveAck.p2pTeam).catch(function(Br){return Pr.logger.error("sessionAck::syncSessionAck::updatetimetag db",Br),o.reject(Br)})),Pr.saveAck.superTeam&&to.push(Nr.updateSuperTeamSessionAck(Pr.saveAck.superTeam).catch(function(Br){return Pr.logger.error("sessionAck::syncSuperTeamSessionAck::updatetimetag db",Br),o.reject(Br)})),o.all(to)})}else if(or){var No,An,Aa;d(No=[kt,er]).call(No,function(to){to&&d(to).call(to,function(Br){var Gr;(An=or[Br.sessionId]).unread=An.unread||0,An.unreadMsgs=An.unreadMsgs||[],Aa=An.ack||0,d(Gr=Br.msgs).call(Gr,function(Bn){if(!(Aa>=Bn.time))if(Bn.type==="notification"){var Xn;try{Xn=Pr.options.shouldCountNotifyUnread(Bn)}catch(_o){throw Pr.logger.error("userOption:shouldCountNotifyUnread function error",_o),_o}Xn&&An.unread++}else Bn.flow==="in"&&Bn.isUnreadable!==!1&&(An.unread++,An.unreadMsgs.push(Bn))}),Pr.mergeSession(An)})})}})(),bo.then(function(){if(Qr&&!Pr.hasSynced)Pr.hasSynced=!0,function(){hn.syncRelations&&(Ie=Nr.getRelations().then(function(An){pe=An[0],$e=An[1],pe.invalid=qe,$e.invalid=Lt}).catch(function(An){return An._msg="on relations error",Pr.logger.error("sync::syncRelation: ",An),o.reject(An)}),Ur.push(Ie)),hn.syncFriends&&(Ie=Nr.getFriends().then(function(An){(Dt=An).invalid=dr}).catch(function(An){return An._msg="on friends error",Pr.logger.error("sync::syncFriends: ",An),o.reject(An)}),Ur.push(Ie)),ue(pr)&&(Ie=Nr.getUser(Pr.account).then(function(An){pr=An}).catch(function(An){return An._msg="on myInfo error",Pr.logger.error("sync::syncMyInfo: ",An),o.reject(An)}),Ur.push(Ie)),hn.syncFriendUsers&&(Ie=Nr.getFriends().then(function(An){return b(An).call(An,function(Aa){return Aa.account})}).then(function(An){return Nr.getUsers(An)}).then(function(An){Fe=An}).catch(function(An){return An._msg="on users error",Pr.logger.error("sync::syncFriendUser: ",An),o.reject(An)}),Ur.push(Ie)),hn.syncTeams&&(Ie=Nr.getTeams().then(function(An){(nr=An).invalid=Ue}).catch(function(An){return An._msg="on teams error",Pr.logger.error("sync::syncTeams: ",An),o.reject(An)}),Ur.push(Ie)),hn.syncSuperTeams&&(Ie=Nr.getSuperTeams().then(function(An){(ir=An).invalid=rr}).catch(function(An){return An._msg="on superteams error",Pr.logger.error("sync::syncSuperTeams: ",An),o.reject(An)}),Ur.push(Ie)),Ie=Nr.getTeamMembersByAccount(Pr.account).then(function(An){sr=An,Pr.mergeMyTeamMembers(An)}).catch(function(An){return Pr.logger.error("sync::getTeamMembersByAccount: ",An),o.reject(An)}),Ur.push(Ie),Ie=Nr.getSuperTeamMembersByAccount(Pr.account).then(function(An){hr=An,Pr.mergeMySuperTeamMembers(An)}).catch(function(An){return Pr.logger.error("sync::getSuperTeamMembersByAccount: ",An),o.reject(An)}),Ur.push(Ie),Ie=Nr.getDonnop().then(function(An){Pr.mergeDonnop(An)}).catch(function(An){return Pr.logger.error("sync::donnop: ",An),o.reject(An)}),Ur.push(Ie),Ie=Nr.getAllSessions().then(function(An){or=An}).catch(function(An){return Pr.logger.error("sync::getSession: ",An),o.reject(An)}),Ur.push(Ie),Ie=Nr.getSysMsgUnread().then(function(An){Ar=An}).catch(function(An){return An._msg="on sysMsgUnread error",Pr.logger.error("sync::getSysMsgUnread: ",An),o.reject(An)}),Ur.push(Ie),Ur.push(Nr.getSessionsWithMoreRoaming().then(function(An){Rr=An}))}();else{var so,co,No=[];d(so=c(or)).call(so,function(An){(co=or[An]).lastMsg&&No.push(co)}),or=m(No).call(No,function(An,Aa){return Aa.updateTime-An.updateTime})}o.all(Ur).then(Jr).then(Lr,function(An){Pr.logger.error("taskAfterSync syncDBDataPromise error:",An),An.callFunc="sync::onSyncDone",An.message="taskAfterSync syncDBDataPromise ",Pr.onCustomError("SYNC_SESSION_ACK_ERROR",An)})})}else Pr.logger.warn("sync::onSyncDone: after sync --no promiseArray")}function $n(){var bo=[];return kt&&d(kt).call(kt,function(so){var co;bo=a(co=[]).call(co,n(bo),n(so.msgs))}),er&&d(er).call(er,function(so){var co;bo=a(co=[]).call(co,n(bo),n(so.msgs))}),bo.length?Nr.putMsg(bo).then(function(){return bo}):o.resolve(bo)}function Jr(){Pr.logger.info("sync::onSyncDone: taskAfterSync"),function(){if(qr.deleteMsgSysMsgs){var so,co={};kt&&d(kt).call(kt,function(Gr){co[Gr.sessionId]=Gr});var No={};er&&d(er).call(er,function(Gr){No[Gr.sessionId]=Gr});var An=Pr.api;if(d(so=qr.deleteMsgSysMsgs).call(so,function(Gr){var Bn;d(Bn=Gr.sysMsgs).call(Bn,function(Xn){var _o=Xn.msg,oo=_o.sessionId;Gr.type==="roaming"&&co[oo]?co[oo].msgs=An.cutMsgs(co[oo].msgs,_o):No[oo]&&(No[oo].msgs=An.cutMsgs(No[oo].msgs,_o))})}),!Nr.enable){var Aa,to=a(Aa=[]).call(Aa,n(kt||[]),n(er||[]));d(to).call(to,function(Gr){if(Gr.msgs.length){var Bn=Pr.genSessionByMsgs(Gr.msgs);Pr.cacheSyncedSession(Bn),or.unshift(Bn)}else{var Xn=T(or).call(or,function(_o){return _o.id===Gr.sessionId});k(or).call(or,Xn,1)}});var Br={};d(or).call(or,function(Gr){if(Br[Gr.id]){var Bn=Gr.lastMsg.time>Br[Gr.id].lastMsg.time?Gr.lastMsg:Br[Gr.id].lastMsg;Br[Gr.id]=Gr,Br[Gr.id].lastMsg=Bn}else Br[Gr.id]=Gr}),or=i(Br),or=m(or).call(or,function(Gr,Bn){return Bn.updateTime-Gr.updateTime})}}}(),Cn=Pr.syncResult.stickTopSessions||[],d(Cn).call(Cn,function(so,co){Cn[co]=Pr.mergeSession(so)}),d(or).call(or,function(so){var co=Pr.sessionSet[so.id];co&&co.isTop&&(so.isTop=!0)});var bo=[Pr.deleteMsgOfflineRoaming(qr.deleteMsgSysMsgs,or)];return Or&&d(Or).call(Or,function(so){bo.push(function(co,No){var An;Pr.logger.info("sync::taskAfterSync:sessionHistoryMsgsDelete ".concat(co)),No=No||new Date().getTime();var Aa=v(or).call(or,function(Bn){return Bn.id===co}),to=Pr.getSessionInCache(co);An=to||Aa[0];var Br=hn.rollbackClearMsgsUnread!==!1,Gr=[];return Nr.enable&&Gr.push(Nr.deleteMsgsBySessionId({sessionId:co,end:No})),Br&&An&&(An.lastMsg=null,An.unread=0,An=Pr.mergeSession(An),Nr.enable&&Gr.push(Nr.updateSession(An))),o.all(Gr)}(so.sessionId,so.time))}),o.all(bo)}function Lr(){y(Kn,0)}function Kn(){var bo,so,co=[],No=[];if(pe&&pe.length&&(Pr.logger.info("sync::notifyDataAsync: on blacklist",_e(pe)),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType3_8),hn.onblacklist(pe)),$e&&$e.length&&(Pr.logger.info("sync::notifyDataAsync: on mutelist",_e($e)),hn.onmutelist($e)),Dt&&(Pr.logger.info("sync::notifyDataAsync: on friends",_e(Dt)),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType12_5),hn.onfriends(Dt)),pr&&(Pr.logger.info("sync::notifyDataAsync: on myInfo"),Pr.myInfo=pr,Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType3_109),hn.onmyinfo(ae.copy(pr))),sr){Pr.logger.info("sync::notifyDataAsync: on myTeamMembers",sr),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType8_126);var An=ae.simpleClone(sr);O(An)||(An=[An]),hn.onMyTeamMembers(An)}if(hr){Pr.logger.info("sync::notifyDataAsync: on mySuperTeamMembers",hr),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType21_111);var Aa=ae.simpleClone(hr);O(Aa)||(Aa=[Aa]),hn.onMySuperTeamMembers(Aa)}Fe&&(d(Fe).call(Fe,function(oo){Pr.mergeUser(oo)}),Pr.logger.info("sync::notifyDataAsync: on users",_e(Fe)),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType12_6),hn.onusers(Fe)),nr&&(Pr.logger.info("sync::notifyDataAsync: on teams",Ce(nr)),hn.onteams(nr),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType8_109)),ir&&(Pr.logger.info("sync::notifyDataAsync: onSuperTeams",Ce(ir)),hn.onSuperTeams(ir),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType21_109)),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_12),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_14),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_20),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_21),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType7_15),or&&or.length?(or=b(or).call(or,function(oo){return Pr.mergeSession(oo),D(ze).call(ze,oo)}),or=v(or).call(or,function(oo){return!oo.isDeleted}),Pr.logger.info("sync::notifyDataAsync: on sessions",Y(or),ae.secureOutput("session",or)),!Qr&&Pr.timetags&&Pr.timetags.roamingMsgs?hn.onsessions(v(Pt).call(Pt,function(oo){return ze.isComplete(oo)})):hn.onsessions(or)):!Qr&&Pt.length&&(Pr.logger.info("sync::notifyDataAsync: on sessions",Y(or),ae.secureOutput("session",or)),hn.onsessions(v(Pt).call(Pt,function(oo){return ze.isComplete(oo)}))),Cn&&Cn.length&&(Cn=b(Cn).call(Cn,function(oo){return oo=Pr.mergeSession(oo),D(ze).call(ze,oo)}),Pr.logger.info("sync::notifyDataAsync: onStickTopSessions",Y(Cn),ae.secureOutput("session",Cn)),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_23),hn.onStickTopSessions(Cn)),kt&&d(kt).call(kt,function(oo){oo.scene==="superTeam"?No.push(oo.timetag):co.push(oo.timetag),(so=oo.msgs).length&&(Pr.logger.info("sync::notifyDataAsync: on roaming msgs",oo.sessionId,so.length),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_9),hn.onroamingmsgs(oo))}),er&&(Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_4),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_17),d(er).call(er,function(oo){oo.scene==="superTeam"?No.push(oo.timetag):co.push(oo.timetag),(so=oo.msgs).length&&(Pr.logger.info("sync::notifyDataAsync: on offline msgs",oo.sessionId,so.length,b(so).call(so,function(Ca){return Ca.idServer})),hn.onofflinemsgs(oo))})),cr&&(Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_100),d(cr).call(cr,function(oo){co.push(oo.timetag),(so=oo.msgs).length&&(Pr.logger.info("sync::notifyDataAsync: on offline filter msgs",oo.sessionId,so.length),hn.onofflinefiltermsgs(so))})),Rr&&(Pr.logger.info("sync::notifyDataAsync: on sessionsWithMoreRoaming",Y(Rr),Rr),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_22),hn.onSessionsWithMoreRoaming(Rr));var to,Br=[],Gr=[];qr.deleteMsgSysMsgs&&d(to=qr.deleteMsgSysMsgs).call(to,function(oo){oo.type==="roaming"?Br=a(Br).call(Br,oo.sysMsgs):Gr=a(Gr).call(Gr,oo.sysMsgs)}),Br.length&&(mr=a(mr=mr||[]).call(mr,Br)),Gr.length&&(vr=a(vr=vr||[]).call(vr,Gr)),mr&&(Pr.logger.info("sync::notifyDataAsync: on roaming sys msgs",mr.length),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_19),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_15),hn.onroamingsysmsgs(mr)),vr&&(Pr.logger.info("sync::notifyDataAsync: on offline sys msgs",vr.length),hn.onofflinesysmsgs(vr)),Ir&&(Pr.logger.info("sync::notifyDataAsync: on offline filter sys msgs",Ir.length),hn.onofflinefiltersysmsgs(Ir)),Tr&&(Pr.logger.info("sync::notifyDataAsync: on offline custom sys msgs",Tr.length),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_6),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_18),hn.onofflinecustomsysmsgs(Tr)),kr&&(Pr.logger.info("sync::notifyDataAsync: on offline filter custom sys msgs",kr.length),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_101),hn.onofflinefiltercustomsysmsgs(kr)),Ar&&(Ar=ae.merge({},Pr.sysMsgUnread,Ar),Pr.sysMsgUnread=ae.merge({},Ar),Pr.logger.info("sync::notifyDataAsync: on sysMsgUnread",Ar),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_6),hn.onsysmsgunread(Ar));var Bn=Pr.getPushNotificationMultiportConfig();Pr.logger.info("sync::notifyDataAsync: on pushNotificationMultiportConfig",Bn),Pr.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_13),hn.onPushNotificationMultiportConfig(Bn);var Xn=No.length&&Math.max.apply(Math,No);if(bo=co.length&&Math.max.apply(Math,co),Nr.enable){var _o=[];Xn&&_o.push(Pr.db.updateSuperTeamRoamingMsgTimetag(Xn)),bo&&_o.push(Pr.db.updateRoamingMsgTimetag(bo)),o.all(_o).then(vo).catch(vo)}else Pr.timetags.superTeamRoamingMsgs=Xn,Pr.timetags.roamingMsgs=bo||Pr.timetags.roamingMsgs,vo();Pr.syncPromiseArray=[],Pr.syncResult={}}function vo(){if(Pr.processUnsettledMsgs(),Pr.msgPromise.then(function(){Pr.canHandleDeletedMsgInSyncing=!0,y(function(){Pr.processUnsettledSysMsgs()},0)}),Pr.syncing&&hn.onsyncdone(),Pr.syncing=!1,Pr.reporterHook.emit("reporter/syncComplete"),hn.syncTeamMembers&&nr&&nr.length)throw new Ne("sync team members api deprecated!")}Ur&&Ur.length?o.all(Ur).then(Gn).catch(function(bo){Gn(),Pr.logger.error(bo),bo.callFunc="sync::onSyncDone",bo.message="afterSync syncNormalPromise ",Pr.onCustomError("SYNC_promiseArray_ERROR",bo)}):Gn()},he.syncTeamMembers=function(Ie){var pe,qe,$e=this;$e.timetags,qe={},d(Ie).call(Ie,function(Lt){qe[Lt.teamId]=0},$e),$e.sendCmd("syncTeamMembers",{sync:qe},s(pe=$e.onSyncTeamMembers).call(pe,$e))},he.onSyncTeamMembers=function(Ie){Ie.callFunc="sync::onSyncTeamMembers",Ie.message="",this.onCustomError("SYNC_TEAM_MEMBERS_ERROR",Ie)},he.onSyncTeamMembersDone=function(){var Ie,pe=this,qe=pe.db,$e=pe.options,Lt=pe.syncTeamMembersResult,Dt=pe.syncTeamMembersPromiseArray;function dr(){pe.logger.log("sync::onSyncTeamMembersDone: afterSync",ae.promises2cmds(Dt)),Dt=[],qe.enable&&!pe.hasSyncedTeamMembers?(pe.hasSyncedTeamMembers=!0,function(){if(!$e.syncTeams||!$e.syncTeamMembers)return hr();qe.getTeams().then(function(Fe){d(Fe).call(Fe,function(nr){var ir=nr.teamId;Ie=new o(function(Ue,rr){pe.api.getTeamMembers({teamId:ir,done:function(or,Pt){or&&rr({callFunc:"sync::getTeamMembers: teamId-".concat(ir),message:"sync team members error"}),Lt[ir]=Pt.members||[],Ue()}})}),Dt.push(Ie)}),Dt.length?o.all(Dt).then(pr,function(nr){nr.callFunc="sync::onSyncTeamMembersDone",nr.message="pullFullData promiseArray notifyData ",pe.onCustomError("SYNC_TEAM_MEMBERS_ERROR",nr)}):pr()},function(Fe){Fe.callFunc="sync::onSyncTeamMembersDone",Fe.message="pullFullData getTeams ",pe.onCustomError("SYNC_TEAM_MEMBERS_ERROR",Fe)})}()):pr()}function pr(){y(sr,0)}function sr(){var Fe,nr,ir;d(Fe=c(Lt)).call(Fe,function(Ue){g(Ue).call(Ue,"invalid")===-1&&(nr=Lt[Ue],ir=Lt[Ue+"-invalid"]||[],nr.invalid=ir,function(rr,or){pe.logger.info("sync::onSyncTeamMembersDone: onTeamMembers",rr,_e(or),or),$e.onteammembers({teamId:rr,members:or})}(Ue,nr))}),hr()}function hr(){pe.logger.info("sync::onSyncTeamMembersDone: bingo"),$e.onsyncteammembersdone(),pe.syncTeamMembersResult=null,pe.syncTeamMembersPromiseArray=null}Dt.length?o.all(Dt).then(dr,function(Fe){Fe.callFunc="sync::onSyncTeamMembersDone",Fe.message=" syncTeamMembersPromiseArray ",pe.onCustomError("SYNC_TEAM_MEMBERS_ERROR",Fe)}).catch(function(Fe){pe.logger.log("sync::onSyncTeamMembersDone: syncTeamMembersPromiseArray promise ",Fe),dr()}):dr()}},function(t,r,e){var n=e(784),o=e(788),s=e(748),a=e(792);t.exports=function(i){return n(i)||o(i)||s(i)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(745),o=e(746);t.exports=function(s){if(n(s))return o(s)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(786)},function(t,r,e){var n=e(787);t.exports=n},function(t,r,e){var n=e(299);t.exports=n},function(t,r,e){var n=e(153),o=e(70),s=e(747);t.exports=function(a){if(n!==void 0&&o(a)!=null||a["@@iterator"]!=null)return s(a)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(790)},function(t,r,e){var n=e(791);t.exports=n},function(t,r,e){var n=e(300);t.exports=n},function(t,r){t.exports=function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(794);t.exports=n},function(t,r,e){e(795);var n=e(12);t.exports=n.Object.values},function(t,r,e){var n=e(1),o=e(796).values;n({target:"Object",stat:!0},{values:function(s){return o(s)}})},function(t,r,e){var n=e(27),o=e(11),s=e(118),a=e(43),i=o(e(148).f),u=o([].push),d=function(c){return function(m){for(var v,g=a(m),b=s(g),T=b.length,k=0,y=[];T>k;)v=b[k++],n&&!i(g,v)||u(y,c?[v,g[v]]:g[v]);return y}};t.exports={entries:d(!0),values:d(!1)}},function(t,r,e){t.exports=e(798)},function(t,r,e){var n=e(799);t.exports=n},function(t,r,e){var n=e(21),o=e(800),s=Array.prototype;t.exports=function(a){var i=a.findIndex;return a===s||n(s,a)&&i===s.findIndex?o:i}},function(t,r,e){e(801);var n=e(30);t.exports=n("Array").findIndex},function(t,r,e){var n=e(1),o=e(84).findIndex,s=e(196),a=!0;"findIndex"in[]&&Array(1).findIndex(function(){a=!1}),n({target:"Array",proto:!0,forced:a},{findIndex:function(i){return o(this,i,arguments.length>1?arguments[1]:void 0)}}),s("findIndex")},function(t,r,e){var n=e(8),o=e(9),s=e(3),a=e(2),i=e(35).fn,u=e(0),d=u.objs2accounts,c=e(803),m=e(203);i.processUser=function(v){var g,b=this,T=b.db,k=v.obj,y=v.error,O=v.content;switch(v.cmd){case"markInBlacklist":y||b.markInBlacklist(k);break;case"syncMarkInBlacklist":b.markInBlacklist(O,!0);break;case"markInMutelist":y||b.markInMutelist(k);break;case"syncMarkInMutelist":b.markInMutelist(O,!0);break;case"getRelations":y||b.onRelations(v);break;case"syncMyInfo":b.onMyInfo(v,!0);break;case"updateMyInfo":y||(k.user.updateTime=O.timetag,b.onUpdateMyInfo(v,k.user));break;case"syncUpdateMyInfo":b.onUpdateMyInfo(v,O.user,!0);break;case"getUsers":var D;y||(g=n(D=O.users).call(D,function(he){return he=o(m).call(m,he,b.mixStorePolicy&&b.mixStorePolicy.s3Policy?b.mixStorePolicy.s3Policy.dlcdns:[],b.mixStorePolicy&&b.mixStorePolicy.s3Policy?b.mixStorePolicy.s3Policy.dlcdn:""),b.mergeUser(he),he}),v.obj=g,T.enable&&T.putUsers(g));break;case"updateDonnop":b.onUpdateDonnop(v);break;case"syncUpdateDonnop":b.onDonnop(v,!1)}},i.onMyInfo=function(v){var g,b=this,T=b.db,k=v.error,y=v.content,O=new s(function(he,ae){var Ne,ue;k?(k&&(k.callFunc="user::onMyInfo"),he(k),b.syncData()):(g=o(m).call(m,y.user),T.enable?(Ne=he,ue=ae,T.mergeMyInfo(g,!0).then(function(){D(),Ne()}).then(void 0,function(Y){Y.message="db.mergeMyInfo error",Y.callFunc="user::onMyInfo",ue(Y)})):(D(),he()))}).catch(function(he){return b.logger.error("user::onMyInfo: ",he),s.reject(he)});function D(){b.timetags.myInfo=g.updateTime,b.syncResult.myInfo=g}O.cmd="myInfo",b.syncPromiseArray.push(O)},i.onUpdateMyInfo=function(v,g,b){var T=this.db,k=o(m).call(m,g),y=u.merge(this.myInfo,k);this.myInfo=y,b?(this.logger.info("user::onUpdateMyInfo:",y&&y.account),this.options.onupdatemyinfo(y)):v.obj=y,T.enable&&(k.account=this.account,T.updateUser(k))},i.onRelations=function(v){var g,b=this,T=b.db,k=v.error,y=b.packetFromSync(v),O=v.content.specialRelations,D=!0,he=[],ae=[],Ne=[],ue=[],Y=new s(function(Ce,ze){var ie,le;k?y&&(Ce(k),b.syncData()):(a(O).call(O,function(Ie){var pe={account:(Ie=c.parse(Ie)).account,createTime:Ie.createTime,updateTime:Ie.updateTime};Ie.isBlacked?he.push(pe):ae.push(pe),Ie.isMuted?Ne.push(pe):ue.push(pe)}),b.logger.info("user::onRelations: parse blacklist",d(he),he,"delete",d(ae),ae),b.logger.info("user::onRelations: parse mutelist",d(Ne),Ne,"delete",d(ue),ue),O.length?(D=!0,g=v.content.timetag):D=!1,T.enable?(ie=Ce,le=ze,v.promise=new s(function(Ie,pe){function qe(){y?(_e(),Ie(),ie()):T.getRelations().then(function($e){he=$e[0],Ne=$e[1],_e(),Ie(),ie()}).then(void 0,function($e){$e.message="db.getRelations error",$e.callFunc="user::onRelations",pe($e),le($e)})}D?T.mergeRelations(he,ae,Ne,ue,g).then(function(){qe()}).then(void 0,function($e){$e.message="db.mergeRelations error",$e.callFunc="user::onRelations",pe($e),le($e)}):(b.logger.warn("user::onRelations: no relations need merge"),qe())}).then(void 0,function(Ie){throw Ie.message="merge relations data error",Ie.callFunc="user::onRelations",le(Ie),Ie})):(_e(),Ce()))}).catch(function(Ce){return b.logger.error("user::onRelations: ",Ce),s.reject(Ce)});function _e(){b.timetags.relations=g,he.invalid=ae,Ne.invalid=ue,y?(b.syncResult.blacklist=he,b.syncResult.mutelist=Ne,b.syncResult.invalidBlacklist=ae,b.syncResult.invalidMutelist=ue):(b.logger.info("user::onRelations: get relations",he,Ne),v.obj.blacklist=he,v.obj.mutelist=Ne)}y&&(Y.cmd="relations",b.syncPromiseArray.push(Y))},i.markInBlacklist=function(v,g){var b=this.db;v.record={account:v.account,updateTime:+new Date},b.enable&&b.markInBlacklist(v),g&&(this.logger.info("user::markInBlacklist:",v),this.options.onsyncmarkinblacklist(v))},i.markInMutelist=function(v,g){var b=this.db;v.record={account:v.account,updateTime:+new Date},b.enable&&b.markInMutelist(v),g&&(this.logger.info("user::markInMutelist:",v),this.options.onsyncmarkinmutelist(v))},i.mergeUser=function(v){this.userSet[v.account]=v}},function(t,r,e){var n=e(0);function o(){}o.parse=function(s){var a=n.copy(s);return a.isBlacked=a.isBlacked==="1",a.isMuted=a.isMuted==="1",a.createTime=+a.createTime,a.updateTime=+a.updateTime,a},t.exports=o},function(t,r,e){var n=e(120),o=e(2),s=e(9),a=e(3),i=e(7),u=e(8),d=["type"],c=e(35).fn,m=e(0),v=m.objs2accounts,g=e(750),b=e(203);c.processFriend=function(T){var k=T.obj,y=T.content,O=T.error;switch(T.cmd){case"friendRequest":this.updateFriendSysMsg(T),O||this.onFriendRequest(k);break;case"syncFriendRequest":this.onFriendRequest(y,!0);break;case"deleteFriend":O||this.onDeleteFriend(k);break;case"syncDeleteFriend":this.onDeleteFriend(y,!0);break;case"updateFriend":O||this.onUpdateFriend(k);break;case"syncUpdateFriend":this.onUpdateFriend(y.friend,!0);break;case"getFriends":this.getFriends(T);break;case"syncFriends":this.onFriends(T);break;case"syncFriendUsers":this.onFriendUsers(T)}},c.getFriends=function(T){var k=T.content.friends,y=[],O=[];o(k).call(k,function(D){(D=s(g).call(g,D)).valid?y.push(D):O.push(D)}),y.invalid=O,T.obj=y},c.onFriends=function(T){var k,y=this,O=y.db,D=T.error,he=T.content.friends,ae=!0,Ne=[],ue=[],Y=new a(function(Ce,ze){var ie,le;D?ze(D):(function(){ae&&o(he).call(he,function(Ie){(Ie=s(g).call(g,Ie)).valid?Ne.push(Ie):ue.push(Ie)}),y.logger.info("friend::onFriends: parse friends",v(Ne),"delete",v(ue)),he.length?(ae=!0,k=T.content.timetag):ae=!1}(),O.enable?(ie=Ce,le=ze,T.promise=new a(function(Ie,pe){function qe(){_e(),Ie(),ie()}ae?O.mergeFriends(Ne,ue,k).then(function(){qe()}).then(void 0,function($e){$e._msg="merge friends error",pe($e),le($e)}):(y.logger.info("friend::onFriends: no merge friends"),qe())}).then(void 0,function(Ie){throw Ie._msg="merge friends data error",le(Ie),Ie})):(_e(),Ce()))}).catch(function(Ce){return y.logger.error("friend::onFriends: ",Ce),a.reject(Ce)});function _e(){var Ce,ze;y.timetags.friends=k,Ne.invalid=ue,y.syncResult.friends=i(Ce=y.syncResult.friends||[]).call(Ce,Ne||[]),y.syncResult.invalidFriends=i(ze=y.syncResult.invalidFriends||[]).call(ze,ue||[])}Y.cmd="friends",y.syncPromiseArray.push(Y)},c.onFriendRequest=function(T,k){var y=a.resolve(),O=this.db,D=T.type,he=n(T,d);if((D=T.type=g.getTypeFromByte(D)||D)==="addFriend"||D==="passFriendApply"){var ae=T.friend=g.assembleFriend(he);O.enable&&(y=O.putFriend(ae))}return k&&this.onSyncFriendAction(T),y},c.onSyncFriendAction=function(T){this.logger.info("friend::onSyncFriendActionon: ".concat(T.type,", "),T.account),this.options.onsyncfriendaction(T)},c.onDeleteFriend=function(T,k){var y=a.resolve(),O=this.db;return O.enable&&(y=O.deleteFriend(T.account)),k&&(T.type="deleteFriend",this.onSyncFriendAction(T)),y},c.onUpdateFriend=function(T,k){var y=this.db,O=s(g).call(g,T);y.enable&&y.updateFriend(O),k&&this.onSyncFriendAction({type:"updateFriend",friend:O})},c.onFriendUsers=function(T){var k,y,O=this.db,D=T.content,he=u(k=D.users).call(k,function(ue){return s(b).call(b,ue)});this.logger.info("friend::onFriendUsers: parse users",v(he));var ae=D.timetag,Ne=a.resolve();O.enable&&(Ne=O.mergeFriendUsers(he,ae)),this.timetags.friendUsers=ae,Ne.cmd="friendUsers",this.syncPromiseArray.push(Ne),this.syncResult.users=i(y=this.syncResult.users||[]).call(y,he||[]),this.syncing||this.onSyncDone()},c.updateFriendSysMsg=function(T){var k,y,O=T.obj,D=T.error;if(T.obj.idServer){if(D)k="error",D=m.filterObj(D,"code message");else{var he=O.type;switch(he=g.getTypeFromByte(he)||he){case"passFriendApply":k="passed";break;case"rejectFriendApply":k="rejected"}}y={idServer:O.idServer,state:k,from:O.account,type:"applyFriend"},D&&(y.error=D),this.updateSysMsg(y)}}},function(t,r,e){var n=e(32),o=e(17),s=e(35).fn,a=e(0);s.onRobots=function(i){var u=i.content;if(a.isFunction(this.options.onrobots)&&n(u.robots)){var d,c=o(d=u.robots).call(d,function(m){return!!m.botid});c.length>0&&this.options.onrobots(c||[])}}},function(t,r,e){var n=e(9),o=e(2),s=e(23),a=e(171),i=e(3),u=e(8),d=e(17),c=e(5),m=e(35).fn,v=e(0),g=v.objs2accounts,b=v.teams2ids,T=e(192),k=e(150);m.processTeam=function(y){var O,D,he,ae=y.error;switch(y.obj===void 0&&(y.obj={}),y.cmd){case"createTeam":O=y.obj.team,ae||(O=y.content.team),O=n(T).call(T,O),y.obj.team=O,he=k.assembleOwner(O),y.obj.owner=he,ae||(this.logger.info("team::processTeam: create team ",O&&O.teamId,he&&he.account),this.onCreateTeam(O,he));break;case"syncCreateTeam":O=n(T).call(T,y.content.team),he=k.assembleOwner(O),this.logger.info("team::processTeam: sync createTeam",O&&O.teamId,he&&he.account),this.options.onsynccreateteam(O,he),this.onCreateTeam(O,he);break;case"sendSuperTeamMsg":case"sendTeamMsg":this.onSendMsg(y);break;case"teamMsg":this.onMsg(y);break;case"teamMsgs":this.onMsgs(y);break;case"addTeamMembers":case"removeTeamMembers":case"leaveTeam":case"dismissTeam":case"addTeamManagers":case"removeTeamManagers":case"transferTeam":break;case"updateInfoInTeam":ae||((D=y.obj).account=this.account,D.id=k.genId(D.teamId,D.account),D=n(k).call(k,D),y.obj=D,this.mergeMyTeamMembers(D),this.onUpdateTeamMember(D));break;case"updateNickInTeam":y.obj=n(k).call(k,y.obj);break;case"updateTeam":y.obj=n(T).call(T,y.obj,!0);break;case"applyTeam":y.error||(y.obj=n(T).call(T,y.content.team));break;case"passTeamApply":this.updateTeamSysMsgState(y,"passed");break;case"rejectTeamApply":this.updateTeamSysMsgState(y,"rejected");break;case"acceptTeamInvite":this.updateTeamSysMsgState(y,"passed"),y.error||(y.obj=n(T).call(T,y.content.team));break;case"rejectTeamInvite":this.updateTeamSysMsgState(y,"rejected");break;case"getTeam":y.error||(y.obj=n(T).call(T,y.content.team));break;case"getTeams":this.onTeams(y);break;case"getTeamMembers":this.onTeamMembers(y);break;case"syncTeams":this.onTeams(y);break;case"syncTeamMembers":this.onTeamMembers(y);break;case"getTeamHistoryMsgs":case"searchTeamHistoryMsgs":this.onHistoryMsgs(y);break;case"syncSendTeamMsg":this.onMsg(y);break;case"notifyTeamMsgReads":this.onTeamMsgReceipt(y);break;case"syncUpdateTeamMember":(D=n(k).call(k,y.content.teamMember)).account===this.account&&this.mergeMyTeamMembers(D),this.onUpdateTeamMember(D);break;case"updateMuteStateInTeam":break;case"getMyTeamMembers":y.error||(y.obj=k.reverseMembers(y.content.teamMembers));break;case"getMutedTeamMembers":y.error||(y.obj={teamId:y.obj.teamId,members:k.reverseMembers(y.content.teamMembers)});break;case"syncMyTeamMembers":this.onSyncMyTeamMembers(y);break;case"sendTeamMsgReceipt":this.sendTeamMsgReceipt(y);break;case"getTeamMsgReads":this.getTeamMsgReads(y);break;case"getTeamMsgReadAccounts":this.getTeamMsgReadAccounts(y);break;case"getTeamsById":this.getTeamsById(y)}},m.getTeamMsgReads=function(y){var O=this;if(y.error)this.logger.error("team::sendTeamMsgReceipt: ",y.error);else{var D=v._get(y,"content.teamMsgReceipts")||[];if(this.db.enable){var he=[];o(D).call(D,function(ae){ae.idClient&&he.push({idClient:ae.idClient,unread:+ae.unread,read:+ae.read})}),he.length>0&&s(function(){return O.db.updateMsgBatch(he)},0)}}},m.getTeamMsgReadAccounts=function(y){if(y.error)this.logger.error("team::getTeamMsgReadAccounts: ",y.error);else{var O=v._get(y,"content.readAccounts")||[],D=v._get(y,"content.unreadAccounts")||[],he=v._get(y,"content.teamMsgReceipt.idClient")||[];this.db.enable&&this.db.putMsgReadDetail({idClient:he,readAccounts:O,unreadAccounts:D})}},m.sendTeamMsgReceipt=function(y){var O=this;if(y.error)this.logger.error("team::sendTeamMsgReceipt: ",y.error);else{var D=v._get(y,"obj.teamMsgReceipts")||[],he=v._get(y,"content.teamMsgReceipts")||[];if(this.db.enable){var ae=[];o(D).call(D,function(Ne){a(he).call(he,function(ue){return Ne.idServer===ue.idServer})||ae.push({idClient:Ne.idClient,hasRead:!0})}),ae.length>0&&(this.logger.log("sendTeamMsgReceipt::updateMsgBatch"),s(function(){return O.db.updateMsgBatch(ae)},0))}}},m.onCreateTeam=function(y,O){var D=this.db;D.enable&&(D.putTeam(y),D.putTeamMembers(O)),this.options.onCreateTeam(y,O)},m.onTeams=function(y){y.content=y.content||{};var O,D=this,he=D.db,ae=D.packetFromSync(y),Ne=y.content.teams||[],ue=!0,Y=[],_e=[];if(y.error)switch(y.error.code){case 803:y.error=null,ue=!1}var Ce=new i(function(ie,le){var Ie,pe;y.error?ae&&le(y.error):(function(){ue&&o(Ne).call(Ne,function(qe){(qe=n(T).call(T,qe)).validToCurrentUser?Y.push(qe):_e.push(qe)}),Ne.length?(ue=!0,O=y.content.timetag):ue=!1}(),he.enable?(Ie=ie,pe=le,y.promise=new i(function(qe,$e){function Lt(){ae?(ze(),qe(),Ie()):he.getTeams().then(function(Dt){Y=Dt,ze(),qe(),Ie()}).catch(function(Dt){Dt.message="db.getTeams error",Dt.callFunc="team::afterMergeData",$e(Dt),pe(Dt)})}ue?he.mergeTeams(Y,_e,O).then(function(){Lt()}).catch(function(Dt){var dr={callFunc:"team::onTeams:mergeData",message:"db.mergeTeams error",event:Dt};$e(dr),pe(dr)}):(D.logger.warn("team::onTeams:mergeData: no teams need merge"),Lt())}).then(void 0,function(qe){throw qe.message="merge teams data error",qe.callFunc="team::mergeData",pe(qe),qe})):(ze(),ie()))}).catch(function(ie){return D.logger.error("team::onTeams: ",ie),i.reject(ie)});function ze(){D.timetags.teams=O,Y.invalid=_e,ae?(D.syncResult.teams=Y,D.syncResult.invalidTeams=_e,D.syncing||D.onSyncDone()):(D.logger.info("team::onTeams: not in syncing, get teams",b(Y)),y.obj=Y)}ae&&(Ce.cmd="teams",D.syncPromiseArray.push(Ce))},m.getTeamsById=function(y){var O;if(y.error){if(y.error.code!==816)return;this.logger.error("team::getTeamsById: ",y.error),y.error=null}y.content.teams=u(O=y.content.teams).call(O,function(D){return n(T).call(T,D)}),y.obj=y.content},m.onTeamMembers=function(y){y.content=y.content||{};var O,D,he=this,ae=he.packetFromSync(y),Ne=y.content.members||[],ue=!0,Y=[],_e=[];if(y.obj&&(D=y.obj.teamId),D||(D=y.content.teamId),D=""+D,y.error)switch(y.error.code){case 406:y.error=null,ue=!1}var Ce=new i(function(ze,ie){y.error?ae&&(he.logger.error("team::onTeamMember: team error:",D,y.error),ie({callFunc:"team::onTeamMembers",event:y.error,message:"teamId-".concat(D," ")})):(function(){ue&&o(Ne).call(Ne,function(le){(le=n(k).call(k,le)).valid?Y.push(le):_e.push(le)}),Ne.length?(ue=!0,O=y.content.timetag):ue=!1}(),Y.invalid=_e,ae?(he.syncTeamMembersResult[D]=Y,he.syncTeamMembersResult[D+"-invalid"]=_e,he.timetags["team-"+D]=O):(he.logger.info("team::onTeamMembers: not syncing, get members",D,g(Y)),y.obj={teamId:D,members:Y}),ze())});ae&&(Ce.cmd=D,he.syncTeamMembersPromiseArray.push(Ce))},m.onUpdateTeamMember=function(y){if(y.updateTime||(y.updateTime=+new Date),this.logger.info("team::onUpdateTeamMember: ",y&&y.account),this.options.onupdateteammember(v.simpleClone(y)),this.account===y.account){var O=this.myTeamMembersMap[y.teamId];this.logger.info("team::onMyTeamMembers: ",[O]),this.options.onMyTeamMembers(v.simpleClone([O]))}var D={teamId:y.teamId,memberUpdateTime:y.updateTime};this.onUpdateTeam(D);var he=this.db;he.enable&&he.updateTeamMember(y)},m.onUpdateTeam=function(y){this.logger.info("team::onUpdateTeam:",y&&y.teamId),this.options.onUpdateTeam(v.simpleClone(y));var O=this.db;O.enable&&O.updateTeam(y)},m.onSyncMyTeamMembers=function(y){var O=this,D=O.db,he=k.reverseMembers(y.content.teamMembers);if(D.enable){var ae=D.putTeamMembers(he).then(function(){return D.updateMyTeamMembersTimetag(y.content.timetag)}).catch(function(Ne){return O.logger.error("team::syncMyTeamMember: ",Ne),i.reject(Ne)});ae.cmd="myTeamMembers",O.syncTeamMembersPromiseArray.push(ae),O.syncPromiseArray.push(ae)}else O.syncResult.myTeamMembers=he;O.mergeMyTeamMembers(he)},m.mergeMyTeamMembers=function(y){v.isArray(y)||(y=[y]);var O=this.myTeamMembersMap=this.myTeamMembersMap||{};o(y).call(y,function(D){var he=D.teamId;O[he]=v.merge(O[he],D)})},m.notifyForNewTeamMsg=function(y){v.isArray(y)||(y=[y]);var O=this,D=this.myTeamMembersMap||{},he={},ae=[];o(y).call(y,function(ue){v.exist(D[ue])?he[ue]=D[ue].muteNotiType:ae.push(ue)});var Ne=i.resolve({map:he});return ae.length&&(Ne=O.api.getMyTeamMembers({teamIds:ae,promise:!0}).then(function(ue){O.mergeMyTeamMembers(ue),o(ue).call(ue,function(_e){he[_e.teamId]=_e.muteNotiType});var Y=d(y).call(y,function(_e){return!he[_e]});return i.resolve({map:he,miss:Y})}).catch(function(ue){return c(he).length>0?i.resolve({map:he,miss:ae,error:ue}):i.reject(ue)})),Ne},m.updateTeamSysMsgState=function(y,O){var D,he=y.error;he&&(O="error",he=v.filterObj(he,"code message")),D={idServer:y.obj.idServer,state:O,from:y.obj.from,type:y.obj.type},he&&(D.error=he),this.updateSysMsg(D)},m.onTeamMsgReceipt=function(y){var O=y.content,D=y.error;D&&this.logger.error("team::onTeamMsgReceipt:",D),O&&O.teamMsgReceipts&&(this.options.onTeamMsgReceipt(O),this.options.onMsgReceipts(O.teamMsgReceipts))}},function(t,r,e){var n=e(9),o=e(3),s=e(2),a=e(35).fn,i=e(0),u=i.teams2ids,d=e(307),c=e(202);a.processSuperTeam=function(m){var v,g,b,T=m.error;switch(m.obj===void 0&&(m.obj={}),m.cmd){case"sendSuperTeamMsg":this.onSendMsg(m);break;case"superTeamMsg":this.onMsg(m);break;case"sendSuperTeamCustomSysMsg":this.onSendSysMsg(m);break;case"superTeamCustomSysMsg":this.onSysMsg(m);break;case"syncSuperTeams":this.onSuperTeams(m);break;case"syncCreateSuperTeam":v=n(d).call(d,m.content.team),b=c.assembleOwner(v),this.logger.info("team::processTeam: sync createTeam",v&&v.teamId,b&&b.account),this.options.onSyncCreateSuperTeam(v,b),this.onCreateSuperTeam(v,b);break;case"getSuperTeamHistoryMsgs":case"searchSuperTeamHistoryMsgs":this.onHistoryMsgs(m);break;case"syncSendSuperTeamMsg":this.onMsg(m);break;case"addSuperTeamMembers":case"removeSuperTeamMembers":case"leaveSuperTeam":case"addSuperTeamManagers":case"removeSuperTeamManagers":case"transferSuperTeam":break;case"updateInfoInSuperTeam":T||((g=m.obj).account=this.account,g.id=c.genId(g.teamId,g.account),g=n(c).call(c,g),m.obj=g,this.mergeMySuperTeamMembers(g),this.onUpdateSuperTeamMember(g));break;case"updateNickInTeam":m.obj=n(c).call(c,m.obj);break;case"syncUpdateSuperTeamMember":(g=n(c).call(c,m.content.teamMember)).account===this.account&&this.mergeMySuperTeamMembers(g),this.onUpdateSuperTeamMember(g);break;case"updateSuperTeam":m.obj=n(d).call(d,m.obj,!0);break;case"getSuperTeam":m.error||(m.obj=n(d).call(d,m.content.team));break;case"getSuperTeams":this.onSuperTeams(m);break;case"syncSuperTeamMembers":this.onSyncSuperTeamMembers(m);break;case"syncMySuperTeamMembers":this.onSyncMySuperTeamMembers(m);break;case"getSuperTeamMembers":m.error||this.onGetAllSuperTeamMembers(m);break;case"getSuperTeamMembersByJoinTime":case"getSuperTeamMembersByAccounts":case"getMutedSuperTeamMembers":m.error||this.onSuperTeamMembers(m);break;case"onDeleteSuperTeamMsg":this.onDeleteMsg(m);break;case"onSuperTeamMsgDelete":case"syncDeleteSuperTeamMsg":this.onMsgDeleted(m,!0);break;case"onMarkSuperTeamSessionAck":this.onMarkSessionAck(m);break;case"syncMarkSuperTeamSessionAck":this.syncMarkSessionAck(m);break;case"passSuperTeamApply":this.updateSuperTeamSysMsgState(m,"passed");break;case"rejectSuperTeamApply":this.updateTeamSysMsgState(m,"rejected");break;case"acceptSuperTeamInvite":this.updateTeamSysMsgState(m,"passed");break;case"rejectSuperTeamInvite":this.updateSuperTeamSysMsgState(m,"rejected")}},a.onSuperTeams=function(m){m.content=m.content||{};var v,g=this,b=g.db,T=g.packetFromSync(m),k=m.content.teams||[],y=!0,O=[],D=[];if(m.error)switch(m.error.code){case 803:m.error=null,y=!1}var he=new o(function(Ne,ue){var Y,_e;m.error?T&&ue(m.error):(function(){y&&s(k).call(k,function(Ce){(Ce=n(d).call(d,Ce)).validToCurrentUser?O.push(Ce):D.push(Ce)}),k.length?(y=!0,v=m.content.timetag):y=!1}(),b.enable?(Y=Ne,_e=ue,m.promise=new o(function(Ce,ze){function ie(){T?(ae(),Ce(),Y()):b.getSuperTeams().then(function(le){O=le,ae(),Ce(),Y()}).then(void 0,function(le){le.message="db.getSuperTeams error",le.callFunc="superTeam::afterMergeData",ze(le),_e(le)})}y?b.mergeSuperTeams(O,D,v).then(function(){ie()}).then(void 0,function(le){var Ie={callFunc:"superTeam::onSuperTeams:mergeData",message:"db.mergeSuperTeams error",event:le};ze(Ie),_e(Ie)}):(g.logger.warn("superTeam::onSuperTeams:mergeData: no teams need merge"),ie())}).then(void 0,function(Ce){throw Ce.message="merge teams data error",Ce.callFunc="superTeam::mergeData",_e(Ce),Ce})):(ae(),Ne()))}).catch(function(Ne){return g.logger.error("superTeam::onSuperTeams: ",Ne),o.reject(Ne)});function ae(){g.timetags.superTeams=v,O.invalid=D,T?(g.syncResult.superTeams=O,g.syncResult.invalidSuperTeams=D):(g.logger.info("superTeam::onSuperTeams: not in syncing, get teams",u(O)),m.obj=O)}T&&(he.cmd="superteams",g.syncPromiseArray.push(he))},a.onCreateSuperTeam=function(m,v){var g=this.db;g.enable&&(g.putSuperTeam(m),g.putSuperTeamMembers(v))},a.onGetAllSuperTeamMembers=function(m){var v=this,g=this.db,b=m.raw.ser,T=this.superTeamMembersData[b]||{},k=T.teamId||m.obj&&m.obj.teamId;if(g.enable){var y=m.content&&m.content.timetag,O=m.raw.code===200?o.all(T.pArr):o.resolve();m.promise=O.then(function(){return g.getSuperTeamMembers(k).then(function(D){y&&g.updateSuperTeamMemberTimetag(k,y),m.obj={members:D,invalid:[],teamId:k}})}).catch(function(D){return v.logger.error(D)})}else m.obj={members:T.members,invalid:T.invalid,teamId:k};this.superTeamMembersData[b]=void 0},a.onSyncSuperTeamMembers=function(m){var v,g=this.db,b=[],T=[],k=m.content.members||[],y=m.raw.ser;if(m.obj&&(v=m.obj.teamId),v||(v=m.content.teamId),s(k).call(k,function(he){(he=n(c).call(c,he)).valid?T.push(he):b.push(he)}),g.enable){this.superTeamMembersData[y]=this.superTeamMembersData[y]||{teamId:v,pArr:[]};var O=o.resolve();m.content&&m.content.isAll&&(O=g.deleteSuperTeamMembers(v));var D=O.then(function(){return g.mergeSuperTeamMembers(v,T,b)}).then(function(){return o.resolve()});this.superTeamMembersData[y].pArr.push(D)}else this.superTeamMembersData[y]=this.superTeamMembersData[y]||{teamId:v,members:[],invalid:[]},T.length&&(this.superTeamMembersData[y].members=this.api.mergeTeamMembers(this.superTeamMembersData[y].members,T)),b.length&&(this.superTeamMembersData[y].invalid=this.api.mergeTeamMembers(this.superTeamMembersData[y].invalid,b));m.raw=void 0},a.onSyncMySuperTeamMembers=function(m){var v=this,g=v.db,b=c.reverseMembers(m.content.teamMembers);if(g.enable){var T=g.putSuperTeamMembers(b).then(function(){return g.updateMySuperTeamMembersTimetag(m.content.timetag)}).catch(function(k){return v.logger.error("superTeam::syncMySuperTeamMember: ",k),o.reject(k)});v.syncPromiseArray.push(T)}else v.syncResult.mySuperTeamMembers=b;v.mergeMySuperTeamMembers(b)},a.onSuperTeamMembers=function(m,v){var g,b=this.db,T=[],k=[],y=m.content.members||[];s(y).call(y,function(O){(O=n(c).call(c,O)).valid?k.push(O):T.push(O)}),m.obj&&(g=m.obj.teamId),g||(g=m.content.teamId||k[0]&&k[0].teamId),b.enable&&!v&&b.mergeSuperTeamMembers(g,k,T),m.obj={members:k,invalid:T,teamId:g}},a.onUpdateSuperTeamMember=function(m){if(m.updateTime||(m.updateTime=+new Date),this.logger.info("superTeam::onUpdateSuperTeamMember: ",m&&m.account),this.options.onUpdateSuperTeamMember(i.simpleClone(m)),this.account===m.account){var v=this.mySuperTeamMembersMap[m.teamId];this.logger.info("superTeam::onMySuperTeamMembers: ",[v]),this.options.onMySuperTeamMembers(i.simpleClone([v]))}var g={teamId:m.teamId,memberUpdateTime:m.updateTime};this.onUpdateSuperTeam(g);var b=this.db;b.enable&&b.updateSuperTeamMember(m)},a.onUpdateSuperTeam=function(m){this.logger.info("superteam::onUpdateSuperTeam:",m&&m.teamId),this.options.onUpdateSuperTeam(i.simpleClone(m));var v=this.db;v.enable&&v.updateSuperTeam(m)},a.mergeMySuperTeamMembers=function(m){i.isArray(m)||(m=[m]);var v=this.mySuperTeamMembersMap=this.mySuperTeamMembersMap||{};s(m).call(m,function(g){var b=g.teamId;v[b]=i.merge(v[b],g)})},a.updateSuperTeamSysMsgState=function(m,v){var g,b=m.error;b&&(v="error",b=i.filterObj(b,"code message")),g={idServer:m.obj.idServer,state:v,from:m.obj.from,type:m.obj.type},b&&(g.error=b),this.updateSysMsg(g)}},function(t,r,e){var n=e(9),o=e(3),s=e(23),a=e(35).fn,i=e(0),u=e(309);a.processNotify=function(d){switch(d.cmd){case"syncOfflineNetcallMsgs":case"syncOfflineMsgs":this.onOfflineMsgs(d);break;case"batchMarkRead":break;case"syncOfflineSysMsgs":case"syncOfflineSuperTeamSysMsgs":this.onOfflineSysMsgs(d);break;case"syncRoamingMsgs":case"syncSuperTeamRoamingMsgs":this.onRoamingMsgs(d);break;case"syncOfflineFilterMsgs":this.onOfflineMsgs(d,!0);break;case"syncOfflineFilterSysMsgs":this.onOfflineSysMsgs(d,!0);break;case"syncMsgReceipts":this.onOfflineMsgReceipts(d);break;case"syncDonnop":this.onDonnop(d,!0);break;case"syncSessionAck":this.syncSessionAck(d);break;case"syncSuperTeamSessionAck":this.syncSuperTeamSessionAck(d);break;case"syncRobots":this.onRobots(d);break;case"syncBroadcastMsgs":this.onBroadcastMsgs(d);break;case"syncDeleteSuperTeamMsgOfflineRoaming":this.onDeleteMsgOfflineRoaming(d);break;case"syncDeleteMsgSelf":this.syncDeleteMsgSelf(d);break;case"syncSessionsWithMoreRoaming":this.syncSessionsWithMoreRoaming(d);break;case"syncStickTopSessions":this.syncStickTopSessions(d);break;case"syncSessionHistoryMsgsDelete":this.syncSessionHistoryMsgsDelete(d)}},a.onDonnop=function(d,c){if(!d.error){var m=this,v=m.db,g=n(u).call(u,d.content.donnop);m.mergeDonnop(g);var b=m.dbDonnop();if(c){var T=d.content.timetag;m.timetags.donnop=T,v.enable&&(b=b.then(function(){return m.db.updateDonnopTimetag(T)}).catch(function(k){return m.logger.error("notify::onDonnop: ",k),o.reject(k)})),b.cmd="donnop",m.syncPromiseArray.push(b)}else m.onPushNotificationMultiportConfigUpdate()}},a.onUpdateDonnop=function(d){if(!d.error){var c=d.obj;c&&(this.mergeDonnop(i.filterObj(c,["shouldPushNotificationWhenPCOnline"])),this.dbDonnop(),this.onPushNotificationMultiportConfigUpdate())}},a.getPushNotificationMultiportConfig=function(){return i.merge({},this.pushNotificationMultiportConfig)},a.mergeDonnop=function(d){this.pushNotificationMultiportConfig=i.merge({},this.pushNotificationMultiportConfig,d)},a.dbDonnop=function(){return this.db.enable?this.db.setDonnop(this.pushNotificationMultiportConfig):o.resolve()},a.onPushNotificationMultiportConfigUpdate=function(){var d=this;s(function(){var c=d.getPushNotificationMultiportConfig();d.logger.info("link::onPushNotificationMultiportConfigUpdate:",c),d.options.onPushNotificationMultiportConfigUpdate(c)})}},function(t,r,e){var n=e(58),o=e(2),s=e(17),a=e(3),i=e(8),u=e(5),d=e(6),c=e(10),m=e(9),v=e(138),g=e(7),b=e(23),T=e(25),k=e(52),y=e(41),O=e(59),D=e(60),he=e(61),ae=e(62),Ne=e(47),ue=e(15),Y=e(85),_e=e(86),Ce=e(70),ze=e(32);function ie(Ue,rr){var or=_e!==void 0&&Ce(Ue)||Ue["@@iterator"];if(!or){if(ze(Ue)||(or=function(mr,vr){var Tr;if(mr){if(typeof mr=="string")return le(mr,vr);var Ir=ue(Tr=Object.prototype.toString.call(mr)).call(Tr,8,-1);if(Ir==="Object"&&mr.constructor&&(Ir=mr.constructor.name),Ir==="Map"||Ir==="Set")return Y(mr);if(Ir==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ir))return le(mr,vr)}}(Ue))||rr&&Ue&&typeof Ue.length=="number"){or&&(Ue=or);var Pt=0,Et=function(){};return{s:Et,n:function(){return Pt>=Ue.length?{done:!0}:{done:!1,value:Ue[Pt++]}},e:function(mr){throw mr},f:Et}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var kt,er=!0,cr=!1;return{s:function(){or=or.call(Ue)},n:function(){var mr=or.next();return er=mr.done,mr},e:function(mr){cr=!0,kt=mr},f:function(){try{er||or.return==null||or.return()}finally{if(cr)throw kt}}}}function le(Ue,rr){(rr==null||rr>Ue.length)&&(rr=Ue.length);for(var or=0,Pt=new Array(rr);or<rr;or++)Pt[or]=Ue[or];return Pt}function Ie(Ue,rr){var or=u(Ue);if(O){var Pt=O(Ue);rr&&(Pt=s(Pt).call(Pt,function(Et){return D(Ue,Et).enumerable})),or.push.apply(or,Pt)}return or}var pe=e(35).fn,qe=e(0),$e=qe.undef,Lt=e(44),Dt=e(150),dr=e(202),pr=e(152),sr=e(290),hr=e(13),Fe=e(74),nr=e(72);function ir(Ue,rr,or){var Pt=this,Et=Pt.message.Message,kt=or?"offlineFilterMsgs":"offlineMsgs";if(!(rr&&rr.length>0))return a.resolve();var er=Et.getMaxTimetag(rr),cr=rr[0].scene,mr=rr[0].target;Pt.markMsgRead(rr),rr=Et.deduplication(rr),rr=Et.sortMsgs(rr);var vr=Pt.genSessionByMsgs(rr);Pt.cacheSyncedSession(vr);var Tr=Pt.putMsg(rr,"offlineMsgs").then(function(Ir){var kr=Ir;(kr=Pt.filterIgnore(kr)).length&&(Pt.logger.info("msg::onOfflineMsgs toreLastSession",kt,Ue,kr.length),Pt.syncResult[kt]=Pt.syncResult[kt]||[],Pt.syncResult[kt].push({sessionId:Ue,scene:cr,to:mr,msgs:kr,timetag:er}))}).catch(function(Ir){return Pt.logger.error("msg::onOfflineMsgs: ",Ir),a.reject(Ir)});return Tr.cmd="offlineMsgs-"+Ue,Tr}pe.processMsg=function(Ue){switch(Ue.cmd){case"sendMsg":this.onSendMsg(Ue);break;case"msg":this.onMsg(Ue);break;case"sysMsg":this.onSysMsg(Ue);break;case"broadcastMsg":this.onBroadcastMsg(Ue);break;case"sendCustomSysMsg":this.onSendSysMsg(Ue);break;case"getHistoryMsgs":case"searchHistoryMsgs":this.onHistoryMsgs(Ue);break;case"msgFtsInServer":case"msgFtsInServerByTiming":this.onmsgFtsInServer(Ue);break;case"syncSendMsg":this.onMsg(Ue);break;case"deleteSessions":this.onDeleteSessions(Ue);break;case"sendMsgReceipt":this.onSendMsgReceipt(Ue);break;case"msgReceipt":this.onMsgReceipt(Ue);break;case"onDeleteMsg":this.onDeleteMsg(Ue);break;case"onMsgDeleted":this.onMsgDeleted(Ue);break;case"onDeleteMsgOfflineRoaming":this.onDeleteMsgOfflineRoaming(Ue);break;case"onMarkSessionAck":this.onMarkSessionAck(Ue);break;case"syncMarkSessionAck":this.syncMarkSessionAck(Ue);break;case"syncUpdateServerSession":this.onSyncUpdateServerSession(Ue);break;case"deleteMsgSelf":this.deleteMsgSelf(Ue);break;case"deleteMsgSelfBatch":this.deleteMsgSelfBatch(Ue);break;case"onDeleteMsgSelf":this.onDeleteMsgSelf(Ue);break;case"onDeleteMsgSelfBatch":this.onDeleteMsgSelfBatch(Ue);break;case"clearServerHistoryMsgs":this.clearServerHistoryMsgs(Ue);break;case"onClearServerHistoryMsgs":this.onClearServerHistoryMsgs(Ue)}},pe.checkIgnore=function(Ue){var rr=this;o(Ue).call(Ue,function(or){if(!or.ignore){try{rr.options.shouldIgnoreMsg(or)&&(or.ignore=!0)}catch(Et){throw rr.logger.error("userOption:shouldIgnoreMsg function error",Et),Et}var Pt;try{Pt=rr.options.shouldIgnoreNotification(or)}catch(Et){throw rr.logger.error("userOption:shouldIgnoreNotification function error",Et),Et}or.type==="notification"&&Pt&&(or.ignore=!0)}})},pe.filterIgnore=function(Ue){return s(Ue).call(Ue,function(rr){return!rr.ignore})},pe.genSessionByMsgs=function(Ue){return this.checkIgnore(Ue),pr.genSessionByMsgs(this.message.Message,Ue)},pe.onRoamingMsgs=function(Ue){var rr=this,or=rr.message,Pt=or.Message,Et=Pt.getMaxTimetag,kt=or.reverseMsgs(Ue.content.msgs),er=Et(kt);kt=Pt.deduplication(kt);var cr=(kt=Pt.sortMsgs(kt))[0],mr=cr.sessionId,vr=rr.genSessionByMsgs(kt);rr.cacheSyncedSession(vr);var Tr=rr.putMsg(kt,"roamingMsgs").then(function(Ir){var kr=(kt=Ir).length,Ar=(kt=rr.filterIgnore(kt)).length;kr!==Ar&&rr.logger.info("msg::onRoamingMsgs msg length before filter: "+kr+" after filter: "+Ar),kt.length&&(rr.logger.info("msg::onRoamingMsgs: putRoamingMsgs",mr,kt.length),rr.syncResult.roamingMsgs=rr.syncResult.roamingMsgs||[],rr.syncResult.roamingMsgs.push({sessionId:mr,scene:cr.scene,to:cr.target,msgs:kt,timetag:er}),rr.syncing||rr.onSyncDone())}).catch(function(Ir){return rr.logger.error("msg::onRoamingMsgs: ",Ir),a.reject(Ir)});Tr.cmd="roamingMsgs-"+mr,rr.syncPromiseArray.push(Tr)},pe.onOfflineMsgs=function(Ue,rr){var or,Pt=this,Et=this.message,kt=null;rr&&(kt={filter:!0});var er=Et.reverseMsgs(Ue.content.msgs,{modifyObj:kt});er=nr.deduplication(er);var cr={};o(er).call(er,function(Tr){cr[Tr.sessionId]=cr[Tr.sessionId]||[],cr[Tr.sessionId].push(Tr)});var mr=i(or=u(cr)).call(or,function(Tr){return{sessionId:Tr,msgs:cr[Tr]}}),vr=qe.asyncPool(50,mr,function(Tr){return ir.call(Pt,Tr.sessionId,Tr.msgs,rr)});this.syncPromiseArray.push(vr)},pe.completeMsg=function(Ue){return Ue.from=this.account,Ue.fromNick=this.myInfo&&this.myInfo.nick,Ue.fromClientType="Web",Ue.fromDeviceId=Lt.deviceId,Ue.time||(Ue.time=+new Date),Ue},pe.amendMsg=function(Ue){if(Ue.scene==="team"){var rr=qe.get(this.myTeamMembersMap,Ue.to+".nickInTeam");rr&&(Ue.fromNick=rr)}else if(Ue.scene==="superTeam"){var or=qe.get(this.mySuperTeamMembersMap,Ue.to+".nickInTeam");or&&(Ue.fromNick=or)}return Ue},pe.onMsgs=function(Ue){var rr=this,or=rr.reporterHook.getSafeClock(),Pt=rr.message.reverseMsgs(Ue.content.msgs,{mapper:function(Et){var kt=function(er){for(var cr=1;cr<arguments.length;cr++){var mr,vr,Tr=arguments[cr]!=null?arguments[cr]:{};cr%2?o(mr=Ie(Object(Tr),!0)).call(mr,function(Ir){n(er,Ir,Tr[Ir])}):he?ae(er,he(Tr)):o(vr=Ie(Object(Tr))).call(vr,function(Ir){Ne(er,Ir,D(Tr,Ir))})}return er}({},Et);if(kt.__receiveTime=Ue.__receiveTime,kt.__handleTime=or,kt.__clientExt)try{kt.__clientExt=JSON.parse(kt.__clientExt)}catch{rr.logger.warn("IMProtocolFn:onMsg __clientExt parse failed ".concat(kt.__clientExt))}return rr.handleMsg(kt),kt}});rr.pushMsgDelay(Pt)},pe.onMsg=function(Ue,rr){var or;if(Ue.content.msg.attach){var Pt=null;try{Pt=JSON.parse(Ue.content.msg.attach)}catch{}if(Pt&&Pt.url&&qe.get(this.mixStorePolicy,"s3Policy.dlcdns")){var Et,kt=ie(this.mixStorePolicy.s3Policy.dlcdns);try{for(kt.s();!(Et=kt.n()).done;){var er,cr=Et.value;d(er=Pt.url).call(er,cr)>=0&&(Pt.isS3=!0,cr!==this.mixStorePolicy.s3Policy.dlcdn&&(Pt.url=Pt.url.replace(cr,this.mixStorePolicy.s3Policy.dlcdn)))}}catch(vr){kt.e(vr)}finally{kt.f()}}Ue.content.msg.attach=c(Pt)}var mr=m(or=this.message).call(or,Ue.content.msg);if(mr.__receiveTime=Ue.__receiveTime,mr.__handleTime=this.reporterHook.getSafeClock(),qe.get(Ue,"content.msg.__clientExt"))try{mr.__clientExt=JSON.parse(Ue.content.msg.__clientExt)}catch{this.logger.warn("IMProtocolFn:onMsg __clientExt parse failed ".concat(Ue.content.msg.__clientExt))}rr&&(mr.filter=!0),Ue.cmd!=="syncSendMsg"||mr.from!==mr.to?(this.pushMsgDelay([mr]),this.syncing?(this.logger.info("msg::onMsg:is in syncing ..."),this.unhandledMsgs.push({type:"onMsg",msg:mr})):this.handleMsg(mr)):this.logger.warn("onMsg::syncSendMsg to self, so ignore",mr.idClient,mr.idServer)},pe.onBroadcastMsgs=function(Ue){var rr=Ue.content.broadcastMsgs;rr=v(rr).call(rr,function(or,Pt){return or.broadcastId-Pt.broadcastId}),this.putBroadcastMsgs(rr)},pe.onBroadcastMsg=function(Ue){var rr=Ue.content.broadcastMsg;rr.time=rr.timestamp,this.syncing?this.unhandledMsgs.push({type:"onBroadcastMsg",msg:rr}):rr&&this.putBroadcastMsg(rr)},pe.pushMsgTask=function(Ue){this.msgPromise=this.msgPromise.then(function(){return Ue()})},pe.pushMsgDelay=function(Ue){if(Ue&&Ue.length>0){var rr=this;if(rr.msgStatEnable&&!hr.isWeixinApp){var or,Pt=i(Ue).call(Ue,function(Et){return{appkey:rr.options.appKey,accid:Et.to,fromAccid:Et.from,msgId:Et.idServer,serverTime:Et.time,receiveTime:rr.reporterHook.getNTPTime(),sessionId:rr.sdkSession,platform:"web",sdk_ver:hr.info.version,manufactor:Fe.name+" "+Fe.version}});rr.msgDelayArr=g(or=rr.msgDelayArr).call(or,Pt),rr.msgDelayArr.length>5&&rr.doReportMsgDelay()}}},pe.doReportMsgDelay=function(){var Ue,rr=c(this.msgDelayArr);this.msgDelayArr&&this.msgDelayArr.length>0&&(sr.sendBeacon("https://statistic.live.126.net/statics/report/im/sdk/msgreceived",rr),this.msgDelayArr=[]),this.msgDelayTimer&&clearTimeout(this.msgDelayTimer),this.socket&&(this.msgDelayTimer=b(T(Ue=this.doReportMsgDelay).call(Ue,this),1e4))},pe.handleMsg=function(Ue){var rr=this,or=rr.db,Pt=Ue.time;rr.markMsgRead(Ue),rr.msgPromise=rr.msgPromise.then(function(){return rr.putMsg(Ue,"onMsg")}).then(function(){var Et;return rr.logger.info(g(Et="msg::handleMsg:putMsg: done ".concat(Ue.idServer," ")).call(Et,Ue.idClient)),or.enable?Ue.scene==="superTeam"?or.updateSuperTeamRoamingMsgTimetag(Pt):or.updateRoamingMsgTimetag(Pt):(rr.timetags[Ue.scene==="superTeam"?"superTeamRoamingMsgs":"roamingMsgs"]=Pt,a.resolve())}).then(function(){if(Ue)return rr.checkUserUpdate(Ue)}).then(function(){if(Ue){var Et=Ue.type;switch(rr.logger.info("msg::handleMsg:checkUserUpdate: "+Ue.scene+" "+Et+" msg"+(Et==="notification"?" "+Ue.attach.type:"")),Et){case"notification":return rr.onTeamNotificationMsg(Ue)}}}).then(function(){Ue&&!Ue.ignore&&(rr.logger.info("msg::handleMsg:onmsg: ",Ue.idClient,Ue.idServer),b(function(){var Et=Ue.scene==="p2p";if(hr.isBrowser&&Ue.flow!=="out"){var kt={msgId:Ue.idServer,clientId:Ue.idClient,receiveTime:rr.reporterHook.getNTPTime(Ue.__receiveTime),serverTime:Ue.time,callbackTime:rr.reporterHook.getNTPTime(),preHandleTime:rr.reporterHook.getNTPTime(Ue.__handleTime),fromAccid:Ue.from,toAccid:rr.options.account,type:rr.message.sceneMap[Ue.scene],tid:Et?"":Ue.to,result:200,failReason:"",rt:k(rr.reporterHook.getSafeClock()-Ue.__receiveTime)},er=qe.get(Ue,"__clientExt.statistics.apiCallingTime"),cr=qe.get(Ue,"__clientExt.statistics.sendTime");er&&cr&&(kt.apiCallingTime=er,kt.sendTime=cr,kt.attachUploadDuration=qe.get(Ue,"__clientExt.statistics.attachUploadDuration")||0),rr.reporter&&rr.reporter.report("msgReceive",kt)}delete Ue.__receiveTime,delete Ue.__handleTime,delete Ue.__clientExt,rr.options.onmsg(qe.copy(Ue))},0))}).catch(function(Et){Et.callFunc="msg::handleMsg",rr.onCustomError("",Et)})},pe.putMsg=function(Ue,rr){if(qe.isArray(Ue)||(Ue=[Ue]),s(Ue[0]))return a.resolve(Ue);var or,Pt=this,Et=Pt.db,kt=Et.enable,er=a.resolve(),cr=Pt.message.Message.getLastMsg(Ue),mr=cr.flow,vr=Pt.genSessionByMsgs(Ue);Ir(vr);var Tr=[];function Ir(kr){rr!=="roamingMsgs"&&rr!=="offlineMsgs"||Pt.cacheSyncedSession(kr)}return er=(er=(er=er.then(function(){var kr;return kt||Pt.options.autoMarkRead||rr==="roamingMsgs"||!vr||(Pt.sessionUnreadMsgs=Pt.sessionUnreadMsgs||{},Pt.sessionUnreadMsgs[vr.id]=Pt.sessionUnreadMsgs[vr.id]||[],Pt.sessionUnreadMsgs[vr.id]=g(kr=Pt.sessionUnreadMsgs[vr.id]).call(kr,s(Ue).call(Ue,function(Ar){try{return Pt.options.shouldCountNotifyUnread(Ar)}catch(Rr){throw Pt.logger.error("userOption:shouldCountNotifyUnread function error",Rr),Rr}}))),rr==="offlineMsgs"||rr==="roamingMsgs"?a.reject(Ue):kt?Et.putMsg(Ue):Ue}).then(function(kr){var Ar=[];return o(Ue).call(Ue,function(Rr){Pt.checkMsgUnique(Rr)&&Ar.push(Rr)}),Ue=Ar,Tr=kt?kr:Ue,a.resolve(Ue)})).then(function(kr){return kr.length&&kt&&vr?new a(function(Ar){Et.getSessions({sessionId:vr.id}).then(function(Rr){if(Rr&&Rr.lastMsg){var Cn=Rr.lastMsg;vr.lastMsg&&vr.lastMsg.time<Cn.time&&(vr.lastMsg=Cn)}Tr&&Tr.length?vr?Et.putSession(vr).then(function(Or){Ar(Or)}):Ar(Rr):(Tr=kr,Ar(Rr))})}):a.resolve(vr)})).then(function(kr){if(vr&&Tr.length){or=cr.sessionId!==Pt.currSessionId;var Ar=rr==="roamingMsgs",Rr=Pt.options.syncSessionUnread,Cn=vr.id,Or=Pt.getSessionInCache(Cn,!0)||{},Pr=Or.ack||0;if(rr==="offlineMsgs"||Ar&&Rr||rr==="onMsg"&&mr==="in"&&or){var Nr;if(kt&&kr){var Qr=Or.unread||0;(vr=kr).unread=Qr,Pr=Pr||vr.ack||0}else(kr=Or)&&(vr.unread=kr.unread||0);Ir(vr),vr.unread=vr.unread||0;var hn=0;o(Tr).call(Tr,function(qr){var Gn;try{Gn=Pt.options.shouldCountNotifyUnread(qr)}catch(Lr){throw Pt.logger.error("userOption:shouldCountNotifyUnread function error",Lr),Lr}var $n=(qr.type!=="notification"||qr.type==="notification"&&Gn)&&($e(qr.isUnreadable)||qr.isUnreadable);if($n&&Rr&&($n=qr.time>Pr&&qr.flow!=="out"),$n&&(hn++,Rr&&!kt)){var Jr=Or.unreadMsgs||[];Jr.push(qr),vr.unreadMsgs=Jr}}),vr.unread+=hn;var Ur=qe.secureOutput("session",vr);if(Ur.unreadMsgs&&(Ur.unreadMsgs=i(Nr=Ur.unreadMsgs).call(Nr,function(qr){return qr&&qr.idServer})),Pt.logger.info("msg::putMsg:updateSession: ",Ur),Ir(vr),kt)return Et.updateSession({id:vr.id,unread:vr.unread})}}}),rr==="onMsg"&&(er=er.then(function(){Ue.length&&vr&&(Pt.onUpdateSession(vr),Pt.options.syncSessionUnread&&!or&&Pt.api.resetSessionUnread(Pt.currSessionId))})),er.then(function(){return a.resolve(Ue)}).catch(function(kr){return kr&&kr.length?a.resolve(kr):a.reject(kr)})},pe.putBroadcastMsgs=function(Ue){var rr=this,or=rr.db,Pt=Ue.length;if(Pt>0){if(rr.doMarkBroadcastMsgsRead(Ue),or.enable){var Et=Ue[Pt-1].broadcastId;return or.updateBroadcastMsgTimetag(Et),or.putBroadcastMsg(Ue).then(function(){return b(function(){rr.doMarkMsgsRead(),rr.options.onbroadcastmsgs(qe.copy(Ue))},0),a.resolve(Ue)})}b(function(){rr.options.onbroadcastmsgs(qe.copy(Ue))},0)}return Ue},pe.putBroadcastMsg=function(Ue){var rr=this,or=rr.db;return rr.doMarkBroadcastMsgsRead([Ue]),or.enable?(Ue.broadcastId&&or.updateBroadcastMsgTimetag(Ue.broadcastId),or.putBroadcastMsg(Ue).then(function(){return b(function(){rr.options.onbroadcastmsg(qe.copy(Ue))},0),a.resolve(Ue)})):(b(function(){rr.options.onbroadcastmsg(qe.copy(Ue))},0),Ue)},pe.doMarkBroadcastMsgsRead=function(Ue){Ue=i(Ue).call(Ue,function(rr){return rr.broadcastId}),this.sendCmd("batchMarkRead",{sid:7,cid:17,ids:Ue})},pe.cacheSyncedSession=function(Ue){if(Ue&&this.syncResult){Ue=y({},Ue),this.syncResult.sessions=this.syncResult.sessions||{};var rr=Ue.id,or=this.syncResult.sessions[rr]||{};or&&or.ack>Ue.ack&&(Ue.ack=void 0),or&&or.msgReceiptTime>Ue.msgReceiptTime&&(Ue.msgReceiptTime=void 0);var Pt=qe.get(or,"lastMsg.time"),Et=qe.get(Ue,"lastMsg.time");Pt&&Et&&Pt>Et&&(Ue.lastMsg=or.lastMsg),this.syncResult.sessions[rr]=y(or,Ue),this.syncResult.sessions[rr]=y({},this.mergeSession(this.syncResult.sessions[rr]))}},pe.checkMsgUnique=qe.genCheckUniqueFunc("idClient"),pe.revokeMsgUniqueCheck=function(Ue){this.uniqueSet&&this.uniqueSet.idClient&&(this.uniqueSet.idClient[Ue]=!1)},pe.storeSendMsg=function(Ue){if(!this.syncing){var rr=this.putMsg(Ue,"sendMsg");return this.msgPromise=this.msgPromise.then(function(){return rr}),rr}this.unhandledMsgs.push({type:"sendMsg",msg:Ue})},pe.updateSendMsgError=function(Ue){if(!this.syncing){var rr=this.updateMsg(Ue);return this.msgPromise=this.msgPromise.then(function(){return rr}),rr}this.unupdatedMsgs.push(Ue)},pe.onSendMsg=function(Ue,rr){var or,Pt,Et=this,kt=Ue.content&&Ue.content.msg,er=Ue.obj&&Ue.obj.msg||kt;if(er)if(this.logger.warn(g(or=g(Pt="sendMsg::end: ".concat(kt&&kt.idServer," ")).call(Pt,er.idClient," ")).call(or,Ue&&Ue.raw&&Ue.raw.ser)),Ue.obj)mr();else{var cr=Et.db;cr&&cr.enable&&cr.getMsgByIdClient(er.idClient).then(function(vr){vr&&(er=vr,mr(!1))}).catch(function(){return mr()})}else this.logger.error("sendMsg::error::get msg failed, msg empty");function mr(){var vr,Tr=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];Et.completeMsg(er);var Ir=Ue.error&&Ue.error.code===7101;Ue.error&&!Ir||(er.idServer=kt.idServer,er.time=+kt.time,kt.yidunAntiSpamRes&&(er.yidunAntiSpamRes=kt.yidunAntiSpamRes),kt.callbackExt&&(er.callbackExt=kt.callbackExt)),Ir&&(er.isInBlackList=!0),Ue.error?er.status="fail":er.status="success",er=Tr?m(vr=Et.message).call(vr,er):er,er=Et.amendMsg(er),rr&&(er.filter=!0),Ue.obj=er,Et.syncing?Et.unupdatedMsgs.push(er):Et.msgPromise=a.all([Et.msgPromise,Ue.obj.promise]).then(function(kr){return kr.length||(er.resend=!0),Et.updateMsg(er).then(function(){return Et.options.syncSessionUnread&&Et.currSessionId===er.sessionId&&Et.api.resetSessionUnread(Et.currSessionId),Et.resolveMsgReceiptTask(er),er})}).catch(function(kr){Et.logger.error("onSendMsg::dealMsg error",kr)})}},pe.updateLocalMsg=function(Ue){var rr=this.updateMsg(Ue);return this.msgPromise=this.msgPromise.then(function(){return rr}),rr},pe.updateMsg=function(Ue){if(s(Ue)||this.options.shouldIgnoreMsg(Ue))return a.resolve(Ue);var rr=this,or=rr.db,Pt=Ue.status==="success",Et=pr.genSessionByMsg(Ue),kt=!!Ue.isLocal;return rr.onUpdateSession(Et),or.enable?or.updateMsg(Ue).then(function(er){var cr=or.updateSession(Et),mr=a.resolve();return Pt&&er&&!kt&&(mr=Ue.scene==="superTeam"?or.updateSuperTeamRoamingMsgTimetag(er.time):or.updateRoamingMsgTimetag(er.time)),a.all([cr,mr])}).catch(function(er){rr.logger.error("updateMsg error",er)}):(Pt&&!kt&&(rr.timetags.roamingMsgs=Ue.time),a.resolve(Ue))},pe.updateRoamingMsgTimetag=function(Ue){var rr=this.db;return rr.enable?rr.updateRoamingMsgTimetag(Ue):(this.timetags.roamingMsgs=Ue,a.resolve(Ue))},pe.checkUserUpdate=function(Ue){var rr=this,or=Ue.from;return rr.logger.info("handleMsg::checkUserUpdate: ",or,rr.account),or===rr.account?a.resolve():new a(function(Pt){var Et=rr.userSet[or];if(Et){var kt=+Et.updateTime,er=+Ue.userUpdateTime;!isNaN(kt)&&!isNaN(er)&&qe.isNumber(kt)&&qe.isNumber(er)&&kt<er?cr():Pt()}else cr();function cr(){rr.api.getUser({account:or,sync:!0,done:function(mr,vr){mr||b(function(){rr.logger.log("user::checkUserUpdate: onupdateuser",vr&&vr.account),rr.options.onupdateuser(vr)},0),Pt()}})}})},pe.processUnsettledMsgs=function(){var Ue,rr,or=this;o(Ue=or.unhandledMsgs).call(Ue,function(Pt){var Et=Pt.msg;switch(Pt.type){case"onMsg":or.handleMsg(Et);break;case"sendMsg":or.msgPromise=or.msgPromise.then(function(){return or.putMsg(Et)});break;case"onBroadcastMsg":or.msgPromise=or.msgPromise.then(function(){return or.putBroadcastMsg(Et)})}}),o(rr=or.unupdatedMsgs).call(rr,function(Pt){or.msgPromise=or.msgPromise.then(function(){return or.updateMsg(Pt)})}),or.resetUnsettledMsgs()},pe.onTeamNotificationMsg=function(Ue){var rr=Ue.attach,or=rr.type,Pt=Ue.from,Et=Ue.to,kt=Ue.time,er=rr.team,cr=rr.account,mr=rr.accounts;switch(or){case"updateTeam":return er.updateTime=kt,this.onUpdateTeam(er);case"addTeamMembers":return this.onAddTeamMembers(Ue,er,mr);case"removeTeamMembers":return this.onRemoveTeamMembers(er,Et,mr);case"acceptTeamInvite":return this.onAddTeamMembers(Ue,er,[Pt]);case"passTeamApply":return this.onAddTeamMembers(Ue,er,[cr]);case"addTeamManagers":return this.updateTeamManagers(Ue,Et,mr,!0,kt);case"removeTeamManagers":return this.updateTeamManagers(Ue,Et,mr,!1,kt);case"leaveTeam":return this.onRemoveTeamMembers(er,Et,[Pt]);case"dismissTeam":return this.onDismissTeam(Et,kt);case"transferTeam":return this.transferTeam(Ue,er,Pt,cr);case"updateTeamMute":return this.onUpdateTeamMembersMute(Ue,er,[cr],rr.mute);case"updateSuperTeam":return er.updateTime=kt,this.onUpdateSuperTeam(er);case"acceptSuperTeamInvite":return this.onAddSuperTeamMembers(Ue,er,[Ue.from]);case"addSuperTeamMembers":return this.onAddSuperTeamMembers(Ue,er,mr);case"passSuperTeamApply":return this.onAddSuperTeamMembers(Ue,er,[cr]);case"removeSuperTeamMembers":return this.onRemoveSuperTeamMembers(er,Et,mr);case"leaveSuperTeam":return this.onRemoveSuperTeamMembers(er,Et,[Pt]);case"dismissSuperTeam":return this.onDismissSuperTeam(Et,kt);case"transferSuperTeam":return this.transferSuperTeam(Ue,er,Pt,cr);case"addSuperTeamManagers":return this.updateSuperTeamManagers(Ue,Et,mr,!0,kt);case"removeSuperTeamManagers":return this.updateSuperTeamManagers(Ue,Et,mr,!1,kt);case"updateSuperTeamMembersMute":return this.onUpdateSuperTeamMembersMute(Ue,er,mr,rr.mute)}},pe.onAddSuperTeamMembers=function(Ue,rr,or){var Pt=this.db,Et=dr.assembleMembers(rr,or);Ue.attach.members=Et;var kt={team:rr,accounts:or,members:Et};if(this.logger.info("team::onAddSuperTeamMembers: ".concat(kt.team.teamId,", "),kt.accounts),this.options.onAddSuperTeamMembers(qe.simpleClone(kt)),Pt.enable){var er=Pt.putSuperTeamMembers(Et),cr=Pt.putSuperTeam(rr);return a.all([er,cr])}},pe.onRemoveSuperTeamMembers=function(Ue,rr,or){var Pt=this.db,Et={team:Ue,teamId:rr,accounts:or};if(this.logger.info("team::onRemoveSuperTeamMembers: ".concat(rr,", "),Et.accounts),this.options.onRemoveSuperTeamMembers&&this.options.onRemoveSuperTeamMembers(qe.simpleClone(Et)),Ue&&Pt.enable){if(d(or).call(or,this.account)===-1){var kt=Pt.removeSuperTeamMembersByAccounts(rr,or),er=a.resolve();return Ue&&(er=Pt.putSuperTeam(Ue)),a.all([kt,er])}return Pt.leaveSuperTeam(rr)}},pe.onDismissSuperTeam=function(Ue,rr){var or=this.db,Pt={teamId:Ue};if(this.logger.info("team::onDismissSuperTeam:",Ue),this.options.onDismissSuperTeam(Pt),or.enable)return or.dismissSuperTeam(Ue,rr)},pe.onAddTeamMembers=function(Ue,rr,or){var Pt=this,Et=Pt.db,kt=rr.teamId,er=Dt.assembleMembers(rr,or);Ue.attach.members=er;var cr={team:rr,accounts:or,members:er};if(Pt.logger.info("team::onAddTeamMembers: ",kt,or),Pt.options.onAddTeamMembers(qe.simpleClone(cr)),Et.enable){var mr,vr=Et.putTeam(rr);return d(or).call(or,Pt.account)===-1?mr=Et.putTeamMembers(er):(Pt.logger.log("team::onAddTeamMembers: user join team",kt),vr=new a(function(Tr){Pt.api.getTeamMembers({teamId:kt,sync:!0,done:function(){Tr()}})})),a.all([mr,vr])}},pe.onRemoveTeamMembers=function(Ue,rr,or){var Pt=this.db,Et={team:Ue,teamId:rr,accounts:or};if(this.logger.info("team::onRemoveTeamMembers: ".concat(rr),or),this.options.onRemoveTeamMembers(qe.simpleClone(Et)),Ue&&Pt.enable){if(d(or).call(or,this.account)===-1){var kt=Pt.removeTeamMembersByAccounts(rr,or),er=a.resolve();return Ue&&(er=Pt.putTeam(Ue)),a.all([kt,er])}return Pt.leaveTeam(rr)}},pe.updateTeamManagers=function(Ue,rr,or,Pt,Et){var kt=this.db,er=Ue.attach.members=i(or).call(or,function(Ir){return{id:Dt.genId(rr,Ir),type:Pt?"manager":"normal",updateTime:Et,account:Ir}}),cr={teamId:""+rr,memberUpdateTime:Et};Ue.attach.team=cr;var mr={team:cr,accounts:or,isManager:Pt,members:er};if(this.logger.info("team::updateTeamManagers:",rr,or,Pt),this.options.onUpdateTeamManagers(qe.simpleClone(mr)),kt.enable){var vr=kt.updateTeam(cr),Tr=kt.updateTeamManagers(rr,or,Pt,Et);return a.all([vr,Tr])}},pe.updateSuperTeamManagers=function(Ue,rr,or,Pt,Et){var kt=this.db,er=Ue.attach.members=i(or).call(or,function(Ir){return{id:Dt.genId(rr,Ir),teamId:rr,account:Ir,type:Pt?"manager":"normal",updateTime:Et}}),cr={teamId:""+rr,memberUpdateTime:Et};Ue.attach.team=cr;var mr={team:cr,accounts:or,isManager:Pt,members:er};if(this.logger.info("team::updateSuperTeamManagers:",rr,or,Pt),this.options.onUpdateSuperTeamManagers(qe.simpleClone(mr)),kt.enable){var vr=kt.updateSuperTeam(cr),Tr=kt.updateSuperTeamMembers(er);return a.all([vr,Tr])}},pe.onDismissTeam=function(Ue,rr){var or=this.db,Pt={teamId:Ue};if(this.logger.info("team::onDismissTeam:",Ue),this.options.onDismissTeam(Pt),or.enable)return or.dismissTeam(Ue,rr)},pe.transferTeam=function(Ue,rr,or,Pt){var Et=this.db,kt=rr.teamId,er=rr.memberUpdateTime,cr={id:Dt.genId(kt,or),type:"normal",updateTime:er},mr={id:Dt.genId(kt,Pt),type:"owner",updateTime:er};Ue.attach.members=[cr,mr];var vr={team:rr,from:cr,to:mr};if(this.logger.info("team::transferTeam: from to",kt,or,Pt),this.options.onTransferTeam(qe.simpleClone(vr)),Et.enable)return Et.transferTeam(rr,or,Pt)},pe.transferSuperTeam=function(Ue,rr,or,Pt){var Et=this.db,kt=rr.teamId,er=rr.memberUpdateTime,cr={teamId:kt,type:"normal",account:or,updateTime:er},mr={teamId:kt,type:"owner",account:Pt,updateTime:er};Ue.attach.members=[cr,mr];var vr={team:rr,from:cr,to:mr};if(this.logger.info("team::transferSuperTeam: from to ",kt,or,Pt),this.options.onTransferSuperTeam(qe.simpleClone(vr)),Et.enable)return Et.transferSuperTeam(rr,cr,mr)},pe.onUpdateTeamMembersMute=function(Ue,rr,or,Pt){var Et=this.db,kt=i(or).call(or,function(vr){return{id:Dt.genId(rr.teamId,vr),account:vr,teamId:rr.teamId,mute:Pt,updateTime:rr.memberUpdateTime}});Ue.attach.members=kt;var er={team:rr,accounts:or,members:kt,mute:Pt};if(this.logger.info("team::onUpdateTeamMembersMute:",rr.teamId,or,Pt),this.options.onUpdateTeamMembersMute(qe.simpleClone(er)),Et.enable){var cr=Et.updateTeamMembers(kt),mr=Et.putTeam(rr);return a.all([cr,mr])}},pe.onUpdateSuperTeamMembersMute=function(Ue,rr,or,Pt){var Et=this.db,kt=i(or).call(or,function(vr){return{id:dr.genId(rr.teamId,vr),account:vr,teamId:rr.teamId,mute:Pt,updateTime:rr.memberUpdateTime}});Ue.attach.members=kt;var er={team:rr,accounts:or,members:kt,mute:Pt};if(this.logger.info("team::onUpdateSuperTeamMembersMute:",rr.teamId,or,Pt),this.options.onUpdateSuperTeamMembersMute(qe.simpleClone(er)),Et.enable){var cr=Et.updateSuperTeamMembers(kt),mr=Et.putSuperTeam(rr);return a.all([cr,mr])}},pe.onHistoryMsgs=function(Ue){Ue.error||(Ue.obj.msgs=this.message.reverseMsgs(Ue.content.msgs))},pe.onmsgFtsInServer=function(Ue){if(!Ue.error){var rr=this.message.reverseMsgs(Ue.content.msgs);Ue.obj.msgs=rr,Ue.content.msgs=rr}},pe.isFilterMsgs=function(Ue){return!!s(Ue[0])},pe.splitMsgs=function(Ue,rr,or,Pt){o(Ue).call(Ue,function(Et){if(s(Et))Pt.push(Et);else switch(Et.scene){case"p2p":rr.push(Et);break;case"team":or.push(Et)}})},pe.markMsgRead=function(Ue,rr){if(qe.isArray(Ue)||(Ue=[Ue]),this.db.enable||this.options.autoMarkRead||rr){var or=i(Ue).call(Ue,function(Pt){return{flag:"msg",idServer:Pt.idServer,scene:Pt.scene,filter:s(Pt),type:Pt.type,attachType:Pt.attach&&Pt.attach.type}});this.msgAckBufferManager.add(or)}},pe.markSysMsgRead=function(Ue,rr){if(qe.isArray(Ue)||(Ue=[Ue]),this.db.enable||this.options.autoMarkRead||rr){var or=i(Ue).call(Ue,function(Pt){return{flag:"systemMsg",idServer:Pt.idServer,scene:Pt.scene,filter:s(Pt),type:Pt.type}});this.msgAckBufferManager.add(or)}},pe.handleMsgsAck=function(Ue){var rr,or=this,Pt={p2pSysMsgs:{sid:7,cid:3,msgs:[]},p2pMsgs:{sid:7,cid:2,msgs:[]},superTeamSysMsgs:{sid:21,cid:19,msgs:[]},teamMsgs:{sid:8,cid:3,msgs:[]},filterSysMsgs:{sid:101,cid:3,msgs:[]},filterMsgs:{sid:101,cid:2,msgs:[]},netcallMsgs:{sid:9,cid:11,msgs:[]}};o(Ue).call(Ue,function(Et){/^(netcallBill|netcallMiss|netcallReject)$/.test(Et.attachType)?Pt.netcallMsgs.msgs.push(Et):s(Et)?Et.flag==="systemMsg"?Pt.filterSysMsgs.msgs.push(Et):Pt.filterMsgs.msgs.push(Et):Et.flag!=="systemMsg"?Et.scene==="p2p"?Pt.p2pMsgs.msgs.push(Et):Et.scene==="team"&&Pt.teamMsgs.msgs.push(Et):Et.scene==="superTeam"?Pt.superTeamSysMsgs.msgs.push(Et):Pt.p2pSysMsgs.msgs.push(Et)}),o(rr=u(Pt)).call(rr,function(Et){return or.doMarkMsgsRead(Pt[Et].sid,Pt[Et].cid,Pt[Et].msgs)})},pe.doMarkMsgsRead=function(Ue,rr,or){or&&or.length&&(this.logger.log("markMsgRead::batchMarkRead",Ue,rr,or),this.sendCmd("batchMarkRead",{sid:Ue,cid:rr,ids:i(or).call(or,function(Pt){return Pt.idServer})}))}},function(t,r,e){var n=e(58),o=e(9),s=e(2),a=e(5),i=e(17),u=e(3),d=e(41),c=e(59),m=e(60),v=e(61),g=e(62),b=e(47);function T(Ne,ue){var Y=a(Ne);if(c){var _e=c(Ne);ue&&(_e=i(_e).call(_e,function(Ce){return m(Ne,Ce).enumerable})),Y.push.apply(Y,_e)}return Y}function k(Ne){for(var ue=1;ue<arguments.length;ue++){var Y,_e,Ce=arguments[ue]!=null?arguments[ue]:{};ue%2?s(Y=T(Object(Ce),!0)).call(Y,function(ze){n(Ne,ze,Ce[ze])}):v?g(Ne,v(Ce)):s(_e=T(Object(Ce))).call(_e,function(ze){b(Ne,ze,m(Ce,ze))})}return Ne}var y=e(35).fn,O=e(751),D=e(753);function he(Ne,ue,Y){var _e=this,Ce=this.timetags&&this.timetags.sync;this.db.enable&&Ce&&ue&&this.db.getMsgByIdClient(Ne).then(function(ze){if(ze&&!(ze.commentTimetag&&ze.commentTimetag<=Ce&&ze.time<=Ce)){if(ze.commentTimetag=ue.time,ze.comments=ze.comments||[],Y){var ie;ze.comments=i(ie=ze.comments).call(ie,function(qe){return qe.body!==ue.body||qe.from!==ue.from})}else{for(var le,Ie=0;Ie<ze.comments.length;Ie++)if(ze.comments[Ie].from===ue.from&&ze.comments[Ie].body===ue.body){ze.comments[Ie]=ue,le=!0;break}le||ze.comments.push(ue)}var pe={idClient:ze.idClient,comments:ze.comments,commentTimetag:ze.commentTimetag};_e.db.updateMsg(pe)}})}function ae(Ne){Ne.scene=this.message.sceneReverseMap[+Ne.scene]||Ne.scene,Ne.time=+Ne.time}y.processMsgExtend=function(Ne){switch(Ne.cmd){case"getThreadMsgs":this.onGetThreadMsgs(Ne);break;case"getMsgsByIdServer":this.onGetMsgsByIdServer(Ne);break;case"addQuickComment":this.changeQuickComment(Ne);break;case"deleteQuickComment":this.changeQuickComment(Ne,!0);break;case"onQuickComment":case"syncAddQuickComment":this.onQuickComment(Ne);break;case"onDeleteQuickComment":case"syncDeleteQuickComment":this.onQuickComment(Ne,!0);break;case"getQuickComments":this.getQuickComments(Ne);break;case"addCollect":case"updateCollect":this.addCollect(Ne);break;case"deleteCollects":this.deleteCollects(Ne);break;case"getCollects":this.getCollects(Ne);break;case"addStickTopSession":case"syncAddStickTopSession":this.onChangeStickTopSession(Ne,"add");break;case"updateStickTopSession":case"syncUpdateStickTopSession":this.onChangeStickTopSession(Ne,"update");break;case"deleteStickTopSession":case"syncDeleteStickTopSession":this.onChangeStickTopSession(Ne,"delete");break;case"addMsgPin":case"onAddMsgPin":case"syncAddMsgPin":this.pinMsgChange(Ne,"add");break;case"updateMsgPin":case"onUpdateMsgPin":case"syncUpdateMsgPin":this.pinMsgChange(Ne,"update");break;case"deleteMsgPin":case"onDeleteMsgPin":case"syncDeleteMsgPin":this.pinMsgChange(Ne,"delete");break;case"getMsgPins":this.getMsgPins(Ne)}},y.onGetThreadMsgs=function(Ne){if(!Ne.error){var ue;Ne.obj.msgs=this.message.reverseMsgs(Ne.content.msgs),Ne.obj.threadMsg=o(ue=this.message).call(ue,Ne.content.threadMsg);var Y=Ne.content.threadMsgsMeta||{};Ne.obj.total=Y.total,Ne.obj.timetag=Y.lastMsgTime}},y.onGetMsgsByIdServer=function(Ne){Ne.error||(Ne.obj.msgs=this.message.reverseMsgs(Ne.content.msgs))},y.changeQuickComment=function(Ne,ue){Ne.error||(Ne.obj.comment.time=Ne.content.timetag,Ne.obj.comment=o(O).call(O,Ne.obj.comment),ae.call(this,Ne.obj.msg),he.call(this,Ne.obj.msg.idClient,Ne.obj.comment,ue))},y.onQuickComment=function(Ne,ue){if(Ne.content){var Y=Ne.content,_e=Y.comment,Ce=Y.msg;_e&&Ce&&(ae.call(this,Ce),_e=o(O).call(O,_e),ue?this.options.onDeleteQuickComment(Ne.content.msg,_e):this.options.onQuickComment(Ne.content.msg,_e),he.call(this,Ce.idClient,_e,ue))}},y.getQuickComments=function(Ne){var ue,Y=this;if(!Ne.error){var _e=Ne.obj.idMap,Ce=Ne.obj.indexMap,ze=Ne.content&&Ne.content.commentRes||[];s(ze).call(ze,function(ie){var le=[],Ie=Y.parser.unserializeMap.comment;if(+ie.modify==1)try{le=JSON.parse(ie.detail)}catch(qe){Y.logger.warn("getQuickComments parse detail error",qe)}if(s(le).call(le,function(qe,$e){var Lt,Dt={};s(Lt=a(qe)).call(Lt,function(dr){Dt[Ie[dr]]=qe[dr]}),Dt=o(O).call(O,Dt),le[$e]=Dt}),ie.timestamp=+ie.timestamp,_e[ie.idClient]){var pe={idClient:ie.idClient,commentTimetag:ie.timestamp};_e[ie.idClient].commentTimetag=ie.timestamp,+ie.modify==1&&(_e[ie.idClient].comments=le,pe.comments=le),Y.db.enable&&Y.db.updateMsg(pe)}else _e[ie.idClient]={idServer:ie.idServer,idClient:ie.idClient,comments:le,commentTimetag:ie.timestamp,scene:Y.message.sceneReverseMap[ie.scene]||ie.scene}}),Ne.obj=[],s(ue=a(Ce)).call(ue,function(ie){Ne.obj[Ce[ie]]=_e[ie]})}},y.addCollect=function(Ne){Ne.error||(Ne.obj.collect=o(D).call(D,Ne.content.collect))},y.deleteCollects=function(Ne){Ne.error||(Ne.obj.deleteNum=Ne.content.deleteNum)},y.getCollects=function(Ne){if(!Ne.error){var ue=[],Y=Ne.content.collectList||[];s(Y).call(Y,function(_e){ue.push(o(D).call(D,_e))}),Ne.obj.collectList=ue,Ne.obj.total=Ne.content.total}},y.onChangeStickTopSession=function(Ne,ue){var Y=this;if(!Ne.error){var _e=Ne.content.stickTopSession||Ne.obj.stickTopSession||{},Ce=Ne.content.timetag||+_e.updateTime,ze=_e.id.split("|");ze[0]==="super_team"&&(ze[0]="superTeam"),_e={id:ze.join("-"),scene:ze[0],to:ze[1],topCustom:_e.topCustom||""},ue==="delete"?_e.isTop=!1:ue==="add"&&(_e.isTop=!0),_e=this.onUpdateSession(_e),Ne.obj&&(Ne.obj.stickTopSession=_e),this.db.enable&&(this.db.updateSession(_e).then(function(ie){ie||Y.db.putSession(_e)}),this.db.updateTimetag("stickTopSessions",Ce))}},y.pinMsgChange=function(Ne,ue){var Y=this;if(!Ne.error){Ne.content=Ne.content||{};var _e=this,Ce=this.db,ze=Ne.obj&&Ne.obj.msg,ie=Ne.content.msg||ze||{},le=Ne.content.pinTag||Ne.obj.pinTag,Ie=Ne.content.timetag||+le.updateTime,pe=u.resolve();ae.call(this,ie),Ce.enable&&(pe=Ce.getMsgByIdClient(ie.idClient)),le.createTime&&(le.createTime=+le.createTime),le.updateTime&&(le.updateTime=+le.updateTime),pe.then(function(qe){return ie=qe||ie,qe?ie=qe:ie.sessionId=ie.scene+"-"+Y.message.Message.getMsgTarget(ie,Y.account),ze?(Ne.obj.msg=ie,Ne.obj.pinTag=le):Y.options.onPinMsgChange({msg:ie,pinTag:le},ue),function(){Ce.enable&&Ce[ue==="delete"?"deleteMsgPin":"putMsgPin"](k(k({},ie),{},{pinFrom:le.pinFrom,pinCustom:le.pinCustom})).then(function(){var $e="pin-"+ie.sessionId,Lt=_e.timetags.sync;return Ce.getTimetag($e).then(function(Dt){return Dt>Lt?Ce.updateTimetag($e,Ie):u.resolve()})}).catch(function($e){_e.logger.error("msgExtend::pinMsgChange:error",$e)})}(),u.resolve}).then(function(){}),Ne.promise=pe}},y.getMsgPins=function(Ne){var ue=this;if(!Ne.error){var Y=this.db,_e=Ne.content||{};if(_e.pins=_e.pins||[],_e.modify){var Ce,ze=[];Y.enable&&(Y.updateTimetag("pin-"+Ne.obj.id,_e.timetag),s(Ce=_e.pins).call(Ce,function(ie){ie.sessionId=Ne.obj.id,ze.push(Y.getMsgByIdClient(ie.idClient))})),Ne.promise=u.all(ze).then(function(ie){var le;s(le=_e.pins).call(le,function(Ie,pe){ie[pe]?d(Ie,ie[pe]):(Ie.sessionId=Ne.obj.id,ae.call(ue,Ie))}),Ne.obj.pins=_e.pins,Y.enable&&Y.deleteMsgPins(Ne.obj.id).then(function(){return Y.putMsgPins(_e.pins)}).catch(function(Ie){ue.logger.error("msgExtend::getMsgPins:change db error",Ie)})})}else Y.enable?(Y.updateTimetag("pin-"+Ne.obj.id,_e.timetag),Ne.promise=Y.getMsgPins(Ne.obj.id).then(function(ie){Ne.obj.pins=ie||[]})):Ne.obj.pins=[]}}},function(t,r,e){var n=e(812);t.exports=n},function(t,r,e){e(813);var n=e(12);t.exports=n.Number.isInteger},function(t,r,e){e(1)({target:"Number",stat:!0},{isInteger:e(814)})},function(t,r,e){var n=e(28),o=Math.floor;t.exports=Number.isInteger||function(s){return!n(s)&&isFinite(s)&&o(s)===s}},function(t,r,e){var n=e(120),o=e(3),s=e(2),a=e(7),i=["time","from"],u=e(35).fn,d=e(0);u.onOfflineMsgReceipts=function(c){var m,v=this,g=v.db,b=c.content.msgReceipts,T=[],k=o.resolve();this.logger.info("onOfflineMsgReceipts",b),s(b).call(b,function(y){m={id:"p2p-"+y.from,msgReceiptTime:+y.time},v.cacheSyncedSession(m)}),v.syncResult.msgReceipts=T,g.enable&&(k=g.updateMsgReceiptsTimetag(c.content.timetag)),k.cmd=T,v.syncPromiseArray.push(k)},u.shouldUpdateSessionFromMsgReceipt=function(c,m){return!c||!c.msgReceiptServerTime||m.time>c.msgReceiptServerTime},u.genSessionFromMsgReceipt=function(c,m){var v=m.time,g={id:m.sessionId,msgReceiptTime:v,msgReceiptServerTime:v};return c&&c.id===m.sessionId&&(g=d.merge({},c,g)),c&&c.updateTime||(g.updateTime=v),g},u.onMsgReceipt=function(c){var m=this,v=m.db,g=c.content.msgReceipt;g.time=+g.time;var b=g.idClient,T=o.resolve();v.enable&&b&&(T=v.getMsgByIdClient(b)),this.logger.info("onMsgReceipt::",g),T.then(function(k){if(k){if(!k.idServer)return void(m.msgReceiptTasks[b]=g);k.time}else g.time;g.msgReceiptTime=g.time,g.sessionId="p2p-".concat(g.from),m.updateSessionMsgReceiptTime(g),g.time,g.from;var y=n(g,i);m.options.onMsgReceipts([y])})},u.resolveMsgReceiptTask=function(c){var m=this.msgReceiptTasks[c.idClient];m&&(m.msgReceiptTime=c.time,this.updateSessionMsgReceiptTime(m))},u.updateSessionMsgReceiptTime=function(c){var m=this.db,v={id:"p2p-"+c.from,msgReceiptTime:c.msgReceiptTime,msgReceiptServerTime:c.time};(this.getSessionInCache(v.id)||{}).msgReceiptTime>=v.msgReceiptTime?this.logger.warn("receive old msgReceiptTime",c):(m.enable&&m.putSession(v),this.onUpdateSession(v))},u.onSendMsgReceipt=function(c){var m;if(!c.error)if(c.obj&&c.obj.msgReceipt){var v=c.obj.msgReceipt,g=+v.time,b=+c.content.msgReceipt.time,T=this.getSessionInCache("p2p-"+v.to);T?(this.logger.info(a(m="sendMsgReceipt on:: param time ".concat(g,", res time ")).call(m,b)),T.msgReceiptSendTime=Math.min(g,b)):this.logger.info("sendMsgReceipt on:: session is undefined or logically deleted, failed to send read receipt")}else this.logger.info("sendMsgReceipt on:: origin msg is missing, it maybe timeout")},u.shouldSendMsgReceipt=function(c){if(c&&c.scene==="p2p"&&c.status==="success"){var m=this.getSessionInCache(c.sessionId);if(m){var v=m.msgReceiptSendTime;return!v||v<c.time}}return!1},u.isMsgRemoteRead=function(c){if(c&&c.scene==="p2p"&&c.flow==="out"&&c.status==="success"){var m=this.getSessionInCache(c.sessionId);if(m&&m.msgReceiptTime)return c.time<=m.msgReceiptTime}return!1}},function(t,r,e){var n=e(102),o=e(103),s=e(57),a=e(9),i=e(2),u=e(7),d=e(8),c=e(3),m=e(87),v=e(197),g=e(5),b=e(17),T=e(52),k=e(15),y=e(25),O=e(201),D=e(85),he=e(86),ae=e(70),Ne=e(32);function ue($e,Lt){var Dt=he!==void 0&&ae($e)||$e["@@iterator"];if(!Dt){if(Ne($e)||(Dt=function(nr,ir){var Ue;if(nr){if(typeof nr=="string")return Y(nr,ir);var rr=k(Ue=Object.prototype.toString.call(nr)).call(Ue,8,-1);if(rr==="Object"&&nr.constructor&&(rr=nr.constructor.name),rr==="Map"||rr==="Set")return D(nr);if(rr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(rr))return Y(nr,ir)}}($e))||Lt&&$e&&typeof $e.length=="number"){Dt&&($e=Dt);var dr=0,pr=function(){};return{s:pr,n:function(){return dr>=$e.length?{done:!0}:{done:!1,value:$e[dr++]}},e:function(nr){throw nr},f:pr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sr,hr=!0,Fe=!1;return{s:function(){Dt=Dt.call($e)},n:function(){var nr=Dt.next();return hr=nr.done,nr},e:function(nr){Fe=!0,sr=nr},f:function(){try{hr||Dt.return==null||Dt.return()}finally{if(Fe)throw sr}}}}function Y($e,Lt){(Lt==null||Lt>$e.length)&&(Lt=$e.length);for(var Dt=0,dr=new Array(Lt);Dt<Lt;Dt++)dr[Dt]=$e[Dt];return dr}var _e=e(35).fn,Ce=e(151),ze=e(152),ie=e(0),le=e(105).EMSyncType;function Ie($e,Lt){return pe.apply(this,arguments)}function pe(){return(pe=o(n.mark(function $e(Lt,Dt){var dr,pr,sr,hr,Fe,nr,ir,Ue,rr,or,Pt,Et,kt,er=this;return n.wrap(function(cr){for(;;)switch(cr.prev=cr.next){case 0:if(sr=(pr=this).db,hr=[],i(Lt).call(Lt,function(mr){er.revokeMsgUniqueCheck(mr.idClient),hr.push(mr.idClient)}),pr.options.rollbackDelMsgUnread){cr.next=14;break}return cr.next=7,sr.deleteMsg(hr);case 7:if(cr.t0=cr.sent,cr.t0){cr.next=10;break}cr.t0=[];case 10:return Fe=cr.t0,Fe=Object.prototype.toString.call(Fe)==="[object Array]"?Fe:[Fe],pr.logger.info("msg::_deleteMsgSelfBatchInDb, rollback false, affect: ".concat(Fe.length," rows")),cr.abrupt("return");case 14:return nr=!1,ir=pr.options.cbUpdateSession||y(dr=pr.updateSessionInDbWithNotify).call(dr,pr),Ue=pr.getSessionInCache(Dt)||{id:Dt},rr=Ue.lastMsg||{},O(hr).call(hr,rr.idClient)&&(nr=!0),pr.logger.info("msg::_deleteMsgSelfBatchInDb session change before:",Dt,nr,Ue.unread),cr.next=22,sr.deleteMsg(hr);case 22:if(cr.t1=cr.sent,cr.t1){cr.next=25;break}cr.t1=[];case 25:if(or=cr.t1,or=Object.prototype.toString.call(or)==="[object Array]"?or:[or],pr.logger.info("msg::_deleteMsgSelfBatchInDb affect:",or.length," rows"),!nr){cr.next=34;break}return cr.next=31,sr.getMsgs({sessionId:Dt,limit:1});case 31:Pt=cr.sent,rr=Pt&&Pt[0]?Pt[0]:null,Ue.lastMsg=rr;case 34:if(Et=!1,Ue&&Ue.unread&&(kt=Ue&&Ue.ack||0,i(or).call(or,function(mr){var vr=!0;if(mr.type==="notification")try{vr=pr.options.shouldCountNotifyUnread(mr)}catch(Tr){throw pr.logger.error("userOption:shouldCountNotifyUnread function error",Tr),Tr}vr&&kt<mr.time&&mr.flow==="in"&&(Ue.unread=Ue.unread>0?Ue.unread-1:0,Et=!0)})),!nr&&!Et){cr.next=39;break}return pr.logger.info("msg::_deleteMsgSelfBatchInDb session change after:",Dt,Ue.unread),cr.abrupt("return",ir(Ue));case 39:case"end":return cr.stop()}},$e,this)}))).apply(this,arguments)}function qe($e,Lt){Lt=Lt||new Date().getTime();var Dt=this.db,dr=this.getSessionInCache($e),pr=this.options.rollbackClearMsgsUnread!==!1,sr=[];return Dt.enable&&sr.push(Dt.deleteMsgsBySessionId({sessionId:$e,end:Lt})),pr&&dr&&(dr=this.mergeSession({id:dr.id,unread:0,lastMsg:null,unreadMsgs:[]}),dr=this.onUpdateSession(dr)),Dt.enable&&pr&&dr&&sr.push(Dt.updateSession(dr)),c.all(sr)}_e.onDeleteMsg=function($e){var Lt=this.db;if(delete $e.obj.sysMsg,!$e.error){var Dt=$e.obj.msg;$e.promise=this.deleteLocalMsg(Dt).then(function(){if(Lt.enable){var dr=Dt.scene==="superTeam"?"deleteSuperTeamMsg":"deleteMsg";Lt.getTimetag(dr).then(function(pr){pr=pr||0,s()+1>=pr&&Lt.updateTimetag(dr,s()+1)})}})}},_e.onMsgDeleted=function($e,Lt){var Dt=this;if(!Dt.canHandleDeletedMsgInSyncing)return Dt.logger.info("msg::onMsgDeleted:is in syncing ..."),void Dt.unhandledSysMsgsForDeletedMsgs.push({packet:$e,isSuperTeam:Lt});if(!$e.error){var dr=Dt.db,pr=a(Ce).call(Ce,$e.content.sysMsg);pr=Dt.processDeleteMsgSysMsg(pr),Lt||Dt.markSysMsgRead(pr),Dt.deleteLocalMsg(pr.msg).then(function(){if(dr.enable){var sr=Lt?"deleteSuperTeamMsg":"deleteMsg";dr.updateTimetag(sr,pr.time+1)}Dt.handleSysMsg(pr)})}},_e.processDeleteMsgSysMsg=function($e){var Lt;return $e.msg={},i(Lt=["scene","from","to"]).call(Lt,function(Dt){$e.msg[Dt]=$e[Dt]}),$e.msg.idClient=$e.deletedIdClient,$e.msg.idServer=$e.deletedIdServer,$e.msg.time=$e.deletedMsgTime,$e.msg.fromNick=$e.deletedMsgFromNick,$e.opeAccount=$e.opeAccount||$e.from,$e.msg.opeAccount=$e.opeAccount,this.message.Message.setExtra($e.msg,this.account),$e},_e.onDeleteMsgOfflineRoaming=function($e){if(!$e.error){var Lt,Dt=this,dr=+$e.content.type==1?"offline":"roaming",pr=Ce.reverseSysMsgs($e.content.sysMsgs,{mapper:function(nr){return Dt.processDeleteMsgSysMsg(nr)}}),sr=pr&&pr[0]&&pr[0].scene==="superTeam";Dt.logger.info(u(Lt="msg::onDeleteMsgOfflineRoaming: on delete ".concat(dr," ")).call(Lt,sr?"superTeam":""," idServer deletedIdClient deletedIdClient="),d(pr).call(pr,function(nr){var ir,Ue;return u(ir=u(Ue="".concat(nr.idServer,"-")).call(Ue,nr.deletedIdServer,"-")).call(ir,nr.deletedIdClient)})),dr==="offline"&&Dt.markSysMsgRead(pr);var hr=$e.content.timetag;sr?(Dt.timetags.deleteSuperTeamMsg=hr,Dt.syncResult.deleteSuperTeamMsgTimetag=hr):(Dt.timetags.deleteMsg=hr,Dt.syncResult.deleteMsgTimetag=hr);var Fe=Dt.putSysMsg(pr,"offlineSysMsgs").catch(function(nr){return Dt.logger.error("msgDelete::onDeleteMsgOfflineRoaming: ",nr),c.reject(nr)});Fe.cmd="deleteMsgSysMsgs "+dr,Dt.syncPromiseArray.push(Fe),Dt.syncResult.deleteMsgSysMsgs=Dt.syncResult.deleteMsgSysMsgs||[],Dt.syncResult.deleteMsgSysMsgs.push({type:dr,sysMsgs:pr})}},_e.deleteMsgOfflineRoaming=function($e,Lt){if(!$e)return c.resolve();var Dt=this;Dt.logger.info("msg::deleteMsgOfflineRoaming: ",d($e).call($e,function(sr){var hr;return sr.type+" "+d(hr=sr.sysMsgs).call(hr,function(Fe){var nr,ir;return u(nr=u(ir="".concat(Fe.idServer,"-")).call(ir,Fe.deletedIdServer,"-")).call(nr,Fe.deletedIdClient)})}),ie.secureOutput("session",Lt));var dr=Dt.db,pr=[];return i($e).call($e,function(sr){var hr;i(hr=sr.sysMsgs).call(hr,function(Fe){var nr=Dt.deleteLocalMsg(Fe.msg,{cbUpdateSession:function(ir){ir=Dt.mergeSession(ir),ir=m(ze).call(ze,ir);var Ue=ie.findObjIndexInArray(Lt,{value:ir.id});if(Ue!==-1&&(Lt[Ue]=ie.merge({},Lt[Ue],ir)),dr.enable)return dr.updateSession(ir)}});pr.push(nr)})}),c.all(pr).then(function(){dr.enable&&(Dt.syncResult.deleteMsgTimetag&&dr.updateTimetag("deleteMsg",Dt.syncResult.deleteMsgTimetag),Dt.syncResult.deleteSuperTeamMsgTimetag&&dr.updateTimetag("deleteSuperTeamMsg",Dt.syncResult.deleteSuperTeamMsgTimetag))})},_e.deleteMsgSelf=function($e){if(!$e.error){var Lt=this.db,Dt=$e.obj&&$e.obj.deleteMsgSelfTag;if(Dt){var dr=$e.content&&$e.content.timetag;Dt.scene=Dt.scene+""=="1"?"p2p":"team";var pr=[this.deleteLocalMsg(Dt)];dr<=this.timetags.deleteMsgSelf||(this.timetags.deleteMsgSelf=dr,Lt.enable&&pr.push(Lt.updateDeleteMsgSelf(dr))),$e.promise=c.all(pr)}}},_e.deleteMsgSelfBatch=function(){var $e=o(n.mark(function Lt(Dt){var dr,pr,sr,hr,Fe,nr,ir,Ue;return n.wrap(function(rr){for(;;)switch(rr.prev=rr.next){case 0:if(!Dt.error){rr.next=2;break}return rr.abrupt("return");case 2:if(pr=this,sr=this.db,(hr=Dt.obj&&Dt.obj.deleteMsgSelfTags)&&hr.length>0){rr.next=7;break}return rr.abrupt("return");case 7:if(Fe=v(hr).call(hr,function(or,Pt){var Et=Pt.sessionId;if(or[Et]=or[Et]||[],or[Et].push(Pt),!sr.enable){var kt=pr.getSessionInCache(Et);kt&&kt.lastMsg&&Pt&&kt.lastMsg.idClient===Pt.idClient&&(kt.lastMsg=null,pr.onUpdateSession(kt))}return or},{}),sr.enable){rr.next=11;break}return i(nr=g(Fe)).call(nr,function(or){var Pt=Fe[or],Et=pr.getSessionInCache(or);if(pr.options.rollbackDelMsgUnread&&Et){var kt=Et.ack||0,er=b(Pt).call(Pt,function(cr){var mr=!0;if(cr.type==="notification")try{mr=pr.options.shouldCountNotifyUnread(cr)}catch(vr){throw pr.logger.error("userOption:shouldCountNotifyUnread function error",vr),vr}return pr.message.Message.setFlow(cr,pr.account),mr&&kt<cr.time&&cr.flow==="in"});er.length>0&&Et.unread&&(Et.unread=Et.unread-er.length>=0?Et.unread-er.length:0,pr.onUpdateSession(Et))}}),rr.abrupt("return",c.resolve());case 11:ir=d(dr=g(Fe)).call(dr,function(or){var Pt=Fe[or];return Ie.call(pr,Pt,or)}),(Ue=Dt.content&&Dt.content.timetag)<=pr.timetags.deleteMsgSelf||(pr.timetags.deleteMsgSelf=Ue,ir.push(sr.updateDeleteMsgSelf(Ue))),Dt.promise=c.all(ir);case 15:case"end":return rr.stop()}},Lt,this)}));return function(Lt){return $e.apply(this,arguments)}}(),_e.onDeleteMsgSelf=function($e){var Lt=this,Dt=this.db,dr=$e.content.deleteMsgSelfTag;dr.scene=dr.scene+""=="1"?"p2p":"team",Lt.options.onDeleteMsgSelf([dr]),Lt.deleteLocalMsg(dr).then(function(){var pr=dr.deletedTime;return pr<=Lt.timetags.deleteMsgSelf||!Dt.enable?c.resolve():(Lt.timetags.deleteMsgSelf=pr,Dt.updateDeleteMsgSelf(pr))}).catch(function(pr){Lt.logger.error("onDeleteMsgSelf error",pr)})},_e.onDeleteMsgSelfBatch=function($e){var Lt=this;if(!$e.error){var Dt={1:"p2p",2:"team"},dr=ie.get($e,"content.deleteMsgSelfTags")||[];i(dr).call(dr,function(sr){var hr;sr.scene=Dt[sr.scene],sr.sessionId=u(hr="".concat(sr.scene,"-")).call(hr,Lt.message.Message.getMsgTarget(sr,Lt.account)),sr.deletedTime=T(sr.deletedTime),sr.time=T(sr.time)});var pr=ie.get($e,"content.deleteMsgSelfTags[0].deletedTime");pr=T(pr)||0,this.options.onDeleteMsgSelf(dr),this.deleteMsgSelfBatch({obj:{deleteMsgSelfTags:dr},content:{timetag:pr}})}},_e.clearServerHistoryMsgs=function($e){if(!$e.error){var Lt=this.db,Dt=$e.obj&&$e.obj.clearMsgsParamsWithSync;if(Dt){var dr=(Dt.type&&Dt.type.toString()==="2"?"team":"p2p")=="p2p"?"p2p-".concat(Dt.otherAccid):"team-".concat(Dt.toTid),pr=$e.content&&T($e.content.timetag);pr&&pr>this.timetags.sessionHistoryMsgsDelete&&(this.timetags.sessionHistoryMsgsDelete=pr,Lt.enable&&Lt.updateTimetag("sessionHistoryMsgsDelete",this.timetags.sessionHistoryMsgsDelete)),qe.call(this,dr,pr)}}},_e.onClearServerHistoryMsgs=function($e){if(!$e.error){var Lt=this.db,Dt=$e.content&&$e.content.sessionHistoryMsgsDeleteTag;if(Dt){var dr=(Dt.type&&Dt.type.toString()==="2"?"team":"p2p")=="p2p"?"p2p-".concat(Dt.otherAccid):"team-".concat(Dt.toTid),pr=Dt.ext,sr=T(Dt.time);this.options.onClearServerHistoryMsgs&&this.options.onClearServerHistoryMsgs([{sessionId:dr,time:sr,ext:pr}]),sr<=this.timetags.sessionHistoryMsgsDelete||(this.timetags.sessionHistoryMsgsDelete=sr,Lt.enable&&Lt.updateTimetag("sessionHistoryMsgsDelete",this.timetags.sessionHistoryMsgsDelete)),qe.call(this,dr,sr)}}},_e.syncSessionHistoryMsgsDelete=function($e){if(!$e.error){var Lt=this.db,Dt=$e.content&&$e.content.sessionHistoryMsgsDeleteTags;if(Dt&&Dt.length>0){var dr=d(Dt).call(Dt,function(sr){return{sessionId:(sr.type&&sr.type.toString()==="2"?"team":"p2p")=="p2p"?"p2p-".concat(sr.otherAccid):"team-".concat(sr.toTid),time:T(sr.time)}});this.reporterHook.emit("reporter/syncItemComplete",le.kSyncType4_24),this.options.onClearServerHistoryMsgs&&this.options.onClearServerHistoryMsgs(dr),this.syncResult.clearServerHistoryMsgs=dr;var pr=0;i(dr).call(dr,function(sr){sr.time>pr&&(pr=sr.time)}),Lt.enable&&Lt.updateTimetag("sessionHistoryMsgsDelete",pr)}}},_e.syncDeleteMsgSelf=function($e){var Lt=this,Dt=this.db,dr=$e.content.deletedMsgs;if(dr&&dr.length!==0){var pr=[];i(dr).call(dr,function(sr){sr.scene=sr.scene==="1"?"p2p":"team",sr.deletedTime=+sr.deletedTime,sr.time=+sr.time,pr.push(Lt.deleteLocalMsg(sr))}),Lt.options.onDeleteMsgSelf(dr),c.all(pr).then(function(){var sr=k(dr).call(dr,-1)[0].deletedTime;if(!(Lt.timetags.deleteMsgSelf>=sr))return Lt.timetags.deleteMsgSelf=sr,Dt.enable?Dt.updateDeleteMsgSelf(sr):void 0}).catch(function(sr){Lt.logger.error("syncDeleteMsgSelf error",sr)})}},_e.deleteLocalMsg=function(){var $e=o(n.mark(function Lt(Dt,dr){var pr,sr,hr,Fe,nr,ir,Ue,rr,or,Pt,Et,kt;return n.wrap(function(er){for(;;)switch(er.prev=er.next){case 0:if(Dt){er.next=2;break}return er.abrupt("return");case 2:if(hr=(sr=this).db,Fe=(dr=dr||{}).cbUpdateSession||y(pr=sr.updateSessionInDbWithNotify).call(pr,sr),this.revokeMsgUniqueCheck(Dt&&Dt.idClient),nr=Dt.sessionId||Dt.scene+"-"+this.message.Message.getMsgTarget(Dt,this.account),ir=!1,Ue=sr.getSessionInCache(nr),rr=!0,Dt.type!=="notification"){er.next=20;break}er.prev=12,rr=sr.options.shouldCountNotifyUnread(Dt),er.next=20;break;case 16:throw er.prev=16,er.t0=er.catch(12),sr.logger.error("userOption:shouldCountNotifyUnread function error",er.t0),er.t0;case 20:if(sr.options.rollbackDelMsgUnread&&Ue&&(or=Ue.ack||0,rr&&Ue&&or<Dt.time&&Dt.from!==sr.account&&Ue.unread&&(sr.logger.info("msgDelete::deleteLocalMsg:cache.getSessions: unread",Ue.id,Ue.unread),Ue.unread=Ue.unread-1,ir=!0)),Ue&&Ue.lastMsg&&Ue.lastMsg.idClient==Dt.idClient&&(sr.logger.info("msgDelete::deleteLocalMsg:cache.getSessions: lastMsg",Ue.id,Ue.unread),Ue.lastMsg=null,ir=!0),!hr.enable){er.next=49;break}return Pt=null,er.next=26,hr.getMsgByIdClient(Dt.idClient);case 26:return er.sent||sr.logger.info("msgDelete::deleteLocalMsg::db.deleteMsg no find in DB",Dt),sr.logger.info("msgDelete::deleteLocalMsg::db.deleteMsg ",Dt.idClient),er.next=31,hr.deleteMsg(Dt.idClient);case 31:if(!Ue||Ue.lastMsg!==null){er.next=36;break}return er.next=34,hr.getMsgs({sessionId:nr,limit:1});case 34:(Et=er.sent)&&Et[0]&&(Pt=Et[0]);case 36:if(Ue||!sr.options.rollbackDelMsgUnread){er.next=46;break}return sr.logger.info("msgDelete::deleteLocalMsg::Can not find session in cache,will find in DB",nr),er.next=40,hr.getSession(nr);case 40:if(kt=er.sent){er.next=43;break}return er.abrupt("return");case 43:or=(Ue=kt).ack||0,rr&&Ue&&or<Dt.time&&Dt.flow==="in"&&Ue.unread&&(sr.logger.info("msgDelete::deleteLocalMsg:db.getSessions: unread",kt.id,kt.unread),Ue.unread=Ue.unread-1,ir=!0);case 46:if(Ue&&Ue.lastMsg===null&&Pt&&(sr.logger.info("msgDelete::deleteLocalMsg:db.getSessions: lastMsg",nr,Pt),Ue.lastMsg=Pt||null,ir=!0),!ir){er.next=49;break}return er.abrupt("return",Fe(Ue));case 49:if(hr.enable||!ir){er.next=52;break}return sr.onUpdateSession(Ue),er.abrupt("return");case 52:case"end":return er.stop()}},Lt,this,[[12,16]])}));return function(Lt,Dt){return $e.apply(this,arguments)}}(),_e.deleteLocalMsgs=function($e){var Lt=this,Dt=Lt.db;return new c(function(dr,pr){if(function(sr){var hr=Lt.getSessionInCache($e.sessionId);if(hr&&$e.updateSession){var Fe=hr.lastMsg;Fe&&(!$e.start&&!$e.end||Fe.time>$e.start&&Fe.time<$e.end)&&(hr.lastMsg=null,Lt.logger.log("deleteLocalMsgs::delete cacheSession lastMsg done, options is",$e),Dt.enable||(Lt.onUpdateSession(hr),sr()))}}(dr),Dt.enable)return Dt.deleteMsgsBySessionId($e).then(function(){$e.updateSession&&Lt.checkAndUpdateLocalSessionByMsg($e.sessionId),dr()},function(sr){return pr(sr)})})},_e.deleteLocalMsgsByTime=function(){var $e=o(n.mark(function Lt(Dt){var dr,pr,sr,hr,Fe,nr,ir,Ue,rr,or,Pt,Et,kt,er;return n.wrap(function(cr){for(;;)switch(cr.prev=cr.next){case 0:return pr=(dr=this).db,cr.next=4,pr.getDeletedMsgsCountByTime(Dt);case 4:return sr=cr.sent,hr=0,Fe=[],cr.next=9,pr.deleteMsgsByTime(Dt);case 9:return Dt.deletedone&&Dt.deletedone({deletedMsgCount:sr}),cr.next=12,pr.getAllSessions();case 12:nr=cr.sent,ir=ue(nr),cr.prev=14,ir.s();case 16:if((Ue=ir.n()).done){cr.next=47;break}return rr=Ue.value,or=rr.id,Pt=!1,cr.next=22,pr.getSession(or);case 22:if(Et=cr.sent){cr.next=25;break}return cr.abrupt("continue",45);case 25:return cr.next=27,pr.getMsgCountAfterAck({shouldCountNotifyUnread:dr.options.shouldCountNotifyUnread,sessionId:or,ack:Et.ack||0});case 27:if(kt=cr.sent,Et.unread!==kt&&(Et.unread=kt,Pt=!0),!(Et.lastMsg&&Et.lastMsg.time>Dt.start&&Et.lastMsg.time<Dt.end)){cr.next=39;break}if(Dt.start!==0){cr.next=34;break}Et.lastMsg=null,cr.next=38;break;case 34:return cr.next=36,pr.getMsgs({sessionId:or,limit:1});case 36:er=cr.sent,Et.lastMsg=er&&er[0]?er[0]:null;case 38:Pt=!0;case 39:if(!Pt){cr.next=45;break}return cr.next=42,pr.updateSession(Et);case 42:dr.sessionSet[or]&&Fe.push(Et),hr++;case 45:cr.next=16;break;case 47:cr.next=52;break;case 49:cr.prev=49,cr.t0=cr.catch(14),ir.e(cr.t0);case 52:return cr.prev=52,ir.f(),cr.finish(52);case 55:return dr.onUpdateSessions(Fe),cr.abrupt("return",c.resolve({deletedMsgCount:sr,sessionUpdateCount:hr}));case 57:case"end":return cr.stop()}},Lt,this,[[14,49,52,55]])}));return function(Lt){return $e.apply(this,arguments)}}()},function(t,r,e){var n=e(69),o=e(8),s=e(9),a=e(7),i=e(3),u=e(23),d=e(17),c=e(2),m=e(35).fn,v=e(0),g=e(151);m.splitSysMsgs=function(b,T){for(var k,y=b.length-1;y>=0;y--)k=b[y],g.isCustom(k)&&(n(b).call(b,y,1),T.push(k))},m.onOfflineSysMsgs=function(b,T){var k,y=this,O=o(k=b.content.sysMsgs).call(k,function(Y){return Y=s(g).call(g,Y),T&&(Y.filter=!0),Y});O=s(O).call(O),y.markSysMsgRead(O);var D=[];y.splitSysMsgs(O,D);var he,ae=T?"offlineFilterSysMsgs":"offlineSysMsgs",Ne=T?"offlineFilterCustomSysMsgs":"offlineCustomSysMsgs";if(O.length){var ue=y.putSysMsg(O,"offlineSysMsgs").then(function(Y){var _e;(O=Y).length&&(y.logger.info("sysmsg::onOfflineSysMsgs: ",ae,O.length,O&&o(O).call(O,function(Ce){return Ce.idServer})),y.syncResult[ae]=y.syncResult[ae]||[],y.syncResult[ae]=a(_e=y.syncResult[ae]).call(_e,O))}).catch(function(Y){return y.logger.error("sysMsg::onOfflineSysMsgs: ",Y),i.reject(Y)});ue.cmd="sysMsgs",y.syncPromiseArray.push(ue)}D.length&&(y.logger.info("sysmsg::onOfflineSysMsgs: ",Ne,o(D).call(D,function(Y){return Y.idServer})),y.syncResult[Ne]=y.syncResult[Ne]||[],y.syncResult[Ne]=a(he=y.syncResult[Ne]).call(he,D))},m.onSendSysMsg=function(b,T){var k=b.obj||{};k?(this.completeSysMsg(k),b.error?k.status="fail":k.status="success",k=s(g).call(g,k),T&&(b.obj.filter=!0),b.obj=k):this.logger.warn("onSendSysMsg::no obj")},m.completeSysMsg=function(b){return b.from=this.account,b},m.onSysMsg=function(b,T){var k=s(g).call(g,b.content.sysMsg);T&&(k.filter=!0),this.markSysMsgRead(k),g.isCustom(k)?(this.logger.info("sysmsg::onSysMsg: on customSysMsg"),this.options.oncustomsysmsg(k)):this.syncing?(this.logger.info("sysmsg::onSysMsg:is in syncing ..."),this.unhandledSysMsgs.push(k)):this.handleSysMsg(k)},m.handleSysMsg=function(b){var T=this,k=b.type,y=b.from,O=b.serverex;T.sysMsgPromise=T.sysMsgPromise.then(function(){return T.putSysMsg(b,"onSysMsg")}).then(function(D){b=D[0]}).then(function(){if(b){var D,he=i.resolve();switch(k){case"addFriend":D={type:"addFriend",account:y},O&&(D.serverex=O),he=T.onFriendRequest(D);break;case"passFriendApply":D={type:"passFriendApply",account:y},he=T.onFriendRequest(D);break;case"deleteFriend":he=T.onDeleteFriend({account:y})}return D&&D.friend&&(b.friend=D.friend),he}}).then(function(){b&&(T.logger.info("sysmsg::handleSysMsg: ",k,v.pickAsString(b,["idServer","deletedIdClient","deletedIdServer"])),u(function(){T.options.onsysmsg(b)},0))})},m.putSysMsg=function(b,T){if(v.isArray(b)||(b=[b]),d(b[0]))return i.resolve(b);var k=this,y=k.db,O=y.enable,D=i.resolve(),he=[];return(D=(D=D.then(function(){return O?y.putSysMsg(b):b}).then(function(ae){var Ne=[];c(b).call(b,function(ue){k.checkSysMsgUnique(ue)&&Ne.push(ue)}),b=Ne,he=O?ae:b})).then(function(){return k.getSysMsgUnread().then(function(ae){return he.length||((he=b).backward=!0),k.updateSysMsgUnread(he,ae,1).then(function(Ne){T==="offlineSysMsgs"&&(k.syncResult.sysMsgUnread=Ne),T==="onSysMsg"&&k.onUpdateSysMsgUnread(Ne)})})})).then(function(){return b})},m.checkSysMsgUnique=v.genCheckUniqueFunc("idServer"),m.getSysMsgUnread=function(){var b=this,T=b.db;return new i(function(k){T.enable?T.getSysMsgUnread().then(function(y){k(y)},function(){k(b.sysMsgUnread)}):k(b.sysMsgUnread)})},m.updateSysMsgUnread=function(b,T,k){if(v.isArray(b)||(b=[b]),!b.length)return i.resolve(T);T=T||{};var y,O=this.db;return c(b).call(b,function(D){(k>0&&!D.read||k<0&&D.read)&&(y=D.type,T[y]=(T[y]||0)+k)}),T=g.completeUnread(T),this.sysMsgUnread=T,O.enable&&!b.backward?O.updateSysMsgUnread(T):i.resolve(T)},m.reduceSysMsgUnread=function(b){var T=this;return T.getSysMsgUnread().then(function(k){return T.updateSysMsgUnread(b,k,-1)}).then(function(k){T.onUpdateSysMsgUnread(k)})},m.onUpdateSysMsgUnread=function(b){var T=this;u(function(){T.logger.info("sysmsg::onUpdateSysMsgUnread:",b),T.options.onupdatesysmsgunread(b)},0)},m.updateSysMsg=function(b){var T=this,k=T.db;(k.enable?k.updateSysMsg(b):i.resolve(b)).then(function(y){T.onUpdateSysMsg(y)})},m.onUpdateSysMsg=function(b){var T=this;u(function(){v.isArray(b)||(b=[b]),c(b).call(b,function(k){T.logger.info("sysmsg::onUpdateSysMsg:",k.idServer),T.options.onupdatesysmsg(k)})},0)},m.processUnsettledSysMsgs=function(){var b,T,k=this;c(b=k.unhandledSysMsgs).call(b,function(y){k.handleSysMsg(y)}),c(T=k.unhandledSysMsgsForDeletedMsgs).call(T,function(y){k.onMsgDeleted(y.packet,y.isSuperTeam)}),k.resetUnsettledSysMsgs()}},function(t,r,e){var n=e(754),o=e(58),s=e(2),a=e(6),i=e(15),u=e(9),d=e(3),c=e(8),m=e(87),v=e(17),g=e(41),b=e(5),T=e(7),k=e(59),y=e(60),O=e(61),D=e(62),he=e(47);function ae(ie,le){var Ie=b(ie);if(k){var pe=k(ie);le&&(pe=v(pe).call(pe,function(qe){return y(ie,qe).enumerable})),Ie.push.apply(Ie,pe)}return Ie}function Ne(ie){for(var le=1;le<arguments.length;le++){var Ie,pe,qe=arguments[le]!=null?arguments[le]:{};le%2?s(Ie=ae(Object(qe),!0)).call(Ie,function($e){o(ie,$e,qe[$e])}):O?D(ie,O(qe)):s(pe=ae(Object(qe))).call(pe,function($e){he(ie,$e,y(qe,$e))})}return ie}var ue=e(35).fn,Y=e(0),_e=e(152),Ce=e(40),ze=e(151);ue.processSession=function(ie){if(!ie.error)switch(ie.cmd){case"getServerSessions":this.onGetServerSessions(ie);break;case"getServerSession":this.onGetServerSession(ie);break;case"updateServerSession":this.onUpdateServerSession(ie)}},ue.onGetServerSessions=function(ie){var le=this,Ie=ie.content&&ie.content.sessionReqTag,pe=ie.content&&ie.content.sessionList,qe=[];s(pe).call(pe,function($e){var Lt,Dt;if($e.id=$e.id.split("|").join("-"),a(Lt=$e.id).call(Lt,"super_team")===0&&($e.id="superTeam"+i(Dt=$e.id).call(Dt,10)),$e.updateTime=+$e.updateTime,$e.lastMsg){var dr=$e.lastMsgType==="1"?"sysMsg":"msg";qe.push(le.parser.unserialize(JSON.parse($e.lastMsg),dr).then(function(pr){var sr;$e.lastMsg=dr==="msg"?u(sr=le.message).call(sr,pr):u(ze).call(ze,pr)}))}}),ie.promise=d.all(qe).then(function(){ie.obj={sessionList:pe,hasMore:Ie.hasMore==="1"},Ie.minTimestamp&&(ie.obj.minTimestamp=+Ie.minTimestamp)})},ue.onGetServerSession=function(ie){var le,Ie=this,pe=ie.content&&ie.content.session;if(pe){var qe;if(pe.id=pe.id.split("|").join("-"),a(le=pe.id).call(le,"super_team")===0&&(pe.id="superTeam"+i(qe=pe.id).call(qe,10)),pe.updateTime=+pe.updateTime,pe.lastMsg){var $e=ie.content.session&&ie.content.session.lastMsgType==="1"?"sysMsg":"msg";ie.promise=Ie.parser.unserialize(JSON.parse(pe.lastMsg),$e).then(function(Lt){var Dt;pe.lastMsg=$e==="msg"?u(Dt=Ie.message).call(Dt,Lt):u(ze).call(ze,Lt),ie.obj=pe})}else ie.obj=pe}},ue.onUpdateServerSession=function(ie){ie.obj={}},ue.onSyncUpdateServerSession=function(ie){var le,Ie=this,pe=this,qe=ie.content&&ie.content.session;if(qe){var $e;qe.id=qe.id.split("|").join("-"),a(le=qe.id).call(le,"super_team")===0&&(qe.id="superTeam"+i($e=qe.id).call($e,10)),qe.updateTime=+qe.updateTime,qe.lastMsg?pe.parser.unserialize(JSON.parse(qe.lastMsg),"msg").then(function(Lt){var Dt;qe.lastMsg=u(Dt=pe.message).call(Dt,Lt),Ie.options.onSyncUpdateServerSession(Y.simpleClone(qe))}):this.options.onSyncUpdateServerSession(Y.simpleClone(qe))}},ue.mergeSession=function(ie){ie=Y.copyWithNull(ie);var le=this.sessionSet,Ie=ie.id,pe=le[Ie]||{},qe=!1;return _e.isComplete(ie)?delete pe.isDeleted:pe.isDeleted&&(qe=!0),le[Ie]=Y.merge(pe,ie),ie=qe?ie:le[Ie],Y.undef(ie.unread)&&(ie.unread=0),ie},ue.mergeSessions=function(ie){var le=this;return c(ie=ie||[]).call(ie,function(Ie){return le.mergeSession(Ie)})},ue.onDeleteSessions=function(ie){var le;ie.obj=c(le=ie.obj.sessions).call(le,function(Ie){return _e.parse(Ie)})},ue.onUpdateSession=function(ie){if(ie){if(ie=this.mergeSession(ie),ie=m(_e).call(_e,ie),_e.isComplete(ie))return this.logger.info("session::onUpdateSession: ".concat(ie.id),ie.id,Y.secureOutput("session",ie)),this.options.onupdatesessions?this.options.onupdatesessions([ie]):this.options.onupdatesession(ie),ie;this.logger.warn("session::onUpdateSession::session is not complete",Y.secureOutput("session",ie))}},ue.onUpdateSessions=function(ie){var le=this;if(ie){ie=le.mergeSessions(ie),ie=c(ie).call(ie,function(qe){return m(_e).call(_e,qe)});var Ie=v(ie).call(ie,function(qe){return _e.isComplete(qe)}),pe=v(ie).call(ie,function(qe){return!_e.isComplete(qe)});if(pe&&pe.length>0&&le.logger.warn("session::onUpdateSessions::sessions is not complete",c(pe).call(pe,function(qe){return qe.id}),Y.secureOutput("session",pe)),Ie.length!==0)return le.logger.info("session::onUpdateSessions:",Y.secureOutput("session",Ie)),le.options.onupdatesessions?le.options.onupdatesessions(Ie):s(Ie).call(Ie,function(qe){le.options.onupdatesession(qe)}),Ie;le.logger.warn("session::onUpdateSessions::completeSessions is empty")}},ue.setCurrSession=function(ie){ie=""+ie,this.currSessionId=ie,this.logger.info("session::setCurrSession:",ie)},ue.resetSessionUnread=function(ie){var le=ie.id;this.db.enable&&this.db.updateSession({id:le,unread:0}),!this.options.autoMarkRead&&this.sessionUnreadMsgs&&this.sessionUnreadMsgs[le]&&(this.markMsgRead(this.sessionUnreadMsgs[le],!0),this.sessionUnreadMsgs[le]=[]),this.getSessionInCache(le)?this.onUpdateSession({id:le,unread:0}):this.onUpdateSession(Ne(Ne({},ie),{},{unread:0}))},ue.resetSessionsUnread=function(ie){var le=this,Ie=this.db;Ie.enable&&c(ie).call(ie,function(qe){Ie.updateSession({id:qe.id,unread:0})});var pe=!this.options.autoMarkRead&&this.sessionUnreadMsgs;ie=c(ie).call(ie,function(qe){return pe&&le.sessionUnreadMsgs[qe.id]&&(le.markMsgRead(le.sessionUnreadMsgs[qe.id],!0),le.sessionUnreadMsgs[qe.id]=[]),le.getSessionInCache(qe.id)?{id:qe.id,unread:0}:Ne(Ne({},qe),{},{unread:0})}),this.onUpdateSessions(ie)},ue.insertLocalSession=function(ie){var le=this,Ie=le.db,pe=ie.scene+"-"+ie.to,qe=le.getSessionInCache(pe);return qe&&_e.isComplete(qe)?d.reject(Ce.sessionExist({callFunc:"session::insertLocalSession",session:qe})):(Ie.enable?Ie.getMsgs({sessionId:pe,limit:1}):d.resolve()).then(function($e){if(Y.isArray($e)&&$e.length===1){var Lt=$e[0];(qe=_e.genSessionByMsg(Lt)).updateTime=Lt.time}else qe={id:pe,scene:ie.scene,to:ie.to,updateTime:+ie.updateTime||+new Date,lastMsg:null};return le.onUpdateSession(qe),Ie.enable?Ie.putSession(qe):d.resolve(qe)})},ue.checkAndUpdateLocalSessionByMsg=function(ie){var le,Ie=this.db,pe=this,qe=this.options.syncSessionUnread&&ie!==this.currSessionId,$e=Ie.getMsgs({sessionId:ie,limit:1}),Lt=Ie.getSession(ie).then(function(Dt){if(Dt)return le=g({},Dt),Dt.ack=Dt.ack||0,qe?Ie.getMsgs({sessionId:ie,start:Dt.ack}):d.resolve();pe.logger.error("can't find session that sessionId = ".concat(ie))});return d.all([$e,Lt]).then(function(Dt){var dr,pr,sr=n(Dt,2),hr=sr[0],Fe=sr[1],nr={id:ie};if(!le)return pe.logger.error("checkAndUpdateLocalSessionByMsg:can not find session",ie),d.resolve(200);if(dr=le&&!le.lastMsg?null:le.lastMsg.idClient,hr&&hr[0]?pr=(hr=hr[0]).idClient:(pr=null,hr=null),dr!==pr&&(nr.lastMsg=hr),Fe!==void 0){var ir=0;s(Fe=Fe||[]).call(Fe,function(Ue){var rr;try{rr=pe.options.shouldCountNotifyUnread(Ue)}catch(or){throw pe.logger.error("userOption:shouldCountNotifyUnread function error",or),or}Ue.isUnreadable&&Ue.flow==="in"&&(Ue.type!=="notification"||rr)&&ir++}),ir!==le.unread&&(nr.unread=ir)}return b(nr).length>1?(pe.logger.info("session::checkAndUpdateLocalSessionByMsg::needUpdate newSession:",Y.secureOutput("session",nr)),Ie.updateSession(nr).then(function(){return pe.onUpdateSession(nr)})):d.resolve(200)})},ue.syncSessionsWithMoreRoaming=function(ie){var le=this,Ie=ie&&ie.content&&ie.content.sessions;if(Ie&&Ie.length){var pe={0:"p2p",1:"team",5:"superTeam"};if(s(Ie).call(Ie,function($e){var Lt,Dt=$e.to===le.options.account?$e.from:$e.to;$e.scene=pe[$e.scene],$e.id=T(Lt="".concat($e.scene,"-")).call(Lt,Dt),$e.time=+$e.time}),this.db.enable){var qe=this.db.putSessionsWithMoreRoaming(Ie);qe.cmd="syncSessionsWithMoreRoaming",this.syncPromiseArray.push(qe)}this.syncing&&this.syncResult?this.syncResult.sessionsWithMoreRoaming=Ie:this.logger.warn("syncSessionsWithMoreRoaming::not in syncing or no syncResult")}},ue.syncStickTopSessions=function(ie){var le=this,Ie=this.db,pe=[],qe=[],$e=d.resolve(),Lt=ie.content.sessions||[];this.syncing&&this.syncResult?(s(Lt).call(Lt,function(Dt){var dr=Dt.id.split("|");dr[0]==="super_team"&&(dr[0]="superTeam"),Dt.id=dr.join("-"),Dt.scene=dr[0],Dt.to=dr[1],Dt.isTop=!0,pe.push(dr.join("-")),delete Dt.createTime,delete Dt.updateTime,Ie.enable&&qe.push(Ie.putSession(Dt))}),Ie.enable&&($e=Ie.updateTimetag("stickTopSessions",ie.content.timetag)),$e.then(function(){return Ie.enable?Ie.getStickTopSessions():[]}).then(function(Dt){if(ie.content.modify){var dr=[];s(Dt).call(Dt,function(pr){a(pe).call(pe,pr.id)>-1||(dr.push(pr.id),pr.isTop=!1,pr.topCustom="",qe.push(Ie.putSession(pr)))})}else le.syncResult.stickTopSessions=Dt;return d.all(qe)}),this.syncResult.stickTopSessions=Lt,$e.cmd="syncStickTopSessions",this.syncPromiseArray.push($e)):this.logger.warn("syncSessionsWithMoreRoaming::not in syncing or no syncResult")},ue.getSessionInCache=function(ie,le){var Ie=this.sessionSet[ie];return!Ie||Ie.isDeleted&&!le?void 0:Ie},ue.deleteSessionInCache=function(ie,le){var Ie=this;Y.isArray(ie)||(ie=[ie]),le?s(ie).call(ie,function(pe){Ie.sessionSet[pe]&&(Ie.sessionSet[pe].isDeleted=!0)}):s(ie).call(ie,function(pe){return delete Ie.sessionSet[pe]}),this.logger.info("sessions::deleteSessionInCache::delete session done",ie,le)},ue.updateSessionInCache=function(ie){return this.logger.info("session::updateSessionInCache: ".concat(ie.id),ie.id,ie),this.getSessionInCache(ie.id)?ie=this.mergeSession(ie):(this.logger.info("session::updateSessionInCache: can not find session in cache ".concat(ie.id)),null)},ue.updateSessionInDbWithNotify=function(ie,le){var Ie=this;return new d(function(pe,qe){var $e=Ie.db;if(Ie.getSessionInCache(ie.id)){var Lt=d.resolve(),Dt=Y.filterObj(ie,"id lastMsg localCustom unread");$e.enable&&(Lt=$e.updateSession(Dt)),Lt.then(function(dr){return Ie.onUpdateSession(dr,le)}).then(pe,function(dr){qe({callFunc:"session::updateLocalSession",event:dr})})}else qe(Ce.sessionNotExist({sessionId:ie.id,callFunc:"session::updateLocalSession"}))})}},function(t,r,e){var n=e(745);t.exports=function(o){if(n(o))return o},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(153),o=e(70);t.exports=function(s,a){var i=s==null?null:n!==void 0&&o(s)||s["@@iterator"];if(i!=null){var u,d,c,m,v=[],g=!0,b=!1;try{if(c=(i=i.call(s)).next,a===0){if(Object(i)!==i)return;g=!1}else for(;!(g=(u=c.call(i)).done)&&(v.push(u.value),v.length!==a);g=!0);}catch(T){b=!0,d=T}finally{try{if(!g&&i.return!=null&&(m=i.return(),Object(m)!==m))return}finally{if(b)throw d}}return v}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r){t.exports=function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(2),o=e(5),s=e(7),a=e(41),i=e(35).fn,u=e(0);i.syncSessionAck=function(d){var c,m=this;if(this.logger.info("syncSessionAck::",d.content),m.syncing&&m.syncResult){m.saveAck.p2pTeam=d.content.timetag;var v={};n(c=[[d.content.p2p,"p2p"],[d.content.team.m_map,"team"]]).call(c,function(g){var b,T=g[0],k=g[1];n(b=o(T)).call(b,function(y){var O,D;v[s(O="".concat(k,"-")).call(O,y)]=T[y];var he={id:s(D="".concat(k,"-")).call(D,y),ack:T[y]};m.cacheSyncedSession(he)})}),m.syncResult.ackMap?m.syncResult.ackMap=a(m.syncResult.ackMap,v):m.syncResult.ackMap=v}else m.logger.warn("syncSessionAck: not in syncing or no syncResult",m.syncing,!!m.syncResult)},i.syncSuperTeamSessionAck=function(d){var c,m=this;if(m.syncResult){m.saveAck.superTeam=d.content.timetag;var v={},g=d.content.superTeam.m_map;n(c=o(g)).call(c,function(b){v["superTeam-".concat(b)]=g[b];var T={id:"superTeam-".concat(b),ack:g[b]};m.cacheSyncedSession(T)}),m.syncResult.ackMap?m.syncResult.ackMap=a(m.syncResult.ackMap,v):m.syncResult.ackMap=v}},i.onMarkSessionAck=function(d){d.error||this.storeSessionAck(d.obj)},i.syncMarkSessionAck=function(d){this.storeSessionAck(d.content,!0)},i.storeSessionAck=function(d,c){var m;if(this.options.syncSessionUnread&&d){var v;switch(d.scene){case 0:v="p2p";break;case 1:v="team";break;case void 0:default:v="superTeam"}var g=s(m="".concat(v,"-")).call(m,d.to),b=d.timetag;if(b<=((this.getSessionInCache(g)||{}).ack||0))this.logger.warn("session::storeSessionAck: ack <= ackInMemory",b);else{var T={id:g,ack:b};this.mergeSession(T),this.logger.info("session::storeSessionAck:",u.secureOutput("session",T)),this.markUnreadBySessionAck({sessionId:g,ack:T.ack},c)}}},i.markUnreadBySessionAck=function(d,c){var m=d.sessionId,v=d.ack,g=this,b=g.db;if(b.enable)g.pushMsgTask(function(){return b.getMsgCountAfterAck({shouldCountNotifyUnread:g.options.shouldCountNotifyUnread,sessionId:m,ack:v}).then(function(ae){var Ne={id:m,unread:ae,ack:v};return g.logger.info("session::markUnreadBySessionAck: db.getMsgCountAfterAck done",Ne),g.syncing?g.cacheSyncedSession(Ne):c&&g.onUpdateSession(Ne),b.updateSession(Ne)}).catch(function(ae){g.logger.error("markUnreadBySessionAck::error",ae)})});else{var T=g.getSessionInCache(m);if(T){var k=T.unreadMsgs;if(k&&k.length){for(var y=0,O=[],D=k.length-1;D>=0;D--){var he=k[D];if(!(he.time>v))break;y++,O.push(he)}T.unreadMsgs=O,T.unread=y,g.logger.info("session::markUnreadBySessionAck: unread ".concat(y)),g.syncing?g.cacheSyncedSession(T):c&&g.onUpdateSession(T)}}}}},function(t,r,e){var n=e(35).fn;n.processChatroom=function(o){switch(o.cmd){case"getChatroomAddress":this.onChatroomAddress(o)}},n.onChatroomAddress=function(o){o.error||(o.obj.address=o.content.address)}},function(t,r,e){var n=e(35).fn;n.processQchat=function(o){switch(o.cmd){case"getQChatAddress":this.onQChatAddress(o)}},n.onQChatAddress=function(o){o.error||(o.obj.address=o.content.address)}},function(t,r,e){e(35).fn.processFilter=function(n){switch(n.cmd){case"sendFilterMsg":this.onSendMsg(n,!0);break;case"filterMsg":this.onMsg(n,!0);break;case"filterSysMsg":this.onSysMsg(n,!0);break;case"sendFilterCustomSysMsg":this.onSendSysMsg(n,!0)}}},function(t,r,e){var n=e(8),o=e(44),s=e(35).fn,a=e(0),i=o.clientTypeMap;function u(d){d=d||{};var c=a.copy(d);return c.clientType&&(c.clientType=i[c.clientType]||""),c.serverCustom&&(c.custom=JSON.parse(c.serverCustom),typeof c.custom[0]=="string"&&(c.custom=c.custom[0]),delete c.serverCustom),c}s.processEventService=function(d){var c=d.content,m=d.error,v=this.options||{};switch(m&&(m.callFunc="events::processsEventService",this.onCustomError("","EVENT_SERVICE_ERROR",m)),d.cmd){case"pushEvent":if(a.isFunction(v.onpushevents)){var g={msgEvents:[u(c.msgEvent)]};v.onpushevents(g)}break;case"pushEvents":if(a.isFunction(v.onpushevents)){var b=c.msgEvents;b={msgEvents:n(b).call(b,function(T){return u(T)})},v.onpushevents(b)}}}},function(t,r,e){var n=e(35).fn,o=e(0);n.processProxyService=function(s){var a=s.error;switch(a&&(a.callFunc="events::processProxyService",this.onCustomError("proxyService","EVENT_PROXY_SERVICE_ERROR",a)),s.cmd){case"onProxyMsg":if(o.isFunction(this.options.onProxyMsg)){var i=s.content.proxyMsg||{};i.time&&(i.time=+i.time),this.options.onProxyMsg(i)}break;case"httpProxy":s.obj=s.content&&s.content.proxyTag}}},function(t,r,e){var n=e(9),o=e(8),s=e(0),a=function(y){this.account=y.account},i=a.prototype,u=i.Message=e(72),d=i.TextMessage=e(829),c=i.FileMessage=e(204),m=i.GeoMessage=e(833),v=i.NotificationMessage=e(834),g=i.CustomMessage=e(835),b=i.TipMessage=e(836),T=i.RobotMessage=e(837),k=i.G2Message=e(838);i.validScenes=u.validScenes,i.validTypes=u.validTypes,i.sceneMap=u.sceneMap,i.sceneReverseMap=u.sceneReverseMap,i.reverse=function(y){var O;switch(u.getType(y)){case"text":O=n(d).call(d,y);break;case"image":case"audio":case"video":case"file":O=n(c).call(c,y);break;case"geo":O=n(m).call(m,y);break;case"notification":O=n(v).call(v,y);break;case"custom":O=n(g).call(g,y);break;case"tip":O=n(b).call(b,y);break;case"g2":O=n(k).call(k,y);break;case"robot":O=n(T).call(T,y);break;default:O=n(u).call(u,y)}return u.setExtra(O,this.account),O},i.reverseMsgs=function(y,O){var D,he,ae=this;return o(y).call(y,function(Ne){return Ne=n(ae).call(ae,Ne),O&&((D=O.modifyObj)&&(Ne=s.merge(Ne,D)),he=O.mapper,s.isFunction(he)&&(Ne=he(Ne))),Ne})},t.exports=a},function(t,r,e){var n=e(18),o=e(9),s=e(72),a=e(0);function i(u){a.verifyOptions(u,"text","msg::TextMessage"),u.type="text",s.call(this,u)}i.prototype=n(s.prototype),i.reverse=function(u){return o(s).call(s,u)},t.exports=i},function(t,r,e){var n=e(18),o=e(204);function s(){}s.prototype=n(o.prototype),s.verifyFile=function(a,i){return!0},t.exports=s},function(t,r,e){var n=e(18),o=e(204);function s(){}s.prototype=n(o.prototype),s.verifyFile=function(){},t.exports=s},function(t,r,e){var n=e(18),o=e(204);function s(){}s.prototype=n(o.prototype),s.verifyFile=function(){},t.exports=s},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(72),i=e(0);function u(d){d.type="geo",i.verifyOptions(d,"geo","msg::GeoMessage"),i.verifyOptions(d.geo,"lng lat title",!0,"geo.","msg::GeoMessage"),i.verifyParamType("geo.lng",d.geo.lng,"number","msg::GeoMessage"),i.verifyParamType("geo.lat",d.geo.lat,"number","msg::GeoMessage"),i.verifyParamType("geo.title",d.geo.title,"string","msg::GeoMessage"),a.call(this,d),this.attach=n(d.geo)}u.prototype=o(a.prototype),u.reverse=function(d){var c=s(a).call(a,d);return d.attach=d.attach?""+d.attach:"",c.geo=d.attach?JSON.parse(d.attach):{},c},t.exports=u},function(t,r,e){var n=e(18),o=e(9),s=e(8),a=e(171),i=e(0).notundef,u=e(72),d=e(147).IM,c=e(192),m=e(203),v={0:"addTeamMembers",1:"removeTeamMembers",2:"leaveTeam",3:"updateTeam",4:"dismissTeam",5:"passTeamApply",6:"transferTeam",7:"addTeamManagers",8:"removeTeamManagers",9:"acceptTeamInvite",10:"updateTeamMute",101:"netcallMiss",102:"netcallBill",103:"netcallReject",401:"addSuperTeamMembers",402:"removeSuperTeamMembers",403:"leaveSuperTeam",404:"updateSuperTeam",405:"dismissSuperTeam",406:"transferSuperTeam",407:"addSuperTeamManagers",408:"removeSuperTeamManagers",409:"updateSuperTeamMembersMute",410:"passSuperTeamApply",411:"acceptSuperTeamInvite"};function g(){}g.prototype=n(u.prototype),g.reverse=function(b){var T=o(u).call(u,b);if(b.attach=b.attach?""+b.attach:"",b.attach){var k=JSON.parse(b.attach);if(T.attach={type:v[k.id]||k.id},i(k.data)){var y,O,D=k.data;i(D.tinfo)&&(T.attach.team=o(c).call(c,d.syncUnserialize(D.tinfo,"team"),!0)),i(D.ids)&&(T.attach.accounts=D.ids),i(D.id)&&(T.attach.account=D.id),i(D.uinfos)&&(T.attach.users=s(y=D.uinfos).call(y,function(he){return o(m).call(m,d.syncUnserialize(he,"user"))})),i(D.mute)&&(T.attach.mute=+D.mute==1),i(D.attach)&&(T.attach.custom=D.attach),i(D.channel)&&(T.attach.channelId=D.channel),i(D.calltype)&&(T.attach.netcallType=D.calltype),i(D.duration)&&(T.attach.duration=D.duration),i(D.time)&&(T.attach.time=D.time),i(D.from)&&(T.attach.from=D.from),i(D.ext)&&(T.attach.ext=D.ext),T.attach.accounts&&T.attach.accounts.length<=2&&T.from===T.to&&a(O=T.attach.accounts).call(O,function(he){if(he!==T.to)return T.to=he,!0})}}else T.attach={};return T},t.exports=g},function(t,r,e){var n=e(18),o=e(9),s=e(72),a=e(0);function i(u){a.verifyOptions(u,"content","msg::CustomMessage"),u.type="custom",s.call(this,u),this.attach=u.content}i.prototype=n(s.prototype),i.reverse=function(u){var d=o(s).call(s,u);return d.content=u.attach,d},t.exports=i},function(t,r,e){var n=e(18),o=e(9),s=e(72),a=e(0);function i(u){a.verifyOptions(u,"tip","msg::TipMessage"),u.type="tip",s.call(this,u),this.body=u.tip}i.prototype=n(s.prototype),i.reverse=function(u){var d=o(s).call(s,u);return d.text="",d.tip=u.body,u.attach&&(d.attach=u.attach),d},t.exports=i},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(8),i=e(72),u=e(0),d={welcome:"00",text:"01",link:"03"},c={"01":"text","02":"image","03":"answer",11:"template"};function m(v){u.verifyOptions(v,"content","msg::RobotMessage"),u.undef(v.robotAccid)&&(v.robotAccid=v.to);var g=v.content;switch(g.type){case"welcome":u.undef(v.body)&&(this.body="");break;case"text":u.verifyOptions(g,"content","msg::RobotMessage"),u.undef(v.body)&&(this.body=g.content);break;case"link":u.verifyOptions(g,"target","msg::RobotMessage")}g.type&&(g.type=d[g.type]),g={param:g,robotAccid:v.robotAccid},this.attach=n(g),v.type="robot",i.call(this,v)}m.prototype=o(i.prototype),m.reverse=function(v){var g=s(i).call(i,v);if(g.type==="robot"){var b=JSON.parse(v.attach);if(b.param&&(b.param.type=c[b.param.type]||"unknown"),b.robotMsg){var T=(b=u.merge(b,b.robotMsg)).message;b.flag==="bot"?b.message=a(T).call(T,function(k){return k.type=c[k.type]||"unknown",k}):b.flag,delete b.robotMsg}g.content=b}return g},t.exports=m},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(72),i=e(0);function u(d){i.verifyOptions(d,"attach","msg::G2Message"),d.type="g2",a.call(this,d),this.attach=n(d.attach)}u.prototype=o(a.prototype),u.reverse=function(d){var c=s(a).call(a,d);return d.attach&&(c.attach=JSON.parse(d.attach)),c},t.exports=u},function(t,r,e){var n=e(58),o=e(102),s=e(26),a=e(103),i=e(8),u=e(17),d=e(6),c=e(3),m=e(2),v=e(41),g=e(5),b=e(59),T=e(60),k=e(61),y=e(62),O=e(47);function D(_e,Ce){var ze=g(_e);if(b){var ie=b(_e);Ce&&(ie=u(ie).call(ie,function(le){return T(_e,le).enumerable})),ze.push.apply(ze,ie)}return ze}function he(_e){for(var Ce=1;Ce<arguments.length;Ce++){var ze,ie,le=arguments[Ce]!=null?arguments[Ce]:{};Ce%2?m(ze=D(Object(le),!0)).call(ze,function(Ie){n(_e,Ie,le[Ie])}):k?y(_e,k(le)):m(ie=D(Object(le))).call(ie,function(Ie){O(_e,Ie,T(le,Ie))})}return _e}var ae=e(39).fn,Ne=e(0),ue=Ne.isArray,Y=e(150);ae.mergeObjArray=function(_e,Ce,ze){return _e||(_e=[]),Ce?(ue(Ce)||(Ce=[Ce]),Ce.length?(ze=ze||{},Ne.mergeObjArray(_e,Ce,ze)):_e):_e},ae.cutObjArray=function(_e,Ce,ze){return _e&&Ce?(ue(Ce)||(Ce=[Ce]),Ce.length?(ze=ze||{},Ne.cutObjArray(_e,Ce,ze)):_e):_e},ae.mergeLoginPorts=function(_e,Ce){return this.mergeObjArray(_e,Ce,{keyPath:"deviceId"})},ae.cutLoginPorts=function(_e,Ce){return this.cutObjArray(_e,Ce,{keyPath:"deviceId",sortPath:"type"})},ae.mergeRelations=function(_e,Ce){return this.mergeObjArray(_e,Ce,{keyPath:"account"})},ae.cutRelations=function(_e,Ce){return this.cutObjArray(_e,Ce,{keyPath:"account"})},ae.findRelation=function(_e,Ce){return Ne.findObjInArray(_e,{keyPath:"account",value:Ce})},ae.mergeFriends=function(_e,Ce){return this.mergeObjArray(_e,Ce,{keyPath:"account"})},ae.cutFriends=function(_e,Ce){return this.cutObjArray(_e,Ce,{keyPath:"account"})},ae.cutFriendsByAccounts=function(_e,Ce){ue(Ce)||(Ce=[Ce]);var ze=i(Ce).call(Ce,function(ie){return{account:ie}});return this.cutFriends(_e,ze)},ae.findFriend=function(_e,Ce){return Ne.findObjInArray(_e,{keyPath:"account",value:Ce})},ae.mergeUsers=function(_e,Ce){return this.mergeObjArray(_e,Ce,{keyPath:"account"})},ae.findUser=function(_e,Ce){return Ne.findObjInArray(_e,{keyPath:"account",value:Ce})},ae.mergeTeams=function(_e,Ce){return this.mergeObjArray(_e,Ce,{keyPath:"teamId"})},ae.cutTeams=function(_e,Ce){return this.cutObjArray(_e,Ce,{keyPath:"teamId"})},ae.findTeam=function(_e,Ce){return Ne.findObjInArray(_e,{keyPath:"teamId",value:Ce})},ae.assembleTeamOwner=Y.assembleOwner,ae.assembleTeamMembers=Y.assembleMembers,ae.genTeamMemberId=Y.genId,ae.mergeTeamMembers=function(_e,Ce){return this.mergeObjArray(_e,Ce)},ae.cutTeamMembers=function(_e,Ce){return this.cutObjArray(_e,Ce)},ae.cutTeamMembersByAccounts=function(_e,Ce,ze){ue(ze)||(ze=[ze]);var ie=Y.assembleMembers({teamId:Ce},ze);return this.cutTeamMembers(_e,ie)},ae.findTeamMember=function(_e,Ce){return Ne.findObjInArray(_e,{keyPath:"id",value:Ce})},ae.mergeSessions=function(_e,Ce){return this.mergeObjArray(_e,Ce,{sortPath:"updateTime",desc:!0})},ae.cutSessions=function(_e,Ce){return this.cutObjArray(_e,Ce)},ae.cutSessionsByIds=function(_e,Ce){ue(Ce)||(Ce=[Ce]);var ze=i(Ce).call(Ce,function(ie){return{id:ie}});return this.cutSessions(_e,ze)},ae.findSession=function(_e,Ce){return Ne.findObjInArray(_e,{keyPath:"id",value:Ce})},ae.mergeMsgs=function(_e,Ce){return this.mergeObjArray(_e,Ce,{keyPath:"idClient",sortPath:"time"})},ae.cutMsgs=function(_e,Ce){return this.cutObjArray(_e,Ce,{keyPath:"idClient"})},ae.cutMsgsByIdClients=function(_e,Ce){ue(Ce)||(Ce=[Ce]);var ze=i(Ce).call(Ce,function(ie){return{idClient:ie}});return this.cutMsgs(_e,ze)},ae.findMsg=function(_e,Ce){return Ne.findObjInArray(_e,{keyPath:"idClient",value:Ce})},ae.mergeSysMsgs=function(_e,Ce){return this.mergeObjArray(_e,Ce,{keyPath:"idServer",desc:!0})},ae.cutSysMsgs=function(_e,Ce){return this.cutObjArray(_e,Ce,{keyPath:"idServer"})},ae.cutSysMsgsByIdServers=function(_e,Ce){ue(Ce)||(Ce=[Ce]);var ze=i(Ce).call(Ce,function(ie){return{idServer:ie}});return this.cutSysMsgs(_e,ze)},ae.findSysMsg=function(_e,Ce){return Ne.findObjInArray(_e,{keyPath:"idServer",value:Ce})},ae.searchLocal=function(_e){if(Ne.verifyOptions(_e,"keyword","searchLocal"),this.db.enable){var Ce,ze=this,ie=this.db,le=_e.keyword+"",Ie=["account","nick","alias"],pe=["id","scene","lastMsg.type","lastMsg.text","localCustom","target.account","target.nick","target.alias","target.name"],qe="",$e=_e.keyPath;switch($e?(qe=($e=($e+"").split(".")).shift(),$e=$e.join(".")):qe="all",qe){case"user":$e&&(Ie=u(Ie).call(Ie,function(ir){return ir===$e||d(ir).call(ir,$e+".")===0})),dr(Ie).then(function(ir){_e.done(null,{sessions:[],users:ir})});break;case"session":$e&&(pe=u(pe).call(pe,function(ir){return ir===$e||d(ir).call(ir,$e+".")===0})),Lt(pe,!$e||d($e).call($e,"target")>-1).then(function(ir){_e.done(null,{sessions:ir,users:[]})});break;case"all":sr().then(function(){c.all([Lt(pe,!0),dr(Ie)]).then(function(ir){_e.done(null,{sessions:ir[0],users:ir[1]})})});break;default:_e.done(null,{sessions:[],users:[],msg:'keyPath must start with "user" or "session"'})}}else _e.done(null,{sessions:[],users:[],msg:"no db"});function Lt(ir,Ue){return Dt.apply(this,arguments)}function Dt(){return(Dt=a(o.mark(function ir(Ue,rr){var or;return o.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return or=rr?[ie.getSessions(),sr(),ie.getTeams(),ie.getSuperTeams()]:[ie.getSessions()],Pt.abrupt("return",c.all(or).then(function(Et){var kt,er=Et[0]||[],cr={p2p:Et[1]||[],team:Et[2]||[],superTeam:Et[3]||[]},mr={};return rr&&(m(kt=g(cr)).call(kt,function(vr){var Tr;m(Tr=cr[vr]).call(Tr,function(Ir){var kr=Ir.teamId||Ir.account;mr[vr+"-"+kr]=Ir})}),m(er).call(er,function(vr){vr.target=mr[vr.id]})),Fe(Ue,er)}));case 2:case"end":return Pt.stop()}},ir)}))).apply(this,arguments)}function dr(ir){return pr.apply(this,arguments)}function pr(){return(pr=a(o.mark(function ir(Ue){var rr;return o.wrap(function(or){for(;;)switch(or.prev=or.next){case 0:return or.next=2,sr();case 2:return rr=or.sent,or.abrupt("return",Fe(Ue,rr));case 4:case"end":return or.stop()}},ir)}))).apply(this,arguments)}function sr(){return hr.apply(this,arguments)}function hr(){return(hr=a(o.mark(function ir(){var Ue,rr;return o.wrap(function(or){for(;;)switch(or.prev=or.next){case 0:if(!Ce){or.next=2;break}return or.abrupt("return",Ce);case 2:return or.next=4,ze.db.getFriends();case 4:if(or.t0=or.sent,or.t0){or.next=7;break}or.t0=[];case 7:return Ue=or.t0,rr=ze.protocol.userSet||{},Ce=i(Ue).call(Ue,function(Pt){return he(he({},Pt),rr[Pt.account])}),or.abrupt("return",Ce);case 11:case"end":return or.stop()}},ir)}))).apply(this,arguments)}function Fe(ir,Ue){var rr=[];return m(Ue).call(Ue,function(or){for(var Pt=0;Pt<ir.length;Pt++){var Et=nr(or,ir[Pt].split("."));if(Et&&d(Et).call(Et,le)>-1){rr.push(v({},or));break}}}),rr}function nr(ir,Ue){if(s(ir)==="object"&&ir)return Ue.length===1?ir[Ue[0]]:nr(ir[Ue.shift()],Ue)}}},function(t,r,e){var n=e(15),o=e(39).fn,s=e(0),a=e(24).reportAPI;o.kick=function(i){var u;(i=i||{}).done=a({instance:this,className:"NIMFn",funcName:"kick",done:i.done}),s.verifyOptions(i,"deviceIds","link::kick"),this.processCallback(i),this.sendCmd("kick",{deviceIds:n(u=i.deviceIds).call(u,0)},i.callback)},o.disconnect=function(i){(i=i||{}).done=a({instance:this,className:"NIMFn",funcName:"disconnect",done:i.done}),i=i||{},this.protocol.disconnect(i.done)}},function(t,r,e){var n=e(39).fn,o=e(0),s=e(24).reportAPI;n.markInBlacklist=function(a){(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"markInBlacklist",done:a.done}),o.verifyOptions(a,"account isAdd","relation::markInBlacklist"),o.verifyParamType("isAdd",a.isAdd,"boolean","relation::markInBlacklist"),this.processCallback(a),this.sendCmd("markInBlacklist",{account:a.account,isAdd:a.isAdd},a.callback)},n.addToBlacklist=function(a){return(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"addToBlacklist",done:a.done}),a.isAdd=!0,this.markInBlacklist(a)},n.removeFromBlacklist=function(a){return(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"removeFromBlacklist",done:a.done}),a.isAdd=!1,this.markInBlacklist(a)},n.markInMutelist=function(a){(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"markInMutelist",done:a.done}),o.verifyOptions(a,"account","relation::markInMutelist"),o.verifyParamType("isAdd",a.isAdd,"boolean","relation::markInMutelist"),this.processCallback(a),this.sendCmd("markInMutelist",{account:a.account,isAdd:a.isAdd},a.callback)},n.addToMutelist=function(a){return(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"addToMutelist",done:a.done}),a.isAdd=!0,this.markInMutelist(a)},n.removeFromMutelist=function(a){return(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"removeFromMutelist",done:a.done}),a.isAdd=!1,this.markInMutelist(a)},n.getRelations=function(a){(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"getRelations",done:a.done});var i=this,u=i.db,d=0;function c(){i.sendCmd("getRelations",{timetag:d,NOTSTORE:"timetag"},a.callback)}a=o.verifyOptions(a),i.processCallback(a),u.enable?u.getRelationsTimetag().then(function(m){d=m,c()},c):c()}},function(t,r,e){var n=e(7),o=e(2),s=e(6),a=e(39).fn,i=e(0),u=i.objs2accounts,d=e(203),c=e(24).reportAPI;a.updateMyInfo=function(m){(m=m||{}).done=c({instance:this,className:"NIMFn",funcName:"updateMyInfo",done:m.done}),i.verifyOptions(m),this.processCallback(m),m.user=new d(m),delete m.user.account,this.sendCmd("updateMyInfo",{user:m.user,antispamTag:{antiSpamBusinessId:m.antiSpamBusinessId},single:!0},m.callback)},a.getMyInfo=function(m){return(m=m||{}).done=c({instance:this,className:"NIMFn",funcName:"getMyInfo",done:m.done}),(m=m||{}).account=this.account,this.getUser(m)},a.getUser=function(m){(m=m||{}).done=c({instance:this,className:"NIMFn",funcName:"getUser",done:m.done});var v,g=this,b=g.db;function T(){g.sendCmd("getUsers",{accounts:[v],single:!0},m.callback)}i.verifyOptions(m,"account","user::getUser"),g.processCallback(m),m.cbaop=function(k,y){if(!k)return y=y[0]||null,g.logger.info("api::getUser: cbaop ".concat(v)),y},v=m.account,m.sync?T():b.enable?b.getUser(v).then(function(k){k?m.done(null,k):T()},T):T()},a.getUsers=function(m){(m=m||{}).done=c({instance:this,className:"NIMFn",funcName:"getUsers",done:m.done});var v,g=this,b=g.db,T=[];function k(){g.sendCmd("getUsers",{accounts:v,single:!0},m.callback)}i.verifyOptions(m,"accounts","user::getUsers"),i.verifyParamType("accounts",m.accounts,"array","user::getUsers"),g.processCallback(m),m.cbaop=function(y,O){if(!y)return O=n(O).call(O,T),g.logger.info("api::getUsers: cbaop ".concat(v)),O},v=i.deduplicate(m.accounts),i.verifyArrayMax("accounts",m.accounts,150,"user::getUsers"),m.sync?k():b.enable?b.getUsers(v).then(function(y){if(y&&y.length===v.length)m.done(null,y);else{T=y;var O=u(y),D=[];o(v).call(v,function(he){s(O).call(O,he)===-1&&D.push(he)}),v=D,k()}},k):k()}},function(t,r,e){var n=e(138),o=e(39).fn,s=e(0),a=s.notundef,i=e(750),u=e(24).reportAPI;o.friendRequest=function(d){(d=d||{}).done=u({instance:this,className:"NIMFn",funcName:"friendRequest",done:d.done}),s.verifyOptions(d,"type account","friend::friendRequest"),s.verifyParamValid("type",d.type,i.validTypes(),"friend::friendRequest"),this.processPs(d),this.processCallback(d);var c={account:d.account,type:i.getByteFromType(d.type),ps:d.ps};a(d.idServer)&&(c.idServer=d.idServer),this.sendCmd("friendRequest",c,d.callback)},o.addFriend=function(d){(d=d||{}).done=u({instance:this,className:"NIMFn",funcName:"addFriend",done:d.done}),d.type="addFriend",this.friendRequest(d)},o.applyFriend=function(d){(d=d||{}).done=u({instance:this,className:"NIMFn",funcName:"applyFriend",done:d.done}),d.type="applyFriend",this.friendRequest(d)},o.passFriendApply=function(d){(d=d||{}).done=u({instance:this,className:"NIMFn",funcName:"passFriendApply",done:d.done}),s.verifyOptions(d,"idServer","friend::passFriendApply"),d.type="passFriendApply",this.friendRequest(d)},o.rejectFriendApply=function(d){(d=d||{}).done=u({instance:this,className:"NIMFn",funcName:"rejectFriendApply",done:d.done}),s.verifyOptions(d,"idServer","friend::rejectFriendApply"),d.type="rejectFriendApply",this.friendRequest(d)},o.deleteFriend=function(d){(d=d||{}).done=u({instance:this,className:"NIMFn",funcName:"deleteFriend",done:d.done}),s.verifyOptions(d,"account","friend::deleteFriend");var c=d.delAlias===!0;this.processCallback(d),this.sendCmd("deleteFriend",{account:d.account,delFriendParams:{delAlias:c?1:0}},d.callback)},o.updateFriend=function(d){(d=d||{}).done=u({instance:this,className:"NIMFn",funcName:"updateFriend",done:d.done}),this.processCallback(d);var c=new i(d);this.sendCmd("updateFriend",{friend:c,single:!0},d.callback)},o.getFriends=function(d){(d=d||{}).done=u({instance:this,className:"NIMFn",funcName:"getFriends",done:d.done});var c=this.db;s.validate({timetag:{type:"number",required:!1}},d,"friend::getFriends"),this.processCallback(d),c.enable?c.getFriends({updateTime:d.updateTime||0}).then(function(m){(m=n(m).call(m,function(v,g){return v.updateTime-g.updateTime})).invalid=[],d.done(null,m)}):this.sendCmd("getFriends",{timetag:d.updateTime||0,NOTSTORE:"timetag"},d.callback)},o.isMyFriend=function(d){(d=d||{}).done=u({instance:this,className:"NIMFn",funcName:"isMyFriend",done:d.done});var c=this.db;s.validate({account:{type:"string",allowEmpty:!1,require:!0}},d),this.processCallback(d),c.enable||d.done(null,!1),c.getFriend(d.account).then(function(m){m&&m.valid===!0?d.done(null,!0):d.done(null,!1)})},o.isUserInBlackList=function(d){(d=d||{}).done=u({instance:this,className:"NIMFn",funcName:"isUserInBlackList",done:d.done});var c=this.db;s.validate({account:{type:"string",allowEmpty:!1,require:!0}},d),this.processCallback(d),c.enable||d.done(null,!1),c.getUserFromBlackList(d.account).then(function(m){m&&m.account?d.done(null,!0):d.done(null,!1)})}},function(t,r,e){var n=e(39).fn,o=e(24).reportAPI;n.getRobots=function(s){(s=s||{}).done=o({instance:this,className:"NIMFn",funcName:"getRobots",done:s.done}),this.logger.warn("this api will be abandon"),(s=s||{}).type="getRobots",this.processCallback(s),this.sendCmd("sync",{sync:{robots:0}},s.callback)}},function(t,r,e){var n=e(15),o=e(8),s=e(17),a=e(3),i=e(39).fn,u=e(0),d=u.undef,c=e(192),m=e(150),v=e(24).reportAPI;i.createTeam=function(g){var b;(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"createTeam",done:g.done}),u.verifyOptions(g,"type name","team::createTeam"),d(g.accounts)?g.accounts=[]:u.verifyParamType("accounts",g.accounts,"array","team::createTeam"),g.action="create",this.processPs(g),this.processCallback(g),g.team=new c(g);var T={team:g.team,accounts:n(b=g.accounts).call(b,0),ps:g.ps,antispamTag:{antiSpamBusinessId:g.antiSpamBusinessId}};this.sendCmd("createTeam",T,g.callback)},i.updateTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"updateTeam",done:g.done}),u.verifyOptions(g,"teamId","team::updateTeam"),g.action="update",this.processCallback(g),g.team=new c(g),this.sendCmd("updateTeam",{team:g.team,antispamTag:{antiSpamBusinessId:g.antiSpamBusinessId},single:!0},g.callback)},i.addTeamMembers=function(g){var b;(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"addTeamMembers",done:g.done}),u.verifyOptions(g,"teamId accounts","team::addTeamMembers"),u.verifyParamType("accounts",g.accounts,"array","team::addTeamMembers"),this.processPs(g),u.notexist(g.custom)&&(g.custom=""),this.processCallback(g);var T={teamId:g.teamId,accounts:n(b=g.accounts).call(b,0),ps:g.ps,attach:g.custom};this.sendCmd("addTeamMembers",T,g.callback)},i.removeTeamMembers=function(g){var b;(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"removeTeamMembers",done:g.done}),u.verifyOptions(g,"teamId accounts","team::removeTeamMembers"),u.verifyParamType("accounts",g.accounts,"array","team::removeTeamMembers"),this.processCallback(g);var T={teamId:g.teamId,accounts:n(b=g.accounts).call(b,0)};this.sendCmd("removeTeamMembers",T,g.callback)},i.acceptTeamInvite=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"acceptTeamInvite",done:g.done}),u.verifyOptions(g,"idServer teamId from","team::acceptTeamInvite"),this.processCallback(g);var b={idServer:g.idServer,teamId:g.teamId,from:g.from,type:"teamInvite"};this.sendCmd("acceptTeamInvite",b,g.callback)},i.rejectTeamInvite=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"rejectTeamInvite",done:g.done}),u.verifyOptions(g,"idServer teamId from","team::rejectTeamInvite"),this.processPs(g),this.processCallback(g);var b={idServer:g.idServer,teamId:g.teamId,from:g.from,ps:g.ps,type:"teamInvite"};this.sendCmd("rejectTeamInvite",b,g.callback)},i.applyTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"applyTeam",done:g.done}),u.verifyOptions(g,"teamId","team::applyTeam"),this.processPs(g),this.processCallback(g);var b={teamId:g.teamId,ps:g.ps};this.sendCmd("applyTeam",b,g.callback)},i.passTeamApply=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"passTeamApply",done:g.done}),u.verifyOptions(g,"idServer teamId from","team::passTeamApply"),this.processCallback(g);var b={idServer:g.idServer,teamId:g.teamId,from:g.from,type:"applyTeam"};this.sendCmd("passTeamApply",b,g.callback)},i.rejectTeamApply=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"rejectTeamApply",done:g.done}),u.verifyOptions(g,"idServer teamId from","team::rejectTeamApply"),this.processPs(g),this.processCallback(g);var b={idServer:g.idServer,teamId:g.teamId,from:g.from,ps:g.ps,type:"applyTeam"};this.sendCmd("rejectTeamApply",b,g.callback)},i.addTeamManagers=function(g){var b;(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"addTeamManagers",done:g.done}),u.verifyOptions(g,"teamId accounts","team::addTeamManagers"),u.verifyParamType("accounts",g.accounts,"array","team::addTeamManagers"),this.processCallback(g);var T={teamId:g.teamId,accounts:n(b=g.accounts).call(b,0)};this.sendCmd("addTeamManagers",T,g.callback)},i.removeTeamManagers=function(g){var b;(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"removeTeamManagers",done:g.done}),u.verifyOptions(g,"teamId accounts","team::removeTeamManagers"),u.verifyParamType("accounts",g.accounts,"array","team::removeTeamManagers"),this.processCallback(g);var T={teamId:g.teamId,accounts:n(b=g.accounts).call(b,0)};this.sendCmd("removeTeamManagers",T,g.callback)},i.updateInfoInTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"updateInfoInTeam",done:g.done}),u.verifyOptions(g,"teamId","team::updateInfoInTeam"),this.processCallback(g),this.sendCmd("updateInfoInTeam",{teamMember:new m(g),single:!0},g.callback)},i.updateNickInTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"updateNickInTeam",done:g.done}),u.verifyOptions(g,"teamId account","team::updateNickInTeam"),this.processCallback(g),this.sendCmd("updateNickInTeam",{teamMember:new m(g),single:!0},g.callback)},i.updateMuteStateInTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"updateMuteStateInTeam",done:g.done}),u.verifyOptions(g,"teamId account mute","team::updateMuteStateInTeam"),this.processCallback(g),g.mute=g.mute?1:0,this.sendCmd("updateMuteStateInTeam",g)},i.getMutedTeamMembers=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getMutedTeamMembers",done:g.done}),u.verifyOptions(g,"teamId","team::getMutedTeamMembers"),this.processCallback(g),this.sendCmd("getMutedTeamMembers",g)},i.leaveTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"leaveTeam",done:g.done}),u.verifyOptions(g,"teamId","team::leaveTeam"),this.processCallback(g);var b={teamId:g.teamId};this.sendCmd("leaveTeam",b,g.callback)},i.transferTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"transferTeam",done:g.done}),u.verifyOptions(g,"teamId account leave","team::transferTeam"),u.verifyParamType("leave",g.leave,"boolean","team::transferTeam"),this.processCallback(g);var b={teamId:g.teamId,account:g.account,leave:g.leave};this.sendCmd("transferTeam",b,g.callback)},i.dismissTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"dismissTeam",done:g.done}),u.verifyOptions(g,"teamId","team::dismissTeam"),this.processCallback(g);var b={teamId:g.teamId};this.sendCmd("dismissTeam",b,g.callback)},i.getTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeam",done:g.done});var b,T=this,k=T.db;function y(){T.sendCmd("getTeam",{teamId:g.teamId},g.callback)}u.verifyOptions(g,"teamId","team::getTeam"),T.processCallback(g),g.cbaop=function(O){O||T.logger.info("api::getTeam: cbaop ".concat(b))},b=g.teamId,k.enable&&!g.sync?k.getTeam(b).then(function(O){O&&O.validToCurrentUser?(T.logger.log("api::getTeam: db.getTeam ".concat(b)),g.done(null,O)):y()},y):y()},i.getTeams=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeams",done:g.done});var b=this,T=b.db,k=0;function y(){b.sendCmd("getTeams",{timetag:k,NOTSTORE:"timetag"},g.callback)}u.verifyOptions(g),b.processCallback(g),T.enable?T.getTeamsTimetag().then(function(O){k=O,y()},y):y()},i.getTeamsById=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeamsById",done:g.done}),u.verifyOptions(g,"teamIds","teams::getTeamsById"),this.processCallback(g),this.sendCmd("getTeamsById",{teamIds:g.teamIds},g.callback)},i.getTeamMembers=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeamMembers",done:g.done});var b=this;u.verifyOptions(g,"teamId","team::getTeamMembers"),b.processCallback(g),b.sendCmd("getTeamMembers",{teamId:g.teamId,timetag:0,NOTSTORE:"timetag"},g.callback)},i.getTeamMemberByTeamIdAndAccount=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeamMemberByTeamIdAndAccount",done:g.done});var b=this;u.verifyParamType("teamId",g.teamId,"numeric or numeric string","team::getTeamMemberByTeamIdAndAccount"),u.verifyOptions(g,"account","team::getTeamMemberByTeamIdAndAccount"),b.processCallback(g),b.sendCmd("getTeamMembers",{teamId:g.teamId,timetag:0,NOTSTORE:"timetag"},function(T,k,y){var O={};if(k&&k.members&&k.members.length){for(var D=0;D<k.members.length;D++)if(k.members[D].account===g.account){O[g.account]=k.members[D];break}}g.callback(T,O,y)})},i.getTeamMemberInvitorAccid=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeamMemberInvitorAccid",done:g.done}),u.verifyParamType("teamId",g.teamId,"numeric or numeric string","team::getTeamMemberInvitorAccid"),d(g.accounts)||(u.verifyParamType("accounts",g.accounts,"array","team::getTeamMemberInvitorAccid"),g.accounts.length>200&&u.onParamError("accounts 200","team::getTeamMemberInvitorAccid"));var b,T={teamId:g.teamId};g.accounts.length&&(T.accounts=n(b=g.accounts).call(b,0)),this.processCallback(g),this.sendCmd("getTeamMemberInvitorAccid",T,function(k,y,O){g.callback(k,O&&O.accountsMap||{})})},i.notifyForNewTeamMsg=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"notifyForNewTeamMsg",done:g.done}),u.verifyOptions(g,"teamIds","team::notifyForNewTeamMsg"),this.protocol.notifyForNewTeamMsg(g.teamIds).then(function(b){g.done(b.error||null,o(b),b.miss)},function(b){g.done(b)})},i.getMyTeamMembers=function(g){v({instance:this,className:"NIMFn",funcName:"getMyTeamMembers",hasCallback:!1}),u.verifyOptions(g,"teamIds","team::getMyTeamMembers");var b=this.processCallbackPromise(g);return this.sendCmd("getMyTeamMembers",g),b},i.getLocalTeams=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getLocalTeams",done:g.done});var b,T=this.db,k=[];function y(){g.teams=k,g.done(b,g)}u.verifyOptions(g,"teamIds","team::getLocalTeams"),u.verifyParamType("teamIds",g.teamIds,"array","team::getLocalTeams"),this.processCallback(g),T.enable?T.getTeamsByTeamIds(g.teamIds).then(function(O){k=s(O).call(O,function(D){return!!D}),y()},function(O){b=O,y()}):y()},i.getLocalTeamMembers=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getLocalTeamMembers",done:g.done});var b,T=this.db,k=[];function y(){g.members=k,g.done(b,g)}u.verifyOptions(g,"teamId accounts","team::getLocalTeamMembers"),u.verifyParamType("accounts",g.accounts,"array","team::getLocalTeamMembers"),this.processCallback(g),T.enable?T.getInvalidTeamMembers(g.teamId,g.accounts).then(function(O){k=s(O).call(O,function(D){return!!D}),y()},function(O){b=O,y()}):y()},i.deleteLocalTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"deleteLocalTeam",done:g.done});var b,T=this.db;function k(){g.done(b,g)}u.verifyOptions(g,"teamId","team::deleteLocalTeam"),this.processCallback(g),T.enable?T.deleteTeam(g.teamId).then(function(){k()},function(y){b=y,k()}):k()},i.muteTeamAll=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"muteTeamAll",done:g.done}),u.verifyOptions(g,"teamId mute","team::muteTeamAll"),g.mute=g.mute?1:0,this.processCallback(g),this.sendCmd("muteTeamAll",g)},i.sendTeamMsgReceipt=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"sendTeamMsgReceipt",done:g.done}),u.verifyOptions(g,"teamMsgReceipts","team::sendTeamMsgReceipt"),g.teamMsgReceipts.length>50?this.logger.error("team::sendTeamMsgReceiptteamMsgReceipts length over 50"):(this.processCallback(g),this.sendCmd("sendTeamMsgReceipt",g))},i.getTeamMsgReads=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeamMsgReads",done:g.done}),u.verifyOptions(g,"teamMsgReceipts","team::getTeamMsgReads"),this.processCallback(g),this.sendCmd("getTeamMsgReads",g)},i.getTeamMsgReadAccounts=function(g){var b=this;(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeamMsgReadAccounts",done:g.done});var T,k=this;u.verifyOptions(g,"teamMsgReceipt","team::getTeamMsgReadAccounts"),g.callback=function(y,O,D){y&&T?(O=O||{teamMsgReceipt:g.teamMsgReceipt},g.done(y,O,{teamMsgReceipt:g.teamMsgReceipt,unreadAccounts:T.unreadAccounts,readAccounts:T.readAccounts})):g.done(y,O,D)},this.db.enable&&g.teamMsgReceipt.idClient?this.db.getMsgReadDetail(g.teamMsgReceipt.idClient).then(function(y){if(T=y,!y)return a.reject("no record");if(y.unreadAccounts&&y.unreadAccounts.length>0)return a.reject("unreadAccounts.length > 0");var O={teamMsgReceipt:g.teamMsgReceipt,unreadAccounts:y.unreadAccounts,readAccounts:y.readAccounts};k.logger.info("getTeamMsgReadAccounts from db"),g.done(null,{teamMsgReceipt:g.teamMsgReceipt},O)}).catch(function(y){b.logger.warn("db.getMsgReadDetail invalid",y),k.sendCmd("getTeamMsgReadAccounts",g)}):k.sendCmd("getTeamMsgReadAccounts",g)}},function(t,r,e){var n=e(754),o=e(3),s=e(9),a=e(25),i=e(15),u=e(8),d=e(2),c=e(7),m=e(39).fn,v=e(0),g=v.undef,b=e(307),T=e(202),k=e(24).reportAPI;function y(O){var D=this.db;if(!D.enable)return o.resolve({valid:!1});var he=D.getSuperTeam(O),ae=D.getSuperTeamMembersTimetag(O);return o.all([he,ae]).then(function(Ne){var ue=n(Ne,2),Y=ue[0],_e=ue[1],Ce=Y&&Y.memberUpdateTime,ze={timetag:_e=_e||0};return Ce&&_e>=Ce&&(ze.valid=!0),o.resolve(ze)}).catch(function(){return o.resolve({timetag:0})})}m.addSuperTeamMembers=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"addSuperTeamMembers",done:O.done}),v.verifyOptions(O,"teamId accounts","superTeam::addSuperTeamMembers"),v.verifyParamType("accounts",O.accounts,"array","superTeam::addSuperTeamMembers");var D=v.deduplicate(O.accounts);this.processPs(O),this.processCallback(O);var he={teamId:O.teamId,accounts:D,ps:O.ps};this.sendCmd("addSuperTeamMembers",he,O.callback)},m.removeSuperTeamMembers=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"removeSuperTeamMembers",done:O.done}),v.verifyOptions(O,"teamId accounts","team::removeSuperTeamMembers"),v.verifyParamType("accounts",O.accounts,"array","team::removeSuperTeamMembers");var D=v.deduplicate(O.accounts);this.processCallback(O);var he={teamId:O.teamId,accounts:D};this.sendCmd("removeSuperTeamMembers",he,O.callback)},m.leaveSuperTeam=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"leaveSuperTeam",done:O.done}),v.verifyOptions(O,"teamId","superTeam::leaveSuperTeam"),this.processCallback(O);var D={teamId:O.teamId};this.sendCmd("leaveSuperTeam",D,O.callback)},m.getSuperTeam=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"getSuperTeam",done:O.done});var D,he=this,ae=he.db;function Ne(){he.sendCmd("getSuperTeam",{teamId:O.teamId},O.callback)}v.verifyOptions(O,"teamId","team::getSuperTeam"),he.processCallback(O),O.cbaop=function(ue){ue||he.logger.info("api::getSuperTeam: cbaop ".concat(D))},D=O.teamId,ae.enable&&!O.sync?ae.getSuperTeam(D).then(function(ue){ue&&ue.validToCurrentUser?(he.logger.log("api::getSuperTeam: db.getSuperTeam ".concat(D)),O.done(null,ue)):Ne()}).catch(function(){Ne()}):Ne()},m.getSuperTeams=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"getSuperTeams",done:O.done});var D=this,he=D.db,ae=0;function Ne(){D.sendCmd("getSuperTeams",{timetag:ae,NOTSTORE:"timetag"},O.callback)}v.verifyOptions(O),D.processCallback(O),he.enable?he.getSuperTeamsTimetag().then(function(ue){ae=ue,Ne()},Ne):Ne()},m.updateSuperTeam=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"updateSuperTeam",done:O.done}),v.verifyOptions(O,"teamId","superTeam::updateSuperTeam"),O.action="update",this.processCallback(O),O.team=new b(O),this.sendCmd("updateSuperTeam",{team:O.team,antispamTag:{antiSpamBusinessId:O.antiSpamBusinessId},single:!0},O.callback)},m.updateInfoInSuperTeam=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"updateInfoInSuperTeam",done:O.done}),v.verifyOptions(O,"teamId","superTeam::updateInfoInSuperTeam"),this.processCallback(O),this.sendCmd("updateInfoInSuperTeam",{superTeamMember:new T(O),single:!0},O.callback)},m.getSuperTeamMembersByJoinTime=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"getSuperTeamMembersByJoinTime",done:O.done});var D=this,he=O,ae=he.joinTime,Ne=s(he),ue=he.limit,Y=he.teamId;Ne=!!Ne,g(ae)&&(ae=0),g(ue)&&(ue=100),v.verifyOptions(O,"teamId","superTeam::getSuperTeamMembersByJoinTime"),v.verifyParamType("joinTime",ae,"number","api::superTeam::getSuperTeamMembersByJoinTime"),v.verifyParamType("limit",ue,"number","api::superTeam::getSuperTeamMembersByJoinTime"),D.processCallback(O),D.sendCmd("getSuperTeamMembersByJoinTime",{teamId:Y,limit:ue,joinTime:ae,reverse:Ne,timetag:0,NOTSTORE:"timetag"},O.callback)},m.getAllSuperTeamMembers=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"getAllSuperTeamMembers",done:O.done});var D=this,he=this.db;function ae(Ne){Ne=Ne||0,D.sendCmd("getSuperTeamMembers",{teamId:O.teamId,timetag:Ne,NOTSTORE:"timetag"},O.callback)}v.verifyOptions(O,"teamId","superTeam::getAllSuperTeamMembers"),D.processCallback(O),a(y).call(y,this)(O.teamId).then(function(Ne){var ue=Ne.valid,Y=Ne.timetag;ue?(D.logger.info("getAllSuperTeamMembers from local db"),he.getSuperTeamMembers(O.teamId).then(function(_e){var Ce={teamId:O.teamId,members:_e};O.done(null,Ce)},function(){return ae()})):ae(Y)})},m.applySuperTeam=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"applySuperTeam",done:O.done}),v.verifyOptions(O,"teamId","team::applySuperTeam"),v.verifyOptions(O,"teamId","team::applySuperTeam"),this.processPs(O),this.processCallback(O);var D={teamId:O.teamId,ps:O.ps};this.sendCmd("applySuperTeam",D,O.callback)},m.passSuperTeamApply=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"passSuperTeamApply",done:O.done}),v.verifyOptions(O,"idServer teamId from","team::passSuperTeamApply"),this.processCallback(O);var D={idServer:O.idServer,teamId:O.teamId,from:O.from};this.sendCmd("passSuperTeamApply",D,O.callback)},m.rejectSuperTeamApply=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"rejectSuperTeamApply",done:O.done}),v.verifyOptions(O,"idServer teamId from","team::rejectSuperTeamApply"),this.processPs(O),this.processCallback(O);var D={idServer:O.idServer,teamId:O.teamId,from:O.from,ps:O.ps};this.sendCmd("rejectSuperTeamApply",D,O.callback)},m.acceptSuperTeamInvite=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"acceptSuperTeamInvite",done:O.done}),v.verifyOptions(O,"idServer teamId from","team::acceptSuperTeamInvite"),this.processCallback(O);var D={idServer:O.idServer,teamId:O.teamId,from:O.from};this.sendCmd("acceptSuperTeamInvite",D,O.callback)},m.rejectSuperTeamInvite=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"rejectSuperTeamInvite",done:O.done}),v.verifyOptions(O,"idServer teamId from","team::rejectSuperTeamInvite"),this.processPs(O),this.processCallback(O);var D={idServer:O.idServer,teamId:O.teamId,from:O.from,ps:O.ps};this.sendCmd("rejectSuperTeamInvite",D,O.callback)},m.addSuperTeamManagers=function(O){var D;(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"addSuperTeamManagers",done:O.done}),v.verifyOptions(O,"teamId accounts","team::addSuperTeamManagers"),v.verifyParamType("accounts",O.accounts,"array","team::addSuperTeamManagers"),this.processCallback(O);var he={teamId:O.teamId,accounts:i(D=O.accounts).call(D,0)};this.sendCmd("addSuperTeamManagers",he,O.callback)},m.removeSuperTeamManagers=function(O){var D;(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"removeSuperTeamManagers",done:O.done}),v.verifyOptions(O,"teamId accounts","team::removeSuperTeamManagers"),v.verifyParamType("accounts",O.accounts,"array","team::removeSuperTeamManagers"),this.processCallback(O);var he={teamId:O.teamId,accounts:i(D=O.accounts).call(D,0)};this.sendCmd("removeSuperTeamManagers",he,O.callback)},m.updateSuperTeamMembersMute=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"updateSuperTeamMembersMute",done:O.done}),v.verifyOptions(O,"teamId accounts mute","team::updateSuperTeamMembersMute"),v.verifyParamType("accounts",O.accounts,"array","team::updateSuperTeamMembersMute"),v.verifyArrayMax("accounts",O.accounts,10),this.processCallback(O),O.mute=O.mute?1:0,this.sendCmd("updateSuperTeamMembersMute",O)},m.updateSuperTeamMute=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"updateSuperTeamMute",done:O.done}),v.verifyOptions(O,"teamId mute","team::updateSuperTeamMute"),O.mute=O.mute?1:0,this.processCallback(O),this.sendCmd("updateSuperTeamMute",O)},m.updateNickInSuperTeam=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"updateNickInSuperTeam",done:O.done}),v.verifyOptions(O,"teamId account","team::updateNickInSuperTeam"),this.processCallback(O),this.sendCmd("updateNickInSuperTeam",{superTeamMember:new T(O),single:!0},O.callback)},m.transferSuperTeam=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"transferSuperTeam",done:O.done}),v.verifyOptions(O,"teamId account leave","team::transferSuperTeam"),v.verifyParamType("leave",O.leave,"boolean","team::transferSuperTeam"),this.processCallback(O);var D={teamId:O.teamId,account:O.account,leave:O.leave};this.sendCmd("transferSuperTeam",D,O.callback)},m.getSuperTeamMembersByAccounts=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"getSuperTeamMembersByAccounts",done:O.done});var D=this,he=this.db,ae=O,Ne=ae.teamId,ue=ae.accounts;if(v.verifyOptions(O,"teamId accounts","superTeam::getSuperTeamMembersByAccounts"),v.verifyParamType("accounts",ue,"array","superTeam::getSuperTeamMembersByAccounts"),v.verifyArrayMax("accounts",ue,20),ue.length<=0)return v.onParamError("accounts","superTeam::getSuperTeamMembersByAccounts");function Y(){var _e=u(ue).call(ue,function(Ce){return Ne+"|"+Ce});D.processCallback(O),D.sendCmd("getSuperTeamMembersByAccounts",{memberIds:_e},function(Ce,ze){O.done(null,{accounts:ue,members:ze.members,invaldAccounts:ze.invalid})})}y.call(this,Ne).then(function(_e){var Ce,ze,ie;return _e.valid?(Ce=[],ze=[],ie=[],d(ue).call(ue,function(le){var Ie,pe=he.getSuperTeamMemberById(c(Ie="".concat(Ne,"-")).call(Ie,le)).then(function(qe){ze.push(qe)}).catch(function(){ie.push(le)});Ce.push(pe)}),void o.all(Ce).then(function(){O.done(null,{accounts:ue,members:ze,invaldAccounts:ie})})):Y()}).catch(function(){return Y()})},m.getMutedSuperTeamMembers=function(O){(O=O||{}).done=k({instance:this,className:"NIMFn",funcName:"getMutedSuperTeamMembers",done:O.done});var D=this,he=O,ae=he.joinTime,Ne=s(he),ue=he.limit,Y=he.teamId;Ne=!!Ne,g(ae)&&(ae=0),g(ue)&&(ue=100),v.verifyOptions(O,"teamId","superTeam::getSuperTeamMembersByJoinTime"),v.verifyParamType("joinTime",ae,"number","api::superTeam::getSuperTeamMembersByJoinTime"),v.verifyParamType("limit",ue,"number","api::superTeam::getSuperTeamMembersByJoinTime"),this.processCallback(O),D.sendCmd("getMutedSuperTeamMembers",{teamId:Y,limit:ue,joinTime:ae,reverse:Ne},O.callback)}},function(t,r,e){var n=e(102),o=e(8),s=e(3),a=e(2),i=e(7),u=e(9),d=e(749),c=e(41),m=e(15),v=e(87),g=e(32),b=e(17),T=e(6),k=e(85),y=e(86),O=e(70),D=e(103);function he(pe,qe){var $e=y!==void 0&&O(pe)||pe["@@iterator"];if(!$e){if(g(pe)||($e=function(hr,Fe){var nr;if(hr){if(typeof hr=="string")return ae(hr,Fe);var ir=m(nr=Object.prototype.toString.call(hr)).call(nr,8,-1);if(ir==="Object"&&hr.constructor&&(ir=hr.constructor.name),ir==="Map"||ir==="Set")return k(hr);if(ir==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ir))return ae(hr,Fe)}}(pe))||qe&&pe&&typeof pe.length=="number"){$e&&(pe=$e);var Lt=0,Dt=function(){};return{s:Dt,n:function(){return Lt>=pe.length?{done:!0}:{done:!1,value:pe[Lt++]}},e:function(hr){throw hr},f:Dt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var dr,pr=!0,sr=!1;return{s:function(){$e=$e.call(pe)},n:function(){var hr=$e.next();return pr=hr.done,hr},e:function(hr){sr=!0,dr=hr},f:function(){try{pr||$e.return==null||$e.return()}finally{if(sr)throw dr}}}}function ae(pe,qe){(qe==null||qe>pe.length)&&(qe=pe.length);for(var $e=0,Lt=new Array(qe);$e<qe;$e++)Lt[$e]=pe[$e];return Lt}var Ne=e(39).fn,ue=e(0),Y=ue.undef,_e=ue.notundef,Ce=e(296),ze=e(152),ie=e(24).reportAPI,le=e(848);function Ie(pe,qe){var $e=this,Lt=[],Dt=[],dr=this.db,pr=this;return dr.enable?(a(pe).call(pe,function(hr){var Fe=$e.protocol.getSessionInCache(hr);Fe?sr(Fe,hr):Dt.push(dr.getSession(hr).then(function(nr){return sr(nr,hr)}))}),s.all(Dt).then(function(){return Lt})):(a(pe).call(pe,function(hr){return sr($e.protocol.getSessionInCache(hr),hr)}),s.resolve(Lt));function sr(hr,Fe){var nr,ir,Ue,rr;hr?hr.lastMsg?hr.scene&&hr.to?hr.ack>=hr.lastMsg.time?pr.logger.warn(i(nr="".concat(qe," not need ack ")).call(nr,hr.id)):Lt.push(hr):pr.logger.warn(i(ir="".concat(qe," session.scene|to undefined ")).call(ir,hr.id)):pr.logger.warn(i(Ue="".concat(qe," session.lastMsg undefined ")).call(Ue,hr.id)):pr.logger.warn(i(rr="".concat(qe," session undefined ")).call(rr,Fe))}}Ne.setCurrSession=function(pe){ie({instance:this,className:"NIMFn",funcName:"setCurrSession",hasCallback:!1}),this.resetSessionUnread(pe),this.protocol.setCurrSession(pe)},Ne.resetAllSessionUnread=function(){ie({instance:this,className:"NIMFn",funcName:"resetAllSessionUnread",hasCallback:!1});for(var pe in this.protocol.sessionSet)this.protocol.sessionSet[pe].unread>0&&this.resetSessionUnread(pe)},Ne.resetSessionsUnread=function(){var pe=D(n.mark(function qe($e){var Lt,Dt,dr,pr,sr,hr,Fe,nr,ir=arguments;return n.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return Lt=ir.length>1&&ir[1]!==void 0?ir[1]:function(){},Lt=ie({instance:this,className:"NIMFn",funcName:"resetSessionsUnread",done:Lt}),(Dt=this).logger.info("resetSessionsUnread::",$e),Ue.next=6,Ie.call(this,$e,"api::resetSessionsUnread");case 6:if(dr=Ue.sent,Dt.protocol.resetSessionsUnread(dr),Dt.options.syncSessionUnread&&dr.length!==0){Ue.next=11;break}return Lt(),Ue.abrupt("return");case 11:pr=o(dr).call(dr,function(rr){return{scene:rr.scene==="p2p"?0:1,to:rr.to,timetag:rr.lastMsg.time}}),sr=le(pr,50),hr=he(sr),Ue.prev=14,nr=n.mark(function rr(){var or;return n.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return or=Fe.value,Pt.next=3,new s(function(Et,kt){Dt.sendCmd("markSessionAckBatch",{sessionAckTags:or},function(er){er?(Lt(er),kt(er)):Et()})});case 3:case"end":return Pt.stop()}},rr)}),hr.s();case 17:if((Fe=hr.n()).done){Ue.next=21;break}return Ue.delegateYield(nr(),"t0",19);case 19:Ue.next=17;break;case 21:Ue.next=26;break;case 23:Ue.prev=23,Ue.t1=Ue.catch(14),hr.e(Ue.t1);case 26:return Ue.prev=26,hr.f(),Ue.finish(26);case 29:Lt(null);case 30:case"end":return Ue.stop()}},qe,this,[[14,23,26,29]])}));return function(qe){return pe.apply(this,arguments)}}(),Ne.resetSuperTeamSessionsUnread=function(){var pe=D(n.mark(function qe($e){var Lt,Dt,dr,pr,sr,hr,Fe,nr,ir=arguments;return n.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return Lt=ir.length>1&&ir[1]!==void 0?ir[1]:function(){},Lt=ie({instance:this,className:"NIMFn",funcName:"resetSuperTeamSessionsUnread",done:Lt}),(Dt=this).logger.info("resetSuperTeamSessionsUnread::",$e),Ue.next=6,Ie.call(this,$e,"api::resetSuperTeamSessionsUnread");case 6:if(dr=Ue.sent,Dt.protocol.resetSessionsUnread(dr),Dt.options.syncSessionUnread&&dr.length!==0){Ue.next=11;break}return Lt(),Ue.abrupt("return");case 11:pr=o(dr).call(dr,function(rr){return{to:rr.to,timetag:rr.lastMsg.time}}),sr=le(pr,50),hr=he(sr),Ue.prev=14,nr=n.mark(function rr(){var or;return n.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return or=Fe.value,Pt.next=3,new s(function(Et,kt){Dt.sendCmd("markSuperTeamSessionsAck",{sessionAckTags:or},function(er){er?(Lt(er),kt(er)):Et()})});case 3:case"end":return Pt.stop()}},rr)}),hr.s();case 17:if((Fe=hr.n()).done){Ue.next=21;break}return Ue.delegateYield(nr(),"t0",19);case 19:Ue.next=17;break;case 21:Ue.next=26;break;case 23:Ue.prev=23,Ue.t1=Ue.catch(14),hr.e(Ue.t1);case 26:return Ue.prev=26,hr.f(),Ue.finish(26);case 29:Lt(null);case 30:case"end":return Ue.stop()}},qe,this,[[14,23,26,29]])}));return function(qe){return pe.apply(this,arguments)}}(),Ne.resetSessionUnread=function(pe){var qe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};qe=ie({instance:this,className:"NIMFn",funcName:"resetSessionUnread",done:qe});var $e=this,Lt=$e.options.resetUnreadMode!==!1,Dt=function(){var hr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;hr?qe(hr,pe):qe(null)};$e.logger.info("resetSessionUnread::use reset mode",Lt);var dr=$e.protocol.getSessionInCache(pe),pr=!dr&&this.db.enable?$e.db.getSession(pe):s.resolve(dr);function sr(hr){if(!hr.lastMsg&&!hr.updateTime)return $e.logger.warn("api::resetSessionUnread: session.lastMsg undefined ".concat(pe)),Dt();if(!hr.scene||!hr.to)return $e.logger.warn("api::resetSessionUnread: session.scene|to undefined ".concat(pe)),Dt();var Fe;if(Fe=hr.lastMsg?hr.lastMsg.time:hr.updateTime,hr&&hr.ack&&hr.ack>=Fe)return $e.logger.warn("api::resetSessionUnread: session ack not needs ".concat(pe)),Dt();var nr={done:function(Ue){Ue?($e.logger.error({message:Ue||"mark ack failed",callFunc:"resetSessionUnread"}),Dt(Ue||"mark ack failed")):(Lt||$e.protocol.resetSessionUnread(hr),Dt())}};if($e.processCallback(nr),hr.scene==="superTeam")$e.sendCmd("markSuperTeamSessionAck",{to:hr.to,timetag:Fe},nr.callback);else{var ir={scene:hr.scene==="p2p"?0:1,to:hr.to,timetag:Fe};$e.sendCmd("markSessionAck",ir,nr.callback)}}pr.then(function(hr){return hr?$e.options.syncSessionUnread?(Lt&&$e.protocol.resetSessionUnread(hr),void sr(hr)):($e.protocol.resetSessionUnread(hr),Dt()):($e.logger.warn("api::resetSessionUnread: session undefined ".concat(pe)),Dt())})},Ne.resetCurrSession=function(){ie({instance:this,className:"NIMFn",funcName:"resetCurrSession",hasCallback:!1}),this.protocol.setCurrSession("")},Ne.insertLocalSession=function(pe){(pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"insertLocalSession",done:pe.done});var qe,$e;function Lt(){pe.session=$e,pe.done(qe,pe)}ue.verifyOptions(pe,"scene to","scene::insertLocalSession"),ue.verifyParamValid("scene",pe.scene,this.message.validScenes,"scene::insertLocalSession"),this.protocol.insertLocalSession(pe).then(function(Dt){$e=Dt,Lt()},function(Dt){qe=Dt,Lt()})},Ne.getLocalSessions=function(pe){(pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"getLocalSessions",done:pe.done});var qe=[];ue.verifyOptions(pe),Y(pe.limit)&&(pe.limit=100),ue.verifyParamType("limit",pe.limit,"number","scene::getLocalSessions"),_e(u(pe))?ue.verifyParamType("reverse",u(pe),"boolean","scene::getLocalSessions"):pe.reverse=!1,this.processCallback(pe);var $e=d(this.protocol.sessionSet),Lt=0,Dt=pe.lastSessionId;if(u(pe)){var dr,pr=he($e);try{for(pr.s();!(dr=pr.n()).done;){var sr=dr.value,hr=sr.id;if(Dt)hr===Dt&&(Dt=void 0);else if(sr.lastMsg!==void 0&&!sr.isDeleted){if(++Lt>pe.limit)break;qe.push(c({},sr))}}}catch(rr){pr.e(rr)}finally{pr.f()}}else{var Fe,nr,ir=he($e);try{for(ir.s();!(nr=ir.n()).done;){var Ue=nr.value;if(Dt===Ue.id)break;Ue.lastMsg===void 0||Ue.isDeleted||qe.push(Ue)}}catch(rr){ir.e(rr)}finally{ir.f()}qe=u(Fe=m(qe).call(qe,-pe.limit)).call(Fe)}this.logger.debug("getLocalSessions::sessions is",qe),qe=o(qe).call(qe,function(rr){return v(ze).call(ze,rr)}),pe.sessions=qe,delete pe.callback,pe.done(void 0,pe)},Ne.getLocalSession=function(pe){(pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"getLocalSession",done:pe.done});var qe=this,$e=qe.db,Lt=null;if(ue.verifyOptions(pe,"sessionId","scene::getLocalSession"),ue.verifyParamType("sessionId",pe.sessionId,"string","scene::getLocalSession"),Lt=qe.protocol.getSessionInCache(pe.sessionId),qe.logger.debug("getLocalSession::cache session is",Lt),!Lt&&$e.enable)return qe.processCallback(pe),void $e.getSession(pe.sessionId).then(function(Dt){Dt&&(Lt=Dt,qe.logger.debug("getLocalSession::db session is",Lt)),pe.done(null,Lt)}).catch(function(Dt){pe.done(Dt)});pe.done(null,v(ze).call(ze,Lt))},Ne.getLocalSessionsByMsgType=function(pe){var qe;(pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"getLocalSessionsByMsgType",done:pe.done});var $e=this.db,Lt=pe.exclude,Dt=[],dr=m(qe=Ce.validTypes).call(qe,0);if(_e(Lt)){if(typeof Lt=="string")Lt=[Lt];else if(!g(Lt))return void ue.onParamInvalidType("exclude",["string","string array"],"","exclude::getLocalSessionsByMsgType");Lt=b(Lt).call(Lt,function(pr){return T(dr).call(dr,pr)>-1}),dr=b(dr).call(dr,function(pr){return T(Lt).call(Lt,pr)===-1})}this.processCallback(pe),$e.enable?$e.getSessions().then(function(pr){Lt&&Lt.length!==0?dr&&dr.length!==0?(a(pr).call(pr,function(sr,hr){var Fe,nr,ir;sr.lastMsg&&T(Lt).call(Lt,sr.lastMsg.type)>-1&&(Fe=hr,nr=sr.id,ir=$e.getMsgs({sessionId:nr,limit:1,types:dr}).then(function(Ue){return Ue&&Ue[0]?pr[Fe].lastMsg=Ue[0]:pr[Fe].lastMsg=null,s.resolve()}),Dt.push(ir))}),s.all(Dt).then(function(){pe.done(null,{exclude:Lt,sessions:pr})})):pe.done(null,{exclude:Lt,sessions:o(pr).call(pr,function(sr){sr.lastMsg=null})}):pe.done(null,{exclude:Lt,sessions:pr})}):pe.done(null,{exclude:Lt,sessions:[]})},Ne.updateLocalSession=function(pe){(pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"updateLocalSession",done:pe.done});var qe,$e=this,Lt=$e.db;ue.verifyOptions(pe,"id","scene::updateLocalSession"),$e.processCallback(pe);var Dt=ue.filterObj(pe,"id localCustom");function dr(){pe.needNotify!==!1&&$e.protocol.onUpdateSession(Dt),pe.session=Dt,pe.done(qe,pe)}Dt=$e.protocol.updateSessionInCache(pe),Lt.enable&&Dt?Lt.updateSession(Dt).then(function(pr){Dt=pr,dr()},function(pr){qe=pr,dr()}):dr()},Ne.deleteLocalSession=function(pe){(pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"deleteLocalSession",done:pe.done});var qe,$e=this,Lt=$e.db;ue.verifyOptions(pe,"id","session::deleteLocalSession"),$e.processCallback(pe);var Dt=$e.protocol.getSessionInCache(pe.id);if($e.protocol.deleteSessionInCache(pe.id,pe.isLogic),Lt.enable?(pe.isLogic?Lt.deleteSessionLogic(pe.id):Lt.deleteSession(pe.id,Dt)).then(function(){$e.logger.info("sessions::deleteSessionInDb::delete session done",pe.id),pr()},function(sr){qe=sr,pr()}):pr(),pe.isDeleteRoaming){var dr=typeof pe.id=="string"?[pe.id]:pe.id;dr=o(dr).call(dr,function(sr){return sr.replace("-","|")}),this.sendCmd("deleteSessions",{sessions:dr},function(){})}function pr(){pe.done(qe,pe)}},Ne.deleteSession=function(pe,qe){(pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"deleteSession",done:pe.done}),qe||this.logger.warn('this api will be abandon,please use "deleteLocalSession"'),ue.verifyOptions(pe,"scene to","session::deleteSession"),this.processCallback(pe),pe.sessions=[{scene:pe.scene,to:pe.to}],this.deleteSessions(pe)},Ne.deleteRoamingMsgBySession=function(pe){(pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"deleteRoamingMsgBySession",done:pe.done}),this.deleteSession(pe,!0)},Ne.deleteSessions=function(pe){var qe,$e;(pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"deleteSessions",done:pe.done}),ue.verifyOptions(pe,"sessions","session::deleteSessions"),ue.verifyParamType("sessions",pe.sessions,"array","session::deleteSessions"),a(qe=pe.sessions).call(qe,function(Lt,Dt){ue.verifyOptions(Lt,"scene to",!0,"sessions["+Dt+"].","session::deleteSessions")}),this.processCallback(pe),this.sendCmd("deleteSessions",{sessions:o($e=pe.sessions).call($e,function(Lt){return Lt.scene+"|"+Lt.to})},pe.callback)},Ne.getServerSessions=function(pe){(pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"getServerSessions",done:pe.done}),_e(pe.minTimestamp)&&ue.verifyParamType("minTimestamp",pe.minTimestamp,"number","session::deleteSessions"),_e(pe.maxTimestamp)&&ue.verifyParamType("maxTimestamp",pe.maxTimestamp,"number","session::deleteSessions"),_e(pe.needLastMsg)&&(pe.needLastMsg=pe.needLastMsg===!1?0:1),_e(pe.limit)&&(ue.verifyParamType("limit",pe.limit,"number","session::deleteSessions"),ue.verifyParamMax("limit",pe.limit,100,"scene::getLocalSessions")),this.processCallback(pe),this.sendCmd("getServerSessions",{sessionReqTag:pe},pe.callback)},Ne.getServerSession=function(pe){(pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"getServerSession",done:pe.done}),ue.verifyOptions(pe,"scene to","scene::getServerSession"),ue.verifyParamValid("scene",pe.scene,this.message.validScenes,"scene::getServerSession"),ue.verifyParamType("to",pe.to,"string","to::getServerSession");var qe=pe.scene+"|"+pe.to;pe.scene==="superTeam"&&(qe="super_team|"+pe.to),this.processCallback(pe),this.sendCmd("getServerSession",{session:{id:qe}},pe.callback)},Ne.updateServerSession=function(pe){(pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"updateServerSession",done:pe.done}),ue.verifyOptions(pe,"scene to","scene::updateServerSession"),ue.verifyParamValid("scene",pe.scene,this.message.validScenes,"scene::updateServerSession"),ue.verifyParamType("to",pe.to,"string","to::updateServerSession"),_e(pe.extra)&&ue.verifyParamType("extra",pe.extra,"string","extra::updateServerSession");var qe=pe.scene+"|"+pe.to;pe.scene==="superTeam"&&(qe="super_team|"+pe.to),this.processCallback(pe),this.sendCmd("updateServerSession",{session:{id:qe,ext:pe.extra||""}},pe.callback)},Ne.deleteServerSessions=function(pe){var qe,$e=this;(pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"deleteServerSessions",done:pe.done}),ue.verifyOptions(pe,"sessions","scene::deleteServerSessions"),ue.verifyParamType("sessions",pe.sessions,"array","sessions::deleteServerSessions");var Lt=[];a(qe=pe.sessions).call(qe,function(Dt){ue.verifyParamValid("scene",Dt.scene,$e.message.validScenes,"scene::deleteServerSessions"),ue.verifyParamType("to",Dt.to,"string","to::deleteServerSessions");var dr=Dt.scene+"|"+Dt.to;Dt.scene==="superTeam"&&(dr="super_team|"+Dt.to),Lt.push({id:dr})}),this.processCallback(pe),this.sendCmd("deleteServerSessions",{sessions:Lt},pe.callback)},Ne.updateSessionsWithMoreRoaming=function(pe){var qe;if((pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"updateSessionsWithMoreRoaming",done:pe.done}),ue.verifyOptions(pe,"msg","session::updateSessionsWithMoreRoaming"),ue.verifyCallback(pe,"done","session::updateSessionsWithMoreRoaming"),!this.db.enable)return pe.done(null,"db is disable");var $e={time:pe.msg.time,idServer:pe.msg.idServer,to:pe.msg.to,from:pe.msg.from};ue.verifyParamType("msg.time",pe.msg.time,"number","time::updateSessionsWithMoreRoaming"),ue.verifyParamType("msg.idServer",pe.msg.idServer,"string","idServer::updateSessionsWithMoreRoaming"),ue.verifyParamType("msg.from",pe.msg.from,"string","from::updateSessionsWithMoreRoaming"),ue.verifyParamType("msg.to",pe.msg.to,"string","to::updateSessionsWithMoreRoaming"),ue.verifyParamValid("scene",pe.msg.scene,this.message.validScenes,"scene::updateSessionsWithMoreRoaming");var Lt=$e.to===this.account?$e.from:$e.to;$e.id=i(qe="".concat(pe.msg.scene,"-")).call(qe,Lt),this.db.updateSessionsWithMoreRoaming($e).then(function(Dt){pe.done(null,Dt)}).catch(function(Dt){pe.done(Dt)})},Ne.deleteSessionsWithMoreRoaming=function(pe){if((pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"deleteSessionsWithMoreRoaming",done:pe.done}),ue.verifyOptions(pe,"id","session::deleteSessionsWithMoreRoaming"),ue.verifyCallback(pe,"done","session::deleteSessionsWithMoreRoaming"),!this.db.enable)return pe.done(null,"db is disable");this.db.deleteSessionsWithMoreRoaming(pe.id).then(function(qe){pe.done(null,qe)}).catch(function(qe){pe.done(qe)})},Ne.getSessionsWithMoreRoaming=function(pe){if((pe=pe||{}).done=ie({instance:this,className:"NIMFn",funcName:"getSessionsWithMoreRoaming",done:pe.done}),ue.verifyCallback(pe,"done","session::getSessionsWithMoreRoaming"),!this.db.enable)return pe.done(null,"db is disable");this.db.getSessionsWithMoreRoaming(pe.id).then(function(qe){pe.done(null,qe)}).catch(function(qe){pe.done(qe)})}},function(t,r,e){var n=e(849),o=e(850),s=e(851),a=Math.ceil,i=Math.max;t.exports=function(u,d,c){d=(c?o(u,d,c):d===void 0)?1:i(s(d),0);var m=u==null?0:u.length;if(!m||d<1)return[];for(var v=0,g=0,b=Array(a(m/d));v<m;)b[g++]=n(u,v,v+=d);return b}},function(t,r){t.exports=function(e,n,o){var s=-1,a=e.length;n<0&&(n=-n>a?0:a+n),(o=o>a?a:o)<0&&(o+=a),a=n>o?0:o-n>>>0,n>>>=0;for(var i=Array(a);++s<a;)i[s]=e[s+n];return i}},function(t,r,e){var n=e(199),o=e(200),s=e(301),a=e(88);t.exports=function(i,u,d){if(!a(d))return!1;var c=typeof u;return!!(c=="number"?o(d)&&s(u,d.length):c=="string"&&u in d)&&n(d[u],i)}},function(t,r,e){var n=e(852);t.exports=function(o){var s=n(o),a=s%1;return s==s?a?s-a:s:0}},function(t,r,e){var n=e(853);t.exports=function(o){return o?(o=n(o))===1/0||o===-1/0?17976931348623157e292*(o<0?-1:1):o==o?o:0:o===0?o:0}},function(t,r,e){var n=e(854),o=e(88),s=e(856),a=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,u=/^0o[0-7]+$/i,d=parseInt;t.exports=function(c){if(typeof c=="number")return c;if(s(c))return NaN;if(o(c)){var m=typeof c.valueOf=="function"?c.valueOf():c;c=o(m)?m+"":m}if(typeof c!="string")return c===0?c:+c;c=n(c);var v=i.test(c);return v||u.test(c)?d(c.slice(2),v?2:8):a.test(c)?NaN:+c}},function(t,r,e){var n=e(855),o=/^\s+/;t.exports=function(s){return s&&s.slice(0,n(s)+1).replace(o,"")}},function(t,r){var e=/\s/;t.exports=function(n){for(var o=n.length;o--&&e.test(n.charAt(o)););return o}},function(t,r,e){var n=e(119),o=e(104);t.exports=function(s){return typeof s=="symbol"||o(s)&&n(s)=="[object Symbol]"}},function(t,r,e){var n=e(120),o=e(858),s=e(859),a=e(102),i=e(103),u=e(58),d=e(17),c=e(15),m=e(2),v=e(32),g=e(171),b=e(8),T=e(7),k=e(9),y=e(10),O=e(864),D=e(5),he=e(59),ae=e(60),Ne=e(61),ue=e(62),Y=e(47),_e=["callback","done"];function Ce(Fe,nr){var ir=D(Fe);if(he){var Ue=he(Fe);nr&&(Ue=d(Ue).call(Ue,function(rr){return ae(Fe,rr).enumerable})),ir.push.apply(ir,Ue)}return ir}function ze(Fe){for(var nr=1;nr<arguments.length;nr++){var ir,Ue,rr=arguments[nr]!=null?arguments[nr]:{};nr%2?m(ir=Ce(Object(rr),!0)).call(ir,function(or){u(Fe,or,rr[or])}):Ne?ue(Fe,Ne(rr)):m(Ue=Ce(Object(rr))).call(Ue,function(or){Y(Fe,or,ae(rr,or))})}return Fe}var ie=e(39).fn,le=e(0),Ie=le.undef,pe=le.notundef,qe=e(44),$e=e(152),Lt=e(151),Dt=e(40),dr=e(72),pr=e(24).reportAPI,sr=e(13);ie.sendG2Msg=function(Fe){return(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"sendG2Msg",done:Fe.done}),this.processCallback(Fe),Fe.msg=new this.message.G2Message(Fe),this.sendMsg(Fe)},ie.beforeSendMsg=function(Fe){var nr,ir=this.protocol,Ue=Fe.msg;switch(Ue.to===this.account&&(Ue.fromDeviceId=qe.deviceId),Ue.userUpdateTime=ir.myInfo&&ir.myInfo.updateTime,Ue.getScene()){case"p2p":nr="sendMsg";break;case"team":nr="sendTeamMsg";break;case"superTeam":nr="sendSuperTeamMsg"}d(Fe)&&(nr="sendFilterMsg",Ue.filter=!0),Fe.cmd=nr},ie.afterSendMsg=function(Fe){var nr=Fe.rtnMsg;if(!nr||!nr.ignore){var ir=this.protocol.getSessionInCache(nr.sessionId);Fe.isLocal&&ir&&ir.lastMsg&&nr.time<ir.lastMsg.time||this.protocol.onUpdateSession($e.genSessionByMsg(nr))}},ie.beforeForwardMsg=function(Fe){le.verifyOptions(Fe,"msg scene to","msg::beforeForwardMsg"),Fe.msg.scene=Fe.scene,Fe.msg.to=Fe.to},ie.markMsgRead=function(Fe){var nr=this.protocol;!Fe||this.db.enable||nr.options.autoMarkRead?this.logger.warn("api::markMsgRead:  (, , )"):nr.markMsgRead(Fe,!0)},ie.sendMsgReceipt=function(Fe){if((Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"sendMsgReceipt",done:Fe.done}),le.verifyOptions(Fe),this.processCallback(Fe),Fe.msg){le.verifyOptions(Fe,"msg","msg::sendMsgReceipt");var nr=Fe.msg;le.verifyOptions(nr,"target idClient time",!0,"msg.","msg::sendMsgReceipt"),this.protocol.shouldSendMsgReceipt(nr)?this.sendCmd("sendMsgReceipt",{msgReceipt:{to:nr.target,idClient:nr.idClient,time:nr.time}},Fe.callback):Fe.done()}else Fe.done()},ie.isMsgRemoteRead=function(Fe){return pr({instance:this,className:"NIMFn",funcName:"isMsgRemoteRead",hasCallback:!1}),this.protocol.isMsgRemoteRead(Fe)},ie.recallMsg=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"recallMsg",done:Fe.done}),this.deleteMsg(Fe,!0)},ie.deleteMsg=function(Fe,nr){var ir;(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"deleteMsg",done:Fe.done}),nr||this.logger.warn("this api will be abandon,please use recallMsg"),le.verifyOptions(Fe,"msg","msg::deleteMsg");var Ue=Fe.msg;if(Ue.scene!=="team"&&Ue.from!==this.account||Ue.status!=="success"||Ue.isLocal)return Fe.done(Dt.newParamError(", ",{callFunc:"msg::deleteMsg"}),Fe);le.verifyOptions(Ue,["scene","to","from","time","idClient","idServer"],!0,"msg.","msg::deleteMsg"),le.verifyParamValid("msg.scene",Ue.scene,this.message.validScenes,"msg::deleteMsg"),this.processPs(Fe),this.processCallback(Fe);var rr={deletedIdClient:Ue.idClient,deletedIdServer:Ue.idServer,time:Ue.time,from:Ue.from,to:Ue.to,opeAccount:Ue.from},or=Ue.scene==="superTeam"?"deleteSuperTeamMsg":"deleteMsg";rr.type="deleteMsg"+Ue.scene[0].toUpperCase()+c(ir=Ue.scene).call(ir,1);var Pt=["ps","apnsText","pushPayload","env","opeAccount","attach"];m(Pt).call(Pt,function(Et){Fe[Et]&&(rr[Et]=Fe[Et])}),rr=new Lt(rr),this.sendCmd(or,{sysMsg:rr,msg:Ue},Fe.callback)},ie.deleteMsgSelf=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"deleteMsgSelf",done:Fe.done}),le.verifyOptions(Fe,"msg","msg::deleteMsgSelf");var nr=Fe.msg;if(nr.scene==="superTeam")return Fe.done(Dt.newParamError("",{callFunc:"msg::deleteMsgSelf"}),Fe);le.verifyOptions(nr,["scene","to","from","time","idClient","idServer"],!0,"msg.","msg::deleteMsgSelf"),le.verifyParamValid("msg.scene",nr.scene,this.message.validScenes,"msg::deleteMsgSelf"),this.processCallback(Fe);var ir={scene:nr.scene==="p2p"?1:2,from:nr.from,to:nr.to,time:nr.time,idClient:nr.idClient,idServer:nr.idServer,custom:Fe.custom,type:nr.type};this.sendCmd("deleteMsgSelf",{deleteMsgSelfTag:ir},Fe.callback)},ie.deleteMsgSelfBatch=function(Fe){var nr,ir,Ue,rr=this;if((Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"deleteMsgSelfBatch",done:Fe.done}),le.verifyOptions(Fe,"msgs","msg::deleteMsgSelfBatch"),(!v(Fe.msgs)||Fe.msgs.length===0||Fe.msgs.length>100)&&le.onParamError("msgs0100","msg::deleteMsgSelfBatch"),g(nr=Fe.msgs).call(nr,function(Pt){return Pt.scene==="superTeam"}))return Fe.done(Dt.newParamError("",{callFunc:"msg::deleteMsgSelfBatch"}),Fe);m(ir=Fe.msgs).call(ir,function(Pt){le.verifyOptions(Pt,["scene","to","from","time","idClient","idServer"],!0,"msg.","msg::deleteMsgSelfBatch"),le.verifyParamValid("msg.scene",Pt.scene,rr.message.validScenes,"msg::deleteMsgSelfBatch")}),this.processCallback(Fe);var or=b(Ue=Fe.msgs).call(Ue,function(Pt){var Et;return{scene:Pt.scene==="p2p"?1:2,from:Pt.from,to:Pt.to,time:Pt.time,idClient:Pt.idClient,idServer:Pt.idServer,sessionId:Pt.sessionId||T(Et="".concat(Pt.scene,"-")).call(Et,Pt.to),custom:Fe.custom,type:Pt.type}});this.sendCmd("deleteMsgSelfBatch",{deleteMsgSelfTags:or},Fe.callback)};var hr={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,tip:10,robot:11,custom:100};ie.getHistoryMsgs=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"getHistoryMsgs",done:Fe.done}),this.protocol.syncing&&this.logger.warn("Please call getHistoryMsgs after onsyncdone callback"),le.verifyOptions(Fe,"scene to","msg::getHistoryMsgs"),le.verifyParamValid("scene",Fe.scene,this.message.validScenes,"msg::getHistoryMsgs"),Fe.beginTime===void 0&&(Fe.beginTime=0);var nr,ir=this.protocol.getSessionInCache(Fe.scene+"-"+Fe.to),Ue=ir&&ir.lastEmptyTime;if(Ue>Fe.beginTime&&(Fe.beginTime=Ue),le.verifyParamType("beginTime",Fe.beginTime,"number","msg::getHistoryMsgs"),Fe.endTime===void 0&&(Fe.endTime=0),le.verifyParamType("endTime",Fe.endTime,"number","msg::getHistoryMsgs"),Fe.lastMsgId=Fe.lastMsgId&&+Fe.lastMsgId?Fe.lastMsgId:"0",Fe.limit===void 0&&(Fe.limit=100),le.verifyParamType("limit",Fe.limit,"number","msg::getHistoryMsgs"),le.verifyParamMax("limit",Fe.limit,100,"msg::getHistoryMsgs"),pe(k(Fe))?le.verifyParamType("reverse",k(Fe),"boolean","msg::getHistoryMsgs"):Fe.reverse=!1,pe(Fe.asc)?le.verifyParamType("asc",Fe.asc,"boolean","msg::getHistoryMsgs"):Fe.asc=!1,Ie(Fe.msgTypes))Fe.msgTypes=[];else if(v(Fe.msgTypes)){var rr,or;Fe.msgTypes=b(rr=Fe.msgTypes).call(rr,function(Et){return hr[Et]}),Fe.msgTypes=d(or=Fe.msgTypes).call(or,function(Et){return typeof Et=="number"})}else typeof hr[Fe.msgTypes]=="number"?Fe.msgTypes=[hr[Fe.msgTypes]]:Fe.msgTypes=[];switch(this.processCallback(Fe),Fe.cbaop=function(Et,kt){if(!Et){var er;Fe.asc&&(kt.msgs=k(er=kt.msgs).call(er)),kt.msgs=dr.deduplication(kt.msgs)}},Fe.scene){case"p2p":nr="getHistoryMsgs";break;case"team":nr="getTeamHistoryMsgs";break;case"superTeam":nr="getSuperTeamHistoryMsgs"}var Pt={scene:Fe.scene,to:Fe.to,beginTime:Fe.beginTime,endTime:Fe.endTime,lastMsgId:Fe.lastMsgId,limit:Fe.limit,reverse:k(Fe),msgTypes:Fe.msgTypes};this.sendCmd(nr,Pt,Fe.callback)},ie.searchHistoryMsgs=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"searchHistoryMsgs",done:Fe.done}),le.verifyOptions(Fe,"scene to keyword","msg::searchHistoryMsgs"),le.verifyParamValid("scene",Fe.scene,this.message.validScenes,"msg::searchHistoryMsgs"),Fe.beginTime===void 0&&(Fe.beginTime=0);var nr,ir=this.protocol.getSessionInCache(Fe.scene+"-"+Fe.to),Ue=ir&&ir.lastEmptyTime;switch(Ue>Fe.beginTime&&(Fe.beginTime=Ue),le.verifyParamType("beginTime",Fe.beginTime,"number","msg::searchHistoryMsgs"),Fe.endTime===void 0&&(Fe.endTime=0),le.verifyParamType("endTime",Fe.endTime,"number","msg::searchHistoryMsgs"),Fe.limit===void 0&&(Fe.limit=100),le.verifyParamType("limit",Fe.limit,"number","msg::searchHistoryMsgs"),le.verifyParamMax("limit",Fe.limit,100,"msg::searchHistoryMsgs"),pe(k(Fe))?le.verifyParamType("reverse",k(Fe),"boolean","msg::searchHistoryMsgs"):Fe.reverse=!1,pe(Fe.asc)?le.verifyParamType("asc",Fe.asc,"boolean","msg::searchHistoryMsgs"):Fe.asc=!1,this.processCallback(Fe),Fe.asc&&(Fe.cbaop=function(or,Pt){var Et;or||(Pt.msgs=k(Et=Pt.msgs).call(Et))}),Fe.scene){case"p2p":nr="searchHistoryMsgs";break;case"team":nr="searchTeamHistoryMsgs"}var rr=le.filterObj(Fe,"scene to beginTime endTime keyword limit reverse");this.sendCmd(nr,rr,Fe.callback)},ie.getLocalMsgs=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"getLocalMsgs",done:Fe.done});var nr=this,ir=nr.db,Ue=[];le.verifyOptions(Fe);var rr=!1;pe(Fe.start)&&(rr=!0,le.verifyParamType("start",Fe.start,"number","msg::getLocalMsgs"));var or=!1;if(pe(Fe.end)&&(or=!0,le.verifyParamType("end",Fe.end,"number","msg::getLocalMsgs")),rr&&or&&Fe.end<=Fe.start&&le.onParamError(" end  start"),pe(Fe.subTypes)&&le.verifyParamType("subTypes",Fe.subTypes,"array","msg::getLocalMsgs"),Ie(Fe.limit)&&(Fe.limit=100),le.verifyParamType("limit",Fe.limit,"number","msg::getLocalMsgs"),le.verifyParamMin("limit",Fe.limit,1,"msg::getLocalMsgs"),nr.processCallback(Fe),ir.enable){var Pt=new Date().getTime();ir.getMsgs(Fe).then(function(kt){var er;Ue=kt,nr.logger.info(T(er="api::getLocalMsgs: query db cost ".concat(new Date().getTime()-Pt," ms and the conditions is ")).call(er,y(Fe))),Et()},function(kt){(kt=kt||{}).message=kt.message||"msg::getLocalMsgs:db error",Et()})}else Et();function Et(){var kt=le.simpleClone(Fe);kt.msgs=Ue,delete kt.callback,delete kt.done,Fe.done(null,kt)}},ie.getLocalMsgsInUnread=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"getLocalMsgsInUnread",done:Fe.done});var nr=this;le.validate({sessionId:{type:"string",allowEmpty:!1}},Fe),this.getLocalSession({sessionId:Fe.sessionId,done:function(ir,Ue){ir?Fe.done&&Fe.done(ir):Ue?(Ue.ack=Ue.ack||0,nr.getLocalMsgs(ze({sessionId:Fe.sessionId,start:Ue.ack,limit:O,filterFunc:function(rr){return rr.flow==="in"&&rr.isUnreadable===!0},done:function(){}},Fe))):Fe.done&&Fe.done(new Error("session ".concat(Fe.sessionId," not exist")))}})},ie.getLocalMsgByIdClient=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"getLocalMsgByIdClient",done:Fe.done});var nr=this.db,ir=null,Ue=null;function rr(){Fe.msg=Ue,Fe.done(ir,Fe)}le.verifyOptions(Fe,"idClient","msg::getLocalMsgByIdClient"),this.processCallback(Fe),nr.enable?nr.getMsgByIdClient(Fe.idClient).then(function(or){or&&(Ue=or),rr()},function(or){ir=or,rr()}):(this.logger.warn("because db is false,error is null"),rr())},ie.getLocalMsgsByIdClients=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"getLocalMsgsByIdClients",done:Fe.done});var nr,ir=this.db,Ue=[];function rr(){Fe.msgs=Ue,Fe.done(nr,Fe)}le.verifyOptions(Fe,"idClients","msg::getLocalMsgByIdClients"),le.verifyParamType("idClients",Fe.idClients,"array","msg::getLocalMsgByIdClients"),this.processCallback(Fe),ir.enable?ir.getMsgsByIdClients(Fe.idClients).then(function(or){Ue=d(or).call(or,function(Pt){return!!Pt}),rr()},function(or){nr=or,rr()}):rr()},ie.updateLocalMsg=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"updateLocalMsg",done:Fe.done});var nr,ir=this.db,Ue=null;if(le.verifyOptions(Fe,"idClient","msg::updateLocalMsg"),this.processCallback(Fe),ir.enable){var rr=le.filterObj(Fe,"idClient localCustom");ir.updateMsg(rr).then(function(Pt){Ue=Pt,or()},function(Pt){nr=Pt,or()})}else or();function or(){Fe.msg=Ue,Fe.done(nr,Fe)}},ie.deleteLocalMsg=function(){var Fe=i(a.mark(function nr(ir){var Ue,rr,or,Pt;return a.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return Pt=function(){ir.done(rr,ir)},(ir=ir||{}).done=pr({instance:this,className:"NIMFn",funcName:"deleteLocalMsg",done:ir.done}),Ue=this,le.verifyOptions(ir,"msg","msg::deleteLocalMsg"),or=ir.msg,le.verifyOptions(or,"idClient sessionId",!0,"msg.","msg::deleteLocalMsg"),Ue.processCallback(ir),Et.prev=8,Et.next=11,Ue.protocol.deleteLocalMsg(or);case 11:Pt(),Et.next=18;break;case 14:Et.prev=14,Et.t0=Et.catch(8),rr=Et.t0,Pt();case 18:case"end":return Et.stop()}},nr,this,[[8,14]])}));return function(nr){return Fe.apply(this,arguments)}}(),ie.deleteLocalMsgsBySession=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"deleteLocalMsgsBySession",done:Fe.done});var nr,ir=this,Ue=ir.db;le.verifyOptions(Fe,"scene to","msg::deleteLocalMsgsBySession"),le.verifyParamValid("scene",Fe.scene,ir.message.validScenes,"msg::deleteLocalMsgsBySession"),Fe.sessionId=Fe.scene+"-"+Fe.to,Fe.delLastMsg=Fe.delLastMsg===!0,Fe.isTag=Fe.isTag===!0;var rr=new Date().getTime();function or(){Fe.done(nr,Fe)}ir.processCallback(Fe);var Pt={id:Fe.sessionId};Fe.delLastMsg&&(Pt.lastMsg=null),Fe.isTag&&(Pt.lastEmptyTime=rr),Ue.enable?Ue.deleteMsgsBySessionId(Fe).then(function(){Fe.delLastMsg||Fe.isTag?Ue.updateSession(Pt).then(function(Et){ir.protocol.onUpdateSession(Et),Fe.session=Et,or()}):or()}).catch(function(Et){nr=Et,or()}):(this.logger.warn("because db is false,error is null"),or(),(Fe.delLastMsg||Fe.isTag)&&ir.protocol.onUpdateSession(Pt))},ie.deleteLocalMsgsByTime=function(Fe){var nr=this.db;sr.isBrowser&&nr.enable&&(pe((Fe=Fe||{}).start)?le.verifyParamType("start",Fe.start,"number","msg::deleteLocalMsgsByTime"):Fe.start=0,pe(Fe.end)?le.verifyParamType("end",Fe.end,"number","msg::deleteLocalMsgsByTime"):Fe.end=1/0,pe(Fe.end)&&pe(Fe.start)&&Fe.end<=Fe.start&&le.onParamError(" end  start"),this.processCallback(Fe),this.protocol.deleteLocalMsgsByTime(Fe).then(function(ir){Fe.done(null,ir)},function(ir){Fe.done(ir,null)}))},ie.deleteLocalMsgs=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"deleteLocalMsgs",done:Fe.done});var nr;function ir(){Fe.done(nr,Fe)}Fe.updateSession=Fe.updateSession!==!1,le.verifyOptions(Fe,"sessionId","msg::deleteLocalMsgsBySession"),pe(Fe.start)&&le.verifyParamType("start",Fe.start,"number","msg::deleteLocalMsgs"),pe(Fe.end)&&le.verifyParamType("end",Fe.end,"number","msg::deleteLocalMsgs"),pe(Fe.end)&&pe(Fe.start)&&Fe.end<=Fe.start&&le.onParamError(" end  start"),this.processCallback(Fe),this.protocol.deleteLocalMsgs(Fe).then(function(){ir()},function(Ue){nr=Ue,ir()})},ie.deleteAllLocalMsgs=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"deleteAllLocalMsgs",done:Fe.done});var nr,ir=this.db;function Ue(){Fe.done(nr,Fe)}this.processCallback(Fe),this.protocol.sessionSet={},ir.enable?ir.deleteAllMsgs().then(function(){Ue()},function(rr){nr=rr,Ue()}):(this.logger.warn("because db is false,error is null"),Ue())},ie.saveMsgsToLocal=function(Fe){var nr;(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"saveMsgsToLocal",done:Fe.done}),this.db.enable||(this.logger.warn("because db is false,error is null"),Fe.done(null,[])),le.verifyOptions(Fe,"msgs done","msg::saveMsgsToLocal"),le.verifyParamType("msgs",Fe.msgs,"Array","msg::saveMsgsToLocal");var ir=b(nr=Fe.msgs).call(nr,function(Ue){var rr=ze({},Ue);return rr.hasOwnProperty("needUpdateSession")||(rr.needUpdateSession=!0),rr});this.db.putMsg(ir).then(function(Ue,rr){rr?Fe.done(rr):Fe.done(null,Ue)})},ie.clearServerHistoryMsgs=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"clearServerHistoryMsgs",done:Fe.done}),le.verifyOptions(Fe,"account","msg::clearServerHistoryMsgs");var nr=Fe.delRoam!==!1;this.processCallback(Fe),this.sendCmd("clearServerHistoryMsgs",{clearMsgsParams:{account:Fe.account,delRoam:nr?1:0}},Fe.callback)},ie.clearServerHistoryMsgsWithSync=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"clearServerHistoryMsgsWithSync",done:Fe.done}),le.verifyOptions(Fe,"scene to","msg::clearServerHistoryMsgsWithSync");var nr=Fe.isDeleteRoam===void 0||Fe.isDeleteRoam===!0,ir={type:Fe.scene==="team"?2:1,isDeleteRoam:nr?1:0,isSyncSelf:Fe.isSyncSelf===!0?1:0};ir[ir.type===2?"toTid":"otherAccid"]=Fe.to,Fe.ext!==void 0&&(ir.ext=Fe.ext),this.processCallback(Fe),this.sendCmd("clearServerHistoryMsgsWithSync",{clearMsgsParamsWithSync:ir},Fe.callback)},ie.msgFtsInServer=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"msgFtsInServer",done:Fe.done}),this.processCallback(Fe);var nr=Fe,ir=s({},(o(nr),nr));le.validate({keyword:{type:"string"},fromTime:{type:"number",required:!1},toTime:{type:"number",required:!1},sessionLimit:{type:"number",min:0,required:!1},msgLimit:{type:"number",min:0,required:!1},order:{type:"enum",values:["ASC","DESC"],required:!1},p2pList:{type:"array",required:!1},teamList:{type:"array",required:!1},senderList:{type:"array",required:!1},msgTypeList:{type:"array",required:!1},msgSubTypeList:{type:"array",required:!1}},ir,"msg::msgFtsInServer"),pe(ir.toTime)&&pe(ir.fromTime)&&ir.toTime<ir.fromTime&&le.onParamError("Options error: toTime should be greater than fromTime");var Ue,rr={ASC:1,DESC:2};ir.order&&rr[ir.order]&&(ir.order=rr[ir.order]),ir.msgTypeList&&(ir.msgTypeList=b(Ue=ir.msgTypeList).call(Ue,function(Pt){return hr[Pt]}));var or=["p2pList","teamList","senderList","msgTypeList","msgSubTypeList"];m(or).call(or,function(Pt){v(ir[Pt])&&(ir[Pt]=ir[Pt].join(","))}),this.sendCmd("msgFtsInServer",{msgFullSearchRequestTag:ir},Fe.callback)},ie.msgFtsInServerByTiming=function(Fe){(Fe=Fe||{}).done=pr({instance:this,className:"NIMFn",funcName:"msgFtsInServerByTiming",done:Fe.done}),this.processCallback(Fe);var nr=Fe,ir=(nr.callback,nr.done,n(nr,_e));le.validate({keyword:{type:"string"},fromTime:{type:"number",required:!1},toTime:{type:"number",required:!1},msgLimit:{type:"number",min:0,required:!1},order:{type:"enum",values:["ASC","DESC"],required:!1},p2pList:{type:"array",required:!1},teamList:{type:"array",required:!1},senderList:{type:"array",required:!1},msgTypeList:{type:"array",required:!1},msgSubTypeList:{type:"array",required:!1}},ir,"msg::msgFtsInServerByTimeSort"),pe(ir.toTime)&&pe(ir.fromTime)&&ir.toTime<ir.fromTime&&le.onParamError("Options error: toTime should be greater than fromTime");var Ue,rr={ASC:1,DESC:2};ir.msgLimit===void 0&&(ir.msgLimit=20),ir.order&&rr[ir.order]&&(ir.order=rr[ir.order]),ir.msgTypeList&&(ir.msgTypeList=b(Ue=ir.msgTypeList).call(Ue,function(Pt){return hr[Pt]}));var or=["p2pList","teamList","senderList","msgTypeList","msgSubTypeList"];m(or).call(or,function(Pt){v(ir[Pt])&&(ir[Pt]=ir[Pt].join(","))}),this.sendCmd("msgFtsInServerByTiming",{msgTimingFullSearchRequestTag:ir},Fe.callback)}},function(t,r){t.exports=function(e){if(e==null)throw new TypeError("Cannot destructure "+e)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(860),o=e(149);function s(){var a;return t.exports=s=n?o(a=n).call(a):function(i){for(var u=1;u<arguments.length;u++){var d=arguments[u];for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&(i[c]=d[c])}return i},t.exports.__esModule=!0,t.exports.default=t.exports,s.apply(this,arguments)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(861)},function(t,r,e){t.exports=e(862)},function(t,r,e){var n=e(863);t.exports=n},function(t,r,e){var n=e(304);t.exports=n},function(t,r,e){t.exports=e(865)},function(t,r,e){var n=e(866);t.exports=n},function(t,r,e){e(867),t.exports=9007199254740991},function(t,r,e){e(1)({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991})},function(t,r,e){var n=e(9),o=e(32),s=e(15),a=e(2),i=e(10),u=e(5),d=e(17),c=e(39).fn,m=e(0),v=e(751),g=e(753),b=(e(72),m.notundef),T=e(24).reportAPI;function k(y,O,D,he){D=D||"",m.verifyParamType(D+"from",y.from,"string",O),m.verifyParamType(D+"to",y.to,"string",O),m.verifyParamType(D+"idServer",y.idServer,"string",O),m.verifyParamType(D+"time",y.time,"number",O),m.verifyParamValid(D+"scene",y.scene,this.message.validScenes,O),he||m.verifyParamType(D+"idClient",y.idClient,"string",O)}c.getThreadMsgs=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"getThreadMsgs",done:y.done}),m.verifyCallback(y,"done","msg::getThreadMsgs"),m.verifyOptions(y,"scene threadMsgFromAccount threadMsgToAccount threadMsgIdServer threadMsgTime","msg::getThreadMsgs"),m.verifyParamType("threadMsgFromAccount",y.threadMsgFromAccount,"string","msg::getThreadMsgs"),m.verifyParamType("threadMsgToAccount",y.threadMsgToAccount,"string","msg::getThreadMsgs"),m.verifyParamType("threadMsgIdServer",y.threadMsgIdServer,"string","msg::getThreadMsgs"),m.verifyParamType("threadMsgTime",y.threadMsgTime,"number","msg::getThreadMsgs"),m.verifyParamValid("scene",y.scene,this.message.validScenes,"msg::getThreadMsgs"),this.processCallback(y);var O={scene:this.message.sceneMap[y.scene],from:y.threadMsgFromAccount,to:y.threadMsgToAccount,time:y.threadMsgTime,idServer:y.threadMsgIdServer},D={limit:y.limit<100?y.limit:100,beginTime:typeof y.beginTime=="number"?y.beginTime:0,reverse:n(y)===!0?1:0};typeof y.endTime=="number"&&(D.endTime=y.endTime,D.endTime<=D.beginTime&&m.onParamError("endTimebeginTime","msg::getThreadMsgs")),y.lastMsgId&&(D.lastMsgId=y.lastMsgId),this.sendCmd("getThreadMsgs",{msg:O,threadMsgReq:D,NOTSTORE:"msg threadMsgReq"},y.callback)},c.getMsgsByIdServer=function(y){var O,D,he=this;(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"getMsgsByIdServer",done:y.done});var ae=this,Ne="msg::getMsgsByIdServer";m.verifyCallback(y,"done",Ne),(!o(y.reqMsgs)||y.reqMsgs.length===0||y.reqMsgs.length>100)&&m.onParamError("reqMsgs0100",Ne),y.reqMsgs=s(O=y.reqMsgs).call(O,0),a(D=y.reqMsgs).call(D,function(ue,Y){k.call(ae,ue,Ne,"reqMsgs[".concat(Y,"]."),!0),ue.scene=he.message.sceneMap[ue.scene]}),this.processCallback(y),this.sendCmd("getMsgsByIdServer",{reqMsgs:y.reqMsgs},y.callback)},c.addQuickComment=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"addQuickComment",done:y.done}),m.verifyOptions(y,"msg body","msg::addQuickComment"),k.call(this,y.msg,"msg::addQuickComment");var O=new v(y,"msg::addQuickComment");O.from=this.account;var D={scene:this.message.sceneMap[y.msg.scene],from:y.msg.from,to:y.msg.to,time:y.msg.time,idServer:y.msg.idServer,idClient:y.msg.idClient};this.processCallback(y),this.sendCmd("addQuickComment",{msg:D,comment:O},y.callback)},c.deleteQuickComment=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"deleteQuickComment",done:y.done}),m.verifyOptions(y,"msg body","msg::deleteQuickComment"),k.call(this,y.msg,"msg::deleteQuickComment");var O=new v(y,"msg::addQuickComment");O.from=this.account;var D={scene:this.message.sceneMap[y.msg.scene],from:y.msg.from,to:y.msg.to,time:y.msg.time,idServer:y.msg.idServer,idClient:y.msg.idClient};this.processCallback(y),this.sendCmd("deleteQuickComment",{msg:D,comment:O},y.callback)},c.getQuickComments=function(y){var O=this;(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"getQuickComments",done:y.done});var D="msg::getQuickComments",he=this,ae={},Ne={};m.verifyOptions(y,"msgs","msg::getQuickComments"),(!o(y.msgs)||y.msgs.length===0||y.msgs.length>20)&&m.onParamError("msgs020",D);var ue=[];try{ue=JSON.parse(i(y.msgs))}catch{m.onParamError("msgs ",D)}a(ue).call(ue,function(Y,_e){k.call(he,Y,D,"msgs[".concat(_e,"]."),!0),Y.scene=O.message.sceneMap[Y.scene],ae[Y.idClient]=null,Ne[Y.idClient]=_e}),this.processCallback(y),this.getLocalMsgsByIdClients({idClients:u(ae),done:function(Y,_e){var Ce,ze=he.protocol.timetags.sync;!Y&&_e.msgs&&_e.msgs.length&&ze&&(a(Ce=_e.msgs).call(Ce,function(ie){ae[ie.idClient]=ie}),ue=d(ue).call(ue,function(ie){var le=ae[ie.idClient];return!le||(le.commentTimetag&&(ie.timestamp=le.commentTimetag),!(le.commentTimetag>ze))})),he.sendCmd("getQuickComments",{commentReq:ue,idMap:ae,indexMap:Ne},y.callback)}})},c.addCollect=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"addCollect",done:y.done}),m.verifyOptions(y,"type data","msg::addCollect");var O=new g(y,"msg::addCollect");this.processCallback(y),this.sendCmd("addCollect",{collect:O},y.callback)},c.deleteCollects=function(y){var O;(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"deleteCollects",done:y.done}),m.verifyOptions(y,"collectList","msg::deleteCollects"),(!o(y.collectList)||y.collectList.length===0||y.collectList.length>100)&&m.onParamError("collectList0100","msg::deleteCollects"),a(O=y.collectList).call(O,function(D,he){m.verifyParamType("collectList[".concat(he,"].id"),D.id,"string","msg::deleteCollects"),m.verifyParamType("collectList[".concat(he,"].createTime"),D.createTime,"number","msg::deleteCollects")}),this.processCallback(y),this.sendCmd("deleteCollects",{collectList:y.collectList},y.callback)},c.updateCollect=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"updateCollect",done:y.done}),m.verifyOptions(y,"collect","msg::updateCollect"),m.verifyParamType("collect.id",y.collect.id,"string","msg::updateCollect"),m.verifyParamType("collect.createTime",y.collect.createTime,"number","msg::updateCollect"),this.processCallback(y),this.sendCmd("updateCollect",{collect:y.collect},y.callback)},c.getCollects=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"getCollects",done:y.done}),m.verifyCallback(y,"done","msg::getCollects");var O={},D=["type","beginTime","endTime","limit"];a(D).call(D,function(he){b(y[he])&&(m.verifyParamType(he,y[he],"number","msg::getCollects"),O[he]=y[he])}),y.limit>100&&m.onParamError("limit100","msg::getCollects"),y.beginTime>y.endTime&&m.onParamError("beginTimeendTime","msg::getCollects"),b(y.lastId)&&(m.verifyParamType("lastId",y.lastId,"string","msg::getCollects"),O.lastMsgId=y.lastId),b(n(y))&&(O.reverse=n(y)===!0?1:0),this.processCallback(y),this.sendCmd("getCollects",{collectQuery:O,NOTSTORE:"collectQuery"},y.callback)},c.addStickTopSession=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"addStickTopSession",done:y.done}),m.verifyOptions(y,"id","msg::addStickTopSession");var O=m.getIdArray(y.id);m.verifyParamValid("id",O[0],this.message.validScenes,"msg::addStickTopSession"),m.verifyParamType("id",O[1],"string","msg::addStickTopSession"),O[0]==="superTeam"&&(O[0]="super_team");var D={id:O=O.join("|")};y.topCustom&&(m.verifyParamType("topCustom",y.topCustom,"string","msg::addStickTopSession"),D.topCustom=y.topCustom),this.processCallback(y),this.sendCmd("addStickTopSession",{stickTopSession:D},y.callback)},c.deleteStickTopSession=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"deleteStickTopSession",done:y.done}),m.verifyOptions(y,"id","msg::deleteStickTopSession");var O=m.getIdArray(y.id);m.verifyParamValid("id",O[0],this.message.validScenes,"msg::deleteStickTopSession"),m.verifyParamType("id",O[1],"string","msg::deleteStickTopSession"),O[0]==="superTeam"&&(O[0]="super_team"),O=O.join("|"),this.processCallback(y),this.sendCmd("deleteStickTopSession",{stickTopSession:{id:O}},y.callback)},c.updateStickTopSession=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"updateStickTopSession",done:y.done}),m.verifyOptions(y,"id","msg::updateStickTopSession");var O=m.getIdArray(y.id);m.verifyParamValid("id",O[0],this.message.validScenes,"msg::updateStickTopSession"),m.verifyParamType("id",O[1],"string","msg::updateStickTopSession"),O[0]==="superTeam"&&(O[0]="super_team");var D={id:O=O.join("|")};y.topCustom&&(m.verifyParamType("topCustom",y.topCustom,"string","msg::updateStickTopSession"),D.topCustom=y.topCustom),this.processCallback(y),this.sendCmd("updateStickTopSession",{stickTopSession:D},y.callback)},c.getStickTopSessions=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"getStickTopSessions",done:y.done}),m.verifyOptions(y,"done","msg::getStickTopSessions"),this.processCallback(y);var O,D=this.protocol.sessionSet,he=[];for(var ae in D)(O=this.protocol.getSessionInCache(ae,y.findDelete))&&O.isTop&&he.push(D[ae]);y.callback(null,he)},c.addMsgPin=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"addMsgPin",done:y.done}),m.verifyOptions(y,"msg","msg::addMsgPin"),k.call(this,y.msg,"msg::addMsgPin");var O={pinFrom:this.account};b(y.pinCustom)&&(m.verifyParamType("pinCustom",y.pinCustom,"string","msg::addMsgPin"),O.pinCustom=y.pinCustom);var D={scene:this.message.sceneMap[y.msg.scene],from:y.msg.from,to:y.msg.to,time:y.msg.time,idServer:y.msg.idServer,idClient:y.msg.idClient};this.processCallback(y),this.sendCmd("addMsgPin",{msg:D,pinTag:O},y.callback)},c.updateMsgPin=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"updateMsgPin",done:y.done}),m.verifyOptions(y,"msg","msg::updateMsgPin"),k.call(this,y.msg,"msg::updateMsgPin");var O={pinFrom:this.account};b(y.pinCustom)&&(m.verifyParamType("pinCustom",y.pinCustom,"string","msg::updateMsgPin"),O.pinCustom=y.pinCustom);var D={scene:this.message.sceneMap[y.msg.scene],from:y.msg.from,to:y.msg.to,time:y.msg.time,idServer:y.msg.idServer,idClient:y.msg.idClient};this.processCallback(y),this.sendCmd("updateMsgPin",{msg:D,pinTag:O},y.callback)},c.deleteMsgPin=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"deleteMsgPin",done:y.done}),m.verifyOptions(y,"msg","msg::deleteMsgPin"),k.call(this,y.msg,"msg::deleteMsgPin");var O={pinFrom:this.account},D={scene:this.message.sceneMap[y.msg.scene],from:y.msg.from,to:y.msg.to,time:y.msg.time,idServer:y.msg.idServer,idClient:y.msg.idClient};this.processCallback(y),this.sendCmd("deleteMsgPin",{msg:D,pinTag:O},y.callback)},c.getMsgPins=function(y){var O=this;(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"getMsgPins",done:y.done}),m.verifyOptions(y,"id","msg::getMsgPins");var D=this.db,he=m.getIdArray(y.id);m.verifyParamValid("id",he[0],this.message.validScenes,"msg::getMsgPins"),m.verifyParamType("id",he[1],"string","msg::getMsgPins"),he[0]==="superTeam"&&(he[0]="super_team");var ae={sessionId:he=he.join("|"),timetag:0};if(this.processCallback(y),D.enable){var Ne=this.protocol.timetags.sync;D.getTimetag("pin-"+y.id).then(function(Y){Y>Ne?D.getMsgPins(y.id).then(function(_e){return y.callback(null,{pins:_e||[]})}).catch(function(_e){return y.callback(_e)}):(ae.timetag=Y,ue.call(O))})}else ue.call(this);function ue(){this.sendCmd("getMsgPins",{msgPinReq:ae,id:y.id,NOTSTORE:"msgPinReq"},y.callback)}}},function(t,r,e){var n=e(3),o=e(17),s=e(2),a=e(9),i=e(39).fn,u=e(0),d=u.undef,c=u.notundef,m=e(151),v=e(24).reportAPI;i.markSysMsgRead=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"markSysMsgRead",done:g.done});var b,T=this.db,k=n.resolve(),y=this.protocol;u.verifyOptions(g,"sysMsgs","sysmsg::markSysMsgRead");var O=g.sysMsgs;function D(){g.done(b,g)}u.isArray(O)||(O=[O]),T.enable?k=T.markSysMsgRead(O).then(function(he){O=he,y.onUpdateSysMsg(he)}):(O=o(O).call(O,function(he){return!he.read})).length&&(y.options.autoMarkRead||y.markSysMsgRead(O,!0),s(O).call(O,function(he){he.read=!0}),y.onUpdateSysMsg(O)),k.then(function(){return y.reduceSysMsgUnread(O)}).then(D,function(he){b=he,D()})},i.sendCustomSysMsg=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"sendCustomSysMsg",done:g.done}),u.verifyOptions(g,"scene to content","sysmsg::sendCustomSysMsg"),u.verifyParamValid("scene",g.scene,this.message.validScenes,"sysmsg::sendCustomSysMsg"),this.processCallback(g);var b="sendCustomSysMsg";return g.scene==="p2p"?g.type="customP2p":g.scene==="superTeam"?(g.type="customSuperTeam",b="sendSuperTeamCustomSysMsg"):g.type="customTeam",g.sysMsg=new m(g),o(g)&&(b="sendFilterCustomSysMsg"),this.sendCmd(b,{sysMsg:g.sysMsg,single:!0},g.callback),this.formatReturnSysMsg(g.sysMsg)},i.formatReturnSysMsg=function(g){return g=u.copy(g),this.protocol.completeSysMsg(g),g.status="sending",g=a(m).call(m,g)},i.getLocalSysMsgs=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getLocalSysMsgs",done:g.done});var b,T=this.db,k=[];function y(){g.sysMsgs=k,g.done(b,g)}u.verifyOptions(g),g.category&&u.verifyParamValid("category",g.category,m.validCategories,"sysmsg::getLocalSysMsgs"),g.type&&u.verifyParamValid("type",g.type,m.validTypes,"sysmsg::getLocalSysMsgs"),d(g.limit)&&(g.limit=100),u.verifyParamType("limit",g.limit,"number","sysmsg::getLocalSysMsgs"),u.verifyParamMax("limit",g.limit,100,"sysmsg::getLocalSysMsgs"),c(a(g))?u.verifyParamType("reverse",a(g),"boolean","sysmsg::getLocalSysMsgs"):g.reverse=!1,this.processCallback(g),T.enable?T.getSysMsgs(g).then(function(O){k=O,y()},function(O){b=O,y()}):y()},i.updateLocalSysMsg=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"updateLocalSysMsg",done:g.done});var b,T=this.db,k=null;if(u.verifyOptions(g,"idServer","sysmsg::updateLocalSysMsg"),this.processCallback(g),T.enable){var y=u.filterObj(g,"idServer state localCustom");T.updateSysMsg(y).then(function(D){k=D,O()},function(D){b=D,O()})}else O();function O(){g.sysMsg=k,g.done(b,g)}},i.deleteLocalSysMsg=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"deleteLocalSysMsg",done:g.done});var b,T=this.db;function k(){g.done(b,g)}u.verifyOptions(g,"idServer","sysmsg::deleteLocalSysMsg"),this.processCallback(g),T.enable?T.deleteSysMsg(g.idServer).then(function(){k()},function(y){b=y,k()}):k()},i.deleteAllLocalSysMsgs=function(g){var b;(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"deleteAllLocalSysMsgs",done:g.done});var T=this,k=T.db;function y(){T.protocol.onUpdateSysMsgUnread({}),g.done(b,g)}T.processCallback(g),k.enable?k.deleteAllSysMsgs().then(function(){y()},function(O){b=O,y()}):y()}},function(t,r,e){var n=e(39).fn,o=e(0),s=e(13),a=e(24).reportAPI;n.getChatroomAddress=function(i){(i=i||{}).done=a({instance:this,className:"NIMFn",funcName:"getChatroomAddress",done:i.done}),o.verifyOptions(i,"chatroomId","chatroom::getChatroomAddress"),i.isWeixinApp=s.isWeixinApp,i.type=s.ipVersion,this.processCallback(i),this.sendCmd("getChatroomAddress",i)}},function(t,r){},function(t,r){},function(t,r,e){var n=e(39).fn,o=e(0),s=e(24).reportAPI;n.audioToText=function(a){(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"audioToText",done:a.done}),o.verifyOptions(a,"url","audio::audioToText"),a.audioToText=o.filterObj(a,"url"),this.processCallback(a),this.sendCmd("audioToText",a)}},function(t,r,e){var n=e(39).fn;n.clearDB=function(o){var s=this.db;this.processCallback(o);var a=o.done;s.enable?s.clear().then(a,a):a()},n.removeDB=function(o){var s=this.db;this.processCallback(o);var a=o.done;s.enable?s.destroy().then(a,a):a()},n.closeDB=function(o){var s=this.db;this.processCallback(o);var a=o.done;s.enable?s.close().then(a,a):a()}},function(t,r,e){var n=e(39).fn,o=e(309),s=e(0),a=s.undef,i=e(24).reportAPI;n.getPushNotificationMultiportConfig=function(){return i({instance:this,className:"NIMFn",funcName:"getPushNotificationMultiportConfig",hasCallback:!1}),this.protocol.getPushNotificationMultiportConfig()},n.updatePushNotificationMultiportConfig=function(u){(u=u||{}).done=i({instance:this,className:"NIMFn",funcName:"updatePushNotificationMultiportConfig",done:u.done}),s.verifyOptions(u),a(u.shouldPushNotificationWhenPCOnline)&&(u.shouldPushNotificationWhenPCOnline=!0),u.donnop=new o(u),this.processCallback(u),this.sendCmd("updateDonnop",u)}},function(t,r,e){var n=e(2),o=e(3),s=e(7),a=e(26),i=e(39).fn,u=e(0),d=e(877),c=e(878),m=e(24).reportAPI;function v(g){return a(g)==="object"&&(g.msgEventSubscribes?g=g.msgEventSubscribes:g.msgEventSubscribe?g=g.msgEventSubscribe:g.accounts?g=g.accounts:g.msgEvent&&(g=g.msgEvent).time&&(g.time=+g.time),g.sync===1?g.sync=!0:g.sync===0&&(g.sync=!1)),g}i.batchSendEventsCmds=function(g,b,T){var k=this,y=u.dropArrayDuplicates(b.accounts);y=u.reshape2d(y,100);var O=[];n(y).call(y,function(D){O.push(new o(function(he,ae){var Ne=u.simpleClone(b);Ne.accounts=D,k.sendCmdWithResp(g,Ne,function(ue,Y){ue?ae(ue):he(v(Y))})}))}),o.all(O).then(function(D){var he=null;if(D.length>0)if(D[0].msgEventSubscribe){var ae=D[0].msgEventSubscribe;ae=v(ae);var Ne=[];n(D).call(D,function(ue){Ne=s(Ne).call(Ne,ue.accounts)}),he={accounts:Ne,msgEventSubscribe:ae}}else he=[],n(D).call(D,function(ue){he=s(he).call(he,ue)});T(null,he)},function(D){T(D,null)})},i.publishEvent=function(g){(g=g||{}).done=m({instance:this,className:"NIMFn",funcName:"publishEvent",done:g.done});var b=new d(g);b=b.assembleEvent(),this.processCallback(g),this.sendCmdWithResp("publishEvent",{msgEvent:b},function(T,k){T||(k=v(k)),g.callback(T,k)})},i.subscribeEvent=function(g){(g=g||{}).done=m({instance:this,className:"NIMFn",funcName:"subscribeEvent",done:g.done}),u.verifyOptions(g,"accounts","event::subscribeEvent");var b=new c(g);u.verifyParamType("accounts",g.accounts,"array","event::subscribeEvent"),this.processCallback(g),b=b.assembleEvent(),this.batchSendEventsCmds("subscribeEvent",{msgEventSubscribe:b,accounts:g.accounts},function(T,k){!T&&k&&(k={failedAccounts:k}),g.callback(T,k)})},i.unSubscribeEventsByAccounts=function(g){(g=g||{}).done=m({instance:this,className:"NIMFn",funcName:"unSubscribeEventsByAccounts",done:g.done}),u.verifyOptions(g,"accounts","event::unSubscribeEventsByAccounts"),u.verifyParamType("accounts",g.accounts,"array","event::unSubscribeEventsByAccounts");var b=new c(g);b=b.assembleEvent(),this.processCallback(g),this.batchSendEventsCmds("unSubscribeEventsByAccounts",{msgEventSubscribe:b,accounts:g.accounts},function(T,k){!T&&k&&(k={failedAccounts:k}),g.callback(T,k)})},i.unSubscribeEventsByType=function(g){(g=g||{}).done=m({instance:this,className:"NIMFn",funcName:"unSubscribeEventsByType",done:g.done});var b=new c(g);b=b.assembleEvent(),this.processCallback(g),this.sendCmdWithResp("unSubscribeEventsByType",{msgEventSubscribe:b},function(T,k){g.callback(T,k)})},i.querySubscribeEventsByAccounts=function(g){(g=g||{}).done=m({instance:this,className:"NIMFn",funcName:"querySubscribeEventsByAccounts",done:g.done}),u.verifyOptions(g,"accounts","event::querySubscribeEventsByAccounts"),u.verifyParamType("accounts",g.accounts,"array","event::querySubscribeEventsByAccounts");var b=new c(g);b=b.assembleEvent(),this.processCallback(g),this.batchSendEventsCmds("querySubscribeEventsByAccounts",{msgEventSubscribe:b,accounts:g.accounts},function(T,k){!T&&k&&(k={msgEventSubscribes:k}),g.callback(T,k)})},i.querySubscribeEventsByType=function(g){(g=g||{}).done=m({instance:this,className:"NIMFn",funcName:"querySubscribeEventsByType",done:g.done});var b=new c(g);b=b.assembleEvent(),this.processCallback(g),this.sendCmdWithResp("querySubscribeEventsByType",{msgEventSubscribe:b},function(T,k){T||(k={msgEventSubscribes:v(k)}),g.callback(T,k)})}},function(t,r,e){var n=e(6),o=e(0),s=o.notundef,a=e(40);function i(u){if(o.verifyOptions(u,"type value","event::MsgEvent"),o.verifyParamType("type",u.type,"number","event::MsgEvent"),o.verifyParamType("value",u.value,"number","event::MsgEvent"),this.type=u.type,this.value=u.value,this.idClient=o.guid(),s(u.custom)&&(this.custom=""+u.custom),this.validTime=u.validTime||604800,o.verifyParamType("validTime",this.validTime,"number","event::MsgEvent"),o.verifyParamMin("validTime",this.validTime,60,"event::MsgEvent"),o.verifyParamMax("validTime",this.validTime,604800,"event::MsgEvent"),s(u.broadcastType)){var d;if(o.verifyParamType("broadcastType",u.broadcastType,"number","event::MsgEvent"),n(d=[1,2]).call(d,u.broadcastType)<0)throw new a('"broadcastType":12');this.broadcastType=u.broadcastType}else this.broadcastType=2;s(u.sync)?(o.verifyParamType("sync",u.sync,"boolean","event::MsgEvent"),this.sync=u.sync):this.sync=!1}i.prototype.assembleEvent=function(){return{type:this.type,value:this.value,idClient:this.idClient,custom:this.custom||"",validTime:this.validTime,broadcastType:this.broadcastType,sync:this.sync===!0?1:0}},t.exports=i},function(t,r,e){var n=e(0),o=n.notundef;function s(a){n.verifyOptions(a,"type","event::MsgEventSubscribe"),n.verifyParamType("type",a.type,"number","event::MsgEventSubscribe"),n.findObjIndexInArray([1,2,3],a.type)<0&&n.verifyParamMin("type",a.type,1e5,"event::MsgEventSubscribe"),this.type=a.type,o(a.subscribeTime)?(n.verifyParamType("subscribeTime",a.subscribeTime,"number","event::MsgEventSubscribe"),n.verifyParamMin("subscribeTime",a.subscribeTime,60,"event::MsgEventSubscribe"),n.verifyParamMax("subscribeTime",a.subscribeTime,2592e3,"event::MsgEventSubscribe"),this.subscribeTime=a.subscribeTime):this.subscribeTime=2592e3,o(a.sync)?(n.verifyParamType("sync",a.sync,"boolean","event::MsgEventSubscribe"),this.sync=a.sync):this.sync=!0}s.prototype.assembleEvent=function(){return{type:this.type,subscribeTime:this.subscribeTime,sync:this.sync===!0?1:0}},t.exports=s},function(t,r,e){var n=e(41),o=e(39).fn,s=e(0),a=e(24).reportAPI;o.httpRequestProxy=function(i){(i=i||{}).done=a({instance:this,className:"NIMFn",funcName:"httpRequestProxy",done:i.done}),s.verifyOptions(i,"path","misc::httpRequestProxy");var u=n({},i);delete u.done,this.processCallback(i),this.sendCmd("httpProxy",{proxyTag:u},i.callback)}},function(t,r,e){var n=e(39).fn,o=e(13),s=e(24).reportAPI;n.getQChatAddress=function(a){(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"getQChatAddress",done:a.done}),this.processCallback(a),this.sendCmd("getQChatAddress",{getQChatAddressTag:{ipType:o.ipVersion}},a.done)}},function(t,r,e){e(298);var n=e(194);e(310)(n),t.exports=n},function(t,r,e){var n=e(313),o=e(15),s=e(3),a=e(57),i=e(7),u=e(23),d=e(195).fn,c=e(13),m=e(155).V2NIMConnectStatus;d.connect=function(){if(this.checkNetworkAvailable()===!1&&this.autoconnect)return this.logger.info("connect::skip this reconnection attempt because network is offline"),void this.reconnect();c.isBrowser&&this.reporter.restore(),n(d).connect.call(this)},d.refreshSocketUrl=function(){var v;return this.socketUrlsBackup=this.socketUrlsBackup||[],this.socketUrls=o(v=this.socketUrlsBackup).call(v,0),this.logger.info("link::refreshSocketUrl"),this.statusProtector.emit("auth/loginLifeCycleAddressing"),s.resolve(this.socketUrls)},d.onHandshakeFailed=function(v,g){var b;this.reporter.report("chatroomLogin",{accid:this.account,roomId:this.options&&this.options.chatroomId,serverIps:this.options&&this.options.chatroomAddresses&&this.options.chatroomAddresses.join(","),currentServerIp:g,rt:a()-v,result:408,failReason:"ws_handshake_failed",time:a()}),this.logger.warn(i(b="link::onHandshakeFailed: shandshake failed, startTime: ".concat(v,", targetUrl: ")).call(b,g))},d.onConnectFailed=function(v,g,b){var T,k,y=typeof v=="string"?"connect_failed:".concat(v):"connect_failed";this.reporter.report("chatroomLogin",{accid:this.account,roomId:this.options&&this.options.chatroomId,serverIps:this.options&&this.options.chatroomAddresses&&this.options.chatroomAddresses.join(","),currentServerIp:b,rt:a()-g,result:408,failReason:"ws_".concat(y),time:a()}),this.logger.warn(i(T=i(k="link::onConnectFailed: connect failed due to ".concat(v,", startTime: ")).call(k,g,", targetUrl: ")).call(T,b))},d.onSocketError=function(v,g,b){var T,k,y=typeof v=="string"?"socket.io error:".concat(v):"socket.io error";this.reporter.report("chatroomLogin",{accid:this.account,roomId:this.options&&this.options.chatroomId,serverIps:this.options&&this.options.chatroomAddresses&&this.options.chatroomAddresses.join(","),currentServerIp:b,rt:a()-g,result:408,failReason:"ws_".concat(y),time:a()}),this.logger.warn(i(T=i(k="link::onSocketError: due to ".concat(v,", startTime: ")).call(k,g,", targetUrl: ")).call(T,b))},d.notifyDisconnect=function(v){n(d).notifyDisconnect.call(this,v)},d.disconnect=function(){var v=this,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};if(this.isConnected())return this.sendCmd("logout"),void u(function(){n(d).disconnect.call(v,g)},0);this.connecting?this.logger.warn("ChatroomProtocolFn api disconnect:: connecting but exiting"):this.statusProtector.getConnectStatus()!==m.V2NIM_CONNECT_STATUS_DISCONNECTED?this.logger.warn("ChatroomProtocolFn api disconnect:: has tried to disconnect actively"):this.logger.warn("ChatroomProtocolFn api disconnect:: other logic entered");var b=n(d);b.disconnect.call(this,g)}},function(t,r,e){var n=e(102),o=e(58),s=e(103),a=e(10),i=e(57),u=e(3),d=e(25),c=e(5),m=e(59),v=e(17),g=e(60),b=e(2),T=e(61),k=e(62),y=e(47);function O(Y,_e){var Ce=c(Y);if(m){var ze=m(Y);_e&&(ze=v(ze).call(ze,function(ie){return g(Y,ie).enumerable})),Ce.push.apply(Ce,ze)}return Ce}function D(Y){for(var _e=1;_e<arguments.length;_e++){var Ce,ze,ie=arguments[_e]!=null?arguments[_e]:{};_e%2?b(Ce=O(Object(ie),!0)).call(Ce,function(le){o(Y,le,ie[le])}):T?k(Y,T(ie)):b(ze=O(Object(ie))).call(ze,function(le){y(Y,le,g(ie,le))})}return Y}var he=e(195).fn,ae=e(44),Ne=e(0);function ue(Y){var _e=this;if(Y.code===398)return this.logger.warn("pendingLoginFailed:398 try to reconnect socket linkbackoff set min 5s"),_e.forceDisconnect(),_e.backoff.setMin(5e3),void(_e.retryCount===0?_e.refreshSocketUrl():u.resolve()).then(function(){var Ce;_e.reconnect({allFailedCB:d(Ce=function(ze){this.logger.error("pendingLoginFailed: ",ze.code,ze),this.onAuthError(ze,"link::onLoginReconnectFailed")}).call(Ce,_e,Y)})});this.logger.error("pendingLoginFailed: ",Y.code,Y),_e.onAuthError(Y,"link::onLogin")}he.assembleLogin=function(){var Y=this.options;this.sdkSession=this.genSessionKey();var _e={appKey:Y.appKey,account:Y.account,deviceId:ae.deviceId,chatroomId:Y.chatroomId,session:this.sdkSession,appLogin:this.autoconnect?1:0},Ce=!0;if(Y.loc_x===void 0||Y.loc_y===void 0||Y.loc_z===void 0?Ce=!1:(typeof Y.loc_x!="number"&&(Y.loc_x=0),typeof Y.loc_y!="number"&&(Y.loc_y=0),typeof Y.loc_z!="number"&&(Y.loc_z=0)),Y.authType=Y.loginAuthType,_e=Ne.merge(_e,Ne.filterObj(Y,Ce?"chatroomNick chatroomAvatar chatroomCustom chatroomEnterCustom isAnonymous notifyTargetTags loginAuthType loginExt loc_x loc_y loc_z distance antiSpamBusinessId":"chatroomNick chatroomAvatar chatroomCustom chatroomEnterCustom isAnonymous notifyTargetTags loginAuthType loginExt distance antiSpamBusinessId")),Y.tags&&Y.tags.length>0)try{_e.tags=a(Y.tags)}catch(ze){this.logger.error("assembleLogin::format tags error",Y.tags,ze)}return{type:1,login:_e,imLogin:this.assembleIMLogin()}},he.login=s(n.mark(function Y(){var _e,Ce,ze,ie=this;return n.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return _e=this,le.next=3,_e.assembleLogin();case 3:if(Ce=le.sent,!(ze=this.socket&&this.socket.socket&&this.socket.socket.sessionid)){le.next=13;break}if(this.socketIds||(this.socketIds={}),!this.socketIds[ze]){le.next=10;break}return this.logger.warn("onConnect::repeat login",ze),le.abrupt("return");case 10:this.socketIds[ze]=!0,le.next=14;break;case 13:this.logger.warn("onConnect:: no socketId ",this.socket&&this.socket.socket);case 14:this.logger.warn("link::doLogin: "+ze+" appLogin is "+Ce.login.appLogin),_e.createLoginTime=i(),_e.sendCmd("login",D({},Ce),function(Ie,pe){if(Ie)_e.reporter.report("chatroomLogin",{accid:_e.account,roomId:_e.options&&_e.options.chatroomId,serverIps:_e.options&&_e.options.chatroomAddresses&&_e.options.chatroomAddresses.join(","),currentServerIp:_e.url,rt:i()-_e.createLoginTime,result:Ie?Ie.code:408,failReason:Ie?Ie.message:"",time:i()}),ue.call(_e,Ie),_e.statusProtector.emit("auth/loginLifeCycleLoginFail",Ie);else if(_e.reporter.report("chatroomLogin",{accid:_e.account,roomId:_e.options&&_e.options.chatroomId,serverIps:_e.options&&_e.options.chatroomAddresses&&_e.options.chatroomAddresses.join(","),currentServerIp:_e.url,rt:i()-_e.createLoginTime,result:200,failReason:"",time:i()}),_e.resetReconnectStatus(),ie.heartbeatFail=0,ie.hasLogin=!0,ie.autoconnect=!0,_e.startHeartbeat(),_e.initOnlineListener(),_e.statusProtector.emit("auth/loginLifeCycleLoginSucc"),_e.keepNosSafeUrl)_e.afterLogin(pe);else{var qe=[];_e.parser.checkObjSafeUrl(pe,qe,[]),u.all(qe).then(function(){_e.afterLogin(pe)}).catch(function(){_e.afterLogin(pe)})}});case 17:case"end":return le.stop()}},Y,this)})),he.afterLogin=function(Y){var _e=Y.chatroom;this.sendCmd("getNosCdnHost",{}),this.chatroom=_e,this.notifyLogin(Y)},he.kickedReasons=["","chatroomClosed","managerKick","samePlatformKick","silentlyKick","blacked"],he.kickedMessages=["","","","","",""]},function(t,r,e){var n=e(9),o=e(23),s=e(69),a=e(2),i=e(52),u=e(41),d=e(15),c=e(32),m=e(123),v=e(5),g=e(195).fn,b=e(0),T=e(13),k=e(885),y=e(763),O=e(890),D=e(891),he=e(892);g.completeMsg=function(ae){ae.chatroomId=this.chatroom&&this.chatroom.id,ae.from=this.options.account,ae.fromClientType="Web",ae.time||(ae.time=+new Date)},g.amendMsg=function(ae){return ae},g.onMsg=function(ae){var Ne,ue=n(Ne=this.message).call(Ne,ae.content.msg);if(this.checkMsgUnique(ue)){if(ue.__handleTime=this.reporterHook.getSafeClock(),ue.__receiveTime=ae.__receiveTime,b.get(ae,"content.msg.__clientExt"))try{ue.__clientExt=JSON.parse(ae.content.msg.__clientExt)}catch{this.logger.warn("ChatroomProtocolFn:onMsg __clientExt parse failed ".concat(ae.content.msg.__clientExt))}this.msgBuffer.push(ue),this.msgFlushTimer||this.startMsgFlushTimer(),ae&&ae.content&&ae.content.msg&&ae.content.msg.needHighPriorityMsgAck==="1"&&this.sendCmd("sendChatroomMsgAck",{chatRoomMsgAckTag:{idClient:ue.idClient,chatroomId:ue.chatroomId}})}else this.logger.warn("onMsg::msg::repeat",ue.idClient)},g.startMsgFlushTimer=function(){var ae=this,Ne=ae.options;ae.msgFlushTimer=o(function(){var ue,Y=s(ue=ae.msgBuffer).call(ue,0,Ne.msgBufferSize);if(T.isBrowser){var _e=ae.reporterHook.getSafeClock();a(Y).call(Y,function(Ce){if(Ce.flow!=="out"){var ze={msgId:Ce.idServer,clientId:Ce.idClient,receiveTime:ae.reporterHook.getNTPTime(Ce.__receiveTime),serverTime:Ce.time,callbackTime:ae.reporterHook.getNTPTime(_e),preHandleTime:ae.reporterHook.getNTPTime(Ce.__handleTime),fromAccid:Ce.from,toAccid:ae.options.account,type:4,tid:"",roomId:Ce.chatroomId,result:200,failReason:"",rt:i(_e-Ce.__receiveTime)},ie=b.get(Ce,"__clientExt.statistics.apiCallingTime"),le=b.get(Ce,"__clientExt.statistics.sendTime");ie&&le&&(ze.apiCallingTime=ie,ze.sendTime=le,ze.attachUploadDuration=b.get(Ce,"__clientExt.statistics.attachUploadDuration")||0),ae.reporter&&ae.reporter.report("msgReceive",ze)}delete Ce.__handleTime,delete Ce.__receiveTime,delete Ce.__clientExt})}ae.options.onmsgs(Y),ae.msgBuffer.length?ae.startMsgFlushTimer():delete ae.msgFlushTimer},Ne.msgBufferInterval)},g.checkMsgUnique=b.genCheckUniqueFunc("idClient"),g.onSendMsg=function(ae){var Ne,ue=ae.obj.msg;ae.error?ue.status="fail":(ue=ae.content.msg).status="success",u(ue,ae.obj.msg),ue=n(Ne=this.message).call(Ne,ue),this.checkMsgUnique(ue),ae.obj=ue},g.onHistoryMsgs=function(ae){ae.error||(ae.obj||(ae.obj={}),ae.obj.msgs=this.message.reverseMsgs(ae.content.msgs))},g.onCdnMsgInfo=function(ae){if(ae){ae.cdnUrls&&(ae.cdnUrls=ae.cdnUrls.split("|")),ae.interval&&(ae.interval=1e3*i(ae.interval)),ae.timeout&&(ae.timeout=+ae.timeout),ae.enable&&(ae.enable=+ae.enable),ae.timestamp&&(ae.timestamp=+ae.timestamp,this.correctCdnTime(ae.timestamp));var Ne=!this.cdnInfo.enable&&ae.enable;u(this.cdnInfo,ae),Ne&&this.queryCdnMsgs()}},g.correctCdnTime=function(ae){ae&&typeof ae=="number"&&(this.cdnInfo||(this.cdnInfo={}),this.cdnInfo.timestamp=ae,this.cdnInfo.localTime=+new Date,this.cdnInfo.lastNow=null,this.logger.info("correctCdnTime: timestamp, localTime",ae,this.cdnInfo.localTime,new Date(ae),new Date(this.cdnInfo.localTime)))},g.queryCdnMsgs=function(ae){var Ne,ue=this;if(this.cdnInfo&&this.cdnInfo.enable&&this.isConnected()){this.queryCdnTimer=o(function(){return ue.queryCdnMsgs()},this.cdnInfo.interval);var Y=+new Date;if(Y=Y-this.cdnInfo.localTime+this.cdnInfo.timestamp,Y-=Y%this.cdnInfo.interval,this.cdnInfo.lastNow!==Y&&this.cdnInfo.cdnUrls&&this.cdnInfo.cdnUrls.length){this.cdnInfo.cdnUrls.push(this.cdnInfo.cdnUrls.shift());var _e=this,Ce=this.cdnInfo.decryptKey,ze=this.cdnInfo.timeout||Math.ceil(this.cdnInfo.interval/2),ie=d(Ne=this.cdnInfo.cdnUrls).call(Ne,0);ae=ae||0,function le(){if(ae>=3)return void _e.finalFail++;if(ie.length){var Ie=ie.shift().replace("#time",Y),pe=Ie.split("/")[2],qe=+new Date;_e.adaptersRequest(Ie,{timeout:ze,onload:function($e){if(_e.cdnInfo.lastNow>Y)_e.logger.warn("queryCdnMsgs::doQuery cdnInfo.lastNow > now, will throw data ",_e.cdnInfo.lastNow,Y,$e);else{_e.cdnInfo.lastNow=Y,_e.afterQueryCdn(pe,+new Date-qe,!0);try{$e=JSON.parse($e)}catch(pr){_e.logger.warn("queryCdnMsgs::doQuery::onload parse res error: ",pr)}if($e&&$e.data){$e.ptm&&(_e.cdnInfo.timeout=$e.ptm),$e.pis&&(_e.cdnInfo.interval=1e3*$e.pis);var Lt,Dt,dr=$e.e===!0?(Lt=$e.data,Dt=Ce,k.decrypt(Lt,y.parse(Dt),{mode:O,padding:D}).toString(he)):$e.data;_e.onCdnMsgsSmoothly(dr,Y,1e3*$e.c)}}},onerror:function($e){if(ae++,_e.afterQueryCdn(pe,+new Date-qe,!1),$e.status===404){var Lt;try{var Dt=JSON.parse($e.result);Dt.code===404&&Dt.timestamp&&(Lt=Dt.timestamp)}catch(dr){_e.logger.warn("queryCdnMsgs::doQuery::parse 404 result error",dr,$e)}!Lt&&$e.date&&(Lt=+new Date($e.date)),Lt&&(_e.correctCdnTime(Lt),clearTimeout(_e.queryCdnTimer),_e.queryCdnMsgs(ae))}else le()}},{exception_service:8})}}()}}},g.onCdnMsgsSmoothly=function(ae,Ne,ue){try{ae=JSON.parse(ae)}catch(ie){this.logger.warn("onCdnMsgsSmoothly::JSON.parse error",ie)}if(this.logger.info("receive cdn msgs "+ae.length+" and request time is "+new Date(Ne)),c(ae)&&ae.length){var Y=this,_e=this.options.msgBufferInterval,Ce=Math.ceil(ae.length*_e/ue);ze(),clearInterval(Y.cdnSmoothTimer),Y.cdnSmoothTimer=m(function(){return ze()},_e)}function ze(){if(Y.isConnected()){var ie=s(ae).call(ae,0,Ce);a(ie).call(ie,function(le){var Ie=Y.parser.syncUnserialize(le,"msg");Y.onMsg({content:{msg:Ie}})}),ae.length||clearInterval(Y.cdnSmoothTimer)}}},g.resetCdnData=function(){this.cdnData={},this.finalFail=0,this.cdnDataTime=+new Date},g.initCdnData=function(){this.resetCdnData(),b.isFunction(this.options.onCdnRequestData)?(this.options.cdnRequestDataInterval=this.options.cdnRequestDataInterval||3e4,this.afterQueryCdn=function(ae,Ne,ue){var Y,_e=this;this.cdnData[ae]||(this.cdnData[ae]={success:0,fail:0,sr:0,fr:0,smr:0,fmr:0}),ue?(this.cdnData[ae].success++,this.cdnData[ae].sr+=Ne,Ne>this.cdnData[ae].smr&&(this.cdnData[ae].smr=Ne)):(this.cdnData[ae].fail++,this.cdnData[ae].fr+=Ne,Ne>this.cdnData[ae].fmr&&(this.cdnData[ae].fmr=Ne)),+new Date-this.cdnDataTime<this.options.cdnRequestDataInterval||(a(Y=v(this.cdnData)).call(Y,function(Ce){_e.cdnData[Ce].sr=_e.cdnData[Ce].sr/_e.cdnData[Ce].success||0,_e.cdnData[Ce].fr=_e.cdnData[Ce].fr/_e.cdnData[Ce].fail||0}),this.options.onCdnRequestData(u({},this.cdnData),this.finalFail),this.resetCdnData())}):this.afterQueryCdn=function(){}}},function(t,r,e){var n;t.exports=(n=e(89),e(763),e(887),e(764),e(312),function(){var o=n,s=o.lib.BlockCipher,a=o.algo,i=[],u=[],d=[],c=[],m=[],v=[],g=[],b=[],T=[],k=[];(function(){for(var D=[],he=0;he<256;he++)D[he]=he<128?he<<1:he<<1^283;var ae=0,Ne=0;for(he=0;he<256;he++){var ue=Ne^Ne<<1^Ne<<2^Ne<<3^Ne<<4;ue=ue>>>8^255&ue^99,i[ae]=ue,u[ue]=ae;var Y=D[ae],_e=D[Y],Ce=D[_e],ze=257*D[ue]^16843008*ue;d[ae]=ze<<24|ze>>>8,c[ae]=ze<<16|ze>>>16,m[ae]=ze<<8|ze>>>24,v[ae]=ze,ze=16843009*Ce^65537*_e^257*Y^16843008*ae,g[ue]=ze<<24|ze>>>8,b[ue]=ze<<16|ze>>>16,T[ue]=ze<<8|ze>>>24,k[ue]=ze,ae?(ae=Y^D[D[D[Ce^Y]]],Ne^=D[D[Ne]]):ae=Ne=1}})();var y=[0,1,2,4,8,16,32,64,128,27,54],O=a.AES=s.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var D=this._keyPriorReset=this._key,he=D.words,ae=D.sigBytes/4,Ne=4*((this._nRounds=ae+6)+1),ue=this._keySchedule=[],Y=0;Y<Ne;Y++)Y<ae?ue[Y]=he[Y]:(ze=ue[Y-1],Y%ae?ae>6&&Y%ae==4&&(ze=i[ze>>>24]<<24|i[ze>>>16&255]<<16|i[ze>>>8&255]<<8|i[255&ze]):(ze=i[(ze=ze<<8|ze>>>24)>>>24]<<24|i[ze>>>16&255]<<16|i[ze>>>8&255]<<8|i[255&ze],ze^=y[Y/ae|0]<<24),ue[Y]=ue[Y-ae]^ze);for(var _e=this._invKeySchedule=[],Ce=0;Ce<Ne;Ce++){if(Y=Ne-Ce,Ce%4)var ze=ue[Y];else ze=ue[Y-4];_e[Ce]=Ce<4||Y<=4?ze:g[i[ze>>>24]]^b[i[ze>>>16&255]]^T[i[ze>>>8&255]]^k[i[255&ze]]}}},encryptBlock:function(D,he){this._doCryptBlock(D,he,this._keySchedule,d,c,m,v,i)},decryptBlock:function(D,he){var ae=D[he+1];D[he+1]=D[he+3],D[he+3]=ae,this._doCryptBlock(D,he,this._invKeySchedule,g,b,T,k,u),ae=D[he+1],D[he+1]=D[he+3],D[he+3]=ae},_doCryptBlock:function(D,he,ae,Ne,ue,Y,_e,Ce){for(var ze=this._nRounds,ie=D[he]^ae[0],le=D[he+1]^ae[1],Ie=D[he+2]^ae[2],pe=D[he+3]^ae[3],qe=4,$e=1;$e<ze;$e++){var Lt=Ne[ie>>>24]^ue[le>>>16&255]^Y[Ie>>>8&255]^_e[255&pe]^ae[qe++],Dt=Ne[le>>>24]^ue[Ie>>>16&255]^Y[pe>>>8&255]^_e[255&ie]^ae[qe++],dr=Ne[Ie>>>24]^ue[pe>>>16&255]^Y[ie>>>8&255]^_e[255&le]^ae[qe++],pr=Ne[pe>>>24]^ue[ie>>>16&255]^Y[le>>>8&255]^_e[255&Ie]^ae[qe++];ie=Lt,le=Dt,Ie=dr,pe=pr}Lt=(Ce[ie>>>24]<<24|Ce[le>>>16&255]<<16|Ce[Ie>>>8&255]<<8|Ce[255&pe])^ae[qe++],Dt=(Ce[le>>>24]<<24|Ce[Ie>>>16&255]<<16|Ce[pe>>>8&255]<<8|Ce[255&ie])^ae[qe++],dr=(Ce[Ie>>>24]<<24|Ce[pe>>>16&255]<<16|Ce[ie>>>8&255]<<8|Ce[255&le])^ae[qe++],pr=(Ce[pe>>>24]<<24|Ce[ie>>>16&255]<<16|Ce[le>>>8&255]<<8|Ce[255&Ie])^ae[qe++],D[he]=Lt,D[he+1]=Dt,D[he+2]=dr,D[he+3]=pr},keySize:8});o.AES=s._createHelper(O)}(),n.AES)},function(t,r){},function(t,r,e){var n;t.exports=(n=e(89),function(o){var s=n,a=s.lib,i=a.WordArray,u=a.Hasher,d=s.algo,c=[];(function(){for(var k=0;k<64;k++)c[k]=4294967296*o.abs(o.sin(k+1))|0})();var m=d.MD5=u.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(k,y){for(var O=0;O<16;O++){var D=y+O,he=k[D];k[D]=16711935&(he<<8|he>>>24)|4278255360&(he<<24|he>>>8)}var ae=this._hash.words,Ne=k[y+0],ue=k[y+1],Y=k[y+2],_e=k[y+3],Ce=k[y+4],ze=k[y+5],ie=k[y+6],le=k[y+7],Ie=k[y+8],pe=k[y+9],qe=k[y+10],$e=k[y+11],Lt=k[y+12],Dt=k[y+13],dr=k[y+14],pr=k[y+15],sr=ae[0],hr=ae[1],Fe=ae[2],nr=ae[3];sr=v(sr,hr,Fe,nr,Ne,7,c[0]),nr=v(nr,sr,hr,Fe,ue,12,c[1]),Fe=v(Fe,nr,sr,hr,Y,17,c[2]),hr=v(hr,Fe,nr,sr,_e,22,c[3]),sr=v(sr,hr,Fe,nr,Ce,7,c[4]),nr=v(nr,sr,hr,Fe,ze,12,c[5]),Fe=v(Fe,nr,sr,hr,ie,17,c[6]),hr=v(hr,Fe,nr,sr,le,22,c[7]),sr=v(sr,hr,Fe,nr,Ie,7,c[8]),nr=v(nr,sr,hr,Fe,pe,12,c[9]),Fe=v(Fe,nr,sr,hr,qe,17,c[10]),hr=v(hr,Fe,nr,sr,$e,22,c[11]),sr=v(sr,hr,Fe,nr,Lt,7,c[12]),nr=v(nr,sr,hr,Fe,Dt,12,c[13]),Fe=v(Fe,nr,sr,hr,dr,17,c[14]),sr=g(sr,hr=v(hr,Fe,nr,sr,pr,22,c[15]),Fe,nr,ue,5,c[16]),nr=g(nr,sr,hr,Fe,ie,9,c[17]),Fe=g(Fe,nr,sr,hr,$e,14,c[18]),hr=g(hr,Fe,nr,sr,Ne,20,c[19]),sr=g(sr,hr,Fe,nr,ze,5,c[20]),nr=g(nr,sr,hr,Fe,qe,9,c[21]),Fe=g(Fe,nr,sr,hr,pr,14,c[22]),hr=g(hr,Fe,nr,sr,Ce,20,c[23]),sr=g(sr,hr,Fe,nr,pe,5,c[24]),nr=g(nr,sr,hr,Fe,dr,9,c[25]),Fe=g(Fe,nr,sr,hr,_e,14,c[26]),hr=g(hr,Fe,nr,sr,Ie,20,c[27]),sr=g(sr,hr,Fe,nr,Dt,5,c[28]),nr=g(nr,sr,hr,Fe,Y,9,c[29]),Fe=g(Fe,nr,sr,hr,le,14,c[30]),sr=b(sr,hr=g(hr,Fe,nr,sr,Lt,20,c[31]),Fe,nr,ze,4,c[32]),nr=b(nr,sr,hr,Fe,Ie,11,c[33]),Fe=b(Fe,nr,sr,hr,$e,16,c[34]),hr=b(hr,Fe,nr,sr,dr,23,c[35]),sr=b(sr,hr,Fe,nr,ue,4,c[36]),nr=b(nr,sr,hr,Fe,Ce,11,c[37]),Fe=b(Fe,nr,sr,hr,le,16,c[38]),hr=b(hr,Fe,nr,sr,qe,23,c[39]),sr=b(sr,hr,Fe,nr,Dt,4,c[40]),nr=b(nr,sr,hr,Fe,Ne,11,c[41]),Fe=b(Fe,nr,sr,hr,_e,16,c[42]),hr=b(hr,Fe,nr,sr,ie,23,c[43]),sr=b(sr,hr,Fe,nr,pe,4,c[44]),nr=b(nr,sr,hr,Fe,Lt,11,c[45]),Fe=b(Fe,nr,sr,hr,pr,16,c[46]),sr=T(sr,hr=b(hr,Fe,nr,sr,Y,23,c[47]),Fe,nr,Ne,6,c[48]),nr=T(nr,sr,hr,Fe,le,10,c[49]),Fe=T(Fe,nr,sr,hr,dr,15,c[50]),hr=T(hr,Fe,nr,sr,ze,21,c[51]),sr=T(sr,hr,Fe,nr,Lt,6,c[52]),nr=T(nr,sr,hr,Fe,_e,10,c[53]),Fe=T(Fe,nr,sr,hr,qe,15,c[54]),hr=T(hr,Fe,nr,sr,ue,21,c[55]),sr=T(sr,hr,Fe,nr,Ie,6,c[56]),nr=T(nr,sr,hr,Fe,pr,10,c[57]),Fe=T(Fe,nr,sr,hr,ie,15,c[58]),hr=T(hr,Fe,nr,sr,Dt,21,c[59]),sr=T(sr,hr,Fe,nr,Ce,6,c[60]),nr=T(nr,sr,hr,Fe,$e,10,c[61]),Fe=T(Fe,nr,sr,hr,Y,15,c[62]),hr=T(hr,Fe,nr,sr,pe,21,c[63]),ae[0]=ae[0]+sr|0,ae[1]=ae[1]+hr|0,ae[2]=ae[2]+Fe|0,ae[3]=ae[3]+nr|0},_doFinalize:function(){var k=this._data,y=k.words,O=8*this._nDataBytes,D=8*k.sigBytes;y[D>>>5]|=128<<24-D%32;var he=o.floor(O/4294967296),ae=O;y[15+(D+64>>>9<<4)]=16711935&(he<<8|he>>>24)|4278255360&(he<<24|he>>>8),y[14+(D+64>>>9<<4)]=16711935&(ae<<8|ae>>>24)|4278255360&(ae<<24|ae>>>8),k.sigBytes=4*(y.length+1),this._process();for(var Ne=this._hash,ue=Ne.words,Y=0;Y<4;Y++){var _e=ue[Y];ue[Y]=16711935&(_e<<8|_e>>>24)|4278255360&(_e<<24|_e>>>8)}return Ne},clone:function(){var k=u.clone.call(this);return k._hash=this._hash.clone(),k}});function v(k,y,O,D,he,ae,Ne){var ue=k+(y&O|~y&D)+he+Ne;return(ue<<ae|ue>>>32-ae)+y}function g(k,y,O,D,he,ae,Ne){var ue=k+(y&D|O&~D)+he+Ne;return(ue<<ae|ue>>>32-ae)+y}function b(k,y,O,D,he,ae,Ne){var ue=k+(y^O^D)+he+Ne;return(ue<<ae|ue>>>32-ae)+y}function T(k,y,O,D,he,ae,Ne){var ue=k+(O^(y|~D))+he+Ne;return(ue<<ae|ue>>>32-ae)+y}s.MD5=u._createHelper(m),s.HmacMD5=u._createHmacHelper(m)}(Math),n.MD5)},function(t,r,e){var n,o,s,a,i,u,d,c;t.exports=(c=e(89),o=(n=c).lib,s=o.WordArray,a=o.Hasher,i=n.algo,u=[],d=i.SHA1=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(m,v){for(var g=this._hash.words,b=g[0],T=g[1],k=g[2],y=g[3],O=g[4],D=0;D<80;D++){if(D<16)u[D]=0|m[v+D];else{var he=u[D-3]^u[D-8]^u[D-14]^u[D-16];u[D]=he<<1|he>>>31}var ae=(b<<5|b>>>27)+O+u[D];ae+=D<20?1518500249+(T&k|~T&y):D<40?1859775393+(T^k^y):D<60?(T&k|T&y|k&y)-1894007588:(T^k^y)-899497514,O=y,y=k,k=T<<30|T>>>2,T=b,b=ae}g[0]=g[0]+b|0,g[1]=g[1]+T|0,g[2]=g[2]+k|0,g[3]=g[3]+y|0,g[4]=g[4]+O|0},_doFinalize:function(){var m=this._data,v=m.words,g=8*this._nDataBytes,b=8*m.sigBytes;return v[b>>>5]|=128<<24-b%32,v[14+(b+64>>>9<<4)]=Math.floor(g/4294967296),v[15+(b+64>>>9<<4)]=g,m.sigBytes=4*v.length,this._process(),this._hash},clone:function(){var m=a.clone.call(this);return m._hash=this._hash.clone(),m}}),n.SHA1=a._createHelper(d),n.HmacSHA1=a._createHmacHelper(d),c.SHA1)},function(t,r,e){var n,o,s,a;t.exports=(n=e(89),s=(o=n).lib.Base,a=o.enc.Utf8,void(o.algo.HMAC=s.extend({init:function(i,u){i=this._hasher=new i.init,typeof u=="string"&&(u=a.parse(u));var d=i.blockSize,c=4*d;u.sigBytes>c&&(u=i.finalize(u)),u.clamp();for(var m=this._oKey=u.clone(),v=this._iKey=u.clone(),g=m.words,b=v.words,T=0;T<d;T++)g[T]^=1549556828,b[T]^=909522486;m.sigBytes=v.sigBytes=c,this.reset()},reset:function(){var i=this._hasher;i.reset(),i.update(this._iKey)},update:function(i){return this._hasher.update(i),this},finalize:function(i){var u=this._hasher,d=u.finalize(i);return u.reset(),u.finalize(this._oKey.clone().concat(d))}})))},function(t,r,e){var n,o;t.exports=(o=e(89),e(312),o.mode.ECB=((n=o.lib.BlockCipherMode.extend()).Encryptor=n.extend({processBlock:function(s,a){this._cipher.encryptBlock(s,a)}}),n.Decryptor=n.extend({processBlock:function(s,a){this._cipher.decryptBlock(s,a)}}),n),o.mode.ECB)},function(t,r,e){var n;t.exports=(n=e(89),e(312),n.pad.Pkcs7)},function(t,r,e){var n;t.exports=(n=e(89),n.enc.Utf8)},function(t,r,e){var n=e(9),o=e(195).fn,s=e(311);o.onChatroomMembersInfo=o.onChatroomMembers=function(a){a.error||(a.obj.members=s.reverseMembers(a.content.members))},o.onGetChatroomMemberCountByTag=function(a){a.error||(a.obj=a.content)},o.onMarkChatroomMember=function(a){a.error||(a.obj.member=n(s).call(s,a.content.chatroomMember))},o.onSyncRobot=function(a){!a.error&&this.options.onrobots?this.options.onrobots(null,a.content):this.ontions.onrobots(a.error,{})}},function(t,r,e){var n=e(9),o=e(8),s=e(0),a=function(k){this.account=k.account},i=a.prototype,u=i.Message=e(117),d=i.TextMessage=e(895),c=i.FileMessage=e(205),m=i.GeoMessage=e(899),v=i.NotificationMessage=e(900),g=i.CustomMessage=e(901),b=i.TipMessage=e(902),T=i.RobotMessage=e(903);i.validTypes=u.validTypes,i.reverse=function(k){var y;switch(u.getType(k)){case"text":y=n(d).call(d,k);break;case"image":case"audio":case"video":case"file":y=n(c).call(c,k);break;case"geo":y=n(m).call(m,k);break;case"notification":y=n(v).call(v,k);break;case"custom":y=n(g).call(g,k);break;case"tip":y=n(b).call(b,k);break;case"robot":y=n(T).call(T,k);break;default:y=n(u).call(u,k)}return u.setExtra(y,this.account),y},i.reverseMsgs=function(k,y){var O,D,he=this;return o(k).call(k,function(ae){return ae=n(he).call(he,ae),y&&((O=y.modifyObj)&&(ae=s.merge(ae,O)),D=y.mapper,s.isFunction(D)&&(ae=D(ae))),ae})},t.exports=a},function(t,r,e){var n=e(18),o=e(9),s=e(117),a=e(0);function i(u){a.verifyOptions(u,"text","msg::TextMessage"),u.type="text",s.call(this,u),this.attach=u.text,this.body=""}i.prototype=n(s.prototype),i.reverse=function(u){var d=o(s).call(s,u);return d.text=u.attach,d},t.exports=i},function(t,r,e){var n=e(18),o=e(0),s=e(205);function a(){}a.prototype=n(s.prototype),a.verifyFile=function(i,u){o.verifyOptions(i,"w h",!0,"file.",u)},t.exports=a},function(t,r,e){var n=e(18),o=e(205),s=e(0);function a(){}a.prototype=n(o.prototype),a.verifyFile=function(i,u){s.verifyOptions(i,"dur",!0,"file.",u)},t.exports=a},function(t,r,e){var n=e(18),o=e(205),s=e(0);function a(){}a.prototype=n(o.prototype),a.verifyFile=function(i,u){s.verifyOptions(i,"dur w h",!0,"file.",u)},t.exports=a},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(117),i=e(0);function u(d){d.type="geo",i.verifyOptions(d,"geo","msg::GeoMessage"),i.verifyOptions(d.geo,"lng lat title",!0,"geo.","msg::GeoMessage"),i.verifyParamType("geo.lng",d.geo.lng,"number","msg::GeoMessage"),i.verifyParamType("geo.lat",d.geo.lat,"number","msg::GeoMessage"),i.verifyParamType("geo.title",d.geo.title,"string","msg::GeoMessage"),a.call(this,d),this.attach=n(d.geo)}u.prototype=o(a.prototype),u.reverse=function(d){var c=s(a).call(a,d);return d.attach=d.attach?""+d.attach:"",c.geo=d.attach?JSON.parse(d.attach):{},c},t.exports=u},function(t,r,e){var n=e(18),o=e(9),s=e(52),a=e(0).notundef,i=e(117),u={301:"memberEnter",302:"memberExit",303:"blackMember",304:"unblackMember",305:"gagMember",306:"ungagMember",307:"addManager",308:"removeManager",309:"addCommon",310:"removeCommon",311:"closeChatroom",312:"updateChatroom",313:"kickMember",314:"addTempMute",315:"removeTempMute",316:"updateMemberInfo",317:"updateQueue",318:"muteRoom",319:"unmuteRoom",320:"batchUpdateQueue",321:"addTempMuteTag",322:"removeTempMuteTag",324:"batchQueueOffer",323:"deleteChatroomMsg",325:"updateChatroomTags"};function d(){}d.prototype=n(i.prototype),d.reverse=function(c){var m=o(i).call(i,c);if(c.attach=c.attach?""+c.attach:"",c.attach){var v=JSON.parse(c.attach);if(m.attach={type:u[v.id]},a(v.data)){var g=v.data;if(a(g.operator)&&(m.attach.from=g.operator),a(g.opeNick)&&(m.attach.fromNick=g.opeNick),a(g.target)&&(m.attach.to=g.target),a(g.tarNick)&&(m.attach.toNick=g.tarNick),a(g.muteDuration)&&(m.attach.duration=s(g.muteDuration,10)),a(g.tags)&&(m.attach.tags=g.tags),m.attach.type==="memberEnter"&&(a(g.muted)?m.attach.gaged=+g.muted==1:m.attach.gaged=!1,a(g.tempMuted)?m.attach.tempMuted=+g.tempMuted==1:m.attach.tempMuted=!1,a(g.muteTtl)?m.attach.tempMuteDuration=+g.muteTtl:m.attach.tempMuteDuration=0),m.attach.type==="deleteChatroomMsg"&&(m.attach.msgId=g.msgId,m.attach.msgTime=g.msgTime),a(g.ext)&&(m.attach.custom=g.ext),a(g.queueChange)){var b=JSON.parse(g.queueChange);switch(b._e){case"OFFER":m.attach.queueChange={type:"OFFER",elementKey:b.key,elementValue:b.content};break;case"POLL":m.attach.queueChange={type:"POLL",elementKey:b.key,elementValue:b.content};break;case"DROP":m.attach.queueChange={type:"DROP"};break;case"PARTCLEAR":case"BATCH_UPDATE":m.attach.queueChange={type:b._e,elementKv:b.kvObject};break;case"BATCH_OFFER":m.attach.queueChange={type:b._e,elements:b.elements}}}}}else m.attach={};return m},t.exports=d},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(117),i=e(0);function u(d){i.verifyOptions(d,"content","msg::CustomMessage"),d.type="custom",a.call(this,d),typeof d.content!="string"&&(d.content=n(d.content)),this.attach=d.content}u.prototype=o(a.prototype),u.reverse=function(d){var c=s(a).call(a,d);return c.content=d.attach,c},t.exports=u},function(t,r,e){var n=e(18),o=e(9),s=e(117),a=e(0);function i(u){a.verifyOptions(u,"tip","msg::TipMessage"),u.type="tip",s.call(this,u),this.attach=u.tip}i.prototype=n(s.prototype),i.reverse=function(u){var d=o(s).call(s,u);return d.tip=u.attach,d},t.exports=i},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(8),i=e(117),u=e(0),d={welcome:"00",text:"01",link:"03"},c={"01":"text","02":"image","03":"answer",11:"template"};function m(v){u.verifyOptions(v,"content","msg::RobotMessage");var g=v.content;switch(g.type){case"welcome":u.undef(v.body)&&(this.body="");break;case"text":u.verifyOptions(g,"content","msg::RobotMessage"),u.undef(v.body)&&(this.body=g.content);break;case"link":u.verifyOptions(g,"target","msg::RobotMessage")}g.type&&(g.type=d[g.type]),g={param:g,robotAccid:v.robotAccid},this.attach=n(g),v.type="robot",i.call(this,v)}m.prototype=o(i.prototype),m.reverse=function(v){var g=s(i).call(i,v);if(g.type==="robot"){var b=JSON.parse(v.attach);if(b.param&&(b.param.type=c[b.param.type]||"unknown"),b.robotMsg){var T=(b=u.merge(b,b.robotMsg)).message;b.flag==="bot"?b.message=a(T).call(T,function(k){return k.type=c[k.type]||"unknown",k}):b.flag,delete b.robotMsg}g.content=b}return g},t.exports=m},function(t,r,e){var n=e(9),o=e(32),s=e(8),a=e(17),i=e(10),u=e(0),d=u.undef,c=e(194).fn,m=e(24).reportAPI;c.beforeSendMsg=function(g){g.cmd="sendMsg"};var v={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,tip:10,robot:11,custom:100};c.getHistoryMsgs=function(g){if((g=g||{}).done=m({instance:this,className:"ChatroomFn",funcName:"getHistoryMsgs",done:g.done}),u.verifyOptions(g),d(g.timetag)?g.timetag=0:u.verifyParamType("timetag",g.timetag,"number","msg::getHistoryMsgs"),d(g.limit)?g.limit=100:u.verifyParamType("limit",g.limit,"number","msg::getHistoryMsgs"),d(n(g))?g.reverse=!1:u.verifyParamType("reverse",n(g),"boolean","msg::getHistoryMsgs"),d(g.msgTypes))g.msgTypes=[];else if(o(g.msgTypes)){var b,T;g.msgTypes=s(b=g.msgTypes).call(b,function(k){return v[k]}),g.msgTypes=a(T=g.msgTypes).call(T,function(k){return typeof k=="number"})}else typeof v[g.msgTypes]=="number"?g.msgTypes=[v[g.msgTypes]]:g.msgTypes=[];this.processCallback(g),this.sendCmd("getHistoryMsgs",g,function(k,y,O){o(O)&&(O=s(O).call(O,function(D){return v[D.type]&&(D.type=v[D.type]),D})),g.callback(k,y,O)})},c.getHistoryMsgsByTags=function(g){if((g=g||{}).done=m({instance:this,className:"ChatroomFn",funcName:"getHistoryMsgsByTags",done:g.done}),u.verifyOptions(g,"tags","api::msg::getHistoryMsgsByTags"),u.verifyParamType("tags",g.tags,"array","api::msg::getHistoryMsgsByTags"),d(g.fromTime)?g.fromTime=0:u.verifyParamType("fromTime",g.fromTime,"number","api::msg::getHistoryMsgsByTags"),d(g.toTime)?g.toTime=0:u.verifyParamType("toTime",g.toTime,"number","api::msg::getHistoryMsgsByTags"),d(g.limit)?g.limit=100:u.verifyParamType("limit",g.limit,"number","msg::getHistoryMsgs"),d(n(g))?g.reverse=0:u.verifyParamType("reverse",n(g),"number","msg::getHistoryMsgs"),d(g.types))g.types=[];else if(o(g.types)){var b,T;g.types=s(b=g.types).call(b,function(k){return v[k]}),g.types=a(T=g.types).call(T,function(k){return typeof k=="number"})}else typeof v[g.types]=="number"?g.types=[v[g.types]]:g.types=[];this.processCallback(g),g.types=i(g.types),g.tags=i(g.tags),this.sendCmd("getHistoryMsgsByTags",{chatRoomTagHistoryMsgRequestTag:g},g.callback)}},function(t,r,e){var n=e(194).fn,o=e(24).reportAPI;n.disconnect=function(s){(s=s||{}).done=o({instance:this,className:"ChatroomFn",funcName:"disconnect",done:s.done}),this.protocol.disconnect(s.done)}},function(t,r,e){var n=e(0),o=n.undef,s=n.verifyOptions,a=n.verifyParamType,i=e(311),u=e(194).fn,d=e(24).reportAPI;u.updateMyChatroomMemberInfo=function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"updateMyChatroomMemberInfo",done:c.done}),s(c,"member needNotify","member::updateMyChatroomMemberInfo"),a("needNotify",c.needNotify,"boolean","member::updateMyChatroomMemberInfo"),c.needSave=c.needSave||!1,a("needSave",c.needSave,"boolean","member::updateMyChatroomMemberInfo"),this.processCustom(c),this.processCallback(c),c.chatroomMember=new i(c.member),c.antispamTag={antiSpamBusinessId:c.antiSpamBusinessId},this.sendCmd("updateMyChatroomMemberInfo",c)},u.getChatroomMembers=function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"getChatroomMembers",done:c.done}),s(c,"guest","member::getChatroomMembers"),a("guest",c.guest,"boolean","member::getChatroomMembers"),o(c.time)?c.time=0:a("time",c.time,"number","member::getChatroomMembers"),o(c.limit)?c.limit=100:a("limit",c.limit,"number","member::getChatroomMembers"),this.processCallback(c),c.guest?c.type=c.desc===!1?3:1:c.type=c.onlyOnline?2:0,this.sendCmd("getChatroomMembers",c)},u.getChatroomMembersByTag=function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"getChatroomMembersByTag",done:c.done}),s(c,"tag","getChatroomMembersByTag::rag"),o(c.time)?c.time=0:a("time",c.time,"number","getChatroomMembersByTag::time"),o(c.limit)?c.limit=100:a("limit",c.limit,"number","getChatroomMembersByTag::limit"),this.processCallback(c),this.sendCmd("getChatroomMembersByTag",{tagMemberReq:n.filterObj(c,"tag limit time"),callback:c.callback})},u.getChatroomMemberCountByTag=function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"getChatroomMemberCountByTag",done:c.done}),s(c,"tag","getChatroomMemberCountByTag::rag"),this.processCallback(c),this.sendCmd("getChatroomMemberCountByTag",c)},u.getChatroomMembersInfo=function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"getChatroomMembersInfo",done:c.done}),s(c,"accounts","member::getChatroomMembersInfo"),a("accounts",c.accounts,"array","member::getChatroomMembersInfo"),this.processCallback(c),this.sendCmd("getChatroomMembersInfo",c)},u.markChatroomIdentity=function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"markChatroomIdentity",done:c.done}),s(c,"identity","member::markChatroomIdentity"),c.type={manager:1,common:2,black:-1,mute:-2}[c.identity],delete c.identity,isNaN(c.type)?s(c,"identity",'member::markChatroomIdentity. The valid value of the identity is "manager" or "common" or "black" or "mute".'):this.markChatroomMember(c)},u.markChatroomManager=function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"markChatroomManager",done:c.done}),c.type=1,this.markChatroomMember(c)},u.markChatroomCommonMember=function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"markChatroomCommonMember",done:c.done}),c.type=2,this.markChatroomMember(c)},u.markChatroomBlacklist=function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"markChatroomBlacklist",done:c.done}),c.type=-1,this.markChatroomMember(c)},u.markChatroomGaglist=function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"markChatroomGaglist",done:c.done}),c.type=-2,this.markChatroomMember(c)},u.markChatroomMember=function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"markChatroomMember",done:c.done}),s(c,"account type isAdd","member::markChatroomMember"),a("isAdd",c.isAdd,"boolean","member::markChatroomMember"),o(c.level)?c.level=0:a("level",c.level,"number","member::markChatroomMember"),this.processCustom(c),this.processCallback(c),this.sendCmd("markChatroomMember",c)},u.kickChatroomMember=function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"kickChatroomMember",done:c.done}),s(c,"account","member::kickChatroomMember"),this.processCustom(c),this.processCallback(c),this.sendCmd("kickChatroomMember",c)},u.updateChatroomMemberTempMute=function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"updateChatroomMemberTempMute",done:c.done}),s(c,"account duration needNotify","member::updateChatroomMemberTempMute"),a("duration",c.duration,"number","member::updateChatroomMemberTempMute"),a("needNotify",c.needNotify,"boolean","member::updateChatroomMemberTempMute"),this.processCustom(c),this.processCallback(c),this.sendCmd("updateChatroomMemberTempMute",c)},u.updateTagMembersTempMute=function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"updateTagMembersTempMute",done:c.done}),s(c,"tag duration needNotify","member::updateTagMembersTempMute"),a("duration",c.duration,"number","member::updateTagMembersTempMute"),a("needNotify",c.needNotify,"boolean","member::updateTagMembersTempMute"),this.processCustom(c),this.processCallback(c);var m=n.filterObj(c,"tag duration custom notifyTargetTags");m.needNotify=c.needNotify?1:0,this.sendCmd("updateTagMembersTempMute",{tagMuteReq:m,callback:c.callback})},u.updateCoordinate=n.throttle(function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"updateCoordinate",done:c.done});var m=!0;c.x===void 0||c.y===void 0||c.z===void 0?m=!1:(typeof c.x!="number"&&(c.x=0),typeof c.y!="number"&&(c.y=0),typeof c.z!="number"&&(c.z=0)),this.processCallback(c);var v=n.filterObj(c,m?"x y z distance":"distance");this.sendCmd("updateCoordinate",{coordinateReq:v,callback:c.callback})},300,{},function(c){c&&c.done&&c.done({code:416,chatroomId:this.options.chatroomId})}),u.getRobotList=function(c){(c=c||{}).done=d({instance:this,className:"ChatroomFn",funcName:"getRobotList",done:c.done}),this.logger.warn("this api will be abandon"),o(c.timetag)&&(c.timetag=0),this.processCallback(c),this.sendCmd("syncRobot",c)}},function(t,r,e){var n=e(194).fn,o=e(0),s=e(24).reportAPI;n.queueOffer=function(a){(a=a||{}).done=s({instance:this,className:"ChatroomFn",funcName:"queueOffer",done:a.done}),o.verifyOptions(a,"elementKey elementValue","msg::queueOffer");var i={elementKey:a.elementKey,elementValue:a.elementValue,transient:!!a.transient};a.elementAccount&&(i.elementAccount=a.elementAccount),this.processCallback(a),this.sendCmd("queueOffer",i,a.callback)},n.queuePoll=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(a=a||{}).done=s({instance:this,className:"ChatroomFn",funcName:"queuePoll",done:a.done}),a.elementKey=a.elementKey||"",this.processCallback(a),this.sendCmd("queuePoll",a,a.callback)},n.queueList=function(a){(a=a||{}).done=s({instance:this,className:"ChatroomFn",funcName:"queueList",done:a.done}),this.processCallback(a),this.sendCmd("queueList",a,a.callback)},n.peak=function(a){(a=a||{}).done=s({instance:this,className:"ChatroomFn",funcName:"peak",done:a.done}),this.processCallback(a),this.sendCmd("peak",a,a.callback)},n.queueDrop=function(a){(a=a||{}).done=s({instance:this,className:"ChatroomFn",funcName:"queueDrop",done:a.done}),this.processCallback(a),this.sendCmd("queueDrop",a,a.callback)},n.queueChange=function(a){(a=a||{}).done=s({instance:this,className:"ChatroomFn",funcName:"queueChange",done:a.done}),o.verifyOptions(a,"elementMap","msg::queueOffer"),a.needNotify?(a.needNotify=!0,o.verifyOptions(a,"notifyExt","msg::queueOffer")):a.needNotify=!1,this.processCallback(a),this.sendCmd("queueChange",a,a.callback)}},,,function(t,r,e){t.exports=e(911)},function(t,r,e){e(298);var n={NIM:e(765),Chatroom:e(881)};e(310)(n),t.exports=n}])})})(NIM_Web_SDK);var NIM_Web_SDKExports=NIM_Web_SDK.exports;const NIM_SDK=getDefaultExportFromCjs(NIM_Web_SDKExports);class NimChatroomSocket{constructor(r){Fi(this,"liveId");Fi(this,"nimChatroomSocket");Fi(this,"onMessage");Fi(this,"handleRoomSocketMessage",r=>{this.onMessage(this,r)});Fi(this,"onConnet",r=>{console.log("")});Fi(this,"handleRoomSocketError",(r,e)=>{console.log("",r,e)});Fi(this,"handleRoomSocketDisconnect",r=>{console.log("",r)});this.liveId=r.liveId,this.onMessage=r.onMessage}init(r){this.nimChatroomSocket=NIM_SDK.Chatroom.getInstance({appKey:atob(r),chatroomId:this.liveId,chatroomAddresses:["chatweblink01.netease.im:443"],onconnect:this.onConnet,onmsgs:this.handleRoomSocketMessage,onerror:this.handleRoomSocketError,ondisconnect:this.handleRoomSocketDisconnect,isAnonymous:!0,chatroomNick:this.uuid(),chatroomAvatar:"",db:!1,dbLog:!1})}disconnect(){var r,e;(e=(r=this.nimChatroomSocket)==null?void 0:r.disconnect)==null||e.call(r,{done(){}}),this.nimChatroomSocket=void 0}uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var e=Math.random()*16|0,n=r==="x"?e:e&3|8;return n.toString(16)})}}class PocketMessage{constructor(){Fi(this,"content");Fi(this,"url");Fi(this,"type");Fi(this,"color")}add(r,e){return this.content=r,this.type=1,this.color=e,this}addImg(r,e,n){return this.content=r,this.url=e,this.type=2,this.color=n,this}addVoice(r,e,n){return this.content=r,this.url=e,this.type=3,this.color=n,this}addVideo(r,e,n){return this.content=r,this.url=e,this.type=4,this.color=n,this}}const elMessageBox="",elInput="",elOverlay="",_hoisted_1$2={key:0,style:{color:"green"}},_hoisted_2$2={key:1,style:{color:"orange"}},_hoisted_3$2=createBaseVNode("h3",{style:{"margin-left":"40%"}},"",-1),_hoisted_4$2={style:{height:"530px",overflow:"auto"},id:"textArae"},_hoisted_5$2={style:{margin:"5px"}},_hoisted_6$1={key:1},_hoisted_7$1={style:{height:"530px",overflow:"auto"}},_hoisted_8$1=createBaseVNode("tr",null,[createBaseVNode("th",{width:"300px"},""),createBaseVNode("th",null,"")],-1),_hoisted_9$1={align:"center"},_hoisted_10$1=createBaseVNode("span",{title:"",style:{position:"absolute",right:"10px",bottom:"0",color:"rgb(194, 191, 191)","font-size":"15px"}},"QQ1615842006",-1),_sfc_main$3=defineComponent({__name:"Index",setup(t){const r=ref(!1),e=ref({}),n=ref({}),o=ref(!1),s=ref(!1),a=useRouter(),i=ref(),u=ref(),d=ref(),c=ref(new Array),m=ref(new Array),v=ref(),g=ref(!1);watch(c.value,(qe,$e)=>{qe.length>=100&&c.value.splice(0,1);var Lt=document.getElementById("textArae");Lt!==null&&(Lt.scrollTop=Lt.scrollHeight)});const b=async()=>{await axios$1({url:"http://parkerbot.api/api/StartAliYunApi"})},T=async()=>{var qe=await axios$1({url:"http://parkerbot.api/api/StartMiraiConsole"});qe.data||ElMessage({showClose:!0,message:"Mirai",type:"error"}),qe.data&&ElMessage({showClose:!0,message:"Mirai",type:"success"})},k=async()=>{i.value&&i.value.destroy(),u.value&&u.value.destroy();const qe=await Y();e.value=qe.data.config;const $e=qe.data.config.KD;var Lt=!1;if(qe.data.enable.forEach(pr=>{pr.key=="KD"&&(Lt=JSON.parse(pr.value))}),Lt)console.log($e),i.value=new NIMSDK({appkey:atob($e.appKey),account:$e.account,token:$e.token}),await i.value.connect(),u.value=new QChatSDK({appkey:atob($e.appKey),account:$e.account,token:$e.token,linkAddresses:await i.value.plugin.getQChatAddress({ipType:2})}),u.value.on("logined",y),u.value.on("message",O),u.value.on("disconnect",he),await u.value.login();else{var Dt="";c.value.push(new PocketMessage().add(Dt)),Dt="";var dr=await axios$1({url:"http://parkerbot.api/api/start"});o.value&&(dr.data.mirai?Dt+="QQ":Dt+="QQ"),setTimeout(()=>{Dt&&c.value.push(new PocketMessage().add(Dt)),c.value.push(new PocketMessage().add(""))},500)}},y=async function(){var qe=`${e.value.KD.name}`;if(c.value.push(new PocketMessage().add(qe)),u.value==null)throw"";if((await u.value.qchatServer.subscribeAllChannel({type:1,serverIds:[e.value.KD.serverId]})).failServerIds.length){qe=`${e.value.KD.name}`,c.value.push(new PocketMessage().add(qe));return}qe=`${e.value.KD.name}`,c.value.push(new PocketMessage().add(qe)),d.value=new NimChatroomSocket({liveId:e.value.KD.liveRoomId,onMessage:D}),d.value.init(e.value.KD.appKey);var Lt=await axios$1({url:"http://parkerbot.api/api/start"});v.value=new window.WebSocket("ws://localhost:6001"),v.value.onopen=()=>{g.value=!0,c.value.push(new PocketMessage().add(""))},v.value.onclose=()=>{g.value=!1,c.value.push(new PocketMessage().add(""))},o.value&&(Lt.data.mirai?qe="QQ":qe="QQ",c.value.push(new PocketMessage().add(qe)))},O=async function(qe){var Lt,Dt,dr,pr;if(qe.fromType=1,qe.ext=JSON.parse(qe.ext),qe.channelName=await ae(qe.channelId),qe.time=dayjs(qe.time).format("YYYY-MM-DD HH:mm:ss"),g.value&&((Lt=v.value)==null||Lt.send(JSON.stringify(qe))),qe.type=="text"){var $e=`${qe.channelName}|${qe.time}${qe.ext.user.nickName}:${qe.body}`;c.value.push(new PocketMessage().add($e))}else qe.type=="image"?c.value.push(new PocketMessage().addImg(`${qe.channelName}|${qe.time}${qe.ext.user.nickName}:`,(Dt=qe==null?void 0:qe.attach)==null?void 0:Dt.url)):qe.type=="video"?c.value.push(new PocketMessage().addVideo(`${qe.channelName}|${qe.time}${qe.ext.user.nickName}:`,(dr=qe==null?void 0:qe.attach)==null?void 0:dr.url)):qe.type=="audio"?c.value.push(new PocketMessage().addVoice(`${qe.channelName}|${qe.time}${qe.ext.user.nickName}:`,(pr=qe==null?void 0:qe.attach)==null?void 0:pr.url)):qe.type=="custom"&&c.value.push(new PocketMessage().add(`${qe.channelName}|${qe.time}${qe.ext.user.nickName}:`))},D=function(qe,$e){$e.forEach(Lt=>{var Dt;g.value&&(Lt.fromType=2,(Dt=v.value)==null||Dt.send(JSON.stringify(Lt)))})},he=function(...qe){c.value.push(new PocketMessage().add(""))},ae=async function(qe){if(u.value==null)throw"";const $e=await u.value.qchatChannel.getChannels({channelIds:[`${qe}`]});return $e?$e[0].name:""},Ne=()=>{i.value&&i.value.destroy(),u.value&&u.value.destroy(),d.value&&d.value.disconnect(),a.push("/config")},ue=()=>{i.value&&i.value.destroy(),u.value&&u.value.destroy(),d.value&&d.value.disconnect(),a.push("mirai")},Y=async()=>{var qe=await axios$1({url:"http://parkerbot.api/api/GetBaseConfig"});return qe};onMounted(async()=>{const qe=await Y();e.value=qe.data.config,n.value=qe.data.mirai,o.value=qe.data.mirai.useMirai,qe.data.enable.forEach(Dt=>{Dt.key==="BD"&&JSON.parse(Dt.value)&&qe.data.config.BD.saveAliyunDisk&&(s.value=!0)}),r.value=qe.data.windStatus,await ze();let $e="QQ";if(r.value){var Lt=$e;c.value.find(Dt=>Dt.content===$e)||c.value.push(new PocketMessage().add(Lt,"red"))}else c.value=c.value.filter(Dt=>Dt.content!==$e)});const _e=async(qe,$e)=>{var Lt=await axios$1({url:"http://parkerbot.api/api/piccheck?id="+qe+"&type=1"});Lt.data&&(ElMessage({showClose:!0,message:"",type:"success"}),m.value.splice($e,1)),Lt.data||ElMessage({showClose:!0,message:"",type:"error"})},Ce=async(qe,$e)=>{var Lt=await axios$1({url:"http://parkerbot.api/api/piccheck?id="+qe+"&type=2"});Lt.data&&(ElMessage({showClose:!0,message:"",type:"success"}),m.value.splice($e,1)),Lt.data||ElMessage({showClose:!0,message:"",type:"error"})},ze=async()=>{var qe=await axios$1({url:"http://parkerbot.api/api/refresh"});m.value=qe.data},ie=()=>{ElMessageBox.prompt("","id",{confirmButtonText:"",cancelButtonText:"",beforeClose:(qe,$e,Lt)=>{if(qe=="confirm"){const Dt=$e.inputValue;!Dt||Dt.trim()===""?ElMessage({showClose:!0,message:"id",type:"warning"}):Lt()}else Lt()}}).then(async({value:qe})=>{if(!(!qe||qe.trim()==="")){var $e=await axios$1({url:"http://parkerbot.api/api/SaveByBlogId?blogId="+qe});$e.data.success?ElMessage({showClose:!0,message:$e.data.msg||"",type:"success"}):ElMessage({showClose:!0,message:$e.data.msg||"",type:"error"})}})},le=()=>{r.value=!r.value,ElMessage.success(r.value?"":""),axios$1.get("http://parkerbot.api/api/SetWindStatus",{params:{windStatus:r.value}});let qe="QQ";if(r.value){var $e=qe;c.value.find(Lt=>Lt.content===qe)||c.value.push(new PocketMessage().add($e,"red"))}else c.value=c.value.filter(Lt=>Lt.content!==qe)},Ie=()=>{ElMessageBox.alert("55qq","",{confirmButtonText:"",beforeClose:(qe,$e,Lt)=>{qe==="confirm"&&axios$1.get("http://parkerbot.api/api/closeRemote"),Lt()}})},pe=()=>{ElMessageBox.alert("","",{confirmButtonText:"",callback:()=>{axios$1.get("http://parkerbot.api/api/clearCache").then(qe=>{qe.data?ElMessage.success(""):ElMessage.error("")})}})};return(qe,$e)=>{const Lt=ElButton,Dt=ElHeader,dr=ElIcon,pr=ElDropdownItem,sr=ElDropdownMenu,hr=ElDropdown,Fe=ElImage,nr=ElCol,ir=ElRow,Ue=ElMain,rr=ElContainer;return openBlock(),createElementBlock(Fragment,null,[createVNode(rr,null,{default:withCtx(()=>[createVNode(Dt,{height:"50px"},{default:withCtx(()=>[createVNode(Lt,{type:"primary","native-type":"button",icon:unref(setting_default),onClick:Ne},{default:withCtx(()=>[createTextVNode("  ")]),_:1},8,["icon"]),r.value?createCommentVNode("",!0):(openBlock(),createBlock(Lt,{key:0,title:"QQ",type:"primary","native-type":"button",icon:unref(setting_default),onClick:ue},{default:withCtx(()=>[createTextVNode(" Mirai ")]),_:1},8,["icon"])),o.value?(openBlock(),createBlock(Lt,{key:1,type:"primary","native-type":"button",onClick:T},{default:withCtx(()=>[createTextVNode("Mirai")]),_:1})):createCommentVNode("",!0),createVNode(Lt,{type:"primary","native-type":"button",onClick:k},{default:withCtx(()=>[createTextVNode("")]),_:1}),s.value?(openBlock(),createBlock(Lt,{key:2,type:"primary","native-type":"button",onClick:b},{default:withCtx(()=>[createTextVNode("")]),_:1})):createCommentVNode("",!0)]),_:1}),createVNode(hr,{style:{right:"1vw",position:"fixed"}},{dropdown:withCtx(()=>[createVNode(sr,null,{default:withCtx(()=>[createVNode(pr,{onClick:ie},{default:withCtx(()=>[createTextVNode("")]),_:1}),createVNode(pr,{onClick:le},{default:withCtx(()=>[r.value?(openBlock(),createElementBlock("span",_hoisted_2$2,"")):(openBlock(),createElementBlock("span",_hoisted_1$2,""))]),_:1}),r.value?(openBlock(),createBlock(pr,{key:0,onClick:Ie},{default:withCtx(()=>[createTextVNode("")]),_:1})):createCommentVNode("",!0),createVNode(pr,{onClick:pe},{default:withCtx(()=>[createTextVNode("")]),_:1})]),_:1})]),default:withCtx(()=>[createVNode(Lt,{type:"primary"},{default:withCtx(()=>[createTextVNode(" "),createVNode(dr,null,{default:withCtx(()=>[createVNode(unref(arrow_down_bold_default))]),_:1})]),_:1})]),_:1}),createVNode(Ue,null,{default:withCtx(()=>[createVNode(ir,{gutter:20},{default:withCtx(()=>[createVNode(nr,{span:12},{default:withCtx(()=>[_hoisted_3$2,createBaseVNode("div",_hoisted_4$2,[(openBlock(!0),createElementBlock(Fragment,null,renderList(c.value,(or,Pt)=>(openBlock(),createElementBlock("div",_hoisted_5$2,[createTextVNode(toDisplayString(Pt+1+":")+" ",1),or.type!=2?(openBlock(),createElementBlock("span",{key:0,style:normalizeStyle({color:or.color||""})},toDisplayString(or.content),5)):createCommentVNode("",!0),or.type==2?(openBlock(),createElementBlock("span",_hoisted_6$1,[createTextVNode(toDisplayString(or.content)+" ",1),createVNode(Fe,{style:{height:"80px",width:"80px"},src:or.url,"preview-src-list":[or.url]},null,8,["src","preview-src-list"])])):createCommentVNode("",!0)]))),256))])]),_:1}),createVNode(nr,{span:12},{default:withCtx(()=>[createBaseVNode("h3",{title:"",onClick:ze,style:{cursor:"pointer","margin-left":"40%"}},""),createBaseVNode("div",_hoisted_7$1,[createBaseVNode("table",null,[_hoisted_8$1,(openBlock(!0),createElementBlock(Fragment,null,renderList(m.value,(or,Pt)=>(openBlock(),createElementBlock("tr",null,[createBaseVNode("td",_hoisted_9$1,[createVNode(Fe,{style:{height:"80px",width:"80px"},src:or.content,"preview-src-list":[or.content]},null,8,["src","preview-src-list"])]),createBaseVNode("td",null,[createVNode(Lt,{size:"small",onClick:Et=>_e(or.id,Pt)},{default:withCtx(()=>[createTextVNode("")]),_:2},1032,["onClick"]),createVNode(Lt,{size:"small",type:"danger",onClick:Et=>Ce(or.id,Pt)},{default:withCtx(()=>[createTextVNode("")]),_:2},1032,["onClick"])])]))),256))])])]),_:1})]),_:1})]),_:1})]),_:1}),_hoisted_10$1],64)}}}),elCascader="",elTag="",elCascaderPanel="",elCheckbox="",elRadio="",elDialog="",elBacktop="",elCollapse="",elForm="",elUpload="",elProgress="",elSwitch="",elCollapseItem="",elOption="",elOptionGroup="",elSelect="",elCheckboxGroup="",elTransfer="",elFormItem="",elAffix="",elBadge="",elMessage="",_hoisted_1$1={style:{"margin-bottom":"1%"}},_hoisted_2$1=createBaseVNode("label",{style:{"font-size":"18px","margin-right":"3%"}},"",-1),_hoisted_3$1=createBaseVNode("span",{style:{color:"red"}},"*",-1),_hoisted_4$1=createBaseVNode("span",{style:{color:"red"}},"*",-1),_hoisted_5$1=createBaseVNode("span",{style:{color:"red"}},"*,",-1),_hoisted_6=createBaseVNode("span",{style:{color:"red"}},"*",-1),_hoisted_7=createBaseVNode("span",{style:{color:"red"}},"*,qq",-1),_hoisted_8=createBaseVNode("span",{style:{color:"red"}},"*,",-1),_hoisted_9=createBaseVNode("span",{style:{color:"red"}},"*,qq",-1),_hoisted_10=createBaseVNode("span",{style:{color:"red"}},"*,",-1),_hoisted_11=createBaseVNode("span",{style:{color:"red"}},"*IMtoken",-1),_hoisted_12=createBaseVNode("span",{style:{color:"red"}},"*,qq",-1),_hoisted_13=createBaseVNode("span",{style:{color:"red"}},"*,",-1),_hoisted_14=createBaseVNode("span",{style:{color:"red"}},"*,qq",-1),_hoisted_15=createBaseVNode("span",{style:{color:"red"}},"*,",-1),_hoisted_16=createBaseVNode("span",{style:{color:"red"}},"*,qq",-1),_hoisted_17=createBaseVNode("span",{style:{color:"red"}},"*,",-1),_hoisted_18=createBaseVNode("span",{style:{color:"red"}},"*",-1),_hoisted_19=createBaseVNode("span",{style:{color:"red"}},"*(8070)",-1),_hoisted_20=createBaseVNode("span",{style:{color:"red"}},"*",-1),_hoisted_21=createBaseVNode("span",{style:{color:"red"}},"*",-1),_hoisted_22={key:0,style:{width:"95%","margin-top":"5px"}},_hoisted_23=createBaseVNode("span",null,"",-1),_hoisted_24={style:{"word-break":"break-all"}},_sfc_main$2=defineComponent({__name:"Config",setup(t){const r=ref(!1),e=ref([]),n=ref([]),o=ref([]),s=ref([]),a=ref(!1),i=ref({show:!1,group:[],name:"",loading:!1,url:""}),u=ref({qq:!1,wb:!1,bz:!1,kd:!1,xhs:!1,dy:!1,bd:!1}),d=ref(),c=ref({QQ:{group:"",funcEnable:"",funcEnable1:[],funcAdmin:"",funcAdmin1:[],funcUser:"",funcUser1:[],admin:"",notice:!1,permission:"",sensitive:"",action:"",actions:Array(),debug:!1,gptKey:""},WB:{url:"",timeSpan:0,group:"",forwardGroup:!1,qq:"",forwardQQ:!1,cg:"",keyword:""},BZ:{url:"",timeSpan:0,group:"",forwardGroup:!1,qq:"",forwardQQ:!1},KD:{name:"",sec:60,hasSend:!1,area:"86",code:"",phone:"",group:"",forwardGroup:!1,token:"",account:"",serverId:"",qq:"",forwardQQ:!1,liveRoomId:"",msgType:""},XHS:{url:"",timeSpan:0,group:"",forwardGroup:!1,qq:"",forwardQQ:!1},DY:{url:"",timeSpan:0,group:"",forwardGroup:!1,qq:"",forwardQQ:!1},BD:{appKey:"",appSeret:"",faceVerify:!1,imageList:"",imageList1:new Array,similarity:0,saveAliyunDisk:!1,audit:0,albumName:""}}),m=ref({input:[{required:!0,message:"",trigger:"blur"}],imageList1:[{required:!0,validator:(ue,Y,_e)=>{c.value.BD.faceVerify&&c.value.BD.imageList1.length<=0&&_e(new Error("")),_e()},trigger:["blur","change"]}],audit:[{required:!0,validator:(ue,Y,_e)=>{c.value.BD.faceVerify&&!Y&&_e(new Error("")),_e()},trigger:["blur","change"]}],saveAliyunDisk:[{required:!0,validator:(ue,Y,_e)=>{c.value.BD.saveAliyunDisk&&!Y&&_e(new Error("")),_e()},trigger:["blur","change"]}]});watch(n,(ue,Y)=>{if(ue.length<=0){c.value.QQ.funcEnable1=[];return}var _e=ue.filter(function(ie){return Y.indexOf(ie)===-1}).concat(Y.filter(function(ie){return ue.indexOf(ie)===-1})),Ce=_e[0];if(ue.length>Y.length&&e.value.forEach(ie=>{if(ie.value==Ce&&!c.value.QQ.funcEnable1.some(le=>le.value==Ce)){c.value.QQ.funcEnable1.push(ie);return}}),ue.length<Y.length){var ze=-1;c.value.QQ.funcEnable1.forEach((ie,le)=>{if(ie.value==Ce){ze=le;return}}),c.value.QQ.funcEnable1.splice(ze,1)}}),onMounted(()=>{axios$1({url:"http://parkerbot.api/api/GetBaseConfig"}).then(ue=>{for(let Y in u.value)for(let _e of ue.data.enable)if(_e.key.toLowerCase()==Y){JSON.parse(_e.value)?u.value[Y]=!0:u.value[Y]=!1;continue}s.value=JSON.parse(ue.data.config.KD.msgTypeList),ue.data.config.QQ.funcEnable1=ue.data.config.QQ.funcEnable?JSON.parse(ue.data.config.QQ.funcEnable):new Array,ue.data.config.QQ.funcAdmin1=ue.data.config.QQ.funcAdmin?ue.data.config.QQ.funcAdmin.split(","):[],ue.data.config.QQ.funcUser1=ue.data.config.QQ.funcUser?ue.data.config.QQ.funcUser.split(","):[],c.value=ue.data.config,c.value.QQ.actions=c.value.QQ.action===""?[]:c.value.QQ.action.split(","),c.value.KD.area="86",n.value=ue.data.config.QQ.funcEnable1.map(Y=>Y.value),o.value=c.value.KD.msgType?c.value.KD.msgType.split(","):[],r.value=ue.data.windStatus||!1}),axios$1({url:"http://parkerbot.api/api/GetQQFun"}).then(ue=>{e.value=ue.data})});const v=()=>{history.go(-1)},g=async ue=>{ue&&await ue.validate((Y,_e)=>{if(Y){c.value.BD.imageList=c.value.BD.imageList1.map(ie=>ie.url).toString(),c.value.QQ.action=c.value.QQ.actions.toString(),c.value.QQ.funcEnable=JSON.stringify(c.value.QQ.funcEnable1);var Ce=c.value.QQ.funcEnable1.map(ie=>ie.value),ze=Ce.filter(function(ie){return c.value.QQ.funcUser.indexOf(ie)==-1});c.value.QQ.funcAdmin=ze.toString(),c.value.QQ.funcUser=c.value.QQ.funcUser1.toString(),c.value.KD.msgType=o.value.toString(),axios$1({url:"http://parkerbot.api/api/SetConfig",method:"post",data:{config:c.value,enable:u.value}}).then(ie=>{ie.data?ElMessage({message:"",type:"success"}):ElMessage({message:"",type:"error"})})}else return ElMessage({message:"",type:"warning"}),!1})},b=()=>{i.value.loading=!1,i.value.show=!1,i.value.name="",i.value.url="",i.value.group=[],a.value=!1,c.value.KD.hasSend=!1,c.value.KD.sec=60},T=()=>{if(!c.value.KD.phone){ElMessage({message:"",type:"warning"});return}var ue=/^1[3456789]\d{9}$/;if(ue.test(c.value.KD.phone)==!1){ElMessage({message:"",type:"warning"});return}c.value.KD.hasSend=!0,y(),axios$1({url:"http://parkerbot.api/api/SendSmsCode",method:"get",params:{mobile:c.value.KD.phone,area:c.value.KD.area}}).then(Y=>{let _e=JSON.parse(Y==null?void 0:Y.data);_e!=null&&_e.success?ElMessage({message:"",type:"success"}):ElMessage({message:(_e==null?void 0:_e.message)??"",type:"success"})})},k=()=>{if(!c.value.KD.phone){ElMessage({message:"",type:"warning"});return}if(!c.value.KD.code){ElMessage({message:"",type:"warning"});return}var ue=/^1[3456789]\d{9}$/;if(ue.test(c.value.KD.phone)==!1){ElMessage({message:"",type:"warning"});return}axios$1({url:"http://parkerbot.api/api/PocketLogin",method:"get",params:{mobile:c.value.KD.phone,code:c.value.KD.code}}).then(Y=>{let _e=JSON.parse(Y==null?void 0:Y.data);_e!=null&&_e.success?axios$1({url:"http://parkerbot.api/api/GetPokectUserInfo",method:"get",params:{token:_e.content.token}}).then(Ce=>{let ze=JSON.parse(Ce==null?void 0:Ce.data);ze!=null&&ze.success?(c.value.KD.token=ze.content.pwd,c.value.KD.account=ze.content.accid,setTimeout(()=>{b()},1e3),ElMessage({message:(ze==null?void 0:ze.message)??"",type:"success"})):ElMessage({message:(ze==null?void 0:ze.message)??"",type:"error"})}):ElMessage({message:(_e==null?void 0:_e.message)??"",type:"error"})})},y=()=>{c.value.KD.sec=60;let ue;ue=setInterval(()=>{c.value.KD.sec>0?c.value.KD.sec--:(clearInterval(ue),c.value.KD.sec=60,c.value.KD.hasSend=!1)},1e3)},O=ue=>{c.value.BD.imageList1.push(ue)},D=ue=>{var Y=-1;c.value.BD.imageList1.forEach((_e,Ce)=>{if(_e.name===ue.name){Y=Ce;return}}),Y>=0&&c.value.BD.imageList1.splice(Y,1)},he=ref([{label:"SNH48",value:"SNH48",children:[{value:"TEAM SII",label:"TEAM SII"},{value:"TEAM HII",label:"TEAM HII"},{value:"TEAM X",label:"TEAM X"}]},{label:"GNZ48",value:"GNZ48",children:[{value:"TEAM G",label:"TEAM G"},{value:"TEAM NIII",label:"TEAM NIII"},{value:"TEAM Z",label:"TEAM Z"},{value:"TEAM CII",label:"TEAM CII"}]},{label:"CGT48",value:"CGT48",children:[{value:"TEAM GII",label:"TEAM GII"}]},{label:"BEJ48",value:"BEJ48",children:[{value:"TEAM B",label:"TEAM B"},{value:"TEAM E",label:"TEAM E"}]},{label:"CKG48",value:"CKG48"}]),ae=async()=>{if(!i.value.name){ElMessage({message:"",type:"error"});return}i.value.loading=!0;var ue=await axios$1({url:"http://parkerbot.api/api/getxox?group="+i.value.group.toString()+"&name="+i.value.name}).catch(()=>{i.value.loading=!1});if(ue.data.success){var Y=ue.data.data;c.value.KD.name=Y.name,c.value.KD.liveRoomId=Y.liveId,c.value.KD.serverId=Y.serverId,b()}else i.value.url=ue.data.data;i.value.loading=!1},Ne=()=>{};return(ue,Y)=>{const _e=ElButton,Ce=ElAffix,ze=ElHeader,ie=ElCheckbox,le=ElInput,Ie=ElFormItem,pe=ElCol,qe=ElCheckboxGroup,$e=ElTransfer,Lt=ElOption,Dt=ElSelect,dr=ElCollapseItem,pr=ElSwitch,sr=ElIcon,hr=ElUpload,Fe=ElForm,nr=ElCollapse,ir=ElBacktop,Ue=ElMain,rr=ElContainer,or=ElDialog,Pt=ElCascader;return openBlock(),createElementBlock(Fragment,null,[createVNode(rr,null,{default:withCtx(()=>[createVNode(ze,null,{default:withCtx(()=>[createVNode(Ce,{offset:30},{default:withCtx(()=>[createVNode(_e,{type:"primary","native-type":"button",icon:unref(arrow_left_default),onClick:v},{default:withCtx(()=>[createTextVNode("")]),_:1},8,["icon"]),createVNode(_e,{type:"primary","native-type":"button",icon:unref(edit_default),onClick:Y[0]||(Y[0]=Et=>g(d.value))},{default:withCtx(()=>[createTextVNode("")]),_:1},8,["icon"]),createVNode(_e,{type:"primary","native-type":"button",icon:unref(setting_default),onClick:Y[1]||(Y[1]=Et=>Ne())},{default:withCtx(()=>[createTextVNode("")]),_:1},8,["icon"])]),_:1})]),_:1}),createVNode(Ue,null,{default:withCtx(()=>[createBaseVNode("div",_hoisted_1$1,[_hoisted_2$1,r.value?createCommentVNode("",!0):(openBlock(),createBlock(ie,{key:0,modelValue:u.value.qq,"onUpdate:modelValue":Y[2]||(Y[2]=Et=>u.value.qq=Et),label:"QQ"},null,8,["modelValue"])),createVNode(ie,{modelValue:u.value.wb,"onUpdate:modelValue":Y[3]||(Y[3]=Et=>u.value.wb=Et),label:""},null,8,["modelValue"]),createVNode(ie,{modelValue:u.value.bz,"onUpdate:modelValue":Y[4]||(Y[4]=Et=>u.value.bz=Et),label:"B"},null,8,["modelValue"]),createVNode(ie,{modelValue:u.value.kd,"onUpdate:modelValue":Y[5]||(Y[5]=Et=>u.value.kd=Et),label:"48"},null,8,["modelValue"]),createVNode(ie,{modelValue:u.value.xhs,"onUpdate:modelValue":Y[6]||(Y[6]=Et=>u.value.xhs=Et),label:""},null,8,["modelValue"]),createVNode(ie,{modelValue:u.value.dy,"onUpdate:modelValue":Y[7]||(Y[7]=Et=>u.value.dy=Et),label:""},null,8,["modelValue"]),createVNode(ie,{modelValue:u.value.bd,"onUpdate:modelValue":Y[8]||(Y[8]=Et=>u.value.bd=Et),label:""},null,8,["modelValue"])]),createVNode(nr,null,{default:withCtx(()=>[createVNode(Fe,{ref_key:"form",ref:d,model:c.value,"label-width":"100px"},{default:withCtx(()=>[u.value.qq&&!r.value?(openBlock(),createBlock(dr,{key:0,title:"QQ",name:"qq"},{default:withCtx(()=>[createVNode(Ie,{label:"QQ",prop:"QQ.group",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.QQ.group,"onUpdate:modelValue":Y[9]||(Y[9]=Et=>c.value.QQ.group=Et),placeholder:",qq"},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ie,{label:"",prop:"QQ.admin",rules:m.value.input},{default:withCtx(()=>[createVNode(pe,{span:16},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.QQ.admin,"onUpdate:modelValue":Y[10]||(Y[10]=Et=>c.value.QQ.admin=Et),placeholder:""},null,8,["modelValue"])]),_:1}),createVNode(pe,{span:3,style:{"margin-left":"2%"}},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.QQ.notice,"onUpdate:modelValue":Y[11]||(Y[11]=Et=>c.value.QQ.notice=Et),label:""},null,8,["modelValue"])]),_:1}),createVNode(pe,{span:3,style:{"margin-left":"2%"}},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.QQ.debug,"onUpdate:modelValue":Y[12]||(Y[12]=Et=>c.value.QQ.debug=Et),label:""},null,8,["modelValue"])]),_:1})]),_:1},8,["rules"]),createVNode(Ie,{label:""},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.QQ.permission,"onUpdate:modelValue":Y[13]||(Y[13]=Et=>c.value.QQ.permission=Et),placeholder:","},null,8,["modelValue"])]),_:1}),createVNode(Ie,{label:""},{default:withCtx(()=>[createVNode(qe,{modelValue:n.value,"onUpdate:modelValue":Y[14]||(Y[14]=Et=>n.value=Et)},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.value,Et=>(openBlock(),createBlock(ie,{label:Et.value,key:Et.id},{default:withCtx(()=>[createTextVNode(toDisplayString(Et.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),createVNode(Ie,{label:""},{default:withCtx(()=>[createVNode($e,{modelValue:c.value.QQ.funcUser1,"onUpdate:modelValue":Y[15]||(Y[15]=Et=>c.value.QQ.funcUser1=Et),data:c.value.QQ.funcEnable1,titles:["",""],props:{key:"value",label:"name"}},null,8,["modelValue","data"])]),_:1}),createVNode(Ie,{label:""},{default:withCtx(()=>[createVNode(le,{type:"textarea",modelValue:c.value.QQ.sensitive,"onUpdate:modelValue":Y[16]||(Y[16]=Et=>c.value.QQ.sensitive=Et),placeholder:","},null,8,["modelValue"])]),_:1}),createVNode(Ie,{label:""},{default:withCtx(()=>[createVNode(Dt,{modelValue:c.value.QQ.actions,"onUpdate:modelValue":Y[17]||(Y[17]=Et=>c.value.QQ.actions=Et),multiple:"",placeholder:"","collapse-tags":"",style:{width:"30%"}},{default:withCtx(()=>[createVNode(Lt,{label:"",value:"1"}),createVNode(Lt,{label:"",value:"2"}),createVNode(Lt,{label:"",value:"3"}),createVNode(Lt,{label:"",value:"4"}),createVNode(Lt,{label:"",value:"5"})]),_:1},8,["modelValue"]),_hoisted_3$1]),_:1}),createVNode(Ie,{label:"ChatGpt"},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.QQ.gptKey,"onUpdate:modelValue":Y[18]||(Y[18]=Et=>c.value.QQ.gptKey=Et),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1})):createCommentVNode("",!0),u.value.wb?(openBlock(),createBlock(dr,{key:1,title:"",name:"wb"},{default:withCtx(()=>[createVNode(Ie,{label:"",prop:"WB.url",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.WB.url,"onUpdate:modelValue":Y[19]||(Y[19]=Et=>c.value.WB.url=Et),placeholder:","},null,8,["modelValue"]),_hoisted_4$1]),_:1},8,["rules"]),u.value.qq&&!r.value?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(Ie,{label:""},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.WB.cg,"onUpdate:modelValue":Y[20]||(Y[20]=Et=>c.value.WB.cg=Et),placeholder:","},null,8,["modelValue"]),_hoisted_5$1]),_:1}),createVNode(Ie,{label:""},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.WB.keyword,"onUpdate:modelValue":Y[21]||(Y[21]=Et=>c.value.WB.keyword=Et),placeholder:","},null,8,["modelValue"]),_hoisted_6]),_:1})],64)):createCommentVNode("",!0),createVNode(Ie,{label:"",prop:"WB.timeSpan",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{type:"number",modelValue:c.value.WB.timeSpan,"onUpdate:modelValue":Y[22]||(Y[22]=Et=>c.value.WB.timeSpan=Et),placeholder:""},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ie,{label:r.value?"qq":"qq"},{default:withCtx(()=>[createVNode(pr,{modelValue:c.value.WB.forwardGroup,"onUpdate:modelValue":Y[23]||(Y[23]=Et=>c.value.WB.forwardGroup=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1},8,["label"]),c.value.WB.forwardGroup===!0&&!r.value?(openBlock(),createBlock(Ie,{key:1,label:"qq"},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.WB.group,"onUpdate:modelValue":Y[24]||(Y[24]=Et=>c.value.WB.group=Et),placeholder:""},null,8,["modelValue"]),_hoisted_7]),_:1})):createCommentVNode("",!0),r.value?createCommentVNode("",!0):(openBlock(),createBlock(Ie,{key:2,label:"qq"},{default:withCtx(()=>[createVNode(pr,{modelValue:c.value.WB.forwardQQ,"onUpdate:modelValue":Y[25]||(Y[25]=Et=>c.value.WB.forwardQQ=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})),c.value.WB.forwardQQ===!0&&!r.value?(openBlock(),createBlock(Ie,{key:3,label:"qq"},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.WB.qq,"onUpdate:modelValue":Y[26]||(Y[26]=Et=>c.value.WB.qq=Et),placeholder:""},null,8,["modelValue"]),_hoisted_8]),_:1})):createCommentVNode("",!0)]),_:1})):createCommentVNode("",!0),u.value.bz?(openBlock(),createBlock(dr,{key:2,title:"B",name:"bz"},{default:withCtx(()=>[createVNode(Ie,{label:"ID",prop:"BZ.url",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.BZ.url,"onUpdate:modelValue":Y[27]||(Y[27]=Et=>c.value.BZ.url=Et),placeholder:","},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ie,{label:"",prop:"BZ.timeSpan",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{type:"number",modelValue:c.value.BZ.timeSpan,"onUpdate:modelValue":Y[28]||(Y[28]=Et=>c.value.BZ.timeSpan=Et),placeholder:""},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ie,{label:r.value?"qq":"qq"},{default:withCtx(()=>[createVNode(pr,{modelValue:c.value.BZ.forwardGroup,"onUpdate:modelValue":Y[29]||(Y[29]=Et=>c.value.BZ.forwardGroup=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1},8,["label"]),c.value.BZ.forwardGroup===!0&&!r.value?(openBlock(),createBlock(Ie,{key:0,label:"qq"},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.BZ.group,"onUpdate:modelValue":Y[30]||(Y[30]=Et=>c.value.BZ.group=Et),placeholder:""},null,8,["modelValue"]),_hoisted_9]),_:1})):createCommentVNode("",!0),r.value?createCommentVNode("",!0):(openBlock(),createBlock(Ie,{key:1,label:"qq"},{default:withCtx(()=>[createVNode(pr,{modelValue:c.value.BZ.forwardQQ,"onUpdate:modelValue":Y[31]||(Y[31]=Et=>c.value.BZ.forwardQQ=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})),c.value.BZ.forwardQQ===!0&&!r.value?(openBlock(),createBlock(Ie,{key:2,label:"qq"},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.BZ.qq,"onUpdate:modelValue":Y[32]||(Y[32]=Et=>c.value.BZ.qq=Et),placeholder:""},null,8,["modelValue"]),_hoisted_10]),_:1})):createCommentVNode("",!0)]),_:1})):createCommentVNode("",!0),u.value.kd?(openBlock(),createBlock(dr,{key:3,title:"48",name:"kd"},{default:withCtx(()=>[createVNode(Ie,{label:"",prop:"KD.name",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.KD.name,"onUpdate:modelValue":Y[33]||(Y[33]=Et=>c.value.KD.name=Et)},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ie,{label:"IMServerId",prop:"KD.serverId",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.KD.serverId,"onUpdate:modelValue":Y[34]||(Y[34]=Et=>c.value.KD.serverId=Et)},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ie,{label:"Id",prop:"KD.liveRoomId",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.KD.liveRoomId,"onUpdate:modelValue":Y[35]||(Y[35]=Et=>c.value.KD.liveRoomId=Et)},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ie,null,{default:withCtx(()=>[createVNode(_e,{onClick:Y[36]||(Y[36]=Et=>i.value.show=!0)},{default:withCtx(()=>[createTextVNode("")]),_:1})]),_:1}),createVNode(Ie,{label:"IM",prop:"KD.account",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.KD.account,"onUpdate:modelValue":Y[37]||(Y[37]=Et=>c.value.KD.account=Et)},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ie,{label:"IMtoken",prop:"KD.token",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.KD.token,"onUpdate:modelValue":Y[38]||(Y[38]=Et=>c.value.KD.token=Et)},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ie,null,{default:withCtx(()=>[createVNode(_e,{onClick:Y[39]||(Y[39]=Et=>a.value=!0)},{default:withCtx(()=>[createTextVNode("48")]),_:1}),_hoisted_11]),_:1}),createVNode(Ie,{label:r.value?"qq":"qq"},{default:withCtx(()=>[createVNode(pr,{modelValue:c.value.KD.forwardGroup,"onUpdate:modelValue":Y[40]||(Y[40]=Et=>c.value.KD.forwardGroup=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1},8,["label"]),c.value.KD.forwardGroup===!0&&!r.value?(openBlock(),createBlock(Ie,{key:0,label:"qq"},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.KD.group,"onUpdate:modelValue":Y[41]||(Y[41]=Et=>c.value.KD.group=Et),placeholder:""},null,8,["modelValue"]),_hoisted_12]),_:1})):createCommentVNode("",!0),r.value?createCommentVNode("",!0):(openBlock(),createBlock(Ie,{key:1,label:"qq"},{default:withCtx(()=>[createVNode(pr,{modelValue:c.value.KD.forwardQQ,"onUpdate:modelValue":Y[42]||(Y[42]=Et=>c.value.KD.forwardQQ=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})),c.value.KD.forwardQQ===!0&&!r.value?(openBlock(),createBlock(Ie,{key:2,label:"qq"},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.KD.qq,"onUpdate:modelValue":Y[43]||(Y[43]=Et=>c.value.KD.qq=Et),placeholder:""},null,8,["modelValue"]),_hoisted_13]),_:1})):createCommentVNode("",!0),withDirectives(createVNode(Ie,{label:""},{default:withCtx(()=>[createVNode(qe,{modelValue:o.value,"onUpdate:modelValue":Y[44]||(Y[44]=Et=>o.value=Et)},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(s.value,(Et,kt)=>(openBlock(),createBlock(ie,{label:Et.value,key:kt},{default:withCtx(()=>[createTextVNode(toDisplayString(Et.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},512),[[vShow,c.value.KD.forwardGroup===!0||c.value.KD.forwardQQ===!0]])]),_:1})):createCommentVNode("",!0),u.value.xhs?(openBlock(),createBlock(dr,{key:4,title:"",name:"xhs"},{default:withCtx(()=>[createVNode(Ie,{label:"ID",prop:"XHS.url",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.XHS.url,"onUpdate:modelValue":Y[45]||(Y[45]=Et=>c.value.XHS.url=Et),placeholder:","},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ie,{label:"",prop:"XHS.timeSpan",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{type:"number",modelValue:c.value.XHS.timeSpan,"onUpdate:modelValue":Y[46]||(Y[46]=Et=>c.value.XHS.timeSpan=Et),placeholder:""},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ie,{label:r.value?"qq":"qq"},{default:withCtx(()=>[createVNode(pr,{modelValue:c.value.XHS.forwardGroup,"onUpdate:modelValue":Y[47]||(Y[47]=Et=>c.value.XHS.forwardGroup=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1},8,["label"]),c.value.XHS.forwardGroup===!0&&!r.value?(openBlock(),createBlock(Ie,{key:0,label:"qq"},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.XHS.group,"onUpdate:modelValue":Y[48]||(Y[48]=Et=>c.value.XHS.group=Et),placeholder:""},null,8,["modelValue"]),_hoisted_14]),_:1})):createCommentVNode("",!0),r.value?createCommentVNode("",!0):(openBlock(),createBlock(Ie,{key:1,label:"qq"},{default:withCtx(()=>[createVNode(pr,{modelValue:c.value.XHS.forwardQQ,"onUpdate:modelValue":Y[49]||(Y[49]=Et=>c.value.XHS.forwardQQ=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})),c.value.XHS.forwardQQ===!0&&!r.value?(openBlock(),createBlock(Ie,{key:2,label:"qq"},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.XHS.qq,"onUpdate:modelValue":Y[50]||(Y[50]=Et=>c.value.XHS.qq=Et),placeholder:""},null,8,["modelValue"]),_hoisted_15]),_:1})):createCommentVNode("",!0)]),_:1})):createCommentVNode("",!0),u.value.dy?(openBlock(),createBlock(dr,{key:5,title:"",name:"dy"},{default:withCtx(()=>[createVNode(Ie,{label:"ID",prop:"DY.url",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.DY.url,"onUpdate:modelValue":Y[51]||(Y[51]=Et=>c.value.DY.url=Et),placeholder:","},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ie,{label:"",prop:"DY.timeSpan",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{type:"number",modelValue:c.value.DY.timeSpan,"onUpdate:modelValue":Y[52]||(Y[52]=Et=>c.value.DY.timeSpan=Et),placeholder:""},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ie,{label:r.value?"qq":"qq"},{default:withCtx(()=>[createVNode(pr,{modelValue:c.value.DY.forwardGroup,"onUpdate:modelValue":Y[53]||(Y[53]=Et=>c.value.DY.forwardGroup=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1},8,["label"]),withDirectives(createVNode(Ie,{label:"qq"},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.DY.group,"onUpdate:modelValue":Y[54]||(Y[54]=Et=>c.value.DY.group=Et),placeholder:""},null,8,["modelValue"]),_hoisted_16]),_:1},512),[[vShow,c.value.DY.forwardGroup===!0&&!r.value]]),r.value?createCommentVNode("",!0):(openBlock(),createBlock(Ie,{key:0,label:"qq"},{default:withCtx(()=>[createVNode(pr,{modelValue:c.value.DY.forwardQQ,"onUpdate:modelValue":Y[55]||(Y[55]=Et=>c.value.DY.forwardQQ=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1})),withDirectives(createVNode(Ie,{label:"qq"},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.DY.qq,"onUpdate:modelValue":Y[56]||(Y[56]=Et=>c.value.DY.qq=Et),placeholder:""},null,8,["modelValue"]),_hoisted_17]),_:1},512),[[vShow,c.value.DY.forwardQQ===!0&&!r.value]])]),_:1})):createCommentVNode("",!0),u.value.bd?(openBlock(),createBlock(dr,{key:6,title:"",name:"bd"},{default:withCtx(()=>[createVNode(Ie,{label:"apiKey",prop:"BD.appKey",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.BD.appKey,"onUpdate:modelValue":Y[57]||(Y[57]=Et=>c.value.BD.appKey=Et),placeholder:"appKey"},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ie,{label:"appSeret",prop:"BD.appSeret",rules:m.value.input},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.BD.appSeret,"onUpdate:modelValue":Y[58]||(Y[58]=Et=>c.value.BD.appSeret=Et),placeholder:"appSeret"},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ie,{label:""},{default:withCtx(()=>[createVNode(pr,{modelValue:c.value.BD.faceVerify,"onUpdate:modelValue":Y[59]||(Y[59]=Et=>c.value.BD.faceVerify=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),withDirectives(createVNode(Ie,{label:"",prop:"BD.imageList1",rules:m.value.imageList1},{default:withCtx(()=>[createVNode(hr,{"file-list":c.value.BD.imageList1,action:"http://parkerbot.api/api/upload","on-success":O,"on-remove":D,"list-type":"picture-card",limit:3,accept:".jpg,.png,.jpeg"},{default:withCtx(()=>[createVNode(sr,null,{default:withCtx(()=>[createVNode(unref(plus_default))]),_:1})]),_:1},8,["file-list"]),_hoisted_18]),_:1},8,["rules"]),[[vShow,c.value.BD.faceVerify]]),withDirectives(createVNode(Ie,{label:"",prop:"BD.similarity",rules:m.value.audit},{default:withCtx(()=>[createVNode(pe,{span:8},{default:withCtx(()=>[createVNode(le,{type:"number",modelValue:c.value.BD.similarity,"onUpdate:modelValue":Y[60]||(Y[60]=Et=>c.value.BD.similarity=Et)},null,8,["modelValue"])]),_:1}),_hoisted_19]),_:1},8,["rules"]),[[vShow,c.value.BD.faceVerify]]),withDirectives(createVNode(Ie,{label:"",prop:"BD.audit",rules:m.value.audit},{default:withCtx(()=>[createVNode(pe,{span:8},{default:withCtx(()=>[createVNode(le,{type:"number",modelValue:c.value.BD.audit,"onUpdate:modelValue":Y[61]||(Y[61]=Et=>c.value.BD.audit=Et)},null,8,["modelValue"])]),_:1}),_hoisted_20]),_:1},8,["rules"]),[[vShow,c.value.BD.faceVerify]]),withDirectives(createVNode(Ie,{label:""},{default:withCtx(()=>[createVNode(pr,{modelValue:c.value.BD.saveAliyunDisk,"onUpdate:modelValue":Y[62]||(Y[62]=Et=>c.value.BD.saveAliyunDisk=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"]),_hoisted_21]),_:1},512),[[vShow,c.value.BD.faceVerify]]),withDirectives(createVNode(Ie,{label:"",prop:"BD.albumName",rules:m.value.saveAliyunDisk},{default:withCtx(()=>[createVNode(pe,{span:8},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.BD.albumName,"onUpdate:modelValue":Y[63]||(Y[63]=Et=>c.value.BD.albumName=Et)},null,8,["modelValue"])]),_:1})]),_:1},8,["rules"]),[[vShow,c.value.BD.saveAliyunDisk]])]),_:1})):createCommentVNode("",!0)]),_:1},8,["model"])]),_:1}),createVNode(ir,{right:100,bottom:100})]),_:1})]),_:1}),createVNode(or,{title:"48",modelValue:a.value,"onUpdate:modelValue":Y[66]||(Y[66]=Et=>a.value=Et),"before-close":b,"close-on-click-modal":!1},{default:withCtx(()=>[createVNode(Fe,{"label-width":"100px"},{default:withCtx(()=>[createVNode(Ie,{label:"",required:"",class:"mt-4"},{default:withCtx(()=>[createVNode(le,{modelValue:c.value.KD.phone,"onUpdate:modelValue":Y[64]||(Y[64]=Et=>c.value.KD.phone=Et),style:{width:"95%"}},{prepend:withCtx(()=>[createTextVNode("+"+toDisplayString(c.value.KD.area),1)]),_:1},8,["modelValue"])]),_:1}),createVNode(Ie,{label:"",required:""},{default:withCtx(()=>[createVNode(le,{type:"primary",modelValue:c.value.KD.code,"onUpdate:modelValue":Y[65]||(Y[65]=Et=>c.value.KD.code=Et),style:{width:"65%"}},null,8,["modelValue"]),withDirectives(createVNode(_e,{style:{width:"25%","margin-left":"5%"},onClick:T},{default:withCtx(()=>[createTextVNode("")]),_:1},512),[[vShow,!c.value.KD.hasSend]]),withDirectives(createVNode(_e,{style:{width:"25%","margin-left":"5%"}},{default:withCtx(()=>[createTextVNode(toDisplayString(c.value.KD.sec)+"",1)]),_:1},512),[[vShow,c.value.KD.hasSend]])]),_:1}),createVNode(Ie,null,{default:withCtx(()=>[createVNode(_e,{type:"primary",onClick:k},{default:withCtx(()=>[createTextVNode("")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(or,{title:" ",modelValue:i.value.show,"onUpdate:modelValue":Y[69]||(Y[69]=Et=>i.value.show=Et),"before-close":b,"close-on-click-modal":!1},{default:withCtx(()=>[createVNode(Fe,{"label-width":"100px"},{default:withCtx(()=>[createVNode(Ie,{label:"",class:"mt-4"},{default:withCtx(()=>[createVNode(Pt,{props:{expandTrigger:"hover",checkStrictly:"true"},placeholder:"",modelValue:i.value.group,"onUpdate:modelValue":Y[67]||(Y[67]=Et=>i.value.group=Et),options:he.value,style:{width:"95%"}},null,8,["modelValue","options"])]),_:1}),createVNode(Ie,{label:"",required:""},{default:withCtx(()=>[createVNode(le,{modelValue:i.value.name,"onUpdate:modelValue":Y[68]||(Y[68]=Et=>i.value.name=Et),style:{width:"95%"}},null,8,["modelValue"])]),_:1}),createVNode(Ie,null,{default:withCtx(()=>[createVNode(_e,{type:"primary",loading:i.value.loading,onClick:ae},{default:withCtx(()=>[createTextVNode("")]),_:1},8,["loading"])]),_:1}),i.value.url?(openBlock(),createElementBlock("div",_hoisted_22,[_hoisted_23,createBaseVNode("div",_hoisted_24,toDisplayString(i.value.url),1)])):createCommentVNode("",!0)]),_:1})]),_:1},8,["modelValue"])],64)}}}),_hoisted_1=createBaseVNode("span",null,"",-1),_hoisted_2=createBaseVNode("div",null,"",-1),_hoisted_3=createBaseVNode("div",null,[createTextVNode("1GitHub"),createBaseVNode("span",{style:{color:"rgb(19, 1, 173)","text-decoration-line":"underline"}},"https://sinoahpx.github.io/Mirai.Net.Documents/#/?id=mirainet-"),createTextVNode(" --miraimirai--mirai ")],-1),_hoisted_4=createBaseVNode("div",null,[createTextVNode("2CSDN"),createBaseVNode("span",{style:{color:"rgb(19, 1, 173)","text-decoration-line":"underline"}},"https://blog.csdn.net/qq_30141543/article/details/125576220")],-1),_hoisted_5=createBaseVNode("div",null,[createTextVNode("3"),createBaseVNode("span",{style:{color:"rgb(19, 1, 173)","text-decoration-line":"underline"}},"https://www.bilibili.com/video/BV1eb4y1k7uX/")],-1),_sfc_main$1=defineComponent({__name:"Mirai",setup(t){const r=ref(),e=ref({useMirai:!1,path:"",address:"",qq:"",verifyKey:""});onMounted(()=>{axios$1({url:"http://parkerbot.api/api/GetMiraiConfig"}).then(a=>{e.value=a.data})});const n=function(){axios$1({url:"http://parkerbot.api/api/getMiraiFile"}).then(a=>{a.data==!1?ElMessage({showClose:!0,message:"",type:"error"}):(e.value.address=a.data.address,e.value.verifyKey=a.data.verifyKey,ElMessage({showClose:!0,message:"",type:"success"}))})},o=()=>{history.go(-1)},s=async a=>{a&&await a.validate((i,u)=>{i&&axios$1({url:"http://parkerbot.api/api/setMiraiconfig",method:"post",data:e.value}).then(d=>{if(d.data)ElMessage({showClose:!0,message:"",type:"success"});else return ElMessage({message:"",type:"error"}),!1})})};return(a,i)=>{const u=ElButton,d=ElHeader,c=ElSwitch,m=ElFormItem,v=ElInput,g=ElForm,b=ElMain,T=ElFooter,k=ElContainer;return openBlock(),createBlock(k,null,{default:withCtx(()=>[createVNode(d,null,{default:withCtx(()=>[createVNode(u,{type:"primary","native-type":"button",icon:unref(arrow_left_default),onClick:o},{default:withCtx(()=>[createTextVNode("")]),_:1},8,["icon"]),createVNode(u,{type:"primary","native-type":"button",icon:unref(edit_default),onClick:i[0]||(i[0]=y=>s(r.value))},{default:withCtx(()=>[createTextVNode("")]),_:1},8,["icon"])]),_:1}),createVNode(b,null,{default:withCtx(()=>[createVNode(g,{ref_key:"miraiForm",ref:r,model:e.value,"label-width":"120px"},{default:withCtx(()=>[createVNode(m,{label:"",prop:"useMirai"},{default:withCtx(()=>[createVNode(c,{modelValue:e.value.useMirai,"onUpdate:modelValue":i[1]||(i[1]=y=>e.value.useMirai=y),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),createVNode(m,{label:"qq",prop:"qq"},{default:withCtx(()=>[createVNode(v,{disabled:!e.value.useMirai,modelValue:e.value.qq,"onUpdate:modelValue":i[2]||(i[2]=y=>e.value.qq=y)},null,8,["disabled","modelValue"])]),_:1}),createVNode(m,{label:"mirai",prop:"path"},{default:withCtx(()=>[createVNode(v,{disabled:!e.value.useMirai,modelValue:e.value.path,"onUpdate:modelValue":i[3]||(i[3]=y=>e.value.path=y),style:{width:"87%"}},null,8,["disabled","modelValue"]),createVNode(u,{disabled:!e.value.useMirai,onClick:n,"native-type":"button",type:"primary"},{default:withCtx(()=>[createTextVNode("")]),_:1},8,["disabled"])]),_:1}),createVNode(m,{label:"Tips"},{default:withCtx(()=>[_hoisted_1]),_:1}),createVNode(m,{label:"",prop:"address"},{default:withCtx(()=>[createVNode(v,{disabled:!e.value.useMirai,modelValue:e.value.address,"onUpdate:modelValue":i[4]||(i[4]=y=>e.value.address=y)},null,8,["disabled","modelValue"])]),_:1}),createVNode(m,{label:"verifyKey",prop:"verifyKey"},{default:withCtx(()=>[createVNode(v,{disabled:!e.value.useMirai,modelValue:e.value.verifyKey,"onUpdate:modelValue":i[5]||(i[5]=y=>e.value.verifyKey=y)},null,8,["disabled","modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),createVNode(T,null,{default:withCtx(()=>[_hoisted_2,_hoisted_3,_hoisted_4,_hoisted_5]),_:1})]),_:1})}}}),router=createRouter({history:createWebHistory("/"),routes:[{path:"/",name:"home",component:_sfc_main$3},{path:"/mirai",name:"mirai",component:_sfc_main$1},{path:"/config",name:"config",component:_sfc_main$2}]}),_sfc_main=defineComponent({__name:"App",setup(t){return(r,e)=>(openBlock(),createBlock(unref(RouterView)))}}),app=createApp(_sfc_main);app.use(router);app.mount("#app")});export default YC();
