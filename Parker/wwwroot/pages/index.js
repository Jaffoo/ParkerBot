var GC=Object.defineProperty;var QC=(t,r,e)=>r in t?GC(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var JC=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports);var vc=(t,r,e)=>(QC(t,typeof r!="symbol"?r+"":r,e),e);var YC=JC((exports,module)=>{(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=e(o);fetch(o.href,s)}})();function makeMap(t,r){const e=Object.create(null),n=t.split(",");for(let o=0;o<n.length;o++)e[n[o]]=!0;return r?o=>!!e[o.toLowerCase()]:o=>!!e[o]}const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,onRE=/^on[^a-z]/,isOn=t=>onRE.test(t),isModelListener=t=>t.startsWith("onUpdate:"),extend$1=Object.assign,remove=(t,r)=>{const e=t.indexOf(r);e>-1&&t.splice(e,1)},hasOwnProperty$e=Object.prototype.hasOwnProperty,hasOwn=(t,r)=>hasOwnProperty$e.call(t,r),isArray$4=Array.isArray,isMap$2=t=>toTypeString(t)==="[object Map]",isSet$2=t=>toTypeString(t)==="[object Set]",isDate$1=t=>toTypeString(t)==="[object Date]",isFunction$3=t=>typeof t=="function",isString$2=t=>typeof t=="string",isSymbol$1=t=>typeof t=="symbol",isObject$2=t=>t!==null&&typeof t=="object",isPromise=t=>isObject$2(t)&&isFunction$3(t.then)&&isFunction$3(t.catch),objectToString$1=Object.prototype.toString,toTypeString=t=>objectToString$1.call(t),toRawType=t=>toTypeString(t).slice(8,-1),isPlainObject$1=t=>toTypeString(t)==="[object Object]",isIntegerKey=t=>isString$2(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=t=>{const r=Object.create(null);return e=>r[e]||(r[e]=t(e))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(t=>t.replace(camelizeRE,(r,e)=>e?e.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(t=>t.replace(hyphenateRE,"-$1").toLowerCase()),capitalize$1=cacheStringFunction(t=>t.charAt(0).toUpperCase()+t.slice(1)),toHandlerKey=cacheStringFunction(t=>t?`on${capitalize$1(t)}`:""),hasChanged=(t,r)=>!Object.is(t,r),invokeArrayFns=(t,r)=>{for(let e=0;e<t.length;e++)t[e](r)},def=(t,r,e)=>{Object.defineProperty(t,r,{configurable:!0,enumerable:!1,value:e})},looseToNumber=t=>{const r=parseFloat(t);return isNaN(r)?t:r},toNumber$1=t=>{const r=isString$2(t)?Number(t):NaN;return isNaN(r)?t:r};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function normalizeStyle(t){if(isArray$4(t)){const r={};for(let e=0;e<t.length;e++){const n=t[e],o=isString$2(n)?parseStringStyle(n):normalizeStyle(n);if(o)for(const s in o)r[s]=o[s]}return r}else{if(isString$2(t))return t;if(isObject$2(t))return t}}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(t){const r={};return t.replace(styleCommentRE,"").split(listDelimiterRE).forEach(e=>{if(e){const n=e.split(propertyDelimiterRE);n.length>1&&(r[n[0].trim()]=n[1].trim())}}),r}function normalizeClass(t){let r="";if(isString$2(t))r=t;else if(isArray$4(t))for(let e=0;e<t.length;e++){const n=normalizeClass(t[e]);n&&(r+=n+" ")}else if(isObject$2(t))for(const e in t)t[e]&&(r+=e+" ");return r.trim()}function normalizeProps(t){if(!t)return null;let{class:r,style:e}=t;return r&&!isString$2(r)&&(t.class=normalizeClass(r)),e&&(t.style=normalizeStyle(e)),t}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(t){return!!t||t===""}function looseCompareArrays(t,r){if(t.length!==r.length)return!1;let e=!0;for(let n=0;e&&n<t.length;n++)e=looseEqual(t[n],r[n]);return e}function looseEqual(t,r){if(t===r)return!0;let e=isDate$1(t),n=isDate$1(r);if(e||n)return e&&n?t.getTime()===r.getTime():!1;if(e=isSymbol$1(t),n=isSymbol$1(r),e||n)return t===r;if(e=isArray$4(t),n=isArray$4(r),e||n)return e&&n?looseCompareArrays(t,r):!1;if(e=isObject$2(t),n=isObject$2(r),e||n){if(!e||!n)return!1;const o=Object.keys(t).length,s=Object.keys(r).length;if(o!==s)return!1;for(const a in t){const i=t.hasOwnProperty(a),u=r.hasOwnProperty(a);if(i&&!u||!i&&u||!looseEqual(t[a],r[a]))return!1}}return String(t)===String(r)}function looseIndexOf(t,r){return t.findIndex(e=>looseEqual(e,r))}const toDisplayString=t=>isString$2(t)?t:t==null?"":isArray$4(t)||isObject$2(t)&&(t.toString===objectToString$1||!isFunction$3(t.toString))?JSON.stringify(t,replacer,2):String(t),replacer=(t,r)=>r&&r.__v_isRef?replacer(t,r.value):isMap$2(r)?{[`Map(${r.size})`]:[...r.entries()].reduce((e,[n,o])=>(e[`${n} =>`]=o,e),{})}:isSet$2(r)?{[`Set(${r.size})`]:[...r.values()]}:isObject$2(r)&&!isArray$4(r)&&!isPlainObject$1(r)?String(r):r;let activeEffectScope;class EffectScope{constructor(r=!1){this.detached=r,this._active=!0,this.effects=[],this.cleanups=[],this.parent=activeEffectScope,!r&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}run(r){if(this._active){const e=activeEffectScope;try{return activeEffectScope=this,r()}finally{activeEffectScope=e}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(r){if(this._active){let e,n;for(e=0,n=this.effects.length;e<n;e++)this.effects[e].stop();for(e=0,n=this.cleanups.length;e<n;e++)this.cleanups[e]();if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!r){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0,this._active=!1}}}function effectScope(t){return new EffectScope(t)}function recordEffectScope(t,r=activeEffectScope){r&&r.active&&r.effects.push(t)}function getCurrentScope(){return activeEffectScope}function onScopeDispose(t){activeEffectScope&&activeEffectScope.cleanups.push(t)}const createDep=t=>{const r=new Set(t);return r.w=0,r.n=0,r},wasTracked=t=>(t.w&trackOpBit)>0,newTracked=t=>(t.n&trackOpBit)>0,initDepMarkers=({deps:t})=>{if(t.length)for(let r=0;r<t.length;r++)t[r].w|=trackOpBit},finalizeDepMarkers=t=>{const{deps:r}=t;if(r.length){let e=0;for(let n=0;n<r.length;n++){const o=r[n];wasTracked(o)&&!newTracked(o)?o.delete(t):r[e++]=o,o.w&=~trackOpBit,o.n&=~trackOpBit}r.length=e}},targetMap=new WeakMap;let effectTrackDepth=0,trackOpBit=1;const maxMarkerBits=30;let activeEffect;const ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol("");class ReactiveEffect{constructor(r,e=null,n){this.fn=r,this.scheduler=e,this.active=!0,this.deps=[],this.parent=void 0,recordEffectScope(this,n)}run(){if(!this.active)return this.fn();let r=activeEffect,e=shouldTrack;for(;r;){if(r===this)return;r=r.parent}try{return this.parent=activeEffect,activeEffect=this,shouldTrack=!0,trackOpBit=1<<++effectTrackDepth,effectTrackDepth<=maxMarkerBits?initDepMarkers(this):cleanupEffect(this),this.fn()}finally{effectTrackDepth<=maxMarkerBits&&finalizeDepMarkers(this),trackOpBit=1<<--effectTrackDepth,activeEffect=this.parent,shouldTrack=e,this.parent=void 0,this.deferStop&&this.stop()}}stop(){activeEffect===this?this.deferStop=!0:this.active&&(cleanupEffect(this),this.onStop&&this.onStop(),this.active=!1)}}function cleanupEffect(t){const{deps:r}=t;if(r.length){for(let e=0;e<r.length;e++)r[e].delete(t);r.length=0}}let shouldTrack=!0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const t=trackStack.pop();shouldTrack=t===void 0?!0:t}function track(t,r,e){if(shouldTrack&&activeEffect){let n=targetMap.get(t);n||targetMap.set(t,n=new Map);let o=n.get(e);o||n.set(e,o=createDep()),trackEffects(o)}}function trackEffects(t,r){let e=!1;effectTrackDepth<=maxMarkerBits?newTracked(t)||(t.n|=trackOpBit,e=!wasTracked(t)):e=!t.has(activeEffect),e&&(t.add(activeEffect),activeEffect.deps.push(t))}function trigger(t,r,e,n,o,s){const a=targetMap.get(t);if(!a)return;let i=[];if(r==="clear")i=[...a.values()];else if(e==="length"&&isArray$4(t)){const u=Number(n);a.forEach((c,d)=>{(d==="length"||d>=u)&&i.push(c)})}else switch(e!==void 0&&i.push(a.get(e)),r){case"add":isArray$4(t)?isIntegerKey(e)&&i.push(a.get("length")):(i.push(a.get(ITERATE_KEY)),isMap$2(t)&&i.push(a.get(MAP_KEY_ITERATE_KEY)));break;case"delete":isArray$4(t)||(i.push(a.get(ITERATE_KEY)),isMap$2(t)&&i.push(a.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap$2(t)&&i.push(a.get(ITERATE_KEY));break}if(i.length===1)i[0]&&triggerEffects(i[0]);else{const u=[];for(const c of i)c&&u.push(...c);triggerEffects(createDep(u))}}function triggerEffects(t,r){const e=isArray$4(t)?t:[...t];for(const n of e)n.computed&&triggerEffect(n);for(const n of e)n.computed||triggerEffect(n)}function triggerEffect(t,r){(t!==activeEffect||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}function getDepFromReactive(t,r){var e;return(e=targetMap.get(t))==null?void 0:e.get(r)}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(isSymbol$1)),get$1=createGetter(),shallowGet=createGetter(!1,!0),readonlyGet=createGetter(!0),arrayInstrumentations=createArrayInstrumentations();function createArrayInstrumentations(){const t={};return["includes","indexOf","lastIndexOf"].forEach(r=>{t[r]=function(...e){const n=toRaw(this);for(let s=0,a=this.length;s<a;s++)track(n,"get",s+"");const o=n[r](...e);return o===-1||o===!1?n[r](...e.map(toRaw)):o}}),["push","pop","shift","unshift","splice"].forEach(r=>{t[r]=function(...e){pauseTracking();const n=toRaw(this)[r].apply(this,e);return resetTracking(),n}}),t}function hasOwnProperty$d(t){const r=toRaw(this);return track(r,"has",t),r.hasOwnProperty(t)}function createGetter(t=!1,r=!1){return function(n,o,s){if(o==="__v_isReactive")return!t;if(o==="__v_isReadonly")return t;if(o==="__v_isShallow")return r;if(o==="__v_raw"&&s===(t?r?shallowReadonlyMap:readonlyMap:r?shallowReactiveMap:reactiveMap).get(n))return n;const a=isArray$4(n);if(!t){if(a&&hasOwn(arrayInstrumentations,o))return Reflect.get(arrayInstrumentations,o,s);if(o==="hasOwnProperty")return hasOwnProperty$d}const i=Reflect.get(n,o,s);return(isSymbol$1(o)?builtInSymbols.has(o):isNonTrackableKeys(o))||(t||track(n,"get",o),r)?i:isRef(i)?a&&isIntegerKey(o)?i:i.value:isObject$2(i)?t?readonly(i):reactive(i):i}}const set$1=createSetter(),shallowSet=createSetter(!0);function createSetter(t=!1){return function(e,n,o,s){let a=e[n];if(isReadonly(a)&&isRef(a)&&!isRef(o))return!1;if(!t&&(!isShallow(o)&&!isReadonly(o)&&(a=toRaw(a),o=toRaw(o)),!isArray$4(e)&&isRef(a)&&!isRef(o)))return a.value=o,!0;const i=isArray$4(e)&&isIntegerKey(n)?Number(n)<e.length:hasOwn(e,n),u=Reflect.set(e,n,o,s);return e===toRaw(s)&&(i?hasChanged(o,a)&&trigger(e,"set",n,o):trigger(e,"add",n,o)),u}}function deleteProperty(t,r){const e=hasOwn(t,r);t[r];const n=Reflect.deleteProperty(t,r);return n&&e&&trigger(t,"delete",r,void 0),n}function has$1(t,r){const e=Reflect.has(t,r);return(!isSymbol$1(r)||!builtInSymbols.has(r))&&track(t,"has",r),e}function ownKeys(t){return track(t,"iterate",isArray$4(t)?"length":ITERATE_KEY),Reflect.ownKeys(t)}const mutableHandlers={get:get$1,set:set$1,deleteProperty,has:has$1,ownKeys},readonlyHandlers={get:readonlyGet,set(t,r){return!0},deleteProperty(t,r){return!0}},shallowReactiveHandlers=extend$1({},mutableHandlers,{get:shallowGet,set:shallowSet}),toShallow=t=>t,getProto=t=>Reflect.getPrototypeOf(t);function get$2(t,r,e=!1,n=!1){t=t.__v_raw;const o=toRaw(t),s=toRaw(r);e||(r!==s&&track(o,"get",r),track(o,"get",s));const{has:a}=getProto(o),i=n?toShallow:e?toReadonly:toReactive;if(a.call(o,r))return i(t.get(r));if(a.call(o,s))return i(t.get(s));t!==o&&t.get(r)}function has(t,r=!1){const e=this.__v_raw,n=toRaw(e),o=toRaw(t);return r||(t!==o&&track(n,"has",t),track(n,"has",o)),t===o?e.has(t):e.has(t)||e.has(o)}function size(t,r=!1){return t=t.__v_raw,!r&&track(toRaw(t),"iterate",ITERATE_KEY),Reflect.get(t,"size",t)}function add(t){t=toRaw(t);const r=toRaw(this);return getProto(r).has.call(r,t)||(r.add(t),trigger(r,"add",t,t)),this}function set$2(t,r){r=toRaw(r);const e=toRaw(this),{has:n,get:o}=getProto(e);let s=n.call(e,t);s||(t=toRaw(t),s=n.call(e,t));const a=o.call(e,t);return e.set(t,r),s?hasChanged(r,a)&&trigger(e,"set",t,r):trigger(e,"add",t,r),this}function deleteEntry(t){const r=toRaw(this),{has:e,get:n}=getProto(r);let o=e.call(r,t);o||(t=toRaw(t),o=e.call(r,t)),n&&n.call(r,t);const s=r.delete(t);return o&&trigger(r,"delete",t,void 0),s}function clear(){const t=toRaw(this),r=t.size!==0,e=t.clear();return r&&trigger(t,"clear",void 0,void 0),e}function createForEach(t,r){return function(n,o){const s=this,a=s.__v_raw,i=toRaw(a),u=r?toShallow:t?toReadonly:toReactive;return!t&&track(i,"iterate",ITERATE_KEY),a.forEach((c,d)=>n.call(o,u(c),u(d),s))}}function createIterableMethod(t,r,e){return function(...n){const o=this.__v_raw,s=toRaw(o),a=isMap$2(s),i=t==="entries"||t===Symbol.iterator&&a,u=t==="keys"&&a,c=o[t](...n),d=e?toShallow:r?toReadonly:toReactive;return!r&&track(s,"iterate",u?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:m,done:v}=c.next();return v?{value:m,done:v}:{value:i?[d(m[0]),d(m[1])]:d(m),done:v}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(t){return function(...r){return t==="delete"?!1:this}}function createInstrumentations(){const t={get(s){return get$2(this,s)},get size(){return size(this)},has,add,set:set$2,delete:deleteEntry,clear,forEach:createForEach(!1,!1)},r={get(s){return get$2(this,s,!1,!0)},get size(){return size(this)},has,add,set:set$2,delete:deleteEntry,clear,forEach:createForEach(!1,!0)},e={get(s){return get$2(this,s,!0)},get size(){return size(this,!0)},has(s){return has.call(this,s,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!1)},n={get(s){return get$2(this,s,!0,!0)},get size(){return size(this,!0)},has(s){return has.call(this,s,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=createIterableMethod(s,!1,!1),e[s]=createIterableMethod(s,!0,!1),r[s]=createIterableMethod(s,!1,!0),n[s]=createIterableMethod(s,!0,!0)}),[t,e,r,n]}const[mutableInstrumentations,readonlyInstrumentations,shallowInstrumentations,shallowReadonlyInstrumentations]=createInstrumentations();function createInstrumentationGetter(t,r){const e=r?t?shallowReadonlyInstrumentations:shallowInstrumentations:t?readonlyInstrumentations:mutableInstrumentations;return(n,o,s)=>o==="__v_isReactive"?!t:o==="__v_isReadonly"?t:o==="__v_raw"?n:Reflect.get(hasOwn(e,o)&&o in n?e:n,o,s)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(t){return t.__v_skip||!Object.isExtensible(t)?0:targetTypeMap(toRawType(t))}function reactive(t){return isReadonly(t)?t:createReactiveObject(t,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(t){return createReactiveObject(t,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(t){return createReactiveObject(t,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function createReactiveObject(t,r,e,n,o){if(!isObject$2(t)||t.__v_raw&&!(r&&t.__v_isReactive))return t;const s=o.get(t);if(s)return s;const a=getTargetType(t);if(a===0)return t;const i=new Proxy(t,a===2?n:e);return o.set(t,i),i}function isReactive(t){return isReadonly(t)?isReactive(t.__v_raw):!!(t&&t.__v_isReactive)}function isReadonly(t){return!!(t&&t.__v_isReadonly)}function isShallow(t){return!!(t&&t.__v_isShallow)}function isProxy(t){return isReactive(t)||isReadonly(t)}function toRaw(t){const r=t&&t.__v_raw;return r?toRaw(r):t}function markRaw(t){return def(t,"__v_skip",!0),t}const toReactive=t=>isObject$2(t)?reactive(t):t,toReadonly=t=>isObject$2(t)?readonly(t):t;function trackRefValue(t){shouldTrack&&activeEffect&&(t=toRaw(t),trackEffects(t.dep||(t.dep=createDep())))}function triggerRefValue(t,r){t=toRaw(t);const e=t.dep;e&&triggerEffects(e)}function isRef(t){return!!(t&&t.__v_isRef===!0)}function ref(t){return createRef(t,!1)}function shallowRef(t){return createRef(t,!0)}function createRef(t,r){return isRef(t)?t:new RefImpl(t,r)}class RefImpl{constructor(r,e){this.__v_isShallow=e,this.dep=void 0,this.__v_isRef=!0,this._rawValue=e?r:toRaw(r),this._value=e?r:toReactive(r)}get value(){return trackRefValue(this),this._value}set value(r){const e=this.__v_isShallow||isShallow(r)||isReadonly(r);r=e?r:toRaw(r),hasChanged(r,this._rawValue)&&(this._rawValue=r,this._value=e?r:toReactive(r),triggerRefValue(this))}}function triggerRef(t){triggerRefValue(t)}function unref(t){return isRef(t)?t.value:t}const shallowUnwrapHandlers={get:(t,r,e)=>unref(Reflect.get(t,r,e)),set:(t,r,e,n)=>{const o=t[r];return isRef(o)&&!isRef(e)?(o.value=e,!0):Reflect.set(t,r,e,n)}};function proxyRefs(t){return isReactive(t)?t:new Proxy(t,shallowUnwrapHandlers)}function toRefs(t){const r=isArray$4(t)?new Array(t.length):{};for(const e in t)r[e]=propertyToRef(t,e);return r}class ObjectRefImpl{constructor(r,e,n){this._object=r,this._key=e,this._defaultValue=n,this.__v_isRef=!0}get value(){const r=this._object[this._key];return r===void 0?this._defaultValue:r}set value(r){this._object[this._key]=r}get dep(){return getDepFromReactive(toRaw(this._object),this._key)}}class GetterRefImpl{constructor(r){this._getter=r,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function toRef(t,r,e){return isRef(t)?t:isFunction$3(t)?new GetterRefImpl(t):isObject$2(t)&&arguments.length>1?propertyToRef(t,r,e):ref(t)}function propertyToRef(t,r,e){const n=t[r];return isRef(n)?n:new ObjectRefImpl(t,r,e)}class ComputedRefImpl{constructor(r,e,n,o){this._setter=e,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new ReactiveEffect(r,()=>{this._dirty||(this._dirty=!0,triggerRefValue(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!o,this.__v_isReadonly=n}get value(){const r=toRaw(this);return trackRefValue(r),(r._dirty||!r._cacheable)&&(r._dirty=!1,r._value=r.effect.run()),r._value}set value(r){this._setter(r)}}function computed$1(t,r,e=!1){let n,o;const s=isFunction$3(t);return s?(n=t,o=NOOP):(n=t.get,o=t.set),new ComputedRefImpl(n,o,s||!o,e)}function warn(t,...r){}function callWithErrorHandling(t,r,e,n){let o;try{o=n?t(...n):t()}catch(s){handleError(s,r,e)}return o}function callWithAsyncErrorHandling(t,r,e,n){if(isFunction$3(t)){const s=callWithErrorHandling(t,r,e,n);return s&&isPromise(s)&&s.catch(a=>{handleError(a,r,e)}),s}const o=[];for(let s=0;s<t.length;s++)o.push(callWithAsyncErrorHandling(t[s],r,e,n));return o}function handleError(t,r,e,n=!0){const o=r?r.vnode:null;if(r){let s=r.parent;const a=r.proxy,i=e;for(;s;){const c=s.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](t,a,i)===!1)return}s=s.parent}const u=r.appContext.config.errorHandler;if(u){callWithErrorHandling(u,null,10,[t,a,i]);return}}logError(t,e,o,n)}function logError(t,r,e,n=!0){console.error(t)}let isFlushing=!1,isFlushPending=!1;const queue=[];let flushIndex=0;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(t){const r=currentFlushPromise||resolvedPromise;return t?r.then(this?t.bind(this):t):r}function findInsertionIndex(t){let r=flushIndex+1,e=queue.length;for(;r<e;){const n=r+e>>>1;getId(queue[n])<t?r=n+1:e=n}return r}function queueJob(t){(!queue.length||!queue.includes(t,isFlushing&&t.allowRecurse?flushIndex+1:flushIndex))&&(t.id==null?queue.push(t):queue.splice(findInsertionIndex(t.id),0,t),queueFlush())}function queueFlush(){!isFlushing&&!isFlushPending&&(isFlushPending=!0,currentFlushPromise=resolvedPromise.then(flushJobs))}function invalidateJob(t){const r=queue.indexOf(t);r>flushIndex&&queue.splice(r,1)}function queuePostFlushCb(t){isArray$4(t)?pendingPostFlushCbs.push(...t):(!activePostFlushCbs||!activePostFlushCbs.includes(t,t.allowRecurse?postFlushIndex+1:postFlushIndex))&&pendingPostFlushCbs.push(t),queueFlush()}function flushPreFlushCbs(t,r=isFlushing?flushIndex+1:0){for(;r<queue.length;r++){const e=queue[r];e&&e.pre&&(queue.splice(r,1),r--,e())}}function flushPostFlushCbs(t){if(pendingPostFlushCbs.length){const r=[...new Set(pendingPostFlushCbs)];if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...r);return}for(activePostFlushCbs=r,activePostFlushCbs.sort((e,n)=>getId(e)-getId(n)),postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++)activePostFlushCbs[postFlushIndex]();activePostFlushCbs=null,postFlushIndex=0}}const getId=t=>t.id==null?1/0:t.id,comparator=(t,r)=>{const e=getId(t)-getId(r);if(e===0){if(t.pre&&!r.pre)return-1;if(r.pre&&!t.pre)return 1}return e};function flushJobs(t){isFlushPending=!1,isFlushing=!0,queue.sort(comparator);const r=NOOP;try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const e=queue[flushIndex];e&&e.active!==!1&&callWithErrorHandling(e,null,14)}}finally{flushIndex=0,queue.length=0,flushPostFlushCbs(),isFlushing=!1,currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}function emit(t,r,...e){if(t.isUnmounted)return;const n=t.vnode.props||EMPTY_OBJ;let o=e;const s=r.startsWith("update:"),a=s&&r.slice(7);if(a&&a in n){const d=`${a==="modelValue"?"model":a}Modifiers`,{number:m,trim:v}=n[d]||EMPTY_OBJ;v&&(o=e.map(g=>isString$2(g)?g.trim():g)),m&&(o=e.map(looseToNumber))}let i,u=n[i=toHandlerKey(r)]||n[i=toHandlerKey(camelize(r))];!u&&s&&(u=n[i=toHandlerKey(hyphenate(r))]),u&&callWithAsyncErrorHandling(u,t,6,o);const c=n[i+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[i])return;t.emitted[i]=!0,callWithAsyncErrorHandling(c,t,6,o)}}function normalizeEmitsOptions(t,r,e=!1){const n=r.emitsCache,o=n.get(t);if(o!==void 0)return o;const s=t.emits;let a={},i=!1;if(!isFunction$3(t)){const u=c=>{const d=normalizeEmitsOptions(c,r,!0);d&&(i=!0,extend$1(a,d))};!e&&r.mixins.length&&r.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}return!s&&!i?(isObject$2(t)&&n.set(t,null),null):(isArray$4(s)?s.forEach(u=>a[u]=null):extend$1(a,s),isObject$2(t)&&n.set(t,a),a)}function isEmitListener(t,r){return!t||!isOn(r)?!1:(r=r.slice(2).replace(/Once$/,""),hasOwn(t,r[0].toLowerCase()+r.slice(1))||hasOwn(t,hyphenate(r))||hasOwn(t,r))}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(t){const r=currentRenderingInstance;return currentRenderingInstance=t,currentScopeId=t&&t.type.__scopeId||null,r}function withCtx(t,r=currentRenderingInstance,e){if(!r||t._n)return t;const n=(...o)=>{n._d&&setBlockTracking(-1);const s=setCurrentRenderingInstance(r);let a;try{a=t(...o)}finally{setCurrentRenderingInstance(s),n._d&&setBlockTracking(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function markAttrsAccessed(){}function renderComponentRoot(t){const{type:r,vnode:e,proxy:n,withProxy:o,props:s,propsOptions:[a],slots:i,attrs:u,emit:c,render:d,renderCache:m,data:v,setupState:g,ctx:b,inheritAttrs:T}=t;let k,y;const A=setCurrentRenderingInstance(t);try{if(e.shapeFlag&4){const he=o||n;k=normalizeVNode(d.call(he,he,m,s,g,v,b)),y=u}else{const he=r;k=normalizeVNode(he.length>1?he(s,{attrs:u,slots:i,emit:c}):he(s,null)),y=r.props?u:getFunctionalFallthrough(u)}}catch(he){blockStack.length=0,handleError(he,t,1),k=createVNode(Comment)}let V=k;if(y&&T!==!1){const he=Object.keys(y),{shapeFlag:ae}=V;he.length&&ae&7&&(a&&he.some(isModelListener)&&(y=filterModelListeners(y,a)),V=cloneVNode(V,y))}return e.dirs&&(V=cloneVNode(V),V.dirs=V.dirs?V.dirs.concat(e.dirs):e.dirs),e.transition&&(V.transition=e.transition),k=V,setCurrentRenderingInstance(A),k}const getFunctionalFallthrough=t=>{let r;for(const e in t)(e==="class"||e==="style"||isOn(e))&&((r||(r={}))[e]=t[e]);return r},filterModelListeners=(t,r)=>{const e={};for(const n in t)(!isModelListener(n)||!(n.slice(9)in r))&&(e[n]=t[n]);return e};function shouldUpdateComponent(t,r,e){const{props:n,children:o,component:s}=t,{props:a,children:i,patchFlag:u}=r,c=s.emitsOptions;if(r.dirs||r.transition)return!0;if(e&&u>=0){if(u&1024)return!0;if(u&16)return n?hasPropsChanged(n,a,c):!!a;if(u&8){const d=r.dynamicProps;for(let m=0;m<d.length;m++){const v=d[m];if(a[v]!==n[v]&&!isEmitListener(c,v))return!0}}}else return(o||i)&&(!i||!i.$stable)?!0:n===a?!1:n?a?hasPropsChanged(n,a,c):!0:!!a;return!1}function hasPropsChanged(t,r,e){const n=Object.keys(r);if(n.length!==Object.keys(t).length)return!0;for(let o=0;o<n.length;o++){const s=n[o];if(r[s]!==t[s]&&!isEmitListener(e,s))return!0}return!1}function updateHOCHostEl({vnode:t,parent:r},e){for(;r&&r.subTree===t;)(t=r.vnode).el=e,r=r.parent}const isSuspense=t=>t.__isSuspense;function queueEffectWithSuspense(t,r){r&&r.pendingBranch?isArray$4(t)?r.effects.push(...t):r.effects.push(t):queuePostFlushCb(t)}function watchEffect(t,r){return doWatch(t,null,r)}const INITIAL_WATCHER_VALUE={};function watch(t,r,e){return doWatch(t,r,e)}function doWatch(t,r,{immediate:e,deep:n,flush:o,onTrack:s,onTrigger:a}=EMPTY_OBJ){var i;const u=getCurrentScope()===((i=currentInstance)==null?void 0:i.scope)?currentInstance:null;let c,d=!1,m=!1;if(isRef(t)?(c=()=>t.value,d=isShallow(t)):isReactive(t)?(c=()=>t,n=!0):isArray$4(t)?(m=!0,d=t.some(he=>isReactive(he)||isShallow(he)),c=()=>t.map(he=>{if(isRef(he))return he.value;if(isReactive(he))return traverse(he);if(isFunction$3(he))return callWithErrorHandling(he,u,2)})):isFunction$3(t)?r?c=()=>callWithErrorHandling(t,u,2):c=()=>{if(!(u&&u.isUnmounted))return v&&v(),callWithAsyncErrorHandling(t,u,3,[g])}:c=NOOP,r&&n){const he=c;c=()=>traverse(he())}let v,g=he=>{v=A.onStop=()=>{callWithErrorHandling(he,u,4)}},b;if(isInSSRComponentSetup)if(g=NOOP,r?e&&callWithAsyncErrorHandling(r,u,3,[c(),m?[]:void 0,g]):c(),o==="sync"){const he=useSSRContext();b=he.__watcherHandles||(he.__watcherHandles=[])}else return NOOP;let T=m?new Array(t.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const k=()=>{if(A.active)if(r){const he=A.run();(n||d||(m?he.some((ae,Ne)=>hasChanged(ae,T[Ne])):hasChanged(he,T)))&&(v&&v(),callWithAsyncErrorHandling(r,u,3,[he,T===INITIAL_WATCHER_VALUE?void 0:m&&T[0]===INITIAL_WATCHER_VALUE?[]:T,g]),T=he)}else A.run()};k.allowRecurse=!!r;let y;o==="sync"?y=k:o==="post"?y=()=>queuePostRenderEffect(k,u&&u.suspense):(k.pre=!0,u&&(k.id=u.uid),y=()=>queueJob(k));const A=new ReactiveEffect(c,y);r?e?k():T=A.run():o==="post"?queuePostRenderEffect(A.run.bind(A),u&&u.suspense):A.run();const V=()=>{A.stop(),u&&u.scope&&remove(u.scope.effects,A)};return b&&b.push(V),V}function instanceWatch(t,r,e){const n=this.proxy,o=isString$2(t)?t.includes(".")?createPathGetter(n,t):()=>n[t]:t.bind(n,n);let s;isFunction$3(r)?s=r:(s=r.handler,e=r);const a=currentInstance;setCurrentInstance(this);const i=doWatch(o,s.bind(n),e);return a?setCurrentInstance(a):unsetCurrentInstance(),i}function createPathGetter(t,r){const e=r.split(".");return()=>{let n=t;for(let o=0;o<e.length&&n;o++)n=n[e[o]];return n}}function traverse(t,r){if(!isObject$2(t)||t.__v_skip||(r=r||new Set,r.has(t)))return t;if(r.add(t),isRef(t))traverse(t.value,r);else if(isArray$4(t))for(let e=0;e<t.length;e++)traverse(t[e],r);else if(isSet$2(t)||isMap$2(t))t.forEach(e=>{traverse(e,r)});else if(isPlainObject$1(t))for(const e in t)traverse(t[e],r);return t}function withDirectives(t,r){const e=currentRenderingInstance;if(e===null)return t;const n=getExposeProxy(e)||e.proxy,o=t.dirs||(t.dirs=[]);for(let s=0;s<r.length;s++){let[a,i,u,c=EMPTY_OBJ]=r[s];a&&(isFunction$3(a)&&(a={mounted:a,updated:a}),a.deep&&traverse(i),o.push({dir:a,instance:n,value:i,oldValue:void 0,arg:u,modifiers:c}))}return t}function invokeDirectiveHook(t,r,e,n){const o=t.dirs,s=r&&r.dirs;for(let a=0;a<o.length;a++){const i=o[a];s&&(i.oldValue=s[a].value);let u=i.dir[n];u&&(pauseTracking(),callWithAsyncErrorHandling(u,e,8,[t.el,i,t,r]),resetTracking())}}function useTransitionState(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return onMounted(()=>{t.isMounted=!0}),onBeforeUnmount(()=>{t.isUnmounting=!0}),t}const TransitionHookValidator=[Function,Array],BaseTransitionPropsValidators={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:TransitionHookValidator,onEnter:TransitionHookValidator,onAfterEnter:TransitionHookValidator,onEnterCancelled:TransitionHookValidator,onBeforeLeave:TransitionHookValidator,onLeave:TransitionHookValidator,onAfterLeave:TransitionHookValidator,onLeaveCancelled:TransitionHookValidator,onBeforeAppear:TransitionHookValidator,onAppear:TransitionHookValidator,onAfterAppear:TransitionHookValidator,onAppearCancelled:TransitionHookValidator},BaseTransitionImpl={name:"BaseTransition",props:BaseTransitionPropsValidators,setup(t,{slots:r}){const e=getCurrentInstance(),n=useTransitionState();let o;return()=>{const s=r.default&&getTransitionRawChildren(r.default(),!0);if(!s||!s.length)return;let a=s[0];if(s.length>1){for(const T of s)if(T.type!==Comment){a=T;break}}const i=toRaw(t),{mode:u}=i;if(n.isLeaving)return emptyPlaceholder(a);const c=getKeepAliveChild(a);if(!c)return emptyPlaceholder(a);const d=resolveTransitionHooks(c,i,n,e);setTransitionHooks(c,d);const m=e.subTree,v=m&&getKeepAliveChild(m);let g=!1;const{getTransitionKey:b}=c.type;if(b){const T=b();o===void 0?o=T:T!==o&&(o=T,g=!0)}if(v&&v.type!==Comment&&(!isSameVNodeType(c,v)||g)){const T=resolveTransitionHooks(v,i,n,e);if(setTransitionHooks(v,T),u==="out-in")return n.isLeaving=!0,T.afterLeave=()=>{n.isLeaving=!1,e.update.active!==!1&&e.update()},emptyPlaceholder(a);u==="in-out"&&c.type!==Comment&&(T.delayLeave=(k,y,A)=>{const V=getLeavingNodesForType(n,v);V[String(v.key)]=v,k._leaveCb=()=>{y(),k._leaveCb=void 0,delete d.delayedLeave},d.delayedLeave=A})}return a}}},BaseTransition=BaseTransitionImpl;function getLeavingNodesForType(t,r){const{leavingVNodes:e}=t;let n=e.get(r.type);return n||(n=Object.create(null),e.set(r.type,n)),n}function resolveTransitionHooks(t,r,e,n){const{appear:o,mode:s,persisted:a=!1,onBeforeEnter:i,onEnter:u,onAfterEnter:c,onEnterCancelled:d,onBeforeLeave:m,onLeave:v,onAfterLeave:g,onLeaveCancelled:b,onBeforeAppear:T,onAppear:k,onAfterAppear:y,onAppearCancelled:A}=r,V=String(t.key),he=getLeavingNodesForType(e,t),ae=(Ce,re)=>{Ce&&callWithAsyncErrorHandling(Ce,n,9,re)},Ne=(Ce,re)=>{const ue=re[1];ae(Ce,re),isArray$4(Ce)?Ce.every(ze=>ze.length<=1)&&ue():Ce.length<=1&&ue()},_e={mode:s,persisted:a,beforeEnter(Ce){let re=i;if(!e.isMounted)if(o)re=T||i;else return;Ce._leaveCb&&Ce._leaveCb(!0);const ue=he[V];ue&&isSameVNodeType(t,ue)&&ue.el._leaveCb&&ue.el._leaveCb(),ae(re,[Ce])},enter(Ce){let re=u,ue=c,ze=d;if(!e.isMounted)if(o)re=k||u,ue=y||c,ze=A||d;else return;let le=!1;const de=Ce._enterCb=Ie=>{le||(le=!0,Ie?ae(ze,[Ce]):ae(ue,[Ce]),_e.delayedLeave&&_e.delayedLeave(),Ce._enterCb=void 0)};re?Ne(re,[Ce,de]):de()},leave(Ce,re){const ue=String(t.key);if(Ce._enterCb&&Ce._enterCb(!0),e.isUnmounting)return re();ae(m,[Ce]);let ze=!1;const le=Ce._leaveCb=de=>{ze||(ze=!0,re(),de?ae(b,[Ce]):ae(g,[Ce]),Ce._leaveCb=void 0,he[ue]===t&&delete he[ue])};he[ue]=t,v?Ne(v,[Ce,le]):le()},clone(Ce){return resolveTransitionHooks(Ce,r,e,n)}};return _e}function emptyPlaceholder(t){if(isKeepAlive(t))return t=cloneVNode(t),t.children=null,t}function getKeepAliveChild(t){return isKeepAlive(t)?t.children?t.children[0]:void 0:t}function setTransitionHooks(t,r){t.shapeFlag&6&&t.component?setTransitionHooks(t.component.subTree,r):t.shapeFlag&128?(t.ssContent.transition=r.clone(t.ssContent),t.ssFallback.transition=r.clone(t.ssFallback)):t.transition=r}function getTransitionRawChildren(t,r=!1,e){let n=[],o=0;for(let s=0;s<t.length;s++){let a=t[s];const i=e==null?a.key:String(e)+String(a.key!=null?a.key:s);a.type===Fragment?(a.patchFlag&128&&o++,n=n.concat(getTransitionRawChildren(a.children,r,i))):(r||a.type!==Comment)&&n.push(i!=null?cloneVNode(a,{key:i}):a)}if(o>1)for(let s=0;s<n.length;s++)n[s].patchFlag=-2;return n}function defineComponent(t,r){return isFunction$3(t)?(()=>extend$1({name:t.name},r,{setup:t}))():t}const isAsyncWrapper=t=>!!t.type.__asyncLoader,isKeepAlive=t=>t.type.__isKeepAlive;function onActivated(t,r){registerKeepAliveHook(t,"a",r)}function onDeactivated(t,r){registerKeepAliveHook(t,"da",r)}function registerKeepAliveHook(t,r,e=currentInstance){const n=t.__wdc||(t.__wdc=()=>{let o=e;for(;o;){if(o.isDeactivated)return;o=o.parent}return t()});if(injectHook(r,n,e),e){let o=e.parent;for(;o&&o.parent;)isKeepAlive(o.parent.vnode)&&injectToKeepAliveRoot(n,r,e,o),o=o.parent}}function injectToKeepAliveRoot(t,r,e,n){const o=injectHook(r,t,n,!0);onUnmounted(()=>{remove(n[r],o)},e)}function injectHook(t,r,e=currentInstance,n=!1){if(e){const o=e[t]||(e[t]=[]),s=r.__weh||(r.__weh=(...a)=>{if(e.isUnmounted)return;pauseTracking(),setCurrentInstance(e);const i=callWithAsyncErrorHandling(r,e,t,a);return unsetCurrentInstance(),resetTracking(),i});return n?o.unshift(s):o.push(s),s}}const createHook=t=>(r,e=currentInstance)=>(!isInSSRComponentSetup||t==="sp")&&injectHook(t,(...n)=>r(...n),e),onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(t,r=currentInstance){injectHook("ec",t,r)}const COMPONENTS="components",DIRECTIVES="directives";function resolveComponent(t,r){return resolveAsset(COMPONENTS,t,!0,r)||t}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc");function resolveDynamicComponent(t){return isString$2(t)?resolveAsset(COMPONENTS,t,!1)||t:t||NULL_DYNAMIC_COMPONENT}function resolveDirective(t){return resolveAsset(DIRECTIVES,t)}function resolveAsset(t,r,e=!0,n=!1){const o=currentRenderingInstance||currentInstance;if(o){const s=o.type;if(t===COMPONENTS){const i=getComponentName(s,!1);if(i&&(i===r||i===camelize(r)||i===capitalize$1(camelize(r))))return s}const a=resolve(o[t]||s[t],r)||resolve(o.appContext[t],r);return!a&&n?s:a}}function resolve(t,r){return t&&(t[r]||t[camelize(r)]||t[capitalize$1(camelize(r))])}function renderList(t,r,e,n){let o;const s=e&&e[n];if(isArray$4(t)||isString$2(t)){o=new Array(t.length);for(let a=0,i=t.length;a<i;a++)o[a]=r(t[a],a,void 0,s&&s[a])}else if(typeof t=="number"){o=new Array(t);for(let a=0;a<t;a++)o[a]=r(a+1,a,void 0,s&&s[a])}else if(isObject$2(t))if(t[Symbol.iterator])o=Array.from(t,(a,i)=>r(a,i,void 0,s&&s[i]));else{const a=Object.keys(t);o=new Array(a.length);for(let i=0,u=a.length;i<u;i++){const c=a[i];o[i]=r(t[c],c,i,s&&s[i])}}else o=[];return e&&(e[n]=o),o}function createSlots(t,r){for(let e=0;e<r.length;e++){const n=r[e];if(isArray$4(n))for(let o=0;o<n.length;o++)t[n[o].name]=n[o].fn;else n&&(t[n.name]=n.key?(...o)=>{const s=n.fn(...o);return s&&(s.key=n.key),s}:n.fn)}return t}function renderSlot(t,r,e={},n,o){if(currentRenderingInstance.isCE||currentRenderingInstance.parent&&isAsyncWrapper(currentRenderingInstance.parent)&&currentRenderingInstance.parent.isCE)return r!=="default"&&(e.name=r),createVNode("slot",e,n&&n());let s=t[r];s&&s._c&&(s._d=!1),openBlock();const a=s&&ensureValidVNode(s(e)),i=createBlock(Fragment,{key:e.key||a&&a.key||`_${r}`},a||(n?n():[]),a&&t._===1?64:-2);return!o&&i.scopeId&&(i.slotScopeIds=[i.scopeId+"-s"]),s&&s._c&&(s._d=!0),i}function ensureValidVNode(t){return t.some(r=>isVNode(r)?!(r.type===Comment||r.type===Fragment&&!ensureValidVNode(r.children)):!0)?t:null}function toHandlers(t,r){const e={};for(const n in t)e[r&&/[A-Z]/.test(n)?`on:${n}`:toHandlerKey(n)]=t[n];return e}const getPublicInstance=t=>t?isStatefulComponent(t)?getExposeProxy(t)||t.proxy:getPublicInstance(t.parent):null,publicPropertiesMap=extend$1(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>getPublicInstance(t.parent),$root:t=>getPublicInstance(t.root),$emit:t=>t.emit,$options:t=>resolveMergedOptions(t),$forceUpdate:t=>t.f||(t.f=()=>queueJob(t.update)),$nextTick:t=>t.n||(t.n=nextTick.bind(t.proxy)),$watch:t=>instanceWatch.bind(t)}),hasSetupBinding=(t,r)=>t!==EMPTY_OBJ&&!t.__isScriptSetup&&hasOwn(t,r),PublicInstanceProxyHandlers={get({_:t},r){const{ctx:e,setupState:n,data:o,props:s,accessCache:a,type:i,appContext:u}=t;let c;if(r[0]!=="$"){const g=a[r];if(g!==void 0)switch(g){case 1:return n[r];case 2:return o[r];case 4:return e[r];case 3:return s[r]}else{if(hasSetupBinding(n,r))return a[r]=1,n[r];if(o!==EMPTY_OBJ&&hasOwn(o,r))return a[r]=2,o[r];if((c=t.propsOptions[0])&&hasOwn(c,r))return a[r]=3,s[r];if(e!==EMPTY_OBJ&&hasOwn(e,r))return a[r]=4,e[r];shouldCacheAccess&&(a[r]=0)}}const d=publicPropertiesMap[r];let m,v;if(d)return r==="$attrs"&&track(t,"get",r),d(t);if((m=i.__cssModules)&&(m=m[r]))return m;if(e!==EMPTY_OBJ&&hasOwn(e,r))return a[r]=4,e[r];if(v=u.config.globalProperties,hasOwn(v,r))return v[r]},set({_:t},r,e){const{data:n,setupState:o,ctx:s}=t;return hasSetupBinding(o,r)?(o[r]=e,!0):n!==EMPTY_OBJ&&hasOwn(n,r)?(n[r]=e,!0):hasOwn(t.props,r)||r[0]==="$"&&r.slice(1)in t?!1:(s[r]=e,!0)},has({_:{data:t,setupState:r,accessCache:e,ctx:n,appContext:o,propsOptions:s}},a){let i;return!!e[a]||t!==EMPTY_OBJ&&hasOwn(t,a)||hasSetupBinding(r,a)||(i=s[0])&&hasOwn(i,a)||hasOwn(n,a)||hasOwn(publicPropertiesMap,a)||hasOwn(o.config.globalProperties,a)},defineProperty(t,r,e){return e.get!=null?t._.accessCache[r]=0:hasOwn(e,"value")&&this.set(t,r,e.value,null),Reflect.defineProperty(t,r,e)}};function useSlots(){return getContext().slots}function useAttrs$1(){return getContext().attrs}function getContext(){const t=getCurrentInstance();return t.setupContext||(t.setupContext=createSetupContext(t))}function normalizePropsOrEmits(t){return isArray$4(t)?t.reduce((r,e)=>(r[e]=null,r),{}):t}let shouldCacheAccess=!0;function applyOptions(t){const r=resolveMergedOptions(t),e=t.proxy,n=t.ctx;shouldCacheAccess=!1,r.beforeCreate&&callHook$1(r.beforeCreate,t,"bc");const{data:o,computed:s,methods:a,watch:i,provide:u,inject:c,created:d,beforeMount:m,mounted:v,beforeUpdate:g,updated:b,activated:T,deactivated:k,beforeDestroy:y,beforeUnmount:A,destroyed:V,unmounted:he,render:ae,renderTracked:Ne,renderTriggered:_e,errorCaptured:Ce,serverPrefetch:re,expose:ue,inheritAttrs:ze,components:le,directives:de,filters:Ie}=r;if(c&&resolveInjections(c,n,null),a)for(const Ue in a){const Dt=a[Ue];isFunction$3(Dt)&&(n[Ue]=Dt.bind(e))}if(o){const Ue=o.call(e,e);isObject$2(Ue)&&(t.data=reactive(Ue))}if(shouldCacheAccess=!0,s)for(const Ue in s){const Dt=s[Ue],tr=isFunction$3(Dt)?Dt.bind(e,e):isFunction$3(Dt.get)?Dt.get.bind(e,e):NOOP,dr=!isFunction$3(Dt)&&isFunction$3(Dt.set)?Dt.set.bind(e):NOOP,fr=computed({get:tr,set:dr});Object.defineProperty(n,Ue,{enumerable:!0,configurable:!0,get:()=>fr.value,set:sr=>fr.value=sr})}if(i)for(const Ue in i)createWatcher(i[Ue],n,e,Ue);if(u){const Ue=isFunction$3(u)?u.call(e):u;Reflect.ownKeys(Ue).forEach(Dt=>{provide(Dt,Ue[Dt])})}d&&callHook$1(d,t,"c");function Ve(Ue,Dt){isArray$4(Dt)?Dt.forEach(tr=>Ue(tr.bind(e))):Dt&&Ue(Dt.bind(e))}if(Ve(onBeforeMount,m),Ve(onMounted,v),Ve(onBeforeUpdate,g),Ve(onUpdated,b),Ve(onActivated,T),Ve(onDeactivated,k),Ve(onErrorCaptured,Ce),Ve(onRenderTracked,Ne),Ve(onRenderTriggered,_e),Ve(onBeforeUnmount,A),Ve(onUnmounted,he),Ve(onServerPrefetch,re),isArray$4(ue))if(ue.length){const Ue=t.exposed||(t.exposed={});ue.forEach(Dt=>{Object.defineProperty(Ue,Dt,{get:()=>e[Dt],set:tr=>e[Dt]=tr})})}else t.exposed||(t.exposed={});ae&&t.render===NOOP&&(t.render=ae),ze!=null&&(t.inheritAttrs=ze),le&&(t.components=le),de&&(t.directives=de)}function resolveInjections(t,r,e=NOOP){isArray$4(t)&&(t=normalizeInject(t));for(const n in t){const o=t[n];let s;isObject$2(o)?"default"in o?s=inject(o.from||n,o.default,!0):s=inject(o.from||n):s=inject(o),isRef(s)?Object.defineProperty(r,n,{enumerable:!0,configurable:!0,get:()=>s.value,set:a=>s.value=a}):r[n]=s}}function callHook$1(t,r,e){callWithAsyncErrorHandling(isArray$4(t)?t.map(n=>n.bind(r.proxy)):t.bind(r.proxy),r,e)}function createWatcher(t,r,e,n){const o=n.includes(".")?createPathGetter(e,n):()=>e[n];if(isString$2(t)){const s=r[t];isFunction$3(s)&&watch(o,s)}else if(isFunction$3(t))watch(o,t.bind(e));else if(isObject$2(t))if(isArray$4(t))t.forEach(s=>createWatcher(s,r,e,n));else{const s=isFunction$3(t.handler)?t.handler.bind(e):r[t.handler];isFunction$3(s)&&watch(o,s,t)}}function resolveMergedOptions(t){const r=t.type,{mixins:e,extends:n}=r,{mixins:o,optionsCache:s,config:{optionMergeStrategies:a}}=t.appContext,i=s.get(r);let u;return i?u=i:!o.length&&!e&&!n?u=r:(u={},o.length&&o.forEach(c=>mergeOptions$1(u,c,a,!0)),mergeOptions$1(u,r,a)),isObject$2(r)&&s.set(r,u),u}function mergeOptions$1(t,r,e,n=!1){const{mixins:o,extends:s}=r;s&&mergeOptions$1(t,s,e,!0),o&&o.forEach(a=>mergeOptions$1(t,a,e,!0));for(const a in r)if(!(n&&a==="expose")){const i=internalOptionMergeStrats[a]||e&&e[a];t[a]=i?i(t[a],r[a]):r[a]}return t}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(t,r){return r?t?function(){return extend$1(isFunction$3(t)?t.call(this,this):t,isFunction$3(r)?r.call(this,this):r)}:r:t}function mergeInject(t,r){return mergeObjectOptions(normalizeInject(t),normalizeInject(r))}function normalizeInject(t){if(isArray$4(t)){const r={};for(let e=0;e<t.length;e++)r[t[e]]=t[e];return r}return t}function mergeAsArray(t,r){return t?[...new Set([].concat(t,r))]:r}function mergeObjectOptions(t,r){return t?extend$1(Object.create(null),t,r):r}function mergeEmitsOrPropsOptions(t,r){return t?isArray$4(t)&&isArray$4(r)?[...new Set([...t,...r])]:extend$1(Object.create(null),normalizePropsOrEmits(t),normalizePropsOrEmits(r??{})):r}function mergeWatchOptions(t,r){if(!t)return r;if(!r)return t;const e=extend$1(Object.create(null),t);for(const n in r)e[n]=mergeAsArray(t[n],r[n]);return e}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(t,r){return function(n,o=null){isFunction$3(n)||(n=extend$1({},n)),o!=null&&!isObject$2(o)&&(o=null);const s=createAppContext(),a=new Set;let i=!1;const u=s.app={_uid:uid$1++,_component:n,_props:o,_container:null,_context:s,_instance:null,version,get config(){return s.config},set config(c){},use(c,...d){return a.has(c)||(c&&isFunction$3(c.install)?(a.add(c),c.install(u,...d)):isFunction$3(c)&&(a.add(c),c(u,...d))),u},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),u},component(c,d){return d?(s.components[c]=d,u):s.components[c]},directive(c,d){return d?(s.directives[c]=d,u):s.directives[c]},mount(c,d,m){if(!i){const v=createVNode(n,o);return v.appContext=s,d&&r?r(v,c):t(v,c,m),i=!0,u._container=c,c.__vue_app__=u,getExposeProxy(v.component)||v.component.proxy}},unmount(){i&&(t(null,u._container),delete u._container.__vue_app__)},provide(c,d){return s.provides[c]=d,u},runWithContext(c){currentApp=u;try{return c()}finally{currentApp=null}}};return u}}let currentApp=null;function provide(t,r){if(currentInstance){let e=currentInstance.provides;const n=currentInstance.parent&&currentInstance.parent.provides;n===e&&(e=currentInstance.provides=Object.create(n)),e[t]=r}}function inject(t,r,e=!1){const n=currentInstance||currentRenderingInstance;if(n||currentApp){const o=n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:currentApp._context.provides;if(o&&t in o)return o[t];if(arguments.length>1)return e&&isFunction$3(r)?r.call(n&&n.proxy):r}}function initProps(t,r,e,n=!1){const o={},s={};def(s,InternalObjectKey,1),t.propsDefaults=Object.create(null),setFullProps(t,r,o,s);for(const a in t.propsOptions[0])a in o||(o[a]=void 0);e?t.props=n?o:shallowReactive(o):t.type.props?t.props=o:t.props=s,t.attrs=s}function updateProps(t,r,e,n){const{props:o,attrs:s,vnode:{patchFlag:a}}=t,i=toRaw(o),[u]=t.propsOptions;let c=!1;if((n||a>0)&&!(a&16)){if(a&8){const d=t.vnode.dynamicProps;for(let m=0;m<d.length;m++){let v=d[m];if(isEmitListener(t.emitsOptions,v))continue;const g=r[v];if(u)if(hasOwn(s,v))g!==s[v]&&(s[v]=g,c=!0);else{const b=camelize(v);o[b]=resolvePropValue(u,i,b,g,t,!1)}else g!==s[v]&&(s[v]=g,c=!0)}}}else{setFullProps(t,r,o,s)&&(c=!0);let d;for(const m in i)(!r||!hasOwn(r,m)&&((d=hyphenate(m))===m||!hasOwn(r,d)))&&(u?e&&(e[m]!==void 0||e[d]!==void 0)&&(o[m]=resolvePropValue(u,i,m,void 0,t,!0)):delete o[m]);if(s!==i)for(const m in s)(!r||!hasOwn(r,m))&&(delete s[m],c=!0)}c&&trigger(t,"set","$attrs")}function setFullProps(t,r,e,n){const[o,s]=t.propsOptions;let a=!1,i;if(r)for(let u in r){if(isReservedProp(u))continue;const c=r[u];let d;o&&hasOwn(o,d=camelize(u))?!s||!s.includes(d)?e[d]=c:(i||(i={}))[d]=c:isEmitListener(t.emitsOptions,u)||(!(u in n)||c!==n[u])&&(n[u]=c,a=!0)}if(s){const u=toRaw(e),c=i||EMPTY_OBJ;for(let d=0;d<s.length;d++){const m=s[d];e[m]=resolvePropValue(o,u,m,c[m],t,!hasOwn(c,m))}}return a}function resolvePropValue(t,r,e,n,o,s){const a=t[e];if(a!=null){const i=hasOwn(a,"default");if(i&&n===void 0){const u=a.default;if(a.type!==Function&&!a.skipFactory&&isFunction$3(u)){const{propsDefaults:c}=o;e in c?n=c[e]:(setCurrentInstance(o),n=c[e]=u.call(null,r),unsetCurrentInstance())}else n=u}a[0]&&(s&&!i?n=!1:a[1]&&(n===""||n===hyphenate(e))&&(n=!0))}return n}function normalizePropsOptions(t,r,e=!1){const n=r.propsCache,o=n.get(t);if(o)return o;const s=t.props,a={},i=[];let u=!1;if(!isFunction$3(t)){const d=m=>{u=!0;const[v,g]=normalizePropsOptions(m,r,!0);extend$1(a,v),g&&i.push(...g)};!e&&r.mixins.length&&r.mixins.forEach(d),t.extends&&d(t.extends),t.mixins&&t.mixins.forEach(d)}if(!s&&!u)return isObject$2(t)&&n.set(t,EMPTY_ARR),EMPTY_ARR;if(isArray$4(s))for(let d=0;d<s.length;d++){const m=camelize(s[d]);validatePropName(m)&&(a[m]=EMPTY_OBJ)}else if(s)for(const d in s){const m=camelize(d);if(validatePropName(m)){const v=s[d],g=a[m]=isArray$4(v)||isFunction$3(v)?{type:v}:extend$1({},v);if(g){const b=getTypeIndex(Boolean,g.type),T=getTypeIndex(String,g.type);g[0]=b>-1,g[1]=T<0||b<T,(b>-1||hasOwn(g,"default"))&&i.push(m)}}}const c=[a,i];return isObject$2(t)&&n.set(t,c),c}function validatePropName(t){return t[0]!=="$"}function getType(t){const r=t&&t.toString().match(/^\s*(function|class) (\w+)/);return r?r[2]:t===null?"null":""}function isSameType(t,r){return getType(t)===getType(r)}function getTypeIndex(t,r){return isArray$4(r)?r.findIndex(e=>isSameType(e,t)):isFunction$3(r)&&isSameType(r,t)?0:-1}const isInternalKey=t=>t[0]==="_"||t==="$stable",normalizeSlotValue=t=>isArray$4(t)?t.map(normalizeVNode):[normalizeVNode(t)],normalizeSlot$1=(t,r,e)=>{if(r._n)return r;const n=withCtx((...o)=>normalizeSlotValue(r(...o)),e);return n._c=!1,n},normalizeObjectSlots=(t,r,e)=>{const n=t._ctx;for(const o in t){if(isInternalKey(o))continue;const s=t[o];if(isFunction$3(s))r[o]=normalizeSlot$1(o,s,n);else if(s!=null){const a=normalizeSlotValue(s);r[o]=()=>a}}},normalizeVNodeSlots=(t,r)=>{const e=normalizeSlotValue(r);t.slots.default=()=>e},initSlots=(t,r)=>{if(t.vnode.shapeFlag&32){const e=r._;e?(t.slots=toRaw(r),def(r,"_",e)):normalizeObjectSlots(r,t.slots={})}else t.slots={},r&&normalizeVNodeSlots(t,r);def(t.slots,InternalObjectKey,1)},updateSlots=(t,r,e)=>{const{vnode:n,slots:o}=t;let s=!0,a=EMPTY_OBJ;if(n.shapeFlag&32){const i=r._;i?e&&i===1?s=!1:(extend$1(o,r),!e&&i===1&&delete o._):(s=!r.$stable,normalizeObjectSlots(r,o)),a=r}else r&&(normalizeVNodeSlots(t,r),a={default:1});if(s)for(const i in o)!isInternalKey(i)&&!(i in a)&&delete o[i]};function setRef(t,r,e,n,o=!1){if(isArray$4(t)){t.forEach((v,g)=>setRef(v,r&&(isArray$4(r)?r[g]:r),e,n,o));return}if(isAsyncWrapper(n)&&!o)return;const s=n.shapeFlag&4?getExposeProxy(n.component)||n.component.proxy:n.el,a=o?null:s,{i,r:u}=t,c=r&&r.r,d=i.refs===EMPTY_OBJ?i.refs={}:i.refs,m=i.setupState;if(c!=null&&c!==u&&(isString$2(c)?(d[c]=null,hasOwn(m,c)&&(m[c]=null)):isRef(c)&&(c.value=null)),isFunction$3(u))callWithErrorHandling(u,i,12,[a,d]);else{const v=isString$2(u),g=isRef(u);if(v||g){const b=()=>{if(t.f){const T=v?hasOwn(m,u)?m[u]:d[u]:u.value;o?isArray$4(T)&&remove(T,s):isArray$4(T)?T.includes(s)||T.push(s):v?(d[u]=[s],hasOwn(m,u)&&(m[u]=d[u])):(u.value=[s],t.k&&(d[t.k]=u.value))}else v?(d[u]=a,hasOwn(m,u)&&(m[u]=a)):g&&(u.value=a,t.k&&(d[t.k]=a))};a?(b.id=-1,queuePostRenderEffect(b,e)):b()}}}const queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(t){return baseCreateRenderer(t)}function baseCreateRenderer(t,r){const e=getGlobalThis();e.__VUE__=!0;const{insert:n,remove:o,patchProp:s,createElement:a,createText:i,createComment:u,setText:c,setElementText:d,parentNode:m,nextSibling:v,setScopeId:g=NOOP,insertStaticContent:b}=t,T=(kt,Et,cr,mr=null,yr=null,Tr=null,Ir=!1,kr=null,Ar=!!Et.dynamicChildren)=>{if(kt===Et)return;kt&&!isSameVNodeType(kt,Et)&&(mr=$e(kt),sr(kt,yr,Tr,!0),kt=null),Et.patchFlag===-2&&(Ar=!1,Et.dynamicChildren=null);const{type:Rr,ref:Mn,shapeFlag:Or}=Et;switch(Rr){case Text:k(kt,Et,cr,mr);break;case Comment:y(kt,Et,cr,mr);break;case Static:kt==null&&A(Et,cr,mr,Ir);break;case Fragment:le(kt,Et,cr,mr,yr,Tr,Ir,kr,Ar);break;default:Or&1?ae(kt,Et,cr,mr,yr,Tr,Ir,kr,Ar):Or&6?de(kt,Et,cr,mr,yr,Tr,Ir,kr,Ar):(Or&64||Or&128)&&Rr.process(kt,Et,cr,mr,yr,Tr,Ir,kr,Ar,nr)}Mn!=null&&yr&&setRef(Mn,kt&&kt.ref,Tr,Et||kt,!Et)},k=(kt,Et,cr,mr)=>{if(kt==null)n(Et.el=i(Et.children),cr,mr);else{const yr=Et.el=kt.el;Et.children!==kt.children&&c(yr,Et.children)}},y=(kt,Et,cr,mr)=>{kt==null?n(Et.el=u(Et.children||""),cr,mr):Et.el=kt.el},A=(kt,Et,cr,mr)=>{[kt.el,kt.anchor]=b(kt.children,Et,cr,mr,kt.el,kt.anchor)},V=({el:kt,anchor:Et},cr,mr)=>{let yr;for(;kt&&kt!==Et;)yr=v(kt),n(kt,cr,mr),kt=yr;n(Et,cr,mr)},he=({el:kt,anchor:Et})=>{let cr;for(;kt&&kt!==Et;)cr=v(kt),o(kt),kt=cr;o(Et)},ae=(kt,Et,cr,mr,yr,Tr,Ir,kr,Ar)=>{Ir=Ir||Et.type==="svg",kt==null?Ne(Et,cr,mr,yr,Tr,Ir,kr,Ar):re(kt,Et,yr,Tr,Ir,kr,Ar)},Ne=(kt,Et,cr,mr,yr,Tr,Ir,kr)=>{let Ar,Rr;const{type:Mn,props:Or,shapeFlag:Pr,transition:Nr,dirs:Wr}=kt;if(Ar=kt.el=a(kt.type,Tr,Or&&Or.is,Or),Pr&8?d(Ar,kt.children):Pr&16&&Ce(kt.children,Ar,null,mr,yr,Tr&&Mn!=="foreignObject",Ir,kr),Wr&&invokeDirectiveHook(kt,null,mr,"created"),_e(Ar,kt,kt.scopeId,Ir,mr),Or){for(const Ur in Or)Ur!=="value"&&!isReservedProp(Ur)&&s(Ar,Ur,null,Or[Ur],Tr,kt.children,mr,yr,ir);"value"in Or&&s(Ar,"value",null,Or.value),(Rr=Or.onVnodeBeforeMount)&&invokeVNodeHook(Rr,mr,kt)}Wr&&invokeDirectiveHook(kt,null,mr,"beforeMount");const Yr=(!yr||yr&&!yr.pendingBranch)&&Nr&&!Nr.persisted;Yr&&Nr.beforeEnter(Ar),n(Ar,Et,cr),((Rr=Or&&Or.onVnodeMounted)||Yr||Wr)&&queuePostRenderEffect(()=>{Rr&&invokeVNodeHook(Rr,mr,kt),Yr&&Nr.enter(Ar),Wr&&invokeDirectiveHook(kt,null,mr,"mounted")},yr)},_e=(kt,Et,cr,mr,yr)=>{if(cr&&g(kt,cr),mr)for(let Tr=0;Tr<mr.length;Tr++)g(kt,mr[Tr]);if(yr){let Tr=yr.subTree;if(Et===Tr){const Ir=yr.vnode;_e(kt,Ir,Ir.scopeId,Ir.slotScopeIds,yr.parent)}}},Ce=(kt,Et,cr,mr,yr,Tr,Ir,kr,Ar=0)=>{for(let Rr=Ar;Rr<kt.length;Rr++){const Mn=kt[Rr]=kr?cloneIfMounted(kt[Rr]):normalizeVNode(kt[Rr]);T(null,Mn,Et,cr,mr,yr,Tr,Ir,kr)}},re=(kt,Et,cr,mr,yr,Tr,Ir)=>{const kr=Et.el=kt.el;let{patchFlag:Ar,dynamicChildren:Rr,dirs:Mn}=Et;Ar|=kt.patchFlag&16;const Or=kt.props||EMPTY_OBJ,Pr=Et.props||EMPTY_OBJ;let Nr;cr&&toggleRecurse(cr,!1),(Nr=Pr.onVnodeBeforeUpdate)&&invokeVNodeHook(Nr,cr,Et,kt),Mn&&invokeDirectiveHook(Et,kt,cr,"beforeUpdate"),cr&&toggleRecurse(cr,!0);const Wr=yr&&Et.type!=="foreignObject";if(Rr?ue(kt.dynamicChildren,Rr,kr,cr,mr,Wr,Tr):Ir||Dt(kt,Et,kr,null,cr,mr,Wr,Tr,!1),Ar>0){if(Ar&16)ze(kr,Et,Or,Pr,cr,mr,yr);else if(Ar&2&&Or.class!==Pr.class&&s(kr,"class",null,Pr.class,yr),Ar&4&&s(kr,"style",Or.style,Pr.style,yr),Ar&8){const Yr=Et.dynamicProps;for(let Ur=0;Ur<Yr.length;Ur++){const qr=Yr[Ur],Yn=Or[qr],$n=Pr[qr];($n!==Yn||qr==="value")&&s(kr,qr,Yn,$n,yr,kt.children,cr,mr,ir)}}Ar&1&&kt.children!==Et.children&&d(kr,Et.children)}else!Ir&&Rr==null&&ze(kr,Et,Or,Pr,cr,mr,yr);((Nr=Pr.onVnodeUpdated)||Mn)&&queuePostRenderEffect(()=>{Nr&&invokeVNodeHook(Nr,cr,Et,kt),Mn&&invokeDirectiveHook(Et,kt,cr,"updated")},mr)},ue=(kt,Et,cr,mr,yr,Tr,Ir)=>{for(let kr=0;kr<Et.length;kr++){const Ar=kt[kr],Rr=Et[kr],Mn=Ar.el&&(Ar.type===Fragment||!isSameVNodeType(Ar,Rr)||Ar.shapeFlag&70)?m(Ar.el):cr;T(Ar,Rr,Mn,null,mr,yr,Tr,Ir,!0)}},ze=(kt,Et,cr,mr,yr,Tr,Ir)=>{if(cr!==mr){if(cr!==EMPTY_OBJ)for(const kr in cr)!isReservedProp(kr)&&!(kr in mr)&&s(kt,kr,cr[kr],null,Ir,Et.children,yr,Tr,ir);for(const kr in mr){if(isReservedProp(kr))continue;const Ar=mr[kr],Rr=cr[kr];Ar!==Rr&&kr!=="value"&&s(kt,kr,Rr,Ar,Ir,Et.children,yr,Tr,ir)}"value"in mr&&s(kt,"value",cr.value,mr.value)}},le=(kt,Et,cr,mr,yr,Tr,Ir,kr,Ar)=>{const Rr=Et.el=kt?kt.el:i(""),Mn=Et.anchor=kt?kt.anchor:i("");let{patchFlag:Or,dynamicChildren:Pr,slotScopeIds:Nr}=Et;Nr&&(kr=kr?kr.concat(Nr):Nr),kt==null?(n(Rr,cr,mr),n(Mn,cr,mr),Ce(Et.children,cr,Mn,yr,Tr,Ir,kr,Ar)):Or>0&&Or&64&&Pr&&kt.dynamicChildren?(ue(kt.dynamicChildren,Pr,cr,yr,Tr,Ir,kr),(Et.key!=null||yr&&Et===yr.subTree)&&traverseStaticChildren(kt,Et,!0)):Dt(kt,Et,cr,Mn,yr,Tr,Ir,kr,Ar)},de=(kt,Et,cr,mr,yr,Tr,Ir,kr,Ar)=>{Et.slotScopeIds=kr,kt==null?Et.shapeFlag&512?yr.ctx.activate(Et,cr,mr,Ir,Ar):Ie(Et,cr,mr,yr,Tr,Ir,Ar):ie(kt,Et,Ar)},Ie=(kt,Et,cr,mr,yr,Tr,Ir)=>{const kr=kt.component=createComponentInstance(kt,mr,yr);if(isKeepAlive(kt)&&(kr.ctx.renderer=nr),setupComponent(kr),kr.asyncDep){if(yr&&yr.registerDep(kr,Ve),!kt.el){const Ar=kr.subTree=createVNode(Comment);y(null,Ar,Et,cr)}return}Ve(kr,kt,Et,cr,yr,Tr,Ir)},ie=(kt,Et,cr)=>{const mr=Et.component=kt.component;if(shouldUpdateComponent(kt,Et,cr))if(mr.asyncDep&&!mr.asyncResolved){Ue(mr,Et,cr);return}else mr.next=Et,invalidateJob(mr.update),mr.update();else Et.el=kt.el,mr.vnode=Et},Ve=(kt,Et,cr,mr,yr,Tr,Ir)=>{const kr=()=>{if(kt.isMounted){let{next:Mn,bu:Or,u:Pr,parent:Nr,vnode:Wr}=kt,Yr=Mn,Ur;toggleRecurse(kt,!1),Mn?(Mn.el=Wr.el,Ue(kt,Mn,Ir)):Mn=Wr,Or&&invokeArrayFns(Or),(Ur=Mn.props&&Mn.props.onVnodeBeforeUpdate)&&invokeVNodeHook(Ur,Nr,Mn,Wr),toggleRecurse(kt,!0);const qr=renderComponentRoot(kt),Yn=kt.subTree;kt.subTree=qr,T(Yn,qr,m(Yn.el),$e(Yn),kt,yr,Tr),Mn.el=qr.el,Yr===null&&updateHOCHostEl(kt,qr.el),Pr&&queuePostRenderEffect(Pr,yr),(Ur=Mn.props&&Mn.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(Ur,Nr,Mn,Wr),yr)}else{let Mn;const{el:Or,props:Pr}=Et,{bm:Nr,m:Wr,parent:Yr}=kt,Ur=isAsyncWrapper(Et);if(toggleRecurse(kt,!1),Nr&&invokeArrayFns(Nr),!Ur&&(Mn=Pr&&Pr.onVnodeBeforeMount)&&invokeVNodeHook(Mn,Yr,Et),toggleRecurse(kt,!0),Or&&rr){const qr=()=>{kt.subTree=renderComponentRoot(kt),rr(Or,kt.subTree,kt,yr,null)};Ur?Et.type.__asyncLoader().then(()=>!kt.isUnmounted&&qr()):qr()}else{const qr=kt.subTree=renderComponentRoot(kt);T(null,qr,cr,mr,kt,yr,Tr),Et.el=qr.el}if(Wr&&queuePostRenderEffect(Wr,yr),!Ur&&(Mn=Pr&&Pr.onVnodeMounted)){const qr=Et;queuePostRenderEffect(()=>invokeVNodeHook(Mn,Yr,qr),yr)}(Et.shapeFlag&256||Yr&&isAsyncWrapper(Yr.vnode)&&Yr.vnode.shapeFlag&256)&&kt.a&&queuePostRenderEffect(kt.a,yr),kt.isMounted=!0,Et=cr=mr=null}},Ar=kt.effect=new ReactiveEffect(kr,()=>queueJob(Rr),kt.scope),Rr=kt.update=()=>Ar.run();Rr.id=kt.uid,toggleRecurse(kt,!0),Rr()},Ue=(kt,Et,cr)=>{Et.component=kt;const mr=kt.vnode.props;kt.vnode=Et,kt.next=null,updateProps(kt,Et.props,mr,cr),updateSlots(kt,Et.children,cr),pauseTracking(),flushPreFlushCbs(),resetTracking()},Dt=(kt,Et,cr,mr,yr,Tr,Ir,kr,Ar=!1)=>{const Rr=kt&&kt.children,Mn=kt?kt.shapeFlag:0,Or=Et.children,{patchFlag:Pr,shapeFlag:Nr}=Et;if(Pr>0){if(Pr&128){dr(Rr,Or,cr,mr,yr,Tr,Ir,kr,Ar);return}else if(Pr&256){tr(Rr,Or,cr,mr,yr,Tr,Ir,kr,Ar);return}}Nr&8?(Mn&16&&ir(Rr,yr,Tr),Or!==Rr&&d(cr,Or)):Mn&16?Nr&16?dr(Rr,Or,cr,mr,yr,Tr,Ir,kr,Ar):ir(Rr,yr,Tr,!0):(Mn&8&&d(cr,""),Nr&16&&Ce(Or,cr,mr,yr,Tr,Ir,kr,Ar))},tr=(kt,Et,cr,mr,yr,Tr,Ir,kr,Ar)=>{kt=kt||EMPTY_ARR,Et=Et||EMPTY_ARR;const Rr=kt.length,Mn=Et.length,Or=Math.min(Rr,Mn);let Pr;for(Pr=0;Pr<Or;Pr++){const Nr=Et[Pr]=Ar?cloneIfMounted(Et[Pr]):normalizeVNode(Et[Pr]);T(kt[Pr],Nr,cr,null,yr,Tr,Ir,kr,Ar)}Rr>Mn?ir(kt,yr,Tr,!0,!1,Or):Ce(Et,cr,mr,yr,Tr,Ir,kr,Ar,Or)},dr=(kt,Et,cr,mr,yr,Tr,Ir,kr,Ar)=>{let Rr=0;const Mn=Et.length;let Or=kt.length-1,Pr=Mn-1;for(;Rr<=Or&&Rr<=Pr;){const Nr=kt[Rr],Wr=Et[Rr]=Ar?cloneIfMounted(Et[Rr]):normalizeVNode(Et[Rr]);if(isSameVNodeType(Nr,Wr))T(Nr,Wr,cr,null,yr,Tr,Ir,kr,Ar);else break;Rr++}for(;Rr<=Or&&Rr<=Pr;){const Nr=kt[Or],Wr=Et[Pr]=Ar?cloneIfMounted(Et[Pr]):normalizeVNode(Et[Pr]);if(isSameVNodeType(Nr,Wr))T(Nr,Wr,cr,null,yr,Tr,Ir,kr,Ar);else break;Or--,Pr--}if(Rr>Or){if(Rr<=Pr){const Nr=Pr+1,Wr=Nr<Mn?Et[Nr].el:mr;for(;Rr<=Pr;)T(null,Et[Rr]=Ar?cloneIfMounted(Et[Rr]):normalizeVNode(Et[Rr]),cr,Wr,yr,Tr,Ir,kr,Ar),Rr++}}else if(Rr>Pr)for(;Rr<=Or;)sr(kt[Rr],yr,Tr,!0),Rr++;else{const Nr=Rr,Wr=Rr,Yr=new Map;for(Rr=Wr;Rr<=Pr;Rr++){const ho=Et[Rr]=Ar?cloneIfMounted(Et[Rr]):normalizeVNode(Et[Rr]);ho.key!=null&&Yr.set(ho.key,Rr)}let Ur,qr=0;const Yn=Pr-Wr+1;let $n=!1,Jr=0;const Fr=new Array(Yn);for(Rr=0;Rr<Yn;Rr++)Fr[Rr]=0;for(Rr=Nr;Rr<=Or;Rr++){const ho=kt[Rr];if(qr>=Yn){sr(ho,yr,Tr,!0);continue}let bo;if(ho.key!=null)bo=Yr.get(ho.key);else for(Ur=Wr;Ur<=Pr;Ur++)if(Fr[Ur-Wr]===0&&isSameVNodeType(ho,Et[Ur])){bo=Ur;break}bo===void 0?sr(ho,yr,Tr,!0):(Fr[bo-Wr]=Rr+1,bo>=Jr?Jr=bo:$n=!0,T(ho,Et[bo],cr,null,yr,Tr,Ir,kr,Ar),qr++)}const Wn=$n?getSequence(Fr):EMPTY_ARR;for(Ur=Wn.length-1,Rr=Yn-1;Rr>=0;Rr--){const ho=Wr+Rr,bo=Et[ho],uo=ho+1<Mn?Et[ho+1].el:mr;Fr[Rr]===0?T(null,bo,cr,uo,yr,Tr,Ir,kr,Ar):$n&&(Ur<0||Rr!==Wn[Ur]?fr(bo,cr,uo,2):Ur--)}}},fr=(kt,Et,cr,mr,yr=null)=>{const{el:Tr,type:Ir,transition:kr,children:Ar,shapeFlag:Rr}=kt;if(Rr&6){fr(kt.component.subTree,Et,cr,mr);return}if(Rr&128){kt.suspense.move(Et,cr,mr);return}if(Rr&64){Ir.move(kt,Et,cr,nr);return}if(Ir===Fragment){n(Tr,Et,cr);for(let Or=0;Or<Ar.length;Or++)fr(Ar[Or],Et,cr,mr);n(kt.anchor,Et,cr);return}if(Ir===Static){V(kt,Et,cr);return}if(mr!==2&&Rr&1&&kr)if(mr===0)kr.beforeEnter(Tr),n(Tr,Et,cr),queuePostRenderEffect(()=>kr.enter(Tr),yr);else{const{leave:Or,delayLeave:Pr,afterLeave:Nr}=kr,Wr=()=>n(Tr,Et,cr),Yr=()=>{Or(Tr,()=>{Wr(),Nr&&Nr()})};Pr?Pr(Tr,Wr,Yr):Yr()}else n(Tr,Et,cr)},sr=(kt,Et,cr,mr=!1,yr=!1)=>{const{type:Tr,props:Ir,ref:kr,children:Ar,dynamicChildren:Rr,shapeFlag:Mn,patchFlag:Or,dirs:Pr}=kt;if(kr!=null&&setRef(kr,null,cr,kt,!0),Mn&256){Et.ctx.deactivate(kt);return}const Nr=Mn&1&&Pr,Wr=!isAsyncWrapper(kt);let Yr;if(Wr&&(Yr=Ir&&Ir.onVnodeBeforeUnmount)&&invokeVNodeHook(Yr,Et,kt),Mn&6)or(kt.component,cr,mr);else{if(Mn&128){kt.suspense.unmount(cr,mr);return}Nr&&invokeDirectiveHook(kt,null,Et,"beforeUnmount"),Mn&64?kt.type.remove(kt,Et,cr,yr,nr,mr):Rr&&(Tr!==Fragment||Or>0&&Or&64)?ir(Rr,Et,cr,!1,!0):(Tr===Fragment&&Or&384||!yr&&Mn&16)&&ir(Ar,Et,cr),mr&&hr(kt)}(Wr&&(Yr=Ir&&Ir.onVnodeUnmounted)||Nr)&&queuePostRenderEffect(()=>{Yr&&invokeVNodeHook(Yr,Et,kt),Nr&&invokeDirectiveHook(kt,null,Et,"unmounted")},cr)},hr=kt=>{const{type:Et,el:cr,anchor:mr,transition:yr}=kt;if(Et===Fragment){Fe(cr,mr);return}if(Et===Static){he(kt);return}const Tr=()=>{o(cr),yr&&!yr.persisted&&yr.afterLeave&&yr.afterLeave()};if(kt.shapeFlag&1&&yr&&!yr.persisted){const{leave:Ir,delayLeave:kr}=yr,Ar=()=>Ir(cr,Tr);kr?kr(kt.el,Tr,Ar):Ar()}else Tr()},Fe=(kt,Et)=>{let cr;for(;kt!==Et;)cr=v(kt),o(kt),kt=cr;o(Et)},or=(kt,Et,cr)=>{const{bum:mr,scope:yr,update:Tr,subTree:Ir,um:kr}=kt;mr&&invokeArrayFns(mr),yr.stop(),Tr&&(Tr.active=!1,sr(Ir,kt,Et,cr)),kr&&queuePostRenderEffect(kr,Et),queuePostRenderEffect(()=>{kt.isUnmounted=!0},Et),Et&&Et.pendingBranch&&!Et.isUnmounted&&kt.asyncDep&&!kt.asyncResolved&&kt.suspenseId===Et.pendingId&&(Et.deps--,Et.deps===0&&Et.resolve())},ir=(kt,Et,cr,mr=!1,yr=!1,Tr=0)=>{for(let Ir=Tr;Ir<kt.length;Ir++)sr(kt[Ir],Et,cr,mr,yr)},$e=kt=>kt.shapeFlag&6?$e(kt.component.subTree):kt.shapeFlag&128?kt.suspense.next():v(kt.anchor||kt.el),er=(kt,Et,cr)=>{kt==null?Et._vnode&&sr(Et._vnode,null,null,!0):T(Et._vnode||null,kt,Et,null,null,null,cr),flushPreFlushCbs(),flushPostFlushCbs(),Et._vnode=kt},nr={p:T,um:sr,m:fr,r:hr,mt:Ie,mc:Ce,pc:Dt,pbc:ue,n:$e,o:t};let Pt,rr;return r&&([Pt,rr]=r(nr)),{render:er,hydrate:Pt,createApp:createAppAPI(er,Pt)}}function toggleRecurse({effect:t,update:r},e){t.allowRecurse=r.allowRecurse=e}function traverseStaticChildren(t,r,e=!1){const n=t.children,o=r.children;if(isArray$4(n)&&isArray$4(o))for(let s=0;s<n.length;s++){const a=n[s];let i=o[s];i.shapeFlag&1&&!i.dynamicChildren&&((i.patchFlag<=0||i.patchFlag===32)&&(i=o[s]=cloneIfMounted(o[s]),i.el=a.el),e||traverseStaticChildren(a,i)),i.type===Text&&(i.el=a.el)}}function getSequence(t){const r=t.slice(),e=[0];let n,o,s,a,i;const u=t.length;for(n=0;n<u;n++){const c=t[n];if(c!==0){if(o=e[e.length-1],t[o]<c){r[n]=o,e.push(n);continue}for(s=0,a=e.length-1;s<a;)i=s+a>>1,t[e[i]]<c?s=i+1:a=i;c<t[e[s]]&&(s>0&&(r[n]=e[s-1]),e[s]=n)}}for(s=e.length,a=e[s-1];s-- >0;)e[s]=a,a=r[a];return e}const isTeleport=t=>t.__isTeleport,isTeleportDisabled=t=>t&&(t.disabled||t.disabled===""),isTargetSVG=t=>typeof SVGElement<"u"&&t instanceof SVGElement,resolveTarget=(t,r)=>{const e=t&&t.to;return isString$2(e)?r?r(e):null:e},TeleportImpl={__isTeleport:!0,process(t,r,e,n,o,s,a,i,u,c){const{mc:d,pc:m,pbc:v,o:{insert:g,querySelector:b,createText:T,createComment:k}}=c,y=isTeleportDisabled(r.props);let{shapeFlag:A,children:V,dynamicChildren:he}=r;if(t==null){const ae=r.el=T(""),Ne=r.anchor=T("");g(ae,e,n),g(Ne,e,n);const _e=r.target=resolveTarget(r.props,b),Ce=r.targetAnchor=T("");_e&&(g(Ce,_e),a=a||isTargetSVG(_e));const re=(ue,ze)=>{A&16&&d(V,ue,ze,o,s,a,i,u)};y?re(e,Ne):_e&&re(_e,Ce)}else{r.el=t.el;const ae=r.anchor=t.anchor,Ne=r.target=t.target,_e=r.targetAnchor=t.targetAnchor,Ce=isTeleportDisabled(t.props),re=Ce?e:Ne,ue=Ce?ae:_e;if(a=a||isTargetSVG(Ne),he?(v(t.dynamicChildren,he,re,o,s,a,i),traverseStaticChildren(t,r,!0)):u||m(t,r,re,ue,o,s,a,i,!1),y)Ce||moveTeleport(r,e,ae,c,1);else if((r.props&&r.props.to)!==(t.props&&t.props.to)){const ze=r.target=resolveTarget(r.props,b);ze&&moveTeleport(r,ze,null,c,0)}else Ce&&moveTeleport(r,Ne,_e,c,1)}updateCssVars(r)},remove(t,r,e,n,{um:o,o:{remove:s}},a){const{shapeFlag:i,children:u,anchor:c,targetAnchor:d,target:m,props:v}=t;if(m&&s(d),(a||!isTeleportDisabled(v))&&(s(c),i&16))for(let g=0;g<u.length;g++){const b=u[g];o(b,r,e,!0,!!b.dynamicChildren)}},move:moveTeleport,hydrate:hydrateTeleport};function moveTeleport(t,r,e,{o:{insert:n},m:o},s=2){s===0&&n(t.targetAnchor,r,e);const{el:a,anchor:i,shapeFlag:u,children:c,props:d}=t,m=s===2;if(m&&n(a,r,e),(!m||isTeleportDisabled(d))&&u&16)for(let v=0;v<c.length;v++)o(c[v],r,e,2);m&&n(i,r,e)}function hydrateTeleport(t,r,e,n,o,s,{o:{nextSibling:a,parentNode:i,querySelector:u}},c){const d=r.target=resolveTarget(r.props,u);if(d){const m=d._lpa||d.firstChild;if(r.shapeFlag&16)if(isTeleportDisabled(r.props))r.anchor=c(a(t),r,i(t),e,n,o,s),r.targetAnchor=m;else{r.anchor=a(t);let v=m;for(;v;)if(v=a(v),v&&v.nodeType===8&&v.data==="teleport anchor"){r.targetAnchor=v,d._lpa=r.targetAnchor&&a(r.targetAnchor);break}c(m,r,d,e,n,o,s)}updateCssVars(r)}return r.anchor&&a(r.anchor)}const Teleport=TeleportImpl;function updateCssVars(t){const r=t.ctx;if(r&&r.ut){let e=t.children[0].el;for(;e!==t.targetAnchor;)e.nodeType===1&&e.setAttribute("data-v-owner",r.uid),e=e.nextSibling;r.ut()}}const Fragment=Symbol.for("v-fgt"),Text=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;function openBlock(t=!1){blockStack.push(currentBlock=t?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(t){isBlockTreeEnabled+=t}function setupBlock(t){return t.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(t),t}function createElementBlock(t,r,e,n,o,s){return setupBlock(createBaseVNode(t,r,e,n,o,s,!0))}function createBlock(t,r,e,n,o){return setupBlock(createVNode(t,r,e,n,o,!0))}function isVNode(t){return t?t.__v_isVNode===!0:!1}function isSameVNodeType(t,r){return t.type===r.type&&t.key===r.key}const InternalObjectKey="__vInternal",normalizeKey=({key:t})=>t??null,normalizeRef=({ref:t,ref_key:r,ref_for:e})=>(typeof t=="number"&&(t=""+t),t!=null?isString$2(t)||isRef(t)||isFunction$3(t)?{i:currentRenderingInstance,r:t,k:r,f:!!e}:t:null);function createBaseVNode(t,r=null,e=null,n=0,o=null,s=t===Fragment?0:1,a=!1,i=!1){const u={__v_isVNode:!0,__v_skip:!0,type:t,props:r,key:r&&normalizeKey(r),ref:r&&normalizeRef(r),scopeId:currentScopeId,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:n,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return i?(normalizeChildren(u,e),s&128&&t.normalize(u)):e&&(u.shapeFlag|=isString$2(e)?8:16),isBlockTreeEnabled>0&&!a&&currentBlock&&(u.patchFlag>0||s&6)&&u.patchFlag!==32&&currentBlock.push(u),u}const createVNode=_createVNode;function _createVNode(t,r=null,e=null,n=0,o=null,s=!1){if((!t||t===NULL_DYNAMIC_COMPONENT)&&(t=Comment),isVNode(t)){const i=cloneVNode(t,r,!0);return e&&normalizeChildren(i,e),isBlockTreeEnabled>0&&!s&&currentBlock&&(i.shapeFlag&6?currentBlock[currentBlock.indexOf(t)]=i:currentBlock.push(i)),i.patchFlag|=-2,i}if(isClassComponent(t)&&(t=t.__vccOpts),r){r=guardReactiveProps(r);let{class:i,style:u}=r;i&&!isString$2(i)&&(r.class=normalizeClass(i)),isObject$2(u)&&(isProxy(u)&&!isArray$4(u)&&(u=extend$1({},u)),r.style=normalizeStyle(u))}const a=isString$2(t)?1:isSuspense(t)?128:isTeleport(t)?64:isObject$2(t)?4:isFunction$3(t)?2:0;return createBaseVNode(t,r,e,n,o,a,s,!0)}function guardReactiveProps(t){return t?isProxy(t)||InternalObjectKey in t?extend$1({},t):t:null}function cloneVNode(t,r,e=!1){const{props:n,ref:o,patchFlag:s,children:a}=t,i=r?mergeProps(n||{},r):n;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:i,key:i&&normalizeKey(i),ref:r&&r.ref?e&&o?isArray$4(o)?o.concat(normalizeRef(r)):[o,normalizeRef(r)]:normalizeRef(r):o,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:r&&t.type!==Fragment?s===-1?16:s|16:s,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&cloneVNode(t.ssContent),ssFallback:t.ssFallback&&cloneVNode(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function createTextVNode(t=" ",r=0){return createVNode(Text,null,t,r)}function createCommentVNode(t="",r=!1){return r?(openBlock(),createBlock(Comment,null,t)):createVNode(Comment,null,t)}function normalizeVNode(t){return t==null||typeof t=="boolean"?createVNode(Comment):isArray$4(t)?createVNode(Fragment,null,t.slice()):typeof t=="object"?cloneIfMounted(t):createVNode(Text,null,String(t))}function cloneIfMounted(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:cloneVNode(t)}function normalizeChildren(t,r){let e=0;const{shapeFlag:n}=t;if(r==null)r=null;else if(isArray$4(r))e=16;else if(typeof r=="object")if(n&65){const o=r.default;o&&(o._c&&(o._d=!1),normalizeChildren(t,o()),o._c&&(o._d=!0));return}else{e=32;const o=r._;!o&&!(InternalObjectKey in r)?r._ctx=currentRenderingInstance:o===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?r._=1:(r._=2,t.patchFlag|=1024))}else isFunction$3(r)?(r={default:r,_ctx:currentRenderingInstance},e=32):(r=String(r),n&64?(e=16,r=[createTextVNode(r)]):e=8);t.children=r,t.shapeFlag|=e}function mergeProps(...t){const r={};for(let e=0;e<t.length;e++){const n=t[e];for(const o in n)if(o==="class")r.class!==n.class&&(r.class=normalizeClass([r.class,n.class]));else if(o==="style")r.style=normalizeStyle([r.style,n.style]);else if(isOn(o)){const s=r[o],a=n[o];a&&s!==a&&!(isArray$4(s)&&s.includes(a))&&(r[o]=s?[].concat(s,a):a)}else o!==""&&(r[o]=n[o])}return r}function invokeVNodeHook(t,r,e,n=null){callWithAsyncErrorHandling(t,r,7,[e,n])}const emptyAppContext=createAppContext();let uid$2=0;function createComponentInstance(t,r,e){const n=t.type,o=(r?r.appContext:t.appContext)||emptyAppContext,s={uid:uid$2++,vnode:t,type:n,parent:r,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:r?r.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(n,o),emitsOptions:normalizeEmitsOptions(n,o),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:n.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=r?r.root:s,s.emit=emit.bind(null,s),t.ce&&t.ce(s),s}let currentInstance=null;const getCurrentInstance=()=>currentInstance||currentRenderingInstance;let internalSetCurrentInstance,globalCurrentInstanceSetters,settersKey="__VUE_INSTANCE_SETTERS__";(globalCurrentInstanceSetters=getGlobalThis()[settersKey])||(globalCurrentInstanceSetters=getGlobalThis()[settersKey]=[]),globalCurrentInstanceSetters.push(t=>currentInstance=t),internalSetCurrentInstance=t=>{globalCurrentInstanceSetters.length>1?globalCurrentInstanceSetters.forEach(r=>r(t)):globalCurrentInstanceSetters[0](t)};const setCurrentInstance=t=>{internalSetCurrentInstance(t),t.scope.on()},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(t){return t.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(t,r=!1){isInSSRComponentSetup=r;const{props:e,children:n}=t.vnode,o=isStatefulComponent(t);initProps(t,e,o,r),initSlots(t,n);const s=o?setupStatefulComponent(t,r):void 0;return isInSSRComponentSetup=!1,s}function setupStatefulComponent(t,r){const e=t.type;t.accessCache=Object.create(null),t.proxy=markRaw(new Proxy(t.ctx,PublicInstanceProxyHandlers));const{setup:n}=e;if(n){const o=t.setupContext=n.length>1?createSetupContext(t):null;setCurrentInstance(t),pauseTracking();const s=callWithErrorHandling(n,t,0,[t.props,o]);if(resetTracking(),unsetCurrentInstance(),isPromise(s)){if(s.then(unsetCurrentInstance,unsetCurrentInstance),r)return s.then(a=>{handleSetupResult(t,a,r)}).catch(a=>{handleError(a,t,0)});t.asyncDep=s}else handleSetupResult(t,s,r)}else finishComponentSetup(t,r)}function handleSetupResult(t,r,e){isFunction$3(r)?t.type.__ssrInlineRender?t.ssrRender=r:t.render=r:isObject$2(r)&&(t.setupState=proxyRefs(r)),finishComponentSetup(t,e)}let compile;function finishComponentSetup(t,r,e){const n=t.type;if(!t.render){if(!r&&compile&&!n.render){const o=n.template||resolveMergedOptions(t).template;if(o){const{isCustomElement:s,compilerOptions:a}=t.appContext.config,{delimiters:i,compilerOptions:u}=n,c=extend$1(extend$1({isCustomElement:s,delimiters:i},a),u);n.render=compile(o,c)}}t.render=n.render||NOOP}setCurrentInstance(t),pauseTracking(),applyOptions(t),resetTracking(),unsetCurrentInstance()}function getAttrsProxy(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(r,e){return track(t,"get","$attrs"),r[e]}}))}function createSetupContext(t){const r=e=>{t.exposed=e||{}};return{get attrs(){return getAttrsProxy(t)},slots:t.slots,emit:t.emit,expose:r}}function getExposeProxy(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(proxyRefs(markRaw(t.exposed)),{get(r,e){if(e in r)return r[e];if(e in publicPropertiesMap)return publicPropertiesMap[e](t)},has(r,e){return e in r||e in publicPropertiesMap}}))}function getComponentName(t,r=!0){return isFunction$3(t)?t.displayName||t.name:t.name||r&&t.__name}function isClassComponent(t){return isFunction$3(t)&&"__vccOpts"in t}const computed=(t,r)=>computed$1(t,r,isInSSRComponentSetup);function h(t,r,e){const n=arguments.length;return n===2?isObject$2(r)&&!isArray$4(r)?isVNode(r)?createVNode(t,null,[r]):createVNode(t,r):createVNode(t,null,r):(n>3?e=Array.prototype.slice.call(arguments,2):n===3&&isVNode(e)&&(e=[e]),createVNode(t,r,e))}const ssrContextKey=Symbol.for("v-scx"),useSSRContext=()=>inject(ssrContextKey),version="3.3.4",svgNS="http://www.w3.org/2000/svg",doc=typeof document<"u"?document:null,templateContainer=doc&&doc.createElement("template"),nodeOps={insert:(t,r,e)=>{r.insertBefore(t,e||null)},remove:t=>{const r=t.parentNode;r&&r.removeChild(t)},createElement:(t,r,e,n)=>{const o=r?doc.createElementNS(svgNS,t):doc.createElement(t,e?{is:e}:void 0);return t==="select"&&n&&n.multiple!=null&&o.setAttribute("multiple",n.multiple),o},createText:t=>doc.createTextNode(t),createComment:t=>doc.createComment(t),setText:(t,r)=>{t.nodeValue=r},setElementText:(t,r)=>{t.textContent=r},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>doc.querySelector(t),setScopeId(t,r){t.setAttribute(r,"")},insertStaticContent(t,r,e,n,o,s){const a=e?e.previousSibling:r.lastChild;if(o&&(o===s||o.nextSibling))for(;r.insertBefore(o.cloneNode(!0),e),!(o===s||!(o=o.nextSibling)););else{templateContainer.innerHTML=n?`<svg>${t}</svg>`:t;const i=templateContainer.content;if(n){const u=i.firstChild;for(;u.firstChild;)i.appendChild(u.firstChild);i.removeChild(u)}r.insertBefore(i,e)}return[a?a.nextSibling:r.firstChild,e?e.previousSibling:r.lastChild]}};function patchClass(t,r,e){const n=t._vtc;n&&(r=(r?[r,...n]:[...n]).join(" ")),r==null?t.removeAttribute("class"):e?t.setAttribute("class",r):t.className=r}function patchStyle(t,r,e){const n=t.style,o=isString$2(e);if(e&&!o){if(r&&!isString$2(r))for(const s in r)e[s]==null&&setStyle(n,s,"");for(const s in e)setStyle(n,s,e[s])}else{const s=n.display;o?r!==e&&(n.cssText=e):r&&t.removeAttribute("style"),"_vod"in t&&(n.display=s)}}const importantRE=/\s*!important$/;function setStyle(t,r,e){if(isArray$4(e))e.forEach(n=>setStyle(t,r,n));else if(e==null&&(e=""),r.startsWith("--"))t.setProperty(r,e);else{const n=autoPrefix(t,r);importantRE.test(e)?t.setProperty(hyphenate(n),e.replace(importantRE,""),"important"):t[n]=e}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(t,r){const e=prefixCache[r];if(e)return e;let n=camelize(r);if(n!=="filter"&&n in t)return prefixCache[r]=n;n=capitalize$1(n);for(let o=0;o<prefixes.length;o++){const s=prefixes[o]+n;if(s in t)return prefixCache[r]=s}return r}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(t,r,e,n,o){if(n&&r.startsWith("xlink:"))e==null?t.removeAttributeNS(xlinkNS,r.slice(6,r.length)):t.setAttributeNS(xlinkNS,r,e);else{const s=isSpecialBooleanAttr(r);e==null||s&&!includeBooleanAttr(e)?t.removeAttribute(r):t.setAttribute(r,s?"":e)}}function patchDOMProp(t,r,e,n,o,s,a){if(r==="innerHTML"||r==="textContent"){n&&a(n,o,s),t[r]=e??"";return}const i=t.tagName;if(r==="value"&&i!=="PROGRESS"&&!i.includes("-")){t._value=e;const c=i==="OPTION"?t.getAttribute("value"):t.value,d=e??"";c!==d&&(t.value=d),e==null&&t.removeAttribute(r);return}let u=!1;if(e===""||e==null){const c=typeof t[r];c==="boolean"?e=includeBooleanAttr(e):e==null&&c==="string"?(e="",u=!0):c==="number"&&(e=0,u=!0)}try{t[r]=e}catch{}u&&t.removeAttribute(r)}function addEventListener(t,r,e,n){t.addEventListener(r,e,n)}function removeEventListener(t,r,e,n){t.removeEventListener(r,e,n)}function patchEvent(t,r,e,n,o=null){const s=t._vei||(t._vei={}),a=s[r];if(n&&a)a.value=n;else{const[i,u]=parseName(r);if(n){const c=s[r]=createInvoker(n,o);addEventListener(t,i,c,u)}else a&&(removeEventListener(t,i,a,u),s[r]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(t){let r;if(optionsModifierRE.test(t)){r={};let n;for(;n=t.match(optionsModifierRE);)t=t.slice(0,t.length-n[0].length),r[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):hyphenate(t.slice(2)),r]}let cachedNow=0;const p=Promise.resolve(),getNow=()=>cachedNow||(p.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(t,r){const e=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=e.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(n,e.value),r,5,[n])};return e.value=t,e.attached=getNow(),e}function patchStopImmediatePropagation(t,r){if(isArray$4(r)){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{e.call(t),t._stopped=!0},r.map(n=>o=>!o._stopped&&n&&n(o))}else return r}const nativeOnRE=/^on[a-z]/,patchProp=(t,r,e,n,o=!1,s,a,i,u)=>{r==="class"?patchClass(t,n,o):r==="style"?patchStyle(t,e,n):isOn(r)?isModelListener(r)||patchEvent(t,r,e,n,a):(r[0]==="."?(r=r.slice(1),!0):r[0]==="^"?(r=r.slice(1),!1):shouldSetAsProp(t,r,n,o))?patchDOMProp(t,r,n,s,a,i,u):(r==="true-value"?t._trueValue=n:r==="false-value"&&(t._falseValue=n),patchAttr(t,r,n,o))};function shouldSetAsProp(t,r,e,n){return n?!!(r==="innerHTML"||r==="textContent"||r in t&&nativeOnRE.test(r)&&isFunction$3(e)):r==="spellcheck"||r==="draggable"||r==="translate"||r==="form"||r==="list"&&t.tagName==="INPUT"||r==="type"&&t.tagName==="TEXTAREA"||nativeOnRE.test(r)&&isString$2(e)?!1:r in t}const TRANSITION="transition",ANIMATION="animation",Transition=(t,{slots:r})=>h(BaseTransition,resolveTransitionProps(t),r);Transition.displayName="Transition";const DOMTransitionPropsValidators={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},TransitionPropsValidators=Transition.props=extend$1({},BaseTransitionPropsValidators,DOMTransitionPropsValidators),callHook=(t,r=[])=>{isArray$4(t)?t.forEach(e=>e(...r)):t&&t(...r)},hasExplicitCallback=t=>t?isArray$4(t)?t.some(r=>r.length>1):t.length>1:!1;function resolveTransitionProps(t){const r={};for(const le in t)le in DOMTransitionPropsValidators||(r[le]=t[le]);if(t.css===!1)return r;const{name:e="v",type:n,duration:o,enterFromClass:s=`${e}-enter-from`,enterActiveClass:a=`${e}-enter-active`,enterToClass:i=`${e}-enter-to`,appearFromClass:u=s,appearActiveClass:c=a,appearToClass:d=i,leaveFromClass:m=`${e}-leave-from`,leaveActiveClass:v=`${e}-leave-active`,leaveToClass:g=`${e}-leave-to`}=t,b=normalizeDuration(o),T=b&&b[0],k=b&&b[1],{onBeforeEnter:y,onEnter:A,onEnterCancelled:V,onLeave:he,onLeaveCancelled:ae,onBeforeAppear:Ne=y,onAppear:_e=A,onAppearCancelled:Ce=V}=r,re=(le,de,Ie)=>{removeTransitionClass(le,de?d:i),removeTransitionClass(le,de?c:a),Ie&&Ie()},ue=(le,de)=>{le._isLeaving=!1,removeTransitionClass(le,m),removeTransitionClass(le,g),removeTransitionClass(le,v),de&&de()},ze=le=>(de,Ie)=>{const ie=le?_e:A,Ve=()=>re(de,le,Ie);callHook(ie,[de,Ve]),nextFrame(()=>{removeTransitionClass(de,le?u:s),addTransitionClass(de,le?d:i),hasExplicitCallback(ie)||whenTransitionEnds(de,n,T,Ve)})};return extend$1(r,{onBeforeEnter(le){callHook(y,[le]),addTransitionClass(le,s),addTransitionClass(le,a)},onBeforeAppear(le){callHook(Ne,[le]),addTransitionClass(le,u),addTransitionClass(le,c)},onEnter:ze(!1),onAppear:ze(!0),onLeave(le,de){le._isLeaving=!0;const Ie=()=>ue(le,de);addTransitionClass(le,m),forceReflow(),addTransitionClass(le,v),nextFrame(()=>{le._isLeaving&&(removeTransitionClass(le,m),addTransitionClass(le,g),hasExplicitCallback(he)||whenTransitionEnds(le,n,k,Ie))}),callHook(he,[le,Ie])},onEnterCancelled(le){re(le,!1),callHook(V,[le])},onAppearCancelled(le){re(le,!0),callHook(Ce,[le])},onLeaveCancelled(le){ue(le),callHook(ae,[le])}})}function normalizeDuration(t){if(t==null)return null;if(isObject$2(t))return[NumberOf(t.enter),NumberOf(t.leave)];{const r=NumberOf(t);return[r,r]}}function NumberOf(t){return toNumber$1(t)}function addTransitionClass(t,r){r.split(/\s+/).forEach(e=>e&&t.classList.add(e)),(t._vtc||(t._vtc=new Set)).add(r)}function removeTransitionClass(t,r){r.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const{_vtc:e}=t;e&&(e.delete(r),e.size||(t._vtc=void 0))}function nextFrame(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let endId=0;function whenTransitionEnds(t,r,e,n){const o=t._endId=++endId,s=()=>{o===t._endId&&n()};if(e)return setTimeout(s,e);const{type:a,timeout:i,propCount:u}=getTransitionInfo(t,r);if(!a)return n();const c=a+"end";let d=0;const m=()=>{t.removeEventListener(c,v),s()},v=g=>{g.target===t&&++d>=u&&m()};setTimeout(()=>{d<u&&m()},i+1),t.addEventListener(c,v)}function getTransitionInfo(t,r){const e=window.getComputedStyle(t),n=b=>(e[b]||"").split(", "),o=n(`${TRANSITION}Delay`),s=n(`${TRANSITION}Duration`),a=getTimeout(o,s),i=n(`${ANIMATION}Delay`),u=n(`${ANIMATION}Duration`),c=getTimeout(i,u);let d=null,m=0,v=0;r===TRANSITION?a>0&&(d=TRANSITION,m=a,v=s.length):r===ANIMATION?c>0&&(d=ANIMATION,m=c,v=u.length):(m=Math.max(a,c),d=m>0?a>c?TRANSITION:ANIMATION:null,v=d?d===TRANSITION?s.length:u.length:0);const g=d===TRANSITION&&/\b(transform|all)(,|$)/.test(n(`${TRANSITION}Property`).toString());return{type:d,timeout:m,propCount:v,hasTransform:g}}function getTimeout(t,r){for(;t.length<r.length;)t=t.concat(t);return Math.max(...r.map((e,n)=>toMs(e)+toMs(t[n])))}function toMs(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function forceReflow(){return document.body.offsetHeight}const positionMap=new WeakMap,newPositionMap=new WeakMap,TransitionGroupImpl={name:"TransitionGroup",props:extend$1({},TransitionPropsValidators,{tag:String,moveClass:String}),setup(t,{slots:r}){const e=getCurrentInstance(),n=useTransitionState();let o,s;return onUpdated(()=>{if(!o.length)return;const a=t.moveClass||`${t.name||"v"}-move`;if(!hasCSSTransform(o[0].el,e.vnode.el,a))return;o.forEach(callPendingCbs),o.forEach(recordPosition);const i=o.filter(applyTranslation);forceReflow(),i.forEach(u=>{const c=u.el,d=c.style;addTransitionClass(c,a),d.transform=d.webkitTransform=d.transitionDuration="";const m=c._moveCb=v=>{v&&v.target!==c||(!v||/transform$/.test(v.propertyName))&&(c.removeEventListener("transitionend",m),c._moveCb=null,removeTransitionClass(c,a))};c.addEventListener("transitionend",m)})}),()=>{const a=toRaw(t),i=resolveTransitionProps(a);let u=a.tag||Fragment;o=s,s=r.default?getTransitionRawChildren(r.default()):[];for(let c=0;c<s.length;c++){const d=s[c];d.key!=null&&setTransitionHooks(d,resolveTransitionHooks(d,i,n,e))}if(o)for(let c=0;c<o.length;c++){const d=o[c];setTransitionHooks(d,resolveTransitionHooks(d,i,n,e)),positionMap.set(d,d.el.getBoundingClientRect())}return createVNode(u,null,s)}}},removeMode=t=>delete t.mode;TransitionGroupImpl.props;const TransitionGroup=TransitionGroupImpl;function callPendingCbs(t){const r=t.el;r._moveCb&&r._moveCb(),r._enterCb&&r._enterCb()}function recordPosition(t){newPositionMap.set(t,t.el.getBoundingClientRect())}function applyTranslation(t){const r=positionMap.get(t),e=newPositionMap.get(t),n=r.left-e.left,o=r.top-e.top;if(n||o){const s=t.el.style;return s.transform=s.webkitTransform=`translate(${n}px,${o}px)`,s.transitionDuration="0s",t}}function hasCSSTransform(t,r,e){const n=t.cloneNode();t._vtc&&t._vtc.forEach(a=>{a.split(/\s+/).forEach(i=>i&&n.classList.remove(i))}),e.split(/\s+/).forEach(a=>a&&n.classList.add(a)),n.style.display="none";const o=r.nodeType===1?r:r.parentNode;o.appendChild(n);const{hasTransform:s}=getTransitionInfo(n);return o.removeChild(n),s}const getModelAssigner=t=>{const r=t.props["onUpdate:modelValue"]||!1;return isArray$4(r)?e=>invokeArrayFns(r,e):r};function onCompositionStart(t){t.target.composing=!0}function onCompositionEnd(t){const r=t.target;r.composing&&(r.composing=!1,r.dispatchEvent(new Event("input")))}const vModelText={created(t,{modifiers:{lazy:r,trim:e,number:n}},o){t._assign=getModelAssigner(o);const s=n||o.props&&o.props.type==="number";addEventListener(t,r?"change":"input",a=>{if(a.target.composing)return;let i=t.value;e&&(i=i.trim()),s&&(i=looseToNumber(i)),t._assign(i)}),e&&addEventListener(t,"change",()=>{t.value=t.value.trim()}),r||(addEventListener(t,"compositionstart",onCompositionStart),addEventListener(t,"compositionend",onCompositionEnd),addEventListener(t,"change",onCompositionEnd))},mounted(t,{value:r}){t.value=r??""},beforeUpdate(t,{value:r,modifiers:{lazy:e,trim:n,number:o}},s){if(t._assign=getModelAssigner(s),t.composing||document.activeElement===t&&t.type!=="range"&&(e||n&&t.value.trim()===r||(o||t.type==="number")&&looseToNumber(t.value)===r))return;const a=r??"";t.value!==a&&(t.value=a)}},vModelCheckbox={deep:!0,created(t,r,e){t._assign=getModelAssigner(e),addEventListener(t,"change",()=>{const n=t._modelValue,o=getValue$2(t),s=t.checked,a=t._assign;if(isArray$4(n)){const i=looseIndexOf(n,o),u=i!==-1;if(s&&!u)a(n.concat(o));else if(!s&&u){const c=[...n];c.splice(i,1),a(c)}}else if(isSet$2(n)){const i=new Set(n);s?i.add(o):i.delete(o),a(i)}else a(getCheckboxValue(t,s))})},mounted:setChecked,beforeUpdate(t,r,e){t._assign=getModelAssigner(e),setChecked(t,r,e)}};function setChecked(t,{value:r,oldValue:e},n){t._modelValue=r,isArray$4(r)?t.checked=looseIndexOf(r,n.props.value)>-1:isSet$2(r)?t.checked=r.has(n.props.value):r!==e&&(t.checked=looseEqual(r,getCheckboxValue(t,!0)))}const vModelRadio={created(t,{value:r},e){t.checked=looseEqual(r,e.props.value),t._assign=getModelAssigner(e),addEventListener(t,"change",()=>{t._assign(getValue$2(t))})},beforeUpdate(t,{value:r,oldValue:e},n){t._assign=getModelAssigner(n),r!==e&&(t.checked=looseEqual(r,n.props.value))}};function getValue$2(t){return"_value"in t?t._value:t.value}function getCheckboxValue(t,r){const e=r?"_trueValue":"_falseValue";return e in t?t[e]:r}const systemModifiers=["ctrl","shift","alt","meta"],modifierGuards={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,r)=>systemModifiers.some(e=>t[`${e}Key`]&&!r.includes(e))},withModifiers=(t,r)=>(e,...n)=>{for(let o=0;o<r.length;o++){const s=modifierGuards[r[o]];if(s&&s(e,r))return}return t(e,...n)},keyNames={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},withKeys=(t,r)=>e=>{if(!("key"in e))return;const n=hyphenate(e.key);if(r.some(o=>o===n||keyNames[o]===n))return t(e)},vShow={beforeMount(t,{value:r},{transition:e}){t._vod=t.style.display==="none"?"":t.style.display,e&&r?e.beforeEnter(t):setDisplay(t,r)},mounted(t,{value:r},{transition:e}){e&&r&&e.enter(t)},updated(t,{value:r,oldValue:e},{transition:n}){!r!=!e&&(n?r?(n.beforeEnter(t),setDisplay(t,!0),n.enter(t)):n.leave(t,()=>{setDisplay(t,!1)}):setDisplay(t,r))},beforeUnmount(t,{value:r}){setDisplay(t,r)}};function setDisplay(t,r){t.style.display=r?t._vod:"none"}const rendererOptions=extend$1({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const render=(...t)=>{ensureRenderer().render(...t)},createApp=(...t)=>{const r=ensureRenderer().createApp(...t),{mount:e}=r;return r.mount=n=>{const o=normalizeContainer(n);if(!o)return;const s=r._component;!isFunction$3(s)&&!s.render&&!s.template&&(s.template=o.innerHTML),o.innerHTML="";const a=e(o,!1,o instanceof SVGElement);return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),a},r};function normalizeContainer(t){return isString$2(t)?document.querySelector(t):t}/*!
  * vue-router v4.2.4
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const isBrowser=typeof window<"u";function isESModule(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const assign=Object.assign;function applyToParams(t,r){const e={};for(const n in r){const o=r[n];e[n]=isArray$3(o)?o.map(t):t(o)}return e}const noop$2=()=>{},isArray$3=Array.isArray,TRAILING_SLASH_RE=/\/$/,removeTrailingSlash=t=>t.replace(TRAILING_SLASH_RE,"");function parseURL(t,r,e="/"){let n,o={},s="",a="";const i=r.indexOf("#");let u=r.indexOf("?");return i<u&&i>=0&&(u=-1),u>-1&&(n=r.slice(0,u),s=r.slice(u+1,i>-1?i:r.length),o=t(s)),i>-1&&(n=n||r.slice(0,i),a=r.slice(i,r.length)),n=resolveRelativePath(n??r,e),{fullPath:n+(s&&"?")+s+a,path:n,query:o,hash:a}}function stringifyURL(t,r){const e=r.query?t(r.query):"";return r.path+(e&&"?")+e+(r.hash||"")}function stripBase(t,r){return!r||!t.toLowerCase().startsWith(r.toLowerCase())?t:t.slice(r.length)||"/"}function isSameRouteLocation(t,r,e){const n=r.matched.length-1,o=e.matched.length-1;return n>-1&&n===o&&isSameRouteRecord(r.matched[n],e.matched[o])&&isSameRouteLocationParams(r.params,e.params)&&t(r.query)===t(e.query)&&r.hash===e.hash}function isSameRouteRecord(t,r){return(t.aliasOf||t)===(r.aliasOf||r)}function isSameRouteLocationParams(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const e in t)if(!isSameRouteLocationParamsValue(t[e],r[e]))return!1;return!0}function isSameRouteLocationParamsValue(t,r){return isArray$3(t)?isEquivalentArray(t,r):isArray$3(r)?isEquivalentArray(r,t):t===r}function isEquivalentArray(t,r){return isArray$3(r)?t.length===r.length&&t.every((e,n)=>e===r[n]):t.length===1&&t[0]===r}function resolveRelativePath(t,r){if(t.startsWith("/"))return t;if(!t)return r;const e=r.split("/"),n=t.split("/"),o=n[n.length-1];(o===".."||o===".")&&n.push("");let s=e.length-1,a,i;for(a=0;a<n.length;a++)if(i=n[a],i!==".")if(i==="..")s>1&&s--;else break;return e.slice(0,s).join("/")+"/"+n.slice(a-(a===n.length?1:0)).join("/")}var NavigationType;(function(t){t.pop="pop",t.push="push"})(NavigationType||(NavigationType={}));var NavigationDirection;(function(t){t.back="back",t.forward="forward",t.unknown=""})(NavigationDirection||(NavigationDirection={}));function normalizeBase(t){if(!t)if(isBrowser){const r=document.querySelector("base");t=r&&r.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),removeTrailingSlash(t)}const BEFORE_HASH_RE=/^[^#]+#/;function createHref(t,r){return t.replace(BEFORE_HASH_RE,"#")+r}function getElementPosition(t,r){const e=document.documentElement.getBoundingClientRect(),n=t.getBoundingClientRect();return{behavior:r.behavior,left:n.left-e.left-(r.left||0),top:n.top-e.top-(r.top||0)}}const computeScrollPosition=()=>({left:window.pageXOffset,top:window.pageYOffset});function scrollToPosition(t){let r;if("el"in t){const e=t.el,n=typeof e=="string"&&e.startsWith("#"),o=typeof e=="string"?n?document.getElementById(e.slice(1)):document.querySelector(e):e;if(!o)return;r=getElementPosition(o,t)}else r=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(r):window.scrollTo(r.left!=null?r.left:window.pageXOffset,r.top!=null?r.top:window.pageYOffset)}function getScrollKey(t,r){return(history.state?history.state.position-r:-1)+t}const scrollPositions=new Map;function saveScrollPosition(t,r){scrollPositions.set(t,r)}function getSavedScrollPosition(t){const r=scrollPositions.get(t);return scrollPositions.delete(t),r}let createBaseLocation=()=>location.protocol+"//"+location.host;function createCurrentLocation(t,r){const{pathname:e,search:n,hash:o}=r,s=t.indexOf("#");if(s>-1){let i=o.includes(t.slice(s))?t.slice(s).length:1,u=o.slice(i);return u[0]!=="/"&&(u="/"+u),stripBase(u,"")}return stripBase(e,t)+n+o}function useHistoryListeners(t,r,e,n){let o=[],s=[],a=null;const i=({state:v})=>{const g=createCurrentLocation(t,location),b=e.value,T=r.value;let k=0;if(v){if(e.value=g,r.value=v,a&&a===b){a=null;return}k=T?v.position-T.position:0}else n(g);o.forEach(y=>{y(e.value,b,{delta:k,type:NavigationType.pop,direction:k?k>0?NavigationDirection.forward:NavigationDirection.back:NavigationDirection.unknown})})};function u(){a=e.value}function c(v){o.push(v);const g=()=>{const b=o.indexOf(v);b>-1&&o.splice(b,1)};return s.push(g),g}function d(){const{history:v}=window;v.state&&v.replaceState(assign({},v.state,{scroll:computeScrollPosition()}),"")}function m(){for(const v of s)v();s=[],window.removeEventListener("popstate",i),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",i),window.addEventListener("beforeunload",d,{passive:!0}),{pauseListeners:u,listen:c,destroy:m}}function buildState(t,r,e,n=!1,o=!1){return{back:t,current:r,forward:e,replaced:n,position:window.history.length,scroll:o?computeScrollPosition():null}}function useHistoryStateNavigation(t){const{history:r,location:e}=window,n={value:createCurrentLocation(t,e)},o={value:r.state};o.value||s(n.value,{back:null,current:n.value,forward:null,position:r.length-1,replaced:!0,scroll:null},!0);function s(u,c,d){const m=t.indexOf("#"),v=m>-1?(e.host&&document.querySelector("base")?t:t.slice(m))+u:createBaseLocation()+t+u;try{r[d?"replaceState":"pushState"](c,"",v),o.value=c}catch(g){console.error(g),e[d?"replace":"assign"](v)}}function a(u,c){const d=assign({},r.state,buildState(o.value.back,u,o.value.forward,!0),c,{position:o.value.position});s(u,d,!0),n.value=u}function i(u,c){const d=assign({},o.value,r.state,{forward:u,scroll:computeScrollPosition()});s(d.current,d,!0);const m=assign({},buildState(n.value,u,null),{position:d.position+1},c);s(u,m,!1),n.value=u}return{location:n,state:o,push:i,replace:a}}function createWebHistory(t){t=normalizeBase(t);const r=useHistoryStateNavigation(t),e=useHistoryListeners(t,r.state,r.location,r.replace);function n(s,a=!0){a||e.pauseListeners(),history.go(s)}const o=assign({location:"",base:t,go:n,createHref:createHref.bind(null,t)},r,e);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>r.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>r.state.value}),o}function isRouteLocation(t){return typeof t=="string"||t&&typeof t=="object"}function isRouteName(t){return typeof t=="string"||typeof t=="symbol"}const START_LOCATION_NORMALIZED={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},NavigationFailureSymbol=Symbol("");var NavigationFailureType;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(NavigationFailureType||(NavigationFailureType={}));function createRouterError(t,r){return assign(new Error,{type:t,[NavigationFailureSymbol]:!0},r)}function isNavigationFailure(t,r){return t instanceof Error&&NavigationFailureSymbol in t&&(r==null||!!(t.type&r))}const BASE_PARAM_PATTERN="[^/]+?",BASE_PATH_PARSER_OPTIONS={sensitive:!1,strict:!1,start:!0,end:!0},REGEX_CHARS_RE=/[.+*?^${}()[\]/\\]/g;function tokensToParser(t,r){const e=assign({},BASE_PATH_PARSER_OPTIONS,r),n=[];let o=e.start?"^":"";const s=[];for(const c of t){const d=c.length?[]:[90];e.strict&&!c.length&&(o+="/");for(let m=0;m<c.length;m++){const v=c[m];let g=40+(e.sensitive?.25:0);if(v.type===0)m||(o+="/"),o+=v.value.replace(REGEX_CHARS_RE,"\\$&"),g+=40;else if(v.type===1){const{value:b,repeatable:T,optional:k,regexp:y}=v;s.push({name:b,repeatable:T,optional:k});const A=y||BASE_PARAM_PATTERN;if(A!==BASE_PARAM_PATTERN){g+=10;try{new RegExp(`(${A})`)}catch(he){throw new Error(`Invalid custom RegExp for param "${b}" (${A}): `+he.message)}}let V=T?`((?:${A})(?:/(?:${A}))*)`:`(${A})`;m||(V=k&&c.length<2?`(?:/${V})`:"/"+V),k&&(V+="?"),o+=V,g+=20,k&&(g+=-8),T&&(g+=-20),A===".*"&&(g+=-50)}d.push(g)}n.push(d)}if(e.strict&&e.end){const c=n.length-1;n[c][n[c].length-1]+=.7000000000000001}e.strict||(o+="/?"),e.end?o+="$":e.strict&&(o+="(?:/|$)");const a=new RegExp(o,e.sensitive?"":"i");function i(c){const d=c.match(a),m={};if(!d)return null;for(let v=1;v<d.length;v++){const g=d[v]||"",b=s[v-1];m[b.name]=g&&b.repeatable?g.split("/"):g}return m}function u(c){let d="",m=!1;for(const v of t){(!m||!d.endsWith("/"))&&(d+="/"),m=!1;for(const g of v)if(g.type===0)d+=g.value;else if(g.type===1){const{value:b,repeatable:T,optional:k}=g,y=b in c?c[b]:"";if(isArray$3(y)&&!T)throw new Error(`Provided param "${b}" is an array but it is not repeatable (* or + modifiers)`);const A=isArray$3(y)?y.join("/"):y;if(!A)if(k)v.length<2&&(d.endsWith("/")?d=d.slice(0,-1):m=!0);else throw new Error(`Missing required param "${b}"`);d+=A}}return d||"/"}return{re:a,score:n,keys:s,parse:i,stringify:u}}function compareScoreArray(t,r){let e=0;for(;e<t.length&&e<r.length;){const n=r[e]-t[e];if(n)return n;e++}return t.length<r.length?t.length===1&&t[0]===40+40?-1:1:t.length>r.length?r.length===1&&r[0]===40+40?1:-1:0}function comparePathParserScore(t,r){let e=0;const n=t.score,o=r.score;for(;e<n.length&&e<o.length;){const s=compareScoreArray(n[e],o[e]);if(s)return s;e++}if(Math.abs(o.length-n.length)===1){if(isLastScoreNegative(n))return 1;if(isLastScoreNegative(o))return-1}return o.length-n.length}function isLastScoreNegative(t){const r=t[t.length-1];return t.length>0&&r[r.length-1]<0}const ROOT_TOKEN={type:0,value:""},VALID_PARAM_RE=/[a-zA-Z0-9_]/;function tokenizePath(t){if(!t)return[[]];if(t==="/")return[[ROOT_TOKEN]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function r(g){throw new Error(`ERR (${e})/"${c}": ${g}`)}let e=0,n=e;const o=[];let s;function a(){s&&o.push(s),s=[]}let i=0,u,c="",d="";function m(){c&&(e===0?s.push({type:0,value:c}):e===1||e===2||e===3?(s.length>1&&(u==="*"||u==="+")&&r(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:c,regexp:d,repeatable:u==="*"||u==="+",optional:u==="*"||u==="?"})):r("Invalid state to consume buffer"),c="")}function v(){c+=u}for(;i<t.length;){if(u=t[i++],u==="\\"&&e!==2){n=e,e=4;continue}switch(e){case 0:u==="/"?(c&&m(),a()):u===":"?(m(),e=1):v();break;case 4:v(),e=n;break;case 1:u==="("?e=2:VALID_PARAM_RE.test(u)?v():(m(),e=0,u!=="*"&&u!=="?"&&u!=="+"&&i--);break;case 2:u===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+u:e=3:d+=u;break;case 3:m(),e=0,u!=="*"&&u!=="?"&&u!=="+"&&i--,d="";break;default:r("Unknown state");break}}return e===2&&r(`Unfinished custom RegExp for param "${c}"`),m(),a(),o}function createRouteRecordMatcher(t,r,e){const n=tokensToParser(tokenizePath(t.path),e),o=assign(n,{record:t,parent:r,children:[],alias:[]});return r&&!o.record.aliasOf==!r.record.aliasOf&&r.children.push(o),o}function createRouterMatcher(t,r){const e=[],n=new Map;r=mergeOptions({strict:!1,end:!0,sensitive:!1},r);function o(d){return n.get(d)}function s(d,m,v){const g=!v,b=normalizeRouteRecord(d);b.aliasOf=v&&v.record;const T=mergeOptions(r,d),k=[b];if("alias"in d){const V=typeof d.alias=="string"?[d.alias]:d.alias;for(const he of V)k.push(assign({},b,{components:v?v.record.components:b.components,path:he,aliasOf:v?v.record:b}))}let y,A;for(const V of k){const{path:he}=V;if(m&&he[0]!=="/"){const ae=m.record.path,Ne=ae[ae.length-1]==="/"?"":"/";V.path=m.record.path+(he&&Ne+he)}if(y=createRouteRecordMatcher(V,m,T),v?v.alias.push(y):(A=A||y,A!==y&&A.alias.push(y),g&&d.name&&!isAliasRecord(y)&&a(d.name)),b.children){const ae=b.children;for(let Ne=0;Ne<ae.length;Ne++)s(ae[Ne],y,v&&v.children[Ne])}v=v||y,(y.record.components&&Object.keys(y.record.components).length||y.record.name||y.record.redirect)&&u(y)}return A?()=>{a(A)}:noop$2}function a(d){if(isRouteName(d)){const m=n.get(d);m&&(n.delete(d),e.splice(e.indexOf(m),1),m.children.forEach(a),m.alias.forEach(a))}else{const m=e.indexOf(d);m>-1&&(e.splice(m,1),d.record.name&&n.delete(d.record.name),d.children.forEach(a),d.alias.forEach(a))}}function i(){return e}function u(d){let m=0;for(;m<e.length&&comparePathParserScore(d,e[m])>=0&&(d.record.path!==e[m].record.path||!isRecordChildOf(d,e[m]));)m++;e.splice(m,0,d),d.record.name&&!isAliasRecord(d)&&n.set(d.record.name,d)}function c(d,m){let v,g={},b,T;if("name"in d&&d.name){if(v=n.get(d.name),!v)throw createRouterError(1,{location:d});T=v.record.name,g=assign(paramsFromLocation(m.params,v.keys.filter(A=>!A.optional).map(A=>A.name)),d.params&&paramsFromLocation(d.params,v.keys.map(A=>A.name))),b=v.stringify(g)}else if("path"in d)b=d.path,v=e.find(A=>A.re.test(b)),v&&(g=v.parse(b),T=v.record.name);else{if(v=m.name?n.get(m.name):e.find(A=>A.re.test(m.path)),!v)throw createRouterError(1,{location:d,currentLocation:m});T=v.record.name,g=assign({},m.params,d.params),b=v.stringify(g)}const k=[];let y=v;for(;y;)k.unshift(y.record),y=y.parent;return{name:T,path:b,params:g,matched:k,meta:mergeMetaFields(k)}}return t.forEach(d=>s(d)),{addRoute:s,resolve:c,removeRoute:a,getRoutes:i,getRecordMatcher:o}}function paramsFromLocation(t,r){const e={};for(const n of r)n in t&&(e[n]=t[n]);return e}function normalizeRouteRecord(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:normalizeRecordProps(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function normalizeRecordProps(t){const r={},e=t.props||!1;if("component"in t)r.default=e;else for(const n in t.components)r[n]=typeof e=="object"?e[n]:e;return r}function isAliasRecord(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function mergeMetaFields(t){return t.reduce((r,e)=>assign(r,e.meta),{})}function mergeOptions(t,r){const e={};for(const n in t)e[n]=n in r?r[n]:t[n];return e}function isRecordChildOf(t,r){return r.children.some(e=>e===t||isRecordChildOf(t,e))}const HASH_RE=/#/g,AMPERSAND_RE=/&/g,SLASH_RE=/\//g,EQUAL_RE=/=/g,IM_RE=/\?/g,PLUS_RE=/\+/g,ENC_BRACKET_OPEN_RE=/%5B/g,ENC_BRACKET_CLOSE_RE=/%5D/g,ENC_CARET_RE=/%5E/g,ENC_BACKTICK_RE=/%60/g,ENC_CURLY_OPEN_RE=/%7B/g,ENC_PIPE_RE=/%7C/g,ENC_CURLY_CLOSE_RE=/%7D/g,ENC_SPACE_RE=/%20/g;function commonEncode(t){return encodeURI(""+t).replace(ENC_PIPE_RE,"|").replace(ENC_BRACKET_OPEN_RE,"[").replace(ENC_BRACKET_CLOSE_RE,"]")}function encodeHash(t){return commonEncode(t).replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryValue(t){return commonEncode(t).replace(PLUS_RE,"%2B").replace(ENC_SPACE_RE,"+").replace(HASH_RE,"%23").replace(AMPERSAND_RE,"%26").replace(ENC_BACKTICK_RE,"`").replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryKey(t){return encodeQueryValue(t).replace(EQUAL_RE,"%3D")}function encodePath(t){return commonEncode(t).replace(HASH_RE,"%23").replace(IM_RE,"%3F")}function encodeParam(t){return t==null?"":encodePath(t).replace(SLASH_RE,"%2F")}function decode(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function parseQuery(t){const r={};if(t===""||t==="?")return r;const n=(t[0]==="?"?t.slice(1):t).split("&");for(let o=0;o<n.length;++o){const s=n[o].replace(PLUS_RE," "),a=s.indexOf("="),i=decode(a<0?s:s.slice(0,a)),u=a<0?null:decode(s.slice(a+1));if(i in r){let c=r[i];isArray$3(c)||(c=r[i]=[c]),c.push(u)}else r[i]=u}return r}function stringifyQuery(t){let r="";for(let e in t){const n=t[e];if(e=encodeQueryKey(e),n==null){n!==void 0&&(r+=(r.length?"&":"")+e);continue}(isArray$3(n)?n.map(s=>s&&encodeQueryValue(s)):[n&&encodeQueryValue(n)]).forEach(s=>{s!==void 0&&(r+=(r.length?"&":"")+e,s!=null&&(r+="="+s))})}return r}function normalizeQuery(t){const r={};for(const e in t){const n=t[e];n!==void 0&&(r[e]=isArray$3(n)?n.map(o=>o==null?null:""+o):n==null?n:""+n)}return r}const matchedRouteKey=Symbol(""),viewDepthKey=Symbol(""),routerKey=Symbol(""),routeLocationKey=Symbol(""),routerViewLocationKey=Symbol("");function useCallbacks(){let t=[];function r(n){return t.push(n),()=>{const o=t.indexOf(n);o>-1&&t.splice(o,1)}}function e(){t=[]}return{add:r,list:()=>t.slice(),reset:e}}function guardToPromiseFn(t,r,e,n,o){const s=n&&(n.enterCallbacks[o]=n.enterCallbacks[o]||[]);return()=>new Promise((a,i)=>{const u=m=>{m===!1?i(createRouterError(4,{from:e,to:r})):m instanceof Error?i(m):isRouteLocation(m)?i(createRouterError(2,{from:r,to:m})):(s&&n.enterCallbacks[o]===s&&typeof m=="function"&&s.push(m),a())},c=t.call(n&&n.instances[o],r,e,u);let d=Promise.resolve(c);t.length<3&&(d=d.then(u)),d.catch(m=>i(m))})}function extractComponentsGuards(t,r,e,n){const o=[];for(const s of t)for(const a in s.components){let i=s.components[a];if(!(r!=="beforeRouteEnter"&&!s.instances[a]))if(isRouteComponent(i)){const c=(i.__vccOpts||i)[r];c&&o.push(guardToPromiseFn(c,e,n,s,a))}else{let u=i();o.push(()=>u.then(c=>{if(!c)return Promise.reject(new Error(`Couldn't resolve component "${a}" at "${s.path}"`));const d=isESModule(c)?c.default:c;s.components[a]=d;const v=(d.__vccOpts||d)[r];return v&&guardToPromiseFn(v,e,n,s,a)()}))}}return o}function isRouteComponent(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function useLink(t){const r=inject(routerKey),e=inject(routeLocationKey),n=computed(()=>r.resolve(unref(t.to))),o=computed(()=>{const{matched:u}=n.value,{length:c}=u,d=u[c-1],m=e.matched;if(!d||!m.length)return-1;const v=m.findIndex(isSameRouteRecord.bind(null,d));if(v>-1)return v;const g=getOriginalPath(u[c-2]);return c>1&&getOriginalPath(d)===g&&m[m.length-1].path!==g?m.findIndex(isSameRouteRecord.bind(null,u[c-2])):v}),s=computed(()=>o.value>-1&&includesParams(e.params,n.value.params)),a=computed(()=>o.value>-1&&o.value===e.matched.length-1&&isSameRouteLocationParams(e.params,n.value.params));function i(u={}){return guardEvent(u)?r[unref(t.replace)?"replace":"push"](unref(t.to)).catch(noop$2):Promise.resolve()}return{route:n,href:computed(()=>n.value.href),isActive:s,isExactActive:a,navigate:i}}const RouterLinkImpl=defineComponent({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink,setup(t,{slots:r}){const e=reactive(useLink(t)),{options:n}=inject(routerKey),o=computed(()=>({[getLinkClass(t.activeClass,n.linkActiveClass,"router-link-active")]:e.isActive,[getLinkClass(t.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:e.isExactActive}));return()=>{const s=r.default&&r.default(e);return t.custom?s:h("a",{"aria-current":e.isExactActive?t.ariaCurrentValue:null,href:e.href,onClick:e.navigate,class:o.value},s)}}}),RouterLink=RouterLinkImpl;function guardEvent(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const r=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(r))return}return t.preventDefault&&t.preventDefault(),!0}}function includesParams(t,r){for(const e in r){const n=r[e],o=t[e];if(typeof n=="string"){if(n!==o)return!1}else if(!isArray$3(o)||o.length!==n.length||n.some((s,a)=>s!==o[a]))return!1}return!0}function getOriginalPath(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const getLinkClass=(t,r,e)=>t??r??e,RouterViewImpl=defineComponent({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:r,slots:e}){const n=inject(routerViewLocationKey),o=computed(()=>t.route||n.value),s=inject(viewDepthKey,0),a=computed(()=>{let c=unref(s);const{matched:d}=o.value;let m;for(;(m=d[c])&&!m.components;)c++;return c}),i=computed(()=>o.value.matched[a.value]);provide(viewDepthKey,computed(()=>a.value+1)),provide(matchedRouteKey,i),provide(routerViewLocationKey,o);const u=ref();return watch(()=>[u.value,i.value,t.name],([c,d,m],[v,g,b])=>{d&&(d.instances[m]=c,g&&g!==d&&c&&c===v&&(d.leaveGuards.size||(d.leaveGuards=g.leaveGuards),d.updateGuards.size||(d.updateGuards=g.updateGuards))),c&&d&&(!g||!isSameRouteRecord(d,g)||!v)&&(d.enterCallbacks[m]||[]).forEach(T=>T(c))},{flush:"post"}),()=>{const c=o.value,d=t.name,m=i.value,v=m&&m.components[d];if(!v)return normalizeSlot(e.default,{Component:v,route:c});const g=m.props[d],b=g?g===!0?c.params:typeof g=="function"?g(c):g:null,k=h(v,assign({},b,r,{onVnodeUnmounted:y=>{y.component.isUnmounted&&(m.instances[d]=null)},ref:u}));return normalizeSlot(e.default,{Component:k,route:c})||k}}});function normalizeSlot(t,r){if(!t)return null;const e=t(r);return e.length===1?e[0]:e}const RouterView=RouterViewImpl;function createRouter(t){const r=createRouterMatcher(t.routes,t),e=t.parseQuery||parseQuery,n=t.stringifyQuery||stringifyQuery,o=t.history,s=useCallbacks(),a=useCallbacks(),i=useCallbacks(),u=shallowRef(START_LOCATION_NORMALIZED);let c=START_LOCATION_NORMALIZED;isBrowser&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=applyToParams.bind(null,$e=>""+$e),m=applyToParams.bind(null,encodeParam),v=applyToParams.bind(null,decode);function g($e,er){let nr,Pt;return isRouteName($e)?(nr=r.getRecordMatcher($e),Pt=er):Pt=$e,r.addRoute(Pt,nr)}function b($e){const er=r.getRecordMatcher($e);er&&r.removeRoute(er)}function T(){return r.getRoutes().map($e=>$e.record)}function k($e){return!!r.getRecordMatcher($e)}function y($e,er){if(er=assign({},er||u.value),typeof $e=="string"){const cr=parseURL(e,$e,er.path),mr=r.resolve({path:cr.path},er),yr=o.createHref(cr.fullPath);return assign(cr,mr,{params:v(mr.params),hash:decode(cr.hash),redirectedFrom:void 0,href:yr})}let nr;if("path"in $e)nr=assign({},$e,{path:parseURL(e,$e.path,er.path).path});else{const cr=assign({},$e.params);for(const mr in cr)cr[mr]==null&&delete cr[mr];nr=assign({},$e,{params:m(cr)}),er.params=m(er.params)}const Pt=r.resolve(nr,er),rr=$e.hash||"";Pt.params=d(v(Pt.params));const kt=stringifyURL(n,assign({},$e,{hash:encodeHash(rr),path:Pt.path})),Et=o.createHref(kt);return assign({fullPath:kt,hash:rr,query:n===stringifyQuery?normalizeQuery($e.query):$e.query||{}},Pt,{redirectedFrom:void 0,href:Et})}function A($e){return typeof $e=="string"?parseURL(e,$e,u.value.path):assign({},$e)}function V($e,er){if(c!==$e)return createRouterError(8,{from:er,to:$e})}function he($e){return _e($e)}function ae($e){return he(assign(A($e),{replace:!0}))}function Ne($e){const er=$e.matched[$e.matched.length-1];if(er&&er.redirect){const{redirect:nr}=er;let Pt=typeof nr=="function"?nr($e):nr;return typeof Pt=="string"&&(Pt=Pt.includes("?")||Pt.includes("#")?Pt=A(Pt):{path:Pt},Pt.params={}),assign({query:$e.query,hash:$e.hash,params:"path"in Pt?{}:$e.params},Pt)}}function _e($e,er){const nr=c=y($e),Pt=u.value,rr=$e.state,kt=$e.force,Et=$e.replace===!0,cr=Ne(nr);if(cr)return _e(assign(A(cr),{state:typeof cr=="object"?assign({},rr,cr.state):rr,force:kt,replace:Et}),er||nr);const mr=nr;mr.redirectedFrom=er;let yr;return!kt&&isSameRouteLocation(n,Pt,nr)&&(yr=createRouterError(16,{to:mr,from:Pt}),fr(Pt,Pt,!0,!1)),(yr?Promise.resolve(yr):ue(mr,Pt)).catch(Tr=>isNavigationFailure(Tr)?isNavigationFailure(Tr,2)?Tr:dr(Tr):Dt(Tr,mr,Pt)).then(Tr=>{if(Tr){if(isNavigationFailure(Tr,2))return _e(assign({replace:Et},A(Tr.to),{state:typeof Tr.to=="object"?assign({},rr,Tr.to.state):rr,force:kt}),er||mr)}else Tr=le(mr,Pt,!0,Et,rr);return ze(mr,Pt,Tr),Tr})}function Ce($e,er){const nr=V($e,er);return nr?Promise.reject(nr):Promise.resolve()}function re($e){const er=Fe.values().next().value;return er&&typeof er.runWithContext=="function"?er.runWithContext($e):$e()}function ue($e,er){let nr;const[Pt,rr,kt]=extractChangingRecords($e,er);nr=extractComponentsGuards(Pt.reverse(),"beforeRouteLeave",$e,er);for(const cr of Pt)cr.leaveGuards.forEach(mr=>{nr.push(guardToPromiseFn(mr,$e,er))});const Et=Ce.bind(null,$e,er);return nr.push(Et),ir(nr).then(()=>{nr=[];for(const cr of s.list())nr.push(guardToPromiseFn(cr,$e,er));return nr.push(Et),ir(nr)}).then(()=>{nr=extractComponentsGuards(rr,"beforeRouteUpdate",$e,er);for(const cr of rr)cr.updateGuards.forEach(mr=>{nr.push(guardToPromiseFn(mr,$e,er))});return nr.push(Et),ir(nr)}).then(()=>{nr=[];for(const cr of kt)if(cr.beforeEnter)if(isArray$3(cr.beforeEnter))for(const mr of cr.beforeEnter)nr.push(guardToPromiseFn(mr,$e,er));else nr.push(guardToPromiseFn(cr.beforeEnter,$e,er));return nr.push(Et),ir(nr)}).then(()=>($e.matched.forEach(cr=>cr.enterCallbacks={}),nr=extractComponentsGuards(kt,"beforeRouteEnter",$e,er),nr.push(Et),ir(nr))).then(()=>{nr=[];for(const cr of a.list())nr.push(guardToPromiseFn(cr,$e,er));return nr.push(Et),ir(nr)}).catch(cr=>isNavigationFailure(cr,8)?cr:Promise.reject(cr))}function ze($e,er,nr){i.list().forEach(Pt=>re(()=>Pt($e,er,nr)))}function le($e,er,nr,Pt,rr){const kt=V($e,er);if(kt)return kt;const Et=er===START_LOCATION_NORMALIZED,cr=isBrowser?history.state:{};nr&&(Pt||Et?o.replace($e.fullPath,assign({scroll:Et&&cr&&cr.scroll},rr)):o.push($e.fullPath,rr)),u.value=$e,fr($e,er,nr,Et),dr()}let de;function Ie(){de||(de=o.listen(($e,er,nr)=>{if(!or.listening)return;const Pt=y($e),rr=Ne(Pt);if(rr){_e(assign(rr,{replace:!0}),Pt).catch(noop$2);return}c=Pt;const kt=u.value;isBrowser&&saveScrollPosition(getScrollKey(kt.fullPath,nr.delta),computeScrollPosition()),ue(Pt,kt).catch(Et=>isNavigationFailure(Et,12)?Et:isNavigationFailure(Et,2)?(_e(Et.to,Pt).then(cr=>{isNavigationFailure(cr,20)&&!nr.delta&&nr.type===NavigationType.pop&&o.go(-1,!1)}).catch(noop$2),Promise.reject()):(nr.delta&&o.go(-nr.delta,!1),Dt(Et,Pt,kt))).then(Et=>{Et=Et||le(Pt,kt,!1),Et&&(nr.delta&&!isNavigationFailure(Et,8)?o.go(-nr.delta,!1):nr.type===NavigationType.pop&&isNavigationFailure(Et,20)&&o.go(-1,!1)),ze(Pt,kt,Et)}).catch(noop$2)}))}let ie=useCallbacks(),Ve=useCallbacks(),Ue;function Dt($e,er,nr){dr($e);const Pt=Ve.list();return Pt.length?Pt.forEach(rr=>rr($e,er,nr)):console.error($e),Promise.reject($e)}function tr(){return Ue&&u.value!==START_LOCATION_NORMALIZED?Promise.resolve():new Promise(($e,er)=>{ie.add([$e,er])})}function dr($e){return Ue||(Ue=!$e,Ie(),ie.list().forEach(([er,nr])=>$e?nr($e):er()),ie.reset()),$e}function fr($e,er,nr,Pt){const{scrollBehavior:rr}=t;if(!isBrowser||!rr)return Promise.resolve();const kt=!nr&&getSavedScrollPosition(getScrollKey($e.fullPath,0))||(Pt||!nr)&&history.state&&history.state.scroll||null;return nextTick().then(()=>rr($e,er,kt)).then(Et=>Et&&scrollToPosition(Et)).catch(Et=>Dt(Et,$e,er))}const sr=$e=>o.go($e);let hr;const Fe=new Set,or={currentRoute:u,listening:!0,addRoute:g,removeRoute:b,hasRoute:k,getRoutes:T,resolve:y,options:t,push:he,replace:ae,go:sr,back:()=>sr(-1),forward:()=>sr(1),beforeEach:s.add,beforeResolve:a.add,afterEach:i.add,onError:Ve.add,isReady:tr,install($e){const er=this;$e.component("RouterLink",RouterLink),$e.component("RouterView",RouterView),$e.config.globalProperties.$router=er,Object.defineProperty($e.config.globalProperties,"$route",{enumerable:!0,get:()=>unref(u)}),isBrowser&&!hr&&u.value===START_LOCATION_NORMALIZED&&(hr=!0,he(o.location).catch(rr=>{}));const nr={};for(const rr in START_LOCATION_NORMALIZED)Object.defineProperty(nr,rr,{get:()=>u.value[rr],enumerable:!0});$e.provide(routerKey,er),$e.provide(routeLocationKey,shallowReactive(nr)),$e.provide(routerViewLocationKey,u);const Pt=$e.unmount;Fe.add($e),$e.unmount=function(){Fe.delete($e),Fe.size<1&&(c=START_LOCATION_NORMALIZED,de&&de(),de=null,u.value=START_LOCATION_NORMALIZED,hr=!1,Ue=!1),Pt()}}};function ir($e){return $e.reduce((er,nr)=>er.then(()=>re(nr)),Promise.resolve())}return or}function extractChangingRecords(t,r){const e=[],n=[],o=[],s=Math.max(r.matched.length,t.matched.length);for(let a=0;a<s;a++){const i=r.matched[a];i&&(t.matched.find(c=>isSameRouteRecord(c,i))?n.push(i):e.push(i));const u=t.matched[a];u&&(r.matched.find(c=>isSameRouteRecord(c,u))||o.push(u))}return[e,n,o]}function useRouter(){return inject(routerKey)}const FOCUSABLE_ELEMENT_SELECTORS='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',isVisible=t=>getComputedStyle(t).position==="fixed"?!1:t.offsetParent!==null,obtainAllFocusableElements$1=t=>Array.from(t.querySelectorAll(FOCUSABLE_ELEMENT_SELECTORS)).filter(r=>isFocusable(r)&&isVisible(r)),isFocusable=t=>{if(t.tabIndex>0||t.tabIndex===0&&t.getAttribute("tabIndex")!==null)return!0;if(t.disabled)return!1;switch(t.nodeName){case"A":return!!t.href&&t.rel!=="ignore";case"INPUT":return!(t.type==="hidden"||t.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},isLeaf=t=>!t.getAttribute("aria-owns"),getSibling=(t,r,e)=>{const{parentNode:n}=t;if(!n)return null;const o=n.querySelectorAll(e),s=Array.prototype.indexOf.call(o,t);return o[s+r]||null},focusNode=t=>{t&&(t.focus(),!isLeaf(t)&&t.click())},composeEventHandlers=(t,r,{checkForDefaultPrevented:e=!0}={})=>o=>{const s=t==null?void 0:t(o);if(e===!1||!s)return r==null?void 0:r(o)},whenMouse=t=>r=>r.pointerType==="mouse"?t(r):void 0;var _a;const isClient=typeof window<"u",isDef=t=>typeof t<"u",isFunction$2=t=>typeof t=="function",isString$1=t=>typeof t=="string",noop$1=()=>{},isIOS=isClient&&((_a=window==null?void 0:window.navigator)==null?void 0:_a.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function resolveUnref(t){return typeof t=="function"?t():unref(t)}function createFilterWrapper(t,r){function e(...n){return new Promise((o,s)=>{Promise.resolve(t(()=>r.apply(this,n),{fn:r,thisArg:this,args:n})).then(o).catch(s)})}return e}function debounceFilter(t,r={}){let e,n,o=noop$1;const s=i=>{clearTimeout(i),o(),o=noop$1};return i=>{const u=resolveUnref(t),c=resolveUnref(r.maxWait);return e&&s(e),u<=0||c!==void 0&&c<=0?(n&&(s(n),n=null),Promise.resolve(i())):new Promise((d,m)=>{o=r.rejectOnCancel?m:d,c&&!n&&(n=setTimeout(()=>{e&&s(e),n=null,d(i())},c)),e=setTimeout(()=>{n&&s(n),n=null,d(i())},u)})}}function throttleFilter(t,r=!0,e=!0,n=!1){let o=0,s,a=!0,i=noop$1,u;const c=()=>{s&&(clearTimeout(s),s=void 0,i(),i=noop$1)};return m=>{const v=resolveUnref(t),g=Date.now()-o,b=()=>u=m();return c(),v<=0?(o=Date.now(),b()):(g>v&&(e||!a)?(o=Date.now(),b()):r&&(u=new Promise((T,k)=>{i=n?k:T,s=setTimeout(()=>{o=Date.now(),a=!0,T(b()),c()},Math.max(0,v-g))})),!e&&!s&&(s=setTimeout(()=>a=!0,v)),a=!1,u)}}function identity$1(t){return t}function tryOnScopeDispose(t){return getCurrentScope()?(onScopeDispose(t),!0):!1}function useDebounceFn(t,r=200,e={}){return createFilterWrapper(debounceFilter(r,e),t)}function refDebounced(t,r=200,e={}){const n=ref(t.value),o=useDebounceFn(()=>{n.value=t.value},r,e);return watch(t,()=>o()),n}function useThrottleFn(t,r=200,e=!1,n=!0,o=!1){return createFilterWrapper(throttleFilter(r,e,n,o),t)}function tryOnMounted(t,r=!0){getCurrentInstance()?onMounted(t):r?t():nextTick(t)}function useTimeoutFn(t,r,e={}){const{immediate:n=!0}=e,o=ref(!1);let s=null;function a(){s&&(clearTimeout(s),s=null)}function i(){o.value=!1,a()}function u(...c){a(),o.value=!0,s=setTimeout(()=>{o.value=!1,s=null,t(...c)},resolveUnref(r))}return n&&(o.value=!0,isClient&&u()),tryOnScopeDispose(i),{isPending:readonly(o),start:u,stop:i}}function unrefElement(t){var r;const e=resolveUnref(t);return(r=e==null?void 0:e.$el)!=null?r:e}const defaultWindow=isClient?window:void 0;function useEventListener(...t){let r,e,n,o;if(isString$1(t[0])||Array.isArray(t[0])?([e,n,o]=t,r=defaultWindow):[r,e,n,o]=t,!r)return noop$1;Array.isArray(e)||(e=[e]),Array.isArray(n)||(n=[n]);const s=[],a=()=>{s.forEach(d=>d()),s.length=0},i=(d,m,v,g)=>(d.addEventListener(m,v,g),()=>d.removeEventListener(m,v,g)),u=watch(()=>[unrefElement(r),resolveUnref(o)],([d,m])=>{a(),d&&s.push(...e.flatMap(v=>n.map(g=>i(d,v,g,m))))},{immediate:!0,flush:"post"}),c=()=>{u(),a()};return tryOnScopeDispose(c),c}let _iOSWorkaround=!1;function onClickOutside(t,r,e={}){const{window:n=defaultWindow,ignore:o=[],capture:s=!0,detectIframe:a=!1}=e;if(!n)return;isIOS&&!_iOSWorkaround&&(_iOSWorkaround=!0,Array.from(n.document.body.children).forEach(v=>v.addEventListener("click",noop$1)));let i=!0;const u=v=>o.some(g=>{if(typeof g=="string")return Array.from(n.document.querySelectorAll(g)).some(b=>b===v.target||v.composedPath().includes(b));{const b=unrefElement(g);return b&&(v.target===b||v.composedPath().includes(b))}}),d=[useEventListener(n,"click",v=>{const g=unrefElement(t);if(!(!g||g===v.target||v.composedPath().includes(g))){if(v.detail===0&&(i=!u(v)),!i){i=!0;return}r(v)}},{passive:!0,capture:s}),useEventListener(n,"pointerdown",v=>{const g=unrefElement(t);g&&(i=!v.composedPath().includes(g)&&!u(v))},{passive:!0}),a&&useEventListener(n,"blur",v=>{var g;const b=unrefElement(t);((g=n.document.activeElement)==null?void 0:g.tagName)==="IFRAME"&&!(b!=null&&b.contains(n.document.activeElement))&&r(v)})].filter(Boolean);return()=>d.forEach(v=>v())}function useSupported(t,r=!1){const e=ref(),n=()=>e.value=!!t();return n(),tryOnMounted(n,r),e}function cloneFnJSON(t){return JSON.parse(JSON.stringify(t))}const _global$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},globalKey="__vueuse_ssr_handlers__";_global$1[globalKey]=_global$1[globalKey]||{};function useCssVar(t,r,{window:e=defaultWindow,initialValue:n=""}={}){const o=ref(n),s=computed(()=>{var a;return unrefElement(r)||((a=e==null?void 0:e.document)==null?void 0:a.documentElement)});return watch([s,()=>resolveUnref(t)],([a,i])=>{var u;if(a&&e){const c=(u=e.getComputedStyle(a).getPropertyValue(i))==null?void 0:u.trim();o.value=c||n}},{immediate:!0}),watch(o,a=>{var i;(i=s.value)!=null&&i.style&&s.value.style.setProperty(resolveUnref(t),a)}),o}var __getOwnPropSymbols$g=Object.getOwnPropertySymbols,__hasOwnProp$g=Object.prototype.hasOwnProperty,__propIsEnum$g=Object.prototype.propertyIsEnumerable,__objRest$2=(t,r)=>{var e={};for(var n in t)__hasOwnProp$g.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&__getOwnPropSymbols$g)for(var n of __getOwnPropSymbols$g(t))r.indexOf(n)<0&&__propIsEnum$g.call(t,n)&&(e[n]=t[n]);return e};function useResizeObserver(t,r,e={}){const n=e,{window:o=defaultWindow}=n,s=__objRest$2(n,["window"]);let a;const i=useSupported(()=>o&&"ResizeObserver"in o),u=()=>{a&&(a.disconnect(),a=void 0)},c=watch(()=>unrefElement(t),m=>{u(),i.value&&o&&m&&(a=new ResizeObserver(r),a.observe(m,s))},{immediate:!0,flush:"post"}),d=()=>{u(),c()};return tryOnScopeDispose(d),{isSupported:i,stop:d}}function useElementBounding(t,r={}){const{reset:e=!0,windowResize:n=!0,windowScroll:o=!0,immediate:s=!0}=r,a=ref(0),i=ref(0),u=ref(0),c=ref(0),d=ref(0),m=ref(0),v=ref(0),g=ref(0);function b(){const T=unrefElement(t);if(!T){e&&(a.value=0,i.value=0,u.value=0,c.value=0,d.value=0,m.value=0,v.value=0,g.value=0);return}const k=T.getBoundingClientRect();a.value=k.height,i.value=k.bottom,u.value=k.left,c.value=k.right,d.value=k.top,m.value=k.width,v.value=k.x,g.value=k.y}return useResizeObserver(t,b),watch(()=>unrefElement(t),T=>!T&&b()),o&&useEventListener("scroll",b,{capture:!0,passive:!0}),n&&useEventListener("resize",b,{passive:!0}),tryOnMounted(()=>{s&&b()}),{height:a,bottom:i,left:u,right:c,top:d,width:m,x:v,y:g,update:b}}var SwipeDirection;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(SwipeDirection||(SwipeDirection={}));var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(t,r,e)=>r in t?__defProp(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,__spreadValues=(t,r)=>{for(var e in r||(r={}))__hasOwnProp.call(r,e)&&__defNormalProp(t,e,r[e]);if(__getOwnPropSymbols)for(var e of __getOwnPropSymbols(r))__propIsEnum.call(r,e)&&__defNormalProp(t,e,r[e]);return t};const _TransitionPresets={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};__spreadValues({linear:identity$1},_TransitionPresets);function useVModel(t,r,e,n={}){var o,s,a;const{clone:i=!1,passive:u=!1,eventName:c,deep:d=!1,defaultValue:m}=n,v=getCurrentInstance(),g=e||(v==null?void 0:v.emit)||((o=v==null?void 0:v.$emit)==null?void 0:o.bind(v))||((a=(s=v==null?void 0:v.proxy)==null?void 0:s.$emit)==null?void 0:a.bind(v==null?void 0:v.proxy));let b=c;r||(r="modelValue"),b=c||b||`update:${r.toString()}`;const T=y=>i?isFunction$2(i)?i(y):cloneFnJSON(y):y,k=()=>isDef(t[r])?T(t[r]):m;if(u){const y=k(),A=ref(y);return watch(()=>t[r],V=>A.value=T(V)),watch(A,V=>{(V!==t[r]||d)&&g(b,V)},{deep:d}),A}else return computed({get(){return k()},set(y){g(b,y)}})}function useWindowSize(t={}){const{window:r=defaultWindow,initialWidth:e=1/0,initialHeight:n=1/0,listenOrientation:o=!0,includeScrollbar:s=!0}=t,a=ref(e),i=ref(n),u=()=>{r&&(s?(a.value=r.innerWidth,i.value=r.innerHeight):(a.value=r.document.documentElement.clientWidth,i.value=r.document.documentElement.clientHeight))};return u(),tryOnMounted(u),useEventListener("resize",u,{passive:!0}),o&&useEventListener("orientationchange",u,{passive:!0}),{width:a,height:i}}const isFirefox=()=>isClient&&/firefox/i.test(window.navigator.userAgent),isInContainer=(t,r)=>{if(!isClient||!t||!r)return!1;const e=t.getBoundingClientRect();let n;return r instanceof Element?n=r.getBoundingClientRect():n={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},e.top<n.bottom&&e.bottom>n.top&&e.right>n.left&&e.left<n.right};var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global;const freeGlobal$1=freeGlobal;var freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal$1||freeSelf||Function("return this")();const root$1=root;var Symbol$1=root$1.Symbol;const Symbol$2=Symbol$1;var objectProto$e=Object.prototype,hasOwnProperty$c=objectProto$e.hasOwnProperty,nativeObjectToString$1=objectProto$e.toString,symToStringTag$1=Symbol$2?Symbol$2.toStringTag:void 0;function getRawTag(t){var r=hasOwnProperty$c.call(t,symToStringTag$1),e=t[symToStringTag$1];try{t[symToStringTag$1]=void 0;var n=!0}catch{}var o=nativeObjectToString$1.call(t);return n&&(r?t[symToStringTag$1]=e:delete t[symToStringTag$1]),o}var objectProto$d=Object.prototype,nativeObjectToString=objectProto$d.toString;function objectToString(t){return nativeObjectToString.call(t)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$2?Symbol$2.toStringTag:void 0;function baseGetTag(t){return t==null?t===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(t)?getRawTag(t):objectToString(t)}function isObjectLike(t){return t!=null&&typeof t=="object"}var symbolTag$3="[object Symbol]";function isSymbol(t){return typeof t=="symbol"||isObjectLike(t)&&baseGetTag(t)==symbolTag$3}function arrayMap(t,r){for(var e=-1,n=t==null?0:t.length,o=Array(n);++e<n;)o[e]=r(t[e],e,t);return o}var isArray$1=Array.isArray;const isArray$2=isArray$1;var INFINITY$3=1/0,symbolProto$2=Symbol$2?Symbol$2.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(t){if(typeof t=="string")return t;if(isArray$2(t))return arrayMap(t,baseToString)+"";if(isSymbol(t))return symbolToString?symbolToString.call(t):"";var r=t+"";return r=="0"&&1/t==-INFINITY$3?"-0":r}var reWhitespace=/\s/;function trimmedEndIndex(t){for(var r=t.length;r--&&reWhitespace.test(t.charAt(r)););return r}var reTrimStart=/^\s+/;function baseTrim(t){return t&&t.slice(0,trimmedEndIndex(t)+1).replace(reTrimStart,"")}function isObject$1(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}var NAN=0/0,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(t){if(typeof t=="number")return t;if(isSymbol(t))return NAN;if(isObject$1(t)){var r=typeof t.valueOf=="function"?t.valueOf():t;t=isObject$1(r)?r+"":r}if(typeof t!="string")return t===0?t:+t;t=baseTrim(t);var e=reIsBinary.test(t);return e||reIsOctal.test(t)?freeParseInt(t.slice(2),e?2:8):reIsBadHex.test(t)?NAN:+t}var INFINITY$2=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(t){if(!t)return t===0?t:0;if(t=toNumber(t),t===INFINITY$2||t===-INFINITY$2){var r=t<0?-1:1;return r*MAX_INTEGER}return t===t?t:0}function toInteger(t){var r=toFinite(t),e=r%1;return r===r?e?r-e:r:0}function identity(t){return t}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$1(t){if(!isObject$1(t))return!1;var r=baseGetTag(t);return r==funcTag$2||r==genTag$1||r==asyncTag||r==proxyTag}var coreJsData=root$1["__core-js_shared__"];const coreJsData$1=coreJsData;var maskSrcKey=function(){var t=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function isMasked(t){return!!maskSrcKey&&maskSrcKey in t}var funcProto$1=Function.prototype,funcToString$1=funcProto$1.toString;function toSource(t){if(t!=null){try{return funcToString$1.call(t)}catch{}try{return t+""}catch{}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto$c=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$b=objectProto$c.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty$b).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(t){if(!isObject$1(t)||isMasked(t))return!1;var r=isFunction$1(t)?reIsNative:reIsHostCtor;return r.test(toSource(t))}function getValue$1(t,r){return t==null?void 0:t[r]}function getNative(t,r){var e=getValue$1(t,r);return baseIsNative(e)?e:void 0}var WeakMap$1=getNative(root$1,"WeakMap");const WeakMap$2=WeakMap$1;var objectCreate=Object.create,baseCreate=function(){function t(){}return function(r){if(!isObject$1(r))return{};if(objectCreate)return objectCreate(r);t.prototype=r;var e=new t;return t.prototype=void 0,e}}();const baseCreate$1=baseCreate;function apply(t,r,e){switch(e.length){case 0:return t.call(r);case 1:return t.call(r,e[0]);case 2:return t.call(r,e[0],e[1]);case 3:return t.call(r,e[0],e[1],e[2])}return t.apply(r,e)}function copyArray(t,r){var e=-1,n=t.length;for(r||(r=Array(n));++e<n;)r[e]=t[e];return r}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(t){var r=0,e=0;return function(){var n=nativeNow(),o=HOT_SPAN-(n-e);if(e=n,o>0){if(++r>=HOT_COUNT)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}function constant(t){return function(){return t}}var defineProperty=function(){try{var t=getNative(Object,"defineProperty");return t({},"",{}),t}catch{}}();const defineProperty$1=defineProperty;var baseSetToString=defineProperty$1?function(t,r){return defineProperty$1(t,"toString",{configurable:!0,enumerable:!1,value:constant(r),writable:!0})}:identity;const baseSetToString$1=baseSetToString;var setToString=shortOut(baseSetToString$1);const setToString$1=setToString;function arrayEach(t,r){for(var e=-1,n=t==null?0:t.length;++e<n&&r(t[e],e,t)!==!1;);return t}function baseFindIndex(t,r,e,n){for(var o=t.length,s=e+(n?1:-1);n?s--:++s<o;)if(r(t[s],s,t))return s;return-1}var MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(t,r){var e=typeof t;return r=r??MAX_SAFE_INTEGER$1,!!r&&(e=="number"||e!="symbol"&&reIsUint.test(t))&&t>-1&&t%1==0&&t<r}function baseAssignValue(t,r,e){r=="__proto__"&&defineProperty$1?defineProperty$1(t,r,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[r]=e}function eq(t,r){return t===r||t!==t&&r!==r}var objectProto$b=Object.prototype,hasOwnProperty$a=objectProto$b.hasOwnProperty;function assignValue(t,r,e){var n=t[r];(!(hasOwnProperty$a.call(t,r)&&eq(n,e))||e===void 0&&!(r in t))&&baseAssignValue(t,r,e)}function copyObject(t,r,e,n){var o=!e;e||(e={});for(var s=-1,a=r.length;++s<a;){var i=r[s],u=n?n(e[i],t[i],i,e,t):void 0;u===void 0&&(u=t[i]),o?baseAssignValue(e,i,u):assignValue(e,i,u)}return e}var nativeMax$2=Math.max;function overRest(t,r,e){return r=nativeMax$2(r===void 0?t.length-1:r,0),function(){for(var n=arguments,o=-1,s=nativeMax$2(n.length-r,0),a=Array(s);++o<s;)a[o]=n[r+o];o=-1;for(var i=Array(r+1);++o<r;)i[o]=n[o];return i[r]=e(a),apply(t,this,i)}}var MAX_SAFE_INTEGER=9007199254740991;function isLength(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=MAX_SAFE_INTEGER}function isArrayLike(t){return t!=null&&isLength(t.length)&&!isFunction$1(t)}var objectProto$a=Object.prototype;function isPrototype(t){var r=t&&t.constructor,e=typeof r=="function"&&r.prototype||objectProto$a;return t===e}function baseTimes(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n}var argsTag$3="[object Arguments]";function baseIsArguments(t){return isObjectLike(t)&&baseGetTag(t)==argsTag$3}var objectProto$9=Object.prototype,hasOwnProperty$9=objectProto$9.hasOwnProperty,propertyIsEnumerable$1=objectProto$9.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(t){return isObjectLike(t)&&hasOwnProperty$9.call(t,"callee")&&!propertyIsEnumerable$1.call(t,"callee")};const isArguments$1=isArguments;function stubFalse(){return!1}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$2=moduleExports$2?root$1.Buffer:void 0,nativeIsBuffer=Buffer$2?Buffer$2.isBuffer:void 0,isBuffer$1=nativeIsBuffer||stubFalse;const isBuffer$2=isBuffer$1;var argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$1="[object Function]",mapTag$5="[object Map]",numberTag$3="[object Number]",objectTag$3="[object Object]",regexpTag$3="[object RegExp]",setTag$5="[object Set]",stringTag$3="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0;typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$3]=typedArrayTags[boolTag$3]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$3]=typedArrayTags[errorTag$2]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$5]=typedArrayTags[numberTag$3]=typedArrayTags[objectTag$3]=typedArrayTags[regexpTag$3]=typedArrayTags[setTag$5]=typedArrayTags[stringTag$3]=typedArrayTags[weakMapTag$2]=!1;function baseIsTypedArray(t){return isObjectLike(t)&&isLength(t.length)&&!!typedArrayTags[baseGetTag(t)]}function baseUnary(t){return function(r){return t(r)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal$1.process,nodeUtil=function(){try{var t=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return t||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch{}}();const nodeUtil$1=nodeUtil;var nodeIsTypedArray=nodeUtil$1&&nodeUtil$1.isTypedArray,isTypedArray$1=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;const isTypedArray$2=isTypedArray$1;var objectProto$8=Object.prototype,hasOwnProperty$8=objectProto$8.hasOwnProperty;function arrayLikeKeys(t,r){var e=isArray$2(t),n=!e&&isArguments$1(t),o=!e&&!n&&isBuffer$2(t),s=!e&&!n&&!o&&isTypedArray$2(t),a=e||n||o||s,i=a?baseTimes(t.length,String):[],u=i.length;for(var c in t)(r||hasOwnProperty$8.call(t,c))&&!(a&&(c=="length"||o&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||isIndex(c,u)))&&i.push(c);return i}function overArg(t,r){return function(e){return t(r(e))}}var nativeKeys=overArg(Object.keys,Object);const nativeKeys$1=nativeKeys;var objectProto$7=Object.prototype,hasOwnProperty$7=objectProto$7.hasOwnProperty;function baseKeys(t){if(!isPrototype(t))return nativeKeys$1(t);var r=[];for(var e in Object(t))hasOwnProperty$7.call(t,e)&&e!="constructor"&&r.push(e);return r}function keys(t){return isArrayLike(t)?arrayLikeKeys(t):baseKeys(t)}function nativeKeysIn(t){var r=[];if(t!=null)for(var e in Object(t))r.push(e);return r}var objectProto$6=Object.prototype,hasOwnProperty$6=objectProto$6.hasOwnProperty;function baseKeysIn(t){if(!isObject$1(t))return nativeKeysIn(t);var r=isPrototype(t),e=[];for(var n in t)n=="constructor"&&(r||!hasOwnProperty$6.call(t,n))||e.push(n);return e}function keysIn(t){return isArrayLike(t)?arrayLikeKeys(t,!0):baseKeysIn(t)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(t,r){if(isArray$2(t))return!1;var e=typeof t;return e=="number"||e=="symbol"||e=="boolean"||t==null||isSymbol(t)?!0:reIsPlainProp.test(t)||!reIsDeepProp.test(t)||r!=null&&t in Object(r)}var nativeCreate=getNative(Object,"create");const nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$5=Object.prototype,hasOwnProperty$5=objectProto$5.hasOwnProperty;function hashGet(t){var r=this.__data__;if(nativeCreate$1){var e=r[t];return e===HASH_UNDEFINED$2?void 0:e}return hasOwnProperty$5.call(r,t)?r[t]:void 0}var objectProto$4=Object.prototype,hasOwnProperty$4=objectProto$4.hasOwnProperty;function hashHas(t){var r=this.__data__;return nativeCreate$1?r[t]!==void 0:hasOwnProperty$4.call(r,t)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=nativeCreate$1&&r===void 0?HASH_UNDEFINED$1:r,this}function Hash(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Hash.prototype.clear=hashClear;Hash.prototype.delete=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(t,r){for(var e=t.length;e--;)if(eq(t[e][0],r))return e;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(t){var r=this.__data__,e=assocIndexOf(r,t);if(e<0)return!1;var n=r.length-1;return e==n?r.pop():splice.call(r,e,1),--this.size,!0}function listCacheGet(t){var r=this.__data__,e=assocIndexOf(r,t);return e<0?void 0:r[e][1]}function listCacheHas(t){return assocIndexOf(this.__data__,t)>-1}function listCacheSet(t,r){var e=this.__data__,n=assocIndexOf(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this}function ListCache(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype.delete=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative(root$1,"Map");const Map$2=Map$1;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$2||ListCache),string:new Hash}}function isKeyable(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}function getMapData(t,r){var e=t.__data__;return isKeyable(r)?e[typeof r=="string"?"string":"hash"]:e.map}function mapCacheDelete(t){var r=getMapData(this,t).delete(t);return this.size-=r?1:0,r}function mapCacheGet(t){return getMapData(this,t).get(t)}function mapCacheHas(t){return getMapData(this,t).has(t)}function mapCacheSet(t,r){var e=getMapData(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this}function MapCache(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype.delete=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT$2="Expected a function";function memoize(t,r){if(typeof t!="function"||r!=null&&typeof r!="function")throw new TypeError(FUNC_ERROR_TEXT$2);var e=function(){var n=arguments,o=r?r.apply(this,n):n[0],s=e.cache;if(s.has(o))return s.get(o);var a=t.apply(this,n);return e.cache=s.set(o,a)||s,a};return e.cache=new(memoize.Cache||MapCache),e}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(t){var r=memoize(t,function(n){return e.size===MAX_MEMOIZE_SIZE&&e.clear(),n}),e=r.cache;return r}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(t){var r=[];return t.charCodeAt(0)===46&&r.push(""),t.replace(rePropName,function(e,n,o,s){r.push(o?s.replace(reEscapeChar,"$1"):n||e)}),r});const stringToPath$1=stringToPath;function toString$1(t){return t==null?"":baseToString(t)}function castPath(t,r){return isArray$2(t)?t:isKey(t,r)?[t]:stringToPath$1(toString$1(t))}var INFINITY$1=1/0;function toKey(t){if(typeof t=="string"||isSymbol(t))return t;var r=t+"";return r=="0"&&1/t==-INFINITY$1?"-0":r}function baseGet(t,r){r=castPath(r,t);for(var e=0,n=r.length;t!=null&&e<n;)t=t[toKey(r[e++])];return e&&e==n?t:void 0}function get(t,r,e){var n=t==null?void 0:baseGet(t,r);return n===void 0?e:n}function arrayPush(t,r){for(var e=-1,n=r.length,o=t.length;++e<n;)t[o+e]=r[e];return t}var spreadableSymbol=Symbol$2?Symbol$2.isConcatSpreadable:void 0;function isFlattenable(t){return isArray$2(t)||isArguments$1(t)||!!(spreadableSymbol&&t&&t[spreadableSymbol])}function baseFlatten(t,r,e,n,o){var s=-1,a=t.length;for(e||(e=isFlattenable),o||(o=[]);++s<a;){var i=t[s];r>0&&e(i)?r>1?baseFlatten(i,r-1,e,n,o):arrayPush(o,i):n||(o[o.length]=i)}return o}function flatten(t){var r=t==null?0:t.length;return r?baseFlatten(t,1):[]}function flatRest(t){return setToString$1(overRest(t,void 0,flatten),t+"")}var getPrototype=overArg(Object.getPrototypeOf,Object);const getPrototype$1=getPrototype;function castArray$1(){if(!arguments.length)return[];var t=arguments[0];return isArray$2(t)?t:[t]}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(t){var r=this.__data__,e=r.delete(t);return this.size=r.size,e}function stackGet(t){return this.__data__.get(t)}function stackHas(t){return this.__data__.has(t)}var LARGE_ARRAY_SIZE=200;function stackSet(t,r){var e=this.__data__;if(e instanceof ListCache){var n=e.__data__;if(!Map$2||n.length<LARGE_ARRAY_SIZE-1)return n.push([t,r]),this.size=++e.size,this;e=this.__data__=new MapCache(n)}return e.set(t,r),this.size=e.size,this}function Stack(t){var r=this.__data__=new ListCache(t);this.size=r.size}Stack.prototype.clear=stackClear;Stack.prototype.delete=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;function baseAssign(t,r){return t&&copyObject(r,keys(r),t)}function baseAssignIn(t,r){return t&&copyObject(r,keysIn(r),t)}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer$1=moduleExports?root$1.Buffer:void 0,allocUnsafe=Buffer$1?Buffer$1.allocUnsafe:void 0;function cloneBuffer(t,r){if(r)return t.slice();var e=t.length,n=allocUnsafe?allocUnsafe(e):new t.constructor(e);return t.copy(n),n}function arrayFilter(t,r){for(var e=-1,n=t==null?0:t.length,o=0,s=[];++e<n;){var a=t[e];r(a,e,t)&&(s[o++]=a)}return s}function stubArray(){return[]}var objectProto$3=Object.prototype,propertyIsEnumerable=objectProto$3.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(t){return t==null?[]:(t=Object(t),arrayFilter(nativeGetSymbols$1(t),function(r){return propertyIsEnumerable.call(t,r)}))}:stubArray;const getSymbols$1=getSymbols;function copySymbols(t,r){return copyObject(t,getSymbols$1(t),r)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(t){for(var r=[];t;)arrayPush(r,getSymbols$1(t)),t=getPrototype$1(t);return r}:stubArray;const getSymbolsIn$1=getSymbolsIn;function copySymbolsIn(t,r){return copyObject(t,getSymbolsIn$1(t),r)}function baseGetAllKeys(t,r,e){var n=r(t);return isArray$2(t)?n:arrayPush(n,e(t))}function getAllKeys(t){return baseGetAllKeys(t,keys,getSymbols$1)}function getAllKeysIn(t){return baseGetAllKeys(t,keysIn,getSymbolsIn$1)}var DataView=getNative(root$1,"DataView");const DataView$1=DataView;var Promise$1=getNative(root$1,"Promise");const Promise$2=Promise$1;var Set$1=getNative(root$1,"Set");const Set$2=Set$1;var mapTag$4="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$4="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$3="[object DataView]",dataViewCtorString=toSource(DataView$1),mapCtorString=toSource(Map$2),promiseCtorString=toSource(Promise$2),setCtorString=toSource(Set$2),weakMapCtorString=toSource(WeakMap$2),getTag=baseGetTag;(DataView$1&&getTag(new DataView$1(new ArrayBuffer(1)))!=dataViewTag$3||Map$2&&getTag(new Map$2)!=mapTag$4||Promise$2&&getTag(Promise$2.resolve())!=promiseTag||Set$2&&getTag(new Set$2)!=setTag$4||WeakMap$2&&getTag(new WeakMap$2)!=weakMapTag$1)&&(getTag=function(t){var r=baseGetTag(t),e=r==objectTag$2?t.constructor:void 0,n=e?toSource(e):"";if(n)switch(n){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$4;case promiseCtorString:return promiseTag;case setCtorString:return setTag$4;case weakMapCtorString:return weakMapTag$1}return r});const getTag$1=getTag;var objectProto$2=Object.prototype,hasOwnProperty$3=objectProto$2.hasOwnProperty;function initCloneArray(t){var r=t.length,e=new t.constructor(r);return r&&typeof t[0]=="string"&&hasOwnProperty$3.call(t,"index")&&(e.index=t.index,e.input=t.input),e}var Uint8Array$1=root$1.Uint8Array;const Uint8Array$2=Uint8Array$1;function cloneArrayBuffer(t){var r=new t.constructor(t.byteLength);return new Uint8Array$2(r).set(new Uint8Array$2(t)),r}function cloneDataView(t,r){var e=r?cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}var reFlags=/\w*$/;function cloneRegExp(t){var r=new t.constructor(t.source,reFlags.exec(t));return r.lastIndex=t.lastIndex,r}var symbolProto$1=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(t){return symbolValueOf$1?Object(symbolValueOf$1.call(t)):{}}function cloneTypedArray(t,r){var e=r?cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}var boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$3="[object Map]",numberTag$2="[object Number]",regexpTag$2="[object RegExp]",setTag$3="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(t,r,e){var n=t.constructor;switch(r){case arrayBufferTag$2:return cloneArrayBuffer(t);case boolTag$2:case dateTag$2:return new n(+t);case dataViewTag$2:return cloneDataView(t,e);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(t,e);case mapTag$3:return new n;case numberTag$2:case stringTag$2:return new n(t);case regexpTag$2:return cloneRegExp(t);case setTag$3:return new n;case symbolTag$2:return cloneSymbol(t)}}function initCloneObject(t){return typeof t.constructor=="function"&&!isPrototype(t)?baseCreate$1(getPrototype$1(t)):{}}var mapTag$2="[object Map]";function baseIsMap(t){return isObjectLike(t)&&getTag$1(t)==mapTag$2}var nodeIsMap=nodeUtil$1&&nodeUtil$1.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap;const isMap$1=isMap;var setTag$2="[object Set]";function baseIsSet(t){return isObjectLike(t)&&getTag$1(t)==setTag$2}var nodeIsSet=nodeUtil$1&&nodeUtil$1.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet;const isSet$1=isSet;var CLONE_DEEP_FLAG$1=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$2=4,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$1="[object Map]",numberTag$1="[object Number]",objectTag$1="[object Object]",regexpTag$1="[object RegExp]",setTag$1="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$1]=cloneableTags[numberTag$1]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$1]=cloneableTags[setTag$1]=cloneableTags[stringTag$1]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0;cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;function baseClone(t,r,e,n,o,s){var a,i=r&CLONE_DEEP_FLAG$1,u=r&CLONE_FLAT_FLAG,c=r&CLONE_SYMBOLS_FLAG$2;if(e&&(a=o?e(t,n,o,s):e(t)),a!==void 0)return a;if(!isObject$1(t))return t;var d=isArray$2(t);if(d){if(a=initCloneArray(t),!i)return copyArray(t,a)}else{var m=getTag$1(t),v=m==funcTag||m==genTag;if(isBuffer$2(t))return cloneBuffer(t,i);if(m==objectTag$1||m==argsTag$1||v&&!o){if(a=u||v?{}:initCloneObject(t),!i)return u?copySymbolsIn(t,baseAssignIn(a,t)):copySymbols(t,baseAssign(a,t))}else{if(!cloneableTags[m])return o?t:{};a=initCloneByTag(t,m,i)}}s||(s=new Stack);var g=s.get(t);if(g)return g;s.set(t,a),isSet$1(t)?t.forEach(function(k){a.add(baseClone(k,r,e,k,t,s))}):isMap$1(t)&&t.forEach(function(k,y){a.set(y,baseClone(k,r,e,y,t,s))});var b=c?u?getAllKeysIn:getAllKeys:u?keysIn:keys,T=d?void 0:b(t);return arrayEach(T||t,function(k,y){T&&(y=k,k=t[y]),assignValue(a,y,baseClone(k,r,e,y,t,s))}),a}var CLONE_SYMBOLS_FLAG$1=4;function clone(t){return baseClone(t,CLONE_SYMBOLS_FLAG$1)}var CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG=4;function cloneDeep(t){return baseClone(t,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG)}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(t){return this.__data__.set(t,HASH_UNDEFINED),this}function setCacheHas(t){return this.__data__.has(t)}function SetCache(t){var r=-1,e=t==null?0:t.length;for(this.__data__=new MapCache;++r<e;)this.add(t[r])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function arraySome(t,r){for(var e=-1,n=t==null?0:t.length;++e<n;)if(r(t[e],e,t))return!0;return!1}function cacheHas(t,r){return t.has(r)}var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(t,r,e,n,o,s){var a=e&COMPARE_PARTIAL_FLAG$5,i=t.length,u=r.length;if(i!=u&&!(a&&u>i))return!1;var c=s.get(t),d=s.get(r);if(c&&d)return c==r&&d==t;var m=-1,v=!0,g=e&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(s.set(t,r),s.set(r,t);++m<i;){var b=t[m],T=r[m];if(n)var k=a?n(T,b,m,r,t,s):n(b,T,m,t,r,s);if(k!==void 0){if(k)continue;v=!1;break}if(g){if(!arraySome(r,function(y,A){if(!cacheHas(g,A)&&(b===y||o(b,y,e,n,s)))return g.push(A)})){v=!1;break}}else if(!(b===T||o(b,T,e,n,s))){v=!1;break}}return s.delete(t),s.delete(r),v}function mapToArray(t){var r=-1,e=Array(t.size);return t.forEach(function(n,o){e[++r]=[o,n]}),e}function setToArray(t){var r=-1,e=Array(t.size);return t.forEach(function(n){e[++r]=n}),e}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(t,r,e,n,o,s,a){switch(e){case dataViewTag:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case arrayBufferTag:return!(t.byteLength!=r.byteLength||!s(new Uint8Array$2(t),new Uint8Array$2(r)));case boolTag:case dateTag:case numberTag:return eq(+t,+r);case errorTag:return t.name==r.name&&t.message==r.message;case regexpTag:case stringTag:return t==r+"";case mapTag:var i=mapToArray;case setTag:var u=n&COMPARE_PARTIAL_FLAG$4;if(i||(i=setToArray),t.size!=r.size&&!u)return!1;var c=a.get(t);if(c)return c==r;n|=COMPARE_UNORDERED_FLAG$2,a.set(t,r);var d=equalArrays(i(t),i(r),n,o,s,a);return a.delete(t),d;case symbolTag:if(symbolValueOf)return symbolValueOf.call(t)==symbolValueOf.call(r)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$1=Object.prototype,hasOwnProperty$2=objectProto$1.hasOwnProperty;function equalObjects(t,r,e,n,o,s){var a=e&COMPARE_PARTIAL_FLAG$3,i=getAllKeys(t),u=i.length,c=getAllKeys(r),d=c.length;if(u!=d&&!a)return!1;for(var m=u;m--;){var v=i[m];if(!(a?v in r:hasOwnProperty$2.call(r,v)))return!1}var g=s.get(t),b=s.get(r);if(g&&b)return g==r&&b==t;var T=!0;s.set(t,r),s.set(r,t);for(var k=a;++m<u;){v=i[m];var y=t[v],A=r[v];if(n)var V=a?n(A,y,v,r,t,s):n(y,A,v,t,r,s);if(!(V===void 0?y===A||o(y,A,e,n,s):V)){T=!1;break}k||(k=v=="constructor")}if(T&&!k){var he=t.constructor,ae=r.constructor;he!=ae&&"constructor"in t&&"constructor"in r&&!(typeof he=="function"&&he instanceof he&&typeof ae=="function"&&ae instanceof ae)&&(T=!1)}return s.delete(t),s.delete(r),T}var COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto=Object.prototype,hasOwnProperty$1=objectProto.hasOwnProperty;function baseIsEqualDeep(t,r,e,n,o,s){var a=isArray$2(t),i=isArray$2(r),u=a?arrayTag:getTag$1(t),c=i?arrayTag:getTag$1(r);u=u==argsTag?objectTag:u,c=c==argsTag?objectTag:c;var d=u==objectTag,m=c==objectTag,v=u==c;if(v&&isBuffer$2(t)){if(!isBuffer$2(r))return!1;a=!0,d=!1}if(v&&!d)return s||(s=new Stack),a||isTypedArray$2(t)?equalArrays(t,r,e,n,o,s):equalByTag(t,r,u,e,n,o,s);if(!(e&COMPARE_PARTIAL_FLAG$2)){var g=d&&hasOwnProperty$1.call(t,"__wrapped__"),b=m&&hasOwnProperty$1.call(r,"__wrapped__");if(g||b){var T=g?t.value():t,k=b?r.value():r;return s||(s=new Stack),o(T,k,e,n,s)}}return v?(s||(s=new Stack),equalObjects(t,r,e,n,o,s)):!1}function baseIsEqual(t,r,e,n,o){return t===r?!0:t==null||r==null||!isObjectLike(t)&&!isObjectLike(r)?t!==t&&r!==r:baseIsEqualDeep(t,r,e,n,baseIsEqual,o)}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(t,r,e,n){var o=e.length,s=o,a=!n;if(t==null)return!s;for(t=Object(t);o--;){var i=e[o];if(a&&i[2]?i[1]!==t[i[0]]:!(i[0]in t))return!1}for(;++o<s;){i=e[o];var u=i[0],c=t[u],d=i[1];if(a&&i[2]){if(c===void 0&&!(u in t))return!1}else{var m=new Stack;if(n)var v=n(c,d,u,t,r,m);if(!(v===void 0?baseIsEqual(d,c,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,n,m):v))return!1}}return!0}function isStrictComparable(t){return t===t&&!isObject$1(t)}function getMatchData(t){for(var r=keys(t),e=r.length;e--;){var n=r[e],o=t[n];r[e]=[n,o,isStrictComparable(o)]}return r}function matchesStrictComparable(t,r){return function(e){return e==null?!1:e[t]===r&&(r!==void 0||t in Object(e))}}function baseMatches(t){var r=getMatchData(t);return r.length==1&&r[0][2]?matchesStrictComparable(r[0][0],r[0][1]):function(e){return e===t||baseIsMatch(e,t,r)}}function baseHasIn(t,r){return t!=null&&r in Object(t)}function hasPath(t,r,e){r=castPath(r,t);for(var n=-1,o=r.length,s=!1;++n<o;){var a=toKey(r[n]);if(!(s=t!=null&&e(t,a)))break;t=t[a]}return s||++n!=o?s:(o=t==null?0:t.length,!!o&&isLength(o)&&isIndex(a,o)&&(isArray$2(t)||isArguments$1(t)))}function hasIn(t,r){return t!=null&&hasPath(t,r,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(t,r){return isKey(t)&&isStrictComparable(r)?matchesStrictComparable(toKey(t),r):function(e){var n=get(e,t);return n===void 0&&n===r?hasIn(e,t):baseIsEqual(r,n,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(t){return function(r){return r==null?void 0:r[t]}}function basePropertyDeep(t){return function(r){return baseGet(r,t)}}function property(t){return isKey(t)?baseProperty(toKey(t)):basePropertyDeep(t)}function baseIteratee(t){return typeof t=="function"?t:t==null?identity:typeof t=="object"?isArray$2(t)?baseMatchesProperty(t[0],t[1]):baseMatches(t):property(t)}var now=function(){return root$1.Date.now()};const now$1=now;var FUNC_ERROR_TEXT$1="Expected a function",nativeMax$1=Math.max,nativeMin$1=Math.min;function debounce(t,r,e){var n,o,s,a,i,u,c=0,d=!1,m=!1,v=!0;if(typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT$1);r=toNumber(r)||0,isObject$1(e)&&(d=!!e.leading,m="maxWait"in e,s=m?nativeMax$1(toNumber(e.maxWait)||0,r):s,v="trailing"in e?!!e.trailing:v);function g(Ne){var _e=n,Ce=o;return n=o=void 0,c=Ne,a=t.apply(Ce,_e),a}function b(Ne){return c=Ne,i=setTimeout(y,r),d?g(Ne):a}function T(Ne){var _e=Ne-u,Ce=Ne-c,re=r-_e;return m?nativeMin$1(re,s-Ce):re}function k(Ne){var _e=Ne-u,Ce=Ne-c;return u===void 0||_e>=r||_e<0||m&&Ce>=s}function y(){var Ne=now$1();if(k(Ne))return A(Ne);i=setTimeout(y,T(Ne))}function A(Ne){return i=void 0,v&&n?g(Ne):(n=o=void 0,a)}function V(){i!==void 0&&clearTimeout(i),c=0,n=u=o=i=void 0}function he(){return i===void 0?a:A(now$1())}function ae(){var Ne=now$1(),_e=k(Ne);if(n=arguments,o=this,u=Ne,_e){if(i===void 0)return b(u);if(m)return clearTimeout(i),i=setTimeout(y,r),g(u)}return i===void 0&&(i=setTimeout(y,r)),a}return ae.cancel=V,ae.flush=he,ae}var nativeMax=Math.max,nativeMin=Math.min;function findLastIndex(t,r,e){var n=t==null?0:t.length;if(!n)return-1;var o=n-1;return e!==void 0&&(o=toInteger(e),o=e<0?nativeMax(n+o,0):nativeMin(o,n-1)),baseFindIndex(t,baseIteratee(r),o,!0)}var INFINITY=1/0;function flattenDeep(t){var r=t==null?0:t.length;return r?baseFlatten(t,INFINITY):[]}function fromPairs(t){for(var r=-1,e=t==null?0:t.length,n={};++r<e;){var o=t[r];n[o[0]]=o[1]}return n}function isEqual(t,r){return baseIsEqual(t,r)}function isNil(t){return t==null}function isUndefined$2(t){return t===void 0}function baseSet(t,r,e,n){if(!isObject$1(t))return t;r=castPath(r,t);for(var o=-1,s=r.length,a=s-1,i=t;i!=null&&++o<s;){var u=toKey(r[o]),c=e;if(u==="__proto__"||u==="constructor"||u==="prototype")return t;if(o!=a){var d=i[u];c=n?n(d,u,i):void 0,c===void 0&&(c=isObject$1(d)?d:isIndex(r[o+1])?[]:{})}assignValue(i,u,c),i=i[u]}return t}function basePickBy(t,r,e){for(var n=-1,o=r.length,s={};++n<o;){var a=r[n],i=baseGet(t,a);e(i,a)&&baseSet(s,castPath(a,t),i)}return s}function basePick(t,r){return basePickBy(t,r,function(e,n){return hasIn(t,n)})}var pick=flatRest(function(t,r){return t==null?{}:basePick(t,r)});const pick$1=pick;function set(t,r,e){return t==null?t:baseSet(t,r,e)}var FUNC_ERROR_TEXT="Expected a function";function throttle(t,r,e){var n=!0,o=!0;if(typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT);return isObject$1(e)&&(n="leading"in e?!!e.leading:n,o="trailing"in e?!!e.trailing:o),debounce(t,r,{leading:n,maxWait:r,trailing:o})}const isUndefined$1=t=>t===void 0,isBoolean$1=t=>typeof t=="boolean",isNumber$1=t=>typeof t=="number",isEmpty=t=>!t&&t!==0||isArray$4(t)&&t.length===0||isObject$2(t)&&!Object.keys(t).length,isElement=t=>typeof Element>"u"?!1:t instanceof Element,isStringNumber=t=>isString$2(t)?!Number.isNaN(Number(t)):!1,escapeStringRegexp=(t="")=>t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),capitalize=t=>capitalize$1(t),keysOf=t=>Object.keys(t),entriesOf=t=>Object.entries(t),getProp=(t,r,e)=>({get value(){return get(t,r,e)},set value(n){set(t,r,n)}});class ElementPlusError extends Error{constructor(r){super(r),this.name="ElementPlusError"}}function throwError(t,r){throw new ElementPlusError(`[${t}] ${r}`)}function debugWarn(t,r){}const classNameToArray=(t="")=>t.split(" ").filter(r=>!!r.trim()),hasClass=(t,r)=>{if(!t||!r)return!1;if(r.includes(" "))throw new Error("className should not contain space.");return t.classList.contains(r)},addClass=(t,r)=>{!t||!r.trim()||t.classList.add(...classNameToArray(r))},removeClass=(t,r)=>{!t||!r.trim()||t.classList.remove(...classNameToArray(r))},getStyle=(t,r)=>{var e;if(!isClient||!t||!r)return"";let n=camelize(r);n==="float"&&(n="cssFloat");try{const o=t.style[n];if(o)return o;const s=(e=document.defaultView)==null?void 0:e.getComputedStyle(t,"");return s?s[n]:""}catch{return t.style[n]}};function addUnit(t,r="px"){if(!t)return"";if(isNumber$1(t)||isStringNumber(t))return`${t}${r}`;if(isString$2(t))return t}const isScroll=(t,r)=>{if(!isClient)return!1;const e={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(r)],n=getStyle(t,e);return["scroll","auto","overlay"].some(o=>n.includes(o))},getScrollContainer=(t,r)=>{if(!isClient)return;let e=t;for(;e;){if([window,document,document.documentElement].includes(e))return window;if(isScroll(e,r))return e;e=e.parentNode}return e};let scrollBarWidth;const getScrollBarWidth=t=>{var r;if(!isClient)return 0;if(scrollBarWidth!==void 0)return scrollBarWidth;const e=document.createElement("div");e.className=`${t}-scrollbar__wrap`,e.style.visibility="hidden",e.style.width="100px",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);const n=e.offsetWidth;e.style.overflow="scroll";const o=document.createElement("div");o.style.width="100%",e.appendChild(o);const s=o.offsetWidth;return(r=e.parentNode)==null||r.removeChild(e),scrollBarWidth=n-s,scrollBarWidth};function scrollIntoView(t,r){if(!isClient)return;if(!r){t.scrollTop=0;return}const e=[];let n=r.offsetParent;for(;n!==null&&t!==n&&t.contains(n);)e.push(n),n=n.offsetParent;const o=r.offsetTop+e.reduce((u,c)=>u+c.offsetTop,0),s=o+r.offsetHeight,a=t.scrollTop,i=a+t.clientHeight;o<a?t.scrollTop=o:s>i&&(t.scrollTop=s-t.clientHeight)}/*! Element Plus Icons Vue v2.1.0 */var export_helper_default=(t,r)=>{let e=t.__vccOpts||t;for(let[n,o]of r)e[n]=o;return e},arrow_down_vue_vue_type_script_lang_default={name:"ArrowDown"},_hoisted_16$1={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_26=createBaseVNode("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"},null,-1),_hoisted_36=[_hoisted_26];function _sfc_render6(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_16$1,_hoisted_36)}var arrow_down_default=export_helper_default(arrow_down_vue_vue_type_script_lang_default,[["render",_sfc_render6],["__file","arrow-down.vue"]]),arrow_left_vue_vue_type_script_lang_default={name:"ArrowLeft"},_hoisted_18$1={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_28=createBaseVNode("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"},null,-1),_hoisted_38=[_hoisted_28];function _sfc_render8(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_18$1,_hoisted_38)}var arrow_left_default=export_helper_default(arrow_left_vue_vue_type_script_lang_default,[["render",_sfc_render8],["__file","arrow-left.vue"]]),arrow_right_vue_vue_type_script_lang_default={name:"ArrowRight"},_hoisted_110={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_210=createBaseVNode("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"},null,-1),_hoisted_310=[_hoisted_210];function _sfc_render10(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_110,_hoisted_310)}var arrow_right_default=export_helper_default(arrow_right_vue_vue_type_script_lang_default,[["render",_sfc_render10],["__file","arrow-right.vue"]]),caret_top_vue_vue_type_script_lang_default={name:"CaretTop"},_hoisted_135={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_235=createBaseVNode("path",{fill:"currentColor",d:"M512 320 192 704h639.936z"},null,-1),_hoisted_334=[_hoisted_235];function _sfc_render35(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_135,_hoisted_334)}var caret_top_default=export_helper_default(caret_top_vue_vue_type_script_lang_default,[["render",_sfc_render35],["__file","caret-top.vue"]]),check_vue_vue_type_script_lang_default={name:"Check"},_hoisted_143={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_243=createBaseVNode("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"},null,-1),_hoisted_342=[_hoisted_243];function _sfc_render43(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_143,_hoisted_342)}var check_default=export_helper_default(check_vue_vue_type_script_lang_default,[["render",_sfc_render43],["__file","check.vue"]]),circle_check_vue_vue_type_script_lang_default={name:"CircleCheck"},_hoisted_149={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_249=createBaseVNode("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),_hoisted_348=createBaseVNode("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"},null,-1),_hoisted_415=[_hoisted_249,_hoisted_348];function _sfc_render49(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_149,_hoisted_415)}var circle_check_default=export_helper_default(circle_check_vue_vue_type_script_lang_default,[["render",_sfc_render49],["__file","circle-check.vue"]]),circle_close_filled_vue_vue_type_script_lang_default={name:"CircleCloseFilled"},_hoisted_150={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_250=createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336L512 457.664z"},null,-1),_hoisted_349=[_hoisted_250];function _sfc_render50(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_150,_hoisted_349)}var circle_close_filled_default=export_helper_default(circle_close_filled_vue_vue_type_script_lang_default,[["render",_sfc_render50],["__file","circle-close-filled.vue"]]),circle_close_vue_vue_type_script_lang_default={name:"CircleClose"},_hoisted_151={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_251=createBaseVNode("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248L466.752 512z"},null,-1),_hoisted_350=createBaseVNode("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),_hoisted_416=[_hoisted_251,_hoisted_350];function _sfc_render51(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_151,_hoisted_416)}var circle_close_default=export_helper_default(circle_close_vue_vue_type_script_lang_default,[["render",_sfc_render51],["__file","circle-close.vue"]]),close_vue_vue_type_script_lang_default={name:"Close"},_hoisted_156={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_256=createBaseVNode("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"},null,-1),_hoisted_355=[_hoisted_256];function _sfc_render56(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_156,_hoisted_355)}var close_default=export_helper_default(close_vue_vue_type_script_lang_default,[["render",_sfc_render56],["__file","close.vue"]]),delete_vue_vue_type_script_lang_default={name:"Delete"},_hoisted_180={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_280=createBaseVNode("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32V256zm448-64v-64H416v64h192zM224 896h576V256H224v640zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32zm192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32z"},null,-1),_hoisted_379=[_hoisted_280];function _sfc_render80(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_180,_hoisted_379)}var delete_default=export_helper_default(delete_vue_vue_type_script_lang_default,[["render",_sfc_render80],["__file","delete.vue"]]),document_vue_vue_type_script_lang_default={name:"Document"},_hoisted_190={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_290=createBaseVNode("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640V384zm-26.496-64L640 154.496V320h165.504zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32zm160 448h384v64H320v-64zm0-192h160v64H320v-64zm0 384h384v64H320v-64z"},null,-1),_hoisted_389=[_hoisted_290];function _sfc_render90(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_190,_hoisted_389)}var document_default=export_helper_default(document_vue_vue_type_script_lang_default,[["render",_sfc_render90],["__file","document.vue"]]),edit_vue_vue_type_script_lang_default={name:"Edit"},_hoisted_194={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_294=createBaseVNode("path",{fill:"currentColor",d:"M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640V512z"},null,-1),_hoisted_393=createBaseVNode("path",{fill:"currentColor",d:"m469.952 554.24 52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z"},null,-1),_hoisted_431=[_hoisted_294,_hoisted_393];function _sfc_render94(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_194,_hoisted_431)}var edit_default=export_helper_default(edit_vue_vue_type_script_lang_default,[["render",_sfc_render94],["__file","edit.vue"]]),full_screen_vue_vue_type_script_lang_default={name:"FullScreen"},_hoisted_1118={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2118=createBaseVNode("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64v.064zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64l-192 .192zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64v-.064z"},null,-1),_hoisted_3117=[_hoisted_2118];function _sfc_render118(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1118,_hoisted_3117)}var full_screen_default=export_helper_default(full_screen_vue_vue_type_script_lang_default,[["render",_sfc_render118],["__file","full-screen.vue"]]),hide_vue_vue_type_script_lang_default={name:"Hide"},_hoisted_1133={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2133=createBaseVNode("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2L371.2 588.8ZM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"},null,-1),_hoisted_3132=createBaseVNode("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"},null,-1),_hoisted_438=[_hoisted_2133,_hoisted_3132];function _sfc_render133(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1133,_hoisted_438)}var hide_default=export_helper_default(hide_vue_vue_type_script_lang_default,[["render",_sfc_render133],["__file","hide.vue"]]),info_filled_vue_vue_type_script_lang_default={name:"InfoFilled"},_hoisted_1143={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2143=createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64zm67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344zM590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"},null,-1),_hoisted_3142=[_hoisted_2143];function _sfc_render143(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1143,_hoisted_3142)}var info_filled_default=export_helper_default(info_filled_vue_vue_type_script_lang_default,[["render",_sfc_render143],["__file","info-filled.vue"]]),loading_vue_vue_type_script_lang_default={name:"Loading"},_hoisted_1150={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2150=createBaseVNode("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32zm448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32zm-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0zm-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"},null,-1),_hoisted_3149=[_hoisted_2150];function _sfc_render150(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1150,_hoisted_3149)}var loading_default=export_helper_default(loading_vue_vue_type_script_lang_default,[["render",_sfc_render150],["__file","loading.vue"]]),plus_vue_vue_type_script_lang_default={name:"Plus"},_hoisted_1201={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2201=createBaseVNode("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"},null,-1),_hoisted_3200=[_hoisted_2201];function _sfc_render201(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1201,_hoisted_3200)}var plus_default=export_helper_default(plus_vue_vue_type_script_lang_default,[["render",_sfc_render201],["__file","plus.vue"]]),refresh_left_vue_vue_type_script_lang_default={name:"RefreshLeft"},_hoisted_1215={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2215=createBaseVNode("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"},null,-1),_hoisted_3214=[_hoisted_2215];function _sfc_render215(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1215,_hoisted_3214)}var refresh_left_default=export_helper_default(refresh_left_vue_vue_type_script_lang_default,[["render",_sfc_render215],["__file","refresh-left.vue"]]),refresh_right_vue_vue_type_script_lang_default={name:"RefreshRight"},_hoisted_1216={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2216=createBaseVNode("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"},null,-1),_hoisted_3215=[_hoisted_2216];function _sfc_render216(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1216,_hoisted_3215)}var refresh_right_default=export_helper_default(refresh_right_vue_vue_type_script_lang_default,[["render",_sfc_render216],["__file","refresh-right.vue"]]),scale_to_original_vue_vue_type_script_lang_default={name:"ScaleToOriginal"},_hoisted_1222={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2222=createBaseVNode("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zM512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412zM512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512z"},null,-1),_hoisted_3221=[_hoisted_2222];function _sfc_render222(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1222,_hoisted_3221)}var scale_to_original_default=export_helper_default(scale_to_original_vue_vue_type_script_lang_default,[["render",_sfc_render222],["__file","scale-to-original.vue"]]),search_vue_vue_type_script_lang_default={name:"Search"},_hoisted_1225={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2225=createBaseVNode("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704z"},null,-1),_hoisted_3224=[_hoisted_2225];function _sfc_render225(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1225,_hoisted_3224)}var search_default=export_helper_default(search_vue_vue_type_script_lang_default,[["render",_sfc_render225],["__file","search.vue"]]),setting_vue_vue_type_script_lang_default={name:"Setting"},_hoisted_1231={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2231=createBaseVNode("path",{fill:"currentColor",d:"M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36-116.224-25.088-65.28 113.152 79.68 88.192-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136-79.808 88.192 65.344 113.152 116.224-25.024 22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152 24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296 116.288 25.024 65.28-113.152-79.744-88.192 1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136 79.808-88.128-65.344-113.152-116.288 24.96-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384 192 192 0 0 1 0-384zm0 64a128 128 0 1 0 0 256 128 128 0 0 0 0-256z"},null,-1),_hoisted_3230=[_hoisted_2231];function _sfc_render231(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1231,_hoisted_3230)}var setting_default=export_helper_default(setting_vue_vue_type_script_lang_default,[["render",_sfc_render231],["__file","setting.vue"]]),success_filled_vue_vue_type_script_lang_default={name:"SuccessFilled"},_hoisted_1249={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2249=createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336L456.192 600.384z"},null,-1),_hoisted_3248=[_hoisted_2249];function _sfc_render249(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1249,_hoisted_3248)}var success_filled_default=export_helper_default(success_filled_vue_vue_type_script_lang_default,[["render",_sfc_render249],["__file","success-filled.vue"]]),view_vue_vue_type_script_lang_default={name:"View"},_hoisted_1283={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2283=createBaseVNode("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352zm0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448zm0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160z"},null,-1),_hoisted_3282=[_hoisted_2283];function _sfc_render283(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1283,_hoisted_3282)}var view_default=export_helper_default(view_vue_vue_type_script_lang_default,[["render",_sfc_render283],["__file","view.vue"]]),warning_filled_vue_vue_type_script_lang_default={name:"WarningFilled"},_hoisted_1287={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2287=createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256zm0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4z"},null,-1),_hoisted_3286=[_hoisted_2287];function _sfc_render287(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1287,_hoisted_3286)}var warning_filled_default=export_helper_default(warning_filled_vue_vue_type_script_lang_default,[["render",_sfc_render287],["__file","warning-filled.vue"]]),zoom_in_vue_vue_type_script_lang_default={name:"ZoomIn"},_hoisted_1292={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2292=createBaseVNode("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704zm-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64h96z"},null,-1),_hoisted_3291=[_hoisted_2292];function _sfc_render292(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1292,_hoisted_3291)}var zoom_in_default=export_helper_default(zoom_in_vue_vue_type_script_lang_default,[["render",_sfc_render292],["__file","zoom-in.vue"]]),zoom_out_vue_vue_type_script_lang_default={name:"ZoomOut"},_hoisted_1293={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_hoisted_2293=createBaseVNode("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704zM352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64z"},null,-1),_hoisted_3292=[_hoisted_2293];function _sfc_render293(t,r,e,n,o,s){return openBlock(),createElementBlock("svg",_hoisted_1293,_hoisted_3292)}var zoom_out_default=export_helper_default(zoom_out_vue_vue_type_script_lang_default,[["render",_sfc_render293],["__file","zoom-out.vue"]]);const epPropKey="__epPropKey",definePropType=t=>t,isEpProp=t=>isObject$2(t)&&!!t[epPropKey],buildProp=(t,r)=>{if(!isObject$2(t)||isEpProp(t))return t;const{values:e,required:n,default:o,type:s,validator:a}=t,u={type:s,required:!!n,validator:e||a?c=>{let d=!1,m=[];if(e&&(m=Array.from(e),hasOwn(t,"default")&&m.push(o),d||(d=m.includes(c))),a&&(d||(d=a(c))),!d&&m.length>0){const v=[...new Set(m)].map(g=>JSON.stringify(g)).join(", ");warn(`Invalid prop: validation failed${r?` for prop "${r}"`:""}. Expected one of [${v}], got value ${JSON.stringify(c)}.`)}return d}:void 0,[epPropKey]:!0};return hasOwn(t,"default")&&(u.default=o),u},buildProps=t=>fromPairs(Object.entries(t).map(([r,e])=>[r,buildProp(e,r)])),iconPropType=definePropType([String,Object,Function]),CloseComponents={Close:close_default},TypeComponents={Close:close_default,SuccessFilled:success_filled_default,InfoFilled:info_filled_default,WarningFilled:warning_filled_default,CircleCloseFilled:circle_close_filled_default},TypeComponentsMap={success:success_filled_default,warning:warning_filled_default,error:circle_close_filled_default,info:info_filled_default},ValidateComponentsMap={validating:loading_default,success:circle_check_default,error:circle_close_default},withInstall=(t,r)=>{if(t.install=e=>{for(const n of[t,...Object.values(r??{})])e.component(n.name,n)},r)for(const[e,n]of Object.entries(r))t[e]=n;return t},withInstallFunction=(t,r)=>(t.install=e=>{t._context=e._context,e.config.globalProperties[r]=t},t),withNoopInstall=t=>(t.install=NOOP,t),composeRefs=(...t)=>r=>{t.forEach(e=>{isFunction$3(e)?e(r):e.value=r})},EVENT_CODE={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},UPDATE_MODEL_EVENT="update:modelValue",CHANGE_EVENT="change",INPUT_EVENT="input",componentSizes=["","default","small","large"],componentSizeMap={large:40,default:32,small:24},getComponentSize=t=>componentSizeMap[t||"default"],isValidComponentSize=t=>["",...componentSizes].includes(t);var PatchFlags=(t=>(t[t.TEXT=1]="TEXT",t[t.CLASS=2]="CLASS",t[t.STYLE=4]="STYLE",t[t.PROPS=8]="PROPS",t[t.FULL_PROPS=16]="FULL_PROPS",t[t.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",t[t.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",t[t.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",t[t.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",t[t.NEED_PATCH=512]="NEED_PATCH",t[t.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",t[t.HOISTED=-1]="HOISTED",t[t.BAIL=-2]="BAIL",t))(PatchFlags||{});const unique=t=>[...new Set(t)],castArray=t=>!t&&t!==0?[]:Array.isArray(t)?t:[t],isKorean=t=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(t),generateId=()=>Math.floor(Math.random()*1e4),mutable=t=>t,DEFAULT_EXCLUDE_KEYS=["class","style"],LISTENER_PREFIX=/^on[A-Z]/,useAttrs=(t={})=>{const{excludeListeners:r=!1,excludeKeys:e}=t,n=computed(()=>((e==null?void 0:e.value)||[]).concat(DEFAULT_EXCLUDE_KEYS)),o=getCurrentInstance();return computed(o?()=>{var s;return fromPairs(Object.entries((s=o.proxy)==null?void 0:s.$attrs).filter(([a])=>!n.value.includes(a)&&!(r&&LISTENER_PREFIX.test(a))))}:()=>({}))},useDeprecated=({from:t,replacement:r,scope:e,version:n,ref:o,type:s="API"},a)=>{watch(()=>unref(a),i=>{},{immediate:!0})},useDraggable=(t,r,e)=>{let n={offsetX:0,offsetY:0};const o=i=>{const u=i.clientX,c=i.clientY,{offsetX:d,offsetY:m}=n,v=t.value.getBoundingClientRect(),g=v.left,b=v.top,T=v.width,k=v.height,y=document.documentElement.clientWidth,A=document.documentElement.clientHeight,V=-g+d,he=-b+m,ae=y-g-T+d,Ne=A-b-k+m,_e=re=>{const ue=Math.min(Math.max(d+re.clientX-u,V),ae),ze=Math.min(Math.max(m+re.clientY-c,he),Ne);n={offsetX:ue,offsetY:ze},t.value.style.transform=`translate(${addUnit(ue)}, ${addUnit(ze)})`},Ce=()=>{document.removeEventListener("mousemove",_e),document.removeEventListener("mouseup",Ce)};document.addEventListener("mousemove",_e),document.addEventListener("mouseup",Ce)},s=()=>{r.value&&t.value&&r.value.addEventListener("mousedown",o)},a=()=>{r.value&&t.value&&r.value.removeEventListener("mousedown",o)};onMounted(()=>{watchEffect(()=>{e.value?s():a()})}),onBeforeUnmount(()=>{a()})};var English={name:"en",el:{colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"}}};const buildTranslator=t=>(r,e)=>translate(r,e,unref(t)),translate=(t,r,e)=>get(e,t,t).replace(/\{(\w+)\}/g,(n,o)=>{var s;return`${(s=r==null?void 0:r[o])!=null?s:`{${o}}`}`}),buildLocaleContext=t=>{const r=computed(()=>unref(t).name),e=isRef(t)?t:ref(t);return{lang:r,locale:e,t:buildTranslator(t)}},localeContextKey=Symbol("localeContextKey"),useLocale=t=>{const r=t||inject(localeContextKey,ref());return buildLocaleContext(computed(()=>r.value||English))},defaultNamespace="el",statePrefix="is-",_bem=(t,r,e,n,o)=>{let s=`${t}-${r}`;return e&&(s+=`-${e}`),n&&(s+=`__${n}`),o&&(s+=`--${o}`),s},namespaceContextKey=Symbol("namespaceContextKey"),useGetDerivedNamespace=t=>{const r=t||(getCurrentInstance()?inject(namespaceContextKey,ref(defaultNamespace)):ref(defaultNamespace));return computed(()=>unref(r)||defaultNamespace)},useNamespace=(t,r)=>{const e=useGetDerivedNamespace(r);return{namespace:e,b:(T="")=>_bem(e.value,t,T,"",""),e:T=>T?_bem(e.value,t,"",T,""):"",m:T=>T?_bem(e.value,t,"","",T):"",be:(T,k)=>T&&k?_bem(e.value,t,T,k,""):"",em:(T,k)=>T&&k?_bem(e.value,t,"",T,k):"",bm:(T,k)=>T&&k?_bem(e.value,t,T,"",k):"",bem:(T,k,y)=>T&&k&&y?_bem(e.value,t,T,k,y):"",is:(T,...k)=>{const y=k.length>=1?k[0]:!0;return T&&y?`${statePrefix}${T}`:""},cssVar:T=>{const k={};for(const y in T)T[y]&&(k[`--${e.value}-${y}`]=T[y]);return k},cssVarName:T=>`--${e.value}-${T}`,cssVarBlock:T=>{const k={};for(const y in T)T[y]&&(k[`--${e.value}-${t}-${y}`]=T[y]);return k},cssVarBlockName:T=>`--${e.value}-${t}-${T}`}},useLockscreen=(t,r={})=>{isRef(t)||throwError("[useLockscreen]","You need to pass a ref param to this function");const e=r.ns||useNamespace("popup"),n=computed$1(()=>e.bm("parent","hidden"));if(!isClient||hasClass(document.body,n.value))return;let o=0,s=!1,a="0";const i=()=>{setTimeout(()=>{removeClass(document==null?void 0:document.body,n.value),s&&document&&(document.body.style.width=a)},200)};watch(t,u=>{if(!u){i();return}s=!hasClass(document.body,n.value),s&&(a=document.body.style.width),o=getScrollBarWidth(e.namespace.value);const c=document.documentElement.clientHeight<document.body.scrollHeight,d=getStyle(document.body,"overflowY");o>0&&(c||d==="scroll")&&s&&(document.body.style.width=`calc(100% - ${o}px)`),addClass(document.body,n.value)}),onScopeDispose(()=>i())},_prop=buildProp({type:definePropType(Boolean),default:null}),_event=buildProp({type:definePropType(Function)}),createModelToggleComposable=t=>{const r=`update:${t}`,e=`onUpdate:${t}`,n=[r],o={[t]:_prop,[e]:_event};return{useModelToggle:({indicator:a,toggleReason:i,shouldHideWhenRouteChanges:u,shouldProceed:c,onShow:d,onHide:m})=>{const v=getCurrentInstance(),{emit:g}=v,b=v.props,T=computed(()=>isFunction$3(b[e])),k=computed(()=>b[t]===null),y=_e=>{a.value!==!0&&(a.value=!0,i&&(i.value=_e),isFunction$3(d)&&d(_e))},A=_e=>{a.value!==!1&&(a.value=!1,i&&(i.value=_e),isFunction$3(m)&&m(_e))},V=_e=>{if(b.disabled===!0||isFunction$3(c)&&!c())return;const Ce=T.value&&isClient;Ce&&g(r,!0),(k.value||!Ce)&&y(_e)},he=_e=>{if(b.disabled===!0||!isClient)return;const Ce=T.value&&isClient;Ce&&g(r,!1),(k.value||!Ce)&&A(_e)},ae=_e=>{isBoolean$1(_e)&&(b.disabled&&_e?T.value&&g(r,!1):a.value!==_e&&(_e?y():A()))},Ne=()=>{a.value?he():V()};return watch(()=>b[t],ae),u&&v.appContext.config.globalProperties.$route!==void 0&&watch(()=>({...v.proxy.$route}),()=>{u.value&&a.value&&he()}),onMounted(()=>{ae(b[t])}),{hide:he,show:V,toggle:Ne,hasUpdateHandler:T}},useModelToggleProps:o,useModelToggleEmits:n}};createModelToggleComposable("modelValue");const useProp=t=>{const r=getCurrentInstance();return computed(()=>{var e,n;return(n=(e=r==null?void 0:r.proxy)==null?void 0:e.$props)==null?void 0:n[t]})};var E="top",R="bottom",W="right",P="left",me="auto",G=[E,R,W,P],U="start",J="end",Xe="clippingParents",je="viewport",K="popper",Ye="reference",De=G.reduce(function(t,r){return t.concat([r+"-"+U,r+"-"+J])},[]),Ee=[].concat(G,[me]).reduce(function(t,r){return t.concat([r,r+"-"+U,r+"-"+J])},[]),Ge="beforeRead",Je="read",Ke="afterRead",Qe="beforeMain",Ze="main",et="afterMain",tt$1="beforeWrite",nt="write",rt="afterWrite",ot=[Ge,Je,Ke,Qe,Ze,et,tt$1,nt,rt];function C(t){return t?(t.nodeName||"").toLowerCase():null}function H(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var r=t.ownerDocument;return r&&r.defaultView||window}return t}function Q(t){var r=H(t).Element;return t instanceof r||t instanceof Element}function B(t){var r=H(t).HTMLElement;return t instanceof r||t instanceof HTMLElement}function Pe(t){if(typeof ShadowRoot>"u")return!1;var r=H(t).ShadowRoot;return t instanceof r||t instanceof ShadowRoot}function Mt(t){var r=t.state;Object.keys(r.elements).forEach(function(e){var n=r.styles[e]||{},o=r.attributes[e]||{},s=r.elements[e];!B(s)||!C(s)||(Object.assign(s.style,n),Object.keys(o).forEach(function(a){var i=o[a];i===!1?s.removeAttribute(a):s.setAttribute(a,i===!0?"":i)}))})}function Rt(t){var r=t.state,e={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(r.elements.popper.style,e.popper),r.styles=e,r.elements.arrow&&Object.assign(r.elements.arrow.style,e.arrow),function(){Object.keys(r.elements).forEach(function(n){var o=r.elements[n],s=r.attributes[n]||{},a=Object.keys(r.styles.hasOwnProperty(n)?r.styles[n]:e[n]),i=a.reduce(function(u,c){return u[c]="",u},{});!B(o)||!C(o)||(Object.assign(o.style,i),Object.keys(s).forEach(function(u){o.removeAttribute(u)}))})}}var Ae={name:"applyStyles",enabled:!0,phase:"write",fn:Mt,effect:Rt,requires:["computeStyles"]};function q(t){return t.split("-")[0]}var X=Math.max,ve=Math.min,Z=Math.round;function ee(t,r){r===void 0&&(r=!1);var e=t.getBoundingClientRect(),n=1,o=1;if(B(t)&&r){var s=t.offsetHeight,a=t.offsetWidth;a>0&&(n=Z(e.width)/a||1),s>0&&(o=Z(e.height)/s||1)}return{width:e.width/n,height:e.height/o,top:e.top/o,right:e.right/n,bottom:e.bottom/o,left:e.left/n,x:e.left/n,y:e.top/o}}function ke(t){var r=ee(t),e=t.offsetWidth,n=t.offsetHeight;return Math.abs(r.width-e)<=1&&(e=r.width),Math.abs(r.height-n)<=1&&(n=r.height),{x:t.offsetLeft,y:t.offsetTop,width:e,height:n}}function it(t,r){var e=r.getRootNode&&r.getRootNode();if(t.contains(r))return!0;if(e&&Pe(e)){var n=r;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function N(t){return H(t).getComputedStyle(t)}function Wt(t){return["table","td","th"].indexOf(C(t))>=0}function I(t){return((Q(t)?t.ownerDocument:t.document)||window.document).documentElement}function ge(t){return C(t)==="html"?t:t.assignedSlot||t.parentNode||(Pe(t)?t.host:null)||I(t)}function at(t){return!B(t)||N(t).position==="fixed"?null:t.offsetParent}function Bt(t){var r=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,e=navigator.userAgent.indexOf("Trident")!==-1;if(e&&B(t)){var n=N(t);if(n.position==="fixed")return null}var o=ge(t);for(Pe(o)&&(o=o.host);B(o)&&["html","body"].indexOf(C(o))<0;){var s=N(o);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||r&&s.willChange==="filter"||r&&s.filter&&s.filter!=="none")return o;o=o.parentNode}return null}function se(t){for(var r=H(t),e=at(t);e&&Wt(e)&&N(e).position==="static";)e=at(e);return e&&(C(e)==="html"||C(e)==="body"&&N(e).position==="static")?r:e||Bt(t)||r}function Le(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function fe(t,r,e){return X(t,ve(r,e))}function St(t,r,e){var n=fe(t,r,e);return n>e?e:n}function st(){return{top:0,right:0,bottom:0,left:0}}function ft(t){return Object.assign({},st(),t)}function ct(t,r){return r.reduce(function(e,n){return e[n]=t,e},{})}var Tt=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,ft(typeof t!="number"?t:ct(t,G))};function Ht(t){var r,e=t.state,n=t.name,o=t.options,s=e.elements.arrow,a=e.modifiersData.popperOffsets,i=q(e.placement),u=Le(i),c=[P,W].indexOf(i)>=0,d=c?"height":"width";if(!(!s||!a)){var m=Tt(o.padding,e),v=ke(s),g=u==="y"?E:P,b=u==="y"?R:W,T=e.rects.reference[d]+e.rects.reference[u]-a[u]-e.rects.popper[d],k=a[u]-e.rects.reference[u],y=se(s),A=y?u==="y"?y.clientHeight||0:y.clientWidth||0:0,V=T/2-k/2,he=m[g],ae=A-v[d]-m[b],Ne=A/2-v[d]/2+V,_e=fe(he,Ne,ae),Ce=u;e.modifiersData[n]=(r={},r[Ce]=_e,r.centerOffset=_e-Ne,r)}}function Ct(t){var r=t.state,e=t.options,n=e.element,o=n===void 0?"[data-popper-arrow]":n;o!=null&&(typeof o=="string"&&(o=r.elements.popper.querySelector(o),!o)||!it(r.elements.popper,o)||(r.elements.arrow=o))}var pt={name:"arrow",enabled:!0,phase:"main",fn:Ht,effect:Ct,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function te(t){return t.split("-")[1]}var qt={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Vt(t){var r=t.x,e=t.y,n=window,o=n.devicePixelRatio||1;return{x:Z(r*o)/o||0,y:Z(e*o)/o||0}}function ut(t){var r,e=t.popper,n=t.popperRect,o=t.placement,s=t.variation,a=t.offsets,i=t.position,u=t.gpuAcceleration,c=t.adaptive,d=t.roundOffsets,m=t.isFixed,v=a.x,g=v===void 0?0:v,b=a.y,T=b===void 0?0:b,k=typeof d=="function"?d({x:g,y:T}):{x:g,y:T};g=k.x,T=k.y;var y=a.hasOwnProperty("x"),A=a.hasOwnProperty("y"),V=P,he=E,ae=window;if(c){var Ne=se(e),_e="clientHeight",Ce="clientWidth";if(Ne===H(e)&&(Ne=I(e),N(Ne).position!=="static"&&i==="absolute"&&(_e="scrollHeight",Ce="scrollWidth")),Ne=Ne,o===E||(o===P||o===W)&&s===J){he=R;var re=m&&Ne===ae&&ae.visualViewport?ae.visualViewport.height:Ne[_e];T-=re-n.height,T*=u?1:-1}if(o===P||(o===E||o===R)&&s===J){V=W;var ue=m&&Ne===ae&&ae.visualViewport?ae.visualViewport.width:Ne[Ce];g-=ue-n.width,g*=u?1:-1}}var ze=Object.assign({position:i},c&&qt),le=d===!0?Vt({x:g,y:T}):{x:g,y:T};if(g=le.x,T=le.y,u){var de;return Object.assign({},ze,(de={},de[he]=A?"0":"",de[V]=y?"0":"",de.transform=(ae.devicePixelRatio||1)<=1?"translate("+g+"px, "+T+"px)":"translate3d("+g+"px, "+T+"px, 0)",de))}return Object.assign({},ze,(r={},r[he]=A?T+"px":"",r[V]=y?g+"px":"",r.transform="",r))}function Nt(t){var r=t.state,e=t.options,n=e.gpuAcceleration,o=n===void 0?!0:n,s=e.adaptive,a=s===void 0?!0:s,i=e.roundOffsets,u=i===void 0?!0:i,c={placement:q(r.placement),variation:te(r.placement),popper:r.elements.popper,popperRect:r.rects.popper,gpuAcceleration:o,isFixed:r.options.strategy==="fixed"};r.modifiersData.popperOffsets!=null&&(r.styles.popper=Object.assign({},r.styles.popper,ut(Object.assign({},c,{offsets:r.modifiersData.popperOffsets,position:r.options.strategy,adaptive:a,roundOffsets:u})))),r.modifiersData.arrow!=null&&(r.styles.arrow=Object.assign({},r.styles.arrow,ut(Object.assign({},c,{offsets:r.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-placement":r.placement})}var Me={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Nt,data:{}},ye={passive:!0};function It(t){var r=t.state,e=t.instance,n=t.options,o=n.scroll,s=o===void 0?!0:o,a=n.resize,i=a===void 0?!0:a,u=H(r.elements.popper),c=[].concat(r.scrollParents.reference,r.scrollParents.popper);return s&&c.forEach(function(d){d.addEventListener("scroll",e.update,ye)}),i&&u.addEventListener("resize",e.update,ye),function(){s&&c.forEach(function(d){d.removeEventListener("scroll",e.update,ye)}),i&&u.removeEventListener("resize",e.update,ye)}}var Re={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:It,data:{}},_t={left:"right",right:"left",bottom:"top",top:"bottom"};function be(t){return t.replace(/left|right|bottom|top/g,function(r){return _t[r]})}var zt={start:"end",end:"start"};function lt(t){return t.replace(/start|end/g,function(r){return zt[r]})}function We(t){var r=H(t),e=r.pageXOffset,n=r.pageYOffset;return{scrollLeft:e,scrollTop:n}}function Be(t){return ee(I(t)).left+We(t).scrollLeft}function Ft(t){var r=H(t),e=I(t),n=r.visualViewport,o=e.clientWidth,s=e.clientHeight,a=0,i=0;return n&&(o=n.width,s=n.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(a=n.offsetLeft,i=n.offsetTop)),{width:o,height:s,x:a+Be(t),y:i}}function Ut(t){var r,e=I(t),n=We(t),o=(r=t.ownerDocument)==null?void 0:r.body,s=X(e.scrollWidth,e.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),a=X(e.scrollHeight,e.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),i=-n.scrollLeft+Be(t),u=-n.scrollTop;return N(o||e).direction==="rtl"&&(i+=X(e.clientWidth,o?o.clientWidth:0)-s),{width:s,height:a,x:i,y:u}}function Se(t){var r=N(t),e=r.overflow,n=r.overflowX,o=r.overflowY;return/auto|scroll|overlay|hidden/.test(e+o+n)}function dt(t){return["html","body","#document"].indexOf(C(t))>=0?t.ownerDocument.body:B(t)&&Se(t)?t:dt(ge(t))}function ce(t,r){var e;r===void 0&&(r=[]);var n=dt(t),o=n===((e=t.ownerDocument)==null?void 0:e.body),s=H(n),a=o?[s].concat(s.visualViewport||[],Se(n)?n:[]):n,i=r.concat(a);return o?i:i.concat(ce(ge(a)))}function Te(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Xt(t){var r=ee(t);return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function ht(t,r){return r===je?Te(Ft(t)):Q(r)?Xt(r):Te(Ut(I(t)))}function Yt(t){var r=ce(ge(t)),e=["absolute","fixed"].indexOf(N(t).position)>=0,n=e&&B(t)?se(t):t;return Q(n)?r.filter(function(o){return Q(o)&&it(o,n)&&C(o)!=="body"}):[]}function Gt(t,r,e){var n=r==="clippingParents"?Yt(t):[].concat(r),o=[].concat(n,[e]),s=o[0],a=o.reduce(function(i,u){var c=ht(t,u);return i.top=X(c.top,i.top),i.right=ve(c.right,i.right),i.bottom=ve(c.bottom,i.bottom),i.left=X(c.left,i.left),i},ht(t,s));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function mt(t){var r=t.reference,e=t.element,n=t.placement,o=n?q(n):null,s=n?te(n):null,a=r.x+r.width/2-e.width/2,i=r.y+r.height/2-e.height/2,u;switch(o){case E:u={x:a,y:r.y-e.height};break;case R:u={x:a,y:r.y+r.height};break;case W:u={x:r.x+r.width,y:i};break;case P:u={x:r.x-e.width,y:i};break;default:u={x:r.x,y:r.y}}var c=o?Le(o):null;if(c!=null){var d=c==="y"?"height":"width";switch(s){case U:u[c]=u[c]-(r[d]/2-e[d]/2);break;case J:u[c]=u[c]+(r[d]/2-e[d]/2);break}}return u}function ne(t,r){r===void 0&&(r={});var e=r,n=e.placement,o=n===void 0?t.placement:n,s=e.boundary,a=s===void 0?Xe:s,i=e.rootBoundary,u=i===void 0?je:i,c=e.elementContext,d=c===void 0?K:c,m=e.altBoundary,v=m===void 0?!1:m,g=e.padding,b=g===void 0?0:g,T=ft(typeof b!="number"?b:ct(b,G)),k=d===K?Ye:K,y=t.rects.popper,A=t.elements[v?k:d],V=Gt(Q(A)?A:A.contextElement||I(t.elements.popper),a,u),he=ee(t.elements.reference),ae=mt({reference:he,element:y,strategy:"absolute",placement:o}),Ne=Te(Object.assign({},y,ae)),_e=d===K?Ne:he,Ce={top:V.top-_e.top+T.top,bottom:_e.bottom-V.bottom+T.bottom,left:V.left-_e.left+T.left,right:_e.right-V.right+T.right},re=t.modifiersData.offset;if(d===K&&re){var ue=re[o];Object.keys(Ce).forEach(function(ze){var le=[W,R].indexOf(ze)>=0?1:-1,de=[E,R].indexOf(ze)>=0?"y":"x";Ce[ze]+=ue[de]*le})}return Ce}function Jt(t,r){r===void 0&&(r={});var e=r,n=e.placement,o=e.boundary,s=e.rootBoundary,a=e.padding,i=e.flipVariations,u=e.allowedAutoPlacements,c=u===void 0?Ee:u,d=te(n),m=d?i?De:De.filter(function(b){return te(b)===d}):G,v=m.filter(function(b){return c.indexOf(b)>=0});v.length===0&&(v=m);var g=v.reduce(function(b,T){return b[T]=ne(t,{placement:T,boundary:o,rootBoundary:s,padding:a})[q(T)],b},{});return Object.keys(g).sort(function(b,T){return g[b]-g[T]})}function Kt(t){if(q(t)===me)return[];var r=be(t);return[lt(t),r,lt(r)]}function Qt(t){var r=t.state,e=t.options,n=t.name;if(!r.modifiersData[n]._skip){for(var o=e.mainAxis,s=o===void 0?!0:o,a=e.altAxis,i=a===void 0?!0:a,u=e.fallbackPlacements,c=e.padding,d=e.boundary,m=e.rootBoundary,v=e.altBoundary,g=e.flipVariations,b=g===void 0?!0:g,T=e.allowedAutoPlacements,k=r.options.placement,y=q(k),A=y===k,V=u||(A||!b?[be(k)]:Kt(k)),he=[k].concat(V).reduce(function(Fe,or){return Fe.concat(q(or)===me?Jt(r,{placement:or,boundary:d,rootBoundary:m,padding:c,flipVariations:b,allowedAutoPlacements:T}):or)},[]),ae=r.rects.reference,Ne=r.rects.popper,_e=new Map,Ce=!0,re=he[0],ue=0;ue<he.length;ue++){var ze=he[ue],le=q(ze),de=te(ze)===U,Ie=[E,R].indexOf(le)>=0,ie=Ie?"width":"height",Ve=ne(r,{placement:ze,boundary:d,rootBoundary:m,altBoundary:v,padding:c}),Ue=Ie?de?W:P:de?R:E;ae[ie]>Ne[ie]&&(Ue=be(Ue));var Dt=be(Ue),tr=[];if(s&&tr.push(Ve[le]<=0),i&&tr.push(Ve[Ue]<=0,Ve[Dt]<=0),tr.every(function(Fe){return Fe})){re=ze,Ce=!1;break}_e.set(ze,tr)}if(Ce)for(var dr=b?3:1,fr=function(Fe){var or=he.find(function(ir){var $e=_e.get(ir);if($e)return $e.slice(0,Fe).every(function(er){return er})});if(or)return re=or,"break"},sr=dr;sr>0;sr--){var hr=fr(sr);if(hr==="break")break}r.placement!==re&&(r.modifiersData[n]._skip=!0,r.placement=re,r.reset=!0)}}var vt={name:"flip",enabled:!0,phase:"main",fn:Qt,requiresIfExists:["offset"],data:{_skip:!1}};function gt(t,r,e){return e===void 0&&(e={x:0,y:0}),{top:t.top-r.height-e.y,right:t.right-r.width+e.x,bottom:t.bottom-r.height+e.y,left:t.left-r.width-e.x}}function yt(t){return[E,W,R,P].some(function(r){return t[r]>=0})}function Zt(t){var r=t.state,e=t.name,n=r.rects.reference,o=r.rects.popper,s=r.modifiersData.preventOverflow,a=ne(r,{elementContext:"reference"}),i=ne(r,{altBoundary:!0}),u=gt(a,n),c=gt(i,o,s),d=yt(u),m=yt(c);r.modifiersData[e]={referenceClippingOffsets:u,popperEscapeOffsets:c,isReferenceHidden:d,hasPopperEscaped:m},r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":m})}var bt={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Zt};function en(t,r,e){var n=q(t),o=[P,E].indexOf(n)>=0?-1:1,s=typeof e=="function"?e(Object.assign({},r,{placement:t})):e,a=s[0],i=s[1];return a=a||0,i=(i||0)*o,[P,W].indexOf(n)>=0?{x:i,y:a}:{x:a,y:i}}function tn(t){var r=t.state,e=t.options,n=t.name,o=e.offset,s=o===void 0?[0,0]:o,a=Ee.reduce(function(d,m){return d[m]=en(m,r.rects,s),d},{}),i=a[r.placement],u=i.x,c=i.y;r.modifiersData.popperOffsets!=null&&(r.modifiersData.popperOffsets.x+=u,r.modifiersData.popperOffsets.y+=c),r.modifiersData[n]=a}var wt={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:tn};function nn(t){var r=t.state,e=t.name;r.modifiersData[e]=mt({reference:r.rects.reference,element:r.rects.popper,strategy:"absolute",placement:r.placement})}var He={name:"popperOffsets",enabled:!0,phase:"read",fn:nn,data:{}};function rn(t){return t==="x"?"y":"x"}function on(t){var r=t.state,e=t.options,n=t.name,o=e.mainAxis,s=o===void 0?!0:o,a=e.altAxis,i=a===void 0?!1:a,u=e.boundary,c=e.rootBoundary,d=e.altBoundary,m=e.padding,v=e.tether,g=v===void 0?!0:v,b=e.tetherOffset,T=b===void 0?0:b,k=ne(r,{boundary:u,rootBoundary:c,padding:m,altBoundary:d}),y=q(r.placement),A=te(r.placement),V=!A,he=Le(y),ae=rn(he),Ne=r.modifiersData.popperOffsets,_e=r.rects.reference,Ce=r.rects.popper,re=typeof T=="function"?T(Object.assign({},r.rects,{placement:r.placement})):T,ue=typeof re=="number"?{mainAxis:re,altAxis:re}:Object.assign({mainAxis:0,altAxis:0},re),ze=r.modifiersData.offset?r.modifiersData.offset[r.placement]:null,le={x:0,y:0};if(Ne){if(s){var de,Ie=he==="y"?E:P,ie=he==="y"?R:W,Ve=he==="y"?"height":"width",Ue=Ne[he],Dt=Ue+k[Ie],tr=Ue-k[ie],dr=g?-Ce[Ve]/2:0,fr=A===U?_e[Ve]:Ce[Ve],sr=A===U?-Ce[Ve]:-_e[Ve],hr=r.elements.arrow,Fe=g&&hr?ke(hr):{width:0,height:0},or=r.modifiersData["arrow#persistent"]?r.modifiersData["arrow#persistent"].padding:st(),ir=or[Ie],$e=or[ie],er=fe(0,_e[Ve],Fe[Ve]),nr=V?_e[Ve]/2-dr-er-ir-ue.mainAxis:fr-er-ir-ue.mainAxis,Pt=V?-_e[Ve]/2+dr+er+$e+ue.mainAxis:sr+er+$e+ue.mainAxis,rr=r.elements.arrow&&se(r.elements.arrow),kt=rr?he==="y"?rr.clientTop||0:rr.clientLeft||0:0,Et=(de=ze==null?void 0:ze[he])!=null?de:0,cr=Ue+nr-Et-kt,mr=Ue+Pt-Et,yr=fe(g?ve(Dt,cr):Dt,Ue,g?X(tr,mr):tr);Ne[he]=yr,le[he]=yr-Ue}if(i){var Tr,Ir=he==="x"?E:P,kr=he==="x"?R:W,Ar=Ne[ae],Rr=ae==="y"?"height":"width",Mn=Ar+k[Ir],Or=Ar-k[kr],Pr=[E,P].indexOf(y)!==-1,Nr=(Tr=ze==null?void 0:ze[ae])!=null?Tr:0,Wr=Pr?Mn:Ar-_e[Rr]-Ce[Rr]-Nr+ue.altAxis,Yr=Pr?Ar+_e[Rr]+Ce[Rr]-Nr-ue.altAxis:Or,Ur=g&&Pr?St(Wr,Ar,Yr):fe(g?Wr:Mn,Ar,g?Yr:Or);Ne[ae]=Ur,le[ae]=Ur-Ar}r.modifiersData[n]=le}}var xt={name:"preventOverflow",enabled:!0,phase:"main",fn:on,requiresIfExists:["offset"]};function an(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function sn(t){return t===H(t)||!B(t)?We(t):an(t)}function fn(t){var r=t.getBoundingClientRect(),e=Z(r.width)/t.offsetWidth||1,n=Z(r.height)/t.offsetHeight||1;return e!==1||n!==1}function cn(t,r,e){e===void 0&&(e=!1);var n=B(r),o=B(r)&&fn(r),s=I(r),a=ee(t,o),i={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(n||!n&&!e)&&((C(r)!=="body"||Se(s))&&(i=sn(r)),B(r)?(u=ee(r,!0),u.x+=r.clientLeft,u.y+=r.clientTop):s&&(u.x=Be(s))),{x:a.left+i.scrollLeft-u.x,y:a.top+i.scrollTop-u.y,width:a.width,height:a.height}}function pn(t){var r=new Map,e=new Set,n=[];t.forEach(function(s){r.set(s.name,s)});function o(s){e.add(s.name);var a=[].concat(s.requires||[],s.requiresIfExists||[]);a.forEach(function(i){if(!e.has(i)){var u=r.get(i);u&&o(u)}}),n.push(s)}return t.forEach(function(s){e.has(s.name)||o(s)}),n}function un(t){var r=pn(t);return ot.reduce(function(e,n){return e.concat(r.filter(function(o){return o.phase===n}))},[])}function ln(t){var r;return function(){return r||(r=new Promise(function(e){Promise.resolve().then(function(){r=void 0,e(t())})})),r}}function dn(t){var r=t.reduce(function(e,n){var o=e[n.name];return e[n.name]=o?Object.assign({},o,n,{options:Object.assign({},o.options,n.options),data:Object.assign({},o.data,n.data)}):n,e},{});return Object.keys(r).map(function(e){return r[e]})}var Ot={placement:"bottom",modifiers:[],strategy:"absolute"};function $t(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return!r.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function we(t){t===void 0&&(t={});var r=t,e=r.defaultModifiers,n=e===void 0?[]:e,o=r.defaultOptions,s=o===void 0?Ot:o;return function(a,i,u){u===void 0&&(u=s);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ot,s),modifiersData:{},elements:{reference:a,popper:i},attributes:{},styles:{}},d=[],m=!1,v={state:c,setOptions:function(T){var k=typeof T=="function"?T(c.options):T;b(),c.options=Object.assign({},s,c.options,k),c.scrollParents={reference:Q(a)?ce(a):a.contextElement?ce(a.contextElement):[],popper:ce(i)};var y=un(dn([].concat(n,c.options.modifiers)));return c.orderedModifiers=y.filter(function(A){return A.enabled}),g(),v.update()},forceUpdate:function(){if(!m){var T=c.elements,k=T.reference,y=T.popper;if($t(k,y)){c.rects={reference:cn(k,se(y),c.options.strategy==="fixed"),popper:ke(y)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(Ce){return c.modifiersData[Ce.name]=Object.assign({},Ce.data)});for(var A=0;A<c.orderedModifiers.length;A++){if(c.reset===!0){c.reset=!1,A=-1;continue}var V=c.orderedModifiers[A],he=V.fn,ae=V.options,Ne=ae===void 0?{}:ae,_e=V.name;typeof he=="function"&&(c=he({state:c,options:Ne,name:_e,instance:v})||c)}}}},update:ln(function(){return new Promise(function(T){v.forceUpdate(),T(c)})}),destroy:function(){b(),m=!0}};if(!$t(a,i))return v;v.setOptions(u).then(function(T){!m&&u.onFirstUpdate&&u.onFirstUpdate(T)});function g(){c.orderedModifiers.forEach(function(T){var k=T.name,y=T.options,A=y===void 0?{}:y,V=T.effect;if(typeof V=="function"){var he=V({state:c,name:k,instance:v,options:A}),ae=function(){};d.push(he||ae)}})}function b(){d.forEach(function(T){return T()}),d=[]}return v}}we();var mn=[Re,He,Me,Ae];we({defaultModifiers:mn});var gn=[Re,He,Me,Ae,wt,vt,xt,pt,bt],yn=we({defaultModifiers:gn});const usePopper=(t,r,e={})=>{const n={name:"updateState",enabled:!0,phase:"write",fn:({state:u})=>{const c=deriveState(u);Object.assign(a.value,c)},requires:["computeStyles"]},o=computed(()=>{const{onFirstUpdate:u,placement:c,strategy:d,modifiers:m}=unref(e);return{onFirstUpdate:u,placement:c||"bottom",strategy:d||"absolute",modifiers:[...m||[],n,{name:"applyStyles",enabled:!1}]}}),s=shallowRef(),a=ref({styles:{popper:{position:unref(o).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),i=()=>{s.value&&(s.value.destroy(),s.value=void 0)};return watch(o,u=>{const c=unref(s);c&&c.setOptions(u)},{deep:!0}),watch([t,r],([u,c])=>{i(),!(!u||!c)&&(s.value=yn(u,c,unref(o)))}),onBeforeUnmount(()=>{i()}),{state:computed(()=>{var u;return{...((u=unref(s))==null?void 0:u.state)||{}}}),styles:computed(()=>unref(a).styles),attributes:computed(()=>unref(a).attributes),update:()=>{var u;return(u=unref(s))==null?void 0:u.update()},forceUpdate:()=>{var u;return(u=unref(s))==null?void 0:u.forceUpdate()},instanceRef:computed(()=>unref(s))}};function deriveState(t){const r=Object.keys(t.elements),e=fromPairs(r.map(o=>[o,t.styles[o]||{}])),n=fromPairs(r.map(o=>[o,t.attributes[o]]));return{styles:e,attributes:n}}const useSameTarget=t=>{if(!t)return{onClick:NOOP,onMousedown:NOOP,onMouseup:NOOP};let r=!1,e=!1;return{onClick:a=>{r&&e&&t(a),r=e=!1},onMousedown:a=>{r=a.target===a.currentTarget},onMouseup:a=>{e=a.target===a.currentTarget}}};function useTimeout(){let t;const r=(n,o)=>{e(),t=window.setTimeout(n,o)},e=()=>window.clearTimeout(t);return tryOnScopeDispose(()=>e()),{registerTimeout:r,cancelTimeout:e}}const defaultIdInjection={prefix:Math.floor(Math.random()*1e4),current:0},ID_INJECTION_KEY=Symbol("elIdInjection"),useIdInjection=()=>getCurrentInstance()?inject(ID_INJECTION_KEY,defaultIdInjection):defaultIdInjection,useId=t=>{const r=useIdInjection(),e=useGetDerivedNamespace();return computed(()=>unref(t)||`${e.value}-id-${r.prefix}-${r.current++}`)};let registeredEscapeHandlers=[];const cachedHandler=t=>{const r=t;r.key===EVENT_CODE.esc&&registeredEscapeHandlers.forEach(e=>e(r))},useEscapeKeydown=t=>{onMounted(()=>{registeredEscapeHandlers.length===0&&document.addEventListener("keydown",cachedHandler),isClient&&registeredEscapeHandlers.push(t)}),onBeforeUnmount(()=>{registeredEscapeHandlers=registeredEscapeHandlers.filter(r=>r!==t),registeredEscapeHandlers.length===0&&isClient&&document.removeEventListener("keydown",cachedHandler)})};let cachedContainer;const usePopperContainerId=()=>{const t=useGetDerivedNamespace(),r=useIdInjection(),e=computed(()=>`${t.value}-popper-container-${r.prefix}`),n=computed(()=>`#${e.value}`);return{id:e,selector:n}},createContainer=t=>{const r=document.createElement("div");return r.id=t,document.body.appendChild(r),r},usePopperContainer=()=>{const{id:t,selector:r}=usePopperContainerId();return onBeforeMount(()=>{isClient&&!cachedContainer&&!document.body.querySelector(r.value)&&(cachedContainer=createContainer(t.value))}),{id:t,selector:r}},useDelayedToggleProps=buildProps({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),useDelayedToggle=({showAfter:t,hideAfter:r,autoClose:e,open:n,close:o})=>{const{registerTimeout:s}=useTimeout(),{registerTimeout:a,cancelTimeout:i}=useTimeout();return{onOpen:d=>{s(()=>{n(d);const m=unref(e);isNumber$1(m)&&m>0&&a(()=>{o(d)},m)},unref(t))},onClose:d=>{i(),s(()=>{o(d)},unref(r))}}},FORWARD_REF_INJECTION_KEY=Symbol("elForwardRef"),useForwardRef=t=>{provide(FORWARD_REF_INJECTION_KEY,{setForwardRef:e=>{t.value=e}})},useForwardRefDirective=t=>({mounted(r){t(r)},updated(r){t(r)},unmounted(){t(null)}}),zIndex=ref(0),defaultInitialZIndex=2e3,zIndexContextKey=Symbol("zIndexContextKey"),useZIndex=t=>{const r=t||(getCurrentInstance()?inject(zIndexContextKey,void 0):void 0),e=computed(()=>{const s=unref(r);return isNumber$1(s)?s:defaultInitialZIndex}),n=computed(()=>e.value+zIndex.value);return{initialZIndex:e,currentZIndex:n,nextZIndex:()=>(zIndex.value++,n.value)}};function useCursor(t){const r=ref();function e(){if(t.value==null)return;const{selectionStart:o,selectionEnd:s,value:a}=t.value;if(o==null||s==null)return;const i=a.slice(0,Math.max(0,o)),u=a.slice(Math.max(0,s));r.value={selectionStart:o,selectionEnd:s,value:a,beforeTxt:i,afterTxt:u}}function n(){if(t.value==null||r.value==null)return;const{value:o}=t.value,{beforeTxt:s,afterTxt:a,selectionStart:i}=r.value;if(s==null||a==null||i==null)return;let u=o.length;if(o.endsWith(a))u=o.length-a.length;else if(o.startsWith(s))u=s.length;else{const c=s[i-1],d=o.indexOf(c,i-1);d!==-1&&(u=d+1)}t.value.setSelectionRange(u,u)}return[e,n]}const useSizeProp=buildProp({type:String,values:componentSizes,required:!1}),SIZE_INJECTION_KEY=Symbol("size"),useGlobalSize=()=>{const t=inject(SIZE_INJECTION_KEY,{});return computed(()=>unref(t.size)||"")};function useFocusController(t,{afterFocus:r,afterBlur:e}={}){const n=getCurrentInstance(),{emit:o}=n,s=shallowRef(),a=ref(!1),i=d=>{a.value||(a.value=!0,o("focus",d),r==null||r())},u=d=>{var m;d.relatedTarget&&((m=s.value)!=null&&m.contains(d.relatedTarget))||(a.value=!1,o("blur",d),e==null||e())},c=()=>{var d;(d=t.value)==null||d.focus()};return watch(s,d=>{d&&d.setAttribute("tabindex","-1")}),useEventListener(s,"click",c),{wrapperRef:s,isFocused:a,handleFocus:i,handleBlur:u}}const configProviderContextKey=Symbol(),globalConfig=ref();function useGlobalConfig(t,r=void 0){const e=getCurrentInstance()?inject(configProviderContextKey,globalConfig):globalConfig;return t?computed(()=>{var n,o;return(o=(n=e.value)==null?void 0:n[t])!=null?o:r}):e}function useGlobalComponentSettings(t,r){const e=useGlobalConfig(),n=useNamespace(t,computed(()=>{var i;return((i=e.value)==null?void 0:i.namespace)||defaultNamespace})),o=useLocale(computed(()=>{var i;return(i=e.value)==null?void 0:i.locale})),s=useZIndex(computed(()=>{var i;return((i=e.value)==null?void 0:i.zIndex)||defaultInitialZIndex})),a=computed(()=>{var i;return unref(r)||((i=e.value)==null?void 0:i.size)||""});return provideGlobalConfig(computed(()=>unref(e)||{})),{ns:n,locale:o,zIndex:s,size:a}}const provideGlobalConfig=(t,r,e=!1)=>{var n;const o=!!getCurrentInstance(),s=o?useGlobalConfig():void 0,a=(n=r==null?void 0:r.provide)!=null?n:o?provide:void 0;if(!a)return;const i=computed(()=>{const u=unref(t);return s!=null&&s.value?mergeConfig$1(s.value,u):u});return a(configProviderContextKey,i),a(localeContextKey,computed(()=>i.value.locale)),a(namespaceContextKey,computed(()=>i.value.namespace)),a(zIndexContextKey,computed(()=>i.value.zIndex)),a(SIZE_INJECTION_KEY,{size:computed(()=>i.value.size||"")}),(e||!globalConfig.value)&&(globalConfig.value=i.value),i},mergeConfig$1=(t,r)=>{var e;const n=[...new Set([...keysOf(t),...keysOf(r)])],o={};for(const s of n)o[s]=(e=r[s])!=null?e:t[s];return o},messageConfig={},affixProps=buildProps({zIndex:{type:definePropType([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),affixEmits={scroll:({scrollTop:t,fixed:r})=>isNumber$1(t)&&isBoolean$1(r),[CHANGE_EVENT]:t=>isBoolean$1(t)};var _export_sfc=(t,r)=>{const e=t.__vccOpts||t;for(const[n,o]of r)e[n]=o;return e};const COMPONENT_NAME$9="ElAffix",__default__$L=defineComponent({name:COMPONENT_NAME$9}),_sfc_main$17=defineComponent({...__default__$L,props:affixProps,emits:affixEmits,setup(t,{expose:r,emit:e}){const n=t,o=useNamespace("affix"),s=shallowRef(),a=shallowRef(),i=shallowRef(),{height:u}=useWindowSize(),{height:c,width:d,top:m,bottom:v,update:g}=useElementBounding(a,{windowScroll:!1}),b=useElementBounding(s),T=ref(!1),k=ref(0),y=ref(0),A=computed(()=>({height:T.value?`${c.value}px`:"",width:T.value?`${d.value}px`:""})),V=computed(()=>{if(!T.value)return{};const Ne=n.offset?addUnit(n.offset):0;return{height:`${c.value}px`,width:`${d.value}px`,top:n.position==="top"?Ne:"",bottom:n.position==="bottom"?Ne:"",transform:y.value?`translateY(${y.value}px)`:"",zIndex:n.zIndex}}),he=()=>{if(i.value)if(k.value=i.value instanceof Window?document.documentElement.scrollTop:i.value.scrollTop||0,n.position==="top")if(n.target){const Ne=b.bottom.value-n.offset-c.value;T.value=n.offset>m.value&&b.bottom.value>0,y.value=Ne<0?Ne:0}else T.value=n.offset>m.value;else if(n.target){const Ne=u.value-b.top.value-n.offset-c.value;T.value=u.value-n.offset<v.value&&u.value>b.top.value,y.value=Ne<0?-Ne:0}else T.value=u.value-n.offset<v.value},ae=()=>{g(),e("scroll",{scrollTop:k.value,fixed:T.value})};return watch(T,Ne=>e("change",Ne)),onMounted(()=>{var Ne;n.target?(s.value=(Ne=document.querySelector(n.target))!=null?Ne:void 0,s.value||throwError(COMPONENT_NAME$9,`Target is not existed: ${n.target}`)):s.value=document.documentElement,i.value=getScrollContainer(a.value,!0),g()}),useEventListener(i,"scroll",ae),watchEffect(he),r({update:he,updateRoot:g}),(Ne,_e)=>(openBlock(),createElementBlock("div",{ref_key:"root",ref:a,class:normalizeClass(unref(o).b()),style:normalizeStyle(unref(A))},[createBaseVNode("div",{class:normalizeClass({[unref(o).m("fixed")]:T.value}),style:normalizeStyle(unref(V))},[renderSlot(Ne.$slots,"default")],6)],6))}});var Affix=_export_sfc(_sfc_main$17,[["__file","/home/runner/work/element-plus/element-plus/packages/components/affix/src/affix.vue"]]);const ElAffix=withInstall(Affix),iconProps=buildProps({size:{type:definePropType([Number,String])},color:{type:String}}),__default__$K=defineComponent({name:"ElIcon",inheritAttrs:!1}),_sfc_main$16=defineComponent({...__default__$K,props:iconProps,setup(t){const r=t,e=useNamespace("icon"),n=computed(()=>{const{size:o,color:s}=r;return!o&&!s?{}:{fontSize:isUndefined$1(o)?void 0:addUnit(o),"--color":s}});return(o,s)=>(openBlock(),createElementBlock("i",mergeProps({class:unref(e).b(),style:unref(n)},o.$attrs),[renderSlot(o.$slots,"default")],16))}});var Icon=_export_sfc(_sfc_main$16,[["__file","/home/runner/work/element-plus/element-plus/packages/components/icon/src/icon.vue"]]);const ElIcon=withInstall(Icon),formContextKey=Symbol("formContextKey"),formItemContextKey=Symbol("formItemContextKey"),useFormSize=(t,r={})=>{const e=ref(void 0),n=r.prop?e:useProp("size"),o=r.global?e:useGlobalSize(),s=r.form?{size:void 0}:inject(formContextKey,void 0),a=r.formItem?{size:void 0}:inject(formItemContextKey,void 0);return computed(()=>n.value||unref(t)||(a==null?void 0:a.size)||(s==null?void 0:s.size)||o.value||"")},useFormDisabled=t=>{const r=useProp("disabled"),e=inject(formContextKey,void 0);return computed(()=>r.value||unref(t)||(e==null?void 0:e.disabled)||!1)},useFormItem=()=>{const t=inject(formContextKey,void 0),r=inject(formItemContextKey,void 0);return{form:t,formItem:r}},useFormItemInputId=(t,{formItemContext:r,disableIdGeneration:e,disableIdManagement:n})=>{e||(e=ref(!1)),n||(n=ref(!1));const o=ref();let s;const a=computed(()=>{var i;return!!(!t.label&&r&&r.inputIds&&((i=r.inputIds)==null?void 0:i.length)<=1)});return onMounted(()=>{s=watch([toRef(t,"id"),e],([i,u])=>{const c=i??(u?void 0:useId().value);c!==o.value&&(r!=null&&r.removeInputId&&(o.value&&r.removeInputId(o.value),!(n!=null&&n.value)&&!u&&c&&r.addInputId(c)),o.value=c)},{immediate:!0})}),onUnmounted(()=>{s&&s(),r!=null&&r.removeInputId&&o.value&&r.removeInputId(o.value)}),{isLabeledByFormItem:a,inputId:o}},formMetaProps=buildProps({size:{type:String,values:componentSizes},disabled:Boolean}),formProps=buildProps({...formMetaProps,model:Object,rules:{type:definePropType(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),formEmits={validate:(t,r,e)=>(isArray$4(t)||isString$2(t))&&isBoolean$1(r)&&isString$2(e)};function useFormLabelWidth(){const t=ref([]),r=computed(()=>{if(!t.value.length)return"0";const s=Math.max(...t.value);return s?`${s}px`:""});function e(s){const a=t.value.indexOf(s);return a===-1&&r.value,a}function n(s,a){if(s&&a){const i=e(a);t.value.splice(i,1,s)}else s&&t.value.push(s)}function o(s){const a=e(s);a>-1&&t.value.splice(a,1)}return{autoLabelWidth:r,registerLabelWidth:n,deregisterLabelWidth:o}}const filterFields=(t,r)=>{const e=castArray$1(r);return e.length>0?t.filter(n=>n.prop&&e.includes(n.prop)):t},COMPONENT_NAME$8="ElForm",__default__$J=defineComponent({name:COMPONENT_NAME$8}),_sfc_main$15=defineComponent({...__default__$J,props:formProps,emits:formEmits,setup(t,{expose:r,emit:e}){const n=t,o=[],s=useFormSize(),a=useNamespace("form"),i=computed(()=>{const{labelPosition:A,inline:V}=n;return[a.b(),a.m(s.value||"default"),{[a.m(`label-${A}`)]:A,[a.m("inline")]:V}]}),u=A=>{o.push(A)},c=A=>{A.prop&&o.splice(o.indexOf(A),1)},d=(A=[])=>{n.model&&filterFields(o,A).forEach(V=>V.resetField())},m=(A=[])=>{filterFields(o,A).forEach(V=>V.clearValidate())},v=computed(()=>!!n.model),g=A=>{if(o.length===0)return[];const V=filterFields(o,A);return V.length?V:[]},b=async A=>k(void 0,A),T=async(A=[])=>{if(!v.value)return!1;const V=g(A);if(V.length===0)return!0;let he={};for(const ae of V)try{await ae.validate("")}catch(Ne){he={...he,...Ne}}return Object.keys(he).length===0?!0:Promise.reject(he)},k=async(A=[],V)=>{const he=!isFunction$3(V);try{const ae=await T(A);return ae===!0&&(V==null||V(ae)),ae}catch(ae){if(ae instanceof Error)throw ae;const Ne=ae;return n.scrollToError&&y(Object.keys(Ne)[0]),V==null||V(!1,Ne),he&&Promise.reject(Ne)}},y=A=>{var V;const he=filterFields(o,A)[0];he&&((V=he.$el)==null||V.scrollIntoView(n.scrollIntoViewOptions))};return watch(()=>n.rules,()=>{n.validateOnRuleChange&&b().catch(A=>void 0)},{deep:!0}),provide(formContextKey,reactive({...toRefs(n),emit:e,resetFields:d,clearValidate:m,validateField:k,addField:u,removeField:c,...useFormLabelWidth()})),r({validate:b,validateField:k,resetFields:d,clearValidate:m,scrollToField:y}),(A,V)=>(openBlock(),createElementBlock("form",{class:normalizeClass(unref(i))},[renderSlot(A.$slots,"default")],2))}});var Form=_export_sfc(_sfc_main$15,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form.vue"]]);function _extends(){return _extends=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},_extends.apply(this,arguments)}function _inheritsLoose(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,_setPrototypeOf(t,r)}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(t)}function _setPrototypeOf(t,r){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},_setPrototypeOf(t,r)}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _construct(t,r,e){return _isNativeReflectConstruct()?_construct=Reflect.construct.bind():_construct=function(o,s,a){var i=[null];i.push.apply(i,s);var u=Function.bind.apply(o,i),c=new u;return a&&_setPrototypeOf(c,a.prototype),c},_construct.apply(null,arguments)}function _isNativeFunction(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function _wrapNativeSuper(t){var r=typeof Map=="function"?new Map:void 0;return _wrapNativeSuper=function(n){if(n===null||!_isNativeFunction(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r<"u"){if(r.has(n))return r.get(n);r.set(n,o)}function o(){return _construct(n,arguments,_getPrototypeOf(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(o,n)},_wrapNativeSuper(t)}var formatRegExp=/%[sdj%]/g,warning=function(){};typeof process<"u"&&process.env;function convertFieldsError(t){if(!t||!t.length)return null;var r={};return t.forEach(function(e){var n=e.field;r[n]=r[n]||[],r[n].push(e)}),r}function format(t){for(var r=arguments.length,e=new Array(r>1?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];var o=0,s=e.length;if(typeof t=="function")return t.apply(null,e);if(typeof t=="string"){var a=t.replace(formatRegExp,function(i){if(i==="%%")return"%";if(o>=s)return i;switch(i){case"%s":return String(e[o++]);case"%d":return Number(e[o++]);case"%j":try{return JSON.stringify(e[o++])}catch{return"[Circular]"}break;default:return i}});return a}return t}function isNativeStringType(t){return t==="string"||t==="url"||t==="hex"||t==="email"||t==="date"||t==="pattern"}function isEmptyValue(t,r){return!!(t==null||r==="array"&&Array.isArray(t)&&!t.length||isNativeStringType(r)&&typeof t=="string"&&!t)}function asyncParallelArray(t,r,e){var n=[],o=0,s=t.length;function a(i){n.push.apply(n,i||[]),o++,o===s&&e(n)}t.forEach(function(i){r(i,a)})}function asyncSerialArray(t,r,e){var n=0,o=t.length;function s(a){if(a&&a.length){e(a);return}var i=n;n=n+1,i<o?r(t[i],s):e([])}s([])}function flattenObjArr(t){var r=[];return Object.keys(t).forEach(function(e){r.push.apply(r,t[e]||[])}),r}var AsyncValidationError=function(t){_inheritsLoose(r,t);function r(e,n){var o;return o=t.call(this,"Async Validation Error")||this,o.errors=e,o.fields=n,o}return r}(_wrapNativeSuper(Error));function asyncMap(t,r,e,n,o){if(r.first){var s=new Promise(function(v,g){var b=function(y){return n(y),y.length?g(new AsyncValidationError(y,convertFieldsError(y))):v(o)},T=flattenObjArr(t);asyncSerialArray(T,e,b)});return s.catch(function(v){return v}),s}var a=r.firstFields===!0?Object.keys(t):r.firstFields||[],i=Object.keys(t),u=i.length,c=0,d=[],m=new Promise(function(v,g){var b=function(k){if(d.push.apply(d,k),c++,c===u)return n(d),d.length?g(new AsyncValidationError(d,convertFieldsError(d))):v(o)};i.length||(n(d),v(o)),i.forEach(function(T){var k=t[T];a.indexOf(T)!==-1?asyncSerialArray(k,e,b):asyncParallelArray(k,e,b)})});return m.catch(function(v){return v}),m}function isErrorObj(t){return!!(t&&t.message!==void 0)}function getValue(t,r){for(var e=t,n=0;n<r.length;n++){if(e==null)return e;e=e[r[n]]}return e}function complementError(t,r){return function(e){var n;return t.fullFields?n=getValue(r,t.fullFields):n=r[e.field||t.fullField],isErrorObj(e)?(e.field=e.field||t.fullField,e.fieldValue=n,e):{message:typeof e=="function"?e():e,fieldValue:n,field:e.field||t.fullField}}}function deepMerge(t,r){if(r){for(var e in r)if(r.hasOwnProperty(e)){var n=r[e];typeof n=="object"&&typeof t[e]=="object"?t[e]=_extends({},t[e],n):t[e]=n}}return t}var required$1=function(r,e,n,o,s,a){r.required&&(!n.hasOwnProperty(r.field)||isEmptyValue(e,a||r.type))&&o.push(format(s.messages.required,r.fullField))},whitespace=function(r,e,n,o,s){(/^\s+$/.test(e)||e==="")&&o.push(format(s.messages.whitespace,r.fullField))},urlReg,getUrlRegex=function(){if(urlReg)return urlReg;var t="[a-fA-F\\d:]",r=function(he){return he&&he.includeBoundaries?"(?:(?<=\\s|^)(?="+t+")|(?<="+t+")(?=\\s|$))":""},e="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",n="[a-fA-F\\d]{1,4}",o=(`
(?:
(?:`+n+":){7}(?:"+n+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+n+":){6}(?:"+e+"|:"+n+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+n+":){5}(?::"+e+"|(?::"+n+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+n+":){4}(?:(?::"+n+"){0,1}:"+e+"|(?::"+n+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+n+":){3}(?:(?::"+n+"){0,2}:"+e+"|(?::"+n+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+n+":){2}(?:(?::"+n+"){0,3}:"+e+"|(?::"+n+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+n+":){1}(?:(?::"+n+"){0,4}:"+e+"|(?::"+n+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+n+"){0,5}:"+e+"|(?::"+n+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),s=new RegExp("(?:^"+e+"$)|(?:^"+o+"$)"),a=new RegExp("^"+e+"$"),i=new RegExp("^"+o+"$"),u=function(he){return he&&he.exact?s:new RegExp("(?:"+r(he)+e+r(he)+")|(?:"+r(he)+o+r(he)+")","g")};u.v4=function(V){return V&&V.exact?a:new RegExp(""+r(V)+e+r(V),"g")},u.v6=function(V){return V&&V.exact?i:new RegExp(""+r(V)+o+r(V),"g")};var c="(?:(?:[a-z]+:)?//)",d="(?:\\S+(?::\\S*)?@)?",m=u.v4().source,v=u.v6().source,g="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",b="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",T="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",k="(?::\\d{2,5})?",y='(?:[/?#][^\\s"]*)?',A="(?:"+c+"|www\\.)"+d+"(?:localhost|"+m+"|"+v+"|"+g+b+T+")"+k+y;return urlReg=new RegExp("(?:^"+A+"$)","i"),urlReg},pattern$2={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},types={integer:function(r){return types.number(r)&&parseInt(r,10)===r},float:function(r){return types.number(r)&&!types.integer(r)},array:function(r){return Array.isArray(r)},regexp:function(r){if(r instanceof RegExp)return!0;try{return!!new RegExp(r)}catch{return!1}},date:function(r){return typeof r.getTime=="function"&&typeof r.getMonth=="function"&&typeof r.getYear=="function"&&!isNaN(r.getTime())},number:function(r){return isNaN(r)?!1:typeof r=="number"},object:function(r){return typeof r=="object"&&!types.array(r)},method:function(r){return typeof r=="function"},email:function(r){return typeof r=="string"&&r.length<=320&&!!r.match(pattern$2.email)},url:function(r){return typeof r=="string"&&r.length<=2048&&!!r.match(getUrlRegex())},hex:function(r){return typeof r=="string"&&!!r.match(pattern$2.hex)}},type$1=function(r,e,n,o,s){if(r.required&&e===void 0){required$1(r,e,n,o,s);return}var a=["integer","float","array","regexp","object","method","email","number","date","url","hex"],i=r.type;a.indexOf(i)>-1?types[i](e)||o.push(format(s.messages.types[i],r.fullField,r.type)):i&&typeof e!==r.type&&o.push(format(s.messages.types[i],r.fullField,r.type))},range$1=function(r,e,n,o,s){var a=typeof r.len=="number",i=typeof r.min=="number",u=typeof r.max=="number",c=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,d=e,m=null,v=typeof e=="number",g=typeof e=="string",b=Array.isArray(e);if(v?m="number":g?m="string":b&&(m="array"),!m)return!1;b&&(d=e.length),g&&(d=e.replace(c,"_").length),a?d!==r.len&&o.push(format(s.messages[m].len,r.fullField,r.len)):i&&!u&&d<r.min?o.push(format(s.messages[m].min,r.fullField,r.min)):u&&!i&&d>r.max?o.push(format(s.messages[m].max,r.fullField,r.max)):i&&u&&(d<r.min||d>r.max)&&o.push(format(s.messages[m].range,r.fullField,r.min,r.max))},ENUM$1="enum",enumerable$1=function(r,e,n,o,s){r[ENUM$1]=Array.isArray(r[ENUM$1])?r[ENUM$1]:[],r[ENUM$1].indexOf(e)===-1&&o.push(format(s.messages[ENUM$1],r.fullField,r[ENUM$1].join(", ")))},pattern$1=function(r,e,n,o,s){if(r.pattern){if(r.pattern instanceof RegExp)r.pattern.lastIndex=0,r.pattern.test(e)||o.push(format(s.messages.pattern.mismatch,r.fullField,e,r.pattern));else if(typeof r.pattern=="string"){var a=new RegExp(r.pattern);a.test(e)||o.push(format(s.messages.pattern.mismatch,r.fullField,e,r.pattern))}}},rules={required:required$1,whitespace,type:type$1,range:range$1,enum:enumerable$1,pattern:pattern$1},string=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e,"string")&&!r.required)return n();rules.required(r,e,o,a,s,"string"),isEmptyValue(e,"string")||(rules.type(r,e,o,a,s),rules.range(r,e,o,a,s),rules.pattern(r,e,o,a,s),r.whitespace===!0&&rules.whitespace(r,e,o,a,s))}n(a)},method=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),e!==void 0&&rules.type(r,e,o,a,s)}n(a)},number=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(e===""&&(e=void 0),isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),e!==void 0&&(rules.type(r,e,o,a,s),rules.range(r,e,o,a,s))}n(a)},_boolean=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),e!==void 0&&rules.type(r,e,o,a,s)}n(a)},regexp=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),isEmptyValue(e)||rules.type(r,e,o,a,s)}n(a)},integer=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),e!==void 0&&(rules.type(r,e,o,a,s),rules.range(r,e,o,a,s))}n(a)},floatFn=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),e!==void 0&&(rules.type(r,e,o,a,s),rules.range(r,e,o,a,s))}n(a)},array=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(e==null&&!r.required)return n();rules.required(r,e,o,a,s,"array"),e!=null&&(rules.type(r,e,o,a,s),rules.range(r,e,o,a,s))}n(a)},object=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),e!==void 0&&rules.type(r,e,o,a,s)}n(a)},ENUM="enum",enumerable=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s),e!==void 0&&rules[ENUM](r,e,o,a,s)}n(a)},pattern=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e,"string")&&!r.required)return n();rules.required(r,e,o,a,s),isEmptyValue(e,"string")||rules.pattern(r,e,o,a,s)}n(a)},date=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e,"date")&&!r.required)return n();if(rules.required(r,e,o,a,s),!isEmptyValue(e,"date")){var u;e instanceof Date?u=e:u=new Date(e),rules.type(r,u,o,a,s),u&&rules.range(r,u.getTime(),o,a,s)}}n(a)},required=function(r,e,n,o,s){var a=[],i=Array.isArray(e)?"array":typeof e;rules.required(r,e,o,a,s,i),n(a)},type=function(r,e,n,o,s){var a=r.type,i=[],u=r.required||!r.required&&o.hasOwnProperty(r.field);if(u){if(isEmptyValue(e,a)&&!r.required)return n();rules.required(r,e,o,i,s,a),isEmptyValue(e,a)||rules.type(r,e,o,i,s)}n(i)},any=function(r,e,n,o,s){var a=[],i=r.required||!r.required&&o.hasOwnProperty(r.field);if(i){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,o,a,s)}n(a)},validators$2={string,method,number,boolean:_boolean,regexp,integer,float:floatFn,array,object,enum:enumerable,pattern,date,url:type,hex:type,email:type,required,any};function newMessages(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var r=JSON.parse(JSON.stringify(this));return r.clone=this.clone,r}}}var messages=newMessages(),Schema=function(){function t(e){this.rules=null,this._messages=messages,this.define(e)}var r=t.prototype;return r.define=function(n){var o=this;if(!n)throw new Error("Cannot configure a schema with no rules");if(typeof n!="object"||Array.isArray(n))throw new Error("Rules must be an object");this.rules={},Object.keys(n).forEach(function(s){var a=n[s];o.rules[s]=Array.isArray(a)?a:[a]})},r.messages=function(n){return n&&(this._messages=deepMerge(newMessages(),n)),this._messages},r.validate=function(n,o,s){var a=this;o===void 0&&(o={}),s===void 0&&(s=function(){});var i=n,u=o,c=s;if(typeof u=="function"&&(c=u,u={}),!this.rules||Object.keys(this.rules).length===0)return c&&c(null,i),Promise.resolve(i);function d(T){var k=[],y={};function A(he){if(Array.isArray(he)){var ae;k=(ae=k).concat.apply(ae,he)}else k.push(he)}for(var V=0;V<T.length;V++)A(T[V]);k.length?(y=convertFieldsError(k),c(k,y)):c(null,i)}if(u.messages){var m=this.messages();m===messages&&(m=newMessages()),deepMerge(m,u.messages),u.messages=m}else u.messages=this.messages();var v={},g=u.keys||Object.keys(this.rules);g.forEach(function(T){var k=a.rules[T],y=i[T];k.forEach(function(A){var V=A;typeof V.transform=="function"&&(i===n&&(i=_extends({},i)),y=i[T]=V.transform(y)),typeof V=="function"?V={validator:V}:V=_extends({},V),V.validator=a.getValidationMethod(V),V.validator&&(V.field=T,V.fullField=V.fullField||T,V.type=a.getType(V),v[T]=v[T]||[],v[T].push({rule:V,value:y,source:i,field:T}))})});var b={};return asyncMap(v,u,function(T,k){var y=T.rule,A=(y.type==="object"||y.type==="array")&&(typeof y.fields=="object"||typeof y.defaultField=="object");A=A&&(y.required||!y.required&&T.value),y.field=T.field;function V(Ne,_e){return _extends({},_e,{fullField:y.fullField+"."+Ne,fullFields:y.fullFields?[].concat(y.fullFields,[Ne]):[Ne]})}function he(Ne){Ne===void 0&&(Ne=[]);var _e=Array.isArray(Ne)?Ne:[Ne];!u.suppressWarning&&_e.length&&t.warning("async-validator:",_e),_e.length&&y.message!==void 0&&(_e=[].concat(y.message));var Ce=_e.map(complementError(y,i));if(u.first&&Ce.length)return b[y.field]=1,k(Ce);if(!A)k(Ce);else{if(y.required&&!T.value)return y.message!==void 0?Ce=[].concat(y.message).map(complementError(y,i)):u.error&&(Ce=[u.error(y,format(u.messages.required,y.field))]),k(Ce);var re={};y.defaultField&&Object.keys(T.value).map(function(le){re[le]=y.defaultField}),re=_extends({},re,T.rule.fields);var ue={};Object.keys(re).forEach(function(le){var de=re[le],Ie=Array.isArray(de)?de:[de];ue[le]=Ie.map(V.bind(null,le))});var ze=new t(ue);ze.messages(u.messages),T.rule.options&&(T.rule.options.messages=u.messages,T.rule.options.error=u.error),ze.validate(T.value,T.rule.options||u,function(le){var de=[];Ce&&Ce.length&&de.push.apply(de,Ce),le&&le.length&&de.push.apply(de,le),k(de.length?de:null)})}}var ae;if(y.asyncValidator)ae=y.asyncValidator(y,T.value,he,T.source,u);else if(y.validator){try{ae=y.validator(y,T.value,he,T.source,u)}catch(Ne){console.error==null||console.error(Ne),u.suppressValidatorError||setTimeout(function(){throw Ne},0),he(Ne.message)}ae===!0?he():ae===!1?he(typeof y.message=="function"?y.message(y.fullField||y.field):y.message||(y.fullField||y.field)+" fails"):ae instanceof Array?he(ae):ae instanceof Error&&he(ae.message)}ae&&ae.then&&ae.then(function(){return he()},function(Ne){return he(Ne)})},function(T){d(T)},i)},r.getType=function(n){if(n.type===void 0&&n.pattern instanceof RegExp&&(n.type="pattern"),typeof n.validator!="function"&&n.type&&!validators$2.hasOwnProperty(n.type))throw new Error(format("Unknown rule type %s",n.type));return n.type||"string"},r.getValidationMethod=function(n){if(typeof n.validator=="function")return n.validator;var o=Object.keys(n),s=o.indexOf("message");return s!==-1&&o.splice(s,1),o.length===1&&o[0]==="required"?validators$2.required:validators$2[this.getType(n)]||void 0},t}();Schema.register=function(r,e){if(typeof e!="function")throw new Error("Cannot register a validator by type, validator is not a function");validators$2[r]=e};Schema.warning=warning;Schema.messages=messages;Schema.validators=validators$2;const formItemValidateStates=["","error","validating","success"],formItemProps=buildProps({label:String,labelWidth:{type:[String,Number],default:""},prop:{type:definePropType([String,Array])},required:{type:Boolean,default:void 0},rules:{type:definePropType([Object,Array])},error:String,validateStatus:{type:String,values:formItemValidateStates},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:componentSizes}}),COMPONENT_NAME$7="ElLabelWrap";var FormLabelWrap=defineComponent({name:COMPONENT_NAME$7,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(t,{slots:r}){const e=inject(formContextKey,void 0),n=inject(formItemContextKey);n||throwError(COMPONENT_NAME$7,"usage: <el-form-item><label-wrap /></el-form-item>");const o=useNamespace("form"),s=ref(),a=ref(0),i=()=>{var d;if((d=s.value)!=null&&d.firstElementChild){const m=window.getComputedStyle(s.value.firstElementChild).width;return Math.ceil(Number.parseFloat(m))}else return 0},u=(d="update")=>{nextTick(()=>{r.default&&t.isAutoWidth&&(d==="update"?a.value=i():d==="remove"&&(e==null||e.deregisterLabelWidth(a.value)))})},c=()=>u("update");return onMounted(()=>{c()}),onBeforeUnmount(()=>{u("remove")}),onUpdated(()=>c()),watch(a,(d,m)=>{t.updateAll&&(e==null||e.registerLabelWidth(d,m))}),useResizeObserver(computed(()=>{var d,m;return(m=(d=s.value)==null?void 0:d.firstElementChild)!=null?m:null}),c),()=>{var d,m;if(!r)return null;const{isAutoWidth:v}=t;if(v){const g=e==null?void 0:e.autoLabelWidth,b=n==null?void 0:n.hasLabel,T={};if(b&&g&&g!=="auto"){const k=Math.max(0,Number.parseInt(g,10)-a.value),y=e.labelPosition==="left"?"marginRight":"marginLeft";k&&(T[y]=`${k}px`)}return createVNode("div",{ref:s,class:[o.be("item","label-wrap")],style:T},[(d=r.default)==null?void 0:d.call(r)])}else return createVNode(Fragment,{ref:s},[(m=r.default)==null?void 0:m.call(r)])}}});const _hoisted_1$t=["role","aria-labelledby"],__default__$I=defineComponent({name:"ElFormItem"}),_sfc_main$14=defineComponent({...__default__$I,props:formItemProps,setup(t,{expose:r}){const e=t,n=useSlots(),o=inject(formContextKey,void 0),s=inject(formItemContextKey,void 0),a=useFormSize(void 0,{formItem:!1}),i=useNamespace("form-item"),u=useId().value,c=ref([]),d=ref(""),m=refDebounced(d,100),v=ref(""),g=ref();let b,T=!1;const k=computed(()=>{if((o==null?void 0:o.labelPosition)==="top")return{};const $e=addUnit(e.labelWidth||(o==null?void 0:o.labelWidth)||"");return $e?{width:$e}:{}}),y=computed(()=>{if((o==null?void 0:o.labelPosition)==="top"||o!=null&&o.inline)return{};if(!e.label&&!e.labelWidth&&re)return{};const $e=addUnit(e.labelWidth||(o==null?void 0:o.labelWidth)||"");return!e.label&&!n.label?{marginLeft:$e}:{}}),A=computed(()=>[i.b(),i.m(a.value),i.is("error",d.value==="error"),i.is("validating",d.value==="validating"),i.is("success",d.value==="success"),i.is("required",Ie.value||e.required),i.is("no-asterisk",o==null?void 0:o.hideRequiredAsterisk),(o==null?void 0:o.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[i.m("feedback")]:o==null?void 0:o.statusIcon}]),V=computed(()=>isBoolean$1(e.inlineMessage)?e.inlineMessage:(o==null?void 0:o.inlineMessage)||!1),he=computed(()=>[i.e("error"),{[i.em("error","inline")]:V.value}]),ae=computed(()=>e.prop?isString$2(e.prop)?e.prop:e.prop.join("."):""),Ne=computed(()=>!!(e.label||n.label)),_e=computed(()=>e.for||c.value.length===1?c.value[0]:void 0),Ce=computed(()=>!_e.value&&Ne.value),re=!!s,ue=computed(()=>{const $e=o==null?void 0:o.model;if(!(!$e||!e.prop))return getProp($e,e.prop).value}),ze=computed(()=>{const{required:$e}=e,er=[];e.rules&&er.push(...castArray$1(e.rules));const nr=o==null?void 0:o.rules;if(nr&&e.prop){const Pt=getProp(nr,e.prop).value;Pt&&er.push(...castArray$1(Pt))}if($e!==void 0){const Pt=er.map((rr,kt)=>[rr,kt]).filter(([rr])=>Object.keys(rr).includes("required"));if(Pt.length>0)for(const[rr,kt]of Pt)rr.required!==$e&&(er[kt]={...rr,required:$e});else er.push({required:$e})}return er}),le=computed(()=>ze.value.length>0),de=$e=>ze.value.filter(nr=>!nr.trigger||!$e?!0:Array.isArray(nr.trigger)?nr.trigger.includes($e):nr.trigger===$e).map(({trigger:nr,...Pt})=>Pt),Ie=computed(()=>ze.value.some($e=>$e.required)),ie=computed(()=>{var $e;return m.value==="error"&&e.showMessage&&(($e=o==null?void 0:o.showMessage)!=null?$e:!0)}),Ve=computed(()=>`${e.label||""}${(o==null?void 0:o.labelSuffix)||""}`),Ue=$e=>{d.value=$e},Dt=$e=>{var er,nr;const{errors:Pt,fields:rr}=$e;(!Pt||!rr)&&console.error($e),Ue("error"),v.value=Pt?(nr=(er=Pt==null?void 0:Pt[0])==null?void 0:er.message)!=null?nr:`${e.prop} is required`:"",o==null||o.emit("validate",e.prop,!1,v.value)},tr=()=>{Ue("success"),o==null||o.emit("validate",e.prop,!0,"")},dr=async $e=>{const er=ae.value;return new Schema({[er]:$e}).validate({[er]:ue.value},{firstFields:!0}).then(()=>(tr(),!0)).catch(Pt=>(Dt(Pt),Promise.reject(Pt)))},fr=async($e,er)=>{if(T||!e.prop)return!1;const nr=isFunction$3(er);if(!le.value)return er==null||er(!1),!1;const Pt=de($e);return Pt.length===0?(er==null||er(!0),!0):(Ue("validating"),dr(Pt).then(()=>(er==null||er(!0),!0)).catch(rr=>{const{fields:kt}=rr;return er==null||er(!1,kt),nr?!1:Promise.reject(kt)}))},sr=()=>{Ue(""),v.value="",T=!1},hr=async()=>{const $e=o==null?void 0:o.model;if(!$e||!e.prop)return;const er=getProp($e,e.prop);T=!0,er.value=clone(b),await nextTick(),sr(),T=!1},Fe=$e=>{c.value.includes($e)||c.value.push($e)},or=$e=>{c.value=c.value.filter(er=>er!==$e)};watch(()=>e.error,$e=>{v.value=$e||"",Ue($e?"error":"")},{immediate:!0}),watch(()=>e.validateStatus,$e=>Ue($e||""));const ir=reactive({...toRefs(e),$el:g,size:a,validateState:d,labelId:u,inputIds:c,isGroup:Ce,hasLabel:Ne,addInputId:Fe,removeInputId:or,resetField:hr,clearValidate:sr,validate:fr});return provide(formItemContextKey,ir),onMounted(()=>{e.prop&&(o==null||o.addField(ir),b=clone(ue.value))}),onBeforeUnmount(()=>{o==null||o.removeField(ir)}),r({size:a,validateMessage:v,validateState:d,validate:fr,clearValidate:sr,resetField:hr}),($e,er)=>{var nr;return openBlock(),createElementBlock("div",{ref_key:"formItemRef",ref:g,class:normalizeClass(unref(A)),role:unref(Ce)?"group":void 0,"aria-labelledby":unref(Ce)?unref(u):void 0},[createVNode(unref(FormLabelWrap),{"is-auto-width":unref(k).width==="auto","update-all":((nr=unref(o))==null?void 0:nr.labelWidth)==="auto"},{default:withCtx(()=>[unref(Ne)?(openBlock(),createBlock(resolveDynamicComponent(unref(_e)?"label":"div"),{key:0,id:unref(u),for:unref(_e),class:normalizeClass(unref(i).e("label")),style:normalizeStyle(unref(k))},{default:withCtx(()=>[renderSlot($e.$slots,"label",{label:unref(Ve)},()=>[createTextVNode(toDisplayString(unref(Ve)),1)])]),_:3},8,["id","for","class","style"])):createCommentVNode("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),createBaseVNode("div",{class:normalizeClass(unref(i).e("content")),style:normalizeStyle(unref(y))},[renderSlot($e.$slots,"default"),createVNode(TransitionGroup,{name:`${unref(i).namespace.value}-zoom-in-top`},{default:withCtx(()=>[unref(ie)?renderSlot($e.$slots,"error",{key:0,error:v.value},()=>[createBaseVNode("div",{class:normalizeClass(unref(he))},toDisplayString(v.value),3)]):createCommentVNode("v-if",!0)]),_:3},8,["name"])],6)],10,_hoisted_1$t)}}});var FormItem=_export_sfc(_sfc_main$14,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form-item.vue"]]);const ElForm=withInstall(Form,{FormItem}),ElFormItem=withNoopInstall(FormItem);let hiddenTextarea;const HIDDEN_STYLE=`
  height:0 !important;
  visibility:hidden !important;
  ${isFirefox()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,CONTEXT_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function calculateNodeStyling(t){const r=window.getComputedStyle(t),e=r.getPropertyValue("box-sizing"),n=Number.parseFloat(r.getPropertyValue("padding-bottom"))+Number.parseFloat(r.getPropertyValue("padding-top")),o=Number.parseFloat(r.getPropertyValue("border-bottom-width"))+Number.parseFloat(r.getPropertyValue("border-top-width"));return{contextStyle:CONTEXT_STYLE.map(a=>`${a}:${r.getPropertyValue(a)}`).join(";"),paddingSize:n,borderSize:o,boxSizing:e}}function calcTextareaHeight(t,r=1,e){var n;hiddenTextarea||(hiddenTextarea=document.createElement("textarea"),document.body.appendChild(hiddenTextarea));const{paddingSize:o,borderSize:s,boxSizing:a,contextStyle:i}=calculateNodeStyling(t);hiddenTextarea.setAttribute("style",`${i};${HIDDEN_STYLE}`),hiddenTextarea.value=t.value||t.placeholder||"";let u=hiddenTextarea.scrollHeight;const c={};a==="border-box"?u=u+s:a==="content-box"&&(u=u-o),hiddenTextarea.value="";const d=hiddenTextarea.scrollHeight-o;if(isNumber$1(r)){let m=d*r;a==="border-box"&&(m=m+o+s),u=Math.max(m,u),c.minHeight=`${m}px`}if(isNumber$1(e)){let m=d*e;a==="border-box"&&(m=m+o+s),u=Math.min(m,u)}return c.height=`${u}px`,(n=hiddenTextarea.parentNode)==null||n.removeChild(hiddenTextarea),hiddenTextarea=void 0,c}const inputProps=buildProps({id:{type:String,default:void 0},size:useSizeProp,disabled:Boolean,modelValue:{type:definePropType([String,Number,Object]),default:""},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:definePropType([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:iconPropType},prefixIcon:{type:iconPropType},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:definePropType([Object,Array,String]),default:()=>mutable({})}}),inputEmits={[UPDATE_MODEL_EVENT]:t=>isString$2(t),input:t=>isString$2(t),change:t=>isString$2(t),focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,clear:()=>!0,mouseleave:t=>t instanceof MouseEvent,mouseenter:t=>t instanceof MouseEvent,keydown:t=>t instanceof Event,compositionstart:t=>t instanceof CompositionEvent,compositionupdate:t=>t instanceof CompositionEvent,compositionend:t=>t instanceof CompositionEvent},_hoisted_1$s=["role"],_hoisted_2$j=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form"],_hoisted_3$c=["id","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form"],__default__$H=defineComponent({name:"ElInput",inheritAttrs:!1}),_sfc_main$13=defineComponent({...__default__$H,props:inputProps,emits:inputEmits,setup(t,{expose:r,emit:e}){const n=t,o=useAttrs$1(),s=useSlots(),a=computed(()=>{const Nr={};return n.containerRole==="combobox"&&(Nr["aria-haspopup"]=o["aria-haspopup"],Nr["aria-owns"]=o["aria-owns"],Nr["aria-expanded"]=o["aria-expanded"]),Nr}),i=computed(()=>[n.type==="textarea"?k.b():T.b(),T.m(g.value),T.is("disabled",b.value),T.is("exceed",Fe.value),{[T.b("group")]:s.prepend||s.append,[T.bm("group","append")]:s.append,[T.bm("group","prepend")]:s.prepend,[T.m("prefix")]:s.prefix||n.prefixIcon,[T.m("suffix")]:s.suffix||n.suffixIcon||n.clearable||n.showPassword,[T.bm("suffix","password-clear")]:dr.value&&fr.value},o.class]),u=computed(()=>[T.e("wrapper"),T.is("focus",ue.value)]),c=useAttrs({excludeKeys:computed(()=>Object.keys(a.value))}),{form:d,formItem:m}=useFormItem(),{inputId:v}=useFormItemInputId(n,{formItemContext:m}),g=useFormSize(),b=useFormDisabled(),T=useNamespace("input"),k=useNamespace("textarea"),y=shallowRef(),A=shallowRef(),V=ref(!1),he=ref(!1),ae=ref(!1),Ne=ref(),_e=shallowRef(n.inputStyle),Ce=computed(()=>y.value||A.value),{wrapperRef:re,isFocused:ue,handleFocus:ze,handleBlur:le}=useFocusController(Ce,{afterBlur(){var Nr;n.validateEvent&&((Nr=m==null?void 0:m.validate)==null||Nr.call(m,"blur").catch(Wr=>void 0))}}),de=computed(()=>{var Nr;return(Nr=d==null?void 0:d.statusIcon)!=null?Nr:!1}),Ie=computed(()=>(m==null?void 0:m.validateState)||""),ie=computed(()=>Ie.value&&ValidateComponentsMap[Ie.value]),Ve=computed(()=>ae.value?view_default:hide_default),Ue=computed(()=>[o.style,n.inputStyle]),Dt=computed(()=>[n.inputStyle,_e.value,{resize:n.resize}]),tr=computed(()=>isNil(n.modelValue)?"":String(n.modelValue)),dr=computed(()=>n.clearable&&!b.value&&!n.readonly&&!!tr.value&&(ue.value||V.value)),fr=computed(()=>n.showPassword&&!b.value&&!n.readonly&&!!tr.value&&(!!tr.value||ue.value)),sr=computed(()=>n.showWordLimit&&!!c.value.maxlength&&(n.type==="text"||n.type==="textarea")&&!b.value&&!n.readonly&&!n.showPassword),hr=computed(()=>tr.value.length),Fe=computed(()=>!!sr.value&&hr.value>Number(c.value.maxlength)),or=computed(()=>!!s.suffix||!!n.suffixIcon||dr.value||n.showPassword||sr.value||!!Ie.value&&de.value),[ir,$e]=useCursor(y);useResizeObserver(A,Nr=>{if(Pt(),!sr.value||n.resize!=="both")return;const Wr=Nr[0],{width:Yr}=Wr.contentRect;Ne.value={right:`calc(100% - ${Yr+15+6}px)`}});const er=()=>{const{type:Nr,autosize:Wr}=n;if(!(!isClient||Nr!=="textarea"||!A.value))if(Wr){const Yr=isObject$2(Wr)?Wr.minRows:void 0,Ur=isObject$2(Wr)?Wr.maxRows:void 0,qr=calcTextareaHeight(A.value,Yr,Ur);_e.value={overflowY:"hidden",...qr},nextTick(()=>{A.value.offsetHeight,_e.value=qr})}else _e.value={minHeight:calcTextareaHeight(A.value).minHeight}},Pt=(Nr=>{let Wr=!1;return()=>{var Yr;if(Wr||!n.autosize)return;((Yr=A.value)==null?void 0:Yr.offsetParent)===null||(Nr(),Wr=!0)}})(er),rr=()=>{const Nr=Ce.value,Wr=n.formatter?n.formatter(tr.value):tr.value;!Nr||Nr.value===Wr||(Nr.value=Wr)},kt=async Nr=>{ir();let{value:Wr}=Nr.target;if(n.formatter&&(Wr=n.parser?n.parser(Wr):Wr),!he.value){if(Wr===tr.value){rr();return}e(UPDATE_MODEL_EVENT,Wr),e("input",Wr),await nextTick(),rr(),$e()}},Et=Nr=>{e("change",Nr.target.value)},cr=Nr=>{e("compositionstart",Nr),he.value=!0},mr=Nr=>{var Wr;e("compositionupdate",Nr);const Yr=(Wr=Nr.target)==null?void 0:Wr.value,Ur=Yr[Yr.length-1]||"";he.value=!isKorean(Ur)},yr=Nr=>{e("compositionend",Nr),he.value&&(he.value=!1,kt(Nr))},Tr=()=>{ae.value=!ae.value,Ir()},Ir=async()=>{var Nr;await nextTick(),(Nr=Ce.value)==null||Nr.focus()},kr=()=>{var Nr;return(Nr=Ce.value)==null?void 0:Nr.blur()},Ar=Nr=>{V.value=!1,e("mouseleave",Nr)},Rr=Nr=>{V.value=!0,e("mouseenter",Nr)},Mn=Nr=>{e("keydown",Nr)},Or=()=>{var Nr;(Nr=Ce.value)==null||Nr.select()},Pr=()=>{e(UPDATE_MODEL_EVENT,""),e("change",""),e("clear"),e("input","")};return watch(()=>n.modelValue,()=>{var Nr;nextTick(()=>er()),n.validateEvent&&((Nr=m==null?void 0:m.validate)==null||Nr.call(m,"change").catch(Wr=>void 0))}),watch(tr,()=>rr()),watch(()=>n.type,async()=>{await nextTick(),rr(),er()}),onMounted(()=>{!n.formatter&&n.parser,rr(),nextTick(er)}),r({input:y,textarea:A,ref:Ce,textareaStyle:Dt,autosize:toRef(n,"autosize"),focus:Ir,blur:kr,select:Or,clear:Pr,resizeTextarea:er}),(Nr,Wr)=>withDirectives((openBlock(),createElementBlock("div",mergeProps(unref(a),{class:unref(i),style:unref(Ue),role:Nr.containerRole,onMouseenter:Rr,onMouseleave:Ar}),[createCommentVNode(" input "),Nr.type!=="textarea"?(openBlock(),createElementBlock(Fragment,{key:0},[createCommentVNode(" prepend slot "),Nr.$slots.prepend?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(T).be("group","prepend"))},[renderSlot(Nr.$slots,"prepend")],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{ref_key:"wrapperRef",ref:re,class:normalizeClass(unref(u))},[createCommentVNode(" prefix slot "),Nr.$slots.prefix||Nr.prefixIcon?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(T).e("prefix"))},[createBaseVNode("span",{class:normalizeClass(unref(T).e("prefix-inner"))},[renderSlot(Nr.$slots,"prefix"),Nr.prefixIcon?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(T).e("icon"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Nr.prefixIcon)))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],2)],2)):createCommentVNode("v-if",!0),createBaseVNode("input",mergeProps({id:unref(v),ref_key:"input",ref:y,class:unref(T).e("inner")},unref(c),{type:Nr.showPassword?ae.value?"text":"password":Nr.type,disabled:unref(b),formatter:Nr.formatter,parser:Nr.parser,readonly:Nr.readonly,autocomplete:Nr.autocomplete,tabindex:Nr.tabindex,"aria-label":Nr.label,placeholder:Nr.placeholder,style:Nr.inputStyle,form:n.form,onCompositionstart:cr,onCompositionupdate:mr,onCompositionend:yr,onInput:kt,onFocus:Wr[0]||(Wr[0]=(...Yr)=>unref(ze)&&unref(ze)(...Yr)),onBlur:Wr[1]||(Wr[1]=(...Yr)=>unref(le)&&unref(le)(...Yr)),onChange:Et,onKeydown:Mn}),null,16,_hoisted_2$j),createCommentVNode(" suffix slot "),unref(or)?(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(unref(T).e("suffix"))},[createBaseVNode("span",{class:normalizeClass(unref(T).e("suffix-inner"))},[!unref(dr)||!unref(fr)||!unref(sr)?(openBlock(),createElementBlock(Fragment,{key:0},[renderSlot(Nr.$slots,"suffix"),Nr.suffixIcon?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(T).e("icon"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Nr.suffixIcon)))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],64)):createCommentVNode("v-if",!0),unref(dr)?(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass([unref(T).e("icon"),unref(T).e("clear")]),onMousedown:withModifiers(unref(NOOP),["prevent"]),onClick:Pr},{default:withCtx(()=>[createVNode(unref(circle_close_default))]),_:1},8,["class","onMousedown"])):createCommentVNode("v-if",!0),unref(fr)?(openBlock(),createBlock(unref(ElIcon),{key:2,class:normalizeClass([unref(T).e("icon"),unref(T).e("password")]),onClick:Tr},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(Ve))))]),_:1},8,["class"])):createCommentVNode("v-if",!0),unref(sr)?(openBlock(),createElementBlock("span",{key:3,class:normalizeClass(unref(T).e("count"))},[createBaseVNode("span",{class:normalizeClass(unref(T).e("count-inner"))},toDisplayString(unref(hr))+" / "+toDisplayString(unref(c).maxlength),3)],2)):createCommentVNode("v-if",!0),unref(Ie)&&unref(ie)&&unref(de)?(openBlock(),createBlock(unref(ElIcon),{key:4,class:normalizeClass([unref(T).e("icon"),unref(T).e("validateIcon"),unref(T).is("loading",unref(Ie)==="validating")])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(ie))))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],2)],2)):createCommentVNode("v-if",!0)],2),createCommentVNode(" append slot "),Nr.$slots.append?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(T).be("group","append"))},[renderSlot(Nr.$slots,"append")],2)):createCommentVNode("v-if",!0)],64)):(openBlock(),createElementBlock(Fragment,{key:1},[createCommentVNode(" textarea "),createBaseVNode("textarea",mergeProps({id:unref(v),ref_key:"textarea",ref:A,class:unref(k).e("inner")},unref(c),{tabindex:Nr.tabindex,disabled:unref(b),readonly:Nr.readonly,autocomplete:Nr.autocomplete,style:unref(Dt),"aria-label":Nr.label,placeholder:Nr.placeholder,form:n.form,onCompositionstart:cr,onCompositionupdate:mr,onCompositionend:yr,onInput:kt,onFocus:Wr[2]||(Wr[2]=(...Yr)=>unref(ze)&&unref(ze)(...Yr)),onBlur:Wr[3]||(Wr[3]=(...Yr)=>unref(le)&&unref(le)(...Yr)),onChange:Et,onKeydown:Mn}),null,16,_hoisted_3$c),unref(sr)?(openBlock(),createElementBlock("span",{key:0,style:normalizeStyle(Ne.value),class:normalizeClass(unref(T).e("count"))},toDisplayString(unref(hr))+" / "+toDisplayString(unref(c).maxlength),7)):createCommentVNode("v-if",!0)],64))],16,_hoisted_1$s)),[[vShow,Nr.type!=="hidden"]])}});var Input=_export_sfc(_sfc_main$13,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input/src/input.vue"]]);const ElInput=withInstall(Input),GAP=4,BAR_MAP={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},renderThumbStyle=({move:t,size:r,bar:e})=>({[e.size]:r,transform:`translate${e.axis}(${t}%)`}),scrollbarContextKey=Symbol("scrollbarContextKey"),thumbProps=buildProps({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),COMPONENT_NAME$6="Thumb",_sfc_main$12=defineComponent({__name:"thumb",props:thumbProps,setup(t){const r=t,e=inject(scrollbarContextKey),n=useNamespace("scrollbar");e||throwError(COMPONENT_NAME$6,"can not inject scrollbar context");const o=ref(),s=ref(),a=ref({}),i=ref(!1);let u=!1,c=!1,d=isClient?document.onselectstart:null;const m=computed(()=>BAR_MAP[r.vertical?"vertical":"horizontal"]),v=computed(()=>renderThumbStyle({size:r.size,move:r.move,bar:m.value})),g=computed(()=>o.value[m.value.offset]**2/e.wrapElement[m.value.scrollSize]/r.ratio/s.value[m.value.offset]),b=Ne=>{var _e;if(Ne.stopPropagation(),Ne.ctrlKey||[1,2].includes(Ne.button))return;(_e=window.getSelection())==null||_e.removeAllRanges(),k(Ne);const Ce=Ne.currentTarget;Ce&&(a.value[m.value.axis]=Ce[m.value.offset]-(Ne[m.value.client]-Ce.getBoundingClientRect()[m.value.direction]))},T=Ne=>{if(!s.value||!o.value||!e.wrapElement)return;const _e=Math.abs(Ne.target.getBoundingClientRect()[m.value.direction]-Ne[m.value.client]),Ce=s.value[m.value.offset]/2,re=(_e-Ce)*100*g.value/o.value[m.value.offset];e.wrapElement[m.value.scroll]=re*e.wrapElement[m.value.scrollSize]/100},k=Ne=>{Ne.stopImmediatePropagation(),u=!0,document.addEventListener("mousemove",y),document.addEventListener("mouseup",A),d=document.onselectstart,document.onselectstart=()=>!1},y=Ne=>{if(!o.value||!s.value||u===!1)return;const _e=a.value[m.value.axis];if(!_e)return;const Ce=(o.value.getBoundingClientRect()[m.value.direction]-Ne[m.value.client])*-1,re=s.value[m.value.offset]-_e,ue=(Ce-re)*100*g.value/o.value[m.value.offset];e.wrapElement[m.value.scroll]=ue*e.wrapElement[m.value.scrollSize]/100},A=()=>{u=!1,a.value[m.value.axis]=0,document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",A),ae(),c&&(i.value=!1)},V=()=>{c=!1,i.value=!!r.size},he=()=>{c=!0,i.value=u};onBeforeUnmount(()=>{ae(),document.removeEventListener("mouseup",A)});const ae=()=>{document.onselectstart!==d&&(document.onselectstart=d)};return useEventListener(toRef(e,"scrollbarElement"),"mousemove",V),useEventListener(toRef(e,"scrollbarElement"),"mouseleave",he),(Ne,_e)=>(openBlock(),createBlock(Transition,{name:unref(n).b("fade"),persisted:""},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{ref_key:"instance",ref:o,class:normalizeClass([unref(n).e("bar"),unref(n).is(unref(m).key)]),onMousedown:T},[createBaseVNode("div",{ref_key:"thumb",ref:s,class:normalizeClass(unref(n).e("thumb")),style:normalizeStyle(unref(v)),onMousedown:b},null,38)],34),[[vShow,Ne.always||i.value]])]),_:1},8,["name"]))}});var Thumb=_export_sfc(_sfc_main$12,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/thumb.vue"]]);const barProps=buildProps({always:{type:Boolean,default:!0},width:String,height:String,ratioX:{type:Number,default:1},ratioY:{type:Number,default:1}}),_sfc_main$11=defineComponent({__name:"bar",props:barProps,setup(t,{expose:r}){const e=t,n=ref(0),o=ref(0);return r({handleScroll:a=>{if(a){const i=a.offsetHeight-GAP,u=a.offsetWidth-GAP;o.value=a.scrollTop*100/i*e.ratioY,n.value=a.scrollLeft*100/u*e.ratioX}}}),(a,i)=>(openBlock(),createElementBlock(Fragment,null,[createVNode(Thumb,{move:n.value,ratio:a.ratioX,size:a.width,always:a.always},null,8,["move","ratio","size","always"]),createVNode(Thumb,{move:o.value,ratio:a.ratioY,size:a.height,vertical:"",always:a.always},null,8,["move","ratio","size","always"])],64))}});var Bar=_export_sfc(_sfc_main$11,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/bar.vue"]]);const scrollbarProps=buildProps({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:definePropType([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20}}),scrollbarEmits={scroll:({scrollTop:t,scrollLeft:r})=>[t,r].every(isNumber$1)},COMPONENT_NAME$5="ElScrollbar",__default__$G=defineComponent({name:COMPONENT_NAME$5}),_sfc_main$10=defineComponent({...__default__$G,props:scrollbarProps,emits:scrollbarEmits,setup(t,{expose:r,emit:e}){const n=t,o=useNamespace("scrollbar");let s,a;const i=ref(),u=ref(),c=ref(),d=ref("0"),m=ref("0"),v=ref(),g=ref(1),b=ref(1),T=computed(()=>{const _e={};return n.height&&(_e.height=addUnit(n.height)),n.maxHeight&&(_e.maxHeight=addUnit(n.maxHeight)),[n.wrapStyle,_e]}),k=computed(()=>[n.wrapClass,o.e("wrap"),{[o.em("wrap","hidden-default")]:!n.native}]),y=computed(()=>[o.e("view"),n.viewClass]),A=()=>{var _e;u.value&&((_e=v.value)==null||_e.handleScroll(u.value),e("scroll",{scrollTop:u.value.scrollTop,scrollLeft:u.value.scrollLeft}))};function V(_e,Ce){isObject$2(_e)?u.value.scrollTo(_e):isNumber$1(_e)&&isNumber$1(Ce)&&u.value.scrollTo(_e,Ce)}const he=_e=>{isNumber$1(_e)&&(u.value.scrollTop=_e)},ae=_e=>{isNumber$1(_e)&&(u.value.scrollLeft=_e)},Ne=()=>{if(!u.value)return;const _e=u.value.offsetHeight-GAP,Ce=u.value.offsetWidth-GAP,re=_e**2/u.value.scrollHeight,ue=Ce**2/u.value.scrollWidth,ze=Math.max(re,n.minSize),le=Math.max(ue,n.minSize);g.value=re/(_e-re)/(ze/(_e-ze)),b.value=ue/(Ce-ue)/(le/(Ce-le)),m.value=ze+GAP<_e?`${ze}px`:"",d.value=le+GAP<Ce?`${le}px`:""};return watch(()=>n.noresize,_e=>{_e?(s==null||s(),a==null||a()):({stop:s}=useResizeObserver(c,Ne),a=useEventListener("resize",Ne))},{immediate:!0}),watch(()=>[n.maxHeight,n.height],()=>{n.native||nextTick(()=>{var _e;Ne(),u.value&&((_e=v.value)==null||_e.handleScroll(u.value))})}),provide(scrollbarContextKey,reactive({scrollbarElement:i,wrapElement:u})),onMounted(()=>{n.native||nextTick(()=>{Ne()})}),onUpdated(()=>Ne()),r({wrapRef:u,update:Ne,scrollTo:V,setScrollTop:he,setScrollLeft:ae,handleScroll:A}),(_e,Ce)=>(openBlock(),createElementBlock("div",{ref_key:"scrollbarRef",ref:i,class:normalizeClass(unref(o).b())},[createBaseVNode("div",{ref_key:"wrapRef",ref:u,class:normalizeClass(unref(k)),style:normalizeStyle(unref(T)),onScroll:A},[(openBlock(),createBlock(resolveDynamicComponent(_e.tag),{ref_key:"resizeRef",ref:c,class:normalizeClass(unref(y)),style:normalizeStyle(_e.viewStyle)},{default:withCtx(()=>[renderSlot(_e.$slots,"default")]),_:3},8,["class","style"]))],38),_e.native?createCommentVNode("v-if",!0):(openBlock(),createBlock(Bar,{key:0,ref_key:"barRef",ref:v,height:m.value,width:d.value,always:_e.always,"ratio-x":b.value,"ratio-y":g.value},null,8,["height","width","always","ratio-x","ratio-y"]))],2))}});var Scrollbar=_export_sfc(_sfc_main$10,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/scrollbar.vue"]]);const ElScrollbar=withInstall(Scrollbar),POPPER_INJECTION_KEY=Symbol("popper"),POPPER_CONTENT_INJECTION_KEY=Symbol("popperContent"),roleTypes=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],popperProps=buildProps({role:{type:String,values:roleTypes,default:"tooltip"}}),__default__$F=defineComponent({name:"ElPopper",inheritAttrs:!1}),_sfc_main$$=defineComponent({...__default__$F,props:popperProps,setup(t,{expose:r}){const e=t,n=ref(),o=ref(),s=ref(),a=ref(),i=computed(()=>e.role),u={triggerRef:n,popperInstanceRef:o,contentRef:s,referenceRef:a,role:i};return r(u),provide(POPPER_INJECTION_KEY,u),(c,d)=>renderSlot(c.$slots,"default")}});var Popper=_export_sfc(_sfc_main$$,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/popper.vue"]]);const popperArrowProps=buildProps({arrowOffset:{type:Number,default:5}}),__default__$E=defineComponent({name:"ElPopperArrow",inheritAttrs:!1}),_sfc_main$_=defineComponent({...__default__$E,props:popperArrowProps,setup(t,{expose:r}){const e=t,n=useNamespace("popper"),{arrowOffset:o,arrowRef:s,arrowStyle:a}=inject(POPPER_CONTENT_INJECTION_KEY,void 0);return watch(()=>e.arrowOffset,i=>{o.value=i}),onBeforeUnmount(()=>{s.value=void 0}),r({arrowRef:s}),(i,u)=>(openBlock(),createElementBlock("span",{ref_key:"arrowRef",ref:s,class:normalizeClass(unref(n).e("arrow")),style:normalizeStyle(unref(a)),"data-popper-arrow":""},null,6))}});var ElPopperArrow=_export_sfc(_sfc_main$_,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/arrow.vue"]]);const NAME="ElOnlyChild",OnlyChild=defineComponent({name:NAME,setup(t,{slots:r,attrs:e}){var n;const o=inject(FORWARD_REF_INJECTION_KEY),s=useForwardRefDirective((n=o==null?void 0:o.setForwardRef)!=null?n:NOOP);return()=>{var a;const i=(a=r.default)==null?void 0:a.call(r,e);if(!i||i.length>1)return null;const u=findFirstLegitChild(i);return u?withDirectives(cloneVNode(u,e),[[s]]):null}}});function findFirstLegitChild(t){if(!t)return null;const r=t;for(const e of r){if(isObject$2(e))switch(e.type){case Comment:continue;case Text:case"svg":return wrapTextContent(e);case Fragment:return findFirstLegitChild(e.children);default:return e}return wrapTextContent(e)}return null}function wrapTextContent(t){const r=useNamespace("only-child");return createVNode("span",{class:r.e("content")},[t])}const popperTriggerProps=buildProps({virtualRef:{type:definePropType(Object)},virtualTriggering:Boolean,onMouseenter:{type:definePropType(Function)},onMouseleave:{type:definePropType(Function)},onClick:{type:definePropType(Function)},onKeydown:{type:definePropType(Function)},onFocus:{type:definePropType(Function)},onBlur:{type:definePropType(Function)},onContextmenu:{type:definePropType(Function)},id:String,open:Boolean}),__default__$D=defineComponent({name:"ElPopperTrigger",inheritAttrs:!1}),_sfc_main$Z=defineComponent({...__default__$D,props:popperTriggerProps,setup(t,{expose:r}){const e=t,{role:n,triggerRef:o}=inject(POPPER_INJECTION_KEY,void 0);useForwardRef(o);const s=computed(()=>i.value?e.id:void 0),a=computed(()=>{if(n&&n.value==="tooltip")return e.open&&e.id?e.id:void 0}),i=computed(()=>{if(n&&n.value!=="tooltip")return n.value}),u=computed(()=>i.value?`${e.open}`:void 0);let c;return onMounted(()=>{watch(()=>e.virtualRef,d=>{d&&(o.value=unrefElement(d))},{immediate:!0}),watch(o,(d,m)=>{c==null||c(),c=void 0,isElement(d)&&(["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"].forEach(v=>{var g;const b=e[v];b&&(d.addEventListener(v.slice(2).toLowerCase(),b),(g=m==null?void 0:m.removeEventListener)==null||g.call(m,v.slice(2).toLowerCase(),b))}),c=watch([s,a,i,u],v=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((g,b)=>{isNil(v[b])?d.removeAttribute(g):d.setAttribute(g,v[b])})},{immediate:!0})),isElement(m)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(v=>m.removeAttribute(v))},{immediate:!0})}),onBeforeUnmount(()=>{c==null||c(),c=void 0}),r({triggerRef:o}),(d,m)=>d.virtualTriggering?createCommentVNode("v-if",!0):(openBlock(),createBlock(unref(OnlyChild),mergeProps({key:0},d.$attrs,{"aria-controls":unref(s),"aria-describedby":unref(a),"aria-expanded":unref(u),"aria-haspopup":unref(i)}),{default:withCtx(()=>[renderSlot(d.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var ElPopperTrigger=_export_sfc(_sfc_main$Z,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/trigger.vue"]]);const FOCUS_AFTER_TRAPPED="focus-trap.focus-after-trapped",FOCUS_AFTER_RELEASED="focus-trap.focus-after-released",FOCUSOUT_PREVENTED="focus-trap.focusout-prevented",FOCUS_AFTER_TRAPPED_OPTS={cancelable:!0,bubbles:!1},FOCUSOUT_PREVENTED_OPTS={cancelable:!0,bubbles:!1},ON_TRAP_FOCUS_EVT="focusAfterTrapped",ON_RELEASE_FOCUS_EVT="focusAfterReleased",FOCUS_TRAP_INJECTION_KEY=Symbol("elFocusTrap"),focusReason=ref(),lastUserFocusTimestamp=ref(0),lastAutomatedFocusTimestamp=ref(0);let focusReasonUserCount=0;const obtainAllFocusableElements=t=>{const r=[],e=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const o=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||o?NodeFilter.FILTER_SKIP:n.tabIndex>=0||n===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;e.nextNode();)r.push(e.currentNode);return r},getVisibleElement=(t,r)=>{for(const e of t)if(!isHidden(e,r))return e},isHidden=(t,r)=>{if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(r&&t===r)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1},getEdges=t=>{const r=obtainAllFocusableElements(t),e=getVisibleElement(r,t),n=getVisibleElement(r.reverse(),t);return[e,n]},isSelectable=t=>t instanceof HTMLInputElement&&"select"in t,tryFocus=(t,r)=>{if(t&&t.focus){const e=document.activeElement;t.focus({preventScroll:!0}),lastAutomatedFocusTimestamp.value=window.performance.now(),t!==e&&isSelectable(t)&&r&&t.select()}};function removeFromStack(t,r){const e=[...t],n=t.indexOf(r);return n!==-1&&e.splice(n,1),e}const createFocusableStack=()=>{let t=[];return{push:n=>{const o=t[0];o&&n!==o&&o.pause(),t=removeFromStack(t,n),t.unshift(n)},remove:n=>{var o,s;t=removeFromStack(t,n),(s=(o=t[0])==null?void 0:o.resume)==null||s.call(o)}}},focusFirstDescendant=(t,r=!1)=>{const e=document.activeElement;for(const n of t)if(tryFocus(n,r),document.activeElement!==e)return},focusableStack=createFocusableStack(),isFocusCausedByUserEvent=()=>lastUserFocusTimestamp.value>lastAutomatedFocusTimestamp.value,notifyFocusReasonPointer=()=>{focusReason.value="pointer",lastUserFocusTimestamp.value=window.performance.now()},notifyFocusReasonKeydown=()=>{focusReason.value="keyboard",lastUserFocusTimestamp.value=window.performance.now()},useFocusReason=()=>(onMounted(()=>{focusReasonUserCount===0&&(document.addEventListener("mousedown",notifyFocusReasonPointer),document.addEventListener("touchstart",notifyFocusReasonPointer),document.addEventListener("keydown",notifyFocusReasonKeydown)),focusReasonUserCount++}),onBeforeUnmount(()=>{focusReasonUserCount--,focusReasonUserCount<=0&&(document.removeEventListener("mousedown",notifyFocusReasonPointer),document.removeEventListener("touchstart",notifyFocusReasonPointer),document.removeEventListener("keydown",notifyFocusReasonKeydown))}),{focusReason,lastUserFocusTimestamp,lastAutomatedFocusTimestamp}),createFocusOutPreventedEvent=t=>new CustomEvent(FOCUSOUT_PREVENTED,{...FOCUSOUT_PREVENTED_OPTS,detail:t}),_sfc_main$Y=defineComponent({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[ON_TRAP_FOCUS_EVT,ON_RELEASE_FOCUS_EVT,"focusin","focusout","focusout-prevented","release-requested"],setup(t,{emit:r}){const e=ref();let n,o;const{focusReason:s}=useFocusReason();useEscapeKeydown(b=>{t.trapped&&!a.paused&&r("release-requested",b)});const a={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},i=b=>{if(!t.loop&&!t.trapped||a.paused)return;const{key:T,altKey:k,ctrlKey:y,metaKey:A,currentTarget:V,shiftKey:he}=b,{loop:ae}=t,Ne=T===EVENT_CODE.tab&&!k&&!y&&!A,_e=document.activeElement;if(Ne&&_e){const Ce=V,[re,ue]=getEdges(Ce);if(re&&ue){if(!he&&_e===ue){const le=createFocusOutPreventedEvent({focusReason:s.value});r("focusout-prevented",le),le.defaultPrevented||(b.preventDefault(),ae&&tryFocus(re,!0))}else if(he&&[re,Ce].includes(_e)){const le=createFocusOutPreventedEvent({focusReason:s.value});r("focusout-prevented",le),le.defaultPrevented||(b.preventDefault(),ae&&tryFocus(ue,!0))}}else if(_e===Ce){const le=createFocusOutPreventedEvent({focusReason:s.value});r("focusout-prevented",le),le.defaultPrevented||b.preventDefault()}}};provide(FOCUS_TRAP_INJECTION_KEY,{focusTrapRef:e,onKeydown:i}),watch(()=>t.focusTrapEl,b=>{b&&(e.value=b)},{immediate:!0}),watch([e],([b],[T])=>{b&&(b.addEventListener("keydown",i),b.addEventListener("focusin",d),b.addEventListener("focusout",m)),T&&(T.removeEventListener("keydown",i),T.removeEventListener("focusin",d),T.removeEventListener("focusout",m))});const u=b=>{r(ON_TRAP_FOCUS_EVT,b)},c=b=>r(ON_RELEASE_FOCUS_EVT,b),d=b=>{const T=unref(e);if(!T)return;const k=b.target,y=b.relatedTarget,A=k&&T.contains(k);t.trapped||y&&T.contains(y)||(n=y),A&&r("focusin",b),!a.paused&&t.trapped&&(A?o=k:tryFocus(o,!0))},m=b=>{const T=unref(e);if(!(a.paused||!T))if(t.trapped){const k=b.relatedTarget;!isNil(k)&&!T.contains(k)&&setTimeout(()=>{if(!a.paused&&t.trapped){const y=createFocusOutPreventedEvent({focusReason:s.value});r("focusout-prevented",y),y.defaultPrevented||tryFocus(o,!0)}},0)}else{const k=b.target;k&&T.contains(k)||r("focusout",b)}};async function v(){await nextTick();const b=unref(e);if(b){focusableStack.push(a);const T=b.contains(document.activeElement)?n:document.activeElement;if(n=T,!b.contains(T)){const y=new Event(FOCUS_AFTER_TRAPPED,FOCUS_AFTER_TRAPPED_OPTS);b.addEventListener(FOCUS_AFTER_TRAPPED,u),b.dispatchEvent(y),y.defaultPrevented||nextTick(()=>{let A=t.focusStartEl;isString$2(A)||(tryFocus(A),document.activeElement!==A&&(A="first")),A==="first"&&focusFirstDescendant(obtainAllFocusableElements(b),!0),(document.activeElement===T||A==="container")&&tryFocus(b)})}}}function g(){const b=unref(e);if(b){b.removeEventListener(FOCUS_AFTER_TRAPPED,u);const T=new CustomEvent(FOCUS_AFTER_RELEASED,{...FOCUS_AFTER_TRAPPED_OPTS,detail:{focusReason:s.value}});b.addEventListener(FOCUS_AFTER_RELEASED,c),b.dispatchEvent(T),!T.defaultPrevented&&(s.value=="keyboard"||!isFocusCausedByUserEvent()||b.contains(document.activeElement))&&tryFocus(n??document.body),b.removeEventListener(FOCUS_AFTER_RELEASED,c),focusableStack.remove(a)}}return onMounted(()=>{t.trapped&&v(),watch(()=>t.trapped,b=>{b?v():g()})}),onBeforeUnmount(()=>{t.trapped&&g()}),{onKeydown:i}}});function _sfc_render$h(t,r,e,n,o,s){return renderSlot(t.$slots,"default",{handleKeydown:t.onKeydown})}var ElFocusTrap=_export_sfc(_sfc_main$Y,[["render",_sfc_render$h],["__file","/home/runner/work/element-plus/element-plus/packages/components/focus-trap/src/focus-trap.vue"]]);const POSITIONING_STRATEGIES=["fixed","absolute"],popperCoreConfigProps=buildProps({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:definePropType(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:Ee,default:"bottom"},popperOptions:{type:definePropType(Object),default:()=>({})},strategy:{type:String,values:POSITIONING_STRATEGIES,default:"absolute"}}),popperContentProps=buildProps({...popperCoreConfigProps,id:String,style:{type:definePropType([String,Array,Object])},className:{type:definePropType([String,Array,Object])},effect:{type:String,default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:definePropType([String,Array,Object])},popperStyle:{type:definePropType([String,Array,Object])},referenceEl:{type:definePropType(Object)},triggerTargetEl:{type:definePropType(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},ariaLabel:{type:String,default:void 0},virtualTriggering:Boolean,zIndex:Number}),popperContentEmits={mouseenter:t=>t instanceof MouseEvent,mouseleave:t=>t instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},buildPopperOptions=(t,r=[])=>{const{placement:e,strategy:n,popperOptions:o}=t,s={placement:e,strategy:n,...o,modifiers:[...genModifiers(t),...r]};return deriveExtraModifiers(s,o==null?void 0:o.modifiers),s},unwrapMeasurableEl=t=>{if(isClient)return unrefElement(t)};function genModifiers(t){const{offset:r,gpuAcceleration:e,fallbackPlacements:n}=t;return[{name:"offset",options:{offset:[0,r??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:n}},{name:"computeStyles",options:{gpuAcceleration:e}}]}function deriveExtraModifiers(t,r){r&&(t.modifiers=[...t.modifiers,...r??[]])}const DEFAULT_ARROW_OFFSET=0,usePopperContent=t=>{const{popperInstanceRef:r,contentRef:e,triggerRef:n,role:o}=inject(POPPER_INJECTION_KEY,void 0),s=ref(),a=ref(),i=computed(()=>({name:"eventListeners",enabled:!!t.visible})),u=computed(()=>{var y;const A=unref(s),V=(y=unref(a))!=null?y:DEFAULT_ARROW_OFFSET;return{name:"arrow",enabled:!isUndefined$2(A),options:{element:A,padding:V}}}),c=computed(()=>({onFirstUpdate:()=>{b()},...buildPopperOptions(t,[unref(u),unref(i)])})),d=computed(()=>unwrapMeasurableEl(t.referenceEl)||unref(n)),{attributes:m,state:v,styles:g,update:b,forceUpdate:T,instanceRef:k}=usePopper(d,e,c);return watch(k,y=>r.value=y),onMounted(()=>{watch(()=>{var y;return(y=unref(d))==null?void 0:y.getBoundingClientRect()},()=>{b()})}),{attributes:m,arrowRef:s,contentRef:e,instanceRef:k,state:v,styles:g,role:o,forceUpdate:T,update:b}},usePopperContentDOM=(t,{attributes:r,styles:e,role:n})=>{const{nextZIndex:o}=useZIndex(),s=useNamespace("popper"),a=computed(()=>unref(r).popper),i=ref(t.zIndex||o()),u=computed(()=>[s.b(),s.is("pure",t.pure),s.is(t.effect),t.popperClass]),c=computed(()=>[{zIndex:unref(i)},unref(e).popper,t.popperStyle||{}]),d=computed(()=>n.value==="dialog"?"false":void 0),m=computed(()=>unref(e).arrow||{});return{ariaModal:d,arrowStyle:m,contentAttrs:a,contentClass:u,contentStyle:c,contentZIndex:i,updateZIndex:()=>{i.value=t.zIndex||o()}}},usePopperContentFocusTrap=(t,r)=>{const e=ref(!1),n=ref();return{focusStartRef:n,trapped:e,onFocusAfterReleased:c=>{var d;((d=c.detail)==null?void 0:d.focusReason)!=="pointer"&&(n.value="first",r("blur"))},onFocusAfterTrapped:()=>{r("focus")},onFocusInTrap:c=>{t.visible&&!e.value&&(c.target&&(n.value=c.target),e.value=!0)},onFocusoutPrevented:c=>{t.trapping||(c.detail.focusReason==="pointer"&&c.preventDefault(),e.value=!1)},onReleaseRequested:()=>{e.value=!1,r("close")}}},__default__$C=defineComponent({name:"ElPopperContent"}),_sfc_main$X=defineComponent({...__default__$C,props:popperContentProps,emits:popperContentEmits,setup(t,{expose:r,emit:e}){const n=t,{focusStartRef:o,trapped:s,onFocusAfterReleased:a,onFocusAfterTrapped:i,onFocusInTrap:u,onFocusoutPrevented:c,onReleaseRequested:d}=usePopperContentFocusTrap(n,e),{attributes:m,arrowRef:v,contentRef:g,styles:b,instanceRef:T,role:k,update:y}=usePopperContent(n),{ariaModal:A,arrowStyle:V,contentAttrs:he,contentClass:ae,contentStyle:Ne,updateZIndex:_e}=usePopperContentDOM(n,{styles:b,attributes:m,role:k}),Ce=inject(formItemContextKey,void 0),re=ref();provide(POPPER_CONTENT_INJECTION_KEY,{arrowStyle:V,arrowRef:v,arrowOffset:re}),Ce&&(Ce.addInputId||Ce.removeInputId)&&provide(formItemContextKey,{...Ce,addInputId:NOOP,removeInputId:NOOP});let ue;const ze=(de=!0)=>{y(),de&&_e()},le=()=>{ze(!1),n.visible&&n.focusOnShow?s.value=!0:n.visible===!1&&(s.value=!1)};return onMounted(()=>{watch(()=>n.triggerTargetEl,(de,Ie)=>{ue==null||ue(),ue=void 0;const ie=unref(de||g.value),Ve=unref(Ie||g.value);isElement(ie)&&(ue=watch([k,()=>n.ariaLabel,A,()=>n.id],Ue=>{["role","aria-label","aria-modal","id"].forEach((Dt,tr)=>{isNil(Ue[tr])?ie.removeAttribute(Dt):ie.setAttribute(Dt,Ue[tr])})},{immediate:!0})),Ve!==ie&&isElement(Ve)&&["role","aria-label","aria-modal","id"].forEach(Ue=>{Ve.removeAttribute(Ue)})},{immediate:!0}),watch(()=>n.visible,le,{immediate:!0})}),onBeforeUnmount(()=>{ue==null||ue(),ue=void 0}),r({popperContentRef:g,popperInstanceRef:T,updatePopper:ze,contentStyle:Ne}),(de,Ie)=>(openBlock(),createElementBlock("div",mergeProps({ref_key:"contentRef",ref:g},unref(he),{style:unref(Ne),class:unref(ae),tabindex:"-1",onMouseenter:Ie[0]||(Ie[0]=ie=>de.$emit("mouseenter",ie)),onMouseleave:Ie[1]||(Ie[1]=ie=>de.$emit("mouseleave",ie))}),[createVNode(unref(ElFocusTrap),{trapped:unref(s),"trap-on-focus-in":!0,"focus-trap-el":unref(g),"focus-start-el":unref(o),onFocusAfterTrapped:unref(i),onFocusAfterReleased:unref(a),onFocusin:unref(u),onFocusoutPrevented:unref(c),onReleaseRequested:unref(d)},{default:withCtx(()=>[renderSlot(de.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16))}});var ElPopperContent=_export_sfc(_sfc_main$X,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/content.vue"]]);const ElPopper=withInstall(Popper),TOOLTIP_INJECTION_KEY=Symbol("elTooltip"),useTooltipContentProps=buildProps({...useDelayedToggleProps,...popperContentProps,appendTo:{type:definePropType([String,Object])},content:{type:String,default:""},rawContent:{type:Boolean,default:!1},persistent:Boolean,ariaLabel:String,visible:{type:definePropType(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean}),useTooltipTriggerProps=buildProps({...popperTriggerProps,disabled:Boolean,trigger:{type:definePropType([String,Array]),default:"hover"},triggerKeys:{type:definePropType(Array),default:()=>[EVENT_CODE.enter,EVENT_CODE.space]}}),{useModelToggleProps:useTooltipModelToggleProps,useModelToggleEmits:useTooltipModelToggleEmits,useModelToggle:useTooltipModelToggle}=createModelToggleComposable("visible"),useTooltipProps=buildProps({...popperProps,...useTooltipModelToggleProps,...useTooltipContentProps,...useTooltipTriggerProps,...popperArrowProps,showArrow:{type:Boolean,default:!0}}),tooltipEmits=[...useTooltipModelToggleEmits,"before-show","before-hide","show","hide","open","close"],isTriggerType=(t,r)=>isArray$4(t)?t.includes(r):t===r,whenTrigger=(t,r,e)=>n=>{isTriggerType(unref(t),r)&&e(n)},__default__$B=defineComponent({name:"ElTooltipTrigger"}),_sfc_main$W=defineComponent({...__default__$B,props:useTooltipTriggerProps,setup(t,{expose:r}){const e=t,n=useNamespace("tooltip"),{controlled:o,id:s,open:a,onOpen:i,onClose:u,onToggle:c}=inject(TOOLTIP_INJECTION_KEY,void 0),d=ref(null),m=()=>{if(unref(o)||e.disabled)return!0},v=toRef(e,"trigger"),g=composeEventHandlers(m,whenTrigger(v,"hover",i)),b=composeEventHandlers(m,whenTrigger(v,"hover",u)),T=composeEventHandlers(m,whenTrigger(v,"click",he=>{he.button===0&&c(he)})),k=composeEventHandlers(m,whenTrigger(v,"focus",i)),y=composeEventHandlers(m,whenTrigger(v,"focus",u)),A=composeEventHandlers(m,whenTrigger(v,"contextmenu",he=>{he.preventDefault(),c(he)})),V=composeEventHandlers(m,he=>{const{code:ae}=he;e.triggerKeys.includes(ae)&&(he.preventDefault(),c(he))});return r({triggerRef:d}),(he,ae)=>(openBlock(),createBlock(unref(ElPopperTrigger),{id:unref(s),"virtual-ref":he.virtualRef,open:unref(a),"virtual-triggering":he.virtualTriggering,class:normalizeClass(unref(n).e("trigger")),onBlur:unref(y),onClick:unref(T),onContextmenu:unref(A),onFocus:unref(k),onMouseenter:unref(g),onMouseleave:unref(b),onKeydown:unref(V)},{default:withCtx(()=>[renderSlot(he.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var ElTooltipTrigger=_export_sfc(_sfc_main$W,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/trigger.vue"]]);const __default__$A=defineComponent({name:"ElTooltipContent",inheritAttrs:!1}),_sfc_main$V=defineComponent({...__default__$A,props:useTooltipContentProps,setup(t,{expose:r}){const e=t,{selector:n}=usePopperContainerId(),o=useNamespace("tooltip"),s=ref(null),a=ref(!1),{controlled:i,id:u,open:c,trigger:d,onClose:m,onOpen:v,onShow:g,onHide:b,onBeforeShow:T,onBeforeHide:k}=inject(TOOLTIP_INJECTION_KEY,void 0),y=computed(()=>e.transition||`${o.namespace.value}-fade-in-linear`),A=computed(()=>e.persistent);onBeforeUnmount(()=>{a.value=!0});const V=computed(()=>unref(A)?!0:unref(c)),he=computed(()=>e.disabled?!1:unref(c)),ae=computed(()=>e.appendTo||n.value),Ne=computed(()=>{var Ue;return(Ue=e.style)!=null?Ue:{}}),_e=computed(()=>!unref(c)),Ce=()=>{b()},re=()=>{if(unref(i))return!0},ue=composeEventHandlers(re,()=>{e.enterable&&unref(d)==="hover"&&v()}),ze=composeEventHandlers(re,()=>{unref(d)==="hover"&&m()}),le=()=>{var Ue,Dt;(Dt=(Ue=s.value)==null?void 0:Ue.updatePopper)==null||Dt.call(Ue),T==null||T()},de=()=>{k==null||k()},Ie=()=>{g(),Ve=onClickOutside(computed(()=>{var Ue;return(Ue=s.value)==null?void 0:Ue.popperContentRef}),()=>{if(unref(i))return;unref(d)!=="hover"&&m()})},ie=()=>{e.virtualTriggering||m()};let Ve;return watch(()=>unref(c),Ue=>{Ue||Ve==null||Ve()},{flush:"post"}),watch(()=>e.content,()=>{var Ue,Dt;(Dt=(Ue=s.value)==null?void 0:Ue.updatePopper)==null||Dt.call(Ue)}),r({contentRef:s}),(Ue,Dt)=>(openBlock(),createBlock(Teleport,{disabled:!Ue.teleported,to:unref(ae)},[createVNode(Transition,{name:unref(y),onAfterLeave:Ce,onBeforeEnter:le,onAfterEnter:Ie,onBeforeLeave:de},{default:withCtx(()=>[unref(V)?withDirectives((openBlock(),createBlock(unref(ElPopperContent),mergeProps({key:0,id:unref(u),ref_key:"contentRef",ref:s},Ue.$attrs,{"aria-label":Ue.ariaLabel,"aria-hidden":unref(_e),"boundaries-padding":Ue.boundariesPadding,"fallback-placements":Ue.fallbackPlacements,"gpu-acceleration":Ue.gpuAcceleration,offset:Ue.offset,placement:Ue.placement,"popper-options":Ue.popperOptions,strategy:Ue.strategy,effect:Ue.effect,enterable:Ue.enterable,pure:Ue.pure,"popper-class":Ue.popperClass,"popper-style":[Ue.popperStyle,unref(Ne)],"reference-el":Ue.referenceEl,"trigger-target-el":Ue.triggerTargetEl,visible:unref(he),"z-index":Ue.zIndex,onMouseenter:unref(ue),onMouseleave:unref(ze),onBlur:ie,onClose:unref(m)}),{default:withCtx(()=>[a.value?createCommentVNode("v-if",!0):renderSlot(Ue.$slots,"default",{key:0})]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[vShow,unref(he)]]):createCommentVNode("v-if",!0)]),_:3},8,["name"])],8,["disabled","to"]))}});var ElTooltipContent=_export_sfc(_sfc_main$V,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/content.vue"]]);const _hoisted_1$r=["innerHTML"],_hoisted_2$i={key:1},__default__$z=defineComponent({name:"ElTooltip"}),_sfc_main$U=defineComponent({...__default__$z,props:useTooltipProps,emits:tooltipEmits,setup(t,{expose:r,emit:e}){const n=t;usePopperContainer();const o=useId(),s=ref(),a=ref(),i=()=>{var y;const A=unref(s);A&&((y=A.popperInstanceRef)==null||y.update())},u=ref(!1),c=ref(),{show:d,hide:m,hasUpdateHandler:v}=useTooltipModelToggle({indicator:u,toggleReason:c}),{onOpen:g,onClose:b}=useDelayedToggle({showAfter:toRef(n,"showAfter"),hideAfter:toRef(n,"hideAfter"),autoClose:toRef(n,"autoClose"),open:d,close:m}),T=computed(()=>isBoolean$1(n.visible)&&!v.value);provide(TOOLTIP_INJECTION_KEY,{controlled:T,id:o,open:readonly(u),trigger:toRef(n,"trigger"),onOpen:y=>{g(y)},onClose:y=>{b(y)},onToggle:y=>{unref(u)?b(y):g(y)},onShow:()=>{e("show",c.value)},onHide:()=>{e("hide",c.value)},onBeforeShow:()=>{e("before-show",c.value)},onBeforeHide:()=>{e("before-hide",c.value)},updatePopper:i}),watch(()=>n.disabled,y=>{y&&u.value&&(u.value=!1)});const k=y=>{var A,V;const he=(V=(A=a.value)==null?void 0:A.contentRef)==null?void 0:V.popperContentRef,ae=(y==null?void 0:y.relatedTarget)||document.activeElement;return he&&he.contains(ae)};return onDeactivated(()=>u.value&&m()),r({popperRef:s,contentRef:a,isFocusInsideContent:k,updatePopper:i,onOpen:g,onClose:b,hide:m}),(y,A)=>(openBlock(),createBlock(unref(ElPopper),{ref_key:"popperRef",ref:s,role:y.role},{default:withCtx(()=>[createVNode(ElTooltipTrigger,{disabled:y.disabled,trigger:y.trigger,"trigger-keys":y.triggerKeys,"virtual-ref":y.virtualRef,"virtual-triggering":y.virtualTriggering},{default:withCtx(()=>[y.$slots.default?renderSlot(y.$slots,"default",{key:0}):createCommentVNode("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),createVNode(ElTooltipContent,{ref_key:"contentRef",ref:a,"aria-label":y.ariaLabel,"boundaries-padding":y.boundariesPadding,content:y.content,disabled:y.disabled,effect:y.effect,enterable:y.enterable,"fallback-placements":y.fallbackPlacements,"hide-after":y.hideAfter,"gpu-acceleration":y.gpuAcceleration,offset:y.offset,persistent:y.persistent,"popper-class":y.popperClass,"popper-style":y.popperStyle,placement:y.placement,"popper-options":y.popperOptions,pure:y.pure,"raw-content":y.rawContent,"reference-el":y.referenceEl,"trigger-target-el":y.triggerTargetEl,"show-after":y.showAfter,strategy:y.strategy,teleported:y.teleported,transition:y.transition,"virtual-triggering":y.virtualTriggering,"z-index":y.zIndex,"append-to":y.appendTo},{default:withCtx(()=>[renderSlot(y.$slots,"content",{},()=>[y.rawContent?(openBlock(),createElementBlock("span",{key:0,innerHTML:y.content},null,8,_hoisted_1$r)):(openBlock(),createElementBlock("span",_hoisted_2$i,toDisplayString(y.content),1))]),y.showArrow?(openBlock(),createBlock(unref(ElPopperArrow),{key:0,"arrow-offset":y.arrowOffset},null,8,["arrow-offset"])):createCommentVNode("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var Tooltip=_export_sfc(_sfc_main$U,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/tooltip.vue"]]);const ElTooltip=withInstall(Tooltip),backtopProps={visibilityHeight:{type:Number,default:200},target:{type:String,default:""},right:{type:Number,default:40},bottom:{type:Number,default:40}},backtopEmits={click:t=>t instanceof MouseEvent},useBackTop=(t,r,e)=>{const n=shallowRef(),o=shallowRef(),s=ref(!1),a=()=>{n.value&&(s.value=n.value.scrollTop>=t.visibilityHeight)},i=c=>{var d;(d=n.value)==null||d.scrollTo({top:0,behavior:"smooth"}),r("click",c)},u=useThrottleFn(a,300,!0);return useEventListener(o,"scroll",u),onMounted(()=>{var c;o.value=document,n.value=document.documentElement,t.target&&(n.value=(c=document.querySelector(t.target))!=null?c:void 0,n.value||throwError(e,`target does not exist: ${t.target}`),o.value=n.value),a()}),{visible:s,handleClick:i}},COMPONENT_NAME$4="ElBacktop",__default__$y=defineComponent({name:COMPONENT_NAME$4}),_sfc_main$T=defineComponent({...__default__$y,props:backtopProps,emits:backtopEmits,setup(t,{emit:r}){const e=t,n=useNamespace("backtop"),{handleClick:o,visible:s}=useBackTop(e,r,COMPONENT_NAME$4),a=computed(()=>({right:`${e.right}px`,bottom:`${e.bottom}px`}));return(i,u)=>(openBlock(),createBlock(Transition,{name:`${unref(n).namespace.value}-fade-in`},{default:withCtx(()=>[unref(s)?(openBlock(),createElementBlock("div",{key:0,style:normalizeStyle(unref(a)),class:normalizeClass(unref(n).b()),onClick:u[0]||(u[0]=withModifiers((...c)=>unref(o)&&unref(o)(...c),["stop"]))},[renderSlot(i.$slots,"default",{},()=>[createVNode(unref(ElIcon),{class:normalizeClass(unref(n).e("icon"))},{default:withCtx(()=>[createVNode(unref(caret_top_default))]),_:1},8,["class"])])],6)):createCommentVNode("v-if",!0)]),_:3},8,["name"]))}});var Backtop=_export_sfc(_sfc_main$T,[["__file","/home/runner/work/element-plus/element-plus/packages/components/backtop/src/backtop.vue"]]);const ElBacktop=withInstall(Backtop),badgeProps=buildProps({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"}}),_hoisted_1$q=["textContent"],__default__$x=defineComponent({name:"ElBadge"}),_sfc_main$S=defineComponent({...__default__$x,props:badgeProps,setup(t,{expose:r}){const e=t,n=useNamespace("badge"),o=computed(()=>e.isDot?"":isNumber$1(e.value)&&isNumber$1(e.max)?e.max<e.value?`${e.max}+`:`${e.value}`:`${e.value}`);return r({content:o}),(s,a)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(n).b())},[renderSlot(s.$slots,"default"),createVNode(Transition,{name:`${unref(n).namespace.value}-zoom-in-center`,persisted:""},{default:withCtx(()=>[withDirectives(createBaseVNode("sup",{class:normalizeClass([unref(n).e("content"),unref(n).em("content",s.type),unref(n).is("fixed",!!s.$slots.default),unref(n).is("dot",s.isDot)]),textContent:toDisplayString(unref(o))},null,10,_hoisted_1$q),[[vShow,!s.hidden&&(unref(o)||s.isDot)]])]),_:1},8,["name"])],2))}});var Badge=_export_sfc(_sfc_main$S,[["__file","/home/runner/work/element-plus/element-plus/packages/components/badge/src/badge.vue"]]);const ElBadge=withInstall(Badge),buttonGroupContextKey=Symbol("buttonGroupContextKey"),useButton=(t,r)=>{useDeprecated({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},computed(()=>t.type==="text"));const e=inject(buttonGroupContextKey,void 0),n=useGlobalConfig("button"),{form:o}=useFormItem(),s=useFormSize(computed(()=>e==null?void 0:e.size)),a=useFormDisabled(),i=ref(),u=useSlots(),c=computed(()=>t.type||(e==null?void 0:e.type)||""),d=computed(()=>{var b,T,k;return(k=(T=t.autoInsertSpace)!=null?T:(b=n.value)==null?void 0:b.autoInsertSpace)!=null?k:!1}),m=computed(()=>t.tag==="button"?{ariaDisabled:a.value||t.loading,disabled:a.value||t.loading,autofocus:t.autofocus,type:t.nativeType}:{}),v=computed(()=>{var b;const T=(b=u.default)==null?void 0:b.call(u);if(d.value&&(T==null?void 0:T.length)===1){const k=T[0];if((k==null?void 0:k.type)===Text){const y=k.children;return/^\p{Unified_Ideograph}{2}$/u.test(y.trim())}}return!1});return{_disabled:a,_size:s,_type:c,_ref:i,_props:m,shouldAddSpace:v,handleClick:b=>{t.nativeType==="reset"&&(o==null||o.resetFields()),r("click",b)}}},buttonTypes=["default","primary","success","warning","info","danger","text",""],buttonNativeTypes=["button","submit","reset"],buttonProps=buildProps({size:useSizeProp,disabled:Boolean,type:{type:String,values:buttonTypes,default:""},icon:{type:iconPropType},nativeType:{type:String,values:buttonNativeTypes,default:"button"},loading:Boolean,loadingIcon:{type:iconPropType,default:()=>loading_default},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:definePropType([String,Object]),default:"button"}}),buttonEmits={click:t=>t instanceof MouseEvent};function bound01(t,r){isOnePointZero(t)&&(t="100%");var e=isPercentage(t);return t=r===360?t:Math.min(r,Math.max(0,parseFloat(t))),e&&(t=parseInt(String(t*r),10)/100),Math.abs(t-r)<1e-6?1:(r===360?t=(t<0?t%r+r:t%r)/parseFloat(String(r)):t=t%r/parseFloat(String(r)),t)}function clamp01(t){return Math.min(1,Math.max(0,t))}function isOnePointZero(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function isPercentage(t){return typeof t=="string"&&t.indexOf("%")!==-1}function boundAlpha(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function convertToPercentage(t){return t<=1?"".concat(Number(t)*100,"%"):t}function pad2(t){return t.length===1?"0"+t:String(t)}function rgbToRgb(t,r,e){return{r:bound01(t,255)*255,g:bound01(r,255)*255,b:bound01(e,255)*255}}function rgbToHsl(t,r,e){t=bound01(t,255),r=bound01(r,255),e=bound01(e,255);var n=Math.max(t,r,e),o=Math.min(t,r,e),s=0,a=0,i=(n+o)/2;if(n===o)a=0,s=0;else{var u=n-o;switch(a=i>.5?u/(2-n-o):u/(n+o),n){case t:s=(r-e)/u+(r<e?6:0);break;case r:s=(e-t)/u+2;break;case e:s=(t-r)/u+4;break}s/=6}return{h:s,s:a,l:i}}function hue2rgb(t,r,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+(r-t)*(6*e):e<1/2?r:e<2/3?t+(r-t)*(2/3-e)*6:t}function hslToRgb(t,r,e){var n,o,s;if(t=bound01(t,360),r=bound01(r,100),e=bound01(e,100),r===0)o=e,s=e,n=e;else{var a=e<.5?e*(1+r):e+r-e*r,i=2*e-a;n=hue2rgb(i,a,t+1/3),o=hue2rgb(i,a,t),s=hue2rgb(i,a,t-1/3)}return{r:n*255,g:o*255,b:s*255}}function rgbToHsv(t,r,e){t=bound01(t,255),r=bound01(r,255),e=bound01(e,255);var n=Math.max(t,r,e),o=Math.min(t,r,e),s=0,a=n,i=n-o,u=n===0?0:i/n;if(n===o)s=0;else{switch(n){case t:s=(r-e)/i+(r<e?6:0);break;case r:s=(e-t)/i+2;break;case e:s=(t-r)/i+4;break}s/=6}return{h:s,s:u,v:a}}function hsvToRgb(t,r,e){t=bound01(t,360)*6,r=bound01(r,100),e=bound01(e,100);var n=Math.floor(t),o=t-n,s=e*(1-r),a=e*(1-o*r),i=e*(1-(1-o)*r),u=n%6,c=[e,a,s,s,i,e][u],d=[i,e,e,a,s,s][u],m=[s,s,i,e,e,a][u];return{r:c*255,g:d*255,b:m*255}}function rgbToHex(t,r,e,n){var o=[pad2(Math.round(t).toString(16)),pad2(Math.round(r).toString(16)),pad2(Math.round(e).toString(16))];return n&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function rgbaToHex(t,r,e,n,o){var s=[pad2(Math.round(t).toString(16)),pad2(Math.round(r).toString(16)),pad2(Math.round(e).toString(16)),pad2(convertDecimalToHex(n))];return o&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function convertDecimalToHex(t){return Math.round(parseFloat(t)*255).toString(16)}function convertHexToDecimal(t){return parseIntFromHex(t)/255}function parseIntFromHex(t){return parseInt(t,16)}function numberInputToObject(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function inputToRGB(t){var r={r:0,g:0,b:0},e=1,n=null,o=null,s=null,a=!1,i=!1;return typeof t=="string"&&(t=stringInputToObject(t)),typeof t=="object"&&(isValidCSSUnit(t.r)&&isValidCSSUnit(t.g)&&isValidCSSUnit(t.b)?(r=rgbToRgb(t.r,t.g,t.b),a=!0,i=String(t.r).substr(-1)==="%"?"prgb":"rgb"):isValidCSSUnit(t.h)&&isValidCSSUnit(t.s)&&isValidCSSUnit(t.v)?(n=convertToPercentage(t.s),o=convertToPercentage(t.v),r=hsvToRgb(t.h,n,o),a=!0,i="hsv"):isValidCSSUnit(t.h)&&isValidCSSUnit(t.s)&&isValidCSSUnit(t.l)&&(n=convertToPercentage(t.s),s=convertToPercentage(t.l),r=hslToRgb(t.h,n,s),a=!0,i="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(e=t.a)),e=boundAlpha(e),{ok:a,format:t.format||i,r:Math.min(255,Math.max(r.r,0)),g:Math.min(255,Math.max(r.g,0)),b:Math.min(255,Math.max(r.b,0)),a:e}}var CSS_INTEGER="[-\\+]?\\d+%?",CSS_NUMBER="[-\\+]?\\d*\\.\\d+%?",CSS_UNIT="(?:".concat(CSS_NUMBER,")|(?:").concat(CSS_INTEGER,")"),PERMISSIVE_MATCH3="[\\s|\\(]+(".concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")\\s*\\)?"),PERMISSIVE_MATCH4="[\\s|\\(]+(".concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")\\s*\\)?"),matchers={CSS_UNIT:new RegExp(CSS_UNIT),rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function stringInputToObject(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var r=!1;if(names[t])t=names[t],r=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var e=matchers.rgb.exec(t);return e?{r:e[1],g:e[2],b:e[3]}:(e=matchers.rgba.exec(t),e?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=matchers.hsl.exec(t),e?{h:e[1],s:e[2],l:e[3]}:(e=matchers.hsla.exec(t),e?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=matchers.hsv.exec(t),e?{h:e[1],s:e[2],v:e[3]}:(e=matchers.hsva.exec(t),e?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=matchers.hex8.exec(t),e?{r:parseIntFromHex(e[1]),g:parseIntFromHex(e[2]),b:parseIntFromHex(e[3]),a:convertHexToDecimal(e[4]),format:r?"name":"hex8"}:(e=matchers.hex6.exec(t),e?{r:parseIntFromHex(e[1]),g:parseIntFromHex(e[2]),b:parseIntFromHex(e[3]),format:r?"name":"hex"}:(e=matchers.hex4.exec(t),e?{r:parseIntFromHex(e[1]+e[1]),g:parseIntFromHex(e[2]+e[2]),b:parseIntFromHex(e[3]+e[3]),a:convertHexToDecimal(e[4]+e[4]),format:r?"name":"hex8"}:(e=matchers.hex3.exec(t),e?{r:parseIntFromHex(e[1]+e[1]),g:parseIntFromHex(e[2]+e[2]),b:parseIntFromHex(e[3]+e[3]),format:r?"name":"hex"}:!1)))))))))}function isValidCSSUnit(t){return!!matchers.CSS_UNIT.exec(String(t))}var TinyColor=function(){function t(r,e){r===void 0&&(r=""),e===void 0&&(e={});var n;if(r instanceof t)return r;typeof r=="number"&&(r=numberInputToObject(r)),this.originalInput=r;var o=inputToRGB(r);this.originalInput=r,this.r=o.r,this.g=o.g,this.b=o.b,this.a=o.a,this.roundA=Math.round(100*this.a)/100,this.format=(n=e.format)!==null&&n!==void 0?n:o.format,this.gradientType=e.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=o.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var r=this.toRgb();return(r.r*299+r.g*587+r.b*114)/1e3},t.prototype.getLuminance=function(){var r=this.toRgb(),e,n,o,s=r.r/255,a=r.g/255,i=r.b/255;return s<=.03928?e=s/12.92:e=Math.pow((s+.055)/1.055,2.4),a<=.03928?n=a/12.92:n=Math.pow((a+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),.2126*e+.7152*n+.0722*o},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(r){return this.a=boundAlpha(r),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var r=this.toHsl().s;return r===0},t.prototype.toHsv=function(){var r=rgbToHsv(this.r,this.g,this.b);return{h:r.h*360,s:r.s,v:r.v,a:this.a}},t.prototype.toHsvString=function(){var r=rgbToHsv(this.r,this.g,this.b),e=Math.round(r.h*360),n=Math.round(r.s*100),o=Math.round(r.v*100);return this.a===1?"hsv(".concat(e,", ").concat(n,"%, ").concat(o,"%)"):"hsva(".concat(e,", ").concat(n,"%, ").concat(o,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var r=rgbToHsl(this.r,this.g,this.b);return{h:r.h*360,s:r.s,l:r.l,a:this.a}},t.prototype.toHslString=function(){var r=rgbToHsl(this.r,this.g,this.b),e=Math.round(r.h*360),n=Math.round(r.s*100),o=Math.round(r.l*100);return this.a===1?"hsl(".concat(e,", ").concat(n,"%, ").concat(o,"%)"):"hsla(".concat(e,", ").concat(n,"%, ").concat(o,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(r){return r===void 0&&(r=!1),rgbToHex(this.r,this.g,this.b,r)},t.prototype.toHexString=function(r){return r===void 0&&(r=!1),"#"+this.toHex(r)},t.prototype.toHex8=function(r){return r===void 0&&(r=!1),rgbaToHex(this.r,this.g,this.b,this.a,r)},t.prototype.toHex8String=function(r){return r===void 0&&(r=!1),"#"+this.toHex8(r)},t.prototype.toHexShortString=function(r){return r===void 0&&(r=!1),this.a===1?this.toHexString(r):this.toHex8String(r)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var r=Math.round(this.r),e=Math.round(this.g),n=Math.round(this.b);return this.a===1?"rgb(".concat(r,", ").concat(e,", ").concat(n,")"):"rgba(".concat(r,", ").concat(e,", ").concat(n,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var r=function(e){return"".concat(Math.round(bound01(e,255)*100),"%")};return{r:r(this.r),g:r(this.g),b:r(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var r=function(e){return Math.round(bound01(e,255)*100)};return this.a===1?"rgb(".concat(r(this.r),"%, ").concat(r(this.g),"%, ").concat(r(this.b),"%)"):"rgba(".concat(r(this.r),"%, ").concat(r(this.g),"%, ").concat(r(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var r="#"+rgbToHex(this.r,this.g,this.b,!1),e=0,n=Object.entries(names);e<n.length;e++){var o=n[e],s=o[0],a=o[1];if(r===a)return s}return!1},t.prototype.toString=function(r){var e=!!r;r=r??this.format;var n=!1,o=this.a<1&&this.a>=0,s=!e&&o&&(r.startsWith("hex")||r==="name");return s?r==="name"&&this.a===0?this.toName():this.toRgbString():(r==="rgb"&&(n=this.toRgbString()),r==="prgb"&&(n=this.toPercentageRgbString()),(r==="hex"||r==="hex6")&&(n=this.toHexString()),r==="hex3"&&(n=this.toHexString(!0)),r==="hex4"&&(n=this.toHex8String(!0)),r==="hex8"&&(n=this.toHex8String()),r==="name"&&(n=this.toName()),r==="hsl"&&(n=this.toHslString()),r==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.l+=r/100,e.l=clamp01(e.l),new t(e)},t.prototype.brighten=function(r){r===void 0&&(r=10);var e=this.toRgb();return e.r=Math.max(0,Math.min(255,e.r-Math.round(255*-(r/100)))),e.g=Math.max(0,Math.min(255,e.g-Math.round(255*-(r/100)))),e.b=Math.max(0,Math.min(255,e.b-Math.round(255*-(r/100)))),new t(e)},t.prototype.darken=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.l-=r/100,e.l=clamp01(e.l),new t(e)},t.prototype.tint=function(r){return r===void 0&&(r=10),this.mix("white",r)},t.prototype.shade=function(r){return r===void 0&&(r=10),this.mix("black",r)},t.prototype.desaturate=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.s-=r/100,e.s=clamp01(e.s),new t(e)},t.prototype.saturate=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.s+=r/100,e.s=clamp01(e.s),new t(e)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(r){var e=this.toHsl(),n=(e.h+r)%360;return e.h=n<0?360+n:n,new t(e)},t.prototype.mix=function(r,e){e===void 0&&(e=50);var n=this.toRgb(),o=new t(r).toRgb(),s=e/100,a={r:(o.r-n.r)*s+n.r,g:(o.g-n.g)*s+n.g,b:(o.b-n.b)*s+n.b,a:(o.a-n.a)*s+n.a};return new t(a)},t.prototype.analogous=function(r,e){r===void 0&&(r=6),e===void 0&&(e=30);var n=this.toHsl(),o=360/e,s=[this];for(n.h=(n.h-(o*r>>1)+720)%360;--r;)n.h=(n.h+o)%360,s.push(new t(n));return s},t.prototype.complement=function(){var r=this.toHsl();return r.h=(r.h+180)%360,new t(r)},t.prototype.monochromatic=function(r){r===void 0&&(r=6);for(var e=this.toHsv(),n=e.h,o=e.s,s=e.v,a=[],i=1/r;r--;)a.push(new t({h:n,s:o,v:s})),s=(s+i)%1;return a},t.prototype.splitcomplement=function(){var r=this.toHsl(),e=r.h;return[this,new t({h:(e+72)%360,s:r.s,l:r.l}),new t({h:(e+216)%360,s:r.s,l:r.l})]},t.prototype.onBackground=function(r){var e=this.toRgb(),n=new t(r).toRgb(),o=e.a+n.a*(1-e.a);return new t({r:(e.r*e.a+n.r*n.a*(1-e.a))/o,g:(e.g*e.a+n.g*n.a*(1-e.a))/o,b:(e.b*e.a+n.b*n.a*(1-e.a))/o,a:o})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(r){for(var e=this.toHsl(),n=e.h,o=[this],s=360/r,a=1;a<r;a++)o.push(new t({h:(n+a*s)%360,s:e.s,l:e.l}));return o},t.prototype.equals=function(r){return this.toRgbString()===new t(r).toRgbString()},t}();function darken(t,r=20){return t.mix("#141414",r).toString()}function useButtonCustomStyle(t){const r=useFormDisabled(),e=useNamespace("button");return computed(()=>{let n={};const o=t.color;if(o){const s=new TinyColor(o),a=t.dark?s.tint(20).toString():darken(s,20);if(t.plain)n=e.cssVarBlock({"bg-color":t.dark?darken(s,90):s.tint(90).toString(),"text-color":o,"border-color":t.dark?darken(s,50):s.tint(50).toString(),"hover-text-color":`var(${e.cssVarName("color-white")})`,"hover-bg-color":o,"hover-border-color":o,"active-bg-color":a,"active-text-color":`var(${e.cssVarName("color-white")})`,"active-border-color":a}),r.value&&(n[e.cssVarBlockName("disabled-bg-color")]=t.dark?darken(s,90):s.tint(90).toString(),n[e.cssVarBlockName("disabled-text-color")]=t.dark?darken(s,50):s.tint(50).toString(),n[e.cssVarBlockName("disabled-border-color")]=t.dark?darken(s,80):s.tint(80).toString());else{const i=t.dark?darken(s,30):s.tint(30).toString(),u=s.isDark()?`var(${e.cssVarName("color-white")})`:`var(${e.cssVarName("color-black")})`;if(n=e.cssVarBlock({"bg-color":o,"text-color":u,"border-color":o,"hover-bg-color":i,"hover-text-color":u,"hover-border-color":i,"active-bg-color":a,"active-border-color":a}),r.value){const c=t.dark?darken(s,50):s.tint(50).toString();n[e.cssVarBlockName("disabled-bg-color")]=c,n[e.cssVarBlockName("disabled-text-color")]=t.dark?"rgba(255, 255, 255, 0.5)":`var(${e.cssVarName("color-white")})`,n[e.cssVarBlockName("disabled-border-color")]=c}}}return n})}const __default__$w=defineComponent({name:"ElButton"}),_sfc_main$R=defineComponent({...__default__$w,props:buttonProps,emits:buttonEmits,setup(t,{expose:r,emit:e}){const n=t,o=useButtonCustomStyle(n),s=useNamespace("button"),{_ref:a,_size:i,_type:u,_disabled:c,_props:d,shouldAddSpace:m,handleClick:v}=useButton(n,e);return r({ref:a,size:i,type:u,disabled:c,shouldAddSpace:m}),(g,b)=>(openBlock(),createBlock(resolveDynamicComponent(g.tag),mergeProps({ref_key:"_ref",ref:a},unref(d),{class:[unref(s).b(),unref(s).m(unref(u)),unref(s).m(unref(i)),unref(s).is("disabled",unref(c)),unref(s).is("loading",g.loading),unref(s).is("plain",g.plain),unref(s).is("round",g.round),unref(s).is("circle",g.circle),unref(s).is("text",g.text),unref(s).is("link",g.link),unref(s).is("has-bg",g.bg)],style:unref(o),onClick:unref(v)}),{default:withCtx(()=>[g.loading?(openBlock(),createElementBlock(Fragment,{key:0},[g.$slots.loading?renderSlot(g.$slots,"loading",{key:0}):(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass(unref(s).is("loading"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(g.loadingIcon)))]),_:1},8,["class"]))],64)):g.icon||g.$slots.icon?(openBlock(),createBlock(unref(ElIcon),{key:1},{default:withCtx(()=>[g.icon?(openBlock(),createBlock(resolveDynamicComponent(g.icon),{key:0})):renderSlot(g.$slots,"icon",{key:1})]),_:3})):createCommentVNode("v-if",!0),g.$slots.default?(openBlock(),createElementBlock("span",{key:2,class:normalizeClass({[unref(s).em("text","expand")]:unref(m)})},[renderSlot(g.$slots,"default")],2)):createCommentVNode("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var Button=_export_sfc(_sfc_main$R,[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button.vue"]]);const buttonGroupProps={size:buttonProps.size,type:buttonProps.type},__default__$v=defineComponent({name:"ElButtonGroup"}),_sfc_main$Q=defineComponent({...__default__$v,props:buttonGroupProps,setup(t){const r=t;provide(buttonGroupContextKey,reactive({size:toRef(r,"size"),type:toRef(r,"type")}));const e=useNamespace("button");return(n,o)=>(openBlock(),createElementBlock("div",{class:normalizeClass(`${unref(e).b("group")}`)},[renderSlot(n.$slots,"default")],2))}});var ButtonGroup=_export_sfc(_sfc_main$Q,[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button-group.vue"]]);const ElButton=withInstall(Button,{ButtonGroup});withNoopInstall(ButtonGroup);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dayjs_min={exports:{}};(function(t,r){(function(e,n){t.exports=n()})(commonjsGlobal,function(){var e=1e3,n=6e4,o=36e5,s="millisecond",a="second",i="minute",u="hour",c="day",d="week",m="month",v="quarter",g="year",b="date",T="Invalid Date",k=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,A={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(de){var Ie=["th","st","nd","rd"],ie=de%100;return"["+de+(Ie[(ie-20)%10]||Ie[ie]||Ie[0])+"]"}},V=function(de,Ie,ie){var Ve=String(de);return!Ve||Ve.length>=Ie?de:""+Array(Ie+1-Ve.length).join(ie)+de},he={s:V,z:function(de){var Ie=-de.utcOffset(),ie=Math.abs(Ie),Ve=Math.floor(ie/60),Ue=ie%60;return(Ie<=0?"+":"-")+V(Ve,2,"0")+":"+V(Ue,2,"0")},m:function de(Ie,ie){if(Ie.date()<ie.date())return-de(ie,Ie);var Ve=12*(ie.year()-Ie.year())+(ie.month()-Ie.month()),Ue=Ie.clone().add(Ve,m),Dt=ie-Ue<0,tr=Ie.clone().add(Ve+(Dt?-1:1),m);return+(-(Ve+(ie-Ue)/(Dt?Ue-tr:tr-Ue))||0)},a:function(de){return de<0?Math.ceil(de)||0:Math.floor(de)},p:function(de){return{M:m,y:g,w:d,d:c,D:b,h:u,m:i,s:a,ms:s,Q:v}[de]||String(de||"").toLowerCase().replace(/s$/,"")},u:function(de){return de===void 0}},ae="en",Ne={};Ne[ae]=A;var _e=function(de){return de instanceof ze},Ce=function de(Ie,ie,Ve){var Ue;if(!Ie)return ae;if(typeof Ie=="string"){var Dt=Ie.toLowerCase();Ne[Dt]&&(Ue=Dt),ie&&(Ne[Dt]=ie,Ue=Dt);var tr=Ie.split("-");if(!Ue&&tr.length>1)return de(tr[0])}else{var dr=Ie.name;Ne[dr]=Ie,Ue=dr}return!Ve&&Ue&&(ae=Ue),Ue||!Ve&&ae},re=function(de,Ie){if(_e(de))return de.clone();var ie=typeof Ie=="object"?Ie:{};return ie.date=de,ie.args=arguments,new ze(ie)},ue=he;ue.l=Ce,ue.i=_e,ue.w=function(de,Ie){return re(de,{locale:Ie.$L,utc:Ie.$u,x:Ie.$x,$offset:Ie.$offset})};var ze=function(){function de(ie){this.$L=Ce(ie.locale,null,!0),this.parse(ie)}var Ie=de.prototype;return Ie.parse=function(ie){this.$d=function(Ve){var Ue=Ve.date,Dt=Ve.utc;if(Ue===null)return new Date(NaN);if(ue.u(Ue))return new Date;if(Ue instanceof Date)return new Date(Ue);if(typeof Ue=="string"&&!/Z$/i.test(Ue)){var tr=Ue.match(k);if(tr){var dr=tr[2]-1||0,fr=(tr[7]||"0").substring(0,3);return Dt?new Date(Date.UTC(tr[1],dr,tr[3]||1,tr[4]||0,tr[5]||0,tr[6]||0,fr)):new Date(tr[1],dr,tr[3]||1,tr[4]||0,tr[5]||0,tr[6]||0,fr)}}return new Date(Ue)}(ie),this.$x=ie.x||{},this.init()},Ie.init=function(){var ie=this.$d;this.$y=ie.getFullYear(),this.$M=ie.getMonth(),this.$D=ie.getDate(),this.$W=ie.getDay(),this.$H=ie.getHours(),this.$m=ie.getMinutes(),this.$s=ie.getSeconds(),this.$ms=ie.getMilliseconds()},Ie.$utils=function(){return ue},Ie.isValid=function(){return this.$d.toString()!==T},Ie.isSame=function(ie,Ve){var Ue=re(ie);return this.startOf(Ve)<=Ue&&Ue<=this.endOf(Ve)},Ie.isAfter=function(ie,Ve){return re(ie)<this.startOf(Ve)},Ie.isBefore=function(ie,Ve){return this.endOf(Ve)<re(ie)},Ie.$g=function(ie,Ve,Ue){return ue.u(ie)?this[Ve]:this.set(Ue,ie)},Ie.unix=function(){return Math.floor(this.valueOf()/1e3)},Ie.valueOf=function(){return this.$d.getTime()},Ie.startOf=function(ie,Ve){var Ue=this,Dt=!!ue.u(Ve)||Ve,tr=ue.p(ie),dr=function(er,nr){var Pt=ue.w(Ue.$u?Date.UTC(Ue.$y,nr,er):new Date(Ue.$y,nr,er),Ue);return Dt?Pt:Pt.endOf(c)},fr=function(er,nr){return ue.w(Ue.toDate()[er].apply(Ue.toDate("s"),(Dt?[0,0,0,0]:[23,59,59,999]).slice(nr)),Ue)},sr=this.$W,hr=this.$M,Fe=this.$D,or="set"+(this.$u?"UTC":"");switch(tr){case g:return Dt?dr(1,0):dr(31,11);case m:return Dt?dr(1,hr):dr(0,hr+1);case d:var ir=this.$locale().weekStart||0,$e=(sr<ir?sr+7:sr)-ir;return dr(Dt?Fe-$e:Fe+(6-$e),hr);case c:case b:return fr(or+"Hours",0);case u:return fr(or+"Minutes",1);case i:return fr(or+"Seconds",2);case a:return fr(or+"Milliseconds",3);default:return this.clone()}},Ie.endOf=function(ie){return this.startOf(ie,!1)},Ie.$set=function(ie,Ve){var Ue,Dt=ue.p(ie),tr="set"+(this.$u?"UTC":""),dr=(Ue={},Ue[c]=tr+"Date",Ue[b]=tr+"Date",Ue[m]=tr+"Month",Ue[g]=tr+"FullYear",Ue[u]=tr+"Hours",Ue[i]=tr+"Minutes",Ue[a]=tr+"Seconds",Ue[s]=tr+"Milliseconds",Ue)[Dt],fr=Dt===c?this.$D+(Ve-this.$W):Ve;if(Dt===m||Dt===g){var sr=this.clone().set(b,1);sr.$d[dr](fr),sr.init(),this.$d=sr.set(b,Math.min(this.$D,sr.daysInMonth())).$d}else dr&&this.$d[dr](fr);return this.init(),this},Ie.set=function(ie,Ve){return this.clone().$set(ie,Ve)},Ie.get=function(ie){return this[ue.p(ie)]()},Ie.add=function(ie,Ve){var Ue,Dt=this;ie=Number(ie);var tr=ue.p(Ve),dr=function(hr){var Fe=re(Dt);return ue.w(Fe.date(Fe.date()+Math.round(hr*ie)),Dt)};if(tr===m)return this.set(m,this.$M+ie);if(tr===g)return this.set(g,this.$y+ie);if(tr===c)return dr(1);if(tr===d)return dr(7);var fr=(Ue={},Ue[i]=n,Ue[u]=o,Ue[a]=e,Ue)[tr]||1,sr=this.$d.getTime()+ie*fr;return ue.w(sr,this)},Ie.subtract=function(ie,Ve){return this.add(-1*ie,Ve)},Ie.format=function(ie){var Ve=this,Ue=this.$locale();if(!this.isValid())return Ue.invalidDate||T;var Dt=ie||"YYYY-MM-DDTHH:mm:ssZ",tr=ue.z(this),dr=this.$H,fr=this.$m,sr=this.$M,hr=Ue.weekdays,Fe=Ue.months,or=Ue.meridiem,ir=function(nr,Pt,rr,kt){return nr&&(nr[Pt]||nr(Ve,Dt))||rr[Pt].slice(0,kt)},$e=function(nr){return ue.s(dr%12||12,nr,"0")},er=or||function(nr,Pt,rr){var kt=nr<12?"AM":"PM";return rr?kt.toLowerCase():kt};return Dt.replace(y,function(nr,Pt){return Pt||function(rr){switch(rr){case"YY":return String(Ve.$y).slice(-2);case"YYYY":return ue.s(Ve.$y,4,"0");case"M":return sr+1;case"MM":return ue.s(sr+1,2,"0");case"MMM":return ir(Ue.monthsShort,sr,Fe,3);case"MMMM":return ir(Fe,sr);case"D":return Ve.$D;case"DD":return ue.s(Ve.$D,2,"0");case"d":return String(Ve.$W);case"dd":return ir(Ue.weekdaysMin,Ve.$W,hr,2);case"ddd":return ir(Ue.weekdaysShort,Ve.$W,hr,3);case"dddd":return hr[Ve.$W];case"H":return String(dr);case"HH":return ue.s(dr,2,"0");case"h":return $e(1);case"hh":return $e(2);case"a":return er(dr,fr,!0);case"A":return er(dr,fr,!1);case"m":return String(fr);case"mm":return ue.s(fr,2,"0");case"s":return String(Ve.$s);case"ss":return ue.s(Ve.$s,2,"0");case"SSS":return ue.s(Ve.$ms,3,"0");case"Z":return tr}return null}(nr)||tr.replace(":","")})},Ie.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Ie.diff=function(ie,Ve,Ue){var Dt,tr=this,dr=ue.p(Ve),fr=re(ie),sr=(fr.utcOffset()-this.utcOffset())*n,hr=this-fr,Fe=function(){return ue.m(tr,fr)};switch(dr){case g:Dt=Fe()/12;break;case m:Dt=Fe();break;case v:Dt=Fe()/3;break;case d:Dt=(hr-sr)/6048e5;break;case c:Dt=(hr-sr)/864e5;break;case u:Dt=hr/o;break;case i:Dt=hr/n;break;case a:Dt=hr/e;break;default:Dt=hr}return Ue?Dt:ue.a(Dt)},Ie.daysInMonth=function(){return this.endOf(m).$D},Ie.$locale=function(){return Ne[this.$L]},Ie.locale=function(ie,Ve){if(!ie)return this.$L;var Ue=this.clone(),Dt=Ce(ie,Ve,!0);return Dt&&(Ue.$L=Dt),Ue},Ie.clone=function(){return ue.w(this.$d,this)},Ie.toDate=function(){return new Date(this.valueOf())},Ie.toJSON=function(){return this.isValid()?this.toISOString():null},Ie.toISOString=function(){return this.$d.toISOString()},Ie.toString=function(){return this.$d.toUTCString()},de}(),le=ze.prototype;return re.prototype=le,[["$ms",s],["$s",a],["$m",i],["$H",u],["$W",c],["$M",m],["$y",g],["$D",b]].forEach(function(de){le[de[1]]=function(Ie){return this.$g(Ie,de[0],de[1])}}),re.extend=function(de,Ie){return de.$i||(de(Ie,ze,re),de.$i=!0),re},re.locale=Ce,re.isDayjs=_e,re.unix=function(de){return re(1e3*de)},re.en=Ne[ae],re.Ls=Ne,re.p={},re})})(dayjs_min);var dayjs_minExports=dayjs_min.exports;const dayjs=getDefaultExportFromCjs(dayjs_minExports),nodeList=new Map;let startClick;isClient&&(document.addEventListener("mousedown",t=>startClick=t),document.addEventListener("mouseup",t=>{for(const r of nodeList.values())for(const{documentHandler:e}of r)e(t,startClick)}));function createDocumentHandler(t,r){let e=[];return Array.isArray(r.arg)?e=r.arg:isElement(r.arg)&&e.push(r.arg),function(n,o){const s=r.instance.popperRef,a=n.target,i=o==null?void 0:o.target,u=!r||!r.instance,c=!a||!i,d=t.contains(a)||t.contains(i),m=t===a,v=e.length&&e.some(b=>b==null?void 0:b.contains(a))||e.length&&e.includes(i),g=s&&(s.contains(a)||s.contains(i));u||c||d||m||v||g||r.value(n,o)}}const ClickOutside={beforeMount(t,r){nodeList.has(t)||nodeList.set(t,[]),nodeList.get(t).push({documentHandler:createDocumentHandler(t,r),bindingFn:r.value})},updated(t,r){nodeList.has(t)||nodeList.set(t,[]);const e=nodeList.get(t),n=e.findIndex(s=>s.bindingFn===r.oldValue),o={documentHandler:createDocumentHandler(t,r),bindingFn:r.value};n>=0?e.splice(n,1,o):e.push(o)},unmounted(t){nodeList.delete(t)}},FOCUSABLE_CHILDREN="_trap-focus-children",FOCUS_STACK=[],FOCUS_HANDLER=t=>{if(FOCUS_STACK.length===0)return;const r=FOCUS_STACK[FOCUS_STACK.length-1][FOCUSABLE_CHILDREN];if(r.length>0&&t.code===EVENT_CODE.tab){if(r.length===1){t.preventDefault(),document.activeElement!==r[0]&&r[0].focus();return}const e=t.shiftKey,n=t.target===r[0],o=t.target===r[r.length-1];n&&e&&(t.preventDefault(),r[r.length-1].focus()),o&&!e&&(t.preventDefault(),r[0].focus())}},TrapFocus={beforeMount(t){t[FOCUSABLE_CHILDREN]=obtainAllFocusableElements$1(t),FOCUS_STACK.push(t),FOCUS_STACK.length<=1&&document.addEventListener("keydown",FOCUS_HANDLER)},updated(t){nextTick(()=>{t[FOCUSABLE_CHILDREN]=obtainAllFocusableElements$1(t)})},unmounted(){FOCUS_STACK.shift(),FOCUS_STACK.length===0&&document.removeEventListener("keydown",FOCUS_HANDLER)}},checkboxProps={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object]},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},controls:{type:String,default:void 0},border:Boolean,size:useSizeProp,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0}},checkboxEmits={[UPDATE_MODEL_EVENT]:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t),change:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t)},checkboxGroupContextKey=Symbol("checkboxGroupContextKey"),useCheckboxDisabled=({model:t,isChecked:r})=>{const e=inject(checkboxGroupContextKey,void 0),n=computed(()=>{var s,a;const i=(s=e==null?void 0:e.max)==null?void 0:s.value,u=(a=e==null?void 0:e.min)==null?void 0:a.value;return!isUndefined$1(i)&&t.value.length>=i&&!r.value||!isUndefined$1(u)&&t.value.length<=u&&r.value});return{isDisabled:useFormDisabled(computed(()=>(e==null?void 0:e.disabled.value)||n.value)),isLimitDisabled:n}},useCheckboxEvent=(t,{model:r,isLimitExceeded:e,hasOwnLabel:n,isDisabled:o,isLabeledByFormItem:s})=>{const a=inject(checkboxGroupContextKey,void 0),{formItem:i}=useFormItem(),{emit:u}=getCurrentInstance();function c(b){var T,k;return b===t.trueLabel||b===!0?(T=t.trueLabel)!=null?T:!0:(k=t.falseLabel)!=null?k:!1}function d(b,T){u("change",c(b),T)}function m(b){if(e.value)return;const T=b.target;u("change",c(T.checked),b)}async function v(b){e.value||!n.value&&!o.value&&s.value&&(b.composedPath().some(y=>y.tagName==="LABEL")||(r.value=c([!1,t.falseLabel].includes(r.value)),await nextTick(),d(r.value,b)))}const g=computed(()=>(a==null?void 0:a.validateEvent)||t.validateEvent);return watch(()=>t.modelValue,()=>{g.value&&(i==null||i.validate("change").catch(b=>void 0))}),{handleChange:m,onClickRoot:v}},useCheckboxModel=t=>{const r=ref(!1),{emit:e}=getCurrentInstance(),n=inject(checkboxGroupContextKey,void 0),o=computed(()=>isUndefined$1(n)===!1),s=ref(!1);return{model:computed({get(){var i,u;return o.value?(i=n==null?void 0:n.modelValue)==null?void 0:i.value:(u=t.modelValue)!=null?u:r.value},set(i){var u,c;o.value&&isArray$4(i)?(s.value=((u=n==null?void 0:n.max)==null?void 0:u.value)!==void 0&&i.length>(n==null?void 0:n.max.value),s.value===!1&&((c=n==null?void 0:n.changeEvent)==null||c.call(n,i))):(e(UPDATE_MODEL_EVENT,i),r.value=i)}}),isGroup:o,isLimitExceeded:s}},useCheckboxStatus=(t,r,{model:e})=>{const n=inject(checkboxGroupContextKey,void 0),o=ref(!1),s=computed(()=>{const c=e.value;return isBoolean$1(c)?c:isArray$4(c)?isObject$2(t.label)?c.map(toRaw).some(d=>isEqual(d,t.label)):c.map(toRaw).includes(t.label):c!=null?c===t.trueLabel:!!c}),a=useFormSize(computed(()=>{var c;return(c=n==null?void 0:n.size)==null?void 0:c.value}),{prop:!0}),i=useFormSize(computed(()=>{var c;return(c=n==null?void 0:n.size)==null?void 0:c.value})),u=computed(()=>!!(r.default||t.label));return{checkboxButtonSize:a,isChecked:s,isFocused:o,checkboxSize:i,hasOwnLabel:u}},setStoreValue=(t,{model:r})=>{function e(){isArray$4(r.value)&&!r.value.includes(t.label)?r.value.push(t.label):r.value=t.trueLabel||!0}t.checked&&e()},useCheckbox=(t,r)=>{const{formItem:e}=useFormItem(),{model:n,isGroup:o,isLimitExceeded:s}=useCheckboxModel(t),{isFocused:a,isChecked:i,checkboxButtonSize:u,checkboxSize:c,hasOwnLabel:d}=useCheckboxStatus(t,r,{model:n}),{isDisabled:m}=useCheckboxDisabled({model:n,isChecked:i}),{inputId:v,isLabeledByFormItem:g}=useFormItemInputId(t,{formItemContext:e,disableIdGeneration:d,disableIdManagement:o}),{handleChange:b,onClickRoot:T}=useCheckboxEvent(t,{model:n,isLimitExceeded:s,hasOwnLabel:d,isDisabled:m,isLabeledByFormItem:g});return setStoreValue(t,{model:n}),{inputId:v,isLabeledByFormItem:g,isChecked:i,isDisabled:m,isFocused:a,checkboxButtonSize:u,checkboxSize:c,hasOwnLabel:d,model:n,handleChange:b,onClickRoot:T}},_hoisted_1$p=["tabindex","role","aria-checked"],_hoisted_2$h=["id","aria-hidden","name","tabindex","disabled","true-value","false-value"],_hoisted_3$b=["id","aria-hidden","disabled","value","name","tabindex"],__default__$u=defineComponent({name:"ElCheckbox"}),_sfc_main$P=defineComponent({...__default__$u,props:checkboxProps,emits:checkboxEmits,setup(t){const r=t,e=useSlots(),{inputId:n,isLabeledByFormItem:o,isChecked:s,isDisabled:a,isFocused:i,checkboxSize:u,hasOwnLabel:c,model:d,handleChange:m,onClickRoot:v}=useCheckbox(r,e),g=useNamespace("checkbox"),b=computed(()=>[g.b(),g.m(u.value),g.is("disabled",a.value),g.is("bordered",r.border),g.is("checked",s.value)]),T=computed(()=>[g.e("input"),g.is("disabled",a.value),g.is("checked",s.value),g.is("indeterminate",r.indeterminate),g.is("focus",i.value)]);return(k,y)=>(openBlock(),createBlock(resolveDynamicComponent(!unref(c)&&unref(o)?"span":"label"),{class:normalizeClass(unref(b)),"aria-controls":k.indeterminate?k.controls:null,onClick:unref(v)},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(unref(T)),tabindex:k.indeterminate?0:void 0,role:k.indeterminate?"checkbox":void 0,"aria-checked":k.indeterminate?"mixed":void 0},[k.trueLabel||k.falseLabel?withDirectives((openBlock(),createElementBlock("input",{key:0,id:unref(n),"onUpdate:modelValue":y[0]||(y[0]=A=>isRef(d)?d.value=A:null),class:normalizeClass(unref(g).e("original")),type:"checkbox","aria-hidden":k.indeterminate?"true":"false",name:k.name,tabindex:k.tabindex,disabled:unref(a),"true-value":k.trueLabel,"false-value":k.falseLabel,onChange:y[1]||(y[1]=(...A)=>unref(m)&&unref(m)(...A)),onFocus:y[2]||(y[2]=A=>i.value=!0),onBlur:y[3]||(y[3]=A=>i.value=!1),onClick:y[4]||(y[4]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_2$h)),[[vModelCheckbox,unref(d)]]):withDirectives((openBlock(),createElementBlock("input",{key:1,id:unref(n),"onUpdate:modelValue":y[5]||(y[5]=A=>isRef(d)?d.value=A:null),class:normalizeClass(unref(g).e("original")),type:"checkbox","aria-hidden":k.indeterminate?"true":"false",disabled:unref(a),value:k.label,name:k.name,tabindex:k.tabindex,onChange:y[6]||(y[6]=(...A)=>unref(m)&&unref(m)(...A)),onFocus:y[7]||(y[7]=A=>i.value=!0),onBlur:y[8]||(y[8]=A=>i.value=!1),onClick:y[9]||(y[9]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_3$b)),[[vModelCheckbox,unref(d)]]),createBaseVNode("span",{class:normalizeClass(unref(g).e("inner"))},null,2)],10,_hoisted_1$p),unref(c)?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(g).e("label"))},[renderSlot(k.$slots,"default"),k.$slots.default?createCommentVNode("v-if",!0):(openBlock(),createElementBlock(Fragment,{key:0},[createTextVNode(toDisplayString(k.label),1)],64))],2)):createCommentVNode("v-if",!0)]),_:3},8,["class","aria-controls","onClick"]))}});var Checkbox=_export_sfc(_sfc_main$P,[["__file","/home/runner/work/element-plus/element-plus/packages/components/checkbox/src/checkbox.vue"]]);const _hoisted_1$o=["name","tabindex","disabled","true-value","false-value"],_hoisted_2$g=["name","tabindex","disabled","value"],__default__$t=defineComponent({name:"ElCheckboxButton"}),_sfc_main$O=defineComponent({...__default__$t,props:checkboxProps,emits:checkboxEmits,setup(t){const r=t,e=useSlots(),{isFocused:n,isChecked:o,isDisabled:s,checkboxButtonSize:a,model:i,handleChange:u}=useCheckbox(r,e),c=inject(checkboxGroupContextKey,void 0),d=useNamespace("checkbox"),m=computed(()=>{var g,b,T,k;const y=(b=(g=c==null?void 0:c.fill)==null?void 0:g.value)!=null?b:"";return{backgroundColor:y,borderColor:y,color:(k=(T=c==null?void 0:c.textColor)==null?void 0:T.value)!=null?k:"",boxShadow:y?`-1px 0 0 0 ${y}`:void 0}}),v=computed(()=>[d.b("button"),d.bm("button",a.value),d.is("disabled",s.value),d.is("checked",o.value),d.is("focus",n.value)]);return(g,b)=>(openBlock(),createElementBlock("label",{class:normalizeClass(unref(v))},[g.trueLabel||g.falseLabel?withDirectives((openBlock(),createElementBlock("input",{key:0,"onUpdate:modelValue":b[0]||(b[0]=T=>isRef(i)?i.value=T:null),class:normalizeClass(unref(d).be("button","original")),type:"checkbox",name:g.name,tabindex:g.tabindex,disabled:unref(s),"true-value":g.trueLabel,"false-value":g.falseLabel,onChange:b[1]||(b[1]=(...T)=>unref(u)&&unref(u)(...T)),onFocus:b[2]||(b[2]=T=>n.value=!0),onBlur:b[3]||(b[3]=T=>n.value=!1),onClick:b[4]||(b[4]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_1$o)),[[vModelCheckbox,unref(i)]]):withDirectives((openBlock(),createElementBlock("input",{key:1,"onUpdate:modelValue":b[5]||(b[5]=T=>isRef(i)?i.value=T:null),class:normalizeClass(unref(d).be("button","original")),type:"checkbox",name:g.name,tabindex:g.tabindex,disabled:unref(s),value:g.label,onChange:b[6]||(b[6]=(...T)=>unref(u)&&unref(u)(...T)),onFocus:b[7]||(b[7]=T=>n.value=!0),onBlur:b[8]||(b[8]=T=>n.value=!1),onClick:b[9]||(b[9]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_2$g)),[[vModelCheckbox,unref(i)]]),g.$slots.default||g.label?(openBlock(),createElementBlock("span",{key:2,class:normalizeClass(unref(d).be("button","inner")),style:normalizeStyle(unref(o)?unref(m):void 0)},[renderSlot(g.$slots,"default",{},()=>[createTextVNode(toDisplayString(g.label),1)])],6)):createCommentVNode("v-if",!0)],2))}});var CheckboxButton=_export_sfc(_sfc_main$O,[["__file","/home/runner/work/element-plus/element-plus/packages/components/checkbox/src/checkbox-button.vue"]]);const checkboxGroupProps=buildProps({modelValue:{type:definePropType(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:useSizeProp,label:String,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0}}),checkboxGroupEmits={[UPDATE_MODEL_EVENT]:t=>isArray$4(t),change:t=>isArray$4(t)},__default__$s=defineComponent({name:"ElCheckboxGroup"}),_sfc_main$N=defineComponent({...__default__$s,props:checkboxGroupProps,emits:checkboxGroupEmits,setup(t,{emit:r}){const e=t,n=useNamespace("checkbox"),{formItem:o}=useFormItem(),{inputId:s,isLabeledByFormItem:a}=useFormItemInputId(e,{formItemContext:o}),i=async c=>{r(UPDATE_MODEL_EVENT,c),await nextTick(),r("change",c)},u=computed({get(){return e.modelValue},set(c){i(c)}});return provide(checkboxGroupContextKey,{...pick$1(toRefs(e),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:u,changeEvent:i}),watch(()=>e.modelValue,()=>{e.validateEvent&&(o==null||o.validate("change").catch(c=>void 0))}),(c,d)=>{var m;return openBlock(),createBlock(resolveDynamicComponent(c.tag),{id:unref(s),class:normalizeClass(unref(n).b("group")),role:"group","aria-label":unref(a)?void 0:c.label||"checkbox-group","aria-labelledby":unref(a)?(m=unref(o))==null?void 0:m.labelId:void 0},{default:withCtx(()=>[renderSlot(c.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var CheckboxGroup=_export_sfc(_sfc_main$N,[["__file","/home/runner/work/element-plus/element-plus/packages/components/checkbox/src/checkbox-group.vue"]]);const ElCheckbox=withInstall(Checkbox,{CheckboxButton,CheckboxGroup});withNoopInstall(CheckboxButton);const ElCheckboxGroup=withNoopInstall(CheckboxGroup),radioPropsBase=buildProps({size:useSizeProp,disabled:Boolean,label:{type:[String,Number,Boolean],default:""}}),radioProps=buildProps({...radioPropsBase,modelValue:{type:[String,Number,Boolean],default:""},name:{type:String,default:""},border:Boolean}),radioEmits={[UPDATE_MODEL_EVENT]:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t),[CHANGE_EVENT]:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t)},radioGroupKey=Symbol("radioGroupKey"),useRadio=(t,r)=>{const e=ref(),n=inject(radioGroupKey,void 0),o=computed(()=>!!n),s=computed({get(){return o.value?n.modelValue:t.modelValue},set(d){o.value?n.changeEvent(d):r&&r(UPDATE_MODEL_EVENT,d),e.value.checked=t.modelValue===t.label}}),a=useFormSize(computed(()=>n==null?void 0:n.size)),i=useFormDisabled(computed(()=>n==null?void 0:n.disabled)),u=ref(!1),c=computed(()=>i.value||o.value&&s.value!==t.label?-1:0);return{radioRef:e,isGroup:o,radioGroup:n,focus:u,size:a,disabled:i,tabIndex:c,modelValue:s}},_hoisted_1$n=["value","name","disabled"],__default__$r=defineComponent({name:"ElRadio"}),_sfc_main$M=defineComponent({...__default__$r,props:radioProps,emits:radioEmits,setup(t,{emit:r}){const e=t,n=useNamespace("radio"),{radioRef:o,radioGroup:s,focus:a,size:i,disabled:u,modelValue:c}=useRadio(e,r);function d(){nextTick(()=>r("change",c.value))}return(m,v)=>{var g;return openBlock(),createElementBlock("label",{class:normalizeClass([unref(n).b(),unref(n).is("disabled",unref(u)),unref(n).is("focus",unref(a)),unref(n).is("bordered",m.border),unref(n).is("checked",unref(c)===m.label),unref(n).m(unref(i))])},[createBaseVNode("span",{class:normalizeClass([unref(n).e("input"),unref(n).is("disabled",unref(u)),unref(n).is("checked",unref(c)===m.label)])},[withDirectives(createBaseVNode("input",{ref_key:"radioRef",ref:o,"onUpdate:modelValue":v[0]||(v[0]=b=>isRef(c)?c.value=b:null),class:normalizeClass(unref(n).e("original")),value:m.label,name:m.name||((g=unref(s))==null?void 0:g.name),disabled:unref(u),type:"radio",onFocus:v[1]||(v[1]=b=>a.value=!0),onBlur:v[2]||(v[2]=b=>a.value=!1),onChange:d,onClick:v[3]||(v[3]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_1$n),[[vModelRadio,unref(c)]]),createBaseVNode("span",{class:normalizeClass(unref(n).e("inner"))},null,2)],2),createBaseVNode("span",{class:normalizeClass(unref(n).e("label")),onKeydown:v[4]||(v[4]=withModifiers(()=>{},["stop"]))},[renderSlot(m.$slots,"default",{},()=>[createTextVNode(toDisplayString(m.label),1)])],34)],2)}}});var Radio=_export_sfc(_sfc_main$M,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio.vue"]]);const radioButtonProps=buildProps({...radioPropsBase,name:{type:String,default:""}}),_hoisted_1$m=["value","name","disabled"],__default__$q=defineComponent({name:"ElRadioButton"}),_sfc_main$L=defineComponent({...__default__$q,props:radioButtonProps,setup(t){const r=t,e=useNamespace("radio"),{radioRef:n,focus:o,size:s,disabled:a,modelValue:i,radioGroup:u}=useRadio(r),c=computed(()=>({backgroundColor:(u==null?void 0:u.fill)||"",borderColor:(u==null?void 0:u.fill)||"",boxShadow:u!=null&&u.fill?`-1px 0 0 0 ${u.fill}`:"",color:(u==null?void 0:u.textColor)||""}));return(d,m)=>{var v;return openBlock(),createElementBlock("label",{class:normalizeClass([unref(e).b("button"),unref(e).is("active",unref(i)===d.label),unref(e).is("disabled",unref(a)),unref(e).is("focus",unref(o)),unref(e).bm("button",unref(s))])},[withDirectives(createBaseVNode("input",{ref_key:"radioRef",ref:n,"onUpdate:modelValue":m[0]||(m[0]=g=>isRef(i)?i.value=g:null),class:normalizeClass(unref(e).be("button","original-radio")),value:d.label,type:"radio",name:d.name||((v=unref(u))==null?void 0:v.name),disabled:unref(a),onFocus:m[1]||(m[1]=g=>o.value=!0),onBlur:m[2]||(m[2]=g=>o.value=!1),onClick:m[3]||(m[3]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_1$m),[[vModelRadio,unref(i)]]),createBaseVNode("span",{class:normalizeClass(unref(e).be("button","inner")),style:normalizeStyle(unref(i)===d.label?unref(c):{}),onKeydown:m[4]||(m[4]=withModifiers(()=>{},["stop"]))},[renderSlot(d.$slots,"default",{},()=>[createTextVNode(toDisplayString(d.label),1)])],38)],2)}}});var RadioButton=_export_sfc(_sfc_main$L,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio-button.vue"]]);const radioGroupProps=buildProps({id:{type:String,default:void 0},size:useSizeProp,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:""},fill:{type:String,default:""},label:{type:String,default:void 0},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0}}),radioGroupEmits=radioEmits,_hoisted_1$l=["id","aria-label","aria-labelledby"],__default__$p=defineComponent({name:"ElRadioGroup"}),_sfc_main$K=defineComponent({...__default__$p,props:radioGroupProps,emits:radioGroupEmits,setup(t,{emit:r}){const e=t,n=useNamespace("radio"),o=useId(),s=ref(),{formItem:a}=useFormItem(),{inputId:i,isLabeledByFormItem:u}=useFormItemInputId(e,{formItemContext:a}),c=m=>{r(UPDATE_MODEL_EVENT,m),nextTick(()=>r("change",m))};onMounted(()=>{const m=s.value.querySelectorAll("[type=radio]"),v=m[0];!Array.from(m).some(g=>g.checked)&&v&&(v.tabIndex=0)});const d=computed(()=>e.name||o.value);return provide(radioGroupKey,reactive({...toRefs(e),changeEvent:c,name:d})),watch(()=>e.modelValue,()=>{e.validateEvent&&(a==null||a.validate("change").catch(m=>void 0))}),(m,v)=>(openBlock(),createElementBlock("div",{id:unref(i),ref_key:"radioGroupRef",ref:s,class:normalizeClass(unref(n).b("group")),role:"radiogroup","aria-label":unref(u)?void 0:m.label||"radio-group","aria-labelledby":unref(u)?unref(a).labelId:void 0},[renderSlot(m.$slots,"default")],10,_hoisted_1$l))}});var RadioGroup=_export_sfc(_sfc_main$K,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio-group.vue"]]);const ElRadio=withInstall(Radio,{RadioButton,RadioGroup});withNoopInstall(RadioGroup);withNoopInstall(RadioButton);var NodeContent=defineComponent({name:"NodeContent",setup(){return{ns:useNamespace("cascader-node")}},render(){const{ns:t}=this,{node:r,panel:e}=this.$parent,{data:n,label:o}=r,{renderLabelFn:s}=e;return h("span",{class:t.e("label")},s?s({node:r,data:n}):o)}});const CASCADER_PANEL_INJECTION_KEY=Symbol(),_sfc_main$J=defineComponent({name:"ElCascaderNode",components:{ElCheckbox,ElRadio,NodeContent,ElIcon,Check:check_default,Loading:loading_default,ArrowRight:arrow_right_default},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(t,{emit:r}){const e=inject(CASCADER_PANEL_INJECTION_KEY),n=useNamespace("cascader-node"),o=computed(()=>e.isHoverMenu),s=computed(()=>e.config.multiple),a=computed(()=>e.config.checkStrictly),i=computed(()=>{var Ne;return(Ne=e.checkedNodes[0])==null?void 0:Ne.uid}),u=computed(()=>t.node.isDisabled),c=computed(()=>t.node.isLeaf),d=computed(()=>a.value&&!c.value||!u.value),m=computed(()=>g(e.expandingNode)),v=computed(()=>a.value&&e.checkedNodes.some(g)),g=Ne=>{var _e;const{level:Ce,uid:re}=t.node;return((_e=Ne==null?void 0:Ne.pathNodes[Ce-1])==null?void 0:_e.uid)===re},b=()=>{m.value||e.expandNode(t.node)},T=Ne=>{const{node:_e}=t;Ne!==_e.checked&&e.handleCheckChange(_e,Ne)},k=()=>{e.lazyLoad(t.node,()=>{c.value||b()})},y=Ne=>{o.value&&(A(),!c.value&&r("expand",Ne))},A=()=>{const{node:Ne}=t;!d.value||Ne.loading||(Ne.loaded?b():k())},V=()=>{o.value&&!c.value||(c.value&&!u.value&&!a.value&&!s.value?ae(!0):A())},he=Ne=>{a.value?(T(Ne),t.node.loaded&&b()):ae(Ne)},ae=Ne=>{t.node.loaded?(T(Ne),!a.value&&b()):k()};return{panel:e,isHoverMenu:o,multiple:s,checkStrictly:a,checkedNodeId:i,isDisabled:u,isLeaf:c,expandable:d,inExpandingPath:m,inCheckedPath:v,ns:n,handleHoverExpand:y,handleExpand:A,handleClick:V,handleCheck:ae,handleSelectCheck:he}}}),_hoisted_1$k=["id","aria-haspopup","aria-owns","aria-expanded","tabindex"],_hoisted_2$f=createBaseVNode("span",null,null,-1);function _sfc_render$g(t,r,e,n,o,s){const a=resolveComponent("el-checkbox"),i=resolveComponent("el-radio"),u=resolveComponent("check"),c=resolveComponent("el-icon"),d=resolveComponent("node-content"),m=resolveComponent("loading"),v=resolveComponent("arrow-right");return openBlock(),createElementBlock("li",{id:`${t.menuId}-${t.node.uid}`,role:"menuitem","aria-haspopup":!t.isLeaf,"aria-owns":t.isLeaf?null:t.menuId,"aria-expanded":t.inExpandingPath,tabindex:t.expandable?-1:void 0,class:normalizeClass([t.ns.b(),t.ns.is("selectable",t.checkStrictly),t.ns.is("active",t.node.checked),t.ns.is("disabled",!t.expandable),t.inExpandingPath&&"in-active-path",t.inCheckedPath&&"in-checked-path"]),onMouseenter:r[2]||(r[2]=(...g)=>t.handleHoverExpand&&t.handleHoverExpand(...g)),onFocus:r[3]||(r[3]=(...g)=>t.handleHoverExpand&&t.handleHoverExpand(...g)),onClick:r[4]||(r[4]=(...g)=>t.handleClick&&t.handleClick(...g))},[createCommentVNode(" prefix "),t.multiple?(openBlock(),createBlock(a,{key:0,"model-value":t.node.checked,indeterminate:t.node.indeterminate,disabled:t.isDisabled,onClick:r[0]||(r[0]=withModifiers(()=>{},["stop"])),"onUpdate:modelValue":t.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onUpdate:modelValue"])):t.checkStrictly?(openBlock(),createBlock(i,{key:1,"model-value":t.checkedNodeId,label:t.node.uid,disabled:t.isDisabled,"onUpdate:modelValue":t.handleSelectCheck,onClick:r[1]||(r[1]=withModifiers(()=>{},["stop"]))},{default:withCtx(()=>[createCommentVNode(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),_hoisted_2$f]),_:1},8,["model-value","label","disabled","onUpdate:modelValue"])):t.isLeaf&&t.node.checked?(openBlock(),createBlock(c,{key:2,class:normalizeClass(t.ns.e("prefix"))},{default:withCtx(()=>[createVNode(u)]),_:1},8,["class"])):createCommentVNode("v-if",!0),createCommentVNode(" content "),createVNode(d),createCommentVNode(" postfix "),t.isLeaf?createCommentVNode("v-if",!0):(openBlock(),createElementBlock(Fragment,{key:3},[t.node.loading?(openBlock(),createBlock(c,{key:0,class:normalizeClass([t.ns.is("loading"),t.ns.e("postfix")])},{default:withCtx(()=>[createVNode(m)]),_:1},8,["class"])):(openBlock(),createBlock(c,{key:1,class:normalizeClass(["arrow-right",t.ns.e("postfix")])},{default:withCtx(()=>[createVNode(v)]),_:1},8,["class"]))],64))],42,_hoisted_1$k)}var ElCascaderNode=_export_sfc(_sfc_main$J,[["render",_sfc_render$g],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/node.vue"]]);const _sfc_main$I=defineComponent({name:"ElCascaderMenu",components:{Loading:loading_default,ElIcon,ElScrollbar,ElCascaderNode},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(t){const r=getCurrentInstance(),e=useNamespace("cascader-menu"),{t:n}=useLocale(),o=generateId();let s=null,a=null;const i=inject(CASCADER_PANEL_INJECTION_KEY),u=ref(null),c=computed(()=>!t.nodes.length),d=computed(()=>!i.initialLoaded),m=computed(()=>`cascader-menu-${o}-${t.index}`),v=k=>{s=k.target},g=k=>{if(!(!i.isHoverMenu||!s||!u.value))if(s.contains(k.target)){b();const y=r.vnode.el,{left:A}=y.getBoundingClientRect(),{offsetWidth:V,offsetHeight:he}=y,ae=k.clientX-A,Ne=s.offsetTop,_e=Ne+s.offsetHeight;u.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${ae} ${Ne} L${V} 0 V${Ne} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${ae} ${_e} L${V} ${he} V${_e} Z" />
        `}else a||(a=window.setTimeout(T,i.config.hoverThreshold))},b=()=>{a&&(clearTimeout(a),a=null)},T=()=>{u.value&&(u.value.innerHTML="",b())};return{ns:e,panel:i,hoverZone:u,isEmpty:c,isLoading:d,menuId:m,t:n,handleExpand:v,handleMouseMove:g,clearHoverZone:T}}});function _sfc_render$f(t,r,e,n,o,s){const a=resolveComponent("el-cascader-node"),i=resolveComponent("loading"),u=resolveComponent("el-icon"),c=resolveComponent("el-scrollbar");return openBlock(),createBlock(c,{key:t.menuId,tag:"ul",role:"menu",class:normalizeClass(t.ns.b()),"wrap-class":t.ns.e("wrap"),"view-class":[t.ns.e("list"),t.ns.is("empty",t.isEmpty)],onMousemove:t.handleMouseMove,onMouseleave:t.clearHoverZone},{default:withCtx(()=>{var d;return[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.nodes,m=>(openBlock(),createBlock(a,{key:m.uid,node:m,"menu-id":t.menuId,onExpand:t.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),t.isLoading?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(t.ns.e("empty-text"))},[createVNode(u,{size:"14",class:normalizeClass(t.ns.is("loading"))},{default:withCtx(()=>[createVNode(i)]),_:1},8,["class"]),createTextVNode(" "+toDisplayString(t.t("el.cascader.loading")),1)],2)):t.isEmpty?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(t.ns.e("empty-text"))},toDisplayString(t.t("el.cascader.noData")),3)):(d=t.panel)!=null&&d.isHoverMenu?(openBlock(),createElementBlock("svg",{key:2,ref:"hoverZone",class:normalizeClass(t.ns.e("hover-zone"))},null,2)):createCommentVNode("v-if",!0)]}),_:1},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var ElCascaderMenu=_export_sfc(_sfc_main$I,[["render",_sfc_render$f],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/menu.vue"]]);let uid=0;const calculatePathNodes=t=>{const r=[t];let{parent:e}=t;for(;e;)r.unshift(e),e=e.parent;return r};class Node{constructor(r,e,n,o=!1){this.data=r,this.config=e,this.parent=n,this.root=o,this.uid=uid++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:s,label:a,children:i}=e,u=r[i],c=calculatePathNodes(this);this.level=o?0:n?n.level+1:1,this.value=r[s],this.label=r[a],this.pathNodes=c,this.pathValues=c.map(d=>d.value),this.pathLabels=c.map(d=>d.label),this.childrenData=u,this.children=(u||[]).map(d=>new Node(d,e,this)),this.loaded=!e.lazy||this.isLeaf||!isEmpty(u)}get isDisabled(){const{data:r,parent:e,config:n}=this,{disabled:o,checkStrictly:s}=n;return(isFunction$3(o)?o(r,this):!!r[o])||!s&&(e==null?void 0:e.isDisabled)}get isLeaf(){const{data:r,config:e,childrenData:n,loaded:o}=this,{lazy:s,leaf:a}=e,i=isFunction$3(a)?a(r,this):r[a];return isUndefined$1(i)?s&&!o?!1:!(Array.isArray(n)&&n.length):!!i}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(r){const{childrenData:e,children:n}=this,o=new Node(r,this.config,this);return Array.isArray(e)?e.push(r):this.childrenData=[r],n.push(o),o}calcText(r,e){const n=r?this.pathLabels.join(e):this.label;return this.text=n,n}broadcast(r,...e){const n=`onParent${capitalize(r)}`;this.children.forEach(o=>{o&&(o.broadcast(r,...e),o[n]&&o[n](...e))})}emit(r,...e){const{parent:n}=this,o=`onChild${capitalize(r)}`;n&&(n[o]&&n[o](...e),n.emit(r,...e))}onParentCheck(r){this.isDisabled||this.setCheckState(r)}onChildCheck(){const{children:r}=this,e=r.filter(o=>!o.isDisabled),n=e.length?e.every(o=>o.checked):!1;this.setCheckState(n)}setCheckState(r){const e=this.children.length,n=this.children.reduce((o,s)=>{const a=s.checked?1:s.indeterminate?.5:0;return o+a},0);this.checked=this.loaded&&this.children.filter(o=>!o.isDisabled).every(o=>o.loaded&&o.checked)&&r,this.indeterminate=this.loaded&&n!==e&&n>0}doCheck(r){if(this.checked===r)return;const{checkStrictly:e,multiple:n}=this.config;e||!n?this.checked=r:(this.broadcast("check",r),this.setCheckState(r),this.emit("check"))}}const flatNodes=(t,r)=>t.reduce((e,n)=>(n.isLeaf?e.push(n):(!r&&e.push(n),e=e.concat(flatNodes(n.children,r))),e),[]);class Store{constructor(r,e){this.config=e;const n=(r||[]).map(o=>new Node(o,this.config));this.nodes=n,this.allNodes=flatNodes(n,!1),this.leafNodes=flatNodes(n,!0)}getNodes(){return this.nodes}getFlattedNodes(r){return r?this.leafNodes:this.allNodes}appendNode(r,e){const n=e?e.appendChild(r):new Node(r,this.config);e||this.nodes.push(n),this.allNodes.push(n),n.isLeaf&&this.leafNodes.push(n)}appendNodes(r,e){r.forEach(n=>this.appendNode(n,e))}getNodeByValue(r,e=!1){return!r&&r!==0?null:this.getFlattedNodes(e).find(o=>isEqual(o.value,r)||isEqual(o.pathValues,r))||null}getSameNode(r){return r&&this.getFlattedNodes(!1).find(({value:n,level:o})=>isEqual(r.value,n)&&r.level===o)||null}}const CommonProps=buildProps({modelValue:{type:definePropType([Number,String,Array])},options:{type:definePropType(Array),default:()=>[]},props:{type:definePropType(Object),default:()=>({})}}),DefaultProps={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:NOOP,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},useCascaderConfig=t=>computed(()=>({...DefaultProps,...t.props})),getMenuIndex=t=>{if(!t)return 0;const r=t.id.split("-");return Number(r[r.length-2])},checkNode=t=>{if(!t)return;const r=t.querySelector("input");r?r.click():isLeaf(t)&&t.click()},sortByOriginalOrder=(t,r)=>{const e=r.slice(0),n=e.map(s=>s.uid),o=t.reduce((s,a)=>{const i=n.indexOf(a.uid);return i>-1&&(s.push(a),e.splice(i,1),n.splice(i,1)),s},[]);return o.push(...e),o},_sfc_main$H=defineComponent({name:"ElCascaderPanel",components:{ElCascaderMenu},props:{...CommonProps,border:{type:Boolean,default:!0},renderLabel:Function},emits:[UPDATE_MODEL_EVENT,CHANGE_EVENT,"close","expand-change"],setup(t,{emit:r,slots:e}){let n=!1;const o=useNamespace("cascader"),s=useCascaderConfig(t);let a=null;const i=ref(!0),u=ref([]),c=ref(null),d=ref([]),m=ref(null),v=ref([]),g=computed(()=>s.value.expandTrigger==="hover"),b=computed(()=>t.renderLabel||e.default),T=()=>{const{options:le}=t,de=s.value;n=!1,a=new Store(le,de),d.value=[a.getNodes()],de.lazy&&isEmpty(t.options)?(i.value=!1,k(void 0,Ie=>{Ie&&(a=new Store(Ie,de),d.value=[a.getNodes()]),i.value=!0,Ce(!1,!0)})):Ce(!1,!0)},k=(le,de)=>{const Ie=s.value;le=le||new Node({},Ie,void 0,!0),le.loading=!0;const ie=Ve=>{const Ue=le,Dt=Ue.root?null:Ue;Ve&&(a==null||a.appendNodes(Ve,Dt)),Ue.loading=!1,Ue.loaded=!0,Ue.childrenData=Ue.childrenData||[],de&&de(Ve)};Ie.lazyLoad(le,ie)},y=(le,de)=>{var Ie;const{level:ie}=le,Ve=d.value.slice(0,ie);let Ue;le.isLeaf?Ue=le.pathNodes[ie-2]:(Ue=le,Ve.push(le.children)),((Ie=m.value)==null?void 0:Ie.uid)!==(Ue==null?void 0:Ue.uid)&&(m.value=le,d.value=Ve,!de&&r("expand-change",(le==null?void 0:le.pathValues)||[]))},A=(le,de,Ie=!0)=>{const{checkStrictly:ie,multiple:Ve}=s.value,Ue=v.value[0];n=!0,!Ve&&(Ue==null||Ue.doCheck(!1)),le.doCheck(de),_e(),Ie&&!Ve&&!ie&&r("close"),!Ie&&!Ve&&!ie&&V(le)},V=le=>{le&&(le=le.parent,V(le),le&&y(le))},he=le=>a==null?void 0:a.getFlattedNodes(le),ae=le=>{var de;return(de=he(le))==null?void 0:de.filter(Ie=>Ie.checked!==!1)},Ne=()=>{v.value.forEach(le=>le.doCheck(!1)),_e(),d.value=d.value.slice(0,1),m.value=null,r("expand-change",[])},_e=()=>{var le;const{checkStrictly:de,multiple:Ie}=s.value,ie=v.value,Ve=ae(!de),Ue=sortByOriginalOrder(ie,Ve),Dt=Ue.map(tr=>tr.valueByOption);v.value=Ue,c.value=Ie?Dt:(le=Dt[0])!=null?le:null},Ce=(le=!1,de=!1)=>{const{modelValue:Ie}=t,{lazy:ie,multiple:Ve,checkStrictly:Ue}=s.value,Dt=!Ue;if(!(!i.value||n||!de&&isEqual(Ie,c.value)))if(ie&&!le){const dr=unique(flattenDeep(castArray(Ie))).map(fr=>a==null?void 0:a.getNodeByValue(fr)).filter(fr=>!!fr&&!fr.loaded&&!fr.loading);dr.length?dr.forEach(fr=>{k(fr,()=>Ce(!1,de))}):Ce(!0,de)}else{const tr=Ve?castArray(Ie):[Ie],dr=unique(tr.map(fr=>a==null?void 0:a.getNodeByValue(fr,Dt)));re(dr,de),c.value=cloneDeep(Ie)}},re=(le,de=!0)=>{const{checkStrictly:Ie}=s.value,ie=v.value,Ve=le.filter(tr=>!!tr&&(Ie||tr.isLeaf)),Ue=a==null?void 0:a.getSameNode(m.value),Dt=de&&Ue||Ve[0];Dt?Dt.pathNodes.forEach(tr=>y(tr,!0)):m.value=null,ie.forEach(tr=>tr.doCheck(!1)),t.props.multiple?reactive(Ve).forEach(tr=>tr.doCheck(!0)):Ve.forEach(tr=>tr.doCheck(!0)),v.value=Ve,nextTick(ue)},ue=()=>{isClient&&u.value.forEach(le=>{const de=le==null?void 0:le.$el;if(de){const Ie=de.querySelector(`.${o.namespace.value}-scrollbar__wrap`),ie=de.querySelector(`.${o.b("node")}.${o.is("active")}`)||de.querySelector(`.${o.b("node")}.in-active-path`);scrollIntoView(Ie,ie)}})},ze=le=>{const de=le.target,{code:Ie}=le;switch(Ie){case EVENT_CODE.up:case EVENT_CODE.down:{le.preventDefault();const ie=Ie===EVENT_CODE.up?-1:1;focusNode(getSibling(de,ie,`.${o.b("node")}[tabindex="-1"]`));break}case EVENT_CODE.left:{le.preventDefault();const ie=u.value[getMenuIndex(de)-1],Ve=ie==null?void 0:ie.$el.querySelector(`.${o.b("node")}[aria-expanded="true"]`);focusNode(Ve);break}case EVENT_CODE.right:{le.preventDefault();const ie=u.value[getMenuIndex(de)+1],Ve=ie==null?void 0:ie.$el.querySelector(`.${o.b("node")}[tabindex="-1"]`);focusNode(Ve);break}case EVENT_CODE.enter:checkNode(de);break}};return provide(CASCADER_PANEL_INJECTION_KEY,reactive({config:s,expandingNode:m,checkedNodes:v,isHoverMenu:g,initialLoaded:i,renderLabelFn:b,lazyLoad:k,expandNode:y,handleCheckChange:A})),watch([s,()=>t.options],T,{deep:!0,immediate:!0}),watch(()=>t.modelValue,()=>{n=!1,Ce()},{deep:!0}),watch(()=>c.value,le=>{isEqual(le,t.modelValue)||(r(UPDATE_MODEL_EVENT,le),r(CHANGE_EVENT,le))}),onBeforeUpdate(()=>u.value=[]),onMounted(()=>!isEmpty(t.modelValue)&&Ce()),{ns:o,menuList:u,menus:d,checkedNodes:v,handleKeyDown:ze,handleCheckChange:A,getFlattedNodes:he,getCheckedNodes:ae,clearCheckedNodes:Ne,calculateCheckedValue:_e,scrollToExpandingNode:ue}}});function _sfc_render$e(t,r,e,n,o,s){const a=resolveComponent("el-cascader-menu");return openBlock(),createElementBlock("div",{class:normalizeClass([t.ns.b("panel"),t.ns.is("bordered",t.border)]),onKeydown:r[0]||(r[0]=(...i)=>t.handleKeyDown&&t.handleKeyDown(...i))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.menus,(i,u)=>(openBlock(),createBlock(a,{key:u,ref_for:!0,ref:c=>t.menuList[u]=c,index:u,nodes:[...i]},null,8,["index","nodes"]))),128))],34)}var CascaderPanel=_export_sfc(_sfc_main$H,[["render",_sfc_render$e],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/index.vue"]]);CascaderPanel.install=t=>{t.component(CascaderPanel.name,CascaderPanel)};const _CascaderPanel=CascaderPanel,tagProps=buildProps({type:{type:String,values:["success","info","warning","danger",""],default:""},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:{type:String,default:""},size:{type:String,values:componentSizes,default:""},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),tagEmits={close:t=>t instanceof MouseEvent,click:t=>t instanceof MouseEvent},__default__$o=defineComponent({name:"ElTag"}),_sfc_main$G=defineComponent({...__default__$o,props:tagProps,emits:tagEmits,setup(t,{emit:r}){const e=t,n=useFormSize(),o=useNamespace("tag"),s=computed(()=>{const{type:u,hit:c,effect:d,closable:m,round:v}=e;return[o.b(),o.is("closable",m),o.m(u),o.m(n.value),o.m(d),o.is("hit",c),o.is("round",v)]}),a=u=>{r("close",u)},i=u=>{r("click",u)};return(u,c)=>u.disableTransitions?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(s)),style:normalizeStyle({backgroundColor:u.color}),onClick:i},[createBaseVNode("span",{class:normalizeClass(unref(o).e("content"))},[renderSlot(u.$slots,"default")],2),u.closable?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(o).e("close")),onClick:withModifiers(a,["stop"])},{default:withCtx(()=>[createVNode(unref(close_default))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0)],6)):(openBlock(),createBlock(Transition,{key:1,name:`${unref(o).namespace.value}-zoom-in-center`,appear:""},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(unref(s)),style:normalizeStyle({backgroundColor:u.color}),onClick:i},[createBaseVNode("span",{class:normalizeClass(unref(o).e("content"))},[renderSlot(u.$slots,"default")],2),u.closable?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(o).e("close")),onClick:withModifiers(a,["stop"])},{default:withCtx(()=>[createVNode(unref(close_default))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0)],6)]),_:3},8,["name"]))}});var Tag=_export_sfc(_sfc_main$G,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tag/src/tag.vue"]]);const ElTag=withInstall(Tag),cascaderProps=buildProps({...CommonProps,size:useSizeProp,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:definePropType(Function),default:(t,r)=>t.text.includes(r)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,maxCollapseTags:{type:Number,default:1},collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:definePropType(Function),default:()=>!0},popperClass:{type:String,default:""},teleported:useTooltipContentProps.teleported,tagType:{...tagProps.type,default:"info"},validateEvent:{type:Boolean,default:!0}}),cascaderEmits={[UPDATE_MODEL_EVENT]:t=>!!t||t===null,[CHANGE_EVENT]:t=>!!t||t===null,focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,visibleChange:t=>isBoolean$1(t),expandChange:t=>!!t,removeTag:t=>!!t},_hoisted_1$j={key:0},_hoisted_2$e=["placeholder","onKeydown"],_hoisted_3$a=["onClick"],COMPONENT_NAME$3="ElCascader",__default__$n=defineComponent({name:COMPONENT_NAME$3}),_sfc_main$F=defineComponent({...__default__$n,props:cascaderProps,emits:cascaderEmits,setup(t,{expose:r,emit:e}){const n=t,o={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:Jr})=>{const{modifiersData:Fr,placement:Wn}=Jr;["right","left","bottom","top"].includes(Wn)||(Fr.arrow.x=35)},requires:["arrow"]}]},s=useAttrs$1();let a=0,i=0;const u=useNamespace("cascader"),c=useNamespace("input"),{t:d}=useLocale(),{form:m,formItem:v}=useFormItem(),g=ref(null),b=ref(null),T=ref(null),k=ref(null),y=ref(null),A=ref(!1),V=ref(!1),he=ref(!1),ae=ref(!1),Ne=ref(""),_e=ref(""),Ce=ref([]),re=ref([]),ue=ref([]),ze=ref(!1),le=computed(()=>s.style),de=computed(()=>n.disabled||(m==null?void 0:m.disabled)),Ie=computed(()=>n.placeholder||d("el.cascader.placeholder")),ie=computed(()=>_e.value||Ce.value.length>0||ze.value?"":Ie.value),Ve=useFormSize(),Ue=computed(()=>["small"].includes(Ve.value)?"small":"default"),Dt=computed(()=>!!n.props.multiple),tr=computed(()=>!n.filterable||Dt.value),dr=computed(()=>Dt.value?_e.value:Ne.value),fr=computed(()=>{var Jr;return((Jr=k.value)==null?void 0:Jr.checkedNodes)||[]}),sr=computed(()=>!n.clearable||de.value||he.value||!V.value?!1:!!fr.value.length),hr=computed(()=>{const{showAllLevels:Jr,separator:Fr}=n,Wn=fr.value;return Wn.length?Dt.value?"":Wn[0].calcText(Jr,Fr):""}),Fe=computed({get(){return cloneDeep(n.modelValue)},set(Jr){e(UPDATE_MODEL_EVENT,Jr),e(CHANGE_EVENT,Jr),n.validateEvent&&(v==null||v.validate("change").catch(Fr=>void 0))}}),or=computed(()=>[u.b(),u.m(Ve.value),u.is("disabled",de.value),s.class]),ir=computed(()=>[c.e("icon"),"icon-arrow-down",u.is("reverse",A.value)]),$e=computed(()=>u.is("focus",A.value||ae.value)),er=computed(()=>{var Jr,Fr;return(Fr=(Jr=g.value)==null?void 0:Jr.popperRef)==null?void 0:Fr.contentRef}),nr=Jr=>{var Fr,Wn,ho;de.value||(Jr=Jr??!A.value,Jr!==A.value&&(A.value=Jr,(Wn=(Fr=b.value)==null?void 0:Fr.input)==null||Wn.setAttribute("aria-expanded",`${Jr}`),Jr?(Pt(),nextTick((ho=k.value)==null?void 0:ho.scrollToExpandingNode)):n.filterable&&Or(),e("visibleChange",Jr)))},Pt=()=>{nextTick(()=>{var Jr;(Jr=g.value)==null||Jr.updatePopper()})},rr=()=>{he.value=!1},kt=Jr=>{const{showAllLevels:Fr,separator:Wn}=n;return{node:Jr,key:Jr.uid,text:Jr.calcText(Fr,Wn),hitState:!1,closable:!de.value&&!Jr.isDisabled,isCollapseTag:!1}},Et=Jr=>{var Fr;const Wn=Jr.node;Wn.doCheck(!1),(Fr=k.value)==null||Fr.calculateCheckedValue(),e("removeTag",Wn.valueByOption)},cr=()=>{if(!Dt.value)return;const Jr=fr.value,Fr=[],Wn=[];if(Jr.forEach(ho=>Wn.push(kt(ho))),re.value=Wn,Jr.length){Jr.slice(0,n.maxCollapseTags).forEach(uo=>Fr.push(kt(uo)));const ho=Jr.slice(n.maxCollapseTags),bo=ho.length;bo&&(n.collapseTags?Fr.push({key:-1,text:`+ ${bo}`,closable:!1,isCollapseTag:!0}):ho.forEach(uo=>Fr.push(kt(uo))))}Ce.value=Fr},mr=()=>{var Jr,Fr;const{filterMethod:Wn,showAllLevels:ho,separator:bo}=n,uo=(Fr=(Jr=k.value)==null?void 0:Jr.getFlattedNodes(!n.props.checkStrictly))==null?void 0:Fr.filter(po=>po.isDisabled?!1:(po.calcText(ho,bo),Wn(po,dr.value)));Dt.value&&(Ce.value.forEach(po=>{po.hitState=!1}),re.value.forEach(po=>{po.hitState=!1})),he.value=!0,ue.value=uo,Pt()},yr=()=>{var Jr;let Fr;he.value&&y.value?Fr=y.value.$el.querySelector(`.${u.e("suggestion-item")}`):Fr=(Jr=k.value)==null?void 0:Jr.$el.querySelector(`.${u.b("node")}[tabindex="-1"]`),Fr&&(Fr.focus(),!he.value&&Fr.click())},Tr=()=>{var Jr,Fr;const Wn=(Jr=b.value)==null?void 0:Jr.input,ho=T.value,bo=(Fr=y.value)==null?void 0:Fr.$el;if(!(!isClient||!Wn)){if(bo){const uo=bo.querySelector(`.${u.e("suggestion-list")}`);uo.style.minWidth=`${Wn.offsetWidth}px`}if(ho){const{offsetHeight:uo}=ho,po=Ce.value.length>0?`${Math.max(uo+6,a)}px`:`${a}px`;Wn.style.height=po,Pt()}}},Ir=Jr=>{var Fr;return(Fr=k.value)==null?void 0:Fr.getCheckedNodes(Jr)},kr=Jr=>{Pt(),e("expandChange",Jr)},Ar=Jr=>{var Fr;const Wn=(Fr=Jr.target)==null?void 0:Fr.value;if(Jr.type==="compositionend")ze.value=!1,nextTick(()=>Yn(Wn));else{const ho=Wn[Wn.length-1]||"";ze.value=!isKorean(ho)}},Rr=Jr=>{if(!ze.value)switch(Jr.code){case EVENT_CODE.enter:nr();break;case EVENT_CODE.down:nr(!0),nextTick(yr),Jr.preventDefault();break;case EVENT_CODE.esc:A.value===!0&&(Jr.preventDefault(),Jr.stopPropagation(),nr(!1));break;case EVENT_CODE.tab:nr(!1);break}},Mn=()=>{var Jr;(Jr=k.value)==null||Jr.clearCheckedNodes(),!A.value&&n.filterable&&Or(),nr(!1)},Or=()=>{const{value:Jr}=hr;Ne.value=Jr,_e.value=Jr},Pr=Jr=>{var Fr,Wn;const{checked:ho}=Jr;Dt.value?(Fr=k.value)==null||Fr.handleCheckChange(Jr,!ho,!1):(!ho&&((Wn=k.value)==null||Wn.handleCheckChange(Jr,!0,!1)),nr(!1))},Nr=Jr=>{const Fr=Jr.target,{code:Wn}=Jr;switch(Wn){case EVENT_CODE.up:case EVENT_CODE.down:{const ho=Wn===EVENT_CODE.up?-1:1;focusNode(getSibling(Fr,ho,`.${u.e("suggestion-item")}[tabindex="-1"]`));break}case EVENT_CODE.enter:Fr.click();break}},Wr=()=>{const Jr=Ce.value,Fr=Jr[Jr.length-1];i=_e.value?0:i+1,!(!Fr||!i||n.collapseTags&&Jr.length>1)&&(Fr.hitState?Et(Fr):Fr.hitState=!0)},Yr=Jr=>{const Fr=Jr.target,Wn=u.e("search-input");Fr.className===Wn&&(ae.value=!0),e("focus",Jr)},Ur=Jr=>{ae.value=!1,e("blur",Jr)},qr=debounce(()=>{const{value:Jr}=dr;if(!Jr)return;const Fr=n.beforeFilter(Jr);isPromise(Fr)?Fr.then(mr).catch(()=>{}):Fr!==!1?mr():rr()},n.debounce),Yn=(Jr,Fr)=>{!A.value&&nr(!0),!(Fr!=null&&Fr.isComposing)&&(Jr?qr():rr())},$n=Jr=>Number.parseFloat(useCssVar(c.cssVarName("input-height"),Jr).value)-2;return watch(he,Pt),watch([fr,de],cr),watch(Ce,()=>{nextTick(()=>Tr())}),watch(Ve,async()=>{await nextTick();const Jr=b.value.input;a=$n(Jr)||a,Tr()}),watch(hr,Or,{immediate:!0}),onMounted(()=>{const Jr=b.value.input,Fr=$n(Jr);a=Jr.offsetHeight||Fr,useResizeObserver(Jr,Tr)}),r({getCheckedNodes:Ir,cascaderPanelRef:k,togglePopperVisible:nr,contentRef:er}),(Jr,Fr)=>(openBlock(),createBlock(unref(ElTooltip),{ref_key:"tooltipRef",ref:g,visible:A.value,teleported:Jr.teleported,"popper-class":[unref(u).e("dropdown"),Jr.popperClass],"popper-options":o,"fallback-placements":["bottom-start","bottom","top-start","top","right","left"],"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:"bottom-start",transition:`${unref(u).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:"",onHide:rr},{default:withCtx(()=>[withDirectives((openBlock(),createElementBlock("div",{class:normalizeClass(unref(or)),style:normalizeStyle(unref(le)),onClick:Fr[5]||(Fr[5]=()=>nr(unref(tr)?void 0:!0)),onKeydown:Rr,onMouseenter:Fr[6]||(Fr[6]=Wn=>V.value=!0),onMouseleave:Fr[7]||(Fr[7]=Wn=>V.value=!1)},[createVNode(unref(ElInput),{ref_key:"input",ref:b,modelValue:Ne.value,"onUpdate:modelValue":Fr[1]||(Fr[1]=Wn=>Ne.value=Wn),placeholder:unref(ie),readonly:unref(tr),disabled:unref(de),"validate-event":!1,size:unref(Ve),class:normalizeClass(unref($e)),tabindex:unref(Dt)&&Jr.filterable&&!unref(de)?-1:void 0,onCompositionstart:Ar,onCompositionupdate:Ar,onCompositionend:Ar,onFocus:Yr,onBlur:Ur,onInput:Yn},{suffix:withCtx(()=>[unref(sr)?(openBlock(),createBlock(unref(ElIcon),{key:"clear",class:normalizeClass([unref(c).e("icon"),"icon-circle-close"]),onClick:withModifiers(Mn,["stop"])},{default:withCtx(()=>[createVNode(unref(circle_close_default))]),_:1},8,["class","onClick"])):(openBlock(),createBlock(unref(ElIcon),{key:"arrow-down",class:normalizeClass(unref(ir)),onClick:Fr[0]||(Fr[0]=withModifiers(Wn=>nr(),["stop"]))},{default:withCtx(()=>[createVNode(unref(arrow_down_default))]),_:1},8,["class"]))]),_:1},8,["modelValue","placeholder","readonly","disabled","size","class","tabindex"]),unref(Dt)?(openBlock(),createElementBlock("div",{key:0,ref_key:"tagWrapper",ref:T,class:normalizeClass(unref(u).e("tags"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(Ce.value,Wn=>(openBlock(),createBlock(unref(ElTag),{key:Wn.key,type:Jr.tagType,size:unref(Ue),hit:Wn.hitState,closable:Wn.closable,"disable-transitions":"",onClose:ho=>Et(Wn)},{default:withCtx(()=>[Wn.isCollapseTag===!1?(openBlock(),createElementBlock("span",_hoisted_1$j,toDisplayString(Wn.text),1)):(openBlock(),createBlock(unref(ElTooltip),{key:1,disabled:A.value||!Jr.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(Wn.text),1)]),content:withCtx(()=>[createBaseVNode("div",{class:normalizeClass(unref(u).e("collapse-tags"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(re.value.slice(Jr.maxCollapseTags),(ho,bo)=>(openBlock(),createElementBlock("div",{key:bo,class:normalizeClass(unref(u).e("collapse-tag"))},[(openBlock(),createBlock(unref(ElTag),{key:ho.key,class:"in-tooltip",type:Jr.tagType,size:unref(Ue),hit:ho.hitState,closable:ho.closable,"disable-transitions":"",onClose:uo=>Et(ho)},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(ho.text),1)]),_:2},1032,["type","size","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","hit","closable","onClose"]))),128)),Jr.filterable&&!unref(de)?withDirectives((openBlock(),createElementBlock("input",{key:0,"onUpdate:modelValue":Fr[2]||(Fr[2]=Wn=>_e.value=Wn),type:"text",class:normalizeClass(unref(u).e("search-input")),placeholder:unref(hr)?"":unref(Ie),onInput:Fr[3]||(Fr[3]=Wn=>Yn(_e.value,Wn)),onClick:Fr[4]||(Fr[4]=withModifiers(Wn=>nr(!0),["stop"])),onKeydown:withKeys(Wr,["delete"]),onCompositionstart:Ar,onCompositionupdate:Ar,onCompositionend:Ar,onFocus:Yr,onBlur:Ur},null,42,_hoisted_2$e)),[[vModelText,_e.value]]):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0)],38)),[[unref(ClickOutside),()=>nr(!1),unref(er)]])]),content:withCtx(()=>[withDirectives(createVNode(unref(_CascaderPanel),{ref_key:"cascaderPanelRef",ref:k,modelValue:unref(Fe),"onUpdate:modelValue":Fr[8]||(Fr[8]=Wn=>isRef(Fe)?Fe.value=Wn:null),options:Jr.options,props:n.props,border:!1,"render-label":Jr.$slots.default,onExpandChange:kr,onClose:Fr[9]||(Fr[9]=Wn=>Jr.$nextTick(()=>nr(!1)))},null,8,["modelValue","options","props","render-label"]),[[vShow,!he.value]]),Jr.filterable?withDirectives((openBlock(),createBlock(unref(ElScrollbar),{key:0,ref_key:"suggestionPanel",ref:y,tag:"ul",class:normalizeClass(unref(u).e("suggestion-panel")),"view-class":unref(u).e("suggestion-list"),onKeydown:Nr},{default:withCtx(()=>[ue.value.length?(openBlock(!0),createElementBlock(Fragment,{key:0},renderList(ue.value,Wn=>(openBlock(),createElementBlock("li",{key:Wn.uid,class:normalizeClass([unref(u).e("suggestion-item"),unref(u).is("checked",Wn.checked)]),tabindex:-1,onClick:ho=>Pr(Wn)},[createBaseVNode("span",null,toDisplayString(Wn.text),1),Wn.checked?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[createVNode(unref(check_default))]),_:1})):createCommentVNode("v-if",!0)],10,_hoisted_3$a))),128)):renderSlot(Jr.$slots,"empty",{key:1},()=>[createBaseVNode("li",{class:normalizeClass(unref(u).e("empty-text"))},toDisplayString(unref(d)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[vShow,he.value]]):createCommentVNode("v-if",!0)]),_:3},8,["visible","teleported","popper-class","transition"]))}});var Cascader=_export_sfc(_sfc_main$F,[["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader/src/cascader.vue"]]);Cascader.install=t=>{t.component(Cascader.name,Cascader)};const _Cascader=Cascader,ElCascader=_Cascader,rowContextKey=Symbol("rowContextKey"),RowJustify=["start","center","end","space-around","space-between","space-evenly"],RowAlign=["top","middle","bottom"],rowProps=buildProps({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:RowJustify,default:"start"},align:{type:String,values:RowAlign}}),__default__$m=defineComponent({name:"ElRow"}),_sfc_main$E=defineComponent({...__default__$m,props:rowProps,setup(t){const r=t,e=useNamespace("row"),n=computed(()=>r.gutter);provide(rowContextKey,{gutter:n});const o=computed(()=>{const a={};return r.gutter&&(a.marginRight=a.marginLeft=`-${r.gutter/2}px`),a}),s=computed(()=>[e.b(),e.is(`justify-${r.justify}`,r.justify!=="start"),e.is(`align-${r.align}`,!!r.align)]);return(a,i)=>(openBlock(),createBlock(resolveDynamicComponent(a.tag),{class:normalizeClass(unref(s)),style:normalizeStyle(unref(o))},{default:withCtx(()=>[renderSlot(a.$slots,"default")]),_:3},8,["class","style"]))}});var Row=_export_sfc(_sfc_main$E,[["__file","/home/runner/work/element-plus/element-plus/packages/components/row/src/row.vue"]]);const ElRow=withInstall(Row),colProps=buildProps({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:definePropType([Number,Object]),default:()=>mutable({})},sm:{type:definePropType([Number,Object]),default:()=>mutable({})},md:{type:definePropType([Number,Object]),default:()=>mutable({})},lg:{type:definePropType([Number,Object]),default:()=>mutable({})},xl:{type:definePropType([Number,Object]),default:()=>mutable({})}}),__default__$l=defineComponent({name:"ElCol"}),_sfc_main$D=defineComponent({...__default__$l,props:colProps,setup(t){const r=t,{gutter:e}=inject(rowContextKey,{gutter:computed(()=>0)}),n=useNamespace("col"),o=computed(()=>{const a={};return e.value&&(a.paddingLeft=a.paddingRight=`${e.value/2}px`),a}),s=computed(()=>{const a=[];return["span","offset","pull","push"].forEach(c=>{const d=r[c];isNumber$1(d)&&(c==="span"?a.push(n.b(`${r[c]}`)):d>0&&a.push(n.b(`${c}-${r[c]}`)))}),["xs","sm","md","lg","xl"].forEach(c=>{isNumber$1(r[c])?a.push(n.b(`${c}-${r[c]}`)):isObject$2(r[c])&&Object.entries(r[c]).forEach(([d,m])=>{a.push(d!=="span"?n.b(`${c}-${d}-${m}`):n.b(`${c}-${m}`))})}),e.value&&a.push(n.is("guttered")),[n.b(),a]});return(a,i)=>(openBlock(),createBlock(resolveDynamicComponent(a.tag),{class:normalizeClass(unref(s)),style:normalizeStyle(unref(o))},{default:withCtx(()=>[renderSlot(a.$slots,"default")]),_:3},8,["class","style"]))}});var Col=_export_sfc(_sfc_main$D,[["__file","/home/runner/work/element-plus/element-plus/packages/components/col/src/col.vue"]]);const ElCol=withInstall(Col),emitChangeFn=t=>typeof isNumber$1(t),collapseProps=buildProps({accordion:Boolean,modelValue:{type:definePropType([Array,String,Number]),default:()=>mutable([])}}),collapseEmits={[UPDATE_MODEL_EVENT]:emitChangeFn,[CHANGE_EVENT]:emitChangeFn},collapseContextKey=Symbol("collapseContextKey"),useCollapse=(t,r)=>{const e=ref(castArray$1(t.modelValue)),n=s=>{e.value=s;const a=t.accordion?e.value[0]:e.value;r(UPDATE_MODEL_EVENT,a),r(CHANGE_EVENT,a)},o=s=>{if(t.accordion)n([e.value[0]===s?"":s]);else{const a=[...e.value],i=a.indexOf(s);i>-1?a.splice(i,1):a.push(s),n(a)}};return watch(()=>t.modelValue,()=>e.value=castArray$1(t.modelValue),{deep:!0}),provide(collapseContextKey,{activeNames:e,handleItemClick:o}),{activeNames:e,setActiveNames:n}},useCollapseDOM=()=>{const t=useNamespace("collapse");return{rootKls:computed(()=>t.b())}},__default__$k=defineComponent({name:"ElCollapse"}),_sfc_main$C=defineComponent({...__default__$k,props:collapseProps,emits:collapseEmits,setup(t,{expose:r,emit:e}){const n=t,{activeNames:o,setActiveNames:s}=useCollapse(n,e),{rootKls:a}=useCollapseDOM();return r({activeNames:o,setActiveNames:s}),(i,u)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(a)),role:"tablist","aria-multiselectable":"true"},[renderSlot(i.$slots,"default")],2))}});var Collapse=_export_sfc(_sfc_main$C,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse.vue"]]);const __default__$j=defineComponent({name:"ElCollapseTransition"}),_sfc_main$B=defineComponent({...__default__$j,setup(t){const r=useNamespace("collapse-transition"),e=o=>{o.style.maxHeight="",o.style.overflow=o.dataset.oldOverflow,o.style.paddingTop=o.dataset.oldPaddingTop,o.style.paddingBottom=o.dataset.oldPaddingBottom},n={beforeEnter(o){o.dataset||(o.dataset={}),o.dataset.oldPaddingTop=o.style.paddingTop,o.dataset.oldPaddingBottom=o.style.paddingBottom,o.style.maxHeight=0,o.style.paddingTop=0,o.style.paddingBottom=0},enter(o){o.dataset.oldOverflow=o.style.overflow,o.scrollHeight!==0?o.style.maxHeight=`${o.scrollHeight}px`:o.style.maxHeight=0,o.style.paddingTop=o.dataset.oldPaddingTop,o.style.paddingBottom=o.dataset.oldPaddingBottom,o.style.overflow="hidden"},afterEnter(o){o.style.maxHeight="",o.style.overflow=o.dataset.oldOverflow},enterCancelled(o){e(o)},beforeLeave(o){o.dataset||(o.dataset={}),o.dataset.oldPaddingTop=o.style.paddingTop,o.dataset.oldPaddingBottom=o.style.paddingBottom,o.dataset.oldOverflow=o.style.overflow,o.style.maxHeight=`${o.scrollHeight}px`,o.style.overflow="hidden"},leave(o){o.scrollHeight!==0&&(o.style.maxHeight=0,o.style.paddingTop=0,o.style.paddingBottom=0)},afterLeave(o){e(o)},leaveCancelled(o){e(o)}};return(o,s)=>(openBlock(),createBlock(Transition,mergeProps({name:unref(r).b()},toHandlers(n)),{default:withCtx(()=>[renderSlot(o.$slots,"default")]),_:3},16,["name"]))}});var CollapseTransition=_export_sfc(_sfc_main$B,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse-transition/src/collapse-transition.vue"]]);CollapseTransition.install=t=>{t.component(CollapseTransition.name,CollapseTransition)};const _CollapseTransition=CollapseTransition,collapseItemProps=buildProps({title:{type:String,default:""},name:{type:definePropType([String,Number]),default:()=>generateId()},disabled:Boolean}),useCollapseItem=t=>{const r=inject(collapseContextKey),e=ref(!1),n=ref(!1),o=ref(generateId()),s=computed(()=>r==null?void 0:r.activeNames.value.includes(t.name));return{focusing:e,id:o,isActive:s,handleFocus:()=>{setTimeout(()=>{n.value?n.value=!1:e.value=!0},50)},handleHeaderClick:()=>{t.disabled||(r==null||r.handleItemClick(t.name),e.value=!1,n.value=!0)},handleEnterClick:()=>{r==null||r.handleItemClick(t.name)}}},useCollapseItemDOM=(t,{focusing:r,isActive:e,id:n})=>{const o=useNamespace("collapse"),s=computed(()=>[o.b("item"),o.is("active",unref(e)),o.is("disabled",t.disabled)]),a=computed(()=>[o.be("item","header"),o.is("active",unref(e)),{focusing:unref(r)&&!t.disabled}]),i=computed(()=>[o.be("item","arrow"),o.is("active",unref(e))]),u=computed(()=>o.be("item","wrap")),c=computed(()=>o.be("item","content")),d=computed(()=>o.b(`content-${unref(n)}`)),m=computed(()=>o.b(`head-${unref(n)}`));return{arrowKls:i,headKls:a,rootKls:s,itemWrapperKls:u,itemContentKls:c,scopedContentId:d,scopedHeadId:m}},_hoisted_1$i=["aria-expanded","aria-controls","aria-describedby"],_hoisted_2$d=["id","tabindex"],_hoisted_3$9=["id","aria-hidden","aria-labelledby"],__default__$i=defineComponent({name:"ElCollapseItem"}),_sfc_main$A=defineComponent({...__default__$i,props:collapseItemProps,setup(t,{expose:r}){const e=t,{focusing:n,id:o,isActive:s,handleFocus:a,handleHeaderClick:i,handleEnterClick:u}=useCollapseItem(e),{arrowKls:c,headKls:d,rootKls:m,itemWrapperKls:v,itemContentKls:g,scopedContentId:b,scopedHeadId:T}=useCollapseItemDOM(e,{focusing:n,isActive:s,id:o});return r({isActive:s}),(k,y)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(m))},[createBaseVNode("div",{role:"tab","aria-expanded":unref(s),"aria-controls":unref(b),"aria-describedby":unref(b)},[createBaseVNode("div",{id:unref(T),class:normalizeClass(unref(d)),role:"button",tabindex:k.disabled?-1:0,onClick:y[0]||(y[0]=(...A)=>unref(i)&&unref(i)(...A)),onKeypress:y[1]||(y[1]=withKeys(withModifiers((...A)=>unref(u)&&unref(u)(...A),["stop","prevent"]),["space","enter"])),onFocus:y[2]||(y[2]=(...A)=>unref(a)&&unref(a)(...A)),onBlur:y[3]||(y[3]=A=>n.value=!1)},[renderSlot(k.$slots,"title",{},()=>[createTextVNode(toDisplayString(k.title),1)]),createVNode(unref(ElIcon),{class:normalizeClass(unref(c))},{default:withCtx(()=>[createVNode(unref(arrow_right_default))]),_:1},8,["class"])],42,_hoisted_2$d)],8,_hoisted_1$i),createVNode(unref(_CollapseTransition),null,{default:withCtx(()=>[withDirectives(createBaseVNode("div",{id:unref(b),class:normalizeClass(unref(v)),role:"tabpanel","aria-hidden":!unref(s),"aria-labelledby":unref(T)},[createBaseVNode("div",{class:normalizeClass(unref(g))},[renderSlot(k.$slots,"default")],2)],10,_hoisted_3$9),[[vShow,unref(s)]])]),_:3})],2))}});var CollapseItem=_export_sfc(_sfc_main$A,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse-item.vue"]]);const ElCollapse=withInstall(Collapse,{CollapseItem}),ElCollapseItem=withNoopInstall(CollapseItem),__default__$h=defineComponent({name:"ElContainer"}),_sfc_main$z=defineComponent({...__default__$h,props:{direction:{type:String}},setup(t){const r=t,e=useSlots(),n=useNamespace("container"),o=computed(()=>r.direction==="vertical"?!0:r.direction==="horizontal"?!1:e&&e.default?e.default().some(a=>{const i=a.type.name;return i==="ElHeader"||i==="ElFooter"}):!1);return(s,a)=>(openBlock(),createElementBlock("section",{class:normalizeClass([unref(n).b(),unref(n).is("vertical",unref(o))])},[renderSlot(s.$slots,"default")],2))}});var Container=_export_sfc(_sfc_main$z,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/container.vue"]]);const __default__$g=defineComponent({name:"ElAside"}),_sfc_main$y=defineComponent({...__default__$g,props:{width:{type:String,default:null}},setup(t){const r=t,e=useNamespace("aside"),n=computed(()=>r.width?e.cssVarBlock({width:r.width}):{});return(o,s)=>(openBlock(),createElementBlock("aside",{class:normalizeClass(unref(e).b()),style:normalizeStyle(unref(n))},[renderSlot(o.$slots,"default")],6))}});var Aside=_export_sfc(_sfc_main$y,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/aside.vue"]]);const __default__$f=defineComponent({name:"ElFooter"}),_sfc_main$x=defineComponent({...__default__$f,props:{height:{type:String,default:null}},setup(t){const r=t,e=useNamespace("footer"),n=computed(()=>r.height?e.cssVarBlock({height:r.height}):{});return(o,s)=>(openBlock(),createElementBlock("footer",{class:normalizeClass(unref(e).b()),style:normalizeStyle(unref(n))},[renderSlot(o.$slots,"default")],6))}});var Footer=_export_sfc(_sfc_main$x,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/footer.vue"]]);const __default__$e=defineComponent({name:"ElHeader"}),_sfc_main$w=defineComponent({...__default__$e,props:{height:{type:String,default:null}},setup(t){const r=t,e=useNamespace("header"),n=computed(()=>r.height?e.cssVarBlock({height:r.height}):{});return(o,s)=>(openBlock(),createElementBlock("header",{class:normalizeClass(unref(e).b()),style:normalizeStyle(unref(n))},[renderSlot(o.$slots,"default")],6))}});var Header=_export_sfc(_sfc_main$w,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/header.vue"]]);const __default__$d=defineComponent({name:"ElMain"}),_sfc_main$v=defineComponent({...__default__$d,setup(t){const r=useNamespace("main");return(e,n)=>(openBlock(),createElementBlock("main",{class:normalizeClass(unref(r).b())},[renderSlot(e.$slots,"default")],2))}});var Main=_export_sfc(_sfc_main$v,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/main.vue"]]);const ElContainer=withInstall(Container,{Aside,Footer,Header,Main});withNoopInstall(Aside);const ElFooter=withNoopInstall(Footer),ElHeader=withNoopInstall(Header),ElMain=withNoopInstall(Main),overlayProps=buildProps({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:definePropType([String,Array,Object])},zIndex:{type:definePropType([String,Number])}}),overlayEmits={click:t=>t instanceof MouseEvent},BLOCK="overlay";var Overlay=defineComponent({name:"ElOverlay",props:overlayProps,emits:overlayEmits,setup(t,{slots:r,emit:e}){const n=useNamespace(BLOCK),o=u=>{e("click",u)},{onClick:s,onMousedown:a,onMouseup:i}=useSameTarget(t.customMaskEvent?void 0:o);return()=>t.mask?createVNode("div",{class:[n.b(),t.overlayClass],style:{zIndex:t.zIndex},onClick:s,onMousedown:a,onMouseup:i},[renderSlot(r,"default")],PatchFlags.STYLE|PatchFlags.CLASS|PatchFlags.PROPS,["onClick","onMouseup","onMousedown"]):h("div",{class:t.overlayClass,style:{zIndex:t.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[renderSlot(r,"default")])}});const ElOverlay=Overlay,dialogInjectionKey=Symbol("dialogInjectionKey"),dialogContentProps=buildProps({center:Boolean,alignCenter:Boolean,closeIcon:{type:iconPropType},customClass:{type:String,default:""},draggable:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),dialogContentEmits={close:()=>!0},_hoisted_1$h=["aria-level"],_hoisted_2$c=["aria-label"],_hoisted_3$8=["id"],__default__$c=defineComponent({name:"ElDialogContent"}),_sfc_main$u=defineComponent({...__default__$c,props:dialogContentProps,emits:dialogContentEmits,setup(t){const r=t,{t:e}=useLocale(),{Close:n}=CloseComponents,{dialogRef:o,headerRef:s,bodyId:a,ns:i,style:u}=inject(dialogInjectionKey),{focusTrapRef:c}=inject(FOCUS_TRAP_INJECTION_KEY),d=computed(()=>[i.b(),i.is("fullscreen",r.fullscreen),i.is("draggable",r.draggable),i.is("align-center",r.alignCenter),{[i.m("center")]:r.center},r.customClass]),m=composeRefs(c,o),v=computed(()=>r.draggable);return useDraggable(o,s,v),(g,b)=>(openBlock(),createElementBlock("div",{ref:unref(m),class:normalizeClass(unref(d)),style:normalizeStyle(unref(u)),tabindex:"-1"},[createBaseVNode("header",{ref_key:"headerRef",ref:s,class:normalizeClass(unref(i).e("header"))},[renderSlot(g.$slots,"header",{},()=>[createBaseVNode("span",{role:"heading","aria-level":g.ariaLevel,class:normalizeClass(unref(i).e("title"))},toDisplayString(g.title),11,_hoisted_1$h)]),g.showClose?(openBlock(),createElementBlock("button",{key:0,"aria-label":unref(e)("el.dialog.close"),class:normalizeClass(unref(i).e("headerbtn")),type:"button",onClick:b[0]||(b[0]=T=>g.$emit("close"))},[createVNode(unref(ElIcon),{class:normalizeClass(unref(i).e("close"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(g.closeIcon||unref(n))))]),_:1},8,["class"])],10,_hoisted_2$c)):createCommentVNode("v-if",!0)],2),createBaseVNode("div",{id:unref(a),class:normalizeClass(unref(i).e("body"))},[renderSlot(g.$slots,"default")],10,_hoisted_3$8),g.$slots.footer?(openBlock(),createElementBlock("footer",{key:0,class:normalizeClass(unref(i).e("footer"))},[renderSlot(g.$slots,"footer")],2)):createCommentVNode("v-if",!0)],6))}});var ElDialogContent=_export_sfc(_sfc_main$u,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog-content.vue"]]);const dialogProps=buildProps({...dialogContentProps,appendToBody:Boolean,beforeClose:{type:definePropType(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1},headerAriaLevel:{type:String,default:"2"}}),dialogEmits={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[UPDATE_MODEL_EVENT]:t=>isBoolean$1(t),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},useDialog=(t,r)=>{const n=getCurrentInstance().emit,{nextZIndex:o}=useZIndex();let s="";const a=useId(),i=useId(),u=ref(!1),c=ref(!1),d=ref(!1),m=ref(t.zIndex||o());let v,g;const b=useGlobalConfig("namespace",defaultNamespace),T=computed(()=>{const Ie={},ie=`--${b.value}-dialog`;return t.fullscreen||(t.top&&(Ie[`${ie}-margin-top`]=t.top),t.width&&(Ie[`${ie}-width`]=addUnit(t.width))),Ie}),k=computed(()=>t.alignCenter?{display:"flex"}:{});function y(){n("opened")}function A(){n("closed"),n(UPDATE_MODEL_EVENT,!1),t.destroyOnClose&&(d.value=!1)}function V(){n("close")}function he(){g==null||g(),v==null||v(),t.openDelay&&t.openDelay>0?{stop:v}=useTimeoutFn(()=>Ce(),t.openDelay):Ce()}function ae(){v==null||v(),g==null||g(),t.closeDelay&&t.closeDelay>0?{stop:g}=useTimeoutFn(()=>re(),t.closeDelay):re()}function Ne(){function Ie(ie){ie||(c.value=!0,u.value=!1)}t.beforeClose?t.beforeClose(Ie):ae()}function _e(){t.closeOnClickModal&&Ne()}function Ce(){isClient&&(u.value=!0)}function re(){u.value=!1}function ue(){n("openAutoFocus")}function ze(){n("closeAutoFocus")}function le(Ie){var ie;((ie=Ie.detail)==null?void 0:ie.focusReason)==="pointer"&&Ie.preventDefault()}t.lockScroll&&useLockscreen(u);function de(){t.closeOnPressEscape&&Ne()}return watch(()=>t.modelValue,Ie=>{Ie?(c.value=!1,he(),d.value=!0,m.value=t.zIndex?m.value++:o(),nextTick(()=>{n("open"),r.value&&(r.value.scrollTop=0)})):u.value&&ae()}),watch(()=>t.fullscreen,Ie=>{r.value&&(Ie?(s=r.value.style.transform,r.value.style.transform=""):r.value.style.transform=s)}),onMounted(()=>{t.modelValue&&(u.value=!0,d.value=!0,he())}),{afterEnter:y,afterLeave:A,beforeLeave:V,handleClose:Ne,onModalClick:_e,close:ae,doClose:re,onOpenAutoFocus:ue,onCloseAutoFocus:ze,onCloseRequested:de,onFocusoutPrevented:le,titleId:a,bodyId:i,closed:c,style:T,overlayDialogStyle:k,rendered:d,visible:u,zIndex:m}},_hoisted_1$g=["aria-label","aria-labelledby","aria-describedby"],__default__$b=defineComponent({name:"ElDialog",inheritAttrs:!1}),_sfc_main$t=defineComponent({...__default__$b,props:dialogProps,emits:dialogEmits,setup(t,{expose:r}){const e=t,n=useSlots();useDeprecated({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},computed(()=>!!n.title)),useDeprecated({scope:"el-dialog",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/dialog.html#attributes",type:"Attribute"},computed(()=>!!e.customClass));const o=useNamespace("dialog"),s=ref(),a=ref(),i=ref(),{visible:u,titleId:c,bodyId:d,style:m,overlayDialogStyle:v,rendered:g,zIndex:b,afterEnter:T,afterLeave:k,beforeLeave:y,handleClose:A,onModalClick:V,onOpenAutoFocus:he,onCloseAutoFocus:ae,onCloseRequested:Ne,onFocusoutPrevented:_e}=useDialog(e,s);provide(dialogInjectionKey,{dialogRef:s,headerRef:a,bodyId:d,ns:o,rendered:g,style:m});const Ce=useSameTarget(V),re=computed(()=>e.draggable&&!e.fullscreen);return r({visible:u,dialogContentRef:i}),(ue,ze)=>(openBlock(),createBlock(Teleport,{to:"body",disabled:!ue.appendToBody},[createVNode(Transition,{name:"dialog-fade",onAfterEnter:unref(T),onAfterLeave:unref(k),onBeforeLeave:unref(y),persisted:""},{default:withCtx(()=>[withDirectives(createVNode(unref(ElOverlay),{"custom-mask-event":"",mask:ue.modal,"overlay-class":ue.modalClass,"z-index":unref(b)},{default:withCtx(()=>[createBaseVNode("div",{role:"dialog","aria-modal":"true","aria-label":ue.title||void 0,"aria-labelledby":ue.title?void 0:unref(c),"aria-describedby":unref(d),class:normalizeClass(`${unref(o).namespace.value}-overlay-dialog`),style:normalizeStyle(unref(v)),onClick:ze[0]||(ze[0]=(...le)=>unref(Ce).onClick&&unref(Ce).onClick(...le)),onMousedown:ze[1]||(ze[1]=(...le)=>unref(Ce).onMousedown&&unref(Ce).onMousedown(...le)),onMouseup:ze[2]||(ze[2]=(...le)=>unref(Ce).onMouseup&&unref(Ce).onMouseup(...le))},[createVNode(unref(ElFocusTrap),{loop:"",trapped:unref(u),"focus-start-el":"container",onFocusAfterTrapped:unref(he),onFocusAfterReleased:unref(ae),onFocusoutPrevented:unref(_e),onReleaseRequested:unref(Ne)},{default:withCtx(()=>[unref(g)?(openBlock(),createBlock(ElDialogContent,mergeProps({key:0,ref_key:"dialogContentRef",ref:i},ue.$attrs,{"custom-class":ue.customClass,center:ue.center,"align-center":ue.alignCenter,"close-icon":ue.closeIcon,draggable:unref(re),fullscreen:ue.fullscreen,"show-close":ue.showClose,title:ue.title,"aria-level":ue.headerAriaLevel,onClose:unref(A)}),createSlots({header:withCtx(()=>[ue.$slots.title?renderSlot(ue.$slots,"title",{key:1}):renderSlot(ue.$slots,"header",{key:0,close:unref(A),titleId:unref(c),titleClass:unref(o).e("title")})]),default:withCtx(()=>[renderSlot(ue.$slots,"default")]),_:2},[ue.$slots.footer?{name:"footer",fn:withCtx(()=>[renderSlot(ue.$slots,"footer")])}:void 0]),1040,["custom-class","center","align-center","close-icon","draggable","fullscreen","show-close","title","aria-level","onClose"])):createCommentVNode("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,_hoisted_1$g)]),_:3},8,["mask","overlay-class","z-index"]),[[vShow,unref(u)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"]))}});var Dialog=_export_sfc(_sfc_main$t,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog.vue"]]);const ElDialog=withInstall(Dialog),_sfc_main$s=defineComponent({inheritAttrs:!1});function _sfc_render$d(t,r,e,n,o,s){return renderSlot(t.$slots,"default")}var Collection=_export_sfc(_sfc_main$s,[["render",_sfc_render$d],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection.vue"]]);const _sfc_main$r=defineComponent({name:"ElCollectionItem",inheritAttrs:!1});function _sfc_render$c(t,r,e,n,o,s){return renderSlot(t.$slots,"default")}var CollectionItem=_export_sfc(_sfc_main$r,[["render",_sfc_render$c],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection-item.vue"]]);const COLLECTION_ITEM_SIGN="data-el-collection-item",createCollectionWithScope=t=>{const r=`El${t}Collection`,e=`${r}Item`,n=Symbol(r),o=Symbol(e),s={...Collection,name:r,setup(){const i=ref(null),u=new Map;provide(n,{itemMap:u,getItems:()=>{const d=unref(i);if(!d)return[];const m=Array.from(d.querySelectorAll(`[${COLLECTION_ITEM_SIGN}]`));return[...u.values()].sort((g,b)=>m.indexOf(g.ref)-m.indexOf(b.ref))},collectionRef:i})}},a={...CollectionItem,name:e,setup(i,{attrs:u}){const c=ref(null),d=inject(n,void 0);provide(o,{collectionItemRef:c}),onMounted(()=>{const m=unref(c);m&&d.itemMap.set(m,{ref:m,...u})}),onBeforeUnmount(()=>{const m=unref(c);d.itemMap.delete(m)})}};return{COLLECTION_INJECTION_KEY:n,COLLECTION_ITEM_INJECTION_KEY:o,ElCollection:s,ElCollectionItem:a}},rovingFocusGroupProps=buildProps({style:{type:definePropType([String,Array,Object])},currentTabId:{type:definePropType(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:definePropType(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:ElCollection$1,ElCollectionItem:ElCollectionItem$1,COLLECTION_INJECTION_KEY:COLLECTION_INJECTION_KEY$1,COLLECTION_ITEM_INJECTION_KEY:COLLECTION_ITEM_INJECTION_KEY$1}=createCollectionWithScope("RovingFocusGroup"),ROVING_FOCUS_GROUP_INJECTION_KEY=Symbol("elRovingFocusGroup"),ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY=Symbol("elRovingFocusGroupItem"),MAP_KEY_TO_FOCUS_INTENT={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},getDirectionAwareKey=(t,r)=>{if(r!=="rtl")return t;switch(t){case EVENT_CODE.right:return EVENT_CODE.left;case EVENT_CODE.left:return EVENT_CODE.right;default:return t}},getFocusIntent=(t,r,e)=>{const n=getDirectionAwareKey(t.key,e);if(!(r==="vertical"&&[EVENT_CODE.left,EVENT_CODE.right].includes(n))&&!(r==="horizontal"&&[EVENT_CODE.up,EVENT_CODE.down].includes(n)))return MAP_KEY_TO_FOCUS_INTENT[n]},reorderArray=(t,r)=>t.map((e,n)=>t[(n+r)%t.length]),focusFirst=t=>{const{activeElement:r}=document;for(const e of t)if(e===r||(e.focus(),r!==document.activeElement))return},CURRENT_TAB_ID_CHANGE_EVT="currentTabIdChange",ENTRY_FOCUS_EVT="rovingFocusGroup.entryFocus",EVT_OPTS={bubbles:!1,cancelable:!0},_sfc_main$q=defineComponent({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:rovingFocusGroupProps,emits:[CURRENT_TAB_ID_CHANGE_EVT,"entryFocus"],setup(t,{emit:r}){var e;const n=ref((e=t.currentTabId||t.defaultCurrentTabId)!=null?e:null),o=ref(!1),s=ref(!1),a=ref(null),{getItems:i}=inject(COLLECTION_INJECTION_KEY$1,void 0),u=computed(()=>[{outline:"none"},t.style]),c=T=>{r(CURRENT_TAB_ID_CHANGE_EVT,T)},d=()=>{o.value=!0},m=composeEventHandlers(T=>{var k;(k=t.onMousedown)==null||k.call(t,T)},()=>{s.value=!0}),v=composeEventHandlers(T=>{var k;(k=t.onFocus)==null||k.call(t,T)},T=>{const k=!unref(s),{target:y,currentTarget:A}=T;if(y===A&&k&&!unref(o)){const V=new Event(ENTRY_FOCUS_EVT,EVT_OPTS);if(A==null||A.dispatchEvent(V),!V.defaultPrevented){const he=i().filter(re=>re.focusable),ae=he.find(re=>re.active),Ne=he.find(re=>re.id===unref(n)),Ce=[ae,Ne,...he].filter(Boolean).map(re=>re.ref);focusFirst(Ce)}}s.value=!1}),g=composeEventHandlers(T=>{var k;(k=t.onBlur)==null||k.call(t,T)},()=>{o.value=!1}),b=(...T)=>{r("entryFocus",...T)};provide(ROVING_FOCUS_GROUP_INJECTION_KEY,{currentTabbedId:readonly(n),loop:toRef(t,"loop"),tabIndex:computed(()=>unref(o)?-1:0),rovingFocusGroupRef:a,rovingFocusGroupRootStyle:u,orientation:toRef(t,"orientation"),dir:toRef(t,"dir"),onItemFocus:c,onItemShiftTab:d,onBlur:g,onFocus:v,onMousedown:m}),watch(()=>t.currentTabId,T=>{n.value=T??null}),useEventListener(a,ENTRY_FOCUS_EVT,b)}});function _sfc_render$b(t,r,e,n,o,s){return renderSlot(t.$slots,"default")}var ElRovingFocusGroupImpl=_export_sfc(_sfc_main$q,[["render",_sfc_render$b],["__file","/home/runner/work/element-plus/element-plus/packages/components/roving-focus-group/src/roving-focus-group-impl.vue"]]);const _sfc_main$p=defineComponent({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:ElCollection$1,ElRovingFocusGroupImpl}});function _sfc_render$a(t,r,e,n,o,s){const a=resolveComponent("el-roving-focus-group-impl"),i=resolveComponent("el-focus-group-collection");return openBlock(),createBlock(i,null,{default:withCtx(()=>[createVNode(a,normalizeProps(guardReactiveProps(t.$attrs)),{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},16)]),_:3})}var ElRovingFocusGroup=_export_sfc(_sfc_main$p,[["render",_sfc_render$a],["__file","/home/runner/work/element-plus/element-plus/packages/components/roving-focus-group/src/roving-focus-group.vue"]]);const _sfc_main$o=defineComponent({components:{ElRovingFocusCollectionItem:ElCollectionItem$1},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(t,{emit:r}){const{currentTabbedId:e,loop:n,onItemFocus:o,onItemShiftTab:s}=inject(ROVING_FOCUS_GROUP_INJECTION_KEY,void 0),{getItems:a}=inject(COLLECTION_INJECTION_KEY$1,void 0),i=useId(),u=ref(null),c=composeEventHandlers(g=>{r("mousedown",g)},g=>{t.focusable?o(unref(i)):g.preventDefault()}),d=composeEventHandlers(g=>{r("focus",g)},()=>{o(unref(i))}),m=composeEventHandlers(g=>{r("keydown",g)},g=>{const{key:b,shiftKey:T,target:k,currentTarget:y}=g;if(b===EVENT_CODE.tab&&T){s();return}if(k!==y)return;const A=getFocusIntent(g);if(A){g.preventDefault();let he=a().filter(ae=>ae.focusable).map(ae=>ae.ref);switch(A){case"last":{he.reverse();break}case"prev":case"next":{A==="prev"&&he.reverse();const ae=he.indexOf(y);he=n.value?reorderArray(he,ae+1):he.slice(ae+1);break}}nextTick(()=>{focusFirst(he)})}}),v=computed(()=>e.value===unref(i));return provide(ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY,{rovingFocusGroupItemRef:u,tabIndex:computed(()=>unref(v)?0:-1),handleMousedown:c,handleFocus:d,handleKeydown:m}),{id:i,handleKeydown:m,handleFocus:d,handleMousedown:c}}});function _sfc_render$9(t,r,e,n,o,s){const a=resolveComponent("el-roving-focus-collection-item");return openBlock(),createBlock(a,{id:t.id,focusable:t.focusable,active:t.active},{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},8,["id","focusable","active"])}var ElRovingFocusItem=_export_sfc(_sfc_main$o,[["render",_sfc_render$9],["__file","/home/runner/work/element-plus/element-plus/packages/components/roving-focus-group/src/roving-focus-item.vue"]]);const dropdownProps=buildProps({trigger:useTooltipTriggerProps.trigger,effect:{...useTooltipContentProps.effect,default:"light"},type:{type:definePropType(String)},placement:{type:definePropType(String),default:"bottom"},popperOptions:{type:definePropType(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:definePropType([Number,String]),default:0},maxHeight:{type:definePropType([Number,String]),default:""},popperClass:{type:String,default:""},disabled:{type:Boolean,default:!1},role:{type:String,default:"menu"},buttonProps:{type:definePropType(Object)},teleported:useTooltipContentProps.teleported}),dropdownItemProps=buildProps({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:iconPropType}}),dropdownMenuProps=buildProps({onKeydown:{type:definePropType(Function)}}),FIRST_KEYS=[EVENT_CODE.down,EVENT_CODE.pageDown,EVENT_CODE.home],LAST_KEYS=[EVENT_CODE.up,EVENT_CODE.pageUp,EVENT_CODE.end],FIRST_LAST_KEYS=[...FIRST_KEYS,...LAST_KEYS],{ElCollection,ElCollectionItem,COLLECTION_INJECTION_KEY,COLLECTION_ITEM_INJECTION_KEY}=createCollectionWithScope("Dropdown"),DROPDOWN_INJECTION_KEY=Symbol("elDropdown"),{ButtonGroup:ElButtonGroup}=ElButton,_sfc_main$n=defineComponent({name:"ElDropdown",components:{ElButton,ElButtonGroup,ElScrollbar,ElDropdownCollection:ElCollection,ElTooltip,ElRovingFocusGroup,ElOnlyChild:OnlyChild,ElIcon,ArrowDown:arrow_down_default},props:dropdownProps,emits:["visible-change","click","command"],setup(t,{emit:r}){const e=getCurrentInstance(),n=useNamespace("dropdown"),{t:o}=useLocale(),s=ref(),a=ref(),i=ref(null),u=ref(null),c=ref(null),d=ref(null),m=ref(!1),v=[EVENT_CODE.enter,EVENT_CODE.space,EVENT_CODE.down],g=computed(()=>({maxHeight:addUnit(t.maxHeight)})),b=computed(()=>[n.m(ae.value)]),T=computed(()=>castArray$1(t.trigger)),k=useId().value,y=computed(()=>t.id||k);watch([s,T],([Ue,Dt],[tr])=>{var dr,fr,sr;(dr=tr==null?void 0:tr.$el)!=null&&dr.removeEventListener&&tr.$el.removeEventListener("pointerenter",_e),(fr=Ue==null?void 0:Ue.$el)!=null&&fr.removeEventListener&&Ue.$el.removeEventListener("pointerenter",_e),(sr=Ue==null?void 0:Ue.$el)!=null&&sr.addEventListener&&Dt.includes("hover")&&Ue.$el.addEventListener("pointerenter",_e)},{immediate:!0}),onBeforeUnmount(()=>{var Ue,Dt;(Dt=(Ue=s.value)==null?void 0:Ue.$el)!=null&&Dt.removeEventListener&&s.value.$el.removeEventListener("pointerenter",_e)});function A(){V()}function V(){var Ue;(Ue=i.value)==null||Ue.onClose()}function he(){var Ue;(Ue=i.value)==null||Ue.onOpen()}const ae=useFormSize();function Ne(...Ue){r("command",...Ue)}function _e(){var Ue,Dt;(Dt=(Ue=s.value)==null?void 0:Ue.$el)==null||Dt.focus()}function Ce(){}function re(){const Ue=unref(u);T.value.includes("hover")&&(Ue==null||Ue.focus()),d.value=null}function ue(Ue){d.value=Ue}function ze(Ue){m.value||(Ue.preventDefault(),Ue.stopImmediatePropagation())}function le(){r("visible-change",!0)}function de(Ue){(Ue==null?void 0:Ue.type)==="keydown"&&u.value.focus()}function Ie(){r("visible-change",!1)}return provide(DROPDOWN_INJECTION_KEY,{contentRef:u,role:computed(()=>t.role),triggerId:y,isUsingKeyboard:m,onItemEnter:Ce,onItemLeave:re}),provide("elDropdown",{instance:e,dropdownSize:ae,handleClick:A,commandHandler:Ne,trigger:toRef(t,"trigger"),hideOnClick:toRef(t,"hideOnClick")}),{t:o,ns:n,scrollbar:c,wrapStyle:g,dropdownTriggerKls:b,dropdownSize:ae,triggerId:y,triggerKeys:v,currentTabId:d,handleCurrentTabIdChange:ue,handlerMainButtonClick:Ue=>{r("click",Ue)},handleEntryFocus:ze,handleClose:V,handleOpen:he,handleBeforeShowTooltip:le,handleShowTooltip:de,handleBeforeHideTooltip:Ie,onFocusAfterTrapped:Ue=>{var Dt,tr;Ue.preventDefault(),(tr=(Dt=u.value)==null?void 0:Dt.focus)==null||tr.call(Dt,{preventScroll:!0})},popperRef:i,contentRef:u,triggeringElementRef:s,referenceElementRef:a}}});function _sfc_render$8(t,r,e,n,o,s){var a;const i=resolveComponent("el-dropdown-collection"),u=resolveComponent("el-roving-focus-group"),c=resolveComponent("el-scrollbar"),d=resolveComponent("el-only-child"),m=resolveComponent("el-tooltip"),v=resolveComponent("el-button"),g=resolveComponent("arrow-down"),b=resolveComponent("el-icon"),T=resolveComponent("el-button-group");return openBlock(),createElementBlock("div",{class:normalizeClass([t.ns.b(),t.ns.is("disabled",t.disabled)])},[createVNode(m,{ref:"popperRef",role:t.role,effect:t.effect,"fallback-placements":["bottom","top"],"popper-options":t.popperOptions,"gpu-acceleration":!1,"hide-after":t.trigger==="hover"?t.hideTimeout:0,"manual-mode":!0,placement:t.placement,"popper-class":[t.ns.e("popper"),t.popperClass],"reference-element":(a=t.referenceElementRef)==null?void 0:a.$el,trigger:t.trigger,"trigger-keys":t.triggerKeys,"trigger-target-el":t.contentRef,"show-after":t.trigger==="hover"?t.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":t.triggeringElementRef,"virtual-triggering":t.splitButton,disabled:t.disabled,transition:`${t.ns.namespace.value}-zoom-in-top`,teleported:t.teleported,pure:"",persistent:"",onBeforeShow:t.handleBeforeShowTooltip,onShow:t.handleShowTooltip,onBeforeHide:t.handleBeforeHideTooltip},createSlots({content:withCtx(()=>[createVNode(c,{ref:"scrollbar","wrap-style":t.wrapStyle,tag:"div","view-class":t.ns.e("list")},{default:withCtx(()=>[createVNode(u,{loop:t.loop,"current-tab-id":t.currentTabId,orientation:"horizontal",onCurrentTabIdChange:t.handleCurrentTabIdChange,onEntryFocus:t.handleEntryFocus},{default:withCtx(()=>[createVNode(i,null,{default:withCtx(()=>[renderSlot(t.$slots,"dropdown")]),_:3})]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])]),_:3},8,["wrap-style","view-class"])]),_:2},[t.splitButton?void 0:{name:"default",fn:withCtx(()=>[createVNode(d,{id:t.triggerId,ref:"triggeringElementRef",role:"button",tabindex:t.tabindex},{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","onBeforeShow","onShow","onBeforeHide"]),t.splitButton?(openBlock(),createBlock(T,{key:0},{default:withCtx(()=>[createVNode(v,mergeProps({ref:"referenceElementRef"},t.buttonProps,{size:t.dropdownSize,type:t.type,disabled:t.disabled,tabindex:t.tabindex,onClick:t.handlerMainButtonClick}),{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),createVNode(v,mergeProps({id:t.triggerId,ref:"triggeringElementRef"},t.buttonProps,{role:"button",size:t.dropdownSize,type:t.type,class:t.ns.e("caret-button"),disabled:t.disabled,tabindex:t.tabindex,"aria-label":t.t("el.dropdown.toggleDropdown")}),{default:withCtx(()=>[createVNode(b,{class:normalizeClass(t.ns.e("icon"))},{default:withCtx(()=>[createVNode(g)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):createCommentVNode("v-if",!0)],2)}var Dropdown=_export_sfc(_sfc_main$n,[["render",_sfc_render$8],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown.vue"]]);const _sfc_main$m=defineComponent({name:"DropdownItemImpl",components:{ElIcon},props:dropdownItemProps,emits:["pointermove","pointerleave","click","clickimpl"],setup(t,{emit:r}){const e=useNamespace("dropdown"),{role:n}=inject(DROPDOWN_INJECTION_KEY,void 0),{collectionItemRef:o}=inject(COLLECTION_ITEM_INJECTION_KEY,void 0),{collectionItemRef:s}=inject(COLLECTION_ITEM_INJECTION_KEY$1,void 0),{rovingFocusGroupItemRef:a,tabIndex:i,handleFocus:u,handleKeydown:c,handleMousedown:d}=inject(ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY,void 0),m=composeRefs(o,s,a),v=computed(()=>n.value==="menu"?"menuitem":n.value==="navigation"?"link":"button"),g=composeEventHandlers(b=>{const{code:T}=b;if(T===EVENT_CODE.enter||T===EVENT_CODE.space)return b.preventDefault(),b.stopImmediatePropagation(),r("clickimpl",b),!0},c);return{ns:e,itemRef:m,dataset:{[COLLECTION_ITEM_SIGN]:""},role:v,tabIndex:i,handleFocus:u,handleKeydown:g,handleMousedown:d}}}),_hoisted_1$f=["aria-disabled","tabindex","role"];function _sfc_render$7(t,r,e,n,o,s){const a=resolveComponent("el-icon");return openBlock(),createElementBlock(Fragment,null,[t.divided?(openBlock(),createElementBlock("li",mergeProps({key:0,role:"separator",class:t.ns.bem("menu","item","divided")},t.$attrs),null,16)):createCommentVNode("v-if",!0),createBaseVNode("li",mergeProps({ref:t.itemRef},{...t.dataset,...t.$attrs},{"aria-disabled":t.disabled,class:[t.ns.be("menu","item"),t.ns.is("disabled",t.disabled)],tabindex:t.tabIndex,role:t.role,onClick:r[0]||(r[0]=i=>t.$emit("clickimpl",i)),onFocus:r[1]||(r[1]=(...i)=>t.handleFocus&&t.handleFocus(...i)),onKeydown:r[2]||(r[2]=withModifiers((...i)=>t.handleKeydown&&t.handleKeydown(...i),["self"])),onMousedown:r[3]||(r[3]=(...i)=>t.handleMousedown&&t.handleMousedown(...i)),onPointermove:r[4]||(r[4]=i=>t.$emit("pointermove",i)),onPointerleave:r[5]||(r[5]=i=>t.$emit("pointerleave",i))}),[t.icon?(openBlock(),createBlock(a,{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.icon)))]),_:1})):createCommentVNode("v-if",!0),renderSlot(t.$slots,"default")],16,_hoisted_1$f)],64)}var ElDropdownItemImpl=_export_sfc(_sfc_main$m,[["render",_sfc_render$7],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown-item-impl.vue"]]);const useDropdown=()=>{const t=inject("elDropdown",{}),r=computed(()=>t==null?void 0:t.dropdownSize);return{elDropdown:t,_elDropdownSize:r}},_sfc_main$l=defineComponent({name:"ElDropdownItem",components:{ElDropdownCollectionItem:ElCollectionItem,ElRovingFocusItem,ElDropdownItemImpl},inheritAttrs:!1,props:dropdownItemProps,emits:["pointermove","pointerleave","click"],setup(t,{emit:r,attrs:e}){const{elDropdown:n}=useDropdown(),o=getCurrentInstance(),s=ref(null),a=computed(()=>{var g,b;return(b=(g=unref(s))==null?void 0:g.textContent)!=null?b:""}),{onItemEnter:i,onItemLeave:u}=inject(DROPDOWN_INJECTION_KEY,void 0),c=composeEventHandlers(g=>(r("pointermove",g),g.defaultPrevented),whenMouse(g=>{if(t.disabled){u(g);return}const b=g.currentTarget;b===document.activeElement||b.contains(document.activeElement)||(i(g),g.defaultPrevented||b==null||b.focus())})),d=composeEventHandlers(g=>(r("pointerleave",g),g.defaultPrevented),whenMouse(g=>{u(g)})),m=composeEventHandlers(g=>{if(!t.disabled)return r("click",g),g.type!=="keydown"&&g.defaultPrevented},g=>{var b,T,k;if(t.disabled){g.stopImmediatePropagation();return}(b=n==null?void 0:n.hideOnClick)!=null&&b.value&&((T=n.handleClick)==null||T.call(n)),(k=n.commandHandler)==null||k.call(n,t.command,o,g)}),v=computed(()=>({...t,...e}));return{handleClick:m,handlePointerMove:c,handlePointerLeave:d,textContent:a,propsAndAttrs:v}}});function _sfc_render$6(t,r,e,n,o,s){var a;const i=resolveComponent("el-dropdown-item-impl"),u=resolveComponent("el-roving-focus-item"),c=resolveComponent("el-dropdown-collection-item");return openBlock(),createBlock(c,{disabled:t.disabled,"text-value":(a=t.textValue)!=null?a:t.textContent},{default:withCtx(()=>[createVNode(u,{focusable:!t.disabled},{default:withCtx(()=>[createVNode(i,mergeProps(t.propsAndAttrs,{onPointerleave:t.handlePointerLeave,onPointermove:t.handlePointerMove,onClickimpl:t.handleClick}),{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},16,["onPointerleave","onPointermove","onClickimpl"])]),_:3},8,["focusable"])]),_:3},8,["disabled","text-value"])}var DropdownItem=_export_sfc(_sfc_main$l,[["render",_sfc_render$6],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown-item.vue"]]);const _sfc_main$k=defineComponent({name:"ElDropdownMenu",props:dropdownMenuProps,setup(t){const r=useNamespace("dropdown"),{_elDropdownSize:e}=useDropdown(),n=e.value,{focusTrapRef:o,onKeydown:s}=inject(FOCUS_TRAP_INJECTION_KEY,void 0),{contentRef:a,role:i,triggerId:u}=inject(DROPDOWN_INJECTION_KEY,void 0),{collectionRef:c,getItems:d}=inject(COLLECTION_INJECTION_KEY,void 0),{rovingFocusGroupRef:m,rovingFocusGroupRootStyle:v,tabIndex:g,onBlur:b,onFocus:T,onMousedown:k}=inject(ROVING_FOCUS_GROUP_INJECTION_KEY,void 0),{collectionRef:y}=inject(COLLECTION_INJECTION_KEY$1,void 0),A=computed(()=>[r.b("menu"),r.bm("menu",n==null?void 0:n.value)]),V=composeRefs(a,c,o,m,y),he=composeEventHandlers(Ne=>{var _e;(_e=t.onKeydown)==null||_e.call(t,Ne)},Ne=>{const{currentTarget:_e,code:Ce,target:re}=Ne;if(_e.contains(re),EVENT_CODE.tab===Ce&&Ne.stopImmediatePropagation(),Ne.preventDefault(),re!==unref(a)||!FIRST_LAST_KEYS.includes(Ce))return;const ze=d().filter(le=>!le.disabled).map(le=>le.ref);LAST_KEYS.includes(Ce)&&ze.reverse(),focusFirst(ze)});return{size:n,rovingFocusGroupRootStyle:v,tabIndex:g,dropdownKls:A,role:i,triggerId:u,dropdownListWrapperRef:V,handleKeydown:Ne=>{he(Ne),s(Ne)},onBlur:b,onFocus:T,onMousedown:k}}}),_hoisted_1$e=["role","aria-labelledby"];function _sfc_render$5(t,r,e,n,o,s){return openBlock(),createElementBlock("ul",{ref:t.dropdownListWrapperRef,class:normalizeClass(t.dropdownKls),style:normalizeStyle(t.rovingFocusGroupRootStyle),tabindex:-1,role:t.role,"aria-labelledby":t.triggerId,onBlur:r[0]||(r[0]=(...a)=>t.onBlur&&t.onBlur(...a)),onFocus:r[1]||(r[1]=(...a)=>t.onFocus&&t.onFocus(...a)),onKeydown:r[2]||(r[2]=withModifiers((...a)=>t.handleKeydown&&t.handleKeydown(...a),["self"])),onMousedown:r[3]||(r[3]=withModifiers((...a)=>t.onMousedown&&t.onMousedown(...a),["self"]))},[renderSlot(t.$slots,"default")],46,_hoisted_1$e)}var DropdownMenu=_export_sfc(_sfc_main$k,[["render",_sfc_render$5],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown-menu.vue"]]);const ElDropdown=withInstall(Dropdown,{DropdownItem,DropdownMenu}),ElDropdownItem=withNoopInstall(DropdownItem),ElDropdownMenu=withNoopInstall(DropdownMenu),imageViewerProps=buildProps({urlList:{type:definePropType(Array),default:()=>mutable([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),imageViewerEmits={close:()=>!0,switch:t=>isNumber$1(t)},_hoisted_1$d=["src"],__default__$a=defineComponent({name:"ElImageViewer"}),_sfc_main$j=defineComponent({...__default__$a,props:imageViewerProps,emits:imageViewerEmits,setup(t,{expose:r,emit:e}){const n=t,o={CONTAIN:{name:"contain",icon:markRaw(full_screen_default)},ORIGINAL:{name:"original",icon:markRaw(scale_to_original_default)}},{t:s}=useLocale(),a=useNamespace("image-viewer"),{nextZIndex:i}=useZIndex(),u=ref(),c=ref([]),d=effectScope(),m=ref(!0),v=ref(n.initialIndex),g=shallowRef(o.CONTAIN),b=ref({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),T=computed(()=>{const{urlList:tr}=n;return tr.length<=1}),k=computed(()=>v.value===0),y=computed(()=>v.value===n.urlList.length-1),A=computed(()=>n.urlList[v.value]),V=computed(()=>[a.e("btn"),a.e("prev"),a.is("disabled",!n.infinite&&k.value)]),he=computed(()=>[a.e("btn"),a.e("next"),a.is("disabled",!n.infinite&&y.value)]),ae=computed(()=>{const{scale:tr,deg:dr,offsetX:fr,offsetY:sr,enableTransition:hr}=b.value;let Fe=fr/tr,or=sr/tr;switch(dr%360){case 90:case-270:[Fe,or]=[or,-Fe];break;case 180:case-180:[Fe,or]=[-Fe,-or];break;case 270:case-90:[Fe,or]=[-or,Fe];break}const ir={transform:`scale(${tr}) rotate(${dr}deg) translate(${Fe}px, ${or}px)`,transition:hr?"transform .3s":""};return g.value.name===o.CONTAIN.name&&(ir.maxWidth=ir.maxHeight="100%"),ir}),Ne=computed(()=>isNumber$1(n.zIndex)?n.zIndex:i());function _e(){re(),e("close")}function Ce(){const tr=throttle(fr=>{switch(fr.code){case EVENT_CODE.esc:n.closeOnPressEscape&&_e();break;case EVENT_CODE.space:Ie();break;case EVENT_CODE.left:Ve();break;case EVENT_CODE.up:Dt("zoomIn");break;case EVENT_CODE.right:Ue();break;case EVENT_CODE.down:Dt("zoomOut");break}}),dr=throttle(fr=>{const sr=fr.deltaY||fr.deltaX;Dt(sr<0?"zoomIn":"zoomOut",{zoomRate:n.zoomRate,enableTransition:!1})});d.run(()=>{useEventListener(document,"keydown",tr),useEventListener(document,"wheel",dr)})}function re(){d.stop()}function ue(){m.value=!1}function ze(tr){m.value=!1,tr.target.alt=s("el.image.error")}function le(tr){if(m.value||tr.button!==0||!u.value)return;b.value.enableTransition=!1;const{offsetX:dr,offsetY:fr}=b.value,sr=tr.pageX,hr=tr.pageY,Fe=throttle(ir=>{b.value={...b.value,offsetX:dr+ir.pageX-sr,offsetY:fr+ir.pageY-hr}}),or=useEventListener(document,"mousemove",Fe);useEventListener(document,"mouseup",()=>{or()}),tr.preventDefault()}function de(){b.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Ie(){if(m.value)return;const tr=keysOf(o),dr=Object.values(o),fr=g.value.name,hr=(dr.findIndex(Fe=>Fe.name===fr)+1)%tr.length;g.value=o[tr[hr]],de()}function ie(tr){const dr=n.urlList.length;v.value=(tr+dr)%dr}function Ve(){k.value&&!n.infinite||ie(v.value-1)}function Ue(){y.value&&!n.infinite||ie(v.value+1)}function Dt(tr,dr={}){if(m.value)return;const{zoomRate:fr,rotateDeg:sr,enableTransition:hr}={zoomRate:n.zoomRate,rotateDeg:90,enableTransition:!0,...dr};switch(tr){case"zoomOut":b.value.scale>.2&&(b.value.scale=Number.parseFloat((b.value.scale/fr).toFixed(3)));break;case"zoomIn":b.value.scale<7&&(b.value.scale=Number.parseFloat((b.value.scale*fr).toFixed(3)));break;case"clockwise":b.value.deg+=sr;break;case"anticlockwise":b.value.deg-=sr;break}b.value.enableTransition=hr}return watch(A,()=>{nextTick(()=>{const tr=c.value[0];tr!=null&&tr.complete||(m.value=!0)})}),watch(v,tr=>{de(),e("switch",tr)}),onMounted(()=>{var tr,dr;Ce(),(dr=(tr=u.value)==null?void 0:tr.focus)==null||dr.call(tr)}),r({setActiveItem:ie}),(tr,dr)=>(openBlock(),createBlock(Teleport,{to:"body",disabled:!tr.teleported},[createVNode(Transition,{name:"viewer-fade",appear:""},{default:withCtx(()=>[createBaseVNode("div",{ref_key:"wrapper",ref:u,tabindex:-1,class:normalizeClass(unref(a).e("wrapper")),style:normalizeStyle({zIndex:unref(Ne)})},[createBaseVNode("div",{class:normalizeClass(unref(a).e("mask")),onClick:dr[0]||(dr[0]=withModifiers(fr=>tr.hideOnClickModal&&_e(),["self"]))},null,2),createCommentVNode(" CLOSE "),createBaseVNode("span",{class:normalizeClass([unref(a).e("btn"),unref(a).e("close")]),onClick:_e},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(close_default))]),_:1})],2),createCommentVNode(" ARROW "),unref(T)?createCommentVNode("v-if",!0):(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("span",{class:normalizeClass(unref(V)),onClick:Ve},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(arrow_left_default))]),_:1})],2),createBaseVNode("span",{class:normalizeClass(unref(he)),onClick:Ue},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(arrow_right_default))]),_:1})],2)],64)),createCommentVNode(" ACTIONS "),createBaseVNode("div",{class:normalizeClass([unref(a).e("btn"),unref(a).e("actions")])},[createBaseVNode("div",{class:normalizeClass(unref(a).e("actions__inner"))},[createVNode(unref(ElIcon),{onClick:dr[1]||(dr[1]=fr=>Dt("zoomOut"))},{default:withCtx(()=>[createVNode(unref(zoom_out_default))]),_:1}),createVNode(unref(ElIcon),{onClick:dr[2]||(dr[2]=fr=>Dt("zoomIn"))},{default:withCtx(()=>[createVNode(unref(zoom_in_default))]),_:1}),createBaseVNode("i",{class:normalizeClass(unref(a).e("actions__divider"))},null,2),createVNode(unref(ElIcon),{onClick:Ie},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(g).icon)))]),_:1}),createBaseVNode("i",{class:normalizeClass(unref(a).e("actions__divider"))},null,2),createVNode(unref(ElIcon),{onClick:dr[3]||(dr[3]=fr=>Dt("anticlockwise"))},{default:withCtx(()=>[createVNode(unref(refresh_left_default))]),_:1}),createVNode(unref(ElIcon),{onClick:dr[4]||(dr[4]=fr=>Dt("clockwise"))},{default:withCtx(()=>[createVNode(unref(refresh_right_default))]),_:1})],2)],2),createCommentVNode(" CANVAS "),createBaseVNode("div",{class:normalizeClass(unref(a).e("canvas"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(tr.urlList,(fr,sr)=>withDirectives((openBlock(),createElementBlock("img",{ref_for:!0,ref:hr=>c.value[sr]=hr,key:fr,src:fr,style:normalizeStyle(unref(ae)),class:normalizeClass(unref(a).e("img")),onLoad:ue,onError:ze,onMousedown:le},null,46,_hoisted_1$d)),[[vShow,sr===v.value]])),128))],2),renderSlot(tr.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var ImageViewer=_export_sfc(_sfc_main$j,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const ElImageViewer=withInstall(ImageViewer),imageProps=buildProps({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:definePropType([String,Object])},previewSrcList:{type:definePropType(Array),default:()=>mutable([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),imageEmits={load:t=>t instanceof Event,error:t=>t instanceof Event,switch:t=>isNumber$1(t),close:()=>!0,show:()=>!0},_hoisted_1$c=["src","loading"],_hoisted_2$b={key:0},__default__$9=defineComponent({name:"ElImage",inheritAttrs:!1}),_sfc_main$i=defineComponent({...__default__$9,props:imageProps,emits:imageEmits,setup(t,{emit:r}){const e=t;let n="";const{t:o}=useLocale(),s=useNamespace("image"),a=useAttrs$1(),i=useAttrs(),u=ref(),c=ref(!1),d=ref(!0),m=ref(!1),v=ref(),g=ref(),b=isClient&&"loading"in HTMLImageElement.prototype;let T,k;const y=computed(()=>[s.e("inner"),he.value&&s.e("preview"),d.value&&s.is("loading")]),A=computed(()=>a.style),V=computed(()=>{const{fit:Dt}=e;return isClient&&Dt?{objectFit:Dt}:{}}),he=computed(()=>{const{previewSrcList:Dt}=e;return Array.isArray(Dt)&&Dt.length>0}),ae=computed(()=>{const{previewSrcList:Dt,initialIndex:tr}=e;let dr=tr;return tr>Dt.length-1&&(dr=0),dr}),Ne=computed(()=>e.loading==="eager"?!1:!b&&e.loading==="lazy"||e.lazy),_e=()=>{isClient&&(d.value=!0,c.value=!1,u.value=e.src)};function Ce(Dt){d.value=!1,c.value=!1,r("load",Dt)}function re(Dt){d.value=!1,c.value=!0,r("error",Dt)}function ue(){isInContainer(v.value,g.value)&&(_e(),de())}const ze=useThrottleFn(ue,200,!0);async function le(){var Dt;if(!isClient)return;await nextTick();const{scrollContainer:tr}=e;isElement(tr)?g.value=tr:isString$2(tr)&&tr!==""?g.value=(Dt=document.querySelector(tr))!=null?Dt:void 0:v.value&&(g.value=getScrollContainer(v.value)),g.value&&(T=useEventListener(g,"scroll",ze),setTimeout(()=>ue(),100))}function de(){!isClient||!g.value||!ze||(T==null||T(),g.value=void 0)}function Ie(Dt){if(Dt.ctrlKey){if(Dt.deltaY<0)return Dt.preventDefault(),!1;if(Dt.deltaY>0)return Dt.preventDefault(),!1}}function ie(){he.value&&(k=useEventListener("wheel",Ie,{passive:!1}),n=document.body.style.overflow,document.body.style.overflow="hidden",m.value=!0,r("show"))}function Ve(){k==null||k(),document.body.style.overflow=n,m.value=!1,r("close")}function Ue(Dt){r("switch",Dt)}return watch(()=>e.src,()=>{Ne.value?(d.value=!0,c.value=!1,de(),le()):_e()}),onMounted(()=>{Ne.value?le():_e()}),(Dt,tr)=>(openBlock(),createElementBlock("div",{ref_key:"container",ref:v,class:normalizeClass([unref(s).b(),Dt.$attrs.class]),style:normalizeStyle(unref(A))},[c.value?renderSlot(Dt.$slots,"error",{key:0},()=>[createBaseVNode("div",{class:normalizeClass(unref(s).e("error"))},toDisplayString(unref(o)("el.image.error")),3)]):(openBlock(),createElementBlock(Fragment,{key:1},[u.value!==void 0?(openBlock(),createElementBlock("img",mergeProps({key:0},unref(i),{src:u.value,loading:Dt.loading,style:unref(V),class:unref(y),onClick:ie,onLoad:Ce,onError:re}),null,16,_hoisted_1$c)):createCommentVNode("v-if",!0),d.value?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(s).e("wrapper"))},[renderSlot(Dt.$slots,"placeholder",{},()=>[createBaseVNode("div",{class:normalizeClass(unref(s).e("placeholder"))},null,2)])],2)):createCommentVNode("v-if",!0)],64)),unref(he)?(openBlock(),createElementBlock(Fragment,{key:2},[m.value?(openBlock(),createBlock(unref(ElImageViewer),{key:0,"z-index":Dt.zIndex,"initial-index":unref(ae),infinite:Dt.infinite,"zoom-rate":Dt.zoomRate,"url-list":Dt.previewSrcList,"hide-on-click-modal":Dt.hideOnClickModal,teleported:Dt.previewTeleported,"close-on-press-escape":Dt.closeOnPressEscape,onClose:Ve,onSwitch:Ue},{default:withCtx(()=>[Dt.$slots.viewer?(openBlock(),createElementBlock("div",_hoisted_2$b,[renderSlot(Dt.$slots,"viewer")])):createCommentVNode("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):createCommentVNode("v-if",!0)],64)):createCommentVNode("v-if",!0)],6))}});var Image$1=_export_sfc(_sfc_main$i,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const ElImage=withInstall(Image$1),selectGroupKey=Symbol("ElSelectGroup"),selectKey=Symbol("ElSelect");function useOption(t,r){const e=inject(selectKey),n=inject(selectGroupKey,{disabled:!1}),o=computed(()=>Object.prototype.toString.call(t.value).toLowerCase()==="[object object]"),s=computed(()=>e.props.multiple?m(e.props.modelValue,t.value):v(t.value,e.props.modelValue)),a=computed(()=>{if(e.props.multiple){const T=e.props.modelValue||[];return!s.value&&T.length>=e.props.multipleLimit&&e.props.multipleLimit>0}else return!1}),i=computed(()=>t.label||(o.value?"":t.value)),u=computed(()=>t.value||t.label||""),c=computed(()=>t.disabled||r.groupDisabled||a.value),d=getCurrentInstance(),m=(T=[],k)=>{if(o.value){const y=e.props.valueKey;return T&&T.some(A=>toRaw(get(A,y))===get(k,y))}else return T&&T.includes(k)},v=(T,k)=>{if(o.value){const{valueKey:y}=e.props;return get(T,y)===get(k,y)}else return T===k},g=()=>{!t.disabled&&!n.disabled&&(e.hoverIndex=e.optionsArray.indexOf(d.proxy))};watch(()=>i.value,()=>{!t.created&&!e.props.remote&&e.setSelected()}),watch(()=>t.value,(T,k)=>{const{remote:y,valueKey:A}=e.props;if(Object.is(T,k)||(e.onOptionDestroy(k,d.proxy),e.onOptionCreate(d.proxy)),!t.created&&!y){if(A&&typeof T=="object"&&typeof k=="object"&&T[A]===k[A])return;e.setSelected()}}),watch(()=>n.disabled,()=>{r.groupDisabled=n.disabled},{immediate:!0});const{queryChange:b}=toRaw(e);return watch(b,T=>{const{query:k}=unref(T),y=new RegExp(escapeStringRegexp(k),"i");r.visible=y.test(i.value)||t.created,r.visible||e.filteredOptionsCount--},{immediate:!0}),{select:e,currentLabel:i,currentValue:u,itemSelected:s,isDisabled:c,hoverItem:g}}const _sfc_main$h=defineComponent({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(t){const r=useNamespace("select"),e=computed(()=>[r.be("dropdown","item"),r.is("disabled",unref(a)),{selected:unref(s),hover:unref(d)}]),n=reactive({index:-1,groupDisabled:!1,visible:!0,hitState:!1,hover:!1}),{currentLabel:o,itemSelected:s,isDisabled:a,select:i,hoverItem:u}=useOption(t,n),{visible:c,hover:d}=toRefs(n),m=getCurrentInstance().proxy;i.onOptionCreate(m),onBeforeUnmount(()=>{const g=m.value,{selected:b}=i,k=(i.props.multiple?b:[b]).some(y=>y.value===m.value);nextTick(()=>{i.cachedOptions.get(g)===m&&!k&&i.cachedOptions.delete(g)}),i.onOptionDestroy(g,m)});function v(){t.disabled!==!0&&n.groupDisabled!==!0&&i.handleOptionSelect(m)}return{ns:r,containerKls:e,currentLabel:o,itemSelected:s,isDisabled:a,select:i,hoverItem:u,visible:c,hover:d,selectOptionClick:v,states:n}}});function _sfc_render$4(t,r,e,n,o,s){return withDirectives((openBlock(),createElementBlock("li",{class:normalizeClass(t.containerKls),onMouseenter:r[0]||(r[0]=(...a)=>t.hoverItem&&t.hoverItem(...a)),onClick:r[1]||(r[1]=withModifiers((...a)=>t.selectOptionClick&&t.selectOptionClick(...a),["stop"]))},[renderSlot(t.$slots,"default",{},()=>[createBaseVNode("span",null,toDisplayString(t.currentLabel),1)])],34)),[[vShow,t.visible]])}var Option=_export_sfc(_sfc_main$h,[["render",_sfc_render$4],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option.vue"]]);const _sfc_main$g=defineComponent({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const t=inject(selectKey),r=useNamespace("select"),e=computed(()=>t.props.popperClass),n=computed(()=>t.props.multiple),o=computed(()=>t.props.fitInputWidth),s=ref("");function a(){var i;s.value=`${(i=t.selectWrapper)==null?void 0:i.offsetWidth}px`}return onMounted(()=>{a(),useResizeObserver(t.selectWrapper,a)}),{ns:r,minWidth:s,popperClass:e,isMultiple:n,isFitInputWidth:o}}});function _sfc_render$3(t,r,e,n,o,s){return openBlock(),createElementBlock("div",{class:normalizeClass([t.ns.b("dropdown"),t.ns.is("multiple",t.isMultiple),t.popperClass]),style:normalizeStyle({[t.isFitInputWidth?"width":"minWidth"]:t.minWidth})},[renderSlot(t.$slots,"default")],6)}var ElSelectMenu=_export_sfc(_sfc_main$g,[["render",_sfc_render$3],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select-dropdown.vue"]]);function useSelectStates(t){const{t:r}=useLocale();return reactive({options:new Map,cachedOptions:new Map,disabledOptions:new Map,createdLabel:null,createdSelected:!1,selected:t.multiple?[]:{},inputLength:20,inputWidth:0,optionsCount:0,filteredOptionsCount:0,visible:!1,selectedLabel:"",hoverIndex:-1,query:"",previousQuery:null,inputHovering:!1,cachedPlaceHolder:"",currentPlaceholder:r("el.select.placeholder"),menuVisibleOnFocus:!1,isOnComposition:!1,prefixWidth:11,mouseEnter:!1,focused:!1})}const useSelect=(t,r,e)=>{const{t:n}=useLocale(),o=useNamespace("select");useDeprecated({from:"suffixTransition",replacement:"override style scheme",version:"2.3.0",scope:"props",ref:"https://element-plus.org/en-US/component/select.html#select-attributes"},computed(()=>t.suffixTransition===!1));const s=ref(null),a=ref(null),i=ref(null),u=ref(null),c=ref(null),d=ref(null),m=ref(null),v=ref(null),g=ref(-1),b=shallowRef({query:""}),T=shallowRef(""),k=ref([]);let y=0;const{form:A,formItem:V}=useFormItem(),he=computed(()=>!t.filterable||t.multiple||!r.visible),ae=computed(()=>t.disabled||(A==null?void 0:A.disabled)),Ne=computed(()=>{const Lr=t.multiple?Array.isArray(t.modelValue)&&t.modelValue.length>0:t.modelValue!==void 0&&t.modelValue!==null&&t.modelValue!=="";return t.clearable&&!ae.value&&r.inputHovering&&Lr}),_e=computed(()=>t.remote&&t.filterable&&!t.remoteShowSuffix?"":t.suffixIcon),Ce=computed(()=>o.is("reverse",_e.value&&r.visible&&t.suffixTransition)),re=computed(()=>(A==null?void 0:A.statusIcon)&&(V==null?void 0:V.validateState)&&ValidateComponentsMap[V==null?void 0:V.validateState]),ue=computed(()=>t.remote?300:0),ze=computed(()=>t.loading?t.loadingText||n("el.select.loading"):t.remote&&r.query===""&&r.options.size===0?!1:t.filterable&&r.query&&r.options.size>0&&r.filteredOptionsCount===0?t.noMatchText||n("el.select.noMatch"):r.options.size===0?t.noDataText||n("el.select.noData"):null),le=computed(()=>{const Lr=Array.from(r.options.values()),Qr=[];return k.value.forEach(Bn=>{const Xn=Lr.findIndex(ko=>ko.currentLabel===Bn);Xn>-1&&Qr.push(Lr[Xn])}),Qr.length?Qr:Lr}),de=computed(()=>Array.from(r.cachedOptions.values())),Ie=computed(()=>{const Lr=le.value.filter(Qr=>!Qr.created).some(Qr=>Qr.currentLabel===r.query);return t.filterable&&t.allowCreate&&r.query!==""&&!Lr}),ie=useFormSize(),Ve=computed(()=>["small"].includes(ie.value)?"small":"default"),Ue=computed({get(){return r.visible&&ze.value!==!1},set(Lr){r.visible=Lr}});watch([()=>ae.value,()=>ie.value,()=>A==null?void 0:A.size],()=>{nextTick(()=>{Dt()})}),watch(()=>t.placeholder,Lr=>{r.cachedPlaceHolder=r.currentPlaceholder=Lr,t.multiple&&Array.isArray(t.modelValue)&&t.modelValue.length>0&&(r.currentPlaceholder="")}),watch(()=>t.modelValue,(Lr,Qr)=>{t.multiple&&(Dt(),Lr&&Lr.length>0||a.value&&r.query!==""?r.currentPlaceholder="":r.currentPlaceholder=r.cachedPlaceHolder,t.filterable&&!t.reserveKeyword&&(r.query="",tr(r.query))),sr(),t.filterable&&!t.multiple&&(r.inputLength=20),!isEqual(Lr,Qr)&&t.validateEvent&&(V==null||V.validate("change").catch(Bn=>void 0))},{flush:"post",deep:!0}),watch(()=>r.visible,Lr=>{var Qr,Bn,Xn,ko,no;Lr?((Bn=(Qr=u.value)==null?void 0:Qr.updatePopper)==null||Bn.call(Qr),t.filterable&&(r.filteredOptionsCount=r.optionsCount,r.query=t.remote?"":r.selectedLabel,(ko=(Xn=i.value)==null?void 0:Xn.focus)==null||ko.call(Xn),t.multiple?(no=a.value)==null||no.focus():r.selectedLabel&&(r.currentPlaceholder=`${r.selectedLabel}`,r.selectedLabel=""),tr(r.query),!t.multiple&&!t.remote&&(b.value.query="",triggerRef(b),triggerRef(T)))):(t.filterable&&(isFunction$3(t.filterMethod)&&t.filterMethod(""),isFunction$3(t.remoteMethod)&&t.remoteMethod("")),r.query="",r.previousQuery=null,r.selectedLabel="",r.inputLength=20,r.menuVisibleOnFocus=!1,Fe(),nextTick(()=>{a.value&&a.value.value===""&&r.selected.length===0&&(r.currentPlaceholder=r.cachedPlaceHolder)}),t.multiple||(r.selected&&(t.filterable&&t.allowCreate&&r.createdSelected&&r.createdLabel?r.selectedLabel=r.createdLabel:r.selectedLabel=r.selected.currentLabel,t.filterable&&(r.query=r.selectedLabel)),t.filterable&&(r.currentPlaceholder=r.cachedPlaceHolder))),e.emit("visible-change",Lr)}),watch(()=>r.options.entries(),()=>{var Lr,Qr,Bn;if(!isClient)return;(Qr=(Lr=u.value)==null?void 0:Lr.updatePopper)==null||Qr.call(Lr),t.multiple&&Dt();const Xn=((Bn=m.value)==null?void 0:Bn.querySelectorAll("input"))||[];(!t.filterable&&!t.defaultFirstOption&&!isUndefined$1(t.modelValue)||!Array.from(Xn).includes(document.activeElement))&&sr(),t.defaultFirstOption&&(t.filterable||t.remote)&&r.filteredOptionsCount&&fr()},{flush:"post"}),watch(()=>r.hoverIndex,Lr=>{isNumber$1(Lr)&&Lr>-1?g.value=le.value[Lr]||{}:g.value={},le.value.forEach(Qr=>{Qr.hover=g.value===Qr})});const Dt=()=>{nextTick(()=>{var Lr,Qr;if(!s.value)return;const Bn=s.value.$el.querySelector("input");y=y||(Bn.clientHeight>0?Bn.clientHeight+2:0);const Xn=d.value,ko=getComponentSize(ie.value||(A==null?void 0:A.size)),no=ie.value||ko===y||y<=0?ko:y;!(Bn.offsetParent===null)&&(Bn.style.height=`${(r.selected.length===0?no:Math.max(Xn?Xn.clientHeight+(Xn.clientHeight>no?6:0):0,no))-2}px`),r.visible&&ze.value!==!1&&((Qr=(Lr=u.value)==null?void 0:Lr.updatePopper)==null||Qr.call(Lr))})},tr=async Lr=>{if(!(r.previousQuery===Lr||r.isOnComposition)){if(r.previousQuery===null&&(isFunction$3(t.filterMethod)||isFunction$3(t.remoteMethod))){r.previousQuery=Lr;return}r.previousQuery=Lr,nextTick(()=>{var Qr,Bn;r.visible&&((Bn=(Qr=u.value)==null?void 0:Qr.updatePopper)==null||Bn.call(Qr))}),r.hoverIndex=-1,t.multiple&&t.filterable&&nextTick(()=>{if(!ae.value){const Qr=a.value.value.length*15+20;r.inputLength=t.collapseTags?Math.min(50,Qr):Qr,dr()}Dt()}),t.remote&&isFunction$3(t.remoteMethod)?(r.hoverIndex=-1,t.remoteMethod(Lr)):isFunction$3(t.filterMethod)?(t.filterMethod(Lr),triggerRef(T)):(r.filteredOptionsCount=r.optionsCount,b.value.query=Lr,triggerRef(b),triggerRef(T)),t.defaultFirstOption&&(t.filterable||t.remote)&&r.filteredOptionsCount&&(await nextTick(),fr())}},dr=()=>{r.currentPlaceholder!==""&&(r.currentPlaceholder=a.value.value?"":r.cachedPlaceHolder)},fr=()=>{const Lr=le.value.filter(Xn=>Xn.visible&&!Xn.disabled&&!Xn.states.groupDisabled),Qr=Lr.find(Xn=>Xn.created),Bn=Lr[0];r.hoverIndex=yr(le.value,Qr||Bn)},sr=()=>{var Lr;if(t.multiple)r.selectedLabel="";else{const Bn=hr(t.modelValue);(Lr=Bn.props)!=null&&Lr.created?(r.createdLabel=Bn.props.value,r.createdSelected=!0):r.createdSelected=!1,r.selectedLabel=Bn.currentLabel,r.selected=Bn,t.filterable&&(r.query=r.selectedLabel);return}const Qr=[];Array.isArray(t.modelValue)&&t.modelValue.forEach(Bn=>{Qr.push(hr(Bn))}),r.selected=Qr,nextTick(()=>{Dt()})},hr=Lr=>{let Qr;const Bn=toRawType(Lr).toLowerCase()==="object",Xn=toRawType(Lr).toLowerCase()==="null",ko=toRawType(Lr).toLowerCase()==="undefined";for(let fs=r.cachedOptions.size-1;fs>=0;fs--){const ms=de.value[fs];if(Bn?get(ms.value,t.valueKey)===get(Lr,t.valueKey):ms.value===Lr){Qr={value:Lr,currentLabel:ms.currentLabel,isDisabled:ms.isDisabled};break}}if(Qr)return Qr;const no=Bn?Lr.label:!Xn&&!ko?Lr:"",Ra={value:Lr,currentLabel:no};return t.multiple&&(Ra.hitState=!1),Ra},Fe=()=>{setTimeout(()=>{const Lr=t.valueKey;t.multiple?r.selected.length>0?r.hoverIndex=Math.min.apply(null,r.selected.map(Qr=>le.value.findIndex(Bn=>get(Bn,Lr)===get(Qr,Lr)))):r.hoverIndex=-1:r.hoverIndex=le.value.findIndex(Qr=>Wn(Qr)===Wn(r.selected))},300)},or=()=>{var Lr,Qr;ir(),(Qr=(Lr=u.value)==null?void 0:Lr.updatePopper)==null||Qr.call(Lr),t.multiple&&Dt()},ir=()=>{var Lr;r.inputWidth=(Lr=s.value)==null?void 0:Lr.$el.offsetWidth},$e=()=>{t.filterable&&r.query!==r.selectedLabel&&(r.query=r.selectedLabel,tr(r.query))},er=debounce(()=>{$e()},ue.value),nr=debounce(Lr=>{tr(Lr.target.value)},ue.value),Pt=Lr=>{isEqual(t.modelValue,Lr)||e.emit(CHANGE_EVENT,Lr)},rr=Lr=>findLastIndex(Lr,Qr=>!r.disabledOptions.has(Qr)),kt=Lr=>{if(Lr.code!==EVENT_CODE.delete){if(Lr.target.value.length<=0&&!Mn()){const Qr=t.modelValue.slice(),Bn=rr(Qr);if(Bn<0)return;Qr.splice(Bn,1),e.emit(UPDATE_MODEL_EVENT,Qr),Pt(Qr)}Lr.target.value.length===1&&t.modelValue.length===0&&(r.currentPlaceholder=r.cachedPlaceHolder)}},Et=(Lr,Qr)=>{const Bn=r.selected.indexOf(Qr);if(Bn>-1&&!ae.value){const Xn=t.modelValue.slice();Xn.splice(Bn,1),e.emit(UPDATE_MODEL_EVENT,Xn),Pt(Xn),e.emit("remove-tag",Qr.value)}Lr.stopPropagation(),Wr()},cr=Lr=>{Lr.stopPropagation();const Qr=t.multiple?[]:"";if(!isString$2(Qr))for(const Bn of r.selected)Bn.isDisabled&&Qr.push(Bn.value);e.emit(UPDATE_MODEL_EVENT,Qr),Pt(Qr),r.hoverIndex=-1,r.visible=!1,e.emit("clear"),Wr()},mr=Lr=>{var Qr;if(t.multiple){const Bn=(t.modelValue||[]).slice(),Xn=yr(Bn,Lr.value);Xn>-1?Bn.splice(Xn,1):(t.multipleLimit<=0||Bn.length<t.multipleLimit)&&Bn.push(Lr.value),e.emit(UPDATE_MODEL_EVENT,Bn),Pt(Bn),Lr.created&&(r.query="",tr(""),r.inputLength=20),t.filterable&&((Qr=a.value)==null||Qr.focus())}else e.emit(UPDATE_MODEL_EVENT,Lr.value),Pt(Lr.value),r.visible=!1;Tr(),!r.visible&&nextTick(()=>{Ir(Lr)})},yr=(Lr=[],Qr)=>{if(!isObject$2(Qr))return Lr.indexOf(Qr);const Bn=t.valueKey;let Xn=-1;return Lr.some((ko,no)=>toRaw(get(ko,Bn))===get(Qr,Bn)?(Xn=no,!0):!1),Xn},Tr=()=>{const Lr=a.value||s.value;Lr&&(Lr==null||Lr.focus())},Ir=Lr=>{var Qr,Bn,Xn,ko,no;const Ra=Array.isArray(Lr)?Lr[0]:Lr;let fs=null;if(Ra!=null&&Ra.value){const ms=le.value.filter(ga=>ga.value===Ra.value);ms.length>0&&(fs=ms[0].$el)}if(u.value&&fs){const ms=(ko=(Xn=(Bn=(Qr=u.value)==null?void 0:Qr.popperRef)==null?void 0:Bn.contentRef)==null?void 0:Xn.querySelector)==null?void 0:ko.call(Xn,`.${o.be("dropdown","wrap")}`);ms&&scrollIntoView(ms,fs)}(no=v.value)==null||no.handleScroll()},kr=Lr=>{r.optionsCount++,r.filteredOptionsCount++,r.options.set(Lr.value,Lr),r.cachedOptions.set(Lr.value,Lr),Lr.disabled&&r.disabledOptions.set(Lr.value,Lr)},Ar=(Lr,Qr)=>{r.options.get(Lr)===Qr&&(r.optionsCount--,r.filteredOptionsCount--,r.options.delete(Lr))},Rr=Lr=>{Lr.code!==EVENT_CODE.backspace&&Mn(!1),r.inputLength=a.value.value.length*15+20,Dt()},Mn=Lr=>{if(!Array.isArray(r.selected))return;const Qr=rr(r.selected.map(Xn=>Xn.value)),Bn=r.selected[Qr];if(Bn)return Lr===!0||Lr===!1?(Bn.hitState=Lr,Lr):(Bn.hitState=!Bn.hitState,Bn.hitState)},Or=Lr=>{const Qr=Lr.target.value;if(Lr.type==="compositionend")r.isOnComposition=!1,nextTick(()=>tr(Qr));else{const Bn=Qr[Qr.length-1]||"";r.isOnComposition=!isKorean(Bn)}},Pr=()=>{nextTick(()=>Ir(r.selected))},Nr=Lr=>{r.focused||((t.automaticDropdown||t.filterable)&&(t.filterable&&!r.visible&&(r.menuVisibleOnFocus=!0),r.visible=!0),r.focused=!0,e.emit("focus",Lr))},Wr=()=>{var Lr,Qr;r.visible?(Lr=a.value||s.value)==null||Lr.focus():(Qr=s.value)==null||Qr.focus()},Yr=()=>{var Lr,Qr,Bn;r.visible=!1,(Lr=s.value)==null||Lr.blur(),(Bn=(Qr=i.value)==null?void 0:Qr.blur)==null||Bn.call(Qr)},Ur=Lr=>{var Qr,Bn,Xn;(Qr=u.value)!=null&&Qr.isFocusInsideContent(Lr)||(Bn=c.value)!=null&&Bn.isFocusInsideContent(Lr)||(Xn=m.value)!=null&&Xn.contains(Lr.relatedTarget)||(r.visible&&Yn(),r.focused=!1,e.emit("blur",Lr))},qr=Lr=>{cr(Lr)},Yn=()=>{r.visible=!1},$n=Lr=>{r.visible&&(Lr.preventDefault(),Lr.stopPropagation(),r.visible=!1)},Jr=Lr=>{Lr&&!r.mouseEnter||ae.value||(r.menuVisibleOnFocus?r.menuVisibleOnFocus=!1:(!u.value||!u.value.isFocusInsideContent())&&(r.visible=!r.visible),Wr())},Fr=()=>{r.visible?le.value[r.hoverIndex]&&mr(le.value[r.hoverIndex]):Jr()},Wn=Lr=>isObject$2(Lr.value)?get(Lr.value,t.valueKey):Lr.value,ho=computed(()=>le.value.filter(Lr=>Lr.visible).every(Lr=>Lr.disabled)),bo=computed(()=>r.selected.slice(0,t.maxCollapseTags)),uo=computed(()=>r.selected.slice(t.maxCollapseTags)),po=Lr=>{if(!r.visible){r.visible=!0;return}if(!(r.options.size===0||r.filteredOptionsCount===0)&&!r.isOnComposition&&!ho.value){Lr==="next"?(r.hoverIndex++,r.hoverIndex===r.options.size&&(r.hoverIndex=0)):Lr==="prev"&&(r.hoverIndex--,r.hoverIndex<0&&(r.hoverIndex=r.options.size-1));const Qr=le.value[r.hoverIndex];(Qr.disabled===!0||Qr.states.groupDisabled===!0||!Qr.visible)&&po(Lr),nextTick(()=>Ir(g.value))}},No=()=>{r.mouseEnter=!0},An=()=>{r.mouseEnter=!1},Sa=(Lr,Qr)=>{var Bn,Xn;Et(Lr,Qr),(Xn=(Bn=c.value)==null?void 0:Bn.updatePopper)==null||Xn.call(Bn)},to=computed(()=>({maxWidth:`${unref(r.inputWidth)-32-(re.value?22:0)}px`,width:"100%"}));return{optionList:k,optionsArray:le,selectSize:ie,handleResize:or,debouncedOnInputChange:er,debouncedQueryChange:nr,deletePrevTag:kt,deleteTag:Et,deleteSelected:cr,handleOptionSelect:mr,scrollToOption:Ir,readonly:he,resetInputHeight:Dt,showClose:Ne,iconComponent:_e,iconReverse:Ce,showNewOption:Ie,collapseTagSize:Ve,setSelected:sr,managePlaceholder:dr,selectDisabled:ae,emptyText:ze,toggleLastOptionHitState:Mn,resetInputState:Rr,handleComposition:Or,onOptionCreate:kr,onOptionDestroy:Ar,handleMenuEnter:Pr,handleFocus:Nr,focus:Wr,blur:Yr,handleBlur:Ur,handleClearClick:qr,handleClose:Yn,handleKeydownEscape:$n,toggleMenu:Jr,selectOption:Fr,getValueKey:Wn,navigateOptions:po,handleDeleteTooltipTag:Sa,dropMenuVisible:Ue,queryChange:b,groupQueryChange:T,showTagList:bo,collapseTagList:uo,selectTagsStyle:to,reference:s,input:a,iOSInput:i,tooltipRef:u,tagTooltipRef:c,tags:d,selectWrapper:m,scrollbar:v,handleMouseEnter:No,handleMouseLeave:An}};var ElOptions=defineComponent({name:"ElOptions",emits:["update-options"],setup(t,{slots:r,emit:e}){let n=[];function o(s,a){if(s.length!==a.length)return!1;for(const[i]of s.entries())if(s[i]!=a[i])return!1;return!0}return()=>{var s,a;const i=(s=r.default)==null?void 0:s.call(r),u=[];function c(d){Array.isArray(d)&&d.forEach(m=>{var v,g,b,T;const k=(v=(m==null?void 0:m.type)||{})==null?void 0:v.name;k==="ElOptionGroup"?c(!isString$2(m.children)&&!Array.isArray(m.children)&&isFunction$3((g=m.children)==null?void 0:g.default)?(b=m.children)==null?void 0:b.default():m.children):k==="ElOption"?u.push((T=m.props)==null?void 0:T.label):Array.isArray(m.children)&&c(m.children)})}return i.length&&c((a=i[0])==null?void 0:a.children),o(u,n)||(n=u,e("update-options",u)),i}}});const COMPONENT_NAME$2="ElSelect",_sfc_main$f=defineComponent({name:COMPONENT_NAME$2,componentName:COMPONENT_NAME$2,components:{ElInput,ElSelectMenu,ElOption:Option,ElOptions,ElTag,ElScrollbar,ElTooltip,ElIcon},directives:{ClickOutside},props:{name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:{type:String,validator:isValidComponentSize},effect:{type:String,default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Object,default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:useTooltipContentProps.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:iconPropType,default:circle_close_default},fitInputWidth:Boolean,suffixIcon:{type:iconPropType,default:arrow_down_default},tagType:{...tagProps.type,default:"info"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,suffixTransition:{type:Boolean,default:!0},placement:{type:String,values:Ee,default:"bottom-start"},ariaLabel:{type:String,default:void 0}},emits:[UPDATE_MODEL_EVENT,CHANGE_EVENT,"remove-tag","clear","visible-change","focus","blur"],setup(t,r){const e=useNamespace("select"),n=useNamespace("input"),{t:o}=useLocale(),s=useSelectStates(t),{optionList:a,optionsArray:i,selectSize:u,readonly:c,handleResize:d,collapseTagSize:m,debouncedOnInputChange:v,debouncedQueryChange:g,deletePrevTag:b,deleteTag:T,deleteSelected:k,handleOptionSelect:y,scrollToOption:A,setSelected:V,resetInputHeight:he,managePlaceholder:ae,showClose:Ne,selectDisabled:_e,iconComponent:Ce,iconReverse:re,showNewOption:ue,emptyText:ze,toggleLastOptionHitState:le,resetInputState:de,handleComposition:Ie,onOptionCreate:ie,onOptionDestroy:Ve,handleMenuEnter:Ue,handleFocus:Dt,focus:tr,blur:dr,handleBlur:fr,handleClearClick:sr,handleClose:hr,handleKeydownEscape:Fe,toggleMenu:or,selectOption:ir,getValueKey:$e,navigateOptions:er,handleDeleteTooltipTag:nr,dropMenuVisible:Pt,reference:rr,input:kt,iOSInput:Et,tooltipRef:cr,tagTooltipRef:mr,tags:yr,selectWrapper:Tr,scrollbar:Ir,queryChange:kr,groupQueryChange:Ar,handleMouseEnter:Rr,handleMouseLeave:Mn,showTagList:Or,collapseTagList:Pr,selectTagsStyle:Nr}=useSelect(t,s,r),{inputWidth:Wr,selected:Yr,inputLength:Ur,filteredOptionsCount:qr,visible:Yn,selectedLabel:$n,hoverIndex:Jr,query:Fr,inputHovering:Wn,currentPlaceholder:ho,menuVisibleOnFocus:bo,isOnComposition:uo,options:po,cachedOptions:No,optionsCount:An,prefixWidth:Sa}=toRefs(s),to=computed(()=>{const ga=[e.b()],Bi=unref(u);return Bi&&ga.push(e.m(Bi)),t.disabled&&ga.push(e.m("disabled")),ga}),Lr=computed(()=>[e.e("tags"),e.is("disabled",unref(_e))]),Qr=computed(()=>[e.b("tags-wrapper"),{"has-prefix":unref(Sa)&&unref(Yr).length}]),Bn=computed(()=>[e.e("input"),e.is(unref(u)),e.is("disabled",unref(_e))]),Xn=computed(()=>[e.e("input"),e.is(unref(u)),e.em("input","iOS")]),ko=computed(()=>[e.is("empty",!t.allowCreate&&!!unref(Fr)&&unref(qr)===0)]),no=computed(()=>({maxWidth:`${unref(Wr)>123?unref(Wr)-123:unref(Wr)-75}px`})),Ra=computed(()=>({marginLeft:`${unref(Sa)}px`,flexGrow:1,width:`${unref(Ur)/(unref(Wr)-32)}%`,maxWidth:`${unref(Wr)-42}px`}));provide(selectKey,reactive({props:t,options:po,optionsArray:i,cachedOptions:No,optionsCount:An,filteredOptionsCount:qr,hoverIndex:Jr,handleOptionSelect:y,onOptionCreate:ie,onOptionDestroy:Ve,selectWrapper:Tr,selected:Yr,setSelected:V,queryChange:kr,groupQueryChange:Ar})),onMounted(()=>{s.cachedPlaceHolder=ho.value=t.placeholder||(()=>o("el.select.placeholder")),t.multiple&&Array.isArray(t.modelValue)&&t.modelValue.length>0&&(ho.value=""),useResizeObserver(Tr,d),t.remote&&t.multiple&&he(),nextTick(()=>{const ga=rr.value&&rr.value.$el;if(ga&&(Wr.value=ga.getBoundingClientRect().width,r.slots.prefix)){const Bi=ga.querySelector(`.${n.e("prefix")}`);Sa.value=Math.max(Bi.getBoundingClientRect().width+11,30)}}),V()}),t.multiple&&!Array.isArray(t.modelValue)&&r.emit(UPDATE_MODEL_EVENT,[]),!t.multiple&&Array.isArray(t.modelValue)&&r.emit(UPDATE_MODEL_EVENT,"");const fs=computed(()=>{var ga,Bi;return(Bi=(ga=cr.value)==null?void 0:ga.popperRef)==null?void 0:Bi.contentRef});return{isIOS,onOptionsRendered:ga=>{a.value=ga},prefixWidth:Sa,selectSize:u,readonly:c,handleResize:d,collapseTagSize:m,debouncedOnInputChange:v,debouncedQueryChange:g,deletePrevTag:b,deleteTag:T,handleDeleteTooltipTag:nr,deleteSelected:k,handleOptionSelect:y,scrollToOption:A,inputWidth:Wr,selected:Yr,inputLength:Ur,filteredOptionsCount:qr,visible:Yn,selectedLabel:$n,hoverIndex:Jr,query:Fr,inputHovering:Wn,currentPlaceholder:ho,menuVisibleOnFocus:bo,isOnComposition:uo,options:po,resetInputHeight:he,managePlaceholder:ae,showClose:Ne,selectDisabled:_e,iconComponent:Ce,iconReverse:re,showNewOption:ue,emptyText:ze,toggleLastOptionHitState:le,resetInputState:de,handleComposition:Ie,handleMenuEnter:Ue,handleFocus:Dt,focus:tr,blur:dr,handleBlur:fr,handleClearClick:sr,handleClose:hr,handleKeydownEscape:Fe,toggleMenu:or,selectOption:ir,getValueKey:$e,navigateOptions:er,dropMenuVisible:Pt,reference:rr,input:kt,iOSInput:Et,tooltipRef:cr,popperPaneRef:fs,tags:yr,selectWrapper:Tr,scrollbar:Ir,wrapperKls:to,tagsKls:Lr,tagWrapperKls:Qr,inputKls:Bn,iOSInputKls:Xn,scrollbarKls:ko,selectTagsStyle:Nr,nsSelect:e,tagTextStyle:no,inputStyle:Ra,handleMouseEnter:Rr,handleMouseLeave:Mn,showTagList:Or,collapseTagList:Pr,tagTooltipRef:mr}}}),_hoisted_1$b=["disabled","autocomplete","aria-label"],_hoisted_2$a=["disabled"],_hoisted_3$7={style:{height:"100%",display:"flex","justify-content":"center","align-items":"center"}};function _sfc_render$2(t,r,e,n,o,s){const a=resolveComponent("el-tag"),i=resolveComponent("el-tooltip"),u=resolveComponent("el-icon"),c=resolveComponent("el-input"),d=resolveComponent("el-option"),m=resolveComponent("el-options"),v=resolveComponent("el-scrollbar"),g=resolveComponent("el-select-menu"),b=resolveDirective("click-outside");return withDirectives((openBlock(),createElementBlock("div",{ref:"selectWrapper",class:normalizeClass(t.wrapperKls),onMouseenter:r[22]||(r[22]=(...T)=>t.handleMouseEnter&&t.handleMouseEnter(...T)),onMouseleave:r[23]||(r[23]=(...T)=>t.handleMouseLeave&&t.handleMouseLeave(...T)),onClick:r[24]||(r[24]=withModifiers((...T)=>t.toggleMenu&&t.toggleMenu(...T),["stop"]))},[createVNode(i,{ref:"tooltipRef",visible:t.dropMenuVisible,placement:t.placement,teleported:t.teleported,"popper-class":[t.nsSelect.e("popper"),t.popperClass],"popper-options":t.popperOptions,"fallback-placements":["bottom-start","top-start","right","left"],effect:t.effect,pure:"",trigger:"click",transition:`${t.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:t.persistent,onShow:t.handleMenuEnter},{default:withCtx(()=>[createBaseVNode("div",{class:"select-trigger",onMouseenter:r[20]||(r[20]=T=>t.inputHovering=!0),onMouseleave:r[21]||(r[21]=T=>t.inputHovering=!1)},[t.multiple?(openBlock(),createElementBlock("div",{key:0,ref:"tags",tabindex:"-1",class:normalizeClass(t.tagsKls),style:normalizeStyle(t.selectTagsStyle),onClick:r[15]||(r[15]=(...T)=>t.focus&&t.focus(...T))},[t.collapseTags&&t.selected.length?(openBlock(),createBlock(Transition,{key:0,onAfterLeave:t.resetInputHeight},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(t.tagWrapperKls)},[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.showTagList,T=>(openBlock(),createBlock(a,{key:t.getValueKey(T),closable:!t.selectDisabled&&!T.isDisabled,size:t.collapseTagSize,hit:T.hitState,type:t.tagType,"disable-transitions":"",onClose:k=>t.deleteTag(k,T)},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(t.nsSelect.e("tags-text")),style:normalizeStyle(t.tagTextStyle)},toDisplayString(T.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))),128)),t.selected.length>t.maxCollapseTags?(openBlock(),createBlock(a,{key:0,closable:!1,size:t.collapseTagSize,type:t.tagType,"disable-transitions":""},{default:withCtx(()=>[t.collapseTagsTooltip?(openBlock(),createBlock(i,{key:0,ref:"tagTooltipRef",disabled:t.dropMenuVisible,"fallback-placements":["bottom","top","right","left"],effect:t.effect,placement:"bottom",teleported:t.teleported},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(t.nsSelect.e("tags-text"))},"+ "+toDisplayString(t.selected.length-t.maxCollapseTags),3)]),content:withCtx(()=>[createBaseVNode("div",{class:normalizeClass(t.nsSelect.e("collapse-tags"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.collapseTagList,T=>(openBlock(),createElementBlock("div",{key:t.getValueKey(T),class:normalizeClass(t.nsSelect.e("collapse-tag"))},[createVNode(a,{class:"in-tooltip",closable:!t.selectDisabled&&!T.isDisabled,size:t.collapseTagSize,hit:T.hitState,type:t.tagType,"disable-transitions":"",style:{margin:"2px"},onClose:k=>t.handleDeleteTooltipTag(k,T)},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(t.nsSelect.e("tags-text")),style:normalizeStyle({maxWidth:t.inputWidth-75+"px"})},toDisplayString(T.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"])],2))),128))],2)]),_:1},8,["disabled","effect","teleported"])):(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(t.nsSelect.e("tags-text"))},"+ "+toDisplayString(t.selected.length-t.maxCollapseTags),3))]),_:1},8,["size","type"])):createCommentVNode("v-if",!0)],2)]),_:1},8,["onAfterLeave"])):createCommentVNode("v-if",!0),t.collapseTags?createCommentVNode("v-if",!0):(openBlock(),createBlock(Transition,{key:1,onAfterLeave:t.resetInputHeight},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(t.tagWrapperKls),style:normalizeStyle(t.prefixWidth&&t.selected.length?{marginLeft:`${t.prefixWidth}px`}:"")},[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.selected,T=>(openBlock(),createBlock(a,{key:t.getValueKey(T),closable:!t.selectDisabled&&!T.isDisabled,size:t.collapseTagSize,hit:T.hitState,type:t.tagType,"disable-transitions":"",onClose:k=>t.deleteTag(k,T)},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(t.nsSelect.e("tags-text")),style:normalizeStyle({maxWidth:t.inputWidth-75+"px"})},toDisplayString(T.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))),128))],6)]),_:1},8,["onAfterLeave"])),t.filterable&&!t.selectDisabled?withDirectives((openBlock(),createElementBlock("input",{key:2,ref:"input","onUpdate:modelValue":r[0]||(r[0]=T=>t.query=T),type:"text",class:normalizeClass(t.inputKls),disabled:t.selectDisabled,autocomplete:t.autocomplete,style:normalizeStyle(t.inputStyle),"aria-label":t.ariaLabel,onFocus:r[1]||(r[1]=(...T)=>t.handleFocus&&t.handleFocus(...T)),onBlur:r[2]||(r[2]=(...T)=>t.handleBlur&&t.handleBlur(...T)),onKeyup:r[3]||(r[3]=(...T)=>t.managePlaceholder&&t.managePlaceholder(...T)),onKeydown:[r[4]||(r[4]=(...T)=>t.resetInputState&&t.resetInputState(...T)),r[5]||(r[5]=withKeys(withModifiers(T=>t.navigateOptions("next"),["prevent"]),["down"])),r[6]||(r[6]=withKeys(withModifiers(T=>t.navigateOptions("prev"),["prevent"]),["up"])),r[7]||(r[7]=withKeys((...T)=>t.handleKeydownEscape&&t.handleKeydownEscape(...T),["esc"])),r[8]||(r[8]=withKeys(withModifiers((...T)=>t.selectOption&&t.selectOption(...T),["stop","prevent"]),["enter"])),r[9]||(r[9]=withKeys((...T)=>t.deletePrevTag&&t.deletePrevTag(...T),["delete"])),r[10]||(r[10]=withKeys(T=>t.visible=!1,["tab"]))],onCompositionstart:r[11]||(r[11]=(...T)=>t.handleComposition&&t.handleComposition(...T)),onCompositionupdate:r[12]||(r[12]=(...T)=>t.handleComposition&&t.handleComposition(...T)),onCompositionend:r[13]||(r[13]=(...T)=>t.handleComposition&&t.handleComposition(...T)),onInput:r[14]||(r[14]=(...T)=>t.debouncedQueryChange&&t.debouncedQueryChange(...T))},null,46,_hoisted_1$b)),[[vModelText,t.query]]):createCommentVNode("v-if",!0)],6)):createCommentVNode("v-if",!0),createCommentVNode(" fix: https://github.com/element-plus/element-plus/issues/11415 "),t.isIOS&&!t.multiple&&t.filterable&&t.readonly?(openBlock(),createElementBlock("input",{key:1,ref:"iOSInput",class:normalizeClass(t.iOSInputKls),disabled:t.selectDisabled,type:"text"},null,10,_hoisted_2$a)):createCommentVNode("v-if",!0),createVNode(c,{id:t.id,ref:"reference",modelValue:t.selectedLabel,"onUpdate:modelValue":r[16]||(r[16]=T=>t.selectedLabel=T),type:"text",placeholder:typeof t.currentPlaceholder=="function"?t.currentPlaceholder():t.currentPlaceholder,name:t.name,autocomplete:t.autocomplete,size:t.selectSize,disabled:t.selectDisabled,readonly:t.readonly,"validate-event":!1,class:normalizeClass([t.nsSelect.is("focus",t.visible)]),tabindex:t.multiple&&t.filterable?-1:void 0,label:t.ariaLabel,onFocus:t.handleFocus,onBlur:t.handleBlur,onInput:t.debouncedOnInputChange,onPaste:t.debouncedOnInputChange,onCompositionstart:t.handleComposition,onCompositionupdate:t.handleComposition,onCompositionend:t.handleComposition,onKeydown:[r[17]||(r[17]=withKeys(withModifiers(T=>t.navigateOptions("next"),["stop","prevent"]),["down"])),r[18]||(r[18]=withKeys(withModifiers(T=>t.navigateOptions("prev"),["stop","prevent"]),["up"])),withKeys(withModifiers(t.selectOption,["stop","prevent"]),["enter"]),withKeys(t.handleKeydownEscape,["esc"]),r[19]||(r[19]=withKeys(T=>t.visible=!1,["tab"]))]},createSlots({suffix:withCtx(()=>[t.iconComponent&&!t.showClose?(openBlock(),createBlock(u,{key:0,class:normalizeClass([t.nsSelect.e("caret"),t.nsSelect.e("icon"),t.iconReverse])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.iconComponent)))]),_:1},8,["class"])):createCommentVNode("v-if",!0),t.showClose&&t.clearIcon?(openBlock(),createBlock(u,{key:1,class:normalizeClass([t.nsSelect.e("caret"),t.nsSelect.e("icon")]),onClick:t.handleClearClick},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.clearIcon)))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0)]),_:2},[t.$slots.prefix?{name:"prefix",fn:withCtx(()=>[createBaseVNode("div",_hoisted_3$7,[renderSlot(t.$slots,"prefix")])])}:void 0]),1032,["id","modelValue","placeholder","name","autocomplete","size","disabled","readonly","class","tabindex","label","onFocus","onBlur","onInput","onPaste","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown"])],32)]),content:withCtx(()=>[createVNode(g,null,{default:withCtx(()=>[withDirectives(createVNode(v,{ref:"scrollbar",tag:"ul","wrap-class":t.nsSelect.be("dropdown","wrap"),"view-class":t.nsSelect.be("dropdown","list"),class:normalizeClass(t.scrollbarKls)},{default:withCtx(()=>[t.showNewOption?(openBlock(),createBlock(d,{key:0,value:t.query,created:!0},null,8,["value"])):createCommentVNode("v-if",!0),createVNode(m,{onUpdateOptions:t.onOptionsRendered},{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},8,["onUpdateOptions"])]),_:3},8,["wrap-class","view-class","class"]),[[vShow,t.options.size>0&&!t.loading]]),t.emptyText&&(!t.allowCreate||t.loading||t.allowCreate&&t.options.size===0)?(openBlock(),createElementBlock(Fragment,{key:0},[t.$slots.empty?renderSlot(t.$slots,"empty",{key:0}):(openBlock(),createElementBlock("p",{key:1,class:normalizeClass(t.nsSelect.be("dropdown","empty"))},toDisplayString(t.emptyText),3))],64)):createCommentVNode("v-if",!0)]),_:3})]),_:3},8,["visible","placement","teleported","popper-class","popper-options","effect","transition","persistent","onShow"])],34)),[[b,t.handleClose,t.popperPaneRef]])}var Select=_export_sfc(_sfc_main$f,[["render",_sfc_render$2],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select.vue"]]);const _sfc_main$e=defineComponent({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(t){const r=useNamespace("select"),e=ref(!0),n=getCurrentInstance(),o=ref([]);provide(selectGroupKey,reactive({...toRefs(t)}));const s=inject(selectKey);onMounted(()=>{o.value=a(n.subTree)});const a=u=>{const c=[];return Array.isArray(u.children)&&u.children.forEach(d=>{var m;d.type&&d.type.name==="ElOption"&&d.component&&d.component.proxy?c.push(d.component.proxy):(m=d.children)!=null&&m.length&&c.push(...a(d))}),c},{groupQueryChange:i}=toRaw(s);return watch(i,()=>{e.value=o.value.some(u=>u.visible===!0)},{flush:"post"}),{visible:e,ns:r}}});function _sfc_render$1(t,r,e,n,o,s){return withDirectives((openBlock(),createElementBlock("ul",{class:normalizeClass(t.ns.be("group","wrap"))},[createBaseVNode("li",{class:normalizeClass(t.ns.be("group","title"))},toDisplayString(t.label),3),createBaseVNode("li",null,[createBaseVNode("ul",{class:normalizeClass(t.ns.b("group"))},[renderSlot(t.$slots,"default")],2)])],2)),[[vShow,t.visible]])}var OptionGroup=_export_sfc(_sfc_main$e,[["render",_sfc_render$1],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option-group.vue"]]);const ElSelect=withInstall(Select,{Option,OptionGroup}),ElOption=withNoopInstall(Option);withNoopInstall(OptionGroup);const progressProps=buildProps({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:t=>t>=0&&t<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:definePropType(String),default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:definePropType([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:definePropType(Function),default:t=>`${t}%`}}),_hoisted_1$a=["aria-valuenow"],_hoisted_2$9={viewBox:"0 0 100 100"},_hoisted_3$6=["d","stroke","stroke-linecap","stroke-width"],_hoisted_4$5=["d","stroke","opacity","stroke-linecap","stroke-width"],_hoisted_5$5={key:0},__default__$8=defineComponent({name:"ElProgress"}),_sfc_main$d=defineComponent({...__default__$8,props:progressProps,setup(t){const r=t,e={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},n=useNamespace("progress"),o=computed(()=>({width:`${r.percentage}%`,animationDuration:`${r.duration}s`,backgroundColor:A(r.percentage)})),s=computed(()=>(r.strokeWidth/r.width*100).toFixed(1)),a=computed(()=>["circle","dashboard"].includes(r.type)?Number.parseInt(`${50-Number.parseFloat(s.value)/2}`,10):0),i=computed(()=>{const V=a.value,he=r.type==="dashboard";return`
          M 50 50
          m 0 ${he?"":"-"}${V}
          a ${V} ${V} 0 1 1 0 ${he?"-":""}${V*2}
          a ${V} ${V} 0 1 1 0 ${he?"":"-"}${V*2}
          `}),u=computed(()=>2*Math.PI*a.value),c=computed(()=>r.type==="dashboard"?.75:1),d=computed(()=>`${-1*u.value*(1-c.value)/2}px`),m=computed(()=>({strokeDasharray:`${u.value*c.value}px, ${u.value}px`,strokeDashoffset:d.value})),v=computed(()=>({strokeDasharray:`${u.value*c.value*(r.percentage/100)}px, ${u.value}px`,strokeDashoffset:d.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),g=computed(()=>{let V;return r.color?V=A(r.percentage):V=e[r.status]||e.default,V}),b=computed(()=>r.status==="warning"?warning_filled_default:r.type==="line"?r.status==="success"?circle_check_default:circle_close_default:r.status==="success"?check_default:close_default),T=computed(()=>r.type==="line"?12+r.strokeWidth*.4:r.width*.111111+2),k=computed(()=>r.format(r.percentage));function y(V){const he=100/V.length;return V.map((Ne,_e)=>isString$2(Ne)?{color:Ne,percentage:(_e+1)*he}:Ne).sort((Ne,_e)=>Ne.percentage-_e.percentage)}const A=V=>{var he;const{color:ae}=r;if(isFunction$3(ae))return ae(V);if(isString$2(ae))return ae;{const Ne=y(ae);for(const _e of Ne)if(_e.percentage>V)return _e.color;return(he=Ne[Ne.length-1])==null?void 0:he.color}};return(V,he)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(n).b(),unref(n).m(V.type),unref(n).is(V.status),{[unref(n).m("without-text")]:!V.showText,[unref(n).m("text-inside")]:V.textInside}]),role:"progressbar","aria-valuenow":V.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[V.type==="line"?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(n).b("bar"))},[createBaseVNode("div",{class:normalizeClass(unref(n).be("bar","outer")),style:normalizeStyle({height:`${V.strokeWidth}px`})},[createBaseVNode("div",{class:normalizeClass([unref(n).be("bar","inner"),{[unref(n).bem("bar","inner","indeterminate")]:V.indeterminate},{[unref(n).bem("bar","inner","striped")]:V.striped},{[unref(n).bem("bar","inner","striped-flow")]:V.stripedFlow}]),style:normalizeStyle(unref(o))},[(V.showText||V.$slots.default)&&V.textInside?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(n).be("bar","innerText"))},[renderSlot(V.$slots,"default",{percentage:V.percentage},()=>[createBaseVNode("span",null,toDisplayString(unref(k)),1)])],2)):createCommentVNode("v-if",!0)],6)],6)],2)):(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(n).b("circle")),style:normalizeStyle({height:`${V.width}px`,width:`${V.width}px`})},[(openBlock(),createElementBlock("svg",_hoisted_2$9,[createBaseVNode("path",{class:normalizeClass(unref(n).be("circle","track")),d:unref(i),stroke:`var(${unref(n).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":V.strokeLinecap,"stroke-width":unref(s),fill:"none",style:normalizeStyle(unref(m))},null,14,_hoisted_3$6),createBaseVNode("path",{class:normalizeClass(unref(n).be("circle","path")),d:unref(i),stroke:unref(g),fill:"none",opacity:V.percentage?1:0,"stroke-linecap":V.strokeLinecap,"stroke-width":unref(s),style:normalizeStyle(unref(v))},null,14,_hoisted_4$5)]))],6)),(V.showText||V.$slots.default)&&!V.textInside?(openBlock(),createElementBlock("div",{key:2,class:normalizeClass(unref(n).e("text")),style:normalizeStyle({fontSize:`${unref(T)}px`})},[renderSlot(V.$slots,"default",{percentage:V.percentage},()=>[V.status?(openBlock(),createBlock(unref(ElIcon),{key:1},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(b))))]),_:1})):(openBlock(),createElementBlock("span",_hoisted_5$5,toDisplayString(unref(k)),1))])],6)):createCommentVNode("v-if",!0)],10,_hoisted_1$a))}});var Progress=_export_sfc(_sfc_main$d,[["__file","/home/runner/work/element-plus/element-plus/packages/components/progress/src/progress.vue"]]);const ElProgress=withInstall(Progress),switchProps=buildProps({modelValue:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},size:{type:String,validator:isValidComponentSize},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},inactiveActionIcon:{type:iconPropType},activeActionIcon:{type:iconPropType},activeIcon:{type:iconPropType},inactiveIcon:{type:iconPropType},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},borderColor:{type:String,default:""},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:definePropType(Function)},id:String,tabindex:{type:[String,Number]},value:{type:[Boolean,String,Number],default:!1}}),switchEmits={[UPDATE_MODEL_EVENT]:t=>isBoolean$1(t)||isString$2(t)||isNumber$1(t),[CHANGE_EVENT]:t=>isBoolean$1(t)||isString$2(t)||isNumber$1(t),[INPUT_EVENT]:t=>isBoolean$1(t)||isString$2(t)||isNumber$1(t)},_hoisted_1$9=["onClick"],_hoisted_2$8=["id","aria-checked","aria-disabled","name","true-value","false-value","disabled","tabindex","onKeydown"],_hoisted_3$5=["aria-hidden"],_hoisted_4$4=["aria-hidden"],_hoisted_5$4=["aria-hidden"],COMPONENT_NAME$1="ElSwitch",__default__$7=defineComponent({name:COMPONENT_NAME$1}),_sfc_main$c=defineComponent({...__default__$7,props:switchProps,emits:switchEmits,setup(t,{expose:r,emit:e}){const n=t,o=getCurrentInstance(),{formItem:s}=useFormItem(),a=useFormSize(),i=useNamespace("switch");(Ce=>{Ce.forEach(re=>{useDeprecated({from:re[0],replacement:re[1],scope:COMPONENT_NAME$1,version:"2.3.0",ref:"https://element-plus.org/en-US/component/switch.html#attributes",type:"Attribute"},computed(()=>{var ue;return!!((ue=o.vnode.props)!=null&&ue[re[2]])}))})})([['"value"','"model-value" or "v-model"',"value"],['"active-color"',"CSS var `--el-switch-on-color`","activeColor"],['"inactive-color"',"CSS var `--el-switch-off-color`","inactiveColor"],['"border-color"',"CSS var `--el-switch-border-color`","borderColor"]]);const{inputId:c}=useFormItemInputId(n,{formItemContext:s}),d=useFormDisabled(computed(()=>n.loading)),m=ref(n.modelValue!==!1),v=ref(),g=ref(),b=computed(()=>[i.b(),i.m(a.value),i.is("disabled",d.value),i.is("checked",V.value)]),T=computed(()=>[i.e("label"),i.em("label","left"),i.is("active",!V.value)]),k=computed(()=>[i.e("label"),i.em("label","right"),i.is("active",V.value)]),y=computed(()=>({width:addUnit(n.width)}));watch(()=>n.modelValue,()=>{m.value=!0}),watch(()=>n.value,()=>{m.value=!1});const A=computed(()=>m.value?n.modelValue:n.value),V=computed(()=>A.value===n.activeValue);[n.activeValue,n.inactiveValue].includes(A.value)||(e(UPDATE_MODEL_EVENT,n.inactiveValue),e(CHANGE_EVENT,n.inactiveValue),e(INPUT_EVENT,n.inactiveValue)),watch(V,Ce=>{var re;v.value.checked=Ce,n.validateEvent&&((re=s==null?void 0:s.validate)==null||re.call(s,"change").catch(ue=>void 0))});const he=()=>{const Ce=V.value?n.inactiveValue:n.activeValue;e(UPDATE_MODEL_EVENT,Ce),e(CHANGE_EVENT,Ce),e(INPUT_EVENT,Ce),nextTick(()=>{v.value.checked=V.value})},ae=()=>{if(d.value)return;const{beforeChange:Ce}=n;if(!Ce){he();return}const re=Ce();[isPromise(re),isBoolean$1(re)].includes(!0)||throwError(COMPONENT_NAME$1,"beforeChange must return type `Promise<boolean>` or `boolean`"),isPromise(re)?re.then(ze=>{ze&&he()}).catch(ze=>{}):re&&he()},Ne=computed(()=>i.cssVarBlock({...n.activeColor?{"on-color":n.activeColor}:null,...n.inactiveColor?{"off-color":n.inactiveColor}:null,...n.borderColor?{"border-color":n.borderColor}:null})),_e=()=>{var Ce,re;(re=(Ce=v.value)==null?void 0:Ce.focus)==null||re.call(Ce)};return onMounted(()=>{v.value.checked=V.value}),r({focus:_e,checked:V}),(Ce,re)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(b)),style:normalizeStyle(unref(Ne)),onClick:withModifiers(ae,["prevent"])},[createBaseVNode("input",{id:unref(c),ref_key:"input",ref:v,class:normalizeClass(unref(i).e("input")),type:"checkbox",role:"switch","aria-checked":unref(V),"aria-disabled":unref(d),name:Ce.name,"true-value":Ce.activeValue,"false-value":Ce.inactiveValue,disabled:unref(d),tabindex:Ce.tabindex,onChange:he,onKeydown:withKeys(ae,["enter"])},null,42,_hoisted_2$8),!Ce.inlinePrompt&&(Ce.inactiveIcon||Ce.inactiveText)?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(T))},[Ce.inactiveIcon?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Ce.inactiveIcon)))]),_:1})):createCommentVNode("v-if",!0),!Ce.inactiveIcon&&Ce.inactiveText?(openBlock(),createElementBlock("span",{key:1,"aria-hidden":unref(V)},toDisplayString(Ce.inactiveText),9,_hoisted_3$5)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("span",{ref_key:"core",ref:g,class:normalizeClass(unref(i).e("core")),style:normalizeStyle(unref(y))},[Ce.inlinePrompt?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(i).e("inner"))},[Ce.activeIcon||Ce.inactiveIcon?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(i).is("icon"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(V)?Ce.activeIcon:Ce.inactiveIcon)))]),_:1},8,["class"])):Ce.activeText||Ce.inactiveText?(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(unref(i).is("text")),"aria-hidden":!unref(V)},toDisplayString(unref(V)?Ce.activeText:Ce.inactiveText),11,_hoisted_4$4)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{class:normalizeClass(unref(i).e("action"))},[Ce.loading?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(i).is("loading"))},{default:withCtx(()=>[createVNode(unref(loading_default))]),_:1},8,["class"])):Ce.activeActionIcon&&unref(V)?(openBlock(),createBlock(unref(ElIcon),{key:1},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Ce.activeActionIcon)))]),_:1})):Ce.inactiveActionIcon&&!unref(V)?(openBlock(),createBlock(unref(ElIcon),{key:2},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Ce.inactiveActionIcon)))]),_:1})):createCommentVNode("v-if",!0)],2)],6),!Ce.inlinePrompt&&(Ce.activeIcon||Ce.activeText)?(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(unref(k))},[Ce.activeIcon?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Ce.activeIcon)))]),_:1})):createCommentVNode("v-if",!0),!Ce.activeIcon&&Ce.activeText?(openBlock(),createElementBlock("span",{key:1,"aria-hidden":!unref(V)},toDisplayString(Ce.activeText),9,_hoisted_5$4)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0)],14,_hoisted_1$9))}});var Switch=_export_sfc(_sfc_main$c,[["__file","/home/runner/work/element-plus/element-plus/packages/components/switch/src/switch.vue"]]);const ElSwitch=withInstall(Switch),LEFT_CHECK_CHANGE_EVENT="left-check-change",RIGHT_CHECK_CHANGE_EVENT="right-check-change",transferProps=buildProps({data:{type:definePropType(Array),default:()=>[]},titles:{type:definePropType(Array),default:()=>[]},buttonTexts:{type:definePropType(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:definePropType(Function)},leftDefaultChecked:{type:definePropType(Array),default:()=>[]},rightDefaultChecked:{type:definePropType(Array),default:()=>[]},renderContent:{type:definePropType(Function)},modelValue:{type:definePropType(Array),default:()=>[]},format:{type:definePropType(Object),default:()=>({})},filterable:Boolean,props:{type:definePropType(Object),default:()=>mutable({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),transferCheckedChangeFn=(t,r)=>[t,r].every(isArray$4)||isArray$4(t)&&isNil(r),transferEmits={[CHANGE_EVENT]:(t,r,e)=>[t,e].every(isArray$4)&&["left","right"].includes(r),[UPDATE_MODEL_EVENT]:t=>isArray$4(t),[LEFT_CHECK_CHANGE_EVENT]:transferCheckedChangeFn,[RIGHT_CHECK_CHANGE_EVENT]:transferCheckedChangeFn},CHECKED_CHANGE_EVENT="checked-change",transferPanelProps=buildProps({data:transferProps.data,optionRender:{type:definePropType(Function)},placeholder:String,title:String,filterable:Boolean,format:transferProps.format,filterMethod:transferProps.filterMethod,defaultChecked:transferProps.leftDefaultChecked,props:transferProps.props}),transferPanelEmits={[CHECKED_CHANGE_EVENT]:transferCheckedChangeFn},usePropsAlias=t=>{const r={label:"label",key:"key",disabled:"disabled"};return computed(()=>({...r,...t.props}))},useCheck=(t,r,e)=>{const n=usePropsAlias(t),o=computed(()=>t.data.filter(d=>isFunction$3(t.filterMethod)?t.filterMethod(r.query,d):String(d[n.value.label]||d[n.value.key]).toLowerCase().includes(r.query.toLowerCase()))),s=computed(()=>o.value.filter(d=>!d[n.value.disabled])),a=computed(()=>{const d=r.checked.length,m=t.data.length,{noChecked:v,hasChecked:g}=t.format;return v&&g?d>0?g.replace(/\${checked}/g,d.toString()).replace(/\${total}/g,m.toString()):v.replace(/\${total}/g,m.toString()):`${d}/${m}`}),i=computed(()=>{const d=r.checked.length;return d>0&&d<s.value.length}),u=()=>{const d=s.value.map(m=>m[n.value.key]);r.allChecked=d.length>0&&d.every(m=>r.checked.includes(m))},c=d=>{r.checked=d?s.value.map(m=>m[n.value.key]):[]};return watch(()=>r.checked,(d,m)=>{if(u(),r.checkChangeByUser){const v=d.concat(m).filter(g=>!d.includes(g)||!m.includes(g));e(CHECKED_CHANGE_EVENT,d,v)}else e(CHECKED_CHANGE_EVENT,d),r.checkChangeByUser=!0}),watch(s,()=>{u()}),watch(()=>t.data,()=>{const d=[],m=o.value.map(v=>v[n.value.key]);r.checked.forEach(v=>{m.includes(v)&&d.push(v)}),r.checkChangeByUser=!1,r.checked=d}),watch(()=>t.defaultChecked,(d,m)=>{if(m&&d.length===m.length&&d.every(b=>m.includes(b)))return;const v=[],g=s.value.map(b=>b[n.value.key]);d.forEach(b=>{g.includes(b)&&v.push(b)}),r.checkChangeByUser=!1,r.checked=v},{immediate:!0}),{filteredData:o,checkableData:s,checkedSummary:a,isIndeterminate:i,updateAllChecked:u,handleAllCheckedChange:c}},useCheckedChange=(t,r)=>({onSourceCheckedChange:(o,s)=>{t.leftChecked=o,s&&r(LEFT_CHECK_CHANGE_EVENT,o,s)},onTargetCheckedChange:(o,s)=>{t.rightChecked=o,s&&r(RIGHT_CHECK_CHANGE_EVENT,o,s)}}),useComputedData=t=>{const r=usePropsAlias(t),e=computed(()=>t.data.reduce((s,a)=>(s[a[r.value.key]]=a)&&s,{})),n=computed(()=>t.data.filter(s=>!t.modelValue.includes(s[r.value.key]))),o=computed(()=>t.targetOrder==="original"?t.data.filter(s=>t.modelValue.includes(s[r.value.key])):t.modelValue.reduce((s,a)=>{const i=e.value[a];return i&&s.push(i),s},[]));return{sourceData:n,targetData:o}},useMove=(t,r,e)=>{const n=usePropsAlias(t),o=(i,u,c)=>{e(UPDATE_MODEL_EVENT,i),e(CHANGE_EVENT,i,u,c)};return{addToLeft:()=>{const i=t.modelValue.slice();r.rightChecked.forEach(u=>{const c=i.indexOf(u);c>-1&&i.splice(c,1)}),o(i,"left",r.rightChecked)},addToRight:()=>{let i=t.modelValue.slice();const u=t.data.filter(c=>{const d=c[n.value.key];return r.leftChecked.includes(d)&&!t.modelValue.includes(d)}).map(c=>c[n.value.key]);i=t.targetOrder==="unshift"?u.concat(i):i.concat(u),t.targetOrder==="original"&&(i=t.data.filter(c=>i.includes(c[n.value.key])).map(c=>c[n.value.key])),o(i,"right",r.leftChecked)}}},__default__$6=defineComponent({name:"ElTransferPanel"}),_sfc_main$b=defineComponent({...__default__$6,props:transferPanelProps,emits:transferPanelEmits,setup(t,{expose:r,emit:e}){const n=t,o=useSlots(),s=({option:V})=>V,{t:a}=useLocale(),i=useNamespace("transfer"),u=reactive({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),c=usePropsAlias(n),{filteredData:d,checkedSummary:m,isIndeterminate:v,handleAllCheckedChange:g}=useCheck(n,u,e),b=computed(()=>!isEmpty(u.query)&&isEmpty(d.value)),T=computed(()=>!isEmpty(o.default()[0].children)),{checked:k,allChecked:y,query:A}=toRefs(u);return r({query:A}),(V,he)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(i).b("panel"))},[createBaseVNode("p",{class:normalizeClass(unref(i).be("panel","header"))},[createVNode(unref(ElCheckbox),{modelValue:unref(y),"onUpdate:modelValue":he[0]||(he[0]=ae=>isRef(y)?y.value=ae:null),indeterminate:unref(v),"validate-event":!1,onChange:unref(g)},{default:withCtx(()=>[createTextVNode(toDisplayString(V.title)+" ",1),createBaseVNode("span",null,toDisplayString(unref(m)),1)]),_:1},8,["modelValue","indeterminate","onChange"])],2),createBaseVNode("div",{class:normalizeClass([unref(i).be("panel","body"),unref(i).is("with-footer",unref(T))])},[V.filterable?(openBlock(),createBlock(unref(ElInput),{key:0,modelValue:unref(A),"onUpdate:modelValue":he[1]||(he[1]=ae=>isRef(A)?A.value=ae:null),class:normalizeClass(unref(i).be("panel","filter")),size:"default",placeholder:V.placeholder,"prefix-icon":unref(search_default),clearable:"","validate-event":!1},null,8,["modelValue","class","placeholder","prefix-icon"])):createCommentVNode("v-if",!0),withDirectives(createVNode(unref(ElCheckboxGroup),{modelValue:unref(k),"onUpdate:modelValue":he[2]||(he[2]=ae=>isRef(k)?k.value=ae:null),"validate-event":!1,class:normalizeClass([unref(i).is("filterable",V.filterable),unref(i).be("panel","list")])},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(d),ae=>(openBlock(),createBlock(unref(ElCheckbox),{key:ae[unref(c).key],class:normalizeClass(unref(i).be("panel","item")),label:ae[unref(c).key],disabled:ae[unref(c).disabled],"validate-event":!1},{default:withCtx(()=>{var Ne;return[createVNode(s,{option:(Ne=V.optionRender)==null?void 0:Ne.call(V,ae)},null,8,["option"])]}),_:2},1032,["class","label","disabled"]))),128))]),_:1},8,["modelValue","class"]),[[vShow,!unref(b)&&!unref(isEmpty)(V.data)]]),withDirectives(createBaseVNode("p",{class:normalizeClass(unref(i).be("panel","empty"))},toDisplayString(unref(b)?unref(a)("el.transfer.noMatch"):unref(a)("el.transfer.noData")),3),[[vShow,unref(b)||unref(isEmpty)(V.data)]])],2),unref(T)?(openBlock(),createElementBlock("p",{key:0,class:normalizeClass(unref(i).be("panel","footer"))},[renderSlot(V.$slots,"default")],2)):createCommentVNode("v-if",!0)],2))}});var TransferPanel=_export_sfc(_sfc_main$b,[["__file","/home/runner/work/element-plus/element-plus/packages/components/transfer/src/transfer-panel.vue"]]);const _hoisted_1$8={key:0},_hoisted_2$7={key:0},__default__$5=defineComponent({name:"ElTransfer"}),_sfc_main$a=defineComponent({...__default__$5,props:transferProps,emits:transferEmits,setup(t,{expose:r,emit:e}){const n=t,o=useSlots(),{t:s}=useLocale(),a=useNamespace("transfer"),{formItem:i}=useFormItem(),u=reactive({leftChecked:[],rightChecked:[]}),c=usePropsAlias(n),{sourceData:d,targetData:m}=useComputedData(n),{onSourceCheckedChange:v,onTargetCheckedChange:g}=useCheckedChange(u,e),{addToLeft:b,addToRight:T}=useMove(n,u,e),k=ref(),y=ref(),A=Ce=>{switch(Ce){case"left":k.value.query="";break;case"right":y.value.query="";break}},V=computed(()=>n.buttonTexts.length===2),he=computed(()=>n.titles[0]||s("el.transfer.titles.0")),ae=computed(()=>n.titles[1]||s("el.transfer.titles.1")),Ne=computed(()=>n.filterPlaceholder||s("el.transfer.filterPlaceholder"));watch(()=>n.modelValue,()=>{var Ce;n.validateEvent&&((Ce=i==null?void 0:i.validate)==null||Ce.call(i,"change").catch(re=>void 0))});const _e=computed(()=>Ce=>n.renderContent?n.renderContent(h,Ce):o.default?o.default({option:Ce}):h("span",Ce[c.value.label]||Ce[c.value.key]));return r({clearQuery:A,leftPanel:k,rightPanel:y}),(Ce,re)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(a).b())},[createVNode(TransferPanel,{ref_key:"leftPanel",ref:k,data:unref(d),"option-render":unref(_e),placeholder:unref(Ne),title:unref(he),filterable:Ce.filterable,format:Ce.format,"filter-method":Ce.filterMethod,"default-checked":Ce.leftDefaultChecked,props:n.props,onCheckedChange:unref(v)},{default:withCtx(()=>[renderSlot(Ce.$slots,"left-footer")]),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),createBaseVNode("div",{class:normalizeClass(unref(a).e("buttons"))},[createVNode(unref(ElButton),{type:"primary",class:normalizeClass([unref(a).e("button"),unref(a).is("with-texts",unref(V))]),disabled:unref(isEmpty)(u.rightChecked),onClick:unref(b)},{default:withCtx(()=>[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(arrow_left_default))]),_:1}),unref(isUndefined$1)(Ce.buttonTexts[0])?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("span",_hoisted_1$8,toDisplayString(Ce.buttonTexts[0]),1))]),_:1},8,["class","disabled","onClick"]),createVNode(unref(ElButton),{type:"primary",class:normalizeClass([unref(a).e("button"),unref(a).is("with-texts",unref(V))]),disabled:unref(isEmpty)(u.leftChecked),onClick:unref(T)},{default:withCtx(()=>[unref(isUndefined$1)(Ce.buttonTexts[1])?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("span",_hoisted_2$7,toDisplayString(Ce.buttonTexts[1]),1)),createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(arrow_right_default))]),_:1})]),_:1},8,["class","disabled","onClick"])],2),createVNode(TransferPanel,{ref_key:"rightPanel",ref:y,data:unref(m),"option-render":unref(_e),placeholder:unref(Ne),filterable:Ce.filterable,format:Ce.format,"filter-method":Ce.filterMethod,title:unref(ae),"default-checked":Ce.rightDefaultChecked,props:n.props,onCheckedChange:unref(g)},{default:withCtx(()=>[renderSlot(Ce.$slots,"right-footer")]),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});var Transfer=_export_sfc(_sfc_main$a,[["__file","/home/runner/work/element-plus/element-plus/packages/components/transfer/src/transfer.vue"]]);const ElTransfer=withInstall(Transfer),uploadContextKey=Symbol("uploadContextKey"),SCOPE$1="ElUpload";class UploadAjaxError extends Error{constructor(r,e,n,o){super(r),this.name="UploadAjaxError",this.status=e,this.method=n,this.url=o}}function getError(t,r,e){let n;return e.response?n=`${e.response.error||e.response}`:e.responseText?n=`${e.responseText}`:n=`fail to ${r.method} ${t} ${e.status}`,new UploadAjaxError(n,e.status,r.method,t)}function getBody(t){const r=t.responseText||t.response;if(!r)return r;try{return JSON.parse(r)}catch{return r}}const ajaxUpload=t=>{typeof XMLHttpRequest>"u"&&throwError(SCOPE$1,"XMLHttpRequest is undefined");const r=new XMLHttpRequest,e=t.action;r.upload&&r.upload.addEventListener("progress",s=>{const a=s;a.percent=s.total>0?s.loaded/s.total*100:0,t.onProgress(a)});const n=new FormData;if(t.data)for(const[s,a]of Object.entries(t.data))isArray$4(a)&&a.length?n.append(s,...a):n.append(s,a);n.append(t.filename,t.file,t.file.name),r.addEventListener("error",()=>{t.onError(getError(e,t,r))}),r.addEventListener("load",()=>{if(r.status<200||r.status>=300)return t.onError(getError(e,t,r));t.onSuccess(getBody(r))}),r.open(t.method,e,!0),t.withCredentials&&"withCredentials"in r&&(r.withCredentials=!0);const o=t.headers||{};if(o instanceof Headers)o.forEach((s,a)=>r.setRequestHeader(a,s));else for(const[s,a]of Object.entries(o))isNil(a)||r.setRequestHeader(s,String(a));return r.send(n),r},uploadListTypes=["text","picture","picture-card"];let fileId=1;const genFileId=()=>Date.now()+fileId++,uploadBaseProps=buildProps({action:{type:String,default:"#"},headers:{type:definePropType(Object)},method:{type:String,default:"post"},data:{type:Object,default:()=>mutable({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},type:{type:String,default:"select"},fileList:{type:definePropType(Array),default:()=>mutable([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:uploadListTypes,default:"text"},httpRequest:{type:definePropType(Function),default:ajaxUpload},disabled:Boolean,limit:Number}),uploadProps=buildProps({...uploadBaseProps,beforeUpload:{type:definePropType(Function),default:NOOP},beforeRemove:{type:definePropType(Function)},onRemove:{type:definePropType(Function),default:NOOP},onChange:{type:definePropType(Function),default:NOOP},onPreview:{type:definePropType(Function),default:NOOP},onSuccess:{type:definePropType(Function),default:NOOP},onProgress:{type:definePropType(Function),default:NOOP},onError:{type:definePropType(Function),default:NOOP},onExceed:{type:definePropType(Function),default:NOOP}}),uploadListProps=buildProps({files:{type:definePropType(Array),default:()=>mutable([])},disabled:{type:Boolean,default:!1},handlePreview:{type:definePropType(Function),default:NOOP},listType:{type:String,values:uploadListTypes,default:"text"}}),uploadListEmits={remove:t=>!!t},_hoisted_1$7=["onKeydown"],_hoisted_2$6=["src"],_hoisted_3$4=["onClick"],_hoisted_4$3=["title"],_hoisted_5$3=["onClick"],_hoisted_6$2=["onClick"],__default__$4=defineComponent({name:"ElUploadList"}),_sfc_main$9=defineComponent({...__default__$4,props:uploadListProps,emits:uploadListEmits,setup(t,{emit:r}){const{t:e}=useLocale(),n=useNamespace("upload"),o=useNamespace("icon"),s=useNamespace("list"),a=useFormDisabled(),i=ref(!1),u=c=>{r("remove",c)};return(c,d)=>(openBlock(),createBlock(TransitionGroup,{tag:"ul",class:normalizeClass([unref(n).b("list"),unref(n).bm("list",c.listType),unref(n).is("disabled",unref(a))]),name:unref(s).b()},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(c.files,m=>(openBlock(),createElementBlock("li",{key:m.uid||m.name,class:normalizeClass([unref(n).be("list","item"),unref(n).is(m.status),{focusing:i.value}]),tabindex:"0",onKeydown:withKeys(v=>!unref(a)&&u(m),["delete"]),onFocus:d[0]||(d[0]=v=>i.value=!0),onBlur:d[1]||(d[1]=v=>i.value=!1),onClick:d[2]||(d[2]=v=>i.value=!1)},[renderSlot(c.$slots,"default",{file:m},()=>[c.listType==="picture"||m.status!=="uploading"&&c.listType==="picture-card"?(openBlock(),createElementBlock("img",{key:0,class:normalizeClass(unref(n).be("list","item-thumbnail")),src:m.url,alt:""},null,10,_hoisted_2$6)):createCommentVNode("v-if",!0),m.status==="uploading"||c.listType!=="picture-card"?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(n).be("list","item-info"))},[createBaseVNode("a",{class:normalizeClass(unref(n).be("list","item-name")),onClick:withModifiers(v=>c.handlePreview(m),["prevent"])},[createVNode(unref(ElIcon),{class:normalizeClass(unref(o).m("document"))},{default:withCtx(()=>[createVNode(unref(document_default))]),_:1},8,["class"]),createBaseVNode("span",{class:normalizeClass(unref(n).be("list","item-file-name")),title:m.name},toDisplayString(m.name),11,_hoisted_4$3)],10,_hoisted_3$4),m.status==="uploading"?(openBlock(),createBlock(unref(ElProgress),{key:0,type:c.listType==="picture-card"?"circle":"line","stroke-width":c.listType==="picture-card"?6:2,percentage:Number(m.percentage),style:normalizeStyle(c.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("label",{class:normalizeClass(unref(n).be("list","item-status-label"))},[c.listType==="text"?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass([unref(o).m("upload-success"),unref(o).m("circle-check")])},{default:withCtx(()=>[createVNode(unref(circle_check_default))]),_:1},8,["class"])):["picture-card","picture"].includes(c.listType)?(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass([unref(o).m("upload-success"),unref(o).m("check")])},{default:withCtx(()=>[createVNode(unref(check_default))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],2),unref(a)?createCommentVNode("v-if",!0):(openBlock(),createBlock(unref(ElIcon),{key:2,class:normalizeClass(unref(o).m("close")),onClick:v=>u(m)},{default:withCtx(()=>[createVNode(unref(close_default))]),_:2},1032,["class","onClick"])),createCommentVNode(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),createCommentVNode(" This is a bug which needs to be fixed "),createCommentVNode(" TODO: Fix the incorrect navigation interaction "),unref(a)?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("i",{key:3,class:normalizeClass(unref(o).m("close-tip"))},toDisplayString(unref(e)("el.upload.deleteTip")),3)),c.listType==="picture-card"?(openBlock(),createElementBlock("span",{key:4,class:normalizeClass(unref(n).be("list","item-actions"))},[createBaseVNode("span",{class:normalizeClass(unref(n).be("list","item-preview")),onClick:v=>c.handlePreview(m)},[createVNode(unref(ElIcon),{class:normalizeClass(unref(o).m("zoom-in"))},{default:withCtx(()=>[createVNode(unref(zoom_in_default))]),_:1},8,["class"])],10,_hoisted_5$3),unref(a)?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(n).be("list","item-delete")),onClick:v=>u(m)},[createVNode(unref(ElIcon),{class:normalizeClass(unref(o).m("delete"))},{default:withCtx(()=>[createVNode(unref(delete_default))]),_:1},8,["class"])],10,_hoisted_6$2))],2)):createCommentVNode("v-if",!0)])],42,_hoisted_1$7))),128)),renderSlot(c.$slots,"append")]),_:3},8,["class","name"]))}});var UploadList=_export_sfc(_sfc_main$9,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-list.vue"]]);const uploadDraggerProps=buildProps({disabled:{type:Boolean,default:!1}}),uploadDraggerEmits={file:t=>isArray$4(t)},_hoisted_1$6=["onDrop","onDragover"],COMPONENT_NAME="ElUploadDrag",__default__$3=defineComponent({name:COMPONENT_NAME}),_sfc_main$8=defineComponent({...__default__$3,props:uploadDraggerProps,emits:uploadDraggerEmits,setup(t,{emit:r}){const e=inject(uploadContextKey);e||throwError(COMPONENT_NAME,"usage: <el-upload><el-upload-dragger /></el-upload>");const n=useNamespace("upload"),o=ref(!1),s=useFormDisabled(),a=u=>{if(s.value)return;o.value=!1,u.stopPropagation();const c=Array.from(u.dataTransfer.files),d=e.accept.value;if(!d){r("file",c);return}const m=c.filter(v=>{const{type:g,name:b}=v,T=b.includes(".")?`.${b.split(".").pop()}`:"",k=g.replace(/\/.*$/,"");return d.split(",").map(y=>y.trim()).filter(y=>y).some(y=>y.startsWith(".")?T===y:/\/\*$/.test(y)?k===y.replace(/\/\*$/,""):/^[^/]+\/[^/]+$/.test(y)?g===y:!1)});r("file",m)},i=()=>{s.value||(o.value=!0)};return(u,c)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(n).b("dragger"),unref(n).is("dragover",o.value)]),onDrop:withModifiers(a,["prevent"]),onDragover:withModifiers(i,["prevent"]),onDragleave:c[0]||(c[0]=withModifiers(d=>o.value=!1,["prevent"]))},[renderSlot(u.$slots,"default")],42,_hoisted_1$6))}});var UploadDragger=_export_sfc(_sfc_main$8,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-dragger.vue"]]);const uploadContentProps=buildProps({...uploadBaseProps,beforeUpload:{type:definePropType(Function),default:NOOP},onRemove:{type:definePropType(Function),default:NOOP},onStart:{type:definePropType(Function),default:NOOP},onSuccess:{type:definePropType(Function),default:NOOP},onProgress:{type:definePropType(Function),default:NOOP},onError:{type:definePropType(Function),default:NOOP},onExceed:{type:definePropType(Function),default:NOOP}}),_hoisted_1$5=["onKeydown"],_hoisted_2$5=["name","multiple","accept"],__default__$2=defineComponent({name:"ElUploadContent",inheritAttrs:!1}),_sfc_main$7=defineComponent({...__default__$2,props:uploadContentProps,setup(t,{expose:r}){const e=t,n=useNamespace("upload"),o=useFormDisabled(),s=shallowRef({}),a=shallowRef(),i=b=>{if(b.length===0)return;const{autoUpload:T,limit:k,fileList:y,multiple:A,onStart:V,onExceed:he}=e;if(k&&y.length+b.length>k){he(b,y);return}A||(b=b.slice(0,1));for(const ae of b){const Ne=ae;Ne.uid=genFileId(),V(Ne),T&&u(Ne)}},u=async b=>{if(a.value.value="",!e.beforeUpload)return c(b);let T,k={};try{const A=e.data,V=e.beforeUpload(b);k=isObject$2(e.data)?cloneDeep(e.data):e.data,T=await V,isObject$2(e.data)&&isEqual(A,k)&&(k=cloneDeep(e.data))}catch{T=!1}if(T===!1){e.onRemove(b);return}let y=b;T instanceof Blob&&(T instanceof File?y=T:y=new File([T],b.name,{type:b.type})),c(Object.assign(y,{uid:b.uid}),k)},c=(b,T)=>{const{headers:k,data:y,method:A,withCredentials:V,name:he,action:ae,onProgress:Ne,onSuccess:_e,onError:Ce,httpRequest:re}=e,{uid:ue}=b,ze={headers:k||{},withCredentials:V,file:b,data:T??y,method:A,filename:he,action:ae,onProgress:de=>{Ne(de,b)},onSuccess:de=>{_e(de,b),delete s.value[ue]},onError:de=>{Ce(de,b),delete s.value[ue]}},le=re(ze);s.value[ue]=le,le instanceof Promise&&le.then(ze.onSuccess,ze.onError)},d=b=>{const T=b.target.files;T&&i(Array.from(T))},m=()=>{o.value||(a.value.value="",a.value.click())},v=()=>{m()};return r({abort:b=>{entriesOf(s.value).filter(b?([k])=>String(b.uid)===k:()=>!0).forEach(([k,y])=>{y instanceof XMLHttpRequest&&y.abort(),delete s.value[k]})},upload:u}),(b,T)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(n).b(),unref(n).m(b.listType),unref(n).is("drag",b.drag)]),tabindex:"0",onClick:m,onKeydown:withKeys(withModifiers(v,["self"]),["enter","space"])},[b.drag?(openBlock(),createBlock(UploadDragger,{key:0,disabled:unref(o),onFile:i},{default:withCtx(()=>[renderSlot(b.$slots,"default")]),_:3},8,["disabled"])):renderSlot(b.$slots,"default",{key:1}),createBaseVNode("input",{ref_key:"inputRef",ref:a,class:normalizeClass(unref(n).e("input")),name:b.name,multiple:b.multiple,accept:b.accept,type:"file",onChange:d,onClick:T[0]||(T[0]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_2$5)],42,_hoisted_1$5))}});var UploadContent=_export_sfc(_sfc_main$7,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-content.vue"]]);const SCOPE="ElUpload",revokeObjectURL=t=>{var r;(r=t.url)!=null&&r.startsWith("blob:")&&URL.revokeObjectURL(t.url)},useHandlers=(t,r)=>{const e=useVModel(t,"fileList",void 0,{passive:!0}),n=v=>e.value.find(g=>g.uid===v.uid);function o(v){var g;(g=r.value)==null||g.abort(v)}function s(v=["ready","uploading","success","fail"]){e.value=e.value.filter(g=>!v.includes(g.status))}const a=(v,g)=>{const b=n(g);b&&(console.error(v),b.status="fail",e.value.splice(e.value.indexOf(b),1),t.onError(v,b,e.value),t.onChange(b,e.value))},i=(v,g)=>{const b=n(g);b&&(t.onProgress(v,b,e.value),b.status="uploading",b.percentage=Math.round(v.percent))},u=(v,g)=>{const b=n(g);b&&(b.status="success",b.response=v,t.onSuccess(v,b,e.value),t.onChange(b,e.value))},c=v=>{isNil(v.uid)&&(v.uid=genFileId());const g={name:v.name,percentage:0,status:"ready",size:v.size,raw:v,uid:v.uid};if(t.listType==="picture-card"||t.listType==="picture")try{g.url=URL.createObjectURL(v)}catch(b){b.message,t.onError(b,g,e.value)}e.value=[...e.value,g],t.onChange(g,e.value)},d=async v=>{const g=v instanceof File?n(v):v;g||throwError(SCOPE,"file to be removed not found");const b=T=>{o(T);const k=e.value;k.splice(k.indexOf(T),1),t.onRemove(T,k),revokeObjectURL(T)};t.beforeRemove?await t.beforeRemove(g,e.value)!==!1&&b(g):b(g)};function m(){e.value.filter(({status:v})=>v==="ready").forEach(({raw:v})=>{var g;return v&&((g=r.value)==null?void 0:g.upload(v))})}return watch(()=>t.listType,v=>{v!=="picture-card"&&v!=="picture"||(e.value=e.value.map(g=>{const{raw:b,url:T}=g;if(!T&&b)try{g.url=URL.createObjectURL(b)}catch(k){t.onError(k,g,e.value)}return g}))}),watch(e,v=>{for(const g of v)g.uid||(g.uid=genFileId()),g.status||(g.status="success")},{immediate:!0,deep:!0}),{uploadFiles:e,abort:o,clearFiles:s,handleError:a,handleProgress:i,handleStart:c,handleSuccess:u,handleRemove:d,submit:m}},__default__$1=defineComponent({name:"ElUpload"}),_sfc_main$6=defineComponent({...__default__$1,props:uploadProps,setup(t,{expose:r}){const e=t,n=useFormDisabled(),o=shallowRef(),{abort:s,submit:a,clearFiles:i,uploadFiles:u,handleStart:c,handleError:d,handleRemove:m,handleSuccess:v,handleProgress:g}=useHandlers(e,o),b=computed(()=>e.listType==="picture-card"),T=computed(()=>({...e,fileList:u.value,onStart:c,onProgress:g,onSuccess:v,onError:d,onRemove:m}));return onBeforeUnmount(()=>{u.value.forEach(({url:k})=>{k!=null&&k.startsWith("blob:")&&URL.revokeObjectURL(k)})}),provide(uploadContextKey,{accept:toRef(e,"accept")}),r({abort:s,submit:a,clearFiles:i,handleStart:c,handleRemove:m}),(k,y)=>(openBlock(),createElementBlock("div",null,[unref(b)&&k.showFileList?(openBlock(),createBlock(UploadList,{key:0,disabled:unref(n),"list-type":k.listType,files:unref(u),"handle-preview":k.onPreview,onRemove:unref(m)},createSlots({append:withCtx(()=>[createVNode(UploadContent,mergeProps({ref_key:"uploadRef",ref:o},unref(T)),{default:withCtx(()=>[k.$slots.trigger?renderSlot(k.$slots,"trigger",{key:0}):createCommentVNode("v-if",!0),!k.$slots.trigger&&k.$slots.default?renderSlot(k.$slots,"default",{key:1}):createCommentVNode("v-if",!0)]),_:3},16)]),_:2},[k.$slots.file?{name:"default",fn:withCtx(({file:A})=>[renderSlot(k.$slots,"file",{file:A})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):createCommentVNode("v-if",!0),!unref(b)||unref(b)&&!k.showFileList?(openBlock(),createBlock(UploadContent,mergeProps({key:1,ref_key:"uploadRef",ref:o},unref(T)),{default:withCtx(()=>[k.$slots.trigger?renderSlot(k.$slots,"trigger",{key:0}):createCommentVNode("v-if",!0),!k.$slots.trigger&&k.$slots.default?renderSlot(k.$slots,"default",{key:1}):createCommentVNode("v-if",!0)]),_:3},16)):createCommentVNode("v-if",!0),k.$slots.trigger?renderSlot(k.$slots,"default",{key:2}):createCommentVNode("v-if",!0),renderSlot(k.$slots,"tip"),!unref(b)&&k.showFileList?(openBlock(),createBlock(UploadList,{key:3,disabled:unref(n),"list-type":k.listType,files:unref(u),"handle-preview":k.onPreview,onRemove:unref(m)},createSlots({_:2},[k.$slots.file?{name:"default",fn:withCtx(({file:A})=>[renderSlot(k.$slots,"file",{file:A})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):createCommentVNode("v-if",!0)]))}});var Upload=_export_sfc(_sfc_main$6,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload.vue"]]);const ElUpload=withInstall(Upload),messageTypes=["success","info","warning","error"],messageDefaults=mutable({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:isClient?document.body:void 0}),messageProps=buildProps({customClass:{type:String,default:messageDefaults.customClass},center:{type:Boolean,default:messageDefaults.center},dangerouslyUseHTMLString:{type:Boolean,default:messageDefaults.dangerouslyUseHTMLString},duration:{type:Number,default:messageDefaults.duration},icon:{type:iconPropType,default:messageDefaults.icon},id:{type:String,default:messageDefaults.id},message:{type:definePropType([String,Object,Function]),default:messageDefaults.message},onClose:{type:definePropType(Function),required:!1},showClose:{type:Boolean,default:messageDefaults.showClose},type:{type:String,values:messageTypes,default:messageDefaults.type},offset:{type:Number,default:messageDefaults.offset},zIndex:{type:Number,default:messageDefaults.zIndex},grouping:{type:Boolean,default:messageDefaults.grouping},repeatNum:{type:Number,default:messageDefaults.repeatNum}}),messageEmits={destroy:()=>!0},instances=shallowReactive([]),getInstance=t=>{const r=instances.findIndex(o=>o.id===t),e=instances[r];let n;return r>0&&(n=instances[r-1]),{current:e,prev:n}},getLastOffset=t=>{const{prev:r}=getInstance(t);return r?r.vm.exposed.bottom.value:0},getOffsetOrSpace=(t,r)=>instances.findIndex(n=>n.id===t)>0?20:r,_hoisted_1$4=["id"],_hoisted_2$4=["innerHTML"],__default__=defineComponent({name:"ElMessage"}),_sfc_main$5=defineComponent({...__default__,props:messageProps,emits:messageEmits,setup(t,{expose:r}){const e=t,{Close:n}=TypeComponents,{ns:o,zIndex:s}=useGlobalComponentSettings("message"),{currentZIndex:a,nextZIndex:i}=s,u=ref(),c=ref(!1),d=ref(0);let m;const v=computed(()=>e.type?e.type==="error"?"danger":e.type:"info"),g=computed(()=>{const _e=e.type;return{[o.bm("icon",_e)]:_e&&TypeComponentsMap[_e]}}),b=computed(()=>e.icon||TypeComponentsMap[e.type]||""),T=computed(()=>getLastOffset(e.id)),k=computed(()=>getOffsetOrSpace(e.id,e.offset)+T.value),y=computed(()=>d.value+k.value),A=computed(()=>({top:`${k.value}px`,zIndex:a.value}));function V(){e.duration!==0&&({stop:m}=useTimeoutFn(()=>{ae()},e.duration))}function he(){m==null||m()}function ae(){c.value=!1}function Ne({code:_e}){_e===EVENT_CODE.esc&&ae()}return onMounted(()=>{V(),i(),c.value=!0}),watch(()=>e.repeatNum,()=>{he(),V()}),useEventListener(document,"keydown",Ne),useResizeObserver(u,()=>{d.value=u.value.getBoundingClientRect().height}),r({visible:c,bottom:y,close:ae}),(_e,Ce)=>(openBlock(),createBlock(Transition,{name:unref(o).b("fade"),onBeforeLeave:_e.onClose,onAfterLeave:Ce[0]||(Ce[0]=re=>_e.$emit("destroy")),persisted:""},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{id:_e.id,ref_key:"messageRef",ref:u,class:normalizeClass([unref(o).b(),{[unref(o).m(_e.type)]:_e.type&&!_e.icon},unref(o).is("center",_e.center),unref(o).is("closable",_e.showClose),_e.customClass]),style:normalizeStyle(unref(A)),role:"alert",onMouseenter:he,onMouseleave:V},[_e.repeatNum>1?(openBlock(),createBlock(unref(ElBadge),{key:0,value:_e.repeatNum,type:unref(v),class:normalizeClass(unref(o).e("badge"))},null,8,["value","type","class"])):createCommentVNode("v-if",!0),unref(b)?(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass([unref(o).e("icon"),unref(g)])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(b))))]),_:1},8,["class"])):createCommentVNode("v-if",!0),renderSlot(_e.$slots,"default",{},()=>[_e.dangerouslyUseHTMLString?(openBlock(),createElementBlock(Fragment,{key:1},[createCommentVNode(" Caution here, message could've been compromised, never use user's input as message "),createBaseVNode("p",{class:normalizeClass(unref(o).e("content")),innerHTML:_e.message},null,10,_hoisted_2$4)],2112)):(openBlock(),createElementBlock("p",{key:0,class:normalizeClass(unref(o).e("content"))},toDisplayString(_e.message),3))]),_e.showClose?(openBlock(),createBlock(unref(ElIcon),{key:2,class:normalizeClass(unref(o).e("closeBtn")),onClick:withModifiers(ae,["stop"])},{default:withCtx(()=>[createVNode(unref(n))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0)],46,_hoisted_1$4),[[vShow,c.value]])]),_:3},8,["name","onBeforeLeave"]))}});var MessageConstructor=_export_sfc(_sfc_main$5,[["__file","/home/runner/work/element-plus/element-plus/packages/components/message/src/message.vue"]]);let seed=1;const normalizeOptions=t=>{const r=!t||isString$2(t)||isVNode(t)||isFunction$3(t)?{message:t}:t,e={...messageDefaults,...r};if(!e.appendTo)e.appendTo=document.body;else if(isString$2(e.appendTo)){let n=document.querySelector(e.appendTo);isElement(n)||(n=document.body),e.appendTo=n}return e},closeMessage=t=>{const r=instances.indexOf(t);if(r===-1)return;instances.splice(r,1);const{handler:e}=t;e.close()},createMessage=({appendTo:t,...r},e)=>{const n=`message_${seed++}`,o=r.onClose,s=document.createElement("div"),a={...r,id:n,onClose:()=>{o==null||o(),closeMessage(d)},onDestroy:()=>{render(null,s)}},i=createVNode(MessageConstructor,a,isFunction$3(a.message)||isVNode(a.message)?{default:isFunction$3(a.message)?a.message:()=>a.message}:null);i.appContext=e||message._context,render(i,s),t.appendChild(s.firstElementChild);const u=i.component,d={id:n,vnode:i,vm:u,handler:{close:()=>{u.exposed.visible.value=!1}},props:i.component.props};return d},message=(t={},r)=>{if(!isClient)return{close:()=>{}};if(isNumber$1(messageConfig.max)&&instances.length>=messageConfig.max)return{close:()=>{}};const e=normalizeOptions(t);if(e.grouping&&instances.length){const o=instances.find(({vnode:s})=>{var a;return((a=s.props)==null?void 0:a.message)===e.message});if(o)return o.props.repeatNum+=1,o.props.type=e.type,o.handler}const n=createMessage(e,r);return instances.push(n),n.handler};messageTypes.forEach(t=>{message[t]=(r={},e)=>{const n=normalizeOptions(r);return message({...n,type:t},e)}});function closeAll(t){for(const r of instances)(!t||t===r.props.type)&&r.handler.close()}message.closeAll=closeAll;message._context=null;const ElMessage=withInstallFunction(message,"$message"),_sfc_main$4=defineComponent({name:"ElMessageBox",directives:{TrapFocus},components:{ElButton,ElFocusTrap,ElInput,ElOverlay,ElIcon,...TypeComponents},inheritAttrs:!1,props:{buttonSize:{type:String,validator:isValidComponentSize},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(t,{emit:r}){const{locale:e,zIndex:n,ns:o,size:s}=useGlobalComponentSettings("message-box",computed(()=>t.buttonSize)),{t:a}=e,{nextZIndex:i}=n,u=ref(!1),c=reactive({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:i()}),d=computed(()=>{const ie=c.type;return{[o.bm("icon",ie)]:ie&&TypeComponentsMap[ie]}}),m=useId(),v=useId(),g=computed(()=>c.icon||TypeComponentsMap[c.type]||""),b=computed(()=>!!c.message),T=ref(),k=ref(),y=ref(),A=ref(),V=ref(),he=computed(()=>c.confirmButtonClass);watch(()=>c.inputValue,async ie=>{await nextTick(),t.boxType==="prompt"&&ie!==null&&ze()},{immediate:!0}),watch(()=>u.value,ie=>{var Ve,Ue;ie&&(t.boxType!=="prompt"&&(c.autofocus?y.value=(Ue=(Ve=V.value)==null?void 0:Ve.$el)!=null?Ue:T.value:y.value=T.value),c.zIndex=i()),t.boxType==="prompt"&&(ie?nextTick().then(()=>{var Dt;A.value&&A.value.$el&&(c.autofocus?y.value=(Dt=le())!=null?Dt:T.value:y.value=T.value)}):(c.editorErrorMessage="",c.validateError=!1))});const ae=computed(()=>t.draggable);useDraggable(T,k,ae),onMounted(async()=>{await nextTick(),t.closeOnHashChange&&window.addEventListener("hashchange",Ne)}),onBeforeUnmount(()=>{t.closeOnHashChange&&window.removeEventListener("hashchange",Ne)});function Ne(){u.value&&(u.value=!1,nextTick(()=>{c.action&&r("action",c.action)}))}const _e=()=>{t.closeOnClickModal&&ue(c.distinguishCancelAndClose?"close":"cancel")},Ce=useSameTarget(_e),re=ie=>{if(c.inputType!=="textarea")return ie.preventDefault(),ue("confirm")},ue=ie=>{var Ve;t.boxType==="prompt"&&ie==="confirm"&&!ze()||(c.action=ie,c.beforeClose?(Ve=c.beforeClose)==null||Ve.call(c,ie,c,Ne):Ne())},ze=()=>{if(t.boxType==="prompt"){const ie=c.inputPattern;if(ie&&!ie.test(c.inputValue||""))return c.editorErrorMessage=c.inputErrorMessage||a("el.messagebox.error"),c.validateError=!0,!1;const Ve=c.inputValidator;if(typeof Ve=="function"){const Ue=Ve(c.inputValue);if(Ue===!1)return c.editorErrorMessage=c.inputErrorMessage||a("el.messagebox.error"),c.validateError=!0,!1;if(typeof Ue=="string")return c.editorErrorMessage=Ue,c.validateError=!0,!1}}return c.editorErrorMessage="",c.validateError=!1,!0},le=()=>{const ie=A.value.$refs;return ie.input||ie.textarea},de=()=>{ue("close")},Ie=()=>{t.closeOnPressEscape&&de()};return t.lockScroll&&useLockscreen(u),{...toRefs(c),ns:o,overlayEvent:Ce,visible:u,hasMessage:b,typeClass:d,contentId:m,inputId:v,btnSize:s,iconComponent:g,confirmButtonClasses:he,rootRef:T,focusStartRef:y,headerRef:k,inputRef:A,confirmRef:V,doClose:Ne,handleClose:de,onCloseRequested:Ie,handleWrapperClick:_e,handleInputEnter:re,handleAction:ue,t:a}}}),_hoisted_1$3=["aria-label","aria-describedby"],_hoisted_2$3=["aria-label"],_hoisted_3$3=["id"];function _sfc_render(t,r,e,n,o,s){const a=resolveComponent("el-icon"),i=resolveComponent("close"),u=resolveComponent("el-input"),c=resolveComponent("el-button"),d=resolveComponent("el-focus-trap"),m=resolveComponent("el-overlay");return openBlock(),createBlock(Transition,{name:"fade-in-linear",onAfterLeave:r[11]||(r[11]=v=>t.$emit("vanish")),persisted:""},{default:withCtx(()=>[withDirectives(createVNode(m,{"z-index":t.zIndex,"overlay-class":[t.ns.is("message-box"),t.modalClass],mask:t.modal},{default:withCtx(()=>[createBaseVNode("div",{role:"dialog","aria-label":t.title,"aria-modal":"true","aria-describedby":t.showInput?void 0:t.contentId,class:normalizeClass(`${t.ns.namespace.value}-overlay-message-box`),onClick:r[8]||(r[8]=(...v)=>t.overlayEvent.onClick&&t.overlayEvent.onClick(...v)),onMousedown:r[9]||(r[9]=(...v)=>t.overlayEvent.onMousedown&&t.overlayEvent.onMousedown(...v)),onMouseup:r[10]||(r[10]=(...v)=>t.overlayEvent.onMouseup&&t.overlayEvent.onMouseup(...v))},[createVNode(d,{loop:"",trapped:t.visible,"focus-trap-el":t.rootRef,"focus-start-el":t.focusStartRef,onReleaseRequested:t.onCloseRequested},{default:withCtx(()=>[createBaseVNode("div",{ref:"rootRef",class:normalizeClass([t.ns.b(),t.customClass,t.ns.is("draggable",t.draggable),{[t.ns.m("center")]:t.center}]),style:normalizeStyle(t.customStyle),tabindex:"-1",onClick:r[7]||(r[7]=withModifiers(()=>{},["stop"]))},[t.title!==null&&t.title!==void 0?(openBlock(),createElementBlock("div",{key:0,ref:"headerRef",class:normalizeClass(t.ns.e("header"))},[createBaseVNode("div",{class:normalizeClass(t.ns.e("title"))},[t.iconComponent&&t.center?(openBlock(),createBlock(a,{key:0,class:normalizeClass([t.ns.e("status"),t.typeClass])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.iconComponent)))]),_:1},8,["class"])):createCommentVNode("v-if",!0),createBaseVNode("span",null,toDisplayString(t.title),1)],2),t.showClose?(openBlock(),createElementBlock("button",{key:0,type:"button",class:normalizeClass(t.ns.e("headerbtn")),"aria-label":t.t("el.messagebox.close"),onClick:r[0]||(r[0]=v=>t.handleAction(t.distinguishCancelAndClose?"close":"cancel")),onKeydown:r[1]||(r[1]=withKeys(withModifiers(v=>t.handleAction(t.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"]))},[createVNode(a,{class:normalizeClass(t.ns.e("close"))},{default:withCtx(()=>[createVNode(i)]),_:1},8,["class"])],42,_hoisted_2$3)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{id:t.contentId,class:normalizeClass(t.ns.e("content"))},[createBaseVNode("div",{class:normalizeClass(t.ns.e("container"))},[t.iconComponent&&!t.center&&t.hasMessage?(openBlock(),createBlock(a,{key:0,class:normalizeClass([t.ns.e("status"),t.typeClass])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.iconComponent)))]),_:1},8,["class"])):createCommentVNode("v-if",!0),t.hasMessage?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(t.ns.e("message"))},[renderSlot(t.$slots,"default",{},()=>[t.dangerouslyUseHTMLString?(openBlock(),createBlock(resolveDynamicComponent(t.showInput?"label":"p"),{key:1,for:t.showInput?t.inputId:void 0,innerHTML:t.message},null,8,["for","innerHTML"])):(openBlock(),createBlock(resolveDynamicComponent(t.showInput?"label":"p"),{key:0,for:t.showInput?t.inputId:void 0},{default:withCtx(()=>[createTextVNode(toDisplayString(t.dangerouslyUseHTMLString?"":t.message),1)]),_:1},8,["for"]))])],2)):createCommentVNode("v-if",!0)],2),withDirectives(createBaseVNode("div",{class:normalizeClass(t.ns.e("input"))},[createVNode(u,{id:t.inputId,ref:"inputRef",modelValue:t.inputValue,"onUpdate:modelValue":r[2]||(r[2]=v=>t.inputValue=v),type:t.inputType,placeholder:t.inputPlaceholder,"aria-invalid":t.validateError,class:normalizeClass({invalid:t.validateError}),onKeydown:withKeys(t.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),createBaseVNode("div",{class:normalizeClass(t.ns.e("errormsg")),style:normalizeStyle({visibility:t.editorErrorMessage?"visible":"hidden"})},toDisplayString(t.editorErrorMessage),7)],2),[[vShow,t.showInput]])],10,_hoisted_3$3),createBaseVNode("div",{class:normalizeClass(t.ns.e("btns"))},[t.showCancelButton?(openBlock(),createBlock(c,{key:0,loading:t.cancelButtonLoading,class:normalizeClass([t.cancelButtonClass]),round:t.roundButton,size:t.btnSize,onClick:r[3]||(r[3]=v=>t.handleAction("cancel")),onKeydown:r[4]||(r[4]=withKeys(withModifiers(v=>t.handleAction("cancel"),["prevent"]),["enter"]))},{default:withCtx(()=>[createTextVNode(toDisplayString(t.cancelButtonText||t.t("el.messagebox.cancel")),1)]),_:1},8,["loading","class","round","size"])):createCommentVNode("v-if",!0),withDirectives(createVNode(c,{ref:"confirmRef",type:"primary",loading:t.confirmButtonLoading,class:normalizeClass([t.confirmButtonClasses]),round:t.roundButton,disabled:t.confirmButtonDisabled,size:t.btnSize,onClick:r[5]||(r[5]=v=>t.handleAction("confirm")),onKeydown:r[6]||(r[6]=withKeys(withModifiers(v=>t.handleAction("confirm"),["prevent"]),["enter"]))},{default:withCtx(()=>[createTextVNode(toDisplayString(t.confirmButtonText||t.t("el.messagebox.confirm")),1)]),_:1},8,["loading","class","round","disabled","size"]),[[vShow,t.showConfirmButton]])],2)],6)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,_hoisted_1$3)]),_:3},8,["z-index","overlay-class","mask"]),[[vShow,t.visible]])]),_:3})}var MessageBoxConstructor=_export_sfc(_sfc_main$4,[["render",_sfc_render],["__file","/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue"]]);const messageInstance=new Map,getAppendToElement=t=>{let r=document.body;return t.appendTo&&(isString$2(t.appendTo)&&(r=document.querySelector(t.appendTo)),isElement(t.appendTo)&&(r=t.appendTo),isElement(r)||(r=document.body)),r},initInstance=(t,r,e=null)=>{const n=createVNode(MessageBoxConstructor,t,isFunction$3(t.message)||isVNode(t.message)?{default:isFunction$3(t.message)?t.message:()=>t.message}:null);return n.appContext=e,render(n,r),getAppendToElement(t).appendChild(r.firstElementChild),n.component},genContainer=()=>document.createElement("div"),showMessage=(t,r)=>{const e=genContainer();t.onVanish=()=>{render(null,e),messageInstance.delete(o)},t.onAction=s=>{const a=messageInstance.get(o);let i;t.showInput?i={value:o.inputValue,action:s}:i=s,t.callback?t.callback(i,n.proxy):s==="cancel"||s==="close"?t.distinguishCancelAndClose&&s!=="cancel"?a.reject("close"):a.reject("cancel"):a.resolve(i)};const n=initInstance(t,e,r),o=n.proxy;for(const s in t)hasOwn(t,s)&&!hasOwn(o.$props,s)&&(o[s]=t[s]);return o.visible=!0,o};function MessageBox(t,r=null){if(!isClient)return Promise.reject();let e;return isString$2(t)||isVNode(t)?t={message:t}:e=t.callback,new Promise((n,o)=>{const s=showMessage(t,r??MessageBox._context);messageInstance.set(s,{options:t,callback:e,resolve:n,reject:o})})}const MESSAGE_BOX_VARIANTS=["alert","confirm","prompt"],MESSAGE_BOX_DEFAULT_OPTS={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};MESSAGE_BOX_VARIANTS.forEach(t=>{MessageBox[t]=messageBoxFactory(t)});function messageBoxFactory(t){return(r,e,n,o)=>{let s="";return isObject$2(e)?(n=e,s=""):isUndefined$1(e)?s="":s=e,MessageBox(Object.assign({title:s,message:r,type:"",...MESSAGE_BOX_DEFAULT_OPTS[t]},n,{boxType:t}),o)}}MessageBox.close=()=>{messageInstance.forEach((t,r)=>{r.doClose()}),messageInstance.clear()};MessageBox._context=null;const _MessageBox=MessageBox;_MessageBox.install=t=>{_MessageBox._context=t._context,t.config.globalProperties.$msgbox=_MessageBox,t.config.globalProperties.$messageBox=_MessageBox,t.config.globalProperties.$alert=_MessageBox.alert,t.config.globalProperties.$confirm=_MessageBox.confirm,t.config.globalProperties.$prompt=_MessageBox.prompt};const ElMessageBox=_MessageBox,base="",elContainer="",elAside="",elFooter="",elHeader="",elMain="",elRow="",elCol="",elImage="",elImageViewer="",elForm="",elFormItem="",elButton="",elButtonGroup="",elPopper="",elScrollbar="",elDropdown="",elDropdownMenu="",elDropdownItem="";function bind(t,r){return function(){return t.apply(r,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(t=>r=>{const e=toString.call(r);return t[e]||(t[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=t=>(t=t.toLowerCase(),r=>kindOf(r)===t),typeOfTest=t=>r=>typeof r===t,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(t){return t!==null&&!isUndefined(t)&&t.constructor!==null&&!isUndefined(t.constructor)&&isFunction(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(t){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(t):r=t&&t.buffer&&isArrayBuffer(t.buffer),r}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=t=>t!==null&&typeof t=="object",isBoolean=t=>t===!0||t===!1,isPlainObject=t=>{if(kindOf(t)!=="object")return!1;const r=getPrototypeOf(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=t=>isObject(t)&&isFunction(t.pipe),isFormData=t=>{let r;return t&&(typeof FormData=="function"&&t instanceof FormData||isFunction(t.append)&&((r=kindOf(t))==="formdata"||r==="object"&&isFunction(t.toString)&&t.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),trim=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(t,r,{allOwnKeys:e=!1}={}){if(t===null||typeof t>"u")return;let n,o;if(typeof t!="object"&&(t=[t]),isArray(t))for(n=0,o=t.length;n<o;n++)r.call(null,t[n],n,t);else{const s=e?Object.getOwnPropertyNames(t):Object.keys(t),a=s.length;let i;for(n=0;n<a;n++)i=s[n],r.call(null,t[i],i,t)}}function findKey(t,r){r=r.toLowerCase();const e=Object.keys(t);let n=e.length,o;for(;n-- >0;)if(o=e[n],r===o.toLowerCase())return o;return null}const _global=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),isContextDefined=t=>!isUndefined(t)&&t!==_global;function merge(){const{caseless:t}=isContextDefined(this)&&this||{},r={},e=(n,o)=>{const s=t&&findKey(r,o)||o;isPlainObject(r[s])&&isPlainObject(n)?r[s]=merge(r[s],n):isPlainObject(n)?r[s]=merge({},n):isArray(n)?r[s]=n.slice():r[s]=n};for(let n=0,o=arguments.length;n<o;n++)arguments[n]&&forEach(arguments[n],e);return r}const extend=(t,r,e,{allOwnKeys:n}={})=>(forEach(r,(o,s)=>{e&&isFunction(o)?t[s]=bind(o,e):t[s]=o},{allOwnKeys:n}),t),stripBOM=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),inherits=(t,r,e,n)=>{t.prototype=Object.create(r.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:r.prototype}),e&&Object.assign(t.prototype,e)},toFlatObject=(t,r,e,n)=>{let o,s,a;const i={};if(r=r||{},t==null)return r;do{for(o=Object.getOwnPropertyNames(t),s=o.length;s-- >0;)a=o[s],(!n||n(a,t,r))&&!i[a]&&(r[a]=t[a],i[a]=!0);t=e!==!1&&getPrototypeOf(t)}while(t&&(!e||e(t,r))&&t!==Object.prototype);return r},endsWith=(t,r,e)=>{t=String(t),(e===void 0||e>t.length)&&(e=t.length),e-=r.length;const n=t.indexOf(r,e);return n!==-1&&n===e},toArray=t=>{if(!t)return null;if(isArray(t))return t;let r=t.length;if(!isNumber(r))return null;const e=new Array(r);for(;r-- >0;)e[r]=t[r];return e},isTypedArray=(t=>r=>t&&r instanceof t)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(t,r)=>{const n=(t&&t[Symbol.iterator]).call(t);let o;for(;(o=n.next())&&!o.done;){const s=o.value;r.call(t,s[0],s[1])}},matchAll=(t,r)=>{let e;const n=[];for(;(e=t.exec(r))!==null;)n.push(e);return n},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,n,o){return n.toUpperCase()+o}),hasOwnProperty=(({hasOwnProperty:t})=>(r,e)=>t.call(r,e))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(t,r)=>{const e=Object.getOwnPropertyDescriptors(t),n={};forEach(e,(o,s)=>{let a;(a=r(o,s,t))!==!1&&(n[s]=a||o)}),Object.defineProperties(t,n)},freezeMethods=t=>{reduceDescriptors(t,(r,e)=>{if(isFunction(t)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const n=t[e];if(isFunction(n)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},toObjectSet=(t,r)=>{const e={},n=o=>{o.forEach(s=>{e[s]=!0})};return isArray(t)?n(t):n(String(t).split(r)),e},noop=()=>{},toFiniteNumber=(t,r)=>(t=+t,Number.isFinite(t)?t:r),ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(t=16,r=ALPHABET.ALPHA_DIGIT)=>{let e="";const{length:n}=r;for(;t--;)e+=r[Math.random()*n|0];return e};function isSpecCompliantForm(t){return!!(t&&isFunction(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const toJSONObject=t=>{const r=new Array(10),e=(n,o)=>{if(isObject(n)){if(r.indexOf(n)>=0)return;if(!("toJSON"in n)){r[o]=n;const s=isArray(n)?[]:{};return forEach(n,(a,i)=>{const u=e(a,o+1);!isUndefined(u)&&(s[i]=u)}),r[o]=void 0,s}}return n};return e(t,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=t=>t&&(isObject(t)||isFunction(t))&&isFunction(t.then)&&isFunction(t.catch),utils={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable};function AxiosError(t,r,e,n,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",r&&(this.code=r),e&&(this.config=e),n&&(this.request=n),o&&(this.response=o)}utils.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{descriptors[t]={value:t}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(t,r,e,n,o,s)=>{const a=Object.create(prototype$1);return utils.toFlatObject(t,a,function(u){return u!==Error.prototype},i=>i!=="isAxiosError"),AxiosError.call(a,t.message,r,e,n,o),a.cause=t,a.name=t.name,s&&Object.assign(a,s),a};const httpAdapter=null;function isVisitable(t){return utils.isPlainObject(t)||utils.isArray(t)}function removeBrackets(t){return utils.endsWith(t,"[]")?t.slice(0,-2):t}function renderKey(t,r,e){return t?t.concat(r).map(function(o,s){return o=removeBrackets(o),!e&&s?"["+o+"]":o}).join(e?".":""):r}function isFlatArray(t){return utils.isArray(t)&&!t.some(isVisitable)}const predicates=utils.toFlatObject(utils,{},null,function(r){return/^is[A-Z]/.test(r)});function toFormData(t,r,e){if(!utils.isObject(t))throw new TypeError("target must be an object");r=r||new FormData,e=utils.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(T,k){return!utils.isUndefined(k[T])});const n=e.metaTokens,o=e.visitor||d,s=e.dots,a=e.indexes,u=(e.Blob||typeof Blob<"u"&&Blob)&&utils.isSpecCompliantForm(r);if(!utils.isFunction(o))throw new TypeError("visitor must be a function");function c(b){if(b===null)return"";if(utils.isDate(b))return b.toISOString();if(!u&&utils.isBlob(b))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils.isArrayBuffer(b)||utils.isTypedArray(b)?u&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function d(b,T,k){let y=b;if(b&&!k&&typeof b=="object"){if(utils.endsWith(T,"{}"))T=n?T:T.slice(0,-2),b=JSON.stringify(b);else if(utils.isArray(b)&&isFlatArray(b)||(utils.isFileList(b)||utils.endsWith(T,"[]"))&&(y=utils.toArray(b)))return T=removeBrackets(T),y.forEach(function(V,he){!(utils.isUndefined(V)||V===null)&&r.append(a===!0?renderKey([T],he,s):a===null?T:T+"[]",c(V))}),!1}return isVisitable(b)?!0:(r.append(renderKey(k,T,s),c(b)),!1)}const m=[],v=Object.assign(predicates,{defaultVisitor:d,convertValue:c,isVisitable});function g(b,T){if(!utils.isUndefined(b)){if(m.indexOf(b)!==-1)throw Error("Circular reference detected in "+T.join("."));m.push(b),utils.forEach(b,function(y,A){(!(utils.isUndefined(y)||y===null)&&o.call(r,y,utils.isString(A)?A.trim():A,T,v))===!0&&g(y,T?T.concat(A):[A])}),m.pop()}}if(!utils.isObject(t))throw new TypeError("data must be an object");return g(t),r}function encode$1(t){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return r[n]})}function AxiosURLSearchParams(t,r){this._pairs=[],t&&toFormData(t,this,r)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(r,e){this._pairs.push([r,e])};prototype.toString=function(r){const e=r?function(n){return r.call(this,n,encode$1)}:encode$1;return this._pairs.map(function(o){return e(o[0])+"="+e(o[1])},"").join("&")};function encode(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(t,r,e){if(!r)return t;const n=e&&e.encode||encode,o=e&&e.serialize;let s;if(o?s=o(r,e):s=utils.isURLSearchParams(r)?r.toString():new AxiosURLSearchParams(r,e).toString(n),s){const a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class InterceptorManager{constructor(){this.handlers=[]}use(r,e,n){return this.handlers.push({fulfilled:r,rejected:e,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){utils.forEach(this.handlers,function(n){n!==null&&r(n)})}}const InterceptorManager$1=InterceptorManager,transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,isStandardBrowserEnv=(()=>{let t;return typeof navigator<"u"&&((t=navigator.product)==="ReactNative"||t==="NativeScript"||t==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),isStandardBrowserWebWorkerEnv=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),platform={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},isStandardBrowserEnv,isStandardBrowserWebWorkerEnv,protocols:["http","https","file","blob","url","data"]};function toURLEncodedForm(t,r){return toFormData(t,new platform.classes.URLSearchParams,Object.assign({visitor:function(e,n,o,s){return platform.isNode&&utils.isBuffer(e)?(this.append(n,e.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},r))}function parsePropPath(t){return utils.matchAll(/\w+|\[(\w*)]/g,t).map(r=>r[0]==="[]"?"":r[1]||r[0])}function arrayToObject(t){const r={},e=Object.keys(t);let n;const o=e.length;let s;for(n=0;n<o;n++)s=e[n],r[s]=t[s];return r}function formDataToJSON(t){function r(e,n,o,s){let a=e[s++];const i=Number.isFinite(+a),u=s>=e.length;return a=!a&&utils.isArray(o)?o.length:a,u?(utils.hasOwnProp(o,a)?o[a]=[o[a],n]:o[a]=n,!i):((!o[a]||!utils.isObject(o[a]))&&(o[a]=[]),r(e,n,o[a],s)&&utils.isArray(o[a])&&(o[a]=arrayToObject(o[a])),!i)}if(utils.isFormData(t)&&utils.isFunction(t.entries)){const e={};return utils.forEachEntry(t,(n,o)=>{r(parsePropPath(n),o,e,0)}),e}return null}function stringifySafely(t,r,e){if(utils.isString(t))try{return(r||JSON.parse)(t),utils.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(e||JSON.stringify)(t)}const defaults={transitional:transitionalDefaults,adapter:platform.isNode?"http":"xhr",transformRequest:[function(r,e){const n=e.getContentType()||"",o=n.indexOf("application/json")>-1,s=utils.isObject(r);if(s&&utils.isHTMLForm(r)&&(r=new FormData(r)),utils.isFormData(r))return o&&o?JSON.stringify(formDataToJSON(r)):r;if(utils.isArrayBuffer(r)||utils.isBuffer(r)||utils.isStream(r)||utils.isFile(r)||utils.isBlob(r))return r;if(utils.isArrayBufferView(r))return r.buffer;if(utils.isURLSearchParams(r))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let i;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(r,this.formSerializer).toString();if((i=utils.isFileList(r))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return toFormData(i?{"files[]":r}:r,u&&new u,this.formSerializer)}}return s||o?(e.setContentType("application/json",!1),stringifySafely(r)):r}],transformResponse:[function(r){const e=this.transitional||defaults.transitional,n=e&&e.forcedJSONParsing,o=this.responseType==="json";if(r&&utils.isString(r)&&(n&&!this.responseType||o)){const a=!(e&&e.silentJSONParsing)&&o;try{return JSON.parse(r)}catch(i){if(a)throw i.name==="SyntaxError"?AxiosError.from(i,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):i}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils.forEach(["delete","get","head","post","put","patch"],t=>{defaults.headers[t]={}});const defaults$1=defaults,ignoreDuplicateOf=utils.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=t=>{const r={};let e,n,o;return t&&t.split(`
`).forEach(function(a){o=a.indexOf(":"),e=a.substring(0,o).trim().toLowerCase(),n=a.substring(o+1).trim(),!(!e||r[e]&&ignoreDuplicateOf[e])&&(e==="set-cookie"?r[e]?r[e].push(n):r[e]=[n]:r[e]=r[e]?r[e]+", "+n:n)}),r},$internals=Symbol("internals");function normalizeHeader(t){return t&&String(t).trim().toLowerCase()}function normalizeValue(t){return t===!1||t==null?t:utils.isArray(t)?t.map(normalizeValue):String(t)}function parseTokens(t){const r=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=e.exec(t);)r[n[1]]=n[2];return r}const isValidHeaderName=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function matchHeaderValue(t,r,e,n,o){if(utils.isFunction(n))return n.call(this,r,e);if(o&&(r=e),!!utils.isString(r)){if(utils.isString(n))return r.indexOf(n)!==-1;if(utils.isRegExp(n))return n.test(r)}}function formatHeader(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,e,n)=>e.toUpperCase()+n)}function buildAccessors(t,r){const e=utils.toCamelCase(" "+r);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+e,{value:function(o,s,a){return this[n].call(this,r,o,s,a)},configurable:!0})})}class AxiosHeaders{constructor(r){r&&this.set(r)}set(r,e,n){const o=this;function s(i,u,c){const d=normalizeHeader(u);if(!d)throw new Error("header name must be a non-empty string");const m=utils.findKey(o,d);(!m||o[m]===void 0||c===!0||c===void 0&&o[m]!==!1)&&(o[m||u]=normalizeValue(i))}const a=(i,u)=>utils.forEach(i,(c,d)=>s(c,d,u));return utils.isPlainObject(r)||r instanceof this.constructor?a(r,e):utils.isString(r)&&(r=r.trim())&&!isValidHeaderName(r)?a(parseHeaders(r),e):r!=null&&s(e,r,n),this}get(r,e){if(r=normalizeHeader(r),r){const n=utils.findKey(this,r);if(n){const o=this[n];if(!e)return o;if(e===!0)return parseTokens(o);if(utils.isFunction(e))return e.call(this,o,n);if(utils.isRegExp(e))return e.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,e){if(r=normalizeHeader(r),r){const n=utils.findKey(this,r);return!!(n&&this[n]!==void 0&&(!e||matchHeaderValue(this,this[n],n,e)))}return!1}delete(r,e){const n=this;let o=!1;function s(a){if(a=normalizeHeader(a),a){const i=utils.findKey(n,a);i&&(!e||matchHeaderValue(n,n[i],i,e))&&(delete n[i],o=!0)}}return utils.isArray(r)?r.forEach(s):s(r),o}clear(r){const e=Object.keys(this);let n=e.length,o=!1;for(;n--;){const s=e[n];(!r||matchHeaderValue(this,this[s],s,r,!0))&&(delete this[s],o=!0)}return o}normalize(r){const e=this,n={};return utils.forEach(this,(o,s)=>{const a=utils.findKey(n,s);if(a){e[a]=normalizeValue(o),delete e[s];return}const i=r?formatHeader(s):String(s).trim();i!==s&&delete e[s],e[i]=normalizeValue(o),n[i]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const e=Object.create(null);return utils.forEach(this,(n,o)=>{n!=null&&n!==!1&&(e[o]=r&&utils.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,e])=>r+": "+e).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...e){const n=new this(r);return e.forEach(o=>n.set(o)),n}static accessor(r){const n=(this[$internals]=this[$internals]={accessors:{}}).accessors,o=this.prototype;function s(a){const i=normalizeHeader(a);n[i]||(buildAccessors(o,a),n[i]=!0)}return utils.isArray(r)?r.forEach(s):s(r),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils.reduceDescriptors(AxiosHeaders.prototype,({value:t},r)=>{let e=r[0].toUpperCase()+r.slice(1);return{get:()=>t,set(n){this[e]=n}}});utils.freezeMethods(AxiosHeaders);const AxiosHeaders$1=AxiosHeaders;function transformData(t,r){const e=this||defaults$1,n=r||e,o=AxiosHeaders$1.from(n.headers);let s=n.data;return utils.forEach(t,function(i){s=i.call(e,s,o.normalize(),r?r.status:void 0)}),o.normalize(),s}function isCancel(t){return!!(t&&t.__CANCEL__)}function CanceledError(t,r,e){AxiosError.call(this,t??"canceled",AxiosError.ERR_CANCELED,r,e),this.name="CanceledError"}utils.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(t,r,e){const n=e.config.validateStatus;!e.status||!n||n(e.status)?t(e):r(new AxiosError("Request failed with status code "+e.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}const cookies=platform.isStandardBrowserEnv?function(){return{write:function(e,n,o,s,a,i){const u=[];u.push(e+"="+encodeURIComponent(n)),utils.isNumber(o)&&u.push("expires="+new Date(o).toGMTString()),utils.isString(s)&&u.push("path="+s),utils.isString(a)&&u.push("domain="+a),i===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function isAbsoluteURL(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function combineURLs(t,r){return r?t.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):t}function buildFullPath(t,r){return t&&!isAbsoluteURL(r)?combineURLs(t,r):r}const isURLSameOrigin=platform.isStandardBrowserEnv?function(){const r=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let n;function o(s){let a=s;return r&&(e.setAttribute("href",a),a=e.href),e.setAttribute("href",a),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:e.pathname.charAt(0)==="/"?e.pathname:"/"+e.pathname}}return n=o(window.location.href),function(a){const i=utils.isString(a)?o(a):a;return i.protocol===n.protocol&&i.host===n.host}}():function(){return function(){return!0}}();function parseProtocol(t){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return r&&r[1]||""}function speedometer(t,r){t=t||10;const e=new Array(t),n=new Array(t);let o=0,s=0,a;return r=r!==void 0?r:1e3,function(u){const c=Date.now(),d=n[s];a||(a=c),e[o]=u,n[o]=c;let m=s,v=0;for(;m!==o;)v+=e[m++],m=m%t;if(o=(o+1)%t,o===s&&(s=(s+1)%t),c-a<r)return;const g=d&&c-d;return g?Math.round(v*1e3/g):void 0}}function progressEventReducer(t,r){let e=0;const n=speedometer(50,250);return o=>{const s=o.loaded,a=o.lengthComputable?o.total:void 0,i=s-e,u=n(i),c=s<=a;e=s;const d={loaded:s,total:a,progress:a?s/a:void 0,bytes:i,rate:u||void 0,estimated:u&&a&&c?(a-s)/u:void 0,event:o};d[r?"download":"upload"]=!0,t(d)}}const isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(t){return new Promise(function(e,n){let o=t.data;const s=AxiosHeaders$1.from(t.headers).normalize(),a=t.responseType;let i;function u(){t.cancelToken&&t.cancelToken.unsubscribe(i),t.signal&&t.signal.removeEventListener("abort",i)}utils.isFormData(o)&&(platform.isStandardBrowserEnv||platform.isStandardBrowserWebWorkerEnv?s.setContentType(!1):s.setContentType("multipart/form-data;",!1));let c=new XMLHttpRequest;if(t.auth){const g=t.auth.username||"",b=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";s.set("Authorization","Basic "+btoa(g+":"+b))}const d=buildFullPath(t.baseURL,t.url);c.open(t.method.toUpperCase(),buildURL(d,t.params,t.paramsSerializer),!0),c.timeout=t.timeout;function m(){if(!c)return;const g=AxiosHeaders$1.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders()),T={data:!a||a==="text"||a==="json"?c.responseText:c.response,status:c.status,statusText:c.statusText,headers:g,config:t,request:c};settle(function(y){e(y),u()},function(y){n(y),u()},T),c=null}if("onloadend"in c?c.onloadend=m:c.onreadystatechange=function(){!c||c.readyState!==4||c.status===0&&!(c.responseURL&&c.responseURL.indexOf("file:")===0)||setTimeout(m)},c.onabort=function(){c&&(n(new AxiosError("Request aborted",AxiosError.ECONNABORTED,t,c)),c=null)},c.onerror=function(){n(new AxiosError("Network Error",AxiosError.ERR_NETWORK,t,c)),c=null},c.ontimeout=function(){let b=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const T=t.transitional||transitionalDefaults;t.timeoutErrorMessage&&(b=t.timeoutErrorMessage),n(new AxiosError(b,T.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,t,c)),c=null},platform.isStandardBrowserEnv){const g=(t.withCredentials||isURLSameOrigin(d))&&t.xsrfCookieName&&cookies.read(t.xsrfCookieName);g&&s.set(t.xsrfHeaderName,g)}o===void 0&&s.setContentType(null),"setRequestHeader"in c&&utils.forEach(s.toJSON(),function(b,T){c.setRequestHeader(T,b)}),utils.isUndefined(t.withCredentials)||(c.withCredentials=!!t.withCredentials),a&&a!=="json"&&(c.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&c.addEventListener("progress",progressEventReducer(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&c.upload&&c.upload.addEventListener("progress",progressEventReducer(t.onUploadProgress)),(t.cancelToken||t.signal)&&(i=g=>{c&&(n(!g||g.type?new CanceledError(null,t,c):g),c.abort(),c=null)},t.cancelToken&&t.cancelToken.subscribe(i),t.signal&&(t.signal.aborted?i():t.signal.addEventListener("abort",i)));const v=parseProtocol(d);if(v&&platform.protocols.indexOf(v)===-1){n(new AxiosError("Unsupported protocol "+v+":",AxiosError.ERR_BAD_REQUEST,t));return}c.send(o||null)})},knownAdapters={http:httpAdapter,xhr:xhrAdapter};utils.forEach(knownAdapters,(t,r)=>{if(t){try{Object.defineProperty(t,"name",{value:r})}catch{}Object.defineProperty(t,"adapterName",{value:r})}});const adapters={getAdapter:t=>{t=utils.isArray(t)?t:[t];const{length:r}=t;let e,n;for(let o=0;o<r&&(e=t[o],!(n=utils.isString(e)?knownAdapters[e.toLowerCase()]:e));o++);if(!n)throw n===!1?new AxiosError(`Adapter ${e} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(utils.hasOwnProp(knownAdapters,e)?`Adapter '${e}' is not available in the build`:`Unknown adapter '${e}'`);if(!utils.isFunction(n))throw new TypeError("adapter is not a function");return n},adapters:knownAdapters};function throwIfCancellationRequested(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new CanceledError(null,t)}function dispatchRequest(t){return throwIfCancellationRequested(t),t.headers=AxiosHeaders$1.from(t.headers),t.data=transformData.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(t.adapter||defaults$1.adapter)(t).then(function(n){return throwIfCancellationRequested(t),n.data=transformData.call(t,t.transformResponse,n),n.headers=AxiosHeaders$1.from(n.headers),n},function(n){return isCancel(n)||(throwIfCancellationRequested(t),n&&n.response&&(n.response.data=transformData.call(t,t.transformResponse,n.response),n.response.headers=AxiosHeaders$1.from(n.response.headers))),Promise.reject(n)})}const headersToObject=t=>t instanceof AxiosHeaders$1?t.toJSON():t;function mergeConfig(t,r){r=r||{};const e={};function n(c,d,m){return utils.isPlainObject(c)&&utils.isPlainObject(d)?utils.merge.call({caseless:m},c,d):utils.isPlainObject(d)?utils.merge({},d):utils.isArray(d)?d.slice():d}function o(c,d,m){if(utils.isUndefined(d)){if(!utils.isUndefined(c))return n(void 0,c,m)}else return n(c,d,m)}function s(c,d){if(!utils.isUndefined(d))return n(void 0,d)}function a(c,d){if(utils.isUndefined(d)){if(!utils.isUndefined(c))return n(void 0,c)}else return n(void 0,d)}function i(c,d,m){if(m in r)return n(c,d);if(m in t)return n(void 0,c)}const u={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:i,headers:(c,d)=>o(headersToObject(c),headersToObject(d),!0)};return utils.forEach(Object.keys(Object.assign({},t,r)),function(d){const m=u[d]||o,v=m(t[d],r[d],d);utils.isUndefined(v)&&m!==i||(e[d]=v)}),e}const VERSION="1.5.0",validators$1={};["object","boolean","number","function","string","symbol"].forEach((t,r)=>{validators$1[t]=function(n){return typeof n===t||"a"+(r<1?"n ":" ")+t}});const deprecatedWarnings={};validators$1.transitional=function(r,e,n){function o(s,a){return"[Axios v"+VERSION+"] Transitional option '"+s+"'"+a+(n?". "+n:"")}return(s,a,i)=>{if(r===!1)throw new AxiosError(o(a," has been removed"+(e?" in "+e:"")),AxiosError.ERR_DEPRECATED);return e&&!deprecatedWarnings[a]&&(deprecatedWarnings[a]=!0,console.warn(o(a," has been deprecated since v"+e+" and will be removed in the near future"))),r?r(s,a,i):!0}};function assertOptions(t,r,e){if(typeof t!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let o=n.length;for(;o-- >0;){const s=n[o],a=r[s];if(a){const i=t[s],u=i===void 0||a(i,s,t);if(u!==!0)throw new AxiosError("option "+s+" must be "+u,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new AxiosError("Unknown option "+s,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(r){this.defaults=r,this.interceptors={request:new InterceptorManager$1,response:new InterceptorManager$1}}request(r,e){typeof r=="string"?(e=e||{},e.url=r):e=r||{},e=mergeConfig(this.defaults,e);const{transitional:n,paramsSerializer:o,headers:s}=e;n!==void 0&&validator.assertOptions(n,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),o!=null&&(utils.isFunction(o)?e.paramsSerializer={serialize:o}:validator.assertOptions(o,{encode:validators.function,serialize:validators.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let a=s&&utils.merge(s.common,s[e.method]);s&&utils.forEach(["delete","get","head","post","put","patch","common"],b=>{delete s[b]}),e.headers=AxiosHeaders$1.concat(a,s);const i=[];let u=!0;this.interceptors.request.forEach(function(T){typeof T.runWhen=="function"&&T.runWhen(e)===!1||(u=u&&T.synchronous,i.unshift(T.fulfilled,T.rejected))});const c=[];this.interceptors.response.forEach(function(T){c.push(T.fulfilled,T.rejected)});let d,m=0,v;if(!u){const b=[dispatchRequest.bind(this),void 0];for(b.unshift.apply(b,i),b.push.apply(b,c),v=b.length,d=Promise.resolve(e);m<v;)d=d.then(b[m++],b[m++]);return d}v=i.length;let g=e;for(m=0;m<v;){const b=i[m++],T=i[m++];try{g=b(g)}catch(k){T.call(this,k);break}}try{d=dispatchRequest.call(this,g)}catch(b){return Promise.reject(b)}for(m=0,v=c.length;m<v;)d=d.then(c[m++],c[m++]);return d}getUri(r){r=mergeConfig(this.defaults,r);const e=buildFullPath(r.baseURL,r.url);return buildURL(e,r.params,r.paramsSerializer)}}utils.forEach(["delete","get","head","options"],function(r){Axios.prototype[r]=function(e,n){return this.request(mergeConfig(n||{},{method:r,url:e,data:(n||{}).data}))}});utils.forEach(["post","put","patch"],function(r){function e(n){return function(s,a,i){return this.request(mergeConfig(i||{},{method:r,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}Axios.prototype[r]=e(),Axios.prototype[r+"Form"]=e(!0)});const Axios$1=Axios;class CancelToken{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(s){e=s});const n=this;this.promise.then(o=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](o);n._listeners=null}),this.promise.then=o=>{let s;const a=new Promise(i=>{n.subscribe(i),s=i}).then(o);return a.cancel=function(){n.unsubscribe(s)},a},r(function(s,a,i){n.reason||(n.reason=new CanceledError(s,a,i),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const e=this._listeners.indexOf(r);e!==-1&&this._listeners.splice(e,1)}static source(){let r;return{token:new CancelToken(function(o){r=o}),cancel:r}}}const CancelToken$1=CancelToken;function spread(t){return function(e){return t.apply(null,e)}}function isAxiosError(t){return utils.isObject(t)&&t.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([t,r])=>{HttpStatusCode[r]=t});const HttpStatusCode$1=HttpStatusCode;function createInstance(t){const r=new Axios$1(t),e=bind(Axios$1.prototype.request,r);return utils.extend(e,Axios$1.prototype,r,{allOwnKeys:!0}),utils.extend(e,r,null,{allOwnKeys:!0}),e.create=function(o){return createInstance(mergeConfig(t,o))},e}const axios=createInstance(defaults$1);axios.Axios=Axios$1;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function(r){return Promise.all(r)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=t=>formDataToJSON(utils.isHTMLForm(t)?new FormData(t):t);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const axios$1=axios;var QCHAT_BROWSER_SDK={exports:{}};(function(t,r){(function(e,n){t.exports=n()})(commonjsGlobal,function(){var e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{};function n(S){return S&&S.__esModule&&Object.prototype.hasOwnProperty.call(S,"default")?S.default:S}function o(S){var x={exports:{}};return S(x,x.exports),x.exports}var s,a,i=n(o(function(S){S.exports=function(D){if(D===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D},S.exports.__esModule=!0,S.exports.default=S.exports})),u=function(S){return S&&S.Math==Math&&S},c=u(typeof globalThis=="object"&&globalThis)||u(typeof window=="object"&&window)||u(typeof self=="object"&&self)||u(typeof e=="object"&&e)||function(){return this}()||Function("return this")(),d=function(S){try{return!!S()}catch{return!0}},m=!d(function(){var S=(function(){}).bind();return typeof S!="function"||S.hasOwnProperty("prototype")}),v=Function.prototype,g=v.apply,b=v.call,T=typeof Reflect=="object"&&Reflect.apply||(m?b.bind(g):function(){return b.apply(g,arguments)}),k=Function.prototype,y=k.bind,A=k.call,V=m&&y.bind(A,A),he=m?function(S){return S&&V(S)}:function(S){return S&&function(){return A.apply(S,arguments)}},ae=function(S){return typeof S=="function"},Ne=!d(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),_e=Function.prototype.call,Ce=m?_e.bind(_e):function(){return _e.apply(_e,arguments)},re={}.propertyIsEnumerable,ue=Object.getOwnPropertyDescriptor,ze={f:ue&&!re.call({1:2},1)?function(x){var D=ue(this,x);return!!D&&D.enumerable}:re},le=function(S,x){return{enumerable:!(1&S),configurable:!(2&S),writable:!(4&S),value:x}},de=he({}.toString),Ie=he("".slice),ie=function(S){return Ie(de(S),8,-1)},Ve=Object,Ue=he("".split),Dt=d(function(){return!Ve("z").propertyIsEnumerable(0)})?function(S){return ie(S)=="String"?Ue(S,""):Ve(S)}:Ve,tr=function(S){return S==null},dr=TypeError,fr=function(S){if(tr(S))throw dr("Can't call method on "+S);return S},sr=function(S){return Dt(fr(S))},hr=typeof document=="object"&&document.all,Fe=hr===void 0&&hr!==void 0?function(S){return typeof S=="object"?S!==null:ae(S)||S===hr}:function(S){return typeof S=="object"?S!==null:ae(S)},or={},ir=function(S){return ae(S)?S:void 0},$e=function(S,x){return arguments.length<2?ir(or[S])||ir(c[S]):or[S]&&or[S][x]||c[S]&&c[S][x]},er=he({}.isPrototypeOf),nr=$e("navigator","userAgent")||"",Pt=c.process,rr=c.Deno,kt=Pt&&Pt.versions||rr&&rr.version,Et=kt&&kt.v8;Et&&(a=(s=Et.split("."))[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&nr&&(!(s=nr.match(/Edge\/(\d+)/))||s[1]>=74)&&(s=nr.match(/Chrome\/(\d+)/))&&(a=+s[1]);var cr,mr=a,yr=!!Object.getOwnPropertySymbols&&!d(function(){var S=Symbol();return!String(S)||!(Object(S)instanceof Symbol)||!Symbol.sham&&mr&&mr<41}),Tr=yr&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Ir=Object,kr=Tr?function(S){return typeof S=="symbol"}:function(S){var x=$e("Symbol");return ae(x)&&er(x.prototype,Ir(S))},Ar=String,Rr=function(S){try{return Ar(S)}catch{return"Object"}},Mn=TypeError,Or=function(S){if(ae(S))return S;throw Mn(Rr(S)+" is not a function")},Pr=function(S,x){var D=S[x];return tr(D)?void 0:Or(D)},Nr=TypeError,Wr=Object.defineProperty,Yr="__core-js_shared__",Ur=c[Yr]||function(S,x){try{Wr(c,S,{value:x,configurable:!0,writable:!0})}catch{c[S]=x}return x}(Yr,{}),qr=o(function(S){(S.exports=function(x,D){return Ur[x]||(Ur[x]=D!==void 0?D:{})})("versions",[]).push({version:"3.25.0",mode:"pure",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),Yn=Object,$n=function(S){return Yn(fr(S))},Jr=he({}.hasOwnProperty),Fr=Object.hasOwn||function(x,D){return Jr($n(x),D)},Wn=0,ho=Math.random(),bo=he(1 .toString),uo=function(S){return"Symbol("+(S===void 0?"":S)+")_"+bo(++Wn+ho,36)},po=qr("wks"),No=c.Symbol,An=No&&No.for,Sa=Tr?No:No&&No.withoutSetter||uo,to=function(S){if(!Fr(po,S)||!yr&&typeof po[S]!="string"){var x="Symbol."+S;yr&&Fr(No,S)?po[S]=No[S]:po[S]=Tr&&An?An(x):Sa(x)}return po[S]},Lr=TypeError,Qr=to("toPrimitive"),Bn=function(S,x){if(!Fe(S)||kr(S))return S;var D,F=Pr(S,Qr);if(F){if(x===void 0&&(x="default"),D=Ce(F,S,x),!Fe(D)||kr(D))return D;throw Lr("Can't convert object to primitive value")}return x===void 0&&(x="number"),function(O,oe){var xe,z;if(oe==="string"&&ae(xe=O.toString)&&!Fe(z=Ce(xe,O))||ae(xe=O.valueOf)&&!Fe(z=Ce(xe,O))||oe!=="string"&&ae(xe=O.toString)&&!Fe(z=Ce(xe,O)))return z;throw Nr("Can't convert object to primitive value")}(S,x)},Xn=function(S){var x=Bn(S,"string");return kr(x)?x:x+""},ko=c.document,no=Fe(ko)&&Fe(ko.createElement),Ra=function(S){return no?ko.createElement(S):{}},fs=!Ne&&!d(function(){return Object.defineProperty(Ra("div"),"a",{get:function(){return 7}}).a!=7}),ms=Object.getOwnPropertyDescriptor,ga={f:Ne?ms:function(x,D){if(x=sr(x),D=Xn(D),fs)try{return ms(x,D)}catch{}if(Fr(x,D))return le(!Ce(ze.f,x,D),x[D])}},Bi=/#|\.prototype\./,Fi=function(S,x){var D=Zy[Xy(S)];return D==tb||D!=eb&&(ae(x)?d(x):!!x)},Xy=Fi.normalize=function(S){return String(S).replace(Bi,".").toLowerCase()},Zy=Fi.data={},eb=Fi.NATIVE="N",tb=Fi.POLYFILL="P",af=Fi,rb=he(he.bind),$o=function(S,x){return Or(S),x===void 0?S:m?rb(S,x):function(){return S.apply(x,arguments)}},sf=Ne&&d(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),nb=String,ob=TypeError,Vn=function(S){if(Fe(S))return S;throw ob(nb(S)+" is not an object")},ab=TypeError,ru=Object.defineProperty,sb=Object.getOwnPropertyDescriptor,ib="enumerable",cb="configurable",lb="writable",ua={f:Ne?sf?function(x,D,F){if(Vn(x),D=Xn(D),Vn(F),typeof x=="function"&&D==="prototype"&&"value"in F&&lb in F&&!F.writable){var O=sb(x,D);O&&O.writable&&(x[D]=F.value,F={configurable:cb in F?F.configurable:O.configurable,enumerable:ib in F?F.enumerable:O.enumerable,writable:!1})}return ru(x,D,F)}:ru:function(x,D,F){if(Vn(x),D=Xn(D),Vn(F),fs)try{return ru(x,D,F)}catch{}if("get"in F||"set"in F)throw ab("Accessors not supported");return"value"in F&&(x[D]=F.value),x}},Jo=Ne?function(S,x,D){return ua.f(S,x,le(1,D))}:function(S,x,D){return S[x]=D,S},ub=ga.f,db=function(S){var x=function(D,F,O){if(this instanceof x){switch(arguments.length){case 0:return new S;case 1:return new S(D);case 2:return new S(D,F)}return new S(D,F,O)}return T(S,this,arguments)};return x.prototype=S.prototype,x},Vr=function(S,x){var D,F,O,oe,xe,z,qe,Lt,lr=S.target,pr=S.global,Sr=S.stat,br=S.proto,Er=pr?c:Sr?c[lr]:(c[lr]||{}).prototype,Dr=pr?or:or[lr]||Jo(or,lr,{})[lr],$r=Dr.prototype;for(O in x)D=!af(pr?O:lr+(Sr?".":"#")+O,S.forced)&&Er&&Fr(Er,O),xe=Dr[O],D&&(z=S.dontCallGetSet?(Lt=ub(Er,O))&&Lt.value:Er[O]),oe=D&&z?z:x[O],D&&typeof xe==typeof oe||(qe=S.bind&&D?$o(oe,c):S.wrap&&D?db(oe):br&&ae(oe)?he(oe):oe,(S.sham||oe&&oe.sham||xe&&xe.sham)&&Jo(qe,"sham",!0),Jo(Dr,O,qe),br&&(Fr(or,F=lr+"Prototype")||Jo(or,F,{}),Jo(or[F],O,oe),S.real&&$r&&!$r[O]&&Jo($r,O,oe)))},pb=Math.ceil,fb=Math.floor,mb=Math.trunc||function(x){var D=+x;return(D>0?fb:pb)(D)},Li=function(S){var x=+S;return x!=x||x===0?0:mb(x)},gb=Math.max,hb=Math.min,ri=function(S,x){var D=Li(S);return D<0?gb(D+x,0):hb(D,x)},vb=Math.min,Ia=function(S){return(x=S.length)>0?vb(Li(x),9007199254740991):0;var x},cf=function(S){return function(x,D,F){var O,oe=sr(x),xe=Ia(oe),z=ri(F,xe);if(S&&D!=D){for(;xe>z;)if((O=oe[z++])!=O)return!0}else for(;xe>z;z++)if((S||z in oe)&&oe[z]===D)return S||z||0;return!S&&-1}},nu={includes:cf(!0),indexOf:cf(!1)},ni={},yb=nu.indexOf,lf=he([].push),uf=function(S,x){var D,F=sr(S),O=0,oe=[];for(D in F)!Fr(ni,D)&&Fr(F,D)&&lf(oe,D);for(;x.length>O;)Fr(F,D=x[O++])&&(~yb(oe,D)||lf(oe,D));return oe},$c=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],gs=Object.keys||function(x){return uf(x,$c)},bb=Ne&&!sf?Object.defineProperties:function(x,D){Vn(x);for(var F,O=sr(D),oe=gs(D),xe=oe.length,z=0;xe>z;)ua.f(x,F=oe[z++],O[F]);return x},df={f:bb},ou=$e("document","documentElement"),pf=qr("keys"),jc=function(S){return pf[S]||(pf[S]=uo(S))},ff=jc("IE_PROTO"),au=function(){},mf=function(S){return"<script>"+S+"<\/script>"},gf=function(S){S.write(mf("")),S.close();var x=S.parentWindow.Object;return S=null,x},Dc=function(){try{cr=new ActiveXObject("htmlfile")}catch{}var S,x;Dc=typeof document<"u"?document.domain&&cr?gf(cr):((x=Ra("iframe")).style.display="none",ou.appendChild(x),x.src="javascript:",(S=x.contentWindow.document).open(),S.write(mf("document.F=Object")),S.close(),S.F):gf(cr);for(var D=$c.length;D--;)delete Dc.prototype[$c[D]];return Dc()};ni[ff]=!0;var Ea=Object.create||function(x,D){var F;return x!==null?(au.prototype=Vn(x),F=new au,au.prototype=null,F[ff]=x):F=Dc(),D===void 0?F:df.f(F,D)};Vr({target:"Object",stat:!0,sham:!Ne},{create:Ea});var Tb=or.Object,Ja=function(x,D){return Tb.create(x,D)},Sb=String,Cb=TypeError,$i=Object.setPrototypeOf||("__proto__"in{}?function(){var S,x=!1,D={};try{(S=he(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(D,[]),x=D instanceof Array}catch{}return function(O,oe){return Vn(O),function(xe){if(typeof xe=="object"||ae(xe))return xe;throw Cb("Can't set "+Sb(xe)+" as a prototype")}(oe),x?S(O,oe):O.__proto__=oe,O}}():void 0);Vr({target:"Object",stat:!0},{setPrototypeOf:$i});var Ns=or.Object.setPrototypeOf,hs=he([].slice),hf=Function,Mb=he([].concat),kb=he([].join),su={},_b=function(S,x,D){if(!Fr(su,x)){for(var F=[],O=0;O<x;O++)F[O]="a["+O+"]";su[x]=hf("C,a","return new C("+kb(F,",")+")")}return su[x](S,D)},iu=m?hf.bind:function(x){var D=Or(this),F=D.prototype,O=hs(arguments,1),oe=function(){var z=Mb(O,hs(arguments));return this instanceof oe?_b(D,z.length,z):D.apply(x,z)};return Fe(F)&&(oe.prototype=F),oe};Vr({target:"Function",proto:!0,forced:Function.bind!==iu},{bind:iu});var Uo=function(S){return or[S+"Prototype"]},wb=Uo("Function").bind,cu=Function.prototype,Oo=function(S){var x=S.bind;return S===cu||er(cu,S)&&x===cu.bind?wb:x},lu=o(function(S){function x(D,F){var O;return S.exports=x=Ns?Oo(O=Ns).call(O):function(xe,z){return xe.__proto__=z,xe},S.exports.__esModule=!0,S.exports.default=S.exports,x(D,F)}S.exports=x,S.exports.__esModule=!0,S.exports.default=S.exports}),Ro=n(o(function(S){S.exports=function(D,F){D.prototype=Ja(F.prototype),D.prototype.constructor=D,lu(D,F)},S.exports.__esModule=!0,S.exports.default=S.exports})),Ya=Array.isArray||function(x){return ie(x)=="Array"},xb=TypeError,uu=function(S){if(S>9007199254740991)throw xb("Maximum allowed index exceeded");return S},Rs=function(S,x,D){var F=Xn(x);F in S?ua.f(S,F,le(0,D)):S[F]=D},vf={};vf[to("toStringTag")]="z";var du=String(vf)==="[object z]",Ib=to("toStringTag"),Eb=Object,Pb=ie(function(){return arguments}())=="Arguments",Bs=du?ie:function(S){var x,D,F;return S===void 0?"Undefined":S===null?"Null":typeof(D=function(O,oe){try{return O[oe]}catch{}}(x=Eb(S),Ib))=="string"?D:Pb?ie(x):(F=ie(x))=="Object"&&ae(x.callee)?"Arguments":F},Ab=he(Function.toString);ae(Ur.inspectSource)||(Ur.inspectSource=function(S){return Ab(S)});var yf=Ur.inspectSource,bf=function(){},Ob=[],Tf=$e("Reflect","construct"),pu=/^\s*(?:class|function)\b/,Nb=he(pu.exec),Rb=!pu.exec(bf),ji=function(x){if(!ae(x))return!1;try{return Tf(bf,Ob,x),!0}catch{return!1}},Sf=function(x){if(!ae(x))return!1;switch(Bs(x)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Rb||!!Nb(pu,yf(x))}catch{return!0}};Sf.sham=!0;var Uc=!Tf||d(function(){var S;return ji(ji.call)||!ji(Object)||!ji(function(){S=!0})||S})?Sf:ji,Bb=to("species"),Cf=Array,fu=function(S,x){return new(function(D){var F;return Ya(D)&&(F=D.constructor,(Uc(F)&&(F===Cf||Ya(F.prototype))||Fe(F)&&(F=F[Bb])===null)&&(F=void 0)),F===void 0?Cf:F}(S))(x===0?0:x)},Fb=to("species"),Di=function(S){return mr>=51||!d(function(){var x=[];return(x.constructor={})[Fb]=function(){return{foo:1}},x[S](Boolean).foo!==1})},Mf=to("isConcatSpreadable"),Lb=mr>=51||!d(function(){var S=[];return S[Mf]=!1,S.concat()[0]!==S}),$b=Di("concat"),jb=function(S){if(!Fe(S))return!1;var x=S[Mf];return x!==void 0?!!x:Ya(S)};Vr({target:"Array",proto:!0,arity:1,forced:!Lb||!$b},{concat:function(x){var D,F,O,oe,xe,z=$n(this),qe=fu(z,0),Lt=0;for(D=-1,O=arguments.length;D<O;D++)if(jb(xe=D===-1?z:arguments[D]))for(oe=Ia(xe),uu(Lt+oe),F=0;F<oe;F++,Lt++)F in xe&&Rs(qe,Lt,xe[F]);else uu(Lt+1),Rs(qe,Lt++,xe);return qe.length=Lt,qe}});var qc,Ui,Vc,Db=String,Aa=function(S){if(Bs(S)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Db(S)},Ub=$c.concat("length","prototype"),qi={f:Object.getOwnPropertyNames||function(x){return uf(x,Ub)}},qb=Array,Vb=Math.max,mu=function(S,x,D){for(var F=Ia(S),O=ri(x,F),oe=ri(D===void 0?F:D,F),xe=qb(Vb(oe-O,0)),z=0;O<oe;O++,z++)Rs(xe,z,S[O]);return xe.length=z,xe},kf=qi.f,_f=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],gu={f:function(x){return _f&&ie(x)=="Window"?function(D){try{return kf(D)}catch{return mu(_f)}}(x):kf(sr(x))}},Vi={f:Object.getOwnPropertySymbols},vs=function(S,x,D,F){return F&&F.enumerable?S[x]=D:Jo(S,x,D),S},hu={f:to},Hb=ua.f,wo=function(S){var x=or.Symbol||(or.Symbol={});Fr(x,S)||Hb(x,S,{value:hu.f(S)})},wf=function(){var S=$e("Symbol"),x=S&&S.prototype,D=x&&x.valueOf,F=to("toPrimitive");x&&!x[F]&&vs(x,F,function(O){return Ce(D,this)},{arity:1})},zb=du?{}.toString:function(){return"[object "+Bs(this)+"]"},Kb=ua.f,xf=to("toStringTag"),Fs=function(S,x,D,F){if(S){var O=D?S:S.prototype;Fr(O,xf)||Kb(O,xf,{configurable:!0,value:x}),F&&!du&&Jo(O,"toString",zb)}},If=c.WeakMap,Wb=ae(If)&&/native code/.test(String(If)),Ef="Object already initialized",vu=c.TypeError,Gb=c.WeakMap;if(Wb||Ur.state){var Ls=Ur.state||(Ur.state=new Gb),Qb=he(Ls.get),Pf=he(Ls.has),Jb=he(Ls.set);qc=function(S,x){if(Pf(Ls,S))throw vu(Ef);return x.facade=S,Jb(Ls,S,x),x},Ui=function(S){return Qb(Ls,S)||{}},Vc=function(S){return Pf(Ls,S)}}else{var oi=jc("state");ni[oi]=!0,qc=function(S,x){if(Fr(S,oi))throw vu(Ef);return x.facade=S,Jo(S,oi,x),x},Ui=function(S){return Fr(S,oi)?S[oi]:{}},Vc=function(S){return Fr(S,oi)}}var Pa={set:qc,get:Ui,has:Vc,enforce:function(S){return Vc(S)?Ui(S):qc(S,{})},getterFor:function(S){return function(x){var D;if(!Fe(x)||(D=Ui(x)).type!==S)throw vu("Incompatible receiver, "+S+" required");return D}}},Af=he([].push),ys=function(S){var x=S==1,D=S==2,F=S==3,O=S==4,oe=S==6,xe=S==7,z=S==5||oe;return function(qe,Lt,lr,pr){for(var Sr,br,Er=$n(qe),Dr=Dt(Er),$r=$o(Lt,lr),vn=Ia(Dr),Xr=0,wn=pr||fu,hn=x?wn(qe,vn):D||xe?wn(qe,0):void 0;vn>Xr;Xr++)if((z||Xr in Dr)&&(br=$r(Sr=Dr[Xr],Xr,Er),S))if(x)hn[Xr]=br;else if(br)switch(S){case 3:return!0;case 5:return Sr;case 6:return Xr;case 2:Af(hn,Sr)}else switch(S){case 4:return!1;case 7:Af(hn,Sr)}return oe?-1:F||O?O:hn}},bs={forEach:ys(0),map:ys(1),filter:ys(2),some:ys(3),every:ys(4),find:ys(5),findIndex:ys(6),filterReject:ys(7)},Hc=bs.forEach,da=jc("hidden"),zc="Symbol",Yb=Pa.set,Of=Pa.getterFor(zc),Ba=Object.prototype,$s=c.Symbol,Hi=$s&&$s.prototype,Xb=c.TypeError,yu=c.QObject,Nf=ga.f,Ts=ua.f,Rf=gu.f,Zb=ze.f,Bf=he([].push),Xa=qr("symbols"),zi=qr("op-symbols"),e0=qr("wks"),bu=!yu||!yu.prototype||!yu.prototype.findChild,Tu=Ne&&d(function(){return Ea(Ts({},"a",{get:function(){return Ts(this,"a",{value:7}).a}})).a!=7})?function(S,x,D){var F=Nf(Ba,x);F&&delete Ba[x],Ts(S,x,D),F&&S!==Ba&&Ts(Ba,x,F)}:Ts,Su=function(S,x){var D=Xa[S]=Ea(Hi);return Yb(D,{type:zc,tag:S,description:x}),Ne||(D.description=x),D},Kc=function(x,D,F){x===Ba&&Kc(zi,D,F),Vn(x);var O=Xn(D);return Vn(F),Fr(Xa,O)?(F.enumerable?(Fr(x,da)&&x[da][O]&&(x[da][O]=!1),F=Ea(F,{enumerable:le(0,!1)})):(Fr(x,da)||Ts(x,da,le(1,{})),x[da][O]=!0),Tu(x,O,F)):Ts(x,O,F)},Cu=function(x,D){Vn(x);var F=sr(D),O=gs(F).concat(jf(F));return Hc(O,function(oe){Ne&&!Ce(Ff,F,oe)||Kc(x,oe,F[oe])}),x},Ff=function(x){var D=Xn(x),F=Ce(Zb,this,D);return!(this===Ba&&Fr(Xa,D)&&!Fr(zi,D))&&(!(F||!Fr(this,D)||!Fr(Xa,D)||Fr(this,da)&&this[da][D])||F)},Lf=function(x,D){var F=sr(x),O=Xn(D);if(F!==Ba||!Fr(Xa,O)||Fr(zi,O)){var oe=Nf(F,O);return!oe||!Fr(Xa,O)||Fr(F,da)&&F[da][O]||(oe.enumerable=!0),oe}},$f=function(x){var D=Rf(sr(x)),F=[];return Hc(D,function(O){Fr(Xa,O)||Fr(ni,O)||Bf(F,O)}),F},jf=function(S){var x=S===Ba,D=Rf(x?zi:sr(S)),F=[];return Hc(D,function(O){!Fr(Xa,O)||x&&!Fr(Ba,O)||Bf(F,Xa[O])}),F};yr||($s=function(){if(er(Hi,this))throw Xb("Symbol is not a constructor");var x=arguments.length&&arguments[0]!==void 0?Aa(arguments[0]):void 0,D=uo(x),F=function(O){this===Ba&&Ce(F,zi,O),Fr(this,da)&&Fr(this[da],D)&&(this[da][D]=!1),Tu(this,D,le(1,O))};return Ne&&bu&&Tu(Ba,D,{configurable:!0,set:F}),Su(D,x)},Hi=$s.prototype,vs(Hi,"toString",function(){return Of(this).tag}),vs($s,"withoutSetter",function(S){return Su(uo(S),S)}),ze.f=Ff,ua.f=Kc,df.f=Cu,ga.f=Lf,qi.f=gu.f=$f,Vi.f=jf,hu.f=function(S){return Su(to(S),S)},Ne&&Ts(Hi,"description",{configurable:!0,get:function(){return Of(this).description}})),Vr({global:!0,constructor:!0,wrap:!0,forced:!yr,sham:!yr},{Symbol:$s}),Hc(gs(e0),function(S){wo(S)}),Vr({target:zc,stat:!0,forced:!yr},{useSetter:function(){bu=!0},useSimple:function(){bu=!1}}),Vr({target:"Object",stat:!0,forced:!yr,sham:!Ne},{create:function(x,D){return D===void 0?Ea(x):Cu(Ea(x),D)},defineProperty:Kc,defineProperties:Cu,getOwnPropertyDescriptor:Lf}),Vr({target:"Object",stat:!0,forced:!yr},{getOwnPropertyNames:$f}),wf(),Fs($s,zc),ni[da]=!0;var Df=yr&&!!Symbol.for&&!!Symbol.keyFor,Mu=qr("string-to-symbol-registry"),t0=qr("symbol-to-string-registry");Vr({target:"Symbol",stat:!0,forced:!Df},{for:function(S){var x=Aa(S);if(Fr(Mu,x))return Mu[x];var D=$e("Symbol")(x);return Mu[x]=D,t0[D]=x,D}});var Uf=qr("symbol-to-string-registry");Vr({target:"Symbol",stat:!0,forced:!Df},{keyFor:function(x){if(!kr(x))throw TypeError(Rr(x)+" is not a symbol");if(Fr(Uf,x))return Uf[x]}});var Ss=$e("JSON","stringify"),Wc=he(/./.exec),qf=he("".charAt),r0=he("".charCodeAt),n0=he("".replace),o0=he(1 .toString),a0=/[\uD800-\uDFFF]/g,Vf=/^[\uD800-\uDBFF]$/,Hf=/^[\uDC00-\uDFFF]$/,zf=!yr||d(function(){var S=$e("Symbol")();return Ss([S])!="[null]"||Ss({a:S})!="{}"||Ss(Object(S))!="{}"}),Kf=d(function(){return Ss("\uDF06\uD834")!=='"\\udf06\\ud834"'||Ss("\uDEAD")!=='"\\udead"'}),s0=function(S,x){var D=hs(arguments),F=x;if((Fe(x)||S!==void 0)&&!kr(S))return Ya(x)||(x=function(O,oe){if(ae(F)&&(oe=Ce(F,this,O,oe)),!kr(oe))return oe}),D[1]=x,T(Ss,null,D)},i0=function(S,x,D){var F=qf(D,x-1),O=qf(D,x+1);return Wc(Vf,S)&&!Wc(Hf,O)||Wc(Hf,S)&&!Wc(Vf,F)?"\\u"+o0(r0(S,0),16):S};Ss&&Vr({target:"JSON",stat:!0,arity:3,forced:zf||Kf},{stringify:function(x,D,F){var O=hs(arguments),oe=T(zf?s0:Ss,null,O);return Kf&&typeof oe=="string"?n0(oe,a0,i0):oe}});var c0=!yr||d(function(){Vi.f(1)});Vr({target:"Object",stat:!0,forced:c0},{getOwnPropertySymbols:function(x){var D=Vi.f;return D?D($n(x)):[]}}),wo("asyncIterator"),wo("hasInstance"),wo("isConcatSpreadable"),wo("iterator"),wo("match"),wo("matchAll"),wo("replace"),wo("search"),wo("species"),wo("split"),wo("toPrimitive"),wf(),wo("toStringTag"),Fs($e("Symbol"),"Symbol"),wo("unscopables"),Fs(c.JSON,"JSON",!0);var Cs,Wf,Gf,l0=or.Symbol,Za={},Qf=Function.prototype,u0=Ne&&Object.getOwnPropertyDescriptor,ku=Fr(Qf,"name"),d0={EXISTS:ku,PROPER:ku&&(function(){}).name==="something",CONFIGURABLE:ku&&(!Ne||Ne&&u0(Qf,"name").configurable)},Jf=!d(function(){function S(){}return S.prototype.constructor=null,Object.getPrototypeOf(new S)!==S.prototype}),Yf=jc("IE_PROTO"),_u=Object,p0=_u.prototype,ai=Jf?_u.getPrototypeOf:function(S){var x=$n(S);if(Fr(x,Yf))return x[Yf];var D=x.constructor;return ae(D)&&x instanceof D?D.prototype:x instanceof _u?p0:null},wu=to("iterator"),Xf=!1;[].keys&&("next"in(Gf=[].keys())?(Wf=ai(ai(Gf)))!==Object.prototype&&(Cs=Wf):Xf=!0);var f0=!Fe(Cs)||d(function(){var S={};return Cs[wu].call(S)!==S});Cs=f0?{}:Ea(Cs),ae(Cs[wu])||vs(Cs,wu,function(){return this});var Zf={IteratorPrototype:Cs,BUGGY_SAFARI_ITERATORS:Xf},m0=Zf.IteratorPrototype,g0=function(){return this},h0=d0.PROPER,Gc=Zf.BUGGY_SAFARI_ITERATORS,xu=to("iterator"),em="keys",Qc="values",tm="entries",v0=function(){return this},Iu=function(S,x,D,F,O,oe,xe){(function(vn,Xr,wn,hn){var Gn=Xr+" Iterator";vn.prototype=Ea(m0,{next:le(+!hn,wn)}),Fs(vn,Gn,!1,!0),Za[Gn]=g0})(D,x,F);var z,qe,Lt,lr=function(vn){if(vn===O&&Dr)return Dr;if(!Gc&&vn in br)return br[vn];switch(vn){case em:return function(){return new D(this,vn)};case Qc:return function(){return new D(this,vn)};case tm:return function(){return new D(this,vn)}}return function(){return new D(this)}},pr=x+" Iterator",Sr=!1,br=S.prototype,Er=br[xu]||br["@@iterator"]||O&&br[O],Dr=!Gc&&Er||lr(O),$r=x=="Array"&&br.entries||Er;if($r&&(z=ai($r.call(new S)))!==Object.prototype&&z.next&&(Fs(z,pr,!0,!0),Za[pr]=v0),h0&&O==Qc&&Er&&Er.name!==Qc&&(Sr=!0,Dr=function(){return Ce(Er,this)}),O)if(qe={values:lr(Qc),keys:oe?Dr:lr(em),entries:lr(tm)},xe)for(Lt in qe)(Gc||Sr||!(Lt in br))&&vs(br,Lt,qe[Lt]);else Vr({target:x,proto:!0,forced:Gc||Sr},qe);return xe&&br[xu]!==Dr&&vs(br,xu,Dr,{name:O}),Za[x]=Dr,qe};ua.f;var rm="Array Iterator",y0=Pa.set,b0=Pa.getterFor(rm);Iu(Array,"Array",function(S,x){y0(this,{type:rm,target:sr(S),index:0,kind:x})},function(){var S=b0(this),x=S.target,D=S.kind,F=S.index++;return!x||F>=x.length?(S.target=void 0,{value:void 0,done:!0}):D=="keys"?{value:F,done:!1}:D=="values"?{value:x[F],done:!1}:{value:[F,x[F]],done:!1}},"values"),Za.Arguments=Za.Array;var nm=to("toStringTag");for(var Eu in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var om=c[Eu],Pu=om&&om.prototype;Pu&&Bs(Pu)!==nm&&Jo(Pu,nm,Eu),Za[Eu]=Za.Array}var T0=l0;wo("asyncDispose"),wo("dispose"),wo("matcher"),wo("metadataKey"),wo("observable"),wo("metadata"),wo("patternMatch"),wo("replaceAll");var ha=T0,S0=he("".charAt),am=he("".charCodeAt),C0=he("".slice),sm=function(S){return function(x,D){var F,O,oe=Aa(fr(x)),xe=Li(D),z=oe.length;return xe<0||xe>=z?S?"":void 0:(F=am(oe,xe))<55296||F>56319||xe+1===z||(O=am(oe,xe+1))<56320||O>57343?S?S0(oe,xe):F:S?C0(oe,xe,xe+2):O-56320+(F-55296<<10)+65536}},M0={codeAt:sm(!1),charAt:sm(!0)}.charAt,im="String Iterator",k0=Pa.set,_0=Pa.getterFor(im);Iu(String,"String",function(S){k0(this,{type:im,string:Aa(S),index:0})},function(){var x,D=_0(this),F=D.string,O=D.index;return O>=F.length?{value:void 0,done:!0}:(x=M0(F,O),D.index+=x.length,{value:x,done:!1})});var cm=hu.f("iterator"),w0=o(function(S){function x(D){return S.exports=x=typeof ha=="function"&&typeof cm=="symbol"?function(F){return typeof F}:function(F){return F&&typeof ha=="function"&&F.constructor===ha&&F!==ha.prototype?"symbol":typeof F},S.exports.__esModule=!0,S.exports.default=S.exports,x(D)}S.exports=x,S.exports.__esModule=!0,S.exports.default=S.exports}),lm=ua.f;Vr({target:"Object",stat:!0,forced:Object.defineProperty!==lm,sham:!Ne},{defineProperty:lm});var x0=o(function(S){var x=or.Object,D=S.exports=function(O,oe,xe){return x.defineProperty(O,oe,xe)};x.defineProperty.sham&&(D.sham=!0)}),Ki=x0,I0=d(function(){ai(1)});Vr({target:"Object",stat:!0,forced:I0,sham:!Jf},{getPrototypeOf:function(x){return ai($n(x))}});var js=or.Object.getPrototypeOf,Ds=function(S,x){var D=[][S];return!!D&&d(function(){D.call(null,x||function(){return 1},1)})},E0=bs.forEach,um=Ds("forEach")?[].forEach:function(x){return E0(this,x,arguments.length>1?arguments[1]:void 0)};Vr({target:"Array",proto:!0,forced:[].forEach!=um},{forEach:um});var P0=Uo("Array").forEach,Au=Array.prototype,A0={DOMTokenList:!0,NodeList:!0},In=function(S){var x=S.forEach;return S===Au||er(Au,S)&&x===Au.forEach||Fr(A0,Bs(S))?P0:x},O0=he([].concat),N0=$e("Reflect","ownKeys")||function(x){var D=qi.f(Vn(x)),F=Vi.f;return F?O0(D,F(x)):D},dm=Error,R0=he("".replace),B0=String(dm("zxcasd").stack),pm=/\n\s*at [^:]*:[^\n]*/,F0=pm.test(B0),L0=function(S,x){if(F0&&typeof S=="string"&&!dm.prepareStackTrace)for(;x--;)S=R0(S,pm,"");return S},$0=function(S,x){Fe(x)&&"cause"in x&&Jo(S,"cause",x.cause)},j0=to("iterator"),D0=Array.prototype,fm=function(S){return S!==void 0&&(Za.Array===S||D0[j0]===S)},U0=to("iterator"),Jc=function(S){if(!tr(S))return Pr(S,U0)||Pr(S,"@@iterator")||Za[Bs(S)]},q0=TypeError,Wi=function(S,x){var D=arguments.length<2?Jc(S):x;if(Or(D))return Vn(Ce(D,S));throw q0(Rr(S)+" is not iterable")},Ou=function(S,x,D){var F,O;Vn(S);try{if(!(F=Pr(S,"return"))){if(x==="throw")throw D;return D}F=Ce(F,S)}catch(oe){O=!0,F=oe}if(x==="throw")throw D;if(O)throw F;return Vn(F),D},V0=TypeError,Yc=function(S,x){this.stopped=S,this.result=x},mm=Yc.prototype,so=function(S,x,D){var F,O,oe,xe,z,qe,Lt,lr=D&&D.that,pr=!(!D||!D.AS_ENTRIES),Sr=!(!D||!D.IS_RECORD),br=!(!D||!D.IS_ITERATOR),Er=!(!D||!D.INTERRUPTED),Dr=$o(x,lr),$r=function(Xr){return F&&Ou(F,"normal",Xr),new Yc(!0,Xr)},vn=function(Xr){return pr?(Vn(Xr),Er?Dr(Xr[0],Xr[1],$r):Dr(Xr[0],Xr[1])):Er?Dr(Xr,$r):Dr(Xr)};if(Sr)F=S.iterator;else if(br)F=S;else{if(!(O=Jc(S)))throw V0(Rr(S)+" is not iterable");if(fm(O)){for(oe=0,xe=Ia(S);xe>oe;oe++)if((z=vn(S[oe]))&&er(mm,z))return z;return new Yc(!1)}F=Wi(S,O)}for(qe=Sr?S.next:F.next;!(Lt=Ce(qe,F)).done;){try{z=vn(Lt.value)}catch(Xr){Ou(F,"throw",Xr)}if(typeof z=="object"&&z&&er(mm,z))return z}return new Yc(!1)},H0=function(S,x){return S===void 0?arguments.length<2?"":x:Aa(S)},z0=!d(function(){var S=Error("a");return!("stack"in S)||(Object.defineProperty(S,"stack",le(1,7)),S.stack!==7)}),K0=to("toStringTag"),Xc=Error,W0=[].push,Gi=function(x,D){var F,O=arguments.length>2?arguments[2]:void 0,oe=er(Nu,this);$i?F=$i(Xc(),oe?ai(this):Nu):(F=oe?this:Ea(Nu),Jo(F,K0,"Error")),D!==void 0&&Jo(F,"message",H0(D)),z0&&Jo(F,"stack",L0(F.stack,1)),$0(F,O);var xe=[];return so(x,W0,{that:xe}),Jo(F,"errors",xe),F};$i?$i(Gi,Xc):function(S,x,D){for(var F=N0(x),O=ua.f,oe=ga.f,xe=0;xe<F.length;xe++){var z=F[xe];Fr(S,z)||D&&Fr(D,z)||O(S,z,oe(x,z))}}(Gi,Xc,{name:!0});var Nu=Gi.prototype=Ea(Xc.prototype,{constructor:le(1,Gi),message:le(1,""),name:le(1,"AggregateError")});Vr({global:!0,constructor:!0,arity:2},{AggregateError:Gi});var Qi,si,gm,Ru,Ua=ie(c.process)=="process",hm=to("species"),vm=function(S){var x=$e(S),D=ua.f;Ne&&x&&!x[hm]&&D(x,hm,{configurable:!0,get:function(){return this}})},G0=TypeError,Bu=function(S,x){if(er(x,S))return S;throw G0("Incorrect invocation")},Q0=TypeError,Zc=function(S){if(Uc(S))return S;throw Q0(Rr(S)+" is not a constructor")},J0=to("species"),Ms=function(S,x){var D,F=Vn(S).constructor;return F===void 0||tr(D=Vn(F)[J0])?x:Zc(D)},Y0=TypeError,ym=function(S,x){if(S<x)throw Y0("Not enough arguments");return S},bm=/(?:ipad|iphone|ipod).*applewebkit/i.test(nr),Fu=c.setImmediate,Lu=c.clearImmediate,X0=c.process,$u=c.Dispatch,Z0=c.Function,Tm=c.MessageChannel,e1=c.String,ju=0,Ji={},t1="onreadystatechange";try{Qi=c.location}catch{}var Du=function(S){if(Fr(Ji,S)){var x=Ji[S];delete Ji[S],x()}},Uu=function(S){return function(){Du(S)}},Sm=function(S){Du(S.data)},Cm=function(S){c.postMessage(e1(S),Qi.protocol+"//"+Qi.host)};Fu&&Lu||(Fu=function(x){ym(arguments.length,1);var D=ae(x)?x:Z0(x),F=hs(arguments,1);return Ji[++ju]=function(){T(D,void 0,F)},si(ju),ju},Lu=function(x){delete Ji[x]},Ua?si=function(S){X0.nextTick(Uu(S))}:$u&&$u.now?si=function(S){$u.now(Uu(S))}:Tm&&!bm?(Ru=(gm=new Tm).port2,gm.port1.onmessage=Sm,si=$o(Ru.postMessage,Ru)):c.addEventListener&&ae(c.postMessage)&&!c.importScripts&&Qi&&Qi.protocol!=="file:"&&!d(Cm)?(si=Cm,c.addEventListener("message",Sm,!1)):si=t1 in Ra("script")?function(S){ou.appendChild(Ra("script")).onreadystatechange=function(){ou.removeChild(this),Du(S)}}:function(S){setTimeout(Uu(S),0)});var Yi,Us,Xi,ii,qu,Vu,Hu,Mm,km={set:Fu,clear:Lu},r1=/ipad|iphone|ipod/i.test(nr)&&c.Pebble!==void 0,n1=/web0s(?!.*chrome)/i.test(nr),o1=ga.f,zu=km.set,_m=c.MutationObserver||c.WebKitMutationObserver,wm=c.document,xm=c.process,el=c.Promise,Im=o1(c,"queueMicrotask"),Em=Im&&Im.value;Em||(Yi=function(){var S,x;for(Ua&&(S=xm.domain)&&S.exit();Us;){x=Us.fn,Us=Us.next;try{x()}catch(D){throw Us?ii():Xi=void 0,D}}Xi=void 0,S&&S.enter()},bm||Ua||n1||!_m||!wm?!r1&&el&&el.resolve?((Hu=el.resolve(void 0)).constructor=el,Mm=$o(Hu.then,Hu),ii=function(){Mm(Yi)}):Ua?ii=function(){xm.nextTick(Yi)}:(zu=$o(zu,c),ii=function(){zu(Yi)}):(qu=!0,Vu=wm.createTextNode(""),new _m(Yi).observe(Vu,{characterData:!0}),ii=function(){Vu.data=qu=!qu}));var Ku=Em||function(S){var x={fn:S,next:void 0};Xi&&(Xi.next=x),Us||(Us=x,ii()),Xi=x},ci=function(S){try{return{error:!1,value:S()}}catch(x){return{error:!0,value:x}}},Pm=function(){this.head=null,this.tail=null};Pm.prototype={add:function(S){var x={item:S,next:null};this.head?this.tail.next=x:this.head=x,this.tail=x},get:function(){var S=this.head;if(S)return this.head=S.next,this.tail===S&&(this.tail=null),S.item}};var Wu,Am,a1=Pm,ra=c.Promise,Om=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",s1=!Om&&!Ua&&typeof window=="object"&&typeof document=="object",Nm=ra&&ra.prototype,i1=to("species"),Rm=!1,Bm=ae(c.PromiseRejectionEvent),c1=af("Promise",function(){var S=yf(ra),x=S!==String(ra);if(!x&&mr===66||!Nm.catch||!Nm.finally)return!0;if(!mr||mr<51||!/native code/.test(S)){var D=new ra(function(O){O(1)}),F=function(O){O(function(){},function(){})};if((D.constructor={})[i1]=F,!(Rm=D.then(function(){})instanceof F))return!0}return!x&&(s1||Om)&&!Bm}),li={CONSTRUCTOR:c1,REJECTION_EVENT:Bm,SUBCLASSING:Rm},l1=TypeError,u1=function(S){var x,D;this.promise=new S(function(F,O){if(x!==void 0||D!==void 0)throw l1("Bad Promise constructor");x=F,D=O}),this.resolve=Or(x),this.reject=Or(D)},es={f:function(S){return new u1(S)}},Fm=km.set,tl="Promise",Lm=li.CONSTRUCTOR,d1=li.REJECTION_EVENT,Gu=Pa.getterFor(tl),p1=Pa.set,f1=ra&&ra.prototype,Zi=ra,Qu=f1,$m=c.TypeError,Ju=c.document,Yu=c.process,Xu=es.f,m1=Xu,g1=!!(Ju&&Ju.createEvent&&c.dispatchEvent),jm="unhandledrejection",Dm=function(S){var x;return!(!Fe(S)||!ae(x=S.then))&&x},Um=function(S,x){var D,F,O,oe=x.value,xe=x.state==1,z=xe?S.ok:S.fail,qe=S.resolve,Lt=S.reject,lr=S.domain;try{z?(xe||(x.rejection===2&&v1(x),x.rejection=1),z===!0?D=oe:(lr&&lr.enter(),D=z(oe),lr&&(lr.exit(),O=!0)),D===S.promise?Lt($m("Promise-chain cycle")):(F=Dm(D))?Ce(F,D,qe,Lt):qe(D)):Lt(oe)}catch(pr){lr&&!O&&lr.exit(),Lt(pr)}},qm=function(S,x){S.notified||(S.notified=!0,Ku(function(){for(var D,F=S.reactions;D=F.get();)Um(D,S);S.notified=!1,x&&!S.rejection&&h1(S)}))},Vm=function(S,x,D){var F,O;g1?((F=Ju.createEvent("Event")).promise=x,F.reason=D,F.initEvent(S,!1,!0),c.dispatchEvent(F)):F={promise:x,reason:D},!d1&&(O=c["on"+S])?O(F):S===jm&&function(oe,xe){var z=c.console;z&&z.error&&(arguments.length==1?z.error(oe):z.error(oe,xe))}("Unhandled promise rejection",D)},h1=function(S){Ce(Fm,c,function(){var x,D=S.facade,F=S.value;if(Hm(S)&&(x=ci(function(){Ua?Yu.emit("unhandledRejection",F,D):Vm(jm,D,F)}),S.rejection=Ua||Hm(S)?2:1,x.error))throw x.value})},Hm=function(S){return S.rejection!==1&&!S.parent},v1=function(S){Ce(Fm,c,function(){var x=S.facade;Ua?Yu.emit("rejectionHandled",x):Vm("rejectionhandled",x,S.value)})},ui=function(S,x,D){return function(F){S(x,F,D)}},di=function(S,x,D){S.done||(S.done=!0,D&&(S=D),S.value=x,S.state=2,qm(S,!0))},Zu=function(S,x,D){if(!S.done){S.done=!0,D&&(S=D);try{if(S.facade===x)throw $m("Promise can't be resolved itself");var F=Dm(x);F?Ku(function(){var O={done:!1};try{Ce(F,x,ui(Zu,O,S),ui(di,O,S))}catch(oe){di(O,oe,S)}}):(S.value=x,S.state=1,qm(S,!1))}catch(O){di({done:!1},O,S)}}};Lm&&(Qu=(Zi=function(x){Bu(this,Qu),Or(x),Ce(Wu,this);var D=Gu(this);try{x(ui(Zu,D),ui(di,D))}catch(F){di(D,F)}}).prototype,(Wu=function(x){p1(this,{type:tl,done:!1,notified:!1,parent:!1,reactions:new a1,rejection:!1,state:0,value:void 0})}).prototype=vs(Qu,"then",function(x,D){var F=Gu(this),O=Xu(Ms(this,Zi));return F.parent=!0,O.ok=!ae(x)||x,O.fail=ae(D)&&D,O.domain=Ua?Yu.domain:void 0,F.state==0?F.reactions.add(O):Ku(function(){Um(O,F)}),O.promise}),Am=function(){var S=new Wu,x=Gu(S);this.promise=S,this.resolve=ui(Zu,x),this.reject=ui(di,x)},es.f=Xu=function(S){return S===Zi||S===void 0?new Am(S):m1(S)}),Vr({global:!0,constructor:!0,wrap:!0,forced:Lm},{Promise:Zi}),Fs(Zi,tl,!1,!0),vm(tl);var zm=to("iterator"),Km=!1;try{var y1=0,Wm={next:function(){return{done:!!y1++}},return:function(){Km=!0}};Wm[zm]=function(){return this},Array.from(Wm,function(){throw 2})}catch{}var Gm=function(S,x){if(!x&&!Km)return!1;var D=!1;try{var F={};F[zm]=function(){return{next:function(){return{done:D=!0}}}},S(F)}catch{}return D},Qm=li.CONSTRUCTOR||!Gm(function(S){ra.all(S).then(void 0,function(){})});Vr({target:"Promise",stat:!0,forced:Qm},{all:function(x){var D=this,F=es.f(D),O=F.resolve,oe=F.reject,xe=ci(function(){var z=Or(D.resolve),qe=[],Lt=0,lr=1;so(x,function(pr){var Sr=Lt++,br=!1;lr++,Ce(z,D,pr).then(function(Er){br||(br=!0,qe[Sr]=Er,--lr||O(qe))},oe)}),--lr||O(qe)});return xe.error&&oe(xe.value),F.promise}});var b1=li.CONSTRUCTOR;ra&&ra.prototype,Vr({target:"Promise",proto:!0,forced:b1,real:!0},{catch:function(S){return this.then(void 0,S)}}),Vr({target:"Promise",stat:!0,forced:Qm},{race:function(x){var D=this,F=es.f(D),O=F.reject,oe=ci(function(){var xe=Or(D.resolve);so(x,function(z){Ce(xe,D,z).then(F.resolve,O)})});return oe.error&&O(oe.value),F.promise}}),Vr({target:"Promise",stat:!0,forced:li.CONSTRUCTOR},{reject:function(x){var D=es.f(this);return Ce(D.reject,void 0,x),D.promise}});var ed=function(S,x){if(Vn(S),Fe(x)&&x.constructor===S)return x;var D=es.f(S);return(0,D.resolve)(x),D.promise},T1=li.CONSTRUCTOR,S1=$e("Promise"),C1=!T1;Vr({target:"Promise",stat:!0,forced:!0},{resolve:function(x){return ed(C1&&this===S1?ra:this,x)}}),Vr({target:"Promise",stat:!0},{allSettled:function(x){var D=this,F=es.f(D),O=F.resolve,oe=F.reject,xe=ci(function(){var z=Or(D.resolve),qe=[],Lt=0,lr=1;so(x,function(pr){var Sr=Lt++,br=!1;lr++,Ce(z,D,pr).then(function(Er){br||(br=!0,qe[Sr]={status:"fulfilled",value:Er},--lr||O(qe))},function(Er){br||(br=!0,qe[Sr]={status:"rejected",reason:Er},--lr||O(qe))})}),--lr||O(qe)});return xe.error&&oe(xe.value),F.promise}});var Jm="No one promise resolved";Vr({target:"Promise",stat:!0},{any:function(x){var D=this,F=$e("AggregateError"),O=es.f(D),oe=O.resolve,xe=O.reject,z=ci(function(){var qe=Or(D.resolve),Lt=[],lr=0,pr=1,Sr=!1;so(x,function(br){var Er=lr++,Dr=!1;pr++,Ce(qe,D,br).then(function($r){Dr||Sr||(Sr=!0,oe($r))},function($r){Dr||Sr||(Dr=!0,Lt[Er]=$r,--pr||xe(new F(Lt,Jm)))})}),--pr||xe(new F(Lt,Jm))});return z.error&&xe(z.value),O.promise}});var M1=ra&&ra.prototype,k1=!!ra&&d(function(){M1.finally.call({then:function(){}},function(){})});Vr({target:"Promise",proto:!0,real:!0,forced:k1},{finally:function(S){var x=Ms(this,$e("Promise")),D=ae(S);return this.then(D?function(F){return ed(x,S()).then(function(){return F})}:S,D?function(F){return ed(x,S()).then(function(){throw F})}:S)}});var _1=or.Promise;Vr({target:"Promise",stat:!0,forced:!0},{try:function(S){var x=es.f(this),D=ci(S);return(D.error?x.reject:x.resolve)(D.value),x.promise}});var co=_1,w1=he([].reverse),Ym=[1,2];Vr({target:"Array",proto:!0,forced:String(Ym)===String(Ym.reverse())},{reverse:function(){return Ya(this)&&(this.length=this.length),w1(this)}});var x1=Uo("Array").reverse,td=Array.prototype,kl=function(S){var x=S.reverse;return S===td||er(td,S)&&x===td.reverse?x1:x},I1=Di("slice"),E1=to("species"),rd=Array,P1=Math.max;Vr({target:"Array",proto:!0,forced:!I1},{slice:function(x,D){var F,O,oe,xe=sr(this),z=Ia(xe),qe=ri(x,z),Lt=ri(D===void 0?z:D,z);if(Ya(xe)&&(F=xe.constructor,(Uc(F)&&(F===rd||Ya(F.prototype))||Fe(F)&&(F=F[E1])===null)&&(F=void 0),F===rd||F===void 0))return hs(xe,qe,Lt);for(O=new(F===void 0?rd:F)(P1(Lt-qe,0)),oe=0;qe<Lt;qe++,oe++)qe in xe&&Rs(O,oe,xe[qe]);return O.length=oe,O}});var A1=Uo("Array").slice,nd=Array.prototype,Co=function(S){var x=S.slice;return S===nd||er(nd,S)&&x===nd.slice?A1:x},O1=o(function(S){var x=w0.default;function D(){S.exports=D=function(){return F},S.exports.__esModule=!0,S.exports.default=S.exports;var F={},O=Object.prototype,oe=O.hasOwnProperty,xe=typeof ha=="function"?ha:{},z=xe.iterator||"@@iterator",qe=xe.asyncIterator||"@@asyncIterator",Lt=xe.toStringTag||"@@toStringTag";function lr(Cn,Zr,On){return Ki(Cn,Zr,{value:On,enumerable:!0,configurable:!0,writable:!0}),Cn[Zr]}try{lr({},"")}catch{lr=function(On,Un,eo){return On[Un]=eo}}function pr(Cn,Zr,On,Un){var eo=Zr&&Zr.prototype instanceof Er?Zr:Er,ro=Ja(eo.prototype),Do=new wr(Un||[]);return ro._invoke=function(go,Zo,So){var Io="suspendedStart";return function(ea,Ci){if(Io==="executing")throw new Error("Generator is already running");if(Io==="completed"){if(ea==="throw")throw Ci;return Nn()}for(So.method=ea,So.arg=Ci;;){var Eo=So.delegate;if(Eo){var Mi=Dn(Eo,So);if(Mi){if(Mi===br)continue;return Mi}}if(So.method==="next")So.sent=So._sent=So.arg;else if(So.method==="throw"){if(Io==="suspendedStart")throw Io="completed",So.arg;So.dispatchException(So.arg)}else So.method==="return"&&So.abrupt("return",So.arg);Io="executing";var $a=Sr(go,Zo,So);if($a.type==="normal"){if(Io=So.done?"completed":"suspendedYield",$a.arg===br)continue;return{value:$a.arg,done:So.done}}$a.type==="throw"&&(Io="completed",So.method="throw",So.arg=$a.arg)}}}(Cn,On,Do),ro}function Sr(Cn,Zr,On){try{return{type:"normal",arg:Cn.call(Zr,On)}}catch(Un){return{type:"throw",arg:Un}}}F.wrap=pr;var br={};function Er(){}function Dr(){}function $r(){}var vn={};lr(vn,z,function(){return this});var Xr=js&&js(js(xn([])));Xr&&Xr!==O&&oe.call(Xr,z)&&(vn=Xr);var wn=$r.prototype=Er.prototype=Ja(vn);function hn(Cn){var Zr;In(Zr=["next","throw","return"]).call(Zr,function(On){lr(Cn,On,function(Un){return this._invoke(On,Un)})})}function Gn(Cn,Zr){function On(eo,ro,Do,go){var Zo=Sr(Cn[eo],Cn,ro);if(Zo.type!=="throw"){var So=Zo.arg,Io=So.value;return Io&&x(Io)=="object"&&oe.call(Io,"__await")?Zr.resolve(Io.__await).then(function(ea){On("next",ea,Do,go)},function(ea){On("throw",ea,Do,go)}):Zr.resolve(Io).then(function(ea){So.value=ea,Do(So)},function(ea){return On("throw",ea,Do,go)})}go(Zo.arg)}var Un;this._invoke=function(eo,ro){function Do(){return new Zr(function(go,Zo){On(eo,ro,go,Zo)})}return Un=Un?Un.then(Do,Do):Do()}}function Dn(Cn,Zr){var On=Cn.iterator[Zr.method];if(On===void 0){if(Zr.delegate=null,Zr.method==="throw"){if(Cn.iterator.return&&(Zr.method="return",Zr.arg=void 0,Dn(Cn,Zr),Zr.method==="throw"))return br;Zr.method="throw",Zr.arg=new TypeError("The iterator does not provide a 'throw' method")}return br}var Un=Sr(On,Cn.iterator,Zr.arg);if(Un.type==="throw")return Zr.method="throw",Zr.arg=Un.arg,Zr.delegate=null,br;var eo=Un.arg;return eo?eo.done?(Zr[Cn.resultName]=eo.value,Zr.next=Cn.nextLoc,Zr.method!=="return"&&(Zr.method="next",Zr.arg=void 0),Zr.delegate=null,br):eo:(Zr.method="throw",Zr.arg=new TypeError("iterator result is not an object"),Zr.delegate=null,br)}function jo(Cn){var Zr={tryLoc:Cn[0]};1 in Cn&&(Zr.catchLoc=Cn[1]),2 in Cn&&(Zr.finallyLoc=Cn[2],Zr.afterLoc=Cn[3]),this.tryEntries.push(Zr)}function jn(Cn){var Zr=Cn.completion||{};Zr.type="normal",delete Zr.arg,Cn.completion=Zr}function wr(Cn){this.tryEntries=[{tryLoc:"root"}],In(Cn).call(Cn,jo,this),this.reset(!0)}function xn(Cn){if(Cn){var Zr=Cn[z];if(Zr)return Zr.call(Cn);if(typeof Cn.next=="function")return Cn;if(!isNaN(Cn.length)){var On=-1,Un=function eo(){for(;++On<Cn.length;)if(oe.call(Cn,On))return eo.value=Cn[On],eo.done=!1,eo;return eo.value=void 0,eo.done=!0,eo};return Un.next=Un}}return{next:Nn}}function Nn(){return{value:void 0,done:!0}}return Dr.prototype=$r,lr(wn,"constructor",$r),lr($r,"constructor",Dr),Dr.displayName=lr($r,Lt,"GeneratorFunction"),F.isGeneratorFunction=function(Cn){var Zr=typeof Cn=="function"&&Cn.constructor;return!!Zr&&(Zr===Dr||(Zr.displayName||Zr.name)==="GeneratorFunction")},F.mark=function(Cn){return Ns?Ns(Cn,$r):(Cn.__proto__=$r,lr(Cn,Lt,"GeneratorFunction")),Cn.prototype=Ja(wn),Cn},F.awrap=function(Cn){return{__await:Cn}},hn(Gn.prototype),lr(Gn.prototype,qe,function(){return this}),F.AsyncIterator=Gn,F.async=function(Cn,Zr,On,Un,eo){eo===void 0&&(eo=co);var ro=new Gn(pr(Cn,Zr,On,Un),eo);return F.isGeneratorFunction(Zr)?ro:ro.next().then(function(Do){return Do.done?Do.value:ro.next()})},hn(wn),lr(wn,Lt,"Generator"),lr(wn,z,function(){return this}),lr(wn,"toString",function(){return"[object Generator]"}),F.keys=function(Cn){var Zr=[];for(var On in Cn)Zr.push(On);return kl(Zr).call(Zr),function Un(){for(;Zr.length;){var eo=Zr.pop();if(eo in Cn)return Un.value=eo,Un.done=!1,Un}return Un.done=!0,Un}},F.values=xn,wr.prototype={constructor:wr,reset:function(Zr){var On;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,In(On=this.tryEntries).call(On,jn),!Zr)for(var Un in this)Un.charAt(0)==="t"&&oe.call(this,Un)&&!isNaN(+Co(Un).call(Un,1))&&(this[Un]=void 0)},stop:function(){this.done=!0;var Zr=this.tryEntries[0].completion;if(Zr.type==="throw")throw Zr.arg;return this.rval},dispatchException:function(Zr){if(this.done)throw Zr;var On=this;function Un(So,Io){return Do.type="throw",Do.arg=Zr,On.next=So,Io&&(On.method="next",On.arg=void 0),!!Io}for(var eo=this.tryEntries.length-1;eo>=0;--eo){var ro=this.tryEntries[eo],Do=ro.completion;if(ro.tryLoc==="root")return Un("end");if(ro.tryLoc<=this.prev){var go=oe.call(ro,"catchLoc"),Zo=oe.call(ro,"finallyLoc");if(go&&Zo){if(this.prev<ro.catchLoc)return Un(ro.catchLoc,!0);if(this.prev<ro.finallyLoc)return Un(ro.finallyLoc)}else if(go){if(this.prev<ro.catchLoc)return Un(ro.catchLoc,!0)}else{if(!Zo)throw new Error("try statement without catch or finally");if(this.prev<ro.finallyLoc)return Un(ro.finallyLoc)}}}},abrupt:function(Zr,On){for(var Un=this.tryEntries.length-1;Un>=0;--Un){var eo=this.tryEntries[Un];if(eo.tryLoc<=this.prev&&oe.call(eo,"finallyLoc")&&this.prev<eo.finallyLoc){var ro=eo;break}}ro&&(Zr==="break"||Zr==="continue")&&ro.tryLoc<=On&&On<=ro.finallyLoc&&(ro=null);var Do=ro?ro.completion:{};return Do.type=Zr,Do.arg=On,ro?(this.method="next",this.next=ro.finallyLoc,br):this.complete(Do)},complete:function(Zr,On){if(Zr.type==="throw")throw Zr.arg;return Zr.type==="break"||Zr.type==="continue"?this.next=Zr.arg:Zr.type==="return"?(this.rval=this.arg=Zr.arg,this.method="return",this.next="end"):Zr.type==="normal"&&On&&(this.next=On),br},finish:function(Zr){for(var On=this.tryEntries.length-1;On>=0;--On){var Un=this.tryEntries[On];if(Un.finallyLoc===Zr)return this.complete(Un.completion,Un.afterLoc),jn(Un),br}},catch:function(Zr){for(var On=this.tryEntries.length-1;On>=0;--On){var Un=this.tryEntries[On];if(Un.tryLoc===Zr){var eo=Un.completion;if(eo.type==="throw"){var ro=eo.arg;jn(Un)}return ro}}throw new Error("illegal catch attempt")},delegateYield:function(Zr,On,Un){return this.delegate={iterator:xn(Zr),resultName:On,nextLoc:Un},this.method==="next"&&(this.arg=void 0),br}},F}S.exports=D,S.exports.__esModule=!0,S.exports.default=S.exports}),rl=O1(),ar=rl;try{regeneratorRuntime=rl}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=rl:Function("r","regeneratorRuntime = r")(rl)}Vr({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991});var Xm=9007199254740991,_l=Object.assign,Vo=Object.defineProperty,wl=he([].concat),Zm=!_l||d(function(){if(Ne&&_l({b:1},_l(Vo({},"a",{enumerable:!0,get:function(){Vo(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var S={},x={},D=Symbol(),F="abcdefghijklmnopqrst";return S[D]=7,F.split("").forEach(function(O){x[O]=O}),_l({},S)[D]!=7||gs(_l({},x)).join("")!=F})?function(x,D){for(var F=$n(x),O=arguments.length,oe=1,xe=Vi.f,z=ze.f;O>oe;)for(var qe,Lt=Dt(arguments[oe++]),lr=xe?wl(gs(Lt),xe(Lt)):gs(Lt),pr=lr.length,Sr=0;pr>Sr;)qe=lr[Sr++],Ne&&!Ce(z,Lt,qe)||(F[qe]=Lt[qe]);return F}:_l;Vr({target:"Object",stat:!0,arity:2,forced:Object.assign!==Zm},{assign:Zm});var Tn=or.Object.assign;function xl(S,x){var D={};for(var F in S)Object.prototype.hasOwnProperty.call(S,F)&&x.indexOf(F)<0&&(D[F]=S[F]);if(S!=null&&typeof Object.getOwnPropertySymbols=="function"){var O=0;for(F=Object.getOwnPropertySymbols(S);O<F.length;O++)x.indexOf(F[O])<0&&Object.prototype.propertyIsEnumerable.call(S,F[O])&&(D[F[O]]=S[F[O]])}return D}function Mr(S,x,D,F){return new(D||(D=Promise))(function(O,oe){function xe(Lt){try{qe(F.next(Lt))}catch(lr){oe(lr)}}function z(Lt){try{qe(F.throw(Lt))}catch(lr){oe(lr)}}function qe(Lt){Lt.done?O(Lt.value):function(pr){return pr instanceof D?pr:new D(function(Sr){Sr(pr)})}(Lt.value).then(xe,z)}qe((F=F.apply(S,x||[])).next())})}var Wh=d(function(){if(typeof ArrayBuffer=="function"){var S=new ArrayBuffer(8);Object.isExtensible(S)&&Object.defineProperty(S,"a",{value:8})}}),Wo=Object.isExtensible,eg=d(function(){Wo(1)})||Wh?function(x){return!!Fe(x)&&(!Wh||ie(x)!="ArrayBuffer")&&(!Wo||Wo(x))}:Wo,tg=!d(function(){return Object.isExtensible(Object.preventExtensions({}))}),rg=o(function(S){var x=ua.f,D=!1,F=uo("meta"),O=0,oe=function(z){x(z,F,{value:{objectID:"O"+O++,weakData:{}}})},xe=S.exports={enable:function(){xe.enable=function(){},D=!0;var z=qi.f,qe=he([].splice),Lt={};Lt[F]=1,z(Lt).length&&(qi.f=function(lr){for(var pr=z(lr),Sr=0,br=pr.length;Sr<br;Sr++)if(pr[Sr]===F){qe(pr,Sr,1);break}return pr},Vr({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:gu.f}))},fastKey:function(z,qe){if(!Fe(z))return typeof z=="symbol"?z:(typeof z=="string"?"S":"P")+z;if(!Fr(z,F)){if(!eg(z))return"F";if(!qe)return"E";oe(z)}return z[F].objectID},getWeakData:function(z,qe){if(!Fr(z,F)){if(!eg(z))return!0;if(!qe)return!1;oe(z)}return z[F].weakData},onFreeze:function(z){return tg&&D&&eg(z)&&!Fr(z,F)&&oe(z),z}};ni[F]=!0}),N1=ua.f,R1=bs.forEach,ng=Pa.set,ka=Pa.getterFor,Gh=function(S,x,D){var F,O=S.indexOf("Map")!==-1,oe=S.indexOf("Weak")!==-1,xe=O?"set":"add",z=c[S],qe=z&&z.prototype,Lt={};if(Ne&&ae(z)&&(oe||qe.forEach&&!d(function(){new z().entries().next()}))){var lr=(F=x(function(Sr,br){ng(Bu(Sr,lr),{type:S,collection:new z}),br!=null&&so(br,Sr[xe],{that:Sr,AS_ENTRIES:O})})).prototype,pr=ka(S);R1(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(Sr){var br=Sr=="add"||Sr=="set";!(Sr in qe)||oe&&Sr=="clear"||Jo(lr,Sr,function(Er,Dr){var $r=pr(this).collection;if(!br&&oe&&!Fe(Er))return Sr=="get"&&void 0;var vn=$r[Sr](Er===0?0:Er,Dr);return br?this:vn})}),oe||N1(lr,"size",{configurable:!0,get:function(){return pr(this).collection.size}})}else F=D.getConstructor(x,S,O,xe),rg.enable();return Fs(F,S,!1,!0),Lt[S]=F,Vr({global:!0,forced:!0},Lt),oe||D.setStrong(F,S,O),F},Qd=function(S,x,D){for(var F in x)D&&D.unsafe&&S[F]?S[F]=x[F]:vs(S,F,x[F],D);return S},ks=ua.f,Es=rg.fastKey,Sn=Pa.set,Jd=Pa.getterFor,od={getConstructor:function(S,x,D,F){var O=S(function(Lt,lr){Bu(Lt,oe),Sn(Lt,{type:x,index:Ea(null),first:void 0,last:void 0,size:0}),Ne||(Lt.size=0),tr(lr)||so(lr,Lt[F],{that:Lt,AS_ENTRIES:D})}),oe=O.prototype,xe=Jd(x),z=function(Lt,lr,pr){var Sr,br,Er=xe(Lt),Dr=qe(Lt,lr);return Dr?Dr.value=pr:(Er.last=Dr={index:br=Es(lr,!0),key:lr,value:pr,previous:Sr=Er.last,next:void 0,removed:!1},Er.first||(Er.first=Dr),Sr&&(Sr.next=Dr),Ne?Er.size++:Lt.size++,br!=="F"&&(Er.index[br]=Dr)),Lt},qe=function(Lt,lr){var pr,Sr=xe(Lt),br=Es(lr);if(br!=="F")return Sr.index[br];for(pr=Sr.first;pr;pr=pr.next)if(pr.key==lr)return pr};return Qd(oe,{clear:function(){for(var lr=xe(this),pr=lr.index,Sr=lr.first;Sr;)Sr.removed=!0,Sr.previous&&(Sr.previous=Sr.previous.next=void 0),delete pr[Sr.index],Sr=Sr.next;lr.first=lr.last=void 0,Ne?lr.size=0:this.size=0},delete:function(Lt){var lr=this,pr=xe(lr),Sr=qe(lr,Lt);if(Sr){var br=Sr.next,Er=Sr.previous;delete pr.index[Sr.index],Sr.removed=!0,Er&&(Er.next=br),br&&(br.previous=Er),pr.first==Sr&&(pr.first=br),pr.last==Sr&&(pr.last=Er),Ne?pr.size--:lr.size--}return!!Sr},forEach:function(lr){for(var pr,Sr=xe(this),br=$o(lr,arguments.length>1?arguments[1]:void 0);pr=pr?pr.next:Sr.first;)for(br(pr.value,pr.key,this);pr&&pr.removed;)pr=pr.previous},has:function(lr){return!!qe(this,lr)}}),Qd(oe,D?{get:function(lr){var pr=qe(this,lr);return pr&&pr.value},set:function(lr,pr){return z(this,lr===0?0:lr,pr)}}:{add:function(lr){return z(this,lr=lr===0?0:lr,lr)}}),Ne&&ks(oe,"size",{get:function(){return xe(this).size}}),O},setStrong:function(S,x,D){var F=x+" Iterator",O=Jd(x),oe=Jd(F);Iu(S,x,function(xe,z){Sn(this,{type:F,target:xe,state:O(xe),kind:z,last:void 0})},function(){for(var xe=oe(this),z=xe.kind,qe=xe.last;qe&&qe.removed;)qe=qe.previous;return xe.target&&(xe.last=qe=qe?qe.next:xe.state.first)?z=="keys"?{value:qe.key,done:!1}:z=="values"?{value:qe.value,done:!1}:{value:[qe.key,qe.value],done:!1}:(xe.target=void 0,{value:void 0,done:!0})},D?"entries":"values",!D,!0),vm(x)}};Gh("Map",function(S){return function(){return S(this,arguments.length?arguments[0]:void 0)}},od);var og=or.Map,Qh=[].push,ag=function(x){var D,F,O,oe,xe=arguments.length,z=xe>1?arguments[1]:void 0;return Zc(this),(D=z!==void 0)&&Or(z),tr(x)?new this:(F=[],D?(O=0,oe=$o(z,xe>2?arguments[2]:void 0),so(x,function(qe){Ce(Qh,F,oe(qe,O++))})):so(x,Qh,{that:F}),new this(F))};Vr({target:"Map",stat:!0,forced:!0},{from:ag});var Jh=function(){return new this(hs(arguments))};Vr({target:"Map",stat:!0,forced:!0},{of:Jh});var Yh=function(){for(var x,D=Vn(this),F=Or(D.delete),O=!0,oe=0,xe=arguments.length;oe<xe;oe++)x=Ce(F,D,arguments[oe]),O=O&&x;return!!O};Vr({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:Yh}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function(x,D){var F,O,oe=Vn(this),xe=Or(oe.get),z=Or(oe.has),qe=Or(oe.set);return Ce(z,oe,x)?(F=Ce(xe,oe,x),"update"in D&&(F=D.update(F,x,oe),Ce(qe,oe,x,F)),F):(O=D.insert(x,oe),Ce(qe,oe,x,O),O)}});var ki=Wi;Vr({target:"Map",proto:!0,real:!0,forced:!0},{every:function(x){var D=Vn(this),F=ki(D),O=$o(x,arguments.length>1?arguments[1]:void 0);return!so(F,function(oe,xe,z){if(!O(xe,oe,D))return z()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(x){var D=Vn(this),F=ki(D),O=$o(x,arguments.length>1?arguments[1]:void 0),oe=new(Ms(D,$e("Map"))),xe=Or(oe.set);return so(F,function(z,qe){O(qe,z,D)&&Ce(xe,oe,z,qe)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),oe}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{find:function(x){var D=Vn(this),F=ki(D),O=$o(x,arguments.length>1?arguments[1]:void 0);return so(F,function(oe,xe,z){if(O(xe,oe,D))return z(xe)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(x){var D=Vn(this),F=ki(D),O=$o(x,arguments.length>1?arguments[1]:void 0);return so(F,function(oe,xe,z){if(O(xe,oe,D))return z(oe)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var B1=he([].push);Vr({target:"Map",stat:!0,forced:!0},{groupBy:function(x,D){Or(D);var F=Wi(x),O=new this,oe=Or(O.has),xe=Or(O.get),z=Or(O.set);return so(F,function(qe){var Lt=D(qe);Ce(oe,O,Lt)?B1(Ce(xe,O,Lt),qe):Ce(z,O,Lt,[qe])},{IS_ITERATOR:!0}),O}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(x){return so(ki(Vn(this)),function(D,F,O){if((oe=F)===(xe=x)||oe!=oe&&xe!=xe)return O();var oe,xe},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Vr({target:"Map",stat:!0,forced:!0},{keyBy:function(x,D){var F=new this;Or(D);var O=Or(F.set);return so(x,function(oe){Ce(O,F,D(oe),oe)}),F}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(x){return so(ki(Vn(this)),function(D,F,O){if(F===x)return O(D)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(x){var D=Vn(this),F=ki(D),O=$o(x,arguments.length>1?arguments[1]:void 0),oe=new(Ms(D,$e("Map"))),xe=Or(oe.set);return so(F,function(z,qe){Ce(xe,oe,O(qe,z,D),qe)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),oe}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(x){var D=Vn(this),F=ki(D),O=$o(x,arguments.length>1?arguments[1]:void 0),oe=new(Ms(D,$e("Map"))),xe=Or(oe.set);return so(F,function(z,qe){Ce(xe,oe,z,O(qe,z,D))},{AS_ENTRIES:!0,IS_ITERATOR:!0}),oe}}),Vr({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(x){for(var D=Vn(this),F=Or(D.set),O=arguments.length,oe=0;oe<O;)so(arguments[oe++],F,{that:D,AS_ENTRIES:!0});return D}});var Xh=TypeError;Vr({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(x){var D=Vn(this),F=ki(D),O=arguments.length<2,oe=O?void 0:arguments[1];if(Or(x),so(F,function(xe,z){O?(O=!1,oe=z):oe=x(oe,z,xe,D)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),O)throw Xh("Reduce of empty map with no initial value");return oe}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{some:function(x){var D=Vn(this),F=ki(D),O=$o(x,arguments.length>1?arguments[1]:void 0);return so(F,function(oe,xe,z){if(O(xe,oe,D))return z()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var F1=TypeError;Vr({target:"Map",proto:!0,real:!0,forced:!0},{update:function(x,D){var F=Vn(this),O=Or(F.get),oe=Or(F.has),xe=Or(F.set),z=arguments.length;Or(D);var qe=Ce(oe,F,x);if(!qe&&z<3)throw F1("Updating absent value");var Lt=qe?Ce(O,F,x):Or(z>2?arguments[2]:void 0)(x,F);return Ce(xe,F,x,D(Lt,x,F)),F}});var Zh=TypeError,sg=function(x,D){var F,O=Vn(this),oe=Or(O.get),xe=Or(O.has),z=Or(O.set),qe=arguments.length>2?arguments[2]:void 0;if(!ae(D)&&!ae(qe))throw Zh("At least one callback required");return Ce(xe,O,x)?(F=Ce(oe,O,x),ae(D)&&(F=D(F),Ce(z,O,x,F))):ae(qe)&&(F=qe(),Ce(z,O,x,F)),F};Vr({target:"Map",proto:!0,real:!0,forced:!0},{upsert:sg}),Vr({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:sg});var nl=og,ev=Date,L1=he(ev.prototype.getTime);Vr({target:"Date",stat:!0},{now:function(){return L1(new ev)}});var ts=or.Date.now,_i=Uo("Array").concat,ig=Array.prototype,qs=function(S){var x=S.concat;return S===ig||er(ig,S)&&x===ig.concat?_i:x},$1=/MSIE .\./.test(nr),j1=c.Function,cg=function(S){return $1?function(x,D){var F=ym(arguments.length,1)>2,O=ae(x)?x:j1(x),oe=F?hs(arguments,2):void 0;return S(F?function(){T(O,this,oe)}:O,D)}:S},ec={setTimeout:cg(c.setTimeout),setInterval:cg(c.setInterval)},lg=ec.setInterval;Vr({global:!0,bind:!0,forced:c.setInterval!==lg},{setInterval:lg});var tv=ec.setTimeout;Vr({global:!0,bind:!0,forced:c.setTimeout!==tv},{setTimeout:tv});var sa=or.setTimeout;or.JSON||(or.JSON={stringify:JSON.stringify});var D1=function(x,D,F){return T(or.JSON.stringify,null,arguments)},mo=D1,rv=bs.map,nv=Di("map");Vr({target:"Array",proto:!0,forced:!nv},{map:function(x){return rv(this,x,arguments.length>1?arguments[1]:void 0)}});var ov=Uo("Array").map,Yd=Array.prototype,vo=function(S){var x=S.map;return S===Yd||er(Yd,S)&&x===Yd.map?ov:x},ug=o(function(S){var x=Object.prototype.hasOwnProperty,D="~";function F(){}function O(qe,Lt,lr){this.fn=qe,this.context=Lt,this.once=lr||!1}function oe(qe,Lt,lr,pr,Sr){if(typeof lr!="function")throw new TypeError("The listener must be a function");var br=new O(lr,pr||qe,Sr),Er=D?D+Lt:Lt;return qe._events[Er]?qe._events[Er].fn?qe._events[Er]=[qe._events[Er],br]:qe._events[Er].push(br):(qe._events[Er]=br,qe._eventsCount++),qe}function xe(qe,Lt){--qe._eventsCount==0?qe._events=new F:delete qe._events[Lt]}function z(){this._events=new F,this._eventsCount=0}Object.create&&(F.prototype=Object.create(null),new F().__proto__||(D=!1)),z.prototype.eventNames=function(){var Lt,lr,pr=[];if(this._eventsCount===0)return pr;for(lr in Lt=this._events)x.call(Lt,lr)&&pr.push(D?lr.slice(1):lr);return Object.getOwnPropertySymbols?pr.concat(Object.getOwnPropertySymbols(Lt)):pr},z.prototype.listeners=function(Lt){var lr=D?D+Lt:Lt,pr=this._events[lr];if(!pr)return[];if(pr.fn)return[pr.fn];for(var Sr=0,br=pr.length,Er=new Array(br);Sr<br;Sr++)Er[Sr]=pr[Sr].fn;return Er},z.prototype.listenerCount=function(Lt){var lr=D?D+Lt:Lt,pr=this._events[lr];return pr?pr.fn?1:pr.length:0},z.prototype.emit=function(Lt,lr,pr,Sr,br,Er){var Dr=D?D+Lt:Lt;if(!this._events[Dr])return!1;var $r,vn,Xr=this._events[Dr],wn=arguments.length;if(Xr.fn){switch(Xr.once&&this.removeListener(Lt,Xr.fn,void 0,!0),wn){case 1:return Xr.fn.call(Xr.context),!0;case 2:return Xr.fn.call(Xr.context,lr),!0;case 3:return Xr.fn.call(Xr.context,lr,pr),!0;case 4:return Xr.fn.call(Xr.context,lr,pr,Sr),!0;case 5:return Xr.fn.call(Xr.context,lr,pr,Sr,br),!0;case 6:return Xr.fn.call(Xr.context,lr,pr,Sr,br,Er),!0}for(vn=1,$r=new Array(wn-1);vn<wn;vn++)$r[vn-1]=arguments[vn];Xr.fn.apply(Xr.context,$r)}else{var hn,Gn=Xr.length;for(vn=0;vn<Gn;vn++)switch(Xr[vn].once&&this.removeListener(Lt,Xr[vn].fn,void 0,!0),wn){case 1:Xr[vn].fn.call(Xr[vn].context);break;case 2:Xr[vn].fn.call(Xr[vn].context,lr);break;case 3:Xr[vn].fn.call(Xr[vn].context,lr,pr);break;case 4:Xr[vn].fn.call(Xr[vn].context,lr,pr,Sr);break;default:if(!$r)for(hn=1,$r=new Array(wn-1);hn<wn;hn++)$r[hn-1]=arguments[hn];Xr[vn].fn.apply(Xr[vn].context,$r)}}return!0},z.prototype.on=function(Lt,lr,pr){return oe(this,Lt,lr,pr,!1)},z.prototype.once=function(Lt,lr,pr){return oe(this,Lt,lr,pr,!0)},z.prototype.removeListener=function(Lt,lr,pr,Sr){var br=D?D+Lt:Lt;if(!this._events[br])return this;if(!lr)return xe(this,br),this;var Er=this._events[br];if(Er.fn)Er.fn!==lr||Sr&&!Er.once||pr&&Er.context!==pr||xe(this,br);else{for(var Dr=0,$r=[],vn=Er.length;Dr<vn;Dr++)(Er[Dr].fn!==lr||Sr&&!Er[Dr].once||pr&&Er[Dr].context!==pr)&&$r.push(Er[Dr]);$r.length?this._events[br]=$r.length===1?$r[0]:$r:xe(this,br)}return this},z.prototype.removeAllListeners=function(Lt){var lr;return Lt?(lr=D?D+Lt:Lt,this._events[lr]&&xe(this,lr)):(this._events=new F,this._eventsCount=0),this},z.prototype.off=z.prototype.removeListener,z.prototype.addListener=z.prototype.on,z.prefixed=D,z.EventEmitter=z,S.exports=z}),U1=Il;function Il(S){S=S||{},this.ms=S.min||100,this.max=S.max||1e4,this.factor=S.factor||2,this.jitter=S.jitter>0&&S.jitter<=1?S.jitter:0,this.attempts=0}Il.prototype.duration=function(){var S=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var x=Math.random(),D=Math.floor(x*this.jitter*S);S=1&Math.floor(10*x)?S+D:S-D}return 0|Math.min(S,this.max)},Il.prototype.reset=function(){this.attempts=0},Il.prototype.setMin=function(S){this.ms=S},Il.prototype.setMax=function(S){this.max=S},Il.prototype.setJitter=function(S){this.jitter=S};var Xd=typeof e=="object"&&e&&e.Object===Object&&e,To=typeof self=="object"&&self&&self.Object===Object&&self,Vs=Xd||To||Function("return this")(),wi=Vs.Symbol,ol=Object.prototype,av=ol.hasOwnProperty,q1=ol.toString,Ps=wi?wi.toStringTag:void 0,Gs=function(x){var D=av.call(x,Ps),F=x[Ps];try{x[Ps]=void 0;var O=!0}catch{}var oe=q1.call(x);return O&&(D?x[Ps]=F:delete x[Ps]),oe},sv=Object.prototype.toString,V1=function(x){return sv.call(x)},iv=wi?wi.toStringTag:void 0,Qs=function(x){return x==null?x===void 0?"[object Undefined]":"[object Null]":iv&&iv in Object(x)?Gs(x):V1(x)},pi=function(x){var D=typeof x;return x!=null&&(D=="object"||D=="function")},Zd=function(x){if(!pi(x))return!1;var D=Qs(x);return D=="[object Function]"||D=="[object GeneratorFunction]"||D=="[object AsyncFunction]"||D=="[object Proxy]"},cv={deviceId:"",timeout:8e3},lv={account:"",appkey:"",token:"",debugLevel:"off",needReconnect:!0,reconnectionAttempts:Xm,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},yc=nu.includes,fi=d(function(){return!Array(1).includes()});Vr({target:"Array",proto:!0,forced:fi},{includes:function(x){return yc(this,x,arguments.length>1?arguments[1]:void 0)}});var ep=Uo("Array").includes,uv=to("match"),H1=TypeError,dv=function(S){if(function(x){var D;return Fe(x)&&((D=x[uv])!==void 0?!!D:ie(x)=="RegExp")}(S))throw H1("The method doesn't accept regular expressions");return S},z1=to("match"),K1=he("".indexOf);Vr({target:"String",proto:!0,forced:!function(S){var x=/./;try{"/./"[S](x)}catch{try{return x[z1]=!1,"/./"[S](x)}catch{}}return!1}("includes")},{includes:function(x){return!!~K1(Aa(fr(this)),Aa(dv(x)),arguments.length>1?arguments[1]:void 0)}});var W1=Uo("String").includes,dg=Array.prototype,pg=String.prototype,mi=function(S){var x=S.includes;return S===dg||er(dg,S)&&x===dg.includes?ep:typeof S=="string"||S===pg||er(pg,S)&&x===pg.includes?W1:x},G1=bs.findIndex,Q1="findIndex",pv=!0;Q1 in[]&&Array(1).findIndex(function(){pv=!1}),Vr({target:"Array",proto:!0,forced:pv},{findIndex:function(x){return G1(this,x,arguments.length>1?arguments[1]:void 0)}});var fg=Uo("Array").findIndex,ad=Array.prototype,bc=function(S){var x=S.findIndex;return S===ad||er(ad,S)&&x===ad.findIndex?fg:x},J1=o(function(S){function x(D){var F;return S.exports=x=Ns?Oo(F=js).call(F):function(oe){return oe.__proto__||js(oe)},S.exports.__esModule=!0,S.exports.default=S.exports,x(D)}S.exports=x,S.exports.__esModule=!0,S.exports.default=S.exports}),Y1=nu.indexOf,tp=he([].indexOf),fv=!!tp&&1/tp([1],1,-0)<0,mg=Ds("indexOf");Vr({target:"Array",proto:!0,forced:fv||!mg},{indexOf:function(x){var D=arguments.length>1?arguments[1]:void 0;return fv?tp(this,x,D)||0:Y1(this,x,D)}});var X1=Uo("Array").indexOf,gg=Array.prototype,pa=function(S){var x=S.indexOf;return S===gg||er(gg,S)&&x===gg.indexOf?X1:x},hg=o(function(S){S.exports=function(D){var F;return pa(F=Function.toString.call(D)).call(F,"[native code]")!==-1},S.exports.__esModule=!0,S.exports.default=S.exports}),vg=$e("Reflect","construct"),Z1=Object.prototype,mv=[].push,yg=d(function(){function S(){}return!(vg(function(){},[],S)instanceof S)}),bg=!d(function(){vg(function(){})}),xi=yg||bg;Vr({target:"Reflect",stat:!0,forced:xi,sham:xi},{construct:function(x,D){Zc(x),Vn(D);var F=arguments.length<3?x:Zc(arguments[2]);if(bg&&!yg)return vg(x,D,F);if(x==F){switch(D.length){case 0:return new x;case 1:return new x(D[0]);case 2:return new x(D[0],D[1]);case 3:return new x(D[0],D[1],D[2]);case 4:return new x(D[0],D[1],D[2],D[3])}var O=[null];return T(mv,O,D),new(T(iu,x,O))}var oe=F.prototype,xe=Ea(Fe(oe)?oe:Z1),z=T(x,xe,D);return Fe(z)?z:xe}});var tc=or.Reflect.construct,eT=o(function(S){S.exports=function(){if(typeof Reflect>"u"||!tc||tc.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(tc(Boolean,[],function(){})),!0}catch{return!1}},S.exports.__esModule=!0,S.exports.default=S.exports}),tT=o(function(S){function x(D,F,O){var oe;return eT()?(S.exports=x=Oo(oe=tc).call(oe),S.exports.__esModule=!0,S.exports.default=S.exports):(S.exports=x=function(z,qe,Lt){var lr=[null];lr.push.apply(lr,qe);var pr=new(Oo(Function).apply(z,lr));return Lt&&lu(pr,Lt.prototype),pr},S.exports.__esModule=!0,S.exports.default=S.exports),x.apply(null,arguments)}S.exports=x,S.exports.__esModule=!0,S.exports.default=S.exports}),rc=o(function(S){function x(D){var F=typeof nl=="function"?new nl:void 0;return S.exports=x=function(oe){if(oe===null||!hg(oe))return oe;if(typeof oe!="function")throw new TypeError("Super expression must either be null or a function");if(F!==void 0){if(F.has(oe))return F.get(oe);F.set(oe,xe)}function xe(){return tT(oe,arguments,J1(this).constructor)}return xe.prototype=Ja(oe.prototype,{constructor:{value:xe,enumerable:!1,writable:!0,configurable:!0}}),lu(xe,oe)},S.exports.__esModule=!0,S.exports.default=S.exports,x(D)}S.exports=x,S.exports.__esModule=!0,S.exports.default=S.exports}),yo=function(S){function x(D,F,O){var oe;return F===void 0&&(F={}),O===void 0&&(O=400),(oe=S.call(this,D)||this).data=F,oe.code=O,oe.name="customError",oe}return Ro(x,S),x}(n(rc)(Error)),al=function(S){function x(D,F,O){var oe;return F===void 0&&(F={}),(oe=S.call(this,D,F,414)||this).code=414,oe.name="validateError",oe.rules=O,oe}return Ro(x,S),x}(yo),rp={200:null,406:null,808:null,810:null,201:"The client version is incorrect. You need to upgrade the SDK",302:"The user name or password is incorrect. Please check whether the appkey and token are valid and whether the account and token match",403:"Illegal operation or no permission",404:"Target object does not exist",405:"Parameter length too long",408:"Client request timed out",414:"Request parameter error",415:"Service unavailable",416:"Frequency control",417:"Repeat operation",422:"Account disabled",500:"Server internal error",503:"Server busy",508:"Expiration date",509:"Invalid",7101:"Be pulled black",700:"Partial failure of batch operation",801:"The number of people in the team has reached the upper limit",802:"No permission",803:"The team does not exist or has not changed",804:"The user is not in the team",805:"Team type mismatch",806:"The number of teams created has reached the limit",807:"Team member not valid",809:"Already in the team",811:"The number of accounts in the forced push list exceeds the limit",812:"The team is muted",813:"Due to the limited number of team, some pull people successfully",814:"Disable team message read service",815:"Maximum number of team administrators",816:"Batch operation partial failure",997:"The packet has expired",998:"Deserialize packet error",999:"Serialize packet error",9102:"Channel failure",9103:"This call has been answered / rejected at another end",10201:"Signaling: target NIM client is offline",10202:"Signaling: push is unreachable",10404:"Signaling: channel not exists",10405:"Signaling: channel already exists",10406:"Signaling: member of channel not exists",10407:"Signaling: member of channel already exists",10408:"Signaling: the invitation request does not exist or has expired",10409:"Signaling: the invitation request has been rejected",10410:"Signaling: the invitation request has been accepted",10414:"Signaling: request parameter error",10417:"Signaling: uid conflict",10419:"Signaling: the number of members of channel exceed the limit",10420:"Signaling: member is already in the channel on other client",10700:"Signaling: phased success",13002:"Abnormal chatroom status",13003:"In the blacklist",13004:"In the mute list",13006:"All members are muted, and only the administrator can speak"},Tg=function(S){function x(D,F,O,oe,xe){var z;return O===void 0&&(O=""),oe===void 0&&(oe=new Date().getTime()),xe===void 0&&(xe={}),O=O||rp[D],(z=S.call(this,O,xe,D)||this).name="cmdError",z.cmd=F,z.timetag=oe,z}return Ro(x,S),x}(yo),El=function(S){function x(D,F,O){var oe;return(oe=S.call(this,D,{},412)||this).code=412,oe.name="formatError",oe.key=F,oe.reason=O,oe}return Ro(x,S),x}(yo),Tc=function(S){function x(D,F,O,oe,xe){var z;return(z=S.call(this,D,{file:xe},400)||this).name="uploadError",z.rawError=F,z.curProvider=O||1,z.mixStorePolicy=oe,z}return Ro(x,S),x}(yo),sl=["error","warn","log","debug"],sd=function(){},np=["off","error","warn","log","debug"],gv=function(){function S(D,F){this.name=F,this.strategies={debug:console.log,log:console.log,warn:console.warn,error:console.error},this.debug=sd,this.log=sd,this.warn=sd,this.error=sd,this.name=F,S.instancesName.push(F),mi(np).call(np,D)||(D="off"),this.setLogFunc(D)}var x=S.prototype;return x.setLogFunc=function(F){var O=this,oe=bc(sl).call(sl,function(xe){return xe===F});In(sl).call(sl,function(xe,z){z<=oe&&(O[xe]=function(){var qe=Co(Array.prototype).call(arguments),Lt=this.formatArgs(qe,xe);this.strategies[xe](Lt)})})},x.formatArgs=function(F,O){var oe=new Date,xe=oe.getMonth()+1+"-"+oe.getDate()+" "+oe.getHours()+":"+oe.getMinutes()+":"+oe.getSeconds()+":"+oe.getMilliseconds();return"[NIM "+O+" "+this.name+" "+xe+"] "+vo(F).call(F,function(z){return z instanceof yo?z.name+", "+z.code+", "+z.message:z instanceof Error?z&&z.message?z.message:z:typeof z=="object"?mo(z):z}).join(" ")},S}();gv.instancesName=[],Vr({global:!0},{globalThis:c});var rT=d(function(){gs(1)});Vr({target:"Object",stat:!0,forced:rT},{keys:function(x){return gs($n(x))}});var na=or.Object.keys,Sg=bs.filter,is=Di("filter");Vr({target:"Array",proto:!0,forced:!is},{filter:function(x){return Sg(this,x,arguments.length>1?arguments[1]:void 0)}});var nT=Uo("Array").filter,Ho=Array.prototype,Js=function(S){var x=S.filter;return S===Ho||er(Ho,S)&&x===Ho.filter?nT:x},hv=o(function(S,x){S.exports=function(){function D(Lt,lr){if(!(Lt instanceof lr))throw new TypeError("Cannot call a class as a function")}function F(Lt,lr){for(var pr=0;pr<lr.length;pr++){var Sr=lr[pr];Sr.enumerable=Sr.enumerable||!1,Sr.configurable=!0,"value"in Sr&&(Sr.writable=!0),Ki(Lt,Sr.key,Sr)}}function O(Lt,lr,pr){return lr&&F(Lt.prototype,lr),pr&&F(Lt,pr),Ki(Lt,"prototype",{writable:!1}),Lt}var oe={reportUrl:"https://statistic.live.126.net/statics/report/common/form",maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0},xe="https://statistic.live.126.net/dispatcher/req",z=function(){},qe=function(){function Lt(lr){D(this,Lt),this.enable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=oe,this.msgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=ts(),this.timer=null,this.setConfig(lr),this.reportConfig.autoStart&&this.initUploadConfig()}return O(Lt,[{key:"setConfig",value:function(pr){this.reportConfig=Tn({},this.reportConfig,pr)}},{key:"reportImmediately",value:function(pr,Sr){var br=this;this.reportConfig.request(pr,Tn({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},Sr)).catch(function(Er){var Dr,$r;($r=(Dr=br.reportConfig)===null||Dr===void 0?void 0:Dr.logger)===null||$r===void 0||$r.warn("Reporter immediately upload failed",Er)})}},{key:"report",value:function(pr,Sr){var br=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(pr){var Er=ts();br?this.lowPriorityMsgList.push({module:pr,msg:Sr,createTime:Er}):this.msgList.push({module:pr,msg:Sr,createTime:Er}),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function(pr,Sr){if(pr&&!this.traceMsgCache[pr]){var br=Tn(Tn({start_time:ts()},Sr),{extension:[]});this.traceMsgCache[pr]=br}}},{key:"reportTraceUpdate",value:function(pr){}},{key:"reportTraceUpdateV2",value:function(pr,Sr){if(this.traceMsgCache[pr]){var br=this.traceMsgCache[pr].extension.length,Er=new Date().getTime();Sr.duration=br===0?Er-this.traceMsgCache[pr].start_time:Er-this.traceMsgCache[pr].extension[br-1].end_time,this.traceMsgCache[pr].extension.push(Tn({end_time:Er},Sr))}}},{key:"reportTraceEnd",value:function(pr){var Sr,br=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.traceMsgCache[pr]&&(pr!=="nos"||br===!1?(typeof br=="boolean"?this.traceMsgCache[pr].succeed=!!br:this.traceMsgCache[pr].state=br,this.traceMsgCache[pr].duration=ts()-this.traceMsgCache[pr].start_time,In(Sr=this.traceMsgCache[pr].extension).call(Sr,function(Er){delete Er.end_time}),this.report(pr,this.traceMsgCache[pr]),this.traceMsgCache[pr]=null):this.traceMsgCache[pr]=null)}},{key:"reportTraceCancel",value:function(pr){this.traceMsgCache[pr]=null}},{key:"pause",value:function(){this.enable=!1}},{key:"restore",value:function(){this.enable=!0,this.initConfigLoaded||this.initUploadConfig()}},{key:"destroy",value:function(){var pr,Sr=this;In(pr=na(this.traceMsgCache)).call(pr,function(br){Sr.reportTraceEnd(br,1)}),this.timer!==null&&clearTimeout(this.timer),this.setConfig=z,this.report=z,this.reportTraceStart=z,this.reportTraceUpdate=z,this.reportTraceEnd=z,this.pause=z,this.restore=z,this.destroy=z,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.reportConfig={},this.isDestroyed=!0}},{key:"initUploadConfig",value:function(){var pr,Sr,br=this;if(!this.loading){this.loading=!0;var Er=this.reportConfig.common||{};try{this.reportConfig.request(xe,{method:"GET",dataType:"json",params:{deviceId:Er.dev_id,sdkVer:Er.sdk_ver,platform:Er.platform,appkey:Er.app_key},timeout:this.reportConfig.timeout}).then(function(Dr){var $r,vn;if(!br.isDestroyed){if(Dr.status===200&&Dr.data&&Dr.data.code===200){var Xr=Dr.data.data||{};br.reportConfig.maxSize=Xr.maxSize>1e3?1e3:Xr.maxSize,br.reportConfig.maxInterval=Xr.maxInterval>1e4?1e4:Xr.maxInterval,br.reportConfig.maxInterval=Xr.maxInterval<10?10:Xr.maxInterval,br.reportConfig.minInterval=Xr.minInterval<2?2:Xr.minInterval,br.reportConfig.maxDelay=Xr.maxDelay||300,br.reportConfig.maxInterval=1e3*br.reportConfig.maxInterval,br.reportConfig.minInterval=1e3*br.reportConfig.minInterval,br.reportConfig.maxDelay=1e3*br.reportConfig.maxDelay,br.enable=!0,br.initConfigLoaded=!0,br.loading=!1,br.reportHeartBeat()}(vn=($r=br.reportConfig)===null||$r===void 0?void 0:$r.logger)===null||vn===void 0||vn.log("Get reporter upload config success")}}).catch(function(Dr){var $r,vn;br.loading=!1,(vn=($r=br.reportConfig)===null||$r===void 0?void 0:$r.logger)===null||vn===void 0||vn.error("Get reporter upload config failed",Dr)})}catch(Dr){this.loading=!1,(Sr=(pr=this.reportConfig)===null||pr===void 0?void 0:pr.logger)===null||Sr===void 0||Sr.error("Exec reporter request failed",Dr)}}}},{key:"reportHeartBeat",value:function(){var pr=this;this.isDestroyed||(this.timer=sa(function(){pr.reportHeartBeat()},this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function(){if(!this.isDestroyed){var pr=this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;ts()-this.lastReportTime>=pr&&this.upload()}}},{key:"getUploadMsg",value:function(){var pr,Sr,br,Er,Dr,$r=this,vn={},Xr=ts();this.msgList=Js(pr=this.msgList).call(pr,function(xn){return Xr-xn.createTime<$r.reportConfig.maxDelay}),this.lowPriorityMsgList=Js(Sr=this.lowPriorityMsgList).call(Sr,function(xn){return Xr-xn.createTime<$r.reportConfig.maxDelay}),this.cacheMsgList=Js(br=this.cacheMsgList).call(br,function(xn){return Xr-xn.createTime<$r.reportConfig.maxDelay});var wn=Co(Er=this.msgList).call(Er,0,this.reportConfig.maxSize);if(this.msgList=Co(Dr=this.msgList).call(Dr,wn.length),wn.length<this.reportConfig.maxSize){var hn,Gn,Dn=this.reportConfig.maxSize-wn.length;wn=qs(wn).call(wn,Co(hn=this.lowPriorityMsgList).call(hn,0,Dn)),this.lowPriorityMsgList=Co(Gn=this.lowPriorityMsgList).call(Gn,Dn)}if(wn.length<this.reportConfig.maxSize){var jo,jn,wr=this.reportConfig.maxSize-wn.length;wn=qs(wn).call(wn,Co(jo=this.cacheMsgList).call(jo,0,wr)),this.cacheMsgList=Co(jn=this.cacheMsgList).call(jn,wr)}return In(wn).call(wn,function(xn){vn[xn.module]?vn[xn.module].push(xn.msg):vn[xn.module]=[xn.msg]}),{uploadMsgArr:wn,uploadMsg:vn}}},{key:"upload",value:function(){var pr,Sr,br=this;if(this.enable&&!(this.lastReportTime&&ts()-this.lastReportTime<this.reportConfig.minInterval)){var Er=this.getUploadMsg(),Dr=Er.uploadMsgArr,$r=Er.uploadMsg;if(Dr.length){this.lastReportTime=ts();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:$r},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch(function(vn){var Xr,wn,hn,Gn;br.cacheMsgList=Co(Xr=qs(wn=br.cacheMsgList).call(wn,Dr)).call(Xr,0,br.reportConfig.cacheMaxSize),(Gn=(hn=br.reportConfig)===null||hn===void 0?void 0:hn.logger)===null||Gn===void 0||Gn.warn("Reporter upload failed",vn)})}catch(vn){(Sr=(pr=this.reportConfig)===null||pr===void 0?void 0:pr.logger)===null||Sr===void 0||Sr.warn("Exec reporter request failed",vn)}clearTimeout(this.timer),this.reportHeartBeat()}}}}]),Lt}();return qe}()}),ta={setLogger:function(x){throw new Error("Function not implemented.")},platform:"",WebSocket:function(){function S(D,F){throw this.CONNECTING=0,this.OPEN=1,this.CLOSING=2,this.CLOSED=3,new Error("Method not implemented.")}var x=S.prototype;return x.close=function(F,O){throw new Error("Method not implemented.")},x.send=function(F){throw new Error("Method not implemented.")},x.onclose=function(F){throw new Error("Method not implemented.")},x.onerror=function(F){throw new Error("Method not implemented.")},x.onmessage=function(F){throw new Error("Method not implemented.")},x.onopen=function(F){throw new Error("Method not implemented.")},S}(),localStorage:{},request:function(x,D){throw new Error("Function not implemented.")},uploadFile:function(x){throw new Error("Function not implemented.")},getSystemInfo:function(){throw new Error("Function not implemented.")}},oT=TypeError,vv=function(S){return function(x,D,F,O){Or(D);var oe=$n(x),xe=Dt(oe),z=Ia(oe),qe=S?z-1:0,Lt=S?-1:1;if(F<2)for(;;){if(qe in xe){O=xe[qe],qe+=Lt;break}if(qe+=Lt,S?qe<0:z<=qe)throw oT("Reduce of empty array with no initial value")}for(;S?qe>=0:z>qe;qe+=Lt)qe in xe&&(O=D(O,xe[qe],qe,oe));return O}},Cg={left:vv(!1),right:vv(!0)}.left,op=Ds("reduce");Vr({target:"Array",proto:!0,forced:!op||!Ua&&mr>79&&mr<83},{reduce:function(x){var D=arguments.length;return Cg(this,x,D,D>1?arguments[1]:void 0)}});var yv=Uo("Array").reduce,Pl=Array.prototype,Sc=function(S){var x=S.reduce;return S===Pl||er(Pl,S)&&x===Pl.reduce?yv:x},bv=function(x){return x===void 0},id={},Ii={};function qa(S,x){var D,F,O;try{O=JSON.parse(S)}catch(br){throw x.error("Parse command error: ",S),br}var oe=O.sid+"_"+O.cid,xe=O.r;if(mi(D=["4_1","4_2","4_10","4_11"]).call(D,oe)){var z=O.r[1].headerPacket;oe=z.sid+"_"+z.cid,xe=O.r[1].body}var qe,Lt=Ii[oe],lr=id[Lt],pr=function(Er,Dr){var $r=rp[Er];return $r===null?null:new Tg(Er,Dr,$r,new Date().getTime())}(O.code,Lt),Sr={cmd:Lt,raw:O,error:pr,service:lr==null?void 0:lr.service,content:{}};if(Sr.error){if(Sr.error.cmd=Lt,Sr.error.callFunc="parseCmd",!(!((F=lr==null?void 0:lr.ignoreErrCodes)===null||F===void 0)&&mi(F).call(F,O.code)))return Sr;x.warn("parseCmd:: ignore error ",Sr.error),Sr.error.ignore=!0}return!Lt||!lr?(Sr.notFound=!0,Sr):(lr.response&&In(qe=lr.response).call(qe,function(br,Er){var Dr=xe[Er],$r=br.type,vn=br.name,Xr=br.reflectMapper;if(!bv(Dr))switch($r){case"Property":Sr.content[vn]=Xr?Oa(Dr,Xr):Dr;break;case"PropertyArray":Sr.content[vn]=vo(Dr).call(Dr,function(wn){return Xr?Oa(wn,Xr):wn});break;case"long":case"Long":case"byte":case"Byte":case"Number":Sr.content[vn]=+Dr;break;default:Sr.content[vn]=Dr}}),Sr)}function rs(S,x){var D={};for(var F in S)x[F]!==void 0&&(D[x[F]]=S[F]);return D}function Oa(S,x){var D={};for(var F in S)x[F]!==void 0&&(D[x[F]]=S[F]);return D}function Ei(S){id=Tn(id,S.cmdConfig),Ii=Tn(Ii,S.cmdMap)}function Cc(S){var x;return Sc(x=na(S)).call(x,function(D,F){var O,oe=S[F];return D[F]=Sc(O=na(oe)).call(O,function(xe,z){return xe[oe[z]]=z,xe},{}),D},{})}var Mg=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],kg=["transport not supported","client not handshaken","unauthorized"],ap=["reconnect"],aT=function(S){function x(F,O,oe){var xe;return(xe=S.call(this)||this).url=O,xe.logger=oe,xe.websocket=null,xe.core=F,xe.url=O,xe.status="disconnected",xe.logger=oe,xe.connect(),xe}Ro(x,S);var D=x.prototype;return D.connect=function(){var O=this;this.status!=="connecting"&&this.status!=="connected"?(this.status="connecting",this.core.adapters.request("https://"+this.url+"/socket.io/1/?t="+ts(),{method:"GET",dataType:"text",timeout:8e3}).then(function(oe){var xe=oe.data.split(":"),z=xe[0],qe=xe[1];return O.sessionId=z,O.closeTimeout=1e3*qe,O._createWebsocket("wss://"+O.url+"/socket.io/1/websocket/"+z)}).catch(function(oe){O.logger.error("imsocket::handshake fail. ",oe&&oe.message),O.status="disconnected",O.emit("handshakeFailed")})):this.logger.warn("imsocket::socket is connecting or connected",this.status)},D.close=function(){if(this.websocket){this.logger.log("imsocket:: close websocket");try{this.websocket.send(this.encodePacket({type:"disconnect"})),this.websocket.close()}catch(O){this.logger.warn("attempt to close websocket error",O)}this.clean()}},D.clean=function(){this.status="disconnected",this.websocket&&(this.websocket.onmessage=null,this.websocket.onopen=null,this.websocket.onerror=null,this.websocket.onclose=null,this.websocket=null,this.emit("disconnect"))},D.onConnect=function(){this.status="connected",this.resetCloseTimer(),this.emit("connect")},D._createWebsocket=function(O){var oe,xe=this;this.websocket=new ta.WebSocket(O),this.websocket.onmessage=Oo(oe=this.onMessage).call(oe,this),this.websocket.onclose=function(){xe.logger.log("imsocket:: receive websocket onclose event, current status",xe.status),xe.clean()},this.websocket.onerror=function(z){xe.logger.error("imsocket:: onerror",z)}},D.onMessage=function(O){var oe;this.resetCloseTimer();var xe=this.decodePacket(O.data);if(xe)switch(xe.type){case"connect":this.onConnect();break;case"disconnect":this.close();break;case"message":case"json":this.emit("message",xe.data);break;case"event":xe.name&&this.emit(xe.name,xe.args);break;case"error":xe.reason==="unauthorized"?this.emit("connect_failed",xe.reason):this.emit("error",xe.reason);break;case"heartbeat":(oe=this.websocket)===null||oe===void 0||oe.send(this.encodePacket({type:"heartbeat"}));break;default:this.logger.warn("imsocket::no handler type",xe.type)}},D.encodePacket=function(O){var oe,xe,z=O.type,qe=O.id,Lt=qe===void 0?"":qe,lr=O.endpoint,pr=lr===void 0?"":lr,Sr=O.ack,br=null;if(!z)return"";switch(z){case"error":oe=O.reason?pa(kg).call(kg,O.reason):"",xe=O.advice?pa(ap).call(ap,O.advice):"",oe===""&&xe===""||(br=oe+(xe!==""?"+"+xe:""));break;case"message":O.data!==""&&(br=O.data);break;case"event":oe={name:O.name},oe=O.args&&O.args.length?{name:O.name,args:O.args}:{name:O.name},br=mo(oe);break;case"json":br=mo(O.data);break;case"connect":O.qs&&(br=O.qs);break;case"ack":br=O.ackId+(O.args&&O.args.length?"+"+mo(O.args):"")}var Er=[pa(Mg).call(Mg,z),Lt+(Sr==="data"?"+":""),pr];return br!=null&&Er.push(br),Er.join(":")},D.decodePacket=function(O){if(O)if(O.charAt(0)!="�"){var oe=O.match(/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/);if(oe){var xe,z=oe[1],qe=oe[2],Lt=oe[3],lr=oe[4],pr=oe[5],Sr={type:Mg[+z],endpoint:lr};switch(qe&&(Sr.id=qe,Sr.ack=!Lt||"data"),Sr.type){case"error":xe=pr.split("+"),Sr.reason=kg[+xe[0]]||"";break;case"message":Sr.data=pr||"";break;case"connect":Sr.qs=pr||"";break;case"event":try{var br=JSON.parse(pr);Sr.name=br.name,Sr.args=br.args}catch(Er){this.logger.error("imsocket::parseData::type::event error",Er)}Sr.args=Sr.args||[];break;case"json":try{Sr.data=JSON.parse(pr)}catch(Er){this.logger.error("imsocket::parseData::type::json error",Er)}break;case"ack":if((xe=pr.match(/^([0-9]+)(\+)?(.*)/))&&(Sr.ackId=xe[1],Sr.args=[],xe[3]))try{Sr.args=xe[3]?JSON.parse(xe[3]):[]}catch(Er){this.logger.error("imsocket::parseData::type::ack error",Er)}}return Sr}}else this.logger.error("imsocket::unrecognize dataStr",Co(O).call(O,0,20))},D.send=function(O){var oe,xe={data:O,type:"message",endpoint:""};(oe=this.websocket)===null||oe===void 0||oe.send(this.encodePacket(xe))},D.resetCloseTimer=function(){var O=this;this.closeTimeout&&(clearTimeout(this.closeTimer),this.closeTimer=sa(function(){O.close()},this.closeTimeout))},x}(ug),sp=Uo("Array").values,gi=Array.prototype,sT={DOMTokenList:!0,NodeList:!0},ip=function(S){var x=S.values;return S===gi||er(gi,S)&&x===gi.values||Fr(sT,Bs(S))?sp:x};Vr({target:"Array",stat:!0},{isArray:Ya});var ns=or.Array.isArray,_g=bs.every,iT=Ds("every");Vr({target:"Array",proto:!0,forced:!iT},{every:function(x){return _g(this,x,arguments.length>1?arguments[1]:void 0)}});var hi=Uo("Array").every,wg=Array.prototype,Al=function(S){var x=S.every;return S===wg||er(wg,S)&&x===wg.every?hi:x},cs=function(x){return x!=null&&typeof x=="object"},Tv=function(x){return cs(x)&&Qs(x)=="[object RegExp]"},xg=function(x){return function(D){return x(D)}},Ol=o(function(S,x){var D=x&&!x.nodeType&&x,F=D&&S&&!S.nodeType&&S,O=F&&F.exports===D&&Xd.process,oe=function(){try{var xe=F&&F.require&&F.require("util").types;return xe||O&&O.binding&&O.binding("util")}catch{}}();S.exports=oe}),Ig=Ol&&Ol.isRegExp,cT=Ig?xg(Ig):Tv,Eg=Vs["__core-js_shared__"],Mc=function(){var S=/[^.]+$/.exec(Eg&&Eg.keys&&Eg.keys.IE_PROTO||"");return S?"Symbol(src)_1."+S:""}(),lT=function(x){return!!Mc&&Mc in x},uT=Function.prototype.toString,il=function(x){if(x!=null){try{return uT.call(x)}catch{}try{return x+""}catch{}}return""},dT=/^\[object .+?Constructor\]$/,pT=Function.prototype,fT=Object.prototype,mT=pT.toString,gT=fT.hasOwnProperty,cl=RegExp("^"+mT.call(gT).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),cd=function(x){return!(!pi(x)||lT(x))&&(Zd(x)?cl:dT).test(il(x))},hT=function(x,D){return x==null?void 0:x[D]},ll=function(x,D){var F=hT(x,D);return cd(F)?F:void 0},ld=ll(Object,"create"),vT=function(){this.__data__=ld?ld(null):{},this.size=0},yT=function(x){var D=this.has(x)&&delete this.__data__[x];return this.size-=D?1:0,D},bT=Object.prototype.hasOwnProperty,TT=function(x){var D=this.__data__;if(ld){var F=D[x];return F==="__lodash_hash_undefined__"?void 0:F}return bT.call(D,x)?D[x]:void 0},Nl=Object.prototype.hasOwnProperty,Sv=function(x){var D=this.__data__;return ld?D[x]!==void 0:Nl.call(D,x)},ST=function(x,D){var F=this.__data__;return this.size+=this.has(x)?0:1,F[x]=ld&&D===void 0?"__lodash_hash_undefined__":D,this};function nc(S){var x=-1,D=S==null?0:S.length;for(this.clear();++x<D;){var F=S[x];this.set(F[0],F[1])}}nc.prototype.clear=vT,nc.prototype.delete=yT,nc.prototype.get=TT,nc.prototype.has=Sv,nc.prototype.set=ST;var ud=nc,CT=function(){this.__data__=[],this.size=0},cp=function(x,D){return x===D||x!=x&&D!=D},lp=function(x,D){for(var F=x.length;F--;)if(cp(x[F][0],D))return F;return-1},MT=Array.prototype.splice,kT=function(x){var D=this.__data__,F=lp(D,x);return!(F<0)&&(F==D.length-1?D.pop():MT.call(D,F,1),--this.size,!0)},Rl=function(x){var D=this.__data__,F=lp(D,x);return F<0?void 0:D[F][1]},up=function(x){return lp(this.__data__,x)>-1},dd=function(x,D){var F=this.__data__,O=lp(F,x);return O<0?(++this.size,F.push([x,D])):F[O][1]=D,this};function Bl(S){var x=-1,D=S==null?0:S.length;for(this.clear();++x<D;){var F=S[x];this.set(F[0],F[1])}}Bl.prototype.clear=CT,Bl.prototype.delete=kT,Bl.prototype.get=Rl,Bl.prototype.has=up,Bl.prototype.set=dd;var dp=Bl,kc=ll(Vs,"Map"),_T=function(){this.size=0,this.__data__={hash:new ud,map:new(kc||dp),string:new ud}},wT=function(x){var D=typeof x;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?x!=="__proto__":x===null},pp=function(x,D){var F=x.__data__;return wT(D)?F[typeof D=="string"?"string":"hash"]:F.map},xT=function(x){var D=pp(this,x).delete(x);return this.size-=D?1:0,D},Fl=function(x){return pp(this,x).get(x)},fp=function(x){return pp(this,x).has(x)},IT=function(x,D){var F=pp(this,x),O=F.size;return F.set(x,D),this.size+=F.size==O?0:1,this};function Ll(S){var x=-1,D=S==null?0:S.length;for(this.clear();++x<D;){var F=S[x];this.set(F[0],F[1])}}Ll.prototype.clear=_T,Ll.prototype.delete=xT,Ll.prototype.get=Fl,Ll.prototype.has=fp,Ll.prototype.set=IT;var ul=Ll,Pg=function(x){return this.__data__.set(x,"__lodash_hash_undefined__"),this},Cv=function(x){return this.__data__.has(x)};function mp(S){var x=-1,D=S==null?0:S.length;for(this.__data__=new ul;++x<D;)this.add(S[x])}mp.prototype.add=mp.prototype.push=Pg,mp.prototype.has=Cv;var Ag=mp,ET=function(x,D,F,O){for(var oe=x.length,xe=F+(O?1:-1);O?xe--:++xe<oe;)if(D(x[xe],xe,x))return xe;return-1},Mv=function(x){return x!=x},kv=function(x,D,F){for(var O=F-1,oe=x.length;++O<oe;)if(x[O]===D)return O;return-1},Og=function(x,D,F){return D==D?kv(x,D,F):ET(x,Mv,F)},gp=function(x,D){return!!(x!=null&&x.length)&&Og(x,D,0)>-1},_v=function(x,D,F){for(var O=-1,oe=x==null?0:x.length;++O<oe;)if(F(D,x[O]))return!0;return!1},$l=function(x,D){for(var F=-1,O=x==null?0:x.length,oe=Array(O);++F<O;)oe[F]=D(x[F],F,x);return oe},Ng=function(x,D){return x.has(D)},Rg=function(x,D,F,O){var oe=-1,xe=gp,z=!0,qe=x.length,Lt=[],lr=D.length;if(!qe)return Lt;F&&(D=$l(D,xg(F))),O?(xe=_v,z=!1):D.length>=200&&(xe=Ng,z=!1,D=new Ag(D));e:for(;++oe<qe;){var pr=x[oe],Sr=F==null?pr:F(pr);if(pr=O||pr!==0?pr:0,z&&Sr==Sr){for(var br=lr;br--;)if(D[br]===Sr)continue e;Lt.push(pr)}else xe(D,Sr,O)||Lt.push(pr)}return Lt},hp=function(x){return x},wv=function(x,D,F){switch(F.length){case 0:return x.call(D);case 1:return x.call(D,F[0]);case 2:return x.call(D,F[0],F[1]);case 3:return x.call(D,F[0],F[1],F[2])}return x.apply(D,F)},pd=Math.max,xv=function(x,D,F){return D=pd(D===void 0?x.length-1:D,0),function(){for(var O=arguments,oe=-1,xe=pd(O.length-D,0),z=Array(xe);++oe<xe;)z[oe]=O[D+oe];oe=-1;for(var qe=Array(D+1);++oe<D;)qe[oe]=O[oe];return qe[D]=F(z),wv(x,this,qe)}},PT=function(x){return function(){return x}},vp=function(){try{var S=ll(Object,"defineProperty");return S({},"",{}),S}catch{}}(),Iv=vp?function(S,x){return vp(S,"toString",{configurable:!0,enumerable:!1,value:PT(x),writable:!0})}:hp,Bg=Date.now,yp=function(x){var D=0,F=0;return function(){var O=Bg(),oe=16-(O-F);if(F=O,oe>0){if(++D>=800)return arguments[0]}else D=0;return x.apply(void 0,arguments)}},Ev=yp(Iv),Pv=function(x,D){return Ev(xv(x,D,hp),x+"")},Fg=function(x){return typeof x=="number"&&x>-1&&x%1==0&&x<=9007199254740991},bp=function(x){return x!=null&&Fg(x.length)&&!Zd(x)},En=function(x){return cs(x)&&bp(x)},AT=Pv(function(S,x){return En(S)?Rg(S,x):[]}),jl=AT;function OT(S,x){return x instanceof RegExp?"__REGEXP "+x.toString():x}function Gr(S,x,D){var F;x===void 0&&(x={});var O={};return In(F=na(S)).call(F,function(oe){var xe=S[oe].type,z=D?"In "+D+", ":"";if(x[oe]===void 0){if(S[oe].required===!1)return void(O[oe]=x[oe]);throw new al(z+'param "'+oe+'" is required',{key:oe},"required")}var qe=NT[xe];if(qe&&!qe(x,oe,S[oe]))throw new al(z+'param "'+oe+'" expects '+mo(S[oe],OT),{key:oe,value:x[oe]},mo(S[oe]));O[oe]=x[oe]}),O}var NT={string:function(x,D,F){var O=F.allowEmpty,oe=F.max,xe=F.min,z=F.regExp,qe=x[D];return typeof qe=="string"&&(O!==!1||qe!=="")&&!(typeof oe=="number"&&qe.length>oe)&&!(typeof xe=="number"&&qe.length<xe)&&!(cT(z)&&!z.test(qe))},number:function(x,D,F){var O=F.min,oe=F.max,xe=x[D];return typeof xe=="number"&&!(typeof O=="number"&&xe<O)&&!(typeof oe=="number"&&xe>oe)},boolean:function(x,D){return typeof x[D]=="boolean"},enum:function(x,D,F){var O=ip(F),oe=x[D];return!O||pa(O).call(O,oe)>-1},array:function(x,D,F){var O,oe=F.itemType,xe=F.rules,z=F.min,qe=F.max,Lt=ip(F),lr=x[D];return!!ns(lr)&&!(typeof qe=="number"&&lr.length>qe)&&!(typeof z=="number"&&lr.length<z)&&!(oe&&oe!=="enum"&&!Al(lr).call(lr,function(pr){return typeof pr===oe}))&&(oe!=="enum"||!Lt||!jl.apply(void 0,qs(O=[lr]).call(O,Lt)).length)&&(xe&&In(lr).call(lr,function(pr,Sr){return Gr(xe,pr,D+"["+Sr+"]")}),!0)},object:function(x,D,F){var O=F.rules,oe=x[D];return O&&Gr(O,oe,D),!0}},Dl=ll(Vs,"Set"),RT=function(){},Tp=function(x){var D=-1,F=Array(x.size);return x.forEach(function(O){F[++D]=O}),F},Lg=Dl&&1/Tp(new Dl([,-0]))[1]==1/0?function(S){return new Dl(S)}:RT,Av=Lg,Sp=function(x,D,F){var O=-1,oe=gp,xe=x.length,z=!0,qe=[],Lt=qe;if(F)z=!1,oe=_v;else if(xe>=200){var lr=D?null:Av(x);if(lr)return Tp(lr);z=!1,oe=Ng,Lt=new Ag}else Lt=D?[]:qe;e:for(;++O<xe;){var pr=x[O],Sr=D?D(pr):pr;if(pr=F||pr!==0?pr:0,z&&Sr==Sr){for(var br=Lt.length;br--;)if(Lt[br]===Sr)continue e;D&&Lt.push(Sr),qe.push(pr)}else oe(Lt,Sr,F)||(Lt!==qe&&Lt.push(Sr),qe.push(pr))}return qe},BT=function(x){return x&&x.length?Sp(x):[]},$g=`	
\v\f\r                　\u2028\u2029\uFEFF`,Cp=he("".replace),Mp="["+$g+"]",fd=RegExp("^"+Mp+Mp+"*"),Ov=RegExp(Mp+Mp+"*$"),kp=function(S){return function(x){var D=Aa(fr(x));return 1&S&&(D=Cp(D,fd,"")),2&S&&(D=Cp(D,Ov,"")),D}},Nv={start:kp(1),end:kp(2),trim:kp(3)}.trim,md=c.parseInt,jg=c.Symbol,Pi=jg&&jg.iterator,_o=/^[+-]?0x/i,_p=he(_o.exec),vi=md($g+"08")!==8||md($g+"0x16")!==22||Pi&&!d(function(){md(Object(Pi))})?function(x,D){var F=Nv(Aa(x));return md(F,D>>>0||(_p(_o,F)?16:10))}:md;Vr({global:!0,forced:parseInt!=vi},{parseInt:vi});var Ai,Lo=or.parseInt,Dg=(Ai=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return Ai()+Ai()+Ai()+Ai()+Ai()+Ai()+Ai()+Ai()});function ia(S){var x;return Js(x=na(S)).call(x,function(D){return!(+D>=0)})}function Rv(S,x){var D,F=Js(D=na(S)).call(D,function(O){return S[O]==x});return F.length>0?F[0]:void 0}var FT=TypeError,wp=Object.getOwnPropertyDescriptor,LT=Ne&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(S){return S instanceof TypeError}}()?function(S,x){if(Ya(S)&&!wp(S,"length").writable)throw FT("Cannot set read only .length");return S.length=x}:function(S,x){return S.length=x},$T=TypeError,xp=function(S,x){if(!delete S[x])throw $T("Cannot delete property "+Rr(x)+" of "+Rr(S))},jT=Di("splice"),Ug=Math.max,qg=Math.min;Vr({target:"Array",proto:!0,forced:!jT},{splice:function(x,D){var F,O,oe,xe,z,qe,Lt=$n(this),lr=Ia(Lt),pr=ri(x,lr),Sr=arguments.length;for(Sr===0?F=O=0:Sr===1?(F=0,O=lr-pr):(F=Sr-2,O=qg(Ug(Li(D),0),lr-pr)),uu(lr+F-O),oe=fu(Lt,O),xe=0;xe<O;xe++)(z=pr+xe)in Lt&&Rs(oe,xe,Lt[z]);if(oe.length=O,F<O){for(xe=pr;xe<lr-O;xe++)qe=xe+F,(z=xe+O)in Lt?Lt[qe]=Lt[z]:xp(Lt,qe);for(xe=lr;xe>lr-O+F;xe--)xp(Lt,xe-1)}else if(F>O)for(xe=lr-O;xe>pr;xe--)qe=xe+F-1,(z=xe+O-1)in Lt?Lt[qe]=Lt[z]:xp(Lt,qe);for(xe=0;xe<F;xe++)Lt[xe+pr]=arguments[xe+2];return LT(Lt,lr-O+F),oe}});var DT=Uo("Array").splice,Ip=Array.prototype,Bv=function(S){var x=S.splice;return S===Ip||er(Ip,S)&&x===Ip.splice?DT:x},Ep=function(S,x,D,F){try{return F?x(Vn(D)[0],D[1]):x(D)}catch(O){Ou(S,"throw",O)}},gd=Array,Fv=!Gm(function(S){Array.from(S)});Vr({target:"Array",stat:!0,forced:Fv},{from:function(x){var D=$n(x),F=Uc(this),O=arguments.length,oe=O>1?arguments[1]:void 0,xe=oe!==void 0;xe&&(oe=$o(oe,O>2?arguments[2]:void 0));var z,qe,Lt,lr,pr,Sr,br=Jc(D),Er=0;if(!br||this===gd&&fm(br))for(z=Ia(D),qe=F?new this(z):gd(z);z>Er;Er++)Sr=xe?oe(D[Er],Er):D[Er],Rs(qe,Er,Sr);else for(pr=(lr=Wi(D,br)).next,qe=F?new this:[];!(Lt=Ce(pr,lr)).done;Er++)Sr=xe?Ep(lr,oe,[Lt.value,Er],!0):Lt.value,Rs(qe,Er,Sr);return qe.length=Er,qe}});var _c=or.Array.from,Va=Jc;function Lv(S,x){var D,F=ha!==void 0&&Va(S)||S["@@iterator"];if(F)return Oo(D=(F=F.call(S)).next).call(D,F);if(ns(S)||(F=function(xe,z){var qe;if(xe){if(typeof xe=="string")return $v(xe,z);var Lt=Co(qe=Object.prototype.toString.call(xe)).call(qe,8,-1);if(Lt==="Object"&&xe.constructor&&(Lt=xe.constructor.name),Lt==="Map"||Lt==="Set")return _c(xe);if(Lt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Lt))return $v(xe,z)}}(S))||x&&S&&typeof S.length=="number"){F&&(S=F);var O=0;return function(){return O>=S.length?{done:!0}:{done:!1,value:S[O++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $v(S,x){(x==null||x>S.length)&&(x=S.length);for(var D=0,F=new Array(x);D<x;D++)F[D]=S[D];return F}var ls,jv=function(){function S(){this.timerList=[],this.id=0,this.timer=null,this.timeout=0}var x=S.prototype;return x.addTimer=function(F,O,oe){O===void 0&&(O=0),oe===void 0&&(oe=1);var xe=new Date().getTime(),z=this.id;return this.timerList.push({id:z,loop:oe,count:0,timeout:xe+O,interval:O,callback:F}),this.id++,this.checkTimer(xe),z},x.checkTimer=function(F){if(F===void 0&&(F=new Date().getTime()),this.removeFinished(),this.timerList.length!==0||this.timer==null){for(var O,oe,xe=0,z=Lv(this.timerList);!(O=z()).done;){var qe=O.value;(xe===0||xe>qe.timeout)&&(xe=qe.timeout)}this.timerList.length!==0&&(this.timer===null||xe<this.timeout||this.timeout<F)&&(this.timer=sa(Oo(oe=this.nowTime).call(oe,this),xe-F),this.timeout=xe)}},x.nowTime=function(){for(var F,O=new Date().getTime(),oe=Lv(this.timerList);!(F=oe()).done;){var xe=F.value;O>=xe.timeout&&(xe.callback(),xe.count++,xe.timeout=O+xe.interval)}this.clerTime(),this.checkTimer(O)},x.clerTime=function(){this.timer!==null&&(clearTimeout(this.timer),this.timer=null)},x.deleteTimer=function(F){for(var O=this.timerList.length-1;O>=0;O--){var oe;this.timerList[O].id===F&&Bv(oe=this.timerList).call(oe,O,1)}},x.removeFinished=function(){for(var F=this.timerList.length-1;F>=0;F--){var O,oe=this.timerList[F];oe.loop>=0&&oe.count>=oe.loop&&Bv(O=this.timerList).call(O,F,1)}},x.destroy=function(){this.clerTime(),this.timerList=[],this.id=0,this.timer=null},S}(),Dv=function(){function S(D){this.core=D}var x=S.prototype;return x.request=function(F,O){var oe=this,xe=new Date().getTime();return ta.request(F,O).catch(function(z){var qe,Lt,lr=z;throw oe.core.reporter.reportTraceStart("exceptions",{user_id:oe.core.options.account,trace_id:(Lt=(qe=oe.core)===null||qe===void 0?void 0:qe.socket)===null||Lt===void 0?void 0:Lt.sessionId,start_time:xe,action:1}),oe.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof lr.code=="number"?lr.code:0,description:lr.message||""+lr.code,operation_type:0,target:F,context:O?mo(O):""}),oe.core.reporter.reportTraceEnd("exceptions",1),z})},x.uploadFile=function(F){var O=this,oe=new Date().getTime();return ta.uploadFile(F).catch(function(xe){var z,qe,Lt=xe;O.core.reporter.reportTraceStart("exceptions",{user_id:O.core.options.account,trace_id:(qe=(z=O.core)===null||z===void 0?void 0:z.socket)===null||qe===void 0?void 0:qe.sessionId,start_time:oe,action:1});var lr=ta.platform==="BROWSER"?F.chunkUploadHost:F.commonUploadHost?F.commonUploadHost+"/"+(F.nosToken&&F.nosToken.bucket):"https://nos.netease.com/nim";throw O.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof Lt.code=="number"?Lt.code:0,description:Lt.message||""+Lt.code,operation_type:1,target:lr}),O.core.reporter.reportTraceEnd("exceptions",1),xe})},S}();(function(S){S[S.ACTIVE=1]="ACTIVE",S[S.KICKED=2]="KICKED",S[S.OFFLINE=3]="OFFLINE"})(ls||(ls={}));var Uv=window&&Zd(window.addEventListener)&&Zd(window.removeEventListener),hd=function(S){function x(F,O){var oe;(oe=S.call(this)||this).status="unconnected",oe.linkUrls=[],oe.eventBus=new ug,oe.packetSer=1,oe.retryCount=0,oe.reconnectTimer=0,oe.backoff=new U1({max:8e3,min:1600,jitter:.01}),oe.sendingCmdMap=new nl,oe.pingTimer=0,oe.config=cv,oe.abtInfo={},Gr({linkUrls:{type:"array",itemType:"string",required:!1}},F),oe.options=Tn(Tn({},lv),F),oe.adapters=new Dv(i(oe));var xe=ta.localStorage.getItem("__NIM_DEVC_ID__");oe.options.isFixedDeviceId?(xe=ta.localStorage.getItem("__NIM_DEVC_ID__")||Dg(),ta.localStorage.setItem("__NIM_DEVC_ID__",xe)):xe=Dg(),oe.config=Tn(Tn(Tn({},cv),O),{deviceId:xe}),oe.timerManager=new jv,oe.logger=new gv(oe.options.debugLevel,oe.options.account);var z=ta.getSystemInfo();return oe.reporter=new hv({common:{app_key:F.appkey,dev_id:xe,platform:"Web",sdk_ver:"0.13.1",env:"online",os_name:z.os,os_ver:z.osVer,model:z.hostEnvVer,manufactor:z.hostEnv,host_env:z.hostEnv,host_info:z.hostInfo,host_env_ver:z.hostEnvVer},request:ta.request,logger:oe.logger,autoStart:ta.platform==="BROWSER"}),ta.setLogger(oe.logger),oe.logger.log("Core init, version ","0.13.1"," sdk version ",91001," appkey ",F.appkey),oe}Ro(x,S);var D=x.prototype;return D.emit=function(O){try{for(var oe,xe,z=ts(),qe=arguments.length,Lt=new Array(qe>1?qe-1:0),lr=1;lr<qe;lr++)Lt[lr-1]=arguments[lr];var pr=(oe=S.prototype.emit).call.apply(oe,qs(xe=[this,O]).call(xe,Lt)),Sr=ts()-z;return Sr>=10&&this.logger.warn("Core::emit event: "+O+" process takes: "+Sr+"ms"),pr}catch(br){return this.logger.error("Core::emit event: "+O+". Error: "+br),!1}},D.connect=function(O,oe){return O===void 0&&(O={}),Mr(this,void 0,void 0,ar.mark(function xe(){var z,qe,Lt,lr,pr,Sr;return ar.wrap(function(Er){for(;;)switch(Er.prev=Er.next){case 0:if(Gr({linkUrls:{type:"array",itemType:"string",required:!1}},O),/^(unconnected|waitReconnect)$/.test(this.status)){Er.next=5;break}return z="Core socket status is "+this.status+", and would not connect",this.logger.warn(z),Er.abrupt("return",co.reject(z));case 5:this.status="connecting",O.linkUrls&&O.linkUrls.length>0&&(this.linkUrls=qs(qe=O.linkUrls).call(qe,this.linkUrls),this.linkUrls=BT(this.linkUrls)),this.linkUrls.length===0&&this.linkUrls.push("weblink.netease.im:443"),Lt=0;case 9:if(!(Lt<this.linkUrls.length)){Er.next=32;break}return lr=this.linkUrls[Lt],pr=new Date().getTime(),Er.prev=12,Er.next=15,this.doConnect(lr);case 15:return this.status="connected",this.logger.log("core:: connect success with url: "+lr),this.abtRequest(),Er.abrupt("return",lr);case 21:Er.prev=21,Er.t0=Er.catch(12),Sr=Er.t0,oe&&oe(Sr,lr),this.reporter.reportTraceStart("exceptions",{user_id:this.options.account,start_time:pr,action:0}),this.reporter.reportTraceUpdateV2("exceptions",{code:typeof Sr.code=="number"?Sr.code:0,description:Sr.message||""+Sr.code,operation_type:0,target:lr}),this.reporter.reportTraceEnd("exceptions",1),this.logger.warn("core:: connect failed with url: "+lr,Er.t0);case 29:Lt++,Er.next=9;break;case 32:throw this.retryCount===0?this.doDisconnect(ls.ACTIVE,"SocketHandshakeFailed"):this.doDisconnect(ls.OFFLINE,"ReconnectHadRetryAllLinks"),new Error("core: socket handshake failed");case 34:case"end":return Er.stop()}},xe,this,[[12,21]])}))},D.doConnect=function(O){var oe=this;return new co(function(xe,z){var qe;oe.socket=new aT(oe,O,oe.logger),oe.socket.on("connect",function(){oe.logger.log("socket on connect",O),xe()}),oe.socket.on("message",Oo(qe=oe.onMessage).call(qe,oe)),oe.socket.on("disconnect",function(Lt){oe.logger.log("core:: socket on disconnect",Lt),oe.doDisconnect(ls.OFFLINE,"SocketOnDisconnect")}),oe.socket.on("handshakeFailed",function(){oe.logger.warn("core:: socket handshake failed"),z(new yo("handshake failed",{},408))})})},D.resetConnectStatus=function(){clearTimeout(this.reconnectTimer),this.backoff.reset(),this.retryCount=0,this.initOnlineListener()},D.doDisconnect=function(O,oe){if(this.logger.log("doDisconnect: type "+O+", description "+oe),this.status!=="unconnected"){this.markAllCmdInvaild(new yo("Packet timeout due to instance disconnect",{},408)),this.timerManager.destroy(),clearTimeout(this.pingTimer),this.socket&&(typeof this.socket.removeAllListeners=="function"&&this.socket.removeAllListeners(),typeof this.socket.close=="function"&&this.socket.close(),this.socket=void 0);var xe=!this.options.needReconnect||this.retryCount>=this.options.reconnectionAttempts;if(O===ls.ACTIVE||xe)this.logger.log("doDisconnect: emit disconnect, type "+O,xe),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.eventBus.emit("disconnect"),this.emit("disconnect"),this.destroyOnlineListener();else if(O===ls.KICKED){this.logger.log("doDisconnect: kicked"),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer);var z=typeof oe=="string"?{reason:"unknow",message:oe}:oe;this.eventBus.emit("kicked",z),this.emit("kicked",z),this.destroyOnlineListener()}else O===ls.OFFLINE?(this.logger.log("doDisconnect: start to reconnect"),this.attempToReconnect()):this.logger.log("doDisconnect: nothing to do")}else this.logger.warn("doDisconnect: already unconnected")},D.attempToReconnect=function(){var O=this;if(this.status!=="waitReconnect"){var oe=this.backoff.duration();this.retryCount++,this.logger.log("willReconnect "+this.retryCount+" "+oe),this.eventBus.emit("willReconnect",{retryCount:this.retryCount,duration:oe}),this.emit("willReconnect",{retryCount:this.retryCount,duration:oe}),this.status="waitReconnect",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=sa(function(){O.status==="waitReconnect"?O.connect({isAutoReconnect:!0}).catch(function(){O.logger.error("core::attempToReconnect failed "+O.retryCount)}):O.logger.warn("doDisconnect: reconnectTimer status is "+O.status+", would not go on reconnecting")},oe)}else this.logger.warn("doDisconnect: already is waiting reconnect")},D.sendCmd=function(O,oe,xe){var z=this;if(this.status!=="logined"&&O!=="login"&&O!=="chatroomLogin"&&O!=="qchatLogin")return this.logger.warn("nim status is "+this.status+", so can not sendCmd "+O),co.reject({cmd:O,error:{code:"No_connected",message:"Connection not established",timetag:new Date().getTime()}});if(!this.socket||!this.socket.send)return co.reject("No_socket");var qe=O!=="heartbeat",Lt=qe?this.packetSer++:0,lr=function(vn,Xr,wn,hn){var Gn=id[vn];if(!Gn)return wn.error("createCmd:: can not find cmd config: ",vn),null;var Dn,jo={SER:Xr,SID:Gn.sid,CID:Gn.cid,Q:[]};return Gn.params&&hn&&In(Dn=Gn.params).call(Dn,function(jn){var wr=hn[jn.name];if(!bv(wr)){var xn=jn.type,Nn=jn.reflectMapper;switch(jn.type){case"PropertyArray":xn="ArrayMable",wr=vo(wr).call(wr,function(Cn){return{t:"Property",v:Nn?rs(Cn,Nn):Cn}});break;case"Property":wr=Nn?rs(wr,Nn):wr;break;case"Bool":case"bool":wr=wr?"true":"false"}jo.Q.push({t:xn,v:wr})}}),{packet:jo,isNoResponse:Gn.isNoResponse||!1}}(O,Lt,this.logger,oe);if(!lr){var pr="SendCmd "+Lt+" "+O+" error";return this.logger.error(pr),co.reject(pr)}var Sr=lr.packet,br=lr.isNoResponse,Er=mo(Sr);qe&&(this.options.debugLevel==="debug"?this.logger.debug("core::sendCmd",O,"ser:"+Lt,Er):this.logger.log("core::sendCmd",O,"ser:"+Lt));var Dr=new Date().getTime();return new co(function($r,vn){z.sendingCmdMap.set(Lt,{cmd:O,params:oe,callback:[$r,vn],timer:br?null:sa(function(){var wn,hn=new Tg(504,O,"Packet Timeout",new Date().getTime(),{message:"ser "+Lt+" cmd "+O+" timeout"});hn.callFunc="sendCmd",z.markCmdInvalid(Lt,hn,O),z.reporter.reportTraceStart("exceptions",{user_id:z.options.account,trace_id:(wn=z.socket)===null||wn===void 0?void 0:wn.sessionId,start_time:Dr,action:2}),z.reporter.reportTraceUpdateV2("exceptions",{code:408,description:"Packet timeout",operation_type:1,target:Sr.SID+"-"+Sr.CID,context:""+Sr.SER}),z.reporter.reportTraceEnd("exceptions",1)},xe&&xe.timeout?xe.timeout:z.config.timeout)});try{z.socket.send(Er)}catch(wn){var Xr=new Tg(415,O,wn&&wn.message||"Unable to send packet",new Date().getTime(),{message:"send json error",rawError:wn});Xr.callFunc="sendCmd",z.markCmdInvalid(Lt,Xr,O),vn(wn)}})},D.onMessage=function(O){var oe=qa(O,this.logger);if(oe){var xe=oe.raw.ser;if(oe.error&&this.logger.error("core:onMessage packet error",oe.raw.sid+"_"+oe.raw.cid+", ser:"+xe+",",oe.error),!oe.notFound)return oe.cmd!=="heartbeat"&&(this.options.debugLevel==="debug"?this.logger.debug("imsocket::recvCmd ser:"+xe,oe.cmd,oe.content):this.logger.log("imsocket::recvCmd ser:"+xe,oe.cmd)),oe.__receiveTime=ts(),oe;this.logger.warn("core::onMessage packet not found",oe.raw.sid+"_"+oe.raw.cid+", ser:"+xe)}},D.markCmdInvalid=function(O,oe,xe){var z=this.sendingCmdMap.get(O);if(z){var qe=z.callback,Lt=z.timer;Lt&&clearTimeout(Lt),this.sendingCmdMap.delete(O),this.logger.warn("packet "+O+", "+xe+" is invalid:",oe),qe[1](oe)}},D.markAllCmdInvaild=function(O){var oe;this.logger.log("markAllCmdInvaild"),In(oe=this.sendingCmdMap).call(oe,function(xe){var z=xe.callback,qe=xe.timer;qe&&clearTimeout(qe),z[1](O)}),this.sendingCmdMap.clear()},D.ping=function(){return Mr(this,void 0,void 0,ar.mark(function O(){var oe=this;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return clearTimeout(this.pingTimer),z.prev=1,z.next=4,this.sendCmd("heartbeat");case 4:z.next=14;break;case 6:return z.prev=6,z.t0=z.catch(1),z.next=10,this.testHeartBeat5Timeout();case 10:if(!z.sent){z.next=14;break}return this.doDisconnect(ls.OFFLINE,"PingError"),z.abrupt("return");case 14:this.pingTimer=sa(function(){oe.ping()},3e4);case 15:case"end":return z.stop()}},O,this,[[1,6]])}))},D.testHeartBeat5Timeout=function(){return Mr(this,void 0,void 0,ar.mark(function O(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:clearTimeout(this.pingTimer),oe=0;case 2:if(!(oe<5)){z.next=15;break}return z.prev=3,z.next=6,this.sendCmd("heartbeat",{},{timeout:3e3});case 6:return z.abrupt("return",!1);case 9:z.prev=9,z.t0=z.catch(3),this.logger.debug("core:: test heartbeat "+oe+" Timeout");case 12:oe++,z.next=2;break;case 15:return z.abrupt("return",!0);case 16:case"end":return z.stop()}},O,this,[[3,9]])}))},D.initOnlineListener=function(){var O,oe;this.onlineListener||(Uv?(this.onlineListener=Oo(O=function(){this.status==="logined"&&this.ping()}).call(O,this),this.offlineListener=Oo(oe=function(){this.logger.log("offline"),this.doDisconnect(ls.OFFLINE,"OfflineListener")}).call(oe,this),window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener)):this.logger.warn("initOnlineListener not support add listener"))},D.destroyOnlineListener=function(){this.onlineListener&&(window.removeEventListener("online",this.onlineListener),this.onlineListener=void 0),this.offlineListener&&(window.removeEventListener("offline",this.offlineListener),this.offlineListener=void 0)},D.disconnect=function(){switch(this.status){case"connected":case"logined":case"connecting":case"waitReconnect":return this.doDisconnect(ls.ACTIVE,"UserActiveDisconnect"),co.resolve();case"unconnected":case"destroyed":return co.resolve()}},D.destroy=function(){var O=this;return this.disconnect().then(function(){O.status="destroyed",O.removeAllListeners(),O.eventBus.removeAllListeners(),O.reporter.destroy(),O.connect=function(){return co.resolve()},O.disconnect=function(){return co.resolve()},O.destroy=function(){return co.resolve()}})},D.abtRequest=function(){var O,oe;return Mr(this,void 0,void 0,ar.mark(function xe(){var z,qe;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:if(this.options.isAbtestEnable){lr.next=2;break}return lr.abrupt("return");case 2:if(!this.abtInfo.experiments){lr.next=4;break}return lr.abrupt("return");case 4:if(this.options.abtestUrl){lr.next=6;break}return lr.abrupt("return");case 6:return lr.prev=6,lr.next=9,this.adapters.request(this.options.abtestUrl,{method:"POST",dataType:"json",headers:{sdktype:"ABTest"},data:{clientInfo:{projectKey:this.options.abtestProjectKey,appKey:this.options.appkey,osType:"Web",sdkVersion:"0.13.1",deviceId:this.config.deviceId},useLocalCache:!0}});case 9:z=lr.sent,lr.next=15;break;case 12:lr.prev=12,lr.t0=lr.catch(6),this.logger.warn("ABTest request failed");case 15:this.abtInfo=((oe=(O=z==null?void 0:z.data)===null||O===void 0?void 0:O.data)===null||oe===void 0?void 0:oe.abtInfo)||{},this.abtInfo.experiments&&this.abtInfo.experiments.length>0&&this.reporter.reportImmediately("https://statistic.live.126.net/statics/report/abtest/result",{params:{app_key:this.options.appkey,biz_sdk_type:"IM",sdk_ver:"0.13.1",device_id:this.config.deviceId,platform:"Web",projectKey:this.options.abtestProjectKey,experiments:vo(qe=this.abtInfo.experiments).call(qe,function(pr){return{experimentKey:pr.experimentKey,schemeKey:pr.schemeKey}})},headers:{sdktype:"ABTest"},method:"POST",dataType:"json"});case 17:case"end":return lr.stop()}},xe,this,[[6,12]])}))},x}(ug);hd.setAdapters=function(x){Tn(ta,x)};var qv=bs.some,yi=Ds("some");Vr({target:"Array",proto:!0,forced:!yi},{some:function(x){return qv(this,x,arguments.length>1?arguments[1]:void 0)}});var Pp=Uo("Array").some,Vg=Array.prototype,Ap=function(S){var x=S.some;return S===Vg||er(Vg,S)&&x===Vg.some?Pp:x},Hg=function(){this.__data__=new dp,this.size=0},zg=function(x){var D=this.__data__,F=D.delete(x);return this.size=D.size,F},UT=function(x){return this.__data__.get(x)},qT=function(x){return this.__data__.has(x)},VT=function(x,D){var F=this.__data__;if(F instanceof dp){var O=F.__data__;if(!kc||O.length<199)return O.push([x,D]),this.size=++F.size,this;F=this.__data__=new ul(O)}return F.set(x,D),this.size=F.size,this};function Ul(S){var x=this.__data__=new dp(S);this.size=x.size}Ul.prototype.clear=Hg,Ul.prototype.delete=zg,Ul.prototype.get=UT,Ul.prototype.has=qT,Ul.prototype.set=VT;var Op=Ul,Vv=function(x,D){for(var F=-1,O=x==null?0:x.length;++F<O;)if(D(x[F],F,x))return!0;return!1},Kg=function(x,D,F,O,oe,xe){var z=1&F,qe=x.length,Lt=D.length;if(qe!=Lt&&!(z&&Lt>qe))return!1;var lr=xe.get(x),pr=xe.get(D);if(lr&&pr)return lr==D&&pr==x;var Sr=-1,br=!0,Er=2&F?new Ag:void 0;for(xe.set(x,D),xe.set(D,x);++Sr<qe;){var Dr=x[Sr],$r=D[Sr];if(O)var vn=z?O($r,Dr,Sr,D,x,xe):O(Dr,$r,Sr,x,D,xe);if(vn!==void 0){if(vn)continue;br=!1;break}if(Er){if(!Vv(D,function(Xr,wn){if(!Ng(Er,wn)&&(Dr===Xr||oe(Dr,Xr,F,O,xe)))return Er.push(wn)})){br=!1;break}}else if(Dr!==$r&&!oe(Dr,$r,F,O,xe)){br=!1;break}}return xe.delete(x),xe.delete(D),br},Hv=Vs.Uint8Array,HT=function(x){var D=-1,F=Array(x.size);return x.forEach(function(O,oe){F[++D]=[oe,O]}),F},vd=wi?wi.prototype:void 0,dl=vd?vd.valueOf:void 0,Wg=function(x,D,F,O,oe,xe,z){switch(F){case"[object DataView]":if(x.byteLength!=D.byteLength||x.byteOffset!=D.byteOffset)return!1;x=x.buffer,D=D.buffer;case"[object ArrayBuffer]":return!(x.byteLength!=D.byteLength||!xe(new Hv(x),new Hv(D)));case"[object Boolean]":case"[object Date]":case"[object Number]":return cp(+x,+D);case"[object Error]":return x.name==D.name&&x.message==D.message;case"[object RegExp]":case"[object String]":return x==D+"";case"[object Map]":var qe=HT;case"[object Set]":var Lt=1&O;if(qe||(qe=Tp),x.size!=D.size&&!Lt)return!1;var lr=z.get(x);if(lr)return lr==D;O|=2,z.set(x,D);var pr=Kg(qe(x),qe(D),O,oe,xe,z);return z.delete(x),pr;case"[object Symbol]":if(dl)return dl.call(x)==dl.call(D)}return!1},As=function(x,D){for(var F=-1,O=D.length,oe=x.length;++F<O;)x[oe+F]=D[F];return x},Oi=Array.isArray,Np=function(x,D,F){var O=D(x);return Oi(x)?O:As(O,F(x))},Fa=function(x,D){for(var F=-1,O=x==null?0:x.length,oe=0,xe=[];++F<O;){var z=x[F];D(z,F,x)&&(xe[oe++]=z)}return xe},zv=function(){return[]},Gg=Object.prototype.propertyIsEnumerable,Qg=Object.getOwnPropertySymbols,zT=Qg?function(S){return S==null?[]:(S=Object(S),Fa(Qg(S),function(x){return Gg.call(S,x)}))}:zv,Jg=zT,KT=function(x,D){for(var F=-1,O=Array(x);++F<x;)O[F]=D(F);return O},Rp=function(x){return cs(x)&&Qs(x)=="[object Arguments]"},Yg=Object.prototype,ql=Yg.hasOwnProperty,WT=Yg.propertyIsEnumerable,Xg=Rp(function(){return arguments}())?Rp:function(S){return cs(S)&&ql.call(S,"callee")&&!WT.call(S,"callee")},Zg=Xg,GT=function(){return!1},eh=o(function(S,x){var D=x&&!x.nodeType&&x,F=D&&S&&!S.nodeType&&S,O=F&&F.exports===D?Vs.Buffer:void 0,oe=(O?O.isBuffer:void 0)||GT;S.exports=oe}),Kv=/^(?:0|[1-9]\d*)$/,yd=function(x,D){var F=typeof x;return!!(D=D??9007199254740991)&&(F=="number"||F!="symbol"&&Kv.test(x))&&x>-1&&x%1==0&&x<D},Ca={};Ca["[object Float32Array]"]=Ca["[object Float64Array]"]=Ca["[object Int8Array]"]=Ca["[object Int16Array]"]=Ca["[object Int32Array]"]=Ca["[object Uint8Array]"]=Ca["[object Uint8ClampedArray]"]=Ca["[object Uint16Array]"]=Ca["[object Uint32Array]"]=!0,Ca["[object Arguments]"]=Ca["[object Array]"]=Ca["[object ArrayBuffer]"]=Ca["[object Boolean]"]=Ca["[object DataView]"]=Ca["[object Date]"]=Ca["[object Error]"]=Ca["[object Function]"]=Ca["[object Map]"]=Ca["[object Number]"]=Ca["[object Object]"]=Ca["[object RegExp]"]=Ca["[object Set]"]=Ca["[object String]"]=Ca["[object WeakMap]"]=!1;var Wv=function(x){return cs(x)&&Fg(x.length)&&!!Ca[Qs(x)]},th=Ol&&Ol.isTypedArray,oc=th?xg(th):Wv,Gv=Object.prototype.hasOwnProperty,Qv=function(x,D){var F=Oi(x),O=!F&&Zg(x),oe=!F&&!O&&eh(x),xe=!F&&!O&&!oe&&oc(x),z=F||O||oe||xe,qe=z?KT(x.length,String):[],Lt=qe.length;for(var lr in x)!D&&!Gv.call(x,lr)||z&&(lr=="length"||oe&&(lr=="offset"||lr=="parent")||xe&&(lr=="buffer"||lr=="byteLength"||lr=="byteOffset")||yd(lr,Lt))||qe.push(lr);return qe},QT=Object.prototype,Jv=function(x){var D=x&&x.constructor;return x===(typeof D=="function"&&D.prototype||QT)},Yv=function(x,D){return function(F){return x(D(F))}},Xv=Yv(Object.keys,Object),JT=Object.prototype.hasOwnProperty,rh=function(x){if(!Jv(x))return Xv(x);var D=[];for(var F in Object(x))JT.call(x,F)&&F!="constructor"&&D.push(F);return D},wc=function(x){return bp(x)?Qv(x):rh(x)},nh=function(x){return Np(x,wc,Jg)},YT=Object.prototype.hasOwnProperty,Zv=function(x,D,F,O,oe,xe){var z=1&F,qe=nh(x),Lt=qe.length;if(Lt!=nh(D).length&&!z)return!1;for(var lr=Lt;lr--;){var pr=qe[lr];if(!(z?pr in D:YT.call(D,pr)))return!1}var Sr=xe.get(x),br=xe.get(D);if(Sr&&br)return Sr==D&&br==x;var Er=!0;xe.set(x,D),xe.set(D,x);for(var Dr=z;++lr<Lt;){var $r=x[pr=qe[lr]],vn=D[pr];if(O)var Xr=z?O(vn,$r,pr,D,x,xe):O($r,vn,pr,x,D,xe);if(!(Xr===void 0?$r===vn||oe($r,vn,F,O,xe):Xr)){Er=!1;break}Dr||(Dr=pr=="constructor")}if(Er&&!Dr){var wn=x.constructor,hn=D.constructor;wn==hn||!("constructor"in x)||!("constructor"in D)||typeof wn=="function"&&wn instanceof wn&&typeof hn=="function"&&hn instanceof hn||(Er=!1)}return xe.delete(x),xe.delete(D),Er},ac=ll(Vs,"DataView"),Da=ll(Vs,"Promise"),Vl=ll(Vs,"WeakMap"),va="[object Map]",Ys="[object Promise]",ey="[object Set]",os="[object WeakMap]",oh="[object DataView]",ah=il(ac),XT=il(kc),ZT=il(Da),ty=il(Dl),eS=il(Vl),pl=Qs;(ac&&pl(new ac(new ArrayBuffer(1)))!=oh||kc&&pl(new kc)!=va||Da&&pl(Da.resolve())!=Ys||Dl&&pl(new Dl)!=ey||Vl&&pl(new Vl)!=os)&&(pl=function(S){var x=Qs(S),D=x=="[object Object]"?S.constructor:void 0,F=D?il(D):"";if(F)switch(F){case ah:return oh;case XT:return va;case ZT:return Ys;case ty:return ey;case eS:return os}return x});var bd=pl,Xs="[object Arguments]",sh="[object Array]",Bp="[object Object]",Td=Object.prototype.hasOwnProperty,ry=function(x,D,F,O,oe,xe){var z=Oi(x),qe=Oi(D),Lt=z?sh:bd(x),lr=qe?sh:bd(D),pr=(Lt=Lt==Xs?Bp:Lt)==Bp,Sr=(lr=lr==Xs?Bp:lr)==Bp,br=Lt==lr;if(br&&eh(x)){if(!eh(D))return!1;z=!0,pr=!1}if(br&&!pr)return xe||(xe=new Op),z||oc(x)?Kg(x,D,F,O,oe,xe):Wg(x,D,Lt,F,O,oe,xe);if(!(1&F)){var Er=pr&&Td.call(x,"__wrapped__"),Dr=Sr&&Td.call(D,"__wrapped__");if(Er||Dr){var $r=Er?x.value():x,vn=Dr?D.value():D;return xe||(xe=new Op),oe($r,vn,F,O,xe)}}return!!br&&(xe||(xe=new Op),Zv(x,D,F,O,oe,xe))},ih=function S(x,D,F,O,oe){return x===D||(x==null||D==null||!cs(x)&&!cs(D)?x!=x&&D!=D:ry(x,D,F,O,S,oe))},tS=function(x,D,F,O){var oe=F.length,xe=oe,z=!O;if(x==null)return!xe;for(x=Object(x);oe--;){var qe=F[oe];if(z&&qe[2]?qe[1]!==x[qe[0]]:!(qe[0]in x))return!1}for(;++oe<xe;){var Lt=(qe=F[oe])[0],lr=x[Lt],pr=qe[1];if(z&&qe[2]){if(lr===void 0&&!(Lt in x))return!1}else{var Sr=new Op;if(O)var br=O(lr,pr,Lt,x,D,Sr);if(!(br===void 0?ih(pr,lr,3,O,Sr):br))return!1}}return!0},ny=function(x){return x==x&&!pi(x)},rS=function(x){for(var D=wc(x),F=D.length;F--;){var O=D[F],oe=x[O];D[F]=[O,oe,ny(oe)]}return D},ch=function(x,D){return function(F){return F!=null&&F[x]===D&&(D!==void 0||x in Object(F))}},oy=function(x){var D=rS(x);return D.length==1&&D[0][2]?ch(D[0][0],D[0][1]):function(F){return F===x||tS(F,x,D)}},Fp=function(x){return typeof x=="symbol"||cs(x)&&Qs(x)=="[object Symbol]"},nS=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,oS=/^\w*$/,Sd=function(x,D){if(Oi(x))return!1;var F=typeof x;return!(F!="number"&&F!="symbol"&&F!="boolean"&&x!=null&&!Fp(x))||oS.test(x)||!nS.test(x)||D!=null&&x in Object(D)};function lh(S,x){if(typeof S!="function"||x!=null&&typeof x!="function")throw new TypeError("Expected a function");var D=function(){var F=arguments,O=x?x.apply(this,F):F[0],oe=D.cache;if(oe.has(O))return oe.get(O);var xe=S.apply(this,F);return D.cache=oe.set(O,xe)||oe,xe};return D.cache=new(lh.Cache||ul),D}lh.Cache=ul;var Lp=lh,aS=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$p=/\\(\\)?/g,Ma=function(x){var D=Lp(x,function(O){return F.size===500&&F.clear(),O}),F=D.cache;return D}(function(S){var x=[];return S.charCodeAt(0)===46&&x.push(""),S.replace(aS,function(D,F,O,oe){x.push(O?oe.replace($p,"$1"):F||D)}),x}),sS=Ma,uh=wi?wi.prototype:void 0,dh=uh?uh.toString:void 0,iS=function S(x){if(typeof x=="string")return x;if(Oi(x))return $l(x,S)+"";if(Fp(x))return dh?dh.call(x):"";var D=x+"";return D=="0"&&1/x==-1/0?"-0":D},ay=function(x){return x==null?"":iS(x)},jp=function(x,D){return Oi(x)?x:Sd(x,D)?[x]:sS(ay(x))},fl=function(x){if(typeof x=="string"||Fp(x))return x;var D=x+"";return D=="0"&&1/x==-1/0?"-0":D},ph=function(x,D){for(var F=0,O=(D=jp(D,x)).length;x!=null&&F<O;)x=x[fl(D[F++])];return F&&F==O?x:void 0},Wa=function(x,D,F){var O=x==null?void 0:ph(x,D);return O===void 0?F:O},cS=function(x,D){return x!=null&&D in Object(x)},Cd=function(x,D,F){for(var O=-1,oe=(D=jp(D,x)).length,xe=!1;++O<oe;){var z=fl(D[O]);if(!(xe=x!=null&&F(x,z)))break;x=x[z]}return xe||++O!=oe?xe:!!(oe=x==null?0:x.length)&&Fg(oe)&&yd(z,oe)&&(Oi(x)||Zg(x))},sy=function(x,D){return x!=null&&Cd(x,D,cS)},lS=function(x,D){return Sd(x)&&ny(D)?ch(fl(x),D):function(F){var O=Wa(F,x);return O===void 0&&O===D?sy(F,x):ih(D,O,3)}},fh=function(x){return function(D){return D==null?void 0:D[x]}},uS=function(x){return function(D){return ph(D,x)}},dS=function(x){return Sd(x)?fh(fl(x)):uS(x)},Ga=function(x){return typeof x=="function"?x:x==null?hp:typeof x=="object"?Oi(x)?lS(x[0],x[1]):oy(x):dS(x)},pS=function(x,D,F){D=="__proto__"&&vp?vp(x,D,{configurable:!0,enumerable:!0,value:F,writable:!0}):x[D]=F},mh=Object.prototype.hasOwnProperty,iy=function(x,D,F){var O=x[D];mh.call(x,D)&&cp(O,F)&&(F!==void 0||D in x)||pS(x,D,F)},fS=function(x,D,F,O){if(!pi(x))return x;for(var oe=-1,xe=(D=jp(D,x)).length,z=xe-1,qe=x;qe!=null&&++oe<xe;){var Lt=fl(D[oe]),lr=F;if(Lt==="__proto__"||Lt==="constructor"||Lt==="prototype")return x;if(oe!=z){var pr=qe[Lt];(lr=O?O(pr,Lt,qe):void 0)===void 0&&(lr=pi(pr)?pr:yd(D[oe+1])?[]:{})}iy(qe,Lt,lr),qe=qe[Lt]}return x},cy=function(x,D,F){for(var O=-1,oe=D.length,xe={};++O<oe;){var z=D[O],qe=ph(x,z);F(qe,z)&&fS(xe,jp(z,x),qe)}return xe},ly=Yv(Object.getPrototypeOf,Object),Md=Object.getOwnPropertySymbols?function(S){for(var x=[];S;)As(x,Jg(S)),S=ly(S);return x}:zv,mS=function(x){var D=[];if(x!=null)for(var F in Object(x))D.push(F);return D},gS=Object.prototype.hasOwnProperty,uy=function(x){if(!pi(x))return mS(x);var D=Jv(x),F=[];for(var O in x)(O!="constructor"||!D&&gS.call(x,O))&&F.push(O);return F},hS=function(x){return bp(x)?Qv(x,!0):uy(x)},vS=function(x){return Np(x,hS,Md)},gh,dy,py=function(x,D){if(x==null)return{};var F=$l(vS(x),function(O){return[O]});return D=Ga(D),cy(x,F,function(O,oe){return D(O,oe[0])})},fy={"6_2":"getNosToken","6_22":"getOriginUrl","6_26":"getNosCdnHost","6_27":"getGrayscaleConfig","6_28":"getMixStorePolicy","6_29":"getMixStoreToken","6_30":"getFileAuthToken"},Hl={nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},mixStoreTokenReqTag:{provider:0,tokenCount:1,fileExpireSec:2,tag:3,returnBody:4},nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4},grayConfigTag:{config:0,ttl:1},mixStorePolicyTag:{providers:0,ttl:1,mixEnable:2,nosPolicy:3,s3Policy:4},mixStoreTokenResTag:{provider:0,accessKeyId:1,secretAccessKey:2,sessionToken:3,token:4,expireTime:5,bucket:6,objectName:7,fileExpireSec:8,tag:9,shortUrl:10,region:11},nosSafeUrlTag:{safeUrl:0,originUrl:1},mixStoreAuthTokenReqTag:{type:1,urls:2},mixStoreAuthTokenResTag:{type:1,tokens:2,token:3,ttl:4}},ml=Cc(Hl),hh={getNosToken:{sid:6,cid:2,service:"cloudStorage",response:[{type:"Property",name:"nosToken",reflectMapper:ml.nosToken}],params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken",reflectMapper:Hl.nosToken}]},getOriginUrl:{sid:6,cid:22,service:"cloudStorage",response:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:ml.nosSafeUrlTag}],params:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:Hl.nosSafeUrlTag}]},getNosCdnHost:{sid:6,cid:26,service:"misc",response:[{type:"Property",name:"nosConfigTag",reflectMapper:ml.nosConfigTag}]},getGrayscaleConfig:{sid:6,cid:27,service:"cloudStorage",response:[{type:"Property",name:"grayConfigTag",reflectMapper:ml.grayConfigTag}],params:[{type:"Property",name:"config"}]},getMixStorePolicy:{sid:6,cid:28,service:"cloudStorage",params:[{type:"LongArray",name:"supportType"}],response:[{type:"Property",name:"mixStorePolicyTag",reflectMapper:ml.mixStorePolicyTag}]},getMixStoreToken:{sid:6,cid:29,service:"cloudStorage",params:[{type:"Property",name:"mixStoreTokenReqTag",reflectMapper:Hl.mixStoreTokenReqTag}],response:[{type:"Property",name:"mixStoreTokenResTag",reflectMapper:ml.mixStoreTokenResTag}]},getFileAuthToken:{sid:6,cid:30,service:"cloudStorage",params:[{type:"Property",name:"mixStoreAuthTokenReqTag",reflectMapper:Hl.mixStoreAuthTokenReqTag}],response:[{type:"Property",name:"mixStoreAuthTokenResTag",reflectMapper:ml.mixStoreAuthTokenResTag}]}};(function(S){S[S.nos=1]="nos",S[S.s3=2]="s3"})(gh||(gh={})),function(S){S[S.dontNeed=-1]="dontNeed",S[S.time=2]="time",S[S.urls=3]="urls"}(dy||(dy={}));var Hs,Ni,yS={chunkUploadHost:"https://wanproxy-web.127.net",commonUploadHost:"https://nos.netease.com",chunkMaxSize:4194304e4,commonMaxSize:104857600,uploadReplaceFormat:"https://{host}/{object}",cdn:{defaultCdnDomain:"nim.nosdn.127.net",cdnDomain:"",bucket:"",objectNamePrefix:""},downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHostList:["nos.netease.com"],nosCdnEnable:!0,isNeedToGetUploadPolicyFromServer:!0},xc={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},vh={accessKeyId:"",secretAccessKey:"",sessionToken:"",region:"",maxRetries:0,bucket:"",objectName:"",token:"",shortUrl:""};function yh(S){return S===void 0&&(S="file"),mo(xc[S]||{}).replace(/"/gi,'\\"')}(function(S){S[S.nos=1]="nos",S[S.s3=2]="s3"})(Hs||(Hs={})),function(S){S[S.dontNeed=-1]="dontNeed",S[S.time=2]="time",S[S.urls=3]="urls"}(Ni||(Ni={}));var gy=function(){function S(D,F){F===void 0&&(F={}),this.GRAYKEY="AllGrayscaleConfig",this.MIXSTOREKEY="AllMixStorePolicy",this.config={},this.nosCdnHostTimer=0,this.grayConfig={mixStoreEnable:!1,timeStamp:0,ttl:0},this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=Hs.nos,this.s3=null,this.mixStoreErrorCount=10,this.nosErrorCount=0,this.circuitTimer=0,this.name="cloudStorage",this.logger=D.logger,this.core=D,Ei({cmdMap:fy,cmdConfig:hh}),this.setOptions(F)}var x=S.prototype;return x.setOptions=function(F){F===void 0&&(F={});var O=F.storageKeyPrefix||"NIMClient";this.GRAYKEY=O+"-AllGrayscaleConfig",this.MIXSTOREKEY=O+"-AllMixStorePolicy";var oe=F.s3,xe=xl(F,["s3"]),z=Tn({},yS,this.config);if(xe&&Object.prototype.hasOwnProperty.call(xe,"cdn")){var qe={cdn:Tn(Tn({},z.cdn),xe.cdn)};this.config=Tn({},z,xe,qe)}else this.config=Tn({},z,xe);oe&&(this.s3=oe)},x.init=function(){return Mr(this,void 0,void 0,ar.mark(function F(){return ar.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:if(this.grayConfig=null,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=Hs.nos,this.mixStoreErrorCount=10,!this.config.isNeedToGetUploadPolicyFromServer){oe.next=9;break}return oe.next=7,this.getGrayscaleConfig(this.core.options.appkey);case 7:return oe.next=9,this.getNosCdnHost();case 9:case"end":return oe.stop()}},F,this)}))},x.uploadFile=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:if(Gr({maxSize:{type:"number",required:!1},type:{type:"enum",values:["file","image","audio","video"]}},F),F.fileInput||F.file||F.filePath){Lt.next=3;break}throw new Error("uploadFile needs target file object or a filePath");case 3:if(!F.type||F.type==="file"){Lt.next=7;break}if(typeof(oe=Wa(F,"file.type"))!="string"||pa(oe).call(oe,F.type)!==-1){Lt.next=7;break}throw new Error('The meta type "'+oe+'" does not match "'+F.type+'"');case 7:if(this.grayConfig&&this.grayConfig.mixStoreEnable&&this.mixStorePolicy.providers.length){Lt.next=10;break}return this.logger.log("uploadFile:: uploadFile begin, use old nos"),Lt.abrupt("return",this.nosUpload(F));case 10:return this.logger.log("uploadFile:: uploadFile begin,Current settings grayConfig mixStoreEnable:"+this.grayConfig.mixStoreEnable+" curProvider:"+this.curProvider),this.s3||(this.curProvider=Hs.nos),xe=vh,Lt.prev=13,Lt.next=16,this.core.sendCmd("getMixStoreToken",{mixStoreTokenReqTag:{provider:this.curProvider,tokenCount:1,tag:"qchat",returnBody:yh(F.type)}});case 16:z=Lt.sent,xe=z.content.mixStoreTokenResTag,Lt.next=24;break;case 20:throw Lt.prev=20,Lt.t0=Lt.catch(13),this.core.logger.error("uploadFile:: getMixStoreToken error",Lt.t0),new Tc("getMixStoreToken error",Lt.t0,this.curProvider,this.mixStorePolicy);case 24:return Lt.abrupt("return",this.curProvider===Hs.s3?this.s3Upload(F,xe):this.nosUpload(F,xe));case 25:case"end":return Lt.stop()}},O,this,[[13,20]])}))},x.nosUpload=function(F,O){var oe,xe;return Mr(this,void 0,void 0,ar.mark(function z(){var qe,Lt,lr,pr,Sr,br,Er,Dr,$r,vn,Xr,wn,hn;return ar.wrap(function(Dn){for(;;)switch(Dn.prev=Dn.next){case 0:if(qe=Wa(this.core,"config.cdn.bucket"),Lt={tag:F.nosScenes||qe||"nim",expireSec:F.nosSurvivalTime},O){Dn.next=13;break}return Dn.prev=3,Dn.next=6,this.core.sendCmd("getNosToken",{responseBody:yh(F.type),nosToken:Lt});case 6:lr=Dn.sent,Dn.next=13;break;case 9:throw Dn.prev=9,Dn.t0=Dn.catch(3),this.core.logger.error("uploadFile:: getNosToken error",Dn.t0),new Tc("getNosToken error",Dn.t0,1);case 13:return Dn.prev=13,Sr=lr?lr.content.nosToken:O,this.core.logger.debug("uploadFile:: uploadFile params",{nosToken:Sr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,platform:ta.platform}),Dn.next=18,this.core.adapters.uploadFile(Tn(Tn({},F),{nosToken:Sr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,maxSize:F.maxSize||this.config.chunkMaxSize}));case 18:pr=Dn.sent,Dn.next=42;break;case 21:if(Dn.prev=21,Dn.t1=Dn.catch(13),this.core.logger.error("uploadFile::nos uploadFile error",Dn.t1),!O){Dn.next=41;break}if(this.nosErrorCount!==0){Dn.next=37;break}Dn.prev=26,this._addCircuitTimer(),Dn.next=33;break;case 30:throw Dn.prev=30,Dn.t2=Dn.catch(26),new Tc("upload file error",Dn.t2,this.curProvider,this.mixStorePolicy,F.file||F.filePath);case 33:return this.nosErrorCount=(oe=this.mixStorePolicy.nosPolicy)===null||oe===void 0?void 0:oe.uploadConfig.retryPolicy.retry,Dn.abrupt("return",this.uploadFile(F));case 37:return this.nosErrorCount--,Dn.abrupt("return",this.nosUpload(F,O));case 39:Dn.next=42;break;case 41:throw new Tc("nos uploadFile error",Dn.t1,1);case 42:if(br=pr==null?void 0:pr.type,Er=br&&pa(br).call(br,"/")>-1?Co(br).call(br,0,pa(br).call(br,"/")):"",Dr={image:"imageInfo",video:"vinfo",audio:"vinfo"},$r=this.config.uploadReplaceFormat.replace("{host}",this.config.cdn.cdnDomain||this.config.cdn.defaultCdnDomain).replace("{object}",lr?lr.content.nosToken.objectName:O==null?void 0:O.objectName),O&&O.shortUrl&&($r=O.shortUrl),Dr[Er]){Dn.next=49;break}return Dn.abrupt("return",Tn({url:$r},pr));case 49:if(Dn.prev=49,!(pa($r).call($r,"_im_url=1")<0)){Dn.next=54;break}return Dn.next=53,this.core.adapters.request($r+"?"+Dr[Er],{method:"GET",dataType:"json",timeout:5e3});case 53:vn=Dn.sent;case 54:Dn.next=60;break;case 56:return Dn.prev=56,Dn.t3=Dn.catch(49),this.core.logger.error("uploadFile:: fetch file info error",Dn.t3),Dn.abrupt("return",Tn({url:$r},pr));case 60:if(!vn){Dn.next=67;break}return Xr=vn.data,wn=Dr[Er]==="imageInfo"?Xr:(xe=Xr==null?void 0:Xr.GetVideoInfo)===null||xe===void 0?void 0:xe.VideoInfo,hn={url:$r,name:pr.name,size:pr.size,ext:pr.ext,w:wn.Width,h:wn.Height,orientation:wn.Orientation,dur:wn.Duration,audioCodec:wn.AudioCodec,videoCodec:wn.VideoCodec,container:wn.Container},Dn.abrupt("return",py(hn,function(jo,jn){return jn!==void 0}));case 67:return Dn.abrupt("return",Tn({url:$r},pr));case 68:case"end":return Dn.stop()}},z,this,[[3,9],[13,21],[26,30],[49,56]])}))},x.getNosCdnHost=function(){var F;return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe=this;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return lr.prev=0,lr.next=3,this.core.sendCmd("getNosCdnHost");case 3:oe=lr.sent,lr.next=10;break;case 6:return lr.prev=6,lr.t0=lr.catch(0),this.logger.error("getNosCdnHost::error",lr.t0),lr.abrupt("return");case 10:if(oe){lr.next=12;break}return lr.abrupt("return");case 12:xe=(F=oe==null?void 0:oe.content)===null||F===void 0?void 0:F.nosConfigTag,(z=Lo(xe==null?void 0:xe.expire))!==0&&xe.cdnDomain?z===-1?(this.config.cdn.bucket=xe.bucket,this.config.cdn.cdnDomain=xe.cdnDomain,this.config.cdn.objectNamePrefix=xe.objectNamePrefix):(this.config.cdn.bucket=xe.bucket,this.config.cdn.cdnDomain=xe.cdnDomain,this.config.cdn.objectNamePrefix=xe.objectNamePrefix,this.nosCdnHostTimer=this.core.timerManager.addTimer(function(){qe.getNosCdnHost()},1e3*z)):(this.config.cdn.bucket="",this.config.cdn.cdnDomain="",this.config.cdn.objectNamePrefix="");case 15:case"end":return lr.stop()}},O,this,[[0,6]])}))},x.getGrayscaleConfig=function(F){var O;return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:if(ta.localStorage)try{ta.localStorage.getItem&&ta.localStorage.getItem(this.GRAYKEY)&&(this.grayConfig=JSON.parse(ta.localStorage.getItem(this.GRAYKEY))[F])}catch(lr){ta.localStorage.getItem(this.GRAYKEY)&&this.core.logger.error("uploadFile:: JSON.parse grayscaleConfig error ",lr)}if(this.grayConfig&&!(this.grayConfig.timeStamp+1e3*this.grayConfig.ttl<new Date().getTime())){Lt.next=17;break}return Lt.next=4,this.core.sendCmd("getGrayscaleConfig",{config:{}});case 4:if(!(xe=Lt.sent).content||!xe.content.grayConfigTag){Lt.next=16;break}this.logger.log("uploadFile::getAppGrayConfigRequest success ");try{this.grayConfig=JSON.parse(xe.content.grayConfigTag.config),this.grayConfig.ttl=JSON.parse(xe.content.grayConfigTag.ttl)}catch(lr){this.logger.error("getGrayscaleConfig error",lr)}if(this.grayConfig){Lt.next=10;break}return Lt.abrupt("return");case 10:z=ta.localStorage.getItem(this.GRAYKEY)?JSON.parse(ta.localStorage.getItem(this.GRAYKEY)):{},this.grayConfig.timeStamp=new Date().getTime(),z[F]=this.grayConfig,ta.localStorage.setItem(this.GRAYKEY,mo(z)),Lt.next=17;break;case 16:this.logger.debug("uploadFile:: result grayConfig:",xe.content);case 17:if(!(!((O=this.grayConfig)===null||O===void 0)&&O.mixStoreEnable)){Lt.next=20;break}return Lt.next=20,this._getMixStorePolicy(F);case 20:case"end":return Lt.stop()}},oe,this)}))},x._getMixStorePolicy=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe,Lt,lr,pr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(oe=new Date().getTime(),ta.localStorage)try{this.mixStorePolicy=JSON.parse(ta.localStorage.getItem(this.MIXSTOREKEY))[F],this.curProvider=Lo(this.mixStorePolicy.providers[0]),this.mixStorePolicy.timeStamp&&this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl>oe&&(z=this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl-oe,this.core.timerManager.addTimer(Oo(xe=this._getMixStorePolicy).call(xe,this,F),z))}catch(Er){ta.localStorage.getItem(this.MIXSTOREKEY)&&JSON.parse(ta.localStorage.getItem(this.MIXSTOREKEY))[F]&&this.core.logger.error("uploadFile:: JSON.parse mixStorePolicy error ",Er)}if(this.mixStorePolicy&&!(this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl<=oe)){br.next=30;break}return br.prev=3,br.next=6,this.core.sendCmd("getMixStorePolicy",{supportType:this.s3?[1,2]:[1]});case 6:Lt=br.sent,lr=Lt.content.mixStorePolicyTag,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.mixStorePolicy.ttl=Number(lr.ttl),this.mixStorePolicy.providers=lr.providers.split(","),this.circuitTimer&&this.core.timerManager.deleteTimer(this.circuitTimer),this.curProvider=Lo(this.mixStorePolicy.providers[0]),this.mixStorePolicy.nosPolicy=lr.nosPolicy?JSON.parse(lr.nosPolicy):null,this.mixStorePolicy.s3Policy=lr.s3Policy?JSON.parse(lr.s3Policy):null,this.mixStorePolicy.s3Policy===null?this.mixStorePolicy.providers=["1"]:this.mixStorePolicy.nosPolicy===null?this.mixStorePolicy.providers=["2"]:this.mixStorePolicy.providers=this.mixStorePolicy.s3Policy.priority<this.mixStorePolicy.nosPolicy.priority?["2","1"]:["1","2"],this.core.timerManager.addTimer(Oo(qe=this._getMixStorePolicy).call(qe,this,F),1e3*this.mixStorePolicy.ttl),pr=ta.localStorage.getItem(this.MIXSTOREKEY)?JSON.parse(ta.localStorage.getItem(this.MIXSTOREKEY)):{},this.mixStorePolicy.timeStamp=new Date().getTime(),pr[F]=this.mixStorePolicy,ta.localStorage.setItem(this.MIXSTOREKEY,mo(pr)),br.next=30;break;case 23:if(br.prev=23,br.t0=br.catch(3),this.logger.error("getMixStorePolicy error",br.t0),this.mixStoreErrorCount!==0){br.next=28;break}throw new Error("getMixStorePolicy all count error");case 28:this._getMixStorePolicy(F),this.mixStoreErrorCount--;case 30:this.mixStorePolicy.nosPolicy&&(this.nosErrorCount=this.mixStorePolicy.nosPolicy.uploadConfig.retryPolicy.retry);case 31:case"end":return br.stop()}},O,this,[[3,23]])}))},x.s3Upload=function(F,O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt,lr,pr,Sr,br,Er,Dr,$r=this;return ar.wrap(function(Xr){for(;;)switch(Xr.prev=Xr.next){case 0:if(!F.file){Xr.next=4;break}xe=F.file,Xr.next=19;break;case 4:if(typeof F.fileInput!="string"){Xr.next=14;break}if(this.logger.warn("fileInput will abandon,Please use file or filepath"),!((z=document.getElementById(F.fileInput))&&z.files&&z.files[0])){Xr.next=11;break}xe=z.files[0],Xr.next=12;break;case 11:throw new Error("Can not get file from fileInput");case 12:Xr.next=19;break;case 14:if(!(F.fileInput&&F.fileInput.files&&F.fileInput.files[0])){Xr.next=18;break}xe=F.fileInput.files[0],Xr.next=19;break;case 18:throw new Error("Can not get file from fileInput "+F.fileInput);case 19:if(this.mixStorePolicy.s3Policy){Xr.next=21;break}throw new Error("dont get s3 policy");case 21:return qe={accessKeyId:O.accessKeyId,secretAccessKey:O.secretAccessKey,sessionToken:O.sessionToken,region:O.region,maxRetries:this.mixStorePolicy.s3Policy.uploadConfig.retryPolicy.retry},Lt=this.s3,(lr=new Lt).config.update(qe),pr=decodeURIComponent(O.bucket),Sr=decodeURIComponent(O.objectName),Er={Bucket:pr,Key:Sr,Body:br=xe,Metadata:{token:O.token},ContentType:br.type||"application/octet-stream"},this.core.logger.debug("uploadFile:: s3 upload params:",Er),Dr=lr.upload(Er),Xr.abrupt("return",new co(function(wn){var hn=new Date().getTime();Dr.send(function(Gn,Dn){var jo,jn;if(Gn){$r.logger.error("uploadFile:","api::s3:upload file failed",Gn),$r.core.reporter.reportTraceStart("exceptions",{user_id:$r.core.options.account,trace_id:(jn=(jo=$r.core)===null||jo===void 0?void 0:jo.socket)===null||jn===void 0?void 0:jn.sessionId,start_time:hn,action:1}),$r.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof Gn.status=="number"?Gn.status:typeof Gn.code=="number"?Gn.code:0,description:Gn.message||""+Gn.code,operation_type:1,target:Gn.hostname}),$r.core.reporter.reportTraceEnd("exceptions",1);try{$r._addCircuitTimer()}catch(xn){throw new Tc("upload file error",xn,$r.curProvider,$r.mixStorePolicy,F.file||F.filePath)}wn($r.uploadFile(F))}else{var wr=$r.mixStorePolicy.s3Policy.cdnSchema;wr=(wr=wr.replace("{cdnDomain}",$r.mixStorePolicy.s3Policy.dlcdn)).replace("{objectName}",Dn.Key),wn({size:br.size,name:br.name,url:O.shortUrl?O.shortUrl:wr,ext:br.name.split(".")[1]||"unknown"})}})}));case 32:case"end":return Xr.stop()}},oe,this)}))},x.getPrivateUrl=function(F){var O;if(!new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?/).test(F))return this.logger.error("illegal file url:"+F),"";var oe=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/.exec(F);oe[0];var xe=oe[1];oe[2];var z=oe[3];oe[4];var qe=oe[5];if(oe[6],oe[7],(O=this.grayConfig)===null||O===void 0?void 0:O.mixStoreEnable){var Lt=this._getUrlType(F);return Lt===Hs.s3&&this.mixStorePolicy.s3Policy&&(F=this.mixStorePolicy.s3Policy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.s3Policy.dlcdn).replace("{objectName}",qe)),Lt===Hs.nos&&this.mixStorePolicy.nosPolicy&&(F=this.mixStorePolicy.nosPolicy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.nosPolicy.dlcdn).replace("{objectName}",qe)),F}var lr=this.config,pr=lr.downloadUrl,Sr=lr.downloadHostList,br=lr.nosCdnEnable,Er=this.config.cdn.cdnDomain,Dr=this.config.cdn.objectNamePrefix?decodeURIComponent(this.config.cdn.objectNamePrefix):"",$r=decodeURIComponent(qe),vn=pa($r).call($r,Dr);if(Er&&vn>-1&&br)return""+xe+Er+"/"+Co($r).call($r,vn);if(mi(Sr).call(Sr,z)&&mi(qe).call(qe,"/")){var Xr=pa(qe).call(qe,"/"),wn=qe.substring(0,Xr),hn=qe.substring(Xr+1);return pr.replace("{bucket}",wn).replace("{object}",hn)}var Gn=Js(Sr).call(Sr,function(jo){return typeof z=="string"&&mi(z).call(z,jo)})[0],Dn=Gn?z.replace(Gn,"").replace(/\W/g,""):null;return Dn?pr.replace("{bucket}",Dn).replace("{object}",qe):F},x.getOriginUrl=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.core.sendCmd("getOriginUrl",{nosSafeUrlTag:{safeUrl:F}});case 2:return oe=z.sent,z.abrupt("return",oe.content.nosSafeUrlTag.originUrl);case 4:case"end":return z.stop()}},O,this)}))},x.getFileToken=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe,Lt,lr=this;return ar.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:if(Gr({type:{type:"number",min:2,max:3},urls:{type:"array",required:!1,itemType:"string"}},F),oe=this.mixStorePolicy.nosPolicy?this.mixStorePolicy.nosPolicy.authPolicy.policyType:null,xe=this.mixStorePolicy.s3Policy?this.mixStorePolicy.s3Policy.authPolicy.policyType:null,oe!==String(Ni.dontNeed)||xe!==String(Ni.dontNeed)){Sr.next=8;break}throw this.logger.error("don't need token"),new Error("don't need token");case 8:if(F.type!==Ni.time){Sr.next=17;break}if(!(oe&&pa(oe).call(oe,String(Ni.time))>=0||xe&&pa(xe).call(xe,String(Ni.time))>0)){Sr.next=13;break}return Sr.abrupt("return",this.getFileAuthToken(F));case 13:throw this.logger.error("don't support time token "),new Error("don't support type time token ");case 15:Sr.next=33;break;case 17:if(F.urls&&F.urls.length){Sr.next=20;break}throw this.logger.error("urls is required when urls token"),new Error("urls is required when urls token");case 20:if(qe=[],Lt=[],In(z=F.urls).call(z,function(br){var Er=lr._getUrlType(br);Er===Hs.nos&&Lt.push(br),Er===Hs.s3&&qe.push(br)}),(!xe||qe.length!==0&&pa(xe).call(xe,String(Ni.urls))<0)&&(this.logger.warn("s3 url don't support url token"),qe=[]),(!oe||Lt.length!==0&&pa(oe).call(oe,String(Ni.urls))<0)&&(this.logger.warn("nos url don't support url token"),Lt=[]),qe.length!==0||Lt.length!==0){Sr.next=30;break}throw this.logger.error("not support urls"),new Error("not support urls");case 30:if(qe.length!==0&&Lt.length!==0){Sr.next=33;break}return F.urls=mo(F.urls),Sr.abrupt("return",this.getFileAuthToken(F));case 33:case"end":return Sr.stop()}},O,this)}))},x.getFileAuthToken=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.core.sendCmd("getFileAuthToken",{mixStoreAuthTokenReqTag:F});case 2:return oe=z.sent,z.abrupt("return",oe.content.mixStoreAuthTokenResTag);case 4:case"end":return z.stop()}},O,this)}))},x._getUrlType=function(F){var O,oe;return this.mixStorePolicy.nosPolicy&&Ap(O=this.mixStorePolicy.nosPolicy.dlcdns).call(O,function(xe){return pa(F).call(F,xe)>=0})?Hs.nos:this.mixStorePolicy.s3Policy&&Ap(oe=this.mixStorePolicy.s3Policy.dlcdns).call(oe,function(xe){return pa(F).call(F,xe)>=0})?Hs.s3:null},x._addCircuitTimer=function(){var F=this,O=this.mixStorePolicy.providers,oe=O[(pa(O).call(O,String(this.curProvider))+1)%O.length];if(oe===O[0])throw new Error("uploadFile all policy fail");var xe=Wa(this.mixStorePolicy,"s3Policy.uploadConfig.retryPolicy");if(xe&&xe.retryNext&&oe&&(this.logger.log("uploadFile:: upload policy will change,now policy:"+this.curProvider+" nextProvider:"+oe),this.curProvider=Lo(oe),this.mixStorePolicy.nosPolicy&&this.mixStorePolicy.s3Policy)){var z=this.mixStorePolicy[this.curProvider===Hs.nos?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!z||z===0)return;this.circuitTimer=this.core.timerManager.addTimer(function(){F.logger.log("uploadFile:: upload policy will change,now policy:"+F.curProvider+" nextProvider:"+Lo(F.mixStorePolicy.providers[0])),F.curProvider=Lo(F.mixStorePolicy.providers[0]),F.core.timerManager.deleteTimer(F.circuitTimer)},1e3*z)}},x.process=function(F){var O=this[F.cmd+"Handler"];return typeof O=="function"?O.call(this,F):F.error&&!F.error.ignore?co.reject(F.error):co.resolve(F)},S}(),kd=Math.floor,Dp=function(S,x){var D=S.length,F=kd(D/2);return D<8?hy(S,x):bS(S,Dp(mu(S,0,F),x),Dp(mu(S,F),x),x)},hy=function(S,x){for(var D,F,O=S.length,oe=1;oe<O;){for(F=oe,D=S[oe];F&&x(S[F-1],D)>0;)S[F]=S[--F];F!==oe++&&(S[F]=D)}return S},bS=function(S,x,D,F){for(var O=x.length,oe=D.length,xe=0,z=0;xe<O||z<oe;)S[xe+z]=xe<O&&z<oe?F(x[xe],D[z])<=0?x[xe++]:D[z++]:xe<O?x[xe++]:D[z++];return S},zl=Dp,vy=nr.match(/firefox\/(\d+)/i),sc=!!vy&&+vy[1],as=/MSIE|Trident/.test(nr),yy=nr.match(/AppleWebKit\/(\d+)\./),by=!!yy&&+yy[1],ic=[],Kl=he(ic.sort),TS=he(ic.push),Ty=d(function(){ic.sort(void 0)}),SS=d(function(){ic.sort(null)}),Sy=Ds("sort"),bh=!d(function(){if(mr)return mr<70;if(!(sc&&sc>3)){if(as)return!0;if(by)return by<603;var S,x,D,F,O="";for(S=65;S<76;S++){switch(x=String.fromCharCode(S),S){case 66:case 69:case 70:case 72:D=3;break;case 68:case 71:D=4;break;default:D=2}for(F=0;F<47;F++)ic.push({k:x+F,v:D})}for(ic.sort(function(oe,xe){return xe.v-oe.v}),F=0;F<ic.length;F++)x=ic[F].k.charAt(0),O.charAt(O.length-1)!==x&&(O+=x);return O!=="DGBEFHACIJK"}});Vr({target:"Array",proto:!0,forced:Ty||!SS||!Sy||!bh},{sort:function(x){x!==void 0&&Or(x);var D=$n(this);if(bh)return x===void 0?Kl(D):Kl(D,x);var F,O,oe=[],xe=Ia(D);for(O=0;O<xe;O++)O in D&&TS(oe,D[O]);for(zl(oe,function(z){return function(qe,Lt){return Lt===void 0?-1:qe===void 0?1:z!==void 0?+z(qe,Lt)||0:Aa(qe)>Aa(Lt)?1:-1}}(x)),F=Ia(oe),O=0;O<F;)D[O]=oe[O++];for(;O<xe;)xp(D,O++);return D}});var Ic,bi,Up,Ri=Uo("Array").sort,_d=Array.prototype,Wl=function(S){var x=S.sort;return S===_d||er(_d,S)&&x===_d.sort?Ri:x};(function(S){S[S.ASC=1]="ASC",S[S.DESC=2]="DESC"})(Ic||(Ic={})),function(S){S[S.reorderWeight=0]="reorderWeight",S[S.createTime=1]="createTime",S[S.totalMember=2]="totalMember"}(bi||(bi={})),function(S){S[S.square=1]="square",S[S.person=2]="person"}(Up||(Up={}));var gl=function(){function S(x,D){this.name=x,this.core=D,this.name=x,this.logger=D.logger,this.core=D}return S.prototype.process=function(D){var F=this[D.cmd+"Handler"];return typeof F=="function"?F.call(this,D):D.error&&!D.error.ignore?co.reject(D.error):co.resolve(D)},S}(),wd={"24_15":"qchatSubscribe","24_27":"qchatGetUnreadInfo","24_48":"qchatCreateChannel","24_49":"qchatDeleteChannel","24_50":"qchatUpdateChannel","24_51":"qchatGetChannels","24_52":"qchatGetChannelsByPage","24_53":"qchatGetMembersByPage","24_54":"qchatUpdateWhiteBlackRole","24_55":"qchatGetWhiteBlackRolesPage","24_56":"qchatUpdateWhiteBlackMembers","24_57":"qchatGetWhiteBlackMembersPage","24_58":"qchatGetExistingWhiteBlackRoles","24_59":"qchatGetExistingWhiteBlackMembers","24_60":"qchatUpdateCategoryInfoOfChannel","24_109":"qchatCreateChannelCategory","24_110":"qchatRemoveChannelCategory","24_111":"qchatUpdateChannelCategory","24_112":"qchatGetChannelCategoriesByID","24_113":"qchatUpdateChannelCategoryWhiteBlackRole","24_114":"qchatGetChannelCategoryWhiteBlackRolesPage","24_115":"qchatUpdateChannelCategoryWhiteBlackMembers","24_116":"qchatGetChannelCategoryWhiteBlackMembersPage","24_117":"qchatGetChannelCategoryWhiteBlackRoles","24_118":"qchatGetChannelCategoryWhiteBlackMembers","24_119":"qchatGetChannelCategoriesPage","24_120":"qchatGetChannelCategoryChannelsPage","24_93":"qchatGetChannelSearchByPage","24_95":"qchatChannelMemberSearch","25_8":"qchatGetRoleIdsByServerId","25_9":"qchatSubscribeAsVisitor"},Th={serverId:1,channelId:2,ackTimestamp:3,unreadCount:4,mentionedCount:5,maxCount:6,lastMsgTime:7},Yo={channelInfo:{channelId:1,serverId:2,name:4,topic:5,ext:6,type:7,validFlag:8,createTime:9,updateTime:10,owner:11,viewMode:12,categoryId:13,syncMode:14,reorderWeight:15,visitorMode:16},antispamTag:{antiSpamBusinessId:1},memberInfo:{serverId:1,accid:3,nick:4,avatar:5,ext:6,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},serverRole:{serverId:1,roleId:2,name:3,icon:4,ext:5,auths:6,type:7,memberCount:8,priority:9,createTime:10,updateTime:11},qchatSubReqTag:{type:1,opeType:2},qchatChannelIdInfoTag:{serverId:1,channelId:2},unreadInfo:Th,qchatGetChannelListPageTag:{serverId:1,timetag:2,limit:3},qchatGetMembersByPageTag:{serverId:1,channelId:2,timetag:3,limit:4},qchatUpdateWhiteBlackRoleTag:{serverId:1,channelId:2,type:3,opeType:4,roleId:5},qchatGetWhiteBlackRolesPageTag:{serverId:1,channelId:2,type:3,timetag:4,limit:5},qchatUpdateWhiteBlackMembersTag:{serverId:1,channelId:2,type:3,opeType:4,toAccids:5},qchatGetWhiteBlackMembersPageTag:{serverId:1,channelId:2,type:3,timetag:4,limit:5},qchatGetExistingWhiteBlackRolesTag:{serverId:1,channelId:2,type:3,roleIds:4},qchatGetExistingWhiteBlackMembersTag:{serverId:1,channelId:2,type:3,accids:4},QChatChannelCategoryInfo:{categoryId:1,serverId:2,name:4,ext:5,owner:6,viewMode:7,validFlag:8,createTime:9,updateTime:10,channelNumber:11},qchatUpdateChannelCategoryWhiteBlackRoleTag:{serverId:1,categoryId:2,type:3,opeType:4,roleId:5},qchatGetChannelCategoryWhiteBlackRolesPageTag:{serverId:1,categoryId:2,type:3,timetag:4,limit:5},qchatUpdateChannelCategoryWhiteBlackMembersTag:{serverId:1,categoryId:2,type:3,opeType:4,toAccids:5},qchatGetChannelCategoryWhiteBlackMembersPageTag:{serverId:1,categoryId:2,type:3,timetag:4,limit:5},qchatGetChannelCategoryWhiteBlackRolesTag:{serverId:1,categoryId:2,type:3,roleIds:4},qchatGetChannelCategoryWhiteBlackMembersTag:{serverId:1,categoryId:2,type:3,accids:4},qchatGetChannelCategoriesPageTag:{serverId:1,timetag:2,limit:3},qchatGetChannelCategoryChannelsPageTag:{serverId:1,categoryId:2,timetag:3,limit:4},qchatGetChannelSearchByPageTag:{keyword:1,startTime:2,endTime:3,order:4,limit:5,serverId:6,sort:7,cursor:8},qchatUpdateChannelTag:{channelId:1,name:4,topic:5,ext:6,viewMode:12,visitorMode:16},serverRoles:{serverId:1,roleIds:2,timeTag:3},qchatChannelMemberSearchTag:{serverId:1,channelId:2,keyword:3,limit:4},qchatChannelMemberInfo:{serverId:1,channelId:2,avatar:3,accid:4,nick:5,createTime:6,updateTime:7}},zo=Cc(Yo),Sh={qchatCreateChannel:{sid:24,cid:48,service:"qchatChannel",params:[{type:"Property",name:"channelInfo",reflectMapper:Yo.channelInfo},{type:"Property",name:"antispamTag",reflectMapper:Yo.antispamTag}],response:[{type:"Property",name:"channelInfo",reflectMapper:zo.channelInfo}]},qchatDeleteChannel:{sid:24,cid:49,service:"qchatChannel",params:[{type:"Long",name:"channelId"}]},qchatUpdateChannel:{sid:24,cid:50,service:"qchatChannel",params:[{type:"Property",name:"channelInfo",reflectMapper:Yo.qchatUpdateChannelTag},{type:"Property",name:"antispamTag",reflectMapper:Yo.antispamTag}],response:[{type:"Property",name:"channelInfo",reflectMapper:zo.channelInfo}]},qchatGetChannels:{sid:24,cid:51,service:"qchatChannel",params:[{type:"LongArray",name:"channelIds"}],response:[{type:"PropertyArray",name:"channelList",reflectMapper:zo.channelInfo}]},qchatGetChannelsByPage:{sid:24,cid:52,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelListPageTag",reflectMapper:Yo.qchatGetChannelListPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.channelInfo}]},qchatGetMembersByPage:{sid:24,cid:53,service:"qchatChannel",params:[{type:"Property",name:"qchatGetMembersByPageTag",reflectMapper:Yo.qchatGetMembersByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.memberInfo}]},qchatUpdateWhiteBlackRole:{sid:24,cid:54,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateWhiteBlackRoleTag",reflectMapper:Yo.qchatUpdateWhiteBlackRoleTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.memberInfo}]},qchatGetWhiteBlackRolesPage:{sid:24,cid:55,service:"qchatChannel",params:[{type:"Property",name:"qchatGetWhiteBlackRolesPageTag",reflectMapper:Yo.qchatGetWhiteBlackRolesPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.serverRole}]},qchatUpdateWhiteBlackMembers:{sid:24,cid:56,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateWhiteBlackMembersTag",reflectMapper:Yo.qchatUpdateWhiteBlackMembersTag}]},qchatGetWhiteBlackMembersPage:{sid:24,cid:57,service:"qchatChannel",params:[{type:"Property",name:"qchatGetWhiteBlackMembersPageTag",reflectMapper:Yo.qchatGetWhiteBlackMembersPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.memberInfo}]},qchatGetExistingWhiteBlackRoles:{sid:24,cid:58,service:"qchatChannel",params:[{type:"Property",name:"qchatGetExistingWhiteBlackRolesTag",reflectMapper:Yo.qchatGetExistingWhiteBlackRolesTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:zo.serverRole}]},qchatGetExistingWhiteBlackMembers:{sid:24,cid:59,service:"qchatChannel",params:[{type:"Property",name:"qchatGetExistingWhiteBlackMembersTag",reflectMapper:Yo.qchatGetExistingWhiteBlackMembersTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:zo.memberInfo}]},qchatUpdateCategoryInfoOfChannel:{sid:24,cid:60,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateCategoryInfoOfChannelTag",reflectMapper:Yo.channelInfo}],response:[{type:"Property",name:"channelInfo",reflectMapper:zo.channelInfo}]},qchatCreateChannelCategory:{sid:24,cid:109,service:"qchatChannel",params:[{type:"Property",name:"qchatCreateChannelCategoryTag",reflectMapper:Yo.QChatChannelCategoryInfo}],response:[{type:"Property",name:"QChatChannelCategoryInfo",reflectMapper:zo.QChatChannelCategoryInfo}]},qchatRemoveChannelCategory:{sid:24,cid:110,service:"qchatChannel",params:[{type:"Long",name:"categoryId"}]},qchatUpdateChannelCategory:{sid:24,cid:111,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateChannelCategoryTag",reflectMapper:Yo.QChatChannelCategoryInfo}],response:[{type:"Property",name:"QChatChannelCategoryInfo",reflectMapper:zo.QChatChannelCategoryInfo}]},qchatGetChannelCategoriesByID:{sid:24,cid:112,service:"qchatChannel",params:[{type:"LongArray",name:"categoryIds"}],response:[{type:"PropertyArray",name:"channelCategoryList",reflectMapper:zo.QChatChannelCategoryInfo}]},qchatUpdateChannelCategoryWhiteBlackRole:{sid:24,cid:113,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateChannelCategoryWhiteBlackRoleTag",reflectMapper:Yo.qchatUpdateChannelCategoryWhiteBlackRoleTag}]},qchatGetChannelCategoryWhiteBlackRolesPage:{sid:24,cid:114,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackRolesPageTag",reflectMapper:Yo.qchatGetChannelCategoryWhiteBlackRolesPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.serverRole}]},qchatUpdateChannelCategoryWhiteBlackMembers:{sid:24,cid:115,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateChannelCategoryWhiteBlackMembersTag",reflectMapper:Yo.qchatUpdateChannelCategoryWhiteBlackMembersTag}]},qchatGetChannelCategoryWhiteBlackMembersPage:{sid:24,cid:116,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackMembersPageTag",reflectMapper:Yo.qchatGetChannelCategoryWhiteBlackMembersPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.memberInfo}]},qchatGetChannelCategoryWhiteBlackRoles:{sid:24,cid:117,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackRolesTag",reflectMapper:Yo.qchatGetChannelCategoryWhiteBlackRolesTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:zo.serverRole}]},qchatGetChannelCategoryWhiteBlackMembers:{sid:24,cid:118,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackMembersTag",reflectMapper:Yo.qchatGetChannelCategoryWhiteBlackMembersTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:zo.memberInfo}]},qchatGetChannelCategoriesPage:{sid:24,cid:119,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoriesPageTag",reflectMapper:Yo.qchatGetChannelCategoriesPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.QChatChannelCategoryInfo}]},qchatGetChannelCategoryChannelsPage:{sid:24,cid:120,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryChannelsPageTag",reflectMapper:Yo.qchatGetChannelCategoryChannelsPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.channelInfo}]},qchatSubscribe:{sid:24,cid:15,service:"qchatChannel",params:[{type:"Property",name:"qchatSubReqTag",reflectMapper:Yo.qchatSubReqTag},{type:"PropertyArray",name:"channels",reflectMapper:Yo.qchatChannelIdInfoTag}],response:[{type:"PropertyArray",name:"unreadInfos",reflectMapper:zo.unreadInfo},{type:"PropertyArray",name:"failedChannels",reflectMapper:zo.qchatChannelIdInfoTag}]},qchatGetUnreadInfo:{sid:24,cid:27,service:"qchatChannel",params:[{type:"PropertyArray",name:"channels",reflectMapper:Yo.qchatChannelIdInfoTag}],response:[{type:"PropertyArray",name:"unreadInfos",reflectMapper:zo.unreadInfo}]},qchatGetChannelSearchByPage:{sid:24,cid:93,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelSearchByPageTag",reflectMapper:Yo.qchatGetChannelSearchByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag",3:"cursor"}},{type:"PropertyArray",name:"datas",reflectMapper:zo.channelInfo}]},qchatGetRoleIdsByServerId:{sid:25,cid:8,service:"qchatChannel",params:[{type:"Property",name:"qchatGetRoleIdsByServerIdTag",reflectMapper:{serverIdTimeTags:1}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:zo.serverRoles},{type:"LongArray",name:"failServerIds"}]},qchatChannelMemberSearch:{sid:24,cid:95,service:"qchatChannel",params:[{type:"Property",name:"qchatChannelMemberSearchTag",reflectMapper:Yo.qchatChannelMemberSearchTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:zo.qchatChannelMemberInfo}]},qchatSubscribeAsVisitor:{sid:25,cid:9,service:"qchatChannel",params:[{type:"Property",name:"tag",reflectMapper:Yo.qchatSubReqTag},{type:"PropertyArray",name:"datas",reflectMapper:Yo.qchatChannelIdInfoTag}],response:[{type:"PropertyArray",name:"failedArr",reflectMapper:zo.qchatChannelIdInfoTag}]}},Cy={"24_31":"qchatCreateServer","24_32":"qchatDeleteServer","24_33":"qchatUpdateServer","24_34":"qchatGetServers","24_35":"qchatGetServersByPage","24_36":"qchatInviteServerMembers","24_37":"qchatAcceptServerInvite","24_38":"qchatRejectInviteServer","24_39":"qchatApplyServerJoin","24_40":"qchatAcceptServerApply","24_41":"qchatRejectServerApply","24_42":"qchatKickServerMembers","24_43":"qchatLeaveServer","24_44":"qchatUpdateMyMemberInfo","24_45":"qchatUpdateServerMemberInfo","24_46":"qchatGetServerMembers","24_47":"qchatGetServerMembersByPage","24_104":"qchatUpdateServerMemberBan","24_105":"qchatGetBannedMembersByPage","24_91":"qchatServerSearchByPage","24_92":"qchatServerMemberSearchByPage","24_122":"qchatGenerateInviteCode","24_123":"qchatJoinByInviteCode","24_124":"qchatGetInviteApplyRecordOfServer","24_125":"qchatGetInviteApplyRecordOfSelf","25_5":"qchatClearServersUnread","25_7":"qchatSubscribeChannelsByServers","25_10":"qchatEnterAsVisitor","25_11":"qchatLeaveAsVisitor"},Ha={serverInfo:{serverId:1,name:3,icon:4,ext:5,owner:6,memberNumber:7,inviteMode:8,applyMode:9,validFlag:10,createTime:11,updateTime:12,channelNumber:13,categoryNumber:14,searchType:15,searchEnable:16,reorderWeight:17},antispamTag:{antiSpamBusinessId:1},memberInfo:{serverId:1,accid:3,nick:4,avatar:5,ext:6,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},otherMemberInfo:{serverId:1,accid:3,nick:4,avatar:5,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},getServerListPageTag:{timestamp:1,limit:2},getServerMemberListPageTag:{serverId:1,timetag:2,limit:3},updateServerMemberBanTag:{serverId:1,opeType:2,accid:3,ext:4},getBannedMembersByPageTag:{serverId:1,timetag:2,limit:3},serverMemberBanInfo:{serverId:1,appid:2,accid:3,ext:4,banTime:5,validFlag:6,createTime:7,updateTime:8},serverSearchByPageTag:{keyword:1,startTime:2,endTime:3,order:4,limit:5,serverType:6,searchType:7,sort:8,cursor:9},serverMemberSearchByPageTag:{serverId:1,keyword:3,limit:4},inviteRespParamTag:{requestId:1},applyRespParamTag:{requestId:1,expireTime:2},inviteApplyRecord:{accid:1,type:2,serverId:3,status:4,requestId:5,createTime:6,updateTime:7,expireTime:8,data:9,recordId:10},clearServersUnreadTag:{successServerIds:1,failServerIds:2,ackTimestamp:3},unreadInfo:Th},La=Cc(Ha),Ec={qchatCreateServer:{sid:24,cid:31,service:"qchatServer",params:[{type:"Property",name:"serverInfo",reflectMapper:Ha.serverInfo},{type:"Property",name:"antispamTag",reflectMapper:Ha.antispamTag}],response:[{type:"Property",name:"serverInfo",reflectMapper:La.serverInfo}]},qchatDeleteServer:{sid:24,cid:32,service:"qchatServer",params:[{type:"Long",name:"serverId"}]},qchatUpdateServer:{sid:24,cid:33,service:"qchatServer",params:[{type:"Property",name:"serverInfo",reflectMapper:Ha.serverInfo},{type:"Property",name:"antispamTag",reflectMapper:Ha.antispamTag}],response:[{type:"Property",name:"serverInfo",reflectMapper:La.serverInfo}]},qchatGetServers:{sid:24,cid:34,service:"qchatServer",params:[{type:"LongArray",name:"serverIds"}],response:[{type:"PropertyArray",name:"serverList",reflectMapper:La.serverInfo}]},qchatGetServersByPage:{sid:24,cid:35,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:Ha.getServerListPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:La.serverInfo}]},qchatInviteServerMembers:{sid:24,cid:36,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"StrArray",name:"accids"},{type:"String",name:"ps"},{type:"Property",name:"params",reflectMapper:{ttl:1}}],response:[{type:"StrArray",name:"failByOverAccids"},{type:"StrArray",name:"failByBanAccids"},{type:"Property",name:"record",reflectMapper:La.applyRespParamTag}]},qchatAcceptServerInvite:{sid:24,cid:37,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"Property",name:"recordInfo",reflectMapper:Ha.inviteRespParamTag}]},qchatRejectInviteServer:{sid:24,cid:38,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"String",name:"ps"},{type:"Property",name:"recordInfo",reflectMapper:Ha.inviteRespParamTag}]},qchatApplyServerJoin:{sid:24,cid:39,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"ps"},{type:"Property",name:"params",reflectMapper:{ttl:1}}],response:[{type:"Property",name:"data",reflectMapper:La.applyRespParamTag}]},qchatAcceptServerApply:{sid:24,cid:40,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"Property",name:"recordInfo",reflectMapper:Ha.applyRespParamTag}]},qchatRejectServerApply:{sid:24,cid:41,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"String",name:"ps"},{type:"Property",name:"recordInfo",reflectMapper:Ha.applyRespParamTag}]},qchatKickServerMembers:{sid:24,cid:42,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"StrArray",name:"accids"}]},qchatLeaveServer:{sid:24,cid:43,service:"qchatServer",params:[{type:"Long",name:"serverId"}]},qchatUpdateMyMemberInfo:{sid:24,cid:44,service:"qchatServer",params:[{type:"Property",name:"memberInfo",reflectMapper:Ha.memberInfo},{type:"Property",name:"antispamTag",reflectMapper:Ha.antispamTag}],response:[{type:"Property",name:"memberInfo",reflectMapper:La.memberInfo}]},qchatUpdateServerMemberInfo:{sid:24,cid:45,service:"qchatServer",params:[{type:"Property",name:"memberInfo",reflectMapper:Ha.otherMemberInfo},{type:"Property",name:"antispamTag",reflectMapper:Ha.antispamTag}],response:[{type:"Property",name:"memberInfo",reflectMapper:La.memberInfo}]},qchatGetServerMembers:{sid:24,cid:46,service:"qchatServer",params:[{type:"StrArray",name:"accids"}],response:[{type:"PropertyArray",name:"accidList",reflectMapper:La.memberInfo}]},qchatGetServerMembersByPage:{sid:24,cid:47,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:Ha.getServerMemberListPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:La.memberInfo}]},qchatUpdateServerMemberBan:{sid:24,cid:104,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:Ha.updateServerMemberBanTag}]},qchatGetBannedMembersByPage:{sid:24,cid:105,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:Ha.getBannedMembersByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:La.serverMemberBanInfo}]},qchatServerSearchByPage:{sid:24,cid:91,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:Ha.serverSearchByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag",3:"cursor"}},{type:"PropertyArray",name:"datas",reflectMapper:La.serverInfo}]},qchatServerMemberSearchByPage:{sid:24,cid:92,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:Ha.serverMemberSearchByPageTag}],response:[{type:"PropertyArray",name:"members",reflectMapper:La.serverMemberBanInfo}]},qchatGenerateInviteCode:{sid:24,cid:122,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,ttl:2}}],response:[{type:"Property",name:"data",reflectMapper:{1:"serverId",2:"requestId",3:"inviteCode",4:"expireTime"}}]},qchatJoinByInviteCode:{sid:24,cid:123,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,inviteCode:2,ps:3}}]},qchatGetInviteApplyRecordOfServer:{sid:24,cid:124,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,fromTime:2,toTime:3,reverse:4,limit:5,cursor:6}}],response:[{type:"PropertyArray",name:"data",reflectMapper:La.inviteApplyRecord}]},qchatGetInviteApplyRecordOfSelf:{sid:24,cid:125,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{fromTime:1,toTime:2,reverse:3,limit:4,cursor:5}}],response:[{type:"PropertyArray",name:"data",reflectMapper:La.inviteApplyRecord}]},qchatClearServersUnread:{sid:25,cid:5,service:"qchatServer",params:[{type:"LongArray",name:"serverIds"}],response:[{type:"Property",name:"clearServersUnreadTag",reflectMapper:La.clearServersUnreadTag}]},qchatSubscribeChannelsByServers:{sid:25,cid:7,service:"qchatServer",params:[{type:"int",name:"type"},{type:"LongArray",name:"serverIds"}],response:[{type:"PropertyArray",name:"unreadInfos",reflectMapper:La.unreadInfo},{type:"LongArray",name:"failServerIds"}]},qchatEnterAsVisitor:{sid:25,cid:10,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverIds:1}}],response:[{type:"LongArray",name:"failServerIds"}]},qchatLeaveAsVisitor:{sid:25,cid:11,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverIds:1}}],response:[{type:"LongArray",name:"failServerIds"}]}},ss=Function.prototype,CS=Object.prototype,My=ss.toString,MS=CS.hasOwnProperty,kS=My.call(Object),qp=function(x){if(!cs(x)||Qs(x)!="[object Object]")return!1;var D=ly(x);if(D===null)return!0;var F=MS.call(D,"constructor")&&D.constructor;return typeof F=="function"&&F instanceof F&&My.call(F)==kS};function ya(S,x){if(!qp(x))return{};var D=JSON.parse(mo(x)),F=ky(S,D);return JSON.parse(mo(Tn(Tn({},D),F)))}function ky(S,x){if(!qp(x))return{};var D={},F=na(S);return In(F).call(F,function(O){var oe=S[O].type;if(typeof oe!="string"){var xe=ky(S[O],x);na(xe).length>0&&(D[O]=xe)}else{var z=S[O],qe=z.rawKey||O,Lt=_S[oe](x,qe,z);Lt!==void 0&&(x[qe]=void 0,D[O]=Lt)}}),D}var _S={number:function(x,D){if(x[D]!==void 0)return+x[D]},string:function(x,D){if(x[D]!==void 0)return x[D]},boolean:function(x,D){return+x[D]>0||+x[D]!=0&&void 0},enum:function(x,D,F){return ip(F)[x[D]]},object:function(x,D){if(x[D]!==void 0)try{return JSON.parse(x[D])}catch{return{}}}};function Gl(S,x){if(!qp(x))return{};var D=JSON.parse(mo(x)),F=_y(S,D);return JSON.parse(mo(Tn(Tn({},D),F)))}function _y(S,x){var D;if(!qp(x))return Sc(D=na(S)).call(D,function(oe,xe){return oe[S[xe].rawKey||xe]=void 0,oe},{});var F={},O=na(S);return In(O).call(O,function(oe){var xe=S[oe].type;if(typeof xe!="string"){var z=_y(S[oe],x[oe]);return Tn(F,z),void(x[oe]=void 0)}var qe=S[oe],Lt=qe.rawKey||oe,lr=Vp[xe](x,oe,qe);x[Lt]=void 0,F[Lt]=lr}),F}var Vp={number:function(x,D){return x[D]},string:function(x,D){return x[D]},boolean:function(x,D){return x[D]===!0?1:x[D]===!1?0:void 0},enum:function(x,D,F){return ip(F)[x[D]]},object:function(x,D){if(x[D]!==void 0)try{return mo(x[D])}catch{return""}}},Ch=Vp,wy={serverId:{type:"string"},name:{type:"string"},icon:{type:"string"},ext:{type:"string"},owner:{type:"string"},memberNumber:{type:"number"},inviteMode:{type:"number"},applyMode:{type:"number"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},channelNumber:{type:"number"},categoryNumber:{type:"number"},searchType:{type:"number"},searchEnable:{type:"boolean"},reorderWeight:{type:"string"}},wS={serverId:{type:"string"},uid:{type:"string"},accid:{type:"string"},nick:{type:"string"},avatar:{type:"string"},ext:{type:"string"},type:{type:"number"},joinTime:{type:"number"},inviter:{type:"string"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"}},xS={serverId:{type:"string"},appid:{type:"string"},accid:{type:"string"},ext:{type:"string"},banTime:{type:"number"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"}};function xd(S){return ya(wy,S)}function Mh(S){return ns(S)&&S.length>0?vo(S).call(S,function(x){return xd(x)}):[]}function Ql(S){return ya(wS,S)}function cc(S){return ns(S)&&S.length>0?vo(S).call(S,function(x){return Ql(x)}):[]}function IS(S){return ns(S)&&S.length>0?vo(S).call(S,function(x){return function(F){return ya(xS,F)}(x)}):[]}function Pc(S){var x,D,F;if(!S.antispamTag)return{};var O=Tn({},S.antispamTag);return!((x=S.antispamTag)===null||x===void 0)&&x.antiSpamBusinessId&&typeof((D=S.antispamTag)===null||D===void 0?void 0:D.antiSpamBusinessId)!="string"&&(O.antiSpamBusinessId=mo((F=S.antispamTag)===null||F===void 0?void 0:F.antiSpamBusinessId)),O}var ES={accid:{type:"string"},type:{type:"number"},serverId:{type:"string"},status:{type:"number"},requestId:{type:"string"},createTime:{type:"number"},updateTime:{type:"number"},expireTime:{type:"number"},data:{type:"object"}};function Id(S){return ya(ES,S)}function xy(S){return ns(S)&&S.length>0?vo(S).call(S,function(x){return Id(x)}):[]}var Hp,ca,Zs,hl,PS={successServerIds:{type:"object"},failServerIds:{type:"object"},ackTimestamp:{type:"number"}};function vl(S){return ya(PS,S)}(function(S){S[S.reorderWeight=0]="reorderWeight",S[S.createTime=1]="createTime"})(Hp||(Hp={})),function(S){S[S.white=1]="white",S[S.black=2]="black"}(ca||(ca={})),function(S){S[S.add=1]="add",S[S.remove=2]="remove"}(Zs||(Zs={})),function(S){S[S.message=0]="message",S[S.media=1]="media",S[S.ext=100]="ext"}(hl||(hl={}));var Ed={channelId:{type:"string"},serverId:{type:"string"},name:{type:"string"},topic:{type:"string"},ext:{type:"string"},type:{type:"enum",values:hl},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},viewMode:{type:"number"},categoryId:{type:"string"},syncMode:{type:"number"},visitorMode:{type:"number"},reorderWeight:{type:"string"}},AS={serverId:{type:"string"},channelId:{type:"string"},ackTimestamp:{type:"number"},unreadCount:{type:"number"},mentionedCount:{type:"number"},maxCount:{type:"number"},lastMsgTime:{type:"number"}},Iy={serverId:{type:"string"},channelId:{type:"string"},type:{type:"enum",values:ca},opeType:{type:"enum",values:Zs},toAccids:{type:"object"}},zp={serverId:{type:"string"},channelId:{type:"string"},type:{type:"enum",values:ca},opeType:{type:"enum",values:Zs},roleId:{type:"string"}},OS={categoryId:{type:"string"},serverId:{type:"string"},name:{type:"string"},ext:{type:"string"},owner:{type:"string"},viewMode:{type:"number"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},channelNumber:{type:"number"}},Ey={serverId:{type:"string"},channelId:{type:"string"},accid:{type:"string"},avatar:{type:"string"},nick:{type:"string"},createTime:{type:"number"},updateTime:{type:"number"}};function Pd(S){return ya(zp,S)}function Ad(S){return ya(Ed,S)}function Od(S){return ns(S)&&S.length>0?vo(S).call(S,function(x){return Ad(x)}):[]}function kh(S){return ya(AS,S)}function Nd(S){return ns(S)&&S.length>0?vo(S).call(S,function(x){return kh(x)}):[]}function Rd(S){return ya(OS,S)}function _h(S){return ns(S)&&S.length>0?vo(S).call(S,function(x){return Rd(x)}):[]}function NS(S){return ns(S)&&S.length>0?vo(S).call(S,function(x){return function(F){return ya(Ey,F)}(x)}):[]}function Bd(S){try{return JSON.parse(S)}catch{return[]}}var Kp=wi?wi.isConcatSpreadable:void 0,RS=function(x){return Oi(x)||Zg(x)||!!(Kp&&x&&x[Kp])},Py=function S(x,D,F,O,oe){var xe=-1,z=x.length;for(F||(F=RS),oe||(oe=[]);++xe<z;){var qe=x[xe];D>0&&F(qe)?D>1?S(qe,D-1,F,O,oe):As(oe,qe):O||(oe[oe.length]=qe)}return oe},wh=Pv(function(S,x){return En(S)?Rg(S,Py(x,1,En,!0)):[]}),Wp=wh;function xh(S,x){var D,F=ha!==void 0&&Va(S)||S["@@iterator"];if(F)return Oo(D=(F=F.call(S)).next).call(D,F);if(ns(S)||(F=function(xe,z){var qe;if(xe){if(typeof xe=="string")return Ih(xe,z);var Lt=Co(qe=Object.prototype.toString.call(xe)).call(qe,8,-1);if(Lt==="Object"&&xe.constructor&&(Lt=xe.constructor.name),Lt==="Map"||Lt==="Set")return _c(xe);if(Lt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Lt))return Ih(xe,z)}}(S))||x&&S&&typeof S.length=="number"){F&&(S=F);var O=0;return function(){return O>=S.length?{done:!0}:{done:!1,value:S[O++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ih(S,x){(x==null||x>S.length)&&(x=S.length);for(var D=0,F=new Array(x);D<x;D++)F[D]=S[D];return F}var Jl,Fd,yl,bl,BS=function(S){function x(F){var O;return(O=S.call(this,"qchatServer",F)||this).core=F,Ei({cmdMap:Cy,cmdConfig:Ec}),O}Ro(x,S);var D=x.prototype;return D.createServer=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({icon:{type:"string",required:!1},name:{type:"string",required:!1},ext:{type:"string",required:!1},searchType:{type:"number",required:!1,min:0},searchEnable:{type:"boolean",required:!1},inviteMode:{type:"number",min:0,max:1,required:!1},applyMode:{type:"number",min:0,max:1,required:!1}},O),qe.next=3,this.core.sendCmd("qchatCreateServer",{serverInfo:Tn(Tn({},O),{searchEnable:O.searchEnable===!1?0:1}),antispamTag:Pc(O)});case 3:return xe=qe.sent,qe.abrupt("return",xd(xe.content.serverInfo));case 5:case"end":return qe.stop()}},oe,this)}))},D.deleteServer=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",min:1}},O),z.next=3,this.core.sendCmd("qchatDeleteServer",O);case 3:case"end":return z.stop()}},oe,this)}))},D.updateServer=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",min:1},icon:{type:"string",required:!1},name:{type:"string",required:!1},ext:{type:"string",required:!1},searchType:{type:"number",required:!1,min:0},searchEnable:{type:"boolean",required:!1},inviteMode:{type:"number",min:0,max:1,required:!1},applyMode:{type:"number",min:0,max:1,required:!1}},O),qe.next=3,this.core.sendCmd("qchatUpdateServer",{serverInfo:Tn(Tn({},O),{searchEnable:O.searchEnable===!1?0:1}),antispamTag:Pc(O)});case 3:return xe=qe.sent,qe.abrupt("return",xd(xe.content.serverInfo));case 5:case"end":return qe.stop()}},oe,this)}))},D.getServers=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverIds:{type:"array",itemType:"string",min:1}},O),qe.next=3,this.core.sendCmd("qchatGetServers",O);case 3:return xe=qe.sent,qe.abrupt("return",Mh(xe.content.serverList));case 5:case"end":return qe.stop()}},oe,this)}))},D.getServersByPage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Gr({timestamp:{type:"number"},limit:{type:"number",min:1,required:!1}},O),pr.next=3,this.core.sendCmd("qchatGetServersByPage",{tag:O});case 3:return xe=pr.sent,z=xe.content,qe=z.datas,Lt=z.listQueryTag,pr.abrupt("return",{listQueryTag:{hasMore:+Lt.hasMore==1,nextTimetag:Lo(Lt.nextTimetag)},datas:Mh(qe)});case 6:case"end":return pr.stop()}},oe,this)}))},D.inviteServerMembers=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Gr({serverId:{type:"string",min:1},accids:{type:"array",itemType:"string",min:1},ps:{type:"string"},params:{type:"object",rules:{ttl:{type:"number"}},required:!1}},O),Lt.next=3,this.core.sendCmd("qchatInviteServerMembers",O);case 3:return xe=Lt.sent,z=xe.content.record||{},Lt.abrupt("return",{failByOverAccids:xe.content.failByOverAccids,failByBanAccids:xe.content.failByBanAccids,recordInfo:Id(z)});case 6:case"end":return Lt.stop()}},oe,this)}))},D.acceptServerInvite=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},O),z.next=3,this.core.sendCmd("qchatAcceptServerInvite",O);case 3:case"end":return z.stop()}},oe,this)}))},D.rejectInviteServer=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",min:1},accid:{type:"string",min:1},ps:{type:"string"},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},O),z.next=3,this.core.sendCmd("qchatRejectInviteServer",O);case 3:case"end":return z.stop()}},oe,this)}))},D.applyServerJoin=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",min:1},ps:{type:"string"},params:{type:"object",rules:{ttl:{type:"number"}},required:!1}},O),qe.next=3,this.core.sendCmd("qchatApplyServerJoin",O);case 3:return xe=qe.sent,qe.abrupt("return",Id(xe.content.data));case 5:case"end":return qe.stop()}},oe,this)}))},D.acceptServerApply=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",min:1},accid:{type:"string",min:1},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},O),z.next=3,this.core.sendCmd("qchatAcceptServerApply",O);case 3:case"end":return z.stop()}},oe,this)}))},D.rejectServerApply=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",min:1},accid:{type:"string",min:1},ps:{type:"string"},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},O),z.next=3,this.core.sendCmd("qchatRejectServerApply",O);case 3:case"end":return z.stop()}},oe,this)}))},D.kickServerMembers=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",min:1},accids:{type:"array",itemType:"string",min:1}},O),z.next=3,this.core.sendCmd("qchatKickServerMembers",O);case 3:case"end":return z.stop()}},oe,this)}))},D.leaveServer=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",min:1}},O),z.next=3,this.core.sendCmd("qchatLeaveServer",O);case 3:case"end":return z.stop()}},oe,this)}))},D.updateMyMemberInfo=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",min:1},accid:{type:"string",required:!1},nick:{type:"string",required:!1},avatar:{type:"string",required:!1},ext:{type:"string",required:!1}},O),qe.next=3,this.core.sendCmd("qchatUpdateMyMemberInfo",{memberInfo:O,antispamTag:Pc(O)});case 3:return xe=qe.sent,qe.abrupt("return",Ql(xe.content.memberInfo));case 5:case"end":return qe.stop()}},oe,this)}))},D.updateServerMemberInfo=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",min:1},accid:{type:"string",min:1},nick:{type:"string",required:!1},avatar:{type:"string",required:!1}},O),qe.next=3,this.core.sendCmd("qchatUpdateServerMemberInfo",{memberInfo:O,antispamTag:Pc(O)});case 3:return xe=qe.sent,qe.abrupt("return",Ql(xe.content.memberInfo));case 5:case"end":return qe.stop()}},oe,this)}))},D.getServerMembers=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt,lr;return ar.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:if(Gr({accids:{type:"array"}},O),xe=[],O.accids.length)for(z=xh(O.accids);!(qe=z()).done;)Lt=qe.value,xe.push(Lt.serverId+"|"+Lt.accid);return Sr.next=5,this.core.sendCmd("qchatGetServerMembers",{accids:xe});case 5:return lr=Sr.sent,Sr.abrupt("return",cc(lr.content.accidList));case 7:case"end":return Sr.stop()}},oe,this)}))},D.getServerMembersByPage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Gr({serverId:{type:"string",min:1},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},O),pr.next=3,this.core.sendCmd("qchatGetServerMembersByPage",{tag:O});case 3:return xe=pr.sent,z=xe.content,qe=z.datas,Lt=z.listQueryTag,pr.abrupt("return",{listQueryTag:{hasMore:+Lt.hasMore==1,nextTimetag:Lo(Lt.nextTimetag)},datas:cc(qe)});case 6:case"end":return pr.stop()}},oe,this)}))},D.subscribeServer=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:if(Gr({type:{type:"number",min:4,max:4,required:!1},opeType:{type:"number",min:1,max:2}},O),O.type||(O.type=4),!O.servers.length){pr.next=10;break}return z=Tn(Tn({},O),{channels:vo(xe=O.servers).call(xe,function(Sr){return{serverId:Sr.serverId,channelId:""}})}),pr.next=6,this.core.qchatChannel.subscribeModuleService.subscribe(z);case 6:return qe=pr.sent,Lt=qe.failedChannels,this.core.qchatChannel.subscribeModuleService.cacheSubscribe(z),pr.abrupt("return",{failedServers:Lt});case 10:case"end":return pr.stop()}},oe,this)}))},D.banServerMember=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},O),z.next=3,this.core.sendCmd("qchatUpdateServerMemberBan",{tag:Tn(Tn({},O),{opeType:1})});case 3:case"end":return z.stop()}},oe,this)}))},D.unbanServerMember=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},O),z.next=3,this.core.sendCmd("qchatUpdateServerMemberBan",{tag:Tn(Tn({},O),{opeType:2})});case 3:case"end":return z.stop()}},oe,this)}))},D.getBannedMembersByPage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},O),pr.next=3,this.core.sendCmd("qchatGetBannedMembersByPage",{tag:O});case 3:return xe=pr.sent,z=xe.content,qe=z.datas,Lt=z.listQueryTag,pr.abrupt("return",{listQueryTag:{hasMore:+Lt.hasMore==1,nextTimetag:Lo(Lt.nextTimetag)},datas:IS(qe)});case 6:case"end":return pr.stop()}},oe,this)}))},D.serverSearchByPage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:if(Gr({keyword:{type:"string",allowEmpty:!1},startTime:{type:"number",min:0,required:!1},endTime:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1},serverType:{type:"array",itemType:"number",min:0,required:!1},order:{type:"enum",values:ia(Ic),required:!1},searchType:{type:"enum",values:ia(Up)},sort:{type:"enum",values:ia(bi),required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},O),!(O.startTime&&O.endTime&&O.startTime>=O.endTime)){pr.next=3;break}throw new al("startTime more than endTime",O,"timeRule");case 3:return pr.next=5,this.core.sendCmd("qchatServerSearchByPage",{tag:Tn(Tn({},O),{order:O.order&&Ic[O.order],searchType:Up[O.searchType],sort:Wl(O)&&bi[Wl(O)],serverType:mo(O.serverType)})});case 5:return xe=pr.sent,z=xe.content,qe=z.datas,Lt=z.listQueryTag,pr.abrupt("return",{listQueryTag:{hasMore:+Lt.hasMore==1,nextTimetag:Lo(Lt.nextTimetag),cursor:Lt.cursor},datas:Mh(qe)});case 8:case"end":return pr.stop()}},oe,this)}))},D.serverMemberSearchByPage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},keyword:{type:"string",allowEmpty:!1},limit:{type:"number",min:1,required:!1}},O),qe.next=3,this.core.sendCmd("qchatServerMemberSearchByPage",{tag:O});case 3:return xe=qe.sent,qe.abrupt("return",cc(xe.content.members));case 5:case"end":return qe.stop()}},oe,this)}))},D.generateInviteCode=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},ttl:{type:"number",min:0,required:!1}},O),qe.next=3,this.core.sendCmd("qchatGenerateInviteCode",{tag:O});case 3:return xe=qe.sent,qe.abrupt("return",ya({expireTime:{type:"number"}},xe.content.data));case 5:case"end":return qe.stop()}},oe,this)}))},D.joinByInviteCode=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},inviteCode:{type:"string",allowEmpty:!1},ps:{type:"string",required:!1}},O),z.next=3,this.core.sendCmd("qchatJoinByInviteCode",{tag:O});case 3:case"end":return z.stop()}},oe,this)}))},D.getInviteApplyRecordOfServer=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},fromTime:{type:"number",min:0},toTime:{type:"number",min:0},reverse:{type:"boolean",required:!1},limit:{type:"number",min:1,required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},O),qe.next=3,this.core.sendCmd("qchatGetInviteApplyRecordOfServer",{tag:Tn(Tn({},O),{reverse:kl(O)?1:0})});case 3:return xe=qe.sent,qe.abrupt("return",xy(xe.content.data));case 5:case"end":return qe.stop()}},oe,this)}))},D.getInviteApplyRecordOfSelf=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({fromTime:{type:"number",min:0},toTime:{type:"number",min:0},reverse:{type:"boolean",required:!1},limit:{type:"number",min:1,required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},O),qe.next=3,this.core.sendCmd("qchatGetInviteApplyRecordOfSelf",{tag:Tn(Tn({},O),{reverse:kl(O)?1:0})});case 3:return xe=qe.sent,qe.abrupt("return",xy(xe.content.data));case 5:case"end":return qe.stop()}},oe,this)}))},D.markRead=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Gr({serverIds:{type:"array",itemType:"string",required:!0}},O),pr.next=3,this.core.sendCmd("qchatClearServersUnread",O);case 3:return xe=pr.sent,z=vl(xe.content.clearServersUnreadTag),qe=z.successServerIds,Lt=z.ackTimestamp,this.logger.log("qchatServer::clearServersUnread:: begin auto clear servers unreadInfo"),this.core.eventBus.emit("qchatChannel/clearUnreadCountByServers",qe,Lt),pr.abrupt("return",z);case 9:case"end":return pr.stop()}},oe,this)}))},D.subscribeAllChannel=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return Gr({type:{type:"number",required:!0},serverIds:{type:"array",itemType:"string",required:!0,max:10}},O),lr.next=3,this.core.sendCmd("qchatSubscribeChannelsByServers",O,{timeout:3e4});case 3:return(z=lr.sent).content.unreadInfos=Nd(z.content.unreadInfos),z.content.failServerIds=Bd(z.content.failServerIds),qe={type:O.type,opeType:1,channels:vo(xe=z.content.unreadInfos).call(xe,function(pr){return{serverId:pr.serverId,channelId:pr.channelId}})},this.core.eventBus.emit("qchatChannel/cacheSubscribe",qe),this.core.eventBus.emit("qchatChannel/getRoleIdsByServerId",O.serverIds),this.core.eventBus.emit("qchatChannel/updateUnreads",z.content.unreadInfos),lr.abrupt("return",z.content);case 11:case"end":return lr.stop()}},oe,this)}))},D.enterAsVisitor=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return Gr({serverIds:{type:"array",itemType:"string",min:1}},O),lr.next=3,this.core.sendCmd("qchatEnterAsVisitor",{tag:{serverIds:mo(O.serverIds)}});case 3:return xe=lr.sent,z=Bd(xe.content.failServerIds),qe=Wp(O.serverIds,z),this.core.qchatChannel.subscribeForVisitorService.cacheServer(qe),lr.abrupt("return",{failedServers:z});case 8:case"end":return lr.stop()}},oe,this)}))},D.leaveAsVisitor=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt=this;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Gr({serverIds:{type:"array",itemType:"string",min:1}},O),pr.next=3,this.core.sendCmd("qchatLeaveAsVisitor",{tag:{serverIds:mo(O.serverIds)}});case 3:return xe=pr.sent,z=Bd(xe.content.failServerIds),qe=Wp(O.serverIds,z),In(qe).call(qe,function(Sr){Lt.core.qchatChannel.subscribeForVisitorService.deleteServer(Sr)}),pr.abrupt("return",{failedServers:z});case 8:case"end":return pr.stop()}},oe,this)}))},D.subscribeAsVisitor=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(Gr({opeType:{type:"number",min:1,max:2},type:{type:"number",required:!1},serverIds:{type:"array",itemType:"string",min:1}},O),!O.serverIds.length){z.next=5;break}return z.next=4,this.core.qchatChannel.subscribeForVisitorService.subscribeServerAsVisitor(O);case 4:return z.abrupt("return",z.sent);case 5:return z.abrupt("return",{failedServers:[]});case 6:case"end":return z.stop()}},oe,this)}))},x}(gl);(function(S){S[S.everyone=1]="everyone",S[S.custom=2]="custom"})(Jl||(Jl={})),function(S){S[S.normal=0]="normal",S[S.owner=1]="owner"}(Fd||(Fd={})),function(S){S[S.ignore=0]="ignore",S[S.deny=-1]="deny",S[S.allow=1]="allow"}(yl||(yl={})),function(S){S[S.manageServer=1]="manageServer",S[S.manageChannel=2]="manageChannel",S[S.manageRole=3]="manageRole",S[S.sendMsg=4]="sendMsg",S[S.accountInfoSelf=5]="accountInfoSelf",S[S.inviteServer=6]="inviteServer",S[S.kickServer=7]="kickServer",S[S.accountInfoOther=8]="accountInfoOther",S[S.recallMsg=9]="recallMsg",S[S.deleteMsg=10]="deleteMsg",S[S.remindOther=11]="remindOther",S[S.remindEveryone=12]="remindEveryone",S[S.manageBlackWhiteList=13]="manageBlackWhiteList",S[S.banServerMember=14]="banServerMember",S[S.RTCChannelConnect=15]="RTCChannelConnect",S[S.RTCChannelDisconnectOther=16]="RTCChannelDisconnectOther",S[S.RTCChannelOpenMicrophone=17]="RTCChannelOpenMicrophone",S[S.RTCChannelOpenCamera=18]="RTCChannelOpenCamera",S[S.RTCChannelOpenCloseOtherMicrophone=19]="RTCChannelOpenCloseOtherMicrophone",S[S.RTCChannelOpenCloseOtherCamera=20]="RTCChannelOpenCloseOtherCamera",S[S.RTCChannelOpenCloseEveryoneMicrophone=21]="RTCChannelOpenCloseEveryoneMicrophone",S[S.RTCChannelOpenCloseEveryoneCamera=22]="RTCChannelOpenCloseEveryoneCamera",S[S.RTCChannelOpenShareScreen=23]="RTCChannelOpenShareScreen",S[S.RTCChannelCloseOtherShareScreen=24]="RTCChannelCloseOtherShareScreen",S[S.manageInviteApply=25]="manageInviteApply",S[S.manageInviteApplyHistory=26]="manageInviteApplyHistory",S[S.mentionedRole=27]="mentionedRole"}(bl||(bl={}));var Ay={type:{type:"enum",values:Jl},memberType:{type:"enum",values:Fd},createTime:{type:"number"},updateTime:{type:"number"},priority:{type:"number"},memberCount:{type:"number"},joinTime:{type:"number"}},FS={roleId:{type:"string"},categoryId:{type:"string"},serverId:{type:"string"},type:{type:"enum",values:Jl},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},name:{type:"string"},icon:{type:"string"},ext:{type:"string"}},LS={id:{type:"string"},accid:{type:"string"},categoryId:{type:"string"},serverId:{type:"string"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},nick:{type:"string"},avatar:{type:"string"},ext:{type:"string"},memberType:{type:"enum",values:Fd},joinTime:{type:"number"},inviter:{type:"string"}};function Ac(S){var x=Tn({},S),D=Gl(Ay,x);return D.auths&&(D.auths=function(O){var oe,xe=Sc(oe=na(O)).call(oe,function(z,qe){var Lt=bl[qe];return Lt?z[Lt]=yl[O[qe]]:z[qe]=yl[O[qe]],z},{});return mo(xe)}(D.auths)),D}function Ti(S){var x;return Sc(x=na(S)).call(x,function(D,F){var O=Rv(bl,F);return O?D[O]=yl[S[F]]:D[Lo(F)]=yl[S[F]],D},{})}function us(S){var x=ya(Ay,S);return S.auths&&(x.auths=Ti(JSON.parse(x.auths))),x.isMember&&delete x.isMember,x}function zs(S){return ns(S)&&S.length>0?vo(S).call(S,function(x){return us(x)}):[]}function Gp(S){return S.auths&&(S.auths=Ti(JSON.parse(S.auths))),ya(FS,S)}function Yl(S){return S.auths&&(S.auths=Ti(JSON.parse(S.auths))),ya(LS,S)}Gh("Set",function(S){return function(){return S(this,arguments.length?arguments[0]:void 0)}},od);var Oy=or.Set;Vr({target:"Set",stat:!0,forced:!0},{from:ag}),Vr({target:"Set",stat:!0,forced:!0},{of:Jh}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{addAll:function(){for(var x=Vn(this),D=Or(x.add),F=0,O=arguments.length;F<O;F++)Ce(D,x,arguments[F]);return x}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{deleteAll:Yh});var Tl=Wi;Vr({target:"Set",proto:!0,real:!0,forced:!0},{every:function(x){var D=Vn(this),F=Tl(D),O=$o(x,arguments.length>1?arguments[1]:void 0);return!so(F,function(oe,xe){if(!O(oe,oe,D))return xe()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{difference:function(x){var D=Vn(this),F=new(Ms(D,$e("Set")))(D),O=Or(F.delete);return so(x,function(oe){Ce(O,F,oe)}),F}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{filter:function(x){var D=Vn(this),F=Tl(D),O=$o(x,arguments.length>1?arguments[1]:void 0),oe=new(Ms(D,$e("Set"))),xe=Or(oe.add);return so(F,function(z){O(z,z,D)&&Ce(xe,oe,z)},{IS_ITERATOR:!0}),oe}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{find:function(x){var D=Vn(this),F=Tl(D),O=$o(x,arguments.length>1?arguments[1]:void 0);return so(F,function(oe,xe){if(O(oe,oe,D))return xe(oe)},{IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{intersection:function(x){var D=Vn(this),F=new(Ms(D,$e("Set"))),O=Or(D.has),oe=Or(F.add);return so(x,function(xe){Ce(O,D,xe)&&Ce(oe,F,xe)}),F}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{isDisjointFrom:function(x){var D=Vn(this),F=Or(D.has);return!so(x,function(O,oe){if(Ce(F,D,O)===!0)return oe()},{INTERRUPTED:!0}).stopped}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{isSubsetOf:function(x){var D=Wi(this),F=Vn(x),O=F.has;return ae(O)||(F=new($e("Set"))(x),O=Or(F.has)),!so(D,function(oe,xe){if(Ce(O,F,oe)===!1)return xe()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{isSupersetOf:function(x){var D=Vn(this),F=Or(D.has);return!so(x,function(O,oe){if(Ce(F,D,O)===!1)return oe()},{INTERRUPTED:!0}).stopped}});var Ny=he([].join),$S=[].push;Vr({target:"Set",proto:!0,real:!0,forced:!0},{join:function(x){var D=Vn(this),F=Tl(D),O=x===void 0?",":Aa(x),oe=[];return so(F,$S,{that:oe,IS_ITERATOR:!0}),Ny(oe,O)}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{map:function(x){var D=Vn(this),F=Tl(D),O=$o(x,arguments.length>1?arguments[1]:void 0),oe=new(Ms(D,$e("Set"))),xe=Or(oe.add);return so(F,function(z){Ce(xe,oe,O(z,z,D))},{IS_ITERATOR:!0}),oe}});var Ry=TypeError;Vr({target:"Set",proto:!0,real:!0,forced:!0},{reduce:function(x){var D=Vn(this),F=Tl(D),O=arguments.length<2,oe=O?void 0:arguments[1];if(Or(x),so(F,function(xe){O?(O=!1,oe=xe):oe=x(oe,xe,xe,D)},{IS_ITERATOR:!0}),O)throw Ry("Reduce of empty set with no initial value");return oe}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{some:function(x){var D=Vn(this),F=Tl(D),O=$o(x,arguments.length>1?arguments[1]:void 0);return so(F,function(oe,xe){if(O(oe,oe,D))return xe()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{symmetricDifference:function(x){var D=Vn(this),F=new(Ms(D,$e("Set")))(D),O=Or(F.delete),oe=Or(F.add);return so(x,function(xe){Ce(O,F,xe)||Ce(oe,F,xe)}),F}}),Vr({target:"Set",proto:!0,real:!0,forced:!0},{union:function(x){var D=Vn(this),F=new(Ms(D,$e("Set")))(D);return so(x,Or(F.add),{that:F}),F}});var Qp,Ld,Si,$d,Oc,Xo,lc,Xl=Oy;(function(S){S[S.sendTime=1]="sendTime"})(Qp||(Qp={})),function(S){S[S.text=0]="text",S[S.image=1]="image",S[S.audio=2]="audio",S[S.video=3]="video",S[S.geo=4]="geo",S[S.notification=5]="notification",S[S.file=6]="file",S[S.tip=10]="tip",S[S.robot=11]="robot",S[S.g2=12]="g2",S[S.custom=100]="custom"}(Ld||(Ld={})),function(S){S[S.sending=1]="sending",S[S.success=2]="success",S[S.failed=3]="failed"}(Si||(Si={})),function(S){S[S.notifyAll=1]="notifyAll",S[S.notifySubscribe=2]="notifySubscribe"}($d||($d={})),function(S){S[S.unknown=0]="unknown",S[S.server=1]="server",S[S.channel=2]="channel",S[S.serverAccids=3]="serverAccids",S[S.channelAccids=4]="channelAccids",S[S.accids=5]="accids"}(Oc||(Oc={})),function(S){S[S.serverMemberInvite=1]="serverMemberInvite",S[S.serverMemberInviteReject=2]="serverMemberInviteReject",S[S.serverMemberApply=3]="serverMemberApply",S[S.serverMemberApplyReject=4]="serverMemberApplyReject",S[S.serverCreate=5]="serverCreate",S[S.serverRemove=6]="serverRemove",S[S.serverUpdate=7]="serverUpdate",S[S.serverMemberInviteDone=8]="serverMemberInviteDone",S[S.serverMemberInviteAccept=9]="serverMemberInviteAccept",S[S.serverMemberApplyDone=10]="serverMemberApplyDone",S[S.serverMemberApplyAccept=11]="serverMemberApplyAccept",S[S.serverMemberKick=12]="serverMemberKick",S[S.serverMemberLeave=13]="serverMemberLeave",S[S.serverMemberUpdate=14]="serverMemberUpdate",S[S.channelCreate=15]="channelCreate",S[S.channelRemove=16]="channelRemove",S[S.channelUpdate=17]="channelUpdate",S[S.channelUpdateWhiteBlackIdentify=18]="channelUpdateWhiteBlackIdentify",S[S.channelUpdateWhiteBlackIdentifyUser=19]="channelUpdateWhiteBlackIdentifyUser",S[S.updateQuickComment=20]="updateQuickComment",S[S.channelCategoryCreate=21]="channelCategoryCreate",S[S.channelCategoryRemove=22]="channelCategoryRemove",S[S.channelCategoryUpdate=23]="channelCategoryUpdate",S[S.channelCategoryUpdateWhiteBlackIdentify=24]="channelCategoryUpdateWhiteBlackIdentify",S[S.channelCategoryUpdateWhiteBlackIdentifyUser=25]="channelCategoryUpdateWhiteBlackIdentifyUser",S[S.serverIdentifyAdd=26]="serverIdentifyAdd",S[S.serverIdentifyRemove=27]="serverIdentifyRemove",S[S.serverIdentifyUpdate=28]="serverIdentifyUpdate",S[S.channelIdentifyUpdate=29]="channelIdentifyUpdate",S[S.userIdentifyUpdate=30]="userIdentifyUpdate",S[S.channelVisibilityUpdate=31]="channelVisibilityUpdate",S[S.serverEnterLeave=32]="serverEnterLeave",S[S.serverMemberJoinByInviteCode=33]="serverMemberJoinByInviteCode",S[S.channelVisibilityToVisitorUpdate=34]="channelVisibilityToVisitorUpdate",S[S.myMemberInfoUpdated=35]="myMemberInfoUpdated",S[S.custom=100]="custom",S[S.msgTyping=101]="msgTyping"}(Xo||(Xo={})),function(S){S[S.reply=1]="reply",S[S.thread=2]="thread",S[S.all=3]="all"}(lc||(lc={}));var Eh=function(){return Vs.Date.now()},jS=/\s/,DS=function(x){for(var D=x.length;D--&&jS.test(x.charAt(D)););return D},US=/^\s+/,qS=function(x){return x&&x.slice(0,DS(x)+1).replace(US,"")},VS=/^[-+]0x[0-9a-f]+$/i,HS=/^0b[01]+$/i,zS=/^0o[0-7]+$/i,KS=parseInt,Ph=function(x){if(typeof x=="number")return x;if(Fp(x))return NaN;if(pi(x)){var D=typeof x.valueOf=="function"?x.valueOf():x;x=pi(D)?D+"":D}if(typeof x!="string")return x===0?x:+x;x=qS(x);var F=HS.test(x);return F||zS.test(x)?KS(x.slice(2),F?2:8):VS.test(x)?NaN:+x},WS=Math.max,By=Math.min,GS=function(x,D,F){var O,oe,xe,z,qe,Lt,lr=0,pr=!1,Sr=!1,br=!0;if(typeof x!="function")throw new TypeError("Expected a function");function Er(hn){var Gn=O,Dn=oe;return O=oe=void 0,lr=hn,z=x.apply(Dn,Gn)}function Dr(hn){return lr=hn,qe=setTimeout(vn,D),pr?Er(hn):z}function $r(hn){var Gn=hn-Lt;return Lt===void 0||Gn>=D||Gn<0||Sr&&hn-lr>=xe}function vn(){var hn=Eh();if($r(hn))return Xr(hn);qe=setTimeout(vn,function(Dn){var jo=D-(Dn-Lt);return Sr?By(jo,xe-(Dn-lr)):jo}(hn))}function Xr(hn){return qe=void 0,br&&O?Er(hn):(O=oe=void 0,z)}function wn(){var hn=Eh(),Gn=$r(hn);if(O=arguments,oe=this,Lt=hn,Gn){if(qe===void 0)return Dr(Lt);if(Sr)return clearTimeout(qe),qe=setTimeout(vn,D),Er(Lt)}return qe===void 0&&(qe=setTimeout(vn,D)),z}return D=Ph(D)||0,pi(F)&&(pr=!!F.leading,xe=(Sr="maxWait"in F)?WS(Ph(F.maxWait)||0,D):xe,br="trailing"in F?!!F.trailing:br),wn.cancel=function(){qe!==void 0&&clearTimeout(qe),lr=0,O=Lt=oe=qe=void 0},wn.flush=function(){return qe===void 0?z:Xr(Eh())},wn},Ah=function(x,D,F){var O=!0,oe=!0;if(typeof x!="function")throw new TypeError("Expected a function");return pi(F)&&(O="leading"in F?!!F.leading:O,oe="trailing"in F?!!F.trailing:oe),GS(x,D,{leading:O,maxWait:D,trailing:oe})},QS=function(x,D,F){var O=-1,oe=x.length;D<0&&(D=-D>oe?0:oe+D),(F=F>oe?oe:F)<0&&(F+=oe),oe=D>F?0:F-D>>>0,D>>>=0;for(var xe=Array(oe);++O<oe;)xe[O]=x[O+D];return xe},Zl=function(x,D,F){if(!pi(F))return!1;var O=typeof D;return!!(O=="number"?bp(F)&&yd(D,F.length):O=="string"&&D in F)&&cp(F[D],x)},uc=1/0,JS=function(x){return x?(x=Ph(x))===uc||x===-1/0?17976931348623157e292*(x<0?-1:1):x==x?x:0:x===0?x:0},YS=function(x){var D=JS(x),F=D%1;return D==D?F?D-F:D:0},Jp=Math.ceil,XS=Math.max,jd,eu=function(x,D,F){D=(F?Zl(x,D,F):D===void 0)?1:XS(YS(D),0);var O=x==null?0:x.length;if(!O||D<1)return[];for(var oe=0,xe=0,z=Array(Jp(O/D));oe<O;)z[xe++]=QS(x,oe,oe+=D);return z};(function(S){S[S.sub=1]="sub",S[S.unSub=2]="unSub"})(jd||(jd={}));var Oh,ZS=function(){function S(D){var F=this;this.unreadCount={},this.autoSubscribeUnreadMap={},this.autoSubscribeServerMap={},this.autoSubscribeTypingMap={},this.unreadServerCount={},this.serverRoleIdsMap={},this._serverUnreadInfo=Ah(function(O){F.core.emit("serverUnreadInfo",F.getServerUnreadInfo(O))},100),this.core=D}var x=S.prototype;return x.changeCacheServerRoleIds=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe,Lt,lr,pr,Sr=this;return ar.wrap(function(Er){for(;;)switch(Er.prev=Er.next){case 0:if(xe=F.attach.serverIdentifyInfo,z=xe.serverId,qe=xe.roleId,this.serverRoleIdsMap[z]){Er.next=4;break}return Er.next=4,this.getRoleIdsByServerId([z]);case 4:if(Lt=this.serverRoleIdsMap[z],!(F.time<Lt.timeTag)){Er.next=7;break}return Er.abrupt("return");case 7:if(F.type===Xo[Xo.serverIdentifyAdd]?Lt.roleIds.add(qe):Lt.roleIds.delete(qe),this.core.logger.debug("QChatChannel::qchatChannel/serverIdentifyChange::now "+z+" roleIds is",qs(oe=[]).call(oe,Lt.roleIds)),lr=this.unreadServerCount[z]){Er.next=12;break}return Er.abrupt("return");case 12:pr=eu(na(lr),100),In(pr).call(pr,function(Dr){Sr.core.qchatChannel.getChannelUnreadInfos({channels:vo(Dr).call(Dr,function($r){return{serverId:z,channelId:$r}})})});case 14:case"end":return Er.stop()}},O,this)}))},x.getRoleIdsByServerId=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe,Lt=this;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:if((xe=Js(F).call(F,function(Sr){return!Lt.serverRoleIdsMap[Sr]})).length){pr.next=3;break}return pr.abrupt("return");case 3:return z={serverIdTimeTags:xe},pr.next=6,this.core.sendCmd("qchatGetRoleIdsByServerId",{qchatGetRoleIdsByServerIdTag:z});case 6:qe=pr.sent,this.core.logger.debug("QChatChannel:: getRoleIdsByServerId, params is ",z,"result is",qe),In(oe=qe.content.serverRoles).call(oe,function(Sr){try{Sr.roleIds=JSON.parse(Sr.roleIds)}catch(br){Lt.core.logger.error("QChatChannel:: getRoleIdsByServerId JSON parse roleIds error",br)}Lt.serverRoleIdsMap[Sr.serverId]={roleIds:new Xl(Sr.roleIds),timeTag:Sr.timeTag}});case 9:case"end":return pr.stop()}},O,this)}))},x._unSubscribeChannel=function(F,O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:if(xe=F+"_"+O,z=this.autoSubscribeUnreadMap[xe]){Lt.next=4;break}return Lt.abrupt("return");case 4:this.subscribe({opeType:jd.unSub,type:z,channels:[{serverId:F,channelId:O}]}),this.autoSubscribeUnreadMap[xe]=void 0;case 6:case"end":return Lt.stop()}},oe,this)}))},x.subscribe=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe,Lt=this;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Gr({type:{type:"number",min:1,max:5},opeType:{type:"number",min:1,max:2}},F),pr.next=3,this.core.sendCmd("qchatSubscribe",{qchatSubReqTag:{type:F.type,opeType:F.opeType},channels:F.channels});case 3:return xe=pr.sent,z=new Xl,In(oe=F.channels).call(oe,function(Sr){return Mr(Lt,void 0,void 0,ar.mark(function br(){return ar.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:this.serverRoleIdsMap[Sr.serverId]||z.add(Sr.serverId);case 1:case"end":return Dr.stop()}},br,this)}))}),qe=eu(_c(z),10),In(qe).call(qe,function(Sr){Lt.getRoleIdsByServerId(Sr)}),pr.abrupt("return",xe.content);case 9:case"end":return pr.stop()}},O,this)}))},x.resumeSubscribe=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe,Lt,lr,pr,Sr=this;return ar.wrap(function(Er){for(;;)switch(Er.prev=Er.next){case 0:if(this.serverRoleIdsMap={},this.unreadServerCount={},this.unreadCount={},Lt=100,F.isAutoReconnect){Er.next=6;break}return Er.abrupt("return");case 6:return lr={},In(oe=na(this.autoSubscribeUnreadMap)).call(oe,function(Dr){var $r=Sr.autoSubscribeUnreadMap[Dr];if($r){var vn=Dr.split("_"),Xr={serverId:vn[0],channelId:vn[1]};lr[$r]=lr[$r]||[],lr[$r].push(Xr)}}),lr[5]=[],In(xe=na(this.autoSubscribeTypingMap)).call(xe,function(Dr){return Mr(Sr,void 0,void 0,ar.mark(function $r(){var vn,Xr,wn,hn;return ar.wrap(function(Dn){for(;;)switch(Dn.prev=Dn.next){case 0:this.autoSubscribeTypingMap[Dr]&&(vn=Dr.split("_"),Xr=vn[0],wn=vn[1],hn={serverId:Xr,channelId:wn},lr[5].push(hn));case 2:case"end":return Dn.stop()}},$r,this)}))}),lr[4]=[],In(z=na(this.autoSubscribeServerMap)).call(z,function(Dr){return Mr(Sr,void 0,void 0,ar.mark(function $r(){var vn;return ar.wrap(function(wn){for(;;)switch(wn.prev=wn.next){case 0:this.autoSubscribeServerMap[Dr]&&(vn={serverId:Dr},lr[4].push(vn));case 2:case"end":return wn.stop()}},$r,this)}))}),pr=[],In(qe=na(lr)).call(qe,function(Dr){var $r=lr[Dr];if($r&&$r.length===0)return co.resolve();if($r.length>Lt){var vn=eu($r,100);return In(vn).call(vn,function(Xr){pr.push(Sr.createSubscribePromise(Xr,Dr))})}pr.push(Sr.createSubscribePromise($r,Dr))}),Er.next=16,co.all(pr);case 16:case"end":return Er.stop()}},O,this)}))},x.createSubscribePromise=function(F,O){var oe=this,xe={type:Lo(O),opeType:1,channels:F};return this.core.logger.debug("qchatChannel:: autoSubscribeUnread params",xe),this.subscribe(xe).then(function(z){var qe=z.unreadInfos;qe&&qe.length>0&&(qe=Nd(qe),oe.cacheUnreadCount(qe))}).catch(function(z){oe.core.logger.error("qchatChannel:: autoSubscribeUnread error ",z)})},x.cacheSubscribe=function(F){var O,oe=this;In(O=F.channels).call(O,function(xe){var z=xe.channelId?xe.serverId+"_"+xe.channelId:""+xe.serverId,qe=F.type===5?oe.autoSubscribeTypingMap:F.type===4?oe.autoSubscribeServerMap:oe.autoSubscribeUnreadMap;F.opeType===jd.sub?qe[z]=F.type:F.opeType===jd.unSub&&(qe[z]=void 0)})},x.cacheUnreadCount=function(F){var O=this;In(F).call(F,function(oe){var xe=oe.serverId+"_"+oe.channelId;O.unreadCount[xe]=Tn({},oe),O.unreadServerCount[oe.serverId]||(O.unreadServerCount[oe.serverId]={}),O.unreadServerCount[oe.serverId][oe.channelId]=!0})},x.getServerUnreadInfo=function(F){var O,oe=this,xe={serverId:F,unreadCount:0,mentionedCount:0,maxCount:0},z=this.unreadServerCount[F];return z&&(In(O=na(z)).call(O,function(qe){var Lt=F+"_"+qe,lr=oe.unreadCount[Lt];xe.unreadCount+=lr.unreadCount,xe.mentionedCount+=lr.mentionedCount,lr.maxCount!==void 0&&(xe.maxCount=lr.maxCount)}),xe.unreadCount=xe.unreadCount>xe.maxCount?xe.maxCount:xe.unreadCount,xe.mentionedCount=xe.mentionedCount>xe.maxCount?xe.maxCount:xe.mentionedCount),xe},x.getUnreadInfo=function(F){Gr({serverId:{type:"string"},channelId:{type:"string"}},F);var O=F.serverId+"_"+F.channelId;return this.unreadCount[O]?this.unreadCount[O]:null},x.shouldChangeUnread=function(F,O){if(!F.serverId||!F.channelId||this.core.qchatChannel.subscribeForVisitorService.isInSubscribeChannels(F.serverId,F.channelId)||F.historyEnable===!1||F.needBadge===!1||F.fromAccount===this.core.account||O&&(F==null?void 0:F.status)!==2)return!1;if(F.notifyReason&&F.notifyReason===Rv($d,$d.notifySubscribe)){if(!F.serverId||!F.channelId)return!1;var oe=this.getUnreadInfo({serverId:F.serverId,channelId:F.channelId}),xe=O?"ackTimestamp":"lastMsgTime";if(!oe||F.time&&oe[xe]&&oe[xe]>F.time)return!1}return!0},x.shouldChangeMentionedUnread=function(F,O){return O===void 0&&(O=!1),Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:if(!F.accidsOfMentionedRoles||!mi(xe=F.accidsOfMentionedRoles).call(xe,this.core.account)){Lt.next=2;break}return Lt.abrupt("return",!0);case 2:if(!F.mentionRoleIds||!F.serverId){Lt.next=16;break}if(this.serverRoleIdsMap[F.serverId]){Lt.next=9;break}if(O){Lt.next=7;break}return this.handledRoleMsg(F),Lt.abrupt("return",!1);case 7:return Lt.next=9,this.getRoleIdsByServerId([F.serverId]);case 9:z=0;case 10:if(!(z<F.mentionRoleIds.length)){Lt.next=16;break}if(!this.serverRoleIdsMap[F.serverId].roleIds.has(F.mentionRoleIds[z])){Lt.next=13;break}return Lt.abrupt("return",!0);case 13:z++,Lt.next=10;break;case 16:return Lt.abrupt("return",!1);case 17:case"end":return Lt.stop()}},oe,this)}))},x.handledRoleMsg=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe,Lt,lr=this;return ar.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:if(F.mentionRoleIds){Sr.next=2;break}return Sr.abrupt("return");case 2:if(this.serverRoleIdsMap[F.serverId]){Sr.next=5;break}return Sr.next=5,this.getRoleIdsByServerId([F.serverId]);case 5:if(this.serverRoleIdsMap[F.serverId]){Sr.next=8;break}return this.core.logger.warn("QChatChannel::handledRoleMsg::can not get serverRoleIds,server id",F.serverId),Sr.abrupt("return");case 8:if(xe=!1,In(oe=F.mentionRoleIds).call(oe,function(br){lr.serverRoleIdsMap[F.serverId].roleIds.has(br)&&(xe=!0,lr.core.logger.debug("QChatChannel::handledRoleMsg::will update message mentionedCount，message is ",F))}),xe){Sr.next=12;break}return Sr.abrupt("return");case 12:if(z=this.unreadCount[F.serverId+"_"+F.channelId],qe=(F==null?void 0:F.status)===2,z.mentionedCount=qe?z.mentionedCount?z.mentionedCount-1:0:z.mentionedCount?z.mentionedCount+1:1,typeof z.maxCount!="number"){Sr.next=24;break}if(!((Lt=(Lt=z.mentionedCount)>z.maxCount?z.maxCount:Lt)>z.maxCount)){Sr.next=21;break}return this.core.logger.debug("QChatChannel::handledRoleMsg::tempUnreadCount more than maxCount"),Sr.abrupt("return");case 21:this.core.emit("unreadInfo",Tn(Tn({},z),{mentionedCount:Lt})),this.core.emit("unreadInfos",[Tn(Tn({},z),{mentionedCount:Lt})]),this._serverUnreadInfo(F.serverId);case 24:case"end":return Sr.stop()}},O,this)}))},x.getMentionedFlag=function(F,O){return O===void 0&&(O=!1),Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:if(!F.mentionAll){qe.next=4;break}return qe.abrupt("return",!0);case 4:if(!F.mentionRoleIds&&!F.accidsOfMentionedRoles){qe.next=10;break}return qe.next=7,this.shouldChangeMentionedUnread(F,O);case 7:return qe.abrupt("return",qe.sent);case 10:if(!F.mentionAccids||!mi(xe=F.mentionAccids).call(xe,this.core.account)){qe.next=12;break}return qe.abrupt("return",!0);case 12:return qe.abrupt("return",!1);case 13:case"end":return qe.stop()}},oe,this)}))},x.changeUnread=function(F,O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt,lr,pr,Sr;return ar.wrap(function(Er){for(;;)switch(Er.prev=Er.next){case 0:if(xe=F.serverId,z=F.channelId,qe=xe+"_"+z,this.shouldChangeUnread(F,O)){Er.next=6;break}return this.core.logger.debug("changeUnread: "+qe+" does not need to update unreadInfo"),Er.abrupt("return");case 6:if(this.unreadCount[qe]){Er.next=11;break}return Er.next=9,this.core.qchatChannel.getChannelUnreadInfos({channels:[{serverId:xe,channelId:z}]});case 9:return!this.serverRoleIdsMap[xe]&&F.mentionRoleIds&&this.getRoleIdsByServerId([xe]),Er.abrupt("return");case 11:return Lt=this.unreadCount[qe],lr=(F==null?void 0:F.status)===2,Er.next=15,this.getMentionedFlag(F);case 15:if(pr=Er.sent,lr?(Lt.unreadCount=Lt.unreadCount?Lt.unreadCount-1:0,pr&&(Lt.mentionedCount=Lt.mentionedCount?Lt.mentionedCount-1:0),delete Lt.lastMsgTime,this.core.logger.debug("changeUnread: "+qe+" unread reduce ",Lt)):(Lt.unreadCount=Lt.unreadCount?Lt.unreadCount+1:1,pr&&(Lt.mentionedCount=Lt.mentionedCount?Lt.mentionedCount+1:1),F.time&&(Lt.lastMsgTime=F.time),this.core.logger.debug("changeUnread: "+qe+" unread add ",Lt)),Sr=typeof Lt.maxCount=="number"?Lt.maxCount:100,!(Lt.unreadCount>Sr)){Er.next=21;break}return this.core.logger.debug("QChatChannel::subscribe::tempUnreadCount more than maxCount"),Er.abrupt("return");case 21:this.core.logger.warn("unreadInfo event will abandon,please use unreadInfos"),this.core.emit("unreadInfo",Tn(Tn({},Lt),{mentionedCount:Lt.mentionedCount>Sr?Sr:Lt.mentionedCount,unreadCount:Lt.unreadCount>Sr?Sr:Lt.unreadCount})),this.core.emit("unreadInfos",[Tn(Tn({},Lt),{mentionedCount:Lt.mentionedCount>Sr?Sr:Lt.mentionedCount,unreadCount:Lt.unreadCount>Sr?Sr:Lt.unreadCount})]),this._serverUnreadInfo(xe);case 25:case"end":return Er.stop()}},oe,this)}))},x.updateUnreads=function(F){var O,oe=this;if(F&&F.length>0){var xe=this.getServerUnreadInfo(F[0].serverId),z=this.unreadServerCount[F[0].serverId],qe=vo(O=Js(F).call(F,function(Dr){var $r=Dr.serverId+"_"+Dr.channelId,vn=oe.unreadCount[$r],Xr=Wa(vn,"ackTimestamp"),wn=Wa(Dr,"ackTimestamp");return!(Xr&&wn&&wn<Xr)&&(Wa(vn,"unreadCount")!==Wa(Dr,"unreadCount")||Wa(vn,"mentionedCount")!==Wa(Dr,"mentionedCount"))})).call(O,function(Dr){var $r=Dr.serverId,vn=Dr.channelId,Xr=$r+"_"+vn;return oe.core.logger.debug("qchat channel updateUnread: ",Dr),oe.unreadCount[Xr]=Tn({},Dr),oe.unreadServerCount[$r]||(oe.unreadServerCount[$r]={}),oe.unreadServerCount[$r][vn]=!0,Dr});if(qe.length>0){this.core.emit("unreadInfos",qe);var Lt=this.getServerUnreadInfo(F[0].serverId),lr=this.unreadServerCount[F[0].serverId],pr=xe.unreadCount!==Lt.unreadCount,Sr=!z||na(z).length===0,br=lr&&na(lr).length>0,Er=xe.mentionedCount!==Lt.mentionedCount;(pr||Er||Sr&&br)&&this._serverUnreadInfo(qe[0].serverId)}In(qe).call(qe,function(Dr){oe.core.emit("unreadInfo",Dr)})}},x.clearUnreadCountByServers=function(F,O){var oe=this,xe=[];In(F).call(F,function(qe){var Lt;oe.unreadServerCount[qe]&&In(Lt=na(oe.unreadServerCount[qe])).call(Lt,function(lr){xe.push(qe+"_"+lr)})});var z=[];In(xe).call(xe,function(qe){z.push(Tn(Tn({},oe.unreadCount[qe]),{unreadCount:0,mentionedCount:0,ackTimestamp:O}))}),this.updateUnreads(z)},S}(),eC=function(){function S(D){this.limitForBatchEnter=10,this.limitForBatchSubscribe=100,this.autoServers=new Xl,this.autoVisitorSubscribeServer=new Xl,this.autoVisitorSubscribeChannel=new Xl,this.core=D}var x=S.prototype;return x.subscribeChannelAsVisitor=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe,Lt=this;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return pr.next=2,this.core.sendCmd("qchatSubscribeAsVisitor",{tag:{type:F.type||6,opeType:F.opeType},datas:F.channels});case 2:return xe=pr.sent,z=xe.content.failedArr,qe=Js(oe=F.channels).call(oe,function(Sr){return!Ap(z).call(z,function(br){return br.channelId===Sr.channelId&&br.serverId===Sr.serverId})}),In(qe).call(qe,function(Sr){F.opeType===1?Lt.autoVisitorSubscribeChannel.add(Sr.serverId+"&"+Sr.channelId):Lt.autoVisitorSubscribeChannel.delete(Sr.serverId+"&"+Sr.channelId)}),pr.abrupt("return",{failedChannels:z});case 7:case"end":return pr.stop()}},O,this)}))},x.subscribeServerAsVisitor=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe,Lt,lr,pr=this;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return br.next=2,this.core.sendCmd("qchatSubscribeAsVisitor",{tag:{type:F.type||7,opeType:F.opeType},datas:vo(oe=F.serverIds).call(oe,function(Er){return{serverId:Er}})});case 2:return qe=br.sent,Lt=qe.content.failedArr,lr=Js(xe=F.serverIds).call(xe,function(Er){return!Ap(Lt).call(Lt,function(Dr){return Dr.serverId===Er})}),In(lr).call(lr,function(Er){F.opeType===1?pr.autoVisitorSubscribeServer.add(Er):pr.autoVisitorSubscribeServer.delete(Er)}),br.abrupt("return",{failedServers:vo(z=qe.content.failedArr).call(z,function(Er){return Er.serverId})});case 7:case"end":return br.stop()}},O,this)}))},x.deleteServer=function(F){var O;this.autoServers.delete(F),this.autoVisitorSubscribeServer.has(F)&&this.subscribeServerAsVisitor({opeType:2,serverIds:[F]});var oe=[];In(O=this.autoVisitorSubscribeChannel).call(O,function(xe){if(pa(xe).call(xe,F)===0){var z=xe.replace(F+"&","");oe.push({serverId:F,channelId:z})}}),oe.length>0&&this.subscribeChannelAsVisitor({opeType:2,channels:oe})},x.deleteAutoSetInServerId=function(F){var O,oe=this;this.autoServers.delete(F),this.autoVisitorSubscribeServer.delete(F),In(O=this.autoVisitorSubscribeChannel).call(O,function(xe){pa(xe).call(xe,F)===0&&oe.autoVisitorSubscribeChannel.delete(xe)})},x.deleteAutoSetInChannel=function(F,O){this.autoVisitorSubscribeChannel.delete(F+"&"+O)},x.unSubscribeChannel=function(F,O){this.subscribeChannelAsVisitor({opeType:2,channels:[{serverId:F,channelId:O}]})},x.isInSubscribeChannels=function(F,O){return this.autoVisitorSubscribeChannel.has(F+"&"+O)},x.isInAutoServers=function(F){return this.autoServers.has(F)},x.doAutoSubscribe=function(){var F=this,O=[],oe=eu(_c(this.autoVisitorSubscribeServer),this.limitForBatchSubscribe);In(oe).call(oe,function(z){O.push(F.subscribeServerAsVisitor({opeType:1,serverIds:z}))});var xe=eu(_c(this.autoVisitorSubscribeChannel),this.limitForBatchSubscribe);return In(xe).call(xe,function(z){O.push(F.subscribeChannelAsVisitor({opeType:1,channels:vo(z).call(z,function(qe){var Lt=pa(qe).call(qe,"&");return{serverId:Co(qe).call(qe,0,Lt),channelId:Co(qe).call(qe,Lt+1)}})}))}),co.all(O)},x.doAutoEnterServer=function(){return Mr(this,void 0,void 0,ar.mark(function F(){var O,oe,xe,z=this;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return O=eu(_c(this.autoServers),this.limitForBatchEnter),oe=[],In(O).call(O,function(lr){oe.push(z.core.qchatServer.enterAsVisitor({serverIds:lr}))}),Lt.next=5,co.all(oe);case 5:xe=Lt.sent,In(xe).call(xe,function(lr){var pr;In(pr=lr.failedServers).call(pr,function(Sr){z.deleteAutoSetInServerId(Sr)})});case 7:case"end":return Lt.stop()}},F,this)}))},x.resumeSubscribe=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){return ar.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:if(!F.isAutoReconnect){xe.next=7;break}return xe.next=3,this.doAutoEnterServer();case 3:return xe.next=5,this.doAutoSubscribe();case 5:xe.next=10;break;case 7:this.autoServers.clear(),this.autoVisitorSubscribeChannel.clear(),this.autoVisitorSubscribeServer.clear();case 10:case"end":return xe.stop()}},O,this)}))},x.cacheServer=function(F){var O=this;In(F).call(F,function(oe){return O.autoServers.add(oe)})},S}();(function(S){S[S.sub=1]="sub",S[S.unSub=2]="unSub"})(Oh||(Oh={}));var tC=function(S){function x(F){var O,oe,xe,z,qe,Lt;return(Lt=S.call(this,"qchatChannel",F)||this).core=F,Ei({cmdMap:wd,cmdConfig:Sh}),Lt.subscribeModuleService=new ZS(F),Lt.subscribeForVisitorService=new eC(F),Lt.core.eventBus.on("qchatChannel/changeUnread",Oo(O=Lt.subscribeModuleService.changeUnread).call(O,Lt.subscribeModuleService)),Lt.core.eventBus.on("qchatChannel/updateUnreads",Oo(oe=Lt.subscribeModuleService.updateUnreads).call(oe,Lt.subscribeModuleService)),Lt.core.eventBus.on("qchatChannel/cacheSubscribe",Oo(xe=Lt.subscribeModuleService.cacheSubscribe).call(xe,Lt.subscribeModuleService)),Lt.core.eventBus.on("qchatChannel/clearUnreadCountByServers",Oo(z=Lt.subscribeModuleService.clearUnreadCountByServers).call(z,Lt.subscribeModuleService)),Lt.core.eventBus.on("qchatChannel/getRoleIdsByServerId",Oo(qe=Lt.subscribeModuleService.getRoleIdsByServerId).call(qe,Lt.subscribeModuleService)),Lt.core.eventBus.on("logined",function(lr){Lt.subscribeModuleService.resumeSubscribe(lr),Lt.subscribeForVisitorService.resumeSubscribe(lr)}),Lt.core.eventBus.on("qchatChannel/autoUnSubscribe",function(lr){if(Lt.logger.log("QChatChannel::enter autoUnSubscribe sysMsg is",lr),lr.type===Xo[Xo.channelVisibilityUpdate])Lt.logger.log("QChatChannel::begin autoUnSubscribe channel key is",lr.serverId+"_"+lr.channelId),Lt.subscribeModuleService._unSubscribeChannel(lr.serverId,lr.channelId),Lt.logger.log("QChatChannel::autoUnSubscribe channel done key is",lr.serverId+"_"+lr.channelId);else if(lr.type===Xo[Xo.serverEnterLeave]){var pr;Lt.subscribeModuleService.autoSubscribeServerMap[lr.serverId]&&(Lt.logger.log("QChatChannel::begin autoUnSubscribe server key is",lr.serverId),Lt.subscribeModuleService.subscribe({type:4,opeType:Oh.unSub,channels:[{serverId:lr.serverId,channelId:""}]}),Lt.logger.log("QChatChannel::autoUnSubscribe server done key is",lr.serverId));var Sr=Lt.subscribeModuleService.unreadServerCount[lr.serverId];if(!Sr)return;Lt.logger.log("QChatChannel::begin autoUnSubscribe channels key is",na(Sr)),In(pr=na(Sr)).call(pr,function(br){Lt.subscribeModuleService._unSubscribeChannel(lr.serverId,br)}),Lt.logger.log("QChatChannel::autoUnSubscribe channels done key is",na(Sr))}}),Lt.core.eventBus.on("qchatChannel/serverIdentifyChange",function(lr){Lt.subscribeModuleService.changeCacheServerRoleIds(lr)}),Lt}Ro(x,S);var D=x.prototype;return D.createChannel=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",min:1},type:{type:"enum",values:ia(hl)},name:{type:"string",required:!1},topic:{type:"string",required:!1},ext:{type:"string",required:!1},visitorMode:{type:"number",required:!1}},O),qe.next=3,this.core.sendCmd("qchatCreateChannel",{channelInfo:Tn(Tn({},O),{type:hl[O.type]}),antispamTag:Pc(O)});case 3:return xe=qe.sent,qe.abrupt("return",Ad(xe.content.channelInfo));case 5:case"end":return qe.stop()}},oe,this)}))},D.deleteChannel=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({channelId:{type:"string",allowEmpty:!1}},O),z.next=3,this.core.sendCmd("qchatDeleteChannel",O);case 3:case"end":return z.stop()}},oe,this)}))},D.updateChannel=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Gr({channelId:{type:"string",min:1},serverId:{type:"string",required:!1},type:{type:"enum",values:ia(hl),required:!1},name:{type:"string",required:!1},topic:{type:"string",required:!1},ext:{type:"string",required:!1},visitorMode:{type:"number",required:!1}},O),xe=O,O.type&&(xe.type=hl[O.type]),Lt.next=5,this.core.sendCmd("qchatUpdateChannel",{channelInfo:xe,antispamTag:Pc(O)});case 5:return z=Lt.sent,Lt.abrupt("return",Ad(z.content.channelInfo));case 7:case"end":return Lt.stop()}},oe,this)}))},D.getChannels=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({channelIds:{type:"array",itemType:"string",min:1}},O),qe.next=3,this.core.sendCmd("qchatGetChannels",O);case 3:return xe=qe.sent,qe.abrupt("return",Od(xe.content.channelList));case 5:case"end":return qe.stop()}},oe,this)}))},D.getChannelsByPage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Gr({serverId:{type:"string",min:1},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},O),pr.next=3,this.core.sendCmd("qchatGetChannelsByPage",{qchatGetChannelListPageTag:Tn({limit:100},O)});case 3:return xe=pr.sent,z=xe.content,qe=z.datas,Lt=z.listQueryTag,pr.abrupt("return",{listQueryTag:{hasMore:+Lt.hasMore==1,nextTimetag:Lo(Lt.nextTimetag)},datas:Od(qe)});case 6:case"end":return pr.stop()}},oe,this)}))},D.getMembersByPage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Gr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},O),pr.next=3,this.core.sendCmd("qchatGetMembersByPage",{qchatGetMembersByPageTag:O});case 3:return xe=pr.sent,z=xe.content,qe=z.datas,Lt=z.listQueryTag,pr.abrupt("return",{listQueryTag:{hasMore:+Lt.hasMore==1,nextTimetag:Lo(Lt.nextTimetag)},datas:cc(qe)});case 6:case"end":return pr.stop()}},oe,this)}))},D.updateWhiteBlackRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},roleId:{type:"string",min:1},type:{type:"enum",values:ia(ca)},opeType:{type:"enum",values:ia(Zs)}},O),z.next=3,this.core.sendCmd("qchatUpdateWhiteBlackRole",{qchatUpdateWhiteBlackRoleTag:Tn(Tn({},O),{type:ca[O.type],opeType:Zs[O.opeType]})});case 3:case"end":return z.stop()}},oe,this)}))},D.getWhiteBlackRolesPage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Gr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:ia(ca)},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},O),pr.next=3,this.core.sendCmd("qchatGetWhiteBlackRolesPage",{qchatGetWhiteBlackRolesPageTag:Tn(Tn({},O),{type:ca[O.type]})});case 3:return xe=pr.sent,z=xe.content,qe=z.datas,Lt=z.listQueryTag,pr.abrupt("return",{listQueryTag:{hasMore:+Lt.hasMore==1,nextTimetag:Lo(Lt.nextTimetag)},datas:zs(qe)});case 6:case"end":return pr.stop()}},oe,this)}))},D.updateWhiteBlackMembers=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:ia(ca)},opeType:{type:"enum",values:ia(Zs)},toAccids:{type:"array",itemType:"string",min:1}},O),z.next=3,this.core.sendCmd("qchatUpdateWhiteBlackMembers",{qchatUpdateWhiteBlackMembersTag:Tn(Tn({},O),{type:ca[O.type],opeType:Zs[O.opeType],toAccids:mo(O.toAccids)})});case 3:case"end":return z.stop()}},oe,this)}))},D.getWhiteBlackMembersPage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Gr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:ia(ca)},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},O),pr.next=3,this.core.sendCmd("qchatGetWhiteBlackMembersPage",{qchatGetWhiteBlackMembersPageTag:Tn(Tn({limit:100},O),{type:ca[O.type]})});case 3:return xe=pr.sent,z=xe.content,qe=z.datas,Lt=z.listQueryTag,pr.abrupt("return",{listQueryTag:{hasMore:+Lt.hasMore==1,nextTimetag:Lo(Lt.nextTimetag)},datas:cc(qe)});case 6:case"end":return pr.stop()}},oe,this)}))},D.getExistingWhiteBlackRoles=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Gr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:ia(ca)},roleIds:{type:"array",itemType:"string",min:1}},O),Lt.next=3,this.core.sendCmd("qchatGetExistingWhiteBlackRoles",{qchatGetExistingWhiteBlackRolesTag:Tn(Tn({},O),{type:ca[O.type],roleIds:mo(O.roleIds)})});case 3:return xe=Lt.sent,z=xe.content.datas,Lt.abrupt("return",{datas:zs(z)});case 6:case"end":return Lt.stop()}},oe,this)}))},D.getExistingWhiteBlackMembers=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Gr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:ia(ca)},accids:{type:"array",itemType:"string",min:1}},O),Lt.next=3,this.core.sendCmd("qchatGetExistingWhiteBlackMembers",{qchatGetExistingWhiteBlackMembersTag:Tn(Tn({},O),{type:ca[O.type],accids:mo(O.accids)})});case 3:return xe=Lt.sent,z=xe.content.datas,Lt.abrupt("return",{datas:cc(z)});case 6:case"end":return Lt.stop()}},oe,this)}))},D.updateCategoryInfoOfChannel=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({channelId:{type:"string",min:1},categoryId:{type:"string",allowEmpty:!1,required:!1},syncMode:{type:"number",min:0,max:1,required:!1}},O),qe.next=3,this.core.sendCmd("qchatUpdateCategoryInfoOfChannel",{qchatUpdateCategoryInfoOfChannelTag:O});case 3:return xe=qe.sent,qe.abrupt("return",Ad(xe.content.channelInfo));case 5:case"end":return qe.stop()}},oe,this)}))},D.createChannelCategory=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},name:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",required:!1},viewMode:{type:"number",min:0,max:1,required:!1}},O),qe.next=3,this.core.sendCmd("qchatCreateChannelCategory",{qchatCreateChannelCategoryTag:O});case 3:return xe=qe.sent,qe.abrupt("return",Rd(xe.content.QChatChannelCategoryInfo));case 5:case"end":return qe.stop()}},oe,this)}))},D.removeChannelCategory=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({categoryId:{type:"string",allowEmpty:!1}},O),z.next=3,this.core.sendCmd("qchatRemoveChannelCategory",O);case 3:case"end":return z.stop()}},oe,this)}))},D.updateChannelCategory=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({categoryId:{type:"string",allowEmpty:!1},name:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",required:!1},viewMode:{type:"number",min:0,max:1,required:!1}},O),qe.next=3,this.core.sendCmd("qchatUpdateChannelCategory",{qchatUpdateChannelCategoryTag:O});case 3:return xe=qe.sent,qe.abrupt("return",Rd(xe.content.QChatChannelCategoryInfo));case 5:case"end":return qe.stop()}},oe,this)}))},D.getChannelCategoriesByID=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({categoryIds:{type:"array",itemType:"string",min:1}},O),qe.next=3,this.core.sendCmd("qchatGetChannelCategoriesByID",O);case 3:return xe=qe.sent,qe.abrupt("return",_h(xe.content.channelCategoryList));case 5:case"end":return qe.stop()}},oe,this)}))},D.updateChannelCategoryWhiteBlackRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(ca)},opeType:{type:"enum",values:ia(Zs)},roleId:{type:"string",allowEmpty:!1}},O),z.next=3,this.core.sendCmd("qchatUpdateChannelCategoryWhiteBlackRole",{qchatUpdateChannelCategoryWhiteBlackRoleTag:Tn(Tn({},O),{type:ca[O.type],opeType:Zs[O.opeType]})});case 3:case"end":return z.stop()}},oe,this)}))},D.getChannelCategoryWhiteBlackRolesPage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Gr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(ca)},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},O),pr.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackRolesPage",{qchatGetChannelCategoryWhiteBlackRolesPageTag:Tn(Tn({},O),{type:ca[O.type]})});case 3:return xe=pr.sent,z=xe.content,qe=z.datas,Lt=z.listQueryTag,pr.abrupt("return",{listQueryTag:{hasMore:+Lt.hasMore==1,nextTimetag:Lo(Lt.nextTimetag)},datas:zs(qe)});case 6:case"end":return pr.stop()}},oe,this)}))},D.updateChannelCategoryWhiteBlackMembers=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(ca)},opeType:{type:"enum",values:ia(Zs)},toAccids:{type:"array",itemType:"string",min:1}},O),z.next=3,this.core.sendCmd("qchatUpdateChannelCategoryWhiteBlackMembers",{qchatUpdateChannelCategoryWhiteBlackMembersTag:Tn(Tn({},O),{type:ca[O.type],opeType:Zs[O.opeType],toAccids:mo(O.toAccids)})});case 3:case"end":return z.stop()}},oe,this)}))},D.getChannelCategoryWhiteBlackMembersPage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Gr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(ca)},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},O),pr.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackMembersPage",{qchatGetChannelCategoryWhiteBlackMembersPageTag:Tn(Tn({},O),{type:ca[O.type]})});case 3:return xe=pr.sent,z=xe.content,qe=z.datas,Lt=z.listQueryTag,pr.abrupt("return",{listQueryTag:{hasMore:+Lt.hasMore==1,nextTimetag:Lo(Lt.nextTimetag)},datas:cc(qe)});case 6:case"end":return pr.stop()}},oe,this)}))},D.getChannelCategoryWhiteBlackRoles=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Gr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(ca)},roleIds:{type:"array",itemType:"string",min:1}},O),Lt.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackRoles",{qchatGetChannelCategoryWhiteBlackRolesTag:Tn(Tn({},O),{type:ca[O.type],roleIds:mo(O.roleIds)})});case 3:return xe=Lt.sent,z=xe.content.datas,Lt.abrupt("return",zs(z));case 6:case"end":return Lt.stop()}},oe,this)}))},D.getChannelCategoryWhiteBlackMembers=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Gr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(ca)},accids:{type:"array",itemType:"string",min:1}},O),Lt.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackMembers",{qchatGetChannelCategoryWhiteBlackMembersTag:Tn(Tn({},O),{type:ca[O.type],accids:mo(O.accids)})});case 3:return xe=Lt.sent,z=xe.content.datas,Lt.abrupt("return",cc(z));case 6:case"end":return Lt.stop()}},oe,this)}))},D.getChannelCategoriesPage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},O),pr.next=3,this.core.sendCmd("qchatGetChannelCategoriesPage",{qchatGetChannelCategoriesPageTag:O});case 3:return xe=pr.sent,z=xe.content,qe=z.datas,Lt=z.listQueryTag,pr.abrupt("return",{listQueryTag:{hasMore:+Lt.hasMore==1,nextTimetag:Lo(Lt.nextTimetag)},datas:_h(qe)});case 6:case"end":return pr.stop()}},oe,this)}))},D.getChannelCategoryChannelsPage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},O),pr.next=3,this.core.sendCmd("qchatGetChannelCategoryChannelsPage",{qchatGetChannelCategoryChannelsPageTag:O});case 3:return xe=pr.sent,z=xe.content,qe=z.datas,Lt=z.listQueryTag,pr.abrupt("return",{listQueryTag:{hasMore:+Lt.hasMore==1,nextTimetag:Lo(Lt.nextTimetag)},datas:Od(qe)});case 6:case"end":return pr.stop()}},oe,this)}))},D.subscribeChannel=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Gr({type:{type:"number",min:1,max:5},opeType:{type:"number",min:1,max:2}},O),Lt.next=3,this.subscribeModuleService.subscribe(O);case 3:if((xe=Lt.sent).unreadInfos=Nd(xe.unreadInfos),O.opeType===1&&(O.channels=vo(z=xe.unreadInfos).call(z,function(lr){return{serverId:lr.serverId,channelId:lr.channelId}})),this.logger.debug("QChatChannel::subscribeChannel:: cacheSubscribe ",O),this.subscribeModuleService.cacheSubscribe(O),O.type!==5){Lt.next=10;break}return Lt.abrupt("return");case 10:return this.subscribeModuleService.updateUnreads(xe.unreadInfos),Lt.abrupt("return",xe);case 12:case"end":return Lt.stop()}},oe,this)}))},D.getChannelUnreadInfos=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Lt.next=2,this.core.sendCmd("qchatGetUnreadInfo",O);case 2:return xe=Lt.sent,z=Nd(xe.content.unreadInfos),this.subscribeModuleService.updateUnreads(z),Lt.abrupt("return",z);case 6:case"end":return Lt.stop()}},oe,this)}))},D.getChannelSearchByPage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:if(Gr({keyword:{type:"string",allowEmpty:!1},startTime:{type:"number",min:0,required:!1},endTime:{type:"number",min:1,required:!1},order:{type:"enum",values:ia(Ic),required:!1},limit:{type:"number",min:1,required:!1},serverId:{type:"string",required:!1},sort:{type:"enum",values:ia(Hp),required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},O),!(O.startTime&&O.endTime&&O.startTime>=O.endTime)){pr.next=3;break}throw new al("startTime more than endTime",O,"timeRule");case 3:return pr.next=5,this.core.sendCmd("qchatGetChannelSearchByPage",{qchatGetChannelSearchByPageTag:Tn(Tn({},O),{order:O.order&&Ic[O.order],sort:Wl(O)&&Hp[Wl(O)]})});case 5:return xe=pr.sent,z=xe.content,qe=z.datas,Lt=z.listQueryTag,pr.abrupt("return",{listQueryTag:{hasMore:+Lt.hasMore==1,nextTimetag:Lo(Lt.nextTimetag),cursor:Lt.cursor},datas:Od(qe)});case 8:case"end":return pr.stop()}},oe,this)}))},D.channelMemberSearch=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},keyword:{type:"string",allowEmpty:!1},limit:{type:"number",min:1,required:!1}},O),qe.next=3,this.core.sendCmd("qchatChannelMemberSearch",{qchatChannelMemberSearchTag:O});case 3:return xe=qe.sent,qe.abrupt("return",NS(xe.content.datas));case 5:case"end":return qe.stop()}},oe,this)}))},D.subscribeAsVisitor=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({opeType:{type:"number",min:1,max:2},type:{type:"number",required:!1},channels:{type:"array",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1}},min:1}},O),z.next=3,this.subscribeForVisitorService.subscribeChannelAsVisitor(O);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},x}(gl),Fy={"24_61":"qchatCreateServerRole","24_62":"qchatDeleteServerRole","24_63":"qchatUpdateServerRole","24_64":"qchatGetServerRoles","24_65":"qchatAddChannelRole","24_66":"qchatRemoveChannelRole","24_67":"qchatUpdateChannelRole","24_68":"qchatGetChannelRoles","24_69":"qchatAddMemberRole","24_70":"qchatRemoveMemberRole","24_71":"qchatUpdateMemberRole","24_72":"qchatGetMemberRoles","24_73":"qchatAddMembersToServerRole","24_74":"qchatRemoveMembersFromServerRole","24_75":"qchatGetMembersFromServerRole","24_76":"qchatGetServerRolesByAccid","24_77":"qchatGetExistingServerRolesByAccids","24_78":"qchatGetExistingChannelRolesByServerRoleIds","24_79":"qchatGetExistingAccidsOfMemberRoles","24_80":"qchatUpdateServerRolePriorities","24_81":"qchatGetExistingAccidsInServerRole","24_82":"qchatCheckPermission","24_83":"qchatAddChannelCategoryRole","24_84":"qchatRemoveChannelCategoryRole","24_85":"qchatUpdateChannelCategoryRole","24_86":"qchatGetChannelCategoryRole","24_87":"qchatAddChannelCategoryMemberRole","24_88":"qchatRemoveChannelCategoryMemberRole","24_89":"qchatUpdateChannelCategoryMemberRole","24_90":"qchatGetChannelCategoryMemberRole","24_126":"qchatCheckPermissions"},za={channelRole:{serverId:1,roleId:2,parentRoleId:3,channelId:4,name:5,icon:6,ext:7,auths:8,type:9,createTime:10,updateTime:11},memberRole:{serverId:1,id:2,accid:3,channelId:4,auths:5,createTime:6,updateTime:7,nick:8,avatar:9,ext:10,memberType:11,joinTime:12,inviter:13},antispamTag:{antiSpamBusinessId:1},serverRole:{serverId:1,roleId:2,name:3,icon:4,ext:5,auths:6,type:7,memberCount:8,priority:9,createTime:10,updateTime:11,isMember:12},getRoleByPagesTag:{serverId:1,channelId:2,time:3,limit:4},checkPermissionTag:{serverId:1,channelId:2,auth:3},member:{serverId:1,roleId:2,accid:3,createTime:4,updateTime:5,nick:6,avatar:7,ext:8,type:9,joinTime:10,inviter:11},qchatAddChannelCategoryRoleTag:{categoryId:3,serverId:4,parentRoleId:5},channelCategoryRole:{roleId:1,categoryId:3,serverId:4,parentRoleId:5,type:6,validFlag:7,createTime:8,updateTime:9,auths:10,name:11,icon:12,ext:13},qchatGetChannelCategoryRoleTag:{serverId:1,categoryId:2,timetag:3,limit:4},channelCategoryMemberRole:{id:1,accid:3,categoryId:4,serverId:5,validFlag:6,createTime:7,updateTime:8,auths:9,nick:10,avatar:11,ext:12,memberType:13,joinTime:14,inviter:15},qchatGetChannelCategoryMemberRoleTag:{serverId:1,categoryId:2,timetag:3,limit:4},checkPermissionsTag:{serverId:1,channelId:2,auths:3}},la=Cc(za),rC={qchatCreateServerRole:{service:"qchatRole",sid:24,cid:61,params:[{type:"Property",name:"serverRole",reflectMapper:za.serverRole},{type:"Property",name:"antispamTag",reflectMapper:za.antispamTag}],response:[{type:"Property",name:"serverRole",reflectMapper:la.serverRole}]},qchatDeleteServerRole:{service:"qchatRole",sid:24,cid:62,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"}]},qchatUpdateServerRole:{service:"qchatRole",sid:24,cid:63,params:[{type:"Property",name:"updateServerRoleTag",reflectMapper:{serverId:1,roleId:2,name:3,icon:4,ext:5,auths:6,priority:7}},{type:"Property",name:"antispamTag",reflectMapper:za.antispamTag}],response:[{type:"Property",name:"serverRole",reflectMapper:la.serverRole}]},qchatGetServerRoles:{service:"qchatRole",sid:24,cid:64,params:[{type:"Property",name:"getServerRolesTag",reflectMapper:{serverId:1,timetag:2,limit:3,priority:4,channelId:5,categoryId:6}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:la.serverRole}]},qchatAddChannelRole:{service:"qchatRole",sid:24,cid:65,params:[{type:"Property",name:"channelRole",reflectMapper:za.channelRole}],response:[{type:"Property",name:"channelRole",reflectMapper:la.channelRole}]},qchatRemoveChannelRole:{service:"qchatRole",sid:24,cid:66,params:[{type:"Long",name:"serverId"},{type:"Long",name:"channelId"},{type:"Long",name:"roleId"}]},qchatUpdateChannelRole:{service:"qchatRole",sid:24,cid:67,params:[{type:"Property",name:"updateChannelRoleTag",reflectMapper:{serverId:1,roleId:2,channelId:3,auths:4}}],response:[{type:"Property",name:"channelRole",reflectMapper:la.channelRole}]},qchatGetChannelRoles:{service:"qchatRole",sid:24,cid:68,params:[{type:"Property",name:"getChannelRolesTag",reflectMapper:{serverId:1,channelId:2,timetag:3,limit:4}}],response:[{type:"PropertyArray",name:"channelRoles",reflectMapper:la.channelRole}]},qchatAddMemberRole:{service:"qchatRole",sid:24,cid:69,params:[{type:"Property",name:"memberRole",reflectMapper:za.memberRole}],response:[{type:"Property",name:"memberRole",reflectMapper:la.memberRole}]},qchatRemoveMemberRole:{service:"qchatRole",sid:24,cid:70,params:[{type:"Property",name:"memberRole",reflectMapper:za.memberRole}]},qchatUpdateMemberRole:{service:"qchatRole",sid:24,cid:71,params:[{type:"Property",name:"updateMemberRoleTag",reflectMapper:{serverId:1,accid:2,channelId:3,auths:4}}],response:[{type:"Property",name:"memberRole",reflectMapper:la.memberRole}]},qchatGetMemberRoles:{service:"qchatRole",sid:24,cid:72,params:[{type:"Property",name:"getMemberRolesTag",reflectMapper:{serverId:1,channelId:2,timetag:3,limit:4}}],response:[{type:"PropertyArray",name:"memberRoles",reflectMapper:la.memberRole}]},qchatAddMembersToServerRole:{service:"qchatRole",sid:24,cid:73,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"},{type:"String",name:"accids"}],response:[{type:"Property",name:"accids",reflectMapper:{1:"successAccids",2:"failedAccids"}}]},qchatRemoveMembersFromServerRole:{service:"qchatRole",sid:24,cid:74,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"},{type:"String",name:"accids"}],response:[{type:"Property",name:"accids",reflectMapper:{1:"successAccids",2:"failedAccids"}}]},qchatGetMembersFromServerRole:{service:"qchatRole",sid:24,cid:75,params:[{type:"Property",name:"getMembersFromServerRoleTag",reflectMapper:{serverId:1,roleId:2,timetag:3,accid:4,limit:5}}],response:[{type:"PropertyArray",name:"members",reflectMapper:la.member}]},qchatGetServerRolesByAccid:{service:"qchatRole",sid:24,cid:76,params:[{type:"Property",name:"getServerRolesByAccidTag",reflectMapper:{serverId:1,accid:2,timetag:3,limit:4}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:la.serverRole}]},qchatGetExistingServerRolesByAccids:{service:"qchatRole",sid:24,cid:77,params:[{type:"Long",name:"serverId"},{type:"String",name:"accids"}],response:[{type:"String",name:"serverRoles"}]},qchatGetExistingChannelRolesByServerRoleIds:{service:"qchatRole",sid:24,cid:78,params:[{type:"Long",name:"serverId"},{type:"Long",name:"channelId"},{type:"String",name:"roleIds"}],response:[{type:"PropertyArray",name:"channelRoles",reflectMapper:la.channelRole}]},qchatGetExistingAccidsOfMemberRoles:{service:"qchatRole",sid:24,cid:79,params:[{type:"Long",name:"serverId"},{type:"Long",name:"channelId"},{type:"String",name:"accids"}],response:[{type:"PropertyArray",name:"memberRoles",reflectMapper:la.memberRole}]},qchatUpdateServerRolePriorities:{service:"qchatRole",sid:24,cid:80,params:[{type:"Long",name:"serverId"},{type:"PropertyArray",name:"serverRoles",reflectMapper:{serverId:1,roleId:2,priority:7}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:la.serverRole}]},qchatGetExistingAccidsInServerRole:{service:"qchatRole",sid:24,cid:81,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"},{type:"String",name:"accids"}],response:[{type:"PropertyArray",name:"members",reflectMapper:la.member}]},qchatCheckPermission:{service:"qchatRole",sid:24,cid:82,params:[{type:"Property",name:"checkPermissionTag",reflectMapper:za.checkPermissionTag}],response:[{type:"Boolean",name:"checked"}]},qchatAddChannelCategoryRole:{service:"qchatRole",sid:24,cid:83,params:[{type:"Property",name:"qchatAddChannelCategoryRoleTag",reflectMapper:za.channelCategoryRole}],response:[{type:"Property",name:"channelCategoryRole",reflectMapper:la.channelCategoryRole}]},qchatRemoveChannelCategoryRole:{service:"qchatRole",sid:24,cid:84,params:[{type:"Long",name:"serverId"},{type:"Long",name:"categoryId"},{type:"Long",name:"roleId"}]},qchatUpdateChannelCategoryRole:{service:"qchatRole",sid:24,cid:85,params:[{type:"Property",name:"qchatUpdateChannelCategoryRoleTag",reflectMapper:za.channelCategoryRole}],response:[{type:"Property",name:"channelCategoryRole",reflectMapper:la.channelCategoryRole}]},qchatGetChannelCategoryRole:{service:"qchatRole",sid:24,cid:86,params:[{type:"Property",name:"qchatGetChannelCategoryRoleTag",reflectMapper:za.qchatGetChannelCategoryRoleTag}],response:[{type:"PropertyArray",name:"list",reflectMapper:la.channelCategoryRole}]},qchatAddChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:87,params:[{type:"Property",name:"qchatAddChannelCategoryMemberRoleTag",reflectMapper:za.channelCategoryMemberRole}],response:[{type:"Property",name:"channelCategoryMemberRole",reflectMapper:la.channelCategoryMemberRole}]},qchatRemoveChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:88,params:[{type:"Long",name:"serverId"},{type:"Long",name:"categoryId"},{type:"String",name:"accid"}]},qchatUpdateChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:89,params:[{type:"Property",name:"qchatUpdateChannelCategoryMemberRoleTag",reflectMapper:za.channelCategoryMemberRole}],response:[{type:"Property",name:"channelCategoryMemberRole",reflectMapper:la.channelCategoryMemberRole}]},qchatGetChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:90,params:[{type:"Property",name:"qchatGetChannelCategoryMemberRoleTag",reflectMapper:za.qchatGetChannelCategoryMemberRoleTag}],response:[{type:"PropertyArray",name:"list",reflectMapper:la.channelCategoryMemberRole}]},qchatCheckPermissions:{service:"qchatRole",sid:24,cid:126,params:[{type:"Property",name:"checkPermissionsTag",reflectMapper:za.checkPermissionsTag}],response:[{type:"PropertyArray",name:"checkPermissionsResult",reflectMapper:{1:"auth",2:"isAllow"}}]}},nC=function(){function S(D){this.core=D}var x=S.prototype;return x.addChannelCategoryRole=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},parentRoleId:{type:"string",allowEmpty:!1}},F),z.next=3,this.core.sendCmd("qchatAddChannelCategoryRole",{qchatAddChannelCategoryRoleTag:F});case 3:return oe=z.sent,z.abrupt("return",Gp(oe.content.channelCategoryRole));case 5:case"end":return z.stop()}},O,this)}))},x.removeChannelCategoryRole=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){return ar.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1}},F),xe.next=3,this.core.sendCmd("qchatRemoveChannelCategoryRole",F);case 3:case"end":return xe.stop()}},O,this)}))},x.updateChannelCategoryRole=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},auths:{type:"object"}},F),z.next=3,this.core.sendCmd("qchatUpdateChannelCategoryRole",{qchatUpdateChannelCategoryRoleTag:Ac(F)});case 3:if((oe=z.sent).raw.code!==406){z.next=6;break}throw new yo("No update required",{},406);case 6:return z.abrupt("return",Gp(oe.content.channelCategoryRole));case 7:case"end":return z.stop()}},O,this)}))},x.getChannelCategoryRole=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1}},F),z.next=3,this.core.sendCmd("qchatGetChannelCategoryRole",{qchatGetChannelCategoryRoleTag:F});case 3:return oe=z.sent,z.abrupt("return",(qe=oe.content.list,ns(qe)&&qe.length>0?vo(qe).call(qe,function(Lt){return Gp(Lt)}):[]));case 5:case"end":return z.stop()}var qe},O,this)}))},x.addChannelCategoryMemberRole=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},F),z.next=3,this.core.sendCmd("qchatAddChannelCategoryMemberRole",{qchatAddChannelCategoryMemberRoleTag:F});case 3:return oe=z.sent,z.abrupt("return",Yl(oe.content.channelCategoryMemberRole));case 5:case"end":return z.stop()}},O,this)}))},x.removeChannelCategoryMemberRole=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){return ar.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},F),xe.next=3,this.core.sendCmd("qchatRemoveChannelCategoryMemberRole",F);case 3:case"end":return xe.stop()}},O,this)}))},x.updateChannelCategoryMemberRole=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},auths:{type:"object"}},F),z.next=3,this.core.sendCmd("qchatUpdateChannelCategoryMemberRole",{qchatUpdateChannelCategoryMemberRoleTag:Ac(F)});case 3:if((oe=z.sent).raw.code!==406){z.next=6;break}throw new yo("No update required",{},406);case 6:return z.abrupt("return",Yl(oe.content.channelCategoryMemberRole));case 7:case"end":return z.stop()}},O,this)}))},x.getChannelCategoryMemberRole=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1}},F),z.next=3,this.core.sendCmd("qchatGetChannelCategoryMemberRole",{qchatGetChannelCategoryMemberRoleTag:F});case 3:return oe=z.sent,z.abrupt("return",(qe=oe.content.list,ns(qe)&&qe.length>0?vo(qe).call(qe,function(Lt){return Yl(Lt)}):[]));case 5:case"end":return z.stop()}var qe},O,this)}))},S}(),oC=function(S){function x(F){var O;return(O=S.call(this,"qchatRole",F)||this).core=F,Ei({cmdMap:Fy,cmdConfig:rC}),O.category=new nC(F),O}Ro(x,S);var D=x.prototype;return D.createServerRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},name:{type:"string",allowEmpty:!1},priority:{type:"number",min:1},icon:{type:"string",required:!1},ext:{type:"string",required:!1}},O),qe.next=3,this.core.sendCmd("qchatCreateServerRole",{serverRole:Tn(Tn({},Ac(O)),{type:Jl.custom}),antispamTag:Pc(O)});case 3:return xe=qe.sent,qe.abrupt("return",us(xe.content.serverRole));case 5:case"end":return qe.stop()}},oe,this)}))},D.updateServerRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},name:{type:"string",required:!1},icon:{type:"string",required:!1},ext:{type:"string",required:!1},priority:{type:"number",required:!1},auths:{type:"object",required:!1}},O),qe.next=3,this.core.sendCmd("qchatUpdateServerRole",{updateServerRoleTag:Ac(O),antispamTag:Pc(O)});case 3:return xe=qe.sent,qe.abrupt("return",us(xe.content.serverRole));case 5:case"end":return qe.stop()}},oe,this)}))},D.deleteServerRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1}},O),z.next=3,this.core.sendCmd("qchatDeleteServerRole",O);case 3:case"end":return z.stop()}},oe,this)}))},D.getServerRoles=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},categoryId:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,required:!1},priority:{type:"number",required:!1}},O),lr.next=3,this.core.sendCmd("qchatGetServerRoles",{getServerRolesTag:Ac(O)});case 3:return z=lr.sent,qe=Js(xe=z.content.serverRoles).call(xe,function(pr){return Lo(pr.isMember)===1}),qe=vo(qe).call(qe,function(pr){return pr.roleId}),lr.abrupt("return",{roles:zs(z.content.serverRoles),isMemberRoles:qe});case 7:case"end":return lr.stop()}},oe,this)}))},D.addChannelRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},parentRoleId:{type:"string",allowEmpty:!1}},O),qe.next=3,this.core.sendCmd("qchatAddChannelRole",{channelRole:Ac(O)});case 3:return xe=qe.sent,qe.abrupt("return",us(xe.content.channelRole));case 5:case"end":return qe.stop()}},oe,this)}))},D.getChannelRoles=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},limit:{type:"number",min:1,required:!1}},O),qe.next=3,this.core.sendCmd("qchatGetChannelRoles",{getChannelRolesTag:O});case 3:return xe=qe.sent,qe.abrupt("return",zs(xe.content.channelRoles));case 5:case"end":return qe.stop()}},oe,this)}))},D.removeChannelRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1}},O),z.next=3,this.core.sendCmd("qchatRemoveChannelRole",O);case 3:case"end":return z.stop()}},oe,this)}))},D.updateChannelRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},auths:{type:"object",required:!1}},O),qe.next=3,this.core.sendCmd("qchatUpdateChannelRole",{updateChannelRoleTag:Ac(O)});case 3:if((xe=qe.sent).raw.code!==406){qe.next=6;break}throw new yo("No update required",{},406);case 6:return qe.abrupt("return",us(xe.content.channelRole));case 7:case"end":return qe.stop()}},oe,this)}))},D.addMemberRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},O),qe.next=3,this.core.sendCmd("qchatAddMemberRole",{memberRole:O});case 3:return xe=qe.sent,qe.abrupt("return",us(xe.content.memberRole));case 5:case"end":return qe.stop()}},oe,this)}))},D.getMemberRoles=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},limit:{type:"number",min:1,required:!1}},O),qe.next=3,this.core.sendCmd("qchatGetMemberRoles",{getMemberRolesTag:O});case 3:return xe=qe.sent,qe.abrupt("return",zs(xe.content.memberRoles));case 5:case"end":return qe.stop()}},oe,this)}))},D.removeMemberRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},O),z.next=3,this.core.sendCmd("qchatRemoveMemberRole",{memberRole:O});case 3:case"end":return z.stop()}},oe,this)}))},D.updateMemberRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},auths:{type:"object",required:!1}},O),qe.next=3,this.core.sendCmd("qchatUpdateMemberRole",{updateMemberRoleTag:Ac(O)});case 3:if((xe=qe.sent).raw.code!==406){qe.next=6;break}throw new yo("No update required",{},406);case 6:return qe.abrupt("return",us(xe.content.memberRole));case 7:case"end":return qe.stop()}},oe,this)}))},D.addMembersToServerRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string",min:1}},O),lr.next=3,this.core.sendCmd("qchatAddMembersToServerRole",Tn(Tn({},O),{accids:mo(O.accids)}));case 3:return xe=lr.sent,z=Wa(xe,"content.accids.successAccids"),qe=Wa(xe,"content.accids.failedAccids"),lr.abrupt("return",{successAccids:z?JSON.parse(z):[],failedAccids:qe?JSON.parse(qe):[]});case 7:case"end":return lr.stop()}},oe,this)}))},D.removeMembersFromServerRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string",min:1}},O),lr.next=3,this.core.sendCmd("qchatRemoveMembersFromServerRole",Tn(Tn({},O),{accids:mo(O.accids)}));case 3:return xe=lr.sent,z=Wa(xe,"content.accids.successAccids"),qe=Wa(xe,"content.accids.failedAccids"),lr.abrupt("return",{successAccids:z?JSON.parse(z):[],failedAccids:qe?JSON.parse(qe):[]});case 7:case"end":return lr.stop()}},oe,this)}))},D.getMembersFromServerRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},accid:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,required:!1}},O),qe.next=3,this.core.sendCmd("qchatGetMembersFromServerRole",{getMembersFromServerRoleTag:O});case 3:return xe=qe.sent,qe.abrupt("return",zs(xe.content.members));case 5:case"end":return qe.stop()}},oe,this)}))},D.getServerRolesByAccid=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},limit:{type:"number",min:1,required:!1}},O),qe.next=3,this.core.sendCmd("qchatGetServerRolesByAccid",{getServerRolesByAccidTag:O});case 3:return xe=qe.sent,qe.abrupt("return",zs(xe.content.serverRoles));case 5:case"end":return qe.stop()}},oe,this)}))},D.getExistingServerRolesByAccids=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string"}},O),lr.next=3,this.core.sendCmd("qchatGetExistingServerRolesByAccids",{serverId:O.serverId,accids:mo(O.accids)});case 3:return xe=lr.sent,lr.prev=4,qe=JSON.parse(xe.content.serverRoles),In(z=na(qe)).call(z,function(pr){var Sr;In(Sr=qe[pr]).call(Sr,function(br,Er){qe[pr][Er]=Oa(br,la.serverRole)}),qe[pr]=zs(qe[pr])}),lr.abrupt("return",qe);case 10:throw lr.prev=10,lr.t0=lr.catch(4),this.logger.error("can not parse serverRolesGroupByAccid from "+O.serverId+" and "+O.accids,xe.content.serverRoles),lr.t0;case 14:case"end":return lr.stop()}},oe,this,[[4,10]])}))},D.getExistingChannelRolesByServerRoleIds=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},roleIds:{type:"array",itemType:"string"}},O),qe.next=3,this.core.sendCmd("qchatGetExistingChannelRolesByServerRoleIds",{serverId:O.serverId,channelId:O.channelId,roleIds:mo(O.roleIds)});case 3:return xe=qe.sent,qe.abrupt("return",zs(xe.content.channelRoles));case 5:case"end":return qe.stop()}},oe,this)}))},D.getExistingAccidsOfMemberRoles=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string"}},O),Lt.next=3,this.core.sendCmd("qchatGetExistingAccidsOfMemberRoles",{serverId:O.serverId,channelId:O.channelId,accids:mo(O.accids)});case 3:return xe=Lt.sent,z=xe.content.memberRoles,Lt.abrupt("return",z&&z.length>0?vo(z).call(z,function(lr){return lr.accid}):[]);case 6:case"end":return Lt.stop()}},oe,this)}))},D.getExistingAccidsInServerRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string"}},O),Lt.next=3,this.core.sendCmd("qchatGetExistingAccidsInServerRole",{serverId:O.serverId,roleId:O.roleId,accids:mo(O.accids)});case 3:return xe=Lt.sent,z=xe.content.members,Lt.abrupt("return",z&&z.length>0?vo(z).call(z,function(lr){return lr.accid}):[]);case 6:case"end":return Lt.stop()}},oe,this)}))},D.updateServerRolePriorities=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},serverRoles:{type:"array"}},O),Lt.next=3,this.core.sendCmd("qchatUpdateServerRolePriorities",{serverId:O.serverId,serverRoles:vo(xe=O.serverRoles).call(xe,function(lr){return{serverId:lr.serverId,roleId:lr.roleId,priority:lr.priority}})});case 3:return z=Lt.sent,Lt.abrupt("return",zs(z.content.serverRoles));case 5:case"end":return Lt.stop()}},oe,this)}))},D.checkPermission=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},auth:{type:"string"}},O),qe.next=3,this.core.sendCmd("qchatCheckPermission",{checkPermissionTag:Tn(Tn({},O),{auth:bl[O.auth]||O.auth})});case 3:return xe=qe.sent,qe.abrupt("return",xe.content.checked);case 5:case"end":return qe.stop()}},oe,this)}))},D.addChannelCategoryRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.addChannelCategoryRole(O);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},D.removeChannelCategoryRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.removeChannelCategoryRole(O);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},D.updateChannelCategoryRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.updateChannelCategoryRole(O);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},D.getChannelCategoryRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.getChannelCategoryRole(O);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},D.addChannelCategoryMemberRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.addChannelCategoryMemberRole(O);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},D.removeChannelCategoryMemberRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.removeChannelCategoryMemberRole(O);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},D.updateChannelCategoryMemberRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.updateChannelCategoryMemberRole(O);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},D.getChannelCategoryMemberRole=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.category.getChannelCategoryMemberRole(O);case 2:return z.abrupt("return",z.sent);case 3:case"end":return z.stop()}},oe,this)}))},D.checkPermissions=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},auths:{type:"array",itemType:"string"}},O),this.core.logger.log("qchatRole::checkPermission options is",O),pr.next=4,this.core.sendCmd("qchatCheckPermissions",{checkPermissionsTag:Tn(Tn({},O),{auths:mo(vo(xe=O.auths).call(xe,function(Sr){return bl[Sr]||Sr}))})});case 4:return qe=pr.sent,this.core.logger.log("qchatRole::checkPermission result is",qe.content),Lt={},In(z=qe.content.checkPermissionsResult).call(z,function(Sr){Lt[Sr.auth]=Sr.isAllow}),this.core.logger.log("qchatRole::checkPermission auths is",Lt),pr.abrupt("return",Ti(Lt));case 10:case"end":return pr.stop()}},oe,this)}))},x}(gl),Yp=function(x,D){return cy(x,D,function(F,O){return sy(x,O)})},aC=function(x){return x!=null&&x.length?Py(x,1):[]},dc,Os,Xp=function(x){return Ev(xv(x,void 0,aC),x+"")}(function(S,x){return S==null?{}:Yp(S,x)}),Nh={"24_10":"qchatSendMsg","24_11":"qchatOnMsg","24_12":"qchatOnRecvUnreadInfo","24_13":"qchatSendCustomSysMsg","24_14":"qchatOnSysMsg","24_16":"qchatGetHistoryMsg","24_17":"qchatMarkMessageRead","24_18":"qchatMultiSyncMessageRead","24_22":"qchatUpdateSystemNotification","24_23":"qchatMultiSyncSystemNotificationUpdate","24_24":"qchatSyncSystemNotification","24_25":"qchatUpdateMessage","24_26":"qchatRecvMessageUpdate","24_28":"qchatMarkSysMsgRead","24_94":"qchatMessageSearchByPage","24_100":"qchatGetMessageHistoryByIds","24_101":"qchatGetThreadMessages","24_102":"qchatUpdateQuickComment","24_103":"qchatGetQuickComments","24_108":"qchatGetThreadRootMessagesMeta","24_121":"qchatGetLastMessageOfChannels","24_127":"qchatGetMentionedMeMessages","25_6":"qchatMultiSyncServersMessageRead"},ds={getHistoryMsgTag:{serverId:1,channelId:2,beginTime:3,endTime:4,excludeMsgId:5,limit:6,reverse:7},getThreadHistoryMsgTag:{beginTime:1,endTime:2,excludeMsgId:3,limit:4,reverse:5},qchatMsgTag:{serverId:1,channelId:2,fromAccount:3,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,updateTime:8,type:9,body:10,attach:11,ext:12,msgIdClient:13,msgIdServer:14,resendFlag:15,status:16,pushPayload:17,pushContent:18,mentionAccids:19,mentionAll:20,env:21,callbackExt:22,replyMsgFromAccount:23,replyMsgTime:24,replyMsgIdServer:25,replyMsgIdClient:26,threadMsgFromAccount:27,threadMsgTime:28,threadMsgIdServer:29,threadMsgIdClient:30,useCustomContent:31,antiSpamContent:32,antiSpamBusinessId:33,antiSpamUsingYidun:34,yidunCallback:35,yidunAntiCheating:36,yidunAntiSpamExt:37,yidunAntiSpamRes:38,mentionRoleIds:41,accidsOfMentionedRoles:42,updateContent:39,updateOperatorInfo:40,subType:61,historyEnable:100,pushEnable:101,needBadge:102,needPushNick:103,notifyReason:104,routeEnable:105,isAntispam:106},sysMsg:{toType:1,serverId:2,channelId:3,toAccids:4,fromAccount:5,fromClientType:6,fromDeviceId:7,fromNick:8,time:9,updateTime:10,type:11,msgIdClient:12,msgIdServer:13,body:14,attach:15,ext:16,resendFlag:17,status:18,pushPayload:19,pushContent:20,env:21,callbackExt:22,persistEnable:100,pushEnable:101,needBadge:102,needPushNick:103,routeEnable:104},qchatMsgUpdateTag:{operatorAccount:1,operatorClientType:2,ps:3,ext:4,pushContent:5,pushPayload:6,env:7,routeEnable:100},markMsgReadTag:{serverId:1,channelId:2,time:3},qchatQuickCommentRequestTag:{serverId:1,channelId:2,fromAccount:3,msgIdServer:4,time:5,type:6,opeType:7,opeAccid:8},qchatQuickCommentQueryTag:{serverId:1,channelId:2,msgIdServerList:3},qchatGetLastMessageOfChannelsTag:{serverId:1,channelIdList:2},qchatMultiSyncServersMessageReadTag:{successServerIds:1,failServerIds:2,ackTimestamp:3},qchatMessageSearchByPageTag:{keyword:1,serverId:2,channelId:3,fromAccid:4,fromTime:5,toTime:6,msgTypes:7,subTypes:8,includeSelf:9,order:10,limit:11,sort:12,cursor:13},qchatPageQueryTag:{hasMore:1,nextTimetag:2,cursor:3},unreadInfo:Th},fa=Cc(ds),sC={qchatSendMsg:{service:"qchatMsg",sid:24,cid:10,params:[{type:"Property",name:"qchatMsg",reflectMapper:ds.qchatMsgTag}],response:[{type:"Property",name:"qchatMsg",reflectMapper:fa.qchatMsgTag}]},qchatOnMsg:{service:"qchatMsg",sid:24,cid:11,response:[{type:"Property",name:"qchatMsg",reflectMapper:fa.qchatMsgTag}]},qchatOnRecvUnreadInfo:{service:"qchatMsg",sid:24,cid:12,response:[{type:"Property",name:"qchatMsg",reflectMapper:fa.qchatMsgTag}]},qchatSendCustomSysMsg:{service:"qchatMsg",sid:24,cid:13,params:[{type:"Property",name:"sysMsg",reflectMapper:ds.sysMsg}],response:[{type:"Property",name:"sysMsg",reflectMapper:fa.sysMsg}]},qchatOnSysMsg:{service:"qchatMsg",sid:24,cid:14,response:[{type:"Property",name:"sysMsg",reflectMapper:fa.sysMsg}]},qchatGetHistoryMsg:{service:"qchatMsg",sid:24,cid:16,params:[{type:"Property",name:"getHistoryMsgTag",reflectMapper:ds.getHistoryMsgTag}],response:[{type:"PropertyArray",name:"qchatMsgs",reflectMapper:fa.qchatMsgTag}]},qchatUpdateMessage:{service:"qchatMsg",sid:24,cid:25,params:[{type:"Property",name:"qchatMsgUpdateTag",reflectMapper:ds.qchatMsgUpdateTag},{type:"Property",name:"qchatMsg",reflectMapper:ds.qchatMsgTag}],response:[{type:"Property",name:"qchatMsg",reflectMapper:fa.qchatMsgTag}]},qchatRecvMessageUpdate:{service:"qchatMsg",sid:24,cid:26,response:[{type:"Property",name:"qchatMsgUpdateInfo",reflectMapper:fa.qchatMsgUpdateTag},{type:"Property",name:"qchatMsg",reflectMapper:fa.qchatMsgTag}]},qchatMarkMessageRead:{sid:24,cid:17,service:"qchatMsg",params:[{type:"Property",name:"markMsgReadTag",reflectMapper:ds.markMsgReadTag}],response:[{type:"Property",name:"unreadInfo",reflectMapper:fa.unreadInfo}]},qchatMultiSyncMessageRead:{sid:24,cid:18,service:"qchatMsg",response:[{type:"Property",name:"unreadInfo",reflectMapper:fa.unreadInfo}]},qchatUpdateSystemNotification:{service:"qchatMsg",sid:24,cid:22,params:[{type:"Property",name:"qchatMsgUpdateTag",reflectMapper:ds.qchatMsgUpdateTag},{type:"Property",name:"sysMsg",reflectMapper:ds.sysMsg}],response:[{type:"Property",name:"sysMsg",reflectMapper:fa.sysMsg}]},qchatMultiSyncSystemNotificationUpdate:{service:"qchatMsg",sid:24,cid:23,response:[{type:"Property",name:"qchatMsgUpdateTag",reflectMapper:fa.qchatMsgUpdateTag},{type:"Property",name:"sysMsg",reflectMapper:fa.sysMsg}]},qchatSyncSystemNotification:{service:"qchatMsg",sid:24,cid:24,response:[{type:"PropertyArray",name:"systemNotifications",reflectMapper:fa.sysMsg}]},qchatMarkSysMsgRead:{service:"qchatMsg",sid:24,cid:28,params:[{type:"PropertyArray",name:"sysMsgs",reflectMapper:ds.sysMsg}]},qchatMessageSearchByPage:{service:"qchatMsg",sid:24,cid:94,params:[{type:"Property",name:"qchatMessageSearchByPageTag",reflectMapper:ds.qchatMessageSearchByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:fa.qchatPageQueryTag},{type:"PropertyArray",name:"datas",reflectMapper:fa.qchatMsgTag}]},qchatGetMessageHistoryByIds:{service:"qchatMsg",sid:24,cid:100,params:[{type:"Property",name:"channelInfo",reflectMapper:{serverId:1,channelId:2}},{type:"PropertyArray",name:"messageReferList",reflectMapper:{msgIdServer:1,time:2}}],response:[{type:"PropertyArray",name:"qchatMsgs",reflectMapper:fa.qchatMsgTag}]},qchatGetThreadMessages:{service:"qchatMsg",sid:24,cid:101,params:[{type:"Property",name:"qchatMsg",reflectMapper:ds.qchatMsgTag},{type:"Property",name:"getThreadHistoryMsgTag",reflectMapper:ds.getThreadHistoryMsgTag}],response:[{type:"Property",name:"thread",reflectMapper:fa.qchatMsgTag},{type:"Property",name:"threadInfo",reflectMapper:{1:"messageCount",2:"lastMessageTimestamp"}},{type:"PropertyArray",name:"qchatMsgs",reflectMapper:fa.qchatMsgTag}]},qchatUpdateQuickComment:{service:"qchatMsg",sid:24,cid:102,params:[{type:"Property",name:"tag",reflectMapper:ds.qchatQuickCommentRequestTag}]},qchatGetQuickComments:{service:"qchatMsg",sid:24,cid:103,params:[{type:"Property",name:"tag",reflectMapper:ds.qchatQuickCommentQueryTag}],response:[{type:"PropertyArray",name:"quickCommentResponse",reflectMapper:{1:"serverId",2:"channelId",3:"msgIdServer",4:"totalCount",5:"lastUpdateTime",6:"details"}}]},qchatGetThreadRootMessagesMeta:{service:"qchatMsg",sid:24,cid:108,params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,channelId:2}},{type:"PropertyArray",name:"qchatMsgs",reflectMapper:{time:7,msgIdServer:14}}],response:[{type:"PropertyArray",name:"metas",reflectMapper:{1:"total",2:"timestamp",3:"msgIdServer",4:"msgTime"}}]},qchatGetLastMessageOfChannels:{service:"qchatMsg",sid:24,cid:121,params:[{type:"Property",name:"tag",reflectMapper:ds.qchatGetLastMessageOfChannelsTag}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:fa.qchatMsgTag}]},qchatMultiSyncServersMessageRead:{service:"qchatMsg",sid:25,cid:6,response:[{type:"Property",name:"qchatMultiSyncServersMessageReadTag",reflectMapper:fa.qchatMultiSyncServersMessageReadTag}]},qchatGetMentionedMeMessages:{service:"qchatMsg",sid:24,cid:127,params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,channelId:2,timestamp:3,limit:4}}],response:[{type:"Property",name:"page",reflectMapper:fa.qchatPageQueryTag},{type:"PropertyArray",name:"datas",reflectMapper:fa.qchatMsgTag}]}};(function(S){S[S.Android=1]="Android",S[S.iOS=2]="iOS",S[S.PC=4]="PC",S[S.WindowsPhone=8]="WindowsPhone",S[S.Web=16]="Web",S[S.Server=32]="Server",S[S.Mac=64]="Mac"})(dc||(dc={}));var Ly=["image","audio","video","file"],Zp={time:{type:"number"},updateTime:{type:"number"},resendFlag:{type:"boolean"},persistEnable:{type:"boolean"},routeEnable:{type:"boolean"},pushEnable:{type:"boolean"},needBadge:{type:"boolean"},needPushNick:{type:"boolean"},type:{type:"enum",values:Xo},fromClientType:{type:"enum",values:dc},status:{type:"number"},toAccids:{type:"object"},toType:{type:"number"},attach:{type:"object"},pushPayload:{type:"object"}};function Rh(S,x){var D=Tn({},S),F=Tn({type:x||Xo.custom},Gl(Zp,D));return F.serverId&&F.channelId&&F.toAccids?F.toType=Oc.channelAccids:F.serverId&&F.toAccids?F.toType=Oc.serverAccids:F.serverId&&F.channelId?F.toType=Oc.channel:F.serverId?F.toType=Oc.server:F.toAccids?F.toType=Oc.accids:F.toType=Oc.unknown,F}function $y(S){var x=Xp(S,["msgIdServer","type"]);return Gl(Zp,x)}var jy=((Os={})[Xo.channelUpdateWhiteBlackIdentify]=function(S){return S.notify=Pd(Oa(S.notify,zo.qchatUpdateWhiteBlackRoleTag)),S},Os[Xo.channelUpdateWhiteBlackIdentifyUser]=function(S){return S.notify=function(D){return ya(Iy,D)}(Oa(S.notify,zo.qchatUpdateWhiteBlackMembersTag)),S},Os[Xo.updateQuickComment]=function(S){return S.notify=function(D){return ya(lC,D)}(Oa(S.notify,fa.qchatQuickCommentRequestTag)),S},Os[Xo.channelCategoryCreate]=function(S){return S.categoryInfo=Rd(Oa(S.categoryInfo,zo.QChatChannelCategoryInfo)),S},Os[Xo.channelCategoryUpdate]=function(S){return S.categoryInfo=Rd(Oa(S.categoryInfo,zo.QChatChannelCategoryInfo)),S},Os[Xo.channelCategoryUpdateWhiteBlackIdentify]=function(S){return S.notify=Pd(Oa(S.notify,zo.qchatUpdateChannelCategoryWhiteBlackRoleTag)),S},Os[Xo.channelCategoryUpdateWhiteBlackIdentifyUser]=function(S){return S.notify=Pd(Oa(S.notify,zo.qchatUpdateChannelCategoryWhiteBlackMembersTag)),S},Os[Xo.serverIdentifyAdd]=function(S){return S.serverIdentifyInfo=us(Oa(S.serverIdentifyInfo,la.serverRole)),S},Os[Xo.serverIdentifyRemove]=function(S){return S.serverIdentifyInfo=us(Oa(S.serverIdentifyInfo,la.serverRole)),S},Os[Xo.serverIdentifyUpdate]=function(S){return S.serverIdentifyInfo=us(Oa(S.serverIdentifyInfo,la.serverRole)),S},Os[Xo.channelIdentifyUpdate]=function(S){return S.channelIdentifyInfo=us(Oa(S.channelIdentifyInfo,la.channelRole)),S},Os[Xo.userIdentifyUpdate]=function(S){return S.userIdentifyInfo=us(Oa(S.userIdentifyInfo,la.memberRole)),S},Os[Xo.myMemberInfoUpdated]=function(S){var x,D=Wa(S,"userInfo.name"),F=Wa(S,"userInfo.icon");return S.updatedInfos=vo(x=S.reuseServers).call(x,function(O){var oe={serverId:O.serverId};return(1&O.bits)==1&&typeof D=="string"&&Tn(oe,{nickChanged:!0,nick:D}),(2&O.bits)==2&&typeof F=="string"&&Tn(oe,{avatarChanged:!0,avatar:F}),oe}),delete S.userInfo,delete S.reuseServers,S},Os);function Dd(S,x){var D=ya(Zp,S);if(!D.attach)return D;if(D.attach.serverInfo&&(D.attach.serverInfo=xd(Oa(D.attach.serverInfo,La.serverInfo))),D.attach.channelInfo&&(D.attach.channelInfo=Ad(Oa(D.attach.channelInfo,zo.channelInfo))),D.attach.serverMember&&(D.attach.serverMember=Ql(Oa(D.attach.serverMember,La.memberInfo))),jy[D.attach.type]&&(D.attach=jy[D.attach.type](D.attach)),D.attach.updateAuths)try{D.attach.updateAuths=Ti(JSON.parse(D.attach.updateAuths))}catch(F){x.error("formatSystemNotification:JSON parse updateAuths error: ",F)}return D.attach.type&&(D.attach.rawType=D.attach.type,D.attach.type=Xo[D.attach.type]),D}var ef={type:{type:"enum",values:Ld},fromClientType:{type:"enum",values:dc},status:{type:"number"},resendFlag:{type:"boolean"},mentionAll:{type:"boolean"},notifyReason:{type:"enum",values:$d},pushEnable:{type:"boolean"},historyEnable:{type:"boolean"},needBadge:{type:"boolean"},needPushNick:{type:"boolean"},routeEnable:{type:"boolean"},time:{type:"number"},updateTime:{type:"number"},mentionAccids:{type:"object"},mentionRoleIds:{type:"object"},accidsOfMentionedRoles:{type:"object"},attach:{type:"object"},pushPayload:{type:"object"},isAntispam:{type:"boolean"},antiSpamInfo:{useCustomContent:{type:"boolean"},antiSpamContent:{type:"string"},antiSpamBusinessId:{type:"string"},antiSpamUsingYidun:{type:"boolean"},yidunCallback:{type:"string"},yidunAntiCheating:{type:"object"},yidunAntiSpamExt:{type:"object"},yidunAntiSpamRes:{type:"string"}},replyRefer:{fromAccount:{type:"string",rawKey:"replyMsgFromAccount"},time:{type:"number",rawKey:"replyMsgTime"},msgIdServer:{type:"string",rawKey:"replyMsgIdServer"},msgIdClient:{type:"string",rawKey:"replyMsgIdClient"}},threadRefer:{fromAccount:{type:"string",rawKey:"threadMsgFromAccount"},time:{type:"number",rawKey:"threadMsgTime"},msgIdServer:{type:"string",rawKey:"threadMsgIdServer"},msgIdClient:{type:"string",rawKey:"threadMsgIdClient"}}};function Bh(S){S.onSendBefore,S.onUploadStart,S.onUploadDone,S.onUploadProgress;var x=xl(S,["onSendBefore","onUploadStart","onUploadDone","onUploadProgress"]),D=Gl(ef,x);if(D.msgIdClient=S.resendFlag?S.msgIdClient:Dg(),!D.msgIdClient)throw new El("msgIdClient is required for resend a message","msgIdClient","required");return S.replyMessage&&S.replyMessage.msgIdServer&&(D.replyMsgFromAccount=S.replyMessage.fromAccount,D.replyMsgTime=+S.replyMessage.time,D.replyMsgIdServer=S.replyMessage.msgIdServer,D.replyMsgIdClient=S.replyMessage.msgIdClient,S.replyMessage.threadRefer&&S.replyMessage.threadRefer.msgIdServer?(D.threadMsgFromAccount=S.replyMessage.threadRefer.fromAccount,D.threadMsgTime=+S.replyMessage.threadRefer.time,D.threadMsgIdServer=S.replyMessage.threadRefer.msgIdServer,D.threadMsgIdClient=S.replyMessage.threadRefer.msgIdClient):(D.threadMsgFromAccount=S.replyMessage.fromAccount,D.threadMsgTime=+S.replyMessage.time,D.threadMsgIdServer=S.replyMessage.msgIdServer,D.threadMsgIdClient=S.replyMessage.msgIdClient),delete D.replyMessage),D}function Dy(S){return ya({operatorClientType:{type:"enum",values:dc},pushPayload:{type:"object"}},S)}function _s(S,x,D){var F,O;return x===void 0&&(x={}),Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return(xe=ya(ef,S)).deliveryStatus=x.deliveryStatus?Si[x.deliveryStatus]:Si[Si.success],x.time&&(xe.time=x.time),xe.updateContent&&(z=ya({status:{type:"number"}},z=Oa(z=JSON.parse(xe.updateContent),fa.qchatMsgTag)),xe.updateContent=z),xe.updateOperatorInfo&&(qe=Dy(Oa(qe=JSON.parse(xe.updateOperatorInfo),fa.qchatMsgUpdateTag)),xe.updateOperatorInfo=qe),((F=xe==null?void 0:xe.threadRefer)===null||F===void 0?void 0:F.fromAccount)===""&&delete xe.threadRefer,((O=xe==null?void 0:xe.replyRefer)===null||O===void 0?void 0:O.fromAccount)===""&&delete xe.replyRefer,xe.attach&&x.attachUrl&&(xe.attach.url=x.attachUrl),lr.next=10,Uy(xe,D);case 10:return lr.abrupt("return",lr.sent);case 11:case"end":return lr.stop()}},oe)}))}function Uy(S,x){return Mr(this,void 0,void 0,ar.mark(function D(){var F;return ar.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:if(mi(Ly).call(Ly,S.type)&&S.attach&&S.attach.url){oe.next=2;break}return oe.abrupt("return",S);case 2:if(x&&x.cloudStorage&&typeof x.cloudStorage.getPrivateUrl=="function"&&typeof x.cloudStorage.getOriginUrl=="function"){oe.next=4;break}return oe.abrupt("return",S);case 4:if(!(pa(F=S.attach.url).call(F,"_im_url=1")<0)){oe.next=7;break}return S.attach.url=x.cloudStorage.getPrivateUrl(S.attach.url),oe.abrupt("return",S);case 7:return oe.prev=7,oe.next=10,x.cloudStorage.getOriginUrl(S.attach.url);case 10:S.attach.url=oe.sent,oe.next=16;break;case 13:throw oe.prev=13,oe.t0=oe.catch(7),new El('url "'+S.attach.url+'" parse error',"message.attach.url","parse error");case 16:return oe.abrupt("return",S);case 17:case"end":return oe.stop()}},D,null,[[7,13]])}))}function Fh(S,x,D){return x===void 0&&(x={}),Mr(this,void 0,void 0,ar.mark(function F(){var O;return ar.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:if(ns(S)&&S.length>0){xe.next=2;break}return xe.abrupt("return",[]);case 2:return O=vo(S).call(S,function(z){return _s(z,x,D)}),xe.next=5,co.all(O);case 5:return xe.abrupt("return",xe.sent);case 6:case"end":return xe.stop()}},F)}))}var iC={totalCount:{type:"number"},lastUpdateTime:{type:"number"},details:{type:"object"}};function cC(S){var x=vo(S).call(S,function(F){var O,oe=ya(iC,F);return oe.details=vo(O=oe.details).call(O,function(xe){return{count:xe.count,hasSelf:xe.self,severalAccids:xe.topN,type:xe.type}}),oe}),D={};return In(x).call(x,function(F){return D[F.msgIdServer]=F}),D}var lC={type:{type:"number"},time:{type:"number"},opeType:{type:"number"}},qy={includeSelf:{type:"number"},order:{type:"enum",values:Ic},sort:{type:"enum",values:Qp},msgTypes:{type:"object"},subTypes:{type:"object"}},uC={hasMore:{type:"boolean"},nextTimetag:{type:"number"},cursor:{type:"string"}},dC={6:function(x){return this.core.qchatChannel.subscribeForVisitorService.deleteAutoSetInServerId(x.serverId),!0},16:function(x){return this.core.qchatChannel.subscribeForVisitorService.deleteAutoSetInChannel(x.serverId,x.channelId),!0},26:function(x){var D=Wa(x,"attach.addAccids");return D&&mi(D).call(D,this.core.account)&&this.core.eventBus.emit("qchatChannel/serverIdentifyChange",x),!0},27:function(x){var D=Wa(x,"attach.deleteAccids");return D&&mi(D).call(D,this.core.account)&&this.core.eventBus.emit("qchatChannel/serverIdentifyChange",x),!0},31:function(x){return x.attach.event===2&&(this.core.eventBus.emit("qchatChannel/autoUnSubscribe",x),this.core.eventBus.emit("qchatMedia/serverOrChannelLeave",x)),!0},32:function(x){return x.attach.event===2?(this.core.eventBus.emit("qchatChannel/autoUnSubscribe",x),this.core.eventBus.emit("qchatMedia/serverOrChannelLeave",x)):x.attach.event===1&&this.core.qchatChannel.subscribeForVisitorService.deleteServer(x.serverId),!0},34:function(x){return x.attach.event===2&&this.core.qchatChannel.subscribeForVisitorService.unSubscribeChannel(x.serverId,x.channelId),!0},101:function(x){var D=Xp(x,["serverId","channelId","ext","fromAccount","fromNick","time"]);return this.logger.log("qchat on recvTypingEvent: ",D),this.core.emit("recvTypingEvent",D),!1}},pC=function(){function S(D){this.core=D,this.logger=D.logger}var x=S.prototype;return x.sendSystemNotification=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return qe.next=2,this.core.sendCmd("qchatSendCustomSysMsg",{sysMsg:Rh(F)});case 2:return oe=qe.sent,xe=Dd(oe.content.sysMsg,this.logger),this.core.options.debugLevel==="debug"?this.logger.debug("sendCustomSysMsg success",xe):this.logger.log("sendCustomSysMsg success",xe.serverId,xe.channelId,xe.msgIdServer),qe.abrupt("return",xe);case 6:case"end":return qe.stop()}},O,this)}))},x.updateSystemNotification=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return oe=F.systemNotification,xe=xl(F,["systemNotification"]),z=Xp(oe,["msgIdServer","type","body","ext","status"]),qe=Rh(z),pr.next=5,this.core.sendCmd("qchatUpdateSystemNotification",{sysMsg:qe,qchatMsgUpdateTag:Tn(Tn({},xe),{operatorAccount:this.core.account,operatorClientType:dc.Web,pushPayload:mo(F.pushPayload),routeEnable:Ch.boolean(F,"routeEnable")})});case 5:return Lt=pr.sent,pr.abrupt("return",Dd(Lt.content.sysMsg,this.logger));case 7:case"end":return pr.stop()}},O,this)}))},x.markSystemNotificationsRead=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.core.sendCmd("qchatMarkSysMsgRead",{sysMsgs:vo(oe=F.systemNotifications).call(oe,function(qe){return $y(qe)})});case 2:case"end":return z.stop()}},O,this)}))},x.onSysMsg=function(F){var O=F.content.sysMsg;if(O){var oe=Dd(O,this.core.logger),xe=dC[Xo[oe.type]];if(xe&&xe.call(this,oe)===!1)return;var z={feature:"default",systemNotifications:[oe]};this.logger.log("qchat on systemNotification: ",z),this.core.emit("systemNotification",z)}else this.core.logger.warn("No sysMsg in onSysMsg packet")},x.onMultiSysMsg=function(F){var O=F.content.sysMsg;if(O){var oe=Dd(O,this.logger);this.core.emit("systemNotificationUpdate",oe)}},x.onSyncSysMsg=function(F){var O=this,oe=F.content.systemNotifications;if(oe&&oe.length>0){var xe=vo(oe).call(oe,function(z){return Dd(z,O.logger)});this.core.emit("systemNotification",{feature:"sync",systemNotifications:xe})}else this.logger.warn("sync system notification not exist")},S}(),Lh=["image","audio","video","file"],fC=function(){function S(D){var F=this;this.markMessageRead=Ah(function(O){return Mr(F,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Lt.next=2,this.core.sendCmd("qchatMarkMessageRead",{markMsgReadTag:O});case 2:xe=Lt.sent,z=kh(xe.content.unreadInfo),this.core.eventBus.emit("qchatChannel/updateUnreads",[z]);case 5:case"end":return Lt.stop()}},oe,this)}))},200),this.core=D,this.logger=D.logger}var x=S.prototype;return x.sendMessage=function(F){var O,oe,xe,z;return Mr(this,void 0,void 0,ar.mark(function qe(){var Lt,lr,pr,Sr,br,Er;return ar.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:if(!(pa(Lh).call(Lh,F.type)>-1)){$r.next=4;break}return $r.next=3,this.doSendFile(F);case 3:F.attach=$r.sent;case 4:return Lt=Bh(Tn({fromAccount:this.core.account},F)),$r.next=7,_s(Lt,{time:new Date().getTime(),deliveryStatus:Si.sending},this.core);case 7:lr=$r.sent;try{F.onSendBefore&&F.onSendBefore(lr)}catch(vn){this.logger.error("sendMsg: options.onSendBefore error",vn)}return $r.prev=9,$r.next=12,this.core.sendCmd("qchatSendMsg",{qchatMsg:Lt});case 12:pr=$r.sent,$r.next=22;break;case 15:return $r.prev=15,$r.t0=$r.catch(9),$r.next=19,_s(Lt,{time:new Date().getTime(),deliveryStatus:Si.failed,attachUrl:(O=lr.attach)===null||O===void 0?void 0:O.url},this.core);case 19:throw Sr=$r.sent,$r.t0.msg=Sr,$r.t0;case 22:return br=pr.content,$r.next=25,_s(Tn({},br.qchatMsg),{deliveryStatus:Si.success,attachUrl:(oe=lr.attach)===null||oe===void 0?void 0:oe.url},this.core);case 25:if(!(Er=$r.sent).isAntispam){$r.next=29;break}throw{code:10403,msg:Er,message:((xe=Er==null?void 0:Er.antiSpamInfo)===null||xe===void 0?void 0:xe.yidunAntiSpamRes)||"message has be antispam",isAntispam:!0,yidunAntiSpamRes:((z=Er==null?void 0:Er.antiSpamInfo)===null||z===void 0?void 0:z.yidunAntiSpamRes)||""};case 29:return $r.abrupt("return",Er);case 30:case"end":return $r.stop()}},qe,this,[[9,15]])}))},x.doSendFile=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe;return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(Gr({type:{type:"enum",values:["image","audio","video","file"]},attach:{type:"object",rules:{url:{type:"string",allowEmpty:!1}},required:!1},maxSize:{type:"number",min:1,required:!1}},F),oe=F.attach){z.next=23;break}if(this.core.cloudStorage&&this.core.cloudStorage.uploadFile){z.next=5;break}throw new Error('Service "cloudStorage" does not exist');case 5:return z.prev=5,z.next=8,this.core.cloudStorage.uploadFile(F);case 8:oe=z.sent,z.next=15;break;case 11:throw z.prev=11,z.t0=z.catch(5),this.logger.error("sendFile:: upload File error or abort",z.t0),z.t0;case 15:z.prev=15,F.onUploadDone&&F.onUploadDone(oe),z.next=23;break;case 19:throw z.prev=19,z.t1=z.catch(15),this.logger.error("sendFile options.onUploadDone err",z.t1),z.t1;case 23:return z.abrupt("return",oe);case 24:case"end":return z.stop()}},O,this,[[5,11],[15,19]])}))},x.resendMessage=function(F){var O,oe;return Mr(this,void 0,void 0,ar.mark(function xe(){var z,qe,Lt,lr,pr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return(z=Bh(Tn(Tn({},F),{resendFlag:!0}))).deliveryStatus=Si.sending,br.prev=2,br.next=5,this.core.sendCmd("qchatSendMsg",{qchatMsg:z});case 5:qe=br.sent,br.next=15;break;case 8:return br.prev=8,br.t0=br.catch(2),br.next=12,_s(z,{time:new Date().getTime(),deliveryStatus:Si.failed},this.core);case 12:throw Lt=br.sent,br.t0.msg=Lt,br.t0;case 15:return lr=qe.content,br.next=18,_s(Tn({},lr.qchatMsg),{deliveryStatus:Si.success},this.core);case 18:if(!(pr=br.sent).isAntispam){br.next=22;break}throw{code:10403,msg:pr,message:((O=pr==null?void 0:pr.antiSpamInfo)===null||O===void 0?void 0:O.yidunAntiSpamRes)||"message has be antispam",isAntispam:!0,yidunAntiSpamRes:((oe=pr==null?void 0:pr.antiSpamInfo)===null||oe===void 0?void 0:oe.yidunAntiSpamRes)||""};case 22:return br.abrupt("return",pr);case 23:case"end":return br.stop()}},xe,this,[[2,8]])}))},x.doUpdateMessage=function(F){var O,oe;return Mr(this,void 0,void 0,ar.mark(function xe(){var z,qe,Lt,lr,pr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return z=F.message,qe=xl(F,["message"]),(Lt=Bh(z)).msgIdClient=void 0,Lt.time=z.time,br.next=6,this.core.sendCmd("qchatUpdateMessage",{qchatMsg:Lt,qchatMsgUpdateTag:Tn(Tn({},qe),{operatorAccount:this.core.account,operatorClientType:dc.Web,pushPayload:mo(F.pushPayload),routeEnable:Ch.boolean(F,"routeEnable")})});case 6:return lr=br.sent,br.next=9,_s(lr.content.qchatMsg,{},this.core);case 9:if(pr=br.sent,this.core.eventBus.emit("qchatChannel/changeUnread",pr,!0),!lr.content.qchatMsg.isAntispam){br.next=14;break}throw{code:10403,msg:Lt,message:((O=lr.content.qchatMsg)===null||O===void 0?void 0:O.yidunAntiSpamRes)||"message has be antispam",isAntispam:!0,yidunAntiSpamRes:((oe=lr.content.qchatMsg)===null||oe===void 0?void 0:oe.yidunAntiSpamRes)||""};case 14:return br.abrupt("return",pr);case 15:case"end":return br.stop()}},xe,this)}))},x.getHistoryMessage=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe=this;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return lr.next=2,this.core.sendCmd("qchatGetHistoryMsg",{getHistoryMsgTag:Tn(Tn({},F),{reverse:kl(F)?1:0})});case 2:return xe=lr.sent,z=xe.content,lr.next=6,co.all(vo(oe=z.qchatMsgs).call(oe,function(pr){return _s(pr,{},qe.core)}));case 6:return lr.abrupt("return",lr.sent);case 7:case"end":return lr.stop()}},O,this)}))},x.getMentionedMeMessages=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe,Lt,lr=this;return ar.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:return Sr.next=2,this.core.sendCmd("qchatGetMentionedMeMessages",{tag:F});case 2:return xe=Sr.sent,z=xe.content,br=z.page,qe=ya(uC,br),Sr.next=7,co.all(vo(oe=z.datas).call(oe,function(Er){return _s(Er,{},lr.core)}));case 7:return Lt=Sr.sent,Sr.abrupt("return",{pageInfo:qe,messages:Lt});case 9:case"end":return Sr.stop()}var br},O,this)}))},x.areMentionedMeMessages=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:oe={},xe=0;case 2:if(!(xe<F.length)){Lt.next=13;break}if((z=F[xe]).fromAccount!==this.core.account){Lt.next=7;break}return oe[z.msgIdClient]=!1,Lt.abrupt("continue",10);case 7:return Lt.next=9,this.core.qchatChannel.subscribeModuleService.getMentionedFlag(z,!0);case 9:oe[z.msgIdClient]=Lt.sent;case 10:xe++,Lt.next=2;break;case 13:return Lt.abrupt("return",oe);case 14:case"end":return Lt.stop()}},O,this)}))},x.getLastMessageOfChannels=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Lt.next=2,this.core.sendCmd("qchatGetLastMessageOfChannels",{tag:F});case 2:return oe=Lt.sent,xe=oe.content.msgs,Lt.next=6,Fh(xe,{},this.core);case 6:return z=Lt.sent,Lt.abrupt("return",Sc(z).call(z,function(lr,pr){return lr[pr.channelId]=pr,lr},{}));case 8:case"end":return Lt.stop()}},O,this)}))},x.messageSearchByPage=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return pr.next=2,this.core.sendCmd("qchatMessageSearchByPage",{qchatMessageSearchByPageTag:Tn(Tn({},(Sr=F,Gl(qy,Sr))),{includeSelf:F.includeSelf?1:""})});case 2:return oe=pr.sent,xe=oe.content,z=xe.datas,qe=xe.listQueryTag,pr.next=6,Fh(z,{},this.core);case 6:return Lt=pr.sent,pr.abrupt("return",{listQueryTag:{hasMore:+qe.hasMore==1,nextTimetag:qe.nextTimetag?Lo(qe.nextTimetag):0,cursor:qe.cursor},datas:Lt});case 8:case"end":return pr.stop()}var Sr},O,this)}))},x.onMsg=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:if(oe=F.content.qchatMsg){qe.next=4;break}return this.logger.warn("No qchatMsg in qchatMsg packet"),qe.abrupt("return");case 4:return qe.next=6,_s(oe,{},this.core);case 6:xe=qe.sent,this.core.eventBus.emit("qchatChannel/changeUnread",xe,!1),this.core.emit("message",xe);case 9:case"end":return qe.stop()}},O,this)}))},x.onRecvUnreadInfo=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:if(oe=F.content.qchatMsg){qe.next=3;break}return qe.abrupt("return");case 3:return qe.next=5,_s(oe);case 5:xe=qe.sent,this.core.eventBus.emit("qchatChannel/changeUnread",xe,!1);case 7:case"end":return qe.stop()}},O,this)}))},x.onMultiSyncRead=function(F){var O=F.content.unreadInfo;if(O){var oe=kh(O);this.core.eventBus.emit("qchatChannel/updateUnreads",[oe])}},x.onMultiSyncServersRead=function(F){var O=F.content.qchatMultiSyncServersMessageReadTag;if(O){var oe=vl(O),xe=oe.successServerIds,z=oe.ackTimestamp;this.core.eventBus.emit("qchatChannel/clearUnreadCountByServers",xe,z)}},x.onRecvMsgUpdate=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:if(oe=F.content.qchatMsg,xe=F.content.qchatMsgUpdateInfo,oe){lr.next=4;break}return lr.abrupt("return");case 4:return lr.next=6,_s(oe,{},this.core);case 6:z=lr.sent,qe=Dy(xe),this.core.eventBus.emit("qchatChannel/changeUnread",z,!0),this.core.emit("messageUpdate",z,qe);case 10:case"end":return lr.stop()}},O,this)}))},S}(),mC=function(){function S(D){var F=this;this._sendTypingEvent=Ah(function(O){return Mr(F,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.core.sendCmd("qchatSendCustomSysMsg",{sysMsg:Rh(Tn(Tn({},O),{resendFlag:!1,persistEnable:!1,routeEnable:!1,pushEnable:!1,needBadge:!1,needPushNick:!1}),Xo.msgTyping)});case 2:case"end":return z.stop()}},oe,this)}))},3e3),this.core=D,this.logger=D.logger,this.lastChannelIdInTyping=""}var x=S.prototype;return x.getMessageHistoryByIds=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return qe.next=2,this.core.sendCmd("qchatGetMessageHistoryByIds",{channelInfo:{serverId:F.serverId,channelId:F.channelId},messageReferList:F.messageReferList});case 2:return xe=qe.sent,qe.abrupt("return",co.all(vo(oe=xe.content.qchatMsgs).call(oe,function(Lt){return _s(Lt)})));case 4:case"end":return qe.stop()}},O,this)}))},x.getReferMessages=function(F){var O,oe;return Mr(this,void 0,void 0,ar.mark(function xe(){var z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:if(!((O=F.message.replyRefer)===null||O===void 0)&&O.msgIdServer&&(!((oe=F.message.threadRefer)===null||oe===void 0)&&oe.msgIdServer)){Lt.next=2;break}throw new Error("Message has no reply");case 2:return Lt.next=4,this.getMessageHistoryByIds({serverId:F.message.serverId,channelId:F.message.channelId,messageReferList:[F.message.replyRefer,F.message.threadRefer]});case 4:if(z=Lt.sent,F.referType!==lc[lc.all]){Lt.next=9;break}return Lt.abrupt("return",{replyMessage:z[0],threadMessage:z[1]});case 9:if(F.referType!==lc[lc.reply]){Lt.next=13;break}return Lt.abrupt("return",{replyMessage:z[0]});case 13:if(F.referType!==lc[lc.thread]){Lt.next=15;break}return Lt.abrupt("return",{threadMessage:z[1]});case 15:return Lt.abrupt("return",{replyMessage:z[0],threadMessage:z[1]});case 16:case"end":return Lt.stop()}},xe,this)}))},x.getThreadMessages=function(F){var O;return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt,lr;return ar.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:return z=!((O=F.message.threadRefer)===null||O===void 0)&&O.msgIdServer?Tn({serverId:F.message.serverId,channelId:F.message.channelId},F.message.threadRefer):F.message,Sr.next=3,this.core.sendCmd("qchatGetThreadMessages",{qchatMsg:z,getThreadHistoryMsgTag:Tn(Tn({},F.messageQueryOption),{reverse:Ch.boolean(F.messageQueryOption,"reverse")})});case 3:return qe=Sr.sent,Sr.next=6,_s(qe.content.thread);case 6:return Lt=Sr.sent,Sr.next=9,co.all(vo(xe=qe.content.qchatMsgs).call(xe,function(br){return _s(br)}));case 9:return lr=Sr.sent,Sr.abrupt("return",{thread:Lt,threadInfo:{messageCount:+qe.content.threadInfo.messageCount,lastMessageTimestamp:+qe.content.threadInfo.lastMessageTimestamp},messages:lr});case 11:case"end":return Sr.stop()}},oe,this)}))},x.getThreadRootMessagesMeta=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z,qe;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return oe=F.threadRootMessages,xe=xl(F,["threadRootMessages"]),lr.next=3,this.core.sendCmd("qchatGetThreadRootMessagesMeta",{qchatMsgs:oe,tag:xe});case 3:if(z=lr.sent,!((qe=z.content.metas)&&qe.length>0)){lr.next=7;break}return lr.abrupt("return",vo(qe).call(qe,function(pr){return Tn(Tn({},pr),{total:Lo(pr.total),timestamp:Lo(pr.timestamp),msgTime:Lo(pr.msgTime)})}));case 7:return lr.abrupt("return",[]);case 8:case"end":return lr.stop()}},O,this)}))},x.getQuickComments=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){var oe,xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Lt.next=2,this.core.sendCmd("qchatGetQuickComments",{tag:{serverId:F.serverId,channelId:F.channelId,msgIdServerList:mo(vo(oe=F.msgList).call(oe,function(lr){return lr.msgIdServer}))}});case 2:return xe=Lt.sent,z=xe.content.quickCommentResponse,Lt.abrupt("return",cC(z));case 5:case"end":return Lt.stop()}},O,this)}))},x.updateQuickComment=function(F,O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt,lr,pr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return Gr({type:{type:"number"},commentMessage:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1}}}},F),xe=F.commentMessage,z=xe.serverId,qe=xe.channelId,Lt=xe.fromAccount,lr=xe.msgIdServer,pr=xe.time,br.next=4,this.core.sendCmd("qchatUpdateQuickComment",{tag:{serverId:z,channelId:qe,fromAccount:Lt,msgIdServer:lr,time:pr,type:F.type,opeType:O,opeAccid:this.core.account}});case 4:case"end":return br.stop()}},oe,this)}))},x.sendTypingEvent=function(F){return Mr(this,void 0,void 0,ar.mark(function O(){return ar.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:if(F.channelId!==this.lastChannelIdInTyping){xe.next=4;break}return this.logger.log("qchatMsg sendTypingEvent throttle"),this._sendTypingEvent(F),xe.abrupt("return");case 4:this.lastChannelIdInTyping=F.channelId,this._sendTypingEvent.flush(),this._sendTypingEvent(F);case 7:case"end":return xe.stop()}},O,this)}))},S}(),Vy=function(S){function x(F){var O;return(O=S.call(this,"qchatMsg",F)||this).core=F,O.lastChannelIdInMark="",Ei({cmdMap:Nh,cmdConfig:sC}),O.notificationModuleService=new pC(F),O.messageModuleService=new fC(F),O.extendModuleService=new mC(F),O}Ro(x,S);var D=x.prototype;return D.sendMessage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(Ld)},ext:{type:"string",required:!1},mentionAll:{type:"boolean",required:!1},mentionAccids:{type:"array",itemType:"string",required:!1},mentionRoleIds:{type:"array",itemType:"string",required:!1,min:1},historyEnable:{type:"boolean",required:!1},pushEnable:{type:"boolean",required:!1}},O),z.next=3,this.messageModuleService.sendMessage(O);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},D.updateMessage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(Gr({message:{type:"object",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number",min:0},body:{type:"string",required:!1},ext:{type:"string",required:!1}}}},O),!(typeof O.message.status=="number"&&O.message.status<1e4)){z.next=3;break}throw new yo("Status should be greater than or equal to 10000");case 3:return z.next=5,this.messageModuleService.doUpdateMessage(O);case 5:return z.abrupt("return",z.sent);case 6:case"end":return z.stop()}},oe,this)}))},D.resendMessage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdClient:{type:"string",allowEmpty:!1}},O),z.next=3,this.messageModuleService.resendMessage(O);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},D.deleteMessage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({message:{type:"object",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number",min:0}}}},O),(xe=JSON.parse(mo(O))).message.status=2,qe.next=5,this.messageModuleService.doUpdateMessage(xe);case 5:return qe.abrupt("return",qe.sent);case 6:case"end":return qe.stop()}},oe,this)}))},D.revokeMessage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({message:{type:"object",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number",min:0}}}},O),(xe=JSON.parse(mo(O))).message=Xp(xe.message,["serverId","channelId","msgIdServer","time"]),xe.message.status=1,qe.next=6,this.messageModuleService.doUpdateMessage(xe);case 6:return qe.abrupt("return",qe.sent);case 7:case"end":return qe.stop()}},oe,this)}))},D.markMessageRead=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:Gr({serverId:{type:"string"},channelId:{type:"string"},time:{type:"number",min:0}},O),O.channelId!==this.lastChannelIdInMark&&this.messageModuleService.markMessageRead.flush(),this.lastChannelIdInMark=O.channelId,this.messageModuleService.markMessageRead(O);case 4:case"end":return z.stop()}},oe,this)}))},D.replyMessage=function(O){Gr({replyMessage:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1}}}},O);var oe=O.replyMessage;if(O.serverId!==oe.serverId||O.channelId!==oe.channelId)throw new yo("Forbid replying to message from other server, channel");return this.sendMessage(O)},D.getMessageHistoryByIds=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},messageReferList:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}}},O),z.next=3,this.extendModuleService.getMessageHistoryByIds(O);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},D.getReferMessages=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({message:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}},referType:{type:"enum",values:ia(lc),required:!1}},O),z.next=3,this.extendModuleService.getReferMessages(O);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},D.getThreadMessages=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({message:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}},messageQueryOption:{type:"object",rules:{beginTime:{type:"number",required:!1},endTime:{type:"number",required:!1},excludeMsgId:{type:"string",required:!1},limit:{type:"number",required:!1},reverse:{type:"boolean",required:!1}}}},O),z.next=3,this.extendModuleService.getThreadMessages(O);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},D.getThreadRootMessagesMeta=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},threadRootMessages:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}}},O),z.next=3,this.extendModuleService.getThreadRootMessagesMeta(O);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},D.sendSystemNotification=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},attach:{type:"object",required:!1}},O),z.next=3,this.notificationModuleService.sendSystemNotification(O);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},D.updateSystemNotification=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({systemNotification:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1},type:{type:"enum",values:ia(Xo)},body:{type:"string",required:!1},ext:{type:"string",required:!1},status:{type:"number",required:!1}}}},O),z.next=3,this.notificationModuleService.updateSystemNotification(O);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},D.markSystemNotificationsRead=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({systemNotifications:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1},type:{type:"string",allowEmpty:!1}},min:1}},O),z.next=3,this.notificationModuleService.markSystemNotificationsRead(O);case 3:case"end":return z.stop()}},oe,this)}))},D.getHistoryMessage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},beginTime:{type:"number",min:0,required:!1},endTime:{type:"number",min:0,required:!1},excludeMsgId:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,required:!1},reverse:{type:"boolean",required:!1}},O),z.next=3,this.messageModuleService.getHistoryMessage(O);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},D.getMentionedMeMessages=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},timestamp:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1}},O),z.next=3,this.messageModuleService.getMentionedMeMessages(O);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},D.areMentionedMeMessages=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:if(Gr({messages:{type:"array",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1}},min:1}},O),Al(xe=O.messages).call(xe,function(Lt){return O.messages[0].serverId===Lt.serverId})){qe.next=4;break}throw new yo("Different serverId",O,10414);case 4:if(!this.core.qchatChannel.subscribeForVisitorService.isInAutoServers(O.messages[0].serverId)){qe.next=7;break}throw new yo("Not allowed for visitor",O,10403);case 7:return qe.next=9,this.messageModuleService.areMentionedMeMessages(O.messages);case 9:return qe.abrupt("return",qe.sent);case 10:case"end":return qe.stop()}},oe,this)}))},D.addQuickComment=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.extendModuleService.updateQuickComment(O,1);case 2:case"end":return z.stop()}},oe,this)}))},D.removeQuickComment=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,this.extendModuleService.updateQuickComment(O,2);case 2:case"end":return z.stop()}},oe,this)}))},D.getQuickComments=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgList:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1}},min:1}},O),z.next=3,this.extendModuleService.getQuickComments(O);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},D.sendTypingEvent=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},O),z.next=3,this.extendModuleService.sendTypingEvent(O);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},D.getLastMessageOfChannels=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelIdList:{type:"array",itemType:"string"}},O),z.next=3,this.messageModuleService.getLastMessageOfChannels(O);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},D.qchatOnMsgHandler=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:this.messageModuleService.onMsg(O);case 1:case"end":return z.stop()}},oe,this)}))},D.qchatOnRecvUnreadInfoHandler=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:this.messageModuleService.onRecvUnreadInfo(O);case 1:case"end":return z.stop()}},oe,this)}))},D.qchatOnSysMsgHandler=function(O){this.notificationModuleService.onSysMsg(O)},D.qchatMultiSyncMessageReadHandler=function(O){this.messageModuleService.onMultiSyncRead(O)},D.qchatMultiSyncSystemNotificationUpdateHandler=function(O){this.notificationModuleService.onMultiSysMsg(O)},D.qchatSyncSystemNotificationHandler=function(O){this.notificationModuleService.onSyncSysMsg(O)},D.qchatRecvMessageUpdateHandler=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:this.messageModuleService.onRecvMsgUpdate(O);case 1:case"end":return z.stop()}},oe,this)}))},D.searchMsgByPage=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({keyword:{type:"string",allowEmpty:!1,required:!1},serverId:{type:"string",allowEmpty:!1,required:!0},channelId:{type:"string",allowEmpty:!1,required:!1},fromAccid:{type:"string",allowEmpty:!1,required:!1},fromTime:{type:"number",allowEmpty:!1,required:!1},toTime:{type:"number",allowEmpty:!1,required:!1},msgTypes:{type:"array",itemType:"string",allowEmpty:!1,required:!0},subTypes:{type:"array",itemType:"string",allowEmpty:!1,required:!1},includeSelf:{type:"boolean",allowEmpty:!1,required:!1},order:{type:"enum",values:ia(Ic),required:!1},limit:{type:"number",min:0,required:!1},sort:{type:"enum",values:ia(Qp),required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},O),z.next=3,this.messageModuleService.messageSearchByPage(O);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},oe,this)}))},D.qchatMultiSyncServersMessageReadHandler=function(O){this.messageModuleService.onMultiSyncServersRead(O)},x}(gl);function $h(S,x){x===void 0&&(x=1);var D=ya({clientPort:{type:"number"},clientType:{type:"enum",values:dc},customClientType:{type:"number"},loginTime:{type:"number"},hasTokenPreviously:{type:"boolean"},pushType:{type:"number"}},S);return Tn(Tn({},D),{account:D.account,connectionId:D.connectionId,deviceId:D.deviceId,ip:D.ip,mac:D.ip,os:D.os,clientType:D.clientType,time:D.time,online:x!==2})}var Hy={1:{reason:"samePlatformKick",message:"The same account is not allowed to multiple login at the same time"},2:{reason:"serverKick",message:"Kicked out by IM server"},3:{reason:"otherPlatformKick",message:"Kicked out by other client of your account"},4:{reason:"silentlyKick",message:"Quietly kicked"}},jh,ws,ba={BROWSER:0,RN:2,UNIAPP:3,WECHAT:6},gC=function(S){function x(F){var O;return(O=S.call(this,"qchatAuth",F)||this).syncTimeTag=0,O}Ro(x,S);var D=x.prototype;return D.doLogin=function(O){var oe;return O===void 0&&(O=!1),Mr(this,void 0,void 0,ar.mark(function xe(){var z,qe,Lt,lr,pr,Sr,br;return ar.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:return z=this.core.options,qe=ta.getSystemInfo(),Lt=Tn(Tn({},z),{appLogin:O?0:1,clientType:16,clientSession:(oe=this.core.socket)===null||oe===void 0?void 0:oe.sessionId,deviceId:this.core.config.deviceId,sdkVersion:91001,sdkType:ba[ta.platform]||0,userAgent:"Native/0.13.1",sdkHumanVersion:"0.13.1",os:qe.os,browser:qe.browser}),Dr.next=5,this.core.sendCmd("qchatLogin",{qchatLoginReqTag:Lt});case 5:if(!(lr=Dr.sent).error){Dr.next=8;break}throw lr.error;case 8:return pr=lr.content,Sr=pr.qchatLoginResTag,br=pr.qchatMultiLoginResult,Sr.isAutoReconnect=O,Dr.abrupt("return",{loginResult:$h(Sr),multiLoginResults:vo(br).call(br,function($r){return $h($r)})});case 11:case"end":return Dr.stop()}},xe,this)}))},D.kick=function(O){var oe;return Mr(this,void 0,void 0,ar.mark(function xe(){var z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Lt.next=2,this.core.sendCmd("qchatKick",O);case 2:return z=Lt.sent,Lt.abrupt("return",(oe=z.content)===null||oe===void 0?void 0:oe.deviceIds);case 4:case"end":return Lt.stop()}},xe,this)}))},D.sync=function(){return Mr(this,void 0,void 0,ar.mark(function O(){return ar.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return xe.next=2,this.core.sendCmd("qchatSync",{qchatSyncTag:{systemNotification:this.syncTimeTag||0}});case 2:case"end":return xe.stop()}},O,this)}))},D.qchatSyncHandler=function(O){var oe,xe;this.logger.log("sync: emit syncdone",(oe=O.content)===null||oe===void 0?void 0:oe.timetag),this.core.emit("syncdone"),this.syncTimeTag=((xe=O.content)===null||xe===void 0?void 0:xe.timetag)||0},D.qchatMultiSpotLoginHandler=function(O){if(O.error)this.logger.error("qchatMultiPortLoginHandler:: error, ",O.error);else{var oe=O.content,xe=$h(oe.qchatLoginResTag,oe.state);this.core.emit("multiSpotLogin",[xe])}},D.qchatBeKickedHandler=function(O){if(O.error)this.logger.error("qchatBeKickedHandler error, ",O.error);else{var oe=function(z){var qe=ya({clientType:{type:"enum",values:dc},customClientType:{type:"number"}},z),Lt=Hy[qe.reason];return Tn(qe,Lt=Lt||{reason:"unknow",message:"Unknown reason"})}(O.content.beKickedTag);this.logger.warn("bekicked::",oe),this.core.doDisconnect(ls.KICKED,oe)}},x}(gl);(function(S){S.UNKNOWN="UNKNOWN",S.LOGIN_STATE_ERROR="LOGIN_STATE_ERROR",S.CLOSE_BY_BACKEND="CLOSE_BY_BACKEND",S.ALL_MEMBERS_OUT="ALL_MEMBERS_OUT",S.END_OF_LIFE="END_OF_LIFE",S.CLOSE_BY_MEMBER="CLOSE_BY_MEMBER",S.KICK_OUT="KICK_OUT",S.SYNC_DATA_ERROR="SYNC_DATA_ERROR",S.LEAVE_BY_SELF="LEAVE_BY_SELF",S.kICK_BY_SELF="kICK_BY_SELF"})(jh||(jh={})),function(S){S.offNotAllowSelfOn="offNotAllowSelfOn",S.offAllowSelfOn="offAllowSelfOn",S.disable="disable"}(ws||(ws={}));var Nc={serverId:{type:"string"},uid:{type:"string"},accid:{type:"string"},nick:{type:"string"},avatar:{type:"string"},ext:{type:"string"},type:{type:"number"},joinTime:{type:"number"},inviter:{type:"string"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"}},pc={limit:{type:"number"}};function fc(S){return ns(S)&&S.length>0?vo(S).call(S,function(x){return function(F){return ya(Nc,F)}(x)}):[]}function hC(S){try{S.audio&&(S.audio=JSON.parse(S.audio))}catch{throw new al('result "audio" JSON parse error',{key:"audio"},"JSON parse error")}try{S.video&&(S.video=JSON.parse(S.video))}catch{throw new al('result "video" JSON parse error',{key:"video"},"JSON parse error")}return ya(pc,S)}var Ud={"25_1":"qchatGetNeroomToken","25_2":"qchatUpdateRTCChannelConfig","25_3":"qchatGetRTCChannelConfig","25_4":"qchatGetRTCChannelMembers"},qd={QChatRTCChannelConfigTag:{serverId:1,channelId:2,limit:3,audio:4,video:5},QChatRTCChannelConfigResultTag:{limit:1,audio:2,video:3},QChatGetRTCParams:{serverId:1,channelId:2},qchatGetRTCChannelMembersTag:{serverId:1,channelId:2},memberInfo:{serverId:1,accid:3,nick:4,avatar:5,ext:6,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},QChatGetNeroomTokenResultTag:{token:1,expire:2},QChatGetNeroomTokenParams:{neroomDeviceId:1}},tf=Cc(qd),Vd={qchatGetNeroomToken:{sid:25,cid:1,service:"qchatMedia",params:[{type:"Property",name:"qchatGetNeroomTokenTag",reflectMapper:qd.QChatGetNeroomTokenParams}],response:[{type:"Property",name:"neroomToken",reflectMapper:tf.QChatGetNeroomTokenResultTag}]},qchatUpdateRTCChannelConfig:{sid:25,cid:2,service:"qchatMedia",params:[{type:"Property",name:"RTCChannelConfig",reflectMapper:qd.QChatRTCChannelConfigTag}]},qchatGetRTCChannelConfig:{sid:25,cid:3,service:"qchatMedia",params:[{type:"Property",name:"qchatGetRTCChannelConfigTag",reflectMapper:qd.QChatGetRTCParams}],response:[{type:"Property",name:"RTCChannelConfig",reflectMapper:tf.QChatRTCChannelConfigResultTag}]},qchatGetRTCChannelMembers:{sid:25,cid:4,service:"qchatMedia",params:[{type:"Property",name:"qchatGetRTCChannelMembersTag",reflectMapper:qd.QChatGetRTCParams}],response:[{type:"PropertyArray",name:"memberList",reflectMapper:tf.memberInfo}]}},vC=function(S){function x(F){var O;return(O=S.call(this,"qchatMedia",F)||this).tokenExpireTime=24e4,O.getTokenState=!1,O.core=F,Ei({cmdMap:Ud,cmdConfig:Vd}),O.core.on("disconnect",function(){return Mr(i(O),void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(!this.roomContext){z.next=3;break}return z.next=3,this.disconnectChannel();case 3:this.tokenTimer&&(this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0);case 4:case"end":return z.stop()}},oe,this)}))}),O.core.on("kicked",function(){return Mr(i(O),void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(!this.roomContext){z.next=3;break}return z.next=3,this.disconnectChannel();case 3:this.tokenTimer&&(this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0);case 4:case"end":return z.stop()}},oe,this)}))}),O.core.eventBus.on("qchatMedia/serverOrChannelLeave",function(oe){return Mr(i(O),void 0,void 0,ar.mark(function xe(){return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:if(!(oe.type===Xo[Xo.channelVisibilityUpdate]&&oe.channelId===this.channelId||oe.type===Xo[Xo.serverEnterLeave]&&oe.serverId===this.serverId)){qe.next=4;break}if(!this.roomContext||!this.roomContext.roomUuid){qe.next=4;break}return qe.next=4,this.disconnectChannel();case 4:case"end":return qe.stop()}},xe,this)}))}),O.tokenExpireTime=24e4,O.channelId="",O.serverId="",O}Ro(x,S);var D=x.prototype;return D.setNeroom=function(O){this.neroom=new O},D._checkPermission=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return qe.next=2,this.core.qchatRole.checkPermission(O);case 2:return xe=qe.sent,qe.abrupt("return",xe);case 4:case"end":return qe.stop()}},oe,this)}))},D._checkConnectState=function(){if(this.state!=="connect")throw new yo("QChatMedia::you should connect first")},D.kickMemberOut=function(O){var oe;return Mr(this,void 0,void 0,ar.mark(function xe(){return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return this._checkConnectState(),Gr({accid:{type:"string",allowEmpty:!1}},O),qe.prev=2,qe.next=5,(oe=this.roomContext)===null||oe===void 0?void 0:oe.kickMemberOut(O.accid);case 5:qe.next=11;break;case 7:throw qe.prev=7,qe.t0=qe.catch(2),this.logger.error("QChatMedia::kickMemberOut error params is "+mo(O),qe.t0),new yo("QChatMedia::kickMemberOut error",qe.t0);case 11:case"end":return qe.stop()}},xe,this,[[2,7]])}))},D.disconnectChannel=function(){var O;return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this._checkConnectState(),this.logger.debug("QChatMedia::disconnect begin disconnect"),z.prev=2,z.next=5,(O=this.roomContext)===null||O===void 0?void 0:O.leaveRoom();case 5:z.next=10;break;case 7:z.prev=7,z.t0=z.catch(2),this.logger.error("QChatMedia::disconnect error",z.t0);case 10:if(!this.authService){z.next=13;break}return z.next=13,this.authService.logout();case 13:this._setStateInit(),this.core.emit("qchatMediaDisconnect");case 15:case"end":return z.stop()}},oe,this,[[2,7]])}))},D._setStateInit=function(){this.logger.debug("QChatMedia::disconnect end"),this.roomContext=void 0,this.rtcController=void 0,this.state="init",this.tokenTimer&&(this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0),this.channelId="",this.serverId=""},D.muteAudio=function(O){var oe,xe,z,qe,Lt;return Mr(this,void 0,void 0,ar.mark(function lr(){var pr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(this._checkConnectState(),Gr({accid:{type:"string",allowEmpty:!1}},O),((oe=this.roomContext)===null||oe===void 0?void 0:oe.localMember.uuid)!==O.accid){br.next=14;break}return br.prev=3,br.next=6,(xe=this.rtcController)===null||xe===void 0?void 0:xe.muteMyAudio();case 6:br.next=12;break;case 8:throw br.prev=8,br.t0=br.catch(3),this.logger.error("QChatMedia::muteAudio error",br.t0),new yo("QChatMedia::muteAudio error",br.t0);case 12:case 25:br.next=31;break;case 14:if(br.prev=14,!(pr=(z=this.roomContext)===null||z===void 0?void 0:z.roomProperties.audioOff)||((qe=pr.value)===null||qe===void 0?void 0:qe.split("_")[0])!==ws.offNotAllowSelfOn){br.next=23;break}return br.next=19,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 19:if(br.sent){br.next=23;break}return this.logger.error("QChatMedia::unMuteAudio not allow open auido"),br.abrupt("return");case 23:return br.next=25,(Lt=this.rtcController)===null||Lt===void 0?void 0:Lt.muteMemberAudio(O.accid);case 27:throw br.prev=27,br.t1=br.catch(14),this.logger.error("QChatMedia::muteAudio error params is "+mo(O),br.t1),new yo("QChatMedia::muteAudio error",br.t1);case 31:case"end":return br.stop()}},lr,this,[[3,8],[14,27]])}))},D.unMuteAudio=function(O){var oe,xe,z,qe,Lt;return Mr(this,void 0,void 0,ar.mark(function lr(){var pr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(this._checkConnectState(),Gr({accid:{type:"string",allowEmpty:!1}},O),!(pr=(oe=this.roomContext)===null||oe===void 0?void 0:oe.roomProperties.audioOff)||((xe=pr.value)===null||xe===void 0?void 0:xe.split("_")[0])!==ws.offNotAllowSelfOn){br.next=10;break}return br.next=6,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 6:if(br.sent){br.next=10;break}return this.logger.error("QChatMedia::unMuteAudio not allow open auido"),br.abrupt("return");case 10:if(((z=this.roomContext)===null||z===void 0?void 0:z.localMember.uuid)!==O.accid){br.next=22;break}return br.prev=11,br.next=14,(qe=this.rtcController)===null||qe===void 0?void 0:qe.unmuteMyAudio();case 14:br.next=20;break;case 16:throw br.prev=16,br.t0=br.catch(11),this.logger.error("QChatMedia::unMuteAudio error",br.t0),new yo("QChatMedia::unMuteAudio error",br.t0);case 20:case 25:br.next=31;break;case 22:return br.prev=22,br.next=25,(Lt=this.rtcController)===null||Lt===void 0?void 0:Lt.unmuteMemberAudio(O.accid);case 27:throw br.prev=27,br.t1=br.catch(22),this.logger.error("QChatMedia::unMuteAudio error params is "+mo(O),br.t1),new yo("QChatMedia::unMuteAudio error",br.t1);case 31:case"end":return br.stop()}},lr,this,[[11,16],[22,27]])}))},D.muteVideo=function(O){var oe,xe,z,qe,Lt;return Mr(this,void 0,void 0,ar.mark(function lr(){var pr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(this._checkConnectState(),Gr({accid:{type:"string",allowEmpty:!1}},O),((oe=this.roomContext)===null||oe===void 0?void 0:oe.localMember.uuid)!==O.accid){br.next=14;break}return br.prev=3,br.next=6,(xe=this.rtcController)===null||xe===void 0?void 0:xe.muteMyVideo();case 6:br.next=12;break;case 8:throw br.prev=8,br.t0=br.catch(3),this.logger.error("QChatMedia::muteVideo error",br.t0),new yo("QChatMedia::muteVideo error",br.t0);case 12:case 25:br.next=31;break;case 14:if(br.prev=14,!(pr=(z=this.roomContext)===null||z===void 0?void 0:z.roomProperties.videoOff)||((qe=pr.value)===null||qe===void 0?void 0:qe.split("_")[0])!==ws.offNotAllowSelfOn){br.next=23;break}return br.next=19,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 19:if(br.sent){br.next=23;break}return this.logger.error("QChatMedia::unMuteVideo not allow open video"),br.abrupt("return");case 23:return br.next=25,(Lt=this.rtcController)===null||Lt===void 0?void 0:Lt.muteMemberVideo(O.accid);case 27:throw br.prev=27,br.t1=br.catch(14),this.logger.error("QChatMedia::muteVideo error params is "+mo(O),br.t1),new yo("QChatMedia::muteVideo error",br.t1);case 31:case"end":return br.stop()}},lr,this,[[3,8],[14,27]])}))},D.unMuteVideo=function(O){var oe,xe,z,qe,Lt;return Mr(this,void 0,void 0,ar.mark(function lr(){var pr;return ar.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(this._checkConnectState(),Gr({accid:{type:"string",allowEmpty:!1}},O),!(pr=(oe=this.roomContext)===null||oe===void 0?void 0:oe.roomProperties.videoOff)||((xe=pr.value)===null||xe===void 0?void 0:xe.split("_")[0])!==ws.offNotAllowSelfOn){br.next=10;break}return br.next=6,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 6:if(br.sent){br.next=10;break}return this.logger.error("QChatMedia::unMuteVideo not allow open video"),br.abrupt("return");case 10:if(((z=this.roomContext)===null||z===void 0?void 0:z.localMember.uuid)!==O.accid){br.next=22;break}return br.prev=11,br.next=14,(qe=this.rtcController)===null||qe===void 0?void 0:qe.unmuteMyVideo();case 14:br.next=20;break;case 16:throw br.prev=16,br.t0=br.catch(11),this.logger.error("QChatMedia::unMuteVideo error",br.t0),new yo("QChatMedia::unMuteVideo error",br.t0);case 20:br.next=30;break;case 22:br.prev=22,(Lt=this.rtcController)===null||Lt===void 0||Lt.unmuteMemberVideo(O.accid),br.next=30;break;case 26:throw br.prev=26,br.t1=br.catch(22),this.logger.error("QChatMedia::unMuteVideo error",br.t1),new yo("QChatMedia::unMuteVideo error",br.t1);case 30:case"end":return br.stop()}},lr,this,[[11,16],[22,26]])}))},D.startScreenShare=function(){var O;return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:this._checkConnectState(),z.prev=1,(O=this.rtcController)===null||O===void 0||O.startScreenShare(),z.next=9;break;case 5:throw z.prev=5,z.t0=z.catch(1),this.logger.error("QChatMedia::startScreenShare error",z.t0),new yo("QChatMedia::startScreenShare error",z.t0);case 9:case"end":return z.stop()}},oe,this,[[1,5]])}))},D.stopScreenShare=function(){var O;return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:this._checkConnectState(),z.prev=1,(O=this.rtcController)===null||O===void 0||O.stopScreenShare(),z.next=9;break;case 5:throw z.prev=5,z.t0=z.catch(1),this.logger.error("QChatMedia::stopScreenShare error",z.t0),new yo("QChatMedia::stopScreenShare error",z.t0);case 9:case"end":return z.stop()}},oe,this,[[1,5]])}))},D.stopMemberScreenShare=function(O){var oe;return Mr(this,void 0,void 0,ar.mark(function xe(){return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:this._checkConnectState(),Gr({accid:{type:"string",allowEmpty:!1}},O),qe.prev=2,(oe=this.rtcController)===null||oe===void 0||oe.stopMemberScreenShare(O.accid),qe.next=10;break;case 6:throw qe.prev=6,qe.t0=qe.catch(2),this.logger.error("QChatMedia::stopMemberScreenShare error",qe.t0),new yo("QChatMedia::stopMemberScreenShare error",qe.t0);case 10:case"end":return qe.stop()}},xe,this,[[2,6]])}))},D.subscribeRemoteVideoStream=function(O){var oe;return Mr(this,void 0,void 0,ar.mark(function xe(){return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:this._checkConnectState(),Gr({accid:{type:"string",allowEmpty:!1},streamType:{type:"number",allowEmpty:!1,min:0,max:1}},O),qe.prev=2,(oe=this.rtcController)===null||oe===void 0||oe.subscribeRemoteVideoStream(O.accid,O.streamType),qe.next=10;break;case 6:throw qe.prev=6,qe.t0=qe.catch(2),this.logger.error("QChatMedia::subscribeRemoteVideoStream error",qe.t0),new yo("QChatMedia::subscribeRemoteVideoStream error",qe.t0);case 10:case"end":return qe.stop()}},xe,this,[[2,6]])}))},D.unSubscribeRemoteVideoStream=function(O){var oe;return Mr(this,void 0,void 0,ar.mark(function xe(){return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:this._checkConnectState(),Gr({accid:{type:"string",allowEmpty:!1},streamType:{type:"number",allowEmpty:!1,min:0,max:1}},O),qe.prev=2,(oe=this.rtcController)===null||oe===void 0||oe.unsubscribeRemoteVideoStream(O.accid,O.streamType),qe.next=10;break;case 6:throw qe.prev=6,qe.t0=qe.catch(2),this.logger.error("QChatMedia::unSubscribeRemoteVideoStream error",qe.t0),new yo("QChatMedia::unSubscribeRemoteVideoStream error",qe.t0);case 10:case"end":return qe.stop()}},xe,this,[[2,6]])}))},D.setupVideoCanvas=function(O){var oe;if(this._checkConnectState(),((oe=this.roomContext)===null||oe===void 0?void 0:oe.localMember.uuid)===O.accid)try{return this.rtcController.setupLocalVideoCanvas(O.videoView)}catch(xe){throw this.logger.error("QChatMedia::setupVideoCanvas error",xe),new yo("QChatMedia::setupVideoCanvas error",xe)}else try{return this.rtcController.setupRemoteVideoCanvas(O.videoView,O.accid)}catch(xe){throw this.logger.error("QChatMedia::setupVideoCanvas error",xe),new yo("QChatMedia::setupVideoCanvas error",xe)}},D.setupRemoteVideoSubStreamCanvas=function(O){this._checkConnectState(),Gr({accid:{type:"string",allowEmpty:!1}},O);try{return this.rtcController.setupRemoteVideoSubStreamCanvas(O.videoView,O.accid)}catch(oe){throw this.logger.error("QChatMedia::setupRemoteVideoSubStreamCanvas error",oe),new yo("QChatMedia::setupRemoteVideoSubStreamCanvas error",oe)}},D.getScreenSharingUserUuid=function(){this._checkConnectState();try{return this.rtcController.getScreenSharingUserUuid()}catch(O){throw this.logger.error("QChatMedia::getScreenSharingUserUuid error",O),new yo("QChatMedia::getScreenSharingUserUuid error",O)}},D.initQChatMedia=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(this.neroom){z.next=3;break}return this.logger.warn("QChatMedia::init::you should import neroom SDK"),z.abrupt("return");case 3:if(this.state===void 0){z.next=6;break}return this.logger.error("QChatMedia::init::you already init QChatMedia"),z.abrupt("return");case 6:z.prev=6,this.neroom.initialize({appKey:this.core.options.appkey,serverConfig:O.serverConfig}),z.next=14;break;case 10:throw z.prev=10,z.t0=z.catch(6),this.logger.error("QChatMedia::initQChatMedia error",z.t0),new yo("QChatMedia::initQChatMedia error",z.t0);case 14:this.authService=this.neroom.authService,this.roomService=this.neroom.roomService,this.messageChannelService=this.neroom.messageChannelService,this.state="init";case 18:case"end":return z.stop()}},oe,this,[[6,10]])}))},D.loginByIM=function(){var O;return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z;return ar.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:if(this.state==="init"){Lt.next=3;break}return this.logger.error("QChatMedia::connect::you should init before login"),Lt.abrupt("return");case 3:return xe=this.core.options,Lt.next=6,this._getToken();case 6:return z=Lt.sent,Lt.prev=7,Lt.next=10,(O=this.authService)===null||O===void 0?void 0:O.loginByIM(xe.account,z,xe.token);case 10:Lt.next=16;break;case 12:throw Lt.prev=12,Lt.t0=Lt.catch(7),this.logger.error("QChatMedia::loginByIM error",Lt.t0),new yo("QChatMedia::loginByIM error",Lt.t0);case 16:this.state="login";case 17:case"end":return Lt.stop()}},oe,this,[[7,12]])}))},D._getToken=function(){var O;return Mr(this,void 0,void 0,ar.mark(function oe(){var xe,z,qe,Lt,lr=this;return ar.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:return this.logger.log("QChatMedia::getToken begin getToken"),Sr.next=3,this.core.sendCmd("qchatGetNeroomToken",{qchatGetNeroomTokenTag:{neroomDeviceId:(O=this.neroom)===null||O===void 0?void 0:O.deviceId}});case 3:return xe=Sr.sent,z=xe.content.neroomToken,qe=z.token,Lt=z.expire,this.logger.log("QChatMedia::getToken success token is "+qe+",expire is "+Lt+" "),this.tokenTimer||(this.logger.debug("QChatMedia::getToken set token timer,expire is "+(1e3*Lt-this.tokenExpireTime)+" "),this.tokenTimer=this.core.timerManager.addTimer(function(){return Mr(lr,void 0,void 0,ar.mark(function br(){var Er;return ar.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:return this.tokenTimer&&this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0,$r.next=4,this._getToken();case 4:Er=$r.sent,this.authService&&this.authService.renewToken(Er);case 6:case"end":return $r.stop()}},br,this)}))},1e3*Lt-this.tokenExpireTime)),Sr.abrupt("return",qe);case 8:case"end":return Sr.stop()}},oe,this)}))},D.connectChannel=function(O){var oe,xe;return Mr(this,void 0,void 0,ar.mark(function z(){var qe;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:if(this.state!==void 0){lr.next=3;break}return this.logger.error("QChatMedia::connect::you should init before login"),lr.abrupt("return");case 3:if(this.state!=="init"){lr.next=6;break}return lr.next=6,this.loginByIM();case 6:return this.serverId=O.serverId,this.channelId=O.channelId,lr.prev=8,lr.next=11,(oe=this.roomService)===null||oe===void 0?void 0:oe.joinRoom({roomUuid:O.channelId,role:"qchatAudience",userName:this.core.options.account,initialProperties:{}},{});case 11:lr.next=17;break;case 13:throw lr.prev=13,lr.t0=lr.catch(8),this.logger.error("QChatMedia::connectChannel error",lr.t0),new yo("QChatMedia::connectChannel error",lr.t0);case 17:if(!(qe=(xe=this.roomService)===null||xe===void 0?void 0:xe.getRoomContext(O.channelId))){lr.next=27;break}return this.roomContext=qe,this.rtcController=this.roomContext.rtcController,this.state="connect",lr.next=24,this.rtcController.joinRtcChannel();case 24:this.core.emit("connectChannel"),lr.next=28;break;case 27:this.logger.error("QChatMedia::connect room not exited");case 28:case"end":return lr.stop()}},z,this,[[8,13]])}))},D.updateRTCChannelInfo=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},limit:{type:"number",allowEmpty:!1}},O),z.next=3,this.core.sendCmd("qchatUpdateRTCChannelConfig",{RTCChannelConfig:Tn(Tn({},O),{audio:mo(O.audio),video:mo(O.video)})});case 3:case"end":return z.stop()}},oe,this)}))},D.getRTCChannelInfo=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1}},O),qe.next=3,this.core.sendCmd("qchatGetRTCChannelConfig",{qchatGetRTCChannelConfigTag:O});case 3:return xe=qe.sent,qe.abrupt("return",hC(xe.content.RTCChannelConfig));case 5:case"end":return qe.stop()}},oe,this)}))},D.getRTCChannelOnlineMembers=function(O){return Mr(this,void 0,void 0,ar.mark(function oe(){var xe;return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Gr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1}},O),qe.next=3,this.core.sendCmd("qchatGetRTCChannelMembers",{qchatGetRTCChannelMembersTag:O});case 3:return xe=qe.sent,qe.abrupt("return",fc(xe.content.memberList));case 5:case"end":return qe.stop()}},oe,this)}))},D.addRTCChannelListener=function(){var O,oe,xe=this;this._checkConnectState();try{(O=this.authService)===null||O===void 0||O.addAuthListener({onAuthEvent:function(qe){return Mr(xe,void 0,void 0,ar.mark(function Lt(){var lr;return ar.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:if(qe!==1026||this.getTokenState){Sr.next=10;break}return this.logger.log("QChatMedia::loginByIM token expire,begin get new token "),this.getTokenState=!0,Sr.next=5,this._getToken();case 5:if(lr=Sr.sent,!this.authService){Sr.next=9;break}return Sr.next=9,this.authService.renewToken(lr);case 9:this.getTokenState=!1;case 10:case"end":return Sr.stop()}},Lt,this)}))}})}catch(z){throw this.getTokenState=!1,this.logger.error("QChatMedia::loginByIM addAuthListener error",z),new yo("QChatMedia::loginByIM addAuthListener error",z)}(oe=this.roomContext)===null||oe===void 0||oe.addRoomListener({onRoomPropertiesChanged:function(qe){var Lt,lr,pr,Sr,br,Er;if(xe.logger.log("QChatMedia::addRTCChannelListener::onRoomPropertiesChanged",qe),qe.audioOff){var Dr=(Lt=qe.audioOff.value)===null||Lt===void 0?void 0:Lt.split("_")[0];Dr!==ws.offNotAllowSelfOn&&Dr!==ws.offAllowSelfOn||!((lr=xe.roomContext)===null||lr===void 0)&&lr.localMember.isAudioOn&&((pr=xe.rtcController)===null||pr===void 0||pr.muteMyAudio())}else if(qe.videoOff){var $r=(Sr=qe.videoOff.value)===null||Sr===void 0?void 0:Sr.split("_")[0];$r!==ws.offNotAllowSelfOn&&$r!==ws.offAllowSelfOn||!((br=xe.roomContext)===null||br===void 0)&&br.localMember.isVideoOn&&((Er=xe.rtcController)===null||Er===void 0||Er.muteMyVideo())}},onRoomPropertiesDeleted:function(qe){xe.logger.log("QChatMedia::addRTCChannelListener::onRoomPropertiesDeleted",qe)},onMemberJoinRtcChannel:function(qe){xe.logger.log("QChatMedia::addRTCChannelListener::onMemberJoinRTCChannel",qe);var Lt=vo(qe).call(qe,function(lr){return lr.uuid});xe.core.emit("memberJoinRTCChannel",Lt)},onMemberLeaveRoom:function(qe){xe.logger.log("QChatMedia::addRTCChannelListener::onMemberLeaveRoom",qe);var Lt=vo(qe).call(qe,function(lr){return lr.uuid});xe.core.emit("memberLeaveRTCChannel",Lt)},onRoomEnded:function(qe){xe.authService&&xe.authService.logout(),xe._setStateInit(),xe.logger.log("QChatMedia::addRTCChannelListener::onRoomEnded",qe),xe.core.emit("RTCChannelEnded",qe)},onRtcChannelError:function(qe){xe.logger.log("QChatMedia::addRTCChannelListener::onRtcChannelError",qe),qe==="SOCKET_ERROR"&&xe.disconnectChannel(),xe.core.emit("RTCChannelError",qe)},onRtcAudioVolumeIndication:function(qe){xe.logger.log("QChatMedia::addRTCChannelListener::onRtcAudioVolumeIndication",qe),xe.core.emit("onRtcAudioVolumeIndication",qe)},onMemberAudioMuteChanged:function(qe,Lt,lr){xe.logger.log("QChatMedia::addRTCChannelListener::onMemberAudioMuteChanged",qe,Lt),xe.core.emit("memberAudioMuteChanged",{memberAccId:qe.uuid,mute:Lt,operateByAccId:lr.uuid})},onMemberScreenShareStateChanged:function(qe,Lt,lr){xe.logger.log("QChatMedia::addRTCChannelListener::onMemberScreenShareStateChanged",qe,Lt),xe.core.emit("memberScreenShareStateChanged",{memberAccId:qe.uuid,isSharing:Lt,operateByAccId:lr.uuid})},onMemberVideoMuteChanged:function(qe,Lt,lr){xe.logger.log("QChatMedia::addRTCChannelListener::onMemberVideoMuteChanged",qe,Lt),xe.core.emit("memberVideoMuteChanged",{memberAccId:qe.uuid,mute:Lt,operateByAccId:lr.uuid})}})},D.enumCameraDevices=function(){var O=this;return this._checkConnectState(),this.rtcController.enumCameraDevices().then(function(oe){return oe.data},function(oe){throw O.logger.error("QChatMedia::enumCameraDevices error",oe),new yo("QChatMedia::enumCameraDevices error",oe)})},D.enumPlayoutDevices=function(){var O=this;return this._checkConnectState(),this.rtcController.enumPlayoutDevices().then(function(oe){return oe.data},function(oe){throw O.logger.error("QChatMedia::enumPlayoutDevices error",oe),new yo("QChatMedia::enumPlayoutDevices error",oe)})},D.enumRecordDevices=function(){var O=this;return this._checkConnectState(),this.rtcController.enumRecordDevices().then(function(oe){return oe.data},function(oe){throw O.logger.error("QChatMedia::enumRecordDevices error",oe),new yo("QChatMedia::enumRecordDevices error",oe)})},D.removeRTCChannelListener=function(){var O,oe;this._checkConnectState(),(O=this.roomContext)===null||O===void 0||O.removeRoomListener({}),(oe=this.authService)===null||oe===void 0||oe.removeAuthListener({})},D.setSelectedCameraDevice=function(O){var oe=this;return this._checkConnectState(),Gr({deviceId:{type:"string",allowEmpty:!1}},O),this.rtcController.setSelectedCameraDevice(O.deviceId).then(function(xe){return xe.data},function(xe){throw oe.logger.error("QChatMedia::setSelectedCameraDevice error",xe),new yo("QChatMedia::setSelectedCameraDevice error",xe)})},D.setSelectedPlayoutDevice=function(O){var oe=this;return this._checkConnectState(),Gr({deviceId:{type:"string",allowEmpty:!1}},O),this.rtcController.setSelectedPlayoutDevice(O.deviceId).then(function(xe){return xe.data},function(xe){throw oe.logger.error("QChatMedia::setSelectedPlayoutDevice error",xe),new yo("QChatMedia::setSelectedPlayoutDevice error",xe)})},D.setSelectedRecordDevice=function(O){var oe=this;return this._checkConnectState(),Gr({deviceId:{type:"string",allowEmpty:!1}},O),this.rtcController.setSelectedRecordDevice(O.deviceId).then(function(xe){return xe.data},function(xe){throw oe.logger.error("QChatMedia::setSelectedRecordDevice error",xe),new yo("QChatMedia::setSelectedRecordDevice error",xe)})},D.getRTCMembers=function(){var O,oe;return this._checkConnectState(),vo(O=Js(oe=this.roomContext.remoteMembers).call(oe,function(xe){return xe.isInRtcChannel})).call(O,function(xe){return{accid:xe.uuid,isAudioOn:!!xe.isAudioOn,isVideoOn:!!xe.isVideoOn,isSharingScreen:!!xe.isSharingScreen,properties:xe.properties}})},D.subscribeRemoteVideoSubStream=function(O){var oe;return Mr(this,void 0,void 0,ar.mark(function xe(){return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:this._checkConnectState(),Gr({accid:{type:"string",allowEmpty:!1}},O),qe.prev=2,(oe=this.rtcController)===null||oe===void 0||oe.subscribeRemoteVideoSubStream(O.accid),qe.next=10;break;case 6:throw qe.prev=6,qe.t0=qe.catch(2),this.logger.error("QChatMedia::subscribeRemoteVideoSubStream error",qe.t0),new yo("QChatMedia::subscribeRemoteVideoSubStream error",qe.t0);case 10:case"end":return qe.stop()}},xe,this,[[2,6]])}))},D.unsubscribeRemoteVideoSubStream=function(O){var oe;return Mr(this,void 0,void 0,ar.mark(function xe(){return ar.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:this._checkConnectState(),Gr({accid:{type:"string",allowEmpty:!1}},O),qe.prev=2,(oe=this.rtcController)===null||oe===void 0||oe.unsubscribeRemoteVideoSubStream(O.accid),qe.next=10;break;case 6:throw qe.prev=6,qe.t0=qe.catch(2),this.logger.error("QChatMedia::unsubscribeRemoteVideoSubStream error",qe.t0),new yo("QChatMedia::unsubscribeRemoteVideoSubStream error",qe.t0);case 10:case"end":return qe.stop()}},xe,this,[[2,6]])}))},D.muteAllAudio=function(){var O;return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this._checkConnectState(),z.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 3:if(z.sent){z.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneMicrophone auth"),z.abrupt("return");case 7:z.prev=7,(O=this.roomContext)===null||O===void 0||O.updateRoomProperty("audioOff",mo({value:ws.offNotAllowSelfOn+"_"+new Date().getTime()})),z.next=15;break;case 11:throw z.prev=11,z.t0=z.catch(7),this.logger.error("QChatMedia::muteAllAudio error",z.t0),new yo("QChatMedia::muteAllAudio error",z.t0);case 15:case"end":return z.stop()}},oe,this,[[7,11]])}))},D.muteAllVideo=function(){var O;return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this._checkConnectState(),z.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 3:if(z.sent){z.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneCamera auth"),z.abrupt("return");case 7:z.prev=7,(O=this.roomContext)===null||O===void 0||O.updateRoomProperty("videoOff",mo({value:ws.offNotAllowSelfOn+"_"+new Date().getTime()})),z.next=15;break;case 11:throw z.prev=11,z.t0=z.catch(7),this.logger.error("QChatMedia::muteAllVideo error",z.t0),new yo("QChatMedia::muteAllVideo error",z.t0);case 15:case"end":return z.stop()}},oe,this,[[7,11]])}))},D.unMuteAllAudio=function(){var O;return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this._checkConnectState(),z.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 3:if(z.sent){z.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneMicrophone auth"),z.abrupt("return");case 7:z.prev=7,(O=this.roomContext)===null||O===void 0||O.updateRoomProperty("audioOff",mo({value:ws.disable+"_"+new Date().getTime()})),z.next=15;break;case 11:throw z.prev=11,z.t0=z.catch(7),this.logger.error("QChatMedia::unMuteAllAudio error",z.t0),new yo("QChatMedia::unMuteAllAudio error",z.t0);case 15:case"end":return z.stop()}},oe,this,[[7,11]])}))},D.unMuteAllVideo=function(){var O;return Mr(this,void 0,void 0,ar.mark(function oe(){return ar.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this._checkConnectState(),z.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 3:if(z.sent){z.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneCamera auth"),z.abrupt("return");case 7:z.prev=7,(O=this.roomContext)===null||O===void 0||O.updateRoomProperty("videoOff",mo({value:ws.disable+"_"+new Date().getTime()})),z.next=15;break;case 11:throw z.prev=11,z.t0=z.catch(7),this.logger.error("QChatMedia::unMuteAllVideo error",z.t0),new yo("QChatMedia::unMuteAllVideo error",z.t0);case 15:case"end":return z.stop()}},oe,this,[[7,11]])}))},x}(gl),yC={"1_2":"heartbeat","24_2":"qchatLogin","24_4":"qchatExit","24_5":"qchatBeKicked","24_8":"qchatMultiSpotLogin","24_9":"qchatKick","24_19":"qchatSync"},Hd={qchatLoginTag:{appkey:1,account:2,authType:3,token:4,loginExt:5,clientType:6,clientSession:7,deviceId:8,sdkVersion:9,sdkType:10,userAgent:11,customTag:12,customClientType:13,sdkHumanVersion:14,pushTokenName:20,pushToken:21,pushkitTokenName:22,pushkitToken:23,deviceInfo:24,customPushContentType:25,os:30,mac:31,bundleId:32,simCarrierCode:33,simCountryCode:34,networkCode:35,browser:36,deviceModel:37,androidid:38,imei:39,idfv:40,openuuid:41,pushType:100,hasTokenPreviously:101,consid:102,clientIP:103,clientPort:104,loginTime:105}},Sl=Cc(Hd),bC={heartbeat:{sid:1,cid:2,service:"qchatAuth"},qchatLogin:{sid:24,cid:2,service:"qchatAuth",params:[{type:"Property",name:"qchatLoginReqTag",reflectMapper:Hd.qchatLoginTag}],response:[{type:"Property",name:"qchatLoginResTag",reflectMapper:Sl.qchatLoginTag},{type:"PropertyArray",name:"qchatMultiLoginResult",reflectMapper:Sl.qchatLoginTag}]},qchatExit:{sid:24,cid:4,service:"qchatAuth"},qchatBeKicked:{sid:24,cid:5,service:"qchatAuth",response:[{type:"Property",name:"beKickedTag",reflectMapper:{1:"clientType",2:"reason",3:"ext",4:"customClientType"}}]},qchatMultiSpotLogin:{sid:24,cid:8,service:"qchatAuth",response:[{type:"Number",name:"state"},{type:"Property",name:"qchatLoginResTag",reflectMapper:Sl.qchatLoginTag}]},qchatKick:{sid:24,cid:9,service:"qchatAuth",params:[{type:"StrArray",name:"deviceIds"}],response:[{type:"StrArray",name:"deviceIds"}]},qchatSync:{sid:24,cid:19,service:"qchatAuth",isNoResponse:!0,params:[{type:"Property",name:"qchatSyncTag",reflectMapper:{systemNotification:1,pushConfig:2}}],response:[{type:"Number",name:"timetag"}]}},TC={debugLevel:"off",needReconnect:!0,reconnectionAttempts:Xm,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},zd=function(S){function x(F,O){var oe;return O===void 0&&(O={cloudStorageConfig:{}}),(oe=S.call(this,F)||this).instanceName="QChat",oe.account="",oe.options={},oe.qchatAuth={},oe.qchatServer={},oe.qchatChannel={},oe.qchatMsg={},oe.qchatRole={},oe.qchatMedia={},oe.cloudStorage={},oe.setOptions(F),Ei({cmdMap:yC,cmdConfig:bC}),Ei({cmdMap:fy,cmdConfig:hh}),oe.qchatAuth=new gC(i(oe)),oe.qchatServer=new BS(i(oe)),oe.qchatChannel=new tC(i(oe)),oe.qchatMsg=new Vy(i(oe)),oe.qchatRole=new oC(i(oe)),oe.qchatMedia=new vC(i(oe)),oe.cloudStorage=new gy(i(oe),Tn({storageKeyPrefix:oe.instanceName},O.cloudStorageConfig)),O&&oe.setOtherOptions(O),x.instance=i(oe),oe}Ro(x,S),x.getInstance=function(O,oe){if(!x.instance){if(O)return new x(O,oe);throw new Error("Instance not exist, please input options")}if(O){if(x.instance.options.account===O.account&&x.instance.options.appkey===O.appkey)return x.instance.setOptions(O),oe&&x.instance.setOtherOptions(oe),x.instance;throw new Error("Unexpected login")}return x.instance};var D=x.prototype;return D.connect=function(O){O===void 0&&(O={});var oe=Ja(null,{connect:{get:function(){return S.prototype.connect}}});return Mr(this,void 0,void 0,ar.mark(function xe(){var z,qe,Lt;return ar.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:if(/^(unconnected|waitReconnect)$/.test(this.status)){pr.next=4;break}return z="QChat status is "+this.status+", and would not connect",this.logger.warn(z),pr.abrupt("return",co.reject(z));case 4:return qe=O.isAutoReconnect||!1,pr.next=7,oe.connect.call(this,{linkUrls:this.options.linkAddresses,isAutoReconnect:qe});case 7:return pr.prev=7,pr.next=10,this.qchatAuth.doLogin(qe);case 10:Lt=pr.sent,pr.next=21;break;case 13:if(pr.prev=13,pr.t0=pr.catch(7),this.logger.warn("qchat connect:: login failed",pr.t0),this.retryCount!==0){pr.next=19;break}throw this.doDisconnect(ls.ACTIVE,"FailedToInitializeLogin"),pr.t0;case 19:return this.doDisconnect(ls.OFFLINE,"ReconnectLoginFailed"),pr.abrupt("return");case 21:return this.status="logined",Lt.loginResult.appkey=this.options.appkey,this.eventBus.emit("logined",Lt.loginResult),this.emit("logined",Lt.loginResult),Lt.multiLoginResults&&Lt.multiLoginResults.length>0&&this.emit("multiSpotLogin",Lt.multiLoginResults),this.resetConnectStatus(),this.ping(),pr.prev=28,pr.next=31,this.cloudStorage.init();case 31:pr.next=36;break;case 33:pr.prev=33,pr.t1=pr.catch(28),this.logger.error("NIM:login cloudStorage init failed ",pr.t1);case 36:return pr.next=38,this.qchatAuth.sync();case 38:case"end":return pr.stop()}},xe,this,[[7,13],[28,33]])}))},D.login=function(O){return O===void 0&&(O={}),this.connect(O)},D.setOptions=function(O){Gr({account:{type:"string"},appkey:{type:"string"},token:{type:"string"},linkAddresses:{type:"array",itemType:"string",min:1},needReconnect:{type:"boolean",required:!1},reconnectionAttempts:{type:"number",required:!1},debugLevel:{type:"enum",values:np,required:!1}},O),this.logger.log("QChat::setOptions options is",O),this.account=O.account,this.options=Tn(Tn({},TC),O)},D.setOtherOptions=function(O){var oe;!((oe=O==null?void 0:O.QChatMedia)===null||oe===void 0)&&oe.neroom&&this.qchatMedia.setNeroom(O.QChatMedia.neroom)},D.onMessage=function(O){var oe,xe,z=S.prototype.onMessage.call(this,O);if(z){var qe=z.raw.ser,Lt=this.sendingCmdMap.get(qe);if(Lt&&Lt.cmd===z.cmd){var lr=Lt.callback,pr=Lt.timer,Sr=Lt.params;if(clearTimeout(pr),z.params=Sr,this.sendingCmdMap.delete(qe),z.cmd==="heartbeat")return void lr[0]();var br=(oe=this[z.service])===null||oe===void 0?void 0:oe.process(z);br&&typeof br.then=="function"?br.then(function(Er){lr[0](Er)}).catch(function(Er){lr[1](Er)}):(this.logger.log("imsocket:: handlerFn without promise",z.service,z.cmd),lr[0]())}else(xe=this[z.service])===null||xe===void 0||xe.process(z)}},D.disconnect=function(){var O=this;switch(this.status){case"logined":return this.sendCmd("qchatExit").then(function(){S.prototype.doDisconnect.call(O,ls.ACTIVE,"UserActiveDisconnect")});case"connected":case"connecting":case"waitReconnect":return S.prototype.doDisconnect.call(this,ls.ACTIVE,"UserActiveDisconnect"),co.resolve();case"unconnected":case"destroyed":return co.resolve()}},D.logout=function(){return this.disconnect()},D.destroy=function(){return x.instance=null,S.prototype.destroy.call(this)},D.kickOtherClients=function(O){return Gr({deviceIds:{type:"array",itemType:"string"}},O),this.qchatAuth.kick(O)},x}(hd);zd.instance=null;var SC=Math.min,Dh=[].lastIndexOf,rf=!!Dh&&1/[1].lastIndexOf(1,-0)<0,nf=Ds("lastIndexOf"),zy=rf||!nf?function(x){if(rf)return T(Dh,this,arguments)||0;var D=sr(this),F=Ia(D),O=F-1;for(arguments.length>1&&(O=SC(O,Li(arguments[1]))),O<0&&(O=F+O);O>=0;O--)if(O in D&&D[O]===x)return O||0;return-1}:Dh;Vr({target:"Array",proto:!0,forced:zy!==[].lastIndexOf},{lastIndexOf:zy});var CC=Uo("Array").lastIndexOf,Uh=Array.prototype,Ky=function(S){var x=S.lastIndexOf;return S===Uh||er(Uh,S)&&x===Uh.lastIndexOf?CC:x},Rc=o(function(S,x){(function(){var D={function:!0,object:!0}[typeof window]&&window||this,F=x,O=S&&!S.nodeType&&S,oe=F&&O&&typeof e=="object"&&e;!oe||oe.global!==oe&&oe.window!==oe&&oe.self!==oe||(D=oe);var xe=Math.pow(2,53)-1,z=/\bOpera/,qe=Object.prototype,Lt=qe.hasOwnProperty,lr=qe.toString;function pr(wn){return(wn=String(wn)).charAt(0).toUpperCase()+wn.slice(1)}function Sr(wn){return wn=vn(wn),/^(?:webOS|i(?:OS|P))/.test(wn)?wn:pr(wn)}function br(wn,hn){for(var Gn in wn)Lt.call(wn,Gn)&&hn(wn[Gn],Gn,wn)}function Er(wn){return wn==null?pr(wn):lr.call(wn).slice(8,-1)}function Dr(wn){return String(wn).replace(/([ -])(?!$)/g,"$1?")}function $r(wn,hn){var Gn=null;return function(jo,jn){var wr=-1,xn=jo?jo.length:0;if(typeof xn=="number"&&xn>-1&&xn<=xe)for(;++wr<xn;)jn(jo[wr],wr,jo);else br(jo,jn)}(wn,function(Dn,jo){Gn=hn(Gn,Dn,jo,wn)}),Gn}function vn(wn){return String(wn).replace(/^ +| +$/g,"")}var Xr=function wn(hn){var Gn=D,Dn=hn&&typeof hn=="object"&&Er(hn)!="String";Dn&&(Gn=hn,hn=null);var jo=Gn.navigator||{},jn=jo.userAgent||"";hn||(hn=jn);var wr,xn,Nn=Dn?!!jo.likeChrome:/\bChrome\b/.test(hn)&&!/internal|\n/i.test(lr.toString()),Cn="Object",Zr=Dn?Cn:"ScriptBridgingProxyObject",On=Dn?Cn:"Environment",Un=Dn&&Gn.java?"JavaPackage":Er(Gn.java),eo=Dn?Cn:"RuntimeObject",ro=/\bJava/.test(Un)&&Gn.java,Do=ro&&Er(Gn.environment)==On,go=ro?"a":"α",Zo=ro?"b":"β",So=Gn.document||{},Io=Gn.operamini||Gn.opera,ea=z.test(ea=Dn&&Io?Io["[[Class]]"]:Er(Io))?ea:Io=null,Ci=hn,Eo=[],Mi=null,$a=hn==jn,lo=$a&&Io&&typeof Io.version=="function"&&Io.version(),Go=function(wa){return $r(wa,function(Qo,ma){return Qo||RegExp("\\b"+(ma.pattern||Dr(ma))+"\\b","i").exec(hn)&&(ma.label||ma)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),zn=function(wa){return $r(wa,function(Qo,ma){return Qo||RegExp("\\b"+(ma.pattern||Dr(ma))+"\\b","i").exec(hn)&&(ma.label||ma)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),Bo=Gy([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Qa=function(wa){return $r(wa,function(Qo,ma,Kd){return Qo||(ma[Bo]||ma[/^[a-z]+(?: +[a-z]+\b)*/i.exec(Bo)]||RegExp("\\b"+Dr(Kd)+"(?:\\b|\\w*\\d)","i").exec(hn))&&Kd})}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),Qn=function(wa){return $r(wa,function(Qo,ma){var Kd=ma.pattern||Dr(ma);return!Qo&&(Qo=RegExp("\\b"+Kd+"(?:/[\\d.]+|[ \\w.]*)","i").exec(hn))&&(Qo=function(Ks,Wd,of){var Vh={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return Wd&&of&&/^Win/i.test(Ks)&&!/^Windows Phone /i.test(Ks)&&(Vh=Vh[/[\d.]+$/.exec(Ks)])&&(Ks="Windows "+Vh),Ks=String(Ks),Wd&&of&&(Ks=Ks.replace(RegExp(Wd,"i"),of)),Sr(Ks.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(Qo,Kd,ma.label||ma)),Qo})}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Gy(Is){return $r(Is,function(wa,Qo){var ma=Qo.pattern||Dr(Qo);return!wa&&(wa=RegExp("\\b"+ma+" *\\d+[.\\w_]*","i").exec(hn)||RegExp("\\b"+ma+" *\\w+-[\\w]*","i").exec(hn)||RegExp("\\b"+ma+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(hn))&&((wa=String(Qo.label&&!RegExp(ma,"i").test(Qo.label)?Qo.label:wa).split("/"))[1]&&!/[\d.]+/.test(wa[0])&&(wa[0]+=" "+wa[1]),Qo=Qo.label||Qo,wa=Sr(wa[0].replace(RegExp(ma,"i"),Qo).replace(RegExp("; *(?:"+Qo+"[_-])?","i")," ").replace(RegExp("("+Qo+")[-_.]?(\\w)","i"),"$1 $2"))),wa})}function qh(Is){return $r(Is,function(wa,Qo){return wa||(RegExp(Qo+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(hn)||0)[1]||null})}if(Go&&(Go=[Go]),/\bAndroid\b/.test(Qn)&&!Bo&&(wr=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(hn))&&(Bo=vn(wr[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),Qa&&!Bo?Bo=Gy([Qa]):Qa&&Bo&&(Bo=Bo.replace(RegExp("^("+Dr(Qa)+")[-_.\\s]","i"),Qa+" ").replace(RegExp("^("+Dr(Qa)+")[-_.]?(\\w)","i"),Qa+" $2")),(wr=/\bGoogle TV\b/.exec(Bo))&&(Bo=wr[0]),/\bSimulator\b/i.test(hn)&&(Bo=(Bo?Bo+" ":"")+"Simulator"),zn=="Opera Mini"&&/\bOPiOS\b/.test(hn)&&Eo.push("running in Turbo/Uncompressed mode"),zn=="IE"&&/\blike iPhone OS\b/.test(hn)?(Qa=(wr=wn(hn.replace(/like iPhone OS/,""))).manufacturer,Bo=wr.product):/^iP/.test(Bo)?(zn||(zn="Safari"),Qn="iOS"+((wr=/ OS ([\d_]+)/i.exec(hn))?" "+wr[1].replace(/_/g,"."):"")):zn=="Konqueror"&&/^Linux\b/i.test(Qn)?Qn="Kubuntu":Qa&&Qa!="Google"&&(/Chrome/.test(zn)&&!/\bMobile Safari\b/i.test(hn)||/\bVita\b/.test(Bo))||/\bAndroid\b/.test(Qn)&&/^Chrome/.test(zn)&&/\bVersion\//i.test(hn)?(zn="Android Browser",Qn=/\bAndroid\b/.test(Qn)?Qn:"Android"):zn=="Silk"?(/\bMobi/i.test(hn)||(Qn="Android",Eo.unshift("desktop mode")),/Accelerated *= *true/i.test(hn)&&Eo.unshift("accelerated")):zn=="UC Browser"&&/\bUCWEB\b/.test(hn)?Eo.push("speed mode"):zn=="PaleMoon"&&(wr=/\bFirefox\/([\d.]+)\b/.exec(hn))?Eo.push("identifying as Firefox "+wr[1]):zn=="Firefox"&&(wr=/\b(Mobile|Tablet|TV)\b/i.exec(hn))?(Qn||(Qn="Firefox OS"),Bo||(Bo=wr[1])):!zn||(wr=!/\bMinefield\b/i.test(hn)&&/\b(?:Firefox|Safari)\b/.exec(zn))?(zn&&!Bo&&/[\/,]|^[^(]+?\)/.test(hn.slice(hn.indexOf(wr+"/")+8))&&(zn=null),(wr=Bo||Qa||Qn)&&(Bo||Qa||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(Qn))&&(zn=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(Qn)?Qn:wr)+" Browser")):zn=="Electron"&&(wr=(/\bChrome\/([\d.]+)\b/.exec(hn)||0)[1])&&Eo.push("Chromium "+wr),lo||(lo=qh(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",Dr(zn),"(?:Firefox|Minefield|NetFront)"])),(wr=(Go=="iCab"&&parseFloat(lo)>3?"WebKit":/\bOpera\b/.test(zn)&&(/\bOPR\b/.test(hn)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(hn)&&!/^(?:Trident|EdgeHTML)$/.test(Go)&&"WebKit"||!Go&&/\bMSIE\b/i.test(hn)&&(Qn=="Mac OS"?"Tasman":"Trident")||Go=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(zn)&&"NetFront")&&(Go=[wr]),zn=="IE"&&(wr=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(hn)||0)[1])?(zn+=" Mobile",Qn="Windows Phone "+(/\+$/.test(wr)?wr:wr+".x"),Eo.unshift("desktop mode")):/\bWPDesktop\b/i.test(hn)?(zn="IE Mobile",Qn="Windows Phone 8.x",Eo.unshift("desktop mode"),lo||(lo=(/\brv:([\d.]+)/.exec(hn)||0)[1])):zn!="IE"&&Go=="Trident"&&(wr=/\brv:([\d.]+)/.exec(hn))&&(zn&&Eo.push("identifying as "+zn+(lo?" "+lo:"")),zn="IE",lo=wr[1]),$a){if(function(wa,Qo){var ma=wa!=null?typeof wa[Qo]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(ma)||ma=="object"&&!wa[Qo])}(Gn,"global"))if(ro&&(Ci=(wr=ro.lang.System).getProperty("os.arch"),Qn=Qn||wr.getProperty("os.name")+" "+wr.getProperty("os.version")),Do){try{lo=Gn.require("ringo/engine").version.join("."),zn="RingoJS"}catch{(wr=Gn.system)&&wr.global.system==Gn.system&&(zn="Narwhal",Qn||(Qn=wr[0].os||null))}zn||(zn="Rhino")}else typeof Gn.process=="object"&&!Gn.process.browser&&(wr=Gn.process)&&(typeof wr.versions=="object"&&(typeof wr.versions.electron=="string"?(Eo.push("Node "+wr.versions.node),zn="Electron",lo=wr.versions.electron):typeof wr.versions.nw=="string"&&(Eo.push("Chromium "+lo,"Node "+wr.versions.node),zn="NW.js",lo=wr.versions.nw)),zn||(zn="Node.js",Ci=wr.arch,Qn=wr.platform,lo=(lo=/[\d.]+/.exec(wr.version))?lo[0]:null));else Er(wr=Gn.runtime)==Zr?(zn="Adobe AIR",Qn=wr.flash.system.Capabilities.os):Er(wr=Gn.phantom)==eo?(zn="PhantomJS",lo=(wr=wr.version||null)&&wr.major+"."+wr.minor+"."+wr.patch):typeof So.documentMode=="number"&&(wr=/\bTrident\/(\d+)/i.exec(hn))?(lo=[lo,So.documentMode],(wr=+wr[1]+4)!=lo[1]&&(Eo.push("IE "+lo[1]+" mode"),Go&&(Go[1]=""),lo[1]=wr),lo=zn=="IE"?String(lo[1].toFixed(1)):lo[0]):typeof So.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(zn)&&(Eo.push("masking as "+zn+" "+lo),zn="IE",lo="11.0",Go=["Trident"],Qn="Windows");Qn=Qn&&Sr(Qn)}if(lo&&(wr=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(lo)||/(?:alpha|beta)(?: ?\d)?/i.exec(hn+";"+($a&&jo.appMinorVersion))||/\bMinefield\b/i.test(hn)&&"a")&&(Mi=/b/i.test(wr)?"beta":"alpha",lo=lo.replace(RegExp(wr+"\\+?$"),"")+(Mi=="beta"?Zo:go)+(/\d+\+?/.exec(wr)||"")),zn=="Fennec"||zn=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(Qn))zn="Firefox Mobile";else if(zn=="Maxthon"&&lo)lo=lo.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(Bo))Bo=="Xbox 360"&&(Qn=null),Bo=="Xbox 360"&&/\bIEMobile\b/.test(hn)&&Eo.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(zn)&&(!zn||Bo||/Browser|Mobi/.test(zn))||Qn!="Windows CE"&&!/Mobi/i.test(hn))if(zn=="IE"&&$a)try{Gn.external===null&&Eo.unshift("platform preview")}catch{Eo.unshift("embedded")}else(/\bBlackBerry\b/.test(Bo)||/\bBB10\b/.test(hn))&&(wr=(RegExp(Bo.replace(/ +/g," *")+"/([.\\d]+)","i").exec(hn)||0)[1]||lo)?(Qn=((wr=[wr,/BB10/.test(hn)])[1]?(Bo=null,Qa="BlackBerry"):"Device Software")+" "+wr[0],lo=null):this!=br&&Bo!="Wii"&&($a&&Io||/Opera/.test(zn)&&/\b(?:MSIE|Firefox)\b/i.test(hn)||zn=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(Qn)||zn=="IE"&&(Qn&&!/^Win/.test(Qn)&&lo>5.5||/\bWindows XP\b/.test(Qn)&&lo>8||lo==8&&!/\bTrident\b/.test(hn)))&&!z.test(wr=wn.call(br,hn.replace(z,"")+";"))&&wr.name&&(wr="ing as "+wr.name+((wr=wr.version)?" "+wr:""),z.test(zn)?(/\bIE\b/.test(wr)&&Qn=="Mac OS"&&(Qn=null),wr="identify"+wr):(wr="mask"+wr,zn=ea?Sr(ea.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(wr)&&(Qn=null),$a||(lo=null)),Go=["Presto"],Eo.push(wr));else zn+=" Mobile";(wr=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(hn)||0)[1])&&(wr=[parseFloat(wr.replace(/\.(\d)$/,".0$1")),wr],zn=="Safari"&&wr[1].slice(-1)=="+"?(zn="WebKit Nightly",Mi="alpha",lo=wr[1].slice(0,-1)):lo!=wr[1]&&lo!=(wr[2]=(/\bSafari\/([\d.]+\+?)/i.exec(hn)||0)[1])||(lo=null),wr[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(hn)||0)[1],wr[0]==537.36&&wr[2]==537.36&&parseFloat(wr[1])>=28&&Go=="WebKit"&&(Go=["Blink"]),$a&&(Nn||wr[1])?(Go&&(Go[1]="like Chrome"),wr=wr[1]||((wr=wr[0])<530?1:wr<532?2:wr<532.05?3:wr<533?4:wr<534.03?5:wr<534.07?6:wr<534.1?7:wr<534.13?8:wr<534.16?9:wr<534.24?10:wr<534.3?11:wr<535.01?12:wr<535.02?"13+":wr<535.07?15:wr<535.11?16:wr<535.19?17:wr<536.05?18:wr<536.1?19:wr<537.01?20:wr<537.11?"21+":wr<537.13?23:wr<537.18?24:wr<537.24?25:wr<537.36?26:Go!="Blink"?"27":"28")):(Go&&(Go[1]="like Safari"),wr=(wr=wr[0])<400?1:wr<500?2:wr<526?3:wr<533?4:wr<534?"4+":wr<535?5:wr<537?6:wr<538?7:wr<601?8:wr<602?9:wr<604?10:wr<606?11:wr<608?12:"12"),Go&&(Go[1]+=" "+(wr+=typeof wr=="number"?".x":/[.+]/.test(wr)?"":"+")),zn=="Safari"&&(!lo||parseInt(lo)>45)?lo=wr:zn=="Chrome"&&/\bHeadlessChrome/i.test(hn)&&Eo.unshift("headless")),zn=="Opera"&&(wr=/\bzbov|zvav$/.exec(Qn))?(zn+=" ",Eo.unshift("desktop mode"),wr=="zvav"?(zn+="Mini",lo=null):zn+="Mobile",Qn=Qn.replace(RegExp(" *"+wr+"$"),"")):zn=="Safari"&&/\bChrome\b/.exec(Go&&Go[1])?(Eo.unshift("desktop mode"),zn="Chrome Mobile",lo=null,/\bOS X\b/.test(Qn)?(Qa="Apple",Qn="iOS 4.3+"):Qn=null):/\bSRWare Iron\b/.test(zn)&&!lo&&(lo=qh("Chrome")),lo&&lo.indexOf(wr=/[\d.]+$/.exec(Qn))==0&&hn.indexOf("/"+wr+"-")>-1&&(Qn=vn(Qn.replace(wr,""))),Qn&&Qn.indexOf(zn)!=-1&&!RegExp(zn+" OS").test(Qn)&&(Qn=Qn.replace(RegExp(" *"+Dr(zn)+" *"),"")),Go&&!/\b(?:Avant|Nook)\b/.test(zn)&&(/Browser|Lunascape|Maxthon/.test(zn)||zn!="Safari"&&/^iOS/.test(Qn)&&/\bSafari\b/.test(Go[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(zn)&&Go[1])&&(wr=Go[Go.length-1])&&Eo.push(wr),Eo.length&&(Eo=["("+Eo.join("; ")+")"]),Qa&&Bo&&Bo.indexOf(Qa)<0&&Eo.push("on "+Qa),Bo&&Eo.push((/^on /.test(Eo[Eo.length-1])?"":"on ")+Bo),Qn&&(wr=/ ([\d.+]+)$/.exec(Qn),xn=wr&&Qn.charAt(Qn.length-wr[0].length-1)=="/",Qn={architecture:32,family:wr&&!xn?Qn.replace(wr[0],""):Qn,version:wr?wr[1]:null,toString:function(){var Is=this.version;return this.family+(Is&&!xn?" "+Is:"")+(this.architecture==64?" 64-bit":"")}}),(wr=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Ci))&&!/\bi686\b/i.test(Ci)?(Qn&&(Qn.architecture=64,Qn.family=Qn.family.replace(RegExp(" *"+wr),"")),zn&&(/\bWOW64\b/i.test(hn)||$a&&/\w(?:86|32)$/.test(jo.cpuClass||jo.platform)&&!/\bWin64; x64\b/i.test(hn))&&Eo.unshift("32-bit")):Qn&&/^OS X/.test(Qn.family)&&zn=="Chrome"&&parseFloat(lo)>=39&&(Qn.architecture=64),hn||(hn=null);var xs={};return xs.description=hn,xs.layout=Go&&Go[0],xs.manufacturer=Qa,xs.name=zn,xs.prerelease=Mi,xs.product=Bo,xs.ua=hn,xs.version=zn&&lo,xs.os=Qn||{architecture:null,family:null,version:null,toString:function(){return"null"}},xs.parse=wn,xs.toString=function(){return this.description||""},xs.version&&Eo.unshift(lo),xs.name&&Eo.unshift(zn),Qn&&zn&&(Qn!=String(Qn).split(" ")[0]||Qn!=zn.split(" ")[0]&&!Bo)&&Eo.push(Bo?"("+Qn+")":"on "+Qn),Eo.length&&(xs.description=Eo.join(" ")),xs}();F&&O?br(Xr,function(wn,hn){F[hn]=wn}):D.platform=Xr}).call(e)}),Wy=o(function(S,x){S.exports=function(){var D={d:function(wr,xn){for(var Nn in xn)D.o(xn,Nn)&&!D.o(wr,Nn)&&Ki(wr,Nn,{enumerable:!0,get:xn[Nn]})},o:function(wr,xn){return Object.prototype.hasOwnProperty.call(wr,xn)}},F={};D.d(F,{default:function(){return jo}});var O=function jn(wr){for(var xn in function(Nn,Cn){if(!(Nn instanceof Cn))throw new TypeError("Cannot call a class as a function")}(this,jn),this.directUploadAddr="https://wanproxy-web.127.net",this.retryCount=4,this.trunkSize=4194304,this.trunkUploadTimeout=5e4,this.getOffsetTimeout=1e4,this.version="1.0",this.enableCache=!0,this.logger=console,this.onError=function(Nn){},this.onProgress=function(Nn){},this.onUploadProgress=function(Nn){},this.onComplete=function(Nn){},wr)this[xn]=wr[xn]};function oe(jn,wr){var xn=ha!==void 0&&Va(jn)||jn["@@iterator"];if(!xn){if(ns(jn)||(xn=function(eo,ro){if(eo){var Do;if(typeof eo=="string")return xe(eo,ro);var go=Co(Do=Object.prototype.toString.call(eo)).call(Do,8,-1);return go==="Object"&&eo.constructor&&(go=eo.constructor.name),go==="Map"||go==="Set"?_c(eo):go==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(go)?xe(eo,ro):void 0}}(jn))||wr&&jn&&typeof jn.length=="number"){xn&&(jn=xn);var Nn=0,Cn=function(){};return{s:Cn,n:function(){return Nn>=jn.length?{done:!0}:{done:!1,value:jn[Nn++]}},e:function(ro){throw ro},f:Cn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Zr,On=!0,Un=!1;return{s:function(){xn=xn.call(jn)},n:function(){var ro=xn.next();return On=ro.done,ro},e:function(ro){Un=!0,Zr=ro},f:function(){try{On||xn.return==null||xn.return()}finally{if(Un)throw Zr}}}}function xe(jn,wr){(wr==null||wr>jn.length)&&(wr=jn.length);for(var xn=0,Nn=new Array(wr);xn<wr;xn++)Nn[xn]=jn[xn];return Nn}var z=window.localStorage;window.localStorage&&typeof window.localStorage.getItem=="function"&&typeof window.localStorage.setItem=="function"&&typeof window.localStorage.removeItem=="function"||(z={privateObj:{},setItem:function(wr,xn){z.privateObj[wr]=xn},getItem:function(wr){return z.privateObj[wr]},removeItem:function(wr){delete z.privateObj[wr]},getKeys:function(){return na(z.privateObj)}});var qe={getFileKey:function(wr){var xn=wr.size.toString(),Nn=wr.lastModified.toString();return"_NosUploader_"+wr.name+Co(xn).call(xn,xn.length-5)+Co(Nn).call(Nn,Nn.length-5)},getFileInfo:function(wr){var xn=z.getItem(wr);if(!xn)return null;try{return JSON.parse(xn)}catch{return null}},initFile:function(wr,xn,Nn){qe.clearExpiredInfo();var Cn=this.getFileKey(xn),Zr={ctx:wr.ctx!==void 0?wr.ctx:"",bucket:wr.bucketName,obj:wr.objectName,token:wr.token,modifyAt:ts(),end:!1};return wr.payload&&(Zr.payload=wr.payload),Nn&&z.setItem(Cn,mo(Zr)),Cn},setUploadContext:function(wr,xn,Nn){var Cn=this.getFileInfo(wr);Cn&&(Cn.ctx=xn,Nn&&z.setItem(wr,mo(Cn)))},setComplete:function(wr,xn){var Nn=this.getFileInfo(wr);Nn&&(Nn.modifyAt=ts(),Nn.end=!0,xn&&z.setItem(wr,mo(Nn)))},getUploadContext:function(wr){var xn=this.getFileInfo(wr);return xn?xn.ctx:""},removeFileInfo:function(wr){pa(wr).call(wr,"_NosUploader_")===0&&z.removeItem(wr)},clearExpiredInfo:function(){var wr,xn=typeof z.getKeys=="function"?z.getKeys():na(z),Nn=ts(),Cn=[],Zr=oe(xn);try{for(Zr.s();!(wr=Zr.n()).done;){var On=wr.value;if(pa(On).call(On,"_NosUploader_")===0){var Un=qe.getFileInfo(On);Un===null||Nn-Un.modifyAt>jo.expireTime?z.removeItem(On):Cn.push({fileInfo:Un,key:On})}}}catch(So){Zr.e(So)}finally{Zr.f()}if(Cn.length>jo.maxFileCache){var eo,ro,Do=oe(Co(eo=Wl(Cn).call(Cn,function(So,Io){return Io.fileInfo.modifyAt-So.fileInfo.modifyAt})).call(eo,jo.maxFileCache));try{for(Do.s();!(ro=Do.n()).done;){var go,Zo=ro.value;pa(go=Zo.key).call(go,"_NosUploader_")===0&&z.removeItem(Zo.key)}}catch(So){Do.e(So)}finally{Do.f()}}}},Lt=qe;function lr(jn){return(lr=typeof ha=="function"&&typeof cm=="symbol"?function(wr){return typeof wr}:function(wr){return wr&&typeof ha=="function"&&wr.constructor===ha&&wr!==ha.prototype?"symbol":typeof wr})(jn)}function pr(jn,wr){return!wr||lr(wr)!=="object"&&typeof wr!="function"?function(xn){if(xn===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return xn}(jn):wr}function Sr(jn){var wr=typeof nl=="function"?new nl:void 0;return(Sr=function(Nn){var Cn,Zr;if(Nn===null||(Zr=Nn,pa(Cn=Function.toString.call(Zr)).call(Cn,"[native code]")===-1))return Nn;if(typeof Nn!="function")throw new TypeError("Super expression must either be null or a function");if(wr!==void 0){if(wr.has(Nn))return wr.get(Nn);wr.set(Nn,On)}function On(){return br(Nn,arguments,$r(this).constructor)}return On.prototype=Ja(Nn.prototype,{constructor:{value:On,enumerable:!1,writable:!0,configurable:!0}}),Dr(On,Nn)})(jn)}function br(jn,wr,xn){return(br=Er()?tc:function(Nn,Cn,Zr){var On=[null];On.push.apply(On,Cn);var Un=new(Oo(Function).apply(Nn,On));return Zr&&Dr(Un,Zr.prototype),Un}).apply(null,arguments)}function Er(){if(typeof Reflect>"u"||!tc||tc.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(tc(Boolean,[],function(){})),!0}catch{return!1}}function Dr(jn,wr){return(Dr=Ns||function(xn,Nn){return xn.__proto__=Nn,xn})(jn,wr)}function $r(jn){return($r=Ns?js:function(wr){return wr.__proto__||js(wr)})(jn)}var vn=function(jn){(function(Zr,On){if(typeof On!="function"&&On!==null)throw new TypeError("Super expression must either be null or a function");Zr.prototype=Ja(On&&On.prototype,{constructor:{value:Zr,writable:!0,configurable:!0}}),On&&Dr(Zr,On)})(Cn,jn);var wr,xn,Nn=(wr=Cn,xn=Er(),function(){var Zr,On=$r(wr);if(xn){var Un=$r(this).constructor;Zr=tc(On,arguments,Un)}else Zr=On.apply(this,arguments);return pr(this,Zr)});function Cn(Zr,On){var Un;return function(eo,ro){if(!(eo instanceof ro))throw new TypeError("Cannot call a class as a function")}(this,Cn),(Un=Nn.call(this,"NosUploadError:"+Zr)).errCode=On,Un.errMsg=Zr,Un}return Cn}(Sr(Error)),Xr=function jn(wr,xn,Nn){if(wr.uploadState==="uploading"){var Cn=wr.config,Zr=wr.param,On=Lt.getUploadContext(wr.fileKey);if(!On)return Nn(0);var Un=new XMLHttpRequest,eo=Cn.directUploadAddr+"/".concat(Zr.bucketName)+"/".concat(encodeURIComponent(Zr.objectName))+"?uploadContext"+"&context=".concat(On)+"&version=".concat(Cn.version);Un.onreadystatechange=function(){var ro;if(wr.uploadState!=="abort"&&Un.readyState===4){var Do,go,Zo,So;try{So=JSON.parse(Un.responseText)}catch{So={errMsg:"JsonParseError in getOffset",errCode:500}}Un.status===200?So.errCode?wr.config.onError(new vn(So.errMsg,So.errCode)):Nn(So.offset):Un.status.toString().match(/^5/)?jn(wr,xn-1,Nn):xn>0?(typeof((ro=Cn.logger)===null||ro===void 0?void 0:ro.error)=="function"&&Cn.logger.error(qs(Do="getOffset(".concat(eo,") error. retry after 3 seconds. ")).call(Do,new Date().toTimeString())),sa(function(){jn(wr,xn-1,Nn)},3500)):(Lt.removeFileInfo(wr.fileKey),Un.status?Cn.onError(new vn(qs(go=qs(Zo="getOffset(".concat(eo,") error: ")).call(Zo,Un.status," ")).call(go,Un.statusText))):Cn.onError(new vn("getOffset(".concat(eo,") error. no Error Code"))))}},Un.open("get",eo),Un.setRequestHeader("x-nos-token",Zr.token),Un.timeout=Cn.getOffsetTimeout,Un.send()}},wn=function jn(wr,xn,Nn,Cn){if(wr.uploadState==="uploading"){var Zr=wr.param,On=wr.config,Un=Co(File.prototype),eo=Zr.ctx!==void 0?Zr.ctx:"",ro=xn+On.trunkSize>wr.file.size,Do=ro?wr.file.size:xn+On.trunkSize,go=new XMLHttpRequest,Zo=On.directUploadAddr+"/".concat(Zr.bucketName)+"/".concat(encodeURIComponent(Zr.objectName));if(go.upload.onprogress=function(Io){if(wr.uploadState!=="abort"){var ea=0;Io.lengthComputable?(ea=(xn+Io.loaded)/wr.file.size,On.onProgress(ea),On.onUploadProgress({loaded:Io.loaded,total:wr.file.size,percentage:ea,percentageText:(100*ea).toFixed(2)+"%"})):On.onError(new vn("browser does not support query upload progress"))}},go.onreadystatechange=function(){var Io,ea;if(wr.uploadState!=="abort"&&go.readyState===4){var Ci,Eo,Mi,$a;try{$a=JSON.parse(go.responseText)}catch(lo){typeof((Io=On.logger)===null||Io===void 0?void 0:Io.error)=="function"&&On.logger.error("JsonParseError in uploadTrunk",lo),$a={errMsg:"JsonParseError in uploadTrunk"}}go.status===200?(wr.setContext($a.context),ro?(Cn(),wr.setComplete()):jn(wr,$a.offset,On.retryCount,Cn)):go.status.toString().match(/^5/)?Nn>0?jn(wr,xn,Nn-1,Cn):(Lt.removeFileInfo(wr.fileKey),On.onError(new vn($a.errMsg,$a.errCode))):Nn>0?(typeof((ea=On.logger)===null||ea===void 0?void 0:ea.error)=="function"&&On.logger.error(qs(Ci="uploadTrunk(".concat(Zo,") error. retry after 3 seconds. ")).call(Ci,new Date().toTimeString())),sa(function(){jn(wr,xn,Nn-1,Cn)},3500)):(Lt.removeFileInfo(wr.fileKey),go.status?On.onError(new vn(qs(Eo=qs(Mi="uploadTrunk(".concat(Zo,") error: ")).call(Mi,go.status," ")).call(Eo,go.statusText))):On.onError(new vn("uploadTrunk(".concat(Zo,") error. no Error Code. Please check your network"))))}},go.open("post",Zo+"?offset=".concat(xn)+"&complete=".concat(ro)+"&context=".concat(eo)+"&version=".concat(On.version)),go.setRequestHeader("x-nos-token",Zr.token),wr.file.type&&go.setRequestHeader("content-type",wr.file.type),go.timeout=On.trunkUploadTimeout,typeof FileReader<"u"){var So=new FileReader;So.addEventListener("load",function(Io){var ea;!((ea=Io==null?void 0:Io.target)===null||ea===void 0)&&ea.result?go.send(Io.target.result):On.onError(new vn("Read ArrayBuffer failed"))}),So.addEventListener("error",function(Io){var ea=Io.target.error;On.onError(new vn("Read ArrayBuffer error. ".concat(ea.toString()),ea.code))}),So.readAsArrayBuffer(Un.call(wr.file,xn,Do))}else go.send(Un.call(wr.file,xn,Do))}};function hn(jn,wr){for(var xn=0;xn<wr.length;xn++){var Nn=wr[xn];Nn.enumerable=Nn.enumerable||!1,Nn.configurable=!0,"value"in Nn&&(Nn.writable=!0),Ki(jn,Nn.key,Nn)}}var Gn=function(){function jn(xn,Nn,Cn){(function(Zr,On){if(!(Zr instanceof On))throw new TypeError("Cannot call a class as a function")})(this,jn),this.uploadState="paused",this.config=Cn,this.file=xn,this.param=Nn,this.fileKey=Lt.initFile(Nn,xn,this.config.enableCache),this.resume()}var wr;return(wr=[{key:"resume",value:function(){var Nn=this;if(this.uploadState!=="uploading"){this.setUploadState("uploading");var Cn=this.config;Xr(this,Cn.retryCount,function(Zr){wn(Nn,Zr,Cn.retryCount,function(){Nn.setUploadState("ended"),typeof Cn.onComplete=="function"&&Cn.onComplete(Nn.param)})})}}},{key:"pause",value:function(){this.setUploadState("paused")}},{key:"abort",value:function(){this.setUploadState("abort"),Lt.removeFileInfo(this.fileKey),this.config.onError(new vn("Upload Aborted",10499))}},{key:"setUploadState",value:function(Nn){Nn!==this.uploadState&&(this.uploadState=Nn)}},{key:"setContext",value:function(Nn){Lt.setUploadContext(this.fileKey,Nn,this.config.enableCache),this.param.ctx=Nn}},{key:"setComplete",value:function(){Lt.setComplete(this.fileKey,this.config.enableCache),this.setUploadState("ended")}}])&&hn(jn.prototype,wr),jn}(),Dn={maxFileCache:6,expireTime:864e5,getFileUploadInformation:function(wr){var xn=Lt.getFileKey(wr),Nn=Lt.getFileInfo(xn);return Nn===null?null:ts()-Nn.modifyAt>Dn.expireTime?(Lt.removeFileInfo(xn),null):{uploadInfo:Tn({bucketName:Nn.bucket,objectName:Nn.obj,token:Nn.token,ctx:Nn.ctx},Nn.payload?{payload:Nn.payload}:{}),complete:Nn.end}},setMaxFileCache:function(wr){Dn.maxFileCache=wr},setExpireTime:function(wr){Dn.expireTime=wr},printCaches:function(){for(var wr=0,xn=na(localStorage);wr<xn.length;wr++){var Nn=xn[wr],Cn=Lt.getFileInfo(Nn);Cn&&console.log(Cn,"modifiedAt",new Date(Cn.modifyAt).toTimeString())}},createConfig:function(wr){return new O(wr)},createTask:function(wr,xn,Nn){return new Gn(wr,xn,Nn)}},jo=Dn;return F.default}()}),Cl=o(function(S,x){S.exports=function(){function D(xe){if(xe){var z,qe="";return In(z=na(xe)).call(z,function(Lt,lr){qe+=lr===0?"?":"&",qe+=Lt+"="+xe[Lt]}),qe}return""}function F(xe,z,qe,Lt){return Error.call(this,qe),this.source=xe,this.code=z,this.desc=qe,this.detail=Lt||{},this}function O(xe,z){var qe=Ja(z.prototype);qe.constructor=xe,xe.prototype=qe}function oe(xe,z){z===void 0&&(z={dataType:"json",method:"GET",timeout:5e3});var qe=z.dataType==="text"?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",Lt=z.method==="GET"?D(z.params):"";return new co(function(lr,pr){if(window.XMLHttpRequest){var Sr,br=new XMLHttpRequest;if(br.onreadystatechange=function(){if(br.readyState===4)if(br.status===200){try{Sr=JSON.parse(br.response||"{}")}catch{Sr=br.response}lr({status:br.status,data:Sr})}else pr(new F(1,br.status,br.statusText))},br.open(z.method,""+xe+Lt),br.timeout=z.timeout||5e3,br.setRequestHeader("Content-Type",qe),z.headers)for(var Er in z.headers)br.setRequestHeader(Er,z.headers[Er]);br.ontimeout=function(Dr){pr(new F(1,408,Dr&&Dr.message?Dr.message:"request timeout"))},br.send(mo(z.data))}else pr(new F(2,10400,"request no suppout"))})}return O(F,Error),oe}()}),tu=console,MC={setLogger:function(x){tu=x},platform:"BROWSER",localStorage:window.localStorage,request:Cl,WebSocket:window.WebSocket,uploadFile:function(x){return Mr(this,void 0,void 0,ar.mark(function D(){var F,O,oe,xe,z,qe;return ar.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:if(x.fileInput||x.file){lr.next=2;break}throw new Error("File not exist");case 2:if(!x.file){lr.next=6;break}xe=x.file,lr.next=20;break;case 6:if(typeof x.fileInput!="string"){lr.next=15;break}if(!((z=document.getElementById(x.fileInput))&&z.files&&z.files[0])){lr.next=12;break}xe=z.files[0],lr.next=13;break;case 12:throw new Error("Can not get file from fileInput");case 13:lr.next=20;break;case 15:if(!(x.fileInput&&x.fileInput.files&&x.fileInput.files[0])){lr.next=19;break}xe=x.fileInput.files[0],lr.next=20;break;case 19:throw new Error("Can not get file from fileInput "+x.fileInput);case 20:if(!(x.maxSize&&xe.size>x.maxSize)){lr.next=22;break}throw new Error("The file exceeds maxSize limit. maxSize: "+x.maxSize+", get "+xe.size);case 22:return lr.next=24,new co(function(pr,Sr){var br=Wy.createConfig({enableCache:!1,directUploadAddr:x.chunkUploadHost,onError:function($r){Sr($r)},onProgress:x.onUploadProgress||function(){},onComplete:function($r){pr($r)}}),Er=Wy.createTask(xe,{bucketName:x.nosToken.bucket,objectName:decodeURIComponent(x.nosToken.objectName),token:x.nosToken.token},br);try{x.onUploadStart&&x.onUploadStart(Er)}catch(Dr){tu.error("Adapter uploadFile: options.onUploadStart error",Dr&&Dr.message),Er.abort(),Sr(Dr)}});case 24:return(qe=lr.sent).name=xe.name,qe.size=xe.size,qe.type=xe.type,qe.ext=Ky(F=qe.name).call(F,".")>-1?Co(O=qe.name).call(O,Ky(oe=qe.name).call(oe,".")+1).toLowerCase():"",lr.abrupt("return",qe);case 30:case"end":return lr.stop()}},D)}))},getSystemInfo:function(){var x,D;return{os:((x=Rc.os)===null||x===void 0?void 0:x.family)||"",osVer:((D=Rc.os)===null||D===void 0?void 0:D.version)||"",browser:Rc.name||"",browserVer:Rc.version||"",hostEnv:"BROWSER",hostEnvVer:Rc.version||"",hostInfo:Rc.ua||""}}};return zd.setAdapters(MC),zd})})(QCHAT_BROWSER_SDK);var QCHAT_BROWSER_SDKExports=QCHAT_BROWSER_SDK.exports;const QChatSDK=getDefaultExportFromCjs(QCHAT_BROWSER_SDKExports);var NIM_BROWSER_SDK={exports:{}};(function(t,r){(function(e,n){t.exports=n()})(commonjsGlobal,function(){var e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{};function n(w){return w&&w.__esModule&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w}function o(w){var M={exports:{}};return w(M,M.exports),M.exports}var s,a,i=n(o(function(w){w.exports=function(L){if(L===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L},w.exports.__esModule=!0,w.exports.default=w.exports})),u=function(w){return w&&w.Math==Math&&w},c=u(typeof globalThis=="object"&&globalThis)||u(typeof window=="object"&&window)||u(typeof self=="object"&&self)||u(typeof e=="object"&&e)||function(){return this}()||Function("return this")(),d=function(w){try{return!!w()}catch{return!0}},m=!d(function(){var w=(function(){}).bind();return typeof w!="function"||w.hasOwnProperty("prototype")}),v=Function.prototype,g=v.apply,b=v.call,T=typeof Reflect=="object"&&Reflect.apply||(m?b.bind(g):function(){return b.apply(g,arguments)}),k=Function.prototype,y=k.bind,A=k.call,V=m&&y.bind(A,A),he=m?function(w){return w&&V(w)}:function(w){return w&&function(){return A.apply(w,arguments)}},ae=function(w){return typeof w=="function"},Ne=!d(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),_e=Function.prototype.call,Ce=m?_e.bind(_e):function(){return _e.apply(_e,arguments)},re={}.propertyIsEnumerable,ue=Object.getOwnPropertyDescriptor,ze={f:ue&&!re.call({1:2},1)?function(M){var L=ue(this,M);return!!L&&L.enumerable}:re},le=function(w,M){return{enumerable:!(1&w),configurable:!(2&w),writable:!(4&w),value:M}},de=he({}.toString),Ie=he("".slice),ie=function(w){return Ie(de(w),8,-1)},Ve=Object,Ue=he("".split),Dt=d(function(){return!Ve("z").propertyIsEnumerable(0)})?function(w){return ie(w)=="String"?Ue(w,""):Ve(w)}:Ve,tr=function(w){return w==null},dr=TypeError,fr=function(w){if(tr(w))throw dr("Can't call method on "+w);return w},sr=function(w){return Dt(fr(w))},hr=typeof document=="object"&&document.all,Fe=hr===void 0&&hr!==void 0?function(w){return typeof w=="object"?w!==null:ae(w)||w===hr}:function(w){return typeof w=="object"?w!==null:ae(w)},or={},ir=function(w){return ae(w)?w:void 0},$e=function(w,M){return arguments.length<2?ir(or[w])||ir(c[w]):or[w]&&or[w][M]||c[w]&&c[w][M]},er=he({}.isPrototypeOf),nr=$e("navigator","userAgent")||"",Pt=c.process,rr=c.Deno,kt=Pt&&Pt.versions||rr&&rr.version,Et=kt&&kt.v8;Et&&(a=(s=Et.split("."))[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&nr&&(!(s=nr.match(/Edge\/(\d+)/))||s[1]>=74)&&(s=nr.match(/Chrome\/(\d+)/))&&(a=+s[1]);var cr,mr=a,yr=!!Object.getOwnPropertySymbols&&!d(function(){var w=Symbol();return!String(w)||!(Object(w)instanceof Symbol)||!Symbol.sham&&mr&&mr<41}),Tr=yr&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Ir=Object,kr=Tr?function(w){return typeof w=="symbol"}:function(w){var M=$e("Symbol");return ae(M)&&er(M.prototype,Ir(w))},Ar=String,Rr=function(w){try{return Ar(w)}catch{return"Object"}},Mn=TypeError,Or=function(w){if(ae(w))return w;throw Mn(Rr(w)+" is not a function")},Pr=function(w,M){var L=w[M];return tr(L)?void 0:Or(L)},Nr=TypeError,Wr=Object.defineProperty,Yr="__core-js_shared__",Ur=c[Yr]||function(w,M){try{Wr(c,w,{value:M,configurable:!0,writable:!0})}catch{c[w]=M}return M}(Yr,{}),qr=o(function(w){(w.exports=function(M,L){return Ur[M]||(Ur[M]=L!==void 0?L:{})})("versions",[]).push({version:"3.25.0",mode:"pure",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),Yn=Object,$n=function(w){return Yn(fr(w))},Jr=he({}.hasOwnProperty),Fr=Object.hasOwn||function(M,L){return Jr($n(M),L)},Wn=0,ho=Math.random(),bo=he(1 .toString),uo=function(w){return"Symbol("+(w===void 0?"":w)+")_"+bo(++Wn+ho,36)},po=qr("wks"),No=c.Symbol,An=No&&No.for,Sa=Tr?No:No&&No.withoutSetter||uo,to=function(w){if(!Fr(po,w)||!yr&&typeof po[w]!="string"){var M="Symbol."+w;yr&&Fr(No,w)?po[w]=No[w]:po[w]=Tr&&An?An(M):Sa(M)}return po[w]},Lr=TypeError,Qr=to("toPrimitive"),Bn=function(w,M){if(!Fe(w)||kr(w))return w;var L,$=Pr(w,Qr);if($){if(M===void 0&&(M="default"),L=Ce($,w,M),!Fe(L)||kr(L))return L;throw Lr("Can't convert object to primitive value")}return M===void 0&&(M="number"),function(_,Y){var Oe,pe;if(Y==="string"&&ae(Oe=_.toString)&&!Fe(pe=Ce(Oe,_))||ae(Oe=_.valueOf)&&!Fe(pe=Ce(Oe,_))||Y!=="string"&&ae(Oe=_.toString)&&!Fe(pe=Ce(Oe,_)))return pe;throw Nr("Can't convert object to primitive value")}(w,M)},Xn=function(w){var M=Bn(w,"string");return kr(M)?M:M+""},ko=c.document,no=Fe(ko)&&Fe(ko.createElement),Ra=function(w){return no?ko.createElement(w):{}},fs=!Ne&&!d(function(){return Object.defineProperty(Ra("div"),"a",{get:function(){return 7}}).a!=7}),ms=Object.getOwnPropertyDescriptor,ga={f:Ne?ms:function(M,L){if(M=sr(M),L=Xn(L),fs)try{return ms(M,L)}catch{}if(Fr(M,L))return le(!Ce(ze.f,M,L),M[L])}},Bi=/#|\.prototype\./,Fi=function(w,M){var L=Zy[Xy(w)];return L==tb||L!=eb&&(ae(M)?d(M):!!M)},Xy=Fi.normalize=function(w){return String(w).replace(Bi,".").toLowerCase()},Zy=Fi.data={},eb=Fi.NATIVE="N",tb=Fi.POLYFILL="P",af=Fi,rb=he(he.bind),$o=function(w,M){return Or(w),M===void 0?w:m?rb(w,M):function(){return w.apply(M,arguments)}},sf=Ne&&d(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),nb=String,ob=TypeError,Vn=function(w){if(Fe(w))return w;throw ob(nb(w)+" is not an object")},ab=TypeError,ru=Object.defineProperty,sb=Object.getOwnPropertyDescriptor,ib="enumerable",cb="configurable",lb="writable",ua={f:Ne?sf?function(M,L,$){if(Vn(M),L=Xn(L),Vn($),typeof M=="function"&&L==="prototype"&&"value"in $&&lb in $&&!$.writable){var _=sb(M,L);_&&_.writable&&(M[L]=$.value,$={configurable:cb in $?$.configurable:_.configurable,enumerable:ib in $?$.enumerable:_.enumerable,writable:!1})}return ru(M,L,$)}:ru:function(M,L,$){if(Vn(M),L=Xn(L),Vn($),fs)try{return ru(M,L,$)}catch{}if("get"in $||"set"in $)throw ab("Accessors not supported");return"value"in $&&(M[L]=$.value),M}},Jo=Ne?function(w,M,L){return ua.f(w,M,le(1,L))}:function(w,M,L){return w[M]=L,w},ub=ga.f,db=function(w){var M=function(L,$,_){if(this instanceof M){switch(arguments.length){case 0:return new w;case 1:return new w(L);case 2:return new w(L,$)}return new w(L,$,_)}return T(w,this,arguments)};return M.prototype=w.prototype,M},Vr=function(w,M){var L,$,_,Y,Oe,pe,At,jt,ur=w.target,gr=w.global,vr=w.stat,Cr=w.proto,xr=gr?c:vr?c[ur]:(c[ur]||{}).prototype,Br=gr?or:or[ur]||Jo(or,ur,{})[ur],jr=Br.prototype;for(_ in M)L=!af(gr?_:ur+(vr?".":"#")+_,w.forced)&&xr&&Fr(xr,_),Oe=Br[_],L&&(pe=w.dontCallGetSet?(jt=ub(xr,_))&&jt.value:xr[_]),Y=L&&pe?pe:M[_],L&&typeof Oe==typeof Y||(At=w.bind&&L?$o(Y,c):w.wrap&&L?db(Y):Cr&&ae(Y)?he(Y):Y,(w.sham||Y&&Y.sham||Oe&&Oe.sham)&&Jo(At,"sham",!0),Jo(Br,_,At),Cr&&(Fr(or,$=ur+"Prototype")||Jo(or,$,{}),Jo(or[$],_,Y),w.real&&jr&&!jr[_]&&Jo(jr,_,Y)))},pb=Math.ceil,fb=Math.floor,mb=Math.trunc||function(M){var L=+M;return(L>0?fb:pb)(L)},Li=function(w){var M=+w;return M!=M||M===0?0:mb(M)},gb=Math.max,hb=Math.min,ri=function(w,M){var L=Li(w);return L<0?gb(L+M,0):hb(L,M)},vb=Math.min,Ia=function(w){return(M=w.length)>0?vb(Li(M),9007199254740991):0;var M},cf=function(w){return function(M,L,$){var _,Y=sr(M),Oe=Ia(Y),pe=ri($,Oe);if(w&&L!=L){for(;Oe>pe;)if((_=Y[pe++])!=_)return!0}else for(;Oe>pe;pe++)if((w||pe in Y)&&Y[pe]===L)return w||pe||0;return!w&&-1}},nu={includes:cf(!0),indexOf:cf(!1)},ni={},yb=nu.indexOf,lf=he([].push),uf=function(w,M){var L,$=sr(w),_=0,Y=[];for(L in $)!Fr(ni,L)&&Fr($,L)&&lf(Y,L);for(;M.length>_;)Fr($,L=M[_++])&&(~yb(Y,L)||lf(Y,L));return Y},$c=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],gs=Object.keys||function(M){return uf(M,$c)},bb=Ne&&!sf?Object.defineProperties:function(M,L){Vn(M);for(var $,_=sr(L),Y=gs(L),Oe=Y.length,pe=0;Oe>pe;)ua.f(M,$=Y[pe++],_[$]);return M},df={f:bb},ou=$e("document","documentElement"),pf=qr("keys"),jc=function(w){return pf[w]||(pf[w]=uo(w))},ff=jc("IE_PROTO"),au=function(){},mf=function(w){return"<script>"+w+"<\/script>"},gf=function(w){w.write(mf("")),w.close();var M=w.parentWindow.Object;return w=null,M},Dc=function(){try{cr=new ActiveXObject("htmlfile")}catch{}var w,M;Dc=typeof document<"u"?document.domain&&cr?gf(cr):((M=Ra("iframe")).style.display="none",ou.appendChild(M),M.src="javascript:",(w=M.contentWindow.document).open(),w.write(mf("document.F=Object")),w.close(),w.F):gf(cr);for(var L=$c.length;L--;)delete Dc.prototype[$c[L]];return Dc()};ni[ff]=!0;var Ea=Object.create||function(M,L){var $;return M!==null?(au.prototype=Vn(M),$=new au,au.prototype=null,$[ff]=M):$=Dc(),L===void 0?$:df.f($,L)};Vr({target:"Object",stat:!0,sham:!Ne},{create:Ea});var Tb=or.Object,Ja=function(M,L){return Tb.create(M,L)},Sb=String,Cb=TypeError,$i=Object.setPrototypeOf||("__proto__"in{}?function(){var w,M=!1,L={};try{(w=he(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(L,[]),M=L instanceof Array}catch{}return function(_,Y){return Vn(_),function(Oe){if(typeof Oe=="object"||ae(Oe))return Oe;throw Cb("Can't set "+Sb(Oe)+" as a prototype")}(Y),M?w(_,Y):_.__proto__=Y,_}}():void 0);Vr({target:"Object",stat:!0},{setPrototypeOf:$i});var Ns=or.Object.setPrototypeOf,hs=he([].slice),hf=Function,Mb=he([].concat),kb=he([].join),su={},_b=function(w,M,L){if(!Fr(su,M)){for(var $=[],_=0;_<M;_++)$[_]="a["+_+"]";su[M]=hf("C,a","return new C("+kb($,",")+")")}return su[M](w,L)},iu=m?hf.bind:function(M){var L=Or(this),$=L.prototype,_=hs(arguments,1),Y=function(){var pe=Mb(_,hs(arguments));return this instanceof Y?_b(L,pe.length,pe):L.apply(M,pe)};return Fe($)&&(Y.prototype=$),Y};Vr({target:"Function",proto:!0,forced:Function.bind!==iu},{bind:iu});var Uo=function(w){return or[w+"Prototype"]},wb=Uo("Function").bind,cu=Function.prototype,Oo=function(w){var M=w.bind;return w===cu||er(cu,w)&&M===cu.bind?wb:M},lu=o(function(w){function M(L,$){var _;return w.exports=M=Ns?Oo(_=Ns).call(_):function(Oe,pe){return Oe.__proto__=pe,Oe},w.exports.__esModule=!0,w.exports.default=w.exports,M(L,$)}w.exports=M,w.exports.__esModule=!0,w.exports.default=w.exports}),Ro=n(o(function(w){w.exports=function(L,$){L.prototype=Ja($.prototype),L.prototype.constructor=L,lu(L,$)},w.exports.__esModule=!0,w.exports.default=w.exports})),Ya=Array.isArray||function(M){return ie(M)=="Array"},xb=TypeError,uu=function(w){if(w>9007199254740991)throw xb("Maximum allowed index exceeded");return w},Rs=function(w,M,L){var $=Xn(M);$ in w?ua.f(w,$,le(0,L)):w[$]=L},vf={};vf[to("toStringTag")]="z";var du=String(vf)==="[object z]",Ib=to("toStringTag"),Eb=Object,Pb=ie(function(){return arguments}())=="Arguments",Bs=du?ie:function(w){var M,L,$;return w===void 0?"Undefined":w===null?"Null":typeof(L=function(_,Y){try{return _[Y]}catch{}}(M=Eb(w),Ib))=="string"?L:Pb?ie(M):($=ie(M))=="Object"&&ae(M.callee)?"Arguments":$},Ab=he(Function.toString);ae(Ur.inspectSource)||(Ur.inspectSource=function(w){return Ab(w)});var yf=Ur.inspectSource,bf=function(){},Ob=[],Tf=$e("Reflect","construct"),pu=/^\s*(?:class|function)\b/,Nb=he(pu.exec),Rb=!pu.exec(bf),ji=function(M){if(!ae(M))return!1;try{return Tf(bf,Ob,M),!0}catch{return!1}},Sf=function(M){if(!ae(M))return!1;switch(Bs(M)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Rb||!!Nb(pu,yf(M))}catch{return!0}};Sf.sham=!0;var Uc=!Tf||d(function(){var w;return ji(ji.call)||!ji(Object)||!ji(function(){w=!0})||w})?Sf:ji,Bb=to("species"),Cf=Array,fu=function(w,M){return new(function(L){var $;return Ya(L)&&($=L.constructor,(Uc($)&&($===Cf||Ya($.prototype))||Fe($)&&($=$[Bb])===null)&&($=void 0)),$===void 0?Cf:$}(w))(M===0?0:M)},Fb=to("species"),Di=function(w){return mr>=51||!d(function(){var M=[];return(M.constructor={})[Fb]=function(){return{foo:1}},M[w](Boolean).foo!==1})},Mf=to("isConcatSpreadable"),Lb=mr>=51||!d(function(){var w=[];return w[Mf]=!1,w.concat()[0]!==w}),$b=Di("concat"),jb=function(w){if(!Fe(w))return!1;var M=w[Mf];return M!==void 0?!!M:Ya(w)};Vr({target:"Array",proto:!0,arity:1,forced:!Lb||!$b},{concat:function(M){var L,$,_,Y,Oe,pe=$n(this),At=fu(pe,0),jt=0;for(L=-1,_=arguments.length;L<_;L++)if(jb(Oe=L===-1?pe:arguments[L]))for(Y=Ia(Oe),uu(jt+Y),$=0;$<Y;$++,jt++)$ in Oe&&Rs(At,jt,Oe[$]);else uu(jt+1),Rs(At,jt++,Oe);return At.length=jt,At}});var qc,Ui,Vc,Db=String,Aa=function(w){if(Bs(w)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Db(w)},Ub=$c.concat("length","prototype"),qi={f:Object.getOwnPropertyNames||function(M){return uf(M,Ub)}},qb=Array,Vb=Math.max,mu=function(w,M,L){for(var $=Ia(w),_=ri(M,$),Y=ri(L===void 0?$:L,$),Oe=qb(Vb(Y-_,0)),pe=0;_<Y;_++,pe++)Rs(Oe,pe,w[_]);return Oe.length=pe,Oe},kf=qi.f,_f=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],gu={f:function(M){return _f&&ie(M)=="Window"?function(L){try{return kf(L)}catch{return mu(_f)}}(M):kf(sr(M))}},Vi={f:Object.getOwnPropertySymbols},vs=function(w,M,L,$){return $&&$.enumerable?w[M]=L:Jo(w,M,L),w},hu={f:to},Hb=ua.f,wo=function(w){var M=or.Symbol||(or.Symbol={});Fr(M,w)||Hb(M,w,{value:hu.f(w)})},wf=function(){var w=$e("Symbol"),M=w&&w.prototype,L=M&&M.valueOf,$=to("toPrimitive");M&&!M[$]&&vs(M,$,function(_){return Ce(L,this)},{arity:1})},zb=du?{}.toString:function(){return"[object "+Bs(this)+"]"},Kb=ua.f,xf=to("toStringTag"),Fs=function(w,M,L,$){if(w){var _=L?w:w.prototype;Fr(_,xf)||Kb(_,xf,{configurable:!0,value:M}),$&&!du&&Jo(_,"toString",zb)}},If=c.WeakMap,Wb=ae(If)&&/native code/.test(String(If)),Ef="Object already initialized",vu=c.TypeError,Gb=c.WeakMap;if(Wb||Ur.state){var Ls=Ur.state||(Ur.state=new Gb),Qb=he(Ls.get),Pf=he(Ls.has),Jb=he(Ls.set);qc=function(w,M){if(Pf(Ls,w))throw vu(Ef);return M.facade=w,Jb(Ls,w,M),M},Ui=function(w){return Qb(Ls,w)||{}},Vc=function(w){return Pf(Ls,w)}}else{var oi=jc("state");ni[oi]=!0,qc=function(w,M){if(Fr(w,oi))throw vu(Ef);return M.facade=w,Jo(w,oi,M),M},Ui=function(w){return Fr(w,oi)?w[oi]:{}},Vc=function(w){return Fr(w,oi)}}var Pa={set:qc,get:Ui,has:Vc,enforce:function(w){return Vc(w)?Ui(w):qc(w,{})},getterFor:function(w){return function(M){var L;if(!Fe(M)||(L=Ui(M)).type!==w)throw vu("Incompatible receiver, "+w+" required");return L}}},Af=he([].push),ys=function(w){var M=w==1,L=w==2,$=w==3,_=w==4,Y=w==6,Oe=w==7,pe=w==5||Y;return function(At,jt,ur,gr){for(var vr,Cr,xr=$n(At),Br=Dt(xr),jr=$o(jt,ur),zr=Ia(Br),Hr=0,Kr=gr||fu,kn=M?Kr(At,zr):L||Oe?Kr(At,0):void 0;zr>Hr;Hr++)if((pe||Hr in Br)&&(Cr=jr(vr=Br[Hr],Hr,xr),w))if(M)kn[Hr]=Cr;else if(Cr)switch(w){case 3:return!0;case 5:return vr;case 6:return Hr;case 2:Af(kn,vr)}else switch(w){case 4:return!1;case 7:Af(kn,vr)}return Y?-1:$||_?_:kn}},bs={forEach:ys(0),map:ys(1),filter:ys(2),some:ys(3),every:ys(4),find:ys(5),findIndex:ys(6),filterReject:ys(7)},Hc=bs.forEach,da=jc("hidden"),zc="Symbol",Yb=Pa.set,Of=Pa.getterFor(zc),Ba=Object.prototype,$s=c.Symbol,Hi=$s&&$s.prototype,Xb=c.TypeError,yu=c.QObject,Nf=ga.f,Ts=ua.f,Rf=gu.f,Zb=ze.f,Bf=he([].push),Xa=qr("symbols"),zi=qr("op-symbols"),e0=qr("wks"),bu=!yu||!yu.prototype||!yu.prototype.findChild,Tu=Ne&&d(function(){return Ea(Ts({},"a",{get:function(){return Ts(this,"a",{value:7}).a}})).a!=7})?function(w,M,L){var $=Nf(Ba,M);$&&delete Ba[M],Ts(w,M,L),$&&w!==Ba&&Ts(Ba,M,$)}:Ts,Su=function(w,M){var L=Xa[w]=Ea(Hi);return Yb(L,{type:zc,tag:w,description:M}),Ne||(L.description=M),L},Kc=function(M,L,$){M===Ba&&Kc(zi,L,$),Vn(M);var _=Xn(L);return Vn($),Fr(Xa,_)?($.enumerable?(Fr(M,da)&&M[da][_]&&(M[da][_]=!1),$=Ea($,{enumerable:le(0,!1)})):(Fr(M,da)||Ts(M,da,le(1,{})),M[da][_]=!0),Tu(M,_,$)):Ts(M,_,$)},Cu=function(M,L){Vn(M);var $=sr(L),_=gs($).concat(jf($));return Hc(_,function(Y){Ne&&!Ce(Ff,$,Y)||Kc(M,Y,$[Y])}),M},Ff=function(M){var L=Xn(M),$=Ce(Zb,this,L);return!(this===Ba&&Fr(Xa,L)&&!Fr(zi,L))&&(!($||!Fr(this,L)||!Fr(Xa,L)||Fr(this,da)&&this[da][L])||$)},Lf=function(M,L){var $=sr(M),_=Xn(L);if($!==Ba||!Fr(Xa,_)||Fr(zi,_)){var Y=Nf($,_);return!Y||!Fr(Xa,_)||Fr($,da)&&$[da][_]||(Y.enumerable=!0),Y}},$f=function(M){var L=Rf(sr(M)),$=[];return Hc(L,function(_){Fr(Xa,_)||Fr(ni,_)||Bf($,_)}),$},jf=function(w){var M=w===Ba,L=Rf(M?zi:sr(w)),$=[];return Hc(L,function(_){!Fr(Xa,_)||M&&!Fr(Ba,_)||Bf($,Xa[_])}),$};yr||($s=function(){if(er(Hi,this))throw Xb("Symbol is not a constructor");var M=arguments.length&&arguments[0]!==void 0?Aa(arguments[0]):void 0,L=uo(M),$=function(_){this===Ba&&Ce($,zi,_),Fr(this,da)&&Fr(this[da],L)&&(this[da][L]=!1),Tu(this,L,le(1,_))};return Ne&&bu&&Tu(Ba,L,{configurable:!0,set:$}),Su(L,M)},Hi=$s.prototype,vs(Hi,"toString",function(){return Of(this).tag}),vs($s,"withoutSetter",function(w){return Su(uo(w),w)}),ze.f=Ff,ua.f=Kc,df.f=Cu,ga.f=Lf,qi.f=gu.f=$f,Vi.f=jf,hu.f=function(w){return Su(to(w),w)},Ne&&Ts(Hi,"description",{configurable:!0,get:function(){return Of(this).description}})),Vr({global:!0,constructor:!0,wrap:!0,forced:!yr,sham:!yr},{Symbol:$s}),Hc(gs(e0),function(w){wo(w)}),Vr({target:zc,stat:!0,forced:!yr},{useSetter:function(){bu=!0},useSimple:function(){bu=!1}}),Vr({target:"Object",stat:!0,forced:!yr,sham:!Ne},{create:function(M,L){return L===void 0?Ea(M):Cu(Ea(M),L)},defineProperty:Kc,defineProperties:Cu,getOwnPropertyDescriptor:Lf}),Vr({target:"Object",stat:!0,forced:!yr},{getOwnPropertyNames:$f}),wf(),Fs($s,zc),ni[da]=!0;var Df=yr&&!!Symbol.for&&!!Symbol.keyFor,Mu=qr("string-to-symbol-registry"),t0=qr("symbol-to-string-registry");Vr({target:"Symbol",stat:!0,forced:!Df},{for:function(w){var M=Aa(w);if(Fr(Mu,M))return Mu[M];var L=$e("Symbol")(M);return Mu[M]=L,t0[L]=M,L}});var Uf=qr("symbol-to-string-registry");Vr({target:"Symbol",stat:!0,forced:!Df},{keyFor:function(M){if(!kr(M))throw TypeError(Rr(M)+" is not a symbol");if(Fr(Uf,M))return Uf[M]}});var Ss=$e("JSON","stringify"),Wc=he(/./.exec),qf=he("".charAt),r0=he("".charCodeAt),n0=he("".replace),o0=he(1 .toString),a0=/[\uD800-\uDFFF]/g,Vf=/^[\uD800-\uDBFF]$/,Hf=/^[\uDC00-\uDFFF]$/,zf=!yr||d(function(){var w=$e("Symbol")();return Ss([w])!="[null]"||Ss({a:w})!="{}"||Ss(Object(w))!="{}"}),Kf=d(function(){return Ss("\uDF06\uD834")!=='"\\udf06\\ud834"'||Ss("\uDEAD")!=='"\\udead"'}),s0=function(w,M){var L=hs(arguments),$=M;if((Fe(M)||w!==void 0)&&!kr(w))return Ya(M)||(M=function(_,Y){if(ae($)&&(Y=Ce($,this,_,Y)),!kr(Y))return Y}),L[1]=M,T(Ss,null,L)},i0=function(w,M,L){var $=qf(L,M-1),_=qf(L,M+1);return Wc(Vf,w)&&!Wc(Hf,_)||Wc(Hf,w)&&!Wc(Vf,$)?"\\u"+o0(r0(w,0),16):w};Ss&&Vr({target:"JSON",stat:!0,arity:3,forced:zf||Kf},{stringify:function(M,L,$){var _=hs(arguments),Y=T(zf?s0:Ss,null,_);return Kf&&typeof Y=="string"?n0(Y,a0,i0):Y}});var c0=!yr||d(function(){Vi.f(1)});Vr({target:"Object",stat:!0,forced:c0},{getOwnPropertySymbols:function(M){var L=Vi.f;return L?L($n(M)):[]}}),wo("asyncIterator"),wo("hasInstance"),wo("isConcatSpreadable"),wo("iterator"),wo("match"),wo("matchAll"),wo("replace"),wo("search"),wo("species"),wo("split"),wo("toPrimitive"),wf(),wo("toStringTag"),Fs($e("Symbol"),"Symbol"),wo("unscopables"),Fs(c.JSON,"JSON",!0);var Cs,Wf,Gf,l0=or.Symbol,Za={},Qf=Function.prototype,u0=Ne&&Object.getOwnPropertyDescriptor,ku=Fr(Qf,"name"),d0={EXISTS:ku,PROPER:ku&&(function(){}).name==="something",CONFIGURABLE:ku&&(!Ne||Ne&&u0(Qf,"name").configurable)},Jf=!d(function(){function w(){}return w.prototype.constructor=null,Object.getPrototypeOf(new w)!==w.prototype}),Yf=jc("IE_PROTO"),_u=Object,p0=_u.prototype,ai=Jf?_u.getPrototypeOf:function(w){var M=$n(w);if(Fr(M,Yf))return M[Yf];var L=M.constructor;return ae(L)&&M instanceof L?L.prototype:M instanceof _u?p0:null},wu=to("iterator"),Xf=!1;[].keys&&("next"in(Gf=[].keys())?(Wf=ai(ai(Gf)))!==Object.prototype&&(Cs=Wf):Xf=!0);var f0=!Fe(Cs)||d(function(){var w={};return Cs[wu].call(w)!==w});Cs=f0?{}:Ea(Cs),ae(Cs[wu])||vs(Cs,wu,function(){return this});var Zf={IteratorPrototype:Cs,BUGGY_SAFARI_ITERATORS:Xf},m0=Zf.IteratorPrototype,g0=function(){return this},h0=d0.PROPER,Gc=Zf.BUGGY_SAFARI_ITERATORS,xu=to("iterator"),em="keys",Qc="values",tm="entries",v0=function(){return this},Iu=function(w,M,L,$,_,Y,Oe){(function(zr,Hr,Kr,kn){var Jn=Hr+" Iterator";zr.prototype=Ea(m0,{next:le(+!kn,Kr)}),Fs(zr,Jn,!1,!0),Za[Jn]=g0})(L,M,$);var pe,At,jt,ur=function(zr){if(zr===_&&Br)return Br;if(!Gc&&zr in Cr)return Cr[zr];switch(zr){case em:return function(){return new L(this,zr)};case Qc:return function(){return new L(this,zr)};case tm:return function(){return new L(this,zr)}}return function(){return new L(this)}},gr=M+" Iterator",vr=!1,Cr=w.prototype,xr=Cr[xu]||Cr["@@iterator"]||_&&Cr[_],Br=!Gc&&xr||ur(_),jr=M=="Array"&&Cr.entries||xr;if(jr&&(pe=ai(jr.call(new w)))!==Object.prototype&&pe.next&&(Fs(pe,gr,!0,!0),Za[gr]=v0),h0&&_==Qc&&xr&&xr.name!==Qc&&(vr=!0,Br=function(){return Ce(xr,this)}),_)if(At={values:ur(Qc),keys:Y?Br:ur(em),entries:ur(tm)},Oe)for(jt in At)(Gc||vr||!(jt in Cr))&&vs(Cr,jt,At[jt]);else Vr({target:M,proto:!0,forced:Gc||vr},At);return Oe&&Cr[xu]!==Br&&vs(Cr,xu,Br,{name:_}),Za[M]=Br,At};ua.f;var rm="Array Iterator",y0=Pa.set,b0=Pa.getterFor(rm);Iu(Array,"Array",function(w,M){y0(this,{type:rm,target:sr(w),index:0,kind:M})},function(){var w=b0(this),M=w.target,L=w.kind,$=w.index++;return!M||$>=M.length?(w.target=void 0,{value:void 0,done:!0}):L=="keys"?{value:$,done:!1}:L=="values"?{value:M[$],done:!1}:{value:[$,M[$]],done:!1}},"values"),Za.Arguments=Za.Array;var nm=to("toStringTag");for(var Eu in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var om=c[Eu],Pu=om&&om.prototype;Pu&&Bs(Pu)!==nm&&Jo(Pu,nm,Eu),Za[Eu]=Za.Array}var T0=l0;wo("asyncDispose"),wo("dispose"),wo("matcher"),wo("metadataKey"),wo("observable"),wo("metadata"),wo("patternMatch"),wo("replaceAll");var ha=T0,S0=he("".charAt),am=he("".charCodeAt),C0=he("".slice),sm=function(w){return function(M,L){var $,_,Y=Aa(fr(M)),Oe=Li(L),pe=Y.length;return Oe<0||Oe>=pe?w?"":void 0:($=am(Y,Oe))<55296||$>56319||Oe+1===pe||(_=am(Y,Oe+1))<56320||_>57343?w?S0(Y,Oe):$:w?C0(Y,Oe,Oe+2):_-56320+($-55296<<10)+65536}},M0={codeAt:sm(!1),charAt:sm(!0)}.charAt,im="String Iterator",k0=Pa.set,_0=Pa.getterFor(im);Iu(String,"String",function(w){k0(this,{type:im,string:Aa(w),index:0})},function(){var M,L=_0(this),$=L.string,_=L.index;return _>=$.length?{value:void 0,done:!0}:(M=M0($,_),L.index+=M.length,{value:M,done:!1})});var cm=hu.f("iterator"),w0=o(function(w){function M(L){return w.exports=M=typeof ha=="function"&&typeof cm=="symbol"?function($){return typeof $}:function($){return $&&typeof ha=="function"&&$.constructor===ha&&$!==ha.prototype?"symbol":typeof $},w.exports.__esModule=!0,w.exports.default=w.exports,M(L)}w.exports=M,w.exports.__esModule=!0,w.exports.default=w.exports}),lm=ua.f;Vr({target:"Object",stat:!0,forced:Object.defineProperty!==lm,sham:!Ne},{defineProperty:lm});var x0=o(function(w){var M=or.Object,L=w.exports=function(_,Y,Oe){return M.defineProperty(_,Y,Oe)};M.defineProperty.sham&&(L.sham=!0)}),Ki=x0,I0=d(function(){ai(1)});Vr({target:"Object",stat:!0,forced:I0,sham:!Jf},{getPrototypeOf:function(M){return ai($n(M))}});var js=or.Object.getPrototypeOf,Ds=function(w,M){var L=[][w];return!!L&&d(function(){L.call(null,M||function(){return 1},1)})},E0=bs.forEach,um=Ds("forEach")?[].forEach:function(M){return E0(this,M,arguments.length>1?arguments[1]:void 0)};Vr({target:"Array",proto:!0,forced:[].forEach!=um},{forEach:um});var P0=Uo("Array").forEach,Au=Array.prototype,A0={DOMTokenList:!0,NodeList:!0},In=function(w){var M=w.forEach;return w===Au||er(Au,w)&&M===Au.forEach||Fr(A0,Bs(w))?P0:M},O0=he([].concat),N0=$e("Reflect","ownKeys")||function(M){var L=qi.f(Vn(M)),$=Vi.f;return $?O0(L,$(M)):L},dm=Error,R0=he("".replace),B0=String(dm("zxcasd").stack),pm=/\n\s*at [^:]*:[^\n]*/,F0=pm.test(B0),L0=function(w,M){if(F0&&typeof w=="string"&&!dm.prepareStackTrace)for(;M--;)w=R0(w,pm,"");return w},$0=function(w,M){Fe(M)&&"cause"in M&&Jo(w,"cause",M.cause)},j0=to("iterator"),D0=Array.prototype,fm=function(w){return w!==void 0&&(Za.Array===w||D0[j0]===w)},U0=to("iterator"),Jc=function(w){if(!tr(w))return Pr(w,U0)||Pr(w,"@@iterator")||Za[Bs(w)]},q0=TypeError,Wi=function(w,M){var L=arguments.length<2?Jc(w):M;if(Or(L))return Vn(Ce(L,w));throw q0(Rr(w)+" is not iterable")},Ou=function(w,M,L){var $,_;Vn(w);try{if(!($=Pr(w,"return"))){if(M==="throw")throw L;return L}$=Ce($,w)}catch(Y){_=!0,$=Y}if(M==="throw")throw L;if(_)throw $;return Vn($),L},V0=TypeError,Yc=function(w,M){this.stopped=w,this.result=M},mm=Yc.prototype,so=function(w,M,L){var $,_,Y,Oe,pe,At,jt,ur=L&&L.that,gr=!(!L||!L.AS_ENTRIES),vr=!(!L||!L.IS_RECORD),Cr=!(!L||!L.IS_ITERATOR),xr=!(!L||!L.INTERRUPTED),Br=$o(M,ur),jr=function(Hr){return $&&Ou($,"normal",Hr),new Yc(!0,Hr)},zr=function(Hr){return gr?(Vn(Hr),xr?Br(Hr[0],Hr[1],jr):Br(Hr[0],Hr[1])):xr?Br(Hr,jr):Br(Hr)};if(vr)$=w.iterator;else if(Cr)$=w;else{if(!(_=Jc(w)))throw V0(Rr(w)+" is not iterable");if(fm(_)){for(Y=0,Oe=Ia(w);Oe>Y;Y++)if((pe=zr(w[Y]))&&er(mm,pe))return pe;return new Yc(!1)}$=Wi(w,_)}for(At=vr?w.next:$.next;!(jt=Ce(At,$)).done;){try{pe=zr(jt.value)}catch(Hr){Ou($,"throw",Hr)}if(typeof pe=="object"&&pe&&er(mm,pe))return pe}return new Yc(!1)},H0=function(w,M){return w===void 0?arguments.length<2?"":M:Aa(w)},z0=!d(function(){var w=Error("a");return!("stack"in w)||(Object.defineProperty(w,"stack",le(1,7)),w.stack!==7)}),K0=to("toStringTag"),Xc=Error,W0=[].push,Gi=function(M,L){var $,_=arguments.length>2?arguments[2]:void 0,Y=er(Nu,this);$i?$=$i(Xc(),Y?ai(this):Nu):($=Y?this:Ea(Nu),Jo($,K0,"Error")),L!==void 0&&Jo($,"message",H0(L)),z0&&Jo($,"stack",L0($.stack,1)),$0($,_);var Oe=[];return so(M,W0,{that:Oe}),Jo($,"errors",Oe),$};$i?$i(Gi,Xc):function(w,M,L){for(var $=N0(M),_=ua.f,Y=ga.f,Oe=0;Oe<$.length;Oe++){var pe=$[Oe];Fr(w,pe)||L&&Fr(L,pe)||_(w,pe,Y(M,pe))}}(Gi,Xc,{name:!0});var Nu=Gi.prototype=Ea(Xc.prototype,{constructor:le(1,Gi),message:le(1,""),name:le(1,"AggregateError")});Vr({global:!0,constructor:!0,arity:2},{AggregateError:Gi});var Qi,si,gm,Ru,Ua=ie(c.process)=="process",hm=to("species"),vm=function(w){var M=$e(w),L=ua.f;Ne&&M&&!M[hm]&&L(M,hm,{configurable:!0,get:function(){return this}})},G0=TypeError,Bu=function(w,M){if(er(M,w))return w;throw G0("Incorrect invocation")},Q0=TypeError,Zc=function(w){if(Uc(w))return w;throw Q0(Rr(w)+" is not a constructor")},J0=to("species"),Ms=function(w,M){var L,$=Vn(w).constructor;return $===void 0||tr(L=Vn($)[J0])?M:Zc(L)},Y0=TypeError,ym=function(w,M){if(w<M)throw Y0("Not enough arguments");return w},bm=/(?:ipad|iphone|ipod).*applewebkit/i.test(nr),Fu=c.setImmediate,Lu=c.clearImmediate,X0=c.process,$u=c.Dispatch,Z0=c.Function,Tm=c.MessageChannel,e1=c.String,ju=0,Ji={},t1="onreadystatechange";try{Qi=c.location}catch{}var Du=function(w){if(Fr(Ji,w)){var M=Ji[w];delete Ji[w],M()}},Uu=function(w){return function(){Du(w)}},Sm=function(w){Du(w.data)},Cm=function(w){c.postMessage(e1(w),Qi.protocol+"//"+Qi.host)};Fu&&Lu||(Fu=function(M){ym(arguments.length,1);var L=ae(M)?M:Z0(M),$=hs(arguments,1);return Ji[++ju]=function(){T(L,void 0,$)},si(ju),ju},Lu=function(M){delete Ji[M]},Ua?si=function(w){X0.nextTick(Uu(w))}:$u&&$u.now?si=function(w){$u.now(Uu(w))}:Tm&&!bm?(Ru=(gm=new Tm).port2,gm.port1.onmessage=Sm,si=$o(Ru.postMessage,Ru)):c.addEventListener&&ae(c.postMessage)&&!c.importScripts&&Qi&&Qi.protocol!=="file:"&&!d(Cm)?(si=Cm,c.addEventListener("message",Sm,!1)):si=t1 in Ra("script")?function(w){ou.appendChild(Ra("script")).onreadystatechange=function(){ou.removeChild(this),Du(w)}}:function(w){setTimeout(Uu(w),0)});var Yi,Us,Xi,ii,qu,Vu,Hu,Mm,km={set:Fu,clear:Lu},r1=/ipad|iphone|ipod/i.test(nr)&&c.Pebble!==void 0,n1=/web0s(?!.*chrome)/i.test(nr),o1=ga.f,zu=km.set,_m=c.MutationObserver||c.WebKitMutationObserver,wm=c.document,xm=c.process,el=c.Promise,Im=o1(c,"queueMicrotask"),Em=Im&&Im.value;Em||(Yi=function(){var w,M;for(Ua&&(w=xm.domain)&&w.exit();Us;){M=Us.fn,Us=Us.next;try{M()}catch(L){throw Us?ii():Xi=void 0,L}}Xi=void 0,w&&w.enter()},bm||Ua||n1||!_m||!wm?!r1&&el&&el.resolve?((Hu=el.resolve(void 0)).constructor=el,Mm=$o(Hu.then,Hu),ii=function(){Mm(Yi)}):Ua?ii=function(){xm.nextTick(Yi)}:(zu=$o(zu,c),ii=function(){zu(Yi)}):(qu=!0,Vu=wm.createTextNode(""),new _m(Yi).observe(Vu,{characterData:!0}),ii=function(){Vu.data=qu=!qu}));var Ku=Em||function(w){var M={fn:w,next:void 0};Xi&&(Xi.next=M),Us||(Us=M,ii()),Xi=M},ci=function(w){try{return{error:!1,value:w()}}catch(M){return{error:!0,value:M}}},Pm=function(){this.head=null,this.tail=null};Pm.prototype={add:function(w){var M={item:w,next:null};this.head?this.tail.next=M:this.head=M,this.tail=M},get:function(){var w=this.head;if(w)return this.head=w.next,this.tail===w&&(this.tail=null),w.item}};var Wu,Am,a1=Pm,ra=c.Promise,Om=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",s1=!Om&&!Ua&&typeof window=="object"&&typeof document=="object",Nm=ra&&ra.prototype,i1=to("species"),Rm=!1,Bm=ae(c.PromiseRejectionEvent),c1=af("Promise",function(){var w=yf(ra),M=w!==String(ra);if(!M&&mr===66||!Nm.catch||!Nm.finally)return!0;if(!mr||mr<51||!/native code/.test(w)){var L=new ra(function(_){_(1)}),$=function(_){_(function(){},function(){})};if((L.constructor={})[i1]=$,!(Rm=L.then(function(){})instanceof $))return!0}return!M&&(s1||Om)&&!Bm}),li={CONSTRUCTOR:c1,REJECTION_EVENT:Bm,SUBCLASSING:Rm},l1=TypeError,u1=function(w){var M,L;this.promise=new w(function($,_){if(M!==void 0||L!==void 0)throw l1("Bad Promise constructor");M=$,L=_}),this.resolve=Or(M),this.reject=Or(L)},es={f:function(w){return new u1(w)}},Fm=km.set,tl="Promise",Lm=li.CONSTRUCTOR,d1=li.REJECTION_EVENT,Gu=Pa.getterFor(tl),p1=Pa.set,f1=ra&&ra.prototype,Zi=ra,Qu=f1,$m=c.TypeError,Ju=c.document,Yu=c.process,Xu=es.f,m1=Xu,g1=!!(Ju&&Ju.createEvent&&c.dispatchEvent),jm="unhandledrejection",Dm=function(w){var M;return!(!Fe(w)||!ae(M=w.then))&&M},Um=function(w,M){var L,$,_,Y=M.value,Oe=M.state==1,pe=Oe?w.ok:w.fail,At=w.resolve,jt=w.reject,ur=w.domain;try{pe?(Oe||(M.rejection===2&&v1(M),M.rejection=1),pe===!0?L=Y:(ur&&ur.enter(),L=pe(Y),ur&&(ur.exit(),_=!0)),L===w.promise?jt($m("Promise-chain cycle")):($=Dm(L))?Ce($,L,At,jt):At(L)):jt(Y)}catch(gr){ur&&!_&&ur.exit(),jt(gr)}},qm=function(w,M){w.notified||(w.notified=!0,Ku(function(){for(var L,$=w.reactions;L=$.get();)Um(L,w);w.notified=!1,M&&!w.rejection&&h1(w)}))},Vm=function(w,M,L){var $,_;g1?(($=Ju.createEvent("Event")).promise=M,$.reason=L,$.initEvent(w,!1,!0),c.dispatchEvent($)):$={promise:M,reason:L},!d1&&(_=c["on"+w])?_($):w===jm&&function(Y,Oe){var pe=c.console;pe&&pe.error&&(arguments.length==1?pe.error(Y):pe.error(Y,Oe))}("Unhandled promise rejection",L)},h1=function(w){Ce(Fm,c,function(){var M,L=w.facade,$=w.value;if(Hm(w)&&(M=ci(function(){Ua?Yu.emit("unhandledRejection",$,L):Vm(jm,L,$)}),w.rejection=Ua||Hm(w)?2:1,M.error))throw M.value})},Hm=function(w){return w.rejection!==1&&!w.parent},v1=function(w){Ce(Fm,c,function(){var M=w.facade;Ua?Yu.emit("rejectionHandled",M):Vm("rejectionhandled",M,w.value)})},ui=function(w,M,L){return function($){w(M,$,L)}},di=function(w,M,L){w.done||(w.done=!0,L&&(w=L),w.value=M,w.state=2,qm(w,!0))},Zu=function(w,M,L){if(!w.done){w.done=!0,L&&(w=L);try{if(w.facade===M)throw $m("Promise can't be resolved itself");var $=Dm(M);$?Ku(function(){var _={done:!1};try{Ce($,M,ui(Zu,_,w),ui(di,_,w))}catch(Y){di(_,Y,w)}}):(w.value=M,w.state=1,qm(w,!1))}catch(_){di({done:!1},_,w)}}};Lm&&(Qu=(Zi=function(M){Bu(this,Qu),Or(M),Ce(Wu,this);var L=Gu(this);try{M(ui(Zu,L),ui(di,L))}catch($){di(L,$)}}).prototype,(Wu=function(M){p1(this,{type:tl,done:!1,notified:!1,parent:!1,reactions:new a1,rejection:!1,state:0,value:void 0})}).prototype=vs(Qu,"then",function(M,L){var $=Gu(this),_=Xu(Ms(this,Zi));return $.parent=!0,_.ok=!ae(M)||M,_.fail=ae(L)&&L,_.domain=Ua?Yu.domain:void 0,$.state==0?$.reactions.add(_):Ku(function(){Um(_,$)}),_.promise}),Am=function(){var w=new Wu,M=Gu(w);this.promise=w,this.resolve=ui(Zu,M),this.reject=ui(di,M)},es.f=Xu=function(w){return w===Zi||w===void 0?new Am(w):m1(w)}),Vr({global:!0,constructor:!0,wrap:!0,forced:Lm},{Promise:Zi}),Fs(Zi,tl,!1,!0),vm(tl);var zm=to("iterator"),Km=!1;try{var y1=0,Wm={next:function(){return{done:!!y1++}},return:function(){Km=!0}};Wm[zm]=function(){return this},Array.from(Wm,function(){throw 2})}catch{}var Gm=function(w,M){if(!M&&!Km)return!1;var L=!1;try{var $={};$[zm]=function(){return{next:function(){return{done:L=!0}}}},w($)}catch{}return L},Qm=li.CONSTRUCTOR||!Gm(function(w){ra.all(w).then(void 0,function(){})});Vr({target:"Promise",stat:!0,forced:Qm},{all:function(M){var L=this,$=es.f(L),_=$.resolve,Y=$.reject,Oe=ci(function(){var pe=Or(L.resolve),At=[],jt=0,ur=1;so(M,function(gr){var vr=jt++,Cr=!1;ur++,Ce(pe,L,gr).then(function(xr){Cr||(Cr=!0,At[vr]=xr,--ur||_(At))},Y)}),--ur||_(At)});return Oe.error&&Y(Oe.value),$.promise}});var b1=li.CONSTRUCTOR;ra&&ra.prototype,Vr({target:"Promise",proto:!0,forced:b1,real:!0},{catch:function(w){return this.then(void 0,w)}}),Vr({target:"Promise",stat:!0,forced:Qm},{race:function(M){var L=this,$=es.f(L),_=$.reject,Y=ci(function(){var Oe=Or(L.resolve);so(M,function(pe){Ce(Oe,L,pe).then($.resolve,_)})});return Y.error&&_(Y.value),$.promise}}),Vr({target:"Promise",stat:!0,forced:li.CONSTRUCTOR},{reject:function(M){var L=es.f(this);return Ce(L.reject,void 0,M),L.promise}});var ed=function(w,M){if(Vn(w),Fe(M)&&M.constructor===w)return M;var L=es.f(w);return(0,L.resolve)(M),L.promise},T1=li.CONSTRUCTOR,S1=$e("Promise"),C1=!T1;Vr({target:"Promise",stat:!0,forced:!0},{resolve:function(M){return ed(C1&&this===S1?ra:this,M)}}),Vr({target:"Promise",stat:!0},{allSettled:function(M){var L=this,$=es.f(L),_=$.resolve,Y=$.reject,Oe=ci(function(){var pe=Or(L.resolve),At=[],jt=0,ur=1;so(M,function(gr){var vr=jt++,Cr=!1;ur++,Ce(pe,L,gr).then(function(xr){Cr||(Cr=!0,At[vr]={status:"fulfilled",value:xr},--ur||_(At))},function(xr){Cr||(Cr=!0,At[vr]={status:"rejected",reason:xr},--ur||_(At))})}),--ur||_(At)});return Oe.error&&Y(Oe.value),$.promise}});var Jm="No one promise resolved";Vr({target:"Promise",stat:!0},{any:function(M){var L=this,$=$e("AggregateError"),_=es.f(L),Y=_.resolve,Oe=_.reject,pe=ci(function(){var At=Or(L.resolve),jt=[],ur=0,gr=1,vr=!1;so(M,function(Cr){var xr=ur++,Br=!1;gr++,Ce(At,L,Cr).then(function(jr){Br||vr||(vr=!0,Y(jr))},function(jr){Br||vr||(Br=!0,jt[xr]=jr,--gr||Oe(new $(jt,Jm)))})}),--gr||Oe(new $(jt,Jm))});return pe.error&&Oe(pe.value),_.promise}});var M1=ra&&ra.prototype,k1=!!ra&&d(function(){M1.finally.call({then:function(){}},function(){})});Vr({target:"Promise",proto:!0,real:!0,forced:k1},{finally:function(w){var M=Ms(this,$e("Promise")),L=ae(w);return this.then(L?function($){return ed(M,w()).then(function(){return $})}:w,L?function($){return ed(M,w()).then(function(){throw $})}:w)}});var _1=or.Promise;Vr({target:"Promise",stat:!0,forced:!0},{try:function(w){var M=es.f(this),L=ci(w);return(L.error?M.reject:M.resolve)(L.value),M.promise}});var co=_1,w1=he([].reverse),Ym=[1,2];Vr({target:"Array",proto:!0,forced:String(Ym)===String(Ym.reverse())},{reverse:function(){return Ya(this)&&(this.length=this.length),w1(this)}});var x1=Uo("Array").reverse,td=Array.prototype,kl=function(w){var M=w.reverse;return w===td||er(td,w)&&M===td.reverse?x1:M},I1=Di("slice"),E1=to("species"),rd=Array,P1=Math.max;Vr({target:"Array",proto:!0,forced:!I1},{slice:function(M,L){var $,_,Y,Oe=sr(this),pe=Ia(Oe),At=ri(M,pe),jt=ri(L===void 0?pe:L,pe);if(Ya(Oe)&&($=Oe.constructor,(Uc($)&&($===rd||Ya($.prototype))||Fe($)&&($=$[E1])===null)&&($=void 0),$===rd||$===void 0))return hs(Oe,At,jt);for(_=new($===void 0?rd:$)(P1(jt-At,0)),Y=0;At<jt;At++,Y++)At in Oe&&Rs(_,Y,Oe[At]);return _.length=Y,_}});var A1=Uo("Array").slice,nd=Array.prototype,Co=function(w){var M=w.slice;return w===nd||er(nd,w)&&M===nd.slice?A1:M},O1=o(function(w){var M=w0.default;function L(){w.exports=L=function(){return $},w.exports.__esModule=!0,w.exports.default=w.exports;var $={},_=Object.prototype,Y=_.hasOwnProperty,Oe=typeof ha=="function"?ha:{},pe=Oe.iterator||"@@iterator",At=Oe.asyncIterator||"@@asyncIterator",jt=Oe.toStringTag||"@@toStringTag";function ur(_n,bn,Rn){return Ki(_n,bn,{value:Rn,enumerable:!0,configurable:!0,writable:!0}),_n[bn]}try{ur({},"")}catch{ur=function(Rn,qn,oo){return Rn[qn]=oo}}function gr(_n,bn,Rn,qn){var oo=bn&&bn.prototype instanceof xr?bn:xr,ao=Ja(oo.prototype),Ko=new _r(qn||[]);return ao._invoke=function(Po,ja,Mo){var Ao="suspendedStart";return function(oa,Lc){if(Ao==="executing")throw new Error("Generator is already running");if(Ao==="completed"){if(oa==="throw")throw Lc;return Fn()}for(Mo.method=oa,Mo.arg=Lc;;){var Fo=Mo.delegate;if(Fo){var hc=Hn(Fo,Mo);if(hc){if(hc===Cr)continue;return hc}}if(Mo.method==="next")Mo.sent=Mo._sent=Mo.arg;else if(Mo.method==="throw"){if(Ao==="suspendedStart")throw Ao="completed",Mo.arg;Mo.dispatchException(Mo.arg)}else Mo.method==="return"&&Mo.abrupt("return",Mo.arg);Ao="executing";var Ka=vr(Po,ja,Mo);if(Ka.type==="normal"){if(Ao=Mo.done?"completed":"suspendedYield",Ka.arg===Cr)continue;return{value:Ka.arg,done:Mo.done}}Ka.type==="throw"&&(Ao="completed",Mo.method="throw",Mo.arg=Ka.arg)}}}(_n,Rn,Ko),ao}function vr(_n,bn,Rn){try{return{type:"normal",arg:_n.call(bn,Rn)}}catch(qn){return{type:"throw",arg:qn}}}$.wrap=gr;var Cr={};function xr(){}function Br(){}function jr(){}var zr={};ur(zr,pe,function(){return this});var Hr=js&&js(js(Pn([])));Hr&&Hr!==_&&Y.call(Hr,pe)&&(zr=Hr);var Kr=jr.prototype=xr.prototype=Ja(zr);function kn(_n){var bn;In(bn=["next","throw","return"]).call(bn,function(Rn){ur(_n,Rn,function(qn){return this._invoke(Rn,qn)})})}function Jn(_n,bn){function Rn(oo,ao,Ko,Po){var ja=vr(_n[oo],_n,ao);if(ja.type!=="throw"){var Mo=ja.arg,Ao=Mo.value;return Ao&&M(Ao)=="object"&&Y.call(Ao,"__await")?bn.resolve(Ao.__await).then(function(oa){Rn("next",oa,Ko,Po)},function(oa){Rn("throw",oa,Ko,Po)}):bn.resolve(Ao).then(function(oa){Mo.value=oa,Ko(Mo)},function(oa){return Rn("throw",oa,Ko,Po)})}Po(ja.arg)}var qn;this._invoke=function(oo,ao){function Ko(){return new bn(function(Po,ja){Rn(oo,ao,Po,ja)})}return qn=qn?qn.then(Ko,Ko):Ko()}}function Hn(_n,bn){var Rn=_n.iterator[bn.method];if(Rn===void 0){if(bn.delegate=null,bn.method==="throw"){if(_n.iterator.return&&(bn.method="return",bn.arg=void 0,Hn(_n,bn),bn.method==="throw"))return Cr;bn.method="throw",bn.arg=new TypeError("The iterator does not provide a 'throw' method")}return Cr}var qn=vr(Rn,_n.iterator,bn.arg);if(qn.type==="throw")return bn.method="throw",bn.arg=qn.arg,bn.delegate=null,Cr;var oo=qn.arg;return oo?oo.done?(bn[_n.resultName]=oo.value,bn.next=_n.nextLoc,bn.method!=="return"&&(bn.method="next",bn.arg=void 0),bn.delegate=null,Cr):oo:(bn.method="throw",bn.arg=new TypeError("iterator result is not an object"),bn.delegate=null,Cr)}function xo(_n){var bn={tryLoc:_n[0]};1 in _n&&(bn.catchLoc=_n[1]),2 in _n&&(bn.finallyLoc=_n[2],bn.afterLoc=_n[3]),this.tryEntries.push(bn)}function Ln(_n){var bn=_n.completion||{};bn.type="normal",delete bn.arg,_n.completion=bn}function _r(_n){this.tryEntries=[{tryLoc:"root"}],In(_n).call(_n,xo,this),this.reset(!0)}function Pn(_n){if(_n){var bn=_n[pe];if(bn)return bn.call(_n);if(typeof _n.next=="function")return _n;if(!isNaN(_n.length)){var Rn=-1,qn=function oo(){for(;++Rn<_n.length;)if(Y.call(_n,Rn))return oo.value=_n[Rn],oo.done=!1,oo;return oo.value=void 0,oo.done=!0,oo};return qn.next=qn}}return{next:Fn}}function Fn(){return{value:void 0,done:!0}}return Br.prototype=jr,ur(Kr,"constructor",jr),ur(jr,"constructor",Br),Br.displayName=ur(jr,jt,"GeneratorFunction"),$.isGeneratorFunction=function(_n){var bn=typeof _n=="function"&&_n.constructor;return!!bn&&(bn===Br||(bn.displayName||bn.name)==="GeneratorFunction")},$.mark=function(_n){return Ns?Ns(_n,jr):(_n.__proto__=jr,ur(_n,jt,"GeneratorFunction")),_n.prototype=Ja(Kr),_n},$.awrap=function(_n){return{__await:_n}},kn(Jn.prototype),ur(Jn.prototype,At,function(){return this}),$.AsyncIterator=Jn,$.async=function(_n,bn,Rn,qn,oo){oo===void 0&&(oo=co);var ao=new Jn(gr(_n,bn,Rn,qn),oo);return $.isGeneratorFunction(bn)?ao:ao.next().then(function(Ko){return Ko.done?Ko.value:ao.next()})},kn(Kr),ur(Kr,jt,"Generator"),ur(Kr,pe,function(){return this}),ur(Kr,"toString",function(){return"[object Generator]"}),$.keys=function(_n){var bn=[];for(var Rn in _n)bn.push(Rn);return kl(bn).call(bn),function qn(){for(;bn.length;){var oo=bn.pop();if(oo in _n)return qn.value=oo,qn.done=!1,qn}return qn.done=!0,qn}},$.values=Pn,_r.prototype={constructor:_r,reset:function(bn){var Rn;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,In(Rn=this.tryEntries).call(Rn,Ln),!bn)for(var qn in this)qn.charAt(0)==="t"&&Y.call(this,qn)&&!isNaN(+Co(qn).call(qn,1))&&(this[qn]=void 0)},stop:function(){this.done=!0;var bn=this.tryEntries[0].completion;if(bn.type==="throw")throw bn.arg;return this.rval},dispatchException:function(bn){if(this.done)throw bn;var Rn=this;function qn(Mo,Ao){return Ko.type="throw",Ko.arg=bn,Rn.next=Mo,Ao&&(Rn.method="next",Rn.arg=void 0),!!Ao}for(var oo=this.tryEntries.length-1;oo>=0;--oo){var ao=this.tryEntries[oo],Ko=ao.completion;if(ao.tryLoc==="root")return qn("end");if(ao.tryLoc<=this.prev){var Po=Y.call(ao,"catchLoc"),ja=Y.call(ao,"finallyLoc");if(Po&&ja){if(this.prev<ao.catchLoc)return qn(ao.catchLoc,!0);if(this.prev<ao.finallyLoc)return qn(ao.finallyLoc)}else if(Po){if(this.prev<ao.catchLoc)return qn(ao.catchLoc,!0)}else{if(!ja)throw new Error("try statement without catch or finally");if(this.prev<ao.finallyLoc)return qn(ao.finallyLoc)}}}},abrupt:function(bn,Rn){for(var qn=this.tryEntries.length-1;qn>=0;--qn){var oo=this.tryEntries[qn];if(oo.tryLoc<=this.prev&&Y.call(oo,"finallyLoc")&&this.prev<oo.finallyLoc){var ao=oo;break}}ao&&(bn==="break"||bn==="continue")&&ao.tryLoc<=Rn&&Rn<=ao.finallyLoc&&(ao=null);var Ko=ao?ao.completion:{};return Ko.type=bn,Ko.arg=Rn,ao?(this.method="next",this.next=ao.finallyLoc,Cr):this.complete(Ko)},complete:function(bn,Rn){if(bn.type==="throw")throw bn.arg;return bn.type==="break"||bn.type==="continue"?this.next=bn.arg:bn.type==="return"?(this.rval=this.arg=bn.arg,this.method="return",this.next="end"):bn.type==="normal"&&Rn&&(this.next=Rn),Cr},finish:function(bn){for(var Rn=this.tryEntries.length-1;Rn>=0;--Rn){var qn=this.tryEntries[Rn];if(qn.finallyLoc===bn)return this.complete(qn.completion,qn.afterLoc),Ln(qn),Cr}},catch:function(bn){for(var Rn=this.tryEntries.length-1;Rn>=0;--Rn){var qn=this.tryEntries[Rn];if(qn.tryLoc===bn){var oo=qn.completion;if(oo.type==="throw"){var ao=oo.arg;Ln(qn)}return ao}}throw new Error("illegal catch attempt")},delegateYield:function(bn,Rn,qn){return this.delegate={iterator:Pn(bn),resultName:Rn,nextLoc:qn},this.method==="next"&&(this.arg=void 0),Cr}},$}w.exports=L,w.exports.__esModule=!0,w.exports.default=w.exports}),rl=O1(),ar=rl;try{regeneratorRuntime=rl}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=rl:Function("r","regeneratorRuntime = r")(rl)}Vr({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991});var Xm=9007199254740991,_l=d(function(){gs(1)});Vr({target:"Object",stat:!0,forced:_l},{keys:function(M){return gs($n(M))}});var Vo=or.Object.keys,wl=Object.assign,Zm=Object.defineProperty,Tn=he([].concat),xl=!wl||d(function(){if(Ne&&wl({b:1},wl(Zm({},"a",{enumerable:!0,get:function(){Zm(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var w={},M={},L=Symbol(),$="abcdefghijklmnopqrst";return w[L]=7,$.split("").forEach(function(_){M[_]=_}),wl({},w)[L]!=7||gs(wl({},M)).join("")!=$})?function(M,L){for(var $=$n(M),_=arguments.length,Y=1,Oe=Vi.f,pe=ze.f;_>Y;)for(var At,jt=Dt(arguments[Y++]),ur=Oe?Tn(gs(jt),Oe(jt)):gs(jt),gr=ur.length,vr=0;gr>vr;)At=ur[vr++],Ne&&!Ce(pe,jt,At)||($[At]=jt[At]);return $}:wl;Vr({target:"Object",stat:!0,arity:2,forced:Object.assign!==xl},{assign:xl});var Mr=or.Object.assign;or.JSON||(or.JSON={stringify:JSON.stringify});var Wh=function(M,L,$){return T(or.JSON.stringify,null,arguments)},Wo=Wh,eg=nu.indexOf,tg=he([].indexOf),rg=!!tg&&1/tg([1],1,-0)<0,N1=Ds("indexOf");Vr({target:"Array",proto:!0,forced:rg||!N1},{indexOf:function(M){var L=arguments.length>1?arguments[1]:void 0;return rg?tg(this,M,L)||0:eg(this,M,L)}});var R1=Uo("Array").indexOf,ng=Array.prototype,ka=function(w){var M=w.indexOf;return w===ng||er(ng,w)&&M===ng.indexOf?R1:M},Gh=Uo("Array").concat,Qd=Array.prototype,ks=function(w){var M=w.concat;return w===Qd||er(Qd,w)&&M===Qd.concat?Gh:M};function Es(w,M){var L={};for(var $ in w)Object.prototype.hasOwnProperty.call(w,$)&&M.indexOf($)<0&&(L[$]=w[$]);if(w!=null&&typeof Object.getOwnPropertySymbols=="function"){var _=0;for($=Object.getOwnPropertySymbols(w);_<$.length;_++)M.indexOf($[_])<0&&Object.prototype.propertyIsEnumerable.call(w,$[_])&&(L[$[_]]=w[$[_]])}return L}function Sn(w,M,L,$){return new(L||(L=Promise))(function(_,Y){function Oe(jt){try{At($.next(jt))}catch(ur){Y(ur)}}function pe(jt){try{At($.throw(jt))}catch(ur){Y(ur)}}function At(jt){jt.done?_(jt.value):function(gr){return gr instanceof L?gr:new L(function(vr){vr(gr)})}(jt.value).then(Oe,pe)}At(($=$.apply(w,M||[])).next())})}var Jd=d(function(){if(typeof ArrayBuffer=="function"){var w=new ArrayBuffer(8);Object.isExtensible(w)&&Object.defineProperty(w,"a",{value:8})}}),od=Object.isExtensible,og=d(function(){od(1)})||Jd?function(M){return!!Fe(M)&&(!Jd||ie(M)!="ArrayBuffer")&&(!od||od(M))}:od,Qh=!d(function(){return Object.isExtensible(Object.preventExtensions({}))}),ag=o(function(w){var M=ua.f,L=!1,$=uo("meta"),_=0,Y=function(pe){M(pe,$,{value:{objectID:"O"+_++,weakData:{}}})},Oe=w.exports={enable:function(){Oe.enable=function(){},L=!0;var pe=qi.f,At=he([].splice),jt={};jt[$]=1,pe(jt).length&&(qi.f=function(ur){for(var gr=pe(ur),vr=0,Cr=gr.length;vr<Cr;vr++)if(gr[vr]===$){At(gr,vr,1);break}return gr},Vr({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:gu.f}))},fastKey:function(pe,At){if(!Fe(pe))return typeof pe=="symbol"?pe:(typeof pe=="string"?"S":"P")+pe;if(!Fr(pe,$)){if(!og(pe))return"F";if(!At)return"E";Y(pe)}return pe[$].objectID},getWeakData:function(pe,At){if(!Fr(pe,$)){if(!og(pe))return!0;if(!At)return!1;Y(pe)}return pe[$].weakData},onFreeze:function(pe){return Qh&&L&&og(pe)&&!Fr(pe,$)&&Y(pe),pe}};ni[$]=!0}),Jh=ua.f,Yh=bs.forEach,ki=Pa.set,B1=Pa.getterFor,Xh=function(w,M,L){for(var $ in M)L&&L.unsafe&&w[$]?w[$]=M[$]:vs(w,$,M[$],L);return w},F1=ua.f,Zh=ag.fastKey,sg=Pa.set,nl=Pa.getterFor,ev={getConstructor:function(w,M,L,$){var _=w(function(jt,ur){Bu(jt,Y),sg(jt,{type:M,index:Ea(null),first:void 0,last:void 0,size:0}),Ne||(jt.size=0),tr(ur)||so(ur,jt[$],{that:jt,AS_ENTRIES:L})}),Y=_.prototype,Oe=nl(M),pe=function(jt,ur,gr){var vr,Cr,xr=Oe(jt),Br=At(jt,ur);return Br?Br.value=gr:(xr.last=Br={index:Cr=Zh(ur,!0),key:ur,value:gr,previous:vr=xr.last,next:void 0,removed:!1},xr.first||(xr.first=Br),vr&&(vr.next=Br),Ne?xr.size++:jt.size++,Cr!=="F"&&(xr.index[Cr]=Br)),jt},At=function(jt,ur){var gr,vr=Oe(jt),Cr=Zh(ur);if(Cr!=="F")return vr.index[Cr];for(gr=vr.first;gr;gr=gr.next)if(gr.key==ur)return gr};return Xh(Y,{clear:function(){for(var ur=Oe(this),gr=ur.index,vr=ur.first;vr;)vr.removed=!0,vr.previous&&(vr.previous=vr.previous.next=void 0),delete gr[vr.index],vr=vr.next;ur.first=ur.last=void 0,Ne?ur.size=0:this.size=0},delete:function(jt){var ur=this,gr=Oe(ur),vr=At(ur,jt);if(vr){var Cr=vr.next,xr=vr.previous;delete gr.index[vr.index],vr.removed=!0,xr&&(xr.next=Cr),Cr&&(Cr.previous=xr),gr.first==vr&&(gr.first=Cr),gr.last==vr&&(gr.last=xr),Ne?gr.size--:ur.size--}return!!vr},forEach:function(ur){for(var gr,vr=Oe(this),Cr=$o(ur,arguments.length>1?arguments[1]:void 0);gr=gr?gr.next:vr.first;)for(Cr(gr.value,gr.key,this);gr&&gr.removed;)gr=gr.previous},has:function(ur){return!!At(this,ur)}}),Xh(Y,L?{get:function(ur){var gr=At(this,ur);return gr&&gr.value},set:function(ur,gr){return pe(this,ur===0?0:ur,gr)}}:{add:function(ur){return pe(this,ur=ur===0?0:ur,ur)}}),Ne&&F1(Y,"size",{get:function(){return Oe(this).size}}),_},setStrong:function(w,M,L){var $=M+" Iterator",_=nl(M),Y=nl($);Iu(w,M,function(Oe,pe){sg(this,{type:$,target:Oe,state:_(Oe),kind:pe,last:void 0})},function(){for(var Oe=Y(this),pe=Oe.kind,At=Oe.last;At&&At.removed;)At=At.previous;return Oe.target&&(Oe.last=At=At?At.next:Oe.state.first)?pe=="keys"?{value:At.key,done:!1}:pe=="values"?{value:At.value,done:!1}:{value:[At.key,At.value],done:!1}:(Oe.target=void 0,{value:void 0,done:!0})},L?"entries":"values",!L,!0),vm(M)}};(function(w,M,L){var $,_=w.indexOf("Map")!==-1,Y=w.indexOf("Weak")!==-1,Oe=_?"set":"add",pe=c[w],At=pe&&pe.prototype,jt={};if(Ne&&ae(pe)&&(Y||At.forEach&&!d(function(){new pe().entries().next()}))){var ur=($=M(function(vr,Cr){ki(Bu(vr,ur),{type:w,collection:new pe}),Cr!=null&&so(Cr,vr[Oe],{that:vr,AS_ENTRIES:_})})).prototype,gr=B1(w);Yh(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(vr){var Cr=vr=="add"||vr=="set";!(vr in At)||Y&&vr=="clear"||Jo(ur,vr,function(xr,Br){var jr=gr(this).collection;if(!Cr&&Y&&!Fe(xr))return vr=="get"&&void 0;var zr=jr[vr](xr===0?0:xr,Br);return Cr?this:zr})}),Y||Jh(ur,"size",{configurable:!0,get:function(){return gr(this).collection.size}})}else $=L.getConstructor(M,w,_,Oe),ag.enable();Fs($,w,!1,!0),jt[w]=$,Vr({global:!0,forced:!0},jt),Y||L.setStrong($,w,_)})("Map",function(w){return function(){return w(this,arguments.length?arguments[0]:void 0)}},ev);var L1=or.Map,ts=[].push;Vr({target:"Map",stat:!0,forced:!0},{from:function(M){var L,$,_,Y,Oe=arguments.length,pe=Oe>1?arguments[1]:void 0;return Zc(this),(L=pe!==void 0)&&Or(pe),tr(M)?new this:($=[],L?(_=0,Y=$o(pe,Oe>2?arguments[2]:void 0),so(M,function(At){Ce(ts,$,Y(At,_++))})):so(M,ts,{that:$}),new this($))}}),Vr({target:"Map",stat:!0,forced:!0},{of:function(){return new this(hs(arguments))}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:function(){for(var M,L=Vn(this),$=Or(L.delete),_=!0,Y=0,Oe=arguments.length;Y<Oe;Y++)M=Ce($,L,arguments[Y]),_=_&&M;return!!_}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function(M,L){var $,_,Y=Vn(this),Oe=Or(Y.get),pe=Or(Y.has),At=Or(Y.set);return Ce(pe,Y,M)?($=Ce(Oe,Y,M),"update"in L&&($=L.update($,M,Y),Ce(At,Y,M,$)),$):(_=L.insert(M,Y),Ce(At,Y,M,_),_)}});var _i=Wi;Vr({target:"Map",proto:!0,real:!0,forced:!0},{every:function(M){var L=Vn(this),$=_i(L),_=$o(M,arguments.length>1?arguments[1]:void 0);return!so($,function(Y,Oe,pe){if(!_(Oe,Y,L))return pe()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(M){var L=Vn(this),$=_i(L),_=$o(M,arguments.length>1?arguments[1]:void 0),Y=new(Ms(L,$e("Map"))),Oe=Or(Y.set);return so($,function(pe,At){_(At,pe,L)&&Ce(Oe,Y,pe,At)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),Y}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{find:function(M){var L=Vn(this),$=_i(L),_=$o(M,arguments.length>1?arguments[1]:void 0);return so($,function(Y,Oe,pe){if(_(Oe,Y,L))return pe(Oe)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(M){var L=Vn(this),$=_i(L),_=$o(M,arguments.length>1?arguments[1]:void 0);return so($,function(Y,Oe,pe){if(_(Oe,Y,L))return pe(Y)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var ig=he([].push);Vr({target:"Map",stat:!0,forced:!0},{groupBy:function(M,L){Or(L);var $=Wi(M),_=new this,Y=Or(_.has),Oe=Or(_.get),pe=Or(_.set);return so($,function(At){var jt=L(At);Ce(Y,_,jt)?ig(Ce(Oe,_,jt),At):Ce(pe,_,jt,[At])},{IS_ITERATOR:!0}),_}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(M){return so(_i(Vn(this)),function(L,$,_){if((Y=$)===(Oe=M)||Y!=Y&&Oe!=Oe)return _();var Y,Oe},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Vr({target:"Map",stat:!0,forced:!0},{keyBy:function(M,L){var $=new this;Or(L);var _=Or($.set);return so(M,function(Y){Ce(_,$,L(Y),Y)}),$}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(M){return so(_i(Vn(this)),function(L,$,_){if($===M)return _(L)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(M){var L=Vn(this),$=_i(L),_=$o(M,arguments.length>1?arguments[1]:void 0),Y=new(Ms(L,$e("Map"))),Oe=Or(Y.set);return so($,function(pe,At){Ce(Oe,Y,_(At,pe,L),At)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),Y}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(M){var L=Vn(this),$=_i(L),_=$o(M,arguments.length>1?arguments[1]:void 0),Y=new(Ms(L,$e("Map"))),Oe=Or(Y.set);return so($,function(pe,At){Ce(Oe,Y,pe,_(At,pe,L))},{AS_ENTRIES:!0,IS_ITERATOR:!0}),Y}}),Vr({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(M){for(var L=Vn(this),$=Or(L.set),_=arguments.length,Y=0;Y<_;)so(arguments[Y++],$,{that:L,AS_ENTRIES:!0});return L}});var qs=TypeError;Vr({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(M){var L=Vn(this),$=_i(L),_=arguments.length<2,Y=_?void 0:arguments[1];if(Or(M),so($,function(Oe,pe){_?(_=!1,Y=pe):Y=M(Y,pe,Oe,L)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),_)throw qs("Reduce of empty map with no initial value");return Y}}),Vr({target:"Map",proto:!0,real:!0,forced:!0},{some:function(M){var L=Vn(this),$=_i(L),_=$o(M,arguments.length>1?arguments[1]:void 0);return so($,function(Y,Oe,pe){if(_(Oe,Y,L))return pe()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var $1=TypeError;Vr({target:"Map",proto:!0,real:!0,forced:!0},{update:function(M,L){var $=Vn(this),_=Or($.get),Y=Or($.has),Oe=Or($.set),pe=arguments.length;Or(L);var At=Ce(Y,$,M);if(!At&&pe<3)throw $1("Updating absent value");var jt=At?Ce(_,$,M):Or(pe>2?arguments[2]:void 0)(M,$);return Ce(Oe,$,M,L(jt,M,$)),$}});var j1=TypeError,cg=function(M,L){var $,_=Vn(this),Y=Or(_.get),Oe=Or(_.has),pe=Or(_.set),At=arguments.length>2?arguments[2]:void 0;if(!ae(L)&&!ae(At))throw j1("At least one callback required");return Ce(Oe,_,M)?($=Ce(Y,_,M),ae(L)&&($=L($),Ce(pe,_,M,$))):ae(At)&&($=At(),Ce(pe,_,M,$)),$};Vr({target:"Map",proto:!0,real:!0,forced:!0},{upsert:cg}),Vr({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:cg});var ec=L1,lg=Date,tv=he(lg.prototype.getTime);Vr({target:"Date",stat:!0},{now:function(){return tv(new lg)}});var sa=or.Date.now,D1=/MSIE .\./.test(nr),mo=c.Function,rv=function(w){return D1?function(M,L){var $=ym(arguments.length,1)>2,_=ae(M)?M:mo(M),Y=$?hs(arguments,2):void 0;return w($?function(){T(_,this,Y)}:_,L)}:w},nv={setTimeout:rv(c.setTimeout),setInterval:rv(c.setInterval)},ov=nv.setInterval;Vr({global:!0,bind:!0,forced:c.setInterval!==ov},{setInterval:ov});var Yd=nv.setTimeout;Vr({global:!0,bind:!0,forced:c.setTimeout!==Yd},{setTimeout:Yd});var vo=or.setTimeout,ug=bs.map,U1=Di("map");Vr({target:"Array",proto:!0,forced:!U1},{map:function(M){return ug(this,M,arguments.length>1?arguments[1]:void 0)}});var Il=Uo("Array").map,Xd=Array.prototype,To=function(w){var M=w.map;return w===Xd||er(Xd,w)&&M===Xd.map?Il:M},Vs=o(function(w){var M=Object.prototype.hasOwnProperty,L="~";function $(){}function _(At,jt,ur){this.fn=At,this.context=jt,this.once=ur||!1}function Y(At,jt,ur,gr,vr){if(typeof ur!="function")throw new TypeError("The listener must be a function");var Cr=new _(ur,gr||At,vr),xr=L?L+jt:jt;return At._events[xr]?At._events[xr].fn?At._events[xr]=[At._events[xr],Cr]:At._events[xr].push(Cr):(At._events[xr]=Cr,At._eventsCount++),At}function Oe(At,jt){--At._eventsCount==0?At._events=new $:delete At._events[jt]}function pe(){this._events=new $,this._eventsCount=0}Object.create&&($.prototype=Object.create(null),new $().__proto__||(L=!1)),pe.prototype.eventNames=function(){var jt,ur,gr=[];if(this._eventsCount===0)return gr;for(ur in jt=this._events)M.call(jt,ur)&&gr.push(L?ur.slice(1):ur);return Object.getOwnPropertySymbols?gr.concat(Object.getOwnPropertySymbols(jt)):gr},pe.prototype.listeners=function(jt){var ur=L?L+jt:jt,gr=this._events[ur];if(!gr)return[];if(gr.fn)return[gr.fn];for(var vr=0,Cr=gr.length,xr=new Array(Cr);vr<Cr;vr++)xr[vr]=gr[vr].fn;return xr},pe.prototype.listenerCount=function(jt){var ur=L?L+jt:jt,gr=this._events[ur];return gr?gr.fn?1:gr.length:0},pe.prototype.emit=function(jt,ur,gr,vr,Cr,xr){var Br=L?L+jt:jt;if(!this._events[Br])return!1;var jr,zr,Hr=this._events[Br],Kr=arguments.length;if(Hr.fn){switch(Hr.once&&this.removeListener(jt,Hr.fn,void 0,!0),Kr){case 1:return Hr.fn.call(Hr.context),!0;case 2:return Hr.fn.call(Hr.context,ur),!0;case 3:return Hr.fn.call(Hr.context,ur,gr),!0;case 4:return Hr.fn.call(Hr.context,ur,gr,vr),!0;case 5:return Hr.fn.call(Hr.context,ur,gr,vr,Cr),!0;case 6:return Hr.fn.call(Hr.context,ur,gr,vr,Cr,xr),!0}for(zr=1,jr=new Array(Kr-1);zr<Kr;zr++)jr[zr-1]=arguments[zr];Hr.fn.apply(Hr.context,jr)}else{var kn,Jn=Hr.length;for(zr=0;zr<Jn;zr++)switch(Hr[zr].once&&this.removeListener(jt,Hr[zr].fn,void 0,!0),Kr){case 1:Hr[zr].fn.call(Hr[zr].context);break;case 2:Hr[zr].fn.call(Hr[zr].context,ur);break;case 3:Hr[zr].fn.call(Hr[zr].context,ur,gr);break;case 4:Hr[zr].fn.call(Hr[zr].context,ur,gr,vr);break;default:if(!jr)for(kn=1,jr=new Array(Kr-1);kn<Kr;kn++)jr[kn-1]=arguments[kn];Hr[zr].fn.apply(Hr[zr].context,jr)}}return!0},pe.prototype.on=function(jt,ur,gr){return Y(this,jt,ur,gr,!1)},pe.prototype.once=function(jt,ur,gr){return Y(this,jt,ur,gr,!0)},pe.prototype.removeListener=function(jt,ur,gr,vr){var Cr=L?L+jt:jt;if(!this._events[Cr])return this;if(!ur)return Oe(this,Cr),this;var xr=this._events[Cr];if(xr.fn)xr.fn!==ur||vr&&!xr.once||gr&&xr.context!==gr||Oe(this,Cr);else{for(var Br=0,jr=[],zr=xr.length;Br<zr;Br++)(xr[Br].fn!==ur||vr&&!xr[Br].once||gr&&xr[Br].context!==gr)&&jr.push(xr[Br]);jr.length?this._events[Cr]=jr.length===1?jr[0]:jr:Oe(this,Cr)}return this},pe.prototype.removeAllListeners=function(jt){var ur;return jt?(ur=L?L+jt:jt,this._events[ur]&&Oe(this,ur)):(this._events=new $,this._eventsCount=0),this},pe.prototype.off=pe.prototype.removeListener,pe.prototype.addListener=pe.prototype.on,pe.prefixed=L,pe.EventEmitter=pe,w.exports=pe}),wi=ol;function ol(w){w=w||{},this.ms=w.min||100,this.max=w.max||1e4,this.factor=w.factor||2,this.jitter=w.jitter>0&&w.jitter<=1?w.jitter:0,this.attempts=0}ol.prototype.duration=function(){var w=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var M=Math.random(),L=Math.floor(M*this.jitter*w);w=1&Math.floor(10*M)?w+L:w-L}return 0|Math.min(w,this.max)},ol.prototype.reset=function(){this.attempts=0},ol.prototype.setMin=function(w){this.ms=w},ol.prototype.setMax=function(w){this.max=w},ol.prototype.setJitter=function(w){this.jitter=w};var av=typeof e=="object"&&e&&e.Object===Object&&e,q1=typeof self=="object"&&self&&self.Object===Object&&self,Ps=av||q1||Function("return this")(),Gs=Ps.Symbol,sv=Object.prototype,V1=sv.hasOwnProperty,iv=sv.toString,Qs=Gs?Gs.toStringTag:void 0,pi=function(M){var L=V1.call(M,Qs),$=M[Qs];try{M[Qs]=void 0;var _=!0}catch{}var Y=iv.call(M);return _&&(L?M[Qs]=$:delete M[Qs]),Y},Zd=Object.prototype.toString,cv=function(M){return Zd.call(M)},lv=Gs?Gs.toStringTag:void 0,yc=function(M){return M==null?M===void 0?"[object Undefined]":"[object Null]":lv&&lv in Object(M)?pi(M):cv(M)},fi=function(M){var L=typeof M;return M!=null&&(L=="object"||L=="function")},ep=function(M){if(!fi(M))return!1;var L=yc(M);return L=="[object Function]"||L=="[object GeneratorFunction]"||L=="[object AsyncFunction]"||L=="[object Proxy]"},uv={deviceId:"",timeout:8e3},H1={account:"",appkey:"",token:"",debugLevel:"off",needReconnect:!0,reconnectionAttempts:Xm,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},dv="weblink.netease.im:443",z1=nu.includes,K1=d(function(){return!Array(1).includes()});Vr({target:"Array",proto:!0,forced:K1},{includes:function(M){return z1(this,M,arguments.length>1?arguments[1]:void 0)}});var W1=Uo("Array").includes,dg=to("match"),pg=TypeError,mi=function(w){if(function(M){var L;return Fe(M)&&((L=M[dg])!==void 0?!!L:ie(M)=="RegExp")}(w))throw pg("The method doesn't accept regular expressions");return w},G1=to("match"),Q1=he("".indexOf);Vr({target:"String",proto:!0,forced:!function(w){var M=/./;try{"/./"[w](M)}catch{try{return M[G1]=!1,"/./"[w](M)}catch{}}return!1}("includes")},{includes:function(M){return!!~Q1(Aa(fr(this)),Aa(mi(M)),arguments.length>1?arguments[1]:void 0)}});var pv=Uo("String").includes,fg=Array.prototype,ad=String.prototype,bc=function(w){var M=w.includes;return w===fg||er(fg,w)&&M===fg.includes?W1:typeof w=="string"||w===ad||er(ad,w)&&M===ad.includes?pv:M},J1=bs.findIndex,Y1="findIndex",tp=!0;Y1 in[]&&Array(1).findIndex(function(){tp=!1}),Vr({target:"Array",proto:!0,forced:tp},{findIndex:function(M){return J1(this,M,arguments.length>1?arguments[1]:void 0)}});var fv=Uo("Array").findIndex,mg=Array.prototype,X1=function(w){var M=w.findIndex;return w===mg||er(mg,w)&&M===mg.findIndex?fv:M},gg=o(function(w){function M(L){var $;return w.exports=M=Ns?Oo($=js).call($):function(Y){return Y.__proto__||js(Y)},w.exports.__esModule=!0,w.exports.default=w.exports,M(L)}w.exports=M,w.exports.__esModule=!0,w.exports.default=w.exports}),pa=o(function(w){w.exports=function(L){var $;return ka($=Function.toString.call(L)).call($,"[native code]")!==-1},w.exports.__esModule=!0,w.exports.default=w.exports}),hg=$e("Reflect","construct"),vg=Object.prototype,Z1=[].push,mv=d(function(){function w(){}return!(hg(function(){},[],w)instanceof w)}),yg=!d(function(){hg(function(){})}),bg=mv||yg;Vr({target:"Reflect",stat:!0,forced:bg,sham:bg},{construct:function(M,L){Zc(M),Vn(L);var $=arguments.length<3?M:Zc(arguments[2]);if(yg&&!mv)return hg(M,L,$);if(M==$){switch(L.length){case 0:return new M;case 1:return new M(L[0]);case 2:return new M(L[0],L[1]);case 3:return new M(L[0],L[1],L[2]);case 4:return new M(L[0],L[1],L[2],L[3])}var _=[null];return T(Z1,_,L),new(T(iu,M,_))}var Y=$.prototype,Oe=Ea(Fe(Y)?Y:vg),pe=T(M,Oe,L);return Fe(pe)?pe:Oe}});var xi=or.Reflect.construct,tc=o(function(w){w.exports=function(){if(typeof Reflect>"u"||!xi||xi.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(xi(Boolean,[],function(){})),!0}catch{return!1}},w.exports.__esModule=!0,w.exports.default=w.exports}),eT=o(function(w){function M(L,$,_){var Y;return tc()?(w.exports=M=Oo(Y=xi).call(Y),w.exports.__esModule=!0,w.exports.default=w.exports):(w.exports=M=function(pe,At,jt){var ur=[null];ur.push.apply(ur,At);var gr=new(Oo(Function).apply(pe,ur));return jt&&lu(gr,jt.prototype),gr},w.exports.__esModule=!0,w.exports.default=w.exports),M.apply(null,arguments)}w.exports=M,w.exports.__esModule=!0,w.exports.default=w.exports}),tT=o(function(w){function M(L){var $=typeof ec=="function"?new ec:void 0;return w.exports=M=function(Y){if(Y===null||!pa(Y))return Y;if(typeof Y!="function")throw new TypeError("Super expression must either be null or a function");if($!==void 0){if($.has(Y))return $.get(Y);$.set(Y,Oe)}function Oe(){return eT(Y,arguments,gg(this).constructor)}return Oe.prototype=Ja(Y.prototype,{constructor:{value:Oe,enumerable:!1,writable:!0,configurable:!0}}),lu(Oe,Y)},w.exports.__esModule=!0,w.exports.default=w.exports,M(L)}w.exports=M,w.exports.__esModule=!0,w.exports.default=w.exports}),rc=function(w){function M(L,$,_){var Y;return $===void 0&&($={}),_===void 0&&(_=400),(Y=w.call(this,L)||this).data=$,Y.code=_,Y.name="customError",Y}return Ro(M,w),M}(n(tT)(Error)),yo=function(w){function M(L,$,_){var Y;return $===void 0&&($={}),(Y=w.call(this,L,$,414)||this).code=414,Y.name="validateError",Y.rules=_,Y}return Ro(M,w),M}(rc),al={200:null,406:null,808:null,810:null,201:"The client version is incorrect. You need to upgrade the SDK",302:"The user name or password is incorrect. Please check whether the appkey and token are valid and whether the account and token match",403:"Illegal operation or no permission",404:"Target object does not exist",405:"Parameter length too long",408:"Client request timed out",414:"Request parameter error",415:"Service unavailable",416:"Frequency control",417:"Repeat operation",422:"Account disabled",500:"Server internal error",503:"Server busy",508:"Expiration date",509:"Invalid",7101:"Be pulled black",700:"Partial failure of batch operation",801:"The number of people in the team has reached the upper limit",802:"No permission",803:"The team does not exist or has not changed",804:"The user is not in the team",805:"Team type mismatch",806:"The number of teams created has reached the limit",807:"Team member not valid",809:"Already in the team",811:"The number of accounts in the forced push list exceeds the limit",812:"The team is muted",813:"Due to the limited number of team, some pull people successfully",814:"Disable team message read service",815:"Maximum number of team administrators",816:"Batch operation partial failure",997:"The packet has expired",998:"Deserialize packet error",999:"Serialize packet error",9102:"Channel failure",9103:"This call has been answered / rejected at another end",10201:"Signaling: target NIM client is offline",10202:"Signaling: push is unreachable",10404:"Signaling: channel not exists",10405:"Signaling: channel already exists",10406:"Signaling: member of channel not exists",10407:"Signaling: member of channel already exists",10408:"Signaling: the invitation request does not exist or has expired",10409:"Signaling: the invitation request has been rejected",10410:"Signaling: the invitation request has been accepted",10414:"Signaling: request parameter error",10417:"Signaling: uid conflict",10419:"Signaling: the number of members of channel exceed the limit",10420:"Signaling: member is already in the channel on other client",10700:"Signaling: phased success",13002:"Abnormal chatroom status",13003:"In the blacklist",13004:"In the mute list",13006:"All members are muted, and only the administrator can speak"},rp=function(w){function M(L,$,_,Y,Oe){var pe;return _===void 0&&(_=""),Y===void 0&&(Y=new Date().getTime()),Oe===void 0&&(Oe={}),_=_||al[L],(pe=w.call(this,_,Oe,L)||this).name="cmdError",pe.cmd=$,pe.timetag=Y,pe}return Ro(M,w),M}(rc),Tg=function(w){function M(L,$,_){var Y;return(Y=w.call(this,L,{},412)||this).code=412,Y.name="formatError",Y.key=$,Y.reason=_,Y}return Ro(M,w),M}(rc),El=function(w){function M(L,$,_,Y,Oe){var pe;return(pe=w.call(this,L,{file:Oe},400)||this).name="uploadError",pe.rawError=$,pe.curProvider=_||1,pe.mixStorePolicy=Y,pe}return Ro(M,w),M}(rc),Tc=["error","warn","log","debug"],sl=function(){},sd=["off","error","warn","log","debug"],np=function(){function w(L,$){this.name=$,this.strategies={debug:console.log,log:console.log,warn:console.warn,error:console.error},this.debug=sl,this.log=sl,this.warn=sl,this.error=sl,this.name=$,w.instancesName.push($),bc(sd).call(sd,L)||(L="off"),this.setLogFunc(L)}var M=w.prototype;return M.setLogFunc=function($){var _=this,Y=X1(Tc).call(Tc,function(Oe){return Oe===$});In(Tc).call(Tc,function(Oe,pe){pe<=Y&&(_[Oe]=function(){var At=Co(Array.prototype).call(arguments),jt=this.formatArgs(At,Oe);this.strategies[Oe](jt)})})},M.formatArgs=function($,_){var Y=new Date,Oe=Y.getMonth()+1+"-"+Y.getDate()+" "+Y.getHours()+":"+Y.getMinutes()+":"+Y.getSeconds()+":"+Y.getMilliseconds();return"[NIM "+_+" "+this.name+" "+Oe+"] "+To($).call($,function(pe){return pe instanceof rc?pe.name+", "+pe.code+", "+pe.message:pe instanceof Error?pe&&pe.message?pe.message:pe:typeof pe=="object"?Wo(pe):pe}).join(" ")},w}();np.instancesName=[],Vr({global:!0},{globalThis:c});var gv=bs.filter,rT=Di("filter");Vr({target:"Array",proto:!0,forced:!rT},{filter:function(M){return gv(this,M,arguments.length>1?arguments[1]:void 0)}});var na=Uo("Array").filter,Sg=Array.prototype,is=function(w){var M=w.filter;return w===Sg||er(Sg,w)&&M===Sg.filter?na:M},nT=o(function(w,M){w.exports=function(){function L(jt,ur){if(!(jt instanceof ur))throw new TypeError("Cannot call a class as a function")}function $(jt,ur){for(var gr=0;gr<ur.length;gr++){var vr=ur[gr];vr.enumerable=vr.enumerable||!1,vr.configurable=!0,"value"in vr&&(vr.writable=!0),Ki(jt,vr.key,vr)}}function _(jt,ur,gr){return ur&&$(jt.prototype,ur),gr&&$(jt,gr),Ki(jt,"prototype",{writable:!1}),jt}var Y={reportUrl:"https://statistic.live.126.net/statics/report/common/form",maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0},Oe="https://statistic.live.126.net/dispatcher/req",pe=function(){},At=function(){function jt(ur){L(this,jt),this.enable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=Y,this.msgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=sa(),this.timer=null,this.setConfig(ur),this.reportConfig.autoStart&&this.initUploadConfig()}return _(jt,[{key:"setConfig",value:function(gr){this.reportConfig=Mr({},this.reportConfig,gr)}},{key:"reportImmediately",value:function(gr,vr){var Cr=this;this.reportConfig.request(gr,Mr({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},vr)).catch(function(xr){var Br,jr;(jr=(Br=Cr.reportConfig)===null||Br===void 0?void 0:Br.logger)===null||jr===void 0||jr.warn("Reporter immediately upload failed",xr)})}},{key:"report",value:function(gr,vr){var Cr=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(gr){var xr=sa();Cr?this.lowPriorityMsgList.push({module:gr,msg:vr,createTime:xr}):this.msgList.push({module:gr,msg:vr,createTime:xr}),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function(gr,vr){if(gr&&!this.traceMsgCache[gr]){var Cr=Mr(Mr({start_time:sa()},vr),{extension:[]});this.traceMsgCache[gr]=Cr}}},{key:"reportTraceUpdate",value:function(gr){}},{key:"reportTraceUpdateV2",value:function(gr,vr){if(this.traceMsgCache[gr]){var Cr=this.traceMsgCache[gr].extension.length,xr=new Date().getTime();vr.duration=Cr===0?xr-this.traceMsgCache[gr].start_time:xr-this.traceMsgCache[gr].extension[Cr-1].end_time,this.traceMsgCache[gr].extension.push(Mr({end_time:xr},vr))}}},{key:"reportTraceEnd",value:function(gr){var vr,Cr=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.traceMsgCache[gr]&&(gr!=="nos"||Cr===!1?(typeof Cr=="boolean"?this.traceMsgCache[gr].succeed=!!Cr:this.traceMsgCache[gr].state=Cr,this.traceMsgCache[gr].duration=sa()-this.traceMsgCache[gr].start_time,In(vr=this.traceMsgCache[gr].extension).call(vr,function(xr){delete xr.end_time}),this.report(gr,this.traceMsgCache[gr]),this.traceMsgCache[gr]=null):this.traceMsgCache[gr]=null)}},{key:"reportTraceCancel",value:function(gr){this.traceMsgCache[gr]=null}},{key:"pause",value:function(){this.enable=!1}},{key:"restore",value:function(){this.enable=!0,this.initConfigLoaded||this.initUploadConfig()}},{key:"destroy",value:function(){var gr,vr=this;In(gr=Vo(this.traceMsgCache)).call(gr,function(Cr){vr.reportTraceEnd(Cr,1)}),this.timer!==null&&clearTimeout(this.timer),this.setConfig=pe,this.report=pe,this.reportTraceStart=pe,this.reportTraceUpdate=pe,this.reportTraceEnd=pe,this.pause=pe,this.restore=pe,this.destroy=pe,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.reportConfig={},this.isDestroyed=!0}},{key:"initUploadConfig",value:function(){var gr,vr,Cr=this;if(!this.loading){this.loading=!0;var xr=this.reportConfig.common||{};try{this.reportConfig.request(Oe,{method:"GET",dataType:"json",params:{deviceId:xr.dev_id,sdkVer:xr.sdk_ver,platform:xr.platform,appkey:xr.app_key},timeout:this.reportConfig.timeout}).then(function(Br){var jr,zr;if(!Cr.isDestroyed){if(Br.status===200&&Br.data&&Br.data.code===200){var Hr=Br.data.data||{};Cr.reportConfig.maxSize=Hr.maxSize>1e3?1e3:Hr.maxSize,Cr.reportConfig.maxInterval=Hr.maxInterval>1e4?1e4:Hr.maxInterval,Cr.reportConfig.maxInterval=Hr.maxInterval<10?10:Hr.maxInterval,Cr.reportConfig.minInterval=Hr.minInterval<2?2:Hr.minInterval,Cr.reportConfig.maxDelay=Hr.maxDelay||300,Cr.reportConfig.maxInterval=1e3*Cr.reportConfig.maxInterval,Cr.reportConfig.minInterval=1e3*Cr.reportConfig.minInterval,Cr.reportConfig.maxDelay=1e3*Cr.reportConfig.maxDelay,Cr.enable=!0,Cr.initConfigLoaded=!0,Cr.loading=!1,Cr.reportHeartBeat()}(zr=(jr=Cr.reportConfig)===null||jr===void 0?void 0:jr.logger)===null||zr===void 0||zr.log("Get reporter upload config success")}}).catch(function(Br){var jr,zr;Cr.loading=!1,(zr=(jr=Cr.reportConfig)===null||jr===void 0?void 0:jr.logger)===null||zr===void 0||zr.error("Get reporter upload config failed",Br)})}catch(Br){this.loading=!1,(vr=(gr=this.reportConfig)===null||gr===void 0?void 0:gr.logger)===null||vr===void 0||vr.error("Exec reporter request failed",Br)}}}},{key:"reportHeartBeat",value:function(){var gr=this;this.isDestroyed||(this.timer=vo(function(){gr.reportHeartBeat()},this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function(){if(!this.isDestroyed){var gr=this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;sa()-this.lastReportTime>=gr&&this.upload()}}},{key:"getUploadMsg",value:function(){var gr,vr,Cr,xr,Br,jr=this,zr={},Hr=sa();this.msgList=is(gr=this.msgList).call(gr,function(Pn){return Hr-Pn.createTime<jr.reportConfig.maxDelay}),this.lowPriorityMsgList=is(vr=this.lowPriorityMsgList).call(vr,function(Pn){return Hr-Pn.createTime<jr.reportConfig.maxDelay}),this.cacheMsgList=is(Cr=this.cacheMsgList).call(Cr,function(Pn){return Hr-Pn.createTime<jr.reportConfig.maxDelay});var Kr=Co(xr=this.msgList).call(xr,0,this.reportConfig.maxSize);if(this.msgList=Co(Br=this.msgList).call(Br,Kr.length),Kr.length<this.reportConfig.maxSize){var kn,Jn,Hn=this.reportConfig.maxSize-Kr.length;Kr=ks(Kr).call(Kr,Co(kn=this.lowPriorityMsgList).call(kn,0,Hn)),this.lowPriorityMsgList=Co(Jn=this.lowPriorityMsgList).call(Jn,Hn)}if(Kr.length<this.reportConfig.maxSize){var xo,Ln,_r=this.reportConfig.maxSize-Kr.length;Kr=ks(Kr).call(Kr,Co(xo=this.cacheMsgList).call(xo,0,_r)),this.cacheMsgList=Co(Ln=this.cacheMsgList).call(Ln,_r)}return In(Kr).call(Kr,function(Pn){zr[Pn.module]?zr[Pn.module].push(Pn.msg):zr[Pn.module]=[Pn.msg]}),{uploadMsgArr:Kr,uploadMsg:zr}}},{key:"upload",value:function(){var gr,vr,Cr=this;if(this.enable&&!(this.lastReportTime&&sa()-this.lastReportTime<this.reportConfig.minInterval)){var xr=this.getUploadMsg(),Br=xr.uploadMsgArr,jr=xr.uploadMsg;if(Br.length){this.lastReportTime=sa();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:jr},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch(function(zr){var Hr,Kr,kn,Jn;Cr.cacheMsgList=Co(Hr=ks(Kr=Cr.cacheMsgList).call(Kr,Br)).call(Hr,0,Cr.reportConfig.cacheMaxSize),(Jn=(kn=Cr.reportConfig)===null||kn===void 0?void 0:kn.logger)===null||Jn===void 0||Jn.warn("Reporter upload failed",zr)})}catch(zr){(vr=(gr=this.reportConfig)===null||gr===void 0?void 0:gr.logger)===null||vr===void 0||vr.warn("Exec reporter request failed",zr)}clearTimeout(this.timer),this.reportHeartBeat()}}}}]),jt}();return At}()}),Ho={setLogger:function(M){throw new Error("Function not implemented.")},platform:"",WebSocket:function(){function w(L,$){throw this.CONNECTING=0,this.OPEN=1,this.CLOSING=2,this.CLOSED=3,new Error("Method not implemented.")}var M=w.prototype;return M.close=function($,_){throw new Error("Method not implemented.")},M.send=function($){throw new Error("Method not implemented.")},M.onclose=function($){throw new Error("Method not implemented.")},M.onerror=function($){throw new Error("Method not implemented.")},M.onmessage=function($){throw new Error("Method not implemented.")},M.onopen=function($){throw new Error("Method not implemented.")},w}(),localStorage:{},request:function(M,L){throw new Error("Function not implemented.")},uploadFile:function(M){throw new Error("Function not implemented.")},getSystemInfo:function(){throw new Error("Function not implemented.")}},Js=TypeError,hv=function(w){return function(M,L,$,_){Or(L);var Y=$n(M),Oe=Dt(Y),pe=Ia(Y),At=w?pe-1:0,jt=w?-1:1;if($<2)for(;;){if(At in Oe){_=Oe[At],At+=jt;break}if(At+=jt,w?At<0:pe<=At)throw Js("Reduce of empty array with no initial value")}for(;w?At>=0:pe>At;At+=jt)At in Oe&&(_=L(_,Oe[At],At,Y));return _}},ta={left:hv(!1),right:hv(!0)}.left,oT=Ds("reduce");Vr({target:"Array",proto:!0,forced:!oT||!Ua&&mr>79&&mr<83},{reduce:function(M){var L=arguments.length;return ta(this,M,L,L>1?arguments[1]:void 0)}});var vv=Uo("Array").reduce,Cg=Array.prototype,op=function(w){var M=w.reduce;return w===Cg||er(Cg,w)&&M===Cg.reduce?vv:M},yv=function(M){return M===void 0},Pl={},Sc={};function bv(w,M){var L,$,_;try{_=JSON.parse(w)}catch(Cr){throw M.error("Parse command error: ",w),Cr}var Y=_.sid+"_"+_.cid,Oe=_.r;if(bc(L=["4_1","4_2","4_10","4_11"]).call(L,Y)){var pe=_.r[1].headerPacket;Y=pe.sid+"_"+pe.cid,Oe=_.r[1].body}var At,jt=Sc[Y],ur=Pl[jt],gr=function(xr,Br){var jr=al[xr];return jr===null?null:new rp(xr,Br,jr,new Date().getTime())}(_.code,jt),vr={cmd:jt,raw:_,error:gr,service:ur==null?void 0:ur.service,content:{}};if(vr.error){if(vr.error.cmd=jt,vr.error.callFunc="parseCmd",!(!(($=ur==null?void 0:ur.ignoreErrCodes)===null||$===void 0)&&bc($).call($,_.code)))return vr;M.warn("parseCmd:: ignore error ",vr.error),vr.error.ignore=!0}return!jt||!ur?(vr.notFound=!0,vr):(ur.response&&In(At=ur.response).call(At,function(Cr,xr){var Br=Oe[xr],jr=Cr.type,zr=Cr.name,Hr=Cr.reflectMapper;if(!yv(Br))switch(jr){case"Property":vr.content[zr]=Hr?Ii(Br,Hr):Br;break;case"PropertyArray":vr.content[zr]=To(Br).call(Br,function(Kr){return Hr?Ii(Kr,Hr):Kr});break;case"long":case"Long":case"byte":case"Byte":case"Number":vr.content[zr]=+Br;break;default:vr.content[zr]=Br}}),vr)}function id(w,M){var L={};for(var $ in w)M[$]!==void 0&&(L[M[$]]=w[$]);return L}function Ii(w,M){var L={};for(var $ in w)M[$]!==void 0&&(L[M[$]]=w[$]);return L}function qa(w){Pl=Mr(Pl,w.cmdConfig),Sc=Mr(Sc,w.cmdMap)}function rs(w){var M;return op(M=Vo(w)).call(M,function(L,$){var _,Y=w[$];return L[$]=op(_=Vo(Y)).call(_,function(Oe,pe){return Oe[Y[pe]]=pe,Oe},{}),L},{})}var Oa=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],Ei=["transport not supported","client not handshaken","unauthorized"],Cc=["reconnect"],Mg=function(w){function M($,_,Y){var Oe;return(Oe=w.call(this)||this).url=_,Oe.logger=Y,Oe.websocket=null,Oe.core=$,Oe.url=_,Oe.status="disconnected",Oe.logger=Y,Oe.connect(),Oe}Ro(M,w);var L=M.prototype;return L.connect=function(){var _=this;this.status!=="connecting"&&this.status!=="connected"?(this.status="connecting",this.core.adapters.request("https://"+this.url+"/socket.io/1/?t="+sa(),{method:"GET",dataType:"text",timeout:8e3}).then(function(Y){var Oe=Y.data.split(":"),pe=Oe[0],At=Oe[1];return _.sessionId=pe,_.closeTimeout=1e3*At,_._createWebsocket("wss://"+_.url+"/socket.io/1/websocket/"+pe)}).catch(function(Y){_.logger.error("imsocket::handshake fail. ",Y&&Y.message),_.status="disconnected",_.emit("handshakeFailed")})):this.logger.warn("imsocket::socket is connecting or connected",this.status)},L.close=function(){if(this.websocket){this.logger.log("imsocket:: close websocket");try{this.websocket.send(this.encodePacket({type:"disconnect"})),this.websocket.close()}catch(_){this.logger.warn("attempt to close websocket error",_)}this.clean()}},L.clean=function(){this.status="disconnected",this.websocket&&(this.websocket.onmessage=null,this.websocket.onopen=null,this.websocket.onerror=null,this.websocket.onclose=null,this.websocket=null,this.emit("disconnect"))},L.onConnect=function(){this.status="connected",this.resetCloseTimer(),this.emit("connect")},L._createWebsocket=function(_){var Y,Oe=this;this.websocket=new Ho.WebSocket(_),this.websocket.onmessage=Oo(Y=this.onMessage).call(Y,this),this.websocket.onclose=function(){Oe.logger.log("imsocket:: receive websocket onclose event, current status",Oe.status),Oe.clean()},this.websocket.onerror=function(pe){Oe.logger.error("imsocket:: onerror",pe)}},L.onMessage=function(_){var Y;this.resetCloseTimer();var Oe=this.decodePacket(_.data);if(Oe)switch(Oe.type){case"connect":this.onConnect();break;case"disconnect":this.close();break;case"message":case"json":this.emit("message",Oe.data);break;case"event":Oe.name&&this.emit(Oe.name,Oe.args);break;case"error":Oe.reason==="unauthorized"?this.emit("connect_failed",Oe.reason):this.emit("error",Oe.reason);break;case"heartbeat":(Y=this.websocket)===null||Y===void 0||Y.send(this.encodePacket({type:"heartbeat"}));break;default:this.logger.warn("imsocket::no handler type",Oe.type)}},L.encodePacket=function(_){var Y,Oe,pe=_.type,At=_.id,jt=At===void 0?"":At,ur=_.endpoint,gr=ur===void 0?"":ur,vr=_.ack,Cr=null;if(!pe)return"";switch(pe){case"error":Y=_.reason?ka(Ei).call(Ei,_.reason):"",Oe=_.advice?ka(Cc).call(Cc,_.advice):"",Y===""&&Oe===""||(Cr=Y+(Oe!==""?"+"+Oe:""));break;case"message":_.data!==""&&(Cr=_.data);break;case"event":Y={name:_.name},Y=_.args&&_.args.length?{name:_.name,args:_.args}:{name:_.name},Cr=Wo(Y);break;case"json":Cr=Wo(_.data);break;case"connect":_.qs&&(Cr=_.qs);break;case"ack":Cr=_.ackId+(_.args&&_.args.length?"+"+Wo(_.args):"")}var xr=[ka(Oa).call(Oa,pe),jt+(vr==="data"?"+":""),gr];return Cr!=null&&xr.push(Cr),xr.join(":")},L.decodePacket=function(_){if(_)if(_.charAt(0)!="�"){var Y=_.match(/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/);if(Y){var Oe,pe=Y[1],At=Y[2],jt=Y[3],ur=Y[4],gr=Y[5],vr={type:Oa[+pe],endpoint:ur};switch(At&&(vr.id=At,vr.ack=!jt||"data"),vr.type){case"error":Oe=gr.split("+"),vr.reason=Ei[+Oe[0]]||"";break;case"message":vr.data=gr||"";break;case"connect":vr.qs=gr||"";break;case"event":try{var Cr=JSON.parse(gr);vr.name=Cr.name,vr.args=Cr.args}catch(xr){this.logger.error("imsocket::parseData::type::event error",xr)}vr.args=vr.args||[];break;case"json":try{vr.data=JSON.parse(gr)}catch(xr){this.logger.error("imsocket::parseData::type::json error",xr)}break;case"ack":if((Oe=gr.match(/^([0-9]+)(\+)?(.*)/))&&(vr.ackId=Oe[1],vr.args=[],Oe[3]))try{vr.args=Oe[3]?JSON.parse(Oe[3]):[]}catch(xr){this.logger.error("imsocket::parseData::type::ack error",xr)}}return vr}}else this.logger.error("imsocket::unrecognize dataStr",Co(_).call(_,0,20))},L.send=function(_){var Y,Oe={data:_,type:"message",endpoint:""};(Y=this.websocket)===null||Y===void 0||Y.send(this.encodePacket(Oe))},L.resetCloseTimer=function(){var _=this;this.closeTimeout&&(clearTimeout(this.closeTimer),this.closeTimer=vo(function(){_.close()},this.closeTimeout))},M}(Vs),kg=Uo("Array").values,ap=Array.prototype,aT={DOMTokenList:!0,NodeList:!0},sp=function(w){var M=w.values;return w===ap||er(ap,w)&&M===ap.values||Fr(aT,Bs(w))?kg:M};Vr({target:"Array",stat:!0},{isArray:Ya});var gi=or.Array.isArray,sT=bs.every,ip=Ds("every");Vr({target:"Array",proto:!0,forced:!ip},{every:function(M){return sT(this,M,arguments.length>1?arguments[1]:void 0)}});var ns=Uo("Array").every,_g=Array.prototype,iT=function(w){var M=w.every;return w===_g||er(_g,w)&&M===_g.every?ns:M},hi=function(M){return M!=null&&typeof M=="object"},wg=function(M){return hi(M)&&yc(M)=="[object RegExp]"},Al=function(M){return function(L){return M(L)}},cs=o(function(w,M){var L=M&&!M.nodeType&&M,$=L&&w&&!w.nodeType&&w,_=$&&$.exports===L&&av.process,Y=function(){try{var Oe=$&&$.require&&$.require("util").types;return Oe||_&&_.binding&&_.binding("util")}catch{}}();w.exports=Y}),Tv=cs&&cs.isRegExp,xg=Tv?Al(Tv):wg,Ol=Ps["__core-js_shared__"],Ig=function(){var w=/[^.]+$/.exec(Ol&&Ol.keys&&Ol.keys.IE_PROTO||"");return w?"Symbol(src)_1."+w:""}(),cT=function(M){return!!Ig&&Ig in M},Eg=Function.prototype.toString,Mc=function(M){if(M!=null){try{return Eg.call(M)}catch{}try{return M+""}catch{}}return""},lT=/^\[object .+?Constructor\]$/,uT=Function.prototype,il=Object.prototype,dT=uT.toString,pT=il.hasOwnProperty,fT=RegExp("^"+dT.call(pT).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),mT=function(M){return!(!fi(M)||cT(M))&&(ep(M)?fT:lT).test(Mc(M))},gT=function(M,L){return M==null?void 0:M[L]},cl=function(M,L){var $=gT(M,L);return mT($)?$:void 0},cd=cl(Object,"create"),hT=function(){this.__data__=cd?cd(null):{},this.size=0},ll=function(M){var L=this.has(M)&&delete this.__data__[M];return this.size-=L?1:0,L},ld=Object.prototype.hasOwnProperty,vT=function(M){var L=this.__data__;if(cd){var $=L[M];return $==="__lodash_hash_undefined__"?void 0:$}return ld.call(L,M)?L[M]:void 0},yT=Object.prototype.hasOwnProperty,bT=function(M){var L=this.__data__;return cd?L[M]!==void 0:yT.call(L,M)},TT=function(M,L){var $=this.__data__;return this.size+=this.has(M)?0:1,$[M]=cd&&L===void 0?"__lodash_hash_undefined__":L,this};function Nl(w){var M=-1,L=w==null?0:w.length;for(this.clear();++M<L;){var $=w[M];this.set($[0],$[1])}}Nl.prototype.clear=hT,Nl.prototype.delete=ll,Nl.prototype.get=vT,Nl.prototype.has=bT,Nl.prototype.set=TT;var Sv=Nl,ST=function(){this.__data__=[],this.size=0},nc=function(M,L){return M===L||M!=M&&L!=L},ud=function(M,L){for(var $=M.length;$--;)if(nc(M[$][0],L))return $;return-1},CT=Array.prototype.splice,cp=function(M){var L=this.__data__,$=ud(L,M);return!($<0)&&($==L.length-1?L.pop():CT.call(L,$,1),--this.size,!0)},lp=function(M){var L=this.__data__,$=ud(L,M);return $<0?void 0:L[$][1]},MT=function(M){return ud(this.__data__,M)>-1},kT=function(M,L){var $=this.__data__,_=ud($,M);return _<0?(++this.size,$.push([M,L])):$[_][1]=L,this};function Rl(w){var M=-1,L=w==null?0:w.length;for(this.clear();++M<L;){var $=w[M];this.set($[0],$[1])}}Rl.prototype.clear=ST,Rl.prototype.delete=cp,Rl.prototype.get=lp,Rl.prototype.has=MT,Rl.prototype.set=kT;var up=Rl,dd=cl(Ps,"Map"),Bl=function(){this.size=0,this.__data__={hash:new Sv,map:new(dd||up),string:new Sv}},dp=function(M){var L=typeof M;return L=="string"||L=="number"||L=="symbol"||L=="boolean"?M!=="__proto__":M===null},kc=function(M,L){var $=M.__data__;return dp(L)?$[typeof L=="string"?"string":"hash"]:$.map},_T=function(M){var L=kc(this,M).delete(M);return this.size-=L?1:0,L},wT=function(M){return kc(this,M).get(M)},pp=function(M){return kc(this,M).has(M)},xT=function(M,L){var $=kc(this,M),_=$.size;return $.set(M,L),this.size+=$.size==_?0:1,this};function Fl(w){var M=-1,L=w==null?0:w.length;for(this.clear();++M<L;){var $=w[M];this.set($[0],$[1])}}Fl.prototype.clear=Bl,Fl.prototype.delete=_T,Fl.prototype.get=wT,Fl.prototype.has=pp,Fl.prototype.set=xT;var fp=Fl,IT=function(M){return this.__data__.set(M,"__lodash_hash_undefined__"),this},Ll=function(M){return this.__data__.has(M)};function ul(w){var M=-1,L=w==null?0:w.length;for(this.__data__=new fp;++M<L;)this.add(w[M])}ul.prototype.add=ul.prototype.push=IT,ul.prototype.has=Ll;var Pg=ul,Cv=function(M,L,$,_){for(var Y=M.length,Oe=$+(_?1:-1);_?Oe--:++Oe<Y;)if(L(M[Oe],Oe,M))return Oe;return-1},mp=function(M){return M!=M},Ag=function(M,L,$){for(var _=$-1,Y=M.length;++_<Y;)if(M[_]===L)return _;return-1},ET=function(M,L,$){return L==L?Ag(M,L,$):Cv(M,mp,$)},Mv=function(M,L){return!!(M!=null&&M.length)&&ET(M,L,0)>-1},kv=function(M,L,$){for(var _=-1,Y=M==null?0:M.length;++_<Y;)if($(L,M[_]))return!0;return!1},Og=function(M,L){for(var $=-1,_=M==null?0:M.length,Y=Array(_);++$<_;)Y[$]=L(M[$],$,M);return Y},gp=function(M,L){return M.has(L)},_v=function(M,L,$,_){var Y=-1,Oe=Mv,pe=!0,At=M.length,jt=[],ur=L.length;if(!At)return jt;$&&(L=Og(L,Al($))),_?(Oe=kv,pe=!1):L.length>=200&&(Oe=gp,pe=!1,L=new Pg(L));e:for(;++Y<At;){var gr=M[Y],vr=$==null?gr:$(gr);if(gr=_||gr!==0?gr:0,pe&&vr==vr){for(var Cr=ur;Cr--;)if(L[Cr]===vr)continue e;jt.push(gr)}else Oe(L,vr,_)||jt.push(gr)}return jt},$l=function(M){return M},Ng=function(M,L,$){switch($.length){case 0:return M.call(L);case 1:return M.call(L,$[0]);case 2:return M.call(L,$[0],$[1]);case 3:return M.call(L,$[0],$[1],$[2])}return M.apply(L,$)},Rg=Math.max,hp=function(M,L,$){return L=Rg(L===void 0?M.length-1:L,0),function(){for(var _=arguments,Y=-1,Oe=Rg(_.length-L,0),pe=Array(Oe);++Y<Oe;)pe[Y]=_[L+Y];Y=-1;for(var At=Array(L+1);++Y<L;)At[Y]=_[Y];return At[L]=$(pe),Ng(M,this,At)}},wv=function(M){return function(){return M}},pd=function(){try{var w=cl(Object,"defineProperty");return w({},"",{}),w}catch{}}(),xv=pd?function(w,M){return pd(w,"toString",{configurable:!0,enumerable:!1,value:wv(M),writable:!0})}:$l,PT=Date.now,vp=function(M){var L=0,$=0;return function(){var _=PT(),Y=16-(_-$);if($=_,Y>0){if(++L>=800)return arguments[0]}else L=0;return M.apply(void 0,arguments)}},Iv=vp(xv),Bg=function(M){return typeof M=="number"&&M>-1&&M%1==0&&M<=9007199254740991},yp=function(M){return M!=null&&Bg(M.length)&&!ep(M)},Ev=function(M){return hi(M)&&yp(M)},Pv=function(M,L){return Iv(hp(M,L,$l),M+"")}(function(w,M){return Ev(w)?_v(w,M):[]}),Fg=Pv;function bp(w,M){return M instanceof RegExp?"__REGEXP "+M.toString():M}function En(w,M,L){var $;M===void 0&&(M={});var _={};return In($=Vo(w)).call($,function(Y){var Oe=w[Y].type,pe=L?"In "+L+", ":"";if(M[Y]===void 0){if(w[Y].required===!1)return void(_[Y]=M[Y]);throw new yo(pe+'param "'+Y+'" is required',{key:Y},"required")}var At=AT[Oe];if(At&&!At(M,Y,w[Y]))throw new yo(pe+'param "'+Y+'" expects '+Wo(w[Y],bp),{key:Y,value:M[Y]},Wo(w[Y]));_[Y]=M[Y]}),_}var AT={string:function(M,L,$){var _=$.allowEmpty,Y=$.max,Oe=$.min,pe=$.regExp,At=M[L];return typeof At=="string"&&(_!==!1||At!=="")&&!(typeof Y=="number"&&At.length>Y)&&!(typeof Oe=="number"&&At.length<Oe)&&!(xg(pe)&&!pe.test(At))},number:function(M,L,$){var _=$.min,Y=$.max,Oe=M[L];return typeof Oe=="number"&&!(typeof _=="number"&&Oe<_)&&!(typeof Y=="number"&&Oe>Y)},boolean:function(M,L){return typeof M[L]=="boolean"},enum:function(M,L,$){var _=sp($),Y=M[L];return!_||ka(_).call(_,Y)>-1},array:function(M,L,$){var _,Y=$.itemType,Oe=$.rules,pe=$.min,At=$.max,jt=sp($),ur=M[L];return!!gi(ur)&&!(typeof At=="number"&&ur.length>At)&&!(typeof pe=="number"&&ur.length<pe)&&!(Y&&Y!=="enum"&&!iT(ur).call(ur,function(gr){return typeof gr===Y}))&&(Y!=="enum"||!jt||!Fg.apply(void 0,ks(_=[ur]).call(_,jt)).length)&&(Oe&&In(ur).call(ur,function(gr,vr){return En(Oe,gr,L+"["+vr+"]")}),!0)},object:function(M,L,$){var _=$.rules,Y=M[L];return _&&En(_,Y,L),!0}},jl=cl(Ps,"Set"),OT=function(){},Gr=function(M){var L=-1,$=Array(M.size);return M.forEach(function(_){$[++L]=_}),$},NT=jl&&1/Gr(new jl([,-0]))[1]==1/0?function(w){return new jl(w)}:OT,Dl=NT,RT=function(M,L,$){var _=-1,Y=Mv,Oe=M.length,pe=!0,At=[],jt=At;if($)pe=!1,Y=kv;else if(Oe>=200){var ur=L?null:Dl(M);if(ur)return Gr(ur);pe=!1,Y=gp,jt=new Pg}else jt=L?[]:At;e:for(;++_<Oe;){var gr=M[_],vr=L?L(gr):gr;if(gr=$||gr!==0?gr:0,pe&&vr==vr){for(var Cr=jt.length;Cr--;)if(jt[Cr]===vr)continue e;L&&jt.push(vr),At.push(gr)}else Y(jt,vr,$)||(jt!==At&&jt.push(vr),At.push(gr))}return At},Tp=function(M){return M&&M.length?RT(M):[]},Lg=`	
\v\f\r                　\u2028\u2029\uFEFF`,Av=he("".replace),Sp="["+Lg+"]",BT=RegExp("^"+Sp+Sp+"*"),$g=RegExp(Sp+Sp+"*$"),Cp=function(w){return function(M){var L=Aa(fr(M));return 1&w&&(L=Av(L,BT,"")),2&w&&(L=Av(L,$g,"")),L}},Mp={start:Cp(1),end:Cp(2),trim:Cp(3)}.trim,fd=c.parseInt,Ov=c.Symbol,kp=Ov&&Ov.iterator,Nv=/^[+-]?0x/i,md=he(Nv.exec),jg=fd(Lg+"08")!==8||fd(Lg+"0x16")!==22||kp&&!d(function(){fd(Object(kp))})?function(M,L){var $=Mp(Aa(M));return fd($,L>>>0||(md(Nv,$)?16:10))}:fd;Vr({global:!0,forced:parseInt!=jg},{parseInt:jg});var Pi,_o=or.parseInt,_p=(Pi=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return Pi()+Pi()+Pi()+Pi()+Pi()+Pi()+Pi()+Pi()});function vi(w){var M;return is(M=Vo(w)).call(M,function(L){return!(+L>=0)})}function Ai(w,M){var L,$=is(L=Vo(w)).call(L,function(_){return w[_]==M});return $.length>0?$[0]:void 0}function Lo(w,M){if(M===void 0&&(M="-"),!w)throw new rc("No sessionId",{},400);var L=ka(w).call(w,M);if(L===-1)throw new rc("Can not find conjunctions",{},400);var $=Co(w).call(w,0,L);return{accid:Co(w).call(w,L+1),scene:$==="super_team"?"superTeam":$}}var Dg=TypeError,ia=Object.getOwnPropertyDescriptor,Rv=Ne&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(w){return w instanceof TypeError}}()?function(w,M){if(Ya(w)&&!ia(w,"length").writable)throw Dg("Cannot set read only .length");return w.length=M}:function(w,M){return w.length=M},FT=TypeError,wp=function(w,M){if(!delete w[M])throw FT("Cannot delete property "+Rr(M)+" of "+Rr(w))},LT=Di("splice"),$T=Math.max,xp=Math.min;Vr({target:"Array",proto:!0,forced:!LT},{splice:function(M,L){var $,_,Y,Oe,pe,At,jt=$n(this),ur=Ia(jt),gr=ri(M,ur),vr=arguments.length;for(vr===0?$=_=0:vr===1?($=0,_=ur-gr):($=vr-2,_=xp($T(Li(L),0),ur-gr)),uu(ur+$-_),Y=fu(jt,_),Oe=0;Oe<_;Oe++)(pe=gr+Oe)in jt&&Rs(Y,Oe,jt[pe]);if(Y.length=_,$<_){for(Oe=gr;Oe<ur-_;Oe++)At=Oe+$,(pe=Oe+_)in jt?jt[At]=jt[pe]:wp(jt,At);for(Oe=ur;Oe>ur-_+$;Oe--)wp(jt,Oe-1)}else if($>_)for(Oe=ur-_;Oe>gr;Oe--)At=Oe+$-1,(pe=Oe+_-1)in jt?jt[At]=jt[pe]:wp(jt,At);for(Oe=0;Oe<$;Oe++)jt[Oe+gr]=arguments[Oe+2];return Rv(jt,ur-_+$),Y}});var jT=Uo("Array").splice,Ug=Array.prototype,qg=function(w){var M=w.splice;return w===Ug||er(Ug,w)&&M===Ug.splice?jT:M},DT=function(w,M,L,$){try{return $?M(Vn(L)[0],L[1]):M(L)}catch(_){Ou(w,"throw",_)}},Ip=Array,Bv=!Gm(function(w){Array.from(w)});Vr({target:"Array",stat:!0,forced:Bv},{from:function(M){var L=$n(M),$=Uc(this),_=arguments.length,Y=_>1?arguments[1]:void 0,Oe=Y!==void 0;Oe&&(Y=$o(Y,_>2?arguments[2]:void 0));var pe,At,jt,ur,gr,vr,Cr=Jc(L),xr=0;if(!Cr||this===Ip&&fm(Cr))for(pe=Ia(L),At=$?new this(pe):Ip(pe);pe>xr;xr++)vr=Oe?Y(L[xr],xr):L[xr],Rs(At,xr,vr);else for(gr=(ur=Wi(L,Cr)).next,At=$?new this:[];!(jt=Ce(gr,ur)).done;xr++)vr=Oe?DT(ur,Y,[jt.value,xr],!0):jt.value,Rs(At,xr,vr);return At.length=xr,At}});var Ep=or.Array.from,gd=Jc;function Fv(w,M){var L,$=ha!==void 0&&gd(w)||w["@@iterator"];if($)return Oo(L=($=$.call(w)).next).call(L,$);if(gi(w)||($=function(Oe,pe){var At;if(Oe){if(typeof Oe=="string")return _c(Oe,pe);var jt=Co(At=Object.prototype.toString.call(Oe)).call(At,8,-1);if(jt==="Object"&&Oe.constructor&&(jt=Oe.constructor.name),jt==="Map"||jt==="Set")return Ep(Oe);if(jt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(jt))return _c(Oe,pe)}}(w))||M&&w&&typeof w.length=="number"){$&&(w=$);var _=0;return function(){return _>=w.length?{done:!0}:{done:!1,value:w[_++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _c(w,M){(M==null||M>w.length)&&(M=w.length);for(var L=0,$=new Array(M);L<M;L++)$[L]=w[L];return $}var Va,Lv=function(){function w(){this.timerList=[],this.id=0,this.timer=null,this.timeout=0}var M=w.prototype;return M.addTimer=function($,_,Y){_===void 0&&(_=0),Y===void 0&&(Y=1);var Oe=new Date().getTime(),pe=this.id;return this.timerList.push({id:pe,loop:Y,count:0,timeout:Oe+_,interval:_,callback:$}),this.id++,this.checkTimer(Oe),pe},M.checkTimer=function($){if($===void 0&&($=new Date().getTime()),this.removeFinished(),this.timerList.length!==0||this.timer==null){for(var _,Y,Oe=0,pe=Fv(this.timerList);!(_=pe()).done;){var At=_.value;(Oe===0||Oe>At.timeout)&&(Oe=At.timeout)}this.timerList.length!==0&&(this.timer===null||Oe<this.timeout||this.timeout<$)&&(this.timer=vo(Oo(Y=this.nowTime).call(Y,this),Oe-$),this.timeout=Oe)}},M.nowTime=function(){for(var $,_=new Date().getTime(),Y=Fv(this.timerList);!($=Y()).done;){var Oe=$.value;_>=Oe.timeout&&(Oe.callback(),Oe.count++,Oe.timeout=_+Oe.interval)}this.clerTime(),this.checkTimer(_)},M.clerTime=function(){this.timer!==null&&(clearTimeout(this.timer),this.timer=null)},M.deleteTimer=function($){for(var _=this.timerList.length-1;_>=0;_--){var Y;this.timerList[_].id===$&&qg(Y=this.timerList).call(Y,_,1)}},M.removeFinished=function(){for(var $=this.timerList.length-1;$>=0;$--){var _,Y=this.timerList[$];Y.loop>=0&&Y.count>=Y.loop&&qg(_=this.timerList).call(_,$,1)}},M.destroy=function(){this.clerTime(),this.timerList=[],this.id=0,this.timer=null},w}(),$v=function(){function w(L){this.core=L}var M=w.prototype;return M.request=function($,_){var Y=this,Oe=new Date().getTime();return Ho.request($,_).catch(function(pe){var At,jt,ur=pe;throw Y.core.reporter.reportTraceStart("exceptions",{user_id:Y.core.options.account,trace_id:(jt=(At=Y.core)===null||At===void 0?void 0:At.socket)===null||jt===void 0?void 0:jt.sessionId,start_time:Oe,action:1}),Y.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof ur.code=="number"?ur.code:0,description:ur.message||""+ur.code,operation_type:0,target:$,context:_?Wo(_):""}),Y.core.reporter.reportTraceEnd("exceptions",1),pe})},M.uploadFile=function($){var _=this,Y=new Date().getTime();return Ho.uploadFile($).catch(function(Oe){var pe,At,jt=Oe;_.core.reporter.reportTraceStart("exceptions",{user_id:_.core.options.account,trace_id:(At=(pe=_.core)===null||pe===void 0?void 0:pe.socket)===null||At===void 0?void 0:At.sessionId,start_time:Y,action:1});var ur=Ho.platform==="BROWSER"?$.chunkUploadHost:$.commonUploadHost?$.commonUploadHost+"/"+($.nosToken&&$.nosToken.bucket):"https://nos.netease.com/nim";throw _.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof jt.code=="number"?jt.code:0,description:jt.message||""+jt.code,operation_type:1,target:ur}),_.core.reporter.reportTraceEnd("exceptions",1),Oe})},w}();(function(w){w[w.ACTIVE=1]="ACTIVE",w[w.KICKED=2]="KICKED",w[w.OFFLINE=3]="OFFLINE"})(Va||(Va={}));var ls=window&&ep(window.addEventListener)&&ep(window.removeEventListener),jv=function(w){function M($,_){var Y;(Y=w.call(this)||this).status="unconnected",Y.linkUrls=[],Y.eventBus=new Vs,Y.packetSer=1,Y.retryCount=0,Y.reconnectTimer=0,Y.backoff=new wi({max:8e3,min:1600,jitter:.01}),Y.sendingCmdMap=new ec,Y.pingTimer=0,Y.config=uv,Y.abtInfo={},En({linkUrls:{type:"array",itemType:"string",required:!1}},$),Y.options=Mr(Mr({},H1),$),Y.adapters=new $v(i(Y));var Oe=Ho.localStorage.getItem("__NIM_DEVC_ID__");Y.options.isFixedDeviceId?(Oe=Ho.localStorage.getItem("__NIM_DEVC_ID__")||_p(),Ho.localStorage.setItem("__NIM_DEVC_ID__",Oe)):Oe=_p(),Y.config=Mr(Mr(Mr({},uv),_),{deviceId:Oe}),Y.timerManager=new Lv,Y.logger=new np(Y.options.debugLevel,Y.options.account);var pe=Ho.getSystemInfo();return Y.reporter=new nT({common:{app_key:$.appkey,dev_id:Oe,platform:"Web",sdk_ver:"0.13.1",env:"online",os_name:pe.os,os_ver:pe.osVer,model:pe.hostEnvVer,manufactor:pe.hostEnv,host_env:pe.hostEnv,host_info:pe.hostInfo,host_env_ver:pe.hostEnvVer},request:Ho.request,logger:Y.logger,autoStart:Ho.platform==="BROWSER"}),Ho.setLogger(Y.logger),Y.logger.log("Core init, version ","0.13.1"," sdk version ",91001," appkey ",$.appkey),Y}Ro(M,w);var L=M.prototype;return L.emit=function(_){try{for(var Y,Oe,pe=sa(),At=arguments.length,jt=new Array(At>1?At-1:0),ur=1;ur<At;ur++)jt[ur-1]=arguments[ur];var gr=(Y=w.prototype.emit).call.apply(Y,ks(Oe=[this,_]).call(Oe,jt)),vr=sa()-pe;return vr>=10&&this.logger.warn("Core::emit event: "+_+" process takes: "+vr+"ms"),gr}catch(Cr){return this.logger.error("Core::emit event: "+_+". Error: "+Cr),!1}},L.connect=function(_,Y){return _===void 0&&(_={}),Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt,ur,gr,vr;return ar.wrap(function(xr){for(;;)switch(xr.prev=xr.next){case 0:if(En({linkUrls:{type:"array",itemType:"string",required:!1}},_),/^(unconnected|waitReconnect)$/.test(this.status)){xr.next=5;break}return pe="Core socket status is "+this.status+", and would not connect",this.logger.warn(pe),xr.abrupt("return",co.reject(pe));case 5:this.status="connecting",_.linkUrls&&_.linkUrls.length>0&&(this.linkUrls=ks(At=_.linkUrls).call(At,this.linkUrls),this.linkUrls=Tp(this.linkUrls)),this.linkUrls.length===0&&this.linkUrls.push(dv),jt=0;case 9:if(!(jt<this.linkUrls.length)){xr.next=32;break}return ur=this.linkUrls[jt],gr=new Date().getTime(),xr.prev=12,xr.next=15,this.doConnect(ur);case 15:return this.status="connected",this.logger.log("core:: connect success with url: "+ur),this.abtRequest(),xr.abrupt("return",ur);case 21:xr.prev=21,xr.t0=xr.catch(12),vr=xr.t0,Y&&Y(vr,ur),this.reporter.reportTraceStart("exceptions",{user_id:this.options.account,start_time:gr,action:0}),this.reporter.reportTraceUpdateV2("exceptions",{code:typeof vr.code=="number"?vr.code:0,description:vr.message||""+vr.code,operation_type:0,target:ur}),this.reporter.reportTraceEnd("exceptions",1),this.logger.warn("core:: connect failed with url: "+ur,xr.t0);case 29:jt++,xr.next=9;break;case 32:throw this.retryCount===0?this.doDisconnect(Va.ACTIVE,"SocketHandshakeFailed"):this.doDisconnect(Va.OFFLINE,"ReconnectHadRetryAllLinks"),new Error("core: socket handshake failed");case 34:case"end":return xr.stop()}},Oe,this,[[12,21]])}))},L.doConnect=function(_){var Y=this;return new co(function(Oe,pe){var At;Y.socket=new Mg(Y,_,Y.logger),Y.socket.on("connect",function(){Y.logger.log("socket on connect",_),Oe()}),Y.socket.on("message",Oo(At=Y.onMessage).call(At,Y)),Y.socket.on("disconnect",function(jt){Y.logger.log("core:: socket on disconnect",jt),Y.doDisconnect(Va.OFFLINE,"SocketOnDisconnect")}),Y.socket.on("handshakeFailed",function(){Y.logger.warn("core:: socket handshake failed"),pe(new rc("handshake failed",{},408))})})},L.resetConnectStatus=function(){clearTimeout(this.reconnectTimer),this.backoff.reset(),this.retryCount=0,this.initOnlineListener()},L.doDisconnect=function(_,Y){if(this.logger.log("doDisconnect: type "+_+", description "+Y),this.status!=="unconnected"){this.markAllCmdInvaild(new rc("Packet timeout due to instance disconnect",{},408)),this.timerManager.destroy(),clearTimeout(this.pingTimer),this.socket&&(typeof this.socket.removeAllListeners=="function"&&this.socket.removeAllListeners(),typeof this.socket.close=="function"&&this.socket.close(),this.socket=void 0);var Oe=!this.options.needReconnect||this.retryCount>=this.options.reconnectionAttempts;if(_===Va.ACTIVE||Oe)this.logger.log("doDisconnect: emit disconnect, type "+_,Oe),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.eventBus.emit("disconnect"),this.emit("disconnect"),this.destroyOnlineListener();else if(_===Va.KICKED){this.logger.log("doDisconnect: kicked"),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer);var pe=typeof Y=="string"?{reason:"unknow",message:Y}:Y;this.eventBus.emit("kicked",pe),this.emit("kicked",pe),this.destroyOnlineListener()}else _===Va.OFFLINE?(this.logger.log("doDisconnect: start to reconnect"),this.attempToReconnect()):this.logger.log("doDisconnect: nothing to do")}else this.logger.warn("doDisconnect: already unconnected")},L.attempToReconnect=function(){var _=this;if(this.status!=="waitReconnect"){var Y=this.backoff.duration();this.retryCount++,this.logger.log("willReconnect "+this.retryCount+" "+Y),this.eventBus.emit("willReconnect",{retryCount:this.retryCount,duration:Y}),this.emit("willReconnect",{retryCount:this.retryCount,duration:Y}),this.status="waitReconnect",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=vo(function(){_.status==="waitReconnect"?_.connect({isAutoReconnect:!0}).catch(function(){_.logger.error("core::attempToReconnect failed "+_.retryCount)}):_.logger.warn("doDisconnect: reconnectTimer status is "+_.status+", would not go on reconnecting")},Y)}else this.logger.warn("doDisconnect: already is waiting reconnect")},L.sendCmd=function(_,Y,Oe){var pe=this;if(this.status!=="logined"&&_!=="login"&&_!=="chatroomLogin"&&_!=="qchatLogin")return this.logger.warn("nim status is "+this.status+", so can not sendCmd "+_),co.reject({cmd:_,error:{code:"No_connected",message:"Connection not established",timetag:new Date().getTime()}});if(!this.socket||!this.socket.send)return co.reject("No_socket");var At=_!=="heartbeat",jt=At?this.packetSer++:0,ur=function(zr,Hr,Kr,kn){var Jn=Pl[zr];if(!Jn)return Kr.error("createCmd:: can not find cmd config: ",zr),null;var Hn,xo={SER:Hr,SID:Jn.sid,CID:Jn.cid,Q:[]};return Jn.params&&kn&&In(Hn=Jn.params).call(Hn,function(Ln){var _r=kn[Ln.name];if(!yv(_r)){var Pn=Ln.type,Fn=Ln.reflectMapper;switch(Ln.type){case"PropertyArray":Pn="ArrayMable",_r=To(_r).call(_r,function(_n){return{t:"Property",v:Fn?id(_n,Fn):_n}});break;case"Property":_r=Fn?id(_r,Fn):_r;break;case"Bool":case"bool":_r=_r?"true":"false"}xo.Q.push({t:Pn,v:_r})}}),{packet:xo,isNoResponse:Jn.isNoResponse||!1}}(_,jt,this.logger,Y);if(!ur){var gr="SendCmd "+jt+" "+_+" error";return this.logger.error(gr),co.reject(gr)}var vr=ur.packet,Cr=ur.isNoResponse,xr=Wo(vr);At&&(this.options.debugLevel==="debug"?this.logger.debug("core::sendCmd",_,"ser:"+jt,xr):this.logger.log("core::sendCmd",_,"ser:"+jt));var Br=new Date().getTime();return new co(function(jr,zr){pe.sendingCmdMap.set(jt,{cmd:_,params:Y,callback:[jr,zr],timer:Cr?null:vo(function(){var Kr,kn=new rp(504,_,"Packet Timeout",new Date().getTime(),{message:"ser "+jt+" cmd "+_+" timeout"});kn.callFunc="sendCmd",pe.markCmdInvalid(jt,kn,_),pe.reporter.reportTraceStart("exceptions",{user_id:pe.options.account,trace_id:(Kr=pe.socket)===null||Kr===void 0?void 0:Kr.sessionId,start_time:Br,action:2}),pe.reporter.reportTraceUpdateV2("exceptions",{code:408,description:"Packet timeout",operation_type:1,target:vr.SID+"-"+vr.CID,context:""+vr.SER}),pe.reporter.reportTraceEnd("exceptions",1)},Oe&&Oe.timeout?Oe.timeout:pe.config.timeout)});try{pe.socket.send(xr)}catch(Kr){var Hr=new rp(415,_,Kr&&Kr.message||"Unable to send packet",new Date().getTime(),{message:"send json error",rawError:Kr});Hr.callFunc="sendCmd",pe.markCmdInvalid(jt,Hr,_),zr(Kr)}})},L.onMessage=function(_){var Y=bv(_,this.logger);if(Y){var Oe=Y.raw.ser;if(Y.error&&this.logger.error("core:onMessage packet error",Y.raw.sid+"_"+Y.raw.cid+", ser:"+Oe+",",Y.error),!Y.notFound)return Y.cmd!=="heartbeat"&&(this.options.debugLevel==="debug"?this.logger.debug("imsocket::recvCmd ser:"+Oe,Y.cmd,Y.content):this.logger.log("imsocket::recvCmd ser:"+Oe,Y.cmd)),Y.__receiveTime=sa(),Y;this.logger.warn("core::onMessage packet not found",Y.raw.sid+"_"+Y.raw.cid+", ser:"+Oe)}},L.markCmdInvalid=function(_,Y,Oe){var pe=this.sendingCmdMap.get(_);if(pe){var At=pe.callback,jt=pe.timer;jt&&clearTimeout(jt),this.sendingCmdMap.delete(_),this.logger.warn("packet "+_+", "+Oe+" is invalid:",Y),At[1](Y)}},L.markAllCmdInvaild=function(_){var Y;this.logger.log("markAllCmdInvaild"),In(Y=this.sendingCmdMap).call(Y,function(Oe){var pe=Oe.callback,At=Oe.timer;At&&clearTimeout(At),pe[1](_)}),this.sendingCmdMap.clear()},L.ping=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var Y=this;return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return clearTimeout(this.pingTimer),pe.prev=1,pe.next=4,this.sendCmd("heartbeat");case 4:pe.next=14;break;case 6:return pe.prev=6,pe.t0=pe.catch(1),pe.next=10,this.testHeartBeat5Timeout();case 10:if(!pe.sent){pe.next=14;break}return this.doDisconnect(Va.OFFLINE,"PingError"),pe.abrupt("return");case 14:this.pingTimer=vo(function(){Y.ping()},3e4);case 15:case"end":return pe.stop()}},_,this,[[1,6]])}))},L.testHeartBeat5Timeout=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var Y;return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:clearTimeout(this.pingTimer),Y=0;case 2:if(!(Y<5)){pe.next=15;break}return pe.prev=3,pe.next=6,this.sendCmd("heartbeat",{},{timeout:3e3});case 6:return pe.abrupt("return",!1);case 9:pe.prev=9,pe.t0=pe.catch(3),this.logger.debug("core:: test heartbeat "+Y+" Timeout");case 12:Y++,pe.next=2;break;case 15:return pe.abrupt("return",!0);case 16:case"end":return pe.stop()}},_,this,[[3,9]])}))},L.initOnlineListener=function(){var _,Y;this.onlineListener||(ls?(this.onlineListener=Oo(_=function(){this.status==="logined"&&this.ping()}).call(_,this),this.offlineListener=Oo(Y=function(){this.logger.log("offline"),this.doDisconnect(Va.OFFLINE,"OfflineListener")}).call(Y,this),window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener)):this.logger.warn("initOnlineListener not support add listener"))},L.destroyOnlineListener=function(){this.onlineListener&&(window.removeEventListener("online",this.onlineListener),this.onlineListener=void 0),this.offlineListener&&(window.removeEventListener("offline",this.offlineListener),this.offlineListener=void 0)},L.disconnect=function(){switch(this.status){case"connected":case"logined":case"connecting":case"waitReconnect":return this.doDisconnect(Va.ACTIVE,"UserActiveDisconnect"),co.resolve();case"unconnected":case"destroyed":return co.resolve()}},L.destroy=function(){var _=this;return this.disconnect().then(function(){_.status="destroyed",_.removeAllListeners(),_.eventBus.removeAllListeners(),_.reporter.destroy(),_.connect=function(){return co.resolve()},_.disconnect=function(){return co.resolve()},_.destroy=function(){return co.resolve()}})},L.abtRequest=function(){var _,Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:if(this.options.isAbtestEnable){ur.next=2;break}return ur.abrupt("return");case 2:if(!this.abtInfo.experiments){ur.next=4;break}return ur.abrupt("return");case 4:if(this.options.abtestUrl){ur.next=6;break}return ur.abrupt("return");case 6:return ur.prev=6,ur.next=9,this.adapters.request(this.options.abtestUrl,{method:"POST",dataType:"json",headers:{sdktype:"ABTest"},data:{clientInfo:{projectKey:this.options.abtestProjectKey,appKey:this.options.appkey,osType:"Web",sdkVersion:"0.13.1",deviceId:this.config.deviceId},useLocalCache:!0}});case 9:pe=ur.sent,ur.next=15;break;case 12:ur.prev=12,ur.t0=ur.catch(6),this.logger.warn("ABTest request failed");case 15:this.abtInfo=((Y=(_=pe==null?void 0:pe.data)===null||_===void 0?void 0:_.data)===null||Y===void 0?void 0:Y.abtInfo)||{},this.abtInfo.experiments&&this.abtInfo.experiments.length>0&&this.reporter.reportImmediately("https://statistic.live.126.net/statics/report/abtest/result",{params:{app_key:this.options.appkey,biz_sdk_type:"IM",sdk_ver:"0.13.1",device_id:this.config.deviceId,platform:"Web",projectKey:this.options.abtestProjectKey,experiments:To(At=this.abtInfo.experiments).call(At,function(gr){return{experimentKey:gr.experimentKey,schemeKey:gr.schemeKey}})},headers:{sdktype:"ABTest"},method:"POST",dataType:"json"});case 17:case"end":return ur.stop()}},Oe,this,[[6,12]])}))},M}(Vs);jv.setAdapters=function(M){Mr(Ho,M)};var Dv={"1_2":"heartbeat","2_3":"login","2_5":"kicked","2_6":"logout","2_7":"multiPortLogin","2_8":"kick"},Uv={login:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appkey:18,account:19,browser:24,session:26,deviceInfo:32,isReactNative:112,token:1e3,customTag:38,customClientType:39,sdkHumanVersion:40,sdkType:41,userAgent:42,authType:115,loginExt:116},loginRes:{lastLoginDeviceId:17,customTag:38,connectionId:102,ip:103,port:104,country:106,hasXMPush:111},loginPort:{type:3,os:4,mac:5,deviceId:13,account:19,deviceInfo:32,customTag:38,connectionId:102,ip:103,time:109},aosPushInfo:{pushType:110,hasTokenPreviously:111}},hd=rs(Uv),qv={login:{sid:2,cid:3,service:"auth",params:[{type:"Property",name:"login",reflectMapper:Uv.login}],response:[{type:"Property",name:"loginRes",reflectMapper:hd.loginRes},{type:"PropertyArray",name:"loginPorts",reflectMapper:hd.loginPort},{type:"Property",name:"aosPushInfo",reflectMapper:hd.aosPushInfo}]},logout:{sid:2,cid:6,service:"auth"},heartbeat:{sid:1,cid:2,service:"auth"},kicked:{sid:2,cid:5,service:"auth",response:[{type:"Number",name:"clientType"},{type:"Number",name:"reason"},{type:"String",name:"ext"},{type:"Number",name:"customClientType"}]},multiPortLogin:{sid:2,cid:7,service:"auth",response:[{type:"Number",name:"state"},{type:"PropertyArray",name:"loginPorts",reflectMapper:hd.loginPort}]},kick:{sid:2,cid:8,service:"auth",params:[{type:"StrArray",name:"deviceIds"}],response:[{type:"StrArray",name:"deviceIds"}]}},yi=Array.isArray,Pp=function(M){return typeof M=="symbol"||hi(M)&&yc(M)=="[object Symbol]"},Vg=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ap=/^\w*$/,Hg=function(M,L){if(yi(M))return!1;var $=typeof M;return!($!="number"&&$!="symbol"&&$!="boolean"&&M!=null&&!Pp(M))||Ap.test(M)||!Vg.test(M)||L!=null&&M in Object(L)};function zg(w,M){if(typeof w!="function"||M!=null&&typeof M!="function")throw new TypeError("Expected a function");var L=function(){var $=arguments,_=M?M.apply(this,$):$[0],Y=L.cache;if(Y.has(_))return Y.get(_);var Oe=w.apply(this,$);return L.cache=Y.set(_,Oe)||Y,Oe};return L.cache=new(zg.Cache||fp),L}zg.Cache=fp;var UT=zg,qT=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,VT=/\\(\\)?/g,Ul=function(M){var L=UT(M,function(_){return $.size===500&&$.clear(),_}),$=L.cache;return L}(function(w){var M=[];return w.charCodeAt(0)===46&&M.push(""),w.replace(qT,function(L,$,_,Y){M.push(_?Y.replace(VT,"$1"):$||L)}),M}),Op=Ul,Vv=Gs?Gs.prototype:void 0,Kg=Vv?Vv.toString:void 0,Hv=function w(M){if(typeof M=="string")return M;if(yi(M))return Og(M,w)+"";if(Pp(M))return Kg?Kg.call(M):"";var L=M+"";return L=="0"&&1/M==-1/0?"-0":L},HT=function(M){return M==null?"":Hv(M)},vd=function(M,L){return yi(M)?M:Hg(M,L)?[M]:Op(HT(M))},dl=function(M){if(typeof M=="string"||Pp(M))return M;var L=M+"";return L=="0"&&1/M==-1/0?"-0":L},Wg=function(M,L){for(var $=0,_=(L=vd(L,M)).length;M!=null&&$<_;)M=M[dl(L[$++])];return $&&$==_?M:void 0},As=function(M,L,$){var _=M==null?void 0:Wg(M,L);return _===void 0?$:_},Oi={debugLevel:"off",needReconnect:!0,reconnectionAttempts:Xm,lbsUrls:["https://lbs.netease.im/lbs/webconf.jsp"],linkUrl:dv,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},Np={},Fa=function(w){function M($,_){var Y,Oe;_===void 0&&(_={serverConfig:{},syncOptions:{},sessionConfig:{}}),(Oe=w.call(this,$)||this).instanceName="NIM",Oe.account="",Oe.options={},Oe.auth={},Oe.offlinePush={},Oe.sync={},Oe.msg={},Oe.msgLog={},Oe.session={},Oe.cloudSession={},Oe.misc={},Oe.user={},Oe.friend={},Oe.systemMessage={},Oe.team={},Oe.event={},Oe.msgExtend={},Oe.cloudStorage={},Oe.passThrough={},Oe.superTeam={},Oe.plugin={},Oe.signaling={},Oe.setOptions($),qa({cmdMap:Dv,cmdConfig:qv});var pe=null;return In(Y=Vo(Np)).call(Y,function(At){var jt=Np[At];At==="sync"?pe=jt:Oe[At]=At==="session"?new jt(i(Oe),_.sessionConfig):At==="cloudStorage"?new jt(i(Oe),Mr({storageKeyPrefix:Oe.instanceName},_.serverConfig,_.cloudStorageConfig)):new jt(i(Oe))}),pe&&(Oe.sync=new pe(i(Oe),_.syncOptions)),M.instance=i(Oe),Oe}Ro(M,w),M.getInstance=function(_,Y){if(!M.instance){if(_)return new M(_,Y);throw new Error("Instance not exist, please input options")}if(_){if(M.instance.options.account===_.account&&M.instance.options.appkey===_.appkey)return M.instance.setOptions(_),M.instance;throw new Error("Unexpected login")}return M.instance};var L=M.prototype;return L.setOptions=function(_){En({account:{type:"string"},appkey:{type:"string"},token:{type:"string"},needReconnect:{type:"boolean",required:!1},reconnectionAttempts:{type:"number",required:!1},customClientType:{type:"number",min:1,required:!1},authType:{type:"number",min:0,max:2,required:!1},lbsUrls:{type:"array",itemType:"string",min:1,required:!1},linkUrl:{type:"string",allowEmpty:!1,required:!1}},_),this.logger.log("NIM::setOptions options is",_),this.account=_.account,this.options=Mr(Mr({},Oi),_)},L.connect=function(_){_===void 0&&(_={});var Y=Ja(null,{connect:{get:function(){return w.prototype.connect}}});return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt=this;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:if(/^(unconnected|waitReconnect)$/.test(this.status)){gr.next=4;break}return pe="NIM status is "+this.status+", and would not connect",this.logger.warn(pe),gr.abrupt("return",co.reject(pe));case 4:return this.reporter.reportTraceCancel("login"),this.reporter.reportTraceStart("login",{user_id:this.options.account,action:_.isAutoReconnect?"auto_login":"manual_login"}),this.reporter.reportTraceUpdateV2("login",{code:0,description:Wo(Mr(Mr({},this.options),{account:"***",token:"***"})),operation_type:"conf_init",succeed:!0,duration:0,target:""}),gr.next=9,this.getLbsInfos();case 9:return gr.prev=9,gr.next=12,Y.connect.call(this,_,function(vr,Cr){jt.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:Cr,code:vr.code||408,description:"ws_handshake_failed:"+vr.message,succeed:!1})});case 12:(At=gr.sent)&&this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:At,code:200,succeed:!0}),gr.next=20;break;case 16:throw gr.prev=16,gr.t0=gr.catch(9),this.reporter.reportTraceEnd("login",!1),gr.t0;case 20:return gr.next=22,this.login(_.isAutoReconnect);case 22:case"end":return gr.stop()}},Oe,this,[[9,16]])}))},L.login=function(_){return _===void 0&&(_=!1),Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return jt.prev=0,jt.next=3,this.auth.doLogin(_);case 3:Oe=jt.sent,this.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",code:200,succeed:!0}),this.reporter.reportTraceEnd("login",!0),this.status="logined",jt.next=20;break;case 9:if(jt.prev=9,jt.t0=jt.catch(0),pe=jt.t0,this.logger.warn("nim login:: login failed",jt.t0),this.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",code:pe.code||0,succeed:!1,description:pe.message}),this.reporter.reportTraceEnd("login",!1),this.retryCount!==0){jt.next=18;break}throw this.doDisconnect(Va.ACTIVE,"FailedToInitializeLogin"),jt.t0;case 18:return this.doDisconnect(Va.OFFLINE,"ReconnectLoginFailed"),jt.abrupt("return");case 20:return jt.prev=20,jt.next=23,this.cloudStorage.init();case 23:jt.next=28;break;case 25:jt.prev=25,jt.t1=jt.catch(20),this.logger.error("NIM:login cloudStorage init failed ",jt.t1);case 28:if(this.eventBus.emit("logined",Oe),this.emit("logined",Oe),this.logger.log("login done"),this.resetConnectStatus(),!this.sync||!this.sync.doSync){jt.next=35;break}return jt.next=35,this.sync.doSync();case 35:this.ping();case 36:case"end":return jt.stop()}},Y,this,[[0,9],[20,25]])}))},L.onMessage=function(_){var Y,Oe,pe=w.prototype.onMessage.call(this,_);if(pe){var At=pe.raw.ser,jt=this.sendingCmdMap.get(At);if(jt&&jt.cmd===pe.cmd){var ur=jt.callback,gr=jt.timer,vr=jt.params;if(clearTimeout(gr),pe.params=vr,this.sendingCmdMap.delete(At),pe.cmd==="heartbeat")return void ur[0]();var Cr=(Y=this[pe.service])===null||Y===void 0?void 0:Y.process(pe);Cr&&typeof Cr.then=="function"?Cr.then(function(xr){ur[0](xr)}).catch(function(xr){ur[1](xr)}):(this.logger.log("imsocket:: handlerFn without promise",pe.service,pe.cmd),ur[0]())}else(Oe=this[pe.service])===null||Oe===void 0||Oe.process(pe)}},L.getLbsInfos=function(){var _;return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe,At,jt,ur,gr,vr,Cr,xr;return ar.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Oe=this.options.lbsUrls[0],pe=ka(Oe).call(Oe,"?")>-1?"&":"?",At=Oe+pe+"k="+this.options.appkey+"&id="+this.options.account+"&sv=180&pv=1&networkType=0",jr.prev=3,this.logger.log("getLbsInfos ",At),jr.next=7,this.adapters.request(At,{method:"GET",dataType:"json",timeout:1e4});case 7:if((ur=jr.sent).status===200&&ur.data){jr.next=11;break}throw this.logger.error("getLbsInfos::error status",ur.status,ur),new Error("getLbsInfos failed, status "+ur.status);case 11:this.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:At,code:200,succeed:!0}),gr=ur.data,vr=[this.options.linkUrl],As(gr,"common.link")&&(vr=ks(Cr=As(gr,"common.link")).call(Cr,vr)),As(gr,'common["link.default"]')&&(vr=ks(vr).call(vr,As(gr,'common["link.default"]'))),this.linkUrls=Tp(vr),ur.data["nos-chunk"]&&((_=this.cloudStorage)===null||_===void 0||_.setOptions({chunkUploadHost:ur.data["nos-chunk"]})),this.logger.log("getLbsInfos success, socket link:",Co(jt=this.linkUrls).call(jt,0),"chunkUploadHost: ",ur.data["nos-chunk"]),jr.next=27;break;case 21:jr.prev=21,jr.t0=jr.catch(3),xr=jr.t0,this.logger.error("getLbsInfos::error",xr),this.linkUrls=[this.options.linkUrl],this.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:At,description:xr.message,code:xr.code||0,succeed:!1});case 27:case"end":return jr.stop()}},Y,this,[[3,21]])}))},L.disconnect=function(){var _=this;switch(this.status){case"logined":return this.sendCmd("logout",void 0,{timeout:1e3}).then(function(){w.prototype.doDisconnect.call(_,Va.ACTIVE,"UserActiveDisconnect")}).catch(function(Y){_.logger.error("NIM::disconnect sendCmd:logout error",Y),w.prototype.doDisconnect.call(_,Va.ACTIVE,"UserActiveDisconnect")});case"connected":case"connecting":case"waitReconnect":return w.prototype.doDisconnect.call(this,Va.ACTIVE,"UserActiveDisconnect"),co.resolve();case"unconnected":case"destroyed":return co.resolve()}},L.destroy=function(){return M.instance=null,w.prototype.destroy.call(this)},L.kick=function(_){return En({deviceIds:{type:"array",itemType:"string"}},_),this.auth.kick(_)},M.registerService=function(_,Y){Np[Y]=_},M}(jv);Fa.instance=null;var zv=Math.min,Gg=[].lastIndexOf,Qg=!!Gg&&1/[1].lastIndexOf(1,-0)<0,zT=Ds("lastIndexOf"),Jg=Qg||!zT?function(M){if(Qg)return T(Gg,this,arguments)||0;var L=sr(this),$=Ia(L),_=$-1;for(arguments.length>1&&(_=zv(_,Li(arguments[1]))),_<0&&(_=$+_);_>=0;_--)if(_ in L&&L[_]===M)return _||0;return-1}:Gg;Vr({target:"Array",proto:!0,forced:Jg!==[].lastIndexOf},{lastIndexOf:Jg});var KT=Uo("Array").lastIndexOf,Rp=Array.prototype,Yg=function(w){var M=w.lastIndexOf;return w===Rp||er(Rp,w)&&M===Rp.lastIndexOf?KT:M},ql=o(function(w,M){(function(){var L={function:!0,object:!0}[typeof window]&&window||this,$=M,_=w&&!w.nodeType&&w,Y=$&&_&&typeof e=="object"&&e;!Y||Y.global!==Y&&Y.window!==Y&&Y.self!==Y||(L=Y);var Oe=Math.pow(2,53)-1,pe=/\bOpera/,At=Object.prototype,jt=At.hasOwnProperty,ur=At.toString;function gr(Kr){return(Kr=String(Kr)).charAt(0).toUpperCase()+Kr.slice(1)}function vr(Kr){return Kr=zr(Kr),/^(?:webOS|i(?:OS|P))/.test(Kr)?Kr:gr(Kr)}function Cr(Kr,kn){for(var Jn in Kr)jt.call(Kr,Jn)&&kn(Kr[Jn],Jn,Kr)}function xr(Kr){return Kr==null?gr(Kr):ur.call(Kr).slice(8,-1)}function Br(Kr){return String(Kr).replace(/([ -])(?!$)/g,"$1?")}function jr(Kr,kn){var Jn=null;return function(xo,Ln){var _r=-1,Pn=xo?xo.length:0;if(typeof Pn=="number"&&Pn>-1&&Pn<=Oe)for(;++_r<Pn;)Ln(xo[_r],_r,xo);else Cr(xo,Ln)}(Kr,function(Hn,xo){Jn=kn(Jn,Hn,xo,Kr)}),Jn}function zr(Kr){return String(Kr).replace(/^ +| +$/g,"")}var Hr=function Kr(kn){var Jn=L,Hn=kn&&typeof kn=="object"&&xr(kn)!="String";Hn&&(Jn=kn,kn=null);var xo=Jn.navigator||{},Ln=xo.userAgent||"";kn||(kn=Ln);var _r,Pn,Fn=Hn?!!xo.likeChrome:/\bChrome\b/.test(kn)&&!/internal|\n/i.test(ur.toString()),_n="Object",bn=Hn?_n:"ScriptBridgingProxyObject",Rn=Hn?_n:"Environment",qn=Hn&&Jn.java?"JavaPackage":xr(Jn.java),oo=Hn?_n:"RuntimeObject",ao=/\bJava/.test(qn)&&Jn.java,Ko=ao&&xr(Jn.environment)==Rn,Po=ao?"a":"α",ja=ao?"b":"β",Mo=Jn.document||{},Ao=Jn.operamini||Jn.opera,oa=pe.test(oa=Hn&&Ao?Ao["[[Class]]"]:xr(Ao))?oa:Ao=null,Lc=kn,Fo=[],hc=null,Ka=kn==Ln,fo=Ka&&Ao&&typeof Ao.version=="function"&&Ao.version(),aa=function(Na){return jr(Na,function(Ta,xa){return Ta||RegExp("\\b"+(xa.pattern||Br(xa))+"\\b","i").exec(kn)&&(xa.label||xa)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),Kn=function(Na){return jr(Na,function(Ta,xa){return Ta||RegExp("\\b"+(xa.pattern||Br(xa))+"\\b","i").exec(kn)&&(xa.label||xa)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),qo=AC([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),ps=function(Na){return jr(Na,function(Ta,xa,Kh){return Ta||(xa[qo]||xa[/^[a-z]+(?: +[a-z]+\b)*/i.exec(qo)]||RegExp("\\b"+Br(Kh)+"(?:\\b|\\w*\\d)","i").exec(kn))&&Kh})}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),Zn=function(Na){return jr(Na,function(Ta,xa){var Kh=xa.pattern||Br(xa);return!Ta&&(Ta=RegExp("\\b"+Kh+"(?:/[\\d.]+|[ \\w.]*)","i").exec(kn))&&(Ta=function(Ml,xC,IC){var EC={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return xC&&IC&&/^Win/i.test(Ml)&&!/^Windows Phone /i.test(Ml)&&(EC=EC[/[\d.]+$/.exec(Ml)])&&(Ml="Windows "+EC),Ml=String(Ml),xC&&IC&&(Ml=Ml.replace(RegExp(xC,"i"),IC)),vr(Ml.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(Ta,Kh,xa.label||xa)),Ta})}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function AC(ti){return jr(ti,function(Na,Ta){var xa=Ta.pattern||Br(Ta);return!Na&&(Na=RegExp("\\b"+xa+" *\\d+[.\\w_]*","i").exec(kn)||RegExp("\\b"+xa+" *\\w+-[\\w]*","i").exec(kn)||RegExp("\\b"+xa+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(kn))&&((Na=String(Ta.label&&!RegExp(xa,"i").test(Ta.label)?Ta.label:Na).split("/"))[1]&&!/[\d.]+/.test(Na[0])&&(Na[0]+=" "+Na[1]),Ta=Ta.label||Ta,Na=vr(Na[0].replace(RegExp(xa,"i"),Ta).replace(RegExp("; *(?:"+Ta+"[_-])?","i")," ").replace(RegExp("("+Ta+")[-_.]?(\\w)","i"),"$1 $2"))),Na})}function OC(ti){return jr(ti,function(Na,Ta){return Na||(RegExp(Ta+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(kn)||0)[1]||null})}if(aa&&(aa=[aa]),/\bAndroid\b/.test(Zn)&&!qo&&(_r=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(kn))&&(qo=zr(_r[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),ps&&!qo?qo=AC([ps]):ps&&qo&&(qo=qo.replace(RegExp("^("+Br(ps)+")[-_.\\s]","i"),ps+" ").replace(RegExp("^("+Br(ps)+")[-_.]?(\\w)","i"),ps+" $2")),(_r=/\bGoogle TV\b/.exec(qo))&&(qo=_r[0]),/\bSimulator\b/i.test(kn)&&(qo=(qo?qo+" ":"")+"Simulator"),Kn=="Opera Mini"&&/\bOPiOS\b/.test(kn)&&Fo.push("running in Turbo/Uncompressed mode"),Kn=="IE"&&/\blike iPhone OS\b/.test(kn)?(ps=(_r=Kr(kn.replace(/like iPhone OS/,""))).manufacturer,qo=_r.product):/^iP/.test(qo)?(Kn||(Kn="Safari"),Zn="iOS"+((_r=/ OS ([\d_]+)/i.exec(kn))?" "+_r[1].replace(/_/g,"."):"")):Kn=="Konqueror"&&/^Linux\b/i.test(Zn)?Zn="Kubuntu":ps&&ps!="Google"&&(/Chrome/.test(Kn)&&!/\bMobile Safari\b/i.test(kn)||/\bVita\b/.test(qo))||/\bAndroid\b/.test(Zn)&&/^Chrome/.test(Kn)&&/\bVersion\//i.test(kn)?(Kn="Android Browser",Zn=/\bAndroid\b/.test(Zn)?Zn:"Android"):Kn=="Silk"?(/\bMobi/i.test(kn)||(Zn="Android",Fo.unshift("desktop mode")),/Accelerated *= *true/i.test(kn)&&Fo.unshift("accelerated")):Kn=="UC Browser"&&/\bUCWEB\b/.test(kn)?Fo.push("speed mode"):Kn=="PaleMoon"&&(_r=/\bFirefox\/([\d.]+)\b/.exec(kn))?Fo.push("identifying as Firefox "+_r[1]):Kn=="Firefox"&&(_r=/\b(Mobile|Tablet|TV)\b/i.exec(kn))?(Zn||(Zn="Firefox OS"),qo||(qo=_r[1])):!Kn||(_r=!/\bMinefield\b/i.test(kn)&&/\b(?:Firefox|Safari)\b/.exec(Kn))?(Kn&&!qo&&/[\/,]|^[^(]+?\)/.test(kn.slice(kn.indexOf(_r+"/")+8))&&(Kn=null),(_r=qo||ps||Zn)&&(qo||ps||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(Zn))&&(Kn=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(Zn)?Zn:_r)+" Browser")):Kn=="Electron"&&(_r=(/\bChrome\/([\d.]+)\b/.exec(kn)||0)[1])&&Fo.push("Chromium "+_r),fo||(fo=OC(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",Br(Kn),"(?:Firefox|Minefield|NetFront)"])),(_r=(aa=="iCab"&&parseFloat(fo)>3?"WebKit":/\bOpera\b/.test(Kn)&&(/\bOPR\b/.test(kn)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(kn)&&!/^(?:Trident|EdgeHTML)$/.test(aa)&&"WebKit"||!aa&&/\bMSIE\b/i.test(kn)&&(Zn=="Mac OS"?"Tasman":"Trident")||aa=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(Kn)&&"NetFront")&&(aa=[_r]),Kn=="IE"&&(_r=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(kn)||0)[1])?(Kn+=" Mobile",Zn="Windows Phone "+(/\+$/.test(_r)?_r:_r+".x"),Fo.unshift("desktop mode")):/\bWPDesktop\b/i.test(kn)?(Kn="IE Mobile",Zn="Windows Phone 8.x",Fo.unshift("desktop mode"),fo||(fo=(/\brv:([\d.]+)/.exec(kn)||0)[1])):Kn!="IE"&&aa=="Trident"&&(_r=/\brv:([\d.]+)/.exec(kn))&&(Kn&&Fo.push("identifying as "+Kn+(fo?" "+fo:"")),Kn="IE",fo=_r[1]),Ka){if(function(Na,Ta){var xa=Na!=null?typeof Na[Ta]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(xa)||xa=="object"&&!Na[Ta])}(Jn,"global"))if(ao&&(Lc=(_r=ao.lang.System).getProperty("os.arch"),Zn=Zn||_r.getProperty("os.name")+" "+_r.getProperty("os.version")),Ko){try{fo=Jn.require("ringo/engine").version.join("."),Kn="RingoJS"}catch{(_r=Jn.system)&&_r.global.system==Jn.system&&(Kn="Narwhal",Zn||(Zn=_r[0].os||null))}Kn||(Kn="Rhino")}else typeof Jn.process=="object"&&!Jn.process.browser&&(_r=Jn.process)&&(typeof _r.versions=="object"&&(typeof _r.versions.electron=="string"?(Fo.push("Node "+_r.versions.node),Kn="Electron",fo=_r.versions.electron):typeof _r.versions.nw=="string"&&(Fo.push("Chromium "+fo,"Node "+_r.versions.node),Kn="NW.js",fo=_r.versions.nw)),Kn||(Kn="Node.js",Lc=_r.arch,Zn=_r.platform,fo=(fo=/[\d.]+/.exec(_r.version))?fo[0]:null));else xr(_r=Jn.runtime)==bn?(Kn="Adobe AIR",Zn=_r.flash.system.Capabilities.os):xr(_r=Jn.phantom)==oo?(Kn="PhantomJS",fo=(_r=_r.version||null)&&_r.major+"."+_r.minor+"."+_r.patch):typeof Mo.documentMode=="number"&&(_r=/\bTrident\/(\d+)/i.exec(kn))?(fo=[fo,Mo.documentMode],(_r=+_r[1]+4)!=fo[1]&&(Fo.push("IE "+fo[1]+" mode"),aa&&(aa[1]=""),fo[1]=_r),fo=Kn=="IE"?String(fo[1].toFixed(1)):fo[0]):typeof Mo.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(Kn)&&(Fo.push("masking as "+Kn+" "+fo),Kn="IE",fo="11.0",aa=["Trident"],Zn="Windows");Zn=Zn&&vr(Zn)}if(fo&&(_r=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(fo)||/(?:alpha|beta)(?: ?\d)?/i.exec(kn+";"+(Ka&&xo.appMinorVersion))||/\bMinefield\b/i.test(kn)&&"a")&&(hc=/b/i.test(_r)?"beta":"alpha",fo=fo.replace(RegExp(_r+"\\+?$"),"")+(hc=="beta"?ja:Po)+(/\d+\+?/.exec(_r)||"")),Kn=="Fennec"||Kn=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(Zn))Kn="Firefox Mobile";else if(Kn=="Maxthon"&&fo)fo=fo.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(qo))qo=="Xbox 360"&&(Zn=null),qo=="Xbox 360"&&/\bIEMobile\b/.test(kn)&&Fo.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(Kn)&&(!Kn||qo||/Browser|Mobi/.test(Kn))||Zn!="Windows CE"&&!/Mobi/i.test(kn))if(Kn=="IE"&&Ka)try{Jn.external===null&&Fo.unshift("platform preview")}catch{Fo.unshift("embedded")}else(/\bBlackBerry\b/.test(qo)||/\bBB10\b/.test(kn))&&(_r=(RegExp(qo.replace(/ +/g," *")+"/([.\\d]+)","i").exec(kn)||0)[1]||fo)?(Zn=((_r=[_r,/BB10/.test(kn)])[1]?(qo=null,ps="BlackBerry"):"Device Software")+" "+_r[0],fo=null):this!=Cr&&qo!="Wii"&&(Ka&&Ao||/Opera/.test(Kn)&&/\b(?:MSIE|Firefox)\b/i.test(kn)||Kn=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(Zn)||Kn=="IE"&&(Zn&&!/^Win/.test(Zn)&&fo>5.5||/\bWindows XP\b/.test(Zn)&&fo>8||fo==8&&!/\bTrident\b/.test(kn)))&&!pe.test(_r=Kr.call(Cr,kn.replace(pe,"")+";"))&&_r.name&&(_r="ing as "+_r.name+((_r=_r.version)?" "+_r:""),pe.test(Kn)?(/\bIE\b/.test(_r)&&Zn=="Mac OS"&&(Zn=null),_r="identify"+_r):(_r="mask"+_r,Kn=oa?vr(oa.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(_r)&&(Zn=null),Ka||(fo=null)),aa=["Presto"],Fo.push(_r));else Kn+=" Mobile";(_r=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(kn)||0)[1])&&(_r=[parseFloat(_r.replace(/\.(\d)$/,".0$1")),_r],Kn=="Safari"&&_r[1].slice(-1)=="+"?(Kn="WebKit Nightly",hc="alpha",fo=_r[1].slice(0,-1)):fo!=_r[1]&&fo!=(_r[2]=(/\bSafari\/([\d.]+\+?)/i.exec(kn)||0)[1])||(fo=null),_r[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(kn)||0)[1],_r[0]==537.36&&_r[2]==537.36&&parseFloat(_r[1])>=28&&aa=="WebKit"&&(aa=["Blink"]),Ka&&(Fn||_r[1])?(aa&&(aa[1]="like Chrome"),_r=_r[1]||((_r=_r[0])<530?1:_r<532?2:_r<532.05?3:_r<533?4:_r<534.03?5:_r<534.07?6:_r<534.1?7:_r<534.13?8:_r<534.16?9:_r<534.24?10:_r<534.3?11:_r<535.01?12:_r<535.02?"13+":_r<535.07?15:_r<535.11?16:_r<535.19?17:_r<536.05?18:_r<536.1?19:_r<537.01?20:_r<537.11?"21+":_r<537.13?23:_r<537.18?24:_r<537.24?25:_r<537.36?26:aa!="Blink"?"27":"28")):(aa&&(aa[1]="like Safari"),_r=(_r=_r[0])<400?1:_r<500?2:_r<526?3:_r<533?4:_r<534?"4+":_r<535?5:_r<537?6:_r<538?7:_r<601?8:_r<602?9:_r<604?10:_r<606?11:_r<608?12:"12"),aa&&(aa[1]+=" "+(_r+=typeof _r=="number"?".x":/[.+]/.test(_r)?"":"+")),Kn=="Safari"&&(!fo||parseInt(fo)>45)?fo=_r:Kn=="Chrome"&&/\bHeadlessChrome/i.test(kn)&&Fo.unshift("headless")),Kn=="Opera"&&(_r=/\bzbov|zvav$/.exec(Zn))?(Kn+=" ",Fo.unshift("desktop mode"),_r=="zvav"?(Kn+="Mini",fo=null):Kn+="Mobile",Zn=Zn.replace(RegExp(" *"+_r+"$"),"")):Kn=="Safari"&&/\bChrome\b/.exec(aa&&aa[1])?(Fo.unshift("desktop mode"),Kn="Chrome Mobile",fo=null,/\bOS X\b/.test(Zn)?(ps="Apple",Zn="iOS 4.3+"):Zn=null):/\bSRWare Iron\b/.test(Kn)&&!fo&&(fo=OC("Chrome")),fo&&fo.indexOf(_r=/[\d.]+$/.exec(Zn))==0&&kn.indexOf("/"+_r+"-")>-1&&(Zn=zr(Zn.replace(_r,""))),Zn&&Zn.indexOf(Kn)!=-1&&!RegExp(Kn+" OS").test(Zn)&&(Zn=Zn.replace(RegExp(" *"+Br(Kn)+" *"),"")),aa&&!/\b(?:Avant|Nook)\b/.test(Kn)&&(/Browser|Lunascape|Maxthon/.test(Kn)||Kn!="Safari"&&/^iOS/.test(Zn)&&/\bSafari\b/.test(aa[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(Kn)&&aa[1])&&(_r=aa[aa.length-1])&&Fo.push(_r),Fo.length&&(Fo=["("+Fo.join("; ")+")"]),ps&&qo&&qo.indexOf(ps)<0&&Fo.push("on "+ps),qo&&Fo.push((/^on /.test(Fo[Fo.length-1])?"":"on ")+qo),Zn&&(_r=/ ([\d.+]+)$/.exec(Zn),Pn=_r&&Zn.charAt(Zn.length-_r[0].length-1)=="/",Zn={architecture:32,family:_r&&!Pn?Zn.replace(_r[0],""):Zn,version:_r?_r[1]:null,toString:function(){var ti=this.version;return this.family+(ti&&!Pn?" "+ti:"")+(this.architecture==64?" 64-bit":"")}}),(_r=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Lc))&&!/\bi686\b/i.test(Lc)?(Zn&&(Zn.architecture=64,Zn.family=Zn.family.replace(RegExp(" *"+_r),"")),Kn&&(/\bWOW64\b/i.test(kn)||Ka&&/\w(?:86|32)$/.test(xo.cpuClass||xo.platform)&&!/\bWin64; x64\b/i.test(kn))&&Fo.unshift("32-bit")):Zn&&/^OS X/.test(Zn.family)&&Kn=="Chrome"&&parseFloat(fo)>=39&&(Zn.architecture=64),kn||(kn=null);var Ws={};return Ws.description=kn,Ws.layout=aa&&aa[0],Ws.manufacturer=ps,Ws.name=Kn,Ws.prerelease=hc,Ws.product=qo,Ws.ua=kn,Ws.version=Kn&&fo,Ws.os=Zn||{architecture:null,family:null,version:null,toString:function(){return"null"}},Ws.parse=Kr,Ws.toString=function(){return this.description||""},Ws.version&&Fo.unshift(fo),Ws.name&&Fo.unshift(Kn),Zn&&Kn&&(Zn!=String(Zn).split(" ")[0]||Zn!=Kn.split(" ")[0]&&!qo)&&Fo.push(qo?"("+Zn+")":"on "+Zn),Fo.length&&(Ws.description=Fo.join(" ")),Ws}();$&&_?Cr(Hr,function(Kr,kn){$[kn]=Kr}):L.platform=Hr}).call(e)}),WT=Math.floor,Xg=function(w,M){var L=w.length,$=WT(L/2);return L<8?Zg(w,M):GT(w,Xg(mu(w,0,$),M),Xg(mu(w,$),M),M)},Zg=function(w,M){for(var L,$,_=w.length,Y=1;Y<_;){for($=Y,L=w[Y];$&&M(w[$-1],L)>0;)w[$]=w[--$];$!==Y++&&(w[$]=L)}return w},GT=function(w,M,L,$){for(var _=M.length,Y=L.length,Oe=0,pe=0;Oe<_||pe<Y;)w[Oe+pe]=Oe<_&&pe<Y?$(M[Oe],L[pe])<=0?M[Oe++]:L[pe++]:Oe<_?M[Oe++]:L[pe++];return w},eh=Xg,Kv=nr.match(/firefox\/(\d+)/i),yd=!!Kv&&+Kv[1],Ca=/MSIE|Trident/.test(nr),Wv=nr.match(/AppleWebKit\/(\d+)\./),th=!!Wv&&+Wv[1],oc=[],Gv=he(oc.sort),Qv=he(oc.push),QT=d(function(){oc.sort(void 0)}),Jv=d(function(){oc.sort(null)}),Yv=Ds("sort"),Xv=!d(function(){if(mr)return mr<70;if(!(yd&&yd>3)){if(Ca)return!0;if(th)return th<603;var w,M,L,$,_="";for(w=65;w<76;w++){switch(M=String.fromCharCode(w),w){case 66:case 69:case 70:case 72:L=3;break;case 68:case 71:L=4;break;default:L=2}for($=0;$<47;$++)oc.push({k:M+$,v:L})}for(oc.sort(function(Y,Oe){return Oe.v-Y.v}),$=0;$<oc.length;$++)M=oc[$].k.charAt(0),_.charAt(_.length-1)!==M&&(_+=M);return _!=="DGBEFHACIJK"}});Vr({target:"Array",proto:!0,forced:QT||!Jv||!Yv||!Xv},{sort:function(M){M!==void 0&&Or(M);var L=$n(this);if(Xv)return M===void 0?Gv(L):Gv(L,M);var $,_,Y=[],Oe=Ia(L);for(_=0;_<Oe;_++)_ in L&&Qv(Y,L[_]);for(eh(Y,function(pe){return function(At,jt){return jt===void 0?-1:At===void 0?1:pe!==void 0?+pe(At,jt)||0:Aa(At)>Aa(jt)?1:-1}}(M)),$=Ia(Y),_=0;_<$;)L[_]=Y[_++];for(;_<Oe;)wp(L,_++);return L}});var JT=Uo("Array").sort,rh=Array.prototype,wc=function(w){var M=w.sort;return w===rh||er(rh,w)&&M===rh.sort?JT:M},nh=o(function(w,M){w.exports=function(){var L={d:function(_r,Pn){for(var Fn in Pn)L.o(Pn,Fn)&&!L.o(_r,Fn)&&Ki(_r,Fn,{enumerable:!0,get:Pn[Fn]})},o:function(_r,Pn){return Object.prototype.hasOwnProperty.call(_r,Pn)}},$={};L.d($,{default:function(){return xo}});var _=function Ln(_r){for(var Pn in function(Fn,_n){if(!(Fn instanceof _n))throw new TypeError("Cannot call a class as a function")}(this,Ln),this.directUploadAddr="https://wanproxy-web.127.net",this.retryCount=4,this.trunkSize=4194304,this.trunkUploadTimeout=5e4,this.getOffsetTimeout=1e4,this.version="1.0",this.enableCache=!0,this.logger=console,this.onError=function(Fn){},this.onProgress=function(Fn){},this.onUploadProgress=function(Fn){},this.onComplete=function(Fn){},_r)this[Pn]=_r[Pn]};function Y(Ln,_r){var Pn=ha!==void 0&&gd(Ln)||Ln["@@iterator"];if(!Pn){if(gi(Ln)||(Pn=function(oo,ao){if(oo){var Ko;if(typeof oo=="string")return Oe(oo,ao);var Po=Co(Ko=Object.prototype.toString.call(oo)).call(Ko,8,-1);return Po==="Object"&&oo.constructor&&(Po=oo.constructor.name),Po==="Map"||Po==="Set"?Ep(oo):Po==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Po)?Oe(oo,ao):void 0}}(Ln))||_r&&Ln&&typeof Ln.length=="number"){Pn&&(Ln=Pn);var Fn=0,_n=function(){};return{s:_n,n:function(){return Fn>=Ln.length?{done:!0}:{done:!1,value:Ln[Fn++]}},e:function(ao){throw ao},f:_n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var bn,Rn=!0,qn=!1;return{s:function(){Pn=Pn.call(Ln)},n:function(){var ao=Pn.next();return Rn=ao.done,ao},e:function(ao){qn=!0,bn=ao},f:function(){try{Rn||Pn.return==null||Pn.return()}finally{if(qn)throw bn}}}}function Oe(Ln,_r){(_r==null||_r>Ln.length)&&(_r=Ln.length);for(var Pn=0,Fn=new Array(_r);Pn<_r;Pn++)Fn[Pn]=Ln[Pn];return Fn}var pe=window.localStorage;window.localStorage&&typeof window.localStorage.getItem=="function"&&typeof window.localStorage.setItem=="function"&&typeof window.localStorage.removeItem=="function"||(pe={privateObj:{},setItem:function(_r,Pn){pe.privateObj[_r]=Pn},getItem:function(_r){return pe.privateObj[_r]},removeItem:function(_r){delete pe.privateObj[_r]},getKeys:function(){return Vo(pe.privateObj)}});var At={getFileKey:function(_r){var Pn=_r.size.toString(),Fn=_r.lastModified.toString();return"_NosUploader_"+_r.name+Co(Pn).call(Pn,Pn.length-5)+Co(Fn).call(Fn,Fn.length-5)},getFileInfo:function(_r){var Pn=pe.getItem(_r);if(!Pn)return null;try{return JSON.parse(Pn)}catch{return null}},initFile:function(_r,Pn,Fn){At.clearExpiredInfo();var _n=this.getFileKey(Pn),bn={ctx:_r.ctx!==void 0?_r.ctx:"",bucket:_r.bucketName,obj:_r.objectName,token:_r.token,modifyAt:sa(),end:!1};return _r.payload&&(bn.payload=_r.payload),Fn&&pe.setItem(_n,Wo(bn)),_n},setUploadContext:function(_r,Pn,Fn){var _n=this.getFileInfo(_r);_n&&(_n.ctx=Pn,Fn&&pe.setItem(_r,Wo(_n)))},setComplete:function(_r,Pn){var Fn=this.getFileInfo(_r);Fn&&(Fn.modifyAt=sa(),Fn.end=!0,Pn&&pe.setItem(_r,Wo(Fn)))},getUploadContext:function(_r){var Pn=this.getFileInfo(_r);return Pn?Pn.ctx:""},removeFileInfo:function(_r){ka(_r).call(_r,"_NosUploader_")===0&&pe.removeItem(_r)},clearExpiredInfo:function(){var _r,Pn=typeof pe.getKeys=="function"?pe.getKeys():Vo(pe),Fn=sa(),_n=[],bn=Y(Pn);try{for(bn.s();!(_r=bn.n()).done;){var Rn=_r.value;if(ka(Rn).call(Rn,"_NosUploader_")===0){var qn=At.getFileInfo(Rn);qn===null||Fn-qn.modifyAt>xo.expireTime?pe.removeItem(Rn):_n.push({fileInfo:qn,key:Rn})}}}catch(Mo){bn.e(Mo)}finally{bn.f()}if(_n.length>xo.maxFileCache){var oo,ao,Ko=Y(Co(oo=wc(_n).call(_n,function(Mo,Ao){return Ao.fileInfo.modifyAt-Mo.fileInfo.modifyAt})).call(oo,xo.maxFileCache));try{for(Ko.s();!(ao=Ko.n()).done;){var Po,ja=ao.value;ka(Po=ja.key).call(Po,"_NosUploader_")===0&&pe.removeItem(ja.key)}}catch(Mo){Ko.e(Mo)}finally{Ko.f()}}}},jt=At;function ur(Ln){return(ur=typeof ha=="function"&&typeof cm=="symbol"?function(_r){return typeof _r}:function(_r){return _r&&typeof ha=="function"&&_r.constructor===ha&&_r!==ha.prototype?"symbol":typeof _r})(Ln)}function gr(Ln,_r){return!_r||ur(_r)!=="object"&&typeof _r!="function"?function(Pn){if(Pn===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Pn}(Ln):_r}function vr(Ln){var _r=typeof ec=="function"?new ec:void 0;return(vr=function(Fn){var _n,bn;if(Fn===null||(bn=Fn,ka(_n=Function.toString.call(bn)).call(_n,"[native code]")===-1))return Fn;if(typeof Fn!="function")throw new TypeError("Super expression must either be null or a function");if(_r!==void 0){if(_r.has(Fn))return _r.get(Fn);_r.set(Fn,Rn)}function Rn(){return Cr(Fn,arguments,jr(this).constructor)}return Rn.prototype=Ja(Fn.prototype,{constructor:{value:Rn,enumerable:!1,writable:!0,configurable:!0}}),Br(Rn,Fn)})(Ln)}function Cr(Ln,_r,Pn){return(Cr=xr()?xi:function(Fn,_n,bn){var Rn=[null];Rn.push.apply(Rn,_n);var qn=new(Oo(Function).apply(Fn,Rn));return bn&&Br(qn,bn.prototype),qn}).apply(null,arguments)}function xr(){if(typeof Reflect>"u"||!xi||xi.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(xi(Boolean,[],function(){})),!0}catch{return!1}}function Br(Ln,_r){return(Br=Ns||function(Pn,Fn){return Pn.__proto__=Fn,Pn})(Ln,_r)}function jr(Ln){return(jr=Ns?js:function(_r){return _r.__proto__||js(_r)})(Ln)}var zr=function(Ln){(function(bn,Rn){if(typeof Rn!="function"&&Rn!==null)throw new TypeError("Super expression must either be null or a function");bn.prototype=Ja(Rn&&Rn.prototype,{constructor:{value:bn,writable:!0,configurable:!0}}),Rn&&Br(bn,Rn)})(_n,Ln);var _r,Pn,Fn=(_r=_n,Pn=xr(),function(){var bn,Rn=jr(_r);if(Pn){var qn=jr(this).constructor;bn=xi(Rn,arguments,qn)}else bn=Rn.apply(this,arguments);return gr(this,bn)});function _n(bn,Rn){var qn;return function(oo,ao){if(!(oo instanceof ao))throw new TypeError("Cannot call a class as a function")}(this,_n),(qn=Fn.call(this,"NosUploadError:"+bn)).errCode=Rn,qn.errMsg=bn,qn}return _n}(vr(Error)),Hr=function Ln(_r,Pn,Fn){if(_r.uploadState==="uploading"){var _n=_r.config,bn=_r.param,Rn=jt.getUploadContext(_r.fileKey);if(!Rn)return Fn(0);var qn=new XMLHttpRequest,oo=_n.directUploadAddr+"/".concat(bn.bucketName)+"/".concat(encodeURIComponent(bn.objectName))+"?uploadContext"+"&context=".concat(Rn)+"&version=".concat(_n.version);qn.onreadystatechange=function(){var ao;if(_r.uploadState!=="abort"&&qn.readyState===4){var Ko,Po,ja,Mo;try{Mo=JSON.parse(qn.responseText)}catch{Mo={errMsg:"JsonParseError in getOffset",errCode:500}}qn.status===200?Mo.errCode?_r.config.onError(new zr(Mo.errMsg,Mo.errCode)):Fn(Mo.offset):qn.status.toString().match(/^5/)?Ln(_r,Pn-1,Fn):Pn>0?(typeof((ao=_n.logger)===null||ao===void 0?void 0:ao.error)=="function"&&_n.logger.error(ks(Ko="getOffset(".concat(oo,") error. retry after 3 seconds. ")).call(Ko,new Date().toTimeString())),vo(function(){Ln(_r,Pn-1,Fn)},3500)):(jt.removeFileInfo(_r.fileKey),qn.status?_n.onError(new zr(ks(Po=ks(ja="getOffset(".concat(oo,") error: ")).call(ja,qn.status," ")).call(Po,qn.statusText))):_n.onError(new zr("getOffset(".concat(oo,") error. no Error Code"))))}},qn.open("get",oo),qn.setRequestHeader("x-nos-token",bn.token),qn.timeout=_n.getOffsetTimeout,qn.send()}},Kr=function Ln(_r,Pn,Fn,_n){if(_r.uploadState==="uploading"){var bn=_r.param,Rn=_r.config,qn=Co(File.prototype),oo=bn.ctx!==void 0?bn.ctx:"",ao=Pn+Rn.trunkSize>_r.file.size,Ko=ao?_r.file.size:Pn+Rn.trunkSize,Po=new XMLHttpRequest,ja=Rn.directUploadAddr+"/".concat(bn.bucketName)+"/".concat(encodeURIComponent(bn.objectName));if(Po.upload.onprogress=function(Ao){if(_r.uploadState!=="abort"){var oa=0;Ao.lengthComputable?(oa=(Pn+Ao.loaded)/_r.file.size,Rn.onProgress(oa),Rn.onUploadProgress({loaded:Ao.loaded,total:_r.file.size,percentage:oa,percentageText:(100*oa).toFixed(2)+"%"})):Rn.onError(new zr("browser does not support query upload progress"))}},Po.onreadystatechange=function(){var Ao,oa;if(_r.uploadState!=="abort"&&Po.readyState===4){var Lc,Fo,hc,Ka;try{Ka=JSON.parse(Po.responseText)}catch(fo){typeof((Ao=Rn.logger)===null||Ao===void 0?void 0:Ao.error)=="function"&&Rn.logger.error("JsonParseError in uploadTrunk",fo),Ka={errMsg:"JsonParseError in uploadTrunk"}}Po.status===200?(_r.setContext(Ka.context),ao?(_n(),_r.setComplete()):Ln(_r,Ka.offset,Rn.retryCount,_n)):Po.status.toString().match(/^5/)?Fn>0?Ln(_r,Pn,Fn-1,_n):(jt.removeFileInfo(_r.fileKey),Rn.onError(new zr(Ka.errMsg,Ka.errCode))):Fn>0?(typeof((oa=Rn.logger)===null||oa===void 0?void 0:oa.error)=="function"&&Rn.logger.error(ks(Lc="uploadTrunk(".concat(ja,") error. retry after 3 seconds. ")).call(Lc,new Date().toTimeString())),vo(function(){Ln(_r,Pn,Fn-1,_n)},3500)):(jt.removeFileInfo(_r.fileKey),Po.status?Rn.onError(new zr(ks(Fo=ks(hc="uploadTrunk(".concat(ja,") error: ")).call(hc,Po.status," ")).call(Fo,Po.statusText))):Rn.onError(new zr("uploadTrunk(".concat(ja,") error. no Error Code. Please check your network"))))}},Po.open("post",ja+"?offset=".concat(Pn)+"&complete=".concat(ao)+"&context=".concat(oo)+"&version=".concat(Rn.version)),Po.setRequestHeader("x-nos-token",bn.token),_r.file.type&&Po.setRequestHeader("content-type",_r.file.type),Po.timeout=Rn.trunkUploadTimeout,typeof FileReader<"u"){var Mo=new FileReader;Mo.addEventListener("load",function(Ao){var oa;!((oa=Ao==null?void 0:Ao.target)===null||oa===void 0)&&oa.result?Po.send(Ao.target.result):Rn.onError(new zr("Read ArrayBuffer failed"))}),Mo.addEventListener("error",function(Ao){var oa=Ao.target.error;Rn.onError(new zr("Read ArrayBuffer error. ".concat(oa.toString()),oa.code))}),Mo.readAsArrayBuffer(qn.call(_r.file,Pn,Ko))}else Po.send(qn.call(_r.file,Pn,Ko))}};function kn(Ln,_r){for(var Pn=0;Pn<_r.length;Pn++){var Fn=_r[Pn];Fn.enumerable=Fn.enumerable||!1,Fn.configurable=!0,"value"in Fn&&(Fn.writable=!0),Ki(Ln,Fn.key,Fn)}}var Jn=function(){function Ln(Pn,Fn,_n){(function(bn,Rn){if(!(bn instanceof Rn))throw new TypeError("Cannot call a class as a function")})(this,Ln),this.uploadState="paused",this.config=_n,this.file=Pn,this.param=Fn,this.fileKey=jt.initFile(Fn,Pn,this.config.enableCache),this.resume()}var _r;return(_r=[{key:"resume",value:function(){var Fn=this;if(this.uploadState!=="uploading"){this.setUploadState("uploading");var _n=this.config;Hr(this,_n.retryCount,function(bn){Kr(Fn,bn,_n.retryCount,function(){Fn.setUploadState("ended"),typeof _n.onComplete=="function"&&_n.onComplete(Fn.param)})})}}},{key:"pause",value:function(){this.setUploadState("paused")}},{key:"abort",value:function(){this.setUploadState("abort"),jt.removeFileInfo(this.fileKey),this.config.onError(new zr("Upload Aborted",10499))}},{key:"setUploadState",value:function(Fn){Fn!==this.uploadState&&(this.uploadState=Fn)}},{key:"setContext",value:function(Fn){jt.setUploadContext(this.fileKey,Fn,this.config.enableCache),this.param.ctx=Fn}},{key:"setComplete",value:function(){jt.setComplete(this.fileKey,this.config.enableCache),this.setUploadState("ended")}}])&&kn(Ln.prototype,_r),Ln}(),Hn={maxFileCache:6,expireTime:864e5,getFileUploadInformation:function(_r){var Pn=jt.getFileKey(_r),Fn=jt.getFileInfo(Pn);return Fn===null?null:sa()-Fn.modifyAt>Hn.expireTime?(jt.removeFileInfo(Pn),null):{uploadInfo:Mr({bucketName:Fn.bucket,objectName:Fn.obj,token:Fn.token,ctx:Fn.ctx},Fn.payload?{payload:Fn.payload}:{}),complete:Fn.end}},setMaxFileCache:function(_r){Hn.maxFileCache=_r},setExpireTime:function(_r){Hn.expireTime=_r},printCaches:function(){for(var _r=0,Pn=Vo(localStorage);_r<Pn.length;_r++){var Fn=Pn[_r],_n=jt.getFileInfo(Fn);_n&&console.log(_n,"modifiedAt",new Date(_n.modifyAt).toTimeString())}},createConfig:function(_r){return new _(_r)},createTask:function(_r,Pn,Fn){return new Jn(_r,Pn,Fn)}},xo=Hn;return $.default}()}),YT=o(function(w,M){w.exports=function(){function L(Oe){if(Oe){var pe,At="";return In(pe=Vo(Oe)).call(pe,function(jt,ur){At+=ur===0?"?":"&",At+=jt+"="+Oe[jt]}),At}return""}function $(Oe,pe,At,jt){return Error.call(this,At),this.source=Oe,this.code=pe,this.desc=At,this.detail=jt||{},this}function _(Oe,pe){var At=Ja(pe.prototype);At.constructor=Oe,Oe.prototype=At}function Y(Oe,pe){pe===void 0&&(pe={dataType:"json",method:"GET",timeout:5e3});var At=pe.dataType==="text"?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",jt=pe.method==="GET"?L(pe.params):"";return new co(function(ur,gr){if(window.XMLHttpRequest){var vr,Cr=new XMLHttpRequest;if(Cr.onreadystatechange=function(){if(Cr.readyState===4)if(Cr.status===200){try{vr=JSON.parse(Cr.response||"{}")}catch{vr=Cr.response}ur({status:Cr.status,data:vr})}else gr(new $(1,Cr.status,Cr.statusText))},Cr.open(pe.method,""+Oe+jt),Cr.timeout=pe.timeout||5e3,Cr.setRequestHeader("Content-Type",At),pe.headers)for(var xr in pe.headers)Cr.setRequestHeader(xr,pe.headers[xr]);Cr.ontimeout=function(Br){gr(new $(1,408,Br&&Br.message?Br.message:"request timeout"))},Cr.send(Wo(pe.data))}else gr(new $(2,10400,"request no suppout"))})}return _($,Error),Y}()}),Zv=console,ac,Da,Vl,va,Ys,ey={setLogger:function(M){Zv=M},platform:"BROWSER",localStorage:window.localStorage,request:YT,WebSocket:window.WebSocket,uploadFile:function(M){return Sn(this,void 0,void 0,ar.mark(function L(){var $,_,Y,Oe,pe,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:if(M.fileInput||M.file){ur.next=2;break}throw new Error("File not exist");case 2:if(!M.file){ur.next=6;break}Oe=M.file,ur.next=20;break;case 6:if(typeof M.fileInput!="string"){ur.next=15;break}if(!((pe=document.getElementById(M.fileInput))&&pe.files&&pe.files[0])){ur.next=12;break}Oe=pe.files[0],ur.next=13;break;case 12:throw new Error("Can not get file from fileInput");case 13:ur.next=20;break;case 15:if(!(M.fileInput&&M.fileInput.files&&M.fileInput.files[0])){ur.next=19;break}Oe=M.fileInput.files[0],ur.next=20;break;case 19:throw new Error("Can not get file from fileInput "+M.fileInput);case 20:if(!(M.maxSize&&Oe.size>M.maxSize)){ur.next=22;break}throw new Error("The file exceeds maxSize limit. maxSize: "+M.maxSize+", get "+Oe.size);case 22:return ur.next=24,new co(function(gr,vr){var Cr=nh.createConfig({enableCache:!1,directUploadAddr:M.chunkUploadHost,onError:function(jr){vr(jr)},onProgress:M.onUploadProgress||function(){},onComplete:function(jr){gr(jr)}}),xr=nh.createTask(Oe,{bucketName:M.nosToken.bucket,objectName:decodeURIComponent(M.nosToken.objectName),token:M.nosToken.token},Cr);try{M.onUploadStart&&M.onUploadStart(xr)}catch(Br){Zv.error("Adapter uploadFile: options.onUploadStart error",Br&&Br.message),xr.abort(),vr(Br)}});case 24:return(At=ur.sent).name=Oe.name,At.size=Oe.size,At.type=Oe.type,At.ext=Yg($=At.name).call($,".")>-1?Co(_=At.name).call(_,Yg(Y=At.name).call(Y,".")+1).toLowerCase():"",ur.abrupt("return",At);case 30:case"end":return ur.stop()}},L)}))},getSystemInfo:function(){var M,L;return{os:((M=ql.os)===null||M===void 0?void 0:M.family)||"",osVer:((L=ql.os)===null||L===void 0?void 0:L.version)||"",browser:ql.name||"",browserVer:ql.version||"",hostEnv:"BROWSER",hostEnvVer:ql.version||"",hostInfo:ql.ua||""}}},os=function(){function w(M,L){this.name=M,this.core=L,this.name=M,this.logger=L.logger,this.core=L}return w.prototype.process=function(L){var $=this[L.cmd+"Handler"];return typeof $=="function"?$.call(this,L):L.error&&!L.error.ignore?co.reject(L.error):co.resolve(L)},w}();(function(w){w[w.text=0]="text",w[w.image=1]="image",w[w.audio=2]="audio",w[w.video=3]="video",w[w.geo=4]="geo",w[w.notification=5]="notification",w[w.file=6]="file",w[w.tip=10]="tip",w[w.robot=11]="robot",w[w.g2=12]="g2",w[w.custom=100]="custom"})(ac||(ac={})),function(w){w[w.p2p=0]="p2p",w[w.team=1]="team",w[w.superTeam=5]="superTeam"}(Da||(Da={})),function(w){w[w.Android=1]="Android",w[w.iOS=2]="iOS",w[w.PC=4]="PC",w[w.WindowsPhone=8]="WindowsPhone",w[w.Web=16]="Web",w[w.Server=32]="Server",w[w.Mac=64]="Mac"}(Vl||(Vl={})),function(w){w[w.unread=1]="unread",w[w.read=2]="read",w[w.deleted=3]="deleted",w[w.sending=4]="sending",w[w.sendFailed=5]="sendFailed",w[w.sent=6]="sent",w[w.receipt=7]="receipt",w[w.refused=10]="refused"}(va||(va={})),function(w){w[w.default=0]="default",w[w.leave=1]="leave",w[w.roam=2]="roam"}(Ys||(Ys={}));var oh=function(M,L){return function($){return M(L($))}},ah=oh(Object.getPrototypeOf,Object),XT=Function.prototype,ZT=Object.prototype,ty=XT.toString,eS=ZT.hasOwnProperty,pl=ty.call(Object),bd=function(M){if(!hi(M)||yc(M)!="[object Object]")return!1;var L=ah(M);if(L===null)return!0;var $=eS.call(L,"constructor")&&L.constructor;return typeof $=="function"&&$ instanceof $&&ty.call($)==pl};function Xs(w,M){if(!bd(M))return{};var L=JSON.parse(Wo(M)),$=sh(w,L);return JSON.parse(Wo(Mr(Mr({},L),$)))}function sh(w,M){if(!bd(M))return{};var L={},$=Vo(w);return In($).call($,function(_){var Y=w[_].type;if(typeof Y!="string"){var Oe=sh(w[_],M);Vo(Oe).length>0&&(L[_]=Oe)}else{var pe=w[_],At=pe.rawKey||_,jt=Bp[Y](M,At,pe);jt!==void 0&&(M[At]=void 0,L[_]=jt)}}),L}var Bp={number:function(M,L){if(M[L]!==void 0)return+M[L]},string:function(M,L){if(M[L]!==void 0)return M[L]},boolean:function(M,L){return+M[L]>0||+M[L]!=0&&void 0},enum:function(M,L,$){return sp($)[M[L]]},object:function(M,L){if(M[L]!==void 0)try{return JSON.parse(M[L])}catch{return{}}}};function Td(w,M){if(!bd(M))return{};var L=JSON.parse(Wo(M)),$=ry(w,L);return JSON.parse(Wo(Mr(Mr({},L),$)))}function ry(w,M){var L;if(!bd(M))return op(L=Vo(w)).call(L,function(Y,Oe){return Y[w[Oe].rawKey||Oe]=void 0,Y},{});var $={},_=Vo(w);return In(_).call(_,function(Y){var Oe=w[Y].type;if(typeof Oe!="string"){var pe=ry(w[Y],M[Y]);return Mr($,pe),void(M[Y]=void 0)}var At=w[Y],jt=At.rawKey||Y,ur=ih[Oe](M,Y,At);M[jt]=void 0,$[jt]=ur}),$}var ih={number:function(M,L){return M[L]},string:function(M,L){return M[L]},boolean:function(M,L){return M[L]===!0?1:M[L]===!1?0:void 0},enum:function(M,L,$){return sp($)[M[L]]},object:function(M,L){if(M[L]!==void 0)try{return Wo(M[L])}catch{return""}}},tS=ih,ny=function(M){return function(L,$,_){for(var Y=-1,Oe=Object(L),pe=_(L),At=pe.length;At--;){var jt=pe[M?At:++Y];if($(Oe[jt],jt,Oe)===!1)break}return L}}(),rS=function(M,L){for(var $=-1,_=Array(M);++$<M;)_[$]=L($);return _},ch=function(M){return hi(M)&&yc(M)=="[object Arguments]"},oy=Object.prototype,Fp=oy.hasOwnProperty,nS=oy.propertyIsEnumerable,oS=ch(function(){return arguments}())?ch:function(w){return hi(w)&&Fp.call(w,"callee")&&!nS.call(w,"callee")},Sd=oS,lh=function(){return!1},Lp=o(function(w,M){var L=M&&!M.nodeType&&M,$=L&&w&&!w.nodeType&&w,_=$&&$.exports===L?Ps.Buffer:void 0,Y=(_?_.isBuffer:void 0)||lh;w.exports=Y}),aS=/^(?:0|[1-9]\d*)$/,$p=function(M,L){var $=typeof M;return!!(L=L??9007199254740991)&&($=="number"||$!="symbol"&&aS.test(M))&&M>-1&&M%1==0&&M<L},Ma={};Ma["[object Float32Array]"]=Ma["[object Float64Array]"]=Ma["[object Int8Array]"]=Ma["[object Int16Array]"]=Ma["[object Int32Array]"]=Ma["[object Uint8Array]"]=Ma["[object Uint8ClampedArray]"]=Ma["[object Uint16Array]"]=Ma["[object Uint32Array]"]=!0,Ma["[object Arguments]"]=Ma["[object Array]"]=Ma["[object ArrayBuffer]"]=Ma["[object Boolean]"]=Ma["[object DataView]"]=Ma["[object Date]"]=Ma["[object Error]"]=Ma["[object Function]"]=Ma["[object Map]"]=Ma["[object Number]"]=Ma["[object Object]"]=Ma["[object RegExp]"]=Ma["[object Set]"]=Ma["[object String]"]=Ma["[object WeakMap]"]=!1;var sS=function(M){return hi(M)&&Bg(M.length)&&!!Ma[yc(M)]},uh=cs&&cs.isTypedArray,dh=uh?Al(uh):sS,iS=Object.prototype.hasOwnProperty,ay=function(M,L){var $=yi(M),_=!$&&Sd(M),Y=!$&&!_&&Lp(M),Oe=!$&&!_&&!Y&&dh(M),pe=$||_||Y||Oe,At=pe?rS(M.length,String):[],jt=At.length;for(var ur in M)!L&&!iS.call(M,ur)||pe&&(ur=="length"||Y&&(ur=="offset"||ur=="parent")||Oe&&(ur=="buffer"||ur=="byteLength"||ur=="byteOffset")||$p(ur,jt))||At.push(ur);return At},jp=Object.prototype,fl=function(M){var L=M&&M.constructor;return M===(typeof L=="function"&&L.prototype||jp)},ph=oh(Object.keys,Object),Wa=Object.prototype.hasOwnProperty,cS=function(M){if(!fl(M))return ph(M);var L=[];for(var $ in Object(M))Wa.call(M,$)&&$!="constructor"&&L.push($);return L},Cd=function(M){return yp(M)?ay(M):cS(M)},sy=function(M,L){return M&&ny(M,L,Cd)},lS=function(M,L,$,_){return sy(M,function(Y,Oe,pe){L(_,$(Y),Oe,pe)}),_},fh,uS=function(M,L){return function($,_){return lS($,M,L(_),{})}},dS=Object.prototype.toString,Ga=uS(function(w,M,L){M!=null&&typeof M.toString!="function"&&(M=dS.call(M)),w[M]=L},wv($l)),pS=Ga({Android:1,iOS:2,PC:4,WindowsPhone:8,Web:16,Server:32,Mac:64}),mh={p2p:0,team:1,superTeam:5};function iy(w,M){return w&&w.length>0?To(w).call(w,function(L){return Mr(Mr({},L),{account:L.account,connectionId:L.connectionId,deviceId:L.deviceId,ip:L.ip,mac:L.mac,os:L.os,type:pS[L.type]||L.type,time:_o(L.time),online:M!==3})}):[]}Ga(mh),function(w){w[w.text=0]="text",w[w.image=1]="image",w[w.audio=2]="audio",w[w.video=3]="video",w[w.geo=4]="geo",w[w.notification=5]="notification",w[w.file=6]="file",w[w.tip=10]="tip",w[w.robot=11]="robot",w[w.g2=12]="g2",w[w.custom=100]="custom"}(fh||(fh={}));var fS={1:{reason:"samePlatformKick",message:"The same account is not allowed to multiple login at the same time"},2:{reason:"serverKick",message:"Kicked out by IM server"},3:{reason:"otherPlatformKick",message:"Kicked out by other client of your account"},4:{reason:"silentlyKick",message:"Quietly kicked"}},cy={BROWSER:0,RN:2,UNIAPP:3,WECHAT:6},ly=function(w){function M($){var _;return _=w.call(this,"auth",$)||this,qa({cmdMap:Dv,cmdConfig:qv}),_}Ro(M,w);var L=M.prototype;return L.doLogin=function(_){var Y,Oe;return _===void 0&&(_=!1),Sn(this,void 0,void 0,ar.mark(function pe(){var At,jt,ur,gr,vr,Cr,xr,Br,jr,zr;return ar.wrap(function(Kr){for(;;)switch(Kr.prev=Kr.next){case 0:return At=this.core.options,jt=Ho.getSystemInfo(),ur=Mr(Mr({},At),{appLogin:_?0:1,appkey:At.appkey,account:At.account,token:At.token,deviceId:this.core.config.deviceId,clientType:16,protocolVersion:1,sdkVersion:91001,sdkHumanVersion:"0.13.1",os:jt.os,browser:jt.browser,session:(Y=this.core.socket)===null||Y===void 0?void 0:Y.sessionId,sdkType:cy[Ho.platform]||0,userAgent:"Native/0.13.1"}),gr=jt.os.toLowerCase(),Ho.platform!=="UNIAPP"||gr!=="ios"&&gr!=="android"||(ur.isReactNative=1,ur.clientType=gr==="ios"?2:1,jt.pushDeviceInfo&&jt.pushDeviceInfo.MANUFACTURER&&(ur.deviceInfo=Wo(jt.pushDeviceInfo))),this.logger.log("auth::do login ",At.account,(Oe=this.core.socket)===null||Oe===void 0?void 0:Oe.sessionId),Kr.next=8,this.core.sendCmd("login",{login:ur});case 8:if(!(vr=Kr.sent).error){Kr.next=11;break}throw vr.error;case 11:return Cr=vr.content,xr=Cr.loginRes,Br=Cr.loginPorts,jr=Cr.aosPushInfo,zr=iy(Br,2),(zr=is(zr).call(zr,function(kn){return kn.connectionId!==xr.connectionId})).length>0&&this.core.emit("multiPortLogin",zr),Kr.abrupt("return",Mr(Mr({},xr),{aosPushInfo:jr}));case 16:case"end":return Kr.stop()}},pe,this)}))},L.kick=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return jt.next=2,this.core.sendCmd("kick",_);case 2:return pe=jt.sent,jt.abrupt("return",(Y=pe.content)===null||Y===void 0?void 0:Y.deviceIds);case 4:case"end":return jt.stop()}},Oe,this)}))},L.multiPortLoginHandler=function(_){if(_.error)this.logger.error("multiPortLoginHandler:: error, ",_.error);else{var Y=_.content,Oe=iy(Y.loginPorts,Y.state);Oe.length>0&&this.core.emit("multiPortLogin",Oe)}},L.kickedHandler=function(_){if(_.error)this.logger.error("kickedHandler:: error, ",_.error);else{var Y=function(pe){var At=Xs({clientType:{type:"enum",values:Vl},customClientType:{type:"number"}},pe),jt=fS[At.reason];return Mr(At,jt=jt||{reason:"unknow",message:"Unknown reason"})}(_.content);this.logger.warn("kicked::",Y),this.core.doDisconnect(Va.KICKED,Y)}},M}(os);Vr({target:"Number",stat:!0},{isNaN:function(M){return M!=M}});var Md,mS=or.Number.isNaN,gS=Ga({none:0,normal:1,all:3}),uy={normal:0,advanced:1},hS=Ga(uy),vS=Ga({normal:0,owner:1,manager:2}),gh={noVerify:0,needVerify:1,rejectAll:2},dy=Ga(gh),py={needVerify:0,noVerify:1},fy=Ga(py),Hl={manager:0,all:1},ml=Ga(Hl),hh={manager:0,all:1},Hs=Ga(hh),Ni={manager:0,all:1},yS=Ga(Ni);function xc(w){var M,L=["teamId"],$=["level","memberNum","memberUpdateTime","createTime","updateTime"],_=["valid","validToCurrentUser","mute"],Y={type:hS,muteType:gS,joinMode:dy,beInviteMode:fy,inviteMode:ml,updateTeamMode:Hs,updateExtMode:yS};w.bits;var Oe=Es(w,["bits"]);return In(L).call(L,function(pe){Oe[pe]&&(Oe[pe]=Oe[pe].toString())}),In($).call($,function(pe){Oe[pe]!==void 0&&(Oe[pe]=_o(Oe[pe]))}),In(_).call(_,function(pe){Oe[pe]!==void 0&&(Oe[pe]=_o(Oe[pe])===1)}),In(M=Vo(Y)).call(M,function(pe){Oe[pe]!==void 0&&(Oe[pe]=Y[pe][Oe[pe]]||Oe[pe])}),Oe}function vh(w){return w&&w.length>0?To(w).call(w,function(M){return xc(M)}):[]}function yh(w){var M,L=Mr({},w),$=["avatar","name","intro","announcement","ext"],_={type:uy,joinMode:gh,beInviteMode:py,inviteMode:Hl,updateTeamMode:hh,updateExtMode:Ni};return In($).call($,function(Y){L[Y]!==void 0&&(L[Y]=L[Y].toString())}),In(M=Vo(_)).call(M,function(Y){L[Y]!==void 0&&(L[Y]=_[Y][L[Y]])}),L}function gy(w){var M=["teamId","ext","account","nickInTeam"],L={};return w.bitConfigMask!==void 0&&(L.bits=_o(w.bitConfigMask)),In(M).call(M,function($){w[$]&&(L[$]=w[$].toString())}),L}function kd(w){var M,L=["teamId"],$=["joinTime","updateTime","bitConfigMask"],_=["active","valid","mute"],Y={type:vS},Oe=w.bits,pe=Es(w,["bits"]);return Oe!==void 0&&(pe.muteTeam=_o(Oe)===1,pe.bitConfigMask=Oe),pe.id=pe.teamId+"-"+pe.account,In(L).call(L,function(At){pe[At]&&(pe[At]=pe[At].toString())}),In($).call($,function(At){pe[At]!==void 0&&(pe[At]=_o(pe[At]))}),In(_).call(_,function(At){pe[At]!==void 0&&(pe[At]=_o(pe[At])===1)}),In(M=Vo(Y)).call(M,function(At){pe[At]!==void 0&&(pe[At]=Y[At][pe[At]]||pe[At])}),pe}function Dp(w){return w&&w.length>0?To(w).call(w,function(M){return kd(M)}):[]}function hy(w,M,L){return L===void 0&&(L="normal"),{id:w.teamId+"-"+M,teamId:w.teamId,account:M,type:L,nickInTeam:"",muteTeam:!1,mute:!1,joinTime:w.memberUpdateTime,updateTime:w.memberUpdateTime,active:!0,valid:!0}}function bS(w,M,L){return L===void 0&&(L="normal"),M&&M.length>0?To(M).call(M,function($){return hy(w,$,L)}):[]}function zl(w){var M=Mr({},w);return M.createTime&&(M.createTime=+M.createTime),M.updateTime&&(M.updateTime=+M.updateTime),M.gender&&(M.gender=Md[+M.gender]),M}(function(w){w[w.unknown=0]="unknown",w[w.male=1]="male",w[w.female=2]="female"})(Md||(Md={}));var vy={"8_1":"createTeam","8_5":"addTeamMembers","8_6":"removeTeamMembers","8_7":"updateTeamInfo","8_8":"leaveTeam","8_9":"getTeamInfo","8_10":"getTeams","8_11":"getTeamMembers","8_12":"dismissTeam","8_13":"applyTeam","8_14":"passTeamApply","8_15":"rejectTeamApply","8_16":"addTeamManagers","8_17":"removeTeamManagers","8_18":"transferTeam","8_19":"updateMyMemberInfo","8_20":"updateNickInTeam","8_21":"acceptTeamInvite","8_22":"rejectTeamInvite","8_25":"muteTeamMember","8_27":"getMutedTeamMembers","8_28":"sendTeamMsgReceipt","8_29":"getTeamMsgReads","8_30":"getTeamMsgReadAccounts","8_31":"notifyTeamMsgReceipts","8_32":"muteTeam","8_33":"getTeamMemberInvitorAccid","8_34":"getTeamsById","8_101":"syncCreateTeam","8_109":"syncTeams","8_119":"syncUpdateTeamMember","8_126":"syncMyTeamMembers"},sc={team:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,ext:18,serverExt:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateExtMode:24,mute:100,muteType:101},teamMsgReceiptTag:{teamId:0,idServer:1,read:100,unread:101,idClient:102,account:103},teamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,joinTime:10,updateTime:11,ext:12,mute:13,invitorAccid:14}},as=rs(sc),yy={getTeamInfo:{sid:8,cid:9,service:"team",params:[{type:"Long",name:"teamId"}],response:[{type:"Property",name:"team",reflectMapper:as.team}]},getTeams:{sid:8,cid:10,service:"team",params:[{type:"long",name:"timetag"}],response:[{type:"PropertyArray",name:"teams",reflectMapper:as.team},{type:"Number",name:"timetag"}],ignoreErrCodes:[803]},createTeam:{sid:8,cid:1,service:"team",params:[{type:"Property",name:"team",reflectMapper:sc.team},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}],response:[{type:"Property",name:"team",reflectMapper:as.team},{type:"StrArray",name:"abortedAccidList"}]},sendTeamMsgReceipt:{sid:8,cid:28,service:"team",params:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:sc.teamMsgReceiptTag}],response:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:as.teamMsgReceiptTag}]},getTeamMsgReads:{sid:8,cid:29,service:"team",params:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:sc.teamMsgReceiptTag}],response:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:as.teamMsgReceiptTag}]},getTeamMsgReadAccounts:{sid:8,cid:30,service:"team",params:[{type:"Property",name:"teamMsgReceiptTag",reflectMapper:sc.teamMsgReceiptTag}],response:[{type:"Property",name:"teamMsgReceipt",reflectMapper:as.teamMsgReceiptTag},{type:"StrArray",name:"readAccounts"},{type:"StrArray",name:"unreadAccounts"}]},notifyTeamMsgReceipts:{sid:8,cid:31,service:"team",response:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:as.teamMsgReceiptTag}]},dismissTeam:{sid:8,cid:12,service:"team",params:[{type:"Long",name:"teamId"}]},leaveTeam:{sid:8,cid:8,service:"team",params:[{type:"Long",name:"teamId"}]},transferTeam:{sid:8,cid:18,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},updateTeamInfo:{sid:8,cid:7,service:"team",params:[{type:"Property",name:"team",reflectMapper:sc.team}],response:[{type:"Number",name:"id"},{type:"Number",name:"time"}]},getTeamsById:{sid:8,cid:34,service:"team",params:[{type:"LongArray",name:"teamIds"}],response:[{type:"PropertyArray",name:"teams",reflectMapper:as.team},{type:"StrArray",name:"tids"}],ignoreErrCodes:[816]},getTeamMembers:{sid:8,cid:11,service:"team",params:[{type:"Long",name:"teamId"},{type:"Long",name:"timetag"}],response:[{type:"String",name:"teamId"},{type:"PropertyArray",name:"teamMembers",reflectMapper:as.teamMember},{type:"Number",name:"timetag"}]},getMutedTeamMembers:{sid:8,cid:27,service:"team",params:[{type:"Long",name:"teamId"}],response:[{type:"String",name:"teamId"},{type:"PropertyArray",name:"teamMembers",reflectMapper:as.teamMember}]},addTeamMembers:{sid:8,cid:5,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"},{type:"String",name:"attach"}],response:[{type:"Long",name:"time"},{type:"StrArray",name:"abortedAccidList"}]},removeTeamMembers:{sid:8,cid:6,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},applyTeam:{sid:8,cid:13,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"ps"}],response:[{type:"Property",name:"team",reflectMapper:as.team}]},addTeamManagers:{sid:8,cid:16,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeTeamManagers:{sid:8,cid:17,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateMyMemberInfo:{sid:8,cid:19,service:"team",params:[{type:"Property",name:"teamMember",reflectMapper:sc.teamMember}]},updateNickInTeam:{sid:8,cid:20,service:"team",params:[{type:"Property",name:"teamMember",reflectMapper:sc.teamMember}]},muteTeamMember:{sid:8,cid:25,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"Int",name:"mute"}]},getTeamMemberInvitorAccid:{sid:8,cid:33,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}],response:[{type:"Object",name:"accountsMap"}]},muteTeam:{sid:8,cid:32,service:"team",params:[{type:"Long",name:"teamId"},{type:"Int",name:"mute"}]},passTeamApply:{sid:8,cid:14,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamApply:{sid:8,cid:15,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},acceptTeamInvite:{sid:8,cid:21,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamInvite:{sid:8,cid:22,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},syncTeams:{sid:8,cid:109,service:"team",response:[{type:"Number",name:"timetag"},{type:"PropertyArray",name:"teams",reflectMapper:as.team}]},syncCreateTeam:{sid:8,cid:101,service:"team",response:[{type:"Property",name:"team",reflectMapper:as.team}]},syncUpdateTeamMember:{sid:8,cid:119,service:"team",response:[{type:"Property",name:"teamMember",reflectMapper:as.teamMember}]},syncMyTeamMembers:{sid:8,cid:126,ext:"sync",service:"team",response:[{type:"PropertyArray",name:"teamMembers",entity:"teamMember",reflectMapper:as.teamMember},{type:"Number",name:"timetag"}]}},by={"3_7":"getUsersNameCardFromServer","3_10":"updateMyNameCard","3_109":"syncMyNameCard","3_110":"onUpdateMyNameCard","3_3":"setBlack","3_103":"onUpdateBlackList","3_5":"setMute","3_105":"onUpdateMuteList","3_8":"syncRelations"},ic={user:{account:1,nick:3,avatar:4,signature:5,gender:6,email:7,birth:8,tel:9,ext:10,createTime:12,updateTime:13},relationMember:{account:0,isMuted:1,isBlack:2,createTime:3,updateTime:4}},Kl=rs(ic),TS={syncMyNameCard:{sid:3,cid:109,service:"user",response:[{type:"Property",name:"user",reflectMapper:Kl.user},{type:"Number",name:"timetag"}]},setBlack:{service:"user",sid:3,cid:3,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},onUpdateBlackList:{service:"user",sid:3,cid:103,response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},setMute:{service:"user",sid:3,cid:5,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},onUpdateMuteList:{service:"user",sid:3,cid:105,response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},syncRelations:{service:"user",sid:3,cid:8,params:[{type:"long",name:"timetag"}],response:[{type:"PropertyArray",name:"list",reflectMapper:Kl.relationMember},{type:"Number",name:"timetag"}]},getUsersNameCardFromServer:{service:"user",sid:3,cid:7,params:[{type:"StrArray",name:"accounts"}],response:[{type:"PropertyArray",name:"users",reflectMapper:Kl.user}]},updateMyNameCard:{service:"user",sid:3,cid:10,params:[{type:"Property",name:"user",reflectMapper:ic.user}],response:[{type:"Number",name:"timetag"}]},onUpdateMyNameCard:{service:"user",sid:3,cid:110,response:[{type:"Property",name:"user",reflectMapper:Kl.user}]}},Ty={needPush:{type:"boolean",required:!1},needPushBadge:{type:"boolean",required:!1},needPushNick:{type:"boolean",required:!1},pushContent:{type:"string",allowEmpty:!1,required:!1},pushPayload:{type:"string",allowEmpty:!1,required:!1},needForcePush:{type:"boolean",required:!1},forcePushIDsList:{type:"string",allowEmpty:!1,required:!1},forcePushContent:{type:"string",allowEmpty:!1,required:!1}};function SS(w,M){var L,$=ha!==void 0&&gd(w)||w["@@iterator"];if($)return Oo(L=($=$.call(w)).next).call(L,$);if(gi(w)||($=function(Oe,pe){var At;if(Oe){if(typeof Oe=="string")return Sy(Oe,pe);var jt=Co(At=Object.prototype.toString.call(Oe)).call(At,8,-1);if(jt==="Object"&&Oe.constructor&&(jt=Oe.constructor.name),jt==="Map"||jt==="Set")return Ep(Oe);if(jt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(jt))return Sy(Oe,pe)}}(w))||M&&w&&typeof w.length=="number"){$&&(w=$);var _=0;return function(){return _>=w.length?{done:!0}:{done:!1,value:w[_++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sy(w,M){(M==null||M>w.length)&&(M=w.length);for(var L=0,$=new Array(M);L<M;L++)$[L]=w[L];return $}var bh={subType:{type:"string"},setting:{resendFlag:{type:"boolean"},envConfig:{type:"string"},needSaveHistory:{type:"boolean"},needRoaming:{type:"boolean"},needOffline:{type:"boolean"},needSelfSync:{type:"boolean"},needRouted:{type:"boolean"},needUpdateSession:{type:"boolean"},isMuted:{type:"boolean"}},antiSpamInfo:{needAntiSpam:{type:"boolean"},antiSpamContent:{type:"string"},antiSpamBIZID:{type:"string"},clientAntispamHitting:{type:"boolean"},antiSpamUsingYidun:{type:"boolean"},yidunCallbackURL:{type:"string"},yidunAntiCheating:{type:"string"},yidunAntiSpamExtension:{type:"string"},yidunAntiSpamResult:{type:"string"}},pushInfo:Ty,teamSpecializationInfo:{needACK:{type:"boolean"},isACKSent:{type:"boolean"},ackSnapshot:{type:"number"}},threadMessageInfo:{replyMsgFromAccount:{type:"string"},replyMsgToAccount:{type:"string"},replyMsgTime:{type:"number"},replyMsgIdServer:{type:"string"},replyMsgIdClient:{type:"string"},threadMsgFromAccount:{type:"string"},threadMsgToAccount:{type:"string"},threadMsgTime:{type:"number"},threadMsgIdServer:{type:"string"},threadMsgIdClient:{type:"string"}}},Ic={0:"addTeamMembers",1:"removeTeamMembers",2:"leaveTeam",3:"updateTeam",4:"dismissTeam",5:"passTeamApply",6:"transferTeam",7:"addTeamManagers",8:"removeTeamManagers",9:"acceptTeamInvite",10:"updateTeamMemberMute",101:"netcallMiss",102:"netcallBill",103:"netcallReject",401:"addSuperTeamMembers",402:"removeSuperTeamMembers",403:"leaveSuperTeam",404:"updateSuperTeam",405:"dismissSuperTeam",406:"transferSuperTeam",407:"addSuperTeamManagers",408:"removeSuperTeamManagers",409:"updateSuperTeamMembersMute",410:"passSuperTeamApply",411:"acceptSuperTeamInvite"};function bi(w,M){return Da[w.scene]+"-"+(w.to===M?w.from:w.to)}function Up(w,M){return w.from===M?w.to===M?"in":"out":"in"}function Ri(w,M){var L=M.account,$=M.featureValue,_=M.statusValue,Y=M.sessionAck,Oe=M.msgReceiptTime,pe=Da[w.scene],At=w.to===L?w.from:w.to,jt=Ys.default,ur=va.unread;_o(w.isInBlackList)>0?(ur=va.refused,delete w.isInBlackList):ur=w.from===L?Oe&&Oe>=+w.time?va.receipt:va.sent:Y&&Y>=+w.time?va.read:va.unread;var gr=Mr(Mr({},Xs(bh,w)),{scene:pe,type:ac[w.type],fromClientType:Vl[w.fromClientType],flow:Up(w,L),target:At,to:w.to,from:w.from,time:w.time?+w.time:void 0,userUpdateTime:w.userUpdateTime?+w.userUpdateTime:void 0,idClient:w.idClient,sessionId:pe+"-"+At,status:va[_||ur],feature:Ys[$||jt]});if(typeof gr.attach=="string")try{gr.attach=JSON.parse(gr.attach)}catch{}return gr.type==="notification"&&(gr.attach=gr.attach?function(Cr){var xr,Br={};if(Br.type=Ic[Cr.id]||Cr.id,!Cr.data)return Br;var jr,zr={ids:"accounts",id:"account",attach:"custom",channel:"channelId",calltype:"netcallType",mute:"mute",duration:"duration",time:"time",from:"from",ext:"ext"},Hr=Cr.data;return In(xr=Vo(zr)).call(xr,function(Kr){Hr[Kr]!==void 0&&(Br[zr[Kr]]=Hr[Kr])}),Hr.tinfo&&(Br.team=xc(Ii(Hr.tinfo,as.team))),Hr.uinfos&&(Br.users=To(jr=Hr.uinfos).call(jr,function(Kr){return zl(Ii(Kr,Kl.user))})),Hr.mute!==void 0&&(Br.mute=_o(Hr.mute)===1),Br}(gr.attach):{}),gr}function _d(w,M){return w&&w.length>0?Wl(To(w).call(w,function(L){return Ri(L,M)})):[]}function Wl(w){for(var M,L,$={},_=SS(w);!(L=_()).done;){var Y=L.value,Oe=$[Y.idClient];Oe&&Oe.time>Y.time||($[Y.idClient]=Y)}return To(M=Vo($)).call(M,function(pe){return $[pe]})}function gl(w,M){M===void 0&&(M=!0);var L=Mr({},w);if(L.pushInfo&&M){for(var $ in L.pushInfo)typeof L.pushInfo[$]=="boolean"?L[$]=L.pushInfo[$]?1:0:L[$]=L.pushInfo[$];delete L.pushInfo}return L.scene===Da.team&&L.needForcePush&&(L.forcePushContent=L.forcePushContent||L.pushContent,L.forcePushIDsList=L.forcePushIDsList?L.forcePushIDsList:"#%@all@%#"),L}function wd(w,M){return To(w).call(w,function(L){var $;return $=M||(mS(_o(L.scene))?L.scene:_o(L.scene)===1?"p2p":"team"),{deletedTime:_o(L.time),from:L.from,idClient:L.deletedIdClient||L.idClient,idServer:L.deletedIdServer||L.idServer,scene:$,time:_o(L.time),to:L.to}})}var Th=Array.prototype.reverse,Yo=function(M){return M==null?M:Th.call(M)},zo=function(){function w(M){this.core=M}return w.prototype.processBroadcastMsg=function(L){var $=To(L).call(L,function(_){return Mr(Mr({},_),{time:_o(_.time)})});return this.core.sendCmd("batchMarkRead",{sid:7,cid:17,ids:To($).call($,function(_){return _.id})}),$},w}(),Sh={needPush:{type:"boolean",required:!1},needPushBadge:{type:"boolean",required:!1},needPushNick:{type:"boolean",required:!1},pushContent:{type:"string",allowEmpty:!1,required:!1},pushPayload:{type:"string",allowEmpty:!1,required:!1}},Cy={pushContent:8,pushPayload:9,needPush:107,needPushBadge:109,needPushNick:110},Ha={"4_4":"syncOfflineMsgs","4_9":"syncRoamingMsgs","4_17":"syncRoamingMsgs","4_21":"syncDeleteSelfMsgs","7_1":"sendMsg","8_23":"getHistoryTeamMsgs","21_14":"getHistorySuperTeamMsgs","8_2":"sendTeamMsg","21_2":"sendSuperTeamMsg","7_11":"sendMsgReceipt","7_13":"recallMsg","7_24":"deleteSelfMsgs","21_17":"recallSuperTeamMsg","7_2":"onMsg","8_3":"onMsg","21_3":"onMsg","7_101":"onMsg","8_102":"onMsg","21_102":"onMsg","8_4":"nimOnTeamMsgs","4_16":"syncBroadcastMsg","7_17":"onBroadcastMsg","7_123":"onDeleteSelfMsg","7_124":"onDeleteSelfMsgs"},La=Mr({scene:0,to:1,from:2,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,type:8,body:9,attach:10,idClient:11,idServer:12,resendFlag:13,userUpdateTime:14,ext:15,needAntiSpam:21,antiSpamContent:22,antiSpamBIZID:23,clientAntispamHitting:24,antiSpamUsingYidun:25,needACK:26,yidunCallbackURL:27,needUpdateSession:28,replyMsgFromAccount:29,replyMsgToAccount:30,replyMsgTime:31,replyMsgIdServer:32,replyMsgIdClient:33,threadMsgFromAccount:34,threadMsgToAccount:35,threadMsgTime:36,threadMsgIdServer:37,threadMsgIdClient:38,isDeleted:39,callbackExt:40,subType:41,yidunAntiCheating:42,envConfig:43,yidunAntiSpamExtension:44,yidunAntiSpamResult:45,needSaveHistory:100,needRoaming:101,needSelfSync:102,isMuted:104,needRouted:105,isInBlackList:106,needOffline:108,isReplyMsg:111,ackSnapshot:112},{pushContent:17,pushPayload:16,forcePushIDsList:18,forcePushContent:19,needForcePush:20,needPush:107,needPushBadge:109,needPushNick:110}),Ec={msg:La,recallMsgTag:Mr({time:0,type:1,to:2,from:3,ps:4,attach:5,deletedIdClient:10,deletedIdServer:11,opeAccount:16,env:21},Cy),deleteSelfMsgTag:{scene:1,from:2,to:3,idServer:4,idClient:5,time:6,deletedTime:7,ext:8},msgReceiptTag:{to:1,from:2,time:7,idClient:11},broadcastMsg:{id:1,fromAccid:2,time:4,body:5}},ss=rs(Ec),CS={sendMsg:{sid:7,cid:1,service:"msg",params:[{type:"Property",name:"msg",reflectMapper:Ec.msg}],response:[{type:"Property",name:"msg",reflectMapper:ss.msg}],ignoreErrCodes:[7101]},sendTeamMsg:{sid:8,cid:2,service:"msg",params:[{type:"Property",name:"msg",reflectMapper:Ec.msg}],response:[{type:"Property",name:"msg",reflectMapper:ss.msg}]},sendSuperTeamMsg:{sid:21,cid:2,service:"msg",params:[{type:"Property",name:"msg",reflectMapper:Ec.msg}],response:[{type:"Property",name:"msg",reflectMapper:ss.msg}]},onMsg:{sid:7,cid:2,service:"msg",response:[{type:"Property",name:"msg",reflectMapper:ss.msg}]},nimOnTeamMsgs:{sid:8,cid:4,service:"msg",response:[{type:"PropertyArray",name:"datas",reflectMapper:ss.msg}]},getHistoryTeamMsgs:{sid:8,cid:23,service:"msg",params:[{type:"Long",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:ss.msg}]},getHistorySuperTeamMsgs:{sid:21,cid:14,params:[{type:"Long",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:ss.msg}],service:"msg"},recallMsg:{sid:7,cid:13,service:"msg",params:[{type:"Property",name:"recallMsgTag",reflectMapper:Ec.recallMsgTag}]},deleteSelfMsgs:{sid:7,cid:24,service:"msg",params:[{type:"PropertyArray",name:"deletedMsgs",reflectMapper:Ec.deleteSelfMsgTag}],response:[{type:"Long",name:"timetag"}]},recallSuperTeamMsg:{sid:21,cid:17,service:"msg",params:[{type:"Property",name:"recallMsgTag",reflectMapper:Ec.recallMsgTag}]},sendMsgReceipt:{sid:7,cid:11,service:"msg",params:[{type:"Property",name:"msgReceiptTag",reflectMapper:Ec.msgReceiptTag}],response:[{type:"Property",name:"msgReceiptTag",reflectMapper:ss.msgReceiptTag}]},batchMarkRead:{sid:4,cid:5,service:"msg",isNoResponse:!0,params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]},syncMsgReceipts:{sid:4,cid:12,service:"msg",response:[{type:"PropertyArray",name:"msgReceipts",reflectMapper:ss.msgReceiptTag},{type:"Number",name:"timetag"}]},syncOfflineMsgs:{sid:4,cid:4,service:"msg",response:[{type:"PropertyArray",name:"msgs",reflectMapper:ss.msg}]},syncRoamingMsgs:{sid:4,cid:9,service:"msg",response:[{type:"PropertyArray",name:"msgs",reflectMapper:ss.msg}]},syncBroadcastMsg:{sid:4,cid:16,service:"msg",response:[{type:"PropertyArray",name:"msgs",reflectMapper:ss.broadcastMsg}]},onBroadcastMsg:{sid:7,cid:17,service:"msg",response:[{type:"Property",name:"msg",reflectMapper:ss.broadcastMsg}]},onDeleteSelfMsg:{sid:7,cid:123,service:"msg",response:[{type:"Property",name:"deletedMsg",reflectMapper:ss.deleteSelfMsgTag}]},onDeleteSelfMsgs:{sid:7,cid:124,service:"msg",response:[{type:"PropertyArray",name:"deletedMsgs",reflectMapper:ss.deleteSelfMsgTag}]},syncDeleteSelfMsgs:{sid:4,cid:21,service:"msg",response:[{type:"PropertyArray",name:"deletedMsgs",reflectMapper:ss.deleteSelfMsgTag}]}},My=function(w){function M($){var _;return(_=w.call(this,"msg",$)||this).service=new zo($),qa({cmdMap:Ha,cmdConfig:CS}),_}Ro(M,w);var L=M.prototype;return L.sendTextMsg=function(_){return En({body:{type:"string",allowEmpty:!1}},_),this.sendMsg(Mr(Mr({},_),{type:"text"}))},L.sendTipMsg=function(_){return En({body:{type:"string",allowEmpty:!1}},_),this.sendMsg(Mr(Mr({},_),{type:"tip"}))},L.sendGeoLocationMsg=function(_){return En({attach:{type:"object",rules:{title:{type:"string",allowEmpty:!1},lat:{type:"number"},lng:{type:"number"}}}},_),this.sendMsg(Mr(Mr({},_),{type:"geo",attach:Wo(_.attach)}))},L.sendCustomMsg=function(_){return En({attach:{type:"string",allowEmpty:!1}},_),this.sendMsg(Mr(Mr({},_),{type:"custom"}))},L.sendMsg=function(_){var Y,Oe,pe=this;!((Y=this.core.sync)===null||Y===void 0)&&Y.getSyncDoneFlag()||this.logger.warn("Please send message after syncdone event"),En({scene:{type:"enum",values:vi(Da)},type:{type:"enum",values:vi(ac)},to:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1},setting:{type:"object",rules:{resendFlag:{type:"boolean",required:!1},needSaveHistory:{type:"boolean",required:!1},needRoaming:{type:"boolean",required:!1},needOffline:{type:"boolean",required:!1},needSelfSync:{type:"boolean",required:!1},needRouted:{type:"boolean",required:!1},needUpdateSession:{type:"boolean",required:!1}},required:!1},antiSpamInfo:{type:"object",required:!1,rules:{clientAntispamHitting:{type:"boolean",required:!1},antiSpamUsingYidun:{type:"boolean",required:!1}}},pushInfo:{type:"object",required:!1,rules:Ty},teamSpecializationInfo:{type:"object",required:!1,rules:{needACK:{type:"boolean",required:!1}}}},_);var At,jt=_.scene==="p2p"?"sendMsg":_.scene==="team"?"sendTeamMsg":"sendSuperTeamMsg",ur=function(Cr,xr,Br,jr){Cr.onSendBefore,Cr.onUploadStart,Cr.onUploadDone;var zr=Cr.replyMsg,Hr=Es(Cr,["onSendBefore","onUploadStart","onUploadDone","replyMsg"]),Kr=Mr(Mr({},Td(bh,Hr)),{scene:Da[Cr.scene],type:ac[Cr.type],from:xr,fromClientType:16,fromDeviceId:Br,fromNick:jr==null?void 0:jr.nick,userUpdateTime:jr==null?void 0:jr.updateTime,status:va[va.sending]});if(Kr.idClient=Kr.resendFlag?Cr.idClient:_p(),!Kr.idClient)throw new Tg("idClient is required to resend a message","idClient","required");return Kr=gl(Kr,!1),zr&&(Kr.replyMsgFromAccount=zr.from,Kr.replyMsgToAccount=zr.to,Kr.replyMsgTime=+zr.time,Kr.replyMsgIdServer=zr.idServer,Kr.replyMsgIdClient=zr.idClient,Kr.threadMsgFromAccount=zr.from,Kr.threadMsgToAccount=zr.to,Kr.threadMsgTime=+zr.time,Kr.threadMsgIdServer=zr.idServer,Kr.threadMsgIdClient=zr.idClient,zr.threadMessageInfo&&zr.threadMessageInfo.threadMsgIdServer&&(Kr.threadMsgFromAccount=zr.threadMessageInfo.threadMsgFromAccount,Kr.threadMsgToAccount=zr.threadMessageInfo.threadMsgToAccount,Kr.threadMsgTime=zr.threadMessageInfo.threadMsgTime,Kr.threadMsgIdServer=zr.threadMessageInfo.threadMsgIdServer,Kr.threadMsgIdClient=zr.threadMessageInfo.threadMsgIdClient)),Kr}(_,this.core.account,this.core.config.deviceId,(Oe=this.core.user)===null||Oe===void 0?void 0:Oe.myInfo),gr=Ri(Mr(Mr({},ur),{time:new Date().getTime()}),{account:this.core.account,featureValue:Ys.default,statusValue:va.sending});try{_.onSendBefore&&_.onSendBefore(gr)}catch(vr){this.logger.error("sendMsg: options.onSendBefore error",vr)}return this.core.eventBus.emit("session/updateForNewMsg",gr),this.core.sendCmd(jt,{msg:ur}).then(function(vr){var Cr=vr.content,xr=vr.error;if(At=Cr.msg,xr)throw xr;var Br=Ri(Mr(Mr({},ur),Cr.msg),{account:pe.core.account,featureValue:Ys.default,statusValue:va.sent});return Br.from===Br.to&&pe.markMsgsAck([Br]),pe.core.eventBus.emit("session/updateForNewMsg",Br),pe.core.reporter.report("msgSend",{msgId:Br.idServer,clientId:Br.idClient,msgTime:Br.time,fromAccid:_.scene==="p2p"?pe.core.account:"",toAccid:Br.to,type:Da[Br.scene],roomId:"",tid:_.scene==="p2p"?"":Br.to,result:200,faiReason:"",rt:sa()-gr.time}),Br}).catch(function(vr){var Cr=Ri(Mr(Mr(Mr({},ur),{time:new Date().getTime()}),At),{account:pe.core.account,featureValue:Ys.default,statusValue:vr.code===7101?va.refused:va.sendFailed});throw vr.msg=Cr,pe.core.eventBus.emit("session/updateForNewMsg",Cr),pe.core.reporter.report("msgSend",{msgId:Cr.idServer,clientId:Cr.idClient,msgTime:Cr.time,fromAccid:_.scene==="p2p"?pe.core.account:"",toAccid:Cr.to,type:Da[Cr.scene],roomId:"",tid:_.scene==="p2p"?"":Cr.to,result:vr==null?void 0:vr.code,faiReason:(vr==null?void 0:vr.message)||"",rt:sa()-gr.time}),vr})},L.resendMsg=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(En({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1}}}},_),Oe=_.msg,pe=Mr(Mr({},Oe),{attach:Oe.attach?Wo(Oe.attach):void 0,setting:{resendFlag:!0}}),Oe.from===this.core.account){jt.next=5;break}throw new Error("You can only resend messages that you sent: "+Oe.idClient);case 5:return jt.abrupt("return",this.sendMsg(pe));case 6:case"end":return jt.stop()}},Y,this)}))},L.forwardMsg=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return En({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1}}},scene:{type:"enum",values:vi(Da)},to:{type:"string",allowEmpty:!1}},_),Oe=_.msg,pe=Mr(Mr({},Oe),{scene:_.scene,to:_.to,attach:Oe.attach?Wo(Oe.attach):void 0}),jt.abrupt("return",this.sendMsg(pe));case 4:case"end":return jt.stop()}},Y,this)}))},L.sendImageMsg=function(_){return this.doSendFile(Mr(Mr({},_),{type:"image"}))},L.sendFileMsg=function(_){return this.doSendFile(Mr(Mr({},_),{type:"file"}))},L.sendAudioMsg=function(_){return this.doSendFile(Mr(Mr({},_),{type:"audio"}))},L.sendVideoMsg=function(_){return this.doSendFile(Mr(Mr({},_),{type:"video"}))},L.doSendFile=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(En({scene:{type:"enum",values:vi(Da)},to:{type:"string",allowEmpty:!1},type:{type:"string",allowEmpty:!1},attach:{type:"object",rules:{url:{type:"string",allowEmpty:!1}},required:!1},maxSize:{type:"number",min:1,required:!1}},_),Oe=_.attach){jt.next=28;break}if(this.core.cloudStorage&&this.core.cloudStorage.uploadFile){jt.next=5;break}throw new Error('Service "cloudStorage" does not exist');case 5:return jt.prev=5,this.core.reporter.reportTraceStart("nos",{user_id:this.core.account,action:"upload"}),jt.next=9,this.core.cloudStorage.uploadFile(_);case 9:Oe=jt.sent,this.core.reporter.reportTraceEnd("nos",!0),jt.next=20;break;case 13:throw jt.prev=13,jt.t0=jt.catch(5),pe=jt.t0,this.core.reporter.reportTraceUpdateV2("nos",{operation_type:"transfer",description:pe.message,code:pe.code||0,target:"",succeed:!1}),this.core.reporter.reportTraceEnd("nos",!1),this.logger.error("sendFile:: upload File error or abort",jt.t0),jt.t0;case 20:jt.prev=20,_.onUploadDone&&_.onUploadDone(Oe),jt.next=28;break;case 24:throw jt.prev=24,jt.t1=jt.catch(20),this.logger.error("sendFile options.onUploadDone err",jt.t1),jt.t1;case 28:return jt.abrupt("return",this.sendMsg(Mr(Mr({},_),{attach:Wo(Oe),type:_.type})));case 29:case"end":return jt.stop()}},Y,this,[[5,13],[20,24]])}))},L.recallMsg=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return!((Y=this.core.sync)===null||Y===void 0)&&Y.getSyncDoneFlag()||this.logger.warn("Please call recallMsg after syncdone event"),En({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1},scene:{type:"enum",values:vi(Da)},time:{type:"number"}}},pushInfo:{type:"object",required:!1,rules:Sh},ps:{type:"string",allowEmpty:!1,required:!1}},_),pe=_.msg,At={p2p:"recallMsg",team:"recallMsg",superTeam:"recallSuperTeamMsg"},jt={p2p:7,team:8,superTeam:12},gr.next=7,this.core.sendCmd(At[pe.scene],{recallMsgTag:gl({time:pe.time,type:jt[pe.scene],to:pe.to,from:pe.from,ps:_.ps,attach:_.attach,deletedIdClient:pe.idClient,deletedIdServer:pe.idServer,opeAccount:pe.from,env:_.env,pushInfo:_.pushInfo})});case 7:return this.core.eventBus.emit("session/updateForDeletedMsg",wd([pe])),gr.abrupt("return",pe);case 9:case"end":return gr.stop()}},Oe,this)}))},L.deleteSelfMsgs=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return!((Y=this.core.sync)===null||Y===void 0)&&Y.getSyncDoneFlag()||this.logger.warn("Please call deleteSelfMsgs after syncdone event"),En({msgs:{type:"array",rules:{scene:{type:"enum",values:["p2p","team"]},from:{type:"string",allowEmpty:!1},to:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},time:{type:"number",allowEmpty:!1}}},ext:{type:"string",allowEmpty:!1,required:!1}},_),pe=_.msgs,At=To(pe).call(pe,function(vr){return{scene:vr.scene==="p2p"?1:2,from:vr.from,to:vr.to,idServer:vr.idServer,idClient:vr.idClient,time:vr.time,ext:_.ext}}),gr.next=6,this.core.sendCmd("deleteSelfMsgs",{deletedMsgs:At});case 6:return jt=wd(At),this.core.eventBus.emit("session/updateForDeletedMsg",jt),gr.abrupt("return",jt);case 9:case"end":return gr.stop()}},Oe,this)}))},L.sendMsgReceipt=function(_){var Y,Oe,pe;return Sn(this,void 0,void 0,ar.mark(function At(){var jt,ur,gr,vr;return ar.wrap(function(xr){for(;;)switch(xr.prev=xr.next){case 0:if(!((Y=this.core.sync)===null||Y===void 0)&&Y.getSyncDoneFlag()||this.logger.warn("Please call sendMsgReceipt after syncdone event"),En({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1},target:{type:"string",allowEmpty:!1},time:{type:"number"}}}},_),(jt=_.msg).scene==="p2p"&&jt.flow==="in"){xr.next=6;break}return this.logger.warn("Msg scene: "+jt.scene+", flow: "+jt.flow+" is not allowed to send msg receipt"),xr.abrupt("return",void 0);case 6:return ur={to:jt.target,idClient:jt.idClient,time:jt.time},xr.next=9,this.core.sendCmd("sendMsgReceipt",{msgReceiptTag:ur});case 9:return gr=xr.sent,vr=_o((pe=(Oe=gr.content)===null||Oe===void 0?void 0:Oe.msgReceiptTag)===null||pe===void 0?void 0:pe.time),xr.abrupt("return",Mr(Mr({},ur),{time:vr?Math.min(vr,ur.time):ur.time}));case 12:case"end":return xr.stop()}},At,this)}))},L.sendTeamMsgReceipt=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return!((Y=this.core.sync)===null||Y===void 0)&&Y.getSyncDoneFlag()||this.logger.warn("Please call sendTeamMsgReceipt after syncdone event"),En({teamMsgReceipts:{type:"array",rules:{teamId:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1}},max:50}},_),pe=_.teamMsgReceipts,this.core.sendCmd("sendTeamMsgReceipt",{teamMsgReceipts:pe}),jt.abrupt("return",void 0);case 5:case"end":return jt.stop()}},Oe,this)}))},L.getTeamMsgReads=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return En({teamMsgReceipts:{type:"array",rules:{teamId:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1}}}},_),pe=_.teamMsgReceipts,gr.next=4,this.core.sendCmd("getTeamMsgReads",{teamMsgReceipts:pe});case 4:return At=gr.sent,jt=(jt=(Y=At.content)===null||Y===void 0?void 0:Y.teamMsgReceipts)?To(jt).call(jt,function(vr){return Mr(Mr({},vr),{read:_o(vr.read),unread:_o(vr.unread)})}):[],gr.abrupt("return",jt);case 8:case"end":return gr.stop()}},Oe,this)}))},L.getTeamMsgReadAccounts=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return En({teamMsgReceipt:{type:"object",rules:{teamId:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1}}}},_),Oe=_.teamMsgReceipt,jt.next=4,this.core.sendCmd("getTeamMsgReadAccounts",{teamMsgReceiptTag:Oe});case 4:return pe=jt.sent,jt.abrupt("return",pe.content);case 6:case"end":return jt.stop()}},Y,this)}))},L.markMsgsAck=function(_){if(_&&_.length>0){var Y=[],Oe=[];In(_).call(_,function(pe){pe.scene==="p2p"&&pe.flow==="in"?Y.push(pe):pe.scene==="team"&&pe.flow==="in"&&Oe.push(pe)}),Y.length>0&&this.core.sendCmd("batchMarkRead",{sid:7,cid:2,ids:To(Y).call(Y,function(pe){return pe.idServer})}),Oe.length>0&&this.core.sendCmd("batchMarkRead",{sid:8,cid:3,ids:To(Oe).call(Oe,function(pe){return pe.idServer})})}},L.onMsgHandler=function(_){var Y;if(_.error)this.logger.error("msgHandler::recvError",_.error);else{var Oe=typeof As(_,"raw.r[0]")=="number"?""+_.raw.r[0]:void 0,pe=_.content.msg;pe.idServer=pe.idServer||Oe;var At=sa(),jt=bi(pe,this.core.account),ur=(Y=this.core.session)===null||Y===void 0?void 0:Y.getSessionWithUncomplete({id:jt}),gr=Ri(pe,ur?{account:this.core.account,sessionAck:ur.ack,msgReceiptTime:ur.msgReceiptTime}:{account:this.core.account});if(this.core.options.debugLevel==="debug"?this.logger.debug("msgHandler::recvMsg",gr.idClient,gr.idServer,gr):this.logger.log("msgHandler::recvMsg",gr.idClient,gr.idServer),this.markMsgsAck([gr]),this.core.eventBus.emit("session/updateForNewMsg",gr),this.core.emit("msg",gr),gr.type==="notification")this.core.eventBus.emit("team/onNotification",gr);else if(gr.flow!=="out"){var vr=gr.scene==="p2p",Cr={msgId:gr.idServer,clientId:gr.idClient,receiveTime:_.__receiveTime,serverTime:gr.time,callbackTime:sa(),preHandleTime:At,fromAccid:gr.from,toAccid:this.core.account,type:Da[gr.scene],tid:vr?"":gr.to,result:200,failReason:"",rt:sa()-gr.time};this.core.reporter.report("msgReceive",Cr,!0)}}},L.nimOnTeamMsgsHandler=function(_){var Y,Oe=this;In(Y=_.content.datas).call(Y,function(pe){Oe.onMsgHandler(Mr({},_,{content:{msg:pe}}))})},L.syncRoamingMsgsHandler=function(_){var Y,Oe,pe=_.content.msgs||[];if(pe.length!==0){var At=bi(pe[0],this.core.account),jt=(Y=this.core.session)===null||Y===void 0?void 0:Y.getSessionWithUncomplete({id:At}),ur=(pe=_d(pe,jt?{account:this.core.account,featureValue:Ys.roam,sessionAck:jt.ack,msgReceiptTime:jt.msgReceiptTime}:{account:this.core.account,featureValue:Ys.roam}))[0].time,gr={timetag:ur,sessionId:At,msgs:Yo(pe)};!((Oe=this.core.sync)===null||Oe===void 0)&&Oe.getSyncDoneFlag()||this.core.eventBus.emit("session/syncMsgs",gr),this.core.emit("syncRoamingMsgs",gr),this.core.eventBus.emit("sync/updateTimetag",{roamingMsgs:ur})}},L.syncOfflineMsgsHandler=function(_){var Y,Oe=this,pe=_.content.msgs||[];if(pe.length!==0){var At={},jt=[];In(pe).call(pe,function(gr){var vr=bi(gr,Oe.core.account),Cr=Oe.core.session.getSessionWithUncomplete({id:vr}),xr=Ri(gr,Cr?{account:Oe.core.account,featureValue:Ys.leave,sessionAck:Cr.ack,msgReceiptTime:Cr.msgReceiptTime}:{account:Oe.core.account,featureValue:Ys.leave});jt.push(xr),At[xr.sessionId]?At[xr.sessionId].push(xr):At[xr.sessionId]=[xr]}),this.markMsgsAck(jt);var ur=0;In(Y=Vo(At)).call(Y,function(gr){var vr,Cr=wc(vr=At[gr]).call(vr,function(Br,jr){return jr.time-Br.time});(Cr=Wl(Cr))[0].time>ur&&(ur=Cr[0].time);var xr={timetag:Cr[0].time,sessionId:gr,msgs:Cr};Oe.core.eventBus.emit("session/syncMsgs",xr),Oe.core.emit("syncOfflineMsgs",xr)}),this.core.eventBus.emit("sync/updateTimetag",{offlineMsgs:ur})}},L.syncDeleteSelfMsgsHandler=function(_){var Y,Oe=(Y=_.content)===null||Y===void 0?void 0:Y.deletedMsgs;Oe&&Oe.length>0||this.logger.warn("syncDeleteSelfMsgs:: no msgs");var pe=Oe[Oe.length-1].time;this.core.eventBus.emit("sync/updateTimetag",{deleteSelfMsgs:pe})},L.onDeleteSelfMsgHandler=function(_){var Y=wd([_.content.deletedMsg]);this.core.eventBus.emit("session/updateForDeletedMsg",Y),this.core.emit("deleteSelfMsgs",Y)},L.onDeleteSelfMsgsHandler=function(_){var Y=wd(_.content.deletedMsgs);this.core.eventBus.emit("session/updateForDeletedMsg",Y),this.core.emit("deleteSelfMsgs",Y)},L.onBroadcastMsgHandler=function(_){var Y=_.content.msg,Oe=this.service.processBroadcastMsg([Y]);this.core.emit("broadcastMsgs",Oe)},L.syncBroadcastMsgHandler=function(_){var Y=_.content.msgs,Oe=this.service.processBroadcastMsg(Y);this.core.emit("broadcastMsgs",Oe)},M}(os),MS={"5_1":"sync"},kS={sync:{sid:5,cid:1,service:"sync",isNoResponse:!0,params:[{type:"Property",name:"sync",reflectMapper:{myInfo:1,offlineMsgs:2,teams:3,roamingMsgs:7,relations:9,friends:11,friendUsers:13,msgReceipts:14,myTeamMembers:15,donnop:16,recallMsg:17,sessionAck:18,broadcastMsgs:20,signaling:21,superTeams:22,mySuperTeamMembers:23,superTeamRoamingMsgs:24,deleteSuperTeamMsg:25,superTeamSessionAck:26,deleteSelfMsgs:27,stickTopSessions:28,sessionHistoryMsgsDelete:29}}],response:[{type:"Number",name:"timetag"}]}},qp=function(w){function M($,_){var Y;return _===void 0&&(_={}),(Y=w.call(this,"sync",$)||this).options=_,Y.syncDoneFlag=!1,Y.options=Mr({myInfo:!!$.user.name,offlineMsgs:!!$.msg.name,teams:!!$.team.name,myTeamMembers:!!$.team.name,roamingMsgs:!!$.msg.name,relations:!!$.user.name,friends:!!$.friend.name,friendUsers:!!$.user.name,msgReceipts:!!$.msg.name,recallMsg:!!$.msg.name,sessionAck:!!$.session.name,superTeamSessionAck:!!$.session.name,superTeams:!!$.superTeam.name,mySuperTeamMembers:!!$.superTeam.name,superTeamRoamingMsgs:!!$.superTeam.name,deleteSuperTeamMsg:!!$.superTeam.name,deleteSelfMsgs:!!$.msg.name,sessionHistoryMsgsDelete:!!$.msgLog.name,signaling:!!$.signaling.name},_),Y.timetags={},Y.pArray=[],Y.initEventListeners(),qa({cmdMap:MS,cmdConfig:kS}),Y}Ro(M,w);var L=M.prototype;return L.getSyncDoneFlag=function(){return this.syncDoneFlag},L.doSync=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var Y;return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return Y=this.genSyncParams(),this.logger.log("doSync: ",Y),pe.next=4,this.core.sendCmd("sync",{sync:Y});case 4:case"end":return pe.stop()}},_,this)}))},L.initEventListeners=function(){var _=this;this.core.eventBus.on("sync/updateTimetag",function(Y){var Oe;In(Oe=Vo(Y)).call(Oe,function(pe){Y[pe]>(_.timetags[pe]||0)&&(_.timetags[pe]=Y[pe])})}),this.core.eventBus.on("logined",function(){_.syncDoneFlag=!1})},L.genSyncParams=function(){var _,Y,Oe=this;return op(_=is(Y=Vo(this.options)).call(Y,function(pe){var At=pe;return Oe.options[At]})).call(_,function(pe,At){var jt=At;return pe[jt]=Oe.timetags[jt]||0,pe},{})},L.handleImmediate=function(_){var Y;this.core.session&&this.core.session.onSyncDone&&this.core.session.onSyncDone(),this.logger.log("sync: emit syncdone",(Y=_.content)===null||Y===void 0?void 0:Y.timetag),this.syncDoneFlag=!0,this.core.emit("syncdone")},L.syncHandler=function(_){var Y=this;(function(){return typeof tt<"u"&&tt.getSystemInfo?"TT":typeof swan<"u"&&swan.getSystemInfo?"BAIDU":typeof my<"u"&&my.getSystemInfo?"ALI":typeof wx<"u"&&wx.getSystemInfo?"WX":"unknow environment"})()==="ALI"?(this.logger.log("sync: emit ALIAPP sycnHandler, handle later"),vo(function(){Y.handleImmediate(_)},100)):this.handleImmediate(_)},M}(os),ya={"6_26":"getNosCdnHost"},ky={getNosCdnHost:{sid:6,cid:26,service:"misc",response:[{type:"Property",name:"nosConfigTag",reflectMapper:rs({nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4}}).nosConfigTag}]}},_S=function(w){function M(L){var $;return($=w.call(this,"misc",L)||this).core=L,$.nosCdnHostTimer=0,qa({cmdMap:ya,cmdConfig:ky}),$}return Ro(M,w),M}(os),Gl=function(M,L,$){L=="__proto__"&&pd?pd(M,L,{configurable:!0,enumerable:!0,value:$,writable:!0}):M[L]=$},_y=Object.prototype.hasOwnProperty,Vp=function(M,L,$){var _=M[L];_y.call(M,L)&&nc(_,$)&&($!==void 0||L in M)||Gl(M,L,$)},Ch=function(M,L,$,_){if(!fi(M))return M;for(var Y=-1,Oe=(L=vd(L,M)).length,pe=Oe-1,At=M;At!=null&&++Y<Oe;){var jt=dl(L[Y]),ur=$;if(jt==="__proto__"||jt==="constructor"||jt==="prototype")return M;if(Y!=pe){var gr=At[jt];(ur=_?_(gr,jt,At):void 0)===void 0&&(ur=fi(gr)?gr:$p(L[Y+1])?[]:{})}Vp(At,jt,ur),At=At[jt]}return M},wy=function(M,L,$){for(var _=-1,Y=L.length,Oe={};++_<Y;){var pe=L[_],At=Wg(M,pe);$(At,pe)&&Ch(Oe,vd(pe,M),At)}return Oe},wS=function(M,L){return M!=null&&L in Object(M)},xS=function(M,L,$){for(var _=-1,Y=(L=vd(L,M)).length,Oe=!1;++_<Y;){var pe=dl(L[_]);if(!(Oe=M!=null&&$(M,pe)))break;M=M[pe]}return Oe||++_!=Y?Oe:!!(Y=M==null?0:M.length)&&Bg(Y)&&$p(pe,Y)&&(yi(M)||Sd(M))},xd=function(M,L){return M!=null&&xS(M,L,wS)},Mh=function(M,L){return wy(M,L,function($,_){return xd(M,_)})},Ql=function(M,L){for(var $=-1,_=L.length,Y=M.length;++$<_;)M[Y+$]=L[$];return M},cc=Gs?Gs.isConcatSpreadable:void 0,IS=function(M){return yi(M)||Sd(M)||!!(cc&&M&&M[cc])},Pc=function w(M,L,$,_,Y){var Oe=-1,pe=M.length;for($||($=IS),Y||(Y=[]);++Oe<pe;){var At=M[Oe];L>0&&$(At)?L>1?w(At,L-1,$,_,Y):Ql(Y,At):_||(Y[Y.length]=At)}return Y},ES=function(M){return M!=null&&M.length?Pc(M,1):[]},Id=function(M){return Iv(hp(M,void 0,ES),M+"")}(function(w,M){return w==null?{}:Mh(w,M)}),xy=function(w){function M($){var _;return(_=w.call(this,"user",$)||this).myInfo=zl({}),qa({cmdMap:by,cmdConfig:TS}),_}Ro(M,w);var L=M.prototype;return L.setBlack=function(_){return En({account:{type:"string",allowEmpty:!1},isAdd:{type:"boolean"}},_),this.core.sendCmd("setBlack",_).then(function(){})},L.setMute=function(_){return En({account:{type:"string",allowEmpty:!1},isAdd:{type:"boolean"}},_),this.core.sendCmd("setMute",_).then(function(){})},L.getRelations=function(){return this.core.sendCmd("syncRelations",{timetag:0})},L.getBlackList=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var Y;return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return pe.next=2,this.core.sendCmd("syncRelations",{timetag:0});case 2:return Y=pe.sent,pe.abrupt("return",Y.blackList||[]);case 4:case"end":return pe.stop()}},_,this)}))},L.getMuteList=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var Y;return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return pe.next=2,this.core.sendCmd("syncRelations",{timetag:0});case 2:return Y=pe.sent,pe.abrupt("return",Y.muteList||[]);case 4:case"end":return pe.stop()}},_,this)}))},L.updatePushToken=function(){return Sn(this,void 0,void 0,ar.mark(function _(){return ar.wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:this.logger.error("This function is deprecated, please use nim.offlinePush.setOfflinePushConfig instead");case 1:case"end":return Oe.stop()}},_,this)}))},L.updateAppBackground=function(){return Sn(this,void 0,void 0,ar.mark(function _(){return ar.wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:this.logger.error("This function is deprecated, please use nim.offlinePush.setOfflinePushConfig instead");case 1:case"end":return Oe.stop()}},_,this)}))},L.getUsersNameCardFromServer=function(_){var Y=this;return En({accounts:{type:"array",max:150,itemType:"string"}},_),this.core.sendCmd("getUsersNameCardFromServer",Id(_,["accounts"])).then(function(Oe){var pe,At=Oe.content;return Y.logger.log("user:: getUsers done",_.accounts),At&&At.users?To(pe=At.users).call(pe,function(jt){return zl(jt)}):[]})},L.updateMyNameCard=function(_){var Y=this;if(En({nick:{type:"string",required:!1},avatar:{type:"string",required:!1},signature:{type:"string",required:!1},gender:{type:"enum",values:vi(Md),required:!1},email:{type:"string",required:!1},birth:{type:"string",required:!1},tel:{type:"string",required:!1},ext:{type:"string",required:!1}},_),Vo(_).length===0)return co.resolve(this.myInfo);var Oe=Id(_,["nick","avatar","signature","email","birth","tel","ext"]);return _.gender&&(Oe.gender=Md[_.gender]),this.core.sendCmd("updateMyNameCard",{user:Oe}).then(function(pe){var At=pe.content;return At&&At.timetag&&Y.core.eventBus.emit("sync/updateTimetag",{myInfo:+At.timetag}),_.gender&&(Oe.gender=_.gender),Y.myInfo=Mr({},Y.myInfo,Oe),Y.myInfo})},L.onUpdateBlackListHandler=function(_){var Y=_.content;Y.account?this.core.emit("updateBlackList",Y):this.logger.warn("onUpdateBlackListHandler: no account")},L.onUpdateMuteListHandler=function(_){var Y=_.content;Y.account?this.core.emit("updateMuteList",Y):this.logger.warn("onUpdateBlackListHandler: no account")},L.syncRelationsHandler=function(_){var Y=_.content,Oe=Y.list,pe=Y.timetag,At={blackList:[],muteList:[]};return pe&&this.core.eventBus.emit("sync/updateTimetag",{relations:pe}),Oe&&Oe.length&&In(Oe).call(Oe,function(jt){var ur=function(vr){var Cr={account:vr.account,updateTime:+vr.updateTime,createTime:+vr.createTime};return vr.isMuted==="1"&&(Cr.isMuted=!0),vr.isBlack==="1"&&(Cr.isBlack=!0),Cr}(jt);ur.isBlack&&At.blackList.push(ur),ur.isMuted&&At.muteList.push(ur)}),this.core.emit("relations",At),co.resolve(At)},L.syncMyNameCardHandler=function(_){_.content.user&&(this.myInfo=zl(_.content.user),this.core.emit("syncMyNameCard",this.myInfo),this.core.eventBus.emit("sync/updateTimetag",{myInfo:_.content.timetag}))},L.onUpdateMyNameCardHandler=function(_){var Y=_.content.user;Y?(Mr(this.myInfo,zl(Y)),this.core.emit("updateMyNameCard",this.myInfo)):this.logger.warn("onUpdateMyNameCardHandler no user info")},M}(os),Hp=function(){this.__data__=new up,this.size=0},ca=function(M){var L=this.__data__,$=L.delete(M);return this.size=L.size,$},Zs=function(M){return this.__data__.get(M)},hl=function(M){return this.__data__.has(M)},PS=function(M,L){var $=this.__data__;if($ instanceof up){var _=$.__data__;if(!dd||_.length<199)return _.push([M,L]),this.size=++$.size,this;$=this.__data__=new fp(_)}return $.set(M,L),this.size=$.size,this};function vl(w){var M=this.__data__=new up(w);this.size=M.size}vl.prototype.clear=Hp,vl.prototype.delete=ca,vl.prototype.get=Zs,vl.prototype.has=hl,vl.prototype.set=PS;var Ed=vl,AS=function(M,L){for(var $=-1,_=M==null?0:M.length;++$<_;)if(L(M[$],$,M))return!0;return!1},Iy=function(M,L,$,_,Y,Oe){var pe=1&$,At=M.length,jt=L.length;if(At!=jt&&!(pe&&jt>At))return!1;var ur=Oe.get(M),gr=Oe.get(L);if(ur&&gr)return ur==L&&gr==M;var vr=-1,Cr=!0,xr=2&$?new Pg:void 0;for(Oe.set(M,L),Oe.set(L,M);++vr<At;){var Br=M[vr],jr=L[vr];if(_)var zr=pe?_(jr,Br,vr,L,M,Oe):_(Br,jr,vr,M,L,Oe);if(zr!==void 0){if(zr)continue;Cr=!1;break}if(xr){if(!AS(L,function(Hr,Kr){if(!gp(xr,Kr)&&(Br===Hr||Y(Br,Hr,$,_,Oe)))return xr.push(Kr)})){Cr=!1;break}}else if(Br!==jr&&!Y(Br,jr,$,_,Oe)){Cr=!1;break}}return Oe.delete(M),Oe.delete(L),Cr},zp=Ps.Uint8Array,OS=function(M){var L=-1,$=Array(M.size);return M.forEach(function(_,Y){$[++L]=[Y,_]}),$},Ey=Gs?Gs.prototype:void 0,Pd=Ey?Ey.valueOf:void 0,Ad=function(M,L,$,_,Y,Oe,pe){switch($){case"[object DataView]":if(M.byteLength!=L.byteLength||M.byteOffset!=L.byteOffset)return!1;M=M.buffer,L=L.buffer;case"[object ArrayBuffer]":return!(M.byteLength!=L.byteLength||!Oe(new zp(M),new zp(L)));case"[object Boolean]":case"[object Date]":case"[object Number]":return nc(+M,+L);case"[object Error]":return M.name==L.name&&M.message==L.message;case"[object RegExp]":case"[object String]":return M==L+"";case"[object Map]":var At=OS;case"[object Set]":var jt=1&_;if(At||(At=Gr),M.size!=L.size&&!jt)return!1;var ur=pe.get(M);if(ur)return ur==L;_|=2,pe.set(M,L);var gr=Iy(At(M),At(L),_,Y,Oe,pe);return pe.delete(M),gr;case"[object Symbol]":if(Pd)return Pd.call(M)==Pd.call(L)}return!1},Od=function(M,L,$){var _=L(M);return yi(M)?_:Ql(_,$(M))},kh=function(M,L){for(var $=-1,_=M==null?0:M.length,Y=0,Oe=[];++$<_;){var pe=M[$];L(pe,$,M)&&(Oe[Y++]=pe)}return Oe},Nd=function(){return[]},Rd=Object.prototype.propertyIsEnumerable,_h=Object.getOwnPropertySymbols,NS=_h?function(w){return w==null?[]:(w=Object(w),kh(_h(w),function(M){return Rd.call(w,M)}))}:Nd,Bd=NS,Kp=function(M){return Od(M,Cd,Bd)},RS=Object.prototype.hasOwnProperty,Py=function(M,L,$,_,Y,Oe){var pe=1&$,At=Kp(M),jt=At.length;if(jt!=Kp(L).length&&!pe)return!1;for(var ur=jt;ur--;){var gr=At[ur];if(!(pe?gr in L:RS.call(L,gr)))return!1}var vr=Oe.get(M),Cr=Oe.get(L);if(vr&&Cr)return vr==L&&Cr==M;var xr=!0;Oe.set(M,L),Oe.set(L,M);for(var Br=pe;++ur<jt;){var jr=M[gr=At[ur]],zr=L[gr];if(_)var Hr=pe?_(zr,jr,gr,L,M,Oe):_(jr,zr,gr,M,L,Oe);if(!(Hr===void 0?jr===zr||Y(jr,zr,$,_,Oe):Hr)){xr=!1;break}Br||(Br=gr=="constructor")}if(xr&&!Br){var Kr=M.constructor,kn=L.constructor;Kr==kn||!("constructor"in M)||!("constructor"in L)||typeof Kr=="function"&&Kr instanceof Kr&&typeof kn=="function"&&kn instanceof kn||(xr=!1)}return Oe.delete(M),Oe.delete(L),xr},wh=cl(Ps,"DataView"),Wp=cl(Ps,"Promise"),xh=cl(Ps,"WeakMap"),Ih="[object Map]",Jl="[object Promise]",Fd="[object Set]",yl="[object WeakMap]",bl="[object DataView]",BS=Mc(wh),Ay=Mc(dd),FS=Mc(Wp),LS=Mc(jl),Ac=Mc(xh),Ti=yc;(wh&&Ti(new wh(new ArrayBuffer(1)))!=bl||dd&&Ti(new dd)!=Ih||Wp&&Ti(Wp.resolve())!=Jl||jl&&Ti(new jl)!=Fd||xh&&Ti(new xh)!=yl)&&(Ti=function(w){var M=yc(w),L=M=="[object Object]"?w.constructor:void 0,$=L?Mc(L):"";if($)switch($){case BS:return bl;case Ay:return Ih;case FS:return Jl;case LS:return Fd;case Ac:return yl}return M});var us=Ti,zs="[object Arguments]",Gp="[object Array]",Yl="[object Object]",Oy=Object.prototype.hasOwnProperty,Tl=function(M,L,$,_,Y,Oe){var pe=yi(M),At=yi(L),jt=pe?Gp:us(M),ur=At?Gp:us(L),gr=(jt=jt==zs?Yl:jt)==Yl,vr=(ur=ur==zs?Yl:ur)==Yl,Cr=jt==ur;if(Cr&&Lp(M)){if(!Lp(L))return!1;pe=!0,gr=!1}if(Cr&&!gr)return Oe||(Oe=new Ed),pe||dh(M)?Iy(M,L,$,_,Y,Oe):Ad(M,L,jt,$,_,Y,Oe);if(!(1&$)){var xr=gr&&Oy.call(M,"__wrapped__"),Br=vr&&Oy.call(L,"__wrapped__");if(xr||Br){var jr=xr?M.value():M,zr=Br?L.value():L;return Oe||(Oe=new Ed),Y(jr,zr,$,_,Oe)}}return!!Cr&&(Oe||(Oe=new Ed),Py(M,L,$,_,Y,Oe))},Ny=function w(M,L,$,_,Y){return M===L||(M==null||L==null||!hi(M)&&!hi(L)?M!=M&&L!=L:Tl(M,L,$,_,w,Y))},$S=function(M,L,$,_){var Y=$.length,Oe=Y,pe=!_;if(M==null)return!Oe;for(M=Object(M);Y--;){var At=$[Y];if(pe&&At[2]?At[1]!==M[At[0]]:!(At[0]in M))return!1}for(;++Y<Oe;){var jt=(At=$[Y])[0],ur=M[jt],gr=At[1];if(pe&&At[2]){if(ur===void 0&&!(jt in M))return!1}else{var vr=new Ed;if(_)var Cr=_(ur,gr,jt,M,L,vr);if(!(Cr===void 0?Ny(gr,ur,3,_,vr):Cr))return!1}}return!0},Ry=function(M){return M==M&&!fi(M)},Qp=function(M){for(var L=Cd(M),$=L.length;$--;){var _=L[$],Y=M[_];L[$]=[_,Y,Ry(Y)]}return L},Ld=function(M,L){return function($){return $!=null&&$[M]===L&&(L!==void 0||M in Object($))}},Si=function(M){var L=Qp(M);return L.length==1&&L[0][2]?Ld(L[0][0],L[0][1]):function($){return $===M||$S($,M,L)}},$d=function(M,L){return Hg(M)&&Ry(L)?Ld(dl(M),L):function($){var _=As($,M);return _===void 0&&_===L?xd($,M):Ny(L,_,3)}},Oc=function(M){return function(L){return L==null?void 0:L[M]}},Xo=function(M){return function(L){return Wg(L,M)}},lc=function(M){return Hg(M)?Oc(dl(M)):Xo(M)},Xl=function(M){return typeof M=="function"?M:M==null?$l:typeof M=="object"?yi(M)?$d(M[0],M[1]):Si(M):lc(M)},Eh=/\s/,jS=function(M){for(var L=M.length;L--&&Eh.test(M.charAt(L)););return L},DS=/^\s+/,US=function(M){return M&&M.slice(0,jS(M)+1).replace(DS,"")},qS=/^[-+]0x[0-9a-f]+$/i,VS=/^0b[01]+$/i,HS=/^0o[0-7]+$/i,zS=parseInt,KS=function(M){if(typeof M=="number")return M;if(Pp(M))return NaN;if(fi(M)){var L=typeof M.valueOf=="function"?M.valueOf():M;M=fi(L)?L+"":L}if(typeof M!="string")return M===0?M:+M;M=US(M);var $=VS.test(M);return $||HS.test(M)?zS(M.slice(2),$?2:8):qS.test(M)?NaN:+M},Ph=1/0,WS=function(M){return M?(M=KS(M))===Ph||M===-1/0?17976931348623157e292*(M<0?-1:1):M==M?M:0:M===0?M:0},By=function(M){var L=WS(M),$=L%1;return L==L?$?L-$:L:0},GS=Math.max,Ah=function(M,L,$){var _=M==null?0:M.length;if(!_)return-1;var Y=$==null?0:By($);return Y<0&&(Y=GS(_+Y,0)),Cv(M,Xl(L),Y)},QS={"4_12":"syncMsgReceipts","4_14":"syncSessionAck","4_20":"syncSuperTeamSessionAck","4_22":"nimSyncSessionsWithMoreRoaming","4_25":"syncSessionReliableInfo","7_12":"multiSyncMsgReceipt","7_16":"markSessionAck","7_25":"markMultSessionsAck","7_116":"syncMarkSessionAck","21_25":"markSuperTeamSessionAck","21_32":"markMultSuperTeamSessionsAck","21_125":"syncMarkSuperTeamSessionAck","4_23":"nimSyncStickTopSessions","23_12":"nimAddStickTopSession","23_13":"nimDeleteStickTopSession","23_14":"nimUpdateStickTopSession","23_112":"nimMultiSyncAddStickTopSession","23_113":"nimMultiSyncDeleteStickTopSession","23_114":"nimMultiSyncUpdateStickTopSession"},Zl={msgReceiptTag:{to:1,from:2,time:7,idClient:11},stickTopSessionTag:{id:1,ext:2,createTime:3,updateTime:4},sessionAckTag:{scene:1,to:2,timetag:3},sessionReliableSyncTag:{scene:1,sessionId:2,syncStatus:3,syncEndMsgId:4,syncEndMsgidClient:5,syncEndMsgTime:6,syncStartMsgid:7,syncStartMsgidClient:8,syncStartMsgTime:9,nextMsgid:10,nextMsgidClient:11,nextMsgTime:12,roamMsgSync:13,offlineMsgSync:14,netCallOfflineMsgSync:15}},uc=rs(Zl),JS={syncMsgReceipts:{sid:4,cid:12,service:"session",response:[{type:"PropertyArray",name:"msgReceipts",reflectMapper:uc.msgReceiptTag},{type:"Number",name:"timetag"}]},syncSessionAck:{sid:4,cid:14,service:"session",response:[{type:"StrLongMap",name:"p2p"},{type:"LongLongMap",name:"team"},{type:"Number",name:"timetag"}]},syncSuperTeamSessionAck:{sid:4,cid:20,service:"session",response:[{type:"LongLongMap",name:"superTeam"},{type:"Number",name:"timetag"}]},multiSyncMsgReceipt:{sid:7,cid:12,service:"session",response:[{type:"Property",name:"msgReceiptTag",reflectMapper:uc.msgReceiptTag}]},markSessionAck:{sid:7,cid:16,service:"session",params:[{type:"byte",name:"scene"},{type:"String",name:"to"},{type:"long",name:"timetag"}]},syncMarkSessionAck:{sid:7,cid:116,service:"session",response:[{type:"byte",name:"scene"},{type:"String",name:"to"},{type:"long",name:"timetag"}]},syncMarkSuperTeamSessionAck:{sid:21,cid:125,service:"session",response:[{type:"String",name:"to"},{type:"long",name:"timetag"}]},markMultSessionsAck:{sid:7,cid:25,service:"session",ignoreErrCodes:[700],params:[{type:"PropertyArray",name:"datas",reflectMapper:Zl.sessionAckTag}]},markSuperTeamSessionAck:{sid:21,cid:25,service:"session",params:[{type:"long",name:"to"},{type:"long",name:"timetag"}]},nimAddStickTopSession:{sid:23,cid:12,service:"session",params:[{type:"Property",name:"tag",reflectMapper:Zl.stickTopSessionTag}],response:[{type:"Property",name:"data",reflectMapper:uc.stickTopSessionTag}]},nimDeleteStickTopSession:{sid:23,cid:13,service:"session",params:[{type:"Property",name:"tag",reflectMapper:Zl.stickTopSessionTag}],response:[{type:"Number",name:"timetag"}]},nimUpdateStickTopSession:{sid:23,cid:14,service:"session",params:[{type:"Property",name:"tag",reflectMapper:Zl.stickTopSessionTag}],response:[{type:"Property",name:"data",reflectMapper:uc.stickTopSessionTag}]},nimMultiSyncAddStickTopSession:{sid:23,cid:112,service:"session",response:[{type:"Property",name:"data",reflectMapper:uc.stickTopSessionTag}]},nimMultiSyncDeleteStickTopSession:{sid:23,cid:113,service:"session",response:[{type:"Number",name:"timetag"},{type:"Property",name:"data",reflectMapper:uc.stickTopSessionTag}]},nimMultiSyncUpdateStickTopSession:{sid:23,cid:114,service:"session",response:[{type:"Property",name:"data",reflectMapper:uc.stickTopSessionTag}]},nimSyncStickTopSessions:{sid:4,cid:23,service:"session",response:[{type:"Number",name:"timetag"},{type:"Boolean",name:"isThereAnyChange"},{type:"PropertyArray",name:"datas",reflectMapper:uc.stickTopSessionTag}]},markMultSuperTeamSessionsAck:{sid:21,cid:32,service:"session",ignoreErrCodes:[700],params:[{type:"PropertyArray",name:"datas",reflectMapper:Zl.sessionAckTag}]},nimSyncSessionsWithMoreRoaming:{sid:21,cid:22,service:"session",response:[{type:"PropertyArray",name:"datas",reflectMapper:{0:"scene",1:"to",2:"from",7:"time",12:"idServer"}}]},syncSessionReliableInfo:{sid:4,cid:25,service:"session",response:[{type:"Property",name:"context",reflectMapper:{1:"timetag",2:"type"}},{type:"PropertyArray",name:"datas",reflectMapper:uc.sessionReliableSyncTag}]}},YS={id:{type:"string"},ext:{type:"string"},createTime:{type:"number"},updateTime:{type:"number"}};function Jp(w,M,L){L===void 0&&(L=!0);var $=Xs(YS,w);return $.isStickOnTop=L,$.id=M.id,Mr(Mr({},M),{stickTopInfo:M.stickTopInfo?Mr({},M.stickTopInfo,$):$})}var XS={scene:{type:"enum",values:Da},time:{type:"number"}},jd=function(){function w(L){this.core=L}var M=w.prototype;return M.getSession=function($){return this.core.session.getSessionWithUncomplete({id:$})||this.core.session.createSession($)},M.addStickTopSession=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var Y,Oe,pe,At,jt,ur;return ar.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return En({id:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},$),Y=Lo($.id),Oe=Y.scene,pe=Y.accid,vr.next=4,this.core.sendCmd("nimAddStickTopSession",{tag:{id:(Oe==="superTeam"?"super_team":Oe)+"|"+pe,ext:$.ext}});case 4:return At=vr.sent,jt=this.getSession($.id),ur=Jp(At.content.data,jt),vr.abrupt("return",ur);case 8:case"end":return vr.stop()}},_,this)}))},M.deleteStickTopSession=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var Y,Oe,pe,At,jt,ur;return ar.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return En({id:{type:"string",allowEmpty:!1}},$),Y=Lo($.id),Oe=Y.scene,pe=Y.accid,vr.next=4,this.core.sendCmd("nimDeleteStickTopSession",{tag:{id:(Oe==="superTeam"?"super_team":Oe)+"|"+pe}});case 4:return At=vr.sent,jt=this.getSession($.id),ur=Jp({updateTime:At.content.timetag},jt,!1),vr.abrupt("return",ur);case 8:case"end":return vr.stop()}},_,this)}))},M.updateStickTopSession=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var Y,Oe,pe,At,jt,ur;return ar.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return En({id:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},$),Y=Lo($.id),Oe=Y.scene,pe=Y.accid,vr.next=4,this.core.sendCmd("nimUpdateStickTopSession",{tag:{id:(Oe==="superTeam"?"super_team":Oe)+"|"+pe,ext:$.ext}});case 4:return At=vr.sent,jt=this.getSession($.id),ur=Jp(At.content.data,jt),vr.abrupt("return",ur);case 8:case"end":return vr.stop()}},_,this)}))},M.stickTopSessionHandler=function($,_){_===void 0&&(_=!0);var Y=Lo($.id,"|"),Oe=Y.scene+"-"+Y.accid;return Jp($,this.getSession(Oe),_)},w}(),eu=function(){function w(L){this.core=L,this.logger=L.logger}var M=w.prototype;return M.canSessionResetUnreadCount=function($){var _=$.id;if($.lastMsg===void 0)throw new Error("Session::canSessionResetUnreadCount: session "+_+" is not completly, lastMsg undefined");return $.lastMsg!==null||$.unread>0?!($.ack&&$.lastMsg&&$.ack>=$.lastMsg.time)||(this.logger.log("Session::canSessionResetUnreadCount: session "+_+" reset failed, ack time is greater than last message time"),!1):(this.logger.log("Session::canSessionResetUnreadCount: session "+_+" doesn't need to be updated, lastMsg null and unread 0"),!1)},M.filterSessionForResetUnreadCount=function($){var _=this,Y={cmd:"markMultSuperTeamSessionsAck",params:[]},Oe={cmd:"markMultSessionsAck",params:[]};return In($).call($,function(pe){var At;try{if(!_.canSessionResetUnreadCount(pe))return;var jt=Lo(pe.id),ur=jt.accid,gr=jt.scene,vr={to:ur,sessionId:pe.id,timetag:((At=pe==null?void 0:pe.lastMsg)===null||At===void 0?void 0:At.time)||pe.updateTime||0},Cr=function(Br){return Td({scene:{type:"enum",values:Da}},Br)}({scene:gr});gr==="superTeam"?Y.params.push(vr):Oe.params.push(Mr(Mr({},vr),Cr))}catch(xr){_.logger.warn(xr)}}),{superTeam:Y,p2pOrTeam:Oe}},w}(),Oh=function(M,L,$){var _=-1,Y=M.length;L<0&&(L=-L>Y?0:Y+L),($=$>Y?Y:$)<0&&($+=Y),Y=L>$?0:$-L>>>0,L>>>=0;for(var Oe=Array(Y);++_<Y;)Oe[_]=M[_+L];return Oe},ZS=function(M,L,$){if(!fi($))return!1;var _=typeof L;return!!(_=="number"?yp($)&&$p(L,$.length):_=="string"&&L in $)&&nc($[L],M)},eC=Math.ceil,tC=Math.max,Fy=function(M,L,$){L=($?ZS(M,L,$):L===void 0)?1:tC(By(L),0);var _=M==null?0:M.length;if(!_||L<1)return[];for(var Y=0,Oe=0,pe=Array(eC(_/L));Y<_;)pe[Oe++]=Oh(M,Y,Y+=L);return pe};function za(w,M){var L,$=ha!==void 0&&gd(w)||w["@@iterator"];if($)return Oo(L=($=$.call(w)).next).call(L,$);if(gi(w)||($=function(Oe,pe){var At;if(Oe){if(typeof Oe=="string")return la(Oe,pe);var jt=Co(At=Object.prototype.toString.call(Oe)).call(At,8,-1);if(jt==="Object"&&Oe.constructor&&(jt=Oe.constructor.name),jt==="Map"||jt==="Set")return Ep(Oe);if(jt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(jt))return la(Oe,pe)}}(w))||M&&w&&typeof w.length=="number"){$&&(w=$);var _=0;return function(){return _>=w.length?{done:!0}:{done:!1,value:w[_++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function la(w,M){(M==null||M>w.length)&&(M=w.length);for(var L=0,$=new Array(M);L<M;L++)$[L]=w[L];return $}var rC=function(w){function M($,_){var Y;return(Y=w.call(this,"session",$)||this).list=new ec,Y.unreadCountFilterFn=function(Oe){return!0},Y.lastMessageFilterFn=function(Oe){return!0},Y.initEventListeners(),qa({cmdMap:QS,cmdConfig:JS}),typeof(_==null?void 0:_.unreadCountFilterFn)=="function"&&(Y.unreadCountFilterFn=_.unreadCountFilterFn),typeof(_==null?void 0:_.lastMessageFilterFn)=="function"&&(Y.lastMessageFilterFn=_.lastMessageFilterFn),Y.stickTopService=new jd($),Y.unreadModule=new eu($),Y}Ro(M,w);var L=M.prototype;return L.initEventListeners=function(){var _,Y,Oe,pe=this;this.core.eventBus.on("session/syncMsgs",Oo(_=this.onSyncMsgs).call(_,this)),this.core.eventBus.on("session/updateForNewMsg",Oo(Y=this.updateSessionWithMsg).call(Y,this)),this.core.eventBus.on("session/updateForClearMsg",function(At,jt){jt===void 0&&(jt=!0),At&&At.length>0&&In(At).call(At,function(ur){pe.updateSession({id:ur.sessionId,lastMsg:null,unread:0,unreadMsgs:[]},jt)})}),this.core.eventBus.on("session/updateForDeletedMsg",Oo(Oe=this.updateSessionForDeletedMsg).call(Oe,this))},L.createSession=function(_,Y){try{var Oe=Lo(_);return{id:_,scene:Oe.scene,to:Oe.accid,lastMsg:Y,updateTime:Y?Y.time:0,unread:0,unreadMsgs:[],ack:0}}catch(pe){throw this.logger.error("Failed to create session with "+_,pe),new Error("Failed to create session with "+_)}},L.getSession=function(_){En({id:{type:"string",allowEmpty:!1}},_);var Y=this.list.get(_.id);if(this.isSessionComplete(Y))return Y},L.getSessionWithUncomplete=function(_){return this.list.get(_.id)},L.getAllSessions=function(){for(var _,Y=[],Oe=za(this.list);!(_=Oe()).done;){var pe=_.value;pe[0];var At=pe[1];this.isSessionComplete(At)&&Y.push(At)}return Y},L.getSessions=function(_){En({limit:{type:"number",required:!1},lastSessionId:{type:"string",allowEmpty:!1,required:!1},desc:{type:"boolean",required:!1}},_);var Y=[],Oe=_.limit,pe=Oe===void 0?100:Oe,At=_.desc,jt=At===void 0||At,ur=_.lastSessionId,gr=0;if(jt){for(var vr,Cr,xr=za(this.list);!(Cr=xr()).done;){var Br=Cr.value,jr=Br[0],zr=Br[1];if(ur===jr)break;this.isSessionComplete(zr)&&Y.push(zr)}return kl(vr=Co(Y).call(Y,-pe)).call(vr)}for(var Hr,Kr=za(this.list);!(Hr=Kr()).done;){var kn=Hr.value,Jn=kn[0],Hn=kn[1];if(ur)Jn===ur&&(ur=void 0);else if(this.isSessionComplete(Hn)){if(++gr>pe)break;Y.push(Hn)}}return Y},L.resetSessionUnreadCount=function(_){var Y,Oe;return Sn(this,void 0,void 0,ar.mark(function pe(){var At,jt,ur,gr,vr,Cr,xr,Br,jr=this;return ar.wrap(function(Hr){for(;;)switch(Hr.prev=Hr.next){case 0:if(!((Y=this.core.sync)===null||Y===void 0)&&Y.getSyncDoneFlag()||this.logger.warn("Please call resetSessionUnreadCount after syncdone event"),En({id:{type:"string",allowEmpty:!1}},_),En({id:{type:"string",allowEmpty:!1}},_),At=_.id,jt=this.list.get(At)){Hr.next=8;break}throw this.logger.warn("resetSessionUnreadCount: can not find session "+At),new Error("Session::canSessionResetUnreadCount: can not find session "+At);case 8:ur=!1;try{ur=this.unreadModule.canSessionResetUnreadCount(jt)}catch(Kr){this.logger.warn(Kr)}if(ur!==!1){Hr.next=12;break}return Hr.abrupt("return");case 12:return gr=Lo(At),vr=gr.accid,Cr=gr.scene,xr={to:vr,timetag:((Oe=jt==null?void 0:jt.lastMsg)===null||Oe===void 0?void 0:Oe.time)||jt.updateTime||0},Br="markSuperTeamSessionAck",Cr!=="superTeam"&&(xr.scene=Cr==="p2p"?0:1,Br="markSessionAck"),Hr.abrupt("return",this.core.sendCmd(Br,xr).then(function(){var Kr=jr.storeUnreadByAck(At,xr.timetag);Kr&&jr.core.emit("updateSession",Kr)}));case 17:case"end":return Hr.stop()}},pe,this)}))},L.resetMultiSessionUnreadCount=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt,ur,gr,vr,Cr,xr,Br,jr,zr,Hr,Kr,kn,Jn=this;return ar.wrap(function(xo){for(;;)switch(xo.prev=xo.next){case 0:!((Y=this.core.sync)===null||Y===void 0)&&Y.getSyncDoneFlag()||this.logger.warn("Please call resetMultiSessionUnreadCount after syncdone event"),En({ids:{type:"array",itemType:"string",min:1}},_),jt=is(pe=To(At=_.ids).call(At,function(Ln){return Jn.list.get(Ln)})).call(pe,function(Ln,_r){return!!Ln||(Jn.logger.warn("Session::canSessionResetUnreadCount: can not find session "+_.ids[_r]),!1)}),ur=this.unreadModule.filterSessionForResetUnreadCount(jt),gr=ur.superTeam,vr=ur.p2pOrTeam,Cr=Fy(gr.params,10),xr=Fy(vr.params,10),Br=za(Cr);case 7:if((jr=Br()).done){xo.next=14;break}return zr=jr.value,xo.next=11,this.core.sendCmd(gr.cmd,{datas:zr});case 11:In(zr).call(zr,function(Ln){var _r=Jn.storeUnreadByAck(Ln.sessionId,Ln.timetag);_r&&Jn.core.emit("updateSession",_r)});case 12:xo.next=7;break;case 14:Hr=za(xr);case 15:if((Kr=Hr()).done){xo.next=22;break}return kn=Kr.value,xo.next=19,this.core.sendCmd(vr.cmd,{datas:kn});case 19:In(kn).call(kn,function(Ln){var _r=Jn.storeUnreadByAck(Ln.sessionId,Ln.timetag);_r&&Jn.core.emit("updateSession",_r)});case 20:xo.next=15;break;case 22:case"end":return xo.stop()}},Oe,this)}))},L.resetAllSessionsUnreadCount=function(){var _,Y;!((Y=this.core.sync)===null||Y===void 0)&&Y.getSyncDoneFlag()||this.logger.warn("Please call resetAllSessionsUnreadCount after syncdone event");var Oe=[];return In(_=this.list).call(_,function(pe){Oe.push(pe.id)}),this.resetMultiSessionUnreadCount({ids:Oe})},L.deleteSession=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(En({id:{type:"string",allowEmpty:!1},isSyncToServer:{type:"boolean",required:!1}},_),this.list.delete(_.id),!this.core.msgLog||!_.isSyncToServer){pe.next=5;break}return pe.next=5,this.core.msgLog.deleteRoamingMsgs({ids:[_.id]});case 5:case"end":return pe.stop()}},Y,this)}))},L.deleteAllSessionsFromLocal=function(){this.list.clear()},L.addStickTopSession=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return At.next=2,this.stickTopService.addStickTopSession(_);case 2:return Oe=At.sent,this.list.set(Oe.id,Oe),At.abrupt("return",Oe);case 5:case"end":return At.stop()}},Y,this)}))},L.deleteStickTopSession=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return At.next=2,this.stickTopService.deleteStickTopSession(_);case 2:return Oe=At.sent,this.list.set(Oe.id,Oe),At.abrupt("return",Oe);case 5:case"end":return At.stop()}},Y,this)}))},L.updateStickTopSession=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return At.next=2,this.stickTopService.updateStickTopSession(_);case 2:return Oe=At.sent,this.list.set(Oe.id,Oe),At.abrupt("return",Oe);case 5:case"end":return At.stop()}},Y,this)}))},L.nimMultiSyncAddStickTopSessionHandler=function(_){var Y=this.stickTopService.stickTopSessionHandler(_.content.data);this.list.set(Y.id,Y),this.core.emit("updateSession",Y)},L.nimMultiSyncDeleteStickTopSessionHandler=function(_){var Y=this.stickTopService.stickTopSessionHandler({id:_.content.data.id,updateTime:_.content.timetag},!1);this.list.set(Y.id,Y),this.core.emit("updateSession",Y)},L.nimMultiSyncUpdateStickTopSessionHandler=function(_){var Y=this.stickTopService.stickTopSessionHandler(_.content.data);this.list.set(Y.id,Y),this.core.emit("updateSession",Y)},L.nimSyncStickTopSessionsHandler=function(_){var Y=this,Oe=_.content.datas;In(Oe).call(Oe,function(pe){var At=Y.stickTopService.stickTopSessionHandler(pe);Y.list.set(At.id,At)})},L.updateSessionWithMsg=function(_){var Y=!0,Oe=!0;try{Y=!!this.unreadCountFilterFn(_)}catch(ur){this.logger.error("session:updateSessionWithMsg, unreadCountFilterFn error",ur)}try{Oe=!!this.lastMessageFilterFn(_)}catch(ur){this.logger.error("session:updateSessionWithMsg, lastMessageFilterFn error",ur)}var pe=this.list.get(_.sessionId)||this.createSession(_.sessionId),At=!1;if(this.logger.log("session:updateSessionWithMsg, pending ",_.sessionId,_.idClient,_.idServer,Oe,Y),Oe&&(!pe.lastMsg||pe.lastMsg.time<_.time||_.status===va[va.sending]||pe.lastMsg.status===va[va.sending])&&(pe.lastMsg=_,pe.updateTime=_.time,At=!0),Y&&_.status===va[va.unread]&&_.time>(pe.ack||0)){pe.unread++;var jt=pe.unreadMsgs||[];jt.unshift(_),wc(jt).call(jt,function(ur,gr){return gr.time-ur.time}),At=!0}At&&(this.logger.log("session:updateSessionWithMsg updating ",pe.id,pe.unread,pe.lastMsg&&pe.lastMsg.idClient),this.list.set(pe.id,pe),this.core.emit("updateSession",pe))},L.storeUnreadByAck=function(_,Y){var Oe=this.list.get(_)||this.createSession(_);if(!(Oe.ack&&Y<Oe.ack)){var pe=Oe.unreadMsgs||[],At=[],jt=0;return Oe.unreadMsgs=[],pe.length>0&&(In(pe).call(pe,function(ur){ur.time>Y&&(jt++,At.push(ur))}),Oe.unreadMsgs=wc(At).call(At,function(ur,gr){return gr.time-ur.time})),Oe.ack=Y,Oe.unread=jt,Oe.lastMsg&&Oe.lastMsg.status==="unread"&&Y>=Oe.lastMsg.time&&(Oe.lastMsg.status="read"),this.list.set(_,Oe),Oe}this.logger.warn("storeUnreadByAck: not need update ack",_,Y,Oe.ack)},L.updateSession=function(_,Y){Y===void 0&&(Y=!0);var Oe=_.id,pe=this.list.get(Oe)||this.createSession(_.id),At=Mr(pe,_);return this.list.set(Oe,At),this.logger.log("updateSession: update",Y,Id(_,["id","ack","unread"]),At.lastMsg&&At.lastMsg.idClient),Y&&this.core.emit("updateSession",At),At},L.isSessionComplete=function(_){return!!_&&!!(_.id&&_.scene&&_.to)&&_.lastMsg!==void 0},L.syncSessionAckHandler=function(_){var Y,Oe,pe=this,At=_.content.p2p||{},jt=_.content.team.m_map||{};this.logger.log("syncSessionAck::",At,jt),In(Y=Vo(At)).call(Y,function(ur){pe.updateSession({id:"p2p-"+ur,ack:At[ur]},!1)}),In(Oe=Vo(jt)).call(Oe,function(ur){pe.updateSession({id:"team-"+ur,ack:jt[ur]},!1)})},L.syncSuperTeamSessionAckHandler=function(_){var Y,Oe=this,pe=_.content.superTeam.m_map;this.logger.log("syncSuperTeamSessionAck::",pe),In(Y=Vo(pe)).call(Y,function(At){Oe.updateSession({id:"superTeam-"+At,ack:pe[At]},!1)})},L.syncMarkSessionAckHandler=function(_){var Y=_.content,Oe=(Y.scene===0?"p2p":Y.scene===1?"team":"superTeam")+"-"+Y.to,pe=this.list.get(Oe);if(pe&&pe.ack&&Y.timetag<pe.ack)this.logger.warn("syncMarkSessionAckHandler: "+Oe+" do not need update ack",pe.ack,Y.timetag);else{var At=this.storeUnreadByAck(Oe,Y.timetag);At&&this.core.emit("updateSession",At)}},L.syncMarkSuperTeamSessionAckHandler=function(_){_.content.scene=5,this.syncMarkSessionAckHandler(_)},L.onSyncDone=function(){var _,Y,Oe,pe=this,At=[];In(_=this.list).call(_,function(jt,ur){At.push(pe.storeUnreadByAck(ur,jt.ack||0))}),this.list.clear(),In(Y=wc(At).call(At,function(jt,ur){return jt.updateTime-ur.updateTime})).call(Y,function(jt){pe.list.set(jt.id,jt)}),(At=wc(Oe=is(At).call(At,function(jt){return pe.isSessionComplete(jt)})).call(Oe,function(jt,ur){return ur.updateTime-jt.updateTime})).length>0&&this.core.emit("sessions",At)},L.onSyncMsgs=function(_){var Y,Oe=this,pe=this.list.get(_.sessionId),At=[];try{var jt;At=is(jt=_.msgs).call(jt,function(xr){return Oe.unreadCountFilterFn(JSON.parse(Wo(xr)))})}catch(xr){this.logger.error("session:onSyncMsgs, unreadCountFilterFn error ",xr)}var ur,gr=[];try{var vr;gr=is(vr=_.msgs).call(vr,function(xr){return Oe.lastMessageFilterFn(JSON.parse(Wo(xr)))})}catch(xr){this.logger.error("session:onSyncMsgs, lastMessageFilterFn error ",xr)}gr&&gr.length>0&&(ur=gr[gr.length-1],ur=gr[0].time>ur.time?gr[0]:ur);var Cr=ur?ur.time:0;pe||(pe=ur?this.createSession(_.sessionId,ur):this.createSession(_.sessionId)),pe.unreadMsgs=pe.unreadMsgs?is(Y=ks(At).call(At,pe.unreadMsgs)).call(Y,function(xr){return xr.status===va[va.unread]}):is(At).call(At,function(xr){return xr.status===va[va.unread]}),pe.updateTime&&pe.updateTime>=Cr||(pe.updateTime=Cr),pe.lastMsg&&pe.lastMsg.time>=Cr||(pe.lastMsg=ur),this.list.set(pe.id,pe)},L.updateSessionForDeletedMsg=function(_){var Y,Oe=this,pe={};In(_).call(_,function(At){var jt=At.to===Oe.core.account?At.from:At.to,ur=At.scene+"-"+jt,gr=Oe.list.get(ur);if(gr){if((gr.ack||0)<At.time&&At.from!==Oe.core.account&&gr.unread>0&&(gr.unread=gr.unread-1,gr.unreadMsgs&&gr.unreadMsgs.length>0)){var vr,Cr=Ah(gr.unreadMsgs,{idClient:At.idClient});Cr>=0&&qg(vr=gr.unreadMsgs).call(vr,Cr,1)}gr.lastMsg&&gr.lastMsg.idClient===At.idClient&&(gr.lastMsg=null),pe[gr.id]=!0}}),In(Y=Vo(pe)).call(Y,function(At){var jt=Oe.list.get(At);jt&&Oe.core.emit("updateSession",jt)})},L.multiSyncMsgReceiptHandler=function(_){var Y,Oe=(Y=_.content)===null||Y===void 0?void 0:Y.msgReceiptTag;if(Oe){this.updateSessionMsgReceiptTime([Oe],!0),Oe.msgReceiptTime=Oe.time,Oe.sessionId="p2p-"+Oe.from,Oe.time,Oe.from;var pe=Es(Oe,["time","from"]);this.core.emit("msgReceipts",[pe])}},L.syncMsgReceiptsHandler=function(_){var Y,Oe=(Y=_.content)===null||Y===void 0?void 0:Y.msgReceipts;Oe&&this.updateSessionMsgReceiptTime(Oe,!1)},L.updateSessionMsgReceiptTime=function(_,Y){var Oe=this;Y===void 0&&(Y=!0),_&&_.length>0&&In(_).call(_,function(pe){var At=Oe.list.get("p2p-"+pe.from);At||(At=Oe.createSession("p2p-"+pe.from));var jt=_o(pe.time);At.msgReceiptTime&&At.msgReceiptTime>=jt||(At.msgReceiptTime=jt,At.lastMsg&&At.lastMsg.status==="sent"&&jt>=At.lastMsg.time&&(At.lastMsg.status="receipt"),Oe.logger.log("session: update session "+At.id+" msgReceiptTime: "+At.msgReceiptTime),Oe.list.set(At.id,At),Y&&Oe.core.emit("updateSession",At))})},L.nimSyncSessionsWithMoreRoamingHandler=function(_){var Y=function(pe,At){return To(pe).call(pe,function(jt){var ur=Xs(XS,jt);return ur.sessionId=bi(jt,At),ur})}(_.content.datas,this.core.account);this.logger.log("session:syncSessionsWithMoreRoaming",Y)},M}(os),nC=function(){function w(L){this.core=L}var M=w.prototype;return M.notifyAddTeamMembers=function($,_){this.core.emit("addTeamMembers",{team:$,accounts:_,members:bS($,_)})},M.notifyUpdateTeamManagers=function($,_,Y,Oe){this.core.emit("updateTeamManagers",{team:{teamId:$,memberUpdateTime:Oe},accounts:_,isManager:Y,members:To(_).call(_,function(pe){return{id:$+"-"+pe,account:pe,type:"manager",updateTime:Oe}})})},M.notifyRemoveTeamMembers=function($,_){this.core.emit("removeTeamMembers",{team:$,accounts:_})},M.notifyTransferTeam=function($,_,Y){this.core.emit("transferTeam",{team:$,from:{id:$.teamId+"-"+_,type:"normal",account:_,updateTime:$.memberUpdateTime},to:{id:$.teamId+"-"+Y,type:"owner",account:Y,updateTime:$.memberUpdateTime}})},M.notifyUpdateTeamMembersMute=function($,_,Y){this.core.emit("updateTeamMembersMute",{team:$,accounts:_,members:To(_).call(_,function(Oe){return{id:$.teamId+"-"+Oe,account:Oe,teamId:$.teamId,mute:Y,updateTime:$.memberUpdateTime}}),mute:Y})},w}(),oC=function(M,L){for(var $=-1,_=M==null?0:M.length;++$<_&&L(M[$],$,M)!==!1;);return M},Yp=function(M,L,$,_){var Y=!$;$||($={});for(var Oe=-1,pe=L.length;++Oe<pe;){var At=L[Oe],jt=_?_($[At],M[At],At,$,M):void 0;jt===void 0&&(jt=M[At]),Y?Gl($,At,jt):Vp($,At,jt)}return $},aC=function(M,L){return M&&Yp(L,Cd(L),M)},dc=function(M){var L=[];if(M!=null)for(var $ in Object(M))L.push($);return L},Os=Object.prototype.hasOwnProperty,Xp=function(M){if(!fi(M))return dc(M);var L=fl(M),$=[];for(var _ in M)(_!="constructor"||!L&&Os.call(M,_))&&$.push(_);return $},Nh=function(M){return yp(M)?ay(M,!0):Xp(M)},ds=function(M,L){return M&&Yp(L,Nh(L),M)},fa=o(function(w,M){var L=M&&!M.nodeType&&M,$=L&&w&&!w.nodeType&&w,_=$&&$.exports===L?Ps.Buffer:void 0,Y=_?_.allocUnsafe:void 0;w.exports=function(pe,At){if(At)return pe.slice();var jt=pe.length,ur=Y?Y(jt):new pe.constructor(jt);return pe.copy(ur),ur}}),sC=function(M,L){var $=-1,_=M.length;for(L||(L=Array(_));++$<_;)L[$]=M[$];return L},Ly=function(M,L){return Yp(M,Bd(M),L)},Zp=Object.getOwnPropertySymbols?function(w){for(var M=[];w;)Ql(M,Bd(w)),w=ah(w);return M}:Nd,Rh=function(M,L){return Yp(M,Zp(M),L)},$y=function(M){return Od(M,Nh,Zp)},jy=Object.prototype.hasOwnProperty,Dd=function(M){var L=M.length,$=new M.constructor(L);return L&&typeof M[0]=="string"&&jy.call(M,"index")&&($.index=M.index,$.input=M.input),$},ef=function(M){var L=new M.constructor(M.byteLength);return new zp(L).set(new zp(M)),L},Bh=function(M,L){var $=L?ef(M.buffer):M.buffer;return new M.constructor($,M.byteOffset,M.byteLength)},Dy=/\w*$/,_s=function(M){var L=new M.constructor(M.source,Dy.exec(M));return L.lastIndex=M.lastIndex,L},Uy=Gs?Gs.prototype:void 0,Fh=Uy?Uy.valueOf:void 0,iC=function(M){return Fh?Object(Fh.call(M)):{}},cC=function(M,L){var $=L?ef(M.buffer):M.buffer;return new M.constructor($,M.byteOffset,M.length)},lC=function(M,L,$){var _=M.constructor;switch(L){case"[object ArrayBuffer]":return ef(M);case"[object Boolean]":case"[object Date]":return new _(+M);case"[object DataView]":return Bh(M,$);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return cC(M,$);case"[object Map]":case"[object Set]":return new _;case"[object Number]":case"[object String]":return new _(M);case"[object RegExp]":return _s(M);case"[object Symbol]":return iC(M)}},qy=Object.create,uC=function(){function w(){}return function(M){if(!fi(M))return{};if(qy)return qy(M);w.prototype=M;var L=new w;return w.prototype=void 0,L}}(),dC=function(M){return typeof M.constructor!="function"||fl(M)?{}:uC(ah(M))},pC=function(M){return hi(M)&&us(M)=="[object Map]"},Lh=cs&&cs.isMap,fC=Lh?Al(Lh):pC,mC=function(M){return hi(M)&&us(M)=="[object Set]"},Vy=cs&&cs.isSet,$h=Vy?Al(Vy):mC,Hy="[object Arguments]",jh="[object Function]",ws="[object Object]",ba={};ba[Hy]=ba["[object Array]"]=ba["[object ArrayBuffer]"]=ba["[object DataView]"]=ba["[object Boolean]"]=ba["[object Date]"]=ba["[object Float32Array]"]=ba["[object Float64Array]"]=ba["[object Int8Array]"]=ba["[object Int16Array]"]=ba["[object Int32Array]"]=ba["[object Map]"]=ba["[object Number]"]=ba[ws]=ba["[object RegExp]"]=ba["[object Set]"]=ba["[object String]"]=ba["[object Symbol]"]=ba["[object Uint8Array]"]=ba["[object Uint8ClampedArray]"]=ba["[object Uint16Array]"]=ba["[object Uint32Array]"]=!0,ba["[object Error]"]=ba[jh]=ba["[object WeakMap]"]=!1;var gC=function w(M,L,$,_,Y,Oe){var pe,At=1&L,jt=2&L,ur=4&L;if($&&(pe=Y?$(M,_,Y,Oe):$(M)),pe!==void 0)return pe;if(!fi(M))return M;var gr=yi(M);if(gr){if(pe=Dd(M),!At)return sC(M,pe)}else{var vr=us(M),Cr=vr==jh||vr=="[object GeneratorFunction]";if(Lp(M))return fa(M,At);if(vr==ws||vr==Hy||Cr&&!Y){if(pe=jt||Cr?{}:dC(M),!At)return jt?Rh(M,ds(pe,M)):Ly(M,aC(pe,M))}else{if(!ba[vr])return Y?M:{};pe=lC(M,vr,At)}}Oe||(Oe=new Ed);var xr=Oe.get(M);if(xr)return xr;Oe.set(M,pe),$h(M)?M.forEach(function(jr){pe.add(w(jr,L,$,jr,M,Oe))}):fC(M)&&M.forEach(function(jr,zr){pe.set(zr,w(jr,L,$,zr,M,Oe))});var Br=gr?void 0:(ur?jt?$y:Kp:jt?Nh:Cd)(M);return oC(Br||M,function(jr,zr){Br&&(jr=M[zr=jr]),Vp(pe,zr,w(jr,L,$,zr,M,Oe))}),pe},Nc,pc,fc=function(M){return gC(M,5)},hC=function(w){function M($){var _;return(_=w.call(this,"team",$)||this).myTeamMembersMap=new ec,_.service=new nC($),_.core.eventBus.on("team/onNotification",function(Y){return _.notificationHandler(Y)}),qa({cmdMap:vy,cmdConfig:yy}),_}Ro(M,w);var L=M.prototype;return L.mergeMyTeamMembers=function(_){var Y=this;In(_).call(_,function(Oe){var pe=Oe.teamId,At=Y.myTeamMembersMap.get(pe),jt=Mr({},At,Oe);Y.myTeamMembersMap.set(pe,jt)})},L.getTeamInfo=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_),jt.next=3,this.core.sendCmd("getTeamInfo",{teamId:_.teamId});case 3:return Oe=jt.sent,pe=Oe.content.team,jt.abrupt("return",xc(pe));case 6:case"end":return jt.stop()}},Y,this)}))},L.getTeams=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var Y,Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return At.next=2,this.core.sendCmd("getTeams",{timetag:0});case 2:return Y=At.sent,Oe=Y.content.teams,At.abrupt("return",vh(Oe));case 5:case"end":return At.stop()}},_,this)}))},L.getTeamsById=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return En({teamIds:{type:"array",itemType:"string"}},_),jt.next=3,this.core.sendCmd("getTeamsById",{teamIds:_.teamIds});case 3:return Oe=jt.sent,pe=vh(Oe.content.teams),jt.abrupt("return",{teams:pe,tids:Oe.content.tids});case 6:case"end":return jt.stop()}},Y,this)}))},L.createTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({type:{type:"enum",values:["advanced","normal"]},name:{type:"string",allowEmpty:!1},level:{type:"number",required:!1},accounts:{type:"array",itemType:"string",required:!1},ps:{type:"string",allowEmpty:!1,max:5e3,required:!1},joinMode:{type:"enum",values:["noVerify","needVerify","rejectAll"],required:!1},beInviteMode:{type:"enum",values:["noVerify","needVerify"],required:!1},inviteMode:{type:"enum",values:["manager","all"],required:!1},updateTeamMode:{type:"enum",values:["manager","all"],required:!1},updateExtMode:{type:"enum",values:["manager","all"],required:!1},intro:{type:"string",allowEmpty:!1,required:!1},announcement:{type:"string",allowEmpty:!1,required:!1},avatar:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",allowEmpty:!1,required:!1}},_),Oe=yh(_),ur.next=4,this.core.sendCmd("createTeam",{team:Oe,accounts:_.accounts||[],ps:_.ps||""});case 4:return pe=ur.sent,At=xc(pe.content.team),ur.abrupt("return",At);case 7:case"end":return ur.stop()}},Y,this)}))},L.dismissTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_),pe.next=3,this.core.sendCmd("dismissTeam",{teamId:_.teamId});case 3:case"end":return pe.stop()}},Y,this)}))},L.leaveTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_),pe.next=3,this.core.sendCmd("leaveTeam",{teamId:_.teamId});case 3:case"end":return pe.stop()}},Y,this)}))},L.transferTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},leave:{type:"boolean"}},_),pe.next=3,this.core.sendCmd("transferTeam",_);case 3:case"end":return pe.stop()}},Y,this)}))},L.updateTeamInfo=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},joinMode:{type:"enum",values:["noVerify","needVerify","rejectAll"],required:!1},beInviteMode:{type:"enum",values:["noVerify","needVerify"],required:!1},inviteMode:{type:"enum",values:["manager","all"],required:!1},updateTeamMode:{type:"enum",values:["manager","all"],required:!1},updateExtMode:{type:"enum",values:["manager","all"],required:!1},intro:{type:"string",allowEmpty:!1,required:!1},announcement:{type:"string",allowEmpty:!1,required:!1},avatar:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",allowEmpty:!1,required:!1}},_),Oe=yh(_),At.next=4,this.core.sendCmd("updateTeamInfo",{team:Oe});case 4:return At.abrupt("return",xc(Oe));case 5:case"end":return At.stop()}},Y,this)}))},L.getTeamMembers=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",required:!1}},_),ur.next=3,this.core.sendCmd("getTeamMembers",{teamId:_.teamId,timetag:0});case 3:if(pe=ur.sent,At=Dp((Y=pe.content)===null||Y===void 0?void 0:Y.teamMembers),_.accounts&&_.accounts.length>0){ur.next=7;break}return ur.abrupt("return",At);case 7:return ur.abrupt("return",is(At).call(At,function(gr){var vr;return(vr=_.accounts)===null||vr===void 0?void 0:bc(vr).call(vr,gr.account)}));case 8:case"end":return ur.stop()}},Oe,this)}))},L.getMutedTeamMembers=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_),jt.next=3,this.core.sendCmd("getMutedTeamMembers",{teamId:_.teamId});case 3:return Oe=jt.sent,pe=Oe.content,jt.abrupt("return",Dp(pe.teamMembers));case 6:case"end":return jt.stop()}},Y,this)}))},L.addTeamMembers=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},_),pe.next=3,this.core.sendCmd("addTeamMembers",{teamId:_.teamId,accounts:_.accounts,ps:_.ps||"",attach:_.ext||""});case 3:case"end":return pe.stop()}},Y,this)}))},L.removeTeamMembers=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1}},_),pe.next=3,this.core.sendCmd("removeTeamMembers",{teamId:_.teamId,accounts:_.accounts});case 3:case"end":return pe.stop()}},Y,this)}))},L.applyTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},_),At.next=3,this.core.sendCmd("applyTeam",{teamId:_.teamId,ps:_.ps||""});case 3:return Oe=At.sent,At.abrupt("return",xc(Oe.content.team));case 5:case"end":return At.stop()}},Y,this)}))},L.addTeamManagers=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},_),pe.next=3,this.core.sendCmd("addTeamManagers",_);case 3:case"end":return pe.stop()}},Y,this)}))},L.removeTeamManagers=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},_),pe.next=3,this.core.sendCmd("removeTeamManagers",_);case 3:case"end":return pe.stop()}},Y,this)}))},L.updateMyMemberInfo=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1,required:!1},bitConfigMask:{type:"number",min:0,max:2,required:!1},ext:{type:"string",required:!1}},_),Oe=gy({teamId:_.teamId,nickInTeam:_.nickInTeam,bitConfigMask:_.bitConfigMask,ext:_.ext}),ur.next=4,this.core.sendCmd("updateMyMemberInfo",{teamMember:Oe});case 4:return pe=kd(Mr({updateTime:new Date().getTime(),account:this.core.account},Oe)),this.mergeMyTeamMembers([pe]),this.core.emit("updateTeamMember",pe),At=fc(this.myTeamMembersMap.get(pe.teamId)),this.core.emit("myTeamMembers",[At]),ur.abrupt("return",pe);case 10:case"end":return ur.stop()}},Y,this)}))},L.updateMemberNick=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1}},_),Oe=gy({teamId:_.teamId,nickInTeam:_.nickInTeam,account:_.account}),jt.next=4,this.core.sendCmd("updateNickInTeam",{teamMember:Oe});case 4:return pe=kd(Mr({updateTime:new Date().getTime()},Oe)),jt.abrupt("return",pe);case 6:case"end":return jt.stop()}},Y,this)}))},L.muteTeamMember=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},mute:{type:"boolean"}},_),pe.next=3,this.core.sendCmd("muteTeamMember",{teamId:_.teamId,account:_.account,mute:_.mute?1:0});case 3:case"end":return pe.stop()}},Y,this)}))},L.getTeamMemberInvitorAccid=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",max:200}},_),pe={teamId:_.teamId},_.accounts&&_.accounts.length>0&&(pe.accounts=_.accounts),ur.next=5,this.core.sendCmd("getTeamMemberInvitorAccid",pe);case 5:return At=ur.sent,ur.abrupt("return",((Y=At.content)===null||Y===void 0?void 0:Y.accountsMap)||{});case 7:case"end":return ur.stop()}},Oe,this)}))},L.muteTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},mute:{type:"boolean"}},_),pe.next=3,this.core.sendCmd("muteTeam",{teamId:_.teamId,mute:_.mute?1:0});case 3:case"end":return pe.stop()}},Y,this)}))},L.passTeamApply=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},_),pe.next=3,this.core.sendCmd("passTeamApply",_);case 3:case"end":return pe.stop()}},Y,this)}))},L.rejectTeamApply=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},_),pe.next=3,this.core.sendCmd("rejectTeamApply",{teamId:_.teamId,from:_.from,ps:_.ps||""});case 3:case"end":return pe.stop()}},Y,this)}))},L.acceptTeamInvite=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},_),pe.next=3,this.core.sendCmd("acceptTeamInvite",_);case 3:case"end":return pe.stop()}},Y,this)}))},L.rejectTeamInvite=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},_),pe.next=3,this.core.sendCmd("rejectTeamInvite",{teamId:_.teamId,from:_.from,ps:_.ps||""});case 3:case"end":return pe.stop()}},Y,this)}))},L.notifyTeamMsgReceiptsHandler=function(_){var Y,Oe=(Y=_.content)===null||Y===void 0?void 0:Y.teamMsgReceipts;Oe&&Oe.length>0&&(this.core.emit("teamMsgReceipts",Oe),this.core.emit("msgReceipts",Oe))},L.syncTeamsHandler=function(_){var Y=_.content;this.core.eventBus.emit("sync/updateTimetag",{teams:_o(Y.timetag)});var Oe=Y==null?void 0:Y.teams;if(Oe&&Oe.length){var pe=vh(Oe);this.core.emit("teams",pe)}},L.syncCreateTeamHandler=function(_){var Y=_.content,Oe=xc(Y==null?void 0:Y.team),pe=hy(Oe,Oe.owner,"owner");this.core.emit("createTeam",Oe,pe)},L.syncUpdateTeamMemberHandler=function(_){var Y=_.content,Oe=kd(Y==null?void 0:Y.teamMember);Oe.updateTime||(Oe.updateTime=new Date().getTime()),this.mergeMyTeamMembers([Oe]),this.core.emit("updateTeamMember",Oe);var pe=fc(this.myTeamMembersMap.get(Oe.teamId));this.core.emit("myTeamMembers",[pe])},L.syncMyTeamMembersHandler=function(_){var Y,Oe=_.content;this.core.eventBus.emit("sync/updateTimetag",{myTeamMembers:_o(Oe.timetag)});var pe=Oe==null?void 0:To(Y=Oe.teamMembers).call(Y,function(At){return kd(At)});this.mergeMyTeamMembers(pe),this.core.emit("myTeamMembers",fc(pe))},L.notificationHandler=function(_){var Y=_.attach,Oe=_.scene,pe=_.from,At=_.to,jt=_.time,ur=_.idServer,gr=_.idClient,vr=Y.team,Cr=Y.account,xr=Y.accounts,Br=Y.type;if(Oe==="team")switch(this.core.options.debugLevel==="debug"?this.logger.debug("team::recvNotification",ur,gr,Y):this.logger.log("team::recvNotification",ur,gr,At,Br,Cr,xr),Br){case"updateTeam":vr.updateTime=jt,this.core.emit("updateTeam",vr);break;case"addTeamMembers":this.service.notifyAddTeamMembers(vr,xr);break;case"acceptTeamInvite":this.service.notifyAddTeamMembers(vr,[pe]);break;case"passTeamApply":this.service.notifyAddTeamMembers(vr,[Cr]);break;case"addTeamManagers":this.service.notifyUpdateTeamManagers(At,xr,!0,jt);break;case"removeTeamManagers":this.service.notifyUpdateTeamManagers(At,xr,!1,jt);break;case"removeTeamMembers":this.service.notifyRemoveTeamMembers(vr,xr);break;case"leaveTeam":this.service.notifyRemoveTeamMembers(vr,[pe]);break;case"dismissTeam":this.core.emit("dismissTeam",{teamId:At});break;case"transferTeam":this.service.notifyTransferTeam(vr,pe,Cr);break;case"updateTeamMemberMute":this.service.notifyUpdateTeamMembersMute(vr,[Cr],Y.mute)}},M}(os);(function(w){w[w.none=0]="none",w[w.pass=1]="pass",w[w.decline=2]="decline",w[w.read=3]="read",w[w.deleted=4]="deleted",w[w.invalid=5]="invalid"})(Nc||(Nc={})),function(w){w[w.default=0]="default",w[w.leave=1]="leave",w[w.roam=2]="roam"}(pc||(pc={}));var Ud={applyTeam:0,rejectTeamApply:1,teamInvite:2,rejectTeamInvite:3,friendRequest:5,deleteFriend:6,recallMsgP2p:7,recallMsgTeam:8,recallMsgSuperTeam:12,deleteMsgP2pOneWay:13,deleteMsgTeamOneWay:14,applySuperTeam:15,rejectSuperTeamApply:16,superTeamInvite:17,rejectSuperTeamInvite:18,customP2p:100,customTeam:101,customSuperTeam:103},qd={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"},tf={setting:{needSaveOffline:{type:"boolean"},isRoutable:{type:"boolean"},envConfig:{type:"string"}},antiSpamInfo:{needAntiSpam:{type:"boolean"},antiSpamContent:{type:"boolean"}},pushInfo:Sh,recallMessageInfo:{idClient:{type:"string",rawKey:"deletedIdClient"},idServer:{type:"string",rawKey:"deletedIdServer"},createTime:{type:"number",rawKey:"deletedMsgTime"},fromNick:{type:"string",rawKey:"deletedMsgFromNick"},opeAccount:{type:"string"}}};function Vd(w,M,L){var $=+w.type,_=Ai(Ud,$);L=L||pc.default;var Y=Mr(Mr({},Xs(tf,w)),{type:_,time:+w.time,to:w.to,from:w.from,idServer:w.idServer,state:Nc[Nc.none],feature:pc[L]});if(typeof Y.attach=="string")try{Y.attach=JSON.parse(Y.attach)}catch(Oe){M.error("formatSystemMessage: "+Y.idServer+" parse attach error",Oe&&Oe.message)}return $===5&&Y.attach?(Y.attach.type=qd[+Y.attach.vt],Y.attach.type==="passFriendApply"?Y.state=Nc[Nc.pass]:Y.attach.type==="rejectFriendApply"&&(Y.state=Nc[Nc.decline])):$<=3&&Y.attach&&(Y.attach=function(pe){var At=pe.attach,jt=pe.tinfo,ur=Es(pe,["attach","tinfo"]);return ur.ext=At,jt!==void 0&&(ur.team=xc(Ii(pe.tinfo,as.team))),ur}(Y.attach)),Y}function vC(w){var M=Mr({},w);return Mr(Mr({},Td(tf,M)),{type:Ud[M.type],to:M.to,attach:M.attach})}var yC={"4_6":"syncOfflineSysMsgs","4_18":"syncOfflineSysMsgs","4_19":"syncRecallMsgOfflineAndRoaming","4_101":"syncOfflineSysMsgs","7_3":"onSysMsg","7_7":"sendCustomSysMsg","7_14":"onRecallMsg","21_18":"onRecallMsg","21_117":"onRecallMsg","7_15":"syncRecallMsgOfflineAndRoaming","21_19":"onSysMsg","21_16":"sendSuperTeamCustomSysMsg","101_3":"onSysMsg","101_7":"sendFilterCustomSysMsg"},Hd={sysMsg:Mr({time:0,type:1,to:2,from:3,content:4,attach:5,idServer:6,needSaveOffline:7,deletedIdClient:10,deletedIdServer:11,needcAntiSpam:12,antiSpamContent:13,deletedMsgTime:14,deletedMsgFromNick:15,opeAccount:16,envConfig:21,callbackExt:22,isRoutable:105},Cy)},Sl=rs(Hd),bC={onSysMsg:{service:"systemMessage",sid:7,cid:3,response:[{type:"Property",name:"sysMsg",reflectMapper:Sl.sysMsg}]},sendCustomSysMsg:{service:"systemMessage",sid:7,cid:7,params:[{type:"Property",name:"sysMsg",reflectMapper:Hd.sysMsg}]},sendSuperTeamCustomSysMsg:{service:"systemMessage",sid:21,cid:16,params:[{type:"Property",name:"sysMsg",reflectMapper:Hd.sysMsg}]},sendFilterCustomSysMsg:{service:"systemMessage",sid:101,cid:7,params:[{type:"Property",name:"sysMsg",reflectMapper:Hd.sysMsg}]},batchMarkRead:{service:"systemMessage",sid:4,cid:5,isNoResponse:!0,params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]},onRecallMsg:{sid:7,cid:14,service:"systemMessage",response:[{type:"Property",name:"sysMsg",reflectMapper:Sl.sysMsg}]},syncRecallMsgOfflineAndRoaming:{sid:7,cid:15,service:"systemMessage",response:[{type:"PropertyArray",name:"sysMsgs",reflectMapper:Sl.sysMsg},{type:"Number",name:"timetag"},{type:"Number",name:"type"}]},syncOfflineSysMsgs:{sid:4,cid:9,service:"systemMessage",response:[{type:"PropertyArray",name:"sysMsgs",reflectMapper:Sl.sysMsg}]}},TC=function(w){function M($){var _;return(_=w.call(this,"systemMessage",$)||this).sysMsgUnread={total:0,friend:0,msg:0,team:0,superTeam:0},_.core.eventBus.on("logined",function(){_.initEventListeners()}),qa({cmdMap:yC,cmdConfig:bC}),_}Ro(M,w);var L=M.prototype;return L.initEventListeners=function(){var _=this;this.core.eventBus.on("systemMessage/passFriendApply",function(Y){_.core.emit("updateSystemMessages",[{idServer:Y.idServer,from:Y.account,state:"pass",type:"friendRequest"}])}),this.core.eventBus.on("systemMessage/rejectFriendApply",function(Y){_.core.emit("updateSystemMessages",[{idServer:Y.idServer,from:Y.account,state:"decline",type:"friendRequest"}])})},L.doMarkSysMsgAck=function(_){var Y=[],Oe=[],pe=["applySuperTeam","rejectSuperTeamApply","superTeamInvite","rejectSuperTeamInvite","customSuperTeam"];In(_).call(_,function(At){At.idServer&&(bc(pe).call(pe,At.type)?Oe.push(At.idServer):Y.push(At.idServer))}),Y.length>0&&this.core.sendCmd("batchMarkRead",{sid:"7",cid:"3",ids:Y}),Oe.length>0&&this.core.sendCmd("batchMarkRead",{sid:"21",cid:"19",ids:Oe})},L.sendCustomSysMsg=function(_){var Y=this;En({to:{type:"string",allowEmpty:!1},type:{type:"enum",values:["customP2p","customTeam","customSuperTeam"]},attach:{type:"string",allowEmpty:!1},setting:{type:"object",rules:{needSaveOffline:{type:"boolean",required:!1},env:{type:"string",allowEmpty:!1,required:!1}},required:!1},pushInfo:{type:"object",required:!1,rules:Sh}},_);var Oe=_.type==="customSuperTeam"?"sendSuperTeamCustomSysMsg":"sendCustomSysMsg";return this.core.sendCmd(Oe,{sysMsg:vC(_)}).then(function(){Y.logger.log("sendCustomSysMsg success")}).catch(function(pe){throw Y.logger.error("sendCustomSysMsg failed",pe.message),pe})},L.onSysMsgHandler=function(_){var Y,Oe=(Y=_.content)===null||Y===void 0?void 0:Y.sysMsg;if(Oe){var pe=typeof As(_,"raw.r[0]")=="number"?""+_.raw.r[0]:void 0;Oe.idServer=Oe.idServer||pe;var At=Vd(Oe,this.logger,pc.default);this.core.emit("sysMsg",At),this.doMarkSysMsgAck([At])}else this.logger.warn("onSysMsg no content.sysMsg")},L.syncOfflineSysMsgsHandler=function(_){var Y,Oe=this;if(_.content.sysMsgs&&_.content.sysMsgs.length>0){var pe=To(Y=_.content.sysMsgs).call(Y,function(At){return Vd(At,Oe.logger,pc.leave)});this.core.emit("syncSysMsgs",pe),this.doMarkSysMsgAck(pe)}},L.onRecallMsgHandler=function(_){var Y,Oe=(Y=_.content)===null||Y===void 0?void 0:Y.sysMsg;if(Oe){var pe=typeof As(_,"raw.r[0]")=="number"?""+_.raw.r[0]:void 0;Oe.idServer=Oe.idServer||pe;var At=wd([Oe],function(gr){return gr===Ud.recallMsgP2p?"p2p":gr===Ud.recallMsgTeam?"team":gr===Ud.recallMsgSuperTeam?"superTeam":""}(+Oe.type));this.core.eventBus.emit("session/updateForDeletedMsg",At);var jt=Vd(Oe,this.logger,pc.default);this.core.emit("sysMsg",jt),this.doMarkSysMsgAck([jt])}else this.logger.warn("onSysMsg no content.sysMsg")},L.syncRecallMsgOfflineAndRoamingHandler=function(_){var Y=this,Oe=_.content,pe=Oe.timetag,At=Oe.type,jt=Oe.sysMsgs,ur=_o(At),gr=ur===1?pc.leave:pc.roam,vr=To(jt).call(jt,function(Cr){return Vd(Cr,Y.logger,gr)});ur===1&&this.doMarkSysMsgAck(vr),this.core.eventBus.emit("sync/updateTimetag",{recallMsg:pe}),this.core.emit("syncSysMsgs",vr)},M}(os);function zd(w){var M=["bitsExtension","createTime","updateTime","passRelationShip","relationShip","source"],L=Mr({},w);return In(M).call(M,function($){L[$]!==void 0&&(L[$]=_o(L[$]))}),L.relationShip!==void 0&&(L.valid=L.relationShip===1),L}var SC={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"},Dh={"12_4":"getFriends","12_1":"friendReuqest","12_2":"deleteFriend","12_3":"updateFriend","12_5":"syncFriends","12_6":"syncFriendUsers","12_101":"syncFriendRequest","12_102":"syncDeleteFriend","12_103":"syncUpdateFriend"},rf={updateFriendTag:{account:4,alias:8,ext:10},delFriendParams:{delAlias:1},friendTag:{account:4,relationShip:5,passRelationShip:6,source:7,alias:8,bitsExtension:9,ext:10,createTime:11,updateTime:12,serverex:13},userTag:{account:1,nick:3,avatar:4,sign:5,gender:6,email:7,birth:8,tel:9,ext:10,createTime:12,updateTime:13}},nf=rs(rf),zy={getFriends:{sid:12,cid:4,service:"friend",params:[{type:"Long",name:"timetag"}],response:[{type:"PropertyArray",name:"friends",reflectMapper:nf.friendTag},{type:"Number",name:"timetag"}]},friendReuqest:{sid:12,cid:1,service:"friend",params:[{type:"String",name:"account"},{type:"Byte",name:"type"},{type:"String",name:"ps"}]},deleteFriend:{sid:12,cid:2,service:"friend",params:[{type:"String",name:"account"},{type:"Property",name:"delFriendParams",reflectMapper:rf.delFriendParams}]},updateFriend:{sid:12,cid:3,service:"friend",params:[{type:"Property",name:"updateFriendTag",reflectMapper:rf.updateFriendTag}]},syncFriends:{sid:12,cid:5,service:"friend",response:[{type:"PropertyArray",name:"friends",entity:"friendTag",reflectMapper:nf.friendTag},{type:"Number",name:"timetag"}]},syncFriendUsers:{sid:12,cid:6,service:"friend",response:[{type:"PropertyArray",name:"users",entity:"userTag",reflectMapper:nf.userTag},{type:"Number",name:"timetag"}]},syncFriendRequest:{sid:12,cid:101,service:"friend",params:[{type:"String",name:"account"},{type:"Number",name:"type"},{type:"String",name:"ps"}],response:[{type:"String",name:"account"},{type:"Number",name:"type"},{type:"String",name:"ps"}]},syncDeleteFriend:{sid:12,cid:102,service:"friend",response:[{type:"String",name:"account"}]},syncUpdateFriend:{sid:12,cid:103,service:"friend",response:[{type:"Property",name:"friend",reflectMapper:nf.friendTag}]}},CC=function(w){function M($){var _;return _=w.call(this,"friend",$)||this,qa({cmdMap:Dh,cmdConfig:zy}),_}Ro(M,w);var L=M.prototype;return L.getFriends=function(){var _;return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return jt.next=2,this.core.sendCmd("getFriends",{timetag:0});case 2:return Oe=jt.sent,pe=((_=Oe.content)===null||_===void 0?void 0:_.friends)||[],pe=To(pe).call(pe,function(ur){return zd(ur)}),jt.abrupt("return",pe);case 6:case"end":return jt.stop()}},Y,this)}))},L.addFriend=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({account:{type:"string",allowEmpty:!1},ps:{type:"string",allowEmpty:!1,required:!1}},_),At.next=3,this.core.sendCmd("friendReuqest",{account:_.account,type:1,ps:_.ps||""});case 3:return Oe=new Date().getTime(),At.abrupt("return",{account:_.account,createTime:Oe,updateTime:Oe,valid:!0,source:0,passRelationShip:1,relationShip:1,bitsExtension:0});case 5:case"end":return At.stop()}},Y,this)}))},L.applyFriend=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({account:{type:"string",allowEmpty:!1}},_),pe.next=3,this.core.sendCmd("friendReuqest",{account:_.account,type:2,ps:_.ps||""});case 3:case"end":return pe.stop()}},Y,this)}))},L.passFriendApply=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe=this;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({account:{type:"string",allowEmpty:!1}},_),At.next=3,this.core.sendCmd("friendReuqest",{account:_.account,type:3,ps:_.ps||""}).then(function(jt){return Oe.core.eventBus.emit("systemMessage/passFriendApply",_),jt});case 3:case"end":return At.stop()}},Y,this)}))},L.rejectFriendApply=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe=this;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({account:{type:"string",allowEmpty:!1}},_),At.next=3,this.core.sendCmd("friendReuqest",{account:_.account,type:4,ps:_.ps||""}).then(function(jt){return Oe.core.eventBus.emit("systemMessage/rejectFriendApply",_),jt});case 3:case"end":return At.stop()}},Y,this)}))},L.deleteFriend=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({account:{type:"string",allowEmpty:!1},delAlias:{type:"boolean"}},_),pe.next=3,this.core.sendCmd("deleteFriend",{account:_.account,delFriendParams:{delAlias:_.delAlias===!0?1:0}});case 3:case"end":return pe.stop()}},Y,this)}))},L.updateFriend=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({account:{type:"string",allowEmpty:!1},alias:{type:"string"},ext:{type:"string",required:!1}},_),pe.next=3,this.core.sendCmd("updateFriend",{updateFriendTag:_});case 3:case"end":return pe.stop()}},Y,this)}))},L.syncFriendRequestHandler=function(_){var Y=function(pe){var At=Mr({},pe);try{At.ps=At.ps&&JSON.parse(At.ps)}catch{}if(At.type=SC[At.type],At.type==="addFriend"||At.type==="passFriendApply"){var jt=new Date().getTime();At.friend={account:pe.account,alias:"",createTime:jt,ext:"",updateTime:jt,valid:!0}}return At}(_.content);this.core.emit("syncFriend",Y)},L.syncDeleteFriendHandler=function(_){var Y=_.content.account;this.logger.log("friend::emit syncFriendAction: deleteFriend "+Y),this.core.emit("syncFriend",{type:"deleteFriend",account:Y})},L.syncUpdateFriendHandler=function(_){var Y=zd(_.content.friend);this.logger.log("friend::emit syncFriendAction: updateFriend, ",Y==null?void 0:Y.account),this.core.emit("syncFriend",{type:"updateFriend",friend:Y})},L.syncFriendsHandler=function(_){var Y=_.content;this.core.eventBus.emit("sync/updateTimetag",{friends:_o(Y.timetag)});var Oe=Y==null?void 0:Y.friends;if(Oe&&Oe.length){var pe=To(Oe).call(Oe,function(At){return zd(At)});this.core.emit("friends",pe)}},L.syncFriendUsersHandler=function(_){var Y=_.content;this.core.eventBus.emit("sync/updateTimetag",{friendUsers:_o(Y.timetag)});var Oe=Y==null?void 0:Y.users;if(Oe&&Oe.length){var pe=To(Oe).call(Oe,function(At){return zl(At)});this.core.emit("users",pe)}},M}(os),Uh={1:"Android",2:"iOS",4:"PC",8:"WindowsPhone",16:"Web",32:"Server",64:"Mac"};function Ky(w){return w&&w.length>0?To(w).call(w,function(M){return function($){var _=Mr({},$),Y=["subscribeTime","time"];return In(Y).call(Y,function(Oe){_[Oe]&&(_[Oe]=_o(_[Oe]))}),_}(M)}):[]}function Rc(w){if(!w)return w;var M=w.serverExt,L=Es(w,["serverExt"]),$=["time","type","value"];if(In($).call($,function(_){L[_]&&(L[_]=_o(L[_]))}),L.clientType&&(L.clientType=Uh[L.clientType]||""),M)try{L.ext=JSON.parse(M),typeof L.ext[0]=="string"&&(L.ext=L.ext[0])}catch{}return L}var Wy={"14_1":"publishEvent","14_2":"pushEvent","14_3":"subscribeEvent","14_4":"unSubscribeEventsByAccounts","14_5":"unSubscribeEventsByType","14_6":"querySubscribeEventsByAccounts","14_7":"querySubscribeEventsByType","14_9":"pushEvents"},Cl={msgEvent:{type:1,value:2,idClient:3,ext:4,validTime:5,broadcastType:6,sync:7,validTimeType:8,durable:9,time:10,idServer:11,clientType:12,serverConfig:13,serverExt:14,appid:101,account:103,enableMultiClient:104,consid:106},msgEventSubscribe:{type:1,subscribeTime:2,sync:3,to:102,from:104,time:105}},tu=rs(Cl),MC={publishEvent:{sid:14,cid:1,service:"event",params:[{type:"Property",name:"msgEvent",reflectMapper:Cl.msgEvent}],response:[{type:"Property",name:"msgEvent",reflectMapper:tu.msgEvent}]},pushEvent:{sid:14,cid:2,service:"event",response:[{type:"Property",name:"msgEvent",reflectMapper:tu.msgEvent}]},subscribeEvent:{sid:14,cid:3,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:Cl.msgEventSubscribe},{type:"StrArray",name:"accounts"}],response:[{type:"StrArray",name:"accounts"}]},unSubscribeEventsByAccounts:{sid:14,cid:4,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:Cl.msgEventSubscribe},{type:"StrArray",name:"accounts"}],response:[{type:"StrArray",name:"accounts"}]},unSubscribeEventsByType:{sid:14,cid:5,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:Cl.msgEventSubscribe}]},querySubscribeEventsByAccounts:{sid:14,cid:6,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:Cl.msgEventSubscribe},{type:"StrArray",name:"accounts"}],response:[{type:"PropertyArray",name:"msgEventSubscribes",reflectMapper:tu.msgEventSubscribe}]},querySubscribeEventsByType:{sid:14,cid:7,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:Cl.msgEventSubscribe}],response:[{type:"PropertyArray",name:"msgEventSubscribes",reflectMapper:tu.msgEventSubscribe}]},pushEvents:{sid:14,cid:9,service:"event",response:[{type:"PropertyArray",name:"msgEvents",reflectMapper:tu.msgEvent}]}},S=function(w){function M($){var _;return _=w.call(this,"event",$)||this,qa({cmdMap:Wy,cmdConfig:MC}),_}Ro(M,w);var L=M.prototype;return L.publishEvent=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return En({type:{type:"number"},value:{type:"number"},ext:{type:"string",required:!1},validTime:{type:"number",min:60,max:2592e3,required:!1},broadcastType:{type:"number",required:!1},sync:{type:"boolean",required:!1}},_),pe=Mr(Mr({validTime:604800},_),{idClient:_p(),sync:_.sync===!0?1:0}),gr.next=4,this.core.sendCmd("publishEvent",{msgEvent:pe});case 4:return At=gr.sent,jt=((Y=At.content)===null||Y===void 0?void 0:Y.msgEvent)||{},gr.abrupt("return",Rc(jt));case 7:case"end":return gr.stop()}},Oe,this)}))},L.subscribeEvent=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return En({type:{type:"number"},accounts:{type:"array",itemType:"string",max:100},subscribeTime:{type:"number",min:60,max:2592e3,required:!1}},_),pe=Mr(Mr({subscribeTime:2592e3},_),{sync:_.sync===!0?1:0}),gr.next=4,this.core.sendCmd("subscribeEvent",{msgEventSubscribe:pe,accounts:_.accounts});case 4:return At=gr.sent,jt=((Y=At.content)===null||Y===void 0?void 0:Y.accounts)||[],gr.abrupt("return",{failedAccounts:jt});case 7:case"end":return gr.stop()}},Oe,this)}))},L.unSubscribeEvents=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:if(En({type:{type:"number"},accounts:{type:"array",itemType:"string",max:100,required:!1}},_),pe={type:_.type},!(_.accounts&&_.accounts.length>0)){gr.next=9;break}return gr.next=5,this.core.sendCmd("unSubscribeEventsByAccounts",{msgEventSubscribe:pe,accounts:_.accounts});case 5:jt=gr.sent,At=((Y=jt.content)===null||Y===void 0?void 0:Y.accounts)||[],gr.next=12;break;case 9:return gr.next=11,this.core.sendCmd("unSubscribeEventsByType",{msgEventSubscribe:pe});case 11:At=[];case 12:return gr.abrupt("return",{failedAccounts:At});case 13:case"end":return gr.stop()}},Oe,this)}))},L.querySubscribeEvents=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(En({type:{type:"number"},accounts:{type:"array",itemType:"string",max:100,required:!1}},_),!(_.accounts&&_.accounts.length>0)){jt.next=7;break}return jt.next=4,this.core.sendCmd("querySubscribeEventsByAccounts",{msgEventSubscribe:{type:_.type},accounts:_.accounts});case 4:pe=jt.sent,jt.next=10;break;case 7:return jt.next=9,this.core.sendCmd("querySubscribeEventsByType",{msgEventSubscribe:{type:_.type}});case 9:pe=jt.sent;case 10:return jt.abrupt("return",Ky((Y=pe.content)===null||Y===void 0?void 0:Y.msgEventSubscribes));case 11:case"end":return jt.stop()}},Oe,this)}))},L.pushEventHandler=function(_){var Y,Oe=((Y=_.content)===null||Y===void 0?void 0:Y.msgEvent)||{};this.core.emit("pushEvents",[Rc(Oe)])},L.pushEventsHandler=function(_){var Y,Oe=((Y=_.content)===null||Y===void 0?void 0:Y.msgEvents)||{};this.core.emit("pushEvents",function(At){return gi(At)&&At.length>0?To(At).call(At,function(jt){return Rc(jt)}):[]}(Oe))},M}(os);function x(w){var M={scene:mh[w.scene],from:w.threadMsgFromAccount,to:w.threadMsgToAccount,time:w.threadMsgTime,idServer:w.threadMsgIdServer},L={limit:w.limit<100?w.limit:100,beginTime:typeof w.beginTime=="number"?w.beginTime:0,reverse:kl(w)===!0?1:0};return w.lastMsgId&&(L.lastMsgId=w.lastMsgId),{msg:M,threadMsgReq:L}}var D,F={"23_1":"getThreadMsgs","23_2":"getMsgsByIdServer"},O={msg:La,threadMsgReq:{beginTime:1,endTime:2,lastMsgId:3,limit:4,reverse:5},threadMsgsMeta:{total:1,lastMsgTime:2}},oe=rs(O),xe={getThreadMsgs:{sid:23,cid:1,service:"msgExtend",params:[{type:"Property",name:"msg",reflectMapper:O.msg},{type:"Property",name:"threadMsgReq",reflectMapper:O.threadMsgReq}],response:[{type:"Property",name:"threadMsg",reflectMapper:oe.msg},{type:"Property",name:"threadMsgsMeta",reflectMapper:oe.threadMsgsMeta},{type:"PropertyArray",name:"msgs",reflectMapper:oe.msg}]},getMsgsByIdServer:{sid:23,cid:2,service:"msgExtend",params:[{type:"PropertyArray",name:"reqMsgs",reflectMapper:O.msg}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:oe.msg}]}},z=function(w){function M($){var _;return _=w.call(this,"msgExtend",$)||this,qa({cmdMap:F,cmdConfig:xe}),_}Ro(M,w);var L=M.prototype;return L.getThreadMsgs=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt,ur,gr,vr,Cr;return ar.wrap(function(Br){for(;;)switch(Br.prev=Br.next){case 0:return En({scene:{type:"enum",values:vi(Da)},threadMsgFromAccount:{type:"string",allowEmpty:!1},threadMsgIdServer:{type:"string",allowEmpty:!1},threadMsgTime:{type:"number"},threadMsgToAccount:{type:"string",allowEmpty:!1},beginTime:{type:"number",required:!1},endTime:{type:"number",required:!1},lastMsgId:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,max:100,required:!1},reverse:{type:"boolean",required:!1}},_),Br.next=3,this.core.sendCmd("getThreadMsgs",x(_));case 3:return pe=Br.sent,At=pe.content,jt=At.msgs,ur=At.threadMsg,gr=pe.content.threadMsgsMeta,vr=bi(ur,this.core.account),Cr=(Y=this.core.session)===null||Y===void 0?void 0:Y.getSessionWithUncomplete({id:vr}),jt=_d(jt,Cr?{account:this.core.account,sessionAck:Cr.ack,msgReceiptTime:Cr.msgReceiptTime}:{account:this.core.account}),ur=Ri(ur,Cr?{account:this.core.account,sessionAck:Cr.ack,msgReceiptTime:Cr.msgReceiptTime}:{account:this.core.account}),Br.abrupt("return",{msgs:jt,threadMsg:ur,total:_o(gr.total),timetag:_o(gr.lastMsgTime)});case 11:case"end":return Br.stop()}},Oe,this)}))},L.getMsgsByIdServer=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe,At,jt,ur=this;return ar.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return En({reqMsgs:{type:"array",rules:{scene:{type:"enum",values:vi(Da)},from:{type:"string",allowEmpty:!1},to:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1},time:{type:"number"}},min:1,max:100}},_),vr.next=3,this.core.sendCmd("getMsgsByIdServer",{reqMsgs:To(Oe=_.reqMsgs).call(Oe,function(Cr){return Mr(Mr({},Cr),{scene:Ai(Da,Cr.scene)})})});case 3:return At=vr.sent,jt=To(pe=At.content.msgs).call(pe,function(Cr){var xr,Br=bi(Cr,ur.core.account),jr=(xr=ur.core.session)===null||xr===void 0?void 0:xr.getSessionWithUncomplete({id:Br});return Ri(Cr,jr?{account:ur.core.account,sessionAck:jr.ack,msgReceiptTime:jr.msgReceiptTime}:{account:ur.core.account})}),vr.abrupt("return",jt);case 6:case"end":return vr.stop()}},Y,this)}))},M}(os);(function(w){w[w.ASC=1]="ASC",w[w.DESC=2]="DESC"})(D||(D={}));var qe,Lt={"7_6":"getHistoryMsgs","7_9":"deleteRoamingMsgs","4_24":"syncClearServerHistoryMsgs","7_18":"clearHistoryMsgsFromServer","7_118":"multiSyncClearServerHistoryMsgs","7_26":"nimFtsCloudMsgLogsAggWithSession","7_27":"nimFtsCloudMsgLogs"},lr={msg:La,clearHistoryMsgsFromServerReqTag:{type:0,otherAccid:1,isDeleteRoam:2,toTid:3,isSyncSelf:4,ext:7},clearMsgsParamsWithSync:{type:0,otherAccid:1,isDeleteRoam:2,toTid:3,isSyncSelf:4,fromAccid:5,time:6,ext:7},ftsReqTag:{keyword:1,fromTime:2,toTime:3,sessionLimit:4,msglogsLimit:5,orderRule:6,p2pSessionList:7,teamSessionList:8,senderList:9,msgTypeList:10,msgSubTypeList:11}},pr=rs(lr),Sr={deleteRoamingMsgs:{sid:7,cid:9,service:"msgLog",params:[{type:"StrArray",name:"ids"}]},getHistoryMsgs:{sid:7,cid:6,params:[{type:"String",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:pr.msg}],service:"msgLog"},clearHistoryMsgsFromServer:{sid:7,cid:18,params:[{type:"Property",name:"clearHistoryMsgsFromServerReqTag",reflectMapper:lr.clearHistoryMsgsFromServerReqTag}],response:[{type:"Long",name:"timetag"}],service:"msgLog"},multiSyncClearServerHistoryMsgs:{sid:7,cid:118,response:[{type:"Property",name:"data",reflectMapper:pr.clearMsgsParamsWithSync}],service:"msgLog"},syncClearServerHistoryMsgs:{sid:4,cid:24,service:"msgLog",response:[{type:"PropertyArray",name:"datas",reflectMapper:pr.clearMsgsParamsWithSync}]},nimFtsCloudMsgLogsAggWithSession:{sid:7,cid:26,service:"msgLog",params:[{type:"Property",name:"tag",reflectMapper:lr.ftsReqTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:pr.msg}]},nimFtsCloudMsgLogs:{sid:7,cid:27,service:"msgLog",params:[{type:"Property",name:"tag",reflectMapper:lr.ftsReqTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:pr.msg}]}};(function(w){w[w.p2p=1]="p2p",w[w.team=2]="team"})(qe||(qe={}));var br={type:{type:"enum",values:qe},isDeleteRoam:{type:"boolean"},isSyncSelf:{type:"boolean"},time:{type:"number"}};function Er(w){var M=Xs(br,w);return{sessionId:M.type==="p2p"?"p2p-"+M.otherAccid:"team-"+M.toTid,time:M.time}}var Dr={orderRule:{type:"enum",values:D}};function $r(w){var M,L=Xs(Dr,w);gi(L.msgTypeList)&&(L.msgTypeList=To(M=L.msgTypeList).call(M,function(_){return ac[_]}).join(","));var $=["p2pSessionList","teamSessionList","senderList","msgSubTypeList"];return In($).call($,function(_){gi(L[_])&&(L[_]=L[_].join(","))}),L}var vn=function(w){function M($){var _;return _=w.call(this,"msgLog",$)||this,qa({cmdMap:Lt,cmdConfig:Sr}),_}Ro(M,w);var L=M.prototype;return L.deleteRoamingMsgs=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:En({ids:{type:"array",itemType:"string"}},_),Oe=[],jt.prev=2,Oe=To(pe=_.ids).call(pe,function(ur){var gr=Lo(ur);return gr.scene+"|"+gr.accid}),jt.next=10;break;case 6:throw jt.prev=6,jt.t0=jt.catch(2),this.logger.error("Failed to delete roaming msgs with "+_.ids,jt.t0),new Error("Failed to create session with "+_.ids);case 10:return jt.next=12,this.core.sendCmd("deleteRoamingMsgs",{ids:Oe});case 12:case"end":return jt.stop()}},Y,this,[[2,6]])}))},L.getHistoryMsgs=function(_){var Y,Oe;return Sn(this,void 0,void 0,ar.mark(function pe(){var At,jt,ur,gr,vr,Cr,xr;return ar.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return!((Y=this.core.sync)===null||Y===void 0)&&Y.getSyncDoneFlag()||this.logger.warn("Please call getHistoryMsgs after syncdone event"),En({scene:{type:"enum",values:Vo(mh)},to:{type:"string",allowEmpty:!1},beginTime:{type:"number",required:!1},endTime:{type:"number",required:!1},limit:{type:"number",min:1,max:100,required:!1},reverse:{type:"boolean",required:!1},lastMsgId:{type:"string",required:!1,allowEmpty:!1},asc:{type:"boolean",required:!1},msgTypes:{type:"array",itemType:"string",required:!1}},_),jt=_.scene==="p2p"?"getHistoryMsgs":_.scene==="team"?"getHistoryTeamMsgs":"getHistorySuperTeamMsgs",jr.next=5,this.core.sendCmd(jt,Mr(Mr({beginTime:0,endTime:0,lastMsgId:0,limit:100,reverse:!1},_),{msgTypes:_.msgTypes?To(At=_.msgTypes).call(At,function(zr){return fh[zr]}):[]}));case 5:if(ur=jr.sent,(gr=ur.content).msgs&&gr.msgs.length>0){jr.next=9;break}return jr.abrupt("return",[]);case 9:if(vr=bi(gr.msgs[0],this.core.account),Cr=(Oe=this.core.session)===null||Oe===void 0?void 0:Oe.getSessionWithUncomplete({id:vr}),xr=_d(gr.msgs,Cr?{account:this.core.account,sessionAck:Cr.ack,msgReceiptTime:Cr.msgReceiptTime}:{account:this.core.account}),_.asc!==!0){jr.next=14;break}return jr.abrupt("return",wc(xr).call(xr,function(zr,Hr){return zr.time-Hr.time}));case 14:return jr.abrupt("return",xr);case 15:case"end":return jr.stop()}},pe,this)}))},L.clearHistoryMsgsFromServer=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({scene:{type:"enum",values:["p2p","team"]},to:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1},isSyncSelf:{type:"boolean",required:!1}},_),(Oe=Mr(Mr({isDeleteRoam:1},_),{type:_.scene==="team"?2:1,isSyncSelf:_.isSyncSelf===!0?1:0}))[Oe.type===2?"toTid":"otherAccid"]=_.to,ur.next=5,this.core.sendCmd("clearHistoryMsgsFromServer",{clearHistoryMsgsFromServerReqTag:Oe});case 5:return pe=ur.sent,At=pe.content,this.core.eventBus.emit("session/updateForClearMsg",[{sessionId:_.scene+"-"+_.to}],!0),ur.abrupt("return",At);case 9:case"end":return ur.stop()}},Y,this)}))},L.multiSyncClearServerHistoryMsgsHandler=function(_){var Y=Er(_.content.data);this.core.eventBus.emit("session/updateForClearMsg",[Y],!0),this.core.emit("clearServerHistoryMsgs",[Y])},L.ftsCloudMsgLogs=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return pe.abrupt("return",this.baseFtsCloudMsgLogs(_,"nimFtsCloudMsgLogs"));case 1:case"end":return pe.stop()}},Y,this)}))},L.ftsCloudMsgLogsAggWithSession=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return pe.abrupt("return",this.baseFtsCloudMsgLogs(_,"nimFtsCloudMsgLogsAggWithSession"));case 1:case"end":return pe.stop()}},Y,this)}))},L.baseFtsCloudMsgLogs=function(_,Y){return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt,ur=this;return ar.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:if(En({keyword:{type:"string",allowEmpty:!1},fromTime:{type:"number",required:!1},toTime:{type:"number",required:!1},sessionLimit:{type:"number",required:!1},msglogsLimit:{type:"number",required:!1},orderRule:{type:"enum",values:vi(D),required:!1},p2pSessionList:{type:"array",itemType:"string",required:!1},teamSessionList:{type:"array",itemType:"string",required:!1},senderList:{type:"array",itemType:"string",required:!1},msgTypeList:{type:"array",itemType:"enum",values:vi(ac),required:!1},msgSubTypeList:{type:"array",itemType:"number",required:!1}},_),!(_.fromTime&&_.toTime&&_.toTime<_.fromTime)){vr.next=3;break}throw new yo("Request parameter error: toTime should be greater than fromTime",_,"");case 3:return At=$r(_),vr.next=6,this.core.sendCmd(Y,{tag:At});case 6:return jt=vr.sent,vr.abrupt("return",To(pe=jt.content.datas).call(pe,function(Cr){var xr,Br=bi(Cr,ur.core.account),jr=(xr=ur.core.session)===null||xr===void 0?void 0:xr.getSessionWithUncomplete({id:Br});return Ri(Cr,jr?{account:ur.core.account,sessionAck:jr.ack,msgReceiptTime:jr.msgReceiptTime}:{account:ur.core.account})}));case 8:case"end":return vr.stop()}},Oe,this)}))},L.syncClearServerHistoryMsgsHandler=function(_){var Y=function(pe){return gi(pe)&&pe.length>0?To(pe).call(pe,function(At){return Er(At)}):[]}(_.content.datas);this.core.emit("clearServerHistoryMsgs",Y)},M}(os),Xr={"22_1":"requestProxy","22_2":"onRequestProxy"},wn={requestProxyTag:{zone:1,path:2,method:3,header:4,body:5},requestProxyMsgTag:{from:1,body:2,time:3}},hn=rs(wn),Gn={requestProxy:{sid:22,cid:1,service:"passThrough",params:[{type:"Property",name:"requestProxyTag",reflectMapper:wn.requestProxyTag}],response:[{type:"Property",name:"requestProxyTag",reflectMapper:hn.requestProxyTag}]},onRequestProxy:{sid:22,cid:2,service:"passThrough",response:[{type:"Property",name:"proxyMsg",reflectMapper:hn.requestProxyMsgTag}]}},Dn=function(w){function M($){var _;return(_=w.call(this,"passThrough",$)||this).core=$,qa({cmdMap:Xr,cmdConfig:Gn}),_}Ro(M,w);var L=M.prototype;return L.request=function(_){return En({path:{type:"string",allowEmpty:!1}},_),this.core.sendCmd("requestProxy",{requestProxyTag:_}).then(function(Y){return Y.content.proxyTag})},L.onRequestProxyHandler=function(_){var Y=_.content.proxyMsg;Y&&Y.time&&(Y.time=+Y.time),this.core.emit("proxyMsg",Y)},M}(os),jo=bs.some,jn=Ds("some");Vr({target:"Array",proto:!0,forced:!jn},{some:function(M){return jo(this,M,arguments.length>1?arguments[1]:void 0)}});var wr=Uo("Array").some,xn=Array.prototype,Nn=function(w){var M=w.some;return w===xn||er(xn,w)&&M===xn.some?wr:M},Cn,Zr,On=function(M,L){if(M==null)return{};var $=Og($y(M),function(_){return[_]});return L=Xl(L),wy(M,$,function(_,Y){return L(_,Y[0])})},Un={"6_2":"getNosToken","6_22":"getOriginUrl","6_26":"getNosCdnHost","6_27":"getGrayscaleConfig","6_28":"getMixStorePolicy","6_29":"getMixStoreToken","6_30":"getFileAuthToken"},eo={nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},mixStoreTokenReqTag:{provider:0,tokenCount:1,fileExpireSec:2,tag:3,returnBody:4},nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4},grayConfigTag:{config:0,ttl:1},mixStorePolicyTag:{providers:0,ttl:1,mixEnable:2,nosPolicy:3,s3Policy:4},mixStoreTokenResTag:{provider:0,accessKeyId:1,secretAccessKey:2,sessionToken:3,token:4,expireTime:5,bucket:6,objectName:7,fileExpireSec:8,tag:9,shortUrl:10,region:11},nosSafeUrlTag:{safeUrl:0,originUrl:1},mixStoreAuthTokenReqTag:{type:1,urls:2},mixStoreAuthTokenResTag:{type:1,tokens:2,token:3,ttl:4}},ro=rs(eo),Do={getNosToken:{sid:6,cid:2,service:"cloudStorage",response:[{type:"Property",name:"nosToken",reflectMapper:ro.nosToken}],params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken",reflectMapper:eo.nosToken}]},getOriginUrl:{sid:6,cid:22,service:"cloudStorage",response:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:ro.nosSafeUrlTag}],params:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:eo.nosSafeUrlTag}]},getNosCdnHost:{sid:6,cid:26,service:"misc",response:[{type:"Property",name:"nosConfigTag",reflectMapper:ro.nosConfigTag}]},getGrayscaleConfig:{sid:6,cid:27,service:"cloudStorage",response:[{type:"Property",name:"grayConfigTag",reflectMapper:ro.grayConfigTag}],params:[{type:"Property",name:"config"}]},getMixStorePolicy:{sid:6,cid:28,service:"cloudStorage",params:[{type:"LongArray",name:"supportType"}],response:[{type:"Property",name:"mixStorePolicyTag",reflectMapper:ro.mixStorePolicyTag}]},getMixStoreToken:{sid:6,cid:29,service:"cloudStorage",params:[{type:"Property",name:"mixStoreTokenReqTag",reflectMapper:eo.mixStoreTokenReqTag}],response:[{type:"Property",name:"mixStoreTokenResTag",reflectMapper:ro.mixStoreTokenResTag}]},getFileAuthToken:{sid:6,cid:30,service:"cloudStorage",params:[{type:"Property",name:"mixStoreAuthTokenReqTag",reflectMapper:eo.mixStoreAuthTokenReqTag}],response:[{type:"Property",name:"mixStoreAuthTokenResTag",reflectMapper:ro.mixStoreAuthTokenResTag}]}};(function(w){w[w.nos=1]="nos",w[w.s3=2]="s3"})(Cn||(Cn={})),function(w){w[w.dontNeed=-1]="dontNeed",w[w.time=2]="time",w[w.urls=3]="urls"}(Zr||(Zr={}));var go,Zo,So={chunkUploadHost:"https://wanproxy-web.127.net",commonUploadHost:"https://nos.netease.com",chunkMaxSize:4194304e4,commonMaxSize:104857600,uploadReplaceFormat:"https://{host}/{object}",cdn:{defaultCdnDomain:"nim.nosdn.127.net",cdnDomain:"",bucket:"",objectNamePrefix:""},downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHostList:["nos.netease.com"],nosCdnEnable:!0,isNeedToGetUploadPolicyFromServer:!0},Io={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},ea={accessKeyId:"",secretAccessKey:"",sessionToken:"",region:"",maxRetries:0,bucket:"",objectName:"",token:"",shortUrl:""};function Ci(w){return w===void 0&&(w="file"),Wo(Io[w]||{}).replace(/"/gi,'\\"')}(function(w){w[w.nos=1]="nos",w[w.s3=2]="s3"})(go||(go={})),function(w){w[w.dontNeed=-1]="dontNeed",w[w.time=2]="time",w[w.urls=3]="urls"}(Zo||(Zo={}));var Eo=function(){function w(L,$){$===void 0&&($={}),this.GRAYKEY="AllGrayscaleConfig",this.MIXSTOREKEY="AllMixStorePolicy",this.config={},this.nosCdnHostTimer=0,this.grayConfig={mixStoreEnable:!1,timeStamp:0,ttl:0},this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=go.nos,this.s3=null,this.mixStoreErrorCount=10,this.nosErrorCount=0,this.circuitTimer=0,this.name="cloudStorage",this.logger=L.logger,this.core=L,qa({cmdMap:Un,cmdConfig:Do}),this.setOptions($)}var M=w.prototype;return M.setOptions=function($){$===void 0&&($={});var _=$.storageKeyPrefix||"NIMClient";this.GRAYKEY=_+"-AllGrayscaleConfig",this.MIXSTOREKEY=_+"-AllMixStorePolicy";var Y=$.s3,Oe=Es($,["s3"]),pe=Mr({},So,this.config);if(Oe&&Object.prototype.hasOwnProperty.call(Oe,"cdn")){var At={cdn:Mr(Mr({},pe.cdn),Oe.cdn)};this.config=Mr({},pe,Oe,At)}else this.config=Mr({},pe,Oe);Y&&(this.s3=Y)},M.init=function(){return Sn(this,void 0,void 0,ar.mark(function $(){return ar.wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(this.grayConfig=null,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=go.nos,this.mixStoreErrorCount=10,!this.config.isNeedToGetUploadPolicyFromServer){Y.next=9;break}return Y.next=7,this.getGrayscaleConfig(this.core.options.appkey);case 7:return Y.next=9,this.getNosCdnHost();case 9:case"end":return Y.stop()}},$,this)}))},M.uploadFile=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var Y,Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(En({maxSize:{type:"number",required:!1},type:{type:"enum",values:["file","image","audio","video"]}},$),$.fileInput||$.file||$.filePath){jt.next=3;break}throw new Error("uploadFile needs target file object or a filePath");case 3:if(!$.type||$.type==="file"){jt.next=7;break}if(typeof(Y=As($,"file.type"))!="string"||ka(Y).call(Y,$.type)!==-1){jt.next=7;break}throw new Error('The meta type "'+Y+'" does not match "'+$.type+'"');case 7:if(this.grayConfig&&this.grayConfig.mixStoreEnable&&this.mixStorePolicy.providers.length){jt.next=10;break}return this.logger.log("uploadFile:: uploadFile begin, use old nos"),jt.abrupt("return",this.nosUpload($));case 10:return this.logger.log("uploadFile:: uploadFile begin,Current settings grayConfig mixStoreEnable:"+this.grayConfig.mixStoreEnable+" curProvider:"+this.curProvider),this.s3||(this.curProvider=go.nos),Oe=ea,jt.prev=13,jt.next=16,this.core.sendCmd("getMixStoreToken",{mixStoreTokenReqTag:{provider:this.curProvider,tokenCount:1,tag:"qchat",returnBody:Ci($.type)}});case 16:pe=jt.sent,Oe=pe.content.mixStoreTokenResTag,jt.next=24;break;case 20:throw jt.prev=20,jt.t0=jt.catch(13),this.core.logger.error("uploadFile:: getMixStoreToken error",jt.t0),new El("getMixStoreToken error",jt.t0,this.curProvider,this.mixStorePolicy);case 24:return jt.abrupt("return",this.curProvider===go.s3?this.s3Upload($,Oe):this.nosUpload($,Oe));case 25:case"end":return jt.stop()}},_,this,[[13,20]])}))},M.nosUpload=function($,_){var Y,Oe;return Sn(this,void 0,void 0,ar.mark(function pe(){var At,jt,ur,gr,vr,Cr,xr,Br,jr,zr,Hr,Kr,kn;return ar.wrap(function(Hn){for(;;)switch(Hn.prev=Hn.next){case 0:if(At=As(this.core,"config.cdn.bucket"),jt={tag:$.nosScenes||At||"nim",expireSec:$.nosSurvivalTime},_){Hn.next=13;break}return Hn.prev=3,Hn.next=6,this.core.sendCmd("getNosToken",{responseBody:Ci($.type),nosToken:jt});case 6:ur=Hn.sent,Hn.next=13;break;case 9:throw Hn.prev=9,Hn.t0=Hn.catch(3),this.core.logger.error("uploadFile:: getNosToken error",Hn.t0),new El("getNosToken error",Hn.t0,1);case 13:return Hn.prev=13,vr=ur?ur.content.nosToken:_,this.core.logger.debug("uploadFile:: uploadFile params",{nosToken:vr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,platform:Ho.platform}),Hn.next=18,this.core.adapters.uploadFile(Mr(Mr({},$),{nosToken:vr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,maxSize:$.maxSize||this.config.chunkMaxSize}));case 18:gr=Hn.sent,Hn.next=42;break;case 21:if(Hn.prev=21,Hn.t1=Hn.catch(13),this.core.logger.error("uploadFile::nos uploadFile error",Hn.t1),!_){Hn.next=41;break}if(this.nosErrorCount!==0){Hn.next=37;break}Hn.prev=26,this._addCircuitTimer(),Hn.next=33;break;case 30:throw Hn.prev=30,Hn.t2=Hn.catch(26),new El("upload file error",Hn.t2,this.curProvider,this.mixStorePolicy,$.file||$.filePath);case 33:return this.nosErrorCount=(Y=this.mixStorePolicy.nosPolicy)===null||Y===void 0?void 0:Y.uploadConfig.retryPolicy.retry,Hn.abrupt("return",this.uploadFile($));case 37:return this.nosErrorCount--,Hn.abrupt("return",this.nosUpload($,_));case 39:Hn.next=42;break;case 41:throw new El("nos uploadFile error",Hn.t1,1);case 42:if(Cr=gr==null?void 0:gr.type,xr=Cr&&ka(Cr).call(Cr,"/")>-1?Co(Cr).call(Cr,0,ka(Cr).call(Cr,"/")):"",Br={image:"imageInfo",video:"vinfo",audio:"vinfo"},jr=this.config.uploadReplaceFormat.replace("{host}",this.config.cdn.cdnDomain||this.config.cdn.defaultCdnDomain).replace("{object}",ur?ur.content.nosToken.objectName:_==null?void 0:_.objectName),_&&_.shortUrl&&(jr=_.shortUrl),Br[xr]){Hn.next=49;break}return Hn.abrupt("return",Mr({url:jr},gr));case 49:if(Hn.prev=49,!(ka(jr).call(jr,"_im_url=1")<0)){Hn.next=54;break}return Hn.next=53,this.core.adapters.request(jr+"?"+Br[xr],{method:"GET",dataType:"json",timeout:5e3});case 53:zr=Hn.sent;case 54:Hn.next=60;break;case 56:return Hn.prev=56,Hn.t3=Hn.catch(49),this.core.logger.error("uploadFile:: fetch file info error",Hn.t3),Hn.abrupt("return",Mr({url:jr},gr));case 60:if(!zr){Hn.next=67;break}return Hr=zr.data,Kr=Br[xr]==="imageInfo"?Hr:(Oe=Hr==null?void 0:Hr.GetVideoInfo)===null||Oe===void 0?void 0:Oe.VideoInfo,kn={url:jr,name:gr.name,size:gr.size,ext:gr.ext,w:Kr.Width,h:Kr.Height,orientation:Kr.Orientation,dur:Kr.Duration,audioCodec:Kr.AudioCodec,videoCodec:Kr.VideoCodec,container:Kr.Container},Hn.abrupt("return",On(kn,function(xo,Ln){return Ln!==void 0}));case 67:return Hn.abrupt("return",Mr({url:jr},gr));case 68:case"end":return Hn.stop()}},pe,this,[[3,9],[13,21],[26,30],[49,56]])}))},M.getNosCdnHost=function(){var $;return Sn(this,void 0,void 0,ar.mark(function _(){var Y,Oe,pe,At=this;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return ur.prev=0,ur.next=3,this.core.sendCmd("getNosCdnHost");case 3:Y=ur.sent,ur.next=10;break;case 6:return ur.prev=6,ur.t0=ur.catch(0),this.logger.error("getNosCdnHost::error",ur.t0),ur.abrupt("return");case 10:if(Y){ur.next=12;break}return ur.abrupt("return");case 12:Oe=($=Y==null?void 0:Y.content)===null||$===void 0?void 0:$.nosConfigTag,(pe=_o(Oe==null?void 0:Oe.expire))!==0&&Oe.cdnDomain?pe===-1?(this.config.cdn.bucket=Oe.bucket,this.config.cdn.cdnDomain=Oe.cdnDomain,this.config.cdn.objectNamePrefix=Oe.objectNamePrefix):(this.config.cdn.bucket=Oe.bucket,this.config.cdn.cdnDomain=Oe.cdnDomain,this.config.cdn.objectNamePrefix=Oe.objectNamePrefix,this.nosCdnHostTimer=this.core.timerManager.addTimer(function(){At.getNosCdnHost()},1e3*pe)):(this.config.cdn.bucket="",this.config.cdn.cdnDomain="",this.config.cdn.objectNamePrefix="");case 15:case"end":return ur.stop()}},_,this,[[0,6]])}))},M.getGrayscaleConfig=function($){var _;return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(Ho.localStorage)try{Ho.localStorage.getItem&&Ho.localStorage.getItem(this.GRAYKEY)&&(this.grayConfig=JSON.parse(Ho.localStorage.getItem(this.GRAYKEY))[$])}catch(ur){Ho.localStorage.getItem(this.GRAYKEY)&&this.core.logger.error("uploadFile:: JSON.parse grayscaleConfig error ",ur)}if(this.grayConfig&&!(this.grayConfig.timeStamp+1e3*this.grayConfig.ttl<new Date().getTime())){jt.next=17;break}return jt.next=4,this.core.sendCmd("getGrayscaleConfig",{config:{}});case 4:if(!(Oe=jt.sent).content||!Oe.content.grayConfigTag){jt.next=16;break}this.logger.log("uploadFile::getAppGrayConfigRequest success ");try{this.grayConfig=JSON.parse(Oe.content.grayConfigTag.config),this.grayConfig.ttl=JSON.parse(Oe.content.grayConfigTag.ttl)}catch(ur){this.logger.error("getGrayscaleConfig error",ur)}if(this.grayConfig){jt.next=10;break}return jt.abrupt("return");case 10:pe=Ho.localStorage.getItem(this.GRAYKEY)?JSON.parse(Ho.localStorage.getItem(this.GRAYKEY)):{},this.grayConfig.timeStamp=new Date().getTime(),pe[$]=this.grayConfig,Ho.localStorage.setItem(this.GRAYKEY,Wo(pe)),jt.next=17;break;case 16:this.logger.debug("uploadFile:: result grayConfig:",Oe.content);case 17:if(!(!((_=this.grayConfig)===null||_===void 0)&&_.mixStoreEnable)){jt.next=20;break}return jt.next=20,this._getMixStorePolicy($);case 20:case"end":return jt.stop()}},Y,this)}))},M._getMixStorePolicy=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var Y,Oe,pe,At,jt,ur,gr;return ar.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:if(Y=new Date().getTime(),Ho.localStorage)try{this.mixStorePolicy=JSON.parse(Ho.localStorage.getItem(this.MIXSTOREKEY))[$],this.curProvider=_o(this.mixStorePolicy.providers[0]),this.mixStorePolicy.timeStamp&&this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl>Y&&(pe=this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl-Y,this.core.timerManager.addTimer(Oo(Oe=this._getMixStorePolicy).call(Oe,this,$),pe))}catch(xr){Ho.localStorage.getItem(this.MIXSTOREKEY)&&JSON.parse(Ho.localStorage.getItem(this.MIXSTOREKEY))[$]&&this.core.logger.error("uploadFile:: JSON.parse mixStorePolicy error ",xr)}if(this.mixStorePolicy&&!(this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl<=Y)){Cr.next=30;break}return Cr.prev=3,Cr.next=6,this.core.sendCmd("getMixStorePolicy",{supportType:this.s3?[1,2]:[1]});case 6:jt=Cr.sent,ur=jt.content.mixStorePolicyTag,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.mixStorePolicy.ttl=Number(ur.ttl),this.mixStorePolicy.providers=ur.providers.split(","),this.circuitTimer&&this.core.timerManager.deleteTimer(this.circuitTimer),this.curProvider=_o(this.mixStorePolicy.providers[0]),this.mixStorePolicy.nosPolicy=ur.nosPolicy?JSON.parse(ur.nosPolicy):null,this.mixStorePolicy.s3Policy=ur.s3Policy?JSON.parse(ur.s3Policy):null,this.mixStorePolicy.s3Policy===null?this.mixStorePolicy.providers=["1"]:this.mixStorePolicy.nosPolicy===null?this.mixStorePolicy.providers=["2"]:this.mixStorePolicy.providers=this.mixStorePolicy.s3Policy.priority<this.mixStorePolicy.nosPolicy.priority?["2","1"]:["1","2"],this.core.timerManager.addTimer(Oo(At=this._getMixStorePolicy).call(At,this,$),1e3*this.mixStorePolicy.ttl),gr=Ho.localStorage.getItem(this.MIXSTOREKEY)?JSON.parse(Ho.localStorage.getItem(this.MIXSTOREKEY)):{},this.mixStorePolicy.timeStamp=new Date().getTime(),gr[$]=this.mixStorePolicy,Ho.localStorage.setItem(this.MIXSTOREKEY,Wo(gr)),Cr.next=30;break;case 23:if(Cr.prev=23,Cr.t0=Cr.catch(3),this.logger.error("getMixStorePolicy error",Cr.t0),this.mixStoreErrorCount!==0){Cr.next=28;break}throw new Error("getMixStorePolicy all count error");case 28:this._getMixStorePolicy($),this.mixStoreErrorCount--;case 30:this.mixStorePolicy.nosPolicy&&(this.nosErrorCount=this.mixStorePolicy.nosPolicy.uploadConfig.retryPolicy.retry);case 31:case"end":return Cr.stop()}},_,this,[[3,23]])}))},M.s3Upload=function($,_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe,At,jt,ur,gr,vr,Cr,xr,Br,jr=this;return ar.wrap(function(Hr){for(;;)switch(Hr.prev=Hr.next){case 0:if(!$.file){Hr.next=4;break}Oe=$.file,Hr.next=19;break;case 4:if(typeof $.fileInput!="string"){Hr.next=14;break}if(this.logger.warn("fileInput will abandon,Please use file or filepath"),!((pe=document.getElementById($.fileInput))&&pe.files&&pe.files[0])){Hr.next=11;break}Oe=pe.files[0],Hr.next=12;break;case 11:throw new Error("Can not get file from fileInput");case 12:Hr.next=19;break;case 14:if(!($.fileInput&&$.fileInput.files&&$.fileInput.files[0])){Hr.next=18;break}Oe=$.fileInput.files[0],Hr.next=19;break;case 18:throw new Error("Can not get file from fileInput "+$.fileInput);case 19:if(this.mixStorePolicy.s3Policy){Hr.next=21;break}throw new Error("dont get s3 policy");case 21:return At={accessKeyId:_.accessKeyId,secretAccessKey:_.secretAccessKey,sessionToken:_.sessionToken,region:_.region,maxRetries:this.mixStorePolicy.s3Policy.uploadConfig.retryPolicy.retry},jt=this.s3,(ur=new jt).config.update(At),gr=decodeURIComponent(_.bucket),vr=decodeURIComponent(_.objectName),xr={Bucket:gr,Key:vr,Body:Cr=Oe,Metadata:{token:_.token},ContentType:Cr.type||"application/octet-stream"},this.core.logger.debug("uploadFile:: s3 upload params:",xr),Br=ur.upload(xr),Hr.abrupt("return",new co(function(Kr){var kn=new Date().getTime();Br.send(function(Jn,Hn){var xo,Ln;if(Jn){jr.logger.error("uploadFile:","api::s3:upload file failed",Jn),jr.core.reporter.reportTraceStart("exceptions",{user_id:jr.core.options.account,trace_id:(Ln=(xo=jr.core)===null||xo===void 0?void 0:xo.socket)===null||Ln===void 0?void 0:Ln.sessionId,start_time:kn,action:1}),jr.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof Jn.status=="number"?Jn.status:typeof Jn.code=="number"?Jn.code:0,description:Jn.message||""+Jn.code,operation_type:1,target:Jn.hostname}),jr.core.reporter.reportTraceEnd("exceptions",1);try{jr._addCircuitTimer()}catch(Pn){throw new El("upload file error",Pn,jr.curProvider,jr.mixStorePolicy,$.file||$.filePath)}Kr(jr.uploadFile($))}else{var _r=jr.mixStorePolicy.s3Policy.cdnSchema;_r=(_r=_r.replace("{cdnDomain}",jr.mixStorePolicy.s3Policy.dlcdn)).replace("{objectName}",Hn.Key),Kr({size:Cr.size,name:Cr.name,url:_.shortUrl?_.shortUrl:_r,ext:Cr.name.split(".")[1]||"unknown"})}})}));case 32:case"end":return Hr.stop()}},Y,this)}))},M.getPrivateUrl=function($){var _;if(!new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?/).test($))return this.logger.error("illegal file url:"+$),"";var Y=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/.exec($);Y[0];var Oe=Y[1];Y[2];var pe=Y[3];Y[4];var At=Y[5];if(Y[6],Y[7],(_=this.grayConfig)===null||_===void 0?void 0:_.mixStoreEnable){var jt=this._getUrlType($);return jt===go.s3&&this.mixStorePolicy.s3Policy&&($=this.mixStorePolicy.s3Policy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.s3Policy.dlcdn).replace("{objectName}",At)),jt===go.nos&&this.mixStorePolicy.nosPolicy&&($=this.mixStorePolicy.nosPolicy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.nosPolicy.dlcdn).replace("{objectName}",At)),$}var ur=this.config,gr=ur.downloadUrl,vr=ur.downloadHostList,Cr=ur.nosCdnEnable,xr=this.config.cdn.cdnDomain,Br=this.config.cdn.objectNamePrefix?decodeURIComponent(this.config.cdn.objectNamePrefix):"",jr=decodeURIComponent(At),zr=ka(jr).call(jr,Br);if(xr&&zr>-1&&Cr)return""+Oe+xr+"/"+Co(jr).call(jr,zr);if(bc(vr).call(vr,pe)&&bc(At).call(At,"/")){var Hr=ka(At).call(At,"/"),Kr=At.substring(0,Hr),kn=At.substring(Hr+1);return gr.replace("{bucket}",Kr).replace("{object}",kn)}var Jn=is(vr).call(vr,function(xo){return typeof pe=="string"&&bc(pe).call(pe,xo)})[0],Hn=Jn?pe.replace(Jn,"").replace(/\W/g,""):null;return Hn?gr.replace("{bucket}",Hn).replace("{object}",At):$},M.getOriginUrl=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var Y;return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return pe.next=2,this.core.sendCmd("getOriginUrl",{nosSafeUrlTag:{safeUrl:$}});case 2:return Y=pe.sent,pe.abrupt("return",Y.content.nosSafeUrlTag.originUrl);case 4:case"end":return pe.stop()}},_,this)}))},M.getFileToken=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var Y,Oe,pe,At,jt,ur=this;return ar.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:if(En({type:{type:"number",min:2,max:3},urls:{type:"array",required:!1,itemType:"string"}},$),Y=this.mixStorePolicy.nosPolicy?this.mixStorePolicy.nosPolicy.authPolicy.policyType:null,Oe=this.mixStorePolicy.s3Policy?this.mixStorePolicy.s3Policy.authPolicy.policyType:null,Y!==String(Zo.dontNeed)||Oe!==String(Zo.dontNeed)){vr.next=8;break}throw this.logger.error("don't need token"),new Error("don't need token");case 8:if($.type!==Zo.time){vr.next=17;break}if(!(Y&&ka(Y).call(Y,String(Zo.time))>=0||Oe&&ka(Oe).call(Oe,String(Zo.time))>0)){vr.next=13;break}return vr.abrupt("return",this.getFileAuthToken($));case 13:throw this.logger.error("don't support time token "),new Error("don't support type time token ");case 15:vr.next=33;break;case 17:if($.urls&&$.urls.length){vr.next=20;break}throw this.logger.error("urls is required when urls token"),new Error("urls is required when urls token");case 20:if(At=[],jt=[],In(pe=$.urls).call(pe,function(Cr){var xr=ur._getUrlType(Cr);xr===go.nos&&jt.push(Cr),xr===go.s3&&At.push(Cr)}),(!Oe||At.length!==0&&ka(Oe).call(Oe,String(Zo.urls))<0)&&(this.logger.warn("s3 url don't support url token"),At=[]),(!Y||jt.length!==0&&ka(Y).call(Y,String(Zo.urls))<0)&&(this.logger.warn("nos url don't support url token"),jt=[]),At.length!==0||jt.length!==0){vr.next=30;break}throw this.logger.error("not support urls"),new Error("not support urls");case 30:if(At.length!==0&&jt.length!==0){vr.next=33;break}return $.urls=Wo($.urls),vr.abrupt("return",this.getFileAuthToken($));case 33:case"end":return vr.stop()}},_,this)}))},M.getFileAuthToken=function($){return Sn(this,void 0,void 0,ar.mark(function _(){var Y;return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return pe.next=2,this.core.sendCmd("getFileAuthToken",{mixStoreAuthTokenReqTag:$});case 2:return Y=pe.sent,pe.abrupt("return",Y.content.mixStoreAuthTokenResTag);case 4:case"end":return pe.stop()}},_,this)}))},M._getUrlType=function($){var _,Y;return this.mixStorePolicy.nosPolicy&&Nn(_=this.mixStorePolicy.nosPolicy.dlcdns).call(_,function(Oe){return ka($).call($,Oe)>=0})?go.nos:this.mixStorePolicy.s3Policy&&Nn(Y=this.mixStorePolicy.s3Policy.dlcdns).call(Y,function(Oe){return ka($).call($,Oe)>=0})?go.s3:null},M._addCircuitTimer=function(){var $=this,_=this.mixStorePolicy.providers,Y=_[(ka(_).call(_,String(this.curProvider))+1)%_.length];if(Y===_[0])throw new Error("uploadFile all policy fail");var Oe=As(this.mixStorePolicy,"s3Policy.uploadConfig.retryPolicy");if(Oe&&Oe.retryNext&&Y&&(this.logger.log("uploadFile:: upload policy will change,now policy:"+this.curProvider+" nextProvider:"+Y),this.curProvider=_o(Y),this.mixStorePolicy.nosPolicy&&this.mixStorePolicy.s3Policy)){var pe=this.mixStorePolicy[this.curProvider===go.nos?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!pe||pe===0)return;this.circuitTimer=this.core.timerManager.addTimer(function(){$.logger.log("uploadFile:: upload policy will change,now policy:"+$.curProvider+" nextProvider:"+_o($.mixStorePolicy.providers[0])),$.curProvider=_o($.mixStorePolicy.providers[0]),$.core.timerManager.deleteTimer($.circuitTimer)},1e3*pe)}},M.process=function($){var _=this[$.cmd+"Handler"];return typeof _=="function"?_.call(this,$):$.error&&!$.error.ignore?co.reject($.error):co.resolve($)},w}(),Mi=Ga({none:0,normal:1,all:3}),$a=Ga({normal:0,advanced:1}),lo=Ga({normal:0,owner:1,manager:2}),Go={noVerify:0,needVerify:1,rejectAll:2},zn=Ga(Go),Bo={needVerify:0,noVerify:1},Qa=Ga(Bo),Qn={manager:0,all:1},Gy=Ga(Qn),qh={manager:0,all:1},xs=Ga(qh),Is={manager:0,all:1},wa=Ga(Is);function Qo(w){var M,L=["teamId"],$=["level","memberNum","memberUpdateTime","createTime","updateTime"],_=["valid","validToCurrentUser","mute"],Y={type:$a,muteType:Mi,joinMode:zn,beInviteMode:Qa,inviteMode:Gy,updateTeamMode:xs,updateExtMode:wa};w.bits;var Oe=Es(w,["bits"]);return In(L).call(L,function(pe){Oe[pe]&&(Oe[pe]=Oe[pe].toString())}),In($).call($,function(pe){Oe[pe]!==void 0&&(Oe[pe]=_o(Oe[pe]))}),In(_).call(_,function(pe){Oe[pe]!==void 0&&(Oe[pe]=_o(Oe[pe])===1)}),In(M=Vo(Y)).call(M,function(pe){Oe[pe]!==void 0&&(Oe[pe]=Y[pe][Oe[pe]]||Oe[pe])}),Oe}function ma(w){return w&&w.length>0?To(w).call(w,function(M){return Qo(M)}):[]}function Kd(w){var M,L=Mr({},w),$=["avatar","name","intro","announcement","ext"],_={joinMode:Go,beInviteMode:Bo,inviteMode:Qn,updateTeamMode:qh,updateExtMode:Is};return In($).call($,function(Y){L[Y]!==void 0&&(L[Y]=L[Y].toString())}),In(M=Vo(_)).call(M,function(Y){L[Y]!==void 0&&(L[Y]=_[Y][L[Y]])}),L}function kC(w){var M=["teamId","ext","account","nickInTeam"],L={};return w.bitConfigMask!==void 0&&(L.bits=_o(w.bitConfigMask)),In(M).call(M,function($){w[$]&&(L[$]=w[$].toString())}),L}function Ks(w){var M,L=["teamId"],$=["joinTime","updateTime","bitConfigMask"],_=["active","valid","mute"],Y={type:lo},Oe=w.bits,pe=Es(w,["bits"]);return Oe!==void 0&&(pe.muteTeam=_o(Oe)===1,pe.bitConfigMask=Oe),pe.id=pe.teamId+"-"+pe.account,In(L).call(L,function(At){pe[At]&&(pe[At]=pe[At].toString())}),In($).call($,function(At){pe[At]!==void 0&&(pe[At]=_o(pe[At]))}),In(_).call(_,function(At){pe[At]!==void 0&&(pe[At]=_o(pe[At])===1)}),In(M=Vo(Y)).call(M,function(At){pe[At]!==void 0&&(pe[At]=Y[At][pe[At]]||pe[At])}),pe}function Wd(w){return w&&w.length>0?To(w).call(w,function(M){return Ks(M)}):[]}function of(w,M,L){return L===void 0&&(L="normal"),{id:w.teamId+"-"+M,teamId:w.teamId,account:M,type:L,nickInTeam:"",muteTeam:!1,mute:!1,joinTime:w.memberUpdateTime,updateTime:w.memberUpdateTime,active:!0,valid:!0}}function Vh(w,M,L){return L===void 0&&(L="normal"),M&&M.length>0?To(M).call(M,function($){return of(w,$,L)}):[]}var NC=function(){function w(L){this.core=L}var M=w.prototype;return M.notifyAddSuperTeamMembers=function($,_){this.core.emit("addSuperTeamMembers",{team:$,accounts:_,members:Vh($,_)})},M.notifyUpdateSuperTeamManagers=function($,_,Y,Oe){this.core.emit("updateSuperTeamManagers",{team:{teamId:$,memberUpdateTime:Oe},accounts:_,isManager:Y,members:To(_).call(_,function(pe){return{id:$+"-"+pe,type:"manager",account:pe,updateTime:Oe}})})},M.notifyRemoveSuperTeamMembers=function($,_){this.core.emit("removeSuperTeamMembers",{team:$,accounts:_})},M.notifyTransferSuperTeam=function($,_,Y){this.core.emit("transferSuperTeam",{team:$,from:{id:$.teamId+"-"+_,account:_,type:"normal",updateTime:$.memberUpdateTime},to:{id:$.teamId+"-"+Y,account:Y,type:"owner",updateTime:$.memberUpdateTime}})},M.notifyUpdateSuperTeamMembersMute=function($,_,Y){this.core.emit("updateSuperTeamMembersMute",{team:$,accounts:_,members:To(_).call(_,function(Oe){return{id:$.teamId+"-"+Oe,account:Oe,teamId:$.teamId,mute:Y,updateTime:$.memberUpdateTime}}),mute:Y})},w}(),RC={"21_5":"addSuperTeamMembers","21_6":"removeSuperTeamMembers","21_7":"leaveSuperTeam","21_8":"updateSuperTeamInfo","21_9":"getSuperTeamInfo","21_12":"getSuperTeams","21_15":"getSuperTeamMembers","21_10":"updateMySuperTeamMemberInfo","21_20":"applySuperTeam","21_21":"passSuperTeamApply","21_22":"rejectSuperTeamApply","21_23":"acceptSuperTeamInvite","21_24":"rejectSuperTeamInvite","21_26":"addSuperTeamManagers","21_27":"removeSuperTeamManagers","21_28":"muteSuperTeam","21_29":"muteSuperTeamMembers","21_30":"updateSuperTeamMemberNick","21_31":"transferSuperTeam","21_33":"getSuperTeamMembersByAccounts","21_34":"queryMuteSuperTeamMembers","21_101":"syncCreateSuperTeam","21_109":"syncSuperTeams","21_110":"syncUpdateSuperTeamMember","21_111":"syncMySuperTeamMembers"},Qy={superTeam:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,ext:18,serverExt:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateExtMode:24,mute:100,muteType:101},superTeamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,updateTime:11,ext:12,mute:13,invitorAccid:14,joinTime:15}},Bc=rs(Qy),BC={getSuperTeamInfo:{sid:21,cid:9,service:"superTeam",params:[{type:"Long",name:"teamId"}],response:[{type:"Property",name:"superTeam",reflectMapper:Bc.superTeam}]},getSuperTeams:{sid:21,cid:12,service:"superTeam",params:[{type:"long",name:"timetag"}],response:[{type:"PropertyArray",name:"superTeams",reflectMapper:Bc.superTeam},{type:"Number",name:"timetag"}]},updateSuperTeamInfo:{sid:21,cid:8,service:"superTeam",params:[{type:"Property",name:"superTeam",reflectMapper:Qy.superTeam}],response:[{type:"Number",name:"time"}]},addSuperTeamMembers:{sid:21,cid:5,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}],response:[{type:"StrArray",name:"abortedAccidList"},{type:"Long",name:"time"}]},removeSuperTeamMembers:{sid:21,cid:6,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},addSuperTeamManagers:{sid:21,cid:26,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeSuperTeamManagers:{sid:21,cid:27,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},applySuperTeam:{sid:21,cid:20,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"ps"}],response:[{type:"Property",name:"superTeam",reflectMapper:Bc.superTeam}]},transferSuperTeam:{sid:21,cid:31,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},muteSuperTeam:{sid:21,cid:28,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"Int",name:"mute"}]},muteSuperTeamMembers:{sid:21,cid:29,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"Int",name:"mute"}]},updateSuperTeamMemberNick:{sid:21,cid:30,service:"superTeam",params:[{type:"Property",name:"teamMember",reflectMapper:Qy.superTeamMember}]},updateMySuperTeamMemberInfo:{sid:21,cid:10,service:"superTeam",params:[{type:"Property",name:"teamMember",reflectMapper:Qy.superTeamMember}]},getSuperTeamMembersByAccounts:{sid:21,cid:33,service:"superTeam",params:[{type:"StrArray",name:"memberIds"}],response:[{type:"PropertyArray",name:"superTeamMembers",reflectMapper:Bc.superTeamMember}]},getSuperTeamMembers:{sid:21,cid:15,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"Long",name:"joinTime"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"}],response:[{type:"PropertyArray",name:"superTeamMembers",reflectMapper:Bc.superTeamMember}]},queryMuteSuperTeamMembers:{sid:21,cid:34,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"Long",name:"joinTime"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"}],response:[{type:"PropertyArray",name:"superTeamMembers",reflectMapper:Bc.superTeamMember}]},leaveSuperTeam:{sid:21,cid:7,service:"superTeam",params:[{type:"Long",name:"teamId"}]},passSuperTeamApply:{sid:21,cid:21,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamApply:{sid:21,cid:22,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},acceptSuperTeamInvite:{sid:21,cid:23,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamInvite:{sid:21,cid:24,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},syncSuperTeams:{sid:21,cid:109,service:"superTeam",response:[{type:"PropertyArray",name:"teams",reflectMapper:Bc.superTeam},{type:"Bool",name:"isAll"},{type:"Long",name:"timetag"}]},syncCreateSuperTeam:{sid:21,cid:101,service:"superTeam",response:[{type:"Property",name:"superTeam",reflectMapper:Bc.superTeam}]},syncUpdateSuperTeamMember:{sid:21,cid:110,service:"superTeam",response:[{type:"Property",name:"teamMember",reflectMapper:Bc.superTeamMember}]},syncMySuperTeamMembers:{sid:21,cid:111,ext:"sync",service:"superTeam",response:[{type:"PropertyArray",name:"teamMembers",reflectMapper:Bc.superTeamMember},{type:"Number",name:"timetag"}]}},FC=function(w){function M($){var _;return(_=w.call(this,"superTeam",$)||this).mySuperTeamMembersMap=new ec,_.service=new NC($),qa({cmdMap:RC,cmdConfig:BC}),_.core.eventBus.on("team/onNotification",function(Y){return _.notificationHandler(Y)}),_}Ro(M,w);var L=M.prototype;return L.mergeMySuperTeamMembers=function(_){var Y=this;In(_).call(_,function(Oe){var pe=Oe.teamId,At=Y.mySuperTeamMembersMap.get(pe),jt=Mr({},At,Oe);Y.mySuperTeamMembersMap.set(pe,jt)})},L.getSuperTeamInfo=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_),jt.next=3,this.core.sendCmd("getSuperTeamInfo",{teamId:_.teamId});case 3:return Oe=jt.sent,pe=Oe.content.superTeam,jt.abrupt("return",Qo(pe));case 6:case"end":return jt.stop()}},Y,this)}))},L.getSuperTeams=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var Y,Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return At.next=2,this.core.sendCmd("getSuperTeams",{timetag:0});case 2:return Y=At.sent,Oe=Y.content.superTeams,At.abrupt("return",ma(Oe));case 5:case"end":return At.stop()}},_,this)}))},L.updateSuperTeamInfo=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},name:{type:"string",allowEmpty:!1,required:!1},joinMode:{type:"enum",values:["noVerify","needVerify","rejectAll"],required:!1},beInviteMode:{type:"enum",values:["noVerify","needVerify"],required:!1},inviteMode:{type:"enum",values:["manager","all"],required:!1},updateTeamMode:{type:"enum",values:["manager","all"],required:!1},updateExtMode:{type:"enum",values:["manager","all"],required:!1},intro:{type:"string",allowEmpty:!1,required:!1},announcement:{type:"string",allowEmpty:!1,required:!1},avatar:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",allowEmpty:!1,required:!1}},_),Oe=Kd(_),At.next=4,this.core.sendCmd("updateSuperTeamInfo",{superTeam:Oe});case 4:return At.abrupt("return",Qo(Oe));case 5:case"end":return At.stop()}},Y,this)}))},L.addSuperTeamMembers=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},_),pe.next=3,this.core.sendCmd("addSuperTeamMembers",{teamId:_.teamId,accounts:_.accounts,ps:_.ps||"",attach:_.ext||""});case 3:case"end":return pe.stop()}},Y,this)}))},L.removeSuperTeamMembers=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1}},_),pe.next=3,this.core.sendCmd("removeSuperTeamMembers",{teamId:_.teamId,accounts:_.accounts});case 3:case"end":return pe.stop()}},Y,this)}))},L.addSuperTeamManagers=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},_),pe.next=3,this.core.sendCmd("addSuperTeamManagers",_);case 3:case"end":return pe.stop()}},Y,this)}))},L.removeSuperTeamManagers=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},_),pe.next=3,this.core.sendCmd("removeSuperTeamManagers",_);case 3:case"end":return pe.stop()}},Y,this)}))},L.applySuperTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},_),At.next=3,this.core.sendCmd("applySuperTeam",{teamId:_.teamId,ps:_.ps||""});case 3:return Oe=At.sent,At.abrupt("return",Qo(Oe.content.superTeam));case 5:case"end":return At.stop()}},Y,this)}))},L.transferSuperTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},leave:{type:"boolean"}},_),pe.next=3,this.core.sendCmd("transferSuperTeam",_);case 3:case"end":return pe.stop()}},Y,this)}))},L.muteSuperTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},mute:{type:"boolean"}},_),pe.next=3,this.core.sendCmd("muteSuperTeam",{teamId:_.teamId,mute:_.mute?1:0});case 3:case"end":return pe.stop()}},Y,this)}))},L.muteSuperTeamMembers=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string"},mute:{type:"boolean"}},_),pe.next=3,this.core.sendCmd("muteSuperTeamMembers",{teamId:_.teamId,accounts:_.accounts,mute:_.mute?1:0});case 3:case"end":return pe.stop()}},Y,this)}))},L.updateMemberNick=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1}},_),Oe=kC({teamId:_.teamId,nickInTeam:_.nickInTeam,account:_.account}),jt.next=4,this.core.sendCmd("updateSuperTeamMemberNick",{teamMember:Oe});case 4:return pe=Ks(Mr({updateTime:new Date().getTime()},Oe)),jt.abrupt("return",pe);case 6:case"end":return jt.stop()}},Y,this)}))},L.updateMyMemberInfo=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1,required:!1},bitConfigMask:{type:"number",min:0,max:2,required:!1},ext:{type:"string",required:!1}},_),Oe=kC({teamId:_.teamId,nickInTeam:_.nickInTeam,bitConfigMask:_.bitConfigMask,ext:_.ext}),ur.next=4,this.core.sendCmd("updateMySuperTeamMemberInfo",{teamMember:Oe});case 4:return pe=Ks(Mr({updateTime:new Date().getTime(),account:this.core.account},Oe)),this.mergeMySuperTeamMembers([pe]),this.core.emit("updateSuperTeamMember",pe),At=fc(this.mySuperTeamMembersMap.get(pe.teamId)),this.core.emit("mySuperTeamMembers",[At]),ur.abrupt("return",pe);case 10:case"end":return ur.stop()}},Y,this)}))},L.getSuperTeamMembersByAccounts=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",max:20,min:1}},_),At=To(pe=_.accounts).call(pe,function(vr){return _.teamId+"|"+vr}),gr.next=4,this.core.sendCmd("getSuperTeamMembersByAccounts",{memberIds:At});case 4:return jt=gr.sent,gr.abrupt("return",Wd((Y=jt.content)===null||Y===void 0?void 0:Y.superTeamMembers));case 6:case"end":return gr.stop()}},Oe,this)}))},L.getSuperTeamMembers=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},joinTime:{type:"number",min:0,required:!1},limit:{type:"number",min:1,max:1e3,required:!1},reverse:{type:"boolean",required:!1}},_),jt.next=3,this.core.sendCmd("getSuperTeamMembers",Mr({joinTime:0,limit:100,reverse:!1},_));case 3:return pe=jt.sent,jt.abrupt("return",Wd((Y=pe.content)===null||Y===void 0?void 0:Y.superTeamMembers));case 5:case"end":return jt.stop()}},Oe,this)}))},L.queryMuteMembers=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},joinTime:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1},reverse:{type:"boolean",required:!1}},_),jt.next=3,this.core.sendCmd("queryMuteSuperTeamMembers",Mr({limit:100,joinTime:0,reverse:!1},_));case 3:return Oe=jt.sent,pe=Oe.content,jt.abrupt("return",Wd(pe.superTeamMembers));case 6:case"end":return jt.stop()}},Y,this)}))},L.leaveSuperTeam=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_),pe.next=3,this.core.sendCmd("leaveSuperTeam",{teamId:_.teamId});case 3:case"end":return pe.stop()}},Y,this)}))},L.passSuperTeamApply=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},_),pe.next=3,this.core.sendCmd("passSuperTeamApply",_);case 3:case"end":return pe.stop()}},Y,this)}))},L.rejectSuperTeamApply=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},_),pe.next=3,this.core.sendCmd("rejectSuperTeamApply",{teamId:_.teamId,from:_.from,ps:_.ps||""});case 3:case"end":return pe.stop()}},Y,this)}))},L.acceptSuperTeamInvite=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},_),pe.next=3,this.core.sendCmd("acceptSuperTeamInvite",_);case 3:case"end":return pe.stop()}},Y,this)}))},L.rejectSuperTeamInvite=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},_),pe.next=3,this.core.sendCmd("rejectSuperTeamInvite",{teamId:_.teamId,from:_.from,ps:_.ps||""});case 3:case"end":return pe.stop()}},Y,this)}))},L.syncSuperTeamsHandler=function(_){var Y=_.content;this.core.eventBus.emit("sync/updateTimetag",{superTeams:_o(Y.timetag)});var Oe=Y==null?void 0:Y.superTeams;if(Oe&&Oe.length){var pe=ma(Oe);this.core.emit("superTeams",pe)}},L.syncCreateSuperTeamHandler=function(_){var Y=_.content,Oe=Qo(Y==null?void 0:Y.superTeam),pe=of(Oe,Oe.owner,"owner");this.core.emit("createSuperTeam",Oe,pe)},L.syncUpdateSuperTeamMemberHandler=function(_){var Y=_.content,Oe=Ks(Y==null?void 0:Y.teamMember);Oe.updateTime||(Oe.updateTime=new Date().getTime()),this.mergeMySuperTeamMembers([Oe]),this.core.emit("updateSuperTeamMember",Oe);var pe=fc(this.mySuperTeamMembersMap.get(Oe.teamId));this.core.emit("mySuperTeamMembers",[pe])},L.syncMySuperTeamMembersHandler=function(_){var Y,Oe=_.content;this.core.eventBus.emit("sync/updateTimetag",{mySuperTeamMembers:_o(Oe.timetag)});var pe=Oe==null?void 0:To(Y=Oe.teamMembers).call(Y,function(At){return Ks(At)});this.mergeMySuperTeamMembers(pe),this.core.emit("mySuperTeamMembers",fc(pe))},L.notificationHandler=function(_){var Y=_.attach,Oe=_.scene,pe=_.from,At=_.to,jt=_.time,ur=_.idServer,gr=_.idClient,vr=Y.team,Cr=Y.account,xr=Y.accounts,Br=Y.type;if(Oe==="superTeam")switch(this.core.options.debugLevel==="debug"?this.logger.debug("superTeam::recvNotification",ur,gr,Y):this.logger.log("superTeam::recvNotification",ur,gr,At,Br,Cr,xr),Br){case"updateSuperTeam":vr.updateTime=jt,this.core.emit("updateSuperTeam",vr);break;case"addSuperTeamMembers":this.service.notifyAddSuperTeamMembers(vr,xr);break;case"acceptSuperTeamInvite":this.service.notifyAddSuperTeamMembers(vr,[pe]);break;case"passSuperTeamApply":this.service.notifyAddSuperTeamMembers(vr,[Cr]);break;case"addSuperTeamManagers":this.service.notifyUpdateSuperTeamManagers(At,xr,!0,jt);break;case"removeSuperTeamManagers":this.service.notifyUpdateSuperTeamManagers(At,xr,!1,jt);break;case"removeSuperTeamMembers":this.service.notifyRemoveSuperTeamMembers(vr,xr);break;case"leaveSuperTeam":this.service.notifyRemoveSuperTeamMembers(vr,[pe]);break;case"dismissSuperTeam":this.core.emit("dismissSuperTeam",{teamId:At});break;case"transferSuperTeam":this.service.notifyTransferSuperTeam(vr,pe,Cr);break;case"updateSuperTeamMembersMute":this.service.notifyUpdateSuperTeamMembersMute(vr,xr,Y.mute)}},M}(os),LC={"13_1":"getChatroomAddress","24_1":"getQChatAddress"},$C={getChatroomAddress:{sid:13,cid:1,service:"plugin",params:[{type:"Long",name:"chatroomId"},{type:"Boolean",name:"isWeixinApp"},{type:"Number",name:"ipType"}],response:[{type:"StrArray",name:"address"}]},getQChatAddress:{sid:24,cid:1,service:"plugin",params:[{type:"Property",name:"getQChatAddressTag",reflectMapper:{ipType:1}}],response:[{type:"StrArray",name:"address"}]}},jC=function(w){function M($){var _;return(_=w.call(this,"plugin",$)||this).core=$,qa({cmdMap:LC,cmdConfig:$C}),_}Ro(M,w);var L=M.prototype;return L.getChatroomAddress=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({chatroomId:{type:"string",allowEmpty:!1},ipType:{type:"number",required:!1}},_),At.next=3,this.core.sendCmd("getChatroomAddress",{chatroomId:_.chatroomId,isWeixinApp:Ho.platform==="WXAPP",ipType:_.ipType||0});case 3:return Oe=At.sent,At.abrupt("return",Oe.content.address);case 5:case"end":return At.stop()}},Y,this)}))},L.getQChatAddress=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe;return ar.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:return En({ipType:{type:"number",required:!1}},_),At.next=3,this.core.sendCmd("getQChatAddress",{getQChatAddressTag:{ipType:(_==null?void 0:_.ipType)||0}});case 3:return Oe=At.sent,At.abrupt("return",Oe.content.address);case 5:case"end":return At.stop()}},Y,this)}))},M}(os),DC={"7_19":"nimQueryCloudSessionList","7_20":"nimQueryCloudSession","7_21":"nimUpdateCloudSession","7_22":"nimDeleteCloudSessionList","7_121":"nimMultiSyncUpdateCloudSession"},Hh={sessionReqTag:{minTimestamp:1,maxTimestamp:2,includedLastMsg:3,limit:4,hasMore:5},sessionTag:{sessionId:1,updateTime:2,ext:3,lastMsg:4,lastMsgType:5}},Jy=rs(Hh),UC={nimQueryCloudSessionList:{sid:7,cid:19,service:"cloudSession",params:[{type:"Property",name:"tag",reflectMapper:Hh.sessionReqTag}],response:[{type:"Property",name:"tag",reflectMapper:Jy.sessionReqTag},{type:"PropertyArray",name:"sessions",reflectMapper:Jy.sessionTag}]},nimQueryCloudSession:{sid:7,cid:20,service:"cloudSession",params:[{type:"Property",name:"tag",reflectMapper:Hh.sessionTag}],response:[{type:"Property",name:"session",reflectMapper:Jy.sessionTag}]},nimUpdateCloudSession:{sid:7,cid:21,service:"cloudSession",params:[{type:"Property",name:"tag",reflectMapper:Hh.sessionTag}]},nimDeleteCloudSessionList:{sid:7,cid:22,service:"cloudSession",params:[{type:"PropertyArray",name:"tags",reflectMapper:Hh.sessionTag}]},nimMultiSyncUpdateCloudSession:{sid:7,cid:121,service:"cloudSession",response:[{type:"Property",name:"session",reflectMapper:Jy.sessionTag}]}},qC={sessionId:{type:"string"},updateTime:{type:"number"},ext:{type:"string"},lastMsg:{type:"object"},lastMsgType:{type:"number"}};function _C(w,M,L){var $=Xs(qC,w),_=Lo($.sessionId,"|"),Y=_.accid,Oe=_.scene;if($.sessionId=Oe+"-"+Y,$.lastMsg){var pe=$.lastMsgType===1;$.lastMsgInfo=pe?{isLastMsgRecalled:pe,revokedMsg:Vd(Ii($.lastMsg,Sl.sysMsg),L)}:{isLastMsgRecalled:pe,lastMsg:Ri(Ii($.lastMsg,ss.msg),{account:M})}}return delete $.lastMsg,delete $.lastMsgType,$}function VC(w,M,L){return w&&w.length>0?To(w).call(w,function($){return _C($,M,L)}):[]}var PC,Fc,zh,HC=function(w){function M($){var _;return _=w.call(this,"cloudSession",$)||this,qa({cmdMap:DC,cmdConfig:UC}),_}Ro(M,w);var L=M.prototype;return L.queryCloudSessionList=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt,ur;return ar.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return En({minTimestamp:{type:"number",min:0,required:!1},maxTimestamp:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1},includedLastMsg:{type:"boolean",required:!1}},_),(pe=Mr({limit:100,includedLastMsg:!0},_)).includedLastMsg=tS.boolean(_,"includedLastMsg"),vr.next=5,this.core.sendCmd("nimQueryCloudSessionList",{tag:pe});case 5:return At=vr.sent,jt=((Y=At.content)===null||Y===void 0?void 0:Y.tag)||{},ur=At.content.sessions,vr.abrupt("return",{hasMore:+jt.hasMore>0,sessionList:VC(ur,this.core.account,this.logger)});case 9:case"end":return vr.stop()}},Oe,this)}))},L.queryCloudSession=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe,At,jt;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return En({sessionId:{type:"string",allowEmpty:!1}},_),Oe=Lo(_.sessionId,"-"),pe=Oe.accid,At=Oe.scene,gr.next=4,this.core.sendCmd("nimQueryCloudSession",{tag:{sessionId:At==="superTeam"?"super_team|"+pe:At+"|"+pe}});case 4:return jt=gr.sent,gr.abrupt("return",_C(jt.content.session,this.core.account,this.logger));case 6:case"end":return gr.stop()}},Y,this)}))},L.updateCloudSession=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({sessionId:{type:"string",allowEmpty:!1},ext:{type:"string",allowEmpty:!1,required:!1}},_),Oe=Lo(_.sessionId,"-"),pe=Oe.accid,At=Oe.scene,ur.next=4,this.core.sendCmd("nimUpdateCloudSession",{tag:{sessionId:At==="superTeam"?"super_team|"+pe:At+"|"+pe,ext:_.ext}});case 4:case"end":return ur.stop()}},Y,this)}))},L.deleteCloudSessionList=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return En({sessionIdList:{type:"array",itemType:"string"}},_),pe=To(Oe=_.sessionIdList).call(Oe,function(ur){var gr=Lo(ur,"-"),vr=gr.accid,Cr=gr.scene;return{sessionId:Cr==="superTeam"?"super_team|"+vr:Cr+"|"+vr}}),jt.next=4,this.core.sendCmd("nimDeleteCloudSessionList",{tags:pe});case 4:case"end":return jt.stop()}},Y,this)}))},L.nimMultiSyncUpdateCloudSessionHandler=function(_){var Y=_C(_.content.session,this.core.account,this.logger);this.core.emit("multiSyncUpdateCloudSession",Y)},M}(os);(function(w){w[w.audio=1]="audio",w[w.video=2]="video",w[w.custom=3]="custom"})(PC||(PC={})),function(w){w[w.kClose=1]="kClose",w[w.kJoin=2]="kJoin",w[w.kInvite=3]="kInvite",w[w.kCancelInvite=4]="kCancelInvite",w[w.kReject=5]="kReject",w[w.kAccept=6]="kAccept",w[w.kLeave=7]="kLeave",w[w.kCustom=8]="kCustom"}(Fc||(Fc={})),function(w){w[w.kDefault=0]="kDefault",w[w.kLeave=1]="kLeave",w[w.kSelfSync=3]="kSelfSync"}(zh||(zh={}));var wC={needPush:{type:"boolean",required:!1},pushTitle:{type:"string",required:!1},pushContent:{type:"string",required:!1},pushPayload:{type:"string",required:!1},needPushBadge:{type:"boolean",required:!1}},zC={"15_1":"signalingCreate","15_2":"signalingDelay","15_3":"signalingClose","15_4":"signalingJoin","15_5":"signalingLeave","15_6":"signalingInvite","15_7":"signalingCancelInvite","15_8":"signalingReject","15_9":"signalingAccept","15_10":"signalingSendCustomCommand","15_11":"signalingRecvNotification","15_12":"signalingMultiSyncNotification","15_13":"signalingSyncNotification","15_14":"singalingSyncChannels","15_15":"signalingQueryInfo","15_16":"signalingCallEx","15_17":"signalingJoinAndAccept"},ei={avSignalTag:Mr({type:1,name:2,channelId:3,createTime:4,expireTime:5,creatorAccid:6,ext:7,invalid:8,fromAccid:10,toAccid:11,requestId:12,members:18,attach:19,attachExt:20,needOffline:21,msgId:22,uid:23,time:24,nertcChannelName:25,nertcTokenTtl:26,nertcToken:27,nertcJoinRoomQueryParamMap:28,nertcJoinRoomResponse:29,callStatus:30},{needPush:13,pushTitle:14,pushContent:15,pushPayload:16,needPushBadge:17})},mc=rs(ei),KC={signalingCreate:{sid:15,cid:1,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ei.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:mc.avSignalTag}]},signalingDelay:{sid:15,cid:2,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ei.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:mc.avSignalTag}]},signalingClose:{sid:15,cid:3,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ei.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:mc.avSignalTag}]},signalingJoin:{sid:15,cid:4,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ei.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:mc.avSignalTag}]},signalingLeave:{sid:15,cid:5,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ei.avSignalTag}]},signalingInvite:{sid:15,cid:6,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ei.avSignalTag}]},signalingCancelInvite:{sid:15,cid:7,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ei.avSignalTag}]},signalingReject:{sid:15,cid:8,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ei.avSignalTag}]},signalingAccept:{sid:15,cid:9,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ei.avSignalTag}]},signalingSendCustomCommand:{sid:15,cid:10,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ei.avSignalTag}]},signalingRecvNotification:{sid:15,cid:11,service:"signaling",response:[{type:"Property",name:"data",reflectMapper:mc.avSignalTag}]},signalingMultiSyncNotification:{sid:15,cid:12,service:"signaling",response:[{type:"Property",name:"data",reflectMapper:mc.avSignalTag}]},signalingSyncNotification:{sid:15,cid:13,service:"signaling",response:[{type:"PropertyArray",name:"datas",reflectMapper:mc.avSignalTag}]},singalingSyncChannels:{sid:15,cid:14,service:"signaling",response:[{type:"PropertyArray",name:"datas",reflectMapper:mc.avSignalTag}]},signalingQueryInfo:{sid:15,cid:15,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ei.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:mc.avSignalTag}]},signalingCallEx:{sid:15,cid:16,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ei.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:mc.avSignalTag}]},signalingJoinAndAccept:{sid:15,cid:17,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ei.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:mc.avSignalTag}]},signalingBatchMarkRead:{sid:4,cid:5,isNoResponse:!0,service:"signaling",params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]}},Yy={type:{type:"number"},createTime:{type:"number"},expireTime:{type:"number"},invalid:{type:"boolean"},pushInfo:wC,pluginSetting:{nertcInfo:{nertcChannelName:{type:"string"},nertcTokenTtl:{type:"number"},nertcToken:{type:"string"},nertcJoinRoomQueryParamMap:{type:"string"},callStatus:{type:"number"}}},attach:{type:"object"},members:{type:"object"},needOffline:{type:"boolean"},uid:{type:"number"},time:{type:"number"}};function Gd(w){var M,L=Xs(Yy,w),$=[];return L.members&&L.members.length>0&&($=To(M=L.members).call(M,function(_){return function(Oe){return Xs(Yy,Ii(Oe,{1:"accid",2:"uid",3:"createTime",4:"expireTime"}))}(_)}),delete L.members),$.length>0?{channelInfo:L,memberList:$}:{channelInfo:L}}function gc(w){return Td(Yy,w)}var WC=function(w){function M($){var _;return(_=w.call(this)||this).timer=0,_.pollingInterval=12e4,_.name="signaling",_.logger=$.logger,_.core=$,_.channels={},qa({cmdMap:zC,cmdConfig:KC}),_}Ro(M,w);var L=M.prototype;return L.callEx=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt,ur;return ar.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return En({type:{type:"number"},toAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},needOffline:{type:"boolean",required:!1},pushInfo:{type:"object",required:!1,rules:wC},pluginSetting:{type:"object",required:!1,rules:{nertcInfo:{type:"object",required:!1}}}},_),vr.next=3,this.core.sendCmd("signalingCallEx",{tag:gc(_)});case 3:return pe=vr.sent,At=((Y=pe.content)===null||Y===void 0?void 0:Y.data)||{},jt=Gd(At),this.channels[jt.channelInfo.channelId]=fc(jt.channelInfo),this.timer||(this.timer=this.core.timerManager.addTimer(Oo(ur=this.aotoDelay).call(ur,this),this.pollingInterval,-1)),vr.abrupt("return",jt);case 9:case"end":return vr.stop()}},Oe,this)}))},L.joinAndAccept=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt,ur,gr,vr;return ar.wrap(function(xr){for(;;)switch(xr.prev=xr.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",required:!1},needOffline:{type:"boolean",required:!1},uid:{type:"number",required:!1},pluginSetting:{type:"object",required:!1,rules:{nertcInfo:{type:"object",required:!1}}}},_),pe=_.fromAccid,(At=Es(_,["fromAccid"])).toAccid=pe,xr.next=5,this.core.sendCmd("signalingJoinAndAccept",{tag:gc(At)});case 5:return jt=xr.sent,ur=((Y=jt.content)===null||Y===void 0?void 0:Y.data)||{},gr=Gd(ur),this.channels[gr.channelInfo.channelId]=fc(gr.channelInfo),this.timer||(this.timer=this.core.timerManager.addTimer(Oo(vr=this.aotoDelay).call(vr,this),this.pollingInterval,-1)),xr.abrupt("return",gr);case 11:case"end":return xr.stop()}},Oe,this)}))},L.create=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({type:{type:"number"},ext:{type:"string",required:!1}},_),ur.next=3,this.core.sendCmd("signalingCreate",{tag:gc(_)});case 3:return pe=ur.sent,At=((Y=pe.content)===null||Y===void 0?void 0:Y.data)||{},ur.abrupt("return",Gd(At));case 6:case"end":return ur.stop()}},Oe,this)}))},L.close=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},_),pe.next=3,this.core.sendCmd("signalingClose",{tag:gc(_)});case 3:case"end":return pe.stop()}},Y,this)}))},L.queryInfo=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At;return ar.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return En({name:{type:"string",allowEmpty:!1}},_),ur.next=3,this.core.sendCmd("signalingQueryInfo",{tag:_});case 3:return pe=ur.sent,At=((Y=pe.content)===null||Y===void 0?void 0:Y.data)||{},ur.abrupt("return",Gd(At));case 6:case"end":return ur.stop()}},Oe,this)}))},L.join=function(_){var Y;return Sn(this,void 0,void 0,ar.mark(function Oe(){var pe,At,jt,ur;return ar.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},uid:{type:"number",min:0,required:!1},needOffline:{type:"boolean",required:!1}},_),vr.next=3,this.core.sendCmd("signalingJoin",{tag:gc(_)});case 3:return pe=vr.sent,At=((Y=pe.content)===null||Y===void 0?void 0:Y.data)||{},jt=Gd(At),this.channels[jt.channelInfo.channelId]=fc(jt.channelInfo),this.timer||(this.timer=this.core.timerManager.addTimer(Oo(ur=this.aotoDelay).call(ur,this),this.pollingInterval,-1)),vr.abrupt("return",jt);case 9:case"end":return vr.stop()}},Oe,this)}))},L.aotoDelay=function(){return Sn(this,void 0,void 0,ar.mark(function _(){var Y,Oe,pe,At,jt;return ar.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:if((Y=Vo(this.channels)).length!==0){gr.next=4;break}return this.timer&&this.core.timerManager.deleteTimer(this.timer),gr.abrupt("return");case 4:this.logger.log("signling:autoDelay",Y),Oe=0;case 6:if(!(Oe<Y.length)){gr.next=23;break}return pe=Y[Oe],gr.prev=8,gr.next=11,this.core.sendCmd("signalingDelay",{tag:{channelId:pe}});case 11:At=gr.sent,jt=Gd(At.content.data),this.channels[pe]=jt.channelInfo,gr.next=20;break;case 16:gr.prev=16,gr.t0=gr.catch(8),this.logger.warn("signling:autoDelay "+pe+" failed",gr.t0),delete this.channels[pe];case 20:Oe++,gr.next=6;break;case 23:case"end":return gr.stop()}},_,this,[[8,16]])}))},L.leave=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},_),pe.next=3,this.core.sendCmd("signalingLeave",{tag:gc(_)});case 3:delete this.channels[_.channelId];case 4:case"end":return pe.stop()}},Y,this)}))},L.invite=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},toAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1},pushInfo:{type:"object",required:!1,rules:wC}},_),pe.next=3,this.core.sendCmd("signalingInvite",{tag:gc(_)});case 3:case"end":return pe.stop()}},Y,this)}))},L.cancelInvite=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},toAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},_),pe.next=3,this.core.sendCmd("signalingCancelInvite",{tag:gc(_)});case 3:case"end":return pe.stop()}},Y,this)}))},L.reject=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe;return ar.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},_),Oe=_.fromAccid,(pe=Es(_,["fromAccid"])).toAccid=Oe,jt.next=5,this.core.sendCmd("signalingReject",{tag:gc(pe)});case 5:case"end":return jt.stop()}},Y,this)}))},L.accept=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){var Oe,pe,At,jt,ur;return ar.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1},autoJoin:{type:"boolean",required:!1},uid:{type:"number",min:0,required:!1},joinAttachExt:{type:"string",required:!1}},_),Oe=_.autoJoin,pe=_.joinAttachExt,At=_.fromAccid,(jt=Es(_,["autoJoin","joinAttachExt","fromAccid"])).toAccid=At,vr.next=5,this.core.sendCmd("signalingAccept",{tag:gc(jt)});case 5:if(this.logger.log("Signaling:accept, accept success, autoJoin "+_.autoJoin),!Oe){vr.next=10;break}return ur={channelId:_.channelId,needOffline:_.needOffline,attachExt:pe,uid:_.uid},vr.next=10,this.join(ur);case 10:case"end":return vr.stop()}},Y,this)}))},L.sendCustomCommand=function(_){return Sn(this,void 0,void 0,ar.mark(function Y(){return ar.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return En({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1,required:!1},attachExt:{type:"string",required:!1}},_),pe.next=3,this.core.sendCmd("signalingSendCustomCommand",{tag:gc(_)});case 3:case"end":return pe.stop()}},Y,this)}))},L.signalingRecvNotificationHandler=function(_){var Y=typeof As(_,"raw.r[0]")=="number"?""+_.raw.r[0]:void 0;_.content.data.msgId=Y,this.doNotify(_.content.data),Y&&_o(Y)&&this.core.sendCmd("signalingBatchMarkRead",{sid:15,cid:11,ids:[Y]})},L.signalingMultiSyncNotificationHandler=function(_){this.doNotify(_.content.data,zh.kSelfSync)},L.doNotify=function(_,Y){Y===void 0&&(Y=zh.kDefault);var Oe=function(jr,zr){zr===void 0&&(zr=zh.kDefault);var Hr=Xs(Yy,jr),Kr=Hr.attach,kn=Hr.time,Jn=Hr.msgId;Hr.fromAccid,Hr.toAccid,Hr.members,Hr.requestId,Hr.pushInfo;var Hn=Es(Hr,["attach","time","msgId","fromAccid","toAccid","members","requestId","pushInfo"]),xo=Kr.type,Ln=Hr.ext;return delete Hr.attach,{metaData:{eventType:xo,channelInfo:Hn,feature:zr,ext:Ln,time:kn,msgId:Jn},rawData:Hr}}(_,Y),pe=Oe.metaData,At=Oe.rawData,jt=At.fromAccid,ur=At.toAccid,gr=At.members,vr=At.requestId,Cr=At.pushInfo,xr=At.msgId;switch(pe.eventType){case Fc.kClose:this.emit("signalingClose",{fromAccid:jt,metaData:pe});break;case Fc.kJoin:this.emit("signalingJoin",{member:gr,metaData:pe});break;case Fc.kInvite:this.emit("signalingInvite",{fromAccid:jt,toAccid:ur,requestId:vr,pushInfo:Cr,metaData:pe});break;case Fc.kCancelInvite:this.emit("signalingCancelInvite",{fromAccid:jt,toAccid:ur,requestId:vr,metaData:pe});break;case Fc.kReject:this.emit("signalingReject",{toAccid:ur,requestId:vr,metaData:pe});break;case Fc.kAccept:this.emit("signalingAccept",{toAccid:ur,requestId:vr,metaData:pe});break;case Fc.kLeave:this.emit("signalingLeave",{fromAccid:jt,metaData:pe});break;case Fc.kCustom:this.emit("signalingCustomCommand",{fromAccid:jt,metaData:pe});break;default:this.logger.warn("signaling:notification, no such a type "+pe.eventType,At)}return xr},L.signalingSyncNotificationHandler=function(_){var Y,Oe,pe=this;if(_.content.datas&&_.content.datas.length>0){var At=is(Y=To(Oe=_.content.datas).call(Oe,function(jt){return pe.doNotify(jt)})).call(Y,function(jt){return jt});At.length>0&&this.core.sendCmd("signalingBatchMarkRead",{sid:15,cid:11,ids:At})}},L.singalingSyncChannelsHandler=function(_){var Y;if(this.timer=0,this.channels={},_.content.datas&&_.content.datas.length>0){var Oe=To(Y=_.content.datas).call(Y,function(pe){return Gd(pe)});this.emit("singalingSyncChannels",Oe)}},L.process=function(_){var Y=this[_.cmd+"Handler"];return typeof Y=="function"?(Y.call(this,_),co.resolve(_)):_.error&&!_.error.ignore?co.reject(_.error):co.resolve(_)},M}(Vs.EventEmitter);return Fa.setAdapters(ey),Fa.registerService(ly,"auth"),Fa.registerService(My,"msg"),Fa.registerService(_S,"misc"),Fa.registerService(xy,"user"),Fa.registerService(rC,"session"),Fa.registerService(hC,"team"),Fa.registerService(TC,"systemMessage"),Fa.registerService(CC,"friend"),Fa.registerService(S,"event"),Fa.registerService(z,"msgExtend"),Fa.registerService(vn,"msgLog"),Fa.registerService(Dn,"passThrough"),Fa.registerService(Eo,"cloudStorage"),Fa.registerService(FC,"superTeam"),Fa.registerService(qp,"sync"),Fa.registerService(jC,"plugin"),Fa.registerService(HC,"cloudSession"),Fa.registerService(WC,"signaling"),Fa})})(NIM_BROWSER_SDK);var NIM_BROWSER_SDKExports=NIM_BROWSER_SDK.exports;const NIMSDK=getDefaultExportFromCjs(NIM_BROWSER_SDKExports);var NIM_Web_SDK={exports:{}};/*!
 * 
 * VERSION: 9.12.2
 * Git Hash: 4f80425748726d259a3375f1aa196861a10e6b77
 * 
 * Create At: 2023/8/4 下午4:18:45
 * 
 * Target: NIM_Web_SDK
 */(function(module,exports){(function(t,r){module.exports=r()})(window,function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=r,e.d=function(n,o,s){e.o(n,o)||Object.defineProperty(n,o,{enumerable:!0,get:s})},e.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,o){if(1&o&&(n=e(n)),8&o||4&o&&typeof n=="object"&&n&&n.__esModule)return n;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:n}),2&o&&typeof n!="string")for(var a in n)e.d(s,a,(function(i){return n[i]}).bind(null,a));return s},e.n=function(n){var o=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(o,"a",o),o},e.o=function(n,o){return Object.prototype.hasOwnProperty.call(n,o)},e.p="",e(e.s=910)}([function(t,r,e){var n=e(58),o=e(2),s=e(6),a=e(15),i=e(5),u=e(170),c=e(69),d=e(138),m=e(32),v=e(7),g=e(8),b=e(10),T=e(196),k=e(139),y=e(26),A=e(17),V=e(462),he=e(3),ae=e(85),Ne=e(86),_e=e(70),Ce=e(59),re=e(60),ue=e(61),ze=e(62),le=e(47),de=e(25);function Ie(Pt,rr){var kt=i(Pt);if(Ce){var Et=Ce(Pt);rr&&(Et=A(Et).call(Et,function(cr){return re(Pt,cr).enumerable})),kt.push.apply(kt,Et)}return kt}function ie(Pt,rr){var kt=Ne!==void 0&&_e(Pt)||Pt["@@iterator"];if(!kt){if(m(Pt)||(kt=function(Ir,kr){var Ar;if(Ir){if(typeof Ir=="string")return Ve(Ir,kr);var Rr=a(Ar=Object.prototype.toString.call(Ir)).call(Ar,8,-1);if(Rr==="Object"&&Ir.constructor&&(Rr=Ir.constructor.name),Rr==="Map"||Rr==="Set")return ae(Ir);if(Rr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Rr))return Ve(Ir,kr)}}(Pt))||rr&&Pt&&typeof Pt.length=="number"){kt&&(Pt=kt);var Et=0,cr=function(){};return{s:cr,n:function(){return Et>=Pt.length?{done:!0}:{done:!1,value:Pt[Et++]}},e:function(Ir){throw Ir},f:cr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var mr,yr=!0,Tr=!1;return{s:function(){kt=kt.call(Pt)},n:function(){var Ir=kt.next();return yr=Ir.done,Ir},e:function(Ir){Tr=!0,mr=Ir},f:function(){try{yr||kt.return==null||kt.return()}finally{if(Tr)throw mr}}}}function Ve(Pt,rr){(rr==null||rr>Pt.length)&&(rr=Pt.length);for(var kt=0,Et=new Array(rr);kt<rr;kt++)Et[kt]=Pt[kt];return Et}var Ue=e(254),Dt=e(197);function tr(Pt){de(Pt)==="object"?(this.callFunc=Pt.callFunc||null,this.message=Pt.message||"UNKNOW ERROR"):this.message=Pt,this.time=new Date,this.timetag=+this.time}e(485);var dr,fr,sr=e(54),hr=sr.getGlobal(),Fe=/\s+/;sr.deduplicate=function(Pt){var rr=[];return o(Pt).call(Pt,function(kt){s(rr).call(rr,kt)===-1&&rr.push(kt)}),rr},sr.capFirstLetter=function(Pt){return Pt?a(Pt=""+Pt).call(Pt,0,1).toUpperCase()+a(Pt).call(Pt,1):""},sr.guid=(dr=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return dr()+dr()+dr()+dr()+dr()+dr()+dr()+dr()}),sr.extend=function(Pt,rr,kt){for(var Et in rr)Pt[Et]!==void 0&&kt!==!0||(Pt[Et]=rr[Et])},sr.filterObj=function(Pt,rr){var kt={};return sr.isString(rr)&&(rr=rr.split(Fe)),o(rr).call(rr,function(Et){Pt.hasOwnProperty(Et)&&(kt[Et]=Pt[Et])}),kt},sr.copy=function(Pt,rr){var kt;return rr=rr||{},Pt&&o(kt=i(Pt)).call(kt,function(Et){sr.exist(Pt[Et])&&(rr[Et]=Pt[Et])}),rr},sr.copyWithNull=function(Pt,rr){var kt;return rr=rr||{},Pt&&o(kt=i(Pt)).call(kt,function(Et){(sr.exist(Pt[Et])||sr.isnull(Pt[Et]))&&(rr[Et]=Pt[Et])}),rr},sr.findObjIndexInArray=function(Pt,rr){Pt=Pt||[];var kt=rr.keyPath||"id",Et=-1;return u(Pt).call(Pt,function(cr,mr){if(Dt(cr,kt)===rr.value)return Et=mr,!0}),Et},sr.findObjInArray=function(Pt,rr){var kt=sr.findObjIndexInArray(Pt,rr);return kt===-1?null:Pt[kt]},sr.mergeObjArray=function(){var Pt=[],rr=a([]).call(arguments,0,-1),kt=arguments[arguments.length-1];sr.isArray(kt)&&(rr.push(kt),kt={});var Et,cr=kt.keyPath=kt.keyPath||"id";for(kt.sortPath=kt.sortPath||cr;!Pt.length&&rr.length;)Pt=rr.shift()||[],Pt=a(Pt).call(Pt,0);return o(rr).call(rr,function(mr){mr&&o(mr).call(mr,function(yr){(Et=sr.findObjIndexInArray(Pt,{keyPath:cr,value:Dt(yr,cr)}))!==-1?Pt[Et]=sr.merge({},Pt[Et],yr):Pt.push(yr)})}),kt.notSort||(Pt=sr.sortObjArray(Pt,kt)),Pt},sr.cutObjArray=function(Pt){var rr=a(Pt).call(Pt,0),kt=arguments.length,Et=a([]).call(arguments,1,kt-1),cr=arguments[kt-1];sr.isObject(cr)||(Et.push(cr),cr={});var mr,yr=cr.keyPath=cr.keyPath||"id";return o(Et).call(Et,function(Tr){sr.isArray(Tr)||(Tr=[Tr]),o(Tr).call(Tr,function(Ir){Ir&&(cr.value=Dt(Ir,yr),(mr=sr.findObjIndexInArray(rr,cr))!==-1&&c(rr).call(rr,mr,1))})}),rr},sr.sortObjArray=function(Pt,rr){var kt=(rr=rr||{}).sortPath||"id";Ue.insensitive=!!rr.insensitive;var Et,cr,mr,yr=!!rr.desc;return mr=sr.isFunction(rr.compare)?rr.compare:function(Tr,Ir){return Et=Dt(Tr,kt),cr=Dt(Ir,kt),yr?Ue(cr,Et):Ue(Et,cr)},d(Pt).call(Pt,mr)},sr.emptyFunc=function(){},sr.isEmptyFunc=function(Pt){return Pt===sr.emptyFunc},sr.notEmptyFunc=function(Pt){return Pt!==sr.emptyFunc},sr.splice=function(Pt,rr,kt){return c([]).call(Pt,rr,kt)},sr.reshape2d=function(Pt,rr){if(m(Pt)){sr.verifyParamType("type",rr,"number","util::reshape2d");var kt=Pt.length;if(kt<=rr)return[Pt];for(var Et=Math.ceil(kt/rr),cr=[],mr=0;mr<Et;mr++)cr.push(a(Pt).call(Pt,mr*rr,(mr+1)*rr));return cr}return Pt},sr.flatten2d=function(Pt){if(m(Pt)){var rr=[];return o(Pt).call(Pt,function(kt){rr=v(rr).call(rr,kt)}),rr}return Pt},sr.dropArrayDuplicates=function(Pt){if(m(Pt)){for(var rr={},kt=[];Pt.length>0;)rr[Pt.shift()]=!0;for(var Et in rr)rr[Et]===!0&&kt.push(Et);return kt}return Pt},sr.onError=function(Pt){throw new tr(Pt)},sr.verifyParamPresent=function(Pt,rr,kt,Et){kt=kt||"";var cr=!1;switch(sr.typeOf(rr)){case"undefined":case"null":cr=!0;break;case"string":rr===""&&(cr=!0);break;case"StrStrMap":case"object":i(rr).length||(cr=!0);break;case"array":rr.length?u(rr).call(rr,function(mr){if(sr.notexist(mr))return cr=!0,!0}):cr=!0}cr&&sr.onParamAbsent(kt+Pt,Et)},sr.onParamAbsent=function(Pt,rr){sr.onParamError("缺少参数 ".concat(Pt,", 请确保参数不是 空字符串、空对象、空数组、null或undefined, 或数组的内容不是 null/undefined"),rr)},sr.verifyParamAbsent=function(Pt,rr,kt,Et){kt=kt||"",rr!==void 0&&sr.onParamPresent(kt+Pt,Et)},sr.onParamPresent=function(Pt,rr){sr.onParamError("多余的参数 ".concat(Pt),rr)},sr.verifyParamType=function(Pt,rr,kt,Et){var cr=sr.typeOf(rr).toLowerCase();sr.isArray(kt)||(kt=[kt]),kt=g(kt).call(kt,function(yr){return yr.toLowerCase()});var mr=!0;switch(s(kt).call(kt,cr)===-1&&(mr=!1),cr){case"number":isNaN(rr)&&(mr=!1);break;case"string":kt.join("")==="numeric or numeric string"&&(mr=!!/^[0-9]+$/.test(rr))}mr||sr.onParamInvalidType(Pt,kt,"",Et)},sr.onParamInvalidType=function(Pt,rr,kt,Et){kt=kt||"",rr=sr.isArray(rr)?(rr=g(rr).call(rr,function(cr){return'"'+cr+'"'})).join(", "):'"'+rr+'"',sr.onParamError('参数"'+kt+Pt+'"类型错误, 合法的类型包括: ['+rr+"]",Et)},sr.verifyParamValid=function(Pt,rr,kt,Et){sr.isArray(kt)||(kt=[kt]),s(kt).call(kt,rr)===-1&&sr.onParamInvalidValue(Pt,kt,Et)},sr.onParamInvalidValue=function(Pt,rr,kt){var Et;sr.isArray(rr)||(rr=[rr]),rr=g(rr).call(rr,function(cr){return'"'+cr+'"'}),sr.isArray(rr)&&(rr=rr.join(", ")),sr.onParamError(v(Et="参数 ".concat(Pt,"值错误, 合法的值包括: [")).call(Et,b(rr),"]"),kt)},sr.verifyParamMin=function(Pt,rr,kt,Et){rr<kt&&sr.onParamError("参数"+Pt+"的值不能小于"+kt,Et)},sr.verifyParamMax=function(Pt,rr,kt,Et){rr>kt&&sr.onParamError("参数"+Pt+"的值不能大于"+kt,Et)},sr.verifyArrayMax=function(Pt,rr,kt,Et){rr.length>kt&&sr.onParamError("参数"+Pt+"的长度不能大于"+kt,Et)},sr.verifyEmail=(fr=/^\S+@\S+$/,function(Pt,rr,kt){fr.test(rr)||sr.onParamError("参数"+Pt+"邮箱格式错误, 合法格式必须包含@符号, @符号前后至少要各有一个字符",kt)}),sr.verifyTel=function(){var Pt=/^[+\-()\d]+$/;return function(rr,kt,Et){Pt.test(kt)||sr.onParamError("参数"+rr+"电话号码格式错误, 合法字符包括+、-、英文括号和数字",Et)}}(),sr.verifyBirth=function(){var Pt=/^(\d{4})-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/;return function(rr,kt,Et){Pt.test(kt)||sr.onParamError("参数"+rr+'生日格式错误, 合法为"yyyy-MM-dd"',Et)}}(),sr.onParamError=function(Pt,rr){sr.onError({message:Pt,callFunc:rr})},sr.verifyOptions=function(Pt,rr,kt,Et,cr){if(Pt=Pt||{},rr&&(sr.isString(rr)&&(rr=rr.split(Fe)),sr.isArray(rr))){typeof kt!="boolean"&&(cr=kt||null,kt=!0,Et="");var mr=kt?sr.verifyParamPresent:sr.verifyParamAbsent;o(rr).call(rr,function(yr){mr.call(sr,yr,Pt[yr],Et,cr)})}return Pt},sr.verifyParamAtLeastPresentOne=function(Pt,rr,kt){rr&&(sr.isString(rr)&&(rr=rr.split(Fe)),sr.isArray(rr)&&(u(rr).call(rr,function(Et){return sr.exist(Pt[Et])})||sr.onParamError("以下参数["+rr.join(", ")+"]至少需要传入一个",kt)))},sr.verifyParamPresentJustOne=function(Pt,rr,kt){rr&&(sr.isString(rr)&&(rr=rr.split(Fe)),sr.isArray(rr)&&T(rr).call(rr,function(Et,cr){return sr.exist(Pt[cr])&&Et++,Et},0)!==1&&sr.onParamError("以下参数["+rr.join(", ")+"]必须且只能传入一个",kt))},sr.verifyBooleanWithDefault=function(Pt,rr,kt,Et,cr){sr.undef(kt)&&(kt=!0),Fe.test(rr)&&(rr=rr.split(Fe)),sr.isArray(rr)?o(rr).call(rr,function(mr){sr.verifyBooleanWithDefault(Pt,mr,kt,Et,cr)}):Pt[rr]===void 0?Pt[rr]=kt:sr.isBoolean(Pt[rr])||sr.onParamInvalidType(rr,"boolean",Et,cr)},sr.verifyFileInput=function(Pt,rr){var kt;return sr.verifyParamPresent("fileInput",Pt,"",rr),sr.isString(Pt)&&((Pt=typeof document>"u"?void 0:document.getElementById(Pt))||sr.onParamError("找不到要上传的文件对应的input, 请检查fileInput id ".concat(Pt),rr)),Pt.tagName&&Pt.tagName.toLowerCase()==="input"&&Pt.type.toLowerCase()==="file"||sr.onParamError(v(kt="请提供正确的 fileInput, 必须为 file 类型的 input 节点 tagname:".concat(Pt.tagName,", filetype:")).call(kt,Pt.type),rr),Pt},sr.verifyFileType=function(Pt,rr){sr.verifyParamValid("type",Pt,sr.validFileTypes,rr)},sr.verifyCallback=function(Pt,rr,kt){Fe.test(rr)&&(rr=rr.split(Fe)),sr.isArray(rr)?o(rr).call(rr,function(Et){sr.verifyCallback(Pt,Et,kt)}):Pt[rr]?sr.isFunction(Pt[rr])||sr.onParamInvalidType(rr,"function","",kt):Pt[rr]=sr.emptyFunc},sr.verifyFileUploadCallback=function(Pt,rr){sr.verifyCallback(Pt,"uploadprogress uploaddone uploaderror uploadcancel",rr)},sr.validFileTypes=["image","audio","video","file"],sr.validFileExts={image:["bmp","gif","jpg","jpeg","jng","png","webp"],audio:["mp3","wav","aac","wma","wmv","amr","mp2","flac","vorbis","ac3"],video:["mp4","rm","rmvb","wmv","avi","mpg","mpeg","mov"]},sr.filterFiles=function(Pt,rr){var kt,Et,cr=(rr=rr.toLowerCase())==="file",mr=[];return o([]).call(Pt,function(yr){var Tr,Ir;if(cr)mr.push(yr);else if(kt=a(Tr=yr.name).call(Tr,k(Ir=yr.name).call(Ir,".")+1),(Et=yr.type.split("/"))[0]&&Et[1]){var kr,Ar=!1;Et[0].toLowerCase()===rr?Ar=!0:Ar=s(kr=sr.validFileExts[rr]).call(kr,kt)!==-1,Ar&&mr.push(yr)}}),mr};var or,ir,$e=sr.supportFormData=sr.notundef(hr.FormData);sr.getFileName=function(Pt){return Pt=sr.verifyFileInput(Pt),$e?Pt.files[0].name:a(rr=Pt.value).call(rr,k(kt=Pt.value).call(kt,"\\")+1);var rr,kt},sr.getFileInfo=(or={ppt:1,pptx:2,pdf:3,doc:6,docx:7},function(Pt){var rr={};if(!(Pt=sr.verifyFileInput(Pt)).files)return rr;var kt=Pt.files[0];return $e&&(rr.name=kt.name,rr.size=kt.size,rr.type=kt.name.match(/\.(\w+)$/),rr.type=rr.type&&rr.type[1].toLowerCase(),rr.transcodeType=or[rr.type]||0),rr}),sr.sizeText=(ir=["B","KB","MB","GB","TB","PB","EB","ZB","BB"],function(Pt){var rr,kt=0;do rr=(Pt=Math.floor(100*Pt)/100)+ir[kt],Pt/=1024,kt++;while(Pt>1);return rr}),sr.promises2cmds=function(Pt){return g(Pt).call(Pt,function(rr){return rr.cmd})},sr.objs2accounts=function(Pt){return g(Pt).call(Pt,function(rr){return rr.account})},sr.teams2ids=function(Pt){return g(Pt).call(Pt,function(rr){return rr.teamId})},sr.objs2ids=function(Pt){return g(Pt).call(Pt,function(rr){return rr.id})},sr.getMaxUpdateTime=function(Pt){var rr=g(Pt).call(Pt,function(kt){return+kt.updateTime});return Math.max.apply(Math,rr)},sr.genCheckUniqueFunc=function(Pt){return Pt=Pt||"id",function(rr){this.uniqueSet=this.uniqueSet||{},this.uniqueSet[Pt]=this.uniqueSet[Pt]||{};var kt=this.uniqueSet[Pt],Et=rr[Pt];return!kt[Et]&&(kt[Et]=!0,!0)}},sr.fillPropertyWithDefault=function(Pt,rr,kt){return!!sr.undef(Pt[rr])&&(Pt[rr]=kt,!0)},sr.throttle=function(Pt,rr,kt,Et){var cr,mr,yr=null,Tr=0;kt||(kt={});var Ir=function(){Tr=kt.leading===!1?0:new Date().getTime(),yr=null,Pt.apply(cr,mr),yr||(cr=mr=null)};return function(){var kr=new Date().getTime();Tr||kt.leading!==!1||(Tr=kr);var Ar=rr-(kr-Tr);return cr=this,mr=arguments,Ar<=0||Ar>rr?(clearTimeout(yr),yr=null,Tr=kr,Pt.apply(cr,mr),yr||(cr=mr=null)):yr||kt.trailing===!1?yr&&Et&&Et.apply(cr,mr):(yr=y(Ir,Ar),Et&&Et.apply(cr,mr)),yr}},sr.get=function(Pt,rr){var kt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;if(de(Pt)!=="object")return kt;var Et,cr=rr.replace(/\[(\d+)\]/g,".$1").split("."),mr=Pt,yr=ie(cr);try{for(yr.s();!(Et=yr.n()).done;){var Tr=Et.value;if((mr=Object(mr)[Tr])===void 0)return kt}}catch(Ir){yr.e(Ir)}finally{yr.f()}return mr},sr.pickAsString=function(Pt,rr){var kt;return Pt?g(kt=A(rr).call(rr,function(Et){return Pt[Et]!==void 0})).call(kt,function(Et){var cr;return v(cr="".concat(Et,"=")).call(cr,Pt[Et])}).join(","):""},sr.omitAsString=function(Pt,rr){var kt,Et;if(!Pt)return"";var cr={};return o(rr).call(rr,function(mr){cr[mr]=!0}),g(kt=A(Et=i(Pt)).call(Et,function(mr){return!cr[mr]})).call(kt,function(mr){var yr;return v(yr="".concat(mr,"=")).call(yr,Pt[mr])}).join(",")};var er={session:function(Pt){var rr=function(Et){for(var cr=1;cr<arguments.length;cr++){var mr,yr,Tr=arguments[cr]!=null?arguments[cr]:{};cr%2?o(mr=Ie(Object(Tr),!0)).call(mr,function(Ir){n(Et,Ir,Tr[Ir])}):ue?ze(Et,ue(Tr)):o(yr=Ie(Object(Tr))).call(yr,function(Ir){le(Et,Ir,re(Tr,Ir))})}return Et}({},Pt),kt=["topCustom","localCustom","extra"];return o(kt).call(kt,function(Et){rr[Et]&&(rr[Et]="***")}),rr.lastMsg&&(rr.lastMsg={idServer:rr.lastMsg.idServer,idClient:rr.lastMsg.idClient}),rr}};sr.secureOutput=function(Pt,rr){m(rr)||(rr=[rr]);var kt=er[Pt];return(rr=g(rr).call(rr,function(Et){return kt(Et)})).length===1?rr[0]:rr};var nr={string:function(Pt,rr,kt){var Et=kt.required,cr=kt.allowEmpty,mr=Pt[rr];return Et===!1&&mr===void 0||typeof mr=="string"&&!(!cr&&mr==="")},number:function(Pt,rr,kt){var Et=kt.required,cr=kt.min,mr=Pt[rr];return Et===!1&&mr===void 0||typeof mr=="number"&&!(mr<cr)},enum:function(Pt,rr,kt){var Et=kt.required,cr=V(kt),mr=Pt[rr];return Et===!1&&mr===void 0||s(cr).call(cr,mr)>-1},array:function(Pt,rr,kt){var Et=kt.required,cr=Pt[rr];return Et===!1&&cr===void 0||!!m(cr)}};sr.validate=function(Pt,rr,kt){var Et,cr={};return o(Et=i(Pt)).call(Et,function(mr){var yr,Tr=Pt[mr].type,Ir=nr[Tr];Ir&&!Ir(rr,mr,Pt[mr])?sr.onError({message:v(yr="Error in parameter verification, ".concat(mr," expected value is ")).call(yr,b(Pt[mr])),callFunc:kt}):cr[mr]=rr[mr]}),cr},sr.asyncPool=function(Pt,rr,kt){if(typeof Pt!="number"||typeof kt!="function"||!rr||!rr.length)return he.resolve();var Et=0,cr=[],mr=[];return function yr(){if(Et===rr.length)return he.resolve();var Tr=rr[Et++],Ir=he.resolve().then(function(){return kt(Tr,rr)});cr.push(Ir);var kr=he.resolve();if(Pt<=rr.length){var Ar=Ir.then(function(){return c(mr).call(mr,s(mr).call(mr,Ar),1)});mr.push(Ar),mr.length>=Pt&&(kr=he.race(mr))}return kr.then(function(){return yr()})}().then(function(){return he.all(cr)})},sr.getIdArray=function(Pt){if(!Pt||typeof Pt!="string")throw new Error("id type error");var rr=s(Pt).call(Pt,"-");if(rr<0||rr===Pt.length-1)throw new Error("id format error");return[a(Pt).call(Pt,0,rr),a(Pt).call(Pt,rr+1)]},t.exports=sr},function(t,r,e){var n=e(14),o=e(76),s=e(155),a=e(16),i=e(90).f,u=e(209),c=e(12),d=e(34),m=e(53),v=e(29),g=function(b){var T=function(k,y,A){if(this instanceof T){switch(arguments.length){case 0:return new b;case 1:return new b(k);case 2:return new b(k,y)}return new b(k,y,A)}return o(b,this,arguments)};return T.prototype=b.prototype,T};t.exports=function(b,T){var k,y,A,V,he,ae,Ne,_e,Ce,re=b.target,ue=b.global,ze=b.stat,le=b.proto,de=ue?n:ze?n[re]:(n[re]||{}).prototype,Ie=ue?c:c[re]||m(c,re,{})[re],ie=Ie.prototype;for(V in T)y=!(k=u(ue?V:re+(ze?".":"#")+V,b.forced))&&de&&v(de,V),ae=Ie[V],y&&(Ne=b.dontCallGetSet?(Ce=i(de,V))&&Ce.value:de[V]),he=y&&Ne?Ne:T[V],y&&typeof ae==typeof he||(_e=b.bind&&y?d(he,n):b.wrap&&y?g(he):le&&a(he)?s(he):he,(b.sham||he&&he.sham||ae&&ae.sham)&&m(_e,"sham",!0),m(Ie,V,_e),le&&(v(c,A=re+"Prototype")||m(c,A,{}),m(c[A],V,he),b.real&&ie&&(k||!ie[V])&&m(ie,V,he)))}},function(t,r,e){t.exports=e(228)},function(t,r,e){t.exports=e(230)},function(t,r){t.exports=function(e){try{return!!e()}catch{return!0}}},function(t,r,e){t.exports=e(229)},function(t,r,e){t.exports=e(205)},function(t,r,e){t.exports=e(323)},function(t,r,e){t.exports=e(440)},function(t,r,e){t.exports=e(274)},function(t,r,e){t.exports=e(384)},function(t,r,e){var n=e(107),o=Function.prototype,s=o.call,a=n&&o.bind.bind(s,s);t.exports=n?a:function(i){return function(){return s.apply(i,arguments)}}},function(t,r){t.exports={}},function(t,r,e){var n=e(6),o=e(7),s=!1;try{typeof localStorage.setItem=="function"&&typeof localStorage.getItem=="function"&&(localStorage.setItem("nim_localstorage_exist_test","1"),s=localStorage.getItem("nim_localstorage_exist_test")==="1",localStorage.removeItem("nim_localstorage_exist_test"))}catch{s=!1}var a={nodeEnv:"production",info:{hash:"4f80425748726d259a3375f1aa196861a10e6b77",shortHash:"4f804257",version:"9.12.2",sdkVersion:"91202",sdkHumanVersion:"9.12.2",protocolVersion:1},lbsUrl:"https://lbs.netease.im/lbs/webconf.jsp",needToXHR:!0,connectTimeout:1e4,xhrTimeout:8e3,reconnectionDelay:1600,reconnectionDelayMax:8e3,reconnectionJitter:.01,reconnectiontimer:null,heartbeatInterval:3e4,cmdTimeout:8e3,hbCmdTimeout:5e3,isWeixinApp:!1,isNodejs:!1,isRN:!1,ipVersion:0,PUSHTOKEN:"",PUSHCONFIG:{},CLIENTTYPE:16,PushPermissionAsked:!1,iosPushConfig:null,androidPushConfig:null,optionDefaultLinkUrl:"",defaultLinkUrl:"weblink.netease.im",ipv6DefaultLinkUrl:"weblink.netease.im",optionIpv6DefaultLinkUrl:"",wxDefaultLinkUrl:"wlnimsc0.netease.im",serverNosConfig:s?{cdnDomain:localStorage.getItem("nim_cdn_domain")||"",objectPrefix:localStorage.getItem("nim_object_prefix")||""}:{},hasLocalStorage:s,privateConf:{isABTestEnable:!0,isDataReportEnable:!0,isMixStoreEnable:!0,reportConfigUrl:"https://statistic.live.126.net/dispatcher/req",reportUrl:"https://statistic.live.126.net/statics/report/common/form"},getDefaultLinkUrl:function(i){var u,c;a.ipVersion===1?(u=a.optionIpv6DefaultLinkUrl,c=a.ipv6DefaultLinkUrl):(u=a.optionDefaultLinkUrl,c=a.defaultLinkUrl);var d=u||(a.isWeixinApp?a.wxDefaultLinkUrl:c);if(!d)return!1;var m=i?"https":"http",v=i?"443":"80",g=d;return n(d).call(d,"http")===-1&&(g=m+"://"+g),n(d).call(d,":")===-1&&(g=g+":"+v),g},ipProbeAddr:{ipv4:"https://check-ipv4.netease.im/test/",ipv6:"https://check-ipv6.netease.im/test/"},formatSocketUrl:function(i){var u=i.url,c=i.secure?"https":"http";return n(u).call(u,"http")===-1?c+"://"+u:u},uploadUrl:"https://nos.netease.com",chunkUploadUrl:"https://wanproxy-web.127.net",commonMaxSize:104857600,chunkSize:4194304,chunkMaxSize:4194304e4,replaceUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHost:"nos.netease.com",downloadHostList:["nos.netease.com"],downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",nosCdnEnable:!0,httpsEnabled:!1,threshold:0,nosLbsUrls:[],edgeList:["https://wanproxy-web.127.net","https://nosup-hz1.127.net"],genUploadUrl:function(i){return a.uploadUrl+"/"+i},genChunkUploadUrl:function(i){return a.chunkUploadUrl?a.chunkUploadUrl+"/"+i.bucket+"/"+i.objectName:""},genDownloadUrl:function(i,u,c){var d,m,v,g,b,T=i.bucket,k=i.expireSec,y=+new Date,A=k?"&survivalTime=".concat(k):"";if(c)return o(v=o(g=o(b="https://".concat(c,"/")).call(b,u,"?createTime=")).call(g,y)).call(v,A);var V=o(d=o(m="".concat(a.replaceUrl,"?createTime=")).call(m,y)).call(d,A);return(V=a.genNosProtocolUrl(V)).replace("{bucket}",T).replace("{object}",u)},genFileUrl:function(i){var u=i.bucket,c=i.objectName;return a.genNosProtocolUrl(a.replaceUrl).replace("{bucket}",u).replace("{object}",c)},genNosProtocolUrl:function(i){return/^http/.test(i)?a.httpsEnabled&&n(i).call(i,"https://")!==0&&(i=i.replace("http","https")):i=a.httpsEnabled?"https://".concat(i):"http://".concat(i),i}};a.hostEnv="BROWSER",t.exports=a},function(t,r,e){(function(n){var o=function(s){return s&&s.Math==Math&&s};t.exports=o(typeof globalThis=="object"&&globalThis)||o(typeof window=="object"&&window)||o(typeof self=="object"&&self)||o(typeof n=="object"&&n)||function(){return this}()||Function("return this")()}).call(this,e(56))},function(t,r,e){t.exports=e(249)},function(t,r,e){var n=e(206),o=n.all;t.exports=n.IS_HTMLDDA?function(s){return typeof s=="function"||s===o}:function(s){return typeof s=="function"}},function(t,r,e){t.exports=e(458)},function(t,r,e){t.exports=e(214)},function(t,r,e){var n=e(107),o=Function.prototype.call;t.exports=n?o.bind(o):function(){return o.apply(o,arguments)}},function(t,r,e){var n=e(14),o=e(109),s=e(29),a=e(127),i=e(92),u=e(207),c=o("wks"),d=n.Symbol,m=d&&d.for,v=u?d:d&&d.withoutSetter||a;t.exports=function(g){if(!s(c,g)||!i&&typeof c[g]!="string"){var b="Symbol."+g;i&&s(d,g)?c[g]=d[g]:c[g]=u&&m?m(b):v(b)}return c[g]}},function(t,r,e){var n=e(11);t.exports=n({}.isPrototypeOf)},function(t,r,e){var n=e(12),o=e(29),s=e(133),a=e(38).f;t.exports=function(i){var u=n.Symbol||(n.Symbol={});o(u,i)||a(u,i,{value:s.f(i)})}},function(t,r,e){var n=e(58),o=e(57),s=e(7),a=e(26),i=e(10),u=e(32),c=e(5),d=e(59),m=e(17),v=e(60),g=e(2),b=e(61),T=e(62),k=e(47),y=e(15),A=e(85),V=e(86),he=e(70);function ae(de,Ie){var ie=V!==void 0&&he(de)||de["@@iterator"];if(!ie){if(u(de)||(ie=function(fr,sr){var hr;if(fr){if(typeof fr=="string")return Ne(fr,sr);var Fe=y(hr=Object.prototype.toString.call(fr)).call(hr,8,-1);if(Fe==="Object"&&fr.constructor&&(Fe=fr.constructor.name),Fe==="Map"||Fe==="Set")return A(fr);if(Fe==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Fe))return Ne(fr,sr)}}(de))||Ie&&de&&typeof de.length=="number"){ie&&(de=ie);var Ve=0,Ue=function(){};return{s:Ue,n:function(){return Ve>=de.length?{done:!0}:{done:!1,value:de[Ve++]}},e:function(fr){throw fr},f:Ue}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Dt,tr=!0,dr=!1;return{s:function(){ie=ie.call(de)},n:function(){var fr=ie.next();return tr=fr.done,fr},e:function(fr){dr=!0,Dt=fr},f:function(){try{tr||ie.return==null||ie.return()}finally{if(dr)throw Dt}}}}function Ne(de,Ie){(Ie==null||Ie>de.length)&&(Ie=de.length);for(var ie=0,Ve=new Array(Ie);ie<Ie;ie++)Ve[ie]=de[ie];return Ve}function _e(de,Ie){var ie=c(de);if(d){var Ve=d(de);Ie&&(Ve=m(Ve).call(Ve,function(Ue){return v(de,Ue).enumerable})),ie.push.apply(ie,Ve)}return ie}function Ce(de){for(var Ie=1;Ie<arguments.length;Ie++){var ie,Ve,Ue=arguments[Ie]!=null?arguments[Ie]:{};Ie%2?g(ie=_e(Object(Ue),!0)).call(ie,function(Dt){n(de,Dt,Ue[Dt])}):b?T(de,b(Ue)):g(Ve=_e(Object(Ue))).call(Ve,function(Dt){k(de,Dt,v(Ue,Dt))})}return de}var re=e(44),ue=e(0);function ze(de){return ue.get(de,"code")||ue.get(de,"msg.code")||ue.get(de,"statusCode")||ue.get(de,"event.code")||0}function le(de){var Ie,ie,Ve=typeof de=="string"?de:ue.get(de,"msg")||ue.get(de,"message")||ue.get(de,"error")||ue.get(de,"event.msg")||ue.get(de,"event.message")||ue.get(de,"event")||"unknown",Ue="",Dt="";de&&typeof de.toString=="function"&&(Ue=de.toString());try{Dt=i(de)}catch{}return s(Ie=s(ie=`
errMsg: `.concat(Ve,`
errStr: `)).call(ie,Ue,`
errJsonStr: `)).call(Ie,Dt,`
  `)}t.exports={reportAPI:function(de){var Ie=de.instance,ie=de.className,Ve=de.funcName,Ue=de.hasCallback,Dt=Ue===void 0||Ue,tr=de.done;if(!function(sr){if(!sr||!u(sr.experiments))return!1;var hr,Fe=ae(sr.experiments);try{for(Fe.s();!(hr=Fe.n()).done;){var or=hr.value;if(or.experimentKey==="api_trace_collection"&&or.schemeKey==="open_flow"&&u(or.variates)){var ir,$e=ae(or.variates);try{for($e.s();!(ir=$e.n()).done;){var er=ir.value;if(er.key==="open"&&er.value===!0)return!0}}catch(nr){$e.e(nr)}finally{$e.f()}}}}catch(nr){Fe.e(nr)}finally{Fe.f()}return!1}(Ie.abtInfo)||!Ie.reporter||!Ie.reporter.isUploadEnable)return tr;var dr,fr={user_id:ue.get(Ie,"options.account")||"",trace_id:ue.get(Ie,"socket.socket.sessionid"),class_name:ie,api_name:Ve,action:Dt?1:0,active_id:re.deviceId,start_time:o()};return Dt?(dr=a(function(){Ie&&Ie.logger&&Ie.logger.warn("API 数据上报回调函数未调用",fr),Ie&&Ie.reporter&&Ie.reporter.report("nim_api_trace",Ce(Ce({},fr),{},{state:1,error_code:408,error_msg:"API回调函数未被调用",duration:o()-fr.start_time}))},1e4),function(sr){if(clearTimeout(dr),typeof tr=="function"){for(var hr,Fe=arguments.length,or=new Array(Fe>1?Fe-1:0),ir=1;ir<Fe;ir++)or[ir-1]=arguments[ir];tr.apply(void 0,s(hr=[sr]).call(hr,or))}try{if(!Ie||!Ie.reporter)return;sr?Ie.reporter.report("nim_api_trace",Ce(Ce({},fr),{},{state:1,error_code:ze(sr),error_msg:le(sr),duration:o()-fr.start_time})):Ie.reporter.report("nim_api_trace",Ce(Ce({},fr),{},{state:0,duration:o()-fr.start_time}))}catch($e){Ie&&Ie.logger&&Ie.logger.error("api report error",$e)}}):(Ie.reporter.report("nim_api_trace",Ce(Ce({},fr),{},{state:0,duration:1})),tr)}}},function(t,r,e){t.exports=e(271)},function(t,r,e){var n=e(153),o=e(365);function s(a){return t.exports=s=typeof n=="function"&&typeof o=="symbol"?function(i){return typeof i}:function(i){return i&&typeof n=="function"&&i.constructor===n&&i!==n.prototype?"symbol":typeof i},t.exports.__esModule=!0,t.exports.default=t.exports,s(a)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(454)},function(t,r,e){var n=e(4);t.exports=!n(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},function(t,r,e){var n=e(16),o=e(206),s=o.all;t.exports=o.IS_HTMLDDA?function(a){return typeof a=="object"?a!==null:n(a)||a===s}:function(a){return typeof a=="object"?a!==null:n(a)}},function(t,r,e){var n=e(11),o=e(42),s=n({}.hasOwnProperty);t.exports=Object.hasOwn||function(a,i){return s(o(a),i)}},function(t,r,e){var n=e(12);t.exports=function(o){return n[o+"Prototype"]}},function(t,r,e){var n=e(16),o=e(78),s=TypeError;t.exports=function(a){if(n(a))return a;throw s(o(a)+" is not a function")}},function(t,r,e){t.exports=e(298)},function(t,r,e){var n=e(12),o=e(14),s=e(16),a=function(i){return s(i)?i:void 0};t.exports=function(i,u){return arguments.length<2?a(n[i])||a(o[i]):n[i]&&n[i][u]||o[i]&&o[i][u]}},function(t,r,e){var n=e(155),o=e(31),s=e(107),a=n(n.bind);t.exports=function(i,u){return o(i),u===void 0?i:s?a(i,u):function(){return i.apply(u,arguments)}}},function(t,r,e){var n=e(18),o=e(24),s=e(3),a=e(71),i=e(75),u=e(13),c=e(0),d=e(289),m=c.undef,v=e(308),g=e(147),b=e(151),T=e(779);function k(V){var he,ae,Ne,_e=this;c.verifyOptions(V,"appKey account token","protocol::IMProtocol"),c.verifyCallback(V,["onconnect","onerror","onwillreconnect","ondisconnect","onloginportschange","onmyinfo","onblacklist","onmutelist","onfriends","onusers","onrobots","onteams","onSuperTeams","onsessions","onSessionsWithMoreRoaming","onStickTopSessions","onroamingmsgs","onofflinemsgs","onofflinefiltermsgs","onroamingsysmsgs","onofflinesysmsgs","onofflinefiltersysmsgs","onofflinecustomsysmsgs","onofflinefiltercustomsysmsgs","onbroadcastmsg","onbroadcastmsgs","onsysmsgunread","onsyncdone","onteammembers","onsyncteammembersdone","onmsg","onsysmsg","oncustomsysmsg","onupdatemyinfo","onupdateuser","onSyncUpdateServerSession","onUpdateSuperTeamMember","onMySuperTeamMembers","onCreateSuperTeam","onUpdateSuperTeam","onAddSuperTeamMembers","onRemoveSuperTeamMembers","onUpdateSuperTeamManagers","onDismissSuperTeam","onTransferSuperTeam","onUpdateSuperTeamMembersMute","onupdateteammember","onMyTeamMembers","onMsgReceipts","onCreateTeam","onUpdateTeam","onAddTeamMembers","onRemoveTeamMembers","onUpdateTeamManagers","onDismissTeam","onTransferTeam","onUpdateTeamMembersMute","onTeamMsgReceipt","onupdatesession","onQuickComment","onDeleteQuickComment","onPinMsgChange","onupdatesysmsgunread","onupdatesysmsg","onsynccreateteam","onsyncsupercreateteam","onsyncmarkinblacklist","onsyncmarkinmutelist","onsyncfriendaction","shouldIgnoreNotification","shouldIgnoreMsg","onDeleteMsgSelf","shouldCountNotifyUnread","onPushNotificationMultiportConfig","onPushNotificationMultiportConfigUpdate","onpushevents"],"protocol::IMProtocol"),he=typeof c.get(V,"privateConf.isDataReportEnable")=="boolean"?V.privateConf.isDataReportEnable:u.privateConf.isDataReportEnable,ae=typeof c.get(V,"privateConf.reportConfigUrl")=="string"?V.privateConf.reportConfigUrl:u.privateConf.reportConfigUrl,Ne=typeof c.get(V,"privateConf.reportUrl")=="string"?V.privateConf.reportUrl:u.privateConf.reportUrl,_e.reporter=d.initReporter({isDataReportEnable:he,reportConfigUrl:ae,reportUrl:Ne,appKey:V.appKey,logger:_e.logger}),_e.db=V.api.db=new a({logger:V.logger,reporter:_e.reporter,account:V.account,core:_e,notifyError:function(Ce){_e.notifyError&&_e.notifyError("DB error",Ce)}}),i.call(_e,V)}var y=i.fn,A=k.fn=k.prototype=n(y);A.init=function(){var V,he;y.init.call(this),g.IM.setProtocol(this),this.parser=g.IM,o(V=this.sendCmd).call(V,this),this.socketUrls=[],this.syncing=!0,this.canHandleDeletedMsgInSyncing=!1,this.hasSynced=!1,this.hasSyncedTeamMembers=!1,this.syncPromiseArray=[],this.syncResult={},this.syncTeamMembersPromiseArray=[],this.syncSuperTeamMembersPromiseArray=[],this.syncTeamMembersResult={},this.timetags={},this.superTeamMembersData={},this.saveAck={},this.sysMsgUnread=b.completeUnread({}),this.resetUnsettledMsgs(),this.resetUnsettledSysMsgs(),this.msgPromise=s.resolve(),this.sysMsgPromise=s.resolve(),this.msgDelayArr=[],this.msgDelayTimer=null,this.msgStatEnable=!1,this.nosCdnHostTimer=null,this.relativeServerTime=0,this.sessionSet={},this.msgReceiptTasks={},this.userSet={},this.pushNotificationMultiportConfig=v.getDefaultConfig(),this.msgAckBufferManager=new T({processFn:o(he=this.handleMsgsAck).call(he,this),throttleTime:500})},A.reset=function(){y.reset.call(this);var V=this.options;this.db.reset(V.db),m(V.lbsUrl)&&(V.lbsUrl=u.lbsUrl),this.autoconnect=!!V.autoconnect,this.resetAutoMarkRead()},A.resetAutoMarkRead=function(){var V=this.options;c.verifyBooleanWithDefault(V,"autoMarkRead",!0,"","protocol::resetAutoMarkRead")},A.resetUnsettledMsgs=function(){this.unhandledMsgs=[],this.unupdatedMsgs=[]},A.resetUnsettledSysMsgs=function(){this.unhandledSysMsgs=[],this.unhandledSysMsgsForDeletedMsgs=[],this.unupdatedSysMsgs=[]},A.packetFromSync=function(V){return!V.obj||!!V.obj.sync},t.exports=k,e(780),e(781),e(782),e(802),e(804),e(805),e(806),e(807),e(808),e(809),e(810),e(815),e(816),e(817),e(818),e(822),e(823),e(824),e(825),e(826),e(827)},function(t,r,e){var n=e(28),o=String,s=TypeError;t.exports=function(a){if(n(a))return a;throw s(o(a)+" is not an object")}},function(t,r,e){var n=e(78);t.exports=function(o){if(typeof o=="object"&&"size"in o&&"has"in o&&"get"in o&&"set"in o&&"delete"in o&&"entries"in o)return o;throw TypeError(n(o)+" is not a map")}},function(t,r,e){var n=e(27),o=e(208),s=e(210),a=e(36),i=e(125),u=TypeError,c=Object.defineProperty,d=Object.getOwnPropertyDescriptor;r.f=n?s?function(m,v,g){if(a(m),v=i(v),a(g),typeof m=="function"&&v==="prototype"&&"value"in g&&"writable"in g&&!g.writable){var b=d(m,v);b&&b.writable&&(m[v]=g.value,g={configurable:"configurable"in g?g.configurable:b.configurable,enumerable:"enumerable"in g?g.enumerable:b.enumerable,writable:!1})}return c(m,v,g)}:c:function(m,v,g){if(a(m),v=i(v),a(g),o)try{return c(m,v,g)}catch{}if("get"in g||"set"in g)throw u("Accessors not supported");return"value"in g&&(m[v]=g.value),m}},function(t,r,e){var n=e(18),o=e(73),s=e(35),a=e(13),i=e(828),u=e(147).IM;function c(m){return this.subType="im",this.nosScene=m.nosScene||"im",this.nosSurvivalTime=m.nosSurvivalTime,m.Protocol=s,m.Message=i,m.constructor=c,this.init(m)}c.Protocol=s,c.parser=u,c.use=o.use,c.getInstance=o.getInstance,c.rmAllInstances=o.rmAllInstances,c.genInstanceName=function(m){return"NIM-account-"+m.account};var d=c.fn=c.prototype=n(o.prototype);c.info=d.info=a.info,t.exports=c,e(839),e(840),e(841),e(842),e(843),e(844),e(845),e(846),e(847),e(857),e(868),e(869),e(870),e(871),e(872),e(873),e(874),e(875),e(876),e(879),e(880)},function(t,r,e){var n=e(18),o=e(2),s=e(25);function a(c,d){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},v=this;v.message=c||m.message||"",s(d)==="object"?(v.event=d,v.code="Other_Error"):d!==void 0&&(v.code=d),v.timetag=+new Date,m!==void 0&&(v.event=m),v.event&&(v.callFunc=v.event.callFunc||null,delete v.event.callFunc)}a.prototype=n(Error.prototype),a.prototype.name="NIMError";var i={201:"客户端版本不对, 需升级sdk",302:"用户名或密码错误, 请检查appKey和token是否有效, account和token是否匹配",403:"非法操作或没有权限",404:"对象(用户/群/聊天室)不存在",405:"参数长度过长",408:"客户端请求超时",414:"参数错误",415:"服务不可用/没有聊天室服务器可分配",416:"频率控制",417:"重复操作",422:"帐号被禁用",500:"服务器内部错误",501:"数据库操作失败",503:"服务器繁忙",508:"删除有效期过了",509:"已失效",7101:"被拉黑",700:"批量操作部分失败",801:"群人数达到上限",802:"没有权限",803:"群不存在或未发生变化",804:"用户不在群里面",805:"群类型不匹配",806:"创建群数量达到限制",807:"群成员状态不对",809:"已经在群里",811:"强推列表中帐号数量超限",812:"群被禁言",813:"因群数量限制，部分拉人成功",814:"禁止使用群组消息已读服务",815:"群管理员人数上限",816:"批量操作部分失败",997:"协议已失效",998:"解包错误",999:"打包错误",9102:"通道失效",9103:"已经在其他端接听/拒绝过这通电话",11001:"对方离线, 通话不可送达",13002:"聊天室状态异常",13003:"在黑名单中",13004:"在禁言名单中",13006:"聊天室处于整体禁言状态,只有管理员能发言",Connect_Failed:"无法建立连接, 请确保能 ping/telnet 到云信服务器; 如果是IE8/9, 请确保项目部署在 HTTPS 环境下",Error_Internet_Disconnected:"网断了",Error_Connection_is_not_Established:"连接未建立",Error_Connection_Socket_State_not_Match:"socket状态不对",Error_Timeout:"超时",Param_Error:"参数错误",No_File_Selected:"请选择文件",Wrong_File_Type:"文件类型错误",File_Too_Large:"文件过大",Cross_Origin_Iframe:"不能获取跨域Iframe的内容",Not_Support:"不支持",NO_DB:"无数据库",DB:"数据库错误",Still_In_Team:"还在群里",Session_Exist:"会话已存在",Session_Not_Exist:"会话不存在",Error_Unknown:"未知错误",Operation_Canceled:"操作取消",Sync_Error:"同步数据失败"},u=[200,406,808,810];o(u).call(u,function(c){i[c]=null}),a.genError=function(c){var d=i[c];return d===void 0&&(d="操作失败"),d===null?null:new a(d,c)},a.multiInstance=function(c){return new a("不允许初始化多个实例","Not_Allow_Multi_Instance",c)},a.newNetworkError=function(c){var d="Error_Internet_Disconnected";return new a(i[d],d,c)},a.newConnectError=function(c){var d="Connect_Failed";return new a(i[d]||null,d,c)},a.newConnectionError=function(c){var d="Error_Connection_is_not_Established";return new a(i[d],d,c)},a.newSocketStateError=function(c){var d="Error_Connection_Socket_State_not_Match";return new a(i[d],d,c)},a.newTimeoutError=function(c){var d="Error_Timeout";return new a(i[d],d,c)},a.newFrequencyControlError=function(c){var d=new a(i[416],416,c);return d.from="local",d},a.newParamError=function(c,d){return new a(c||i.Param_Error,"Param_Error",d)},a.newNoFileError=function(c,d){var m="No_File_Selected";return new a(c||i[m],m,d)},a.newWrongFileTypeError=function(c,d){var m="Wrong_File_Type";return new a(c||i[m],m,d)},a.newFileTooLargeError=function(c,d){var m="File_Too_Large";return new a(c||i[m],m,d)},a.newCORSIframeError=function(c){var d="Cross_Origin_Iframe";return new a(i[d],d,c)},a.newSupportError=function(c,d,m){return new a("不支持"+c,"Not_Support_"+d,m)},a.newSupportDBError=function(c){return a.newSupportError("数据库","DB",c)},a.noDBError=function(c){return new a(i.NO_DB,"NO_DB",c)},a.newDBError=function(c){return new a(i.DB,"DB",c)},a.newUnknownError=function(c){var d="Error_Unknown";return new a(i[d],d,c)},a.stillInTeamError=function(c){var d="Still_In_Team";return new a(i[d],d,c)},a.sessionExist=function(c){var d="Session_Exist";return new a(i[d],d,c)},a.sessionNotExist=function(c){var d="Session_Not_Exist";return new a(i[d],d,c)},a.cancel=function(c){var d="Operation_Canceled";return new a(i[d],d,c)},a.syncError=function(c){return new a(i.Sync_Error,"Sync_Error",c)},a.customError=function(c,d){c=c||"Other_Error";var m="";return(d=d||{}).message||(m=i[c]||c),s(c)!=="object"?new a(m,c,d):new a(m,"Other_Error",d===void 0?c:d)},t.exports=a},function(t,r,e){t.exports=e(303)},function(t,r,e){var n=e(108),o=Object;t.exports=function(s){return o(n(s))}},function(t,r,e){var n=e(124),o=e(108);t.exports=function(s){return n(o(s))}},function(t,r,e){var n=e(0),o={init:function(){o.deviceId=n.guid()}};o.init(),o.clientTypeMap={1:"Android",2:"iOS",4:"PC",8:"WindowsPhone",16:"Web",32:"Server",64:"Mac"},o.db={open:function(){}},o.rnfs=null,t.exports=o},function(t,r,e){var n=e(322);t.exports=function(o){return n(o.length)}},function(t,r,e){var n=e(34),o=e(19),s=e(36),a=e(78),i=e(233),u=e(45),c=e(21),d=e(234),m=e(136),v=e(235),g=TypeError,b=function(k,y){this.stopped=k,this.result=y},T=b.prototype;t.exports=function(k,y,A){var V,he,ae,Ne,_e,Ce,re,ue=A&&A.that,ze=!(!A||!A.AS_ENTRIES),le=!(!A||!A.IS_RECORD),de=!(!A||!A.IS_ITERATOR),Ie=!(!A||!A.INTERRUPTED),ie=n(y,ue),Ve=function(Dt){return V&&v(V,"normal",Dt),new b(!0,Dt)},Ue=function(Dt){return ze?(s(Dt),Ie?ie(Dt[0],Dt[1],Ve):ie(Dt[0],Dt[1])):Ie?ie(Dt,Ve):ie(Dt)};if(le)V=k.iterator;else if(de)V=k;else{if(!(he=m(k)))throw g(a(k)+" is not iterable");if(i(he)){for(ae=0,Ne=u(k);Ne>ae;ae++)if((_e=Ue(k[ae]))&&c(T,_e))return _e;return new b(!1)}V=d(k,he)}for(Ce=le?k.next:V.next;!(re=o(Ce,V)).done;){try{_e=Ue(re.value)}catch(Dt){v(V,"throw",Dt)}if(typeof _e=="object"&&_e&&c(T,_e))return _e}return new b(!1)}},function(t,r,e){t.exports=e(247)},function(t,r){t.exports=!0},function(t,r,e){var n=e(65),o=String;t.exports=function(s){if(n(s)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return o(s)}},function(t,r,e){var n=e(256),o=typeof self=="object"&&self&&self.Object===Object&&self,s=n||o||Function("return this")();t.exports=s},function(t,r,e){var n=e(716);t.exports=function(o,s,a){return a?n(o.entries(),function(i){return s(i[1],i[0])}):o.forEach(s)}},function(t,r,e){t.exports=e(559)},function(t,r,e){var n=e(27),o=e(38),s=e(77);t.exports=n?function(a,i,u){return o.f(a,i,s(1,u))}:function(a,i,u){return a[i]=u,a}},function(t,r,e){(function(n){var o=e(15),s=e(26),a=e(6),i=e(139),u=e(2),c=e(10),d=e(5),m=e(138),v=e(3),g=e(85),b=e(86),T=e(70),k=e(32);function y(kt,Et){var cr=b!==void 0&&T(kt)||kt["@@iterator"];if(!cr){if(k(kt)||(cr=function(Ar,Rr){var Mn;if(Ar){if(typeof Ar=="string")return A(Ar,Rr);var Or=o(Mn=Object.prototype.toString.call(Ar)).call(Mn,8,-1);if(Or==="Object"&&Ar.constructor&&(Or=Ar.constructor.name),Or==="Map"||Or==="Set")return g(Ar);if(Or==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Or))return A(Ar,Rr)}}(kt))||Et&&kt&&typeof kt.length=="number"){cr&&(kt=cr);var mr=0,yr=function(){};return{s:yr,n:function(){return mr>=kt.length?{done:!0}:{done:!1,value:kt[mr++]}},e:function(Ar){throw Ar},f:yr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Tr,Ir=!0,kr=!1;return{s:function(){cr=cr.call(kt)},n:function(){var Ar=cr.next();return Ir=Ar.done,Ar},e:function(Ar){kr=!0,Tr=Ar},f:function(){try{Ir||cr.return==null||cr.return()}finally{if(kr)throw Tr}}}}function A(kt,Et){(Et==null||Et>kt.length)&&(Et=kt.length);for(var cr=0,mr=new Array(Et);cr<Et;cr++)mr[cr]=kt[cr];return mr}var V=e(486);function he(){return typeof window<"u"?window:n!==void 0?n:typeof self<"u"?self:{}}function ae(kt){var Et;return o(Et=Object.prototype.toString.call(kt)).call(Et,8,-1)}function Ne(kt){return ae(kt).toLowerCase()}function _e(kt){return Ne(kt)==="string"}function Ce(kt){return Ne(kt)==="number"}function re(kt){return Ne(kt)==="array"}function ue(kt){return typeof kt=="function"}function ze(kt){return Ne(kt)==="date"}function le(kt){return kt===null}function de(kt){return kt!==null}function Ie(kt){return kt===void 0}function ie(kt){return kt!==void 0}function Ve(kt){return ie(kt)&&de(kt)}function Ue(kt){return Ie(kt)||le(kt)}function Dt(kt){return Ve(kt)&&Ne(kt)==="object"}var tr=function(kt,Et,cr){kt.addEventListener?kt.addEventListener(Et,cr,!1):kt.attachEvent&&kt.attachEvent("on"+Et,cr)},dr=tr,fr=function(kt,Et,cr){kt.removeEventListener?kt.removeEventListener(Et,cr,!1):kt.detachEvent&&kt.detachEvent("on"+Et,cr)},sr=fr;function hr(){var kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){},cr=arguments.length>2?arguments[2]:void 0;for(var mr in kt)kt.hasOwnProperty(mr)&&Et.call(cr,mr,kt[mr])}function Fe(kt,Et){hr(Et,function(cr,mr){kt[cr]=mr})}var or,ir=(or=0,function(){return""+or++});function $e(kt){return _e(kt)&&a(kt).call(kt,"{")===0&&i(kt).call(kt,"}")===kt.length-1}function er(kt,Et,cr){if(!kt)return"";var mr=[];return hr(kt,function(yr,Tr){ue(Tr)||(ze(Tr)?Tr=Tr.getTime():re(Tr)?Tr=Tr.join(","):Dt(Tr)&&(Tr=c(Tr)),cr&&(Tr=encodeURIComponent(Tr)),mr.push(encodeURIComponent(yr)+"="+Tr))}),mr.join(Et||",")}var nr,Pt=(nr=/^([\w]+?:\/\/.*?(?=\/|$))/i,function(kt){return nr.test(kt||"")?RegExp.$1.toLowerCase():""});function rr(kt){var Et=he();return kt.tagName&&kt.tagName.toUpperCase()==="INPUT"||Et.Blob&&kt instanceof Et.Blob}t.exports={o:{},emptyObj:{},f:function(){},emptyFunc:function(){},regBlank:/\s+/gi,regWhiteSpace:/\s+/gi,getGlobal:he,getClass:ae,typeOf:Ne,isString:_e,isNumber:Ce,isInt:function(kt){return Ce(kt)&&kt%1==0},isBoolean:function(kt){return Ne(kt)==="boolean"},isArray:re,isFunction:ue,isDate:ze,isRegExp:function(kt){return Ne(kt)==="regexp"},isError:function(kt){return Ne(kt)==="error"},isnull:le,notnull:de,undef:Ie,notundef:ie,exist:Ve,notexist:Ue,isObject:Dt,isEmpty:function(kt){return Ue(kt)||(_e(kt)||re(kt))&&kt.length===0},remove:function(kt){kt.parentNode&&kt.parentNode.removeChild(kt)},dataset:function(kt,Et,cr){if(!Ve(cr))return kt.getAttribute("data-"+Et);kt.setAttribute("data-"+Et,cr)},addEventListener:tr,on:dr,removeEventListener:fr,off:sr,target:function(kt){return kt.target||kt.srcElement},createIframe:function(kt){if(typeof document<"u"){var Et;if((kt=kt||{}).name)try{(Et=document.createElement('<iframe name="'+kt.name+'"></iframe>')).frameBorder=0}catch{(Et=document.createElement("iframe")).name=kt.name}else Et=document.createElement("iframe");kt.visible||(Et.style.display="none"),ue(kt.onload)&&dr(Et,"load",function mr(yr){Et.src&&(kt.multi||sr(Et,"load",mr),kt.onload(yr))}),(kt.parent||document.body).appendChild(Et);var cr=kt.src||"about:blank";return s(function(){Et.src=cr},0),Et}},html2node:function(kt){if(typeof document<"u"){var Et=document.createElement("div");Et.innerHTML=kt;var cr,mr,yr=[];if(Et.children)for(cr=0,mr=Et.children.length;cr<mr;cr++)yr.push(Et.children[cr]);else for(cr=0,mr=Et.childNodes.length;cr<mr;cr++){var Tr=Et.childNodes[cr];Tr.nodeType===1&&yr.push(Tr)}return yr.length>1?Et:yr[0]}},forOwn:hr,mixin:Fe,uniqueID:ir,isJSON:$e,parseJSON:function kt(Et){try{$e(Et)&&(Et=JSON.parse(Et)),Dt(Et)&&hr(Et,function(cr,mr){switch(Ne(mr)){case"string":case"object":Et[cr]=kt(mr)}})}catch{}return Et},simpleClone:function(kt){return V(kt)},merge:function(){for(var kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Et=arguments.length,cr=new Array(Et>1?Et-1:0),mr=1;mr<Et;mr++)cr[mr-1]=arguments[mr];return u(cr).call(cr,function(yr){Fe(kt,yr)}),kt},fillUndef:function(kt,Et){return hr(Et,function(cr,mr){Ie(kt[cr])&&(kt[cr]=mr)}),kt},checkWithDefault:function(kt,Et,cr){var mr=kt[Et]||kt[Et.toLowerCase()];return Ue(mr)&&(mr=cr,kt[Et]=mr),mr},fetch:function(kt,Et){return hr(kt,function(cr){Ve(Et[cr])&&(kt[cr]=Et[cr])}),kt},string2object:function(){var kt,Et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",cr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",",mr={};return u(kt=Et.split(cr)).call(kt,function(yr){var Tr=yr.split("="),Ir=Tr.shift();Ir&&(mr[decodeURIComponent(Ir)]=decodeURIComponent(Tr.join("=")))}),mr},object2string:er,genUrlSep:function(kt){return a(kt).call(kt,"?")<0?"?":"&"},object2query:function(kt){return er(kt,"&",!0)},url2origin:Pt,isFileInput:rr,getKeys:function(kt,Et){var cr=d(kt);return Et&&m(cr).call(cr,function(mr,yr){var Tr=rr(kt[mr]);return Tr===rr(kt[yr])?0:Tr?1:-1}),cr},_get:function(kt,Et){var cr,mr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,yr=Et.replace(/\[(\d+)\]/g,".$1").split("."),Tr=kt,Ir=y(yr);try{for(Ir.s();!(cr=Ir.n()).done;){var kr=cr.value;if((Tr=Object(Tr)[kr])===void 0)return mr}}catch(Ar){Ir.e(Ar)}finally{Ir.f()}return Tr},getPromiseWithAbort:function(kt){var Et={},cr=new v(function(mr,yr){Et.abort=yr});return Et.promise=v.race([kt,cr]),Et}}}).call(this,e(56))},function(t,r,e){var n=e(33),o=e(713),s=n("Map");t.exports={Map:s,set:o("set",2),get:o("get",1),has:o("has",1),remove:o("delete",1),proto:s.prototype}},function(t,r){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch{typeof window=="object"&&(e=window)}t.exports=e},function(t,r,e){t.exports=e(581)},function(t,r,e){var n=e(137),o=e(248);t.exports=function(s,a,i){return(a=o(a))in s?n(s,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[a]=i,s},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(253)},function(t,r,e){t.exports=e(476)},function(t,r,e){t.exports=e(479)},function(t,r,e){t.exports=e(482)},function(t,r,e){var n=e(11),o=n({}.toString),s=n("".slice);t.exports=function(a){return s(o(a),8,-1)}},function(t,r,e){var n=e(33);t.exports=n("navigator","userAgent")||""},function(t,r,e){var n=e(161),o=e(16),s=e(63),a=e(20)("toStringTag"),i=Object,u=s(function(){return arguments}())=="Arguments";t.exports=n?s:function(c){var d,m,v;return c===void 0?"Undefined":c===null?"Null":typeof(m=function(g,b){try{return g[b]}catch{}}(d=i(c),a))=="string"?m:u?s(d):(v=s(d))=="Object"&&o(d.callee)?"Arguments":v}},function(t,r,e){var n=e(53);t.exports=function(o,s,a,i){return i&&i.enumerable?o[s]=a:n(o,s,a),o}},function(t,r,e){e(82);var n=e(356),o=e(14),s=e(65),a=e(53),i=e(99),u=e(20)("toStringTag");for(var c in n){var d=o[c],m=d&&d.prototype;m&&s(m)!==u&&a(m,u,c),i[c]=i.Array}},function(t,r,e){var n=e(31),o=TypeError,s=function(a){var i,u;this.promise=new a(function(c,d){if(i!==void 0||u!==void 0)throw o("Bad Promise constructor");i=c,u=d}),this.resolve=n(i),this.reject=n(u)};t.exports.f=function(a){return new s(a)}},function(t,r,e){t.exports=e(427)},function(t,r,e){t.exports=e(470)},function(t,r,e){var n=e(766);n.fn=n.prototype,t.exports=n,e(768),e(769),e(770),e(771),e(772),e(773),e(774),e(775),e(776),e(777),e(778)},function(t,r,e){var n=e(25),o=e(5),s=e(10),a=e(17),i=e(2),u=e(8),c=e(15),d=e(85),m=e(86),v=e(70),g=e(32);function b(le,de){var Ie=m!==void 0&&v(le)||le["@@iterator"];if(!Ie){if(g(le)||(Ie=function(dr,fr){var sr;if(dr){if(typeof dr=="string")return T(dr,fr);var hr=c(sr=Object.prototype.toString.call(dr)).call(sr,8,-1);if(hr==="Object"&&dr.constructor&&(hr=dr.constructor.name),hr==="Map"||hr==="Set")return d(dr);if(hr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(hr))return T(dr,fr)}}(le))||de&&le&&typeof le.length=="number"){Ie&&(le=Ie);var ie=0,Ve=function(){};return{s:Ve,n:function(){return ie>=le.length?{done:!0}:{done:!1,value:le[ie++]}},e:function(dr){throw dr},f:Ve}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ue,Dt=!0,tr=!1;return{s:function(){Ie=Ie.call(le)},n:function(){var dr=Ie.next();return Dt=dr.done,dr},e:function(dr){tr=!0,Ue=dr},f:function(){try{Dt||Ie.return==null||Ie.return()}finally{if(tr)throw Ue}}}}function T(le,de){(de==null||de>le.length)&&(de=le.length);for(var Ie=0,ie=new Array(de);Ie<de;Ie++)ie[Ie]=le[Ie];return ie}var k=e(0),y=k.undef,A=k.notundef,V=k.exist,he=e(192),ae=e(295),Ne={p2p:0,team:1,superTeam:5},_e={0:"p2p",1:"team",5:"superTeam"},Ce=o(Ne),re=ae.typeMap,ue=ae.validTypes;function ze(le){k.verifyOptions(le,"scene to type","msg::Message"),k.verifyParamValid("scene",le.scene,Ce,"msg::Message"),this.scene=Ne[le.scene],this.to=""+le.to,this.type=re[le.type],this.resend=le.resend?1:0,le.resend?(k.verifyOptions(le,"idClient","msg::Message"),this.idClient=le.idClient):this.idClient=k.guid(),A(le.subType)&&(k.isInt(+le.subType)&&+le.subType>0?this.subType=+le.subType:k.onParamError("subType只能是大于0的整数","msg::Message"));var de=le.replyMsg;de&&de.idServer&&de.from&&de.to&&de.time&&(this.replyMsgFromAccount=de.from,this.replyMsgToAccount=de.to,this.replyMsgTime=de.time,this.replyMsgIdServer=de.idServer,this.replyMsgIdClient=de.idClient,de.threadMsgFromAccount&&de.threadMsgIdServer&&de.threadMsgTime&&de.threadMsgToAccount?(this.threadMsgFromAccount=de.threadMsgFromAccount,this.threadMsgToAccount=de.threadMsgToAccount,this.threadMsgTime=de.threadMsgTime,this.threadMsgIdServer=de.threadMsgIdServer,this.threadMsgIdClient=de.threadMsgIdClient):(this.threadMsgFromAccount=de.from,this.threadMsgToAccount=de.to,this.threadMsgTime=de.time,this.threadMsgIdServer=de.idServer,this.threadMsgIdClient=de.idClient)),A(le.text)&&(this.body=""+le.text),A(le.custom)&&(n(le.custom)==="object"?this.custom=s(le.custom):this.custom=""+le.custom),A(le.body)&&(this.body=""+le.body),A(le.pushContent)&&(this.pushContent=""+le.pushContent),A(le.pushPayload)&&(this.pushPayload=""+le.pushPayload);var Ie=le.apns;if(A(Ie)&&le.scene==="team"){var ie=Ie.accounts;A(ie)&&k.verifyParamType("apns.accounts",ie,"array","msg::Message"),this.apnsAccounts=ie?s(ie):"#%@all@%#",this.apnsContent=Ie.content||le.pushContent||"",k.verifyBooleanWithDefault(Ie,"forcePush",!0,"options.apns","msg::Message"),this.apnsForcePush=Ie.forcePush?1:0}var Ve=le.robotInfo;A(Ve)&&(le.scene==="team"&&k.verifyOptions(le.robotInfo,"account","msg::Message::robotInfo scene === team"),Ve.function&&(this.robotInfoFunction=Ve.function),Ve.topic&&(this.robotInfoTopic=Ve.topic),Ve.customContent&&(this.robotInfoCustomContent=Ve.customContent),Ve.account&&(this.robotInfoAccount=Ve.account)),A(le.isHistoryable)&&(this.isHistoryable=le.isHistoryable?1:0),A(le.isRoamingable)&&(this.isRoamingable=le.isRoamingable?1:0),A(le.isSyncable)&&(this.isSyncable=le.isSyncable?1:0),A(le.cc)&&(this.cc=le.cc?1:0),A(le.env)&&(this.env=le.env),A(le.isPushable)&&(this.isPushable=le.isPushable?1:0),A(le.isOfflinable)&&(this.isOfflinable=le.isOfflinable?1:0),A(le.isUnreadable)&&(this.isUnreadable=le.isUnreadable?1:0),A(le.needPushNick)&&(this.needPushNick=le.needPushNick?1:0),A(le.needMsgReceipt)&&(this.needMsgReceipt=le.needMsgReceipt?1:0),A(le.yidunEnable)&&(this.yidunEnable=le.yidunEnable?1:0),this.needUpdateSession=le.needUpdateSession===!1?0:1,A(le.antiSpamUsingYidun)&&(this.antiSpamUsingYidun=le.antiSpamUsingYidun?1:0),A(le.clientAntiSpam)&&(this.clientAntiSpam=le.clientAntiSpam?1:0),A(le.antiSpamContent)&&(n(le.antiSpamContent)==="object"?this.antiSpamContent=s(le.antiSpamContent):this.antiSpamContent=""+le.antiSpamContent),A(le.antiSpamBusinessId)&&(n(le.antiSpamBusinessId)==="object"?this.antiSpamBusinessId=s(le.antiSpamBusinessId):this.antiSpamBusinessId=""+le.antiSpamBusinessId),A(le.yidunAntiCheating)&&(this.yidunAntiCheating=le.yidunAntiCheating),A(le.yidunAntiSpamExt)&&(this.yidunAntiSpamExt=le.yidunAntiSpamExt)}k.merge(ze.prototype,ae.prototype),ze.prototype.getScene=function(){return _e[this.scene]},ze.getType=ae.getType,ze.setFlow=ae.setFlow,ze.reverse=function(le){var de,Ie=_e[le.scene];if(de=le.delete==="1"?{delete:!0,scene:Ie||le.scene,from:le.from,time:+le.time,to:""+le.to}:{scene:Ie||le.scene,from:le.from,fromNick:le.fromNick,fromClientType:he.reverseType(le.fromClientType),fromDeviceId:le.fromDeviceId,to:""+le.to,time:+le.time,type:ze.getType(le),text:V(le.body)?le.body:le.text||"",isHistoryable:y(le.isHistoryable)||+le.isHistoryable==1,isRoamingable:y(le.isRoamingable)||+le.isRoamingable==1,isSyncable:y(le.isSyncable)||+le.isSyncable==1,cc:y(le.cc)||+le.cc==1,isPushable:y(le.isPushable)||+le.isPushable==1,isOfflinable:y(le.isOfflinable)||+le.isOfflinable==1,isUnreadable:y(le.isUnreadable)||+le.isUnreadable==1,isReplyMsg:y(le.isReplyMsg)||+le.isReplyMsg==1,needPushNick:y(le.needPushNick)||+le.needPushNick==1,needMsgReceipt:+le.needMsgReceipt==1,isLocal:!1},le.isInBlackList&&(de.isInBlackList=+le.isInBlackList==1,de.isInBlackList&&(le.status="fail")),A(le.isMuted)&&(de.isMuted=+le.isMuted==1),A(le.resend)&&(de.resend=+le.resend==1),A(le.idClient)&&(de.idClient=le.idClient),A(le.idServer)&&(de.idServer=""+le.idServer),A(le.userUpdateTime)&&(de.userUpdateTime=+le.userUpdateTime),A(le.custom)&&(de.custom=le.custom),A(le.callbackExt)&&(de.callbackExt=le.callbackExt),A(le.subType)&&(de.subType=+le.subType),A(le.pushContent)&&(de.pushContent=le.pushContent),A(le.pushPayload)&&(de.pushPayload=le.pushPayload),A(le.tempTeamMemberCount)&&(de.tempTeamMemberCount=+le.tempTeamMemberCount),A(le.yidunAntiSpamRes)&&(de.yidunAntiSpamRes=le.yidunAntiSpamRes),A(le.apnsAccounts)){if(de.apns={},le.apnsAccounts!=="#%@all@%#"){var ie=le.apnsAccounts;try{de.apns.accounts=JSON.parse(ie)}catch{de.apns.accounts=[]}}de.apns.content=le.apnsContent||"",de.apns.forcePush=+le.apnsForcePush==1}if(A(le.robotInfoFunction)&&(de.robotInfo=de.robotInfo||{},le.robotInfoFunction&&(de.robotInfo.function=le.robotInfoFunction)),A(le.robotInfoCustomContent)&&(de.robotInfo=de.robotInfo||{},le.robotInfoCustomContent&&(de.robotInfo.customContent=le.robotInfoCustomContent)),A(le.robotInfoTopic)&&(de.robotInfo=de.robotInfo||{},le.robotInfoTopic&&(de.robotInfo.topic=le.robotInfoTopic)),A(le.robotInfoAccount)&&(de.robotInfo=de.robotInfo||{},le.robotInfoAccount&&(de.robotInfo.account=le.robotInfoAccount)),A(le.needUpdateSession)&&(de.needUpdateSession=+le.needUpdateSession==1),de.status=le.status||"success",A(a(le))&&(de.filter=a(le)),le.replyMsgIdServer&&le.threadMsgIdServer){var Ve=["replyMsgFromAccount","replyMsgToAccount","replyMsgTime","replyMsgIdServer","replyMsgIdClient","threadMsgFromAccount","threadMsgToAccount","threadMsgTime","threadMsgIdServer","threadMsgIdClient"];i(Ve).call(Ve,function(Ue){de[Ue]=le[Ue]}),de.replyMsgTime=+de.replyMsgTime,de.threadMsgTime=+de.threadMsgTime}return de},ze.setExtra=function(le,de){le.target=ze.getMsgTarget(le,de),le.sessionId=le.scene+"-"+le.target,ae.setFlow(le,de)},ze.getMsgTarget=function(le,de){return le.scene==="p2p"?le.to===de?le.from:le.to:le.scene==="team"||le.scene==="superTeam"?le.to:void 0},ze.deduplication=function(le){var de,Ie,ie={},Ve=b(le);try{for(Ve.s();!(Ie=Ve.n()).done;){var Ue=Ie.value,Dt=ie[Ue.idClient];Dt&&Dt.time>Ue.time||(ie[Ue.idClient]=Ue)}}catch(tr){Ve.e(tr)}finally{Ve.f()}return u(de=o(ie)).call(de,function(tr){return ie[tr]})},ze.sortMsgs=function(le){return le=c(le).call(le,0),k.sortObjArray(le,{sortPath:"time"}),le},ze.getLastMsg=function(le){return(le=ze.sortMsgs(le))[le.length-1]},ze.getLastNotIgnoredMsg=function(le){for(var de=null,Ie=(le=ze.sortMsgs(le)).length-1;Ie>=0;Ie--)if(!(de=le[Ie]).ignore)return de;return null},ze.getMaxTimetag=function(le){return ze.getLastMsg(le).time},ze.validScenes=Ce,ze.validTypes=ue,ze.sceneMap=Ne,ze.sceneReverseMap=_e,t.exports=ze},function(t,r,e){var n=e(25),o=e(18),s=e(32),a=e(2),i=e(378),u=e(6),c=e(5),d=e(10),m=e(3),v=e(169),g=e(0),b=g.notundef,T=e(554),k=e(13),y=(e(183),e(44)),A=e(580).wrapSafeCallback,V=e(23).reportAPI;function he(){}var ae={};he.getInstance=function(re){re=_e(re),g.verifyOptions(re,"account","api::Base.getInstance");var ue=this.genInstanceName(re),ze=ae[ue];return ze?he.updateInstance(ze,re):ze=ae[ue]=new this(re),ze},he.updateInstance=function(re,ue){re.setOptions(ue),re.connect()};var Ne=he.fn=he.prototype=o(new v),_e=function(re){return re.nosSurvivalTime?(g.verifyParamType("nosSurvivalTime",re.nosSurvivalTime,"number","api::Base.getInstance"),g.verifyParamMin("nosSurvivalTime",re.nosSurvivalTime,86400,"api::Base.getInstance")):re.nosSurvivalTime=1/0,re};Ne.updatePrivateConf=function(re){if(V({instance:this,className:"ApiBaseFn",funcName:"updatePrivateConf",hasCallback:!1}),re&&n(re.privateConf)==="object"){var ue=re.privateConf;typeof ue.lbs_web=="string"&&(re.lbsUrl=ue.lbs_web),typeof ue.link_ssl_web=="boolean"&&(re.secure=ue.link_ssl_web),typeof ue.https_enabled=="boolean"&&(re.httpsEnabled=ue.https_enabled),re.uploadUrl=ue.nos_uploader_web?ue.nos_uploader_web:null,re.chunkUploadUrl=ue.nos_uploader_web?ue.nos_uploader_web:null,re.replaceUrl=ue.nos_downloader?ue.nos_downloader:null,re.downloadUrl=ue.nos_accelerate?ue.nos_accelerate:null,re.downloadHost=ue.nos_accelerate_host?ue.nos_accelerate_host:null,re.downloadHostList=ue.nos_accelerate_host_list||[],re.downloadHost&&re.downloadHostList.push(re.downloadHost),re.nosCdnEnable=ue.nos_cdn_enable!==!1,re.ntServerAddress=ue.nt_server||null,re.kibanaServer=ue.kibana_server,re.statisticServer=ue.statistic_server,re.reportGlobalServer=ue.report_global_server,re.ipVersion=ue.ip_protocol_version||re.ipVersion,re.defaultLink=ue.link_web||re.defaultLink,re.ipv6DefaultLink=ue.link_ipv6_web||re.ipv6DefaultLink,typeof ue.nos_lbs=="string"?re.nosLbsUrls=[ue.nos_lbs]:re.nosLbsUrls=[],s(ue.nos_edge_list)&&(re.edgeList=ue.nos_edge_list)}return re.ntServerAddress===null||re.ntServerAddress===""?k.ntServerAddress=null:k.ntServerAddress=re.ntServerAddress,k.uploadUrl=re.uploadUrl||k.uploadUrl,k.chunkUploadUrl=re.chunkUploadUrl||k.chunkUploadUrl,k.downloadUrl=re.downloadUrl||k.downloadUrl,k.downloadHost=re.downloadHost||k.downloadHost,k.downloadHostList=re.downloadHostList&&re.downloadHostList.length>0?re.downloadHostList:k.downloadHostList,k.nosCdnEnable=re.nosCdnEnable!==!1,k.replaceUrl=re.replaceUrl||k.replaceUrl,k.httpsEnabled=re.httpsEnabled||k.httpsEnabled,re.probe_ipv4_url&&(k.ipProbeAddr.ipv4=re.probe_ipv4_url),re.probe_ipv6_url&&(k.ipProbeAddr.ipv6=re.probe_ipv6_url),re},Ne.init=function(re){g.verifyOptions(re,"account","api::Base.init"),re=this.updatePrivateConf(re),g.verifyBooleanWithDefault(re,"exifOrientation",!0,"","api::Base.init"),re.lbsBackup=re.lbsBackup===void 0||re.lbsBackup;var ue=this.account=re.account=re.account+"",ze=re.constructor.genInstanceName(re),le=ae[ze];if(re._disableSingleton&&(le=null),le)return he.updateInstance(le,re),le;this.logger=re.logger=new T({debug:re.debug,logFunc:re.logFunc,prefix:this.subType,dbLog:re.dbLog!==!1,account:re.account,expire:re.expire,logLevel:re.logLevel}),this.options=A(re,this),re.api=this;var de=this.protocol=new re.Protocol(re);return de.name="Protocol-"+ze,de.account=ue,de.api=this,de.message=this.message=new re.Message({account:ue}),this.reporter=de.reporter,this.statusProtector=de.statusProtector,this.reporterHook=de.reporterHook,this.abtInfo={},(typeof g.get(re,"privateConf.isABTestEnable")=="boolean"?re.privateConf.isABTestEnable:k.privateConf.isABTestEnable)&&this.abTestConfigRequset(),this.name=ze,ae[ze]=this,this},Ne.destroy=function(re){var ue=this;(re=re||{}).done=V({instance:this,className:"ApiBaseFn",funcName:"destroy",done:re.done});var ze=this;if(!ze.__beginDestroy){var le;ze.__beginDestroy=!0,re=re||{};var de,Ie=this.name;if(this.logger.warn("destroy::start"),!Ie)return this.logger&&this.logger.warn&&this.logger.warn("destroy::no instanceName"),void(ze.__beginDestroy=void 0);this.protocol&&(le=this.protocol.connectTimer),this.protocol&&this.protocol.resetPush&&this.protocol.resetPush(),this.eventNames&&typeof this.eventNames=="function"&&a(de=this.eventNames()).call(de,function(ie){delete ue._events[ie]}),this.disconnect({done:function(ie){var Ve,Ue,Dt;ze.logger.warn("ApiBase::destroy: instance destroyed ..."),ze.__beginDestroy=void 0,ze.reporter.destroy(),ze.statusProtector.destroy(),ze.reporterHook.destroy(),a(Ve=i(ze.options)).call(Ve,function(dr){u(dr).call(dr,"on")===0&&(ze.options[dr]=function(){},ze.protocol.options[dr]=function(){},ze.protocol.api.options[dr]=function(){})}),ze.logger.destroy(),n(ze.protocol.sessionSet)==="object"&&a(Ue=c(ze.protocol.sessionSet)).call(Ue,function(dr){ze.protocol.sessionSet[dr].unreadMsgs=[],ze.protocol.sessionSet[dr]=void 0}),ze.protocol.syncResult={},ze.db&&ze.db.close();var tr=ze.protocol;a(Dt=i(ze)).call(Dt,function(dr){ze[dr]=void 0}),ae&&(ae[Ie]=null,clearTimeout(le)),tr&&(tr.__destroyed=!0),re.done instanceof Function&&re.done(ie)}})}},Ne.setOptions=function(re){re=A(re,this),this.protocol.setOptions(re)},Ne.abTestConfigRequset=function(){var re=this,ue=re.options.abTestUrl||"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",ze={projectKey:"im1_sdk_abtest_web",appKey:re.options.appKey,osType:"Web",sdkVersion:re.info.version,deviceId:y.deviceId},le=d({clientInfo:ze});this.protocol.adaptersRequest(ue,{method:"POST",timeout:5e3,headers:{"Content-Type":"application/json"},data:le,onload:function(de){var Ie=JSON.parse(de);re.abtInfo=Ie.data.abtInfo||{},re.logger&&re.logger.info("abTestConfigRequset::success",re.abtInfo)},onerror:function(){re.logger&&re.logger.info("abTestConfigRequset::fail")}},{exception_service:7})},Ne.processCallback=function(re,ue){Ce(re,ue)},Ne.processCallbackPromise=function(re,ue){return new m(function(ze,le){Ce(re,ue,!0,ze,le)})};var Ce=function(re,ue,ze,le,de){var Ie="api::processCallback";ze&&(Ie="api::processCallbackPromise"),g.verifyCallback(re,"done",Ie),re.callback=function(ie,Ve,Ue){var Dt=re.callback.options;if(Ve=Ve||Dt,ue&&(Ve=Dt),g.isFunction(re.cbaop)){var tr=re.cbaop(ie,Ve);b(tr)&&(Ve=tr)}var dr=re.done;g.isObject(Ve)&&(delete Ve.done,delete Ve.cb,delete Ve.callback),ze?ie?de({message:"生成接口回调错误",callFunc:Ie,event:ie}):le(Ve):dr(ie,Ve,Ue)},re.callback.options=g.copy(re)};Ne.processPs=function(re){g.notexist(re.ps)&&(re.ps=""),g.verifyArrayMax("ps",re.ps,5e3)},Ne.processCustom=function(re){g.notexist(re.custom)&&(re.custom="")},Ne.sendCmd=function(){this.protocol.sendCmd.apply(this.protocol,arguments)},Ne.sendCmdWithResp=function(re,ue,ze){this.sendCmd(re,ue,function(le,de,Ie){g.isFunction(ze)&&(le?ze(le,de):ze(null,Ie))})},Ne.cbAndSendCmd=function(re,ue){var ze=this.processCallbackPromise(ue);return this.sendCmd(re,ue),ze},Ne.sendCmdUsePromise=function(re,ue){var ze=this,le=V({instance:this,className:"ApiBaseFn",funcName:re,hasCallback:!0});return new m(function(de,Ie){ze.sendCmd(re,ue,function(ie,Ve,Ue){if(ie)typeof le=="function"&&le(ie),Ie(ie);else{var Dt=g.merge({},Ve,Ue);typeof le=="function"&&le(void 0),de(Dt)}})})},he.use=function(re,ue){re&&re.install&&g.isFunction(re.install)&&re.install(this,ue)},he.rmAllInstances=function(){for(var re in ae)ae[re].destroy();ae={}},Ne.logout=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};re.callback=V({instance:this,className:"ApiBaseFn",funcName:"logout",done:re.callback}),re=re||{},this.protocol.shouldReconnect=!1,this.protocol.doLogout=!0,this.processCallback(re),this.sendCmd("logout",re,re.callback),this.protocol.statusProtector.emit("auth/loginLifeCycleLogout")},t.exports=he,e(584),e(585),e(627),e(628),e(638),e(642)},function(t,r,e){(function(n){var o=e(15),s=e(6),a=e(301),i=e(52),u=e(25),c=function(){var d=(n===void 0?"undefined":u(n))==="object"?n:window,m=Math.pow(2,53)-1,v=/\bOpera/,g=Object.prototype,b=g.hasOwnProperty,T=g.toString;function k(_e){return(_e=String(_e)).charAt(0).toUpperCase()+o(_e).call(_e,1)}function y(_e){return _e=Ne(_e),/^(?:webOS|i(?:OS|P))/.test(_e)?_e:k(_e)}function A(_e,Ce){for(var re in _e)b.call(_e,re)&&Ce(_e[re],re,_e)}function V(_e){var Ce;return _e==null?k(_e):o(Ce=T.call(_e)).call(Ce,8,-1)}function he(_e){return String(_e).replace(/([ -])(?!$)/g,"$1?")}function ae(_e,Ce){var re=null;return function(ue,ze){var le=-1,de=ue?ue.length:0;if(typeof de=="number"&&de>-1&&de<=m)for(;++le<de;)ze(ue[le],le,ue);else A(ue,ze)}(_e,function(ue,ze){re=Ce(re,ue,ze,_e)}),re}function Ne(_e){return String(_e).replace(/^ +| +$/g,"")}return function _e(Ce){var re=d,ue=Ce&&u(Ce)==="object"&&V(Ce)!="String";ue&&(re=Ce,Ce=null);var ze=re.navigator||{},le=ze.userAgent||"";Ce||(Ce=le);var de,Ie,ie,Ve,Ue,Dt=ue?!!ze.likeChrome:/\bChrome\b/.test(Ce)&&!/internal|\n/i.test(T.toString()),tr=ue?"Object":"ScriptBridgingProxyObject",dr=ue?"Object":"Environment",fr=ue&&re.java?"JavaPackage":V(re.java),sr=ue?"Object":"RuntimeObject",hr=/\bJava/.test(fr)&&re.java,Fe=hr&&V(re.environment)==dr,or=hr?"a":"α",ir=hr?"b":"β",$e=re.document||{},er=re.operamini||re.opera,nr=v.test(nr=ue&&er?er["[[Class]]"]:V(er))?nr:er=null,Pt=Ce,rr=[],kt=null,Et=Ce==le,cr=Et&&er&&typeof er.version=="function"&&er.version(),mr=ae([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(Pr,Nr){return Pr||RegExp("\\b"+(Nr.pattern||he(Nr))+"\\b","i").exec(Ce)&&(Nr.label||Nr)}),yr=function(Pr){return ae(Pr,function(Nr,Wr){return Nr||RegExp("\\b"+(Wr.pattern||he(Wr))+"\\b","i").exec(Ce)&&(Wr.label||Wr)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),Tr=Ar([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Ir=function(Pr){return ae(Pr,function(Nr,Wr,Yr){return Nr||(Wr[Tr]||Wr[/^[a-z]+(?: +[a-z]+\b)*/i.exec(Tr)]||RegExp("\\b"+he(Yr)+"(?:\\b|\\w*\\d)","i").exec(Ce))&&Yr})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),kr=function(Pr){return ae(Pr,function(Nr,Wr){var Yr=Wr.pattern||he(Wr);return!Nr&&(Nr=RegExp("\\b"+Yr+"(?:/[\\d.]+|[ \\w.]*)","i").exec(Ce))&&(Nr=function(Ur,qr,Yn){var $n={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return qr&&Yn&&/^Win/i.test(Ur)&&!/^Windows Phone /i.test(Ur)&&($n=$n[/[\d.]+$/.exec(Ur)])&&(Ur="Windows "+$n),Ur=String(Ur),qr&&Yn&&(Ur=Ur.replace(RegExp(qr,"i"),Yn)),Ur=y(Ur.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(Nr,Yr,Wr.label||Wr)),Nr})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Ar(Pr){return ae(Pr,function(Nr,Wr){var Yr=Wr.pattern||he(Wr);return!Nr&&(Nr=RegExp("\\b"+Yr+" *\\d+[.\\w_]*","i").exec(Ce)||RegExp("\\b"+Yr+" *\\w+-[\\w]*","i").exec(Ce)||RegExp("\\b"+Yr+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(Ce))&&((Nr=String(Wr.label&&!RegExp(Yr,"i").test(Wr.label)?Wr.label:Nr).split("/"))[1]&&!/[\d.]+/.test(Nr[0])&&(Nr[0]+=" "+Nr[1]),Wr=Wr.label||Wr,Nr=y(Nr[0].replace(RegExp(Yr,"i"),Wr).replace(RegExp("; *(?:"+Wr+"[_-])?","i")," ").replace(RegExp("("+Wr+")[-_.]?(\\w)","i"),"$1 $2"))),Nr})}if(mr&&(mr=[mr]),Ir&&!Tr&&(Tr=Ar([Ir])),(de=/\bGoogle TV\b/.exec(Tr))&&(Tr=de[0]),/\bSimulator\b/i.test(Ce)&&(Tr=(Tr?Tr+" ":"")+"Simulator"),yr=="Opera Mini"&&/\bOPiOS\b/.test(Ce)&&rr.push("running in Turbo/Uncompressed mode"),yr=="IE"&&/\blike iPhone OS\b/.test(Ce)?(Ir=(de=_e(Ce.replace(/like iPhone OS/,""))).manufacturer,Tr=de.product):/^iP/.test(Tr)?(yr||(yr="Safari"),kr="iOS"+((de=/ OS ([\d_]+)/i.exec(Ce))?" "+de[1].replace(/_/g,"."):"")):yr!="Konqueror"||/buntu/i.test(kr)?Ir&&Ir!="Google"&&(/Chrome/.test(yr)&&!/\bMobile Safari\b/i.test(Ce)||/\bVita\b/.test(Tr))||/\bAndroid\b/.test(kr)&&/^Chrome/.test(yr)&&/\bVersion\//i.test(Ce)?(yr="Android Browser",kr=/\bAndroid\b/.test(kr)?kr:"Android"):yr=="Silk"?(/\bMobi/i.test(Ce)||(kr="Android",rr.unshift("desktop mode")),/Accelerated *= *true/i.test(Ce)&&rr.unshift("accelerated")):yr=="PaleMoon"&&(de=/\bFirefox\/([\d.]+)\b/.exec(Ce))?rr.push("identifying as Firefox "+de[1]):yr=="Firefox"&&(de=/\b(Mobile|Tablet|TV)\b/i.exec(Ce))?(kr||(kr="Firefox OS"),Tr||(Tr=de[1])):!yr||(de=!/\bMinefield\b/i.test(Ce)&&/\b(?:Firefox|Safari)\b/.exec(yr))?(yr&&!Tr&&/[\/,]|^[^(]+?\)/.test(o(Ce).call(Ce,s(Ce).call(Ce,de+"/")+8))&&(yr=null),(de=Tr||Ir||kr)&&(Tr||Ir||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(kr))&&(yr=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(kr)?kr:de)+" Browser")):yr=="Electron"&&(de=(/\bChrome\/([\d.]+)\b/.exec(Ce)||0)[1])&&rr.push("Chromium "+de):kr="Kubuntu",cr||(cr=ae(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version","HeadlessChrome",he(yr),"(?:Firefox|Minefield|NetFront)"],function(Pr,Nr){return Pr||(RegExp(Nr+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(Ce)||0)[1]||null})),(de=(mr=="iCab"&&a(cr)>3?"WebKit":/\bOpera\b/.test(yr)&&(/\bOPR\b/.test(Ce)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(Ce)&&!/^(?:Trident|EdgeHTML)$/.test(mr)&&"WebKit"||!mr&&/\bMSIE\b/i.test(Ce)&&(kr=="Mac OS"?"Tasman":"Trident")||mr=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(yr)&&"NetFront")&&(mr=[de]),yr=="IE"&&(de=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(Ce)||0)[1])?(yr+=" Mobile",kr="Windows Phone "+(/\+$/.test(de)?de:de+".x"),rr.unshift("desktop mode")):/\bWPDesktop\b/i.test(Ce)?(yr="IE Mobile",kr="Windows Phone 8.x",rr.unshift("desktop mode"),cr||(cr=(/\brv:([\d.]+)/.exec(Ce)||0)[1])):yr!="IE"&&mr=="Trident"&&(de=/\brv:([\d.]+)/.exec(Ce))&&(yr&&rr.push("identifying as "+yr+(cr?" "+cr:"")),yr="IE",cr=de[1]),Et){if(Ve="global",Ue=(ie=re)!=null?u(ie[Ve]):"number",/^(?:boolean|number|string|undefined)$/.test(Ue)||Ue=="object"&&!ie[Ve])V(de=re.runtime)==tr?(yr="Adobe AIR",kr=de.flash.system.Capabilities.os):V(de=re.phantom)==sr?(yr="PhantomJS",cr=(de=de.version||null)&&de.major+"."+de.minor+"."+de.patch):typeof $e.documentMode=="number"&&(de=/\bTrident\/(\d+)/i.exec(Ce))?(cr=[cr,$e.documentMode],(de=+de[1]+4)!=cr[1]&&(rr.push("IE "+cr[1]+" mode"),mr&&(mr[1]=""),cr[1]=de),cr=yr=="IE"?String(cr[1].toFixed(1)):cr[0]):typeof $e.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(yr)&&(rr.push("masking as "+yr+" "+cr),yr="IE",cr="11.0",mr=["Trident"],kr="Windows");else if(hr&&(Pt=(de=hr.lang.System).getProperty("os.arch"),kr=kr||de.getProperty("os.name")+" "+de.getProperty("os.version")),Fe){try{cr=re.require("ringo/engine").version.join("."),yr="RingoJS"}catch{(de=re.system)&&de.global.system==re.system&&(yr="Narwhal",kr||(kr=de[0].os||null))}yr||(yr="Rhino")}else u(re.process)==="object"&&!re.process.browser&&(de=re.process)&&(u(de.versions)==="object"&&(typeof de.versions.electron=="string"?(rr.push("Node "+de.versions.node),yr="Electron",cr=de.versions.electron):typeof de.versions.nw=="string"&&(rr.push("Chromium "+cr,"Node "+de.versions.node),yr="NW.js",cr=de.versions.nw)),yr||(yr="Node.js",Pt=de.arch,kr=de.platform,cr=(cr=/[\d.]+/.exec(de.version))?cr[0]:null));kr=kr&&y(kr)}if(cr&&(de=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(cr)||/(?:alpha|beta)(?: ?\d)?/i.exec(Ce+";"+(Et&&ze.appMinorVersion))||/\bMinefield\b/i.test(Ce)&&"a")&&(kt=/b/i.test(de)?"beta":"alpha",cr=cr.replace(RegExp(de+"\\+?$"),"")+(kt=="beta"?ir:or)+(/\d+\+?/.exec(de)||"")),yr=="Fennec"||yr=="Firefox"&&/\b(?:Android|Firefox OS)\b/.test(kr))yr="Firefox Mobile";else if(yr=="Maxthon"&&cr)cr=cr.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(Tr))Tr=="Xbox 360"&&(kr=null),Tr=="Xbox 360"&&/\bIEMobile\b/.test(Ce)&&rr.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(yr)&&(!yr||Tr||/Browser|Mobi/.test(yr))||kr!="Windows CE"&&!/Mobi/i.test(Ce))if(yr=="IE"&&Et)try{re.external===null&&rr.unshift("platform preview")}catch{rr.unshift("embedded")}else(/\bBlackBerry\b/.test(Tr)||/\bBB10\b/.test(Ce))&&(de=(RegExp(Tr.replace(/ +/g," *")+"/([.\\d]+)","i").exec(Ce)||0)[1]||cr)?(kr=((de=[de,/BB10/.test(Ce)])[1]?(Tr=null,Ir="BlackBerry"):"Device Software")+" "+de[0],cr=null):this!=A&&Tr!="Wii"&&(Et&&er||/Opera/.test(yr)&&/\b(?:MSIE|Firefox)\b/i.test(Ce)||yr=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(kr)||yr=="IE"&&(kr&&!/^Win/.test(kr)&&cr>5.5||/\bWindows XP\b/.test(kr)&&cr>8||cr==8&&!/\bTrident\b/.test(Ce)))&&!v.test(de=_e.call(A,Ce.replace(v,"")+";"))&&de.name&&(de="ing as "+de.name+((de=de.version)?" "+de:""),v.test(yr)?(/\bIE\b/.test(de)&&kr=="Mac OS"&&(kr=null),de="identify"+de):(de="mask"+de,yr=nr?y(nr.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(de)&&(kr=null),Et||(cr=null)),mr=["Presto"],rr.push(de));else yr+=" Mobile";if(de=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(Ce)||0)[1]){var Rr,Mn;de=[a(de.replace(/\.(\d)$/,".0$1")),de],yr=="Safari"&&o(Rr=de[1]).call(Rr,-1)=="+"?(yr="WebKit Nightly",kt="alpha",cr=o(Mn=de[1]).call(Mn,0,-1)):cr!=de[1]&&cr!=(de[2]=(/\bSafari\/([\d.]+\+?)/i.exec(Ce)||0)[1])||(cr=null),de[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(Ce)||0)[1],de[0]==537.36&&de[2]==537.36&&a(de[1])>=28&&mr=="WebKit"&&(mr=["Blink"]),Et&&(Dt||de[1])?(mr&&(mr[1]="like Chrome"),de=de[1]||((de=de[0])<530?1:de<532?2:de<532.05?3:de<533?4:de<534.03?5:de<534.07?6:de<534.1?7:de<534.13?8:de<534.16?9:de<534.24?10:de<534.3?11:de<535.01?12:de<535.02?"13+":de<535.07?15:de<535.11?16:de<535.19?17:de<536.05?18:de<536.1?19:de<537.01?20:de<537.11?"21+":de<537.13?23:de<537.18?24:de<537.24?25:de<537.36?26:mr!="Blink"?"27":"28")):(mr&&(mr[1]="like Safari"),de=(de=de[0])<400?1:de<500?2:de<526?3:de<533?4:de<534?"4+":de<535?5:de<537?6:de<538?7:de<601?8:"8"),mr&&(mr[1]+=" "+(de+=typeof de=="number"?".x":/[.+]/.test(de)?"":"+")),yr=="Safari"&&(!cr||i(cr)>45)&&(cr=de)}yr=="Opera"&&(de=/\bzbov|zvav$/.exec(kr))?(yr+=" ",rr.unshift("desktop mode"),de=="zvav"?(yr+="Mini",cr=null):yr+="Mobile",kr=kr.replace(RegExp(" *"+de+"$"),"")):yr=="Safari"&&/\bChrome\b/.exec(mr&&mr[1])&&(rr.unshift("desktop mode"),yr="Chrome Mobile",cr=null,/\bOS X\b/.test(kr)?(Ir="Apple",kr="iOS 4.3+"):kr=null),cr&&s(cr).call(cr,de=/[\d.]+$/.exec(kr))==0&&s(Ce).call(Ce,"/"+de+"-")>-1&&(kr=Ne(kr.replace(de,""))),mr&&!/\b(?:Avant|Nook)\b/.test(yr)&&(/Browser|Lunascape|Maxthon/.test(yr)||yr!="Safari"&&/^iOS/.test(kr)&&/\bSafari\b/.test(mr[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(yr)&&mr[1])&&(de=mr[mr.length-1])&&rr.push(de),rr.length&&(rr=["("+rr.join("; ")+")"]),Ir&&Tr&&s(Tr).call(Tr,Ir)<0&&rr.push("on "+Ir),Tr&&rr.push((/^on /.test(rr[rr.length-1])?"":"on ")+Tr),kr&&(de=/ ([\d.+]+)$/.exec(kr),Ie=de&&kr.charAt(kr.length-de[0].length-1)=="/",kr={architecture:32,family:de&&!Ie?kr.replace(de[0],""):kr,version:de?de[1]:null,toString:function(){var Pr=this.version;return this.family+(Pr&&!Ie?" "+Pr:"")+(this.architecture==64?" 64-bit":"")}}),(de=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Pt))&&!/\bi686\b/i.test(Pt)?(kr&&(kr.architecture=64,kr.family=kr.family.replace(RegExp(" *"+de),"")),yr&&(/\bWOW64\b/i.test(Ce)||Et&&/\w(?:86|32)$/.test(ze.cpuClass||ze.platform)&&!/\bWin64; x64\b/i.test(Ce))&&rr.unshift("32-bit")):kr&&/^OS X/.test(kr.family)&&yr=="Chrome"&&a(cr)>=39&&(kr.architecture=64),Ce||(Ce=null);var Or={};return Or.description=Ce,Or.layout=mr&&mr[0],Or.manufacturer=Ir,Or.name=yr,Or.prerelease=kt,Or.product=Tr,Or.ua=Ce,Or.version=yr&&cr,Or.os=kr||{architecture:null,family:null,version:null,toString:function(){return"null"}},Or.parse=_e,Or.toString=function(){return this.description||""},Or.version&&rr.unshift(cr),Or.name&&rr.unshift(yr),kr&&yr&&(kr!=String(kr).split(" ")[0]||kr!=yr.split(" ")[0]&&!Tr)&&rr.push(Tr?"("+kr+")":"on "+kr),rr.length&&(Or.description=rr.join(" ")),Or}()}();t.exports=c}).call(this,e(56))},function(t,r,e){var n=e(87),o=e(32),s=e(5),a=e(17),i=e(200),u=e(6),c=e(69),d=e(7),m=e(2),v=e(10),g=e(26),b=e(57),T=e(24),k=e(0),y=k.undef,A=e(13),V=e(40),he=e(154),ae=he.StatusProtector,Ne=(he.V2NIMLoginStatus,e(105)),_e=Ne.ReporterHook,Ce=Ne.EMSyncType,re=e(643),ue=e(644);function ze(de){k.undef(de.secure)&&(de.secure=!0),this.options=de,this.keepNosSafeUrl=this.options.keepNosSafeUrl||!1;var Ie=de.defaultLink||de.defaultLinkUrl;k.notundef(Ie)&&k.isString(Ie)&&(A.optionDefaultLinkUrl=n(Ie).call(Ie)),k.notundef(de.ipv6DefaultLink)&&k.isString(de.ipv6DefaultLink)&&(A.optionIpv6DefaultLinkUrl=de.ipv6DefaultLink),typeof de.heartbeatInterval=="number"&&(A.heartbeatInterval=de.heartbeatInterval),o(de.nosLbsUrls)&&(A.nosLbsUrls=de.nosLbsUrls);var ie=this.options.socketConcurrent;ie=typeof ie=="number"&&ie>=1&&ie<=3?ie:1,this.options.socketConcurrent=ie,this.options.rollbackDelMsgUnread!==void 0&&typeof this.options.rollbackDelMsgUnread=="boolean"||(this.options.rollbackDelMsgUnread=!0),this.init(),this.connect()}var le=ze.fn=ze.prototype;le.init=function(){var de=this;this.logger=this.options.logger,this.getNosOriginUrlReqNum=0,this.checkNosReqNum=0,this.cmdTaskArray=[],this.timerMap={},this.cmdCallbackMap={},this.cmdContentMap={},this.initConnect(),this.reset(),this.statusProtector=new ae(this),this.reporterHook=new _e(this,this.options.reporterHookConfig),this.promiseAbortManager=new re,this.imsocket=new ue(this,{socketConcurrent:this.options.socketConcurrent}),this.statusProtector.on("auth/loginLifeCycleLogout",function(){de.promiseAbortManager.clear()}),this.statusProtector.on("auth/loginLifeCycleLoginSucc",function(){de.reporterHook.reset(),de.reporterHook.setOriginTimetick()})},le.reset=function(){y(this.options.thumbnailToStatic)&&(this.options.thumbnailToStatic=!0),this.resetConnect()},le.setOptions=function(de){var Ie=this.options,ie=s(Ie),Ve=s(de),Ue=["onconnect","onerror","onwillreconnect","ondisconnect","onloginportschange","onmyinfo","onblacklist","onmutelist","onfriends","onusers","onrobots","onteams","onSuperTeams","onsessions","onSessionsWithMoreRoaming","onStickTopSessions","onroamingmsgs","onofflinemsgs","onofflinefiltermsgs","onroamingsysmsgs","onofflinesysmsgs","onofflinefiltersysmsgs","onofflinecustomsysmsgs","onofflinefiltercustomsysmsgs","onbroadcastmsg","onbroadcastmsgs","onsysmsgunread","onsyncdone","onteammembers","onsyncteammembersdone","onmsg","onsysmsg","oncustomsysmsg","onupdatemyinfo","onupdateuser","onSyncUpdateServerSession","onUpdateSuperTeamMember","onMySuperTeamMembers","onCreateSuperTeam","onUpdateSuperTeam","onAddSuperTeamMembers","onRemoveSuperTeamMembers","onUpdateSuperTeamManagers","onDismissSuperTeam","onTransferSuperTeam","onUpdateSuperTeamMembersMute","onupdateteammember","onMyTeamMembers","onMsgReceipts","onCreateTeam","onUpdateTeam","onAddTeamMembers","onRemoveTeamMembers","onUpdateTeamManagers","onDismissTeam","onTransferTeam","onUpdateTeamMembersMute","onTeamMsgReceipt","onupdatesession","onQuickComment","onDeleteQuickComment","onPinMsgChange","onupdatesysmsgunread","onupdatesysmsg","onsynccreateteam","onsyncsupercreateteam","onsyncmarkinblacklist","onsyncmarkinmutelist","onsyncfriendaction","shouldIgnoreNotification","shouldIgnoreMsg","onDeleteMsgSelf","shouldCountNotifyUnread","onPushNotificationMultiportConfig","onPushNotificationMultiportConfigUpdate","onpushevents"],Dt=a(Ve).call(Ve,function(dr){return i(Ue).call(Ue,dr)}),tr=u(ie).call(ie,"account");k.verifyCallback(de,Dt,"protocol::IMProtocol"),this.logger.info("setOptions::",k.omitAsString(de,["appKey","token","loginExt","customTag"])),tr!==-1&&c(ie).call(ie,tr,1),de=k.filterObj(de,ie),this.options=k.merge(Ie,de),this.reset()},le.sendCmd=function(de){var Ie,ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",Ve=arguments.length>2?arguments[2]:void 0,Ue=this;Ue.heartbeat();var Dt,tr=de,dr=(de=Ue.parser.createCmd(de,ie)).SER;ie=ie||{},Ue.cmdContentMap[dr]=ie,ie.single&&(delete ie.single,(Dt=s(ie)).length===1&&(Ue.cmdContentMap[dr]=ie[Dt[0]])),ie.__exceptionInfo={target:d(Ie="".concat(de.SID,"-")).call(Ie,de.CID),context:dr,startTime:Ue.reporterHook.getSafeClock()},ie.NOTSTORE&&(Dt=ie.NOTSTORE.split(" "),m(Dt).call(Dt,function(fr){delete ie[fr]}),delete ie.NOTSTORE),(Ve=Ve||ie.callback)&&(Ue.cmdCallbackMap[dr]=Ve),Ue.cmdTaskArray.push({cmdName:tr,cmd:v(de)}),Ue.startCmdTaskTimer()},le.startCmdTaskTimer=function(){var de=this;de.cmdTaskTimer||(de.cmdTaskTimer=g(function(){var Ie=de.cmdTaskArray.shift();de.cmdTaskTimer=null,Ie&&de.executeCmdTask(Ie),de.cmdTaskArray.length&&de.startCmdTaskTimer()},0))},le.executeCmdTask=function(de){var Ie=de.cmdName,ie=de.cmd,Ve=(ie=JSON.parse(ie)).SER;this.isFrequencyControlled(Ie)?(this.logger.warn("protocol::executeCmdTask: ".concat(Ie," hit freq control")),this.markCallbackInvalid(Ve,V.newFrequencyControlError({callFunc:"protocol::executeCmdTask",message:"".concat(Ie," hit freq control")}))):this.hasLogin?(Ie!=="heartbeat"&&(this.logger.debugEnable?this.logger.debug("protocol::sendCmd: ".concat(de.cmd)):this.logger.info("protocol::sendCmd: ".concat(Ie))),this.doSendCmd(ie)):Ie==="login"&&this.isConnected()?(this.logger.debugEnable?this.logger.debug("protocol::sendCmd: ".concat(de.cmd)):this.logger.info("protocol::sendCmd: ".concat(Ie)),this.doSendCmd(ie)):(this.logger.warn("protocol::executeCmdTask: ".concat(Ie," not connected or login")),this.markCallbackInvalid(Ve,V.newSocketStateError({callFunc:"protocol::executeCmdTask",message:"".concat(Ie," not connected or not login")})))},le.isFrequencyControlled=function(de){var Ie=this.frequencyControlMap&&this.frequencyControlMap[de];if(Ie){if(b()<Ie.from+Ie.duration)return!0;delete this.frequencyControlMap[de]}},le.doSendCmd=function(de){var Ie=this,ie=de.SER,Ve=ie===0?A.hbCmdTimeout:A.cmdTimeout,Ue=new Date().getTime(),Dt=Ie.cmdContentMap[ie];function tr(){Ie.markCallbackInvalid(ie,V.newSocketStateError({callFunc:"protocol::doSendCmd",message:"ser ".concat(ie," socketSendJson Error")})),Ie.onDisconnect("protocol::doSendCmd:socketSendJson","broken")}Dt&&Dt.__exceptionInfo&&(Dt.__exceptionInfo.startTime=b()),de.isAwaitable&&(Ie.timerMap[ie]=g(function(){var dr;Ie.markCallbackInvalid(ie,V.newTimeoutError({callFunc:"protocol::doSendCmd",message:"ser ".concat(ie," Timeout Error")})),Ie.reporter.reportTraceStart("exceptions",{user_id:k.get(Ie,"options.account")||"",trace_id:k.get(Ie,"socket.socket.sessionid"),start_time:Ue,action:2,exception_service:6}),Ie.reporter.reportTraceUpdateV2("exceptions",{code:408,description:"Packet timeout",operation_type:1,target:d(dr="".concat(de.SID,"-")).call(dr,de.CID),context:"".concat(de.SER),net_connect:Ie.checkNetworkAvailable()}),Ie.reporter.reportTraceEnd("exceptions",1)},Ve));try{Ie.socket&&Ie.socket.send?Ie.socket.send(v(de)):tr()}catch{tr()}},le.getObjWithSer=function(de){var Ie=this.cmdContentMap[de];return Ie&&!Ie.isImSyncDataObj&&delete this.cmdContentMap[de],Ie&&k.copy(Ie)},le.getCallbackWithSer=function(de){var Ie=this.cmdCallbackMap[de];return Ie&&!Ie.isImSyncDataCb&&delete this.cmdCallbackMap[de],Ie},le.getTimerWithSer=function(de){var Ie=this.timerMap[de];return delete this.timerMap[de],Ie},le.clearTimerWithSer=function(de){var Ie=this.getTimerWithSer(de);Ie&&clearTimeout(Ie)},le.markCallbackInvalid=function(de,Ie){this.getObjWithSer(de),this.clearTimerWithSer(de);var ie=this.getCallbackWithSer(de);if(ie){var Ve=ie.options;g(function(){ie(Ie||V.newUnknownError({ser:de}),Ve)},0)}},le.markAllCallbackInvalid=function(de){var Ie,ie,Ve=this;m(Ie=s(this.cmdCallbackMap)).call(Ie,function(Ue){var Dt=Ve.getObjWithSer(Ue);if(Dt.__exceptionInfo){var tr=Dt.__exceptionInfo.target,dr=Dt.__exceptionInfo.context,fr=k.get(de,"event.uploadCode")||de&&de.code;fr=typeof fr!="number"?415:fr;var sr=k.get(de,"event.disconnectReason"),hr=sr?v({disconnect_reason:sr}):de&&de.message||"send cmd failed";Ve.reporter.reportTraceStart("exceptions",{user_id:k.get(Ve,"options.account")||"",trace_id:k.get(Ve,"socket.socket.sessionid"),start_time:Ve.reporterHook.getNTPTime(Dt.__exceptionInfo.startTime),action:2,exception_service:6}),Ve.reporter.reportTraceUpdateV2("exceptions",{code:fr,description:hr,operation_type:1,target:tr,context:dr,net_connect:Ve.checkNetworkAvailable()}),Ve.reporter.reportTraceEnd("exceptions",1),delete Dt.__exceptionInfo}}),m(ie=s(this.cmdCallbackMap)).call(ie,function(Ue){Ve.markCallbackInvalid(Ue,de)}),Ve.cmdTaskArray=[]},le.getPacketObj=function(de){var Ie=null;if(de&&de.raw){var ie=de.raw.ser;k.notundef(ie)&&(Ie=this.getObjWithSer(ie))}return Ie},le.callPacketAckCallback=function(de){var Ie=this;if(de&&de.raw){var ie=de.raw.ser;if(k.notundef(ie)){Ie.clearTimerWithSer(ie);var Ve=Ie.getCallbackWithSer(ie);if(Ve){var Ue;Ve.originUrl&&de.obj&&de.obj.file&&(de.obj.file._url_safe=de.obj.file.url,de.obj.file.url=Ve.originUrl,de.obj.type==="audio"&&(de.obj.file.mp3Url=Ve.originUrl+(~u(Ue=Ve.originUrl).call(Ue,"?")?"&":"?")+"audioTrans&type=mp3")),de.promise?de.promise.then(function(){Ve(de.error,de.obj)},function(Dt){var tr,dr;Dt.callFunc="protocol::callPacketAckCallback",Dt.message=d(tr=d(dr="Resp Promoise Error: cmd: ".concat(de.cmd,", ser: ")).call(dr,ie,", reason: ")).call(tr,Dt.message);var fr=V.customError("CALLBACK_ACK_ERR",Dt);Ie.logger.error(`protocol::callPacketAckCallback error stack: 
`.concat(Dt.stack||Dt.event&&Dt.event.stack)),Ve(fr,de.obj,de.content)}):Ve(de.error,de.obj,de.content)}}}},le.onMessage=function(de){var Ie=this;Ie.heartbeat(),Ie.parser.parseResponse(de).then(function(ie){var Ve;if(ie.notFound&&Ie.logger.warn("protocol::onMessage: packet not found ".concat(v(ie))),ie.error){var Ue,Dt;ie.error.message=d(Ue="".concat(ie.cmd," error: ")).call(Ue,ie.error.message),Ie.logger.error(d(Dt="protocol::onMessage: packet error ".concat(v(ie.error),"，raw cmd ")).call(Dt,ie.rawStr));var tr=ie.raw||{};tr.code!==408&&tr.code!==415&&tr.code!==500||Ie.reporter.report("nimErrEvent",{code:tr.code,module:ie.cmd,accid:Ie.account})}ie.__receiveTime=Ie.reporterHook.getSafeClock();var dr=Ce[d(Ve="kSyncType".concat(ie.raw.sid,"_")).call(Ve,ie.raw.cid)];if(dr){var fr=k.get(ie,"raw.r"),sr=1;if(fr&&fr.length>0){var hr=a(fr).call(fr,function(Pt){return o(Pt)}),Fe=k.get(hr,"0.length");sr=typeof Fe=="number"?Fe:1}Ie.reporterHook.emit("reporter/syncItem",dr,sr)}ie.frequencyControlDuration&&(Ie.logger.error("protocol::onMessage: server freq control ".concat(v(ie.cmd))),Ie.frequencyControlMap=Ie.frequencyControlMap||{},Ie.frequencyControlMap[ie.cmd]={from:+new Date,duration:ie.frequencyControlDuration}),ie.obj=Ie.getPacketObj(ie),ie.obj&&ie.obj.__exceptionInfo&&delete ie.obj.__exceptionInfo,ie.cmd!=="heartbeat"&&(Ie.logger.debugEnable?Ie.logger.debug("protocol::recvCmd: ".concat(ie.rawStr)):Ie.logger.log("protocol::recvCmd: ".concat(ie.cmd)));var or="process"+k.capFirstLetter(ie.service);if(Ie[or])if(ie.cmd==="syncDone"){if(Ie.cmdCallbackMap[ie.raw.ser]&&Ie.cmdCallbackMap[ie.raw.ser].isImSyncDataCb){var ir;Ie.cmdCallbackMap[ie.raw.ser].isImSyncDataCb=!1;var $e=T(ir=function(Pt,rr){this.checkNosReqNum++,this.getNosOriginUrlReqNum<=0||this.checkNosReqNum>=20?this[Pt](rr):g($e,300)}).call(ir,Ie,or,ie);g(function(){$e.call(Ie,or,ie)},10)}}else try{Ie[or](ie)}catch(Pt){var er,nr;Ie.logger.warn(d(er=d(nr="protocol::onMessage: ".concat(or,".")).call(nr,ie.cmd," excute failed ")).call(er,ie.obj?"":", maybe the packet timed out",": "),Pt.message)}else Ie.logger.warn("protocol::onMessage: ".concat(or," not found"));Ie.callPacketAckCallback(ie)})},le.onMiscError=function(de,Ie,ie){Ie&&this.notifyError(de,Ie,ie)},le.onCustomError=function(de,Ie){var ie=V.customError(de,Ie),Ve=Ie.message||"未知错误";this.onMiscError(Ve,ie)},le.notifyError=function(de,Ie,ie){var Ve;this.isConnected()&&(this.logger.error(d(Ve="".concat(de||""," ")).call(Ve,this.name),Ie,ie),this.options.onerror(Ie,ie))},le.emitAPI=function(de){var Ie=de.type,ie=de.obj;this.api.emit(Ie,ie)},t.exports=ze,e(664),e(680),e(681),e(682),e(683),e(684)},function(t,r,e){var n=e(107),o=Function.prototype,s=o.apply,a=o.call;t.exports=typeof Reflect=="object"&&Reflect.apply||(n?a.bind(s):function(){return a.apply(s,arguments)})},function(t,r){t.exports=function(e,n){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:n}}},function(t,r){var e=String;t.exports=function(n){try{return e(n)}catch{return"Object"}}},function(t,r,e){var n=e(63);t.exports=Array.isArray||function(o){return n(o)=="Array"}},function(t,r,e){var n,o=e(36),s=e(162),a=e(163),i=e(112),u=e(216),c=e(158),d=e(130),m=d("IE_PROTO"),v=function(){},g=function(k){return"<script>"+k+"<\/script>"},b=function(k){k.write(g("")),k.close();var y=k.parentWindow.Object;return k=null,y},T=function(){try{n=new ActiveXObject("htmlfile")}catch{}var k,y;T=typeof document<"u"?document.domain&&n?b(n):((y=c("iframe")).style.display="none",u.appendChild(y),y.src="javascript:",(k=y.contentWindow.document).open(),k.write(g("document.F=Object")),k.close(),k.F):b(n);for(var A=a.length;A--;)delete T.prototype[a[A]];return T()};i[m]=!0,t.exports=Object.create||function(k,y){var A;return k!==null?(v.prototype=o(k),A=new v,v.prototype=null,A[m]=k):A=T(),y===void 0?A:s.f(A,y)}},function(t,r,e){var n=e(161),o=e(38).f,s=e(53),a=e(29),i=e(334),u=e(20)("toStringTag");t.exports=function(c,d,m,v){if(c){var g=m?c:c.prototype;a(g,u)||o(g,u,{configurable:!0,value:d}),v&&!n&&s(g,"toString",i)}}},function(t,r,e){var n=e(43),o=e(195),s=e(99),a=e(97),i=e(38).f,u=e(165),c=e(166),d=e(48),m=e(27),v=a.set,g=a.getterFor("Array Iterator");t.exports=u(Array,"Array",function(T,k){v(this,{type:"Array Iterator",target:n(T),index:0,kind:k})},function(){var T=g(this),k=T.target,y=T.kind,A=T.index++;return!k||A>=k.length?(T.target=void 0,c(void 0,!0)):c(y=="keys"?A:y=="values"?k[A]:[A,k[A]],!1)},"values");var b=s.Arguments=s.Array;if(o("keys"),o("values"),o("entries"),!d&&m&&b.name!=="values")try{i(b,"name",{value:"values"})}catch{}},function(t,r,e){var n=e(499),o=e(504);t.exports=function(s,a){var i=o(s,a);return n(i)?i:void 0}},function(t,r,e){var n=e(34),o=e(11),s=e(124),a=e(42),i=e(45),u=e(160),c=o([].push),d=function(m){var v=m==1,g=m==2,b=m==3,T=m==4,k=m==6,y=m==7,A=m==5||k;return function(V,he,ae,Ne){for(var _e,Ce,re=a(V),ue=s(re),ze=n(he,ae),le=i(ue),de=0,Ie=Ne||u,ie=v?Ie(V,le):g||y?Ie(V,0):void 0;le>de;de++)if((A||de in ue)&&(Ce=ze(_e=ue[de],de,re),m))if(v)ie[de]=Ce;else if(Ce)switch(m){case 3:return!0;case 5:return _e;case 6:return de;case 2:c(ie,_e)}else switch(m){case 4:return!1;case 7:c(ie,_e)}return k?-1:b||T?T:ie}};t.exports={forEach:d(0),map:d(1),filter:d(2),some:d(3),every:d(4),find:d(5),findIndex:d(6),filterReject:d(7)}},function(t,r,e){t.exports=e(299)},function(t,r,e){t.exports=e(217)},function(t,r,e){t.exports=e(573)},function(t,r){t.exports=function(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}},function(t,r,e){(function(n){var o;t.exports=(o=o||function(s,a){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&n!==void 0&&n.crypto&&(i=n.crypto),!i)try{i=e(886)}catch{}var u=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},c=Object.create||function(){function he(){}return function(ae){var Ne;return he.prototype=ae,Ne=new he,he.prototype=null,Ne}}(),d={},m=d.lib={},v=m.Base={extend:function(he){var ae=c(this);return he&&ae.mixIn(he),ae.hasOwnProperty("init")&&this.init!==ae.init||(ae.init=function(){ae.$super.init.apply(this,arguments)}),ae.init.prototype=ae,ae.$super=this,ae},create:function(){var he=this.extend();return he.init.apply(he,arguments),he},init:function(){},mixIn:function(he){for(var ae in he)he.hasOwnProperty(ae)&&(this[ae]=he[ae]);he.hasOwnProperty("toString")&&(this.toString=he.toString)},clone:function(){return this.init.prototype.extend(this)}},g=m.WordArray=v.extend({init:function(he,ae){he=this.words=he||[],this.sigBytes=ae??4*he.length},toString:function(he){return(he||T).stringify(this)},concat:function(he){var ae=this.words,Ne=he.words,_e=this.sigBytes,Ce=he.sigBytes;if(this.clamp(),_e%4)for(var re=0;re<Ce;re++){var ue=Ne[re>>>2]>>>24-re%4*8&255;ae[_e+re>>>2]|=ue<<24-(_e+re)%4*8}else for(var ze=0;ze<Ce;ze+=4)ae[_e+ze>>>2]=Ne[ze>>>2];return this.sigBytes+=Ce,this},clamp:function(){var he=this.words,ae=this.sigBytes;he[ae>>>2]&=4294967295<<32-ae%4*8,he.length=s.ceil(ae/4)},clone:function(){var he=v.clone.call(this);return he.words=this.words.slice(0),he},random:function(he){for(var ae=[],Ne=0;Ne<he;Ne+=4)ae.push(u());return new g.init(ae,he)}}),b=d.enc={},T=b.Hex={stringify:function(he){for(var ae=he.words,Ne=he.sigBytes,_e=[],Ce=0;Ce<Ne;Ce++){var re=ae[Ce>>>2]>>>24-Ce%4*8&255;_e.push((re>>>4).toString(16)),_e.push((15&re).toString(16))}return _e.join("")},parse:function(he){for(var ae=he.length,Ne=[],_e=0;_e<ae;_e+=2)Ne[_e>>>3]|=parseInt(he.substr(_e,2),16)<<24-_e%8*4;return new g.init(Ne,ae/2)}},k=b.Latin1={stringify:function(he){for(var ae=he.words,Ne=he.sigBytes,_e=[],Ce=0;Ce<Ne;Ce++){var re=ae[Ce>>>2]>>>24-Ce%4*8&255;_e.push(String.fromCharCode(re))}return _e.join("")},parse:function(he){for(var ae=he.length,Ne=[],_e=0;_e<ae;_e++)Ne[_e>>>2]|=(255&he.charCodeAt(_e))<<24-_e%4*8;return new g.init(Ne,ae)}},y=b.Utf8={stringify:function(he){try{return decodeURIComponent(escape(k.stringify(he)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(he){return k.parse(unescape(encodeURIComponent(he)))}},A=m.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(he){typeof he=="string"&&(he=y.parse(he)),this._data.concat(he),this._nDataBytes+=he.sigBytes},_process:function(he){var ae,Ne=this._data,_e=Ne.words,Ce=Ne.sigBytes,re=this.blockSize,ue=Ce/(4*re),ze=(ue=he?s.ceil(ue):s.max((0|ue)-this._minBufferSize,0))*re,le=s.min(4*ze,Ce);if(ze){for(var de=0;de<ze;de+=re)this._doProcessBlock(_e,de);ae=_e.splice(0,ze),Ne.sigBytes-=le}return new g.init(ae,le)},clone:function(){var he=v.clone.call(this);return he._data=this._data.clone(),he},_minBufferSize:0}),V=(m.Hasher=A.extend({cfg:v.extend(),init:function(he){this.cfg=this.cfg.extend(he),this.reset()},reset:function(){A.reset.call(this),this._doReset()},update:function(he){return this._append(he),this._process(),this},finalize:function(he){return he&&this._append(he),this._doFinalize()},blockSize:16,_createHelper:function(he){return function(ae,Ne){return new he.init(Ne).finalize(ae)}},_createHmacHelper:function(he){return function(ae,Ne){return new V.HMAC.init(he,Ne).finalize(ae)}}}),d.algo={});return d}(Math),o)}).call(this,e(56))},function(t,r,e){var n=e(27),o=e(19),s=e(148),a=e(77),i=e(43),u=e(125),c=e(29),d=e(208),m=Object.getOwnPropertyDescriptor;r.f=n?m:function(v,g){if(v=i(v),g=u(g),d)try{return m(v,g)}catch{}if(c(v,g))return a(!o(s.f,v,g),v[g])}},function(t,r){t.exports=function(e){return e==null}},function(t,r,e){var n=e(93),o=e(4);t.exports=!!Object.getOwnPropertySymbols&&!o(function(){var s=Symbol();return!String(s)||!(Object(s)instanceof Symbol)||!Symbol.sham&&n&&n<41})},function(t,r,e){var n,o,s=e(14),a=e(64),i=s.process,u=s.Deno,c=i&&i.versions||u&&u.version,d=c&&c.v8;d&&(o=(n=d.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!o&&a&&(!(n=a.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=a.match(/Chrome\/(\d+)/))&&(o=+n[1]),t.exports=o},function(t,r,e){var n=e(4);t.exports=function(o,s){var a=[][o];return!!a&&n(function(){a.call(null,s||function(){return 1},1)})}},function(t,r,e){var n=e(125),o=e(38),s=e(77);t.exports=function(a,i,u){var c=n(i);c in a?o.f(a,c,s(0,u)):a[c]=u}},function(t,r){},function(t,r,e){var n,o,s,a=e(335),i=e(14),u=e(28),c=e(53),d=e(29),m=e(157),v=e(130),g=e(112),b=i.TypeError,T=i.WeakMap;if(a||m.state){var k=m.state||(m.state=new T);k.get=k.get,k.has=k.has,k.set=k.set,n=function(A,V){if(k.has(A))throw b("Object already initialized");return V.facade=A,k.set(A,V),V},o=function(A){return k.get(A)||{}},s=function(A){return k.has(A)}}else{var y=v("state");g[y]=!0,n=function(A,V){if(d(A,y))throw b("Object already initialized");return V.facade=A,c(A,y,V),V},o=function(A){return d(A,y)?A[y]:{}},s=function(A){return d(A,y)}}t.exports={set:n,get:o,has:s,enforce:function(A){return s(A)?o(A):n(A,{})},getterFor:function(A){return function(V){var he;if(!u(V)||(he=o(V)).type!==A)throw b("Incompatible receiver, "+A+" required");return he}}}},function(t,r,e){var n=e(11);t.exports=n([].slice)},function(t,r){t.exports={}},function(t,r){t.exports=function(e){try{return{error:!1,value:e()}}catch(n){return{error:!0,value:n}}}},function(t,r,e){var n=e(14);t.exports=n.Promise},function(t,r,e){var n=e(645)();t.exports=n;try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},function(t,r,e){var n=e(286);function o(s,a,i,u,c,d,m){try{var v=s[d](m),g=v.value}catch(b){return void i(b)}v.done?a(g):n.resolve(g).then(u,c)}t.exports=function(s){return function(){var a=this,i=arguments;return new n(function(u,c){var d=s.apply(a,i);function m(g){o(d,u,c,m,v,"next",g)}function v(g){o(d,u,c,m,v,"throw",g)}m(void 0)})}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r){t.exports=function(e){return e!=null&&typeof e=="object"}},function(t,r,e){var n=e(277),o=e(57),s=e(3),a=e(26),i=e(24),u=e(7),c=e(52),d=e(17),m=e(2),v=e(5),g=e(8),b=e(196),T=e(41),k=e(121),y=e(122),A=e(279),V=e(280),he=e(189);function ae(Ie){var ie=function(){if(typeof Reflect>"u"||!n||n.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var Ve,Ue=he(Ie);if(ie){var Dt=he(this).constructor;Ve=n(Ue,arguments,Dt)}else Ve=Ue.apply(this,arguments);return V(this,Ve)}}var Ne=e(169),_e=e(0),Ce=e(13).heartbeatInterval,re=e(154).V2NIMLoginStatus,ue=e(13),ze={kSyncAction5_1:0,kSyncAction5_2:1,kSyncAction5_3:2},le={kKnown:-1,kSucceed:0,kFailed:1,kAborted:2,kCanceled:3},de=function(Ie){A(Ve,Ie);var ie=ae(Ve);function Ve(Ue){var Dt,tr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return k(this,Ve),(Dt=ie.call(this)).clientProto=Ue,Dt.logger=Ue.logger,Dt.reporter=Ue.reporter,Dt.timer=null,Dt.setClientOrigin(),Dt.serverOrigin={timeStamp:null,rtt:null,baseTimeStamp:null},Dt.tolerantRTT=tr.tolerantRTT||3e3,Dt.bestRTT=tr.bestRTT||100,Dt.maxChances=tr.maxChances||10,Dt.isSettingNTP=!1,Dt.currentChance=0,Dt.syncTraceData={},Dt.syncTraceMap={},Dt.syncTraceLastItem={},Dt.uploadTraceData={},Dt.setMonitorForSync(),Dt.setMonitorForResources(),Dt}return y(Ve,[{key:"hasOriginTimetick",value:function(){return!!this.serverOrigin.timeStamp}},{key:"setOriginTimetick",value:function(){var Ue=this,Dt=this.clientProto.options;if((typeof _e.get(Dt,"privateConf.isDataReportEnable")=="boolean"?Dt.privateConf.isDataReportEnable:ue.privateConf.isDataReportEnable)&&ue.isBrowser&&performance&&performance.now&&!(this.isSettingNTP||this.currentChance>=this.maxChances)){this.isSettingNTP=!0,this.currentChance++,clearTimeout(this.timer),this.timer=null;var tr="ReporterHook::setOriginTimetick:",dr=o();return this.logger.info("".concat(tr," getServerTime start, times ").concat(this.currentChance)),new s(function(fr){Ue.clientProto.sendCmd("getServerTime",{},function(sr,hr){if(Ue.isSettingNTP=!1,sr){var Fe;Ue.logger.warn("".concat(tr," Calculate Delay time, getServerTime error"),sr),Ue.clientProto.statusProtector.getLoginStatus()===re.V2NIM_LOGIN_STATUS_LOGINED&&(Ue.timer=a(i(Fe=Ue.setOriginTimetick).call(Fe,Ue),Ce)),fr()}else{if(!hr)return Ue.logger.warn("".concat(tr," Calculate Delay time, getServerTime not correct")),void fr();var or,ir=o()-dr;if(ir>Ue.tolerantRTT)Ue.logger.warn("".concat(tr," Denied, cause of exceeding the maximum tolerance range of RTT: ").concat(ir)),Ue.timer=a(i(or=Ue.setOriginTimetick).call(or,Ue),Ce);else if(ir>Ue.bestRTT){var $e,er,nr;Ue.serverOrigin.rtt&&ir>=Ue.serverOrigin.rtt?Ue.logger.info("".concat(tr," Denied, cause of current.RTT >= serverOrigin.RTT: ").concat(ir)):(Ue.setServerOrigin(ir,hr),Ue.logger.info(u(er=u(nr="".concat(tr," Accept within maximum tolerance range of RTT: ").concat(ir,", ntpTimestamp: ")).call(nr,Ue.serverOrigin.timeStamp,", localClock: ")).call(er,Ue.serverOrigin.baseTimeStamp))),Ue.timer=a(i($e=Ue.setOriginTimetick).call($e,Ue),Ce)}else{var Pt,rr;Ue.setServerOrigin(ir,hr),Ue.logger.info(u(Pt=u(rr="".concat(tr," Accept within best RTT: ").concat(ir,", ntpTimestamp: ")).call(rr,Ue.serverOrigin.timeStamp,", localClock: ")).call(Pt,Ue.serverOrigin.baseTimeStamp))}fr()}})})}}},{key:"getNTPTime",value:function(Ue){if(typeof Ue!="number"&&(Ue=this.getSafeClock()),this.serverOrigin.timeStamp){var Dt=c(Ue-this.serverOrigin.baseTimeStamp);return this.serverOrigin.timeStamp+Dt}var tr=c(Ue-this.clientOrigin.baseTimeStamp);return this.clientOrigin.timeStamp+tr}},{key:"getSafeClock",value:function(){return ue.isBrowser&&performance&&performance.now?performance.now():o()}},{key:"setMonitorForSync",value:function(){var Ue=this,Dt="ReporterHook::setMonitorForSync:";this.on("reporter/syncStart",function(){Ue.logger.info("".concat(Dt," sync start")),Ue.syncTraceData={user_id:Ue.clientProto.account,trace_id:_e.get(Ue.clientProto,"socket.socket.sessionid"),action:ze.kSyncAction5_1,sync_begin_time:Ue.getSafeClock(),sync_end_time:0,sync_duration:0,overall_duration:0,extension:[]}}),this.on("reporter/syncRecv",function(){Ue.syncTraceData.user_id&&(Ue.logger.info("".concat(Dt," sync receive packet")),Ue.syncTraceData.sync_end_time=Ue.getSafeClock(),Ue.syncTraceData.sync_duration=c(Ue.syncTraceData.sync_end_time-Ue.syncTraceData.sync_begin_time))}),this.on("reporter/syncItem",function(tr,dr){var fr;if(typeof tr=="number"&&Ue.syncTraceData.user_id){Ue.logger.info(u(fr="".concat(Dt," receive sync item: ").concat(tr,", total: ")).call(fr,dr));var sr=Ue.getSafeClock();Ue.syncTraceMap[tr]=Ue.syncTraceMap[tr]?Ue.syncTraceMap[tr]:{sync_type:tr,times:0,total:0,sync_duration:0,proc_duration:0,description:"",items:[]};var hr={total:dr,pre_item_recv_time:Ue.syncTraceLastItem.cur_item_recv_time?Ue.syncTraceLastItem.cur_item_recv_time:Ue.syncTraceData.sync_begin_time,cur_item_recv_time:sr};Ue.syncTraceMap[tr].items.push(hr),Ue.syncTraceLastItem=hr}}),this.on("reporter/syncItemComplete",function(tr){var dr;if(typeof tr=="number"&&Ue.syncTraceData.user_id){var fr=Ue.syncTraceMap[tr];if(fr){Ue.logger.info("".concat(Dt," sync item ").concat(tr," callback done"));var sr=d(dr=fr.items).call(dr,function(hr){return!hr.callback_time});sr.length!==0&&(sr[0].callback_time=Ue.getSafeClock())}}}),this.on("reporter/syncComplete",function(){var tr;Ue.syncTraceData.user_id&&(Ue.logger.info("".concat(Dt," sync complete")),m(tr=v(Ue.syncTraceMap)).call(tr,function(dr){var fr,sr=g(fr=Ue.syncTraceMap[dr].items).call(fr,function(Fe){return{total:Fe.total,pre_item_recv_time:Ue.getNTPTime(Fe.pre_item_recv_time),cur_item_recv_time:Ue.getNTPTime(Fe.cur_item_recv_time),callback_time:Ue.getNTPTime(Fe.callback_time)}}),hr=b(sr).call(sr,function(Fe,or){return Fe.times+=1,Fe.total+=or.total,Fe.sync_duration+=or.cur_item_recv_time-or.pre_item_recv_time,Fe.proc_duration+=or.callback_time-or.cur_item_recv_time,Fe},{times:0,total:0,sync_duration:0,proc_duration:0});Ue.syncTraceMap[dr].items=sr,T(Ue.syncTraceMap[dr],hr),Ue.syncTraceData.extension.push(Ue.syncTraceMap[dr])}),Ue.syncTraceData.sync_begin_time=Ue.getNTPTime(Ue.syncTraceData.sync_begin_time),Ue.syncTraceData.sync_end_time=Ue.getNTPTime(Ue.syncTraceData.sync_end_time),Ue.syncTraceData.overall_duration=Ue.getNTPTime()-Ue.syncTraceData.sync_begin_time,Ue.reporter.report("nim_sdk_sync",Ue.syncTraceData),Ue.syncTraceData={},Ue.syncTraceMap={})})}},{key:"setMonitorForResources",value:function(){var Ue=this,Dt="ReporterHook::setMonitorForResources:";this.on("reporter/uploadStart",function(){Ue.logger.info("".concat(Dt," upload start")),Ue.uploadTraceData={user_id:Ue.clientProto.account,trace_id:_e.get(Ue.clientProto,"socket.socket.sessionid"),action:0,duration:0,start_time:Ue.getSafeClock(),offset:0,full_size:0,transferred_size:0}}),this.on("reporter/uploadUpdate",function(){var tr,dr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ue.uploadTraceData.user_id&&(Ue.logger.info("".concat(Dt," upload update"),dr),m(tr=v(dr)).call(tr,function(fr){Ue.uploadTraceData[fr]=dr[fr]}))}),this.on("reporter/uploadEnd",function(){var tr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:le.kKnown;Ue.uploadTraceData.user_id&&(Ue.logger.info("".concat(Dt," upload end cause of ").concat(tr)),Ue.uploadTraceData.state=tr,Ue.uploadTraceData.start_time=Ue.getNTPTime(Ue.uploadTraceData.start_time),Ue.uploadTraceData.duration=Ue.getNTPTime(Ue.getSafeClock())-Ue.uploadTraceData.start_time,Ue.reporter.report("nim_sdk_resources",Ue.uploadTraceData),Ue.uploadTraceData={})})}},{key:"destroy",value:function(){this.reset(),this.removeAllListeners(),this.logger.info("ReporterHook::destroy: complete")}},{key:"reset",value:function(){this.logger.info("ReporterHook::reset"),this.serverOrigin={},this.setClientOrigin(),this.currentChance=0,this.timer&&clearTimeout(this.timer),this.syncTraceData={},this.syncTraceMap={},this.syncTraceLastItem={},this.uploadTraceData={}}},{key:"setClientOrigin",value:function(){this.clientOrigin={timeStamp:o(),baseTimeStamp:this.getSafeClock()}}},{key:"setServerOrigin",value:function(Ue,Dt){this.serverOrigin={timeStamp:Dt+c(Ue/2),rtt:Ue,baseTimeStamp:this.getSafeClock()}}}]),Ve}(Ne);t.exports={EMSyncAction:ze,EMSyncType:{kSyncType3_8:30008,kSyncType3_109:30109,kSyncType4_4:40004,kSyncType4_6:40006,kSyncType4_9:40009,kSyncType4_12:40012,kSyncType4_13:40013,kSyncType4_14:40014,kSyncType4_16:40016,kSyncType4_17:40017,kSyncType4_18:40018,kSyncType4_19:40019,kSyncType4_20:40020,kSyncType4_21:40021,kSyncType4_23:40023,kSyncType4_24:40024,kSyncType4_100:40100,kSyncType4_101:40101,kSyncType7_15:70015,kSyncType8_109:80109,kSyncType8_126:80126,kSyncType12_5:12005,kSyncType12_6:12006,kSyncType15_13:15013,kSyncType21_109:21109,kSyncType21_111:21111},ReporterHook:de,EMExceptionState:le,EMResourceUploadWay:{kResourceUploadWayNOS:0,kResourceUploadWayAWSPlugin:1,kResourceUploadWayNOSPlugin:2}}},function(t,r,e){var n=e(6),o=e(15),s=e(2),a=e(7),i=e(200),u=e(17),c=e(85),d=e(86),m=e(70),v=e(32);function g(y,A){var V=d!==void 0&&m(y)||y["@@iterator"];if(!V){if(v(y)||(V=function(re,ue){var ze;if(re){if(typeof re=="string")return b(re,ue);var le=o(ze=Object.prototype.toString.call(re)).call(ze,8,-1);if(le==="Object"&&re.constructor&&(le=re.constructor.name),le==="Map"||le==="Set")return c(re);if(le==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(le))return b(re,ue)}}(y))||A&&y&&typeof y.length=="number"){V&&(y=V);var he=0,ae=function(){};return{s:ae,n:function(){return he>=y.length?{done:!0}:{done:!1,value:y[he++]}},e:function(re){throw re},f:ae}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ne,_e=!0,Ce=!1;return{s:function(){V=V.call(y)},n:function(){var re=V.next();return _e=re.done,re},e:function(re){Ce=!0,Ne=re},f:function(){try{_e||V.return==null||V.return()}finally{if(Ce)throw Ne}}}}function b(y,A){(A==null||A>y.length)&&(A=y.length);for(var V=0,he=new Array(A);V<A;V++)he[V]=y[V];return he}var T=e(13),k={genUrlSep:function(y){return n(y=""+y).call(y,"?")===-1?"?imageView&":"&"},urlQuery2Object:function(y){if(Object.prototype.toString.call(y)!=="[object String]"||y==="")return{};var A=n(y).call(y,"?");if(A!==-1){var V=o(y).call(y,A+1).split("&"),he={};return s(V).call(V,function(ae){if(~n(ae).call(ae,"=")){var Ne=ae.split("=");he[Ne[0]]=decodeURIComponent(Ne[1])}else he[ae]=""}),he}},url2object:function(y){Object.prototype.toString.call(y)!=="[object String]"&&(y="");var A=n(y=y||"").call(y,"https")>=0?"https://":"http://",V=y.replace(A,"");n(V).call(V,"?")>=0&&(V=V.substring(0,n(V).call(V,"?")));var he=V.split("/");V=he[0];var ae="";if(he.length>0&&(ae=o(he).call(he,1).join("/")),n(y).call(y,"?")===-1)return{protocol:A,hostname:V,path:ae,query:{}};var Ne=y.substr(n(y).call(y,"?")+1).split("&"),_e={};return s(Ne).call(Ne,function(Ce){if(n(Ce).call(Ce,"=")>0){var re=Ce.split("=");_e[re[0]]=decodeURIComponent(re[1])}else _e[Ce]=""}),{protocol:A,hostname:V,path:ae,query:_e}},object2url:function(y){var A,V=y.protocol,he=y.hostname,ae=y.path,Ne=y.query;V=V||"http://",he=he||"",ae&&(he=a(A="".concat(he,"/")).call(A,ae)),Ne=Ne||{};var _e,Ce,re,ue=[];for(var ze in Ne){var le;ze!=="imageView"&&ue.push(a(le="".concat(ze,"=")).call(le,encodeURIComponent(Ne[ze])))}return ue.length>0?a(_e=a(Ce="".concat(V)).call(Ce,he,"?imageView&")).call(_e,ue.join("&")):a(re="".concat(V)).call(re,he)},genPrivateUrl:function(y,A,V){if(A&&A.length){var he,ae=g(A);try{for(ae.s();!(he=ae.n()).done;){var Ne=he.value;if(n(y).call(y,Ne)>=0)return Ne!==V&&(y=y.replace(Ne,V)),y;if(n(y).call(y,Ne)>=0&&Ne===V)return y}}catch(Fe){ae.e(Fe)}finally{ae.f()}}var _e,Ce,re=k.url2object(y),ue=re.hostname,ze=re.path,le=T.downloadUrl,de=T.downloadHostList,Ie=T.nosCdnEnable,ie=T.serverNosConfig.cdnDomain,Ve=decodeURIComponent(T.serverNosConfig.objectPrefix),Ue=decodeURIComponent(ze),Dt=n(Ue).call(Ue,Ve);if(ie&&Dt>-1&&Ie)return a(_e=a(Ce="".concat(re.protocol)).call(Ce,ie,"/")).call(_e,o(Ue).call(Ue,Dt));if(i(de).call(de,ue)&&i(ze).call(ze,"/")){var tr=n(ze).call(ze,"/"),dr=ze.substring(0,tr),fr=ze.substring(tr+1);return le.replace("{bucket}",dr).replace("{object}",fr)}var sr=u(de).call(de,function(Fe){return typeof ue=="string"&&i(ue).call(ue,Fe)})[0],hr=sr?ue.replace(sr,"").replace(/\W/g,""):null;return hr?le.replace("{bucket}",hr).replace("{object}",ze):y}};t.exports=k},function(t,r,e){var n=e(4);t.exports=!n(function(){var o=(function(){}).bind();return typeof o!="function"||o.hasOwnProperty("prototype")})},function(t,r,e){var n=e(91),o=TypeError;t.exports=function(s){if(n(s))throw o("Can't call method on "+s);return s}},function(t,r,e){var n=e(48),o=e(157);(t.exports=function(s,a){return o[s]||(o[s]=a!==void 0?a:{})})("versions",[]).push({version:"3.27.1",mode:n?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.27.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(t,r,e){var n=e(321);t.exports=function(o){var s=+o;return s!=s||s===0?0:n(s)}},function(t,r,e){var n=e(4),o=e(20),s=e(93),a=o("species");t.exports=function(i){return s>=51||!n(function(){var u=[];return(u.constructor={})[a]=function(){return{foo:1}},u[i](Boolean).foo!==1})}},function(t,r){t.exports={}},function(t,r,e){var n=e(371).charAt,o=e(49),s=e(97),a=e(165),i=e(166),u=s.set,c=s.getterFor("String Iterator");a(String,"String",function(d){u(this,{type:"String Iterator",string:o(d),index:0})},function(){var d,m=c(this),v=m.string,g=m.index;return g>=v.length?i(void 0,!0):(d=n(v,g),m.index+=d.length,i(d,!1))})},function(t,r,e){var n=e(63),o=e(14);t.exports=n(o.process)=="process"},function(t,r,e){var n=e(14),o=e(101),s=e(16),a=e(209),i=e(213),u=e(20),c=e(400),d=e(241),m=e(48),v=e(93),g=o&&o.prototype,b=u("species"),T=!1,k=s(n.PromiseRejectionEvent),y=a("Promise",function(){var A=i(o),V=A!==String(o);if(!V&&v===66||m&&(!g.catch||!g.finally))return!0;if(!v||v<51||!/native code/.test(A)){var he=new o(function(Ne){Ne(1)}),ae=function(Ne){Ne(function(){},function(){})};if((he.constructor={})[b]=ae,!(T=he.then(function(){})instanceof ae))return!0}return!V&&(c||d)&&!k});t.exports={CONSTRUCTOR:y,REJECTION_EVENT:k,SUBCLASSING:T}},function(t,r,e){var n=e(24),o=e(54),s=e(570),a=e(572),i=e(578),u={},c=o.f;function d(k){var y=k.upload=(k.headers||o.o)["Content-Type"]==="multipart/form-data",A=!1;try{A=(location.protocol+"//"+location.host).toLowerCase()!==o.url2origin(k.url)}catch{}return k.cors=A,y||A||k.mode?function(V){var he=V.mode,ae=s,Ne=o.getGlobal();return!Ne.FormData&&Ne.document&&(he="iframe"),he==="iframe"&&(ae=V.upload?a:i),new ae(V)}(k):new s(k)}function m(k,y,A){var V=u[k];if(V){y==="onload"&&V.result&&(A=function(ae,Ne){Ne={data:Ne};var _e=ae.result.headers;return _e&&(Ne.headers=ae.req.header(_e)),Ne}(V,A)),function(ae){var Ne=u[ae];Ne&&(Ne.req.destroy(),delete u[ae])}(k);var he={type:y,result:A};c(he),he.stopped||V[y](he.result)}}function v(k,y){m(k,"onload",y)}function g(k,y){m(k,"onerror",y)}function b(k,y){var A=o.genUrlSep(k);return y=y||"",o.isObject(y)&&(y=o.object2query(y)),y&&(k+=A+y),k}function T(k,y){y=y||{};var A=o.uniqueID(),V={result:y.result,onload:y.onload||o.f,onerror:y.onerror||o.f};u[A]=V,y.onload=n(v).call(v,null,A),y.onerror=n(g).call(g,null,A),y.query&&(k=b(k,y.query));var he=y.method||"";return he&&!/get/i.test(he)||!y.data||(k=b(k,y.data),y.data=null),y.url=k,V.req=d(y),A}T.filter=function(k){o.isFunction(k)&&(c=k)},T.abort=function(k){var y=u[k];y&&y.req&&y.req.abort()},t.exports=T},function(t,r,e){var n=e(10),o=e(301),s=e(25),a=e(106).genPrivateUrl,i=e(0),u=i.notundef,c=i.exist,d=e(192),m=e(295),v=m.typeMap;function g(b){b.resend?(i.verifyOptions(b,"idClient","msg::Message"),this.idClient=b.idClient):this.idClient=i.guid(),this.type=v[b.type],this.resend=b.resend?1:0,u(b.subType)&&(i.isInt(+b.subType)&&+b.subType>0?this.subType=+b.subType:i.onParamError("subType只能是大于0的整数","msg::Message")),u(b.custom)&&(s(b.custom)==="object"?this.custom=n(b.custom):this.custom=""+b.custom),u(b.text)&&(this.body=""+b.text),u(b.body)&&(this.body=""+b.body),u(b.yidunEnable)&&(this.yidunEnable=b.yidunEnable?1:0),u(b.antiSpamUsingYidun)&&(this.antiSpamUsingYidun=b.antiSpamUsingYidun?1:0),u(b.antiSpamContent)&&(s(b.antiSpamContent)==="object"?this.antiSpamContent=n(b.antiSpamContent):this.antiSpamContent=""+b.antiSpamContent),u(b.antiSpamBusinessId)&&(s(b.antiSpamBusinessId)==="object"?this.antiSpamBusinessId=n(b.antiSpamBusinessId):this.antiSpamBusinessId=""+b.antiSpamBusinessId),u(b.yidunAntiCheating)&&(this.yidunAntiCheating=b.yidunAntiCheating+""),u(b.skipHistory)&&(this.skipHistory=b.skipHistory?1:0),u(b.highPriority)&&(this.highPriority=b.highPriority?1:0),u(b.clientAntiSpam)&&(this.clientAntiSpam=b.clientAntiSpam?1:0),u(b.env)&&(this.env=b.env),u(b.notifyTargetTags)&&(this.notifyTargetTags=b.notifyTargetTags),u(b.yidunAntiSpamExt)&&(this.yidunAntiSpamExt=b.yidunAntiSpamExt),(u(b.loc_x)||u(b.loc_y)||u(b.loc_z))&&(this.loc_x=b.loc_x,this.loc_y=b.loc_y,this.loc_z=b.loc_z)}g.validTypes=m.validTypes,i.merge(g.prototype,m.prototype),g.getType=m.getType,g.setFlow=m.setFlow,g.reverse=function(b){var T=i.filterObj(b,"chatroomId idClient from fromNick fromAvatar _fromAvatar_safe fromCustom userUpdateTime custom status notifyTargetTags");return u(T.fromAvatar)&&(T.fromAvatar=a(T.fromAvatar)),T=i.merge(T,{fromClientType:d.reverseType(b.fromClientType),time:+b.time,type:g.getType(b),text:c(b.body)?b.body:b.text||"",resend:+b.resend==1}),u(T.userUpdateTime)&&(T.userUpdateTime=+T.userUpdateTime),u(b.callbackExt)&&(T.callbackExt=b.callbackExt),u(b.subType)&&(T.subType=+b.subType),u(b.yidunAntiSpamRes)&&(T.yidunAntiSpamRes=b.yidunAntiSpamRes),u(b.loc_x)&&(T.x=o(b.loc_x),T.y=o(b.loc_y),T.z=o(b.loc_z)),u(b.toAccids)&&(T.toAccids=b.toAccids),T.status=T.status||"success",T},g.setExtra=function(b,T){m.setFlow(b,T)},t.exports=g},function(t,r,e){var n=e(215),o=e(163);t.exports=Object.keys||function(s){return n(s,o)}},function(t,r,e){var n=e(172),o=e(500),s=e(501),a=n?n.toStringTag:void 0;t.exports=function(i){return i==null?i===void 0?"[object Undefined]":"[object Null]":a&&a in Object(i)?o(i):s(i)}},function(t,r,e){var n=e(592),o=e(185),s=e(599);t.exports=function(a,i){if(a==null)return{};var u,c,d=s(a,i);if(n){var m=n(a);for(c=0;c<m.length;c++)u=m[c],o(i).call(i,u)>=0||Object.prototype.propertyIsEnumerable.call(a,u)&&(d[u]=a[u])}return d},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r){t.exports=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(137),o=e(248);function s(a,i){for(var u=0;u<i.length;u++){var c=i[u];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),n(a,o(c.key),c)}}t.exports=function(a,i,u){return i&&s(a.prototype,i),u&&s(a,u),n(a,"prototype",{writable:!1}),a},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(566)},function(t,r,e){var n=e(11),o=e(4),s=e(63),a=Object,i=n("".split);t.exports=o(function(){return!a("z").propertyIsEnumerable(0)})?function(u){return s(u)=="String"?i(u,""):a(u)}:a},function(t,r,e){var n=e(318),o=e(126);t.exports=function(s){var a=n(s,"string");return o(a)?a:a+""}},function(t,r,e){var n=e(33),o=e(16),s=e(21),a=e(207),i=Object;t.exports=a?function(u){return typeof u=="symbol"}:function(u){var c=n("Symbol");return o(c)&&s(c.prototype,i(u))}},function(t,r,e){var n=e(11),o=0,s=Math.random(),a=n(1 .toString);t.exports=function(i){return"Symbol("+(i===void 0?"":i)+")_"+a(++o+s,36)}},function(t,r,e){var n=e(110),o=Math.max,s=Math.min;t.exports=function(a,i){var u=n(a);return u<0?o(u+i,0):s(u,i)}},function(t,r,e){var n=e(11),o=e(4),s=e(16),a=e(65),i=e(33),u=e(213),c=function(){},d=[],m=i("Reflect","construct"),v=/^\s*(?:class|function)\b/,g=n(v.exec),b=!v.exec(c),T=function(y){if(!s(y))return!1;try{return m(c,d,y),!0}catch{return!1}},k=function(y){if(!s(y))return!1;switch(a(y)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return b||!!g(v,u(y))}catch{return!0}};k.sham=!0,t.exports=!m||o(function(){var y;return T(T.call)||!T(Object)||!T(function(){y=!0})||y})?k:T},function(t,r,e){var n=e(109),o=e(127),s=n("keys");t.exports=function(a){return s[a]||(s[a]=o(a))}},function(t,r,e){var n=e(215),o=e(163).concat("length","prototype");r.f=Object.getOwnPropertyNames||function(s){return n(s,o)}},function(t,r){r.f=Object.getOwnPropertySymbols},function(t,r,e){var n=e(20);r.f=n},function(t,r,e){var n=e(29),o=e(16),s=e(42),a=e(130),i=e(227),u=a("IE_PROTO"),c=Object,d=c.prototype;t.exports=i?c.getPrototypeOf:function(m){var v=s(m);if(n(v,u))return v[u];var g=v.constructor;return o(g)&&v instanceof g?g.prototype:v instanceof c?d:null}},function(t,r,e){var n=e(11),o=e(36),s=e(355);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var a,i=!1,u={};try{(a=n(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(u,[]),i=u instanceof Array}catch{}return function(c,d){return o(c),s(d),i?a(c,d):c.__proto__=d,c}}():void 0)},function(t,r,e){var n=e(65),o=e(156),s=e(91),a=e(99),i=e(20)("iterator");t.exports=function(u){if(!s(u))return o(u,i)||o(u,"@@iterator")||a[n(u)]}},function(t,r,e){t.exports=e(407)},function(t,r,e){t.exports=e(432)},function(t,r,e){t.exports=e(449)},function(t,r,e){var n=e(489),o=e(490),s=e(491),a=e(492),i=e(493);function u(c){var d=-1,m=c==null?0:c.length;for(this.clear();++d<m;){var v=c[d];this.set(v[0],v[1])}}u.prototype.clear=n,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=a,u.prototype.set=i,t.exports=u},function(t,r,e){var n=e(198);t.exports=function(o,s){for(var a=o.length;a--;)if(n(o[a][0],s))return a;return-1}},function(t,r,e){var n=e(83)(Object,"create");t.exports=n},function(t,r,e){var n=e(513);t.exports=function(o,s){var a=o.__data__;return n(s)?a[typeof s=="string"?"string":"hash"]:a.map}},function(t,r,e){var n=e(259),o=e(260);t.exports=function(s,a,i,u){var c=!i;i||(i={});for(var d=-1,m=a.length;++d<m;){var v=a[d],g=u?u(i[v],s[v],v,i,s):void 0;g===void 0&&(g=s[v]),c?o(i,v,g):n(i,v,g)}return i}},function(t,r){t.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(t,r){t.exports=`	
\v\f\r                　\u2028\u2029\uFEFF`},function(t,r,e){var n,o=e(18),s=e(2),a=e(8),i=e(3),u=e(7),c=e(6),d=e(24),m=e(10),v=e(106).urlQuery2Object,g=e(0),b=e(40),T=e(739),k=e(740),y=e(741),A=e(742),V=e(743),he=e(744);function ae(re){this.mixin(re)}ae.prototype=o((function(){}).prototype,{protocol:{value:null,writable:!0,enumerable:!0,configurable:!0}}),ae.prototype.setProtocol=function(re){this.protocol=re},ae.prototype.mixin=function(re){var ue,ze,le=this;this.configMap=this.configMap||{},s(ue=["idMap","cmdConfig","packetConfig"]).call(ue,function(de){le.configMap[de]=g.merge({},le.configMap[de],re.configMap&&re.configMap[de])}),s(ze=["serializeMap","unserializeMap"]).call(ze,function(de){le[de]=g.merge({},le[de],re[de])})},ae.prototype.createCmd=(n=1,function(re,ue){var ze,le=this,de=this.configMap.cmdConfig[re],Ie=this.configMap.packetConfig[de.sid+"_"+de.cid],ie=re==="heartbeat"?0:n++;return ie>32767&&(ie=1,n=2),re={SID:de.sid,CID:de.cid,SER:ie,isAwaitable:typeof de.isAwaitable=="boolean"?de.isAwaitable:!(!Ie||!Ie.response)},de.params&&(re.Q=[],s(ze=de.params).call(ze,function(Ve){var Ue=Ve.type,Dt=Ve.name,tr=Ve.entity,dr=ue[Dt];if(!g.undef(dr)){switch(Ue){case"PropertyArray":Ue="ArrayMable",dr=a(dr).call(dr,function(fr){return{t:"Property",v:le.serialize(fr,tr)}});break;case"Property":dr=le.serialize(dr,Dt);break;case"bool":dr=dr?"true":"false"}re.Q.push({t:Ue,v:dr})}})),re}),ae.prototype.parseResponse=function(re){var ue=this;return new i(function(ze){var le=JSON.parse(re),de={raw:le,rawStr:re,error:b.genError(le.code)},Ie=ue.configMap.packetConfig[le.sid+"_"+le.cid];if(!Ie)return de.notFound={sid:le.sid,cid:le.cid},void ze(de);var ie=le.r,Ve=Ie.service==="notify"&&!Ie.cmd;if(de.isNotify=Ve,Ve){var Ue=le.r[1].headerPacket;if(Ie=ue.configMap.packetConfig[Ue.sid+"_"+Ue.cid],ie=le.r[1].body,!Ie)return de.notFound={sid:Ue.sid,cid:Ue.cid},void ze(de)}if(de.service=Ie.service,de.cmd=Ie.cmd,de.error){var Dt,tr,dr=u(Dt="".concat(le.sid,"_")).call(Dt,le.cid);if(Ve&&(dr=u(tr="".concat(Ue.sid,"_")).call(tr,Ue.cid)),de.error.cmd=de.cmd,de.error.callFunc="protocol::parseResponse: ".concat(dr),de.error.code===416){var fr=ie[0];fr&&(de.frequencyControlDuration=1e3*fr)}}var sr,hr=!1;de.error&&Ie.trivialErrorCodes&&(hr=c(sr=Ie.trivialErrorCodes).call(sr,de.error.code)!==-1);var Fe=[];if((!de.error||hr)&&Ie.response){var or;de.content={};var ir=function($e,er,nr,Pt){if($e&&Pt==="msg"||Pt==="sysMsg"){var rr=nr.content[Pt];g.isObject(rr)&&!rr.idServer&&(rr.idServer=""+er.r[0])}};s(or=Ie.response).call(or,function($e,er){var nr,Pt=ie[er];if(!g.undef(Pt)){var rr=$e.type,kt=$e.name,Et=$e.entity||kt;switch(rr){case"Property":Fe.push(ue.unserialize(Pt,Et).then(d(nr=function(cr,mr,yr,Tr,Ir){yr.content[Tr]=Ir,ir(cr,mr,yr,Tr)}).call(nr,this,Ve,le,de,kt)));break;case"PropertyArray":de.content[kt]=[],s(Pt).call(Pt,function(cr,mr){var yr;Fe.push(ue.unserialize(cr,Et).then(d(yr=function(Tr,Ir,kr){Tr.content[Ir][mr]=kr}).call(yr,this,de,kt)))});break;case"KVArray":de.content[kt]=Pt,ir(Ve,le,de,kt);break;case"long":case"Long":case"byte":case"Byte":case"Number":de.content[kt]=+Pt;break;default:de.content[kt]=Pt,ir(Ve,le,de,kt)}}})}i.all(Fe).then(function(){ze(de)})})},ae.prototype.serialize=function(re,ue){var ze=this.serializeMap[ue],le={};for(var de in ze)re.hasOwnProperty(de)&&(le[ze[de]]=re[de]);return le},ae.prototype.matchNosSafeUrl=function(re){if(!g.isString(re)||!~c(re).call(re,"_im_url=1"))return!1;var ue=v(re);return!(!ue||!ue._im_url||ue._im_url!=1)},ae.prototype.getOneNosOriginUrl=function(re,ue,ze){var le=this;return new i(function(de){le.protocol.getNosOriginUrlReqNum++,le.protocol.sendCmd("getNosOriginUrl",{nosFileUrlTag:{safeUrl:re}},function(Ie,ie,Ve){le.protocol.getNosOriginUrlReqNum--,Ie?le.protocol.logger.warn("error: get nos originUrl failed",Ie):(ue["_"+ze+"_safe"]=ue[ze],ue[ze]=Ve.nosFileUrlTag&&Ve.nosFileUrlTag.originUrl),de()})})},ae.prototype.checkObjSafeUrl=function(re,ue,ze){var le=this;for(var de in re)if(re.hasOwnProperty(de)){var Ie=re[de];if(g.isString(Ie)){if(this.matchNosSafeUrl(Ie)){var ie=this.getOneNosOriginUrl(Ie,re,de);ue.push(ie),ze.push(ie)}}else g.isObject(Ie)?this.checkObjSafeUrl(Ie,ue,ze):g.isArray(Ie)&&s(Ie).call(Ie,function(Ve){g.isObject(Ve)&&le.checkObjSafeUrl(Ve,ue,ze)})}};var Ne=["url","avatar","fromAvatar","chatroomAvatar"];ae.prototype.unserialize=function(re,ue){var ze=this;return new i(function(le){var de=ze.unserializeMap[ue],Ie={},ie=[];if(re)for(var Ve in de){var Ue,Dt=[];if(re.hasOwnProperty(Ve)&&(Ie[de[Ve]]=re[Ve],ze.protocol.hasLogin&&!ze.protocol.keepNosSafeUrl))if(de[Ve]==="attach"&&re[Ve]&&c(re[Ve])&&~c(Ue=re[Ve]).call(Ue,"_im_url=1"))try{var tr,dr=JSON.parse(re[Ve]);dr.isS3||ze.checkObjSafeUrl(dr,Dt,ie),i.all(Dt).then(d(tr=function(fr,sr){fr.attach=m(sr)}).call(tr,ze,Ie,dr))}catch(fr){ze.logger.warn("unserialize",fr&&fr.message)}else~c(Ne).call(Ne,de[Ve])&&re[Ve]&&ze.matchNosSafeUrl(re[Ve])&&ie.push(ze.getOneNosOriginUrl(re[Ve],Ie,de[Ve]))}i.all(ie).then(function(){le(Ie)})})},ae.prototype.syncUnserialize=function(re,ue){var ze=this.unserializeMap[ue],le={};if(re)for(var de in ze)re.hasOwnProperty(de)&&(le[ze[de]]=re[de]);return le};var _e=new ae({configMap:T,serializeMap:k,unserializeMap:y}),Ce=new ae({configMap:A,serializeMap:V,unserializeMap:he});t.exports={IM:_e,Chatroom:Ce}},function(t,r,e){var n={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,s=o&&!n.call({1:2},1);r.f=s?function(a){var i=o(this,a);return!!i&&i.enumerable}:n},function(t,r,e){t.exports=e(618)},function(t,r,e){var n=e(8),o=e(9),s=e(0),a=s.notundef,i=s.fillPropertyWithDefault,u={0:"normal",1:"owner",2:"manager"};function c(d){s.verifyOptions(d,"teamId","team::TeamMember"),s.verifyParamAtLeastPresentOne(d,"nickInTeam muteTeam muteNotiType custom","team::TeamMember"),this.teamId=d.teamId,a(d.account)&&(this.account=d.account),a(d.nickInTeam)&&(this.nickInTeam=d.nickInTeam),a(d.muteNotiType)?this.bits=d.muteNotiType:a(d.muteTeam)&&(this.bits=0,d.muteTeam&&(this.bits+=1)),a(d.mute)&&(this.mute=d.mute?1:0),a(d.custom)&&(this.custom=""+d.custom)}c.reverse=function(d){var m=s.copy(d);if(a(m.teamId)&&(m.teamId=""+m.teamId),a(m.type)&&(m.type=u[m.type]),a(m.active)&&(m.active=+m.active==1),a(m.valid)&&(m.valid=+m.valid==1),a(m.mute)&&(m.mute=+m.mute==1),a(m.joinTime)&&(m.joinTime=+m.joinTime),a(m.updateTime)&&(m.updateTime=+m.updateTime),a(m.bits)){var v=m.bits;delete m.bits,m.muteTeam=!!(1&v),m.muteNotiType=v}return a(m.teamId)&&a(m.account)&&(m.id=c.genId(m.teamId,m.account)),m},c.reverseMembers=function(d){return n(d).call(d,function(m){return o(c).call(c,m)})},c.fillProperties=function(d){var m=i(d,"mute",!1),v=i(d,"custom","");return m||v},c.genId=function(d,m){return d+"-"+m},c.accounts2ids=function(d,m){return n(m).call(m,function(v){return c.genId(d,v)})},c.assembleMembers=function(d,m){return s.isArray(m)||(m=[m]),n(m).call(m,function(v){return c.assembleMember(d,v)})},c.assembleMember=function(d,m){return{id:c.genId(d.teamId,m),account:m,teamId:d.teamId,type:"normal",nickInTeam:"",muteTeam:!1,mute:!1,joinTime:d.memberUpdateTime,updateTime:d.memberUpdateTime,active:!0,valid:!0,invitorAccid:""}},c.assembleOwner=function(d){var m=c.assembleMember(d,d.owner);return m.type="owner",m},t.exports=c},function(t,r,e){var n,o=e(25),s=e(6),a=e(10),i=e(7),u=e(5),c=e(15),d=e(9),m=e(17),v=e(8),g=e(2),b=e(0),T=b.undef,k=b.notundef,y=e(147).IM,A=e(191),V=e(150),he={customP2p:100,customTeam:101,customSuperTeam:103,deleteMsgP2p:7,deleteMsgTeam:8,deleteMsgSuperTeam:12,deleteOnewayMsgP2p:13,deleteOnewayMsgTeam:14},ae={0:"applyTeam",1:"rejectTeamApply",2:"teamInvite",3:"rejectTeamInvite",5:"friendRequest",6:"deleteFriend",7:"deleteMsgP2p",8:"deleteMsgTeam",12:"deleteMsgSuperTeam",13:"deleteMsgP2pOneWay",14:"deleteMsgTeamOneWay",15:"applySuperTeam",16:"rejectSuperTeamApply",17:"superTeamInvite",18:"rejectSuperTeamInvite",100:"customP2p",101:"customTeam",103:"customSuperTeam",102:"customP2p"},Ne={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"},_e=["team","superTeam","friend","msg"],Ce={applyTeam:"team",rejectTeamApply:"team",teamInvite:"team",rejectTeamInvite:"team",applySuperTeam:"superTeam",rejectSuperTeamApply:"superTeam",superTeamInvite:"superTeam",rejectSuperTeamInvite:"superTeam",addFriend:"friend",applyFriend:"friend",passFriendApply:"friend",rejectFriendApply:"friend",deleteFriend:"friend",deleteMsg:"msg"};function re(ue){var ze,le;b.verifyOptions(ue,"type to","sysmsg::SystemMessage"),b.verifyParamValid("type",ue.type,re.validTypes,"sysmsg::SystemMessage"),s(ze=ue.type).call(ze,"custom")!==-1&&(b.verifyOptions(ue,"content","sysmsg::SystemMessage"),this.attach=ue.content,k(ue.apnsText)&&(this.apnsText=""+ue.apnsText),k(ue.pushPayload)&&(o(ue.pushPayload)==="object"?this.pushPayload=a(ue.pushPayload):this.pushPayload=""+ue.pushPayload),k(ue.sendToOnlineUsersOnly)&&(this.sendToOnlineUsersOnly=ue.sendToOnlineUsersOnly?0:1),k(ue.cc)&&(this.cc=ue.cc?1:0),k(ue.isPushable)&&(this.isPushable=ue.isPushable?1:0),k(ue.isUnreadable)&&(this.isUnreadable=ue.isUnreadable?1:0),k(ue.needPushNick)&&(this.needPushNick=ue.needPushNick?1:0)),s(le=ue.type).call(le,"deleteMsg")===0&&(ue.apnsText&&(this.apnsText=ue.apnsText),ue.pushPayload&&(this.pushPayload=ue.pushPayload),ue.attach&&(this.attach=ue.attach)),this.time=ue.time||+new Date,this.type=he[ue.type],this.to=ue.to,k(ue.from)&&(this.from=ue.from),k(ue.ps)&&(this.ps=ue.ps),k(ue.deletedIdClient)&&(this.deletedIdClient=ue.deletedIdClient),k(ue.deletedIdServer)&&(this.deletedIdServer=ue.deletedIdServer),k(ue.opeAccount)&&(this.opeAccount=ue.opeAccount),k(ue.yidunEnable)&&(this.yidunEnable=ue.yidunEnable?1:0),k(ue.antiSpamContent)&&(o(ue.antiSpamContent)==="object"?this.antiSpamContent=a(ue.antiSpamContent):this.antiSpamContent=""+ue.antiSpamContent),k(ue.antiSpamBusinessId)&&(o(ue.antiSpamBusinessId)==="object"?this.antiSpamBusinessId=a(ue.antiSpamBusinessId):this.antiSpamBusinessId=""+ue.antiSpamBusinessId),k(ue.env)&&(this.env=ue.env),this.idClient=ue.idClient||b.guid()}re.validTypes=i(n=u(he)).call(n,u(Ce)),re.validCategories=["team","friend"],re.isCustom=function(ue){return ue.type==="custom"},re.reverse=function(ue){var ze,le,de={time:+ue.time,to:ue.to,type:ae[ue.type]};if(k(ue.from)&&(de.from=ue.from),k(ue.idClient)&&(de.idClient=ue.idClient),k(ue.idServer)&&(de.idServer=""+ue.idServer),k(ue.deletedIdClient)&&(de.deletedIdClient=ue.deletedIdClient),k(ue.deletedIdServer)&&(de.deletedIdServer=""+ue.deletedIdServer),k(ue.deletedMsgTime)&&(de.deletedMsgTime=+ue.deletedMsgTime),k(ue.deletedMsgFromNick)&&(de.deletedMsgFromNick=""+ue.deletedMsgFromNick),k(ue.opeAccount)&&(de.opeAccount=ue.opeAccount),k(ue.ps)&&(de.ps=ue.ps),k(ue.callbackExt)&&(de.callbackExt=ue.callbackExt),ue.attach=ue.attach?""+ue.attach:"",de.type==="customP2p"||de.type==="customTeam"||de.type==="customSuperTeam")de.content=ue.attach,k(ue.apnsText)&&(de.apnsText=ue.apnsText),k(ue.pushPayload)&&(de.pushPayload=ue.pushPayload),b.merge(de,{sendToOnlineUsersOnly:T(ue.sendToOnlineUsersOnly)||+ue.sendToOnlineUsersOnly==0,cc:T(ue.cc)||+ue.cc==1,isPushable:T(ue.isPushable)||+ue.isPushable==1,isUnreadable:T(ue.isUnreadable)||+ue.isUnreadable==1,needPushNick:k(ue.needPushNick)&&+ue.needPushNick==1}),de.scene=c(le=de.type).call(le,6).toLowerCase(),de.type="custom";else if(s(ze=de.type).call(ze,"deleteMsg")===0){ue.apnsText&&(de.apnsText=ue.apnsText),ue.pushPayload&&(de.pushPayload=ue.pushPayload),ue.attach&&(de.attach=ue.attach);var Ie=de.type.toLowerCase();s(Ie).call(Ie,"p2p")>-1?de.scene="p2p":s(Ie).call(Ie,"superteam")>-1?de.scene="superTeam":s(Ie).call(Ie,"team")>-1&&(de.scene="team"),de.type="deleteMsg"}else{if(ue.attach){de.attach={};var ie=JSON.parse(ue.attach);k(ie.vt)?(de.type=Ne[ie.vt],ie.serverex&&ie.serverex[0]===1&&(de.serverex=ie.serverex[1]),delete de.attach):(k(ie.tinfo)&&(de.attach.team=d(A).call(A,y.syncUnserialize(ie.tinfo,"team"))),k(ie.tlist)&&(de.attach.member=d(V).call(V,y.syncUnserialize(ie.tlist,"teamMember"))),k(ie.attach)&&(de.attach.custom=ie.attach))}de.category=Ce[de.type],de.read=!1,de.state="init"}return k(ue.cc)&&(de.cc=+ue.cc==1),de.status=ue.status||"success",k(m(ue))&&(de.filter=m(ue)),de},re.reverseSysMsgs=function(ue,ze){var le=(ze=ze||{}).mapper,de=b.isFunction(le);return v(ue).call(ue,function(Ie){return Ie=d(re).call(re,Ie),de&&(Ie=le(Ie)),Ie})},re.completeUnread=function(ue){var ze,le;return ue=ue||{},g(_e).call(_e,function(de){delete ue[de]}),g(ze=u(Ce)).call(ze,function(de){ue[de]=ue[de]||0,ue[de]<0&&(ue[de]=0),ue[le=Ce[de]]=ue[le]||0,ue[le]=ue[le]+ue[de]}),ue.total=0,g(_e).call(_e,function(de){ue.total+=ue[de]}),ue},t.exports=re},function(t,r,e){var n=e(120),o=["unreadMsgs"],s=e(0);function a(){}a.parse=function(i){var u=i.split("|");return{scene:u[0],to:u[1]}},a.genSessionByMsg=function(i){return{id:i.sessionId,scene:i.scene,to:i.target,updateTime:i.time,lastMsg:i}},a.appendLastMsg=function(i){var u=i.lastMsg;i["last"+s.capFirstLetter(u.type)+"Msg"]=u,i["last"+s.capFirstLetter(u.flow)+"Msg"]=u},a.genSessionByMsgs=function(i,u){var c=i.getLastNotIgnoredMsg(u);return c?a.genSessionByMsg(c):null},a.trim=function(i){var u=i=s.simpleClone(i);return u.unreadMsgs,n(u,o)},a.isComplete=function(i){return i.id&&i.scene&&i.to},t.exports=a},function(t,r,e){t.exports=e(329)},function(t,r,e){var n=e(18),o=e(169),s={V2NIM_LOGIN_STATUS_LOGOUT:0,V2NIM_LOGIN_STATUS_LOGINED:1,V2NIM_LOGIN_STATUS_LOGINING:2},a={V2NIM_CONNECT_STATUS_DISCONNECTED:0,V2NIM_CONNECT_STATUS_CONNECTED:1,V2NIM_CONNECT_STATUS_CONNECTING:2,V2NIM_CONNECT_STATUS_WAITING:3};function i(u){this.loginStatus=s.V2NIM_LOGIN_STATUS_LOGOUT,this.connectStatus=a.V2NIM_CONNECT_STATUS_DISCONNECTED,this.logger=u.logger,this.setMonitor()}i.prototype=n(new o),i.prototype.setMonitor=function(){var u=this;this.on("auth/loginLifeCycleAddressing",function(){u.logger.log("auth::life cycle addressing"),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGINING),u.setConnectStatus(a.V2NIM_CONNECT_STATUS_CONNECTING)}),this.on("auth/loginLifeCycleConnect",function(){u.logger.log("auth::life cycle connecting"),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGINING),u.setConnectStatus(a.V2NIM_CONNECT_STATUS_CONNECTING)}),this.on("auth/loginLifeCycleConnectSucc",function(){u.logger.log("auth::life cycle connect success"),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGINING),u.setConnectStatus(a.V2NIM_CONNECT_STATUS_CONNECTED)}),this.on("auth/loginLifeCycleConnectFail",function(c){u.logger.log("auth::life cycle connect fail"),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGOUT),u.setConnectStatus(a.V2NIM_CONNECT_STATUS_DISCONNECTED,c)}),this.on("auth/loginLifeCycleDisconnected",function(c){u.logger.log("auth::life cycle disconnected:",c&&c.message),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGOUT),u.setConnectStatus(a.V2NIM_CONNECT_STATUS_DISCONNECTED,c)}),this.on("auth/loginLifeCycleLoginSucc",function(){u.logger.log("auth::life cycle login success, verify authentication success"),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGINED)}),this.on("auth/loginLifeCycleLoginFail",function(c){u.logger.log("auth::life cycle login fail due to verify authentication failed:",c),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGOUT,c)}),this.on("auth/loginLifeCycleLogout",function(){u.logger.log("auth::life cycle logout"),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGOUT)}),this.on("auth/loginLifeCycleKicked",function(c){u.logger.log("auth::life cycle kicked",c),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGOUT)}),this.on("auth/loginLifeCycleWaiting",function(){u.logger.log("auth::life cycle waiting to reconnect"),u.getConnectStatus(),u.setLoginStatus(s.V2NIM_LOGIN_STATUS_LOGOUT),u.setConnectStatus(a.V2NIM_CONNECT_STATUS_WAITING)})},i.prototype.getConnectStatus=function(){return this.connectStatus},i.prototype.getLoginStatus=function(){return this.loginStatus},i.prototype.setLoginStatus=function(u,c){if(u!==this.loginStatus){var d=this.loginStatus;this.loginStatus=u,this.emit("loginStatus",u),this.delegateLoginEvent(d,u,c)}},i.prototype.delegateLoginEvent=function(u,c,d){u===s.V2NIM_LOGIN_STATUS_LOGINING&&c===s.V2NIM_LOGIN_STATUS_LOGOUT&&this.emit("loginFailed",d)},i.prototype.setConnectStatus=function(u,c){if(u!==this.connectStatus){var d=this.connectStatus;this.connectStatus=u,this.emit("connectStatus",u),this.delegateConnectEvent(d,u,c)}},i.prototype.delegateConnectEvent=function(u,c,d){u===a.V2NIM_CONNECT_STATUS_CONNECTED&&c===a.V2NIM_CONNECT_STATUS_DISCONNECTED&&this.emit("disconnected",d),u===a.V2NIM_CONNECT_STATUS_CONNECTING&&c===a.V2NIM_CONNECT_STATUS_CONNECTED&&this.emit("connectSuccess"),u===a.V2NIM_CONNECT_STATUS_CONNECTING&&c===a.V2NIM_CONNECT_STATUS_DISCONNECTED&&this.emit("connectFailed",d),u!==a.V2NIM_CONNECT_STATUS_DISCONNECTED&&this.connectStatus!==a.V2NIM_CONNECT_STATUS_WAITING||c!==a.V2NIM_CONNECT_STATUS_CONNECTING||this.emit("connecting")},i.prototype.destroy=function(){this.removeAllListeners()},t.exports={V2NIMLoginStatus:s,V2NIMConnectStatus:a,StatusProtector:i}},function(t,r,e){var n=e(63),o=e(11);t.exports=function(s){if(n(s)==="Function")return o(s)}},function(t,r,e){var n=e(31),o=e(91);t.exports=function(s,a){var i=s[a];return o(i)?void 0:n(i)}},function(t,r,e){var n=e(14),o=e(320),s=n["__core-js_shared__"]||o("__core-js_shared__",{});t.exports=s},function(t,r,e){var n=e(14),o=e(28),s=n.document,a=o(s)&&o(s.createElement);t.exports=function(i){return a?s.createElement(i):{}}},function(t,r,e){var n=e(43),o=e(128),s=e(45),a=function(i){return function(u,c,d){var m,v=n(u),g=s(v),b=o(d,g);if(i&&c!=c){for(;g>b;)if((m=v[b++])!=m)return!0}else for(;g>b;b++)if((i||b in v)&&v[b]===c)return i||b||0;return!i&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},function(t,r,e){var n=e(326);t.exports=function(o,s){return new(n(o))(s===0?0:s)}},function(t,r,e){var n={};n[e(20)("toStringTag")]="z",t.exports=String(n)==="[object z]"},function(t,r,e){var n=e(27),o=e(210),s=e(38),a=e(36),i=e(43),u=e(118);r.f=n&&!o?Object.defineProperties:function(c,d){a(c);for(var m,v=i(d),g=u(d),b=g.length,T=0;b>T;)s.f(c,m=g[T++],v[m]);return c}},function(t,r){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,r,e){var n=e(63),o=e(43),s=e(131).f,a=e(219),i=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(u){return i&&n(u)=="Window"?function(c){try{return s(c)}catch{return a(i)}}(u):s(o(u))}},function(t,r,e){var n=e(1),o=e(19),s=e(48),a=e(225),i=e(16),u=e(354),c=e(134),d=e(135),m=e(81),v=e(53),g=e(66),b=e(20),T=e(99),k=e(226),y=a.PROPER,A=a.CONFIGURABLE,V=k.IteratorPrototype,he=k.BUGGY_SAFARI_ITERATORS,ae=b("iterator"),Ne=function(){return this};t.exports=function(_e,Ce,re,ue,ze,le,de){u(re,Ce,ue);var Ie,ie,Ve,Ue=function(Fe){if(Fe===ze&&sr)return sr;if(!he&&Fe in dr)return dr[Fe];switch(Fe){case"keys":case"values":case"entries":return function(){return new re(this,Fe)}}return function(){return new re(this)}},Dt=Ce+" Iterator",tr=!1,dr=_e.prototype,fr=dr[ae]||dr["@@iterator"]||ze&&dr[ze],sr=!he&&fr||Ue(ze),hr=Ce=="Array"&&dr.entries||fr;if(hr&&(Ie=c(hr.call(new _e)))!==Object.prototype&&Ie.next&&(s||c(Ie)===V||(d?d(Ie,V):i(Ie[ae])||g(Ie,ae,Ne)),m(Ie,Dt,!0,!0),s&&(T[Dt]=Ne)),y&&ze=="values"&&fr&&fr.name!=="values"&&(!s&&A?v(dr,"name","values"):(tr=!0,sr=function(){return o(fr,this)})),ze)if(ie={values:Ue("values"),keys:le?sr:Ue("keys"),entries:Ue("entries")},de)for(Ve in ie)(he||tr||!(Ve in dr))&&g(dr,Ve,ie[Ve]);else n({target:Ce,proto:!0,forced:he||tr},ie);return s&&!de||dr[ae]===sr||g(dr,ae,sr,{name:ze}),T[Ce]=sr,ie}},function(t,r){t.exports=function(e,n){return{value:e,done:n}}},function(t,r,e){var n=e(21),o=TypeError;t.exports=function(s,a){if(n(a,s))return s;throw o("Incorrect invocation")}},function(t,r,e){var n=e(129),o=e(78),s=TypeError;t.exports=function(a){if(n(a))return a;throw s(o(a)+" is not a constructor")}},function(t,r,e){var n=Object.prototype.hasOwnProperty,o="~";function s(){}function a(d,m,v){this.fn=d,this.context=m,this.once=v||!1}function i(d,m,v,g,b){if(typeof v!="function")throw new TypeError("The listener must be a function");var T=new a(v,g||d,b),k=o?o+m:m;return d._events[k]?d._events[k].fn?d._events[k]=[d._events[k],T]:d._events[k].push(T):(d._events[k]=T,d._eventsCount++),d}function u(d,m){--d._eventsCount==0?d._events=new s:delete d._events[m]}function c(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(o=!1)),c.prototype.eventNames=function(){var d,m,v=[];if(this._eventsCount===0)return v;for(m in d=this._events)n.call(d,m)&&v.push(o?m.slice(1):m);return Object.getOwnPropertySymbols?v.concat(Object.getOwnPropertySymbols(d)):v},c.prototype.listeners=function(d){var m=o?o+d:d,v=this._events[m];if(!v)return[];if(v.fn)return[v.fn];for(var g=0,b=v.length,T=new Array(b);g<b;g++)T[g]=v[g].fn;return T},c.prototype.listenerCount=function(d){var m=o?o+d:d,v=this._events[m];return v?v.fn?1:v.length:0},c.prototype.emit=function(d,m,v,g,b,T){var k=o?o+d:d;if(!this._events[k])return!1;var y,A,V=this._events[k],he=arguments.length;if(V.fn){switch(V.once&&this.removeListener(d,V.fn,void 0,!0),he){case 1:return V.fn.call(V.context),!0;case 2:return V.fn.call(V.context,m),!0;case 3:return V.fn.call(V.context,m,v),!0;case 4:return V.fn.call(V.context,m,v,g),!0;case 5:return V.fn.call(V.context,m,v,g,b),!0;case 6:return V.fn.call(V.context,m,v,g,b,T),!0}for(A=1,y=new Array(he-1);A<he;A++)y[A-1]=arguments[A];V.fn.apply(V.context,y)}else{var ae,Ne=V.length;for(A=0;A<Ne;A++)switch(V[A].once&&this.removeListener(d,V[A].fn,void 0,!0),he){case 1:V[A].fn.call(V[A].context);break;case 2:V[A].fn.call(V[A].context,m);break;case 3:V[A].fn.call(V[A].context,m,v);break;case 4:V[A].fn.call(V[A].context,m,v,g);break;default:if(!y)for(ae=1,y=new Array(he-1);ae<he;ae++)y[ae-1]=arguments[ae];V[A].fn.apply(V[A].context,y)}}return!0},c.prototype.on=function(d,m,v){return i(this,d,m,v,!1)},c.prototype.once=function(d,m,v){return i(this,d,m,v,!0)},c.prototype.removeListener=function(d,m,v,g){var b=o?o+d:d;if(!this._events[b])return this;if(!m)return u(this,b),this;var T=this._events[b];if(T.fn)T.fn!==m||g&&!T.once||v&&T.context!==v||u(this,b);else{for(var k=0,y=[],A=T.length;k<A;k++)(T[k].fn!==m||g&&!T[k].once||v&&T[k].context!==v)&&y.push(T[k]);y.length?this._events[b]=y.length===1?y[0]:y:u(this,b)}return this},c.prototype.removeAllListeners=function(d){var m;return d?(m=o?o+d:d,this._events[m]&&u(this,m)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=o,c.EventEmitter=c,t.exports=c},function(t,r,e){t.exports=e(423)},function(t,r,e){var n=e(83)(e(50),"Map");t.exports=n},function(t,r,e){var n=e(50).Symbol;t.exports=n},function(t,r,e){var n=e(261),o=e(526),s=e(199);t.exports=function(a){return s(a)?n(a):o(a)}},function(t,r){var e=Array.isArray;t.exports=e},function(t,r){t.exports=function(e){return function(n){return e(n)}}},function(t,r,e){(function(n){var o=e(256),s=r&&!r.nodeType&&r,a=s&&typeof n=="object"&&n&&!n.nodeType&&n,i=a&&a.exports===s&&o.process,u=function(){try{var c=a&&a.require&&a.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();n.exports=u}).call(this,e(145)(t))},function(t,r){var e=Object.prototype;t.exports=function(n){var o=n&&n.constructor;return n===(typeof o=="function"&&o.prototype||e)}},function(t,r,e){var n=e(261),o=e(529),s=e(199);t.exports=function(a){return s(a)?n(a,!0):o(a)}},function(t,r,e){var n=e(534),o=e(265),s=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,i=a?function(u){return u==null?[]:(u=Object(u),n(a(u),function(c){return s.call(u,c)}))}:o;t.exports=i},function(t,r,e){var n=e(538),o=e(171),s=e(539),a=e(270),i=e(540),u=e(119),c=e(257),d=c(n),m=c(o),v=c(s),g=c(a),b=c(i),T=u;(n&&T(new n(new ArrayBuffer(1)))!="[object DataView]"||o&&T(new o)!="[object Map]"||s&&T(s.resolve())!="[object Promise]"||a&&T(new a)!="[object Set]"||i&&T(new i)!="[object WeakMap]")&&(T=function(k){var y=u(k),A=y=="[object Object]"?k.constructor:void 0,V=A?c(A):"";if(V)switch(V){case d:return"[object DataView]";case m:return"[object Map]";case v:return"[object Promise]";case g:return"[object Set]";case b:return"[object WeakMap]"}return y}),t.exports=T},function(t,r,e){var n=e(543);t.exports=function(o){var s=new o.constructor(o.byteLength);return new n(s).set(new n(o)),s}},function(t,r,e){var n=e(11),o=e(108),s=e(49),a=e(146),i=n("".replace),u="["+a+"]",c=RegExp("^"+u+u+"*"),d=RegExp(u+u+"*$"),m=function(v){return function(g){var b=s(o(g));return 1&v&&(b=i(b,c,"")),2&v&&(b=i(b,d,"")),b}};t.exports={start:m(1),end:m(2),trim:m(3)}},function(t,r,e){var n=e(116),o=e(579);n.json=o,t.exports=n},function(t,r,e){var n=e(18),o=e(26),s=e(6),a=e(2),i=e(54),u=i.f,c=e(571);function d(v){v.onload&&this.once("load",v.onload),v.onerror&&this.once("error",v.onerror),v.onbeforesend&&this.once("beforesend",v.onbeforesend),v.onaftersend&&this.once("aftersend",v.onaftersend);var g=(v=this.options=i.fetch({method:"GET",url:"",sync:!1,data:null,headers:{},cookie:!1,timeout:6e4,type:"text",form:null,input:null,putFileAtEnd:!1,proxyUrl:""},v)).headers;i.notexist(g["Content-Type"])&&(g["Content-Type"]="application/x-www-form-urlencoded"),this.send()}var m=d.prototype=n(c.prototype);m.send=function(){var v=this,g=v.options;o(function(){try{try{v.emit("beforesend",g)}catch{}v.doSend()}catch(b){v.onError("serverError","请求失败:"+b.message)}},0)},m.doSend=u,m.afterSend=function(){var v=this;o(function(){v.emit("aftersend",v.options)},0)},m.onLoad=function(v){var g,b=this.options,T=v.status,k=v.result;if(typeof T!="number"||T!==0)if(s(g=""+T).call(g,"2")===0){if(b.type==="json")try{k=JSON.parse(k)}catch{return void this.onError("parseError",k)}this.emit("load",k)}else this.onError("serverError","服务器返回异常状态",{status:T,result:k,date:v.date});else this.onError("netError","网络错误",{status:408})},m.onError=function(v,g,b){var T=i.isObject(b)?b:{};T.code=v||"error",T.message=g||"发生错误",this.emit("error",T)},m.onTimeout=function(){this.onError("timeout","请求超时")},m.abort=function(){this.onError("abort","客户端中止")},m.header=function(v){var g=this;if(!i.isArray(v))return g.getResponseHeader(v||"");var b={};return a(v).call(v,function(T){b[T]=g.header(T)}),b},m.getResponseHeader=u,m.destroy=u,t.exports=d},function(t,r,e){t.exports=e(596)},function(t,r,e){t.exports=e(609)},function(t,r,e){var n=e(188),o=e(149);function s(a,i){var u;return t.exports=s=n?o(u=n).call(u):function(c,d){return c.__proto__=d,c},t.exports.__esModule=!0,t.exports.default=t.exports,s(a,i)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(612)},function(t,r,e){var n=e(188),o=e(149),s=e(281);function a(i){var u;return t.exports=a=n?o(u=s).call(u):function(c){return c.__proto__||s(c)},t.exports.__esModule=!0,t.exports.default=t.exports,a(i)}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r){var e={link:{id:1,heartbeat:2,negotiateTransport:5,initTransport:6},sync:{id:5,sync:1,syncTeamMembers:2},misc:{id:6,getSimpleNosToken:1,getNosToken:2,notifyUploadLog:3,uploadSdkLogUrl:4,audioToText:5,processImage:6,getNosTokenTrans:7,notifyTransLog:8,fetchFile:9,fetchFileList:10,removeFile:11,getClientAntispam:17,fileQuickTransfer:18,getNosOriginUrl:22,getServerTime:23,getNosAccessToken:24,deleteNosAccessToken:25,getNosCdnHost:26,getGrayscaleConfig:27,getMixStorePolicy:28,getMixStoreToken:29,getBackSourceToken:30,uploadDetect:32},avSignal:{id:15,signalingCreate:1,signalingDelay:2,signalingClose:3,signalingJoin:4,signalingLeave:5,signalingInvite:6,signalingCancel:7,signalingReject:8,signalingAccept:9,signalingControl:10,signalingNotify:11,signalingMutilClientSyncNotify:12,signalingUnreadMessageSyncNotify:13,signalingChannelsSyncNotify:14,signalingGetChannelInfo:15,signalingCallEx:16,signalingJoinAndAccept:17}},n={heartbeat:{sid:e.link.id,cid:e.link.heartbeat},negotiateTransport:{sid:e.link.id,cid:e.link.negotiateTransport,params:[{type:"int",name:"sdkVersion"},{type:"Property",name:"negotiateTransportTag"}]},initTransport:{sid:e.link.id,cid:e.link.initTransport,params:[{type:"Property",name:"initTransportTag"}]},getGrayscaleConfig:{sid:e.misc.id,cid:e.misc.getGrayscaleConfig,params:[{type:"Property",name:"providers"}]},getMixStorePolicy:{sid:e.misc.id,cid:e.misc.getMixStorePolicy,params:[{type:"LongArray",name:"providers"}]},getMixStoreToken:{sid:e.misc.id,cid:e.misc.getMixStoreToken,params:[{type:"Property",name:"mixTokenReq"}]},getBackSourceToken:{sid:e.misc.id,cid:e.misc.getBackSourceToken,params:[{type:"Property",name:"mixAuthTokenReq"}]},uploadDetect:{sid:e.misc.id,cid:e.misc.uploadDetect,isAwaitable:!1,params:[{type:"Property",name:"notifyDetectTag"}]},getSimpleNosToken:{sid:e.misc.id,cid:e.misc.getSimpleNosToken,params:[{type:"int",name:"num"}]},getNosToken:{sid:e.misc.id,cid:e.misc.getNosToken,params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken"}]},uploadSdkLogUrl:{sid:e.misc.id,cid:e.misc.uploadSdkLogUrl,params:[{type:"string",name:"url"}]},audioToText:{sid:e.misc.id,cid:e.misc.audioToText,params:[{type:"Property",name:"audioToText"}]},processImage:{sid:e.misc.id,cid:e.misc.processImage,params:[{type:"String",name:"url"},{type:"PropertyArray",name:"imageOps",entity:"imageOp"}]},getClientAntispam:{sid:e.misc.id,cid:e.misc.getClientAntispam,params:[{type:"Property",name:"clientAntispam"}]},fileQuickTransfer:{sid:e.misc.id,cid:e.misc.fileQuickTransfer,params:[{type:"Property",name:"fileQuickTransfer"}]},getNosOriginUrl:{sid:e.misc.id,cid:e.misc.getNosOriginUrl,params:[{type:"Property",name:"nosFileUrlTag"}]},getServerTime:{sid:e.misc.id,cid:e.misc.getServerTime,params:[]},getNosAccessToken:{sid:e.misc.id,cid:e.misc.getNosAccessToken,params:[{type:"Property",name:"nosAccessTokenTag"}]},deleteNosAccessToken:{sid:e.misc.id,cid:e.misc.deleteNosAccessToken,params:[{type:"Property",name:"nosAccessTokenTag"}]},getNosTokenTrans:{sid:e.misc.id,cid:e.misc.getNosTokenTrans,params:[{type:"Property",name:"transToken"}]},fetchFile:{sid:e.misc.id,cid:e.misc.fetchFile,params:[{type:"String",name:"docId"}]},fetchFileList:{sid:e.misc.id,cid:e.misc.fetchFileList,params:[{type:"Property",name:"fileListParam"}]},removeFile:{sid:e.misc.id,cid:e.misc.removeFile,params:[{type:"String",name:"docId"}]},getNosCdnHost:{sid:e.misc.id,cid:e.misc.getNosCdnHost,params:[]},signalingCreate:{sid:e.avSignal.id,cid:e.avSignal.signalingCreate,params:[{type:"Property",name:"avSignalTag"}]},signalingDelay:{sid:e.avSignal.id,cid:e.avSignal.signalingDelay,params:[{type:"Property",name:"avSignalTag"}]},signalingClose:{sid:e.avSignal.id,cid:e.avSignal.signalingClose,params:[{type:"Property",name:"avSignalTag"}]},signalingJoin:{sid:e.avSignal.id,cid:e.avSignal.signalingJoin,params:[{type:"Property",name:"avSignalTag"}]},signalingLeave:{sid:e.avSignal.id,cid:e.avSignal.signalingLeave,params:[{type:"Property",name:"avSignalTag"}]},signalingInvite:{sid:e.avSignal.id,cid:e.avSignal.signalingInvite,params:[{type:"Property",name:"avSignalTag"}]},signalingCancel:{sid:e.avSignal.id,cid:e.avSignal.signalingCancel,params:[{type:"Property",name:"avSignalTag"}]},signalingReject:{sid:e.avSignal.id,cid:e.avSignal.signalingReject,params:[{type:"Property",name:"avSignalTag"}]},signalingAccept:{sid:e.avSignal.id,cid:e.avSignal.signalingAccept,params:[{type:"Property",name:"avSignalTag"}]},signalingControl:{sid:e.avSignal.id,cid:e.avSignal.signalingControl,params:[{type:"Property",name:"avSignalTag"}]},signalingGetChannelInfo:{sid:e.avSignal.id,cid:e.avSignal.signalingGetChannelInfo,params:[{type:"Property",name:"avSignalTag"}]},signalingCallEx:{sid:e.avSignal.id,cid:e.avSignal.signalingCallEx,params:[{type:"Property",name:"avSignalTag"}]},signalingJoinAndAccept:{sid:e.avSignal.id,cid:e.avSignal.signalingJoinAndAccept,params:[{type:"Property",name:"avSignalTag"}]}};t.exports={idMap:e,cmdConfig:n,packetConfig:{"1_2":{service:"link",cmd:"heartbeat"},"1_5":{service:"link",cmd:"negotiateTransport",response:[{type:"Property",name:"negotiateTransportTag"}]},"1_6":{service:"link",cmd:"initTransport",response:[{type:"Property",name:"initTransportTag"}]},"6_1":{service:"misc",cmd:"getSimpleNosToken",response:[{type:"PropertyArray",name:"nosTokens",entity:"nosToken"}]},"6_2":{service:"misc",cmd:"getNosToken",response:[{type:"Property",name:"nosToken"}]},"6_3":{service:"misc",cmd:"notifyUploadLog"},"6_4":{service:"misc",cmd:"uploadSdkLogUrl"},"6_5":{service:"misc",cmd:"audioToText",response:[{type:"String",name:"text"}]},"6_6":{service:"misc",cmd:"processImage",response:[{type:"String",name:"url"}]},"6_7":{service:"misc",cmd:"getNosTokenTrans",response:[{type:"Property",name:"nosToken"},{type:"String",name:"docId"}]},"6_8":{service:"misc",cmd:"notifyTransLog",response:[{type:"Property",name:"transInfo"}]},"6_9":{service:"misc",cmd:"fetchFile",response:[{type:"Property",name:"info",entity:"transInfo"}]},"6_10":{service:"misc",cmd:"fetchFileList",response:[{type:"PropertyArray",name:"list",entity:"transInfo"},{type:"Number",name:"totalCount"}]},"6_11":{service:"misc",cmd:"removeFile",response:[{type:"String",name:"res"}]},"6_17":{service:"misc",cmd:"getClientAntispam",response:[{type:"Property",name:"clientAntispam"}]},"6_18":{service:"misc",cmd:"fileQuickTransfer",response:[{type:"Property",name:"fileQuickTransfer"}]},"6_22":{service:"misc",cmd:"getNosOriginUrl",response:[{type:"Property",name:"nosFileUrlTag"}]},"6_23":{service:"misc",cmd:"getServerTime",response:[{type:"Number",name:"time"}]},"6_24":{service:"misc",cmd:"getNosAccessToken",response:[{type:"Property",name:"nosAccessTokenTag"}]},"6_25":{service:"misc",cmd:"deleteNosAccessToken"},"6_26":{service:"misc",cmd:"getNosCdnHost",response:[{type:"Property",name:"nosConfigTag"}]},"6_27":{service:"misc",cmd:"getGrayscaleConfig",response:[{type:"Property",name:"appGrayConfigTag"}]},"6_28":{service:"misc",cmd:"getMixStorePolicy",response:[{type:"Property",name:"mixStorePolicyTag"}]},"6_29":{service:"misc",cmd:"getMixStoreToken",response:[{type:"Property",name:"mixStoreTokenTag"}]},"6_30":{service:"misc",cmd:"getBackSourceToken",response:[{type:"Property",name:"backSourceTokenTag"}]},"6_31":{service:"link",cmd:"notifyDetect",response:[{type:"Property",name:"notifyDetectTag"}]},"6_32":{service:"link",cmd:"uploadDetect",response:[]},"15_1":{service:"avSignal",cmd:"signalingCreate",response:[{type:"Property",name:"avSignalTag"}]},"15_2":{service:"avSignal",cmd:"signalingDelay",response:[{type:"Property",name:"avSignalTag"}]},"15_3":{service:"avSignal",cmd:"signalingClose",response:[{type:"Property",name:"avSignalTag"}]},"15_4":{service:"avSignal",cmd:"signalingJoin",response:[{type:"Property",name:"avSignalTag"}]},"15_5":{service:"avSignal",cmd:"signalingLeave",response:[]},"15_6":{service:"avSignal",cmd:"signalingInvite",response:[]},"15_7":{service:"avSignal",cmd:"signalingCancel",response:[]},"15_8":{service:"avSignal",cmd:"signalingReject",response:[]},"15_9":{service:"avSignal",cmd:"signalingAccept",response:[]},"15_10":{service:"avSignal",cmd:"signalingControl",response:[]},"15_11":{service:"avSignal",cmd:"signalingNotify",response:[{type:"Property",name:"avSignalTag"}]},"15_12":{service:"avSignal",cmd:"signalingMutilClientSyncNotify",response:[{type:"Property",name:"avSignalTag"}]},"15_13":{service:"avSignal",cmd:"signalingUnreadMessageSyncNotify",response:[{type:"PropertyArray",name:"avSignalTag"}]},"15_14":{service:"avSignal",cmd:"signalingChannelsSyncNotify",response:[{type:"PropertyArray",name:"avSignalTag"}]},"15_15":{service:"avSignal",cmd:"signalingGetChannelInfo",response:[{type:"Property",name:"avSignalTag"}]},"15_16":{service:"avSignal",cmd:"signalingCallEx",response:[{type:"Property",name:"avSignalTag"}]},"15_17":{service:"avSignal",cmd:"signalingJoinAndAccept",response:[{type:"Property",name:"avSignalTag"}]}}}},function(t,r,e){var n=e(5),o=e(2),s=e(24),a=e(0),i=a.notundef,u=a.fillPropertyWithDefault,c=n,d={},m={},v=[],g={},b={normal:0,advanced:1},T={0:"normal",1:"advanced"},k=c(b),y=d.joinMode={noVerify:0,needVerify:1,rejectAll:2};m.joinMode={0:"noVerify",1:"needVerify",2:"rejectAll"},v.push("join"),g.joinMode=c(y);var A=d.beInviteMode={needVerify:0,noVerify:1};m.beInviteMode={0:"needVerify",1:"noVerify"},v.push("beInvite"),g.beInviteMode=c(A);var V=d.inviteMode={manager:0,all:1};m.inviteMode={0:"manager",1:"all"},v.push("invite"),g.inviteMode=c(V);var he=d.updateTeamMode={manager:0,all:1};m.updateTeamMode={0:"manager",1:"all"},v.push("updateTeam"),g.updateTeamMode=c(he);var ae=d.updateCustomMode={manager:0,all:1};function Ne(Ce){var re;switch(a.verifyOptions(Ce,"action","team::Team"),Ce.action){case"create":a.verifyOptions(Ce,"teamId",!1,"team::Team"),a.verifyOptions(Ce,"type name","team::Team"),a.verifyParamValid("type",Ce.type,k,"team::Team"),i(Ce.level)&&(a.verifyParamType("level",Ce.level,"number","team::Team"),this.level=Ce.level);break;case"update":a.verifyOptions(Ce,"teamId","team::Team"),a.verifyOptions(Ce,"type",!1,"team::Team")}i(Ce.teamId)&&(this.teamId=Ce.teamId),i(Ce.type)&&(this.type=b[Ce.type]),i(Ce.avatar)&&(this.avatar=""+Ce.avatar),i(Ce.name)&&(this.name=""+Ce.name),i(Ce.intro)&&(this.intro=""+Ce.intro),i(Ce.announcement)&&(this.announcement=""+Ce.announcement),o(v).call(v,s(re=this.setMode).call(re,this,Ce)),i(Ce.custom)&&(this.custom=""+Ce.custom)}function _e(Ce,re){i(Ce[re+="Mode"])&&(Ce[re]=m[re][Ce[re]])}m.updateCustomMode={0:"manager",1:"all"},v.push("updateCustom"),g.updateCustomMode=c(ae),Ne.prototype.setMode=function(Ce,re){i(Ce[re+="Mode"])&&(a.verifyParamValid(re,Ce[re],g[re],"team::Team"),this[re]=d[re][Ce[re]])},Ne.reverse=function(Ce,re){var ue=a.copy(Ce);if(i(ue.teamId)&&(ue.teamId=""+ue.teamId),i(ue.type)&&(ue.type=T[ue.type]),i(ue.level)&&(ue.level=+ue.level),i(ue.valid)&&(ue.valid=+ue.valid==1),i(ue.memberNum)&&(ue.memberNum=+ue.memberNum),i(ue.memberUpdateTime)&&(ue.memberUpdateTime=+ue.memberUpdateTime),i(ue.createTime)&&(ue.createTime=+ue.createTime),i(ue.updateTime)&&(ue.updateTime=+ue.updateTime),i(ue.validToCurrentUser)&&(ue.validToCurrentUser=ue.validToCurrentUser==="1"),i(ue.mute)&&(ue.mute=ue.mute==="1"),i(ue.muteType))switch(ue.muteType){case"0":ue.mute=!1,ue.muteType="none";break;case"1":ue.mute=!0,ue.muteType="normal";break;case"3":ue.mute=!0,ue.muteType="all"}else i(ue.mute)&&(ue.mute===1?(ue.mute=!0,ue.muteType="normal"):(ue.mute=!1,ue.muteType="none"));return o(v).call(v,s(_e).call(_e,null,ue)),delete ue.bits,re||Ne.fillProperties(ue),ue},Ne.fillProperties=function(Ce){var re=u(Ce,"beInviteMode","needVerify"),ue=u(Ce,"inviteMode","manager"),ze=u(Ce,"updateTeamMode","manager"),le=u(Ce,"updateCustomMode","manager"),de=u(Ce,"avatar","");return re||ue||ze||le||de},t.exports=Ne},function(t,r,e){var n=e(44).clientTypeMap;function o(){}o.reverse=function(s){var a=s;return a.type=n[a.type],a},o.reverseType=function(s){return n[s]||s},t.exports=o},function(t,r,e){var n=e(18),o=e(41),s=e(10),a=e(73),i=e(194),u=e(13),c=e(762),d=e(894),m=e(0),v=m.verifyOptions,g=m.verifyParamType,b=e(23).reportAPI,T=e(147).Chatroom;function k(A){return this.subType="chatroom",this.nosScene=A.nosScene||"chatroom",this.nosSurvivalTime=A.nosSurvivalTime,A.Protocol=i,A.Message=d,A.constructor=k,A.isAnonymous&&(A.account=A.account||"nimanon_".concat(m.guid()),A.isAnonymous=1,m.verifyOptions(A,"chatroomNick","api::Chatroom"),A.chatroomAvatar=A.chatroomAvatar||" "),this.init(A)}k.Protocol=i,k.parser=T,k.use=a.use,k.getInstance=function(A){return A.isAnonymous&&(A.account=A.account||"nimanon_".concat(m.guid()),A.isAnonymous=1,m.verifyOptions(A,"chatroomNick","api::Chatroom.getInstance"),A.chatroomAvatar=A.chatroomAvatar||" "),a.getInstance.call(this,A)},k.genInstanceName=function(A){return m.verifyOptions(A,"chatroomId","api::Chatroom.genInstanceName"),"Chatroom-account-"+A.account+"-chatroomId-"+A.chatroomId};var y=k.fn=k.prototype=n(a.prototype);k.info=y.info=u.info,y.getChatroom=function(A){(A=A||{}).done=b({instance:this,className:"ChatroomFn",funcName:"getChatroom",done:A.done}),this.processCallback(A),this.sendCmd("getChatroom",A)},y.updateChatroom=function(A){(A=A||{}).done=b({instance:this,className:"ChatroomFn",funcName:"updateChatroom",done:A.done}),v(A,"chatroom needNotify","api::updateChatroom"),g("needNotify",A.needNotify,"boolean"),this.processCustom(A),this.processCallback(A),A.chatroom=new c(A.chatroom),A.antispamTag={antiSpamBusinessId:A.antiSpamBusinessId},this.sendCmd("updateChatroom",A)},y.closeChatroom=function(A){(A=A||{}).done=b({instance:this,className:"ChatroomFn",funcName:"closeChatroom",done:A.done}),this.processCustom(A),this.processCallback(A),this.sendCmd("closeChatroom",A)},y.updateTags=function(A){(A=A||{}).done=b({instance:this,className:"ChatroomFn",funcName:"updateTags",done:A.done}),m.validate({tags:{type:"array",required:!1},notifyTargetTags:{type:"string",allowEmpty:!0,required:!1},needNotify:{type:"boolean",required:!1}},A,"chatroom::updateTags");var V=o({},A);this.processCallback(V),V.tags&&(V.tags=s(V.tags)),V.needNotify&&(V.needNotify=V.needNotify?1:0),this.sendCmd("updateChatroomTags",{chatRoomTagsUpdateTag:V},V.done)},t.exports=k,e(904),e(905),e(906),e(907)},function(t,r,e){var n=e(18),o=e(24),s=e(8),a=e(9),i=e(75),u=e(0),c=u.undef,d=u.notundef,m=e(289),v=e(13),g=e(147),b=e(762),T=e(310);function k(V){var he,ae,Ne;u.verifyOptions(V,"appKey account chatroomId chatroomAddresses","protocol::ChatroomProtocol"),V.isAnonymous||u.verifyOptions(V,"token","protocol::ChatroomProtocol"),u.verifyParamType("chatroomAddresses",V.chatroomAddresses,"array","protocol::ChatroomProtocol"),u.verifyCallback(V,"onconnect onerror onwillreconnect ondisconnect onmsg onmsgs onrobots","protocol::ChatroomProtocol"),he=typeof u.get(V,"privateConf.isDataReportEnable")=="boolean"?V.privateConf.isDataReportEnable:v.privateConf.isDataReportEnable,ae=typeof u.get(V,"privateConf.reportConfigUrl")=="string"?V.privateConf.reportConfigUrl:v.privateConf.reportConfigUrl,Ne=typeof u.get(V,"privateConf.reportUrl")=="string"?V.privateConf.reportUrl:v.privateConf.reportUrl,this.reporter=m.initReporter({isDataReportEnable:he,reportConfigUrl:ae,reportUrl:Ne,appKey:V.appKey,logger:this.logger}),i.call(this,V)}var y=i.fn,A=k.fn=k.prototype=n(y);A.init=function(){var V;y.init.call(this),g.Chatroom.setProtocol(this),this.parser=g.Chatroom,o(V=this.sendCmd).call(V,this),this.syncResult={},this.timetags={},this.msgBuffer=[]},A.reset=function(){var V=this;y.reset.call(V);var he,ae=V.options;V.autoconnect=!!ae.autoconnect,c(ae.msgBufferInterval)&&(ae.msgBufferInterval=300),u.verifyParamType("msgBufferInterval",ae.msgBufferInterval,"number","protocol::ChatroomProtocol.reset"),c(ae.msgBufferSize)&&(ae.msgBufferSize=500),u.verifyParamType("msgBufferSize",ae.msgBufferSize,"number","protocol::ChatroomProtocol.reset"),d(ae.chatroomAddresses)&&(V.socketUrlsBackup=s(he=ae.chatroomAddresses).call(he,function(Ne){return v.formatSocketUrl({url:Ne,secure:V.options.secure})}))},A.processChatroom=function(V){switch(V.cmd){case"login":V.error||(V.obj={chatroom:a(b).call(b,V.content.chatroom),member:a(T).call(T,V.content.chatroomMember)},this.cdnInfo={},this.initCdnData(),clearTimeout(this.queryCdnTimer),this.onCdnMsgInfo(V.content.chatroomCdnInfo));break;case"kicked":this.onKicked(V);break;case"logout":break;case"sendMsg":this.onSendMsg(V);break;case"msg":this.onMsg(V),this.cdnInfo&&this.cdnInfo.enable&&this.correctCdnTime(+V.content.msg.time);break;case"getChatroomMembers":case"getChatroomMembersByTag":this.onChatroomMembers(V);break;case"getChatroomMemberCountByTag":this.onGetChatroomMemberCountByTag(V);break;case"getHistoryMsgs":case"getHistoryMsgsByTags":this.onHistoryMsgs(V);break;case"markChatroomMember":this.onMarkChatroomMember(V);break;case"closeChatroom":break;case"getChatroom":this.onChatroom(V);break;case"updateChatroom":break;case"updateMyChatroomMemberInfo":delete V.obj.chatroomMember;break;case"getChatroomMembersInfo":this.onChatroomMembersInfo(V);break;case"kickChatroomMember":case"updateChatroomMemberTempMute":break;case"queueList":V.error||(V.obj=V.content);break;case"syncRobot":this.onSyncRobot(V);break;case"notifyCdnInfo":this.onCdnMsgInfo(V.content&&V.content.chatroomCdnInfo);break;case"updateChatroomTag":this.onTagsUpdate(V.content)}},A.onChatroom=function(V){V.error||(V.obj.chatroom=a(b).call(b,V.content.chatroom))},A.onTagsUpdate=function(V){if(this.logger.info("onTagsUpdate:: ",V),this.options.onTagsUpdate&&typeof this.options.onTagsUpdate=="function"){var he=V.updateTags&&V.updateTags.currentTags;try{he=JSON.parse(he)}catch(ae){this.logger.error("onTagsUpdate:: parse tags failed",ae)}this.options.onTagsUpdate(he)}},t.exports=k,e(882),e(883),e(884),e(893)},function(t,r){t.exports=function(){}},function(t,r,e){t.exports=e(444)},function(t,r){t.exports=function(e,n){for(var o=n.split(".");o.length;){var s=o.shift(),a=!1;if(s[s.length-1]=="?"&&(s=s.slice(0,-1),a=!0),!(e=e[s])&&a)return e}return e}},function(t,r){t.exports=function(e,n){return e===n||e!=e&&n!=n}},function(t,r,e){var n=e(255),o=e(263);t.exports=function(s){return s!=null&&o(s.length)&&!n(s)}},function(t,r,e){t.exports=e(629)},function(t,r,e){var n=e(8),o=e(9),s=e(0),a=s.notundef,i=s.fillPropertyWithDefault,u={0:"normal",1:"owner",2:"manager"};function c(d){s.verifyOptions(d,"teamId","superTeam::TeamMember"),s.verifyParamAtLeastPresentOne(d,"nickInTeam muteTeam custom muteNotiType","superTeam::SuperTeamMember"),this.teamId=d.teamId,a(d.account)&&(this.account=d.account),a(d.nickInTeam)&&(this.nickInTeam=d.nickInTeam),a(d.muteNotiType)?this.bits=d.muteNotiType:a(d.muteTeam)&&(this.bits=0,d.muteTeam&&(this.bits+=1)),a(d.mute)&&(this.mute=d.mute?1:0),a(d.custom)&&(this.custom=""+d.custom)}c.reverse=function(d){var m=s.copy(d);if(a(m.teamId)&&(m.teamId=""+m.teamId),a(m.type)&&(m.type=u[m.type]),a(m.active)&&(m.active=+m.active==1),a(m.valid)&&(m.valid=+m.valid==1),a(m.mute)&&(m.mute=+m.mute==1),a(m.joinTime)&&(m.joinTime=+m.joinTime),a(m.updateTime)&&(m.updateTime=+m.updateTime),a(m.bits)){var v=m.bits;delete m.bits,m.muteTeam=!!(1&v),m.muteNotiType=v}return a(m.teamId)&&a(m.account)&&(m.id=c.genId(m.teamId,m.account)),m},c.reverseMembers=function(d){return n(d).call(d,function(m){return o(c).call(c,m)})},c.fillProperties=function(d){var m=i(d,"mute",!1),v=i(d,"custom","");return m||v},c.genId=function(d,m){return d+"-"+m},c.accounts2ids=function(d,m){return n(m).call(m,function(v){return c.genId(d,v)})},c.assembleMembers=function(d,m){return s.isArray(m)||(m=[m]),n(m).call(m,function(v){return c.assembleMember(d,v)})},c.assembleMember=function(d,m){return{id:c.genId(d.teamId,m),account:m,teamId:d.teamId,type:"normal",nickInTeam:"",muteTeam:!1,mute:!1,joinTime:d.memberUpdateTime,updateTime:d.memberUpdateTime,active:!0,valid:!0}},c.assembleOwner=function(d){var m=c.assembleMember(d,d.owner);return m.type="owner",m},t.exports=c},function(t,r,e){var n=e(8),o=e(9),s=e(5),a=e(106).genPrivateUrl,i=e(0),u={unknown:0,male:1,female:2},c={0:"unknown",1:"male",2:"female"};function d(m){i.merge(this,m),i.notundef(this.gender)&&(i.verifyParamValid("gender",this.gender,d.validGenders,"user::User"),this.gender=u[this.gender]),i.notundef(this.email)&&this.email!==""&&i.verifyEmail("email",this.email,"user::User"),i.notundef(this.birth)&&this.birth!==""&&i.verifyBirth("birth",this.birth,"user::User"),i.notundef(this.tel)&&this.tel!==""&&i.verifyTel("tel",this.tel,"user::User")}d.reverse=function(m,v,g){var b=i.filterObj(m,"account nick avatar _avatar_safe sign gender email birth tel custom createTime updateTime");return i.notundef(b.avatar)&&(b.avatar=a(b.avatar,v,g)),i.notundef(b.gender)&&(b.gender=c[b.gender]),i.notundef(b.createTime)&&(b.createTime=+b.createTime),i.notundef(b.updateTime)&&(b.updateTime=+b.updateTime),b},d.reverseUsers=function(m){return n(m).call(m,function(v){return o(d).call(d,v)})},d.validGenders=s(u),t.exports=d},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(6),i=e(106).genPrivateUrl,u=e(72),c=e(0),d=e(13);function m(T,k){switch(c.notundef(T.type)?c.verifyFileType(T.type,"msg::FileMessage"):T.type="file",c.verifyOptions(T,"file","msg::FileMessage"),c.verifyOptions(T.file,"url ext size",!0,"file.","msg::FileMessage"),T.type){case"image":v.verifyFile(T.file,"msg::FileMessage");break;case"audio":g.verifyFile(T.file,"msg::FileMessage");break;case"video":b.verifyFile(T.file,"msg::FileMessage")}u.call(this,T),k&&(this.idClient=k),this.attach=n(T.file)}m.prototype=o(u.prototype),m.reverse=function(T){var k=s(u).call(u,T);if(T.attach=T.attach?""+T.attach:"",T.attach&&(k.file=JSON.parse(T.attach),!k.file.isS3)){var y,A;k.file.url=i(k.file.url)||"",k.type==="audio"&&k.file.url&&!k.file.mp3Url&&(k.file.mp3Url=k.file.url+(~a(A=k.file.url).call(A,"?")?"&":"?")+"audioTrans&type=mp3"),d.httpsEnabled&&a(y=k.file.url).call(y,"https://")!==0&&(k.file.url=k.file.url.replace("http","https"))}return k},t.exports=m;var v=e(830),g=e(831),b=e(832)},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(6),i=e(106).genPrivateUrl,u=e(117),c=e(0),d=e(13);function m(T,k){switch(c.notundef(T.type)?c.verifyFileType(T.type,"msg::FileMessage"):T.type="file",c.verifyOptions(T,"file","msg::FileMessage"),c.verifyOptions(T.file,"url ext size",!0,"file.","msg::FileMessage"),T.type){case"image":v.verifyFile(T.file,"msg::FileMessage");break;case"audio":g.verifyFile(T.file,"msg::FileMessage");break;case"video":b.verifyFile(T.file,"msg::FileMessage")}u.call(this,T),k&&(this.idClient=k),this.attach=n(T.file)}m.prototype=o(u.prototype),m.reverse=function(T){var k=s(u).call(u,T);if(T.attach=T.attach?""+T.attach:"",T.attach&&(k.file=JSON.parse(T.attach),!k.file.isS3)){var y,A;k.file.url=i(k.file.url)||"",k.type==="audio"&&k.file.url&&!k.file.mp3Url&&(k.file.mp3Url=k.file.url+(~a(A=k.file.url).call(A,"?")?"&":"?")+"audioTrans&type=mp3"),d.httpsEnabled&&a(y=k.file.url).call(y,"https://")!==0&&(k.file.url=k.file.url.replace("http","https"))}return k},t.exports=m;var v=e(896),g=e(897),b=e(898)},function(t,r,e){var n=e(315);t.exports=n},function(t,r){var e=typeof document=="object"&&document.all,n=e===void 0&&e!==void 0;t.exports={all:e,IS_HTMLDDA:n}},function(t,r,e){var n=e(92);t.exports=n&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},function(t,r,e){var n=e(27),o=e(4),s=e(158);t.exports=!n&&!o(function(){return Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a!=7})},function(t,r,e){var n=e(4),o=e(16),s=/#|\.prototype\./,a=function(m,v){var g=u[i(m)];return g==d||g!=c&&(o(v)?n(v):!!v)},i=a.normalize=function(m){return String(m).replace(s,".").toLowerCase()},u=a.data={},c=a.NATIVE="N",d=a.POLYFILL="P";t.exports=a},function(t,r,e){var n=e(27),o=e(4);t.exports=n&&o(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},function(t,r,e){var n=e(1),o=e(4),s=e(79),a=e(28),i=e(42),u=e(45),c=e(212),d=e(95),m=e(160),v=e(111),g=e(20),b=e(93),T=g("isConcatSpreadable"),k=b>=51||!o(function(){var V=[];return V[T]=!1,V.concat()[0]!==V}),y=v("concat"),A=function(V){if(!a(V))return!1;var he=V[T];return he!==void 0?!!he:s(V)};n({target:"Array",proto:!0,arity:1,forced:!k||!y},{concat:function(V){var he,ae,Ne,_e,Ce,re=i(this),ue=m(re,0),ze=0;for(he=-1,Ne=arguments.length;he<Ne;he++)if(A(Ce=he===-1?re:arguments[he]))for(_e=u(Ce),c(ze+_e),ae=0;ae<_e;ae++,ze++)ae in Ce&&d(ue,ze,Ce[ae]);else c(ze+1),d(ue,ze++,Ce);return ue.length=ze,ue}})},function(t,r){var e=TypeError;t.exports=function(n){if(n>9007199254740991)throw e("Maximum allowed index exceeded");return n}},function(t,r,e){var n=e(11),o=e(16),s=e(157),a=n(Function.toString);o(s.inspectSource)||(s.inspectSource=function(i){return a(i)}),t.exports=s.inspectSource},function(t,r,e){var n=e(327);t.exports=n},function(t,r,e){var n=e(11),o=e(29),s=e(43),a=e(159).indexOf,i=e(112),u=n([].push);t.exports=function(c,d){var m,v=s(c),g=0,b=[];for(m in v)!o(i,m)&&o(v,m)&&u(b,m);for(;d.length>g;)o(v,m=d[g++])&&(~a(b,m)||u(b,m));return b}},function(t,r,e){var n=e(33);t.exports=n("document","documentElement")},function(t,r,e){var n=e(332);e(67),t.exports=n},function(t,r,e){e(333),e(336),e(337),e(222),e(338)},function(t,r,e){var n=e(128),o=e(45),s=e(95),a=Array,i=Math.max;t.exports=function(u,c,d){for(var m=o(u),v=n(c,m),g=n(d===void 0?m:d,m),b=a(i(g-v,0)),T=0;v<g;v++,T++)s(b,T,u[v]);return b.length=T,b}},function(t,r,e){var n=e(19),o=e(33),s=e(20),a=e(66);t.exports=function(){var i=o("Symbol"),u=i&&i.prototype,c=u&&u.valueOf,d=s("toPrimitive");u&&!u[d]&&a(u,d,function(m){return n(c,this)},{arity:1})}},function(t,r,e){var n=e(92);t.exports=n&&!!Symbol.for&&!!Symbol.keyFor},function(t,r,e){var n=e(1),o=e(33),s=e(76),a=e(19),i=e(11),u=e(4),c=e(79),d=e(16),m=e(28),v=e(126),g=e(98),b=e(92),T=o("JSON","stringify"),k=i(/./.exec),y=i("".charAt),A=i("".charCodeAt),V=i("".replace),he=i(1 .toString),ae=/[\uD800-\uDFFF]/g,Ne=/^[\uD800-\uDBFF]$/,_e=/^[\uDC00-\uDFFF]$/,Ce=!b||u(function(){var le=o("Symbol")();return T([le])!="[null]"||T({a:le})!="{}"||T(Object(le))!="{}"}),re=u(function(){return T("\uDF06\uD834")!=='"\\udf06\\ud834"'||T("\uDEAD")!=='"\\udead"'}),ue=function(le,de){var Ie=g(arguments),ie=de;if((m(de)||le!==void 0)&&!v(le))return c(de)||(de=function(Ve,Ue){if(d(ie)&&(Ue=a(ie,this,Ve,Ue)),!v(Ue))return Ue}),Ie[1]=de,s(T,null,Ie)},ze=function(le,de,Ie){var ie=y(Ie,de-1),Ve=y(Ie,de+1);return k(Ne,le)&&!k(_e,Ve)||k(_e,le)&&!k(Ne,ie)?"\\u"+he(A(le,0),16):le};T&&n({target:"JSON",stat:!0,arity:3,forced:Ce||re},{stringify:function(le,de,Ie){var ie=g(arguments),Ve=s(Ce?ue:T,null,ie);return re&&typeof Ve=="string"?V(Ve,ae,ze):Ve}})},function(t,r,e){e(22)("iterator")},function(t,r,e){var n=e(22),o=e(220);n("toPrimitive"),o()},function(t,r,e){var n=e(27),o=e(29),s=Function.prototype,a=n&&Object.getOwnPropertyDescriptor,i=o(s,"name"),u=i&&(function(){}).name==="something",c=i&&(!n||n&&a(s,"name").configurable);t.exports={EXISTS:i,PROPER:u,CONFIGURABLE:c}},function(t,r,e){var n,o,s,a=e(4),i=e(16),u=e(28),c=e(80),d=e(134),m=e(66),v=e(20),g=e(48),b=v("iterator"),T=!1;[].keys&&("next"in(s=[].keys())?(o=d(d(s)))!==Object.prototype&&(n=o):T=!0),!u(n)||a(function(){var k={};return n[b].call(k)!==k})?n={}:g&&(n=c(n)),i(n[b])||m(n,b,function(){return this}),t.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:T}},function(t,r,e){var n=e(4);t.exports=!n(function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype})},function(t,r,e){e(67);var n=e(65),o=e(29),s=e(21),a=e(374),i=Array.prototype,u={DOMTokenList:!0,NodeList:!0};t.exports=function(c){var d=c.forEach;return c===i||s(i,c)&&d===i.forEach||o(u,n(c))?a:d}},function(t,r,e){var n=e(382);t.exports=n},function(t,r,e){var n=e(386);e(67),t.exports=n},function(t,r,e){e(387)},function(t,r,e){var n=e(33),o=e(11),s=e(131),a=e(132),i=e(36),u=o([].concat);t.exports=n("Reflect","ownKeys")||function(c){var d=s.f(i(c)),m=a.f;return m?u(d,m(c)):d}},function(t,r,e){var n=e(20),o=e(99),s=n("iterator"),a=Array.prototype;t.exports=function(i){return i!==void 0&&(o.Array===i||a[s]===i)}},function(t,r,e){var n=e(19),o=e(31),s=e(36),a=e(78),i=e(136),u=TypeError;t.exports=function(c,d){var m=arguments.length<2?i(c):d;if(o(m))return s(n(m,c));throw u(a(c)+" is not iterable")}},function(t,r,e){var n=e(19),o=e(36),s=e(156);t.exports=function(a,i,u){var c,d;o(a);try{if(!(c=s(a,"return"))){if(i==="throw")throw u;return u}c=n(c,a)}catch(m){d=!0,c=m}if(i==="throw")throw u;if(d)throw c;return o(c),u}},function(t,r,e){var n=e(33),o=e(38),s=e(20),a=e(27),i=s("species");t.exports=function(u){var c=n(u),d=o.f;a&&c&&!c[i]&&d(c,i,{configurable:!0,get:function(){return this}})}},function(t,r,e){var n=e(36),o=e(168),s=e(91),a=e(20)("species");t.exports=function(i,u){var c,d=n(i).constructor;return d===void 0||s(c=n(d)[a])?u:o(c)}},function(t,r,e){var n,o,s,a,i=e(14),u=e(76),c=e(34),d=e(16),m=e(29),v=e(4),g=e(216),b=e(98),T=e(158),k=e(239),y=e(240),A=e(114),V=i.setImmediate,he=i.clearImmediate,ae=i.process,Ne=i.Dispatch,_e=i.Function,Ce=i.MessageChannel,re=i.String,ue=0,ze={};try{n=i.location}catch{}var le=function(Ve){if(m(ze,Ve)){var Ue=ze[Ve];delete ze[Ve],Ue()}},de=function(Ve){return function(){le(Ve)}},Ie=function(Ve){le(Ve.data)},ie=function(Ve){i.postMessage(re(Ve),n.protocol+"//"+n.host)};V&&he||(V=function(Ve){k(arguments.length,1);var Ue=d(Ve)?Ve:_e(Ve),Dt=b(arguments,1);return ze[++ue]=function(){u(Ue,void 0,Dt)},o(ue),ue},he=function(Ve){delete ze[Ve]},A?o=function(Ve){ae.nextTick(de(Ve))}:Ne&&Ne.now?o=function(Ve){Ne.now(de(Ve))}:Ce&&!y?(a=(s=new Ce).port2,s.port1.onmessage=Ie,o=c(a.postMessage,a)):i.addEventListener&&d(i.postMessage)&&!i.importScripts&&n&&n.protocol!=="file:"&&!v(ie)?(o=ie,i.addEventListener("message",Ie,!1)):o="onreadystatechange"in T("script")?function(Ve){g.appendChild(T("script")).onreadystatechange=function(){g.removeChild(this),le(Ve)}}:function(Ve){setTimeout(de(Ve),0)}),t.exports={set:V,clear:he}},function(t,r){var e=TypeError;t.exports=function(n,o){if(n<o)throw e("Not enough arguments");return n}},function(t,r,e){var n=e(64);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(n)},function(t,r){t.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},function(t,r,e){var n=e(101),o=e(243),s=e(115).CONSTRUCTOR;t.exports=s||!o(function(a){n.all(a).then(void 0,function(){})})},function(t,r,e){var n=e(20)("iterator"),o=!1;try{var s=0,a={next:function(){return{done:!!s++}},return:function(){o=!0}};a[n]=function(){return this},Array.from(a,function(){throw 2})}catch{}t.exports=function(i,u){if(!u&&!o)return!1;var c=!1;try{var d={};d[n]=function(){return{next:function(){return{done:c=!0}}}},i(d)}catch{}return c}},function(t,r,e){var n=e(36),o=e(28),s=e(68);t.exports=function(a,i){if(n(a),o(i)&&i.constructor===a)return i;var u=s.f(a);return(0,u.resolve)(i),u.promise}},function(t,r,e){var n=e(1),o=e(19),s=e(31),a=e(68),i=e(100),u=e(46);n({target:"Promise",stat:!0},{allSettled:function(c){var d=this,m=a.f(d),v=m.resolve,g=m.reject,b=i(function(){var T=s(d.resolve),k=[],y=0,A=1;u(c,function(V){var he=y++,ae=!1;A++,o(T,d,V).then(function(Ne){ae||(ae=!0,k[he]={status:"fulfilled",value:Ne},--A||v(k))},function(Ne){ae||(ae=!0,k[he]={status:"rejected",reason:Ne},--A||v(k))})}),--A||v(k)});return b.error&&g(b.value),m.promise}})},function(t,r,e){var n=e(1),o=e(19),s=e(31),a=e(33),i=e(68),u=e(100),c=e(46);n({target:"Promise",stat:!0},{any:function(d){var m=this,v=a("AggregateError"),g=i.f(m),b=g.resolve,T=g.reject,k=u(function(){var y=s(m.resolve),A=[],V=0,he=1,ae=!1;c(d,function(Ne){var _e=V++,Ce=!1;he++,o(y,m,Ne).then(function(re){Ce||ae||(ae=!0,b(re))},function(re){Ce||ae||(Ce=!0,A[_e]=re,--he||T(new v(A,"No one promise resolved")))})}),--he||T(new v(A,"No one promise resolved"))});return k.error&&T(k.value),g.promise}})},function(t,r,e){var n=e(410);t.exports=n},function(t,r,e){var n=e(25).default,o=e(412);t.exports=function(s){var a=o(s,"string");return n(a)==="symbol"?a:String(a)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(420);t.exports=n},function(t,r,e){var n=e(78),o=TypeError;t.exports=function(s,a){if(!delete s[a])throw o("Cannot delete property "+n(a)+" of "+n(s))}},function(t,r,e){e(455),e(457)},function(t,r,e){var n,o=e(14),s=e(76),a=e(16),i=e(456),u=e(64),c=e(98),d=e(239),m=o.Function,v=/MSIE .\./.test(u)||i&&((n=o.Bun.version.split(".")).length<3||n[0]==0&&(n[1]<3||n[1]==3&&n[2]==0));t.exports=function(g,b){var T=b?2:1;return v?function(k,y){var A=d(arguments.length,1)>T,V=a(k)?k:m(k),he=A?c(arguments,T):[],ae=A?function(){s(V,this,he)}:V;return b?g(ae,y):g(ae)}:g}},function(t,r,e){var n=e(475);t.exports=n},function(t,r){t.exports=function e(n,o){var s,a,i=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,u=/(^[ ]*|[ ]*$)/g,c=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,d=/^0x[0-9a-f]+$/i,m=/^0/,v=function(ae){return e.insensitive&&(""+ae).toLowerCase()||""+ae},g=v(n).replace(u,"")||"",b=v(o).replace(u,"")||"",T=g.replace(i,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),k=b.replace(i,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),y=parseInt(g.match(d),16)||T.length!==1&&g.match(c)&&Date.parse(g),A=parseInt(b.match(d),16)||y&&b.match(c)&&Date.parse(b)||null;if(A){if(y<A)return-1;if(y>A)return 1}for(var V=0,he=Math.max(T.length,k.length);V<he;V++){if(s=!(T[V]||"").match(m)&&parseFloat(T[V])||T[V]||0,a=!(k[V]||"").match(m)&&parseFloat(k[V])||k[V]||0,isNaN(s)!==isNaN(a))return isNaN(s)?1:-1;if(typeof s!=typeof a&&(s+="",a+=""),s<a)return-1;if(s>a)return 1}return 0}},function(t,r,e){var n=e(119),o=e(88);t.exports=function(s){if(!o(s))return!1;var a=n(s);return a=="[object Function]"||a=="[object GeneratorFunction]"||a=="[object AsyncFunction]"||a=="[object Proxy]"}},function(t,r,e){(function(n){var o=typeof n=="object"&&n&&n.Object===Object&&n;t.exports=o}).call(this,e(56))},function(t,r){var e=Function.prototype.toString;t.exports=function(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}},function(t,r,e){var n=e(505),o=e(512),s=e(514),a=e(515),i=e(516);function u(c){var d=-1,m=c==null?0:c.length;for(this.clear();++d<m;){var v=c[d];this.set(v[0],v[1])}}u.prototype.clear=n,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=a,u.prototype.set=i,t.exports=u},function(t,r,e){var n=e(260),o=e(198),s=Object.prototype.hasOwnProperty;t.exports=function(a,i,u){var c=a[i];s.call(a,i)&&o(c,u)&&(u!==void 0||i in a)||n(a,i,u)}},function(t,r,e){var n=e(518);t.exports=function(o,s,a){s=="__proto__"&&n?n(o,s,{configurable:!0,enumerable:!0,value:a,writable:!0}):o[s]=a}},function(t,r,e){var n=e(520),o=e(521),s=e(174),a=e(262),i=e(300),u=e(524),c=Object.prototype.hasOwnProperty;t.exports=function(d,m){var v=s(d),g=!v&&o(d),b=!v&&!g&&a(d),T=!v&&!g&&!b&&u(d),k=v||g||b||T,y=k?n(d.length,String):[],A=y.length;for(var V in d)!m&&!c.call(d,V)||k&&(V=="length"||b&&(V=="offset"||V=="parent")||T&&(V=="buffer"||V=="byteLength"||V=="byteOffset")||i(V,A))||y.push(V);return y}},function(t,r,e){(function(n){var o=e(50),s=e(523),a=r&&!r.nodeType&&r,i=a&&typeof n=="object"&&n&&!n.nodeType&&n,u=i&&i.exports===a?o.Buffer:void 0,c=(u?u.isBuffer:void 0)||s;n.exports=c}).call(this,e(145)(t))},function(t,r){t.exports=function(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=9007199254740991}},function(t,r){t.exports=function(e,n){return function(o){return e(n(o))}}},function(t,r){t.exports=function(){return[]}},function(t,r,e){var n=e(267),o=e(268),s=e(179),a=e(265),i=Object.getOwnPropertySymbols?function(u){for(var c=[];u;)n(c,s(u)),u=o(u);return c}:a;t.exports=i},function(t,r){t.exports=function(e,n){for(var o=-1,s=n.length,a=e.length;++o<s;)e[a+o]=n[o];return e}},function(t,r,e){var n=e(264)(Object.getPrototypeOf,Object);t.exports=n},function(t,r,e){var n=e(267),o=e(174);t.exports=function(s,a,i){var u=a(s);return o(s)?u:n(u,i(s))}},function(t,r,e){var n=e(83)(e(50),"Set");t.exports=n},function(t,r,e){var n=e(567);t.exports=n},function(t,r,e){var n=e(11),o=e(31),s=e(28),a=e(29),i=e(98),u=e(107),c=Function,d=n([].concat),m=n([].join),v={},g=function(b,T,k){if(!a(v,T)){for(var y=[],A=0;A<T;A++)y[A]="a["+A+"]";v[T]=c("C,a","return new C("+m(y,",")+")")}return v[T](b,k)};t.exports=u?c.bind:function(b){var T=o(this),k=T.prototype,y=i(arguments,1),A=function(){var V=d(y,i(arguments));return this instanceof A?g(T,V.length,V):T.apply(b,V)};return s(k)&&(A.prototype=k),A}},function(t,r,e){var n=e(87),o=e(6),s=e(69),a=e(123),i=e(10),u=e(54),c=u.getGlobal(),d={},m=c.name||"_parent",v=[],g=[];d.addMsgListener=function(Ne){v.push(Ne)};var b,T,k,y,A=(b=/^([\w]+?:\/\/.*?(?=\/|$))/i,function(Ne){return Ne=Ne||"",b.test(Ne)?RegExp.$1:"*"}),V=function(){var Ne,_e,Ce=n(Ne=unescape(c.name||"")).call(Ne);if(Ce&&o(Ce).call(Ce,"MSG|")===0){c.name="";var re=u.string2object(Ce.replace("MSG|",""),"|"),ue=(re.origin||"").toLowerCase();ue&&ue!=="*"&&o(_e=location.href.toLowerCase()).call(_e,ue)!==0||function(ze){for(var le=0,de=v.length;le<de;le++)try{v[le].call(null,ze)}catch{}}({data:JSON.parse(re.data||"null"),source:c.frames[re.self]||re.self,origin:A(re.ref||(typeof document>"u"?"":document.referrer))})}},he=(k=function(Ne,_e){for(var Ce=0,re=Ne.length;Ce<re;Ce++)if(Ne[Ce]===_e)return!0;return!1},function(){if(g.length){T=[];for(var Ne,_e=g.length-1;_e>=0;_e--)Ne=g[_e],k(T,Ne.w)||(T.push(Ne.w),s(g).call(g,_e,1),Ne.w.name=Ne.d);T=null}}),ae=d.startTimer=(y=!1,function(){y||(y=!0,c.postMessage||(a(he,100),a(V,20)))});d.postMessage=function(Ne){var _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(u.fillUndef(_e,{origin:"*",source:m}),c.postMessage){var Ce=_e.data;c.FormData||(Ce=i(Ce)),Ne.postMessage(Ce,_e.origin)}else{if(ae(),u.isObject(_e)){var re={};re.origin=_e.origin||"",re.ref=location.href,re.self=_e.source,re.data=i(_e.data),_e="MSG|"+u.object2string(re,"|",!0)}g.unshift({w:Ne,d:escape(_e)})}},t.exports=d},function(t,r,e){var n=e(589);t.exports=n},function(t,r,e){var n=e(0),o={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},s={genResponseBody:function(a){return o[a=a||"file"]},parseResponse:function(a,i){n.notundef(a.size)&&(a.size=+a.size),n.notundef(a.w)&&(a.w=+a.w),n.notundef(a.h)&&(a.h=+a.h),n.notundef(a.dur)&&(a.dur=+a.dur);var u=a.orientation;if(n.notundef(u)&&(delete a.orientation,i&&(u==="right, top"||u==="left, bottom"))){var c=a.w;a.w=a.h,a.h=c}return a}};t.exports=s},function(t,r,e){var n=e(120),o=e(15),s=e(6),a=e(57),i=e(26),u=["Code","code","Message","message"],c=e(13),d=e(0),m=e(40),v=e(605),g=e(606),b=e(105),T=b.EMResourceUploadWay,k=b.EMExceptionState,y=e(183).abort,A=d.supportFormData;function V(ae,Ne){var _e=this,Ce=ae.uploadprogress,re=ae.uploaddone,ue=ae.beginupload;return{beginupload:typeof ue=="function"?function(ze){try{ue(ze,Ne)}catch(le){_e.logger.error("Upload::options.beginupload execute error",le)}}:function(){},uploadprogress:typeof Ce=="function"?function(ze){_e.reporterHook.emit("reporter/uploadUpdate",{transferred_size:ze.loaded});try{Ce(ze,Ne)}catch(le){_e.logger.error("Upload::options.uploadprogress execute error",le)}}:function(ze){_e.reporterHook.emit("reporter/uploadUpdate",{transferred_size:ze.loaded})},uploaddone:function(ze,le){ze?_e.reporterHook.emit("reporter/uploadEnd",ze.code==="RequestAbortedError"||ze.code==="abort"?k.kCanceled:k.kFailed):_e.reporterHook.emit("reporter/uploadEnd",k.kSucceed);try{re(ze,le,null,Ne)}catch(de){_e.logger.error("Upload::options.uploaddone execute error",de)}}}}function he(ae,Ne,_e){var Ce=this;Ce.options=d.copy(ae),ae=Ce.options,d.verifyOptions(ae,"url fileName"),d.verifyParamPresentJustOne(ae,"blob fileInput"),d.verifyCallback(ae,"beginupload uploadprogress uploaddone"),Ce.reporterHook=Ne.reporterHook,Ce.logger=Ne.logger,Ce.message=_e;var re=V.call(this,ae,_e),ue=re.beginupload,ze=re.uploadprogress,le=re.uploaddone;Ce.options.beginupload=ue,Ce.options.uploadprogress=ze,Ce.options.uploaddone=le,ae.fileInput&&(ae.fileInput=d.verifyFileInput(ae.fileInput)),ae.type&&d.verifyFileType(ae.type),ae.timeout?d.verifyParamType("timeout",ae.timeout,"number"):ae.timeout=6e5,d.verifyFileUploadCallback(ae),ae.data={},ae.params&&d.merge(ae.data,ae.params);var de,Ie,ie=ae.fileName,Ve=ae.fileInput;if(A){if(Ve){if(!(Ie=ae.type?d.filterFiles(Ve.files,ae.type):o([]).call(Ve.files,0))||!Ie.length)return void ae.uploaddone(m.newWrongFileTypeError("未读取到"+ae.type+"类型的文件, 请确保文件选择节点的文件不为空, 并且请确保选择了"+ae.type+"类型的文件"));ae.data[ie]=Ie[0],de=Ve.files[0].size}else if(ae.blob){var Ue;if(ae.data[ie]=ae.blob,ae.type!=="file"&&ae.blob.type&&s(Ue=ae.blob.type).call(Ue,ae.type)===-1)return void ae.uploaddone(m.newWrongFileTypeError("未读取到"+ae.type+"类型的文件, 请确保选择了"+ae.type+"类型的文件"));de=ae.blob.size}if(Ce.reporterHook.emit("reporter/uploadUpdate",{full_size:de}),ae.maxSize&&de>ae.maxSize)return void ae.uploaddone(m.newFileTooLargeError("上传文件大小超过".concat(ae.maxSize,"限制")))}function Dt(){if(Ce.logger.info("Upload:enter aws upload"),de){if(de>c.chunkMaxSize)ae.uploaddone(m.newFileTooLargeError("直传文件大小超过".concat(c.commonMaxSize,"限制")));else if(ae.s3Policy&&ae.s3Policy.uploadConfig&&ae.s3Policy.uploadConfig.retryPolicy){var fr=ae.s3Policy.uploadConfig.retryPolicy,sr={accessKeyId:ae.mixStoreToken.accessKeyId,secretAccessKey:ae.mixStoreToken.secretAccessKey,sessionToken:ae.mixStoreToken.sessionToken,region:ae.mixStoreToken.region,maxRetries:fr.retry},hr=new ae.s3;hr.config.update(sr);var Fe=Ce.reporterHook.getNTPTime();hr.config.systemClockOffset=Fe-a();var or=decodeURIComponent(ae.mixStoreToken.bucket),ir=decodeURIComponent(ae.mixStoreToken.objectName),$e=ae.data[ie],er=hr.upload({Bucket:or,Key:ir,Body:$e,Metadata:{token:ae.mixStoreToken.token},ContentType:$e.type||"application/octet-stream"});er.on("httpUploadProgress",function(nr){var Pt=Math.floor(1e4*nr.loaded/nr.total)/100,rr={docId:ae.docId,total:nr.total,loaded:nr.loaded,percentage:Pt,percentageText:Pt+"%"};ae.fileInput&&(rr.fileInput=ae.fileInput),ae.blob&&(rr.blob=ae.blob),ae.uploadprogress(rr)}),er.send(function(nr,Pt){if(ae.errorHook({bucket:or,object:ir},{provider:"s3"}),ae.docId&&(Pt.docId=ae.docId),nr&&nr.code==="RequestAbortedError")Ce.logger.error("uploadFile:","api::s3:upload file abort",nr),Ce.onError(nr);else if(nr){var rr;ae.logger.error("error:","api::s3:upload file failed",nr);var kt=ae.providers[(s(rr=ae.providers).call(rr,ae.curProvider)+1)%ae.providers.length];fr.retryNext&&kt?(Ce.addCircuitTimer(ae,kt),kt===1&&ae.getMixStoreToken(1,function(cr){ae.mixStoreToken=cr,tr()})):Ce.onError(Pt),ae.errorHook(nr,{provider:"s3"})}else{var Et=Ce.options.s3Policy.cdnSchema;Et=(Et=Et.replace("{cdnDomain}",Ce.options.s3Policy.dlcdn)).replace("{objectName}",Pt.Key),ae.uploaddone(null,{size:$e.size,name:$e.name,url:Et,ext:$e.name.split(".")[1]||"unknown",_url_safe:ae.mixStoreToken.shortUrl,isS3:!0}),ae.logger.info("s3 Upload done: fileObj is",{size:$e.size,name:$e.name,url:Et,ext:$e.name.split(".")[1]||"unknown",_url_safe:ae.mixStoreToken.shortUrl,isS3:!0})}}),typeof ae.beginupload=="function"&&ae.beginupload(er)}}else ae.uploaddone(m.newFileTooLargeError("Browser version is too low"))}function tr(){if(Ce.logger.info("Upload:enter nos upload"),de&&!ae.commonUpload)return Ce.logger.info("Upload:use chunk upload, url ".concat(ae.url)),de>c.chunkMaxSize?void ae.uploaddone(m.newFileTooLargeError("直传文件大小超过".concat(c.chunkMaxSize,"限制"))):void(Ce.sn=g(ae,ie,Ce,-1));if(Ce.logger.info("Upload:use common upload, url ".concat(ae.url)),de&&de>c.commonMaxSize)ae.uploaddone(m.newFileTooLargeError("普通上传文件大小超过".concat(c.commonMaxSize,"限制")));else{de||(d.dataset(Ve,"name",ie),ae.data.input=Ve);var fr={data:ae.data,onaftersend:function(){ae.beginupload(Ce,Ce.message)},onuploading:function(sr){var hr=Math.floor(1e4*sr.loaded/sr.total)/100,Fe={docId:ae.docId,total:sr.total,loaded:sr.loaded,percentage:hr,percentageText:hr+"%"};ae.fileInput&&(Fe.fileInput=ae.fileInput),ae.blob&&(Fe.blob=ae.blob),ae.uploadprogress(Fe)},onload:function(sr){var hr;if(ae.docId&&(sr.docId=ae.docId),!sr.Error)return ae.uploaddone(null,sr),void ae.logger.info("nos Upload done: fileObj is",sr);if(ae.mixEnable&&ae.curProvider===1){var Fe=ae.nosPolicy.uploadConfig.retryPolicy,or=ae.providers[(s(hr=ae.providers).call(hr,ae.curProvider)+1)%ae.providers.length];Fe.retryNext&&or?(Ce.addCircuitTimer(ae,or),or===2&&ae.getMixStoreToken(2,function(ir){ae.mixStoreToken=ir,Dt()})):Ce.onError(sr)}else Ce.onError(sr)},onerror:function(sr){var hr;if(ae.mixEnable&&ae.curProvider===1){var Fe,or=ae.nosPolicy.uploadConfig.retryPolicy,ir=ae.providers[(s(Fe=ae.providers).call(Fe,ae.curProvider)+1)%ae.providers.length];if(or.retryNext&&ir)Ce.addCircuitTimer(ae,ir),ir===2&&ae.getMixStoreToken(2,function($e){ae.mixStoreToken=$e,Dt()});else try{hr=sr.result?JSON.parse(sr.result):sr,Ce.onError(hr)}catch{ae.uploaddone(new m(sr.message,sr.code),Ce.options)}}else try{hr=sr.result?JSON.parse(sr.result):sr,Ce.onError(hr)}catch{ae.uploaddone(new m(sr.message,sr.code),Ce.options)}ae.errorHook(sr,{provider:"nos"})}};A||(fr.mode="iframe"),fr.putFileAtEnd=!0,Ce.sn=v(ae.url,fr)}}if(ae.mixEnable&&ae.curProvider===2){var dr=Ce.options.s3Policy.cdnSchema;dr=dr.replace("{cdnDomain}",Ce.options.s3Policy.dlcdn),Ce.reporterHook.emit("reporter/uploadUpdate",{remote_addr:dr,operation_type:T.kResourceUploadWayAWSPlugin}),Dt()}else ae.mixEnable&&ae.curProvider===1?(Ce.reporterHook.emit("reporter/uploadUpdate",{remote_addr:ae.url,operation_type:T.kResourceUploadWayNOSPlugin}),tr()):(Ce.reporterHook.emit("reporter/uploadUpdate",{remote_addr:ae.url,operation_type:T.kResourceUploadWayNOS}),tr())}he.prototype.addCircuitTimer=function(ae,Ne){var _e=this;if(ae.curProvider=Ne,ae.s3Policy&&ae.nosPolicy){var Ce=ae[ae.curProvider===1?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!Ce||Ce===0)return;_e.circuitTimer&&clearTimeout(_e.circuitTimer),_e.circuitTimer=i(function(){ae.curProvider=ae.providers[0],_e.circuitTimer=void 0},1e3*Ce)}},he.prototype.onError=function(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ne=this,_e=Ne.options,Ce=ae.Error||ae||{},re=Ce.Code,ue=Ce.code,ze=Ce.Message,le=Ce.message,de=n(Ce,u),Ie=re||ue||"unknown",ie=ze||le||"未知错误";_e.uploaddone(new m(Ie+"("+ie+")",Ie,de))},he.prototype.abort=function(){y(this.sn)},t.exports=he},function(t,r,e){t.exports=e(278)},function(t,r,e){var n=e(607);t.exports=n},function(t,r,e){var n=e(186),o=e(137),s=e(187);t.exports=function(a,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=n(i&&i.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),o(a,"prototype",{writable:!1}),i&&s(a,i)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(25).default,o=e(621);t.exports=function(s,a){if(a&&(n(a)==="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o(s)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(622)},function(t,r,e){var n=e(625);t.exports=n},function(t,r,e){var n=e(6),o=e(0),s={fromDataURL:function(a){var i,u,c=o.getGlobal();u=n(i=a.split(",")[0]).call(i,"base64")>=0?c.atob(a.split(",")[1]):c.decodeURIComponent(a.split(",")[1]);for(var d=a.split(",")[0].split(":")[1].split(";")[0],m=new Uint8Array(u.length),v=0;v<u.length;v++)m[v]=u.charCodeAt(v);return new c.Blob([m],{type:d})}};t.exports=s},function(t,r,e){var n=e(5),o=e(8),s=e(9),a=e(0),i={stripmeta:0,blur:2,quality:3,crop:4,rotate:5,thumbnail:7,interlace:9},u={0:"stripmeta",1:"type",2:"blur",3:"quality",4:"crop",5:"rotate",6:"pixel",7:"thumbnail",8:"watermark",9:"interlace",10:"tmp"};function c(d){a.verifyOptions(d,"type","image::ImageOp"),a.verifyParamValid("type",d.type,c.validTypes,"image::ImageOp"),a.merge(this,d),this.type=i[d.type]}c.validTypes=n(i),c.reverse=function(d){var m=a.copy(d);return m.type=u[m.type],m},c.reverseImageOps=function(d){return o(d).call(d,function(m){return s(c).call(c,m)})},t.exports=c},function(t,r,e){var n=e(2),o=e(5),s={1:"ROOM_CLOSE",2:"ROOM_JOIN",3:"INVITE",4:"CANCEL_INVITE",5:"REJECT",6:"ACCEPT",7:"LEAVE",8:"CONTROL"},a={1:"accid",2:"uid",3:"createTime",4:"expireTime",5:"web_uid"},i={10404:"ROOM_NOT_EXISTS",10405:"ROOM_HAS_EXISTS",10406:"ROOM_MEMBER_NOT_EXISTS",10407:"ROOM_MEMBER_HAS_EXISTS",10408:"INVITE_NOT_EXISTS",10409:"INVITE_HAS_REJECT",10410:"INVITE_HAS_ACCEPT",10201:"PEER_NIM_OFFLINE",10202:"PEER_PUSH_OFFLINE",10419:"ROOM_MEMBER_EXCEED",10420:"ROOM_MEMBER_HAS_EXISTS_OTHER_CLIENT",10417:"UID_CONFLICT"};t.exports={parseAvSignalType:function(u){return s[u]||u},parseAvSignalMember:function(u){var c,d={};return n(c=o(u)).call(c,function(m){d[a[m]]=u[m]}),d},parseAvSignalError:function(u){return u.message=i[u.code]||u.message||u,u}}},function(t,r,e){t.exports=e(650)},function(module,exports,__webpack_require__){(function(global,module){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;/*! Socket.IO.js build:0.9.11, development. Copyright(c) 2011 LearnBoost <dev@learnboost.com> MIT Licensed */function getGlobal(){return typeof window<"u"?window:typeof self<"u"?self:global!==void 0?global:{}}var root=getGlobal(),io=module.exports;root.location===void 0&&(root.location=null),root.io?module&&(module.exports=io=root.io):root.io=io,function(){(function(t,r){var e=t;e.version="0.9.11",e.protocol=1,e.transports=[],e.j=[],e.sockets={},e.connect=function(n,o){var s,a,i=e.util.parseUri(n);r&&r.location&&(i.protocol=i.protocol||r.location.protocol.slice(0,-1),i.host=i.host||(r.document?r.document.domain:r.location.hostname),i.port=i.port||r.location.port),s=e.util.uniqueUri(i);var u={host:i.ipv6uri?"["+i.host+"]":i.host,secure:i.protocol==="https",port:i.port||(i.protocol==="https"?443:80),query:i.query||""};return e.util.merge(u,o),!u["force new connection"]&&e.sockets[s]||(a=new e.Socket(u)),!u["force new connection"]&&a&&(e.sockets[s]=a),(a=a||e.sockets[s]).of(i.path.length>1?i.path:"")}})(module.exports,root),function(t,r){var e=t.util={},n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,o=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.parseUri=function(a){var i=a,u=a.indexOf("["),c=a.indexOf("]");u!=-1&&c!=-1&&(a=a.substring(0,u)+a.substring(u,c).replace(/:/g,";")+a.substring(c,a.length));for(var d=n.exec(a||""),m={},v=14;v--;)m[o[v]]=d[v]||"";return u!=-1&&c!=-1&&(m.source=i,m.host=m.host.substring(1,m.host.length-1).replace(/;/g,":"),m.authority=m.authority.replace("[","").replace("]","").replace(/;/g,":"),m.ipv6uri=!0),m},e.uniqueUri=function(a){var i=a.protocol,u=a.host,c=a.port;return"document"in r&&r.document?(u=u||document.domain,c=c||(i=="https"&&document.location.protocol!=="https:"?443:document.location.port)):(u=u||"localhost",c||i!="https"||(c=443)),(i||"http")+"://"+u+":"+(c||80)},e.query=function(a,i){var u=e.chunkQuery(a||""),c=[];for(var d in e.merge(u,e.chunkQuery(i||"")),u)u.hasOwnProperty(d)&&c.push(d+"="+u[d]);return c.length?"?"+c.join("&"):""},e.chunkQuery=function(a){for(var i,u={},c=a.split("&"),d=0,m=c.length;d<m;++d)(i=c[d].split("="))[0]&&(u[i[0]]=i[1]);return u};var s=!1;e.load=function(a){if(typeof document<"u"&&document&&document.readyState==="complete"||s)return a();e.on(r,"load",a,!1)},e.on=function(a,i,u,c){a.attachEvent?a.attachEvent("on"+i,u):a.addEventListener&&a.addEventListener(i,u,c)},e.request=function(a){if(a&&typeof XDomainRequest<"u"&&!e.ua.hasCORS)return new XDomainRequest;if(typeof XMLHttpRequest<"u"&&(!a||e.ua.hasCORS))return new XMLHttpRequest;if(!a)try{return new root[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}return null},root!==void 0&&e.load(function(){s=!0}),e.defer=function(a){if(!e.ua.webkit||typeof importScripts<"u")return a();e.load(function(){setTimeout(a,100)})},e.merge=function(a,i,u,c){var d,m=c||[],v=u===void 0?2:u;for(d in i)i.hasOwnProperty(d)&&e.indexOf(m,d)<0&&(typeof a[d]=="object"&&v?e.merge(a[d],i[d],v-1,m):(a[d]=i[d],m.push(i[d])));return a},e.mixin=function(a,i){e.merge(a.prototype,i.prototype)},e.inherit=function(a,i){function u(){}u.prototype=i.prototype,a.prototype=new u},e.isArray=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},e.intersect=function(a,i){for(var u=[],c=a.length>i.length?a:i,d=a.length>i.length?i:a,m=0,v=d.length;m<v;m++)~e.indexOf(c,d[m])&&u.push(d[m]);return u},e.indexOf=function(a,i,u){var c=a.length;for(u=u<0?u+c<0?0:u+c:u||0;u<c&&a[u]!==i;u++);return c<=u?-1:u},e.toArray=function(a){for(var i=[],u=0,c=a.length;u<c;u++)i.push(a[u]);return i},e.ua={},e.ua.hasCORS=typeof XMLHttpRequest<"u"&&function(){try{var a=new XMLHttpRequest}catch{return!1}return a.withCredentials!=null}(),e.ua.webkit=typeof navigator<"u"&&/webkit/i.test(navigator.userAgent),e.ua.iDevice=typeof navigator<"u"&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}(io!==void 0?io:module.exports,root),function(t,r){function e(){}t.EventEmitter=e,e.prototype.on=function(n,o){return this.$events||(this.$events={}),this.$events[n]?r.util.isArray(this.$events[n])?this.$events[n].push(o):this.$events[n]=[this.$events[n],o]:this.$events[n]=o,this},e.prototype.addListener=e.prototype.on,e.prototype.once=function(n,o){var s=this;function a(){s.removeListener(n,a),o.apply(this,arguments)}return a.listener=o,this.on(n,a),this},e.prototype.removeListener=function(n,o){if(this.$events&&this.$events[n]){var s=this.$events[n];if(r.util.isArray(s)){for(var a=-1,i=0,u=s.length;i<u;i++)if(s[i]===o||s[i].listener&&s[i].listener===o){a=i;break}if(a<0)return this;s.splice(a,1),s.length||delete this.$events[n]}else(s===o||s.listener&&s.listener===o)&&delete this.$events[n]}return this},e.prototype.removeAllListeners=function(n){return n===void 0?(this.$events={},this):(this.$events&&this.$events[n]&&(this.$events[n]=null),this)},e.prototype.removeAllListenersX=function(n){if(n===void 0)return this.$events={},this;for(let o in this.$events)o!==n&&(this.$events[o]=null);return this},e.prototype.listeners=function(n){return this.$events||(this.$events={}),this.$events[n]||(this.$events[n]=[]),r.util.isArray(this.$events[n])||(this.$events[n]=[this.$events[n]]),this.$events[n]},e.prototype.emit=function(n){if(!this.$events)return!1;var o=this.$events[n];if(!o)return!1;var s=Array.prototype.slice.call(arguments,1);if(typeof o=="function")o.apply(this,s);else{if(!r.util.isArray(o))return!1;for(var a=o.slice(),i=0,u=a.length;i<u;i++)a[i].apply(this,s)}return!0}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(exports,nativeJSON){if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={};function f(t){return t<10?"0"+t:t}function date(t,r){return isFinite(t.valueOf())?t.getUTCFullYear()+"-"+f(t.getUTCMonth()+1)+"-"+f(t.getUTCDate())+"T"+f(t.getUTCHours())+":"+f(t.getUTCMinutes())+":"+f(t.getUTCSeconds())+"Z":null}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(r){var e=meta[r];return typeof e=="string"?e:"\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,r){var e,n,o,s,a,i=gap,u=r[t];switch(u instanceof Date&&(u=date(t)),typeof rep=="function"&&(u=rep.call(r,t,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=indent,a=[],Object.prototype.toString.apply(u)==="[object Array]"){for(s=u.length,e=0;e<s;e+=1)a[e]=str(e,u)||"null";return o=a.length===0?"[]":gap?`[
`+gap+a.join(`,
`+gap)+`
`+i+"]":"["+a.join(",")+"]",gap=i,o}if(rep&&typeof rep=="object")for(s=rep.length,e=0;e<s;e+=1)typeof rep[e]=="string"&&(o=str(n=rep[e],u))&&a.push(quote(n)+(gap?": ":":")+o);else for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(o=str(n,u))&&a.push(quote(n)+(gap?": ":":")+o);return o=a.length===0?"{}":gap?`{
`+gap+a.join(`,
`+gap)+`
`+i+"}":"{"+a.join(",")+"}",gap=i,o}}JSON.stringify=function(t,r,e){var n;if(gap="",indent="",typeof e=="number")for(n=0;n<e;n+=1)indent+=" ";else typeof e=="string"&&(indent=e);if(rep=r,r&&typeof r!="function"&&(typeof r!="object"||typeof r.length!="number"))throw new Error("socket.io:: replacer cannot JSON.stringify");return str("",{"":t})},JSON.parse=function(text,reviver){var j;function walk(t,r){var e,n,o=t[r];if(o&&typeof o=="object")for(e in o)Object.prototype.hasOwnProperty.call(o,e)&&((n=walk(o,e))!==void 0?o[e]=n:delete o[e]);return reviver.call(t,r,o)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("socket.io:: reviver cannot JSON.parse")}}(io!==void 0?io:module.exports,typeof JSON<"u"?JSON:void 0),function(t,r){var e=t.parser={},n=e.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],o=e.reasons=["transport not supported","client not handshaken","unauthorized"],s=e.advice=["reconnect"],a=r.JSON,i=r.util.indexOf;e.encodePacket=function(c){var d=i(n,c.type),m=c.id||"",v=c.endpoint||"",g=c.ack,b=null;switch(c.type){case"error":var T=c.reason?i(o,c.reason):"",k=c.advice?i(s,c.advice):"";T===""&&k===""||(b=T+(k!==""?"+"+k:""));break;case"message":c.data!==""&&(b=c.data);break;case"event":var y={name:c.name};c.args&&c.args.length&&(y.args=c.args),b=a.stringify(y);break;case"json":b=a.stringify(c.data);break;case"connect":c.qs&&(b=c.qs);break;case"ack":b=c.ackId+(c.args&&c.args.length?"+"+a.stringify(c.args):"")}var A=[d,m+(g=="data"?"+":""),v];return b!=null&&A.push(b),A.join(":")},e.encodePayload=function(c){var d="";if(c.length==1)return c[0];for(var m=0,v=c.length;m<v;m++)d+="�"+c[m].length+"�"+c[m];return d};var u=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;e.decodePacket=function(c){if(!(v=c.match(u)))return{};var d=v[2]||"",m=(c=v[5]||"",{type:n[v[1]],endpoint:v[4]||""});switch(d&&(m.id=d,v[3]?m.ack="data":m.ack=!0),m.type){case"error":var v=c.split("+");m.reason=o[v[0]]||"",m.advice=s[v[1]]||"";break;case"message":m.data=c||"";break;case"event":try{var g=a.parse(c);m.name=g.name,m.args=g.args}catch{}m.args=m.args||[];break;case"json":try{m.data=a.parse(c)}catch{}break;case"connect":m.qs=c||"";break;case"ack":if((v=c.match(/^([0-9]+)(\+)?(.*)/))&&(m.ackId=v[1],m.args=[],v[3]))try{m.args=v[3]?a.parse(v[3]):[]}catch{}}return m},e.decodePayload=function(c){var d=function(k,y){for(var A=0,V=k;V<y.length;V++){if(y.charAt(V)=="�")return A;A++}return A};if(c.charAt(0)=="�"){for(var m=[],v=1,g="";v<c.length;v++)if(c.charAt(v)=="�"){var b=c.substr(v+1).substr(0,g);if(c.charAt(v+1+Number(g))!="�"&&v+1+Number(g)!=c.length){var T=Number(g);l=d(v+T+1,c),b=c.substr(v+1).substr(0,T+l),v+=l}m.push(e.decodePacket(b)),v+=Number(g)+1,g=""}else g+=c.charAt(v);return m}return[e.decodePacket(c)]}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,r){function e(n,o){this.socket=n,this.sessid=o}t.Transport=e,r.util.mixin(e,r.EventEmitter),e.prototype.heartbeats=function(){return!0},e.prototype.onData=function(n){if(this!==this.socket.transport)return this;if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),n!==""){var o=r.parser.decodePayload(n);if(o&&o.length)for(var s=0,a=o.length;s<a;s++)this.onPacket(o[s])}return this},e.prototype.onPacket=function(n){return this.socket.setHeartbeatTimeout(),n.type=="heartbeat"?this.onHeartbeat():(n.type=="connect"&&n.endpoint==""&&this.onConnect(),n.type=="error"&&n.advice=="reconnect"&&(this.isOpen=!1),this.socket.onPacket(n),this)},e.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var n=this;this.closeTimeout=setTimeout(function(){n.socket&&n.socket.publish("info","socket disconnected by setCloseTimeout"),n.onDisconnect()},this.socket.closeTimeout)}},e.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket?(this.socket.transport===this?this.socket.onDisconnect():this.socket.setBuffer(!1),this):this},e.prototype.onConnect=function(){return this.socket.onConnect(),this},e.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},e.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},e.prototype.packet=function(n){this.send(r.parser.encodePacket(n))},e.prototype.onHeartbeat=function(n){this.packet({type:"heartbeat"})},e.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},e.prototype.onClose=function(){this.socket.publish("info","transport onClose"),this.isOpen=!1,this.socket.transport===this?this.socket.onClose():this.socket.setBuffer(!1),this.onDisconnect(),this.onDisconnectDone instanceof Function&&this.onDisconnectDone(null),this.onConnectionOver instanceof Function&&this.onConnectionOver(null)},e.prototype.onDisconnectDone=function(){},e.prototype.onConnectionOver=function(){},e.prototype.prepareUrl=function(){var n=this.socket.options;return this.scheme()+"://"+n.host+":"+n.port+"/"+n.resource+"/"+r.protocol+"/"+this.name+"/"+this.sessid},e.prototype.ready=function(n,o){o.call(this)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,r,e){function n(s){if(this.options={port:80,secure:!1,document:"document"in e&&document,resource:"socket.io",transports:s.transports||r.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,needToXHR:!0,manualFlush:!1},r.util.merge(this.options,s),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||r.util.ua.hasCORS)){var a=this;r.util.on(e,"beforeunload",function(){a.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function o(){}t.Socket=n,r.util.mixin(n,r.EventEmitter),n.prototype.of=function(s){return this.namespaces[s]||(this.namespaces[s]=new r.SocketNamespace(this,s),s!==""&&this.namespaces[s].packet({type:"connect"})),this.namespaces[s]},n.prototype.publish=function(){var s;for(var a in this.emit.apply(this,arguments),this.namespaces)this.namespaces.hasOwnProperty(a)&&(s=this.of(a)).$emit.apply(s,arguments)},n.prototype.guid=function(){var s=root.crypto||root.msCrypto;if(s){var a=new Uint8Array(16);s.getRandomValues(a),a[6]&=15,a[6]|=64,a[8]&=63,a[8]|=128;for(var i="",u=0;u<a.length;u++){var c=a[u].toString(16);c.length===1&&(c="0"+c),i+=c}return i.substring(0,8)+"-"+i.substring(8,12)+"-"+i.substring(12,16)+"-"+i.substring(16,20)+"-"+i.substring(20)}},n.prototype.handshake=function(s){var a=this,i=this.options;if(!this.options.needToXHR&&this.options.transports.length===1&&this.options.transports[0]==="websocket"){var u=this.guid();if(u)return void setTimeout(function(){a.publish("info","xhr, skip and get:"+u),s.apply(null,[u,"90","60","websocket"])},0)}function c(b){b instanceof Error?(a.connecting=!1,a.publish("info","xhr, status:200, but got error:",b),a.onError("xhr, status:200, but got error:"+b.message,b)):s.apply(null,b.split(":"))}var d=["http"+(i.secure?"s":"")+":/",i.host+":"+i.port,i.resource,r.protocol,r.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!r.util.ua.hasCORS&&typeof document<"u"&&document){var m=document.getElementsByTagName("script")[0],v=document.createElement("script");v.src=d+"&jsonp="+r.j.length,v.onreadystatechange=function(){this.readyState=="loaded"&&v.parentNode&&(v.parentNode.removeChild(v),a.connecting=!1,a.publish("info","xhr, jsonp:Server down or port not open"),!a.reconnecting&&a.onError("Server down or port not open",new Error("xhr, jsonp:server down or port not open")),a.publish("handshake_failed"))},m.parentNode.insertBefore(v,m),r.j.push(function(b){c(b),v.parentNode.removeChild(v)})}else{var g=r.util.request();g.open("GET",d,!0),g.timeout=8e3,this.isXDomain()&&(g.withCredentials=!0),g.onreadystatechange=function(){a.publish("info","xhr, readyState:"+g.readyState+" status:"+g.status),g.readyState==4&&(a.publish("info","xhr, responseText:"+g.responseText),g.onreadystatechange=o,g.status==200?c(g.responseText):g.status==403?(a.connecting=!1,a.onError(g.responseText,new Error("xhr, status:403"+g.responseText)),a.publish("handshake_failed")):(a.connecting=!1,!a.reconnecting&&a.onError(g.responseText,new Error("xhr, status:"+g.status+" "+g.responseText)),a.publish("handshake_failed")))},g.ontimeout=function(b){a.publish("info","xhr, timeout"),a.connecting=!1,!a.reconnecting&&a.onError(g.responseText,new Error("xhr, timeout")),a.publish("handshake_failed")},g.send(null)}},n.prototype.connect=function(s){if(this.connecting)return this;var a=this;return a.connecting=!0,this.handshake(function(i,u,c,d){a.publish("info","SocketIO handshake parameter: sid: "+i+", transports: "+d+", close: "+c+", heartbeat: "+u),a.sessionid=i,a.closeTimeout=1e3*c,a.heartbeatTimeout=1e3*u,a.transports||(a.transports=a.origTransports=d?r.util.intersect(d.split(","),a.options.transports):a.options.transports),a.setHeartbeatTimeout(),a.once("connect",function(){a.publish("info","tcp, clear connect timeout due to recv connect event"),clearTimeout(a.connectTimeoutTimer),a.connectTimeoutTimer=null,s&&typeof s=="function"&&s()}),a.doConnect()}),this},n.prototype.doConnect=function(){var s=this;if(s.transport&&s.transport.clearTimeouts(),s.transport=s.getTransport(s.transports),!s.transport)return s.publish("connect_failed");s.transport.ready(s,function(){s.connecting=!0,s.publish("info","tcp, connecting, transport ready in "+s.transport.name),s.publish("connecting",s.transport.name),s.transport.open(),s.options["connect timeout"]&&(s.connectTimeoutTimer&&clearTimeout(s.connectTimeoutTimer),s.publish("info","set new connect timeout"),s.connectTimeoutTimer=setTimeout(function(){s.publish("info","trigger connect timeout due to setTimeout"),s.transport.close(),s.tryNextTransport()},s.options["connect timeout"]))})},n.prototype.getTransport=function(s){const a=this;for(var i,u=s||this.transports,c=0;i=u[c];c++)if(a.publish("info","check transport: "+i),r.Transport[i]&&r.Transport[i].check(this)&&(!this.isXDomain()||r.Transport[i].xdomainCheck(this)))return a.publish("info","use transport: "+i),new r.Transport[i](this,this.sessionid);return null},n.prototype.tryNextTransport=function(){if(!this.connected&&(this.connecting=!1,this.options["try multiple transports"])){for(var s=this.transports;s.length>0&&s.splice(0,1)[0]!=this.transport.name;);s.length?this.doConnect():this.publish("connect_failed")}},n.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var s=this;this.heartbeatTimeoutTimer=setTimeout(function(){s.transport&&(s.publish("info","transport closed by setHeartbeatTimeout"),s.transport.onClose())},this.heartbeatTimeout)}},n.prototype.packet=function(s){return this.connected&&!this.doBuffer?this.transport.packet(s):this.buffer.push(s),this},n.prototype.setBuffer=function(s){this.doBuffer=s,!s&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},n.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},n.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.publish("info","socket disconnected by IM SDK"),this.onDisconnect("booted")),this},n.prototype.disconnectSync=function(){var s=r.util.request(),a=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,r.protocol,"",this.sessionid].join("/")+"/?disconnect=1";s.open("GET",a,!1),s.send(null),this.publish("info","socket disconnected by disconnectSync before page unload"),this.onDisconnect("booted")},n.prototype.isXDomain=function(){var s=e&&e.location||{},a=s.port||(s.protocol=="https:"?443:80);return this.options.host!==s.hostname||this.options.port!=a},n.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},n.prototype.onOpen=function(){this.publish("info","tcp, websocket onOpen"),this.open=!0},n.prototype.onClose=function(){this.publish("info","tcp, websocket onClose"),this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},n.prototype.onPacket=function(s){this.of(s.endpoint).onPacket(s)},n.prototype.onError=function(s,a){s&&s.advice&&s.advice==="reconnect"&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",s&&s.reason?s.reason:s,a)},n.prototype.onDisconnect=function(s){var a=this.connected,i=this.connecting;this.publish("info",s?"tcp, onDisconnect reason:"+s:"tcp, onDisconnect"),this.connected=!1,this.connecting=!1,this.open=!1,(a||i)&&this.transport&&(this.transport.close(),this.transport.clearTimeouts(),a&&(this.publish("disconnect",s),s!="booted"&&this.options.reconnect&&!this.reconnecting&&this.reconnect()),i&&(this.connectTimeoutTimer&&(this.publish("info","clear connect timeout due to onDisconnect"),clearTimeout(this.connectTimeoutTimer)),this.tryNextTransport()))},n.prototype.reconnect=function(){this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var s=this,a=this.options["max reconnection attempts"],i=this.options["try multiple transports"],u=this.options["reconnection limit"];function c(){if(s.connected){for(var m in s.namespaces)s.namespaces.hasOwnProperty(m)&&m!==""&&s.namespaces[m].packet({type:"connect"});s.publish("reconnect",s.transport.name,s.reconnectionAttempts)}clearTimeout(s.reconnectionTimer),s.removeListener("connect_failed",d),s.removeListener("connect",d),s.reconnecting=!1,delete s.reconnectionAttempts,delete s.reconnectionDelay,delete s.reconnectionTimer,delete s.redoTransports,s.options["try multiple transports"]=i}function d(){if(s.reconnecting)return s.connected?c():s.connecting&&s.reconnecting?s.reconnectionTimer=setTimeout(d,1e3):void(s.reconnectionAttempts++>=a?s.redoTransports?(s.publish("reconnect_failed"),c()):(s.on("connect_failed",d),s.options["try multiple transports"]=!0,s.transports=s.origTransports,s.transport=s.getTransport(),s.redoTransports=!0,s.connect()):(s.reconnectionDelay<u&&(s.reconnectionDelay*=2),s.connect(),s.publish("reconnecting",s.reconnectionDelay,s.reconnectionAttempts),s.reconnectionTimer=setTimeout(d,s.reconnectionDelay)))}this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(d,this.reconnectionDelay),this.on("connect",d)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports,root),function(t,r){function e(o,s){this.socket=o,this.name=s||"",this.flags={},this.json=new n(this,"json"),this.ackPackets=0,this.acks={}}function n(o,s){this.namespace=o,this.name=s}t.SocketNamespace=e,r.util.mixin(e,r.EventEmitter),e.prototype.$emit=r.EventEmitter.prototype.emit,e.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},e.prototype.packet=function(o){return o.endpoint=this.name,this.socket.packet(o),this.flags={},this},e.prototype.send=function(o,s){var a={type:this.flags.json?"json":"message",data:o};return typeof s=="function"&&(a.id=++this.ackPackets,a.ack=!0,this.acks[a.id]=s),this.packet(a)},e.prototype.emit=function(o){var s=Array.prototype.slice.call(arguments,1),a=s[s.length-1],i={type:"event",name:o};return typeof a=="function"&&(i.id=++this.ackPackets,i.ack="data",this.acks[i.id]=a,s=s.slice(0,s.length-1)),i.args=s,this.packet(i)},e.prototype.disconnect=function(){return this.name===""?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},e.prototype.onPacket=function(o){var s=this;function a(){s.packet({type:"ack",args:r.util.toArray(arguments),ackId:o.id})}switch(o.type){case"connect":this.$emit("connect");break;case"disconnect":this.name===""?(this.socket.publish("info","socket disconnected by SocketNameSpace.onPacket"),this.socket.onDisconnect(o.reason||"booted")):this.$emit("disconnect",o.reason);break;case"message":case"json":var i=["message",o.data];o.ack=="data"?i.push(a):o.ack&&this.packet({type:"ack",ackId:o.id}),this.$emit.apply(this,i);break;case"event":i=[o.name].concat(o.args),o.ack=="data"&&i.push(a),this.$emit.apply(this,i);break;case"ack":this.acks[o.ackId]&&(this.acks[o.ackId].apply(this,o.args),delete this.acks[o.ackId]);break;case"error":this.socket.publish("info","packet, type:error",o),o.advice?this.socket.onError(o,new Error("packet, type:error and advice is "+o.advice)):o.reason==="unauthorized"?this.$emit("connect_failed",o.reason):this.$emit("error",o.reason,new Error("packet, type:error and reason is "+o.reason))}},n.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},n.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,r,e){function n(o){r.Transport.apply(this,arguments)}t.websocket=n,r.util.inherit(n,r.Transport),n.prototype.name="websocket",n.prototype.open=function(){var o,s=r.util.query(this.socket.options.query),a=this;return o||(o=e.MozWebSocket||e.WebSocket),this.websocket=new o(this.prepareUrl()+s),this.websocket.onopen=function(){a.onOpen(),a.socket.setBuffer(!1)},this.websocket.onmessage=function(i){a.onData(i.data)},this.websocket.onclose=function(){a.socket.setBuffer(!0),a.onClose()},this.websocket.onerror=function(i){var u="";i&&i.message?u=i.message:i.target&&(u=i.target.readyState?"websocket, readyState:"+i.target.readyState:"websocket event"),a.onError(u,i)},this},r.util.ua.iDevice?n.prototype.send=function(o){var s=this;return setTimeout(function(){s.websocket.send(o)},0),this}:n.prototype.send=function(o){return this.websocket.send(o),this},n.prototype.payload=function(o){for(var s=0,a=o.length;s<a;s++)this.packet(o[s]);return this},n.prototype.close=function(){return this.websocket.close(),this},n.prototype.onError=function(o,s){this.socket.publish("info","tcp, onError",o,s),this.socket.onError(o,s)},n.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},n.check=function(){return"WebSocket"in e&&!("__addTask"in WebSocket)||"MozWebSocket"in e},n.xdomainCheck=function(){return!0},r.transports.push("websocket")}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,root),function(t,r,e){function n(s){s&&(r.Transport.apply(this,arguments),this.sendBuffer=[])}function o(){}t.XHR=n,r.util.inherit(n,r.Transport),n.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},n.prototype.payload=function(s){for(var a=[],i=0,u=s.length;i<u;i++)a.push(r.parser.encodePacket(s[i]));this.send(r.parser.encodePayload(a))},n.prototype.send=function(s){return this.post(s),this},n.prototype.post=function(s){var a=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),e.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=function(){this.onload=o,a.socket.setBuffer(!1)}:this.sendXHR.onreadystatechange=function(){this.readyState==4&&(this.onreadystatechange=o,a.posting=!1,this.status==200?a.socket.setBuffer(!1):a.onClose())},this.sendXHR.send(s)},n.prototype.close=function(){return this.onClose(),this},n.prototype.request=function(s){var a=r.util.request(this.socket.isXDomain()),i=r.util.query(this.socket.options.query,"t="+ +new Date);if(a.open(s||"GET",this.prepareUrl()+i,!0),s=="POST")try{a.setRequestHeader?a.setRequestHeader("Content-type","text/plain;charset=UTF-8"):a.contentType="text/plain"}catch{}return a},n.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},n.check=function(s,a){try{var i=r.util.request(a),u=e.XDomainRequest&&i instanceof XDomainRequest,c=s&&s.options&&s.options.secure?"https:":"http:",d=e.location&&c!=e.location.protocol;if(i&&(!u||!d))return!0}catch{}return!1},n.xdomainCheck=function(s){return n.check(s,!0)}}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,root),function(t,r,e){function n(){r.Transport.XHR.apply(this,arguments)}function o(){}t["xhr-polling"]=n,r.util.inherit(n,r.Transport.XHR),r.util.merge(n,r.Transport.XHR),n.prototype.name="xhr-polling",n.prototype.heartbeats=function(){return!1},n.prototype.open=function(){return r.Transport.XHR.prototype.open.call(this),!1},n.prototype.get=function(){if(this.isOpen){var s=this;this.xhr=this.request(),e.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=function(){this.onload=o,this.onerror=o,s.retryCounter=1,s.onData(this.responseText),s.get()},this.xhr.onerror=function(){s.retryCounter++,!s.retryCounter||s.retryCounter>3?s.onClose():s.get()}):this.xhr.onreadystatechange=function(){this.readyState==4&&(this.onreadystatechange=o,this.status==200?(s.onData(this.responseText),s.get()):s.onClose())},this.xhr.send(null)}},n.prototype.onClose=function(){if(r.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=o;try{this.xhr.abort()}catch{}this.xhr=null}},n.prototype.ready=function(s,a){var i=this;r.util.defer(function(){a.call(i)})},r.transports.push("xhr-polling")}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,root),__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=(function(){return io}).apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__===void 0||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()}).call(this,__webpack_require__(56),__webpack_require__(145)(module))},function(t,r){t.exports=function(e){var n=-1,o=Array(e.size);return e.forEach(function(s){o[++n]=s}),o}},function(t,r,e){var n,o=e(24),s=e(44),a=e(13),i=e(74),u=e(685),c=e(692),d={initReporter:function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},v={app_key:m.appKey,platform:"Web",dev_id:s.deviceId,sdk_ver:a.info.version,env:"online",os_name:i.os?i.os.family:"",os_ver:i.os?i.os.version:"",model:i.version,manufactor:a.hostEnv,host_env:a.hostEnv,host_info:i.ua,host_env_ver:i.version};a.isBrowser||(m.isDataReportEnable=!1);var g=new u({isDataReportEnable:m.isDataReportEnable,reportConfigUrl:m.reportConfigUrl,reportUrl:m.reportUrl,common:v,request:c,logger:m.logger,autoStart:a.isBrowser});return g}};d.sendBeacon=navigator&&navigator.sendBeacon&&o(n=navigator.sendBeacon).call(n,navigator)||function(m,v){var g=new XMLHttpRequest;g.open("POST",m,!0),g.send(v)},t.exports=d},function(t,r,e){t.exports=e(686)},function(t,r,e){var n=e(1),o=e(14);n({global:!0,forced:o.globalThis!==o},{globalThis:o})},function(t,r,e){var n=e(1),o=e(11),s=e(112),a=e(28),i=e(29),u=e(38).f,c=e(131),d=e(164),m=e(703),v=e(127),g=e(705),b=!1,T=v("meta"),k=0,y=function(V){u(V,T,{value:{objectID:"O"+k++,weakData:{}}})},A=t.exports={enable:function(){A.enable=function(){},b=!0;var V=c.f,he=o([].splice),ae={};ae[T]=1,V(ae).length&&(c.f=function(Ne){for(var _e=V(Ne),Ce=0,re=_e.length;Ce<re;Ce++)if(_e[Ce]===T){he(_e,Ce,1);break}return _e},n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:d.f}))},fastKey:function(V,he){if(!a(V))return typeof V=="symbol"?V:(typeof V=="string"?"S":"P")+V;if(!i(V,T)){if(!m(V))return"F";if(!he)return"E";y(V)}return V[T].objectID},getWeakData:function(V,he){if(!i(V,T)){if(!m(V))return!0;if(!he)return!1;y(V)}return V[T].weakData},onFreeze:function(V){return g&&b&&m(V)&&!i(V,T)&&y(V),V}};s[T]=!0},function(t,r,e){var n=e(19),o=e(31),s=e(16),a=e(36),i=TypeError;t.exports=function(u,c){var d,m=a(this),v=o(m.get),g=o(m.has),b=o(m.set),T=arguments.length>2?arguments[2]:void 0;if(!s(c)&&!s(T))throw i("At least one callback required");return n(g,m,u)?(d=n(v,m,u),s(c)&&(d=c(d),n(b,m,u,d))):s(T)&&(d=T(),n(b,m,u,d)),d}},function(t,r,e){t.exports=e(735)},function(t,r,e){var n=e(5);e(44);function o(){}o.typeMap={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,tip:10,robot:11,g2:12,custom:100};var s=o.typeReverseMap={0:"text",1:"image",2:"audio",3:"video",4:"geo",5:"notification",6:"file",10:"tip",11:"robot",12:"g2",100:"custom"};o.validTypes=n(o.typeMap),o.setFlow=function(a,i){a.flow=a.from===i?a.to===i?"in":"out":"in",a.type==="robot"&&a.content&&a.content.msgOut&&(a.flow="in")},o.getType=function(a){var i=a.type;return s[i]||i},t.exports=o},function(t,r,e){t.exports=function(n,o,s,a){var i=self||window;try{try{var u;try{u=new i.Blob([n])}catch{(u=new(i.BlobBuilder||i.WebKitBlobBuilder||i.MozBlobBuilder||i.MSBlobBuilder)).append(n),u=u.getBlob()}var c=i.URL||i.webkitURL,d=c.createObjectURL(u),m=new i[o](d,s);return c.revokeObjectURL(d),m}catch{return new i[o]("data:application/javascript,".concat(encodeURIComponent(n)),s)}}catch{if(!a)throw Error("Inline worker is not supported");return new i[o](a,s)}}},function(t,r,e){e(313).polyfill(),e(13).isBrowser=!0},function(t,r,e){var n=e(372);t.exports=n},function(t,r,e){var n=e(466);t.exports=n},function(t,r){var e=/^(?:0|[1-9]\d*)$/;t.exports=function(n,o){var s=typeof n;return!!(o=o??9007199254740991)&&(s=="number"||s!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<o}},function(t,r,e){t.exports=e(555)},function(t,r,e){(function(n){var o,s=e(25),a=e(3),i=e(123),u=e(15),c=e(32),d=e(2),m=e(47),v=e(7),g=e(5),b=e(17);(function(T,k){var y,A=(T=T!==void 0?T:typeof self<"u"?self:n!==void 0?n:{}).IDBKeyRange||T.webkitIDBKeyRange,V="readonly",he="readwrite",ae=Object.prototype.hasOwnProperty,Ne=function(){if(!y&&!(y=T.indexedDB||T.webkitIndexedDB||T.mozIndexedDB||T.oIndexedDB||T.msIndexedDB||(T.indexedDB===null&&T.shimIndexedDB?T.shimIndexedDB:void 0)))throw"IndexedDB required";return y},_e=!1,Ce=navigator&&!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent),re=function(dr){return dr},ue=function(dr){var fr;return u(fr=Object.prototype.toString.call(dr)).call(fr,8,-1).toLowerCase()},ze=function(dr){return typeof dr=="function"},le=function(dr){return ue(dr)==="number"},de=function(dr){return ue(dr)==="array"},Ie=function(dr){return dr===void 0},ie=function(dr,fr){var sr=this,hr=!1;this.name=fr,this.getIndexedDB=function(){return dr},this.add=function(ir){if(hr)throw"Database has been closed";for(var $e=[],er=0,nr=0;nr<arguments.length-1;nr++)if(c(arguments[nr+1]))for(var Pt=0;Pt<arguments[nr+1].length;Pt++)$e[er]=arguments[nr+1][Pt],er++;else $e[er]=arguments[nr+1],er++;var rr=dr.transaction(ir,he),kt=rr.objectStore(ir);return new a(function(Et,cr){d($e).call($e,function(mr){var yr;if(mr.item&&mr.key){var Tr=mr.key;mr=mr.item,yr=kt.add(mr,Tr)}else yr=kt.add(mr);yr.onsuccess=function(Ir){var kr=Ir.target,Ar=kr.source.keyPath;Ar===null&&(Ar="__id__"),m(mr,Ar,{value:kr.result,enumerable:!0})}}),rr.oncomplete=function(){Et($e,sr)},rr.onerror=function(mr){mr.preventDefault(),cr(mr)},rr.onabort=function(mr){cr(mr)}})},this.updateAndDelete=function(ir,$e,er){if(hr)throw"Database has been closed";var nr=dr.transaction(ir,he),Pt=nr.objectStore(ir),rr=Pt.keyPath;return new a(function(kt,Et){d($e).call($e,function(cr){if(cr.item&&cr.key){var mr=cr.key;cr=cr.item,Pt.put(cr,mr)}else Pt.put(cr)}),d(er).call(er,function(cr){Pt.delete(cr[rr])}),nr.oncomplete=function(){kt([$e,er])},nr.onerror=function(cr){Et(cr)}})},this.update=function(ir){if(hr)throw"Database has been closed";for(var $e,er=[],nr=1;nr<arguments.length;nr++)c($e=arguments[nr])?er=v(er).call(er,$e):er.push($e);var Pt=dr.transaction(ir,he),rr=Pt.objectStore(ir);return rr.keyPath,new a(function(kt,Et){d(er).call(er,function(cr){var mr;if(cr.item&&cr.key){var yr=cr.key;cr=cr.item,mr=rr.put(cr,yr)}else mr=rr.put(cr);mr.onsuccess=function(Tr){},mr.onerror=function(Tr){}}),Pt.oncomplete=function(){kt(er,sr)},Pt.onerror=function(cr){Et(cr)},Pt.onabort=function(cr){Et(cr)}})},this.remove=function(ir,$e,er,nr,Pt,rr,kt){if(hr)throw"Database has been closed";var Et=dr.transaction(ir,he),cr=Et.objectStore(ir);return new a(function(mr,yr){function Tr(kr){return kr==null}var Ir;Tr(nr)&&(nr=-1/0),Tr(Pt)&&(Pt=1/0),$e===null||c($e)||($e=[$e]),Tr(er)?$e!==null?d($e).call($e,function(kr){cr.delete(kr)}):cr.delete(range=A.bound(nr,Pt,rr,kt)):(Ir=$e!==null?A.only($e[0]):A.bound(nr,Pt,rr,kt),cr.index(er).openCursor(Ir).onsuccess=function(kr){var Ar=kr.target.result;Ar&&(Ar.delete(),Ar.continue())}),Et.oncomplete=function(){mr()},Et.onerror=function(kr){yr(kr)},Et.onabort=function(kr){yr(kr)}})},this.clear=function(ir){if(hr)throw"Database has been closed";var $e=dr.transaction(ir,he);return $e.objectStore(ir).clear(),new a(function(er,nr){$e.oncomplete=function(){er()},$e.onerror=function(Pt){nr(Pt)}})},this.close=function(){hr||(dr.close(),hr=!0,delete Dt[fr])},this.get=function(ir,$e){if(hr)throw"Database has been closed";var er=dr.transaction(ir),nr=er.objectStore(ir).get($e);return new a(function(Pt,rr){nr.onsuccess=function(kt){Pt(kt.target.result)},er.onerror=function(kt){rr(kt)}})},this.query=function(ir,$e){if(hr)throw"Database has been closed";return new Ve(ir,dr,$e)},this.count=function(ir,$e){if(hr)throw"Database has been closed";dr.transaction(ir).objectStore(ir)};for(var Fe=0,or=dr.objectStoreNames.length;Fe<or;Fe++)(function(ir){for(var $e in sr[ir]={},sr)ae.call(sr,$e)&&$e!=="close"&&(sr[ir][$e]=function(er){return function(){var nr,Pt=v(nr=[ir]).call(nr,u([]).call(arguments,0));return sr[er].apply(sr,Pt)}}($e))})(dr.objectStoreNames[Fe])},Ve=function(dr,fr,sr){var hr,Fe=this,or=!1,ir=!1,$e=function(nr,Pt,rr,kt,Et,cr,mr){return new a(function(yr,Tr){var Ir=or||ir?he:V,kr=fr.transaction(dr,Ir),Ar=kr.objectStore(dr),Rr=sr?Ar.index(sr):Ar,Mn=nr?A[nr].apply(null,Pt):null,Or=[],Pr=[Mn],Nr=0;Et=Et||null,cr=cr||[],rr!=="count"&&Pr.push(kt||"next");var Wr=!!or&&g(or);Rr[rr].apply(Rr,Pr).onsuccess=function(Yr){var Ur=Yr.target.result;if(s(Ur)===s(0))Or=Ur;else if(Ur){if(Et!==null&&Et[0]>Nr)Nr=Et[0],Ur.advance(Et[0]);else if(!(Et!==null&&Nr>=Et[0]+Et[1])){var qr=!0,Yn="value"in Ur?Ur.value:Ur.key;d(cr).call(cr,function($n){$n&&$n.length&&($n.length===2?qr=qr&&Yn[$n[0]]===$n[1]:ze($n[0])&&(qr=qr&&$n[0].apply(void 0,[Yn])))}),qr&&(Nr++,Or.push(mr(Yn)),ir?Ur.delete():or&&(Yn=function($n){for(var Jr=0;Jr<Wr.length;Jr++){var Fr=Wr[Jr],Wn=or[Fr];Wn instanceof Function&&(Wn=Wn($n)),$n[Fr]=Wn}return $n}(Yn),Ur.update(Yn))),Ur.continue()}}},kr.oncomplete=function(){yr(Or)},kr.onerror=function(Yr){Tr(Yr)},kr.onabort=function(Yr){Tr(Yr)}})},er=function(nr,Pt){var rr="next",kt="openCursor",Et=[],cr=null,mr=re,yr=!1,Tr=function(){return $e(nr,Pt,kt,yr?rr+"unique":rr,cr,Et,mr)},Ir=function(){return rr=null,kt="count",{execute:Tr}},kr=function Ur(){return(cr=de(arguments[0])?arguments[0]:u(Array.prototype).call(arguments,0,2)).length==1&&cr.unshift(0),le(cr[1])||(cr=null),{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Mn,desc:Or,distinct:Pr,modify:Nr,limit:Ur,map:Wr,remove:Yr}},Ar=function Ur(qr){return(qr=!!Ie(qr)||!!qr)&&(kt="openKeyCursor"),{execute:Tr,keys:Ur,filter:Rr,asc:Mn,desc:Or,distinct:Pr,modify:Nr,limit:kr,map:Wr,remove:Yr}},Rr=function Ur(){return Et.push(u(Array.prototype).call(arguments,0,2)),{execute:Tr,count:Ir,keys:Ar,filter:Ur,asc:Mn,desc:Or,distinct:Pr,modify:Nr,limit:kr,map:Wr,remove:Yr}},Mn=function Ur(qr){return qr=!!Ie(qr)||!!qr,rr=qr?"next":"prev",{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Ur,desc:Or,distinct:Pr,modify:Nr,limit:kr,map:Wr,remove:Yr}},Or=function Ur(qr){return qr=!!Ie(qr)||!!qr,rr=qr?"prev":"next",{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Mn,desc:Ur,distinct:Pr,modify:Nr,limit:kr,map:Wr,remove:Yr}},Pr=function Ur(qr){return qr=!!Ie(qr)||!!qr,yr=qr,{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Mn,desc:Or,distinct:Ur,modify:Nr,limit:kr,map:Wr,remove:Yr}},Nr=function Ur(qr){return or=qr,{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Mn,desc:Or,distinct:Pr,modify:Ur,limit:kr,map:Wr,remove:Yr}},Wr=function Ur(qr){return ze(qr)&&(mr=qr),{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Mn,desc:Or,distinct:Pr,modify:Nr,limit:kr,map:Ur,remove:Yr}},Yr=function Ur(qr){return qr=!!Ie(qr)||!!qr,ir=qr,{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Mn,desc:Or,distinct:Pr,modify:Nr,limit:kr,map:Wr,remove:Ur}};return{execute:Tr,count:Ir,keys:Ar,filter:Rr,asc:Mn,desc:Or,distinct:Pr,modify:Nr,limit:kr,map:Wr,remove:Yr}};d(hr="only bound upperBound lowerBound".split(" ")).call(hr,function(nr){Fe[nr]=function(){return new er(nr,arguments)}}),this.filter=function(){var nr=new er(null,null);return b(nr).apply(nr,arguments)},this.all=function(){var nr;return b(nr=this).call(nr)}},Ue=function(dr,fr,sr,hr){var Fe=dr.target.result,or=new ie(Fe,fr);return Dt[fr]=Fe,a.resolve(or)},Dt={},tr={version:"0.10.2",open:function(dr){var fr;return new a(function(sr,hr){var Fe;Dt[dr.server]?Ue({target:{result:Dt[dr.server]}},dr.server,dr.version,dr.schema).then(sr,hr):(_e?a.resolve():Ce&&Ne().databases?new a(function(or){var ir=function(){return Ne().databases().finally(or)};Fe=i(ir,100),ir()}).finally(function(){_e=!0,clearInterval(Fe)}):(_e=!0,a.resolve())).then(function(){try{fr=Ne().open(dr.server,dr.version)}catch(or){hr(or)}fr.onsuccess=function(or){Ue(or,dr.server,dr.version,dr.schema).then(sr,hr)},fr.onupgradeneeded=function(or){(function(ir,$e,er){for(var nr in typeof $e=="function"&&($e=$e()),$e){var Pt,rr=$e[nr];for(var kt in Pt=!ae.call($e,nr)||er.objectStoreNames.contains(nr)?ir.currentTarget.transaction.objectStore(nr):er.createObjectStore(nr,rr.key),rr.indexes){var Et=rr.indexes[kt];try{Pt.index(kt)}catch{Pt.createIndex(kt,Et.key||kt,g(Et).length?Et:{unique:!1})}}}})(or,dr.schema,or.target.result)},fr.onerror=function(or){hr(or)}})})},remove:function(dr){return new a(function(fr,sr){if(!dr)return fr();var hr,Fe;s(dr)===ie&&(dr=dr.name),typeof dr=="string"&&(hr=Dt[dr]),hr&&typeof hr.close=="function"&&hr.close();try{Fe=Ne().deleteDatabase(dr)}catch(or){sr(or)}Fe.onsuccess=function(or){delete Dt[dr],fr(dr)},Fe.onerror=function(or){sr(or)},Fe.onblocked=function(or){sr(or)}})}};t.exports!==void 0?t.exports=tr:(o=(function(){return tr}).call(r,e,r,t))===void 0||(t.exports=o)})(void 0)}).call(this,e(56))},function(t,r,e){var n=e(586);t.exports=n},function(t,r,e){t.exports=e(639)},function(t,r){var e={set:function(n,o,s){e[n]=o,s&&(s.support=o)}};t.exports=e},function(t,r,e){var n=e(5),o=e(2),s=e(24),a=e(0),i=a.notundef,u=a.fillPropertyWithDefault,c=n,d={},m={},v={},g=[],b={normal:0,advanced:1},T={manager:0,all:1};d.inviteMode=d.updateCustomMode=d.updateTeamMode=T;var k={0:"normal",1:"advanced"},y=d.joinMode={noVerify:0,needVerify:1,rejectAll:2};m.joinMode={0:"noVerify",1:"needVerify",2:"rejectAll"},v.joinMode=c(y),g.push("join");var A=d.beInviteMode={needVerify:0,noVerify:1};function V(ae){var Ne;a.verifyOptions(ae,"action","superTeam::SuperTeam"),a.verifyOptions(ae,"teamId","superTeam::SuperTeam"),i(ae.teamId)&&(this.teamId=ae.teamId),i(ae.type)&&(this.type=b[ae.type]),i(ae.avatar)&&(this.avatar=""+ae.avatar),i(ae.name)&&(this.name=""+ae.name),i(ae.intro)&&(this.intro=""+ae.intro),i(ae.announcement)&&(this.announcement=""+ae.announcement),i(ae.custom)&&(this.custom=""+ae.custom),i(ae.inviteMode)&&(this.inviteMode=T[ae.inviteMode]),i(ae.updateCustomMode)&&(this.updateCustomMode=T[ae.updateCustomMode]),i(ae.updateTeamMode)&&(this.updateTeamMode=T[ae.updateTeamMode]),o(g).call(g,s(Ne=this.setMode).call(Ne,this,ae))}function he(ae,Ne){i(ae[Ne+="Mode"])&&(ae[Ne]=m[Ne][ae[Ne]])}m.beInviteMode={0:"needVerify",1:"noVerify"},g.push("beInvite"),m.inviteMode=m.updateCustomMode=m.updateTeamMode={0:"manager",1:"all"},g.push("invite"),g.push("updateCustom"),g.push("updateTeam"),v.inviteMode=v.updateCustomMode=v.updateTeamMode=c(T),v.beInviteMode=c(A),V.prototype.setMode=function(ae,Ne){i(ae[Ne+="Mode"])&&(a.verifyParamValid(Ne,ae[Ne],v[Ne],"Superteam::Team"),this[Ne]=d[Ne][ae[Ne]])},V.reverse=function(ae,Ne){var _e=a.copy(ae);if(i(_e.teamId)&&(_e.teamId=""+_e.teamId),i(_e.type)&&(_e.type=k[_e.type]),i(_e.level)&&(_e.level=+_e.level),i(_e.valid)&&(_e.valid=+_e.valid==1),i(_e.memberNum)&&(_e.memberNum=+_e.memberNum),i(_e.memberUpdateTime)&&(_e.memberUpdateTime=+_e.memberUpdateTime),i(_e.createTime)&&(_e.createTime=+_e.createTime),i(_e.updateTime)&&(_e.updateTime=+_e.updateTime),i(_e.validToCurrentUser)&&(_e.validToCurrentUser=_e.validToCurrentUser==="1"),i(_e.mute)&&(_e.mute=_e.mute==="1"),i(_e.muteType))switch(_e.muteType){case"0":_e.mute=!1,_e.muteType="none";break;case"1":_e.mute=!0,_e.muteType="normal";break;case"3":_e.mute=!0,_e.muteType="all"}else i(_e.mute)&&(_e.mute===1?(_e.mute=!0,_e.muteType="normal"):(_e.mute=!1,_e.muteType="none"));return o(g).call(g,s(he).call(he,null,_e)),delete _e.bits,Ne||V.fillProperties(_e),_e},V.fillProperties=function(ae){return u(ae,"avatar","")},t.exports=V},function(t,r,e){t.exports=e(661)},function(t,r,e){var n=e(0).notundef;function o(s){n(s.shouldPushNotificationWhenPCOnline)&&(this.open=s.shouldPushNotificationWhenPCOnline?2:1)}o.getDefaultConfig=function(){return{shouldPushNotificationWhenPCOnline:!0}},o.reverse=function(s){return{shouldPushNotificationWhenPCOnline:+s.open!=1}},t.exports=o},function(t,r,e){var n=e(74),o=e(755),s=e(287),a=e(254),i=e(197),u=e(0),c=e(305),d=e(283),m=e(183),v=e(760),g=e(761);t.exports=function(b){u.merge(b,{platform:n,xhr:o,io:s,naturalSort:a,deepAccess:i,util:u,support:c,blob:d,ajax:m,LoggerPlugin:v,usePlugin:g})}},function(t,r,e){var n=e(8),o=e(9),s=e(5),a=e(106).genPrivateUrl,i=e(0),u=i.notundef,c={"-2":"unset","-1":"restricted",0:"common",1:"owner",2:"manager",3:"guest",4:"anonymous"};function d(m){u(m.nick)&&(this.nick=""+m.nick),u(m.avatar)&&(this.avatar=""+m.avatar),u(m.custom)&&(this.custom=""+m.custom)}d.reverse=function(m){var v=i.copy(m);return u(v.chatroomId)&&(v.chatroomId=""+v.chatroomId),u(v.avatar)&&(v.avatar=a(v.avatar)),u(v.type)&&(v.type=c[v.type]),u(v.level)&&(v.level=+v.level),u(v.online)&&(v.online=+v.online==1),u(v.enterTime)&&(v.enterTime=+v.enterTime),u(v.guest)&&(v.guest=+v.guest==1),u(v.blacked)&&(v.blacked=+v.blacked==1),u(v.gaged)&&(v.gaged=+v.gaged==1),u(v.valid)&&(v.valid=+v.valid==1),u(v.updateTime)&&(v.updateTime=+v.updateTime),u(v.tempMuted)?v.tempMuted=+v.tempMuted==1:v.tempMuted=!1,u(v.tempMuteDuration)?v.tempMuteDuration=+v.tempMuteDuration:v.tempMuteDuration=0,v.online||delete v.enterTime,v.guest&&(v.type="guest",delete v.valid),v.type!=="common"&&delete v.level,delete v.guest,v},d.reverseMembers=function(m){return n(m).call(m,function(v){return o(d).call(d,v)})},d.validTypes=s(c),d.typeReverseMap=c,t.exports=d},function(t,r,e){var n,o,s,a,i,u,c,d,m,v,g,b,T,k,y,A,V,he,ae;t.exports=(n=e(89),e(764),void(n.lib.Cipher||(o=n,s=o.lib,a=s.Base,i=s.WordArray,u=s.BufferedBlockAlgorithm,c=o.enc,c.Utf8,d=c.Base64,m=o.algo.EvpKDF,v=s.Cipher=u.extend({cfg:a.extend(),createEncryptor:function(Ne,_e){return this.create(this._ENC_XFORM_MODE,Ne,_e)},createDecryptor:function(Ne,_e){return this.create(this._DEC_XFORM_MODE,Ne,_e)},init:function(Ne,_e,Ce){this.cfg=this.cfg.extend(Ce),this._xformMode=Ne,this._key=_e,this.reset()},reset:function(){u.reset.call(this),this._doReset()},process:function(Ne){return this._append(Ne),this._process()},finalize:function(Ne){return Ne&&this._append(Ne),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function Ne(_e){return typeof _e=="string"?ae:V}return function(_e){return{encrypt:function(Ce,re,ue){return Ne(re).encrypt(_e,Ce,re,ue)},decrypt:function(Ce,re,ue){return Ne(re).decrypt(_e,Ce,re,ue)}}}}()}),s.StreamCipher=v.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),g=o.mode={},b=s.BlockCipherMode=a.extend({createEncryptor:function(Ne,_e){return this.Encryptor.create(Ne,_e)},createDecryptor:function(Ne,_e){return this.Decryptor.create(Ne,_e)},init:function(Ne,_e){this._cipher=Ne,this._iv=_e}}),T=g.CBC=function(){var Ne=b.extend();function _e(Ce,re,ue){var ze,le=this._iv;le?(ze=le,this._iv=void 0):ze=this._prevBlock;for(var de=0;de<ue;de++)Ce[re+de]^=ze[de]}return Ne.Encryptor=Ne.extend({processBlock:function(Ce,re){var ue=this._cipher,ze=ue.blockSize;_e.call(this,Ce,re,ze),ue.encryptBlock(Ce,re),this._prevBlock=Ce.slice(re,re+ze)}}),Ne.Decryptor=Ne.extend({processBlock:function(Ce,re){var ue=this._cipher,ze=ue.blockSize,le=Ce.slice(re,re+ze);ue.decryptBlock(Ce,re),_e.call(this,Ce,re,ze),this._prevBlock=le}}),Ne}(),k=(o.pad={}).Pkcs7={pad:function(Ne,_e){for(var Ce=4*_e,re=Ce-Ne.sigBytes%Ce,ue=re<<24|re<<16|re<<8|re,ze=[],le=0;le<re;le+=4)ze.push(ue);var de=i.create(ze,re);Ne.concat(de)},unpad:function(Ne){var _e=255&Ne.words[Ne.sigBytes-1>>>2];Ne.sigBytes-=_e}},s.BlockCipher=v.extend({cfg:v.cfg.extend({mode:T,padding:k}),reset:function(){var Ne;v.reset.call(this);var _e=this.cfg,Ce=_e.iv,re=_e.mode;this._xformMode==this._ENC_XFORM_MODE?Ne=re.createEncryptor:(Ne=re.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==Ne?this._mode.init(this,Ce&&Ce.words):(this._mode=Ne.call(re,this,Ce&&Ce.words),this._mode.__creator=Ne)},_doProcessBlock:function(Ne,_e){this._mode.processBlock(Ne,_e)},_doFinalize:function(){var Ne,_e=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(_e.pad(this._data,this.blockSize),Ne=this._process(!0)):(Ne=this._process(!0),_e.unpad(Ne)),Ne},blockSize:4}),y=s.CipherParams=a.extend({init:function(Ne){this.mixIn(Ne)},toString:function(Ne){return(Ne||this.formatter).stringify(this)}}),A=(o.format={}).OpenSSL={stringify:function(Ne){var _e=Ne.ciphertext,Ce=Ne.salt;return(Ce?i.create([1398893684,1701076831]).concat(Ce).concat(_e):_e).toString(d)},parse:function(Ne){var _e,Ce=d.parse(Ne),re=Ce.words;return re[0]==1398893684&&re[1]==1701076831&&(_e=i.create(re.slice(2,4)),re.splice(0,4),Ce.sigBytes-=16),y.create({ciphertext:Ce,salt:_e})}},V=s.SerializableCipher=a.extend({cfg:a.extend({format:A}),encrypt:function(Ne,_e,Ce,re){re=this.cfg.extend(re);var ue=Ne.createEncryptor(Ce,re),ze=ue.finalize(_e),le=ue.cfg;return y.create({ciphertext:ze,key:Ce,iv:le.iv,algorithm:Ne,mode:le.mode,padding:le.padding,blockSize:Ne.blockSize,formatter:re.format})},decrypt:function(Ne,_e,Ce,re){return re=this.cfg.extend(re),_e=this._parse(_e,re.format),Ne.createDecryptor(Ce,re).finalize(_e.ciphertext)},_parse:function(Ne,_e){return typeof Ne=="string"?_e.parse(Ne,this):Ne}}),he=(o.kdf={}).OpenSSL={execute:function(Ne,_e,Ce,re){re||(re=i.random(8));var ue=m.create({keySize:_e+Ce}).compute(Ne,re),ze=i.create(ue.words.slice(_e),4*Ce);return ue.sigBytes=4*_e,y.create({key:ue,iv:ze,salt:re})}},ae=s.PasswordBasedCipher=V.extend({cfg:V.cfg.extend({kdf:he}),encrypt:function(Ne,_e,Ce,re){var ue=(re=this.cfg.extend(re)).kdf.execute(Ce,Ne.keySize,Ne.ivSize);re.iv=ue.iv;var ze=V.encrypt.call(this,Ne,_e,ue.key,re);return ze.mixIn(ue),ze},decrypt:function(Ne,_e,Ce,re){re=this.cfg.extend(re),_e=this._parse(_e,re.format);var ue=re.kdf.execute(Ce,Ne.keySize,Ne.ivSize,_e.salt);return re.iv=ue.iv,V.decrypt.call(this,Ne,_e,ue.key,re)}}))))},function(t,r,e){t.exports=e(282)},function(t,r,e){(function(n,o){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var s;s=function(){function a(or){return typeof or=="function"}var i=Array.isArray?Array.isArray:function(or){return Object.prototype.toString.call(or)==="[object Array]"},u=0,c=void 0,d=void 0,m=function(or,ir){A[u]=or,A[u+1]=ir,(u+=2)===2&&(d?d(V):Ce())},v=typeof window<"u"?window:void 0,g=v||{},b=g.MutationObserver||g.WebKitMutationObserver,T=typeof self>"u"&&n!==void 0&&{}.toString.call(n)==="[object process]",k=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function y(){var or=setTimeout;return function(){return or(V,1)}}var A=new Array(1e3);function V(){for(var or=0;or<u;or+=2)(0,A[or])(A[or+1]),A[or]=void 0,A[or+1]=void 0;u=0}var he,ae,Ne,_e,Ce=void 0;function re(or,ir){var $e=this,er=new this.constructor(le);er[ze]===void 0&&sr(er);var nr=$e._state;if(nr){var Pt=arguments[nr-1];m(function(){return dr(nr,er,Pt,$e._result)})}else Dt($e,er,or,ir);return er}function ue(or){if(or&&typeof or=="object"&&or.constructor===this)return or;var ir=new this(le);return Ie(ir,or),ir}T?Ce=function(){return n.nextTick(V)}:b?(ae=0,Ne=new b(V),_e=document.createTextNode(""),Ne.observe(_e,{characterData:!0}),Ce=function(){_e.data=ae=++ae%2}):k?((he=new MessageChannel).port1.onmessage=V,Ce=function(){return he.port2.postMessage(0)}):Ce=v===void 0?function(){try{var or=Function("return this")().require("vertx");return(c=or.runOnLoop||or.runOnContext)!==void 0?function(){c(V)}:y()}catch{return y()}}():y();var ze=Math.random().toString(36).substring(2);function le(){}function de(or,ir,$e){ir.constructor===or.constructor&&$e===re&&ir.constructor.resolve===ue?function(er,nr){nr._state===1?Ve(er,nr._result):nr._state===2?Ue(er,nr._result):Dt(nr,void 0,function(Pt){return Ie(er,Pt)},function(Pt){return Ue(er,Pt)})}(or,ir):$e===void 0?Ve(or,ir):a($e)?function(er,nr,Pt){m(function(rr){var kt=!1,Et=function(cr,mr,yr,Tr){try{cr.call(mr,yr,Tr)}catch(Ir){return Ir}}(Pt,nr,function(cr){kt||(kt=!0,nr!==cr?Ie(rr,cr):Ve(rr,cr))},function(cr){kt||(kt=!0,Ue(rr,cr))},rr._label);!kt&&Et&&(kt=!0,Ue(rr,Et))},er)}(or,ir,$e):Ve(or,ir)}function Ie(or,ir){if(or===ir)Ue(or,new TypeError("You cannot resolve a promise with itself"));else if(nr=typeof(er=ir),er===null||nr!=="object"&&nr!=="function")Ve(or,ir);else{var $e=void 0;try{$e=ir.then}catch(Pt){return void Ue(or,Pt)}de(or,ir,$e)}var er,nr}function ie(or){or._onerror&&or._onerror(or._result),tr(or)}function Ve(or,ir){or._state===void 0&&(or._result=ir,or._state=1,or._subscribers.length!==0&&m(tr,or))}function Ue(or,ir){or._state===void 0&&(or._state=2,or._result=ir,m(ie,or))}function Dt(or,ir,$e,er){var nr=or._subscribers,Pt=nr.length;or._onerror=null,nr[Pt]=ir,nr[Pt+1]=$e,nr[Pt+2]=er,Pt===0&&or._state&&m(tr,or)}function tr(or){var ir=or._subscribers,$e=or._state;if(ir.length!==0){for(var er=void 0,nr=void 0,Pt=or._result,rr=0;rr<ir.length;rr+=3)er=ir[rr],nr=ir[rr+$e],er?dr($e,er,nr,Pt):nr(Pt);or._subscribers.length=0}}function dr(or,ir,$e,er){var nr=a($e),Pt=void 0,rr=void 0,kt=!0;if(nr){try{Pt=$e(er)}catch(Et){kt=!1,rr=Et}if(ir===Pt)return void Ue(ir,new TypeError("A promises callback cannot return that same promise."))}else Pt=er;ir._state!==void 0||(nr&&kt?Ie(ir,Pt):kt===!1?Ue(ir,rr):or===1?Ve(ir,Pt):or===2&&Ue(ir,Pt))}var fr=0;function sr(or){or[ze]=fr++,or._state=void 0,or._result=void 0,or._subscribers=[]}var hr=function(){function or(ir,$e){this._instanceConstructor=ir,this.promise=new ir(le),this.promise[ze]||sr(this.promise),i($e)?(this.length=$e.length,this._remaining=$e.length,this._result=new Array(this.length),this.length===0?Ve(this.promise,this._result):(this.length=this.length||0,this._enumerate($e),this._remaining===0&&Ve(this.promise,this._result))):Ue(this.promise,new Error("Array Methods must be provided an Array"))}return or.prototype._enumerate=function(ir){for(var $e=0;this._state===void 0&&$e<ir.length;$e++)this._eachEntry(ir[$e],$e)},or.prototype._eachEntry=function(ir,$e){var er=this._instanceConstructor,nr=er.resolve;if(nr===ue){var Pt=void 0,rr=void 0,kt=!1;try{Pt=ir.then}catch(cr){kt=!0,rr=cr}if(Pt===re&&ir._state!==void 0)this._settledAt(ir._state,$e,ir._result);else if(typeof Pt!="function")this._remaining--,this._result[$e]=ir;else if(er===Fe){var Et=new er(le);kt?Ue(Et,rr):de(Et,ir,Pt),this._willSettleAt(Et,$e)}else this._willSettleAt(new er(function(cr){return cr(ir)}),$e)}else this._willSettleAt(nr(ir),$e)},or.prototype._settledAt=function(ir,$e,er){var nr=this.promise;nr._state===void 0&&(this._remaining--,ir===2?Ue(nr,er):this._result[$e]=er),this._remaining===0&&Ve(nr,this._result)},or.prototype._willSettleAt=function(ir,$e){var er=this;Dt(ir,void 0,function(nr){return er._settledAt(1,$e,nr)},function(nr){return er._settledAt(2,$e,nr)})},or}(),Fe=function(){function or(ir){this[ze]=fr++,this._result=this._state=void 0,this._subscribers=[],le!==ir&&(typeof ir!="function"&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof or?function($e,er){try{er(function(nr){Ie($e,nr)},function(nr){Ue($e,nr)})}catch(nr){Ue($e,nr)}}(this,ir):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return or.prototype.catch=function(ir){return this.then(null,ir)},or.prototype.finally=function(ir){var $e=this.constructor;return a(ir)?this.then(function(er){return $e.resolve(ir()).then(function(){return er})},function(er){return $e.resolve(ir()).then(function(){throw er})}):this.then(ir,ir)},or}();return Fe.prototype.then=re,Fe.all=function(or){return new hr(this,or).promise},Fe.race=function(or){var ir=this;return i(or)?new ir(function($e,er){for(var nr=or.length,Pt=0;Pt<nr;Pt++)ir.resolve(or[Pt]).then($e,er)}):new ir(function($e,er){return er(new TypeError("You must pass an array to race."))})},Fe.resolve=ue,Fe.reject=function(or){var ir=new this(le);return Ue(ir,or),ir},Fe._setScheduler=function(or){d=or},Fe._setAsap=function(or){m=or},Fe._asap=m,Fe.polyfill=function(){var or=void 0;if(o!==void 0)or=o;else if(typeof self<"u")or=self;else try{or=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var ir=or.Promise;if(ir){var $e=null;try{$e=Object.prototype.toString.call(ir.resolve())}catch{}if($e==="[object Promise]"&&!ir.cast)return}or.Promise=Fe},Fe.Promise=Fe,Fe},t.exports=s()}).call(this,e(314),e(56))},function(t,r){var e,n,o=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function i(k){if(e===setTimeout)return setTimeout(k,0);if((e===s||!e)&&setTimeout)return e=setTimeout,setTimeout(k,0);try{return e(k,0)}catch{try{return e.call(null,k,0)}catch{return e.call(this,k,0)}}}(function(){try{e=typeof setTimeout=="function"?setTimeout:s}catch{e=s}try{n=typeof clearTimeout=="function"?clearTimeout:a}catch{n=a}})();var u,c=[],d=!1,m=-1;function v(){d&&u&&(d=!1,u.length?c=u.concat(c):m=-1,c.length&&g())}function g(){if(!d){var k=i(v);d=!0;for(var y=c.length;y;){for(u=c,c=[];++m<y;)u&&u[m].run();m=-1,y=c.length}u=null,d=!1,function(A){if(n===clearTimeout)return clearTimeout(A);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(A);try{n(A)}catch{try{return n.call(null,A)}catch{return n.call(this,A)}}}(k)}}function b(k,y){this.fun=k,this.array=y}function T(){}o.nextTick=function(k){var y=new Array(arguments.length-1);if(arguments.length>1)for(var A=1;A<arguments.length;A++)y[A-1]=arguments[A];c.push(new b(k,y)),c.length!==1||d||i(g)},b.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=T,o.addListener=T,o.once=T,o.off=T,o.removeListener=T,o.removeAllListeners=T,o.emit=T,o.prependListener=T,o.prependOnceListener=T,o.listeners=function(k){return[]},o.binding=function(k){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(k){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,r,e){var n=e(21),o=e(316),s=Array.prototype;t.exports=function(a){var i=a.indexOf;return a===s||n(s,a)&&i===s.indexOf?o:i}},function(t,r,e){e(317);var n=e(30);t.exports=n("Array").indexOf},function(t,r,e){var n=e(1),o=e(155),s=e(159).indexOf,a=e(94),i=o([].indexOf),u=!!i&&1/i([1],1,-0)<0,c=a("indexOf");n({target:"Array",proto:!0,forced:u||!c},{indexOf:function(d){var m=arguments.length>1?arguments[1]:void 0;return u?i(this,d,m)||0:s(this,d,m)}})},function(t,r,e){var n=e(19),o=e(28),s=e(126),a=e(156),i=e(319),u=e(20),c=TypeError,d=u("toPrimitive");t.exports=function(m,v){if(!o(m)||s(m))return m;var g,b=a(m,d);if(b){if(v===void 0&&(v="default"),g=n(b,m,v),!o(g)||s(g))return g;throw c("Can't convert object to primitive value")}return v===void 0&&(v="number"),i(m,v)}},function(t,r,e){var n=e(19),o=e(16),s=e(28),a=TypeError;t.exports=function(i,u){var c,d;if(u==="string"&&o(c=i.toString)&&!s(d=n(c,i))||o(c=i.valueOf)&&!s(d=n(c,i))||u!=="string"&&o(c=i.toString)&&!s(d=n(c,i)))return d;throw a("Can't convert object to primitive value")}},function(t,r,e){var n=e(14),o=Object.defineProperty;t.exports=function(s,a){try{o(n,s,{value:a,configurable:!0,writable:!0})}catch{n[s]=a}return a}},function(t,r){var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(o){var s=+o;return(s>0?n:e)(s)}},function(t,r,e){var n=e(110),o=Math.min;t.exports=function(s){return s>0?o(n(s),9007199254740991):0}},function(t,r,e){var n=e(324);t.exports=n},function(t,r,e){var n=e(21),o=e(325),s=Array.prototype;t.exports=function(a){var i=a.concat;return a===s||n(s,a)&&i===s.concat?o:i}},function(t,r,e){e(211);var n=e(30);t.exports=n("Array").concat},function(t,r,e){var n=e(79),o=e(129),s=e(28),a=e(20)("species"),i=Array;t.exports=function(u){var c;return n(u)&&(c=u.constructor,(o(c)&&(c===i||n(c.prototype))||s(c)&&(c=c[a])===null)&&(c=void 0)),c===void 0?i:c}},function(t,r,e){e(328);var n=e(12).Object;t.exports=function(o,s){return n.create(o,s)}},function(t,r,e){e(1)({target:"Object",stat:!0,sham:!e(27)},{create:e(80)})},function(t,r,e){t.exports=e(330)},function(t,r,e){var n=e(331);e(358),e(359),e(360),e(361),e(362),e(363),e(364),t.exports=n},function(t,r,e){var n=e(217);e(357),t.exports=n},function(t,r,e){e(211),e(96),e(218),e(339),e(340),e(341),e(342),e(223),e(343),e(344),e(345),e(346),e(347),e(348),e(224),e(349),e(350),e(351),e(352),e(353);var n=e(12);t.exports=n.Symbol},function(t,r,e){var n=e(1),o=e(14),s=e(19),a=e(11),i=e(48),u=e(27),c=e(92),d=e(4),m=e(29),v=e(21),g=e(36),b=e(43),T=e(125),k=e(49),y=e(77),A=e(80),V=e(118),he=e(131),ae=e(164),Ne=e(132),_e=e(90),Ce=e(38),re=e(162),ue=e(148),ze=e(66),le=e(109),de=e(130),Ie=e(112),ie=e(127),Ve=e(20),Ue=e(133),Dt=e(22),tr=e(220),dr=e(81),fr=e(97),sr=e(84).forEach,hr=de("hidden"),Fe=fr.set,or=fr.getterFor("Symbol"),ir=Object.prototype,$e=o.Symbol,er=$e&&$e.prototype,nr=o.TypeError,Pt=o.QObject,rr=_e.f,kt=Ce.f,Et=ae.f,cr=ue.f,mr=a([].push),yr=le("symbols"),Tr=le("op-symbols"),Ir=le("wks"),kr=!Pt||!Pt.prototype||!Pt.prototype.findChild,Ar=u&&d(function(){return A(kt({},"a",{get:function(){return kt(this,"a",{value:7}).a}})).a!=7})?function(Ur,qr,Yn){var $n=rr(ir,qr);$n&&delete ir[qr],kt(Ur,qr,Yn),$n&&Ur!==ir&&kt(ir,qr,$n)}:kt,Rr=function(Ur,qr){var Yn=yr[Ur]=A(er);return Fe(Yn,{type:"Symbol",tag:Ur,description:qr}),u||(Yn.description=qr),Yn},Mn=function(Ur,qr,Yn){Ur===ir&&Mn(Tr,qr,Yn),g(Ur);var $n=T(qr);return g(Yn),m(yr,$n)?(Yn.enumerable?(m(Ur,hr)&&Ur[hr][$n]&&(Ur[hr][$n]=!1),Yn=A(Yn,{enumerable:y(0,!1)})):(m(Ur,hr)||kt(Ur,hr,y(1,{})),Ur[hr][$n]=!0),Ar(Ur,$n,Yn)):kt(Ur,$n,Yn)},Or=function(Ur,qr){g(Ur);var Yn=b(qr),$n=V(Yn).concat(Yr(Yn));return sr($n,function(Jr){u&&!s(Pr,Yn,Jr)||Mn(Ur,Jr,Yn[Jr])}),Ur},Pr=function(Ur){var qr=T(Ur),Yn=s(cr,this,qr);return!(this===ir&&m(yr,qr)&&!m(Tr,qr))&&(!(Yn||!m(this,qr)||!m(yr,qr)||m(this,hr)&&this[hr][qr])||Yn)},Nr=function(Ur,qr){var Yn=b(Ur),$n=T(qr);if(Yn!==ir||!m(yr,$n)||m(Tr,$n)){var Jr=rr(Yn,$n);return!Jr||!m(yr,$n)||m(Yn,hr)&&Yn[hr][$n]||(Jr.enumerable=!0),Jr}},Wr=function(Ur){var qr=Et(b(Ur)),Yn=[];return sr(qr,function($n){m(yr,$n)||m(Ie,$n)||mr(Yn,$n)}),Yn},Yr=function(Ur){var qr=Ur===ir,Yn=Et(qr?Tr:b(Ur)),$n=[];return sr(Yn,function(Jr){!m(yr,Jr)||qr&&!m(ir,Jr)||mr($n,yr[Jr])}),$n};c||(ze(er=($e=function(){if(v(er,this))throw nr("Symbol is not a constructor");var Ur=arguments.length&&arguments[0]!==void 0?k(arguments[0]):void 0,qr=ie(Ur),Yn=function($n){this===ir&&s(Yn,Tr,$n),m(this,hr)&&m(this[hr],qr)&&(this[hr][qr]=!1),Ar(this,qr,y(1,$n))};return u&&kr&&Ar(ir,qr,{configurable:!0,set:Yn}),Rr(qr,Ur)}).prototype,"toString",function(){return or(this).tag}),ze($e,"withoutSetter",function(Ur){return Rr(ie(Ur),Ur)}),ue.f=Pr,Ce.f=Mn,re.f=Or,_e.f=Nr,he.f=ae.f=Wr,Ne.f=Yr,Ue.f=function(Ur){return Rr(Ve(Ur),Ur)},u&&(kt(er,"description",{configurable:!0,get:function(){return or(this).description}}),i||ze(ir,"propertyIsEnumerable",Pr,{unsafe:!0}))),n({global:!0,constructor:!0,wrap:!0,forced:!c,sham:!c},{Symbol:$e}),sr(V(Ir),function(Ur){Dt(Ur)}),n({target:"Symbol",stat:!0,forced:!c},{useSetter:function(){kr=!0},useSimple:function(){kr=!1}}),n({target:"Object",stat:!0,forced:!c,sham:!u},{create:function(Ur,qr){return qr===void 0?A(Ur):Or(A(Ur),qr)},defineProperty:Mn,defineProperties:Or,getOwnPropertyDescriptor:Nr}),n({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:Wr}),tr(),dr($e,"Symbol"),Ie[hr]=!0},function(t,r,e){var n=e(161),o=e(65);t.exports=n?{}.toString:function(){return"[object "+o(this)+"]"}},function(t,r,e){var n=e(14),o=e(16),s=n.WeakMap;t.exports=o(s)&&/native code/.test(String(s))},function(t,r,e){var n=e(1),o=e(33),s=e(29),a=e(49),i=e(109),u=e(221),c=i("string-to-symbol-registry"),d=i("symbol-to-string-registry");n({target:"Symbol",stat:!0,forced:!u},{for:function(m){var v=a(m);if(s(c,v))return c[v];var g=o("Symbol")(v);return c[v]=g,d[g]=v,g}})},function(t,r,e){var n=e(1),o=e(29),s=e(126),a=e(78),i=e(109),u=e(221),c=i("symbol-to-string-registry");n({target:"Symbol",stat:!0,forced:!u},{keyFor:function(d){if(!s(d))throw TypeError(a(d)+" is not a symbol");if(o(c,d))return c[d]}})},function(t,r,e){var n=e(1),o=e(92),s=e(4),a=e(132),i=e(42);n({target:"Object",stat:!0,forced:!o||s(function(){a.f(1)})},{getOwnPropertySymbols:function(u){var c=a.f;return c?c(i(u)):[]}})},function(t,r,e){e(22)("asyncIterator")},function(t,r){},function(t,r,e){e(22)("hasInstance")},function(t,r,e){e(22)("isConcatSpreadable")},function(t,r,e){e(22)("match")},function(t,r,e){e(22)("matchAll")},function(t,r,e){e(22)("replace")},function(t,r,e){e(22)("search")},function(t,r,e){e(22)("species")},function(t,r,e){e(22)("split")},function(t,r,e){var n=e(33),o=e(22),s=e(81);o("toStringTag"),s(n("Symbol"),"Symbol")},function(t,r,e){e(22)("unscopables")},function(t,r,e){var n=e(14);e(81)(n.JSON,"JSON",!0)},function(t,r){},function(t,r){},function(t,r,e){var n=e(226).IteratorPrototype,o=e(80),s=e(77),a=e(81),i=e(99),u=function(){return this};t.exports=function(c,d,m,v){var g=d+" Iterator";return c.prototype=o(n,{next:s(+!v,m)}),a(c,g,!1,!0),i[g]=u,c}},function(t,r,e){var n=e(16),o=String,s=TypeError;t.exports=function(a){if(typeof a=="object"||n(a))return a;throw s("Can't set "+o(a)+" as a prototype")}},function(t,r){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,r,e){e(22)("dispose")},function(t,r,e){e(22)("asyncDispose")},function(t,r,e){e(22)("matcher")},function(t,r,e){e(22)("metadataKey")},function(t,r,e){e(22)("observable")},function(t,r,e){e(22)("metadata")},function(t,r,e){e(22)("patternMatch")},function(t,r,e){e(22)("replaceAll")},function(t,r,e){t.exports=e(366)},function(t,r,e){t.exports=e(367)},function(t,r,e){var n=e(368);t.exports=n},function(t,r,e){var n=e(369);t.exports=n},function(t,r,e){var n=e(370);e(67),t.exports=n},function(t,r,e){e(82),e(96),e(113),e(223);var n=e(133);t.exports=n.f("iterator")},function(t,r,e){var n=e(11),o=e(110),s=e(49),a=e(108),i=n("".charAt),u=n("".charCodeAt),c=n("".slice),d=function(m){return function(v,g){var b,T,k=s(a(v)),y=o(g),A=k.length;return y<0||y>=A?m?"":void 0:(b=u(k,y))<55296||b>56319||y+1===A||(T=u(k,y+1))<56320||T>57343?m?i(k,y):b:m?c(k,y,y+2):T-56320+(b-55296<<10)+65536}};t.exports={codeAt:d(!1),charAt:d(!0)}},function(t,r,e){e(373);var n=e(12);t.exports=n.Array.isArray},function(t,r,e){e(1)({target:"Array",stat:!0},{isArray:e(79)})},function(t,r,e){var n=e(375);t.exports=n},function(t,r,e){e(376);var n=e(30);t.exports=n("Array").forEach},function(t,r,e){var n=e(1),o=e(377);n({target:"Array",proto:!0,forced:[].forEach!=o},{forEach:o})},function(t,r,e){var n=e(84).forEach,o=e(94)("forEach");t.exports=o?[].forEach:function(s){return n(this,s,arguments.length>1?arguments[1]:void 0)}},function(t,r,e){t.exports=e(379)},function(t,r,e){var n=e(380);t.exports=n},function(t,r,e){e(381);var n=e(12).Object;t.exports=function(o){return n.getOwnPropertyNames(o)}},function(t,r,e){var n=e(1),o=e(4),s=e(164).f;n({target:"Object",stat:!0,forced:o(function(){return!Object.getOwnPropertyNames(1)})},{getOwnPropertyNames:s})},function(t,r,e){e(383);var n=e(12);t.exports=n.Object.keys},function(t,r,e){var n=e(1),o=e(42),s=e(118);n({target:"Object",stat:!0,forced:e(4)(function(){s(1)})},{keys:function(a){return s(o(a))}})},function(t,r,e){var n=e(385);t.exports=n},function(t,r,e){e(222);var n=e(12),o=e(76);n.JSON||(n.JSON={stringify:JSON.stringify}),t.exports=function(s,a,i){return o(n.JSON.stringify,null,arguments)}},function(t,r,e){e(231),e(82),e(96),e(393),e(245),e(246),e(406),e(113);var n=e(12);t.exports=n.Promise},function(t,r,e){var n=e(1),o=e(21),s=e(134),a=e(135),i=e(388),u=e(80),c=e(53),d=e(77),m=e(389),v=e(390),g=e(46),b=e(391),T=e(20),k=e(392),y=T("toStringTag"),A=Error,V=[].push,he=function(Ne,_e){var Ce,re=arguments.length>2?arguments[2]:void 0,ue=o(ae,this);a?Ce=a(A(),ue?s(this):ae):(Ce=ue?this:u(ae),c(Ce,y,"Error")),_e!==void 0&&c(Ce,"message",b(_e)),k&&c(Ce,"stack",m(Ce.stack,1)),v(Ce,re);var ze=[];return g(Ne,V,{that:ze}),c(Ce,"errors",ze),Ce};a?a(he,A):i(he,A,{name:!0});var ae=he.prototype=u(A.prototype,{constructor:d(1,he),message:d(1,""),name:d(1,"AggregateError")});n({global:!0,constructor:!0,arity:2},{AggregateError:he})},function(t,r,e){var n=e(29),o=e(232),s=e(90),a=e(38);t.exports=function(i,u,c){for(var d=o(u),m=a.f,v=s.f,g=0;g<d.length;g++){var b=d[g];n(i,b)||c&&n(c,b)||m(i,b,v(u,b))}}},function(t,r,e){var n=e(11),o=Error,s=n("".replace),a=String(o("zxcasd").stack),i=/\n\s*at [^:]*:[^\n]*/,u=i.test(a);t.exports=function(c,d){if(u&&typeof c=="string"&&!o.prepareStackTrace)for(;d--;)c=s(c,i,"");return c}},function(t,r,e){var n=e(28),o=e(53);t.exports=function(s,a){n(a)&&"cause"in a&&o(s,"cause",a.cause)}},function(t,r,e){var n=e(49);t.exports=function(o,s){return o===void 0?arguments.length<2?"":s:n(o)}},function(t,r,e){var n=e(4),o=e(77);t.exports=!n(function(){var s=Error("a");return!("stack"in s)||(Object.defineProperty(s,"stack",o(1,7)),s.stack!==7)})},function(t,r,e){e(394),e(401),e(402),e(403),e(404),e(405)},function(t,r,e){var n,o,s,a=e(1),i=e(48),u=e(114),c=e(14),d=e(19),m=e(66),v=e(135),g=e(81),b=e(236),T=e(31),k=e(16),y=e(28),A=e(167),V=e(237),he=e(238).set,ae=e(395),Ne=e(398),_e=e(100),Ce=e(399),re=e(97),ue=e(101),ze=e(115),le=e(68),de=ze.CONSTRUCTOR,Ie=ze.REJECTION_EVENT,ie=ze.SUBCLASSING,Ve=re.getterFor("Promise"),Ue=re.set,Dt=ue&&ue.prototype,tr=ue,dr=Dt,fr=c.TypeError,sr=c.document,hr=c.process,Fe=le.f,or=Fe,ir=!!(sr&&sr.createEvent&&c.dispatchEvent),$e=function(Tr){var Ir;return!(!y(Tr)||!k(Ir=Tr.then))&&Ir},er=function(Tr,Ir){var kr,Ar,Rr,Mn=Ir.value,Or=Ir.state==1,Pr=Or?Tr.ok:Tr.fail,Nr=Tr.resolve,Wr=Tr.reject,Yr=Tr.domain;try{Pr?(Or||(Ir.rejection===2&&Et(Ir),Ir.rejection=1),Pr===!0?kr=Mn:(Yr&&Yr.enter(),kr=Pr(Mn),Yr&&(Yr.exit(),Rr=!0)),kr===Tr.promise?Wr(fr("Promise-chain cycle")):(Ar=$e(kr))?d(Ar,kr,Nr,Wr):Nr(kr)):Wr(Mn)}catch(Ur){Yr&&!Rr&&Yr.exit(),Wr(Ur)}},nr=function(Tr,Ir){Tr.notified||(Tr.notified=!0,ae(function(){for(var kr,Ar=Tr.reactions;kr=Ar.get();)er(kr,Tr);Tr.notified=!1,Ir&&!Tr.rejection&&rr(Tr)}))},Pt=function(Tr,Ir,kr){var Ar,Rr;ir?((Ar=sr.createEvent("Event")).promise=Ir,Ar.reason=kr,Ar.initEvent(Tr,!1,!0),c.dispatchEvent(Ar)):Ar={promise:Ir,reason:kr},!Ie&&(Rr=c["on"+Tr])?Rr(Ar):Tr==="unhandledrejection"&&Ne("Unhandled promise rejection",kr)},rr=function(Tr){d(he,c,function(){var Ir,kr=Tr.facade,Ar=Tr.value;if(kt(Tr)&&(Ir=_e(function(){u?hr.emit("unhandledRejection",Ar,kr):Pt("unhandledrejection",kr,Ar)}),Tr.rejection=u||kt(Tr)?2:1,Ir.error))throw Ir.value})},kt=function(Tr){return Tr.rejection!==1&&!Tr.parent},Et=function(Tr){d(he,c,function(){var Ir=Tr.facade;u?hr.emit("rejectionHandled",Ir):Pt("rejectionhandled",Ir,Tr.value)})},cr=function(Tr,Ir,kr){return function(Ar){Tr(Ir,Ar,kr)}},mr=function(Tr,Ir,kr){Tr.done||(Tr.done=!0,kr&&(Tr=kr),Tr.value=Ir,Tr.state=2,nr(Tr,!0))},yr=function(Tr,Ir,kr){if(!Tr.done){Tr.done=!0,kr&&(Tr=kr);try{if(Tr.facade===Ir)throw fr("Promise can't be resolved itself");var Ar=$e(Ir);Ar?ae(function(){var Rr={done:!1};try{d(Ar,Ir,cr(yr,Rr,Tr),cr(mr,Rr,Tr))}catch(Mn){mr(Rr,Mn,Tr)}}):(Tr.value=Ir,Tr.state=1,nr(Tr,!1))}catch(Rr){mr({done:!1},Rr,Tr)}}};if(de&&(dr=(tr=function(Tr){A(this,dr),T(Tr),d(n,this);var Ir=Ve(this);try{Tr(cr(yr,Ir),cr(mr,Ir))}catch(kr){mr(Ir,kr)}}).prototype,(n=function(Tr){Ue(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new Ce,rejection:!1,state:0,value:void 0})}).prototype=m(dr,"then",function(Tr,Ir){var kr=Ve(this),Ar=Fe(V(this,tr));return kr.parent=!0,Ar.ok=!k(Tr)||Tr,Ar.fail=k(Ir)&&Ir,Ar.domain=u?hr.domain:void 0,kr.state==0?kr.reactions.add(Ar):ae(function(){er(Ar,kr)}),Ar.promise}),o=function(){var Tr=new n,Ir=Ve(Tr);this.promise=Tr,this.resolve=cr(yr,Ir),this.reject=cr(mr,Ir)},le.f=Fe=function(Tr){return Tr===tr||Tr===void 0?new o(Tr):or(Tr)},!i&&k(ue)&&Dt!==Object.prototype)){s=Dt.then,ie||m(Dt,"then",function(Tr,Ir){var kr=this;return new tr(function(Ar,Rr){d(s,kr,Ar,Rr)}).then(Tr,Ir)},{unsafe:!0});try{delete Dt.constructor}catch{}v&&v(Dt,dr)}a({global:!0,constructor:!0,wrap:!0,forced:de},{Promise:tr}),g(tr,"Promise",!1,!0),b("Promise")},function(t,r,e){var n,o,s,a,i,u,c,d,m=e(14),v=e(34),g=e(90).f,b=e(238).set,T=e(240),k=e(396),y=e(397),A=e(114),V=m.MutationObserver||m.WebKitMutationObserver,he=m.document,ae=m.process,Ne=m.Promise,_e=g(m,"queueMicrotask"),Ce=_e&&_e.value;Ce||(n=function(){var re,ue;for(A&&(re=ae.domain)&&re.exit();o;){ue=o.fn,o=o.next;try{ue()}catch(ze){throw o?a():s=void 0,ze}}s=void 0,re&&re.enter()},T||A||y||!V||!he?!k&&Ne&&Ne.resolve?((c=Ne.resolve(void 0)).constructor=Ne,d=v(c.then,c),a=function(){d(n)}):A?a=function(){ae.nextTick(n)}:(b=v(b,m),a=function(){b(n)}):(i=!0,u=he.createTextNode(""),new V(n).observe(u,{characterData:!0}),a=function(){u.data=i=!i})),t.exports=Ce||function(re){var ue={fn:re,next:void 0};s&&(s.next=ue),o||(o=ue,a()),s=ue}},function(t,r,e){var n=e(64),o=e(14);t.exports=/ipad|iphone|ipod/i.test(n)&&o.Pebble!==void 0},function(t,r,e){var n=e(64);t.exports=/web0s(?!.*chrome)/i.test(n)},function(t,r,e){var n=e(14);t.exports=function(o,s){var a=n.console;a&&a.error&&(arguments.length==1?a.error(o):a.error(o,s))}},function(t,r){var e=function(){this.head=null,this.tail=null};e.prototype={add:function(n){var o={item:n,next:null};this.head?this.tail.next=o:this.head=o,this.tail=o},get:function(){var n=this.head;if(n)return this.head=n.next,this.tail===n&&(this.tail=null),n.item}},t.exports=e},function(t,r,e){var n=e(241),o=e(114);t.exports=!n&&!o&&typeof window=="object"&&typeof document=="object"},function(t,r,e){var n=e(1),o=e(19),s=e(31),a=e(68),i=e(100),u=e(46);n({target:"Promise",stat:!0,forced:e(242)},{all:function(c){var d=this,m=a.f(d),v=m.resolve,g=m.reject,b=i(function(){var T=s(d.resolve),k=[],y=0,A=1;u(c,function(V){var he=y++,ae=!1;A++,o(T,d,V).then(function(Ne){ae||(ae=!0,k[he]=Ne,--A||v(k))},g)}),--A||v(k)});return b.error&&g(b.value),m.promise}})},function(t,r,e){var n=e(1),o=e(48),s=e(115).CONSTRUCTOR,a=e(101),i=e(33),u=e(16),c=e(66),d=a&&a.prototype;if(n({target:"Promise",proto:!0,forced:s,real:!0},{catch:function(v){return this.then(void 0,v)}}),!o&&u(a)){var m=i("Promise").prototype.catch;d.catch!==m&&c(d,"catch",m,{unsafe:!0})}},function(t,r,e){var n=e(1),o=e(19),s=e(31),a=e(68),i=e(100),u=e(46);n({target:"Promise",stat:!0,forced:e(242)},{race:function(c){var d=this,m=a.f(d),v=m.reject,g=i(function(){var b=s(d.resolve);u(c,function(T){o(b,d,T).then(m.resolve,v)})});return g.error&&v(g.value),m.promise}})},function(t,r,e){var n=e(1),o=e(19),s=e(68);n({target:"Promise",stat:!0,forced:e(115).CONSTRUCTOR},{reject:function(a){var i=s.f(this);return o(i.reject,void 0,a),i.promise}})},function(t,r,e){var n=e(1),o=e(33),s=e(48),a=e(101),i=e(115).CONSTRUCTOR,u=e(244),c=o("Promise"),d=s&&!i;n({target:"Promise",stat:!0,forced:s||i},{resolve:function(m){return u(d&&this===c?a:this,m)}})},function(t,r,e){var n=e(1),o=e(48),s=e(101),a=e(4),i=e(33),u=e(16),c=e(237),d=e(244),m=e(66),v=s&&s.prototype;if(n({target:"Promise",proto:!0,real:!0,forced:!!s&&a(function(){v.finally.call({then:function(){}},function(){})})},{finally:function(b){var T=c(this,i("Promise")),k=u(b);return this.then(k?function(y){return d(T,b()).then(function(){return y})}:b,k?function(y){return d(T,b()).then(function(){throw y})}:b)}}),!o&&u(s)){var g=i("Promise").prototype.finally;v.finally!==g&&m(v,"finally",g,{unsafe:!0})}},function(t,r,e){t.exports=e(408)},function(t,r,e){var n=e(409);t.exports=n},function(t,r,e){var n=e(247);t.exports=n},function(t,r,e){e(411);var n=e(12).Object,o=t.exports=function(s,a,i){return n.defineProperty(s,a,i)};n.defineProperty.sham&&(o.sham=!0)},function(t,r,e){var n=e(1),o=e(27),s=e(38).f;n({target:"Object",stat:!0,forced:Object.defineProperty!==s,sham:!o},{defineProperty:s})},function(t,r,e){var n=e(413),o=e(25).default;t.exports=function(s,a){if(o(s)!=="object"||s===null)return s;var i=s[n];if(i!==void 0){var u=i.call(s,a||"default");if(o(u)!=="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(s)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(414)},function(t,r,e){t.exports=e(415)},function(t,r,e){var n=e(416);t.exports=n},function(t,r,e){var n=e(417);t.exports=n},function(t,r,e){var n=e(418);t.exports=n},function(t,r,e){e(419),e(224);var n=e(133);t.exports=n.f("toPrimitive")},function(t,r){},function(t,r,e){var n=e(21),o=e(421),s=Array.prototype;t.exports=function(a){var i=a.slice;return a===s||n(s,a)&&i===s.slice?o:i}},function(t,r,e){e(422);var n=e(30);t.exports=n("Array").slice},function(t,r,e){var n=e(1),o=e(79),s=e(129),a=e(28),i=e(128),u=e(45),c=e(43),d=e(95),m=e(20),v=e(111),g=e(98),b=v("slice"),T=m("species"),k=Array,y=Math.max;n({target:"Array",proto:!0,forced:!b},{slice:function(A,V){var he,ae,Ne,_e=c(this),Ce=u(_e),re=i(A,Ce),ue=i(V===void 0?Ce:V,Ce);if(o(_e)&&(he=_e.constructor,(s(he)&&(he===k||o(he.prototype))||a(he)&&(he=he[T])===null)&&(he=void 0),he===k||he===void 0))return g(_e,re,ue);for(ae=new(he===void 0?k:he)(y(ue-re,0)),Ne=0;re<ue;re++,Ne++)re in _e&&d(ae,Ne,_e[re]);return ae.length=Ne,ae}})},function(t,r,e){var n=e(424);t.exports=n},function(t,r,e){var n=e(21),o=e(425),s=Array.prototype;t.exports=function(a){var i=a.some;return a===s||n(s,a)&&i===s.some?o:i}},function(t,r,e){e(426);var n=e(30);t.exports=n("Array").some},function(t,r,e){var n=e(1),o=e(84).some;n({target:"Array",proto:!0,forced:!e(94)("some")},{some:function(s){return o(this,s,arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(428);t.exports=n},function(t,r,e){var n=e(21),o=e(429),s=Array.prototype;t.exports=function(a){var i=a.splice;return a===s||n(s,a)&&i===s.splice?o:i}},function(t,r,e){e(430);var n=e(30);t.exports=n("Array").splice},function(t,r,e){var n=e(1),o=e(42),s=e(128),a=e(110),i=e(45),u=e(431),c=e(212),d=e(160),m=e(95),v=e(250),g=e(111)("splice"),b=Math.max,T=Math.min;n({target:"Array",proto:!0,forced:!g},{splice:function(k,y){var A,V,he,ae,Ne,_e,Ce=o(this),re=i(Ce),ue=s(k,re),ze=arguments.length;for(ze===0?A=V=0:ze===1?(A=0,V=re-ue):(A=ze-2,V=T(b(a(y),0),re-ue)),c(re+A-V),he=d(Ce,V),ae=0;ae<V;ae++)(Ne=ue+ae)in Ce&&m(he,ae,Ce[Ne]);if(he.length=V,A<V){for(ae=ue;ae<re-V;ae++)_e=ae+A,(Ne=ae+V)in Ce?Ce[_e]=Ce[Ne]:v(Ce,_e);for(ae=re;ae>re-V+A;ae--)v(Ce,ae-1)}else if(A>V)for(ae=re-V;ae>ue;ae--)_e=ae+A-1,(Ne=ae+V-1)in Ce?Ce[_e]=Ce[Ne]:v(Ce,_e);for(ae=0;ae<A;ae++)Ce[ae+ue]=arguments[ae+2];return u(Ce,re-V+A),he}})},function(t,r,e){var n=e(27),o=e(79),s=TypeError,a=Object.getOwnPropertyDescriptor,i=n&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(u){return u instanceof TypeError}}();t.exports=i?function(u,c){if(o(u)&&!a(u,"length").writable)throw s("Cannot set read only .length");return u.length=c}:function(u,c){return u.length=c}},function(t,r,e){var n=e(433);t.exports=n},function(t,r,e){var n=e(21),o=e(434),s=Array.prototype;t.exports=function(a){var i=a.sort;return a===s||n(s,a)&&i===s.sort?o:i}},function(t,r,e){e(435);var n=e(30);t.exports=n("Array").sort},function(t,r,e){var n=e(1),o=e(11),s=e(31),a=e(42),i=e(45),u=e(250),c=e(49),d=e(4),m=e(436),v=e(94),g=e(437),b=e(438),T=e(93),k=e(439),y=[],A=o(y.sort),V=o(y.push),he=d(function(){y.sort(void 0)}),ae=d(function(){y.sort(null)}),Ne=v("sort"),_e=!d(function(){if(T)return T<70;if(!(g&&g>3)){if(b)return!0;if(k)return k<603;var Ce,re,ue,ze,le="";for(Ce=65;Ce<76;Ce++){switch(re=String.fromCharCode(Ce),Ce){case 66:case 69:case 70:case 72:ue=3;break;case 68:case 71:ue=4;break;default:ue=2}for(ze=0;ze<47;ze++)y.push({k:re+ze,v:ue})}for(y.sort(function(de,Ie){return Ie.v-de.v}),ze=0;ze<y.length;ze++)re=y[ze].k.charAt(0),le.charAt(le.length-1)!==re&&(le+=re);return le!=="DGBEFHACIJK"}});n({target:"Array",proto:!0,forced:he||!ae||!Ne||!_e},{sort:function(Ce){Ce!==void 0&&s(Ce);var re=a(this);if(_e)return Ce===void 0?A(re):A(re,Ce);var ue,ze,le=[],de=i(re);for(ze=0;ze<de;ze++)ze in re&&V(le,re[ze]);for(m(le,function(Ie){return function(ie,Ve){return Ve===void 0?-1:ie===void 0?1:Ie!==void 0?+Ie(ie,Ve)||0:c(ie)>c(Ve)?1:-1}}(Ce)),ue=i(le),ze=0;ze<ue;)re[ze]=le[ze++];for(;ze<de;)u(re,ze++);return re}})},function(t,r,e){var n=e(219),o=Math.floor,s=function(u,c){var d=u.length,m=o(d/2);return d<8?a(u,c):i(u,s(n(u,0,m),c),s(n(u,m),c),c)},a=function(u,c){for(var d,m,v=u.length,g=1;g<v;){for(m=g,d=u[g];m&&c(u[m-1],d)>0;)u[m]=u[--m];m!==g++&&(u[m]=d)}return u},i=function(u,c,d,m){for(var v=c.length,g=d.length,b=0,T=0;b<v||T<g;)u[b+T]=b<v&&T<g?m(c[b],d[T])<=0?c[b++]:d[T++]:b<v?c[b++]:d[T++];return u};t.exports=s},function(t,r,e){var n=e(64).match(/firefox\/(\d+)/i);t.exports=!!n&&+n[1]},function(t,r,e){var n=e(64);t.exports=/MSIE|Trident/.test(n)},function(t,r,e){var n=e(64).match(/AppleWebKit\/(\d+)\./);t.exports=!!n&&+n[1]},function(t,r,e){var n=e(441);t.exports=n},function(t,r,e){var n=e(21),o=e(442),s=Array.prototype;t.exports=function(a){var i=a.map;return a===s||n(s,a)&&i===s.map?o:i}},function(t,r,e){e(443);var n=e(30);t.exports=n("Array").map},function(t,r,e){var n=e(1),o=e(84).map;n({target:"Array",proto:!0,forced:!e(111)("map")},{map:function(s){return o(this,s,arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(445);t.exports=n},function(t,r,e){var n=e(21),o=e(446),s=Array.prototype;t.exports=function(a){var i=a.reduce;return a===s||n(s,a)&&i===s.reduce?o:i}},function(t,r,e){e(447);var n=e(30);t.exports=n("Array").reduce},function(t,r,e){var n=e(1),o=e(448).left,s=e(94),a=e(93),i=e(114);n({target:"Array",proto:!0,forced:!s("reduce")||!i&&a>79&&a<83},{reduce:function(u){var c=arguments.length;return o(this,u,c,c>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(31),o=e(42),s=e(124),a=e(45),i=TypeError,u=function(c){return function(d,m,v,g){n(m);var b=o(d),T=s(b),k=a(b),y=c?k-1:0,A=c?-1:1;if(v<2)for(;;){if(y in T){g=T[y],y+=A;break}if(y+=A,c?y<0:k<=y)throw i("Reduce of empty array with no initial value")}for(;c?y>=0:k>y;y+=A)y in T&&(g=m(g,T[y],y,b));return g}};t.exports={left:u(!1),right:u(!0)}},function(t,r,e){var n=e(450);t.exports=n},function(t,r,e){var n=e(21),o=e(451),s=Array.prototype;t.exports=function(a){var i=a.lastIndexOf;return a===s||n(s,a)&&i===s.lastIndexOf?o:i}},function(t,r,e){e(452);var n=e(30);t.exports=n("Array").lastIndexOf},function(t,r,e){var n=e(1),o=e(453);n({target:"Array",proto:!0,forced:o!==[].lastIndexOf},{lastIndexOf:o})},function(t,r,e){var n=e(76),o=e(43),s=e(110),a=e(45),i=e(94),u=Math.min,c=[].lastIndexOf,d=!!c&&1/[1].lastIndexOf(1,-0)<0,m=i("lastIndexOf"),v=d||!m;t.exports=v?function(g){if(d)return n(c,this,arguments)||0;var b=o(this),T=a(b),k=T-1;for(arguments.length>1&&(k=u(k,s(arguments[1]))),k<0&&(k=T+k);k>=0;k--)if(k in b&&b[k]===g)return k||0;return-1}:c},function(t,r,e){e(251);var n=e(12);t.exports=n.setTimeout},function(t,r,e){var n=e(1),o=e(14),s=e(252)(o.setInterval,!0);n({global:!0,bind:!0,forced:o.setInterval!==s},{setInterval:s})},function(t,r){t.exports=typeof Bun=="function"&&Bun&&typeof Bun.version=="string"},function(t,r,e){var n=e(1),o=e(14),s=e(252)(o.setTimeout,!0);n({global:!0,bind:!0,forced:o.setTimeout!==s},{setTimeout:s})},function(t,r,e){var n=e(459);t.exports=n},function(t,r,e){var n=e(21),o=e(460),s=Array.prototype;t.exports=function(a){var i=a.filter;return a===s||n(s,a)&&i===s.filter?o:i}},function(t,r,e){e(461);var n=e(30);t.exports=n("Array").filter},function(t,r,e){var n=e(1),o=e(84).filter;n({target:"Array",proto:!0,forced:!e(111)("filter")},{filter:function(s){return o(this,s,arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){t.exports=e(463)},function(t,r,e){e(67);var n=e(65),o=e(29),s=e(21),a=e(464),i=Array.prototype,u={DOMTokenList:!0,NodeList:!0};t.exports=function(c){var d=c.values;return c===i||s(i,c)&&d===i.values||o(u,n(c))?a:d}},function(t,r,e){var n=e(465);t.exports=n},function(t,r,e){e(82),e(96);var n=e(30);t.exports=n("Array").values},function(t,r,e){e(113),e(467);var n=e(12);t.exports=n.Array.from},function(t,r,e){var n=e(1),o=e(468);n({target:"Array",stat:!0,forced:!e(243)(function(s){Array.from(s)})},{from:o})},function(t,r,e){var n=e(34),o=e(19),s=e(42),a=e(469),i=e(233),u=e(129),c=e(45),d=e(95),m=e(234),v=e(136),g=Array;t.exports=function(b){var T=s(b),k=u(this),y=arguments.length,A=y>1?arguments[1]:void 0,V=A!==void 0;V&&(A=n(A,y>2?arguments[2]:void 0));var he,ae,Ne,_e,Ce,re,ue=v(T),ze=0;if(!ue||this===g&&i(ue))for(he=c(T),ae=k?new this(he):g(he);he>ze;ze++)re=V?A(T[ze],ze):T[ze],d(ae,ze,re);else for(Ce=(_e=m(T,ue)).next,ae=k?new this:[];!(Ne=o(Ce,_e)).done;ze++)re=V?a(_e,A,[Ne.value,ze],!0):Ne.value,d(ae,ze,re);return ae.length=ze,ae}},function(t,r,e){var n=e(36),o=e(235);t.exports=function(s,a,i,u){try{return u?a(n(i)[0],i[1]):a(i)}catch(c){o(s,"throw",c)}}},function(t,r,e){t.exports=e(471)},function(t,r,e){var n=e(472);t.exports=n},function(t,r,e){var n=e(473);t.exports=n},function(t,r,e){var n=e(474);e(67),t.exports=n},function(t,r,e){e(82),e(113);var n=e(136);t.exports=n},function(t,r,e){e(218);var n=e(12);t.exports=n.Object.getOwnPropertySymbols},function(t,r,e){var n=e(477);t.exports=n},function(t,r,e){e(478);var n=e(12).Object,o=t.exports=function(s,a){return n.getOwnPropertyDescriptor(s,a)};n.getOwnPropertyDescriptor.sham&&(o.sham=!0)},function(t,r,e){var n=e(1),o=e(4),s=e(43),a=e(90).f,i=e(27),u=o(function(){a(1)});n({target:"Object",stat:!0,forced:!i||u,sham:!i},{getOwnPropertyDescriptor:function(c,d){return a(s(c),d)}})},function(t,r,e){var n=e(480);t.exports=n},function(t,r,e){e(481);var n=e(12);t.exports=n.Object.getOwnPropertyDescriptors},function(t,r,e){var n=e(1),o=e(27),s=e(232),a=e(43),i=e(90),u=e(95);n({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(c){for(var d,m,v=a(c),g=i.f,b=s(v),T={},k=0;b.length>k;)(m=g(v,d=b[k++]))!==void 0&&u(T,d,m);return T}})},function(t,r,e){var n=e(483);t.exports=n},function(t,r,e){e(484);var n=e(12).Object,o=t.exports=function(s,a){return n.defineProperties(s,a)};n.defineProperties.sham&&(o.sham=!0)},function(t,r,e){var n=e(1),o=e(27),s=e(162).f;n({target:"Object",stat:!0,forced:Object.defineProperties!==s,sham:!o},{defineProperties:s})},function(t,r,e){var n=e(13);typeof window<"u"&&(window.console||n.isWeixinApp||(window.console={log:function(){},info:function(){},warn:function(){},error:function(){}}))},function(t,r,e){var n=e(487);t.exports=function(o){return n(o,5)}},function(t,r,e){var n=e(488),o=e(517),s=e(259),a=e(519),i=e(528),u=e(531),c=e(532),d=e(533),m=e(535),v=e(536),g=e(537),b=e(180),T=e(541),k=e(542),y=e(548),A=e(174),V=e(262),he=e(550),ae=e(88),Ne=e(552),_e=e(173),Ce=e(178),re={};re["[object Arguments]"]=re["[object Array]"]=re["[object ArrayBuffer]"]=re["[object DataView]"]=re["[object Boolean]"]=re["[object Date]"]=re["[object Float32Array]"]=re["[object Float64Array]"]=re["[object Int8Array]"]=re["[object Int16Array]"]=re["[object Int32Array]"]=re["[object Map]"]=re["[object Number]"]=re["[object Object]"]=re["[object RegExp]"]=re["[object Set]"]=re["[object String]"]=re["[object Symbol]"]=re["[object Uint8Array]"]=re["[object Uint8ClampedArray]"]=re["[object Uint16Array]"]=re["[object Uint32Array]"]=!0,re["[object Error]"]=re["[object Function]"]=re["[object WeakMap]"]=!1,t.exports=function ue(ze,le,de,Ie,ie,Ve){var Ue,Dt=1&le,tr=2&le,dr=4&le;if(de&&(Ue=ie?de(ze,Ie,ie,Ve):de(ze)),Ue!==void 0)return Ue;if(!ae(ze))return ze;var fr=A(ze);if(fr){if(Ue=T(ze),!Dt)return c(ze,Ue)}else{var sr=b(ze),hr=sr=="[object Function]"||sr=="[object GeneratorFunction]";if(V(ze))return u(ze,Dt);if(sr=="[object Object]"||sr=="[object Arguments]"||hr&&!ie){if(Ue=tr||hr?{}:y(ze),!Dt)return tr?m(ze,i(Ue,ze)):d(ze,a(Ue,ze))}else{if(!re[sr])return ie?ze:{};Ue=k(ze,sr,Dt)}}Ve||(Ve=new n);var Fe=Ve.get(ze);if(Fe)return Fe;Ve.set(ze,Ue),Ne(ze)?ze.forEach(function(ir){Ue.add(ue(ir,le,de,ir,ze,Ve))}):he(ze)&&ze.forEach(function(ir,$e){Ue.set($e,ue(ir,le,de,$e,ze,Ve))});var or=fr?void 0:(dr?tr?g:v:tr?Ce:_e)(ze);return o(or||ze,function(ir,$e){or&&(ir=ze[$e=ir]),s(Ue,$e,ue(ir,le,de,$e,ze,Ve))}),Ue}},function(t,r,e){var n=e(140),o=e(494),s=e(495),a=e(496),i=e(497),u=e(498);function c(d){var m=this.__data__=new n(d);this.size=m.size}c.prototype.clear=o,c.prototype.delete=s,c.prototype.get=a,c.prototype.has=i,c.prototype.set=u,t.exports=c},function(t,r){t.exports=function(){this.__data__=[],this.size=0}},function(t,r,e){var n=e(141),o=Array.prototype.splice;t.exports=function(s){var a=this.__data__,i=n(a,s);return!(i<0)&&(i==a.length-1?a.pop():o.call(a,i,1),--this.size,!0)}},function(t,r,e){var n=e(141);t.exports=function(o){var s=this.__data__,a=n(s,o);return a<0?void 0:s[a][1]}},function(t,r,e){var n=e(141);t.exports=function(o){return n(this.__data__,o)>-1}},function(t,r,e){var n=e(141);t.exports=function(o,s){var a=this.__data__,i=n(a,o);return i<0?(++this.size,a.push([o,s])):a[i][1]=s,this}},function(t,r,e){var n=e(140);t.exports=function(){this.__data__=new n,this.size=0}},function(t,r){t.exports=function(e){var n=this.__data__,o=n.delete(e);return this.size=n.size,o}},function(t,r){t.exports=function(e){return this.__data__.get(e)}},function(t,r){t.exports=function(e){return this.__data__.has(e)}},function(t,r,e){var n=e(140),o=e(171),s=e(258);t.exports=function(a,i){var u=this.__data__;if(u instanceof n){var c=u.__data__;if(!o||c.length<199)return c.push([a,i]),this.size=++u.size,this;u=this.__data__=new s(c)}return u.set(a,i),this.size=u.size,this}},function(t,r,e){var n=e(255),o=e(502),s=e(88),a=e(257),i=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,d=u.toString,m=c.hasOwnProperty,v=RegExp("^"+d.call(m).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(g){return!(!s(g)||o(g))&&(n(g)?v:i).test(a(g))}},function(t,r,e){var n=e(172),o=Object.prototype,s=o.hasOwnProperty,a=o.toString,i=n?n.toStringTag:void 0;t.exports=function(u){var c=s.call(u,i),d=u[i];try{u[i]=void 0;var m=!0}catch{}var v=a.call(u);return m&&(c?u[i]=d:delete u[i]),v}},function(t,r){var e=Object.prototype.toString;t.exports=function(n){return e.call(n)}},function(t,r,e){var n,o=e(503),s=(n=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function(a){return!!s&&s in a}},function(t,r,e){var n=e(50)["__core-js_shared__"];t.exports=n},function(t,r){t.exports=function(e,n){return e==null?void 0:e[n]}},function(t,r,e){var n=e(506),o=e(140),s=e(171);t.exports=function(){this.size=0,this.__data__={hash:new n,map:new(s||o),string:new n}}},function(t,r,e){var n=e(507),o=e(508),s=e(509),a=e(510),i=e(511);function u(c){var d=-1,m=c==null?0:c.length;for(this.clear();++d<m;){var v=c[d];this.set(v[0],v[1])}}u.prototype.clear=n,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=a,u.prototype.set=i,t.exports=u},function(t,r,e){var n=e(142);t.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(t,r){t.exports=function(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}},function(t,r,e){var n=e(142),o=Object.prototype.hasOwnProperty;t.exports=function(s){var a=this.__data__;if(n){var i=a[s];return i==="__lodash_hash_undefined__"?void 0:i}return o.call(a,s)?a[s]:void 0}},function(t,r,e){var n=e(142),o=Object.prototype.hasOwnProperty;t.exports=function(s){var a=this.__data__;return n?a[s]!==void 0:o.call(a,s)}},function(t,r,e){var n=e(142);t.exports=function(o,s){var a=this.__data__;return this.size+=this.has(o)?0:1,a[o]=n&&s===void 0?"__lodash_hash_undefined__":s,this}},function(t,r,e){var n=e(143);t.exports=function(o){var s=n(this,o).delete(o);return this.size-=s?1:0,s}},function(t,r){t.exports=function(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}},function(t,r,e){var n=e(143);t.exports=function(o){return n(this,o).get(o)}},function(t,r,e){var n=e(143);t.exports=function(o){return n(this,o).has(o)}},function(t,r,e){var n=e(143);t.exports=function(o,s){var a=n(this,o),i=a.size;return a.set(o,s),this.size+=a.size==i?0:1,this}},function(t,r){t.exports=function(e,n){for(var o=-1,s=e==null?0:e.length;++o<s&&n(e[o],o,e)!==!1;);return e}},function(t,r,e){var n=e(83),o=function(){try{var s=n(Object,"defineProperty");return s({},"",{}),s}catch{}}();t.exports=o},function(t,r,e){var n=e(144),o=e(173);t.exports=function(s,a){return s&&n(a,o(a),s)}},function(t,r){t.exports=function(e,n){for(var o=-1,s=Array(e);++o<e;)s[o]=n(o);return s}},function(t,r,e){var n=e(522),o=e(104),s=Object.prototype,a=s.hasOwnProperty,i=s.propertyIsEnumerable,u=n(function(){return arguments}())?n:function(c){return o(c)&&a.call(c,"callee")&&!i.call(c,"callee")};t.exports=u},function(t,r,e){var n=e(119),o=e(104);t.exports=function(s){return o(s)&&n(s)=="[object Arguments]"}},function(t,r){t.exports=function(){return!1}},function(t,r,e){var n=e(525),o=e(175),s=e(176),a=s&&s.isTypedArray,i=a?o(a):n;t.exports=i},function(t,r,e){var n=e(119),o=e(263),s=e(104),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(i){return s(i)&&o(i.length)&&!!a[n(i)]}},function(t,r,e){var n=e(177),o=e(527),s=Object.prototype.hasOwnProperty;t.exports=function(a){if(!n(a))return o(a);var i=[];for(var u in Object(a))s.call(a,u)&&u!="constructor"&&i.push(u);return i}},function(t,r,e){var n=e(264)(Object.keys,Object);t.exports=n},function(t,r,e){var n=e(144),o=e(178);t.exports=function(s,a){return s&&n(a,o(a),s)}},function(t,r,e){var n=e(88),o=e(177),s=e(530),a=Object.prototype.hasOwnProperty;t.exports=function(i){if(!n(i))return s(i);var u=o(i),c=[];for(var d in i)(d!="constructor"||!u&&a.call(i,d))&&c.push(d);return c}},function(t,r){t.exports=function(e){var n=[];if(e!=null)for(var o in Object(e))n.push(o);return n}},function(t,r,e){(function(n){var o=e(50),s=r&&!r.nodeType&&r,a=s&&typeof n=="object"&&n&&!n.nodeType&&n,i=a&&a.exports===s?o.Buffer:void 0,u=i?i.allocUnsafe:void 0;n.exports=function(c,d){if(d)return c.slice();var m=c.length,v=u?u(m):new c.constructor(m);return c.copy(v),v}}).call(this,e(145)(t))},function(t,r){t.exports=function(e,n){var o=-1,s=e.length;for(n||(n=Array(s));++o<s;)n[o]=e[o];return n}},function(t,r,e){var n=e(144),o=e(179);t.exports=function(s,a){return n(s,o(s),a)}},function(t,r){t.exports=function(e,n){for(var o=-1,s=e==null?0:e.length,a=0,i=[];++o<s;){var u=e[o];n(u,o,e)&&(i[a++]=u)}return i}},function(t,r,e){var n=e(144),o=e(266);t.exports=function(s,a){return n(s,o(s),a)}},function(t,r,e){var n=e(269),o=e(179),s=e(173);t.exports=function(a){return n(a,s,o)}},function(t,r,e){var n=e(269),o=e(266),s=e(178);t.exports=function(a){return n(a,s,o)}},function(t,r,e){var n=e(83)(e(50),"DataView");t.exports=n},function(t,r,e){var n=e(83)(e(50),"Promise");t.exports=n},function(t,r,e){var n=e(83)(e(50),"WeakMap");t.exports=n},function(t,r){var e=Object.prototype.hasOwnProperty;t.exports=function(n){var o=n.length,s=new n.constructor(o);return o&&typeof n[0]=="string"&&e.call(n,"index")&&(s.index=n.index,s.input=n.input),s}},function(t,r,e){var n=e(181),o=e(544),s=e(545),a=e(546),i=e(547);t.exports=function(u,c,d){var m=u.constructor;switch(c){case"[object ArrayBuffer]":return n(u);case"[object Boolean]":case"[object Date]":return new m(+u);case"[object DataView]":return o(u,d);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return i(u,d);case"[object Map]":return new m;case"[object Number]":case"[object String]":return new m(u);case"[object RegExp]":return s(u);case"[object Set]":return new m;case"[object Symbol]":return a(u)}}},function(t,r,e){var n=e(50).Uint8Array;t.exports=n},function(t,r,e){var n=e(181);t.exports=function(o,s){var a=s?n(o.buffer):o.buffer;return new o.constructor(a,o.byteOffset,o.byteLength)}},function(t,r){var e=/\w*$/;t.exports=function(n){var o=new n.constructor(n.source,e.exec(n));return o.lastIndex=n.lastIndex,o}},function(t,r,e){var n=e(172),o=n?n.prototype:void 0,s=o?o.valueOf:void 0;t.exports=function(a){return s?Object(s.call(a)):{}}},function(t,r,e){var n=e(181);t.exports=function(o,s){var a=s?n(o.buffer):o.buffer;return new o.constructor(a,o.byteOffset,o.length)}},function(t,r,e){var n=e(549),o=e(268),s=e(177);t.exports=function(a){return typeof a.constructor!="function"||s(a)?{}:n(o(a))}},function(t,r,e){var n=e(88),o=Object.create,s=function(){function a(){}return function(i){if(!n(i))return{};if(o)return o(i);a.prototype=i;var u=new a;return a.prototype=void 0,u}}();t.exports=s},function(t,r,e){var n=e(551),o=e(175),s=e(176),a=s&&s.isMap,i=a?o(a):n;t.exports=i},function(t,r,e){var n=e(180),o=e(104);t.exports=function(s){return o(s)&&n(s)=="[object Map]"}},function(t,r,e){var n=e(553),o=e(175),s=e(176),a=s&&s.isSet,i=a?o(a):n;t.exports=i},function(t,r,e){var n=e(180),o=e(104);t.exports=function(s){return o(s)&&n(s)=="[object Set]"}},function(t,r,e){var n=e(2),o=e(5),s=e(6),a=e(69),i=e(10),u=e(15),c=e(7),d=e(3),m=e(74),v=e(0),g=e(13),b=e(44),T={};function k(){var Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};!Ne.logLevel&&Ne.debug&&(Ne.logLevel="debug"),v.merge(this,{options:Ne,debugEnable:!1,api:"log",style:"color:blue;",logLevel:Ne.logLevel&&Ne.logLevel.toLowerCase()||"off",debug:v.emptyFunc,log:v.emptyFunc,info:v.emptyFunc,warn:v.emptyFunc,error:v.emptyFunc}),this.prefix=Ne.prefix||"",this.localEnable=T.enable&&Ne.dbLog&&Ne.account,this.setDebug(Ne.debug),this.localEnable&&(this._local=new T(Ne.account,Ne.expire),this._local.logError=this.error)}T=e(563);var y=k.prototype,A=["Chrome","Safari","Firefox"],V={debug:1e3,log:2e3,info:3e3,warn:4e3,error:5e3,off:6e3};function he(Ne){var _e,Ce=[];return n(_e=o(V)).call(_e,function(re){V[re]>=V[Ne]&&Ce.push(re)}),Ce}y.setDebug=function(){var Ne=arguments.length>0&&arguments[0]!==void 0&&arguments[0],_e=this;if(_e.debugEnable=Ne||_e.logLevel==="debug",Ne.style&&(_e.style=Ne.style),v.exist(console)){if(_e.logLevel!=="off"){var Ce=console,re=he(_e.logLevel);n(re).call(re,function(ze){_e[ze]=function(){var le=_e.formatArgsAndSave(arguments,ze);s(A).call(A,m.name)!==-1&&v.isString(le[0])&&(le[0]="%c"+le[0],a(le).call(le,1,0,_e.style)),_e._log(ze,le)}}),_e.options.logFunc?_e._log=function(){}:_e._log=function(ze,le){if(ze==="debug"&&(ze="log"),Ce[ze])try{Ce[ze].apply?_e.chrome(ze,le):_e.ie(ze,le)}catch{}},_e.chrome=function(ze,le){s(A).call(A,m.name)!==-1?Ce[ze].apply(Ce,le):_e.ie(ze,le)},_e.ie=function(ze,le){n(le).call(le,function(de){Ce[ze](i(de,null,4))})}}else if(g.isRN||this.localEnable||this.options.logFunc){var ue=!g.isRN&&!this.localEnable;_e.log=function(){_e.formatArgsAndSave(arguments,"log",ue)},_e.info=function(){_e.formatArgsAndSave(arguments,"info",ue)},_e.warn=function(){_e.formatArgsAndSave(arguments,"warn",ue)},_e.error=function(){_e.formatArgsAndSave(arguments,"error",ue)},_e.debug=function(){_e.formatArgsAndSave(arguments,"error",ue)}}}},y.destroy=function(){this.localEnable=!1,this.log=function(){},this.info=function(){},this.warn=function(){},this.error=function(){},this.debug=function(){},this._local&&this._local.destroy()},y.formatArgsAndSave=function(Ne,_e,Ce){var re,ue;Ne=u([]).call(Ne,0);var ze=new Date,le=ae(ze.getMonth()+1)+"-"+ae(ze.getDate())+" "+ae(ze.getHours())+":"+ae(ze.getMinutes())+":"+ae(ze.getSeconds())+":"+ae(ze.getMilliseconds(),3),de=c(re=c(ue="[NIM ".concat(_e.toUpperCase()," ")).call(ue,le," ")).call(re,this.prefix.toUpperCase(),"]  "),Ie="";v.isString(Ne[0])?Ne[0]=de+Ne[0]:a(Ne).call(Ne,0,0,de),n(Ne).call(Ne,function(Ve,Ue){v.isArray(Ve)||v.isObject(Ve)?(Ne[Ue]=v.simpleClone(Ve),Ie+=i(Ne[Ue])+" "):Ie+=Ve+" "});var ie=this.options.logFunc;return ie&&v.isFunction(ie[_e])&&ie[_e].apply(ie,Ne),!Ce&&this.writeLocalLog(Ie,_e,+ze),Ne},y.writeLocalLog=function(Ne,_e,Ce){return g.isRN?this.writeLocalLogRN(Ne,_e,Ce):g.isBrowser?this.writeLocalLogBrowser(Ne,_e,Ce):void 0};var ae=function(Ne,_e){_e=_e||2;for(var Ce=""+Ne;Ce.length<_e;)Ce="0"+Ce;return Ce};y.writeLocalLogBrowser=function(Ne,_e,Ce){this._local&&this._local.saveLog({log:Ne,level:_e,time:Ce})},y.writeLocalLogRN=function(Ne,_e){if(b.rnfs&&b.rnfs.writeFile&&b.rnfs.appendFile&&b.rnfs.DocumentDirectoryPath&&/error|warn|info/.test(_e)){var Ce,re=b.rnfs,ue=re.size/2-256;Ne+=`\r
`,re.nimPromise=re.nimPromise.then(function(){return Ce=ze(re.nimIndex),re.exists(Ce)}).then(function(le){return le?re.appendFile(Ce,Ne):re.writeFile(Ce,Ne)}).then(function(){return re.stat(Ce)}).then(function(le){if(le.size>ue)return re.nimIndex++,re.nimIndex>1&&(re.nimIndex=re.nimIndex%2),re.unlink(ze(re.nimIndex)).catch(function(){return d.resolve()})}).catch(function(){})}function ze(le){return b.rnfs.DocumentDirectoryPath+"/nimlog_"+le+".log"}},t.exports=k},function(t,r,e){var n=e(556);t.exports=n},function(t,r,e){e(557);var n=e(12);t.exports=n.parseFloat},function(t,r,e){var n=e(1),o=e(558);n({global:!0,forced:parseFloat!=o},{parseFloat:o})},function(t,r,e){var n=e(14),o=e(4),s=e(11),a=e(49),i=e(182).trim,u=e(146),c=s("".charAt),d=n.parseFloat,m=n.Symbol,v=m&&m.iterator,g=1/d(u+"-0")!=-1/0||v&&!o(function(){d(Object(v))});t.exports=g?function(b){var T=i(a(b)),k=d(T);return k===0&&c(T,0)=="-"?-0:k}:d},function(t,r,e){var n=e(560);t.exports=n},function(t,r,e){e(561);var n=e(12);t.exports=n.parseInt},function(t,r,e){var n=e(1),o=e(562);n({global:!0,forced:parseInt!=o},{parseInt:o})},function(t,r,e){var n=e(14),o=e(4),s=e(11),a=e(49),i=e(182).trim,u=e(146),c=n.parseInt,d=n.Symbol,m=d&&d.iterator,v=/^[+-]?0x/i,g=s(v.exec),b=c(u+"08")!==8||c(u+"0x16")!==22||m&&!o(function(){c(Object(m))});t.exports=b?function(T,k){var y=i(a(T));return c(y,k>>>0||(g(v,y)?16:10))}:c},function(t,r,e){var n=e(15),o=e(3),s=e(564),a=e(565),i=e(0).getGlobal(),u=e(74).name,c=typeof s=="function",d=i.indexedDB&&!/^(IE)$/.test(u);function m(g,b){this.logWorker=null,this.db=null,this.logQueue=[],this.callbackList=[],this.preTime=null,this.lastTime=+new Date,this.initLogLocal({name:g,expire:b})}var v=m.prototype;m.enable=!0,v.saveLog=function(g){if(m.enable){var b,T=this.logQueue.length,k=this.logQueue[T-1];g.time!==this.preTime?((this.logQueue.length>50||g.time-this.lastTime>6e4&&this.logQueue.length>0)&&(this.doSaveLog(n(b=this.logQueue).call(b,0)),this.lastTime=k.time,this.logQueue=[]),this.logQueue.push(g),this.preTime=g.time):k.log+=`\r
`+g.log}},v.destroy=function(){this.logQueue=[]},v.doSaveLog=function(){},v.initLogLocal=function(){},v.fetchLog=function(){},v.deleteLogs=function(){},v.logError=function(){},d?c?(v.doSaveLog=function(g){this.logWorker.postMessage(g)},v.initLogLocal=function(g){var b=this;this.logWorker=new s({}),this.logWorker.onmessage=function(T){var k=T.data||{};switch(k.type){case"fetchDone":b.fetchLogDone(k.code,k.msg);break;case"error":b.logError(k.msg)}},this.logWorker.postMessage({type:"init",msg:g})},v.fetchLog=function(){var g=this;return new o(function(b,T){g.callbackList.length===0&&g.logWorker.postMessage({type:"fetch"}),g.callbackList.push(b),g.callbackList.push(T)})},v.fetchLogDone=function(g,b){for(var T=g===200?0:1,k=0;k<this.callbackList.length/2;k++)this.callbackList[2*k+T](b);this.callbackList=[]},v.deleteLogs=function(g){return this.logWorker.postMessage({type:"delete",msg:g}),o.resolve()}):(v.doSaveLog=function(g){var b=this;this.db.putLog(g).catch(function(T){b.logError({msg:"putLog error",error:T})})},v.initLogLocal=function(g){var b=this;this.db=new a(g),this.db.init().catch(function(T){b.logError({msg:"dbLog init error",error:T})})},v.fetchLog=function(){return this.db.getAllLogs()},v.deleteLogs=function(g){return this.db.deleteLogs(g)}):m.enable=!1,t.exports=m},function(t,r,e){e.r(r),e.d(r,"default",function(){return s});var n=e(296),o=e.n(n);function s(){return o()(`/*!
 * 
 * VERSION: 9.12.2
 * Git Hash: 4f80425748726d259a3375f1aa196861a10e6b77
 * 
 * Create At: 2023/8/4 下午4:18:45
 * 
 * Target: NIM_Web_log.worker
 */!function(t){var n={};function r(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)r.d(e,o,function(n){return t[n]}.bind(null,o));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=109)}([function(t,n,r){"use strict";var e=r(1),o=r(41),i=r(78),c=r(2),u=r(43).f,a=r(84),f=r(13),s=r(34),p=r(19),l=r(8),v=function(t){var n=function(r,e,i){if(this instanceof n){switch(arguments.length){case 0:return new t;case 1:return new t(r);case 2:return new t(r,e)}return new t(r,e,i)}return o(t,this,arguments)};return n.prototype=t.prototype,n};t.exports=function(t,n){var r,o,d,y,h,m,g,x,b,w=t.target,S=t.global,j=t.stat,O=t.proto,P=S?e:j?e[w]:(e[w]||{}).prototype,T=S?f:f[w]||p(f,w,{})[w],A=T.prototype;for(y in n)o=!(r=a(S?y:w+(j?".":"#")+y,t.forced))&&P&&l(P,y),m=T[y],o&&(g=t.dontCallGetSet?(b=u(P,y))&&b.value:P[y]),h=o&&g?g:n[y],o&&typeof m==typeof h||(x=t.bind&&o?s(h,e):t.wrap&&o?v(h):O&&c(h)?i(h):h,(t.sham||h&&h.sham||m&&m.sham)&&p(x,"sham",!0),p(T,y,x),O&&(l(f,d=w+"Prototype")||p(f,d,{}),p(f[d],y,h),t.real&&A&&(r||!A[y])&&p(A,y,h)))}},function(t,n,r){(function(n){var r=function(t){return t&&t.Math==Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n&&n)||function(){return this}()||Function("return this")()}).call(this,r(77))},function(t,n,r){var e=r(79),o=e.all;t.exports=e.IS_HTMLDDA?function(t){return"function"==typeof t||t===o}:function(t){return"function"==typeof t}},function(t,n,r){var e=r(13),o=r(8),i=r(75),c=r(16).f;t.exports=function(t){var n=e.Symbol||(e.Symbol={});o(n,t)||c(n,t,{value:i.f(t)})}},function(t,n,r){var e=r(1),o=r(33),i=r(8),c=r(60),u=r(24),a=r(82),f=o("wks"),s=e.Symbol,p=s&&s.for,l=a?s:s&&s.withoutSetter||c;t.exports=function(t){if(!i(f,t)||!u&&"string"!=typeof f[t]){var n="Symbol."+t;u&&i(s,t)?f[t]=s[t]:f[t]=a&&p?p(n):l(n)}return f[t]}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(42),o=Function.prototype,i=o.call,c=e&&o.bind.bind(i,i);t.exports=e?c:function(t){return function(){return i.apply(t,arguments)}}},function(t,n,r){var e=r(42),o=Function.prototype.call;t.exports=e?o.bind(o):function(){return o.apply(o,arguments)}},function(t,n,r){var e=r(6),o=r(25),i=e({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,n){return i(o(t),n)}},function(t,n,r){var e=r(13),o=r(1),i=r(2),c=function(t){return i(t)?t:void 0};t.exports=function(t,n){return arguments.length<2?c(e[t])||c(o[t]):e[t]&&e[t][n]||o[t]&&o[t][n]}},function(t,n,r){var e=r(2),o=r(79),i=o.all;t.exports=o.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:e(t)||t===i}:function(t){return"object"==typeof t?null!==t:e(t)}},function(t,n,r){var e=r(5);t.exports=!e((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,n,r){var e=r(10),o=String,i=TypeError;t.exports=function(t){if(e(t))return t;throw i(o(t)+" is not an object")}},function(t,n){t.exports={}},function(t,n,r){var e=r(6);t.exports=e({}.isPrototypeOf)},function(t,n){t.exports=!0},function(t,n,r){var e=r(11),o=r(83),i=r(85),c=r(12),u=r(45),a=TypeError,f=Object.defineProperty,s=Object.getOwnPropertyDescriptor;n.f=e?i?function(t,n,r){if(c(t),n=u(n),c(r),"function"==typeof t&&"prototype"===n&&"value"in r&&"writable"in r&&!r.writable){var e=s(t,n);e&&e.writable&&(t[n]=r.value,r={configurable:"configurable"in r?r.configurable:e.configurable,enumerable:"enumerable"in r?r.enumerable:e.enumerable,writable:!1})}return f(t,n,r)}:f:function(t,n,r){if(c(t),n=u(n),c(r),o)try{return f(t,n,r)}catch(t){}if("get"in r||"set"in r)throw a("Accessors not supported");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(2),o=r(32),i=TypeError;t.exports=function(t){if(e(t))return t;throw i(o(t)+" is not a function")}},function(t,n,r){var e=r(81),o=r(57);t.exports=function(t){return e(o(t))}},function(t,n,r){var e=r(11),o=r(16),i=r(20);t.exports=e?function(t,n,r){return o.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n,r){var e=r(19);t.exports=function(t,n,r,o){return o&&o.enumerable?t[n]=r:e(t,n,r),t}},function(t,n,r){"use strict";var e=r(17),o=TypeError,i=function(t){var n,r;this.promise=new t((function(t,e){if(void 0!==n||void 0!==r)throw o("Bad Promise constructor");n=t,r=e})),this.resolve=e(n),this.reject=e(r)};t.exports.f=function(t){return new i(t)}},function(t,n,r){var e=r(6),o=e({}.toString),i=e("".slice);t.exports=function(t){return i(o(t),8,-1)}},function(t,n,r){var e=r(47),o=r(5);t.exports=!!Object.getOwnPropertySymbols&&!o((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&e&&e<41}))},function(t,n,r){var e=r(57),o=Object;t.exports=function(t){return o(e(t))}},function(t,n,r){var e=r(124);t.exports=function(t){return e(t.length)}},function(t,n){t.exports={}},function(t,n,r){var e=r(70),o=r(2),i=r(23),c=r(4)("toStringTag"),u=Object,a="Arguments"==i(function(){return arguments}());t.exports=e?i:function(t){var n,r,e;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,n){try{return t[n]}catch(t){}}(n=u(t),c))?r:a?i(n):"Object"==(e=i(n))&&o(n.callee)?"Arguments":e}},function(t,n,r){var e=r(70),o=r(16).f,i=r(19),c=r(8),u=r(136),a=r(4)("toStringTag");t.exports=function(t,n,r,f){if(t){var s=r?t:t.prototype;c(s,a)||o(s,a,{configurable:!0,value:n}),f&&!e&&i(s,"toString",u)}}},function(t,n,r){var e=r(1);t.exports=e.Promise},function(t,n,r){var e=r(9);t.exports=e("navigator","userAgent")||""},function(t,n){var r=String;t.exports=function(t){try{return r(t)}catch(t){return"Object"}}},function(t,n,r){var e=r(15),o=r(59);(t.exports=function(t,n){return o[t]||(o[t]=void 0!==n?n:{})})("versions",[]).push({version:"3.27.1",mode:e?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.27.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(t,n,r){var e=r(78),o=r(17),i=r(42),c=e(e.bind);t.exports=function(t,n){return o(t),void 0===n?t:i?c(t,n):function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(34),o=r(7),i=r(12),c=r(32),u=r(127),a=r(26),f=r(14),s=r(128),p=r(89),l=r(129),v=TypeError,d=function(t,n){this.stopped=t,this.result=n},y=d.prototype;t.exports=function(t,n,r){var h,m,g,x,b,w,S,j=r&&r.that,O=!(!r||!r.AS_ENTRIES),P=!(!r||!r.IS_RECORD),T=!(!r||!r.IS_ITERATOR),A=!(!r||!r.INTERRUPTED),E=e(n,j),k=function(t){return h&&l(h,"normal",t),new d(!0,t)},I=function(t){return O?(i(t),A?E(t[0],t[1],k):E(t[0],t[1])):A?E(t,k):E(t)};if(P)h=t.iterator;else if(T)h=t;else{if(!(m=p(t)))throw v(c(t)+" is not iterable");if(u(m)){for(g=0,x=a(t);x>g;g++)if((b=I(t[g]))&&f(y,b))return b;return new d(!1)}h=s(t,m)}for(w=P?t.next:h.next;!(S=o(w,h)).done;){try{b=I(S.value)}catch(t){l(h,"throw",t)}if("object"==typeof b&&b&&f(y,b))return b}return new d(!1)}},function(t,n,r){var e=r(28),o=String;t.exports=function(t){if("Symbol"===e(t))throw TypeError("Cannot convert a Symbol value to a string");return o(t)}},function(t,n){t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},function(t,n,r){var e=r(1),o=r(30),i=r(2),c=r(84),u=r(94),a=r(4),f=r(147),s=r(98),p=r(15),l=r(47),v=o&&o.prototype,d=a("species"),y=!1,h=i(e.PromiseRejectionEvent),m=c("Promise",(function(){var t=u(o),n=t!==String(o);if(!n&&66===l)return!0;if(p&&(!v.catch||!v.finally))return!0;if(!l||l<51||!/native code/.test(t)){var r=new o((function(t){t(1)})),e=function(t){t((function(){}),(function(){}))};if((r.constructor={})[d]=e,!(y=r.then((function(){}))instanceof e))return!0}return!n&&(f||s)&&!h}));t.exports={CONSTRUCTOR:m,REJECTION_EVENT:h,SUBCLASSING:y}},function(t,n,r){var e=r(23);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){var e=r(13);t.exports=function(t){return e[t+"Prototype"]}},function(t,n,r){var e=r(42),o=Function.prototype,i=o.apply,c=o.call;t.exports="object"==typeof Reflect&&Reflect.apply||(e?c.bind(i):function(){return c.apply(i,arguments)})},function(t,n,r){var e=r(5);t.exports=!e((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},function(t,n,r){var e=r(11),o=r(7),i=r(80),c=r(20),u=r(18),a=r(45),f=r(8),s=r(83),p=Object.getOwnPropertyDescriptor;n.f=e?p:function(t,n){if(t=u(t),n=a(n),s)try{return p(t,n)}catch(t){}if(f(t,n))return c(!o(i.f,t,n),t[n])}},function(t,n){t.exports=function(t){return null==t}},function(t,n,r){var e=r(115),o=r(46);t.exports=function(t){var n=e(t,"string");return o(n)?n:n+""}},function(t,n,r){var e=r(9),o=r(2),i=r(14),c=r(82),u=Object;t.exports=c?function(t){return"symbol"==typeof t}:function(t){var n=e("Symbol");return o(n)&&i(n.prototype,u(t))}},function(t,n,r){var e,o,i=r(1),c=r(31),u=i.process,a=i.Deno,f=u&&u.versions||a&&a.version,s=f&&f.v8;s&&(o=(e=s.split("."))[0]>0&&e[0]<4?1:+(e[0]+e[1])),!o&&c&&(!(e=c.match(/Edge\\/(\\d+)/))||e[1]>=74)&&(e=c.match(/Chrome\\/(\\d+)/))&&(o=+e[1]),t.exports=o},function(t,n,r){var e=r(33),o=r(60),i=e("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},function(t,n){t.exports={}},function(t,n,r){var e,o=r(12),i=r(87),c=r(67),u=r(49),a=r(88),f=r(61),s=r(48),p=s("IE_PROTO"),l=function(){},v=function(t){return"<script>"+t+"<\\/script>"},d=function(t){t.write(v("")),t.close();var n=t.parentWindow.Object;return t=null,n},y=function(){try{e=new ActiveXObject("htmlfile")}catch(t){}var t,n;y="undefined"!=typeof document?document.domain&&e?d(e):((n=f("iframe")).style.display="none",a.appendChild(n),n.src=String("javascript:"),(t=n.contentWindow.document).open(),t.write(v("document.F=Object")),t.close(),t.F):d(e);for(var r=c.length;r--;)delete y.prototype[c[r]];return y()};u[p]=!0,t.exports=Object.create||function(t,n){var r;return null!==t?(l.prototype=o(t),r=new l,l.prototype=null,r[p]=t):r=y(),void 0===n?r:i.f(r,n)}},function(t,n,r){var e,o,i,c=r(133),u=r(1),a=r(10),f=r(19),s=r(8),p=r(59),l=r(48),v=r(49),d=u.TypeError,y=u.WeakMap;if(c||p.state){var h=p.state||(p.state=new y);h.get=h.get,h.has=h.has,h.set=h.set,e=function(t,n){if(h.has(t))throw d("Object already initialized");return n.facade=t,h.set(t,n),n},o=function(t){return h.get(t)||{}},i=function(t){return h.has(t)}}else{var m=l("state");v[m]=!0,e=function(t,n){if(s(t,m))throw d("Object already initialized");return n.facade=t,f(t,m,n),n},o=function(t){return s(t,m)?t[m]:{}},i=function(t){return s(t,m)}}t.exports={set:e,get:o,has:i,enforce:function(t){return i(t)?o(t):e(t,{})},getterFor:function(t){return function(n){var r;if(!a(n)||(r=o(n)).type!==t)throw d("Incompatible receiver, "+t+" required");return r}}}},function(t,n,r){var e=r(23),o=r(1);t.exports="process"==e(o.process)},function(t,n,r){var e=r(6);t.exports=e([].slice)},function(t,n,r){r(71);var e=r(158),o=r(1),i=r(28),c=r(19),u=r(27),a=r(4)("toStringTag");for(var f in e){var s=o[f],p=s&&s.prototype;p&&i(p)!==a&&c(p,a,f),u[f]=u.Array}},function(t,n,r){var e=r(5),o=r(4),i=r(47),c=o("species");t.exports=function(t){return i>=51||!e((function(){var n=[];return(n.constructor={})[c]=function(){return{foo:1}},1!==n[t](Boolean).foo}))}},function(t,n,r){var e=r(34),o=r(6),i=r(81),c=r(25),u=r(26),a=r(103),f=o([].push),s=function(t){var n=1==t,r=2==t,o=3==t,s=4==t,p=6==t,l=7==t,v=5==t||p;return function(d,y,h,m){for(var g,x,b=c(d),w=i(b),S=e(y,h),j=u(w),O=0,P=m||a,T=n?P(d,j):r||l?P(d,0):void 0;j>O;O++)if((v||O in w)&&(x=S(g=w[O],O,b),t))if(n)T[O]=x;else if(x)switch(t){case 3:return!0;case 5:return g;case 6:return O;case 2:f(T,g)}else switch(t){case 4:return!1;case 7:f(T,g)}return p?-1:o||s?s:T}};t.exports={forEach:s(0),map:s(1),filter:s(2),some:s(3),every:s(4),find:s(5),findIndex:s(6),filterReject:s(7)}},function(t,n,r){var e=r(44),o=TypeError;t.exports=function(t){if(e(t))throw o("Can't call method on "+t);return t}},function(t,n,r){var e=r(17),o=r(44);t.exports=function(t,n){var r=t[n];return o(r)?void 0:e(r)}},function(t,n,r){var e=r(1),o=r(117),i=e["__core-js_shared__"]||o("__core-js_shared__",{});t.exports=i},function(t,n,r){var e=r(6),o=0,i=Math.random(),c=e(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+c(++o+i,36)}},function(t,n,r){var e=r(1),o=r(10),i=e.document,c=o(i)&&o(i.createElement);t.exports=function(t){return c?i.createElement(t):{}}},function(t,n,r){var e=r(8),o=r(2),i=r(25),c=r(48),u=r(118),a=c("IE_PROTO"),f=Object,s=f.prototype;t.exports=u?f.getPrototypeOf:function(t){var n=i(t);if(e(n,a))return n[a];var r=n.constructor;return o(r)&&n instanceof r?r.prototype:n instanceof f?s:null}},function(t,n,r){var e=r(6),o=r(12),i=r(119);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,n=!1,r={};try{(t=e(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),n=r instanceof Array}catch(t){}return function(r,e){return o(r),i(e),n?t(r,e):r.__proto__=e,r}}():void 0)},function(t,n,r){var e=r(86),o=r(67).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,o)}},function(t,n,r){var e=r(66),o=Math.max,i=Math.min;t.exports=function(t,n){var r=e(t);return r<0?o(r+n,0):i(r,n)}},function(t,n,r){var e=r(123);t.exports=function(t){var n=+t;return n!=n||0===n?0:e(n)}},function(t,n){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(86),o=r(67);t.exports=Object.keys||function(t){return e(t,o)}},function(t,n,r){var e={};e[r(4)("toStringTag")]="z",t.exports="[object z]"===String(e)},function(t,n,r){"use strict";var e=r(18),o=r(132),i=r(27),c=r(51),u=r(16).f,a=r(90),f=r(92),s=r(15),p=r(11),l=c.set,v=c.getterFor("Array Iterator");t.exports=a(Array,"Array",(function(t,n){l(this,{type:"Array Iterator",target:e(t),index:0,kind:n})}),(function(){var t=v(this),n=t.target,r=t.kind,e=t.index++;return!n||e>=n.length?(t.target=void 0,f(void 0,!0)):f("keys"==r?e:"values"==r?n[e]:[e,n[e]],!1)}),"values");var d=i.Arguments=i.Array;if(o("keys"),o("values"),o("entries"),!s&&p&&"values"!==d.name)try{u(d,"name",{value:"values"})}catch(t){}},function(t,n){},function(t,n,r){var e=r(6),o=r(5),i=r(2),c=r(28),u=r(9),a=r(94),f=function(){},s=[],p=u("Reflect","construct"),l=/^\\s*(?:class|function)\\b/,v=e(l.exec),d=!l.exec(f),y=function(t){if(!i(t))return!1;try{return p(f,s,t),!0}catch(t){return!1}},h=function(t){if(!i(t))return!1;switch(c(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return d||!!v(l,a(t))}catch(t){return!0}};h.sham=!0,t.exports=!p||o((function(){var t;return y(y.call)||!y(Object)||!y((function(){t=!0}))||t}))?h:y},function(t,n,r){"use strict";var e=r(45),o=r(16),i=r(20);t.exports=function(t,n,r){var c=e(n);c in t?o.f(t,c,i(0,r)):t[c]=r}},function(t,n,r){var e=r(4);n.f=e},function(t,n,r){t.exports=r(111)},function(t,n){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,n,r){var e=r(23),o=r(6);t.exports=function(t){if("Function"===e(t))return o(t)}},function(t,n){var r="object"==typeof document&&document.all,e=void 0===r&&void 0!==r;t.exports={all:r,IS_HTMLDDA:e}},function(t,n,r){"use strict";var e={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!e.call({1:2},1);n.f=i?function(t){var n=o(this,t);return!!n&&n.enumerable}:e},function(t,n,r){var e=r(6),o=r(5),i=r(23),c=Object,u=e("".split);t.exports=o((function(){return!c("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?u(t,""):c(t)}:c},function(t,n,r){var e=r(24);t.exports=e&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,n,r){var e=r(11),o=r(5),i=r(61);t.exports=!e&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},function(t,n,r){var e=r(5),o=r(2),i=/#|\\.prototype\\./,c=function(t,n){var r=a[u(t)];return r==s||r!=f&&(o(n)?e(n):!!n)},u=c.normalize=function(t){return String(t).replace(i,".").toLowerCase()},a=c.data={},f=c.NATIVE="N",s=c.POLYFILL="P";t.exports=c},function(t,n,r){var e=r(11),o=r(5);t.exports=e&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(t,n,r){var e=r(6),o=r(8),i=r(18),c=r(122).indexOf,u=r(49),a=e([].push);t.exports=function(t,n){var r,e=i(t),f=0,s=[];for(r in e)!o(u,r)&&o(e,r)&&a(s,r);for(;n.length>f;)o(e,r=n[f++])&&(~c(s,r)||a(s,r));return s}},function(t,n,r){var e=r(11),o=r(85),i=r(16),c=r(12),u=r(18),a=r(69);n.f=e&&!o?Object.defineProperties:function(t,n){c(t);for(var r,e=u(n),o=a(n),f=o.length,s=0;f>s;)i.f(t,r=o[s++],e[r]);return t}},function(t,n,r){var e=r(9);t.exports=e("document","documentElement")},function(t,n,r){var e=r(28),o=r(58),i=r(44),c=r(27),u=r(4)("iterator");t.exports=function(t){if(!i(t))return o(t,u)||o(t,"@@iterator")||c[e(t)]}},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(15),c=r(134),u=r(2),a=r(135),f=r(62),s=r(63),p=r(29),l=r(19),v=r(21),d=r(4),y=r(27),h=r(91),m=c.PROPER,g=c.CONFIGURABLE,x=h.IteratorPrototype,b=h.BUGGY_SAFARI_ITERATORS,w=d("iterator"),S=function(){return this};t.exports=function(t,n,r,c,d,h,j){a(r,n,c);var O,P,T,A=function(t){if(t===d&&L)return L;if(!b&&t in I)return I[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},E=n+" Iterator",k=!1,I=t.prototype,D=I[w]||I["@@iterator"]||d&&I[d],L=!b&&D||A(d),_="Array"==n&&I.entries||D;if(_&&(O=f(_.call(new t)))!==Object.prototype&&O.next&&(i||f(O)===x||(s?s(O,x):u(O[w])||v(O,w,S)),p(O,E,!0,!0),i&&(y[E]=S)),m&&"values"==d&&D&&"values"!==D.name&&(!i&&g?l(I,"name","values"):(k=!0,L=function(){return o(D,this)})),d)if(P={values:A("values"),keys:h?L:A("keys"),entries:A("entries")},j)for(T in P)(b||k||!(T in I))&&v(I,T,P[T]);else e({target:n,proto:!0,forced:b||k},P);return i&&!j||I[w]===L||v(I,w,L,{name:d}),y[n]=L,P}},function(t,n,r){"use strict";var e,o,i,c=r(5),u=r(2),a=r(10),f=r(50),s=r(62),p=r(21),l=r(4),v=r(15),d=l("iterator"),y=!1;[].keys&&("next"in(i=[].keys())?(o=s(s(i)))!==Object.prototype&&(e=o):y=!0),!a(e)||c((function(){var t={};return e[d].call(t)!==t}))?e={}:v&&(e=f(e)),u(e[d])||p(e,d,(function(){return this})),t.exports={IteratorPrototype:e,BUGGY_SAFARI_ITERATORS:y}},function(t,n){t.exports=function(t,n){return{value:t,done:n}}},function(t,n,r){var e=r(12),o=r(141),i=r(44),c=r(4)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||i(r=e(u)[c])?n:o(r)}},function(t,n,r){var e=r(6),o=r(2),i=r(59),c=e(Function.toString);o(i.inspectSource)||(i.inspectSource=function(t){return c(t)}),t.exports=i.inspectSource},function(t,n,r){var e,o,i,c,u=r(1),a=r(41),f=r(34),s=r(2),p=r(8),l=r(5),v=r(88),d=r(53),y=r(61),h=r(96),m=r(97),g=r(52),x=u.setImmediate,b=u.clearImmediate,w=u.process,S=u.Dispatch,j=u.Function,O=u.MessageChannel,P=u.String,T=0,A={};try{e=u.location}catch(t){}var E=function(t){if(p(A,t)){var n=A[t];delete A[t],n()}},k=function(t){return function(){E(t)}},I=function(t){E(t.data)},D=function(t){u.postMessage(P(t),e.protocol+"//"+e.host)};x&&b||(x=function(t){h(arguments.length,1);var n=s(t)?t:j(t),r=d(arguments,1);return A[++T]=function(){a(n,void 0,r)},o(T),T},b=function(t){delete A[t]},g?o=function(t){w.nextTick(k(t))}:S&&S.now?o=function(t){S.now(k(t))}:O&&!m?(c=(i=new O).port2,i.port1.onmessage=I,o=f(c.postMessage,c)):u.addEventListener&&s(u.postMessage)&&!u.importScripts&&e&&"file:"!==e.protocol&&!l(D)?(o=D,u.addEventListener("message",I,!1)):o="onreadystatechange"in y("script")?function(t){v.appendChild(y("script")).onreadystatechange=function(){v.removeChild(this),E(t)}}:function(t){setTimeout(k(t),0)}),t.exports={set:x,clear:b}},function(t,n){var r=TypeError;t.exports=function(t,n){if(t<n)throw r("Not enough arguments");return t}},function(t,n,r){var e=r(31);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(e)},function(t,n){t.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},function(t,n,r){var e=r(30),o=r(149),i=r(38).CONSTRUCTOR;t.exports=i||!o((function(t){e.all(t).then(void 0,(function(){}))}))},function(t,n,r){var e=r(12),o=r(10),i=r(22);t.exports=function(t,n){if(e(t),o(n)&&n.constructor===t)return n;var r=i.f(t);return(0,r.resolve)(n),r.promise}},function(t,n,r){"use strict";var e=r(157).charAt,o=r(36),i=r(51),c=r(90),u=r(92),a=i.set,f=i.getterFor("String Iterator");c(String,"String",(function(t){a(this,{type:"String Iterator",string:o(t),index:0})}),(function(){var t,n=f(this),r=n.string,o=n.index;return o>=r.length?u(void 0,!0):(t=e(r,o),n.index+=t.length,u(t,!1))}))},function(t,n,r){t.exports=r(159)},function(t,n,r){var e=r(168);t.exports=function(t,n){return new(e(t))(0===n?0:n)}},function(t,n,r){"use strict";var e=r(0),o=r(5),i=r(39),c=r(10),u=r(25),a=r(26),f=r(177),s=r(74),p=r(103),l=r(55),v=r(4),d=r(47),y=v("isConcatSpreadable"),h=d>=51||!o((function(){var t=[];return t[y]=!1,t.concat()[0]!==t})),m=l("concat"),g=function(t){if(!c(t))return!1;var n=t[y];return void 0!==n?!!n:i(t)};e({target:"Array",proto:!0,arity:1,forced:!h||!m},{concat:function(t){var n,r,e,o,i,c=u(this),l=p(c,0),v=0;for(n=-1,e=arguments.length;n<e;n++)if(g(i=-1===n?c:arguments[n]))for(o=a(i),f(v+o),r=0;r<o;r++,v++)r in i&&s(l,v,i[r]);else f(v+1),s(l,v++,i);return l.length=v,l}})},function(t,n,r){var e=r(7),o=r(9),i=r(4),c=r(21);t.exports=function(){var t=o("Symbol"),n=t&&t.prototype,r=n&&n.valueOf,u=i("toPrimitive");n&&!n[u]&&c(n,u,(function(t){return e(r,this)}),{arity:1})}},function(t,n,r){var e=r(24);t.exports=e&&!!Symbol.for&&!!Symbol.keyFor},function(t,n,r){r(3)("iterator")},function(t,n,r){"use strict";var e,o=r(1),i=r(41),c=r(2),u=r(220),a=r(31),f=r(53),s=r(96),p=o.Function,l=/MSIE .\\./.test(a)||u&&((e=o.Bun.version.split(".")).length<3||0==e[0]&&(e[1]<3||3==e[1]&&0==e[2]));t.exports=function(t,n){var r=n?2:1;return l?function(e,o){var u=s(arguments.length,1)>r,a=c(e)?e:p(e),l=u?f(arguments,r):[],v=u?function(){i(a,this,l)}:a;return n?t(v,o):t(v)}:t}},function(t,n,r){var e=r(110),o=null;function i(t){return t&&"string"!=typeof t?t.message?t.message:t.target&&t.target.error?t.target.error.message:"unknown error":t}self.onmessage=function(t){switch(t.data.type){case"init":r=t.data.msg,(o=new e(r)).init().catch((function(t){postMessage({type:"error",msg:{msg:"dbLog init error",error:i(t)}})}));break;case"fetch":o.getAllLogs().then((function(t){postMessage({type:"fetchDone",code:200,msg:t})})).catch((function(t){postMessage({type:"fetchDone",code:500,msg:i(t)})}));break;case"delete":o.deleteLogs(n).catch((function(t){postMessage({type:"deleteLogs",code:500,msg:i(t)})}));break;default:!function(t){if(!o)return;o.putLog(t).then((function(){postMessage(200)})).catch((function(t){postMessage({type:"error",msg:{msg:"putLog error",error:i(t)}})}))}(t.data)}var n,r}},function(t,n,r){var e=r(76),o=r(102),i=r(163),c=r(169),u={log:{key:{keyPath:"time"},indexes:{level:{unique:!1},time:{unique:!0}}}};function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.server=null,this.expire=t.expire||72,this.name=t.name}var f=a.prototype;f.init=function(){var t=this;if(!this.server)return c.open({server:"nim-log-"+this.name,version:1,schema:u}).then((function(n){t.server=n}))},f.putLog=function(t){var n=this;if(!this.server)return e.reject("no db server");var r=o(t).call(t,-1)[0].time-36e5*this.expire;return this.deleteLogs(r).then((function(){return n.server.add("log",t)}))},f.getAllLogs=function(){return this.server?this.server.query("log","time").all().execute().then((function(t){var n={},r=o(t).call(t,-1)[0];return n.logs=i(t).call(t,(function(t){return t.log})).join("\\r\\n"),n.time=r&&r.time,n})):e.reject("no db server")},f.deleteLogs=function(t){return this.server?this.server.remove("log",null,"time",0,t):e.reject("no db server")},t.exports=a},function(t,n,r){var e=r(112);r(54),t.exports=e},function(t,n,r){r(113),r(71),r(72),r(137),r(154),r(155),r(156),r(101);var e=r(13);t.exports=e.Promise},function(t,n,r){r(114)},function(t,n,r){"use strict";var e=r(0),o=r(14),i=r(62),c=r(63),u=r(120),a=r(50),f=r(19),s=r(20),p=r(125),l=r(126),v=r(35),d=r(130),y=r(4),h=r(131),m=y("toStringTag"),g=Error,x=[].push,b=function(t,n){var r,e=arguments.length>2?arguments[2]:void 0,u=o(w,this);c?r=c(g(),u?i(this):w):(r=u?this:a(w),f(r,m,"Error")),void 0!==n&&f(r,"message",d(n)),h&&f(r,"stack",p(r.stack,1)),l(r,e);var s=[];return v(t,x,{that:s}),f(r,"errors",s),r};c?c(b,g):u(b,g,{name:!0});var w=b.prototype=a(g.prototype,{constructor:s(1,b),message:s(1,""),name:s(1,"AggregateError")});e({global:!0,constructor:!0,arity:2},{AggregateError:b})},function(t,n,r){var e=r(7),o=r(10),i=r(46),c=r(58),u=r(116),a=r(4),f=TypeError,s=a("toPrimitive");t.exports=function(t,n){if(!o(t)||i(t))return t;var r,a=c(t,s);if(a){if(void 0===n&&(n="default"),r=e(a,t,n),!o(r)||i(r))return r;throw f("Can't convert object to primitive value")}return void 0===n&&(n="number"),u(t,n)}},function(t,n,r){var e=r(7),o=r(2),i=r(10),c=TypeError;t.exports=function(t,n){var r,u;if("string"===n&&o(r=t.toString)&&!i(u=e(r,t)))return u;if(o(r=t.valueOf)&&!i(u=e(r,t)))return u;if("string"!==n&&o(r=t.toString)&&!i(u=e(r,t)))return u;throw c("Can't convert object to primitive value")}},function(t,n,r){var e=r(1),o=Object.defineProperty;t.exports=function(t,n){try{o(e,t,{value:n,configurable:!0,writable:!0})}catch(r){e[t]=n}return n}},function(t,n,r){var e=r(5);t.exports=!e((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,n,r){var e=r(2),o=String,i=TypeError;t.exports=function(t){if("object"==typeof t||e(t))return t;throw i("Can't set "+o(t)+" as a prototype")}},function(t,n,r){var e=r(8),o=r(121),i=r(43),c=r(16);t.exports=function(t,n,r){for(var u=o(n),a=c.f,f=i.f,s=0;s<u.length;s++){var p=u[s];e(t,p)||r&&e(r,p)||a(t,p,f(n,p))}}},function(t,n,r){var e=r(9),o=r(6),i=r(64),c=r(68),u=r(12),a=o([].concat);t.exports=e("Reflect","ownKeys")||function(t){var n=i.f(u(t)),r=c.f;return r?a(n,r(t)):n}},function(t,n,r){var e=r(18),o=r(65),i=r(26),c=function(t){return function(n,r,c){var u,a=e(n),f=i(a),s=o(c,f);if(t&&r!=r){for(;f>s;)if((u=a[s++])!=u)return!0}else for(;f>s;s++)if((t||s in a)&&a[s]===r)return t||s||0;return!t&&-1}};t.exports={includes:c(!0),indexOf:c(!1)}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=Math.trunc||function(t){var n=+t;return(n>0?e:r)(n)}},function(t,n,r){var e=r(66),o=Math.min;t.exports=function(t){return t>0?o(e(t),9007199254740991):0}},function(t,n,r){var e=r(6),o=Error,i=e("".replace),c=String(o("zxcasd").stack),u=/\\n\\s*at [^:]*:[^\\n]*/,a=u.test(c);t.exports=function(t,n){if(a&&"string"==typeof t&&!o.prepareStackTrace)for(;n--;)t=i(t,u,"");return t}},function(t,n,r){var e=r(10),o=r(19);t.exports=function(t,n){e(n)&&"cause"in n&&o(t,"cause",n.cause)}},function(t,n,r){var e=r(4),o=r(27),i=e("iterator"),c=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||c[i]===t)}},function(t,n,r){var e=r(7),o=r(17),i=r(12),c=r(32),u=r(89),a=TypeError;t.exports=function(t,n){var r=arguments.length<2?u(t):n;if(o(r))return i(e(r,t));throw a(c(t)+" is not iterable")}},function(t,n,r){var e=r(7),o=r(12),i=r(58);t.exports=function(t,n,r){var c,u;o(t);try{if(!(c=i(t,"return"))){if("throw"===n)throw r;return r}c=e(c,t)}catch(t){u=!0,c=t}if("throw"===n)throw r;if(u)throw c;return o(c),r}},function(t,n,r){var e=r(36);t.exports=function(t,n){return void 0===t?arguments.length<2?"":n:e(t)}},function(t,n,r){var e=r(5),o=r(20);t.exports=!e((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",o(1,7)),7!==t.stack)}))},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(1),o=r(2),i=e.WeakMap;t.exports=o(i)&&/native code/.test(String(i))},function(t,n,r){var e=r(11),o=r(8),i=Function.prototype,c=e&&Object.getOwnPropertyDescriptor,u=o(i,"name"),a=u&&"something"===function(){}.name,f=u&&(!e||e&&c(i,"name").configurable);t.exports={EXISTS:u,PROPER:a,CONFIGURABLE:f}},function(t,n,r){"use strict";var e=r(91).IteratorPrototype,o=r(50),i=r(20),c=r(29),u=r(27),a=function(){return this};t.exports=function(t,n,r,f){var s=n+" Iterator";return t.prototype=o(e,{next:i(+!f,r)}),c(t,s,!1,!0),u[s]=a,t}},function(t,n,r){"use strict";var e=r(70),o=r(28);t.exports=e?{}.toString:function(){return"[object "+o(this)+"]"}},function(t,n,r){r(138),r(148),r(150),r(151),r(152),r(153)},function(t,n,r){"use strict";var e,o,i,c=r(0),u=r(15),a=r(52),f=r(1),s=r(7),p=r(21),l=r(63),v=r(29),d=r(139),y=r(17),h=r(2),m=r(10),g=r(140),x=r(93),b=r(95).set,w=r(142),S=r(145),j=r(37),O=r(146),P=r(51),T=r(30),A=r(38),E=r(22),k=A.CONSTRUCTOR,I=A.REJECTION_EVENT,D=A.SUBCLASSING,L=P.getterFor("Promise"),_=P.set,C=T&&T.prototype,M=T,R=C,N=f.TypeError,F=f.document,B=f.process,G=E.f,U=G,z=!!(F&&F.createEvent&&f.dispatchEvent),q=function(t){var n;return!(!m(t)||!h(n=t.then))&&n},V=function(t,n){var r,e,o,i=n.value,c=1==n.state,u=c?t.ok:t.fail,a=t.resolve,f=t.reject,p=t.domain;try{u?(c||(2===n.rejection&&Y(n),n.rejection=1),!0===u?r=i:(p&&p.enter(),r=u(i),p&&(p.exit(),o=!0)),r===t.promise?f(N("Promise-chain cycle")):(e=q(r))?s(e,r,a,f):a(r)):f(i)}catch(t){p&&!o&&p.exit(),f(t)}},H=function(t,n){t.notified||(t.notified=!0,w((function(){for(var r,e=t.reactions;r=e.get();)V(r,t);t.notified=!1,n&&!t.rejection&&K(t)})))},J=function(t,n,r){var e,o;z?((e=F.createEvent("Event")).promise=n,e.reason=r,e.initEvent(t,!1,!0),f.dispatchEvent(e)):e={promise:n,reason:r},!I&&(o=f["on"+t])?o(e):"unhandledrejection"===t&&S("Unhandled promise rejection",r)},K=function(t){s(b,f,(function(){var n,r=t.facade,e=t.value;if(W(t)&&(n=j((function(){a?B.emit("unhandledRejection",e,r):J("unhandledrejection",r,e)})),t.rejection=a||W(t)?2:1,n.error))throw n.value}))},W=function(t){return 1!==t.rejection&&!t.parent},Y=function(t){s(b,f,(function(){var n=t.facade;a?B.emit("rejectionHandled",n):J("rejectionhandled",n,t.value)}))},X=function(t,n,r){return function(e){t(n,e,r)}},$=function(t,n,r){t.done||(t.done=!0,r&&(t=r),t.value=n,t.state=2,H(t,!0))},Q=function(t,n,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===n)throw N("Promise can't be resolved itself");var e=q(n);e?w((function(){var r={done:!1};try{s(e,n,X(Q,r,t),X($,r,t))}catch(n){$(r,n,t)}})):(t.value=n,t.state=1,H(t,!1))}catch(n){$({done:!1},n,t)}}};if(k&&(R=(M=function(t){g(this,R),y(t),s(e,this);var n=L(this);try{t(X(Q,n),X($,n))}catch(t){$(n,t)}}).prototype,(e=function(t){_(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new O,rejection:!1,state:0,value:void 0})}).prototype=p(R,"then",(function(t,n){var r=L(this),e=G(x(this,M));return r.parent=!0,e.ok=!h(t)||t,e.fail=h(n)&&n,e.domain=a?B.domain:void 0,0==r.state?r.reactions.add(e):w((function(){V(e,r)})),e.promise})),o=function(){var t=new e,n=L(t);this.promise=t,this.resolve=X(Q,n),this.reject=X($,n)},E.f=G=function(t){return t===M||void 0===t?new o(t):U(t)},!u&&h(T)&&C!==Object.prototype)){i=C.then,D||p(C,"then",(function(t,n){var r=this;return new M((function(t,n){s(i,r,t,n)})).then(t,n)}),{unsafe:!0});try{delete C.constructor}catch(t){}l&&l(C,R)}c({global:!0,constructor:!0,wrap:!0,forced:k},{Promise:M}),v(M,"Promise",!1,!0),d("Promise")},function(t,n,r){"use strict";var e=r(9),o=r(16),i=r(4),c=r(11),u=i("species");t.exports=function(t){var n=e(t),r=o.f;c&&n&&!n[u]&&r(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(14),o=TypeError;t.exports=function(t,n){if(e(n,t))return t;throw o("Incorrect invocation")}},function(t,n,r){var e=r(73),o=r(32),i=TypeError;t.exports=function(t){if(e(t))return t;throw i(o(t)+" is not a constructor")}},function(t,n,r){var e,o,i,c,u,a,f,s,p=r(1),l=r(34),v=r(43).f,d=r(95).set,y=r(97),h=r(143),m=r(144),g=r(52),x=p.MutationObserver||p.WebKitMutationObserver,b=p.document,w=p.process,S=p.Promise,j=v(p,"queueMicrotask"),O=j&&j.value;O||(e=function(){var t,n;for(g&&(t=w.domain)&&t.exit();o;){n=o.fn,o=o.next;try{n()}catch(t){throw o?c():i=void 0,t}}i=void 0,t&&t.enter()},y||g||m||!x||!b?!h&&S&&S.resolve?((f=S.resolve(void 0)).constructor=S,s=l(f.then,f),c=function(){s(e)}):g?c=function(){w.nextTick(e)}:(d=l(d,p),c=function(){d(e)}):(u=!0,a=b.createTextNode(""),new x(e).observe(a,{characterData:!0}),c=function(){a.data=u=!u})),t.exports=O||function(t){var n={fn:t,next:void 0};i&&(i.next=n),o||(o=n,c()),i=n}},function(t,n,r){var e=r(31),o=r(1);t.exports=/ipad|iphone|ipod/i.test(e)&&void 0!==o.Pebble},function(t,n,r){var e=r(31);t.exports=/web0s(?!.*chrome)/i.test(e)},function(t,n,r){var e=r(1);t.exports=function(t,n){var r=e.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,n))}},function(t,n){var r=function(){this.head=null,this.tail=null};r.prototype={add:function(t){var n={item:t,next:null};this.head?this.tail.next=n:this.head=n,this.tail=n},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}},t.exports=r},function(t,n,r){var e=r(98),o=r(52);t.exports=!e&&!o&&"object"==typeof window&&"object"==typeof document},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(22),u=r(37),a=r(35);e({target:"Promise",stat:!0,forced:r(99)},{all:function(t){var n=this,r=c.f(n),e=r.resolve,f=r.reject,s=u((function(){var r=i(n.resolve),c=[],u=0,s=1;a(t,(function(t){var i=u++,a=!1;s++,o(r,n,t).then((function(t){a||(a=!0,c[i]=t,--s||e(c))}),f)})),--s||e(c)}));return s.error&&f(s.value),r.promise}})},function(t,n,r){var e=r(4)("iterator"),o=!1;try{var i=0,c={next:function(){return{done:!!i++}},return:function(){o=!0}};c[e]=function(){return this},Array.from(c,(function(){throw 2}))}catch(t){}t.exports=function(t,n){if(!n&&!o)return!1;var r=!1;try{var i={};i[e]=function(){return{next:function(){return{done:r=!0}}}},t(i)}catch(t){}return r}},function(t,n,r){"use strict";var e=r(0),o=r(15),i=r(38).CONSTRUCTOR,c=r(30),u=r(9),a=r(2),f=r(21),s=c&&c.prototype;if(e({target:"Promise",proto:!0,forced:i,real:!0},{catch:function(t){return this.then(void 0,t)}}),!o&&a(c)){var p=u("Promise").prototype.catch;s.catch!==p&&f(s,"catch",p,{unsafe:!0})}},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(22),u=r(37),a=r(35);e({target:"Promise",stat:!0,forced:r(99)},{race:function(t){var n=this,r=c.f(n),e=r.reject,f=u((function(){var c=i(n.resolve);a(t,(function(t){o(c,n,t).then(r.resolve,e)}))}));return f.error&&e(f.value),r.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(22);e({target:"Promise",stat:!0,forced:r(38).CONSTRUCTOR},{reject:function(t){var n=i.f(this);return o(n.reject,void 0,t),n.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(9),i=r(15),c=r(30),u=r(38).CONSTRUCTOR,a=r(100),f=o("Promise"),s=i&&!u;e({target:"Promise",stat:!0,forced:i||u},{resolve:function(t){return a(s&&this===f?c:this,t)}})},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(22),u=r(37),a=r(35);e({target:"Promise",stat:!0},{allSettled:function(t){var n=this,r=c.f(n),e=r.resolve,f=r.reject,s=u((function(){var r=i(n.resolve),c=[],u=0,f=1;a(t,(function(t){var i=u++,a=!1;f++,o(r,n,t).then((function(t){a||(a=!0,c[i]={status:"fulfilled",value:t},--f||e(c))}),(function(t){a||(a=!0,c[i]={status:"rejected",reason:t},--f||e(c))}))})),--f||e(c)}));return s.error&&f(s.value),r.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(9),u=r(22),a=r(37),f=r(35);e({target:"Promise",stat:!0},{any:function(t){var n=this,r=c("AggregateError"),e=u.f(n),s=e.resolve,p=e.reject,l=a((function(){var e=i(n.resolve),c=[],u=0,a=1,l=!1;f(t,(function(t){var i=u++,f=!1;a++,o(e,n,t).then((function(t){f||l||(l=!0,s(t))}),(function(t){f||l||(f=!0,c[i]=t,--a||p(new r(c,"No one promise resolved")))}))})),--a||p(new r(c,"No one promise resolved"))}));return l.error&&p(l.value),e.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(15),i=r(30),c=r(5),u=r(9),a=r(2),f=r(93),s=r(100),p=r(21),l=i&&i.prototype;if(e({target:"Promise",proto:!0,real:!0,forced:!!i&&c((function(){l.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var n=f(this,u("Promise")),r=a(t);return this.then(r?function(r){return s(n,t()).then((function(){return r}))}:t,r?function(r){return s(n,t()).then((function(){throw r}))}:t)}}),!o&&a(i)){var v=u("Promise").prototype.finally;l.finally!==v&&p(l,"finally",v,{unsafe:!0})}},function(t,n,r){var e=r(6),o=r(66),i=r(36),c=r(57),u=e("".charAt),a=e("".charCodeAt),f=e("".slice),s=function(t){return function(n,r){var e,s,p=i(c(n)),l=o(r),v=p.length;return l<0||l>=v?t?"":void 0:(e=a(p,l))<55296||e>56319||l+1===v||(s=a(p,l+1))<56320||s>57343?t?u(p,l):e:t?f(p,l,l+2):s-56320+(e-55296<<10)+65536}};t.exports={codeAt:s(!1),charAt:s(!0)}},function(t,n){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,n,r){var e=r(160);t.exports=e},function(t,n,r){var e=r(14),o=r(161),i=Array.prototype;t.exports=function(t){var n=t.slice;return t===i||e(i,t)&&n===i.slice?o:n}},function(t,n,r){r(162);var e=r(40);t.exports=e("Array").slice},function(t,n,r){"use strict";var e=r(0),o=r(39),i=r(73),c=r(10),u=r(65),a=r(26),f=r(18),s=r(74),p=r(4),l=r(55),v=r(53),d=l("slice"),y=p("species"),h=Array,m=Math.max;e({target:"Array",proto:!0,forced:!d},{slice:function(t,n){var r,e,p,l=f(this),d=a(l),g=u(t,d),x=u(void 0===n?d:n,d);if(o(l)&&(r=l.constructor,(i(r)&&(r===h||o(r.prototype))||c(r)&&null===(r=r[y]))&&(r=void 0),r===h||void 0===r))return v(l,g,x);for(e=new(void 0===r?h:r)(m(x-g,0)),p=0;g<x;g++,p++)g in l&&s(e,p,l[g]);return e.length=p,e}})},function(t,n,r){t.exports=r(164)},function(t,n,r){var e=r(165);t.exports=e},function(t,n,r){var e=r(14),o=r(166),i=Array.prototype;t.exports=function(t){var n=t.map;return t===i||e(i,t)&&n===i.map?o:n}},function(t,n,r){r(167);var e=r(40);t.exports=e("Array").map},function(t,n,r){"use strict";var e=r(0),o=r(56).map;e({target:"Array",proto:!0,forced:!r(55)("map")},{map:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){var e=r(39),o=r(73),i=r(10),c=r(4)("species"),u=Array;t.exports=function(t){var n;return e(t)&&(n=t.constructor,(o(n)&&(n===u||e(n.prototype))||i(n)&&null===(n=n[c]))&&(n=void 0)),void 0===n?u:n}},function(t,n,r){(function(e){var o,i=r(170),c=r(76),u=r(216),a=r(102),f=r(222),s=r(226),p=r(233),l=r(237),v=r(241),d=r(245);!function(y,h){"use strict";var m,g=(y=void 0!==y?y:"undefined"!=typeof self?self:void 0!==e?e:{}).IDBKeyRange||y.webkitIDBKeyRange,x="readonly",b="readwrite",w=Object.prototype.hasOwnProperty,S=function(){if(!m&&!(m=y.indexedDB||y.webkitIndexedDB||y.mozIndexedDB||y.oIndexedDB||y.msIndexedDB||(null===y.indexedDB&&y.shimIndexedDB?y.shimIndexedDB:void 0)))throw"IndexedDB required";return m},j=!1,O=navigator&&!navigator.userAgentData&&/Safari\\//.test(navigator.userAgent)&&!/Chrom(e|ium)\\//.test(navigator.userAgent),P=function(t){return t},T=function(t){var n;return a(n=Object.prototype.toString.call(t)).call(n,8,-1).toLowerCase()},A=function(t){return"function"==typeof t},E=function(t){return"number"===T(t)},k=function(t){return"array"===T(t)},I=function(t){return void 0===t},D=function(t,n){var r=this,e=!1;this.name=n,this.getIndexedDB=function(){return t},this.add=function(n){if(e)throw"Database has been closed";for(var o=[],i=0,u=0;u<arguments.length-1;u++)if(f(arguments[u+1]))for(var a=0;a<arguments[u+1].length;a++)o[i]=arguments[u+1][a],i++;else o[i]=arguments[u+1],i++;var l=t.transaction(n,b),v=l.objectStore(n);return new c((function(t,n){s(o).call(o,(function(t){var n;if(t.item&&t.key){var r=t.key;t=t.item,n=v.add(t,r)}else n=v.add(t);n.onsuccess=function(n){var r=n.target,e=r.source.keyPath;null===e&&(e="__id__"),p(t,e,{value:r.result,enumerable:!0})}})),l.oncomplete=function(){t(o,r)},l.onerror=function(t){t.preventDefault(),n(t)},l.onabort=function(t){n(t)}}))},this.updateAndDelete=function(n,r,o){if(e)throw"Database has been closed";var i=t.transaction(n,b),u=i.objectStore(n),a=u.keyPath;return new c((function(t,n){s(r).call(r,(function(t){if(t.item&&t.key){var n=t.key;t=t.item,u.put(t,n)}else u.put(t)})),s(o).call(o,(function(t){u.delete(t[a])})),i.oncomplete=function(){t([r,o])},i.onerror=function(t){n(t)}}))},this.update=function(n){if(e)throw"Database has been closed";for(var o,i=[],u=1;u<arguments.length;u++)f(o=arguments[u])?i=l(i).call(i,o):i.push(o);var a=t.transaction(n,b),p=a.objectStore(n);p.keyPath;return new c((function(t,n){s(i).call(i,(function(t){var n;if(t.item&&t.key){var r=t.key;t=t.item,n=p.put(t,r)}else n=p.put(t);n.onsuccess=function(t){},n.onerror=function(t){}})),a.oncomplete=function(){t(i,r)},a.onerror=function(t){n(t)},a.onabort=function(t){n(t)}}))},this.remove=function(n,r,o,i,u,a,p){if(e)throw"Database has been closed";var l=t.transaction(n,b),v=l.objectStore(n);return new c((function(t,n){function e(t){return null==t}var c;(e(i)&&(i=-1/0),e(u)&&(u=1/0),null===r||f(r)||(r=[r]),e(o))?null!==r?s(r).call(r,(function(t){v.delete(t)})):v.delete(range=g.bound(i,u,a,p)):(c=null!==r?g.only(r[0]):g.bound(i,u,a,p),v.index(o).openCursor(c).onsuccess=function(t){var n=t.target.result;n&&(n.delete(),n.continue())});l.oncomplete=function(){t()},l.onerror=function(t){n(t)},l.onabort=function(t){n(t)}}))},this.clear=function(n){if(e)throw"Database has been closed";var r=t.transaction(n,b);r.objectStore(n).clear();return new c((function(t,n){r.oncomplete=function(){t()},r.onerror=function(t){n(t)}}))},this.close=function(){e||(t.close(),e=!0,delete C[n])},this.get=function(n,r){if(e)throw"Database has been closed";var o=t.transaction(n),i=o.objectStore(n).get(r);return new c((function(t,n){i.onsuccess=function(n){t(n.target.result)},o.onerror=function(t){n(t)}}))},this.query=function(n,r){if(e)throw"Database has been closed";return new L(n,t,r)},this.count=function(n,r){if(e)throw"Database has been closed";t.transaction(n).objectStore(n)};for(var o=0,i=t.objectStoreNames.length;o<i;o++)!function(t){for(var n in r[t]={},r)w.call(r,n)&&"close"!==n&&(r[t][n]=function(n){return function(){var e,o=l(e=[t]).call(e,a([]).call(arguments,0));return r[n].apply(r,o)}}(n))}(t.objectStoreNames[o])},L=function(t,n,r){var e,o=this,u=!1,f=!1,p=function(e,o,a,p,l,d,y){return new c((function(c,h){var m=u||f?b:x,w=n.transaction(t,m),S=w.objectStore(t),j=r?S.index(r):S,O=e?g[e].apply(null,o):null,P=[],T=[O],E=0;l=l||null,d=d||[],"count"!==a&&T.push(p||"next");var k=!!u&&v(u);j[a].apply(j,T).onsuccess=function(t){var n=t.target.result;if(i(n)===i(0))P=n;else if(n)if(null!==l&&l[0]>E)E=l[0],n.advance(l[0]);else if(null!==l&&E>=l[0]+l[1]);else{var r=!0,e="value"in n?n.value:n.key;s(d).call(d,(function(t){t&&t.length&&(2===t.length?r=r&&e[t[0]]===t[1]:A(t[0])&&(r=r&&t[0].apply(void 0,[e])))})),r&&(E++,P.push(y(e)),f?n.delete():u&&(e=function(t){for(var n=0;n<k.length;n++){var r=k[n],e=u[r];e instanceof Function&&(e=e(t)),t[r]=e}return t}(e),n.update(e))),n.continue()}},w.oncomplete=function(){c(P)},w.onerror=function(t){h(t)},w.onabort=function(t){h(t)}}))},l=function(t,n){var r="next",e="openCursor",o=[],i=null,c=P,s=!1,l=function(){return p(t,n,e,s?r+"unique":r,i,o,c)},v=function(){return r=null,e="count",{execute:l}},d=function t(){return 1==(i=k(arguments[0])?arguments[0]:a(Array.prototype).call(arguments,0,2)).length&&i.unshift(0),E(i[1])||(i=null),{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:t,map:w,remove:S}},y=function t(n){return(n=!!I(n)||!!n)&&(e="openKeyCursor"),{execute:l,keys:t,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}},h=function t(){return o.push(a(Array.prototype).call(arguments,0,2)),{execute:l,count:v,keys:y,filter:t,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}},m=function t(n){return n=!!I(n)||!!n,r=n?"next":"prev",{execute:l,count:v,keys:y,filter:h,asc:t,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}},g=function t(n){return n=!!I(n)||!!n,r=n?"prev":"next",{execute:l,count:v,keys:y,filter:h,asc:m,desc:t,distinct:x,modify:b,limit:d,map:w,remove:S}},x=function t(n){return n=!!I(n)||!!n,s=n,{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:t,modify:b,limit:d,map:w,remove:S}},b=function t(n){return u=n,{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:t,limit:d,map:w,remove:S}},w=function t(n){return A(n)&&(c=n),{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:t,remove:S}},S=function t(n){return n=!!I(n)||!!n,f=n,{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:t}};return{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}};s(e="only bound upperBound lowerBound".split(" ")).call(e,(function(t){o[t]=function(){return new l(t,arguments)}})),this.filter=function(){var t=new l(null,null);return d(t).apply(t,arguments)},this.all=function(){var t;return d(t=this).call(t)}},_=function(t,n,r,e){var o=t.target.result,i=new D(o,n);return C[n]=o,c.resolve(i)},C={},M={version:"0.10.2",open:function(t){var n;return new c((function(r,e){var o;C[t.server]?_({target:{result:C[t.server]}},t.server,t.version,t.schema).then(r,e):(j?c.resolve():O&&S().databases?new c((function(t){var n=function(){return S().databases().finally(t)};o=u(n,100),n()})).finally((function(){j=!0,clearInterval(o)})):(j=!0,c.resolve())).then((function(){try{n=S().open(t.server,t.version)}catch(t){e(t)}n.onsuccess=function(n){_(n,t.server,t.version,t.schema).then(r,e)},n.onupgradeneeded=function(n){!function(t,n,r){for(var e in"function"==typeof n&&(n=n()),n){var o,i=n[e];for(var c in o=!w.call(n,e)||r.objectStoreNames.contains(e)?t.currentTarget.transaction.objectStore(e):r.createObjectStore(e,i.key),i.indexes){var u=i.indexes[c];try{o.index(c)}catch(t){o.createIndex(c,u.key||c,v(u).length?u:{unique:!1})}}}}(n,t.schema,n.target.result)},n.onerror=function(t){e(t)}}))}))},remove:function(t){return new c((function(n,r){if(!t)return n();var e,o;i(t)===D&&(t=t.name),"string"==typeof t&&(e=C[t]),e&&"function"==typeof e.close&&e.close();try{o=S().deleteDatabase(t)}catch(t){r(t)}o.onsuccess=function(r){delete C[t],n(t)},o.onerror=function(t){r(t)},o.onblocked=function(t){r(t)}}))}};void 0!==t.exports?t.exports=M:void 0===(o=function(){return M}.call(n,r,n,t))||(t.exports=o)}(void 0)}).call(this,r(77))},function(t,n,r){var e=r(171),o=r(210);function i(n){return t.exports=i="function"==typeof e&&"symbol"==typeof o?function(t){return typeof t}:function(t){return t&&"function"==typeof e&&t.constructor===e&&t!==e.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,i(n)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,r){t.exports=r(172)},function(t,n,r){t.exports=r(173)},function(t,n,r){var e=r(174);r(203),r(204),r(205),r(206),r(207),r(208),r(209),t.exports=e},function(t,n,r){var e=r(175);r(202),t.exports=e},function(t,n,r){var e=r(176);r(54),t.exports=e},function(t,n,r){r(104),r(72),r(178),r(186),r(187),r(188),r(189),r(107),r(190),r(191),r(192),r(193),r(194),r(195),r(196),r(197),r(198),r(199),r(200),r(201);var e=r(13);t.exports=e.Symbol},function(t,n){var r=TypeError;t.exports=function(t){if(t>9007199254740991)throw r("Maximum allowed index exceeded");return t}},function(t,n,r){r(179),r(182),r(183),r(184),r(185)},function(t,n,r){"use strict";var e=r(0),o=r(1),i=r(7),c=r(6),u=r(15),a=r(11),f=r(24),s=r(5),p=r(8),l=r(14),v=r(12),d=r(18),y=r(45),h=r(36),m=r(20),g=r(50),x=r(69),b=r(64),w=r(180),S=r(68),j=r(43),O=r(16),P=r(87),T=r(80),A=r(21),E=r(33),k=r(48),I=r(49),D=r(60),L=r(4),_=r(75),C=r(3),M=r(105),R=r(29),N=r(51),F=r(56).forEach,B=k("hidden"),G=N.set,U=N.getterFor("Symbol"),z=Object.prototype,q=o.Symbol,V=q&&q.prototype,H=o.TypeError,J=o.QObject,K=j.f,W=O.f,Y=w.f,X=T.f,$=c([].push),Q=E("symbols"),Z=E("op-symbols"),tt=E("wks"),nt=!J||!J.prototype||!J.prototype.findChild,rt=a&&s((function(){return 7!=g(W({},"a",{get:function(){return W(this,"a",{value:7}).a}})).a}))?function(t,n,r){var e=K(z,n);e&&delete z[n],W(t,n,r),e&&t!==z&&W(z,n,e)}:W,et=function(t,n){var r=Q[t]=g(V);return G(r,{type:"Symbol",tag:t,description:n}),a||(r.description=n),r},ot=function(t,n,r){t===z&&ot(Z,n,r),v(t);var e=y(n);return v(r),p(Q,e)?(r.enumerable?(p(t,B)&&t[B][e]&&(t[B][e]=!1),r=g(r,{enumerable:m(0,!1)})):(p(t,B)||W(t,B,m(1,{})),t[B][e]=!0),rt(t,e,r)):W(t,e,r)},it=function(t,n){v(t);var r=d(n),e=x(r).concat(ft(r));return F(e,(function(n){a&&!i(ct,r,n)||ot(t,n,r[n])})),t},ct=function(t){var n=y(t),r=i(X,this,n);return!(this===z&&p(Q,n)&&!p(Z,n))&&(!(r||!p(this,n)||!p(Q,n)||p(this,B)&&this[B][n])||r)},ut=function(t,n){var r=d(t),e=y(n);if(r!==z||!p(Q,e)||p(Z,e)){var o=K(r,e);return!o||!p(Q,e)||p(r,B)&&r[B][e]||(o.enumerable=!0),o}},at=function(t){var n=Y(d(t)),r=[];return F(n,(function(t){p(Q,t)||p(I,t)||$(r,t)})),r},ft=function(t){var n=t===z,r=Y(n?Z:d(t)),e=[];return F(r,(function(t){!p(Q,t)||n&&!p(z,t)||$(e,Q[t])})),e};f||(A(V=(q=function(){if(l(V,this))throw H("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?h(arguments[0]):void 0,n=D(t),r=function(t){this===z&&i(r,Z,t),p(this,B)&&p(this[B],n)&&(this[B][n]=!1),rt(this,n,m(1,t))};return a&&nt&&rt(z,n,{configurable:!0,set:r}),et(n,t)}).prototype,"toString",(function(){return U(this).tag})),A(q,"withoutSetter",(function(t){return et(D(t),t)})),T.f=ct,O.f=ot,P.f=it,j.f=ut,b.f=w.f=at,S.f=ft,_.f=function(t){return et(L(t),t)},a&&(W(V,"description",{configurable:!0,get:function(){return U(this).description}}),u||A(z,"propertyIsEnumerable",ct,{unsafe:!0}))),e({global:!0,constructor:!0,wrap:!0,forced:!f,sham:!f},{Symbol:q}),F(x(tt),(function(t){C(t)})),e({target:"Symbol",stat:!0,forced:!f},{useSetter:function(){nt=!0},useSimple:function(){nt=!1}}),e({target:"Object",stat:!0,forced:!f,sham:!a},{create:function(t,n){return void 0===n?g(t):it(g(t),n)},defineProperty:ot,defineProperties:it,getOwnPropertyDescriptor:ut}),e({target:"Object",stat:!0,forced:!f},{getOwnPropertyNames:at}),M(),R(q,"Symbol"),I[B]=!0},function(t,n,r){var e=r(23),o=r(18),i=r(64).f,c=r(181),u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return u&&"Window"==e(t)?function(t){try{return i(t)}catch(t){return c(u)}}(t):i(o(t))}},function(t,n,r){var e=r(65),o=r(26),i=r(74),c=Array,u=Math.max;t.exports=function(t,n,r){for(var a=o(t),f=e(n,a),s=e(void 0===r?a:r,a),p=c(u(s-f,0)),l=0;f<s;f++,l++)i(p,l,t[f]);return p.length=l,p}},function(t,n,r){var e=r(0),o=r(9),i=r(8),c=r(36),u=r(33),a=r(106),f=u("string-to-symbol-registry"),s=u("symbol-to-string-registry");e({target:"Symbol",stat:!0,forced:!a},{for:function(t){var n=c(t);if(i(f,n))return f[n];var r=o("Symbol")(n);return f[n]=r,s[r]=n,r}})},function(t,n,r){var e=r(0),o=r(8),i=r(46),c=r(32),u=r(33),a=r(106),f=u("symbol-to-string-registry");e({target:"Symbol",stat:!0,forced:!a},{keyFor:function(t){if(!i(t))throw TypeError(c(t)+" is not a symbol");if(o(f,t))return f[t]}})},function(t,n,r){var e=r(0),o=r(9),i=r(41),c=r(7),u=r(6),a=r(5),f=r(39),s=r(2),p=r(10),l=r(46),v=r(53),d=r(24),y=o("JSON","stringify"),h=u(/./.exec),m=u("".charAt),g=u("".charCodeAt),x=u("".replace),b=u(1..toString),w=/[\\uD800-\\uDFFF]/g,S=/^[\\uD800-\\uDBFF]$/,j=/^[\\uDC00-\\uDFFF]$/,O=!d||a((function(){var t=o("Symbol")();return"[null]"!=y([t])||"{}"!=y({a:t})||"{}"!=y(Object(t))})),P=a((function(){return'"\\\\udf06\\\\ud834"'!==y("\\udf06\\ud834")||'"\\\\udead"'!==y("\\udead")})),T=function(t,n){var r=v(arguments),e=n;if((p(n)||void 0!==t)&&!l(t))return f(n)||(n=function(t,n){if(s(e)&&(n=c(e,this,t,n)),!l(n))return n}),r[1]=n,i(y,null,r)},A=function(t,n,r){var e=m(r,n-1),o=m(r,n+1);return h(S,t)&&!h(j,o)||h(j,t)&&!h(S,e)?"\\\\u"+b(g(t,0),16):t};y&&e({target:"JSON",stat:!0,arity:3,forced:O||P},{stringify:function(t,n,r){var e=v(arguments),o=i(O?T:y,null,e);return P&&"string"==typeof o?x(o,w,A):o}})},function(t,n,r){var e=r(0),o=r(24),i=r(5),c=r(68),u=r(25);e({target:"Object",stat:!0,forced:!o||i((function(){c.f(1)}))},{getOwnPropertySymbols:function(t){var n=c.f;return n?n(u(t)):[]}})},function(t,n,r){r(3)("asyncIterator")},function(t,n){},function(t,n,r){r(3)("hasInstance")},function(t,n,r){r(3)("isConcatSpreadable")},function(t,n,r){r(3)("match")},function(t,n,r){r(3)("matchAll")},function(t,n,r){r(3)("replace")},function(t,n,r){r(3)("search")},function(t,n,r){r(3)("species")},function(t,n,r){r(3)("split")},function(t,n,r){var e=r(3),o=r(105);e("toPrimitive"),o()},function(t,n,r){var e=r(9),o=r(3),i=r(29);o("toStringTag"),i(e("Symbol"),"Symbol")},function(t,n,r){r(3)("unscopables")},function(t,n,r){var e=r(1);r(29)(e.JSON,"JSON",!0)},function(t,n){},function(t,n){},function(t,n,r){r(3)("dispose")},function(t,n,r){r(3)("asyncDispose")},function(t,n,r){r(3)("matcher")},function(t,n,r){r(3)("metadataKey")},function(t,n,r){r(3)("observable")},function(t,n,r){r(3)("metadata")},function(t,n,r){r(3)("patternMatch")},function(t,n,r){r(3)("replaceAll")},function(t,n,r){t.exports=r(211)},function(t,n,r){t.exports=r(212)},function(t,n,r){var e=r(213);t.exports=e},function(t,n,r){var e=r(214);t.exports=e},function(t,n,r){var e=r(215);r(54),t.exports=e},function(t,n,r){r(71),r(72),r(101),r(107);var e=r(75);t.exports=e.f("iterator")},function(t,n,r){t.exports=r(217)},function(t,n,r){r(218);var e=r(13);t.exports=e.setInterval},function(t,n,r){r(219),r(221)},function(t,n,r){var e=r(0),o=r(1),i=r(108)(o.setInterval,!0);e({global:!0,bind:!0,forced:o.setInterval!==i},{setInterval:i})},function(t,n){t.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},function(t,n,r){var e=r(0),o=r(1),i=r(108)(o.setTimeout,!0);e({global:!0,bind:!0,forced:o.setTimeout!==i},{setTimeout:i})},function(t,n,r){t.exports=r(223)},function(t,n,r){var e=r(224);t.exports=e},function(t,n,r){r(225);var e=r(13);t.exports=e.Array.isArray},function(t,n,r){r(0)({target:"Array",stat:!0},{isArray:r(39)})},function(t,n,r){t.exports=r(227)},function(t,n,r){r(54);var e=r(28),o=r(8),i=r(14),c=r(228),u=Array.prototype,a={DOMTokenList:!0,NodeList:!0};t.exports=function(t){var n=t.forEach;return t===u||i(u,t)&&n===u.forEach||o(a,e(t))?c:n}},function(t,n,r){var e=r(229);t.exports=e},function(t,n,r){r(230);var e=r(40);t.exports=e("Array").forEach},function(t,n,r){"use strict";var e=r(0),o=r(231);e({target:"Array",proto:!0,forced:[].forEach!=o},{forEach:o})},function(t,n,r){"use strict";var e=r(56).forEach,o=r(232)("forEach");t.exports=o?[].forEach:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}},function(t,n,r){"use strict";var e=r(5);t.exports=function(t,n){var r=[][t];return!!r&&e((function(){r.call(null,n||function(){return 1},1)}))}},function(t,n,r){t.exports=r(234)},function(t,n,r){var e=r(235);t.exports=e},function(t,n,r){r(236);var e=r(13).Object,o=t.exports=function(t,n,r){return e.defineProperty(t,n,r)};e.defineProperty.sham&&(o.sham=!0)},function(t,n,r){var e=r(0),o=r(11),i=r(16).f;e({target:"Object",stat:!0,forced:Object.defineProperty!==i,sham:!o},{defineProperty:i})},function(t,n,r){t.exports=r(238)},function(t,n,r){var e=r(239);t.exports=e},function(t,n,r){var e=r(14),o=r(240),i=Array.prototype;t.exports=function(t){var n=t.concat;return t===i||e(i,t)&&n===i.concat?o:n}},function(t,n,r){r(104);var e=r(40);t.exports=e("Array").concat},function(t,n,r){t.exports=r(242)},function(t,n,r){var e=r(243);t.exports=e},function(t,n,r){r(244);var e=r(13);t.exports=e.Object.keys},function(t,n,r){var e=r(0),o=r(25),i=r(69);e({target:"Object",stat:!0,forced:r(5)((function(){i(1)}))},{keys:function(t){return i(o(t))}})},function(t,n,r){t.exports=r(246)},function(t,n,r){var e=r(247);t.exports=e},function(t,n,r){var e=r(14),o=r(248),i=Array.prototype;t.exports=function(t){var n=t.filter;return t===i||e(i,t)&&n===i.filter?o:n}},function(t,n,r){r(249);var e=r(40);t.exports=e("Array").filter},function(t,n,r){"use strict";var e=r(0),o=r(56).filter;e({target:"Array",proto:!0,forced:!r(55)("filter")},{filter:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})}]);`,"Worker",void 0,void 0)}},function(t,r,e){var n=e(3),o=e(15),s=e(8),a=e(302),i={log:{key:{keyPath:"time"},indexes:{level:{unique:!1},time:{unique:!0}}}};function u(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.server=null,this.expire=d.expire||72,this.name=d.name}var c=u.prototype;c.init=function(){var d=this;if(!this.server)return a.open({server:"nim-log-"+this.name,version:1,schema:i}).then(function(m){d.server=m})},c.putLog=function(d){var m=this;if(!this.server)return n.reject("no db server");var v=o(d).call(d,-1)[0].time-36e5*this.expire;return this.deleteLogs(v).then(function(){return m.server.add("log",d)})},c.getAllLogs=function(){return this.server?this.server.query("log","time").all().execute().then(function(d){var m={},v=o(d).call(d,-1)[0];return m.logs=s(d).call(d,function(g){return g.log}).join(`\r
`),m.time=v&&v.time,m}):n.reject("no db server")},c.deleteLogs=function(d){return this.server?this.server.remove("log",null,"time",0,d):n.reject("no db server")},t.exports=u},function(t,r,e){e(251);var n=e(12);t.exports=n.setInterval},function(t,r,e){var n=e(21),o=e(568),s=Function.prototype;t.exports=function(a){var i=a.bind;return a===s||n(s,a)&&i===s.bind?o:i}},function(t,r,e){e(569);var n=e(30);t.exports=n("Function").bind},function(t,r,e){var n=e(1),o=e(272);n({target:"Function",proto:!0,forced:Function.bind!==o},{bind:o})},function(t,r,e){var n=e(18),o=e(24),s=e(2),a=e(26),i=e(5),u=e(54),c=e(184);function d(g){g.onuploading&&this.on("uploading",g.onuploading),c.call(this,g)}var m=c.prototype,v=d.prototype=n(m);v.doSend=function(){var g,b,T,k=this.options,y=k.headers,A=this.xhr=new XMLHttpRequest;if(y["Content-Type"]==="multipart/form-data"){var V,he;delete y["Content-Type"],A.upload.onprogress=o(V=this.onProgress).call(V,this),A.upload.onload=o(he=this.onProgress).call(he,this);var ae,Ne=k.data;k.data=new window.FormData,Ne&&s(ae=u.getKeys(Ne,k.putFileAtEnd)).call(ae,function(re){var ue=Ne[re];ue.tagName&&ue.tagName.toUpperCase()==="INPUT"?ue.type==="file"&&s([]).call(ue.files,function(ze){k.data.append(u.dataset(ue,"name")||ue.name||ze.name||"file-"+u.uniqueID(),ze)}):k.data.append(re,ue)})}else if(y["x-nos-token"]){var _e,Ce;A.upload.onprogress=o(_e=this.onProgress).call(_e,this),A.upload.onload=o(Ce=this.onProgress).call(Ce,this)}A.onreadystatechange=o(g=this.onStateChange).call(g,this),k.timeout!==0&&(this.timer=a(o(T=this.onTimeout).call(T,this),k.timeout)),A.open(k.method,k.url,!k.sync),s(b=i(y)).call(b,function(re){A.setRequestHeader(re,y[re])}),k.cookie&&"withCredentials"in A&&(A.withCredentials=!0),A.send(k.data),this.afterSend()},v.onProgress=function(g){g.lengthComputable&&g.loaded<=g.total&&this.emit("uploading",g)},v.onStateChange=function(){var g,b=this.xhr;b.readyState===4&&(g={status:b.status,result:b.responseText||""},this.onLoad(g))},v.getResponseHeader=function(g){var b=this.xhr;return b?b.getResponseHeader(g):""},v.destroy=function(){clearTimeout(this.timer);try{this.xhr.onreadystatechange=u.f,this.xhr.abort()}catch{}m.destroy.call(this)},t.exports=d},function(t,r,e){var n;/*!
 * EventEmitter v5.2.9 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */(function(o){function s(){}var a=s.prototype,i=o.EventEmitter;function u(d,m){for(var v=d.length;v--;)if(d[v].listener===m)return v;return-1}function c(d){return function(){return this[d].apply(this,arguments)}}a.getListeners=function(d){var m,v,g=this._getEvents();if(d instanceof RegExp)for(v in m={},g)g.hasOwnProperty(v)&&d.test(v)&&(m[v]=g[v]);else m=g[d]||(g[d]=[]);return m},a.flattenListeners=function(d){var m,v=[];for(m=0;m<d.length;m+=1)v.push(d[m].listener);return v},a.getListenersAsObject=function(d){var m,v=this.getListeners(d);return v instanceof Array&&((m={})[d]=v),m||v},a.addListener=function(d,m){if(!function T(k){return typeof k=="function"||k instanceof RegExp||!(!k||typeof k!="object")&&T(k.listener)}(m))throw new TypeError("listener must be a function");var v,g=this.getListenersAsObject(d),b=typeof m=="object";for(v in g)g.hasOwnProperty(v)&&u(g[v],m)===-1&&g[v].push(b?m:{listener:m,once:!1});return this},a.on=c("addListener"),a.addOnceListener=function(d,m){return this.addListener(d,{listener:m,once:!0})},a.once=c("addOnceListener"),a.defineEvent=function(d){return this.getListeners(d),this},a.defineEvents=function(d){for(var m=0;m<d.length;m+=1)this.defineEvent(d[m]);return this},a.removeListener=function(d,m){var v,g,b=this.getListenersAsObject(d);for(g in b)b.hasOwnProperty(g)&&(v=u(b[g],m))!==-1&&b[g].splice(v,1);return this},a.off=c("removeListener"),a.addListeners=function(d,m){return this.manipulateListeners(!1,d,m)},a.removeListeners=function(d,m){return this.manipulateListeners(!0,d,m)},a.manipulateListeners=function(d,m,v){var g,b,T=d?this.removeListener:this.addListener,k=d?this.removeListeners:this.addListeners;if(typeof m!="object"||m instanceof RegExp)for(g=v.length;g--;)T.call(this,m,v[g]);else for(g in m)m.hasOwnProperty(g)&&(b=m[g])&&(typeof b=="function"?T.call(this,g,b):k.call(this,g,b));return this},a.removeEvent=function(d){var m,v=typeof d,g=this._getEvents();if(v==="string")delete g[d];else if(d instanceof RegExp)for(m in g)g.hasOwnProperty(m)&&d.test(m)&&delete g[m];else delete this._events;return this},a.removeAllListeners=c("removeEvent"),a.emitEvent=function(d,m){var v,g,b,T,k=this.getListenersAsObject(d);for(T in k)if(k.hasOwnProperty(T))for(v=k[T].slice(0),b=0;b<v.length;b++)(g=v[b]).once===!0&&this.removeListener(d,g.listener),g.listener.apply(this,m||[])===this._getOnceReturnValue()&&this.removeListener(d,g.listener);return this},a.trigger=c("emitEvent"),a.emit=function(d){var m=Array.prototype.slice.call(arguments,1);return this.emitEvent(d,m)},a.setOnceReturnValue=function(d){return this._onceReturnValue=d,this},a._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},a._getEvents=function(){return this._events||(this._events={})},s.noConflict=function(){return o.EventEmitter=i,s},(n=(function(){return s}).call(o,e,o,t))===void 0||(t.exports=n)})(typeof window<"u"?window:this||{})},function(t,r,e){var n=e(18),o=e(6),s=e(2),a=e(24),i=e(87),u=e(54),c=e(184),d=e(273),m="NEJ-UPLOAD-RESULT:",v={};function g(k){this.init(),c.call(this,k)}var b=c.prototype,T=g.prototype=n(b);T.init=function(){var k=!1;function y(A){var V=A.data;if(o(V).call(V,m)===0){var he=(V=JSON.parse(V.replace(m,""))).key,ae=v[he];ae&&(delete v[he],V.result=decodeURIComponent(V.result||""),ae.onLoad(V.result))}}return function(){(function(){if(!k){k=!0;var A=u.getGlobal();A.postMessage?u.on(A,"message",y):(d.addMsgListener(y),d.startTimer())}})()}}(),T.doSend=function(){var k=this,y=k.options,A=k.key="zoro-ajax-upload-iframe-"+u.uniqueID();v[A]=k;var V=k.form=u.html2node('<form style="display:none;"></form>');typeof document>"u"||document.body.appendChild(V),V.target=A,V.method="POST",V.enctype="multipart/form-data",V.encoding="multipart/form-data";var he=y.url,ae=u.genUrlSep(he);V.action=he+ae+"_proxy_=form";var Ne,_e=y.data,Ce=[],re=[];_e&&s(Ne=u.getKeys(_e,y.putFileAtEnd)).call(Ne,function(le){var de=_e[le];if(de.tagName&&de.tagName.toUpperCase()==="INPUT"){if(de.type==="file"){var Ie=de,ie=Ie.cloneNode(!0);Ie.parentNode.insertBefore(ie,Ie);var Ve=u.dataset(Ie,"name");Ve&&(Ie.name=Ve),V.appendChild(Ie),u.isFunction(Ie.setAttribute)&&(Ie.setAttribute("form",""),Ie.removeAttribute("form")),Ce.push(de),re.push(ie)}}else{var Ue=u.html2node('<input type="hidden"/>');Ue.name=le,Ue.value=de,V.appendChild(Ue)}});function ue(){s(Ce).call(Ce,function(le,de){var Ie=re[de];Ie.parentNode&&(le.name=Ie.name,u.isFunction(le.setAttribute)&&le.setAttribute("form",Ie.getAttribute("form")),Ie.parentNode.replaceChild(le,Ie))})}var ze=k.iframe=u.createIframe({name:A,onload:function(){var le;k.aborted?ue():(u.on(ze,"load",a(le=k.checkResult).call(le,k)),V.submit(),ue(),k.afterSend())}})},T.checkResult=function(){var k,y;try{var A,V;if(k=this.iframe.contentWindow.document.body,y=i(A=k.innerText||k.textContent||"").call(A),o(y).call(y,m)>=0||o(V=k.innerHTML).call(V,m)>=0)return}catch{return}this.onLoad(y)},T.onLoad=function(k){b.onLoad.call(this,{status:200,result:k}),u.remove(this.form),u.remove(this.iframe),b.destroy.call(this)},T.destroy=function(){u.remove(this.iframe),u.remove(this.form)},T.abort=function(){this.aborted=!0,delete v[this.key],b.abort.call(this)},t.exports=g},function(t,r,e){var n=e(574);t.exports=n},function(t,r,e){var n=e(21),o=e(575),s=String.prototype;t.exports=function(a){var i=a.trim;return typeof a=="string"||a===s||n(s,a)&&i===s.trim?o:i}},function(t,r,e){e(576);var n=e(30);t.exports=n("String").trim},function(t,r,e){var n=e(1),o=e(182).trim;n({target:"String",proto:!0,forced:e(577)("trim")},{trim:function(){return o(this)}})},function(t,r,e){var n=e(225).PROPER,o=e(4),s=e(146);t.exports=function(a){return o(function(){return!!s[a]()||"​᠎"[a]()!=="​᠎"||n&&s[a].name!==a})}},function(t,r,e){var n=e(18),o=e(6),s=e(24),a=e(2),i=e(54),u=e(273),c=e(184),d={};function m(b){this.init(),c.call(this,b)}var v=c.prototype,g=m.prototype=n(v);g.init=function(){var b="NEJ-AJAX-DATA:",T=!1;function k(y){var A=y.data;if(o(A).call(A,b)===0){var V=(A=JSON.parse(A.replace(b,""))).key,he=d[V];he&&(delete d[V],A.result=decodeURIComponent(A.result||""),he.onLoad(A))}}return function(){(function(){if(!T){T=!0;var y=i.getGlobal();y.postMessage?i.on(y,"message",k):u.addMsgListener(k)}})()}}(),g.doSend=function(){var b=this.options,T=i.url2origin(b.url),k=b.proxyUrl||T+"/res/nej_proxy_frame.html",y=d[k];if(i.isArray(y)){var A;y.push(s(A=this.doSend).call(A,this,b))}else{var V;if(!y)return d[k]=[s(V=this.doSend).call(V,this,b)],void i.createIframe({src:k,onload:function(Ne){var _e=d[k];d[k]=i.target(Ne).contentWindow,a(_e).call(_e,function(Ce){try{Ce()}catch{}})}});if(!this.aborted){var he=this.key=i.uniqueID();d[he]=this;var ae=i.fetch({method:"GET",url:"",data:null,headers:{},timeout:0},b);ae.key=he,u.postMessage(y,{data:ae}),this.afterSend()}}},g.abort=function(){this.aborted=!0,delete d[this.key],v.abort.call(this)},t.exports=m},function(t,r,e){var n,o,s=e(10),a=e(54),i=e(116),u=(n=/json/i,o=/post/i,function(c,d){var m=(d=d||{}).data=d.data||{},v=d.headers=d.headers||{},g=a.checkWithDefault(v,"Accept","application/json"),b=a.checkWithDefault(v,"Content-Type","application/json");return n.test(g)&&(d.type="json"),o.test(d.method)&&n.test(b)&&(d.data=s(m)),i(c,d)});t.exports=u},function(t,r,e){var n=e(5),o=e(17),s=e(6),a=e(2),i=e(7),u=e(15),c=e(26);t.exports={wrapSafeCallback:function(d,m){if(!d.__wrapSafeCallback__){d.__wrapSafeCallback__=!0;var v=n(d);return v=o(v).call(v,function(g){return s(g).call(g,"on")===0&&Object.prototype.toString.call(d[g])==="[object Function]"}),a(v).call(v,function(g){var b=d[g];d[g]=function(){var T=this;try{var k;return b.call.apply(b,i(k=[this]).call(k,u(Array.prototype).call(arguments)))}catch(A){var y;this.logger.error(i(y="wrapSafeCallback. CallbackName: ".concat(g,". Error: ")).call(y,A)),c(function(){var V;throw T.logger.error(i(V="wrapSafeCallback. throw error in setTimeout. CallbackName: ".concat(g,". Error: ")).call(V,A)),A},0),m.logger&&m.logger.error("userOption:".concat(g," function error"),A)}}}),d}}}},function(t,r,e){var n=e(582);t.exports=n},function(t,r,e){e(583);var n=e(12);t.exports=n.Date.now},function(t,r,e){var n=e(1),o=e(11),s=Date,a=o(s.prototype.getTime);n({target:"Date",stat:!0},{now:function(){return a(new s)}})},function(t,r,e){var n=e(73).fn,o=e(23).reportAPI;n.isConnected=function(){return o({instance:this,className:"ApiBaseFn",funcName:"isConnected",hasCallback:!1}),!!this.protocol&&this.protocol.isConnected()},n.connect=function(){o({instance:this,className:"ApiBaseFn",funcName:"connect",hasCallback:!1}),this.protocol.connect()},n.disconnect=function(){}},function(t,r,e){var n=e(25),o=e(10),s=e(24),a=e(8),i=e(41),u=e(15),c=e(139),d=e(87),m=e(6),v=e(52),g=e(26),b=e(9),T=e(32),k=e(2),y=e(7),A=e(5),V=e(59),he=e(17),ae=e(60),Ne=e(61),_e=e(62),Ce=e(47),re=e(58),ue=e(120),ze=["loc_x","loc_y","loc_z"];function le(Fe,or){var ir=A(Fe);if(V){var $e=V(Fe);or&&($e=he($e).call($e,function(er){return ae(Fe,er).enumerable})),ir.push.apply(ir,$e)}return ir}function de(Fe){for(var or=1;or<arguments.length;or++){var ir,$e,er=arguments[or]!=null?arguments[or]:{};or%2?k(ir=le(Object(er),!0)).call(ir,function(nr){re(Fe,nr,er[nr])}):Ne?_e(Fe,Ne(er)):k($e=le(Object(er))).call($e,function(nr){Ce(Fe,nr,ae(er,nr))})}return Fe}var Ie=e(73).fn,ie=e(0),Ve=e(604),Ue=e(40),Dt=e(13),tr=e(275),dr=e(276),fr=e(283),sr=e(105).EMExceptionState,hr=e(23).reportAPI;Ie.sendText=function(Fe){(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"sendText",async:!0,done:Fe.done});var or=Fe,ir=or.loc_x,$e=or.loc_y,er=or.loc_z,nr=ue(or,ze);return ir===void 0||$e===void 0||er===void 0?Fe=de({},nr):(typeof Fe.loc_x!="number"&&(Fe.loc_x=0),typeof Fe.loc_y!="number"&&(Fe.loc_y=0),typeof Fe.loc_z!="number"&&(Fe.loc_z=0)),this.processCallback(Fe),Fe.msg=new this.message.TextMessage(Fe),this.sendMsg(Fe)},Ie.previewFile=function(Fe,or){var ir;(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"previewFile",done:Fe.done});var $e=this,er=$e.protocol.appGrayConfig;if(er&&er.grayConfig&&er.grayConfig.mixStoreEnable&&(Fe.mixEnable=!0),ie.verifyOptions(Fe,"done","msg::previewFile"),Fe.type||(Fe.type="file"),ie.verifyParamPresentJustOne(Fe,"dataURL blob fileInput filePath wxFilePath fileObject","msg::previewFile"),ie.exist(Fe.maxSize)&&ie.verifyParamType("maxSize",Fe.maxSize,"number","api::previewFile"),ie.exist(Fe.commonUpload)&&ie.verifyParamType("commonUpload",Fe.commonUpload,"boolean","api::previewFile"),Fe.nosSurvivalTime?(ie.verifyParamType("nosSurvivalTime",Fe.nosSurvivalTime,"number","api::Base.getInstance"),ie.verifyParamMin("nosSurvivalTime",Fe.nosSurvivalTime,86400,"api::Base.getInstance")):Fe.nosSurvivalTime=this.nosSurvivalTime,Fe.filePath=Fe.filePath||Fe.wxFilePath,delete Fe.wxFilePath,Fe.dataURL)Fe.blob=fr.fromDataURL(Fe.dataURL);else if(!Fe.blob){if(Fe.fileInput){if(Fe.fileInput=ie.verifyFileInput(Fe.fileInput,"msg::previewFile"),Fe.fileInput.files){if(!Fe.fileInput.files.length)return void Fe.done(Ue.newNoFileError("请选择"+Fe.type+"文件",{callFunc:"msg::previewFile",fileInput:Fe.fileInput}),Fe);Fe.fileSize=Fe.fileInput.files[0].size}Fe.fileInputName=ie.getFileName(Fe.fileInput)}}this.processCallback(Fe);var nr=o(tr.genResponseBody(Fe.type)||{}).replace(/"/gi,'\\"'),Pt=null,rr=Fe.transcode?"getNosTokenTrans":"getNosToken";if(Fe.transcode){ie.verifyOptions(Fe,"fileInput","msg::previewFile");var kt=ie.getFileInfo(Fe.fileInput);Pt={transToken:{name:kt.name,type:kt.transcodeType,transType:Fe.transcode==="png"?11:10,size:kt.size,body:nr}}}else Pt=nr;this[rr]({responseBody:Pt,nosToken:{nosScene:Fe.nosScene||this.nosScene,nosSurvivalTime:Fe.nosSurvivalTime},callback:s(ir=function(Et,cr){if(Et)Fe.done(Et);else if(Fe.transcode?(Fe.nosToken=cr.nosToken,Fe.docId=cr.docId):Fe.nosToken=cr,Fe.logger=$e.logger,Fe.mixEnable){var mr,yr;if(!this.protocol.mixStorePolicy)try{this.protocol.mixStorePolicy=JSON.parse(localStorage.getItem("NIM-AllMixStorePolicy"))[this.options.appKey]}catch(Tr){$e.logger.error("error:","get last mixStorePolicy failed",Tr)}if(!this.protocol.mixStorePolicy)return void $e.logger.error("error:","get mixStorePolicy failed");Fe.providers=a(mr=this.protocol.mixStorePolicy.providers||[]).call(mr,function(Tr){return Number(Tr)}),Fe.curProvider=Fe.providers[0]?Number(Fe.providers[0]):1,Fe.nosPolicy=this.protocol.mixStorePolicy.nosPolicy,Fe.s3Policy=this.protocol.mixStorePolicy.s3Policy,$e.getMixStoreToken({curProvider:Fe.curProvider,responseBody:Pt,callback:s(yr=function(Tr,Ir){Tr?Fe.done(Tr):(Fe.mixStoreToken=Ir,Fe.getMixStoreToken=function(kr,Ar){$e.getMixStoreToken({curProvider:kr,responseBody:Pt,callback:function(Rr,Mn){Rr?Fe.done(Rr):Ar(Mn)}})},Fe.curProvider===1&&(Fe.nosToken=Ir),$e._doPreviewFile(Fe,or))}).call(yr,$e)})}else this._doPreviewFile(Fe,or)}).call(ir,this)})},Ie._doPreviewFile=function(Fe,or){var ir=this;Fe=ie.merge(Fe,ir.options.providers);var $e=Dt.genUploadUrl(Fe.nosToken.bucket);Fe.mixEnable&&Fe.curProvider===1&&($e=Dt.genUploadUrl(Fe.mixStoreToken.bucket));var er,nr=Dt.chunkUploadUrl;ir.logger.info("_doPreviewFile: start upload"),Fe.commonUpload||!nr||Dt.isWeixinApp||Dt.isNodejs||Dt.isRN?(Fe.commonUpload=!0,er=$e):(er=nr,Fe.nosLbsUrls=Dt.nosLbsUrls,ir.options.edgeList?Fe.edgeList=ir.options.edgeList:Fe.updateNosEdgeList=function(cr){ir.options.edgeList=cr}),ir.protocol.reporterHook.emit("reporter/uploadStart");var Pt=this.assembleUploadParams(Fe.nosToken);Fe.mixEnable&&Fe.curProvider===1&&(Pt=this.assembleUploadParams(Fe.mixStoreToken));function rr(cr,mr,yr,Tr){if(cr){var Ir=ie.get(cr,"msg.message")||ie.get(cr,"message")||"Unknown error message",kr=ie.get(cr,"msg.code")||ie.get(cr,"code")||"Unknown error code";ir.logger.warn("_doPreviewFile: upload done, failed ",kr,Ir),ir.protocol.reporterHook.emit("reporter/uploadEnd",cr.code==="RequestAbortedError"||cr.code==="abort"?sr.kCanceled:sr.kFailed);var Ar=i({},Tr||or,{status:"fail"}),Rr=de(de({},Fe.callback.options),{},{msg:Ar});return Fe.uploaddone&&Fe.uploaddone(cr,Rr,Ar),void Fe.done(cr,Fe.callback.options)}if(ir.logger.info("_doPreviewFile: upload done, success"),ir.protocol.reporterHook.emit("reporter/uploadEnd",sr.kSucceed),Fe.uploaddone&&Fe.uploaddone(null,ie.copy(mr),Tr||or),mr=tr.parseResponse(mr,ir.options.exifOrientation),yr||mr.isS3||(mr.url=Dt.genDownloadUrl(Fe.nosToken,Pt.Object,Dt.serverNosConfig.cdnDomain),Fe.nosToken.shortUrl&&(mr._url_safe=Fe.nosToken.shortUrl)),ie.exist(Fe.fileInputName))mr.name=Fe.fileInputName;else if(Fe.blob){var Mn=Fe.blob.name;if(mr.name=Mn||"blob-"+mr.md5,!Mn){var Or=Fe.blob.type;mr.ext=u(Or).call(Or,c(Or).call(Or,"/")+1)}}else Fe.filePath?mr.name=Fe.filePath:Fe.fileObject&&(mr.name=Fe.fileObject.fileName);if(!mr.ext){var Pr,Nr,Wr=c(Pr=mr.name).call(Pr,".");Wr===-1?mr.ext="unknown":mr.ext=u(Nr=mr.name).call(Nr,Wr+1)}mr.size=mr.size||0,mr.isS3&&mr._url_safe?ir.getNosOriginUrl({safeShortUrl:mr._url_safe,done:function(Yr,Ur){Yr?ir.logger.error("error:","getNosOriginUrl failed",Yr):(mr.url=Ur,Fe.done(null,ie.copy(mr)))}}):Fe.done(null,ie.copy(mr))}if(Dt.isWeixinApp)ie.verifyOptions(Fe,"filePath","msg::_doPreviewFile"),ir.fileQuickTransfer(Fe,rr,function(){var cr=wx.uploadFile({url:er,filePath:Fe.filePath,name:"file",formData:Pt,fail:function(mr){rr({code:"FAILED",msg:mr}),ir.logger.error("error:","api::msg:upload file failed",mr)},success:function(mr){if(mr.statusCode===200)try{rr(null,JSON.parse(mr.data))}catch(yr){ir.logger.error("error:","parse wx upload file res error",yr),rr({code:"PARSE_WX_UPLOAD_FILE_RES_ERROR",str:mr.data,msg:mr.errMsg})}else rr({code:mr.statusCode,msg:mr.errMsg})}});typeof Fe.uploadprogress=="function"&&cr&&(Fe.beginupload(cr,or),ir.logger.info("_doPreviewFile::mini uploadprogress"),cr.onProgressUpdate(function(mr){Fe.uploadprogress({total:mr.totalBytesExpectedToSend,loaded:mr.totalBytesSent,percentage:mr.progress,percentageText:mr.progress+"%"},or)}))});else if(Dt.isNodejs){var kt={url:er,name:"file",formData:Pt,success:function(cr){if(cr.statusCode===200)try{rr(null,JSON.parse(cr.data))}catch(mr){ir.protocol.logger.error("error:","parse nodejs upload file res error",mr),rr({code:"PARSE_NODEJS_UPLOAD_FILE_RES_ERROR",str:cr.data,msg:cr.errMsg})}else rr({code:cr.statusCode,msg:cr.errMsg})},fail:function(cr){rr({code:"FAILED",msg:cr}),ir.protocol.logger.error("error:","api::msg:upload file failed",cr)}};if(Fe.filePath)kt.filePath=Fe.filePath;else{if(n(Fe.fileObject)!=="object")throw new Ue("Nodejs上传fileObject参数类型应如 {fileName:..,fileData:..} ");kt.fileData=Fe.fileObject.fileData}ir.fileQuickTransfer(Fe,rr,function(){dr.uploadFile(kt)})}else if(Dt.isRN){var Et={url:er,name:"file",formData:Pt,filePath:Fe.filePath,success:function(cr){if(cr.ok&&cr.status===200)try{var mr=a(cr.headers)&&a(cr.headers).etag;cr.md5=mr?typeof mr=="string"?mr:mr[0]:"UNKNOWN",rr(null,cr)}catch(yr){ir.protocol.logger.error("error:","parse React Native upload file res error",yr),rr({code:"PARSE_React_Native_UPLOAD_FILE_RES_ERROR",res:cr})}else rr({code:cr.status,msg:cr.statusText})},fail:function(cr){rr({code:"FAILED",msg:cr}),ir.protocol.logger.error("error:","api::msg:upload file failed",cr)}};ir.fileQuickTransfer(Fe,rr,function(){dr.uploadFile(Et)})}else Fe.url=er,Fe.params=Pt,Fe.fileName="file",ir.fileQuickTransfer(Fe,rr,function(){return ir.protocol.adaptersUploadFile(i({},Fe,{uploaddone:rr}),or)})},Ie.fileQuickTransfer=function(Fe,or,ir){var $e,er=this;Fe=Fe||{},or instanceof Function||(or=function(){}),ir instanceof Function||(ir=function(){});var nr=Fe.fastPass;if(nr)try{nr=JSON.parse(nr),Fe.fastPass=nr}catch{er.protocol.logger.error("快传参数解析失败")}var Pt=Fe.fileInputName||Fe.name||Fe.blob&&Fe.blob.name||"",rr=Fe.fileSize||Fe.size||Fe.blob&&Fe.blob.size||0,kt=nr?d($e=(nr.md5||Fe.digest||"")+"").call($e):"",Et=Fe.type||Fe.blob&&Fe.blob.type;if(kt&&rr>=Dt.threshold){var cr=!0,mr={name:Pt,md5:kt,ext:u(Pt).call(Pt,c(Pt).call(Pt,".")+1),type:Et};switch(Et){case"image":nr&&nr.w&&nr.h?(mr.w=nr.w,mr.h=nr.h):(cr=!1,er.protocol.logger.error("快传 image 文件缺少参数 w 或 h"));break;case"video":nr&&nr.w&&nr.h&&nr.dur?(mr.w=nr.w,mr.h=nr.h,mr.dur=nr.dur):(cr=!1,er.protocol.logger.error("快传 video 文件缺少参数 w 或 h 或 dur"));break;case"audio":nr&&nr.dur?mr.dur=nr.dur:(cr=!1,er.protocol.logger.error("快传 audio 文件缺少参数 dur"))}if(!cr)return void ir();var yr={fileQuickTransfer:{md5:kt}};return rr&&(yr.fileQuickTransfer.size=rr),this.protocol.sendCmd("fileQuickTransfer",yr,function(Tr,Ir,kr){!Tr&&kr&&kr.fileQuickTransfer&&kr.fileQuickTransfer.url||(er.protocol.logger.error("misc::fileQuickTransfer: not found",Tr,Ir),ir()),kr&&kr.fileQuickTransfer&&kr.fileQuickTransfer.threshold&&(Dt.threshold=kr.fileQuickTransfer.threshold||0),kr&&kr.fileQuickTransfer&&kr.fileQuickTransfer.url&&(mr.size=rr||kr.fileQuickTransfer.size,mr.url=kr.fileQuickTransfer.url,kr.fileQuickTransfer._url_safe&&(mr._url_safe=kr.fileQuickTransfer._url_safe),or(Tr,mr,!0))})}ir()},Ie.sendFile=function(Fe){if((Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"sendFile",done:Fe.done}),Fe.type||(Fe.type="file"),Fe=ie.merge(Fe,this.options.providers),ie.verifyParamPresentJustOne(Fe,"dataURL blob fileInput file filePath wxFilePath fileObject","msg::sendFile"),ie.exist(Fe.maxSize)&&ie.verifyParamType("maxSize",Fe.maxSize,"number","api::previewFile"),ie.exist(Fe.commonUpload)&&ie.verifyParamType("commonUpload",Fe.commonUpload,"boolean","api::previewFile"),this.processCallback(Fe),Fe.filePath=Fe.filePath||Fe.wxFilePath,delete Fe.wxFilePath,Fe.dataURL)return this._previewAndSendFile(Fe);if(Fe.blob)return this._previewAndSendFile(Fe);if(Fe.fileInput)return Fe.fileInput=ie.verifyFileInput(Fe.fileInput,"msg::sendFile"),Fe.fileInput.files&&!Fe.fileInput.files.length?void Fe.done(Ue.newNoFileError("请选择"+Fe.type+"文件",{callFunc:"msg::sendFile",fileInput:Fe.fileInput}),Fe.callback.options):this._previewAndSendFile(Fe);if(Fe.filePath||Fe.fileObject)return this._previewAndSendFile(Fe);if(Fe.file){var or,ir=Fe.file._url_safe;return ir&&(or=Fe.file.url,Fe.file.url=ir,delete Fe.file._url_safe),Fe.msg=new this.message.FileMessage(Fe),this.sendMsg(Fe,or)}},Ie._previewAndSendFile=function(Fe){var or=this;ie.verifyCallback(Fe,"uploaddone beforesend","msg::_previewAndSendFile");var ir=de({},Fe),$e=new or.message.Message(ir);$e.type=Fe.type;var er=or.formatReturnMsg($e),nr=or.protocol.reporterHook.getSafeClock(),Pt={apiCallingTime:or.protocol.reporterHook.getNTPTime(nr),attachUploadDuration:0},rr=Fe.done;return Fe.done=function(kt,Et){if(Fe.done=rr,kt){var cr=i({},er,{status:"fail"}),mr=de(de({},Fe.callback.options),{},{msg:cr});Fe.done(kt,mr)}else{if(Pt.attachUploadDuration=or.protocol.reporterHook.getSafeClock()-nr,/chatroom/.test(Fe.scene))return;var yr,Tr=Et._url_safe;Tr&&!Et.isS3&&(yr=Et.url,Et.url=Tr,delete Et._url_safe),Fe.file=Et,Fe.msg=new or.message.FileMessage(Fe,$e.idClient),Fe.beforesend(or.sendMsg(Fe,yr,Pt))}},or.previewFile(Fe,er),er},Ie.assembleUploadParams=function(Fe){return Fe?{Object:decodeURIComponent(Fe.objectName),"x-nos-token":Fe.token,"x-nos-entity-type":"json"}:null},Ie.deleteFile=function(Fe){hr({instance:this,className:"ApiBaseFn",funcName:"deleteFile",hasCallback:!1}),ie.verifyParamPresentJustOne(Fe,"docId","msg::deleteFile"),this.removeFile({docId:Fe.docId,callback:function(or,ir){or?Fe.error&&Fe.error(or,ir):Fe.success&&Fe.success(ir)}})},Ie.getFile=function(Fe){hr({instance:this,className:"ApiBaseFn",funcName:"getFile",hasCallback:!1}),ie.verifyParamPresentJustOne(Fe,"docId","msg::getFile"),this.fetchFile({docId:Fe.docId,callback:function(or,ir){or?Fe.error&&Fe.error(or,ir):Fe.success&&Fe.success(ir.info)}})},Ie.getFileList=function(Fe){hr({instance:this,className:"ApiBaseFn",funcName:"getFileList",hasCallback:!1});var or=Fe.fromDocId,ir=or===void 0?"":or,$e=Fe.limit,er=$e===void 0?10:$e,nr={limit:er};ir&&(nr.fromDocId=ir),this.fetchFileList({fileListParam:nr,callback:function(Pt,rr){Pt?(er>30&&(Pt.message=Pt.message+"::文档条数超过限制:30"),Fe.error&&Fe.error(Pt,rr)):Fe.success&&Fe.success(rr)}})},Ie.sendGeo=function(Fe){return(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"sendGeo",done:Fe.done}),this.processCallback(Fe),Fe.msg=new this.message.GeoMessage(Fe),this.sendMsg(Fe)},Ie.sendTipMsg=function(Fe){return(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"sendTipMsg",done:Fe.done}),this.processCallback(Fe),Fe.msg=new this.message.TipMessage(Fe),this.sendMsg(Fe)},Ie.sendCustomMsg=function(Fe){return(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"sendCustomMsg",done:Fe.done}),this.processCallback(Fe),Fe.msg=new this.message.CustomMessage(Fe),this.sendMsg(Fe)},Ie.sendRobotMsg=function(Fe){return(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"sendRobotMsg",done:Fe.done}),this.logger.warn("this api will be abandon"),this.processCallback(Fe),Fe.msg=new this.message.RobotMessage(Fe),this.sendMsg(Fe)},Ie.sendMsg=function(Fe,or,ir){var $e=this,er=$e.protocol,nr=Fe.msg,Pt={};ir=ir||{apiCallingTime:er.reporterHook.getNTPTime(),attachUploadDuration:0};var rr,kt=!!Fe.isLocal;if(this.logger.warn("sendMsg::start: "+nr.idClient),kt&&(Fe.time&&(nr.time=Fe.time),Fe.idClient&&(nr.idClient=Fe.idClient),Fe.localFrom&&(rr=Fe.localFrom+"")),Fe.resend&&(Fe.flow!=="out"||Fe.status!=="fail"))return ie.onError("只能重发发送失败的消息");Fe.callback.options.idClient=nr.idClient,$e.beforeSendMsg(Fe,Pt);var Et=Fe.rtnMsg=$e.formatReturnMsg(nr,rr);if(or&&!$e.options.keepNosSafeUrl&&Et.file&&(Et.file._url_safe=Et.file.url,Et.file.url=or,Et.type==="audio"&&(Et.file.mp3Url=or+(~m(or).call(or,"?")?"&":"?")+"audioTrans&type=mp3")),Et.hasOwnProperty("chatroomId")&&!Et.chatroomId)return ie.onError("聊天室未连接");if(kt&&(Et.status="success",Et.isLocal=!0),er.storeSendMsg&&(Pt.promise=er.storeSendMsg(Et)),Fe.cbaop=function(mr,yr){if(mr)return mr.code===7101&&(Et.isInBlackList=!0,Et.idServer=yr.idServer,Et.time=yr.time),mr.from!=="server"?(Et.status="fail",er.updateSendMsgError&&er.updateSendMsgError(Et),Et):void 0},!kt){or&&!$e.options.keepNosSafeUrl&&Fe.callback&&(Fe.callback.originUrl=or),Fe.toAccids&&Fe.toAccids.length&&(nr.toAccids=o(Fe.toAccids)),Pt.msg=nr,ir.sendTime=er.reporterHook.getNTPTime(),er.reporterHook.hasOriginTimetick()&&(Pt.msg.__clientExt=o({statistics:ir}));var cr=nr;$e.sendCmd(Fe.cmd,Pt,function(){if(Dt.isBrowser){var mr=arguments[0],yr=arguments[1]||{},Tr=$e.subType==="chatroom",Ir=cr.scene===0,kr=er.reporterHook.getNTPTime(),Ar={msgId:yr.idServer,clientId:cr.idClient,msgTime:yr.time||0,fromAccid:$e.account,toAccid:Ir?cr.to:"",type:Tr?4:cr.scene,roomId:Tr?$e.options.chatroomId:"",tid:Tr||Ir?"":cr.to,result:mr?mr.code:200,failReason:mr?mr.message:"",rt:v(kr-ir.apiCallingTime),apiCallingTime:ir.apiCallingTime,sendTime:ir.sendTime,attachUploadDuration:ir.attachUploadDuration,apiCallbackTime:kr};$e.reporter&&$e.reporter.report("msgSend",Ar)}Fe.callback&&Fe.callback.apply($e,arguments);var Rr=arguments[0],Mn=arguments[1];!Rr&&Mn&&Mn.from===Mn.to&&$e.protocol.markMsgRead(Mn)})}return $e.afterSendMsg(Fe),kt&&g(function(){Et=ie.simpleClone(Et),Fe.done(null,Et)},0),ie.copy(Et)},Ie.beforeSendMsg=function(){},Ie.afterSendMsg=function(){},Ie.formatReturnMsg=function(Fe,or){var ir;return Fe=ie.copy(Fe),this.protocol.completeMsg(Fe),Fe.status="sending",or&&(Fe.from=or),Fe=b(ir=this.message).call(ir,Fe),Fe=this.protocol.amendMsg(Fe)},Ie.resendMsg=function(Fe){return(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"resendMsg",done:Fe.done}),ie.verifyOptions(Fe,"msg","msg::resendMsg"),this.trimMsgFlag(Fe),Fe.resend=!0,this._sendMsgByType(Fe)},Ie.forwardMsg=function(Fe){return(Fe=Fe||{}).done=hr({instance:this,className:"ApiBaseFn",funcName:"forwardMsg",done:Fe.done}),ie.verifyOptions(Fe,"msg","msg::forwardMsg"),this.trimMsgFlag(Fe),this.beforeForwardMsg(Fe),Fe.forward=!0,Fe.msg.idClient=ie.guid(),this._sendMsgByType(Fe)},Ie.trimMsgFlag=function(Fe){Fe&&Fe.msg&&(Fe.msg=ie.copy(Fe.msg),delete Fe.msg.resend,delete Fe.msg.forward)},Ie.beforeForwardMsg=function(){},Ie._sendMsgByType=function(Fe){switch(ie.verifyOptions(Fe,"msg","msg::_sendMsgByType"),ie.verifyParamValid("msg.type",Fe.msg.type,this.message.validTypes,"msg::_sendMsgByType"),ie.merge(Fe,Fe.msg),Fe.type){case"text":return this.sendText(Fe);case"image":case"audio":case"video":case"file":return this.sendFile(Fe);case"geo":return this.sendGeo(Fe);case"custom":return this.sendCustomMsg(Fe);case"tip":return this.sendTipMsg(Fe);default:throw new Ue("不能发送类型为 "+Fe.type+" 的消息")}},Ie.parseRobotTemplate=function(Fe){if(this.logger.warn("this api will be abandon"),/<template[^>/]+\/>/.test(Fe))return{raw:Fe,json:[{type:"text",name:"",text:""}]};if(!/<template[^>/]+>/.test(Fe))return{raw:Fe,json:[{type:"text",name:"",text:Fe}]};var or=new Ve({escapeMode:!1});Fe=Fe.replace(/<template [^>]+>/,"<template>");var ir=or.xml2js(Fe);ir=ir.template.LinearLayout,T(ir)||(ir=[ir]);var $e=[];return ir=k(ir).call(ir,function(Pt){Pt.image&&($e=y($e).call($e,nr(Pt))),Pt.text&&($e=y($e).call($e,er(Pt))),Pt.link&&($e=y($e).call($e,function(rr){if(rr.link){var kt=rr.link;T(kt)||(kt=[kt]),kt=a(kt).call(kt,function(Et){return Et.image&&(Et.image=nr(Et)),Et.text&&(Et.text=er(Et)),Et._type==="url"?(Et.type="url",Et.style=Et._style||"",Et.target=Et._target,delete Et._target,delete Et._style):Et._type==="block"&&(Et.type="block",Et.style=Et._style||"",Et.params=Et._params||"",Et.target=Et._target,delete Et._params,delete Et._target,delete Et._style),delete Et._type,Et}),rr.link=kt}return rr.link}(Pt)))}),{raw:Fe,json:$e};function er(Pt){var rr;return T(Pt.text)||(Pt.text=[Pt.text]),Pt.text=a(rr=Pt.text).call(rr,function(kt){return{type:"text",name:kt._name,text:kt.__text}}),Pt.text}function nr(Pt){var rr;return T(Pt.image)||(Pt.image=[Pt.image]),Pt.image=a(rr=Pt.image).call(rr,function(kt){return{type:"image",name:kt._name,url:kt._url}}),Pt.image}}},function(t,r,e){e(587);var n=e(12);t.exports=n.Object.assign},function(t,r,e){var n=e(1),o=e(588);n({target:"Object",stat:!0,arity:2,forced:Object.assign!==o},{assign:o})},function(t,r,e){var n=e(27),o=e(11),s=e(19),a=e(4),i=e(118),u=e(132),c=e(148),d=e(42),m=e(124),v=Object.assign,g=Object.defineProperty,b=o([].concat);t.exports=!v||a(function(){if(n&&v({b:1},v(g({},"a",{enumerable:!0,get:function(){g(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var T={},k={},y=Symbol();return T[y]=7,"abcdefghijklmnopqrst".split("").forEach(function(A){k[A]=A}),v({},T)[y]!=7||i(v({},k)).join("")!="abcdefghijklmnopqrst"})?function(T,k){for(var y=d(T),A=arguments.length,V=1,he=u.f,ae=c.f;A>V;)for(var Ne,_e=m(arguments[V++]),Ce=he?b(i(_e),he(_e)):i(_e),re=Ce.length,ue=0;re>ue;)Ne=Ce[ue++],n&&!s(ae,_e,Ne)||(y[Ne]=_e[Ne]);return y}:v},function(t,r,e){var n=e(21),o=e(590),s=Array.prototype;t.exports=function(a){var i=a.reverse;return a===s||n(s,a)&&i===s.reverse?o:i}},function(t,r,e){e(591);var n=e(30);t.exports=n("Array").reverse},function(t,r,e){var n=e(1),o=e(11),s=e(79),a=o([].reverse),i=[1,2];n({target:"Array",proto:!0,forced:String(i)===String(i.reverse())},{reverse:function(){return s(this)&&(this.length=this.length),a(this)}})},function(t,r,e){t.exports=e(593)},function(t,r,e){t.exports=e(594)},function(t,r,e){var n=e(595);t.exports=n},function(t,r,e){var n=e(253);t.exports=n},function(t,r,e){t.exports=e(597)},function(t,r,e){var n=e(598);t.exports=n},function(t,r,e){var n=e(205);t.exports=n},function(t,r,e){var n=e(600),o=e(185);t.exports=function(s,a){if(s==null)return{};var i,u,c={},d=n(s);for(u=0;u<d.length;u++)i=d[u],o(a).call(a,i)>=0||(c[i]=s[i]);return c},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(601)},function(t,r,e){t.exports=e(602)},function(t,r,e){var n=e(603);t.exports=n},function(t,r,e){var n=e(229);t.exports=n},function(t,r,e){var n,o,s;(function(a,i){o=[],(s=typeof(n=function(u){return function(c){(c=c||{}).arrayAccessForm=c.arrayAccessForm||"none",c.emptyNodeForm=c.emptyNodeForm||"text",c.jsAttributeFilter=c.jsAttributeFilter,c.jsAttributeConverter=c.jsAttributeConverter,c.attributeConverters=c.attributeConverters||[],c.datetimeAccessFormPaths=c.datetimeAccessFormPaths||[],c.arrayAccessFormPaths=c.arrayAccessFormPaths||[],c.xmldomOptions=c.xmldomOptions||{},c.enableToStringFunc===void 0&&(c.enableToStringFunc=!0),c.skipEmptyTextNodesForObj===void 0&&(c.skipEmptyTextNodesForObj=!0),c.stripWhitespaces===void 0&&(c.stripWhitespaces=!0),c.useDoubleQuotes===void 0&&(c.useDoubleQuotes=!0),c.ignoreRoot===void 0&&(c.ignoreRoot=!1),c.escapeMode===void 0&&(c.escapeMode=!0),c.attributePrefix===void 0&&(c.attributePrefix="_"),c.selfClosingElements===void 0&&(c.selfClosingElements=!0),c.keepCData===void 0&&(c.keepCData=!1),c.keepText===void 0&&(c.keepText=!1),c.jsDateUTC===void 0&&(c.jsDateUTC=!1),function(){function Ie(ie){var Ve=String(ie);return Ve.length===1&&(Ve="0"+Ve),Ve}typeof String.prototype.trim!="function"&&(String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")}),typeof Date.prototype.toISOString!="function"&&(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+Ie(this.getUTCMonth()+1)+"-"+Ie(this.getUTCDate())+"T"+Ie(this.getUTCHours())+":"+Ie(this.getUTCMinutes())+":"+Ie(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"})}();var d=1,m=3,v=4,g=8,b=9;function T(Ie){var ie=Ie.localName;return ie==null&&(ie=Ie.baseName),ie!=null&&ie!==""||(ie=Ie.nodeName),ie}function k(Ie){return typeof Ie=="string"?Ie.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"):Ie}function y(Ie,ie,Ve){switch(c.arrayAccessForm){case"property":Ie[ie]instanceof Array?Ie[ie+"_asArray"]=Ie[ie]:Ie[ie+"_asArray"]=[Ie[ie]]}if(!(Ie[ie]instanceof Array)&&c.arrayAccessFormPaths.length>0){for(var Ue=!1,Dt=0;Dt<c.arrayAccessFormPaths.length;Dt++){var tr=c.arrayAccessFormPaths[Dt];if(typeof tr=="string"){if(tr===Ve){Ue=!0;break}}else if(tr instanceof RegExp){if(tr.test(Ve)){Ue=!0;break}}else if(typeof tr=="function"&&tr(ie,Ve)){Ue=!0;break}}Ue&&(Ie[ie]=[Ie[ie]])}}function A(Ie){var ie=Ie.split(/[-T:+Z]/g),Ve=new Date(ie[0],ie[1]-1,ie[2]),Ue=ie[5].split(".");if(Ve.setHours(ie[3],ie[4],Ue[0]),Ue.length>1&&Ve.setMilliseconds(Ue[1]),ie[6]&&ie[7]){var Dt=60*ie[6]+Number(ie[7]);Dt=0+((/\d\d-\d\d:\d\d$/.test(Ie)?"-":"+")=="-"?-1*Dt:Dt),Ve.setMinutes(Ve.getMinutes()-Dt-Ve.getTimezoneOffset())}else Ie.indexOf("Z",Ie.length-1)!==-1&&(Ve=new Date(Date.UTC(Ve.getFullYear(),Ve.getMonth(),Ve.getDate(),Ve.getHours(),Ve.getMinutes(),Ve.getSeconds(),Ve.getMilliseconds())));return Ve}function V(Ie,ie){for(var Ve={__cnt:0},Ue=Ie.childNodes,Dt=0;Dt<Ue.length;Dt++){var tr=Ue.item(Dt),dr=T(tr);tr.nodeType!==g&&(Ve.__cnt++,Ve[dr]==null?(Ve[dr]=he(tr,ie+"."+dr),y(Ve,dr,ie+"."+dr)):(Ve[dr]instanceof Array||(Ve[dr]=[Ve[dr]],y(Ve,dr,ie+"."+dr)),Ve[dr][Ve[dr].length]=he(tr,ie+"."+dr)))}for(var fr=0;fr<Ie.attributes.length;fr++){var sr=Ie.attributes.item(fr);Ve.__cnt++;for(var hr=sr.value,Fe=0;Fe<c.attributeConverters.length;Fe++){var or=c.attributeConverters[Fe];or.test.call(null,sr.name,sr.value)&&(hr=or.convert.call(null,sr.name,sr.value))}Ve[c.attributePrefix+sr.name]=hr}var ir=Ie.prefix;return ir&&(Ve.__cnt++,Ve.__prefix=ir),Ve["#text"]&&(Ve.__text=Ve["#text"],Ve.__text instanceof Array&&(Ve.__text=Ve.__text.join(`
`)),c.escapeMode&&(Ve.__text=Ve.__text.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&amp;/g,"&")),c.stripWhitespaces&&(Ve.__text=Ve.__text.trim()),delete Ve["#text"],c.arrayAccessForm==="property"&&delete Ve["#text_asArray"],Ve.__text=function($e,er,nr){if(c.datetimeAccessFormPaths.length>0)for(var Pt=nr.split(".#")[0],rr=0;rr<c.datetimeAccessFormPaths.length;rr++){var kt=c.datetimeAccessFormPaths[rr];if(typeof kt=="string"){if(kt===Pt)return A($e)}else if(kt instanceof RegExp){if(kt.test(Pt))return A($e)}else if(typeof kt=="function"&&kt(Pt))return A($e)}return $e}(Ve.__text,0,ie+".#text")),Ve.hasOwnProperty("#cdata-section")&&(Ve.__cdata=Ve["#cdata-section"],delete Ve["#cdata-section"],c.arrayAccessForm==="property"&&delete Ve["#cdata-section_asArray"]),Ve.__cnt===1&&Ve.__text&&!c.keepText?Ve=Ve.__text:Ve.__cnt===0&&c.emptyNodeForm==="text"?Ve="":Ve.__cnt>1&&Ve.__text!==void 0&&c.skipEmptyTextNodesForObj&&(c.stripWhitespaces&&Ve.__text===""||Ve.__text.trim()==="")&&delete Ve.__text,delete Ve.__cnt,c.keepCData||Ve.hasOwnProperty("__text")||!Ve.hasOwnProperty("__cdata")||Object.keys(Ve).length!==1?(c.enableToStringFunc&&(Ve.__text||Ve.__cdata)&&(Ve.toString=function(){return(this.__text?this.__text:"")+(this.__cdata?this.__cdata:"")}),Ve):Ve.__cdata?Ve.__cdata:""}function he(Ie,ie){return Ie.nodeType===b?function(Ve){for(var Ue={},Dt=Ve.childNodes,tr=0;tr<Dt.length;tr++){var dr=Dt.item(tr);if(dr.nodeType===d){var fr=T(dr);c.ignoreRoot?Ue=he(dr,fr):Ue[fr]=he(dr,fr)}}return Ue}(Ie):Ie.nodeType===d?V(Ie,ie):Ie.nodeType===m||Ie.nodeType===v?Ie.nodeValue:null}function ae(Ie,ie,Ve,Ue){var Dt="<"+(Ie&&Ie.__prefix?Ie.__prefix+":":"")+ie;if(Ve)for(var tr=0;tr<Ve.length;tr++){var dr=Ve[tr],fr=Ie[dr];c.escapeMode&&(fr=k(fr)),Dt+=" "+dr.substr(c.attributePrefix.length)+"=",c.useDoubleQuotes?Dt+='"'+fr+'"':Dt+="'"+fr+"'"}return Dt+=Ue?" />":">"}function Ne(Ie,ie){return"</"+(Ie&&Ie.__prefix?Ie.__prefix+":":"")+ie+">"}function _e(Ie,ie){return c.arrayAccessForm==="property"&&(Ve=ie.toString(),Ue="_asArray",Ve.indexOf(Ue,Ve.length-Ue.length)!==-1)||ie.toString().indexOf(c.attributePrefix)===0||ie.toString().indexOf("__")===0||Ie[ie]instanceof Function;var Ve,Ue}function Ce(Ie){var ie=0;if(Ie instanceof Object)for(var Ve in Ie)_e(Ie,Ve)||ie++;return ie}function re(Ie){var ie=[];if(Ie instanceof Object)for(var Ve in Ie)Ve.toString().indexOf("__")===-1&&Ve.toString().indexOf(c.attributePrefix)===0&&ie.push(Ve);return ie}function ue(Ie){var ie="";return Ie instanceof Object?ie+=function(Ve){var Ue="";return Ve.__cdata&&(Ue+="<![CDATA["+Ve.__cdata+"]]>"),(Ve.__text||typeof Ve.__text=="number"||typeof Ve.__text=="boolean")&&(c.escapeMode?Ue+=k(Ve.__text):Ue+=Ve.__text),Ue}(Ie):Ie!==null&&(c.escapeMode?ie+=k(Ie):ie+=Ie),ie}function ze(Ie,ie,Ve){var Ue="";return c.jsAttributeFilter&&c.jsAttributeFilter.call(null,ie,Ie)||(c.jsAttributeConverter&&(Ie=c.jsAttributeConverter.call(null,ie,Ie)),Ie!=null&&Ie!==""||!c.selfClosingElements?typeof Ie=="object"?Object.prototype.toString.call(Ie)==="[object Array]"?Ue+=function(Dt,tr,dr){var fr="";if(Dt.length===0)fr+=ae(Dt,tr,dr,!0);else for(var sr=0;sr<Dt.length;sr++)fr+=ze(Dt[sr],tr,re(Dt[sr]));return fr}(Ie,ie,Ve):Ie instanceof Date?(Ue+=ae(Ie,ie,Ve,!1),Ue+=c.jsDateUTC?Ie.toUTCString():Ie.toISOString(),Ue+=Ne(Ie,ie)):Ce(Ie)>0||typeof Ie.__text=="number"||typeof Ie.__text=="boolean"||Ie.__text||Ie.__cdata?(Ue+=ae(Ie,ie,Ve,!1),Ue+=le(Ie),Ue+=Ne(Ie,ie)):c.selfClosingElements?Ue+=ae(Ie,ie,Ve,!0):(Ue+=ae(Ie,ie,Ve,!1),Ue+=Ne(Ie,ie)):(Ue+=ae(Ie,ie,Ve,!1),Ue+=ue(Ie),Ue+=Ne(Ie,ie)):Ue+=ae(Ie,ie,Ve,!0)),Ue}function le(Ie){var ie="";if(Ce(Ie)>0){for(var Ve in Ie)if(!_e(Ie,Ve)){var Ue=Ie[Ve];ie+=ze(Ue,Ve,re(Ue))}}return ie+=ue(Ie)}function de(Ie){if(Ie===void 0||typeof Ie!="string")return null;var ie=null,Ve=null;if(u)Ve=(ie=new u(c.xmldomOptions)).parseFromString(Ie,"text/xml");else if(window&&window.DOMParser){ie=new window.DOMParser;var Ue=null;if(!(window.ActiveXObject||"ActiveXObject"in window)&&document.all&&!document.addEventListener)try{Ue=ie.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI}catch{Ue=null}try{Ve=ie.parseFromString(Ie,"text/xml"),Ue!==null&&Ve.getElementsByTagNameNS(Ue,"parsererror").length>0&&(Ve=null)}catch{Ve=null}}else Ie.indexOf("<?")===0&&(Ie=Ie.substr(Ie.indexOf("?>")+2)),(Ve=new ActiveXObject("Microsoft.XMLDOM")).async="false",Ve.loadXML(Ie);return Ve}this.asArray=function(Ie){return Ie==null?[]:Ie instanceof Array?Ie:[Ie]},this.toXmlDateTime=function(Ie){return Ie instanceof Date?Ie.toISOString():typeof Ie=="number"?new Date(Ie).toISOString():null},this.asDateTime=function(Ie){return typeof Ie=="string"?A(Ie):Ie},this.xml2dom=function(Ie){return de(Ie)},this.dom2js=function(Ie){return he(Ie,null)},this.js2dom=function(Ie){return de(this.js2xml(Ie))},this.xml2js=function(Ie){var ie=de(Ie);return ie!=null?this.dom2js(ie):null},this.js2xml=function(Ie){return le(Ie)},this.getVersion=function(){return"3.4.4"}}})=="function"?n.apply(r,o):n)===void 0||(t.exports=s)})()},function(t,r,e){var n=e(116);t.exports=function(o,s){return s.method="POST",s.headers=s.headers||{},s.headers["Content-Type"]="multipart/form-data",s.timeout=0,s.type=s.type||"json",n(o,s)}},function(t,r,e){var n=e(15),o=e(52),s=e(6),a=e(3),i=e(13),u=i.chunkSize,c=e(116),d={mp4:"video/mp4",avi:"video/x-msvideo",wmv:"video/x-ms-wmv",mpeg:"video/mpeg",mov:"video/quicktime",aac:"audio/x-aac",wma:"audio/x-ms-wma",wav:"audio/x-wav",mp3:"audio/mp3"};t.exports=function m(v,g,b,T){var k={file:v.data[g],fileSize:v.data[g].size,fileUploadedSize:0,percentage:0},y=v.url;function A(ze){var le=k.fileUploadedSize+ze.loaded,de=Math.floor(1e4*le/k.fileSize)/100;if(o(de)>=100&&(de=100,A=function(){}),k.percentage!==de){k.percentage=de;var Ie={docId:v.docId,total:k.fileSize,loaded:le,percentage:de,percentageText:de+"%"};v.fileInput&&(Ie.fileInput=v.fileInput),v.blob&&(Ie.blob=v.blob),v.uploadprogress(Ie)}}function V(ze){try{ze=JSON.parse(ze)}catch(Ie){return void b.onError(Ie)}if(ze.errMsg||ze.errCode)b.onError(ze);else if(ze.offset<k.fileSize)delete _e.onaftersend,k.fileUploadedSize=ze.offset,function(Ie,ie,Ve,Ue){var Dt=Ie.offset,tr=Ie.offset+u;if(typeof FileReader<"u"){var dr,fr=new FileReader;fr.readAsArrayBuffer(n(dr=Ue.file).call(dr,Dt,tr)),fr.addEventListener("load",function(hr){ie.data=hr.target.result,ie.query.offset=Ie.offset,ie.query.complete=tr>=Ue.fileSize,ie.query.context=Ie.context,ie.onuploading=A,ie.onload=V,ie.onerror=he,b.sn=c(y,ie)}),fr.addEventListener("error",function(hr){ie.onerror(hr.target.error)})}else{var sr;ie.data=n(sr=Ue.file).call(sr,Dt,tr),ie.query.offset=Ie.offset,ie.query.complete=tr>=Ue.fileSize,ie.query.context=Ie.context,ie.onuploading=A,ie.onload=V,ie.onerror=he,b.sn=c(y,ie)}}(ze,_e,0,k);else{var le=i.genFileUrl(v.nosToken);v.type==="image"?c(le+"?imageInfo",{onload:function(Ie){try{Ie=JSON.parse(Ie),v.uploaddone(null,{docId:ze.docId,w:Ie.Width,h:Ie.Height,orientation:Ie.Orientation||"",type:Ie.Type,size:Ie.Size||k.fileSize})}catch(ie){de(ie)}},onerror:function(Ie){if(typeof Image<"u"){var ie=new Image;ie.src=le,ie.onload=function(){v.uploaddone(null,{docId:ze.docId,w:ie.width,h:ie.height,size:k.fileSize})},ie.onerror=function(Ve){de(Ve)}}else de(Ie)}}):v.type==="video"||v.type==="audio"?c(le+"?vinfo",{onload:function(Ie){try{(Ie=JSON.parse(Ie)).GetVideoInfo&&Ie.GetVideoInfo.VideoInfo&&(Ie=Ie.GetVideoInfo.VideoInfo),v.uploaddone(null,{docId:ze.docId,w:Ie.Width,h:Ie.Height,dur:Ie.Duration,orientation:Ie.Rotate,audioCodec:Ie.AudioCodec,videoCodec:Ie.VideoCodec,container:Ie.Container,size:Ie.Size||k.fileSize})}catch(ie){de(ie)}},onerror:de}):v.uploaddone(null,{docId:ze.docId,size:k.fileSize})}function de(Ie){b.onError(Ie)}}function he(ze){v.errorHook(ze,{url:y,provider:"nos"});var le=ze&&ze.code;function de(){try{if(ze.result)var Ie=JSON.parse(ze.result);else Ie=ze;b.onError(Ie)}catch(ie){b.onError(ie)}}k.fileUploadedSize===0&&le!=="abort"?v.edgeList?T<v.edgeList.length-1?m(v,g,b,T+1):de():v.nosLbsUrls&&v.nosLbsUrls.length>0?function(Ie,ie,Ve,Ue,Dt){return new a(function(tr){function dr(){Dt.adaptersRequest(Ve[Ie],{query:{version:"1.0",bucketname:ie},method:"GET",onerror:fr,onload:function(sr){try{(sr=JSON.parse(sr))&&sr.upload&&sr.upload.length?tr(sr.upload):fr()}catch{fr()}}},{exception_service:3})}function fr(){Ue.onLbsUrlFail(Ve[Ie]),Ie<Ve.length-1?(Ie++,dr()):tr([])}dr()})}(0,v.nosToken.bucket,v.nosLbsUrls,b,v).then(function(Ie){Ie.length>0?(v.edgeList=Ie,v.updateNosEdgeList&&v.updateNosEdgeList(Ie),m(v,g,b,T+1)):de()}):(v.edgeList=i.edgeList,m(v,g,b,T+1)):de()}typeof T!="number"&&(T=-1),v.edgeList&&v.edgeList.length&&(T=T>0?T:0,y=v.edgeList[T]),y+="/"+v.nosToken.bucket+"/"+v.nosToken.objectName;var ae=v.data.file&&v.data.file.type;if(!ae||s(ae).call(ae,"/")<0){var Ne=(v.fileInputName||"").split(".").pop();v.type==="image"?ae="image/"+(Ne==="jpg"?"jpeg":Ne):v.type!=="audio"&&v.type!=="video"||(ae=d[Ne])}var _e={query:{offset:0,complete:u>=k.fileSize,version:"1.0"},headers:{"Content-Type":ae||"application/octet-stream","x-nos-token":v.nosToken.token},method:"POST",timeout:0,onaftersend:function(){v.beginupload(b)},onuploading:A,onload:V,onerror:he};if(typeof FileReader<"u"){var Ce,re=new FileReader;re.addEventListener("load",function(ze){_e.data=ze.target.result,b.sn=c(y,_e)}),re.addEventListener("error",function(ze){_e.onerror(ze.target.error)}),re.readAsArrayBuffer(n(Ce=k.file).call(Ce,0,u))}else{var ue;_e.data=n(ue=k.file).call(ue,0,u),b.sn=c(y,_e)}}},function(t,r,e){e(608);var n=e(12);t.exports=n.Reflect.construct},function(t,r,e){var n=e(1),o=e(33),s=e(76),a=e(272),i=e(168),u=e(36),c=e(28),d=e(80),m=e(4),v=o("Reflect","construct"),g=Object.prototype,b=[].push,T=m(function(){function A(){}return!(v(function(){},[],A)instanceof A)}),k=!m(function(){v(function(){})}),y=T||k;n({target:"Reflect",stat:!0,forced:y,sham:y},{construct:function(A,V){i(A),u(V);var he=arguments.length<3?A:i(arguments[2]);if(k&&!T)return v(A,V,he);if(A==he){switch(V.length){case 0:return new A;case 1:return new A(V[0]);case 2:return new A(V[0],V[1]);case 3:return new A(V[0],V[1],V[2]);case 4:return new A(V[0],V[1],V[2],V[3])}var ae=[null];return s(b,ae,V),new(s(a,A,ae))}var Ne=he.prototype,_e=d(c(Ne)?Ne:g),Ce=s(A,_e,V);return c(Ce)?Ce:_e}})},function(t,r,e){t.exports=e(610)},function(t,r,e){var n=e(611);t.exports=n},function(t,r,e){var n=e(214);t.exports=n},function(t,r,e){t.exports=e(613)},function(t,r,e){var n=e(614);t.exports=n},function(t,r,e){var n=e(615);t.exports=n},function(t,r,e){var n=e(616);t.exports=n},function(t,r,e){e(617);var n=e(12);t.exports=n.Object.setPrototypeOf},function(t,r,e){e(1)({target:"Object",stat:!0},{setPrototypeOf:e(135)})},function(t,r,e){t.exports=e(619)},function(t,r,e){var n=e(620);t.exports=n},function(t,r,e){var n=e(271);t.exports=n},function(t,r){t.exports=function(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(623)},function(t,r,e){var n=e(624);t.exports=n},function(t,r,e){var n=e(282);t.exports=n},function(t,r,e){e(626);var n=e(12);t.exports=n.Object.getPrototypeOf},function(t,r,e){var n=e(1),o=e(4),s=e(42),a=e(134),i=e(227);n({target:"Object",stat:!0,forced:o(function(){a(1)}),sham:!i},{getPrototypeOf:function(u){return a(s(u))}})},function(t,r,e){var n,o=e(139),s=e(6),a=e(10),i=e(24),u=e(8),c=e(15),d=e(5),m=e(0),v=e(73).fn,g=e(284),b=e(275),T=e(40),k=e(23).reportAPI;v.transDoc=function(y){var A;m.verifyOptions(y,"fileInput done","nos::transDoc");try{var V=y.fileInput.files[0],he=["ppt","pdf","pptx","doc","docx"],ae=y.fileInputName=V.name,Ne={ppt:1,pptx:2,pdf:3,doc:6,docx:7},_e=ae.substring(o(ae).call(ae,".")+1);if(s(he).call(he,_e)<0)return void y.done(T.newNoFileError("请上传正确格式的文件【ppt, pptx, pdf, doc, docx】",{callFunc:"nos: transDoc",fileInput:y.fileInput}),y)}catch{return void y.done(T.newNoFileError("请上传正确的文件节点",{callFunc:"msg::previewFile",fileInput:y.fileInput}),y)}var Ce=a(b.genResponseBody("file")||{}).replace(/"/gi,'\\"'),re={transToken:{name:ae,type:Ne[_e],transType:y.transcode==="png"?11:10,size:V.size,body:Ce}};this.getNosTokenTrans({responseBody:re,nosToken:{nosScene:y.nosScene||this.nosScene,nosSurvivalTime:y.nosSurvivalTime},callback:i(A=function(ue,ze){ue?y.done(ue):(y.nosToken=ze.nosToken,y.docId=ze.docId,this._doPreviewFile(y))}).call(A,this)})},v.getSimpleNosToken=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return y.num=1,m.verifyOptions(y),this.cbAndSendCmd("getSimpleNosToken",y)},v.getNosToken=function(y){var A=y.callback,V=y.nosToken,he=y.responseBody,ae={tag:V.nosScene};V.nosSurvivalTime&&V.nosSurvivalTime!==1/0&&(ae.expireSec=V.nosSurvivalTime),this.sendCmd("getNosToken",{responseBody:he,nosToken:ae},A)},v.getNosTokenTrans=function(y){this.sendCmd("getNosTokenTrans",y.responseBody,y.callback)},v.getMixStoreToken=function(y){this.sendCmd("getMixStoreToken",{mixTokenReq:{provider:y.curProvider,tokenCount:y.tokenCount||1,tag:"im",returnBody:y.responseBody}},y.callback)},v.packFileDownloadName=function(y){k({instance:this,className:"ApiBaseFn",funcName:"packFileDownloadName",hasCallback:!1}),m.verifyOptions(y,"url name",!0,"","nos::packFileDownloadName");var A=y.url;return A+m.genUrlSep(A)+"download="+encodeURIComponent(y.name)},v.audioToMp3=function(y){k({instance:this,className:"ApiBaseFn",funcName:"audioToMp3",hasCallback:!1}),m.verifyOptions(y,"url","nos::audioToMp3");var A=y.url;return A+m.genUrlSep(A)+"audioTrans&type=mp3"},v.removeFile=function(y){this.sendCmd("removeFile",y,y.callback)},v.fetchFile=function(y){this.sendCmd("fetchFile",y,y.callback)},v.fetchFileList=function(y){this.sendCmd("fetchFileList",y,y.callback)},v.stripImageMeta=function(y){return k({instance:this,className:"ApiBaseFn",funcName:"stripImageMeta",hasCallback:!1}),this.beforeProcessImage(y,"stripmeta")},v.qualityImage=function(y){return k({instance:this,className:"ApiBaseFn",funcName:"qualityImage",hasCallback:!1}),this.beforeProcessImage(y,"quality")},v.interlaceImage=function(y){return k({instance:this,className:"ApiBaseFn",funcName:"interlaceImage",hasCallback:!1}),this.beforeProcessImage(y,"interlace")},v.rotateImage=function(y){return k({instance:this,className:"ApiBaseFn",funcName:"rotateImage",hasCallback:!1}),this.beforeProcessImage(y,"rotate")},v.blurImage=function(y){return k({instance:this,className:"ApiBaseFn",funcName:"blurImage",hasCallback:!1}),this.beforeProcessImage(y,"blur")},v.cropImage=function(y){return k({instance:this,className:"ApiBaseFn",funcName:"cropImage",hasCallback:!1}),this.beforeProcessImage(y,"crop")},v.thumbnailImage=function(y){return k({instance:this,className:"ApiBaseFn",funcName:"thumbnailImage",hasCallback:!1}),this.beforeProcessImage(y,"thumbnail")},v.beforeProcessImage=function(y,A){var V=m.copy(y);return V.type=A,y.ops=[V],this.processImage(y)},v.processImage=function(y){var A;y.callback=k({instance:this,className:"ApiBaseFn",funcName:"processImage",done:y.callback});var V=this;m.verifyOptions(y,"url ops",!0,"","nos::processImage"),m.verifyParamType("ops",y.ops,"array","nos::processImage");var he=u(A=y.ops).call(A,function(ae){var Ne,_e;return m.verifyOptions(ae,"type",!0,"","nos::processImage"),m.verifyParamValid("type",ae.type,g.validTypes,"nos::processImage"),V["gen"+c(Ne=ae.type).call(Ne,0,1).toUpperCase()+c(_e=ae.type).call(_e,1)+"Op"](ae)});V.processCallback(y),V.sendCmd("processImage",{url:y.url,imageOps:he},y.callback)},v.genStripmetaOp=function(y){return new g({type:y.type,stripmeta:y.strip?1:0})},v.genQualityOp=function(y){m.verifyOptions(y,"quality",!0,"","nos::genQualityOp"),m.verifyParamType("quality",y.quality,"number","nos::genQualityOp"),m.verifyParamMin("quality",y.quality,0,"nos::genQualityOp"),m.verifyParamMax("quality",y.quality,100,"nos::genQualityOp");var A=Math.round(y.quality);return new g({type:y.type,qualityQuality:A})},v.genInterlaceOp=function(y){return new g({type:y.type})},v.genRotateOp=function(y){for(m.verifyOptions(y,"angle",!0,"","nos::genRotateOp"),m.verifyParamType("angle",y.angle,"number","nos::genRotateOp");y.angle<0;)y.angle=y.angle+360;y.angle=y.angle%360;var A=Math.round(y.angle);return new g({type:y.type,rotateAngle:A})},v.genBlurOp=function(y){m.verifyOptions(y,"radius sigma","nos::genBlurOp"),m.verifyParamType("radius",y.radius,"number","nos::genBlurOp"),m.verifyParamMin("radius",y.radius,1,"nos::genBlurOp"),m.verifyParamMax("radius",y.radius,50,"nos::genBlurOp"),m.verifyParamType("sigma",y.sigma,"number","nos::genBlurOp"),m.verifyParamMin("sigma",y.sigma,0,"nos::genBlurOp");var A=Math.round(y.radius),V=Math.round(y.sigma);return new g({type:y.type,blurRadius:A,blurSigma:V})},v.genCropOp=function(y){m.verifyOptions(y,"x y width height","nos::genCropOp"),m.verifyParamType("x",y.x,"number","nos::genCropOp"),m.verifyParamMin("x",y.x,0,"nos::genCropOp"),m.verifyParamType("y",y.y,"number","nos::genCropOp"),m.verifyParamMin("y",y.y,0,"nos::genCropOp"),m.verifyParamType("width",y.width,"number","nos::genCropOp"),m.verifyParamMin("width",y.width,0,"nos::genCropOp"),m.verifyParamType("height",y.height,"number","nos::genCropOp"),m.verifyParamMin("height",y.height,0,"nos::genCropOp");var A=Math.round(y.x),V=Math.round(y.y),he=Math.round(y.width),ae=Math.round(y.height);return new g({type:y.type,cropX:A,cropY:V,cropWidth:he,cropHeight:ae})},v.genThumbnailOp=(n={cover:"z",contain:"x",crop:"y"},function(y){m.verifyOptions(y,"mode","nos::genThumbnailOp"),m.verifyParamValid("mode",y.mode,d(n),"nos::genThumbnailOp"),y.mode==="contain"?m.verifyParamAtLeastPresentOne(y,"width height","nos::genThumbnailOp"):m.verifyOptions(y,"width height","nos::genThumbnailOp"),m.undef(y.width)&&(y.width=0),m.undef(y.height)&&(y.height=0),m.verifyParamType("width",y.width,"number","nos::genThumbnailOp"),m.verifyParamMin("width",y.width,0,"nos::genThumbnailOp"),m.verifyParamType("height",y.height,"number","nos::genThumbnailOp"),m.verifyParamMin("height",y.height,0,"nos::genThumbnailOp");var A=Math.round(y.width),V=Math.round(y.height),he=new g({type:y.type,thumbnailMode:n[y.mode],thumbnailWidth:A,thumbnailHeight:V});if(y.mode==="crop"&&m.notundef(y.axis)){m.undef(y.axis.x)&&(y.axis.x=5),m.undef(y.axis.y)&&(y.axis.y=5),m.verifyParamMin("axis.x",y.axis.x,0,"nos::genThumbnailOp"),m.verifyParamMax("axis.x",y.axis.x,10,"nos::genThumbnailOp"),m.verifyParamMin("axis.y",y.axis.y,0,"nos::genThumbnailOp"),m.verifyParamMax("axis.y",y.axis.y,10,"nos::genThumbnailOp");var ae=Math.round(y.axis.x),Ne=Math.round(y.axis.y);he.thumbnailAxisX=ae,he.thumbnailAxisY=Ne}return m.notundef(y.enlarge)&&(m.verifyParamType("enlarge",y.enlarge,"boolean","nos::genThumbnailOp"),y.enlarge&&(he.thumbnailEnlarge=1)),he.thumbnailToStatic=this.options.thumbnailToStatic?1:0,he}),v.getNosOriginUrl=function(y){var A;(y=y||{}).done=k({instance:this,className:"ApiBaseFn",funcName:"getNosOriginUrl",done:y.done}),m.verifyOptions(y,"safeShortUrl",!0,"","nos::getNosOriginUrl"),m.verifyParamType("safeShortUrl",y.safeShortUrl,"string","nos::getNosOriginUrl"),/^http(s)?:/.test(y.safeShortUrl)&&~s(A=y.safeShortUrl).call(A,"im_url=1")?(this.processCallback(y),this.sendCmd("getNosOriginUrl",{nosFileUrlTag:{safeUrl:y.safeShortUrl}},y.callback)):y.done(new T("参数 “safeShortUrl” 内容非文件安全短链",{callFunc:"nos: getNosOriginUrl"}),y)}},function(t,r,e){var n,o=e(7),s=e(6),a=e(5),i=e(25),u=e(106),c=u.genUrlSep,d=u.url2object,m=u.object2url,v=e(0),g=e(73).fn,b=e(23).reportAPI;g.viewImageSync=function(T){b({instance:this,className:"ApiBaseFn",funcName:"viewImageSync",hasCallback:!1});var k=this.options;v.verifyOptions(T,"url","nos::viewImageSync");var y=T.url,A=d(y),V=A.protocol,he=A.hostname,ae=A.path,Ne=A.query;if(typeof T.strip=="boolean"&&(Ne.stripmeta=T.strip?1:0),typeof T.quality=="number"&&(v.verifyParamMin("quality",T.quality,0,"nos::viewImageSync"),v.verifyParamMax("quality",T.quality,100,"nos::viewImageSync"),Ne.quality=Math.round(T.quality)),typeof T.interlace=="boolean"&&(Ne.interlace=T.interlace?1:0),typeof T.rotate=="number"&&(Ne.rotate=Math.round(T.rotate)),i(T.thumbnail)==="object"){var _e=T.thumbnail.mode||"crop",Ce=T.thumbnail.width,re=T.thumbnail.height;if(Ce>=0&&re>=0&&Ce<4096&&re<4096&&(Ce>0||re>0)){var ue,ze;switch(_e){case"crop":_e="y";break;case"contain":_e="x";break;case"cover":_e="z";break;default:_e="x"}Ne.thumbnail=o(ue=o(ze="".concat(Ce)).call(ze,_e)).call(ue,re)}}if(k.downloadUrl){var le=d(T.url),de=k.downloadUrl,Ie=le.path,ie=s(Ie).call(Ie,"/");if(ie!==-1){var Ve=Ie.substring(0,ie),Ue=Ie.substring(ie+1);de=de.replace("{bucket}",Ve).replace("{object}",Ue)}var Dt=d(de);return m({protocol:Dt.protocol,hostname:Dt.hostname,path:Dt.path,query:v.merge(Dt.query,Ne)})}return m({protocol:V,hostname:he,path:ae,query:Ne})},g.viewImageStripMeta=function(T){b({instance:this,className:"ApiBaseFn",funcName:"viewImageStripMeta",hasCallback:!1}),v.verifyOptions(T,"url strip","nos::viewImageStripMeta"),v.verifyParamType("strip",T.strip,"boolean","nos::viewImageStripMeta");var k="stripmeta="+(T.strip?1:0),y=c(T.url);return T.url+y+k},g.viewImageQuality=function(T){b({instance:this,className:"ApiBaseFn",funcName:"viewImageQuality",hasCallback:!1}),v.verifyOptions(T,"url quality","nos::viewImageQuality"),v.verifyParamType("quality",T.quality,"number","nos::viewImageQuality"),v.verifyParamMin("quality",T.quality,0,"nos::viewImageQuality"),v.verifyParamMax("quality",T.quality,100,"nos::viewImageQuality");var k="quality="+Math.round(T.quality),y=c(T.url);return T.url+y+k},g.viewImageInterlace=function(T){b({instance:this,className:"ApiBaseFn",funcName:"viewImageInterlace",hasCallback:!1}),v.verifyOptions(T,"url","nos::viewImageInterlace");var k=c(T.url);return T.url+k+"interlace=1"},g.viewImageRotate=function(T){for(b({instance:this,className:"ApiBaseFn",funcName:"viewImageRotate",hasCallback:!1}),v.verifyOptions(T,"url angle","nos::viewImageRotate"),v.verifyParamType("angle",T.angle,"number","nos::viewImageRotate");T.angle<0;)T.angle=T.angle+360;T.angle=T.angle%360;var k="rotate="+Math.round(T.angle),y=c(T.url);return T.url+y+k},g.viewImageBlur=function(T){b({instance:this,className:"ApiBaseFn",funcName:"viewImageBlur",hasCallback:!1}),v.verifyOptions(T,"url radius sigma","nos::viewImageBlur"),v.verifyParamType("radius",T.radius,"number","nos::viewImageBlur"),v.verifyParamMin("radius",T.radius,1,"nos::viewImageBlur"),v.verifyParamMax("radius",T.radius,50,"nos::viewImageBlur"),v.verifyParamType("sigma",T.sigma,"number","nos::viewImageBlur"),v.verifyParamMin("sigma",T.sigma,0,"nos::viewImageBlur");var k="blur="+Math.round(T.radius)+"x"+Math.round(T.sigma),y=c(T.url);return T.url+y+k},g.viewImageCrop=function(T){b({instance:this,className:"ApiBaseFn",funcName:"viewImageCrop",hasCallback:!1}),v.verifyOptions(T,"url x y width height","nos::viewImageCrop"),v.verifyParamType("x",T.x,"number","nos::viewImageCrop"),v.verifyParamMin("x",T.x,0,"nos::viewImageCrop"),v.verifyParamType("y",T.y,"number","nos::viewImageCrop"),v.verifyParamMin("y",T.y,0,"nos::viewImageCrop"),v.verifyParamType("width",T.width,"number","nos::viewImageCrop"),v.verifyParamMin("width",T.width,0,"nos::viewImageCrop"),v.verifyParamType("height",T.height,"number","nos::viewImageCrop"),v.verifyParamMin("height",T.height,0,"nos::viewImageCrop");var k="crop="+Math.round(T.x)+"_"+Math.round(T.y)+"_"+Math.round(T.width)+"_"+Math.round(T.height),y=c(T.url);return T.url+y+k},g.viewImageThumbnail=(n={cover:"z",contain:"x",crop:"y"},function(T){v.verifyOptions(T,"url mode","nos::viewImageThumbnail"),v.verifyParamValid("mode",T.mode,a(n),"nos::viewImageThumbnail"),T.mode==="contain"?v.verifyParamAtLeastPresentOne(T,"width height","nos::viewImageThumbnail"):v.verifyOptions(T,"width height","nos::viewImageThumbnail"),v.undef(T.width)&&(T.width=0),v.undef(T.height)&&(T.height=0),v.verifyParamType("width",T.width,"number","nos::viewImageThumbnail"),v.verifyParamMin("width",T.width,0,"nos::viewImageThumbnail"),v.verifyParamType("height",T.height,"number","nos::viewImageThumbnail"),v.verifyParamMin("height",T.height,0,"nos::viewImageThumbnail");var k=Math.round(T.width),y=Math.round(T.height),A="thumbnail="+k+n[T.mode]+y;T.mode==="crop"&&v.notundef(T.axis)&&(v.undef(T.axis.x)&&(T.axis.x=5),v.undef(T.axis.y)&&(T.axis.y=5),v.verifyParamMin("axis.x",T.axis.x,0,"nos::viewImageThumbnail"),v.verifyParamMax("axis.x",T.axis.x,10,"nos::viewImageThumbnail"),v.verifyParamMin("axis.y",T.axis.y,0,"nos::viewImageThumbnail"),v.verifyParamMax("axis.y",T.axis.y,10,"nos::viewImageThumbnail"),A=A+"&axis="+Math.round(T.axis.x)+"_"+Math.round(T.axis.y)),v.notundef(T.enlarge)&&(v.verifyParamType("enlarge",T.enlarge,"boolean","nos::viewImageThumbnail"),T.enlarge&&(A+="&enlarge=1"));var V=c(T.url);return T.url+V+A})},function(t,r,e){var n=e(630);t.exports=n},function(t,r,e){var n=e(21),o=e(631),s=e(633),a=Array.prototype,i=String.prototype;t.exports=function(u){var c=u.includes;return u===a||n(a,u)&&c===a.includes?o:typeof u=="string"||u===i||n(i,u)&&c===i.includes?s:c}},function(t,r,e){e(632);var n=e(30);t.exports=n("Array").includes},function(t,r,e){var n=e(1),o=e(159).includes,s=e(4),a=e(195);n({target:"Array",proto:!0,forced:s(function(){return!Array(1).includes()})},{includes:function(i){return o(this,i,arguments.length>1?arguments[1]:void 0)}}),a("includes")},function(t,r,e){e(634);var n=e(30);t.exports=n("String").includes},function(t,r,e){var n=e(1),o=e(11),s=e(635),a=e(108),i=e(49),u=e(637),c=o("".indexOf);n({target:"String",proto:!0,forced:!u("includes")},{includes:function(d){return!!~c(i(a(this)),i(s(d)),arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(636),o=TypeError;t.exports=function(s){if(n(s))throw o("The method doesn't accept regular expressions");return s}},function(t,r,e){var n=e(28),o=e(63),s=e(20)("match");t.exports=function(a){var i;return n(a)&&((i=a[s])!==void 0?!!i:o(a)=="RegExp")}},function(t,r,e){var n=e(20)("match");t.exports=function(o){var s=/./;try{"/./"[o](s)}catch{try{return s[n]=!1,"/./"[o](s)}catch{}}return!1}},function(t,r,e){var n=e(25),o=e(10),s=e(6),a=e(304),i=e(0),u=e(73).fn,c=e(13),d=e(23).reportAPI;function m(g,b,T,k){var y=!1,A="";if(T===1?s(g).call(g,b)>=0&&(y=!0,A=b):T===2&&(A=new RegExp(b,"g")).test(g)&&(y=!0),y&&A!=="")switch(k){case 1:return g.replace(A,"**");case 2:return{code:2};case 3:return{code:3}}return g}function v(g,b){for(var T=b.match,k=b.operate,y=g,A=0;A<a(b).length;A++){var V=a(b)[A],he=V.match||T,ae=V.operate||k;try{if(y=m(y,V.key,he,ae),n(y)==="object")return y}catch(Ne){this.logger.warn("misc::filterContent: js cannot parse this regexp ",Ne)}}return y}u.uploadSdkLogUrl=function(g){return i.verifyOptions(g,"url","misc::uploadSdkLogUrl"),this.cbAndSendCmd("uploadSdkLogUrl",g)},u.getClientAntispamLexicon=function(g){var b=this;(g=g||{}).done=d({instance:this,className:"ApiBaseFn",funcName:"getClientAntispamLexicon",done:g.done});var T=(g=g||{}).done;T instanceof Function||(T=function(){}),g={clientAntispam:{version:0}};var k=this;if(c.hasLocalStorage&&localStorage.getItem("antispamLexicon")&&localStorage.getItem("antispamLexicon")!=="{}")try{k.antispamLexicon=JSON.parse(localStorage.getItem("antispamLexicon"))}catch(y){this.logger.error("JSON parse antispamLexicon error",y)}k.antispamLexicon&&T.call(this,null,{clientAntispam:k.antispamLexicon}),this.protocol.sendCmd("getClientAntispam",g,function(y,A,V){y?(k.protocol.logger.error("misc::getClientAntispamLexicon:",y),T.call(b,y,{})):(c.hasLocalStorage&&localStorage.setItem("antispamLexicon",o(V.clientAntispam)),k.antispamLexicon||T.call(b,null,V),k.antispamLexicon=V.clientAntispam||{})})},u.filterClientAntispam=function(g){d({instance:this,className:"ApiBaseFn",funcName:"filterClientAntispam",hasCallback:!1});var b=g.content;if(!b)return{code:404,errmsg:"待反垃圾文本content不存在"};var T=this.antispamLexicon&&this.antispamLexicon.thesaurus;if(!T)return{code:404,errmsg:"没有反垃圾词库或者词库格式不合法"};try{T=JSON.parse(T).thesaurus}catch{return this.protocol.logger.error("misc::filterClientAntispam: parse thesaurus error"),{code:500,errmsg:"反垃圾词库格式不合法"}}for(var k=b,y=0;y<T.length;y++)if(k=v.call(this,k,T[y]),n(k)==="object"){if(k.code===2)return{code:200,type:2,errmsg:"建议拒绝发送",content:b,result:""};if(k.code===3)return{code:200,type:3,errmsg:"建议服务器处理反垃圾，发消息带上字段clientAntiSpam",content:b,result:b}}return k===b?{code:200,type:0,errmsg:"",content:b,result:k}:{code:200,type:1,errmsg:"已对特殊字符做了过滤",content:b,result:k}},u.getServerTime=function(g){(g=g||{}).done=d({instance:this,className:"ApiBaseFn",funcName:"getServerTime",done:g.done}),this.processCallback(g),this.sendCmd("getServerTime",{},g.callback)},u.getNosAccessToken=function(g){(g=g||{}).done=d({instance:this,className:"ApiBaseFn",funcName:"getNosAccessToken",done:g.done}),i.verifyOptions(g,"url","misc::getNosAccessToken"),this.processCallback(g);var b={url:g.url};g.userAgent&&(b.userAgent=g.userAgent),g.ext&&(b.ext=g.ext),this.sendCmd("getNosAccessToken",{nosAccessTokenTag:b},function(T,k,y){var A=y&&y.nosAccessTokenTag&&y.nosAccessTokenTag.token,V=g.url,he=A?{token:A,resUrl:s(V).call(V,"?")!==-1?V+"&token="+A:V+"?token="+A}:{};g.done(T,he)})},u.deleteNosAccessToken=function(g){(g=g||{}).done=d({instance:this,className:"ApiBaseFn",funcName:"deleteNosAccessToken",done:g.done}),i.verifyOptions(g,"token","misc::deleteNosAccessToken"),this.processCallback(g),this.sendCmd("deleteNosAccessToken",{nosAccessTokenTag:{token:g.token}},g.callback)}},function(t,r,e){e(67);var n=e(65),o=e(29),s=e(21),a=e(640),i=Array.prototype,u={DOMTokenList:!0,NodeList:!0};t.exports=function(c){var d=c.keys;return c===i||s(i,c)&&d===i.keys||o(u,n(c))?a:d}},function(t,r,e){var n=e(641);t.exports=n},function(t,r,e){e(82),e(96);var n=e(30);t.exports=n("Array").keys},function(t,r,e){var n=e(25),o=e(3),s=e(8),a=e(10),i=e(73).fn,u=e(0),c=e(190),d=e(285),m=e(23).reportAPI;i.signalingCreate=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.type,b=v.channelName,T=v.ext;return u.verifyOptions(v,"type","api::signalling"),this.sendCmdUsePromise("signalingCreate",{avSignalTag:{type:g,channelName:b,ext:T}}).then(function(k){var y=k.avSignalTag;return o.resolve(y)}).catch(function(k){return o.reject(d.parseAvSignalError(k))})},i.signalingDelay=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return u.verifyOptions(v,"channelId","api::signalling"),this.sendCmdUsePromise("signalingDelay",{avSignalTag:v}).then(function(g){var b=g.avSignalTag;return o.resolve(b)}).catch(function(g){return o.reject(d.parseAvSignalError(g))})},i.signalingClose=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.offlineEnabled;return u.verifyOptions(v,"channelId","api::signalling"),this.sendCmdUsePromise("signalingClose",{avSignalTag:u.merge(v,{isSave:g===!0?1:0})}).then(function(b){var T=b.avSignalTag;return T.offlineEnabled=T.isSave===1,delete T.isSave,o.resolve(T)}).catch(function(b){return o.reject(d.parseAvSignalError(b))})},i.signalingJoin=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.offlineEnabled;return u.verifyOptions(v,"channelId","api::signalling"),this.sendCmdUsePromise("signalingJoin",{avSignalTag:u.merge(v,{isSave:g===!0?1:0})}).then(function(b){var T,k=b.avSignalTag,y=k.members;return typeof k.members=="string"&&(y=s(T=JSON.parse(k.members)).call(T,function(A){return d.parseAvSignalMember(A)})),k.members=y,o.resolve(k)}).catch(function(b){return o.reject(d.parseAvSignalError(b))})},i.signalingLeave=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.offlineEnabled;return u.verifyOptions(v,"channelId","api::signalling"),this.sendCmdUsePromise("signalingLeave",{avSignalTag:u.merge(v,{isSave:g===!0?1:0})}).then(function(b){var T=b.avSignalTag;return T.offlineEnabled=T.isSave===1,delete T.isSave,o.resolve(T)}).catch(function(b){return o.reject(d.parseAvSignalError(b))})},i.signalingGetChannelInfo=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.channelName;return u.verifyOptions(v,"channelName","api::signalling"),this.sendCmdUsePromise("signalingGetChannelInfo",{avSignalTag:{channelName:g}}).then(function(b){var T,k=b.avSignalTag,y=k.members;return typeof k.members=="string"&&(y=s(T=JSON.parse(k.members)).call(T,function(A){return d.parseAvSignalMember(A)})),k.members=y,o.resolve(k)}).catch(function(b){return o.reject(d.parseAvSignalError(b))})},i.signalingInvite=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.account,b=v.offlineEnabled,T=v.pushInfo,k=T===void 0?{}:T;u.verifyOptions(v,"channelId requestId account","api::signalling"),n(k.pushPayload)==="object"&&(k.pushPayload=a(k.pushPayload));var y=u.merge(v,k,{to:g,isSave:b===!0?1:0,needPush:k.needPush===!0?1:0,needBadge:k.needBadge===!1?0:1});return this.sendCmdUsePromise("signalingInvite",{avSignalTag:y}).then(function(A){var V=A.avSignalTag;return V.offlineEnabled=V.isSave===1,V.needBadge=V.needBadge===1,V.needPush=V.needPush===1,delete V.isSave,o.resolve(V)}).catch(function(A){return o.reject(d.parseAvSignalError(A))})},i.signalingCancel=function(v){var g=v.account,b=v.offlineEnabled;return u.verifyOptions(v,"channelId requestId account","api::signalling"),this.sendCmdUsePromise("signalingCancel",{avSignalTag:u.merge(v,{to:g,isSave:b===!0?1:0})}).then(function(T){var k=T.avSignalTag;return k.offlineEnabled=k.isSave===1,delete k.isSave,o.resolve(k)}).catch(function(T){return o.reject(d.parseAvSignalError(T))})},i.signalingCreateAndJoin=function(v){var g=this,b=m({instance:this,className:"ApiBaseFn",funcName:"signalingCreateAndJoin",hasCallback:!0}),T=v.channelName,k=v.uid,y=k===void 0?0:k,A=v.offlineEnabled,V=A===void 0||A,he=v.attachExt,ae=he===void 0?"":he;return this.signalingCreate(v).catch(function(Ne){return Ne.code===10405?(g.logger.warn("api::avSignal:signalingCall room already exists:",Ne),g.signalingGetChannelInfo({channelName:T})):o.reject(Ne)}).then(function(Ne){var _e={channelId:Ne.channelId,offlineEnabled:V,attachExt:ae,nertcChannelName:v.nertcChannelName,nertcTokenTtl:v.nertcTokenTtl,nertcJoinRoomQueryParamMap:v.nertcJoinRoomQueryParamMap};return y&&u.merge(_e,{uid:y}),g.signalingJoin(_e)}).then(function(Ne){return typeof b=="function"&&b(void 0),Ne}).catch(function(Ne){throw typeof b=="function"&&b(Ne),Ne})},i.signalingCall=function(v){var g=this,b=m({instance:this,className:"ApiBaseFn",funcName:"signalingCall",hasCallback:!0}),T=v.account,k=v.offlineEnabled,y=v.requestId;u.verifyOptions(v,"type requestId account","api::signalling");var A="";return this.signalingCreateAndJoin(v).then(function(V){A=V.channelId||A,g.logger.info("api::avSignal:signalingCall join:",A);var he={channelId:A,account:T,requestId:y,offlineEnabled:k,attachExt:v.attachExt||"",pushInfo:v.pushInfo||{},nertcTokenTtl:V.nertcTokenTtl,nertcToken:V.nertcToken};return g.signalingInvite(he)}).then(function(V){return typeof b=="function"&&b(void 0),V}).catch(function(V){throw typeof b=="function"&&b(V),V})},i.signalingReject=function(v){var g=v.account,b=v.offlineEnabled;return u.verifyOptions(v,"channelId requestId account","api::signalling"),this.sendCmdUsePromise("signalingReject",{avSignalTag:u.merge(v,{to:g,isSave:b===!0?1:0})}).then(function(T){var k=T.avSignalTag;return k.offlineEnabled=k.isSave===1,delete k.isSave,o.resolve(k)}).catch(function(T){return o.reject(d.parseAvSignalError(T))})},i.signalingAccept=function(v){var g=this,b=v.account,T=v.offlineEnabled;return u.verifyOptions(v,"channelId requestId account","api::signalling"),this.sendCmdUsePromise("signalingAccept",{avSignalTag:u.merge(v,{to:b,isSave:T===!0?1:0})}).then(function(k){var y=k.avSignalTag;return y.offlineEnabled=y.isSave===1,delete y.isSave,o.resolve(y)}).catch(function(k){return o.reject(d.parseAvSignalError(k))}).then(function(k){if(v.autoJoin){var y={channelId:v.channelId,offlineEnabled:v.offlineEnabled,attachExt:v.joinAttachExt,uid:v.uid,nertcChannelName:v.nertcChannelName,nertcTokenTtl:v.nertcTokenTtl,nertcJoinRoomQueryParamMap:v.nertcJoinRoomQueryParamMap};return g.signalingJoin(y)}return k})},i.signalingControl=function(v){var g=v.account;return u.verifyOptions(v,"channelId","api::signalling"),this.sendCmdUsePromise("signalingControl",{avSignalTag:u.merge(v,g?{to:g}:{})}).then(function(b){var T=b.avSignalTag;return o.resolve(T)}).catch(function(b){return o.reject(d.parseAvSignalError(b))})},i.signalingSync=function(){return this.sendCmdUsePromise("sync",{sync:{avSignal:0}}).then(function(v){var g=v.avSignalTag;return o.resolve(g)}).catch(function(v){return o.reject(d.parseAvSignalError(v))})},i.signalingMarkMsgRead=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};m({instance:this,className:"ApiBaseFn",funcName:"signalingMarkMsgRead",hasCallback:!1}),u.verifyOptions(v,"msgid","api::signalling");var g,b=c.idMap.avSignal;return g=typeof v.msgid=="string"?[v.msgid]:v.msgid,this.sendCmd("batchMarkRead",{sid:b.id,cid:b.signalingNotify,ids:g})},i.signalingCallEx=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.account,b=v.offlineEnabled,T=v.pushInfo,k=T===void 0?{}:T;n(k.pushPayload)==="object"&&(k.pushPayload=a(k.pushPayload)),u.verifyOptions(v,"type","api::signalling"),u.verifyOptions(v,"account","api::signalling");var y=u.merge(v,k,{to:g,isSave:b===!0?1:0,needPush:k.needPush===!0?1:0,needBadge:k.needBadge===!1?0:1});return this.sendCmdUsePromise("signalingCallEx",{avSignalTag:y}).then(function(A){var V,he=A.avSignalTag,ae=he.members;return typeof he.members=="string"&&(ae=s(V=JSON.parse(he.members)).call(V,function(Ne){return d.parseAvSignalMember(Ne)})),he.members=ae,o.resolve(he)}).catch(function(A){return o.reject(d.parseAvSignalError(A))})},i.signalingJoinAndAccept=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=v.channelId,b=v.attachExt,T=v.offlineEnabled,k=v.uid,y=v.account,A=v.requestId,V=v.nertcChannelName,he=v.nertcTokenTtl,ae=v.nertcJoinRoomQueryParamMap;return u.verifyOptions(v,"channelId","api::signalling"),u.verifyOptions(v,"account","api::signalling"),u.verifyOptions(v,"requestId","api::signalling"),this.sendCmdUsePromise("signalingJoinAndAccept",{avSignalTag:{channelId:g,attachExt:b,isSave:T===!0?1:0,uid:k,to:y,requestId:A,nertcChannelName:V,nertcTokenTtl:he,nertcJoinRoomQueryParamMap:ae}}).then(function(Ne){var _e,Ce=Ne.avSignalTag,re=Ce.members;return typeof Ce.members=="string"&&(re=s(_e=JSON.parse(Ce.members)).call(_e,function(ue){return d.parseAvSignalMember(ue)})),Ce.members=re,o.resolve(Ce)}).catch(function(Ne){return o.reject(d.parseAvSignalError(Ne))})}},function(t,r,e){var n=e(2),o=e(121),s=e(122),a=e(54).getPromiseWithAbort,i=function(){function u(){o(this,u),this.abortFns=[]}return s(u,[{key:"add",value:function(c){var d=a(c);return this.abortFns.push(d.abort),d.promise}},{key:"clear",value:function(){var c;n(c=this.abortFns).call(c,function(d){return d("Request aborted")}),this.abortFns=[]}},{key:"destroy",value:function(){this.clear()}}]),u}();t.exports=i},function(t,r,e){var n=e(102),o=e(103),s=e(2),a=e(69),i=e(3),u=e(8),c=e(57),d=e(15),m=e(7),v=e(10),g=e(24),b=e(121),T=e(122),k=e(0),y=e(13),A=e(74),V=e(287),he=e(40);t.exports=function(){function ae(_e){var Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{socketConcurrent:1};b(this,ae),this.clientProto=_e,this.logger=_e.logger,this.urls=[],this.sockets=[],this.config=Ce}var Ne;return T(ae,[{key:"setConfig",value:function(){var _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{socketConcurrent:1};this.config=_e}},{key:"setUrls",value:function(_e){this.urls=_e}},{key:"resetSockets",value:function(){var _e;s(_e=this.sockets).call(_e,function(Ce){Ce&&(Ce.removeAllListenersX("info"),Ce.disconnect())}),this.sockets=[]}},{key:"connect",value:(Ne=o(n.mark(function _e(){var Ce,re,ue,ze=this;return n.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(this.clientProto.statusProtector.emit("auth/loginLifeCycleConnect"),(re=a(Ce=this.urls).call(Ce,0,this.config.socketConcurrent)).length!==0){le.next=4;break}throw new he("no_socket_url",408,{});case 4:return le.prev=4,le.next=7,i.any(u(re).call(re,function(de,Ie){return ze.doConnect(de,Ie)}));case 7:return le.abrupt("return",le.sent);case 10:throw le.prev=10,le.t0=le.catch(4),s(ue=le.t0.errors).call(ue,function(de,Ie){ze.logger.warn("imsocket::connect failed ".concat(Ie),de)}),le.t0;case 14:case"end":return le.stop()}},_e,this,[[4,10]])})),function(){return Ne.apply(this,arguments)})},{key:"success",value:function(_e){var Ce;return s(Ce=this.sockets).call(Ce,function(re,ue){_e!==ue&&re&&(re.removeAllListenersX("info"),re.disconnect())}),this.sockets[_e]}},{key:"failed",value:function(_e){var Ce=this.sockets[_e];Ce&&(Ce.removeAllListenersX("info"),Ce.disconnect())}},{key:"getTransport",value:function(_e){var Ce=k.getGlobal();if(typeof window>"u"){var re=_e.split(":");return Ce&&!Ce.location&&re.length>1&&(Ce.location={protocol:re.shift(),port:re.pop(),hostname:re.join("")}),["websocket"]}return this.clientProto.options.transports?this.clientProto.options.transports:A.name!=="IE"||Ce.WebSocket?["websocket"]:["xhr-polling"]}},{key:"doConnect",value:function(_e,Ce){var re=this;if(this.clientProto&&this.clientProto.__destroyed===!0)return i.reject("instance has been destroyed");var ue=this.getTransport(_e),ze=c();return new i(function(le,de){var Ie,ie,Ve,Ue;try{Ue=V.connect(_e,{transports:d(ue).call(ue),reconnect:!1,"force new connection":!0,"connect timeout":y.connectTimeout,needToXHR:typeof re.clientProto.options.needToXHR=="boolean"?re.clientProto.options.needToXHR:y.needToXHR}),re.sockets[Ce]=Ue}catch(tr){var Dt;return re.logger.warn(m(Dt="link::connectToUrl ".concat(Ce,":io.connect caught exception: ")).call(Dt,tr&&tr.message),tr),void de(new he("socket_error",408,{startTime:ze,url:_e,reason:tr.message,rawError:tr}))}re.logger.info(m(Ie=m(ie="link::connectToUrl ".concat(Ce,": socket url: ")).call(ie,_e,", transports: ")).call(Ie,v(ue))),Ue.on("connect",function(){re.logger.info("link::connectToUrl ".concat(Ce," success")),re.success(Ce),re.clientProto.url=_e,le(Ue)}),Ue.on("handshake_failed",function(){re.failed(Ce),de(new he("handshake_failed",408,{startTime:ze,url:_e}))}),Ue.on("connect_failed",function(tr){re.failed(Ce),de(new he("connect_failed",408,{startTime:ze,url:_e,reason:tr}))}),Ue.on("error",function(){var tr,dr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",fr=arguments.length>1?arguments[1]:void 0,sr=fr&&fr.message||dr;re.logger.warn(m(tr="link::onSocketError ".concat(Ce,": reason is ")).call(tr,sr,", error is "),fr),de(new he("socket_error",408,{startTime:ze,url:_e,reason:sr,rawError:fr}))}),Ue.on("info",function(tr,dr){var fr,sr;dr?re.logger.info(m(fr="link::onSocketInfo ".concat(Ce,": ")).call(fr,tr,", extraInfo:"),dr):re.logger.info(m(sr="link::onSocketInfo ".concat(Ce,": ")).call(sr,tr,"."))}),Ue.on("message",g(Ve=re.clientProto.onMessage).call(Ve,re.clientProto)),Ue.on("disconnect",function(tr){re.logger.warn("link::onSocketDisconnect: socket url: ".concat(_e,", disconnected"),tr),re.clientProto.hasLogin=!1,re.clientProto.doLogout?re.clientProto.logout():re.clientProto.onDisconnect("link::socketDisconnect"),re.clientProto.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to internal reasons"))})})}},{key:"destroy",value:function(){this.urls=[],this.resetSockets()}}]),ae}()},function(t,r,e){var n=e(25).default,o=e(137),s=e(153),a=e(186),i=e(281),u=e(646),c=e(188),d=e(286),m=e(657),v=e(307);function g(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */t.exports=g=function(){return b},t.exports.__esModule=!0,t.exports.default=t.exports;var b={},T=Object.prototype,k=T.hasOwnProperty,y=o||function(or,ir,$e){or[ir]=$e.value},A=typeof s=="function"?s:{},V=A.iterator||"@@iterator",he=A.asyncIterator||"@@asyncIterator",ae=A.toStringTag||"@@toStringTag";function Ne(or,ir,$e){return o(or,ir,{value:$e,enumerable:!0,configurable:!0,writable:!0}),or[ir]}try{Ne({},"")}catch{Ne=function(ir,$e,er){return ir[$e]=er}}function _e(or,ir,$e,er){var nr=ir&&ir.prototype instanceof ue?ir:ue,Pt=a(nr.prototype),rr=new sr(er||[]);return y(Pt,"_invoke",{value:Dt(or,$e,rr)}),Pt}function Ce(or,ir,$e){try{return{type:"normal",arg:or.call(ir,$e)}}catch(er){return{type:"throw",arg:er}}}b.wrap=_e;var re={};function ue(){}function ze(){}function le(){}var de={};Ne(de,V,function(){return this});var Ie=i&&i(i(hr([])));Ie&&Ie!==T&&k.call(Ie,V)&&(de=Ie);var ie=le.prototype=ue.prototype=a(de);function Ve(or){var ir;u(ir=["next","throw","return"]).call(ir,function($e){Ne(or,$e,function(er){return this._invoke($e,er)})})}function Ue(or,ir){var $e;y(this,"_invoke",{value:function(er,nr){function Pt(){return new ir(function(rr,kt){(function Et(cr,mr,yr,Tr){var Ir=Ce(or[cr],or,mr);if(Ir.type!=="throw"){var kr=Ir.arg,Ar=kr.value;return Ar&&n(Ar)=="object"&&k.call(Ar,"__await")?ir.resolve(Ar.__await).then(function(Rr){Et("next",Rr,yr,Tr)},function(Rr){Et("throw",Rr,yr,Tr)}):ir.resolve(Ar).then(function(Rr){kr.value=Rr,yr(kr)},function(Rr){return Et("throw",Rr,yr,Tr)})}Tr(Ir.arg)})(er,nr,rr,kt)})}return $e=$e?$e.then(Pt,Pt):Pt()}})}function Dt(or,ir,$e){var er="suspendedStart";return function(nr,Pt){if(er==="executing")throw new Error("Generator is already running");if(er==="completed"){if(nr==="throw")throw Pt;return Fe()}for($e.method=nr,$e.arg=Pt;;){var rr=$e.delegate;if(rr){var kt=tr(rr,$e);if(kt){if(kt===re)continue;return kt}}if($e.method==="next")$e.sent=$e._sent=$e.arg;else if($e.method==="throw"){if(er==="suspendedStart")throw er="completed",$e.arg;$e.dispatchException($e.arg)}else $e.method==="return"&&$e.abrupt("return",$e.arg);er="executing";var Et=Ce(or,ir,$e);if(Et.type==="normal"){if(er=$e.done?"completed":"suspendedYield",Et.arg===re)continue;return{value:Et.arg,done:$e.done}}Et.type==="throw"&&(er="completed",$e.method="throw",$e.arg=Et.arg)}}}function tr(or,ir){var $e=ir.method,er=or.iterator[$e];if(er===void 0)return ir.delegate=null,$e==="throw"&&or.iterator.return&&(ir.method="return",ir.arg=void 0,tr(or,ir),ir.method==="throw")||$e!=="return"&&(ir.method="throw",ir.arg=new TypeError("The iterator does not provide a '"+$e+"' method")),re;var nr=Ce(er,or.iterator,ir.arg);if(nr.type==="throw")return ir.method="throw",ir.arg=nr.arg,ir.delegate=null,re;var Pt=nr.arg;return Pt?Pt.done?(ir[or.resultName]=Pt.value,ir.next=or.nextLoc,ir.method!=="return"&&(ir.method="next",ir.arg=void 0),ir.delegate=null,re):Pt:(ir.method="throw",ir.arg=new TypeError("iterator result is not an object"),ir.delegate=null,re)}function dr(or){var ir={tryLoc:or[0]};1 in or&&(ir.catchLoc=or[1]),2 in or&&(ir.finallyLoc=or[2],ir.afterLoc=or[3]),this.tryEntries.push(ir)}function fr(or){var ir=or.completion||{};ir.type="normal",delete ir.arg,or.completion=ir}function sr(or){this.tryEntries=[{tryLoc:"root"}],u(or).call(or,dr,this),this.reset(!0)}function hr(or){if(or){var ir=or[V];if(ir)return ir.call(or);if(typeof or.next=="function")return or;if(!isNaN(or.length)){var $e=-1,er=function nr(){for(;++$e<or.length;)if(k.call(or,$e))return nr.value=or[$e],nr.done=!1,nr;return nr.value=void 0,nr.done=!0,nr};return er.next=er}}return{next:Fe}}function Fe(){return{value:void 0,done:!0}}return ze.prototype=le,y(ie,"constructor",{value:le,configurable:!0}),y(le,"constructor",{value:ze,configurable:!0}),ze.displayName=Ne(le,ae,"GeneratorFunction"),b.isGeneratorFunction=function(or){var ir=typeof or=="function"&&or.constructor;return!!ir&&(ir===ze||(ir.displayName||ir.name)==="GeneratorFunction")},b.mark=function(or){return c?c(or,le):(or.__proto__=le,Ne(or,ae,"GeneratorFunction")),or.prototype=a(ie),or},b.awrap=function(or){return{__await:or}},Ve(Ue.prototype),Ne(Ue.prototype,he,function(){return this}),b.AsyncIterator=Ue,b.async=function(or,ir,$e,er,nr){nr===void 0&&(nr=d);var Pt=new Ue(_e(or,ir,$e,er),nr);return b.isGeneratorFunction(ir)?Pt:Pt.next().then(function(rr){return rr.done?rr.value:Pt.next()})},Ve(ie),Ne(ie,ae,"Generator"),Ne(ie,V,function(){return this}),Ne(ie,"toString",function(){return"[object Generator]"}),b.keys=function(or){var ir=Object(or),$e=[];for(var er in ir)$e.push(er);return m($e).call($e),function nr(){for(;$e.length;){var Pt=$e.pop();if(Pt in ir)return nr.value=Pt,nr.done=!1,nr}return nr.done=!0,nr}},b.values=hr,sr.prototype={constructor:sr,reset:function(or){var ir;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,u(ir=this.tryEntries).call(ir,fr),!or)for(var $e in this)$e.charAt(0)==="t"&&k.call(this,$e)&&!isNaN(+v($e).call($e,1))&&(this[$e]=void 0)},stop:function(){this.done=!0;var or=this.tryEntries[0].completion;if(or.type==="throw")throw or.arg;return this.rval},dispatchException:function(or){if(this.done)throw or;var ir=this;function $e(Et,cr){return Pt.type="throw",Pt.arg=or,ir.next=Et,cr&&(ir.method="next",ir.arg=void 0),!!cr}for(var er=this.tryEntries.length-1;er>=0;--er){var nr=this.tryEntries[er],Pt=nr.completion;if(nr.tryLoc==="root")return $e("end");if(nr.tryLoc<=this.prev){var rr=k.call(nr,"catchLoc"),kt=k.call(nr,"finallyLoc");if(rr&&kt){if(this.prev<nr.catchLoc)return $e(nr.catchLoc,!0);if(this.prev<nr.finallyLoc)return $e(nr.finallyLoc)}else if(rr){if(this.prev<nr.catchLoc)return $e(nr.catchLoc,!0)}else{if(!kt)throw new Error("try statement without catch or finally");if(this.prev<nr.finallyLoc)return $e(nr.finallyLoc)}}}},abrupt:function(or,ir){for(var $e=this.tryEntries.length-1;$e>=0;--$e){var er=this.tryEntries[$e];if(er.tryLoc<=this.prev&&k.call(er,"finallyLoc")&&this.prev<er.finallyLoc){var nr=er;break}}nr&&(or==="break"||or==="continue")&&nr.tryLoc<=ir&&ir<=nr.finallyLoc&&(nr=null);var Pt=nr?nr.completion:{};return Pt.type=or,Pt.arg=ir,nr?(this.method="next",this.next=nr.finallyLoc,re):this.complete(Pt)},complete:function(or,ir){if(or.type==="throw")throw or.arg;return or.type==="break"||or.type==="continue"?this.next=or.arg:or.type==="return"?(this.rval=this.arg=or.arg,this.method="return",this.next="end"):or.type==="normal"&&ir&&(this.next=ir),re},finish:function(or){for(var ir=this.tryEntries.length-1;ir>=0;--ir){var $e=this.tryEntries[ir];if($e.finallyLoc===or)return this.complete($e.completion,$e.afterLoc),fr($e),re}},catch:function(or){for(var ir=this.tryEntries.length-1;ir>=0;--ir){var $e=this.tryEntries[ir];if($e.tryLoc===or){var er=$e.completion;if(er.type==="throw"){var nr=er.arg;fr($e)}return nr}}throw new Error("illegal catch attempt")},delegateYield:function(or,ir,$e){return this.delegate={iterator:hr(or),resultName:ir,nextLoc:$e},this.method==="next"&&(this.arg=void 0),re}},b}t.exports=g,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(647)},function(t,r,e){t.exports=e(648)},function(t,r,e){var n=e(649);t.exports=n},function(t,r,e){var n=e(228);t.exports=n},function(t,r,e){t.exports=e(651)},function(t,r,e){var n=e(652);e(653),e(654),e(655),e(656),t.exports=n},function(t,r,e){var n=e(230);t.exports=n},function(t,r,e){e(231)},function(t,r,e){e(245)},function(t,r,e){var n=e(1),o=e(68),s=e(100);n({target:"Promise",stat:!0,forced:!0},{try:function(a){var i=o.f(this),u=s(a);return(u.error?i.reject:i.resolve)(u.value),i.promise}})},function(t,r,e){e(246)},function(t,r,e){t.exports=e(658)},function(t,r,e){t.exports=e(659)},function(t,r,e){var n=e(660);t.exports=n},function(t,r,e){var n=e(274);t.exports=n},function(t,r,e){t.exports=e(662)},function(t,r,e){var n=e(663);t.exports=n},function(t,r,e){var n=e(249);t.exports=n},function(t,r,e){var n=e(102),o=e(103),s=e(2),a=e(7),i=e(15),u=e(69),c=e(26),d=e(3),m=e(24),v=e(75).fn,g=e(40),b=e(665),T=e(13),k=e(0),y=e(666);function A(){this.logger.log("offlineListener enter"),this.forceDisconnect(),this.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to network offline")),this.options.ondisconnect&&this.options.ondisconnect({code:"offlineListener",callFunc:"link::offlineListener",message:"offlineListener disconnect"}),this.onDisconnect("link::offlineListener","broken")}function V(){var he=this;this.logger.log("onlineListener start"),this&&this.isConnected()&&!this.connecting?(this.stopHeartbeat(),this.sendCmd("heartbeat",null,function(ae){if(ae){he.logger.info("onlineListener heartbeat detect error",ae);try{he.forceDisconnect(),he.onDisconnect("link::onHeartbeat","broken")}catch(Ne){he.logger.info("onlineListener heartbeat websocket.onclose",Ne)}}else he.logger.log("onlineListener heartbeat detect success")})):this.logger.log("onlineListener disconnected or connecting",this&&this.isConnected(),this.connecting)}v.initConnect=function(){this.socket=null,this.retryCount=0,this.connecting=!1,this.shouldReconnect=!0,this.hasNotifyDisconnected=!1,this.doLogout=!1},v.resetConnect=function(){var he=this.options;k.notundef(he.needReconnect)?(k.verifyParamType("needReconnect",he.needReconnect,"boolean","link::resetConnect"),this.needReconnect=he.needReconnect):this.needReconnect=!0,this.logger.info("link::resetConnect: needReconnect ".concat(this.needReconnect)),k.notundef(he.reconnectionAttempts)&&k.verifyParamType("reconnectionAttempts",he.reconnectionAttempts,"number","link::resetConnect"),k.notundef(he.noCacheLinkUrl)&&k.verifyParamType("noCacheLinkUrl",he.noCacheLinkUrl,"boolean","link::resetConnect"),this.reconnectionAttempts=typeof he.reconnectionAttempts=="number"?he.reconnectionAttempts:1/0,this.backoff=new b({min:T.reconnectionDelay,max:T.reconnectionDelayMax,jitter:T.reconnectionJitter})},v.reportTCPException=function(he){var ae=this;s(he).call(he,function(Ne,_e){var Ce,re=Ne.event,ue=re===void 0?{}:re,ze=Ne.message,le=ue.startTime,de=ue.code,Ie=ue.reason,ie=ue.url,Ve="";ze==="handshake_failed"?Ve="handshake_failed":ze==="connect_failed"?Ve=Ie?"connect_failed:".concat(Ie):"connect_failed":ze==="socket_error"&&(Ve=Ie?"socket.io error:".concat(Ie):"socket.io error"),ae.logger.warn(a(Ce="connect::failed ".concat(_e,", ")).call(Ce,Ve),Ne),ae.reporter.reportTraceStart("exceptions",{user_id:ae.options.account,trace_id:k.get(self,"socket.socket.sessionid"),start_time:le,action:0,exception_service:6}),ae.reporter.reportTraceUpdateV2("exceptions",{code:de,description:ze,operation_type:0,target:ie}),ae.reporter.reportTraceEnd("exceptions",1)})},v.connect=o(n.mark(function he(){var ae,Ne,_e,Ce,re;return n.wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:if(_e=this,clearTimeout(_e.connectTimer),!_e.isConnected()){ue.next=5;break}return _e.logger.warn("link::connect: already connected"),ue.abrupt("return");case 5:if(!_e.connecting){ue.next=8;break}return _e.logger.warn("link::connect: already connecting"),ue.abrupt("return");case 8:if(_e.connecting=!0,_e.hasNotifyDisconnected=!1,_e.shouldReconnect=!0,_e.socket&&_e.forceDisconnect(),_e.logger.info("link::connect: connect to new socket, autoconnect is "+_e.autoconnect),typeof _e.options.socketUrl=="string"&&(_e.logger.info("link::connect: try to options.socketUrl ",_e.options.socketUrl),_e.socketUrls=[_e.options.socketUrl]),ue.prev=14,_e.socketUrls&&_e.socketUrls.length>0){ue.next=20;break}return ue.next=18,_e.refreshSocketUrl();case 18:_e.socketUrls=y(_e.socketUrls),_e.logger.info("link::connect: refreshSocketUrl success, socketConcurrent ".concat(_e.imsocket.config.socketConcurrent),_e.socketUrls);case 20:ue.next=26;break;case 22:return ue.prev=22,ue.t0=ue.catch(14),_e.logger.warn("connect::refreshSocketUrl: catch exception,",ue.t0&&ue.t0.message),ue.abrupt("return");case 26:return _e.imsocket.resetSockets(),_e.imsocket.setUrls(i(ae=_e.socketUrls).call(ae,0)),u(Ne=_e.socketUrls).call(Ne,0,_e.imsocket.config.socketConcurrent),ue.prev=29,ue.next=32,_e.imsocket.connect();case 32:_e.socket=ue.sent,_e.onConnect(),ue.next=43;break;case 36:ue.prev=36,ue.t1=ue.catch(29),re="",ue.t1.errors&&(_e.reportTCPException(ue.t1.errors),Ce=ue.t1.errors[0]),Ce.message==="handshake_failed"?(_e.onHandshakeFailed(Ce.event.startTime,Ce.event.url),re="link::onHandshakeFailed"):Ce.message==="connect_failed"?(_e.onConnectFailed(Ce.event.reason,Ce.event.startTime,Ce.event.url),re="link::onConnectFailed"):Ce.message==="socket_error"?(_e.onSocketError(Ce.event.reason,Ce.event.startTime,Ce.event.url),re="link::onSocketError"):(re="link::otherFailed",_e.logger.warn("link::otherFailed",Ce)),this.statusProtector.emit("auth/loginLifeCycleConnectFail",new Error("".concat(re," 408"))),_e.willReconnect()&&_e.onDisconnect(re);case 43:case"end":return ue.stop()}},he,this,[[14,22],[29,36]])})),v.isConnected=function(){return!!this.socket&&!!this.socket.socket&&this.socket.socket.connected},v.disconnect=function(){var he=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){},ae=this;function Ne(_e){clearTimeout(ae.disconnectCallbackTimer),ae.msgAckBufferManager&&ae.msgAckBufferManager.clear(),ae.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to active action")),ae.statusProtector.emit("auth/loginLifeCycleLogout"),c(function(){he(_e)},0)}clearTimeout(ae.connectTimer),ae.disconnectCallbackTimer=c(function(){he.call(ae,"mark disconnected due to timeout")},1e4),ae.mixStorePolicy=null,ae.appGrayConfig=null,ae.resetReconnectStatus(),clearTimeout(ae.mixStorePolicyClock),this.onlineListener&&typeof window<"u"&&k.isFunction(window.removeEventListener)&&(window.removeEventListener("online",this.onlineListener),window.removeEventListener("offline",this.offlineListener),this.onlineListener=null,this.offlineListener=null),ae.isConnected()?(ae.logger.warn("link::disconnect: start disconnecting"),ae.logout()):ae.connecting?(ae.logger.warn("link::disconnect: abort connecting"),ae.disconnectSocket()):(ae.logger.warn("link::disconnect: already disconnected"),ae.connecting=!1,ae.shouldReconnect=!1,ae.socket=null,ae.autoconnect=!1,ae.options.ondisconnect({code:"alreadyDisconnected",callFunc:"link::disconnect",message:"manually disconnect status"})),ae.socket&&ae.socket.socket&&ae.socket.socket.transport?ae.socket.socket.transport.onDisconnectDone=function(_e){ae.logger.warn("link::disconnect: invoke [done] when socket closed",_e),Ne(_e)}:(ae.logger.warn("link::disconnect: invoke [done]"),Ne(null))},v.resetReconnectStatus=function(){this.backoff&&(this.backoff.setMin(T.reconnectionDelay),this.backoff.setMax(T.reconnectionDelayMax),this.backoff.reset()),this.retryCount=0,this.autoconnect=!0,this.logger.info("link::resetReconnectStatus: reset retryCount and backoff")},v.onConnect=function(){this.connecting=!1,this.shouldReconnect=!0,this.hasNotifyDisconnected=!1,this.logger.info("link::onConnect success"),this.statusProtector.emit("auth/loginLifeCycleConnectSucc"),this.login()},v.onDisconnect=function(){var he=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,ae=arguments.length>1?arguments[1]:void 0,Ne=this;this.logger.warn("socket::onDisconnect: "+he),Ne.connecting=!1,Ne.markAllCallbackInvalid(g.newNetworkError({callFunc:he,uploadCode:415,disconnectReason:ae})),Ne.msgAckBufferManager&&Ne.msgAckBufferManager.clear(),Ne.stopHeartbeat(),Ne.reconnect()},v.willReconnect=function(){return this.shouldReconnect&&this.needReconnect&&this.retryCount<this.reconnectionAttempts},v.reconnect=function(){var he=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.__destroyed)if(this.willReconnect()){if(this.socket&&(this.logger.info("link::reconnect: try to force disconnect"),this.forceDisconnect()),this.socketUrls.length===0&&!this.options.socketUrl&&typeof he.allFailedCB=="function")return this.logger.log("reconnect: All socket links have been polled, trigger hooks"),void he.allFailedCB();this.doReconnect()}else this.notifyDisconnect({code:"allAttemptsFailed",message:"All attempts failed"})},v.doReconnect=function(){var he,ae=this;ae.socket=null,ae.retryCount++,ae.hasLogin=!1;var Ne,_e=ae.backoff.duration();ae.logger.info(a(he="link::reconnect: will retry after ".concat(_e,"ms, retryCount ")).call(he,ae.retryCount)),Ne=ae.options.onwillreconnect({retryCount:ae.retryCount,duration:_e}),ae.statusProtector.emit("auth/loginLifeCycleWaiting"),clearTimeout(ae.connectTimer),ae.connectTimer=c(function(){+ae.options.authType==1&&Ne instanceof d?(ae.logger.info("link::reconnect: wait onwillreconnect promise"),Ne.finally(function(){return ae.connect()})):ae.connect()},_e)},v.notifyConnectError=function(he){var ae=g.newConnectError({message:he,callFunc:"link::notifyConnectError"});this.logger.error("link::notifyConnectError:",ae),this.options.onerror(ae)},v.notifyDisconnect=function(he){this.hasNotifyDisconnected?this.logger.warn("notifyDisconnect:: already notified"):(this.hasNotifyDisconnected=!0,this.disconnectSocket(),this.forceDisconnect(),(he=he||new g).retryCount=this.retryCount,he.willReconnect=this.willReconnect(),this.backoff&&this.backoff.reset(),this.retryCount=0,this.autoconnect=!1,this.logger.info("link::notifyDisconnect: ondisconnected",he),this.options.ondisconnect(he),this.onWbNotifyHangup instanceof Function&&this.onWbNotifyHangup({content:{account:this.account,channelId:null,timetag:+Date()}}))},v.disconnectSocket=function(){if(this.isConnected()||this.connecting){this.connecting=!1,this.shouldReconnect=!1;try{this.socket&&this.socket.disconnect()}catch(he){this.socket&&typeof this.socket.removeAllListenersX=="function"&&this.socket.removeAllListenersX("info"),this.logger.info("link::disconnectSocket: disconnect failed, error ",he&&he.message)}}},v.initOnlineListener=function(){this.needReconnect&&this.options&&this.options.quickReconnect?typeof window<"u"&&k.isFunction(window.addEventListener)?this.onlineListener||(this.onlineListener=m(V).call(V,this),this.offlineListener=m(A).call(A,this),this.logger.info("initOnlineListener success"),window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener)):this.logger.warn("initOnlineListener no window.addEventListener"):this.logger.warn("initOnlineListener no quickReconnect")},v.forceDisconnect=function(){var he=this.socket||{};this.socket=null;try{typeof he.removeAllListenersX=="function"&&he.removeAllListenersX("info"),typeof he.disconnect=="function"&&he.disconnect()}catch(ae){this.logger.error("forceDisconnect:: oldSocket error",ae||ae.message)}this.hasLogin=!1}},function(t,r){function e(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}t.exports=e,e.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var o=Math.random(),s=Math.floor(o*this.jitter*n);n=1&Math.floor(10*o)?n+s:n-s}return 0|Math.min(n,this.max)},e.prototype.reset=function(){this.attempts=0},e.prototype.setMin=function(n){this.ms=n},e.prototype.setMax=function(n){this.max=n},e.prototype.setJitter=function(n){this.jitter=n}},function(t,r,e){var n=e(667);t.exports=function(o){return o&&o.length?n(o):[]}},function(t,r,e){var n=e(668),o=e(671),s=e(676),a=e(677),i=e(678),u=e(288);t.exports=function(c,d,m){var v=-1,g=o,b=c.length,T=!0,k=[],y=k;if(m)T=!1,g=s;else if(b>=200){var A=d?null:i(c);if(A)return u(A);T=!1,g=a,y=new n}else y=d?[]:k;e:for(;++v<b;){var V=c[v],he=d?d(V):V;if(V=m||V!==0?V:0,T&&he==he){for(var ae=y.length;ae--;)if(y[ae]===he)continue e;d&&y.push(he),k.push(V)}else g(y,he,m)||(y!==k&&y.push(he),k.push(V))}return k}},function(t,r,e){var n=e(258),o=e(669),s=e(670);function a(i){var u=-1,c=i==null?0:i.length;for(this.__data__=new n;++u<c;)this.add(i[u])}a.prototype.add=a.prototype.push=o,a.prototype.has=s,t.exports=a},function(t,r){t.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(t,r){t.exports=function(e){return this.__data__.has(e)}},function(t,r,e){var n=e(672);t.exports=function(o,s){return!!(o!=null&&o.length)&&n(o,s,0)>-1}},function(t,r,e){var n=e(673),o=e(674),s=e(675);t.exports=function(a,i,u){return i==i?s(a,i,u):n(a,o,u)}},function(t,r){t.exports=function(e,n,o,s){for(var a=e.length,i=o+(s?1:-1);s?i--:++i<a;)if(n(e[i],i,e))return i;return-1}},function(t,r){t.exports=function(e){return e!=e}},function(t,r){t.exports=function(e,n,o){for(var s=o-1,a=e.length;++s<a;)if(e[s]===n)return s;return-1}},function(t,r){t.exports=function(e,n,o){for(var s=-1,a=e==null?0:e.length;++s<a;)if(o(n,e[s]))return!0;return!1}},function(t,r){t.exports=function(e,n){return e.has(n)}},function(t,r,e){var n=e(270),o=e(679),s=e(288),a=n&&1/s(new n([,-0]))[1]==1/0?function(i){return new n(i)}:o;t.exports=a},function(t,r){t.exports=function(){}},function(t,r,e){var n,o=e(75).fn,s=e(40),a=e(192),i=e(0),u=e(13),c=e(44),d=e(74),m=i.notundef;o.genSessionKey=(n={},function(){var v=this.name;return n[v]=n[v]||i.guid()}),o.afterLogin=i.emptyFunc,o.assembleIMLogin=function(){var v=this.options,g=v.account;this.sdkSession=this.genSessionKey();var b={appLogin:this.autoconnect?0:1,appKey:v.appKey,account:g,token:v.token,sdkVersion:u.info.sdkVersion,sdkHumanVersion:u.info.sdkHumanVersion,protocolVersion:u.info.protocolVersion,os:d.os.toString()==="[object Object]"?d.os.family:d.os.toString(),browser:d.name+" "+d.version,clientType:u.CLIENTTYPE||16,session:this.sdkSession,deviceId:c.deviceId,isReactNative:u.isRN?1:0,customTag:v.customTag||"",sdkType:0};return b.userAgent="Native/".concat(u.info.sdkHumanVersion),u.isBrowser?b.sdkType=0:u.isRN?b.sdkType=2:u.isWeixinApp&&(b.sdkType=6),v.customClientType&&(b.customClientType=+v.customClientType),v.authType&&(b.authType=+v.authType),v.loginExt&&(b.loginExt=v.loginExt),b},o.notifyLogin=function(v){this.logger.info("link::notifyLogin: on connect",v),this.options.onconnect(v)},o.logout=function(){if(this.doLogout)return this.doLogout=!1,void this.onAuthError(new s("done logout","logout",{disconnectReason:"close",uploadCode:415}),"link::logout");this.isConnected()&&this.onAuthError(new s("done disconnect","logout",{disconnectReason:"close",uploadCode:415}),"link::logout")},o.onKicked=function(v){var g=v.content,b=g.from,T=g.reason,k=g.custom,y=g.customClientType,A={reason:this.kickedReasons[T]||"unknown",message:this.kickedMessages[T]||"未知原因"};m(b)&&(A.from=a.reverseType(b)),m(k)&&(A.custom=k),+y>0&&(A.customClientType=y),this.logger.warn("link::onKicked:",A);var V=new s("被踢了","kicked",{disconnectReason:"kicked",uploadCode:415});i.merge(V,A),this.onAuthError(V,"link::onKicked"),this.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to kicked")),this.statusProtector.emit("auth/loginLifeCycleKicked",A)},o.onAuthError=function(v,g){var b=v&&v.code;if(this.logger.error("onAuthError ",g,b),/^(Error_Internet_Disconnected|Error_Timeout|Error_Connection_Socket_State_not_Match)$/.test(b))return this.forceDisconnect(),void this.onDisconnect("link::onAuthError::"+b,"broken");(v=v||s.newConnectionError({callFunc:g,uploadCode:415,disconnectReason:"close"})).callFunc=v.callFunc||g||null,this.shouldReconnect=!1,this.markAllCallbackInvalid(v),this.notifyDisconnect(v)}},function(t,r,e){var n=e(26),o=e(24),s=e(25),a=e(75).fn,i=e(13),u=e(0);a.processLink=function(c){switch(c.cmd){case"heartbeat":this.startHeartbeat();break;case"notifyDetect":s(u._get(c,"content.notifyDetectTag"))==="object"&&(c.content.notifyDetectTag.t3=new Date().getTime(),this.startDetect(c))}},a.startHeartbeat=function(){var c=this;c.stopHeartbeat(),c.heartbeatTimer=n(function(){var d;c.sendCmd("heartbeat",null,o(d=c.onHeartbeat).call(d,c))},i.heartbeatInterval)},a.startDetect=function(c){var d=c.content.notifyDetectTag;d.t4=new Date().getTime(),this.sendCmd("uploadDetect",{notifyDetectTag:d})},a.stopHeartbeat=function(){this.heartbeatTimer&&(clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null)},a.onHeartbeat=function(c){if(c){if(this.syncing)return this.logger.warn("onHeartbeat::ignore error in connecting"),void this.startHeartbeat();var d;c.callFunc="link::onHeartbeat",this.onCustomError("heartbeat error",c),this.heartbeatFail++,this.logger.warn("onHeartbeat::error ",c.code,c),c.code==="Error_Timeout"&&(this.checkNetworkAvailable()!==!1?this.heartbeatFail>1?(this.forceDisconnect(),this.onDisconnect("link::onHeartbeat","broken")):this.sendCmd("heartbeat",null,o(d=this.onHeartbeat).call(d,this)):this.startHeartbeat())}else this.heartbeatFail=0},a.checkNetworkAvailable=typeof navigator<"u"&&typeof navigator.onLine=="boolean"?function(){return navigator.onLine}:function(){},a.heartbeat=function(){}},function(t,r,e){var n=e(3),o=e(6),s=e(26),a=e(52),i=e(75).fn,u=e(284),c=e(13),d=e(44);i.processMisc=function(m){switch(m.cmd){case"getSimpleNosToken":m.error||(m.obj=m.content.nosTokens[0]);break;case"getNosToken":m.error||(m.obj=m.content.nosToken);break;case"getGrayscaleConfig":m.error||(m.obj=m.content.appGrayConfigTag);break;case"getMixStorePolicy":m.error||(m.obj=m.content.mixStorePolicyTag);break;case"getMixStoreToken":m.error||(m.obj=m.content.mixStoreTokenTag);break;case"getBackSourceToken":m.error||(m.obj=m.content.backSourceTokenTag);break;case"uploadSdkLogUrl":m.error?this.logger.error("uploadSdkLogUrl::error",m.error):this.logger.info("uploadSdkLogUrl::success",m.obj&&m.obj.url);break;case"notifyUploadLog":m.error||(c.isRN?this.uploadLocalLogRN():c.isBrowser&&this.uploadLocalLogWeb(),this.emitAPI({type:"notifyUploadLog"}));break;case"audioToText":m.error||(m.obj.text=m.content.text);break;case"processImage":m.obj.imageOps=u.reverseImageOps(m.obj.imageOps),m.error||(m.obj={url:m.content.url});break;case"getNosTokenTrans":m.error||(m.obj={nosToken:m.content.nosToken,docId:m.content.docId});break;case"getNosOriginUrl":m.error||(m.obj=m.content.nosFileUrlTag.originUrl);break;case"notifyTransLog":m.error||this.emitAPI({type:"notifyTransLog",obj:m.content.transInfo});break;case"fetchFile":case"fetchFileList":case"removeFile":m.error||(m.obj=m.content);break;case"getServerTime":m.obj=m.content&&m.content.time;break;case"getNosCdnHost":this.getNosCdnHost(m)}},i.uploadLocalLogRN=function(){if(c.isRN&&d.rnfs){var m=d.rnfs,v=this,g=m.nimIndex,b=(m.nimIndex+1)%2;m.nimPromise=m.nimPromise.then(function(){return n.all([m.exists(T(g)),m.exists(T(b))])}).then(function(k){return k&&(k[0]||k[1])?k[0]&&k[1]?m.copyFile(T(b),T(2)).then(function(){return m.readFile(T(g))}).then(function(y){return m.appendFile(T(2),y)}):k[0]?m.copyFile(T(g),T(2)):void(k[1]&&m.copyFile(T(b),T(2))):n.reject()}).then(function(){return new n(function(k){v.api.previewFile({filePath:T(2),done:function(y,A){if(n.all([m.unlink(T(2)),m.unlink(T(1)),m.unlink(T(0))]).finally(function(){k()}),y)v.logger.error("nim::uploadLocalLogRN:previewFile:error",y);else{var V=A.url;o(V).call(V,"?")>0?V+="&":V+="?",V+="download="+new Date().getTime()+"_rn.log",v.api.uploadSdkLogUrl({url:V})}}})})}).catch(function(k){m.unlink(T(2)).catch(function(){}),v.logger.error("nim::protocol::uploadLocalLogRN",k)})}function T(k){return m.DocumentDirectoryPath+"/nimlog_"+k+".log"}},i.uploadLocalLogWeb=function(){var m=this;this.options.dbLog!==!1&&this.logger._local?this.logger._local.fetchLog().then(function(v){m.api.previewFile({blob:new Blob([v.logs],{type:"text/plain"}),done:function(g,b){if(g)m.logger.error("uploadLocalLogWeb::previewFile:error",g);else{m.logger.log("uploadLocalLogWeb::previewFile:success",b);var T=b.url;T+=(o(T).call(T,"?")>0?"&":"?")+"download="+new Date().getTime()+"_web.log",m.api.uploadSdkLogUrl({url:T}),m.logger._local.deleteLogs(v.time).then(function(){m.logger.log("uploadLocalLogWeb::deleteLogs success")}).catch(function(k){return m.logger.error("uploadLocalLogWeb::deleteLogs:error ,",k)})}}})}).catch(function(v){m.logger.error("uploadLocalLogWeb::fetchLog:error",v)}):this.logger.warn("uploadLocalLogWeb::no dbLog")},i.getNosCdnHost=function(m){var v=this,g=m.error;if(g&&(g.callFunc="events::getNosCdnHost",v.onCustomError("getNosCdnHost","EVENT_GET_NOS_CDN_HOST_ERROR",g)),m.content&&m.content.nosConfigTag){var b=m.content.nosConfigTag,T="",k="";b.expire!==0&&b.cdnDomain?b.expire===-1?(T=b.cdnDomain,k=b.objectNamePrefix):(T=b.cdnDomain,k=b.objectNamePrefix,v.nosCdnHostTimer&&clearTimeout(v.nosCdnHostTimer),v.nosCdnHostTimer=s(function(){v.sendCmd("getNosCdnHost",{})},800*a(b.expire))):(T="",k=""),c.serverNosConfig.cdnDomain=T,c.serverNosConfig.objectPrefix=k,c.hasLocalStorage&&(localStorage.setItem("nim_cdn_domain",T),localStorage.setItem("nim_object_prefix",k))}}},function(t,r,e){var n=e(8),o=e(32),s=e(75).fn,a=e(0),i=e(285),u=e(105).EMSyncType;s.processAvSignal=function(d){switch(d.cmd){case"signalingCreate":case"signalingDelay":case"signalingClose":case"signalingJoin":case"signalingLeave":case"signalingInvite":case"signalingCancel":case"signalingReject":case"signalingAccept":case"signalingControl":case"signalingSyncMsgRead":case"signalingGetChannelInfo":case"signalingCallEx":break;case"signalingNotify":this.onSignalingNotify(d);break;case"signalingMutilClientSyncNotify":this.onSignalingMutilClientSyncNotify(d);break;case"signalingUnreadMessageSyncNotify":this.onSignalingUnreadMessageSyncNotify(d);break;case"signalingChannelsSyncNotify":this.onSignalingMembersSyncNotify(d);break;default:this.logger.warn("avSignal::unhandled cmd:",d.cmd)}};var c=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(d.needPush&&(d.needPush=d.needPush==="1"),d.needBadge&&(d.needBadge=d.needBadge==="1"),d.channelInValid&&(d.channelInValid=d.channelInValid==="1"),d.attach){var m=JSON.parse(d.attach);d.eventType=i.parseAvSignalType(m.type)}if(d.members){var v=JSON.parse(d.members);d.members=n(v).call(v,function(g){return i.parseAvSignalMember(g)})}return d};s.onSignalingNotify=function(d){if(d.error){var m=d.error;this.logger.error("protocal::avSignal:onSignalingNotify error",m),this.emitAPI({type:"error",error:m}),this.options.onerror(m)}else{d.raw&&d.raw.r&&d.raw.r.length&&d.content&&d.content.avSignalTag&&(d.content.avSignalTag.msgid=d.raw.r[0]);var v=d.content.avSignalTag;v=o(v)?n(v).call(v,function(g){return c(g)}):c(v),this.emitAPI({type:"signalingNotify",obj:v}),a.isFunction(this.options.onSignalingNotify)&&this.options.onSignalingNotify(v)}},s.onSignalingMutilClientSyncNotify=function(d){if(d.error){var m=d.error;this.logger.error("protocal::avSignal:onSignalingMutilClientSyncNotify error",m),this.emitAPI({type:"error",error:m}),this.options.onerror(m)}else{var v=d.content.avSignalTag;v=o(v)?n(v).call(v,function(g){return c(g)}):c(v),this.emitAPI({type:"signalingMutilClientSyncNotify",obj:v}),a.isFunction(this.options.onSignalingMutilClientSyncNotify)&&this.options.onSignalingMutilClientSyncNotify(v)}},s.onSignalingUnreadMessageSyncNotify=function(d){if(d.error){var m=d.error;this.logger.error("protocal::avSignal:onSignalingUnreadMessageSyncNotify error",m),this.emitAPI({type:"error",error:m}),this.options.onerror(m)}else{var v=d.content.avSignalTag;o(v)&&(v=n(v).call(v,function(g){return c(g)})),this.emitAPI({type:"signalingUnreadMessageSyncNotify",obj:v}),this.reporterHook.emit("reporter/syncItemComplete",u.kSyncType15_13),a.isFunction(this.options.onSignalingUnreadMessageSyncNotify)&&this.options.onSignalingUnreadMessageSyncNotify(v)}},s.onSignalingMembersSyncNotify=function(d){if(d.error){var m=d.error;this.logger.error("protocal::avSignal:onSignalingMembersSyncNotify error",m),this.emitAPI({type:"error",error:m}),this.options.onerror(m)}else{var v=d.content.avSignalTag;o(v)||(v=[v]),v=n(v).call(v,function(g){return c(g)}),this.emitAPI({type:"signalingChannelsSyncNotify",obj:v}),a.isFunction(this.options.onSignalingMembersSyncNotify)&&this.options.onSignalingMembersSyncNotify(v)}}},function(t,r,e){var n=e(10),o=e(24),s=e(0),a=e(75).fn,i=e(116),u=e(276);a.adaptersRequest=function(c){var d=this,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},v=arguments.length>2?arguments[2]:void 0,g=m.onerror||function(){},b=new Date().getTime(),T=s.get(v,"exception_service")||0;return m.onerror=function(){g.apply(void 0,arguments);var k=arguments.length<=0?void 0:arguments[0];d.reporter.reportTraceStart("exceptions",{user_id:d.account,trace_id:s.get(self,"socket.socket.sessionid"),start_time:b,action:1,exception_service:T}),d.reporter.reportTraceUpdateV2("exceptions",{code:typeof k.status=="number"?k.status:typeof k.code=="number"?k.code:0,description:k.message||"".concat(k.code),operation_type:0,target:c,context:m?n(m):"",net_connect:d.checkNetworkAvailable()}),d.reporter.reportTraceEnd("exceptions",1)},i(c,m)},a.adaptersUploadFile=function(c,d){var m,v=this;c.adaptersRequest=o(m=a.adaptersRequest).call(m,this);var g=new Date().getTime();return c.errorHook=function(b){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(b){v.reporter.reportTraceStart("exceptions",{user_id:v.account,trace_id:s.get(self,"socket.socket.sessionid"),start_time:g,action:1,exception_service:T.provider==="s3"?4:3});var k=T.url||c.url;b.bucket&&(k=n(b)),v.reporter.reportTraceUpdateV2("exceptions",{code:typeof b.status=="number"?b.status:typeof b.code=="number"?b.code:0,description:b.message||"".concat(b.code),operation_type:1,target:k,net_connect:v.checkNetworkAvailable()}),v.reporter.reportTraceEnd("exceptions",1)}},new u(c,this,d)}},function(t,r,e){e(290);var n,o,s,a=e(47),i=e(57),u=e(41),c=e(2),d=e(3),m=e(5),v=e(26),g=e(17),b=e(15),T=e(7),k=e(25);s=function(){function y(he,ae){for(var Ne=0;Ne<ae.length;Ne++){var _e=ae[Ne];_e.enumerable=_e.enumerable||!1,_e.configurable=!0,"value"in _e&&(_e.writable=!0),a(he,_e.key,_e)}}var A={isDataReportEnable:!0,maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0},V=function(){};return function(){function he(_e){(function(Ce,re){if(!(Ce instanceof re))throw new TypeError("Cannot call a class as a function")})(this,he),this.isUploadEnable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=A,this.traceMsgCache={},this.highPriorityMsgList=[],this.msgList=[],this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=i(),this.timer=null,this.setConfig(_e),this.reportConfig.isDataReportEnable&&this.reportConfig.autoStart&&this.initUploadConfig()}var ae,Ne;return ae=he,(Ne=[{key:"setConfig",value:function(_e){this.reportConfig=u({},this.reportConfig,_e),this.reportConfig.common.sdk_type||(this.reportConfig.common.sdk_type="im")}},{key:"reportImmediately",value:function(_e,Ce){var re=this;this.reportConfig.isDataReportEnable&&this.reportConfig.request(_e,u({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},Ce)).catch(function(ue){var ze,le;(le=(ze=re.reportConfig)===null||ze===void 0?void 0:ze.logger)===null||le===void 0||le.warn("Reporter immediately upload failed",ue)})}},{key:"report",value:function(_e,Ce){var re=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(re.priority||(re.priority=this.getEventPriority(_e,Ce)),this.reportConfig.isDataReportEnable&&_e){var ue=i();re.priority==="HIGH"?this.highPriorityMsgList.push({module:_e,msg:Ce,createTime:ue}):re.priority==="NORMAL"?this.msgList.push({module:_e,msg:Ce,createTime:ue}):re.priority==="LOW"&&this.lowPriorityMsgList.push({module:_e,msg:Ce,createTime:ue}),this.highPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.highPriorityMsgList.shift(),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function(_e,Ce){if(this.reportConfig.isDataReportEnable&&_e&&!this.traceMsgCache[_e]){var re=u(u({start_time:i()},Ce),{extension:[]});this.traceMsgCache[_e]=re}}},{key:"reportTraceUpdate",value:function(_e){}},{key:"reportTraceUpdateV2",value:function(_e,Ce,re){var ue,ze=this;if(this.reportConfig.isDataReportEnable&&this.traceMsgCache[_e]){var le=this.traceMsgCache[_e].extension.length,de=new Date().getTime();Ce.duration=le===0?de-this.traceMsgCache[_e].start_time:de-this.traceMsgCache[_e].extension[le-1].end_time,this.traceMsgCache[_e].extension.push(u({end_time:de},Ce)),re!=null&&re.asyncParams&&((ue=this.traceMsgCache[_e]).asyncPromiseArray||(ue.asyncPromiseArray=[]),this.traceMsgCache[_e].asyncPromiseArray.push(re.asyncParams.then(function(Ie){var ie=ze.traceMsgCache[_e].extension.length-1;u(ze.traceMsgCache[_e].extension[ie],Ie)})))}}},{key:"reportTraceEnd",value:function(_e){var Ce,re=this,ue=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reportConfig.isDataReportEnable&&this.traceMsgCache[_e])if(_e!=="nos"||ue===!1)if(typeof ue=="boolean"?this.traceMsgCache[_e].succeed=!!ue:this.traceMsgCache[_e].state=ue,this.traceMsgCache[_e].duration=i()-this.traceMsgCache[_e].start_time,c(Ce=this.traceMsgCache[_e].extension).call(Ce,function(le){delete le.end_time}),this.traceMsgCache[_e].asyncPromiseArray){var ze=this.traceMsgCache[_e];d.all(this.traceMsgCache[_e].asyncPromiseArray).finally(function(){ze===re.traceMsgCache[_e]&&(delete re.traceMsgCache[_e].asyncPromiseArray,re.report(_e,re.traceMsgCache[_e],{priority:re.getEventPriority(_e,re.traceMsgCache[_e])}),re.traceMsgCache[_e]=null)})}else this.report(_e,this.traceMsgCache[_e],{priority:this.getEventPriority(_e,this.traceMsgCache[_e])}),this.traceMsgCache[_e]=null;else this.traceMsgCache[_e]=null}},{key:"getEventPriority",value:function(_e,Ce){if(_e==="exceptions"){if(Ce.action===0||Ce.action===2||Ce.action===1&&Ce.exception_service!==0)return"HIGH"}else if(_e==="msgReceive"||_e==="nim_api_trace")return"LOW";return"NORMAL"}},{key:"reportTraceCancel",value:function(_e){this.reportConfig.isDataReportEnable&&(this.traceMsgCache[_e]=null)}},{key:"pause",value:function(){this.reportConfig.isDataReportEnable&&(this.isUploadEnable=!1)}},{key:"restore",value:function(){this.reportConfig.isDataReportEnable&&(this.isUploadEnable=!0,this.initConfigLoaded||this.initUploadConfig())}},{key:"destroy",value:function(){var _e,Ce=this;this.reportConfig.isDataReportEnable&&(c(_e=m(this.traceMsgCache)).call(_e,function(re){Ce.reportTraceEnd(re,1)}),this.timer!==null&&clearTimeout(this.timer),this.setConfig=V,this.report=V,this.reportTraceStart=V,this.reportTraceUpdate=V,this.reportTraceEnd=V,this.pause=V,this.restore=V,this.destroy=V,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.highPriorityMsgList=[],this.reportConfig={},this.isDestroyed=!0)}},{key:"initUploadConfig",value:function(){var _e,Ce,re=this;if(!this.loading){this.loading=!0;var ue=this.reportConfig.common||{};try{this.reportConfig.request(this.reportConfig.reportConfigUrl,{method:"GET",dataType:"json",params:{deviceId:ue.dev_id,sdkVer:ue.sdk_ver,platform:ue.platform,appkey:ue.app_key},timeout:this.reportConfig.timeout}).then(function(ze){var le,de;if(!re.isDestroyed){if(ze.status===200&&ze.data&&ze.data.code===200){var Ie=ze.data.data||{};re.reportConfig.maxSize=Ie.maxSize>1e3?1e3:Ie.maxSize,re.reportConfig.maxInterval=Ie.maxInterval>1e4?1e4:Ie.maxInterval,re.reportConfig.maxInterval=Ie.maxInterval<10?10:Ie.maxInterval,re.reportConfig.minInterval=Ie.minInterval<2?2:Ie.minInterval,re.reportConfig.maxDelay=Ie.maxDelay||300,re.reportConfig.maxInterval=1e3*re.reportConfig.maxInterval,re.reportConfig.minInterval=1e3*re.reportConfig.minInterval,re.reportConfig.maxDelay=1e3*re.reportConfig.maxDelay,re.isUploadEnable=!0,re.initConfigLoaded=!0,re.loading=!1,re.reportHeartBeat()}(de=(le=re.reportConfig)===null||le===void 0?void 0:le.logger)===null||de===void 0||de.log("Get reporter upload config success")}}).catch(function(ze){var le,de;re.loading=!1,(de=(le=re.reportConfig)===null||le===void 0?void 0:le.logger)===null||de===void 0||de.error("Get reporter upload config failed",ze)})}catch(ze){this.loading=!1,(Ce=(_e=this.reportConfig)===null||_e===void 0?void 0:_e.logger)===null||Ce===void 0||Ce.error("Exec reporter request failed",ze)}}}},{key:"reportHeartBeat",value:function(){var _e=this;this.isDestroyed||(this.timer=v(function(){_e.reportHeartBeat()},this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function(){if(!this.isDestroyed){var _e=this.highPriorityMsgList.length+this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;i()-this.lastReportTime>=_e&&this.upload()}}},{key:"getUploadMsg",value:function(){var _e,Ce,re,ue,ze,le,de=this,Ie={},ie=i();this.highPriorityMsgList=g(_e=this.highPriorityMsgList).call(_e,function(ir){return ie-ir.createTime<de.reportConfig.maxDelay}),this.msgList=g(Ce=this.msgList).call(Ce,function(ir){return ie-ir.createTime<de.reportConfig.maxDelay}),this.lowPriorityMsgList=g(re=this.lowPriorityMsgList).call(re,function(ir){return ie-ir.createTime<de.reportConfig.maxDelay}),this.cacheMsgList=g(ue=this.cacheMsgList).call(ue,function(ir){return ie-ir.createTime<de.reportConfig.maxDelay});var Ve=b(ze=this.highPriorityMsgList).call(ze,0,this.reportConfig.maxSize);if(this.highPriorityMsgList=b(le=this.highPriorityMsgList).call(le,Ve.length),Ve.length<this.reportConfig.maxSize){var Ue,Dt,tr=this.reportConfig.maxSize-Ve.length;Ve=T(Ve).call(Ve,b(Ue=this.msgList).call(Ue,0,tr)),this.msgList=b(Dt=this.msgList).call(Dt,tr)}if(Ve.length<this.reportConfig.maxSize){var dr,fr,sr=this.reportConfig.maxSize-Ve.length;Ve=T(Ve).call(Ve,b(dr=this.lowPriorityMsgList).call(dr,0,sr)),this.lowPriorityMsgList=b(fr=this.lowPriorityMsgList).call(fr,sr)}if(Ve.length<this.reportConfig.maxSize){var hr,Fe,or=this.reportConfig.maxSize-Ve.length;Ve=T(Ve).call(Ve,b(hr=this.cacheMsgList).call(hr,0,or)),this.cacheMsgList=b(Fe=this.cacheMsgList).call(Fe,or)}return c(Ve).call(Ve,function(ir){Ie[ir.module]?Ie[ir.module].push(ir.msg):Ie[ir.module]=[ir.msg]}),{uploadMsgArr:Ve,uploadMsg:Ie}}},{key:"upload",value:function(){var _e,Ce,re=this;if(this.isUploadEnable&&!(this.lastReportTime&&i()-this.lastReportTime<this.reportConfig.minInterval)){var ue=this.getUploadMsg(),ze=ue.uploadMsgArr,le=ue.uploadMsg;if(ze.length){this.lastReportTime=i();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:le},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch(function(de){var Ie,ie,Ve,Ue;re.cacheMsgList=b(Ie=T(ie=re.cacheMsgList).call(ie,ze)).call(Ie,0,re.reportConfig.cacheMaxSize),(Ue=(Ve=re.reportConfig)===null||Ve===void 0?void 0:Ve.logger)===null||Ue===void 0||Ue.warn("Reporter upload failed",de)})}catch(de){(Ce=(_e=this.reportConfig)===null||_e===void 0?void 0:_e.logger)===null||Ce===void 0||Ce.warn("Exec reporter request failed",de)}clearTimeout(this.timer),this.reportHeartBeat()}}}}])&&y(ae.prototype,Ne),a(ae,"prototype",{writable:!1}),he}()},k(r)==="object"&&t!==void 0?t.exports=s():(o=typeof(n=s)=="function"?n.call(r,e,r,t):n)===void 0||(t.exports=o)},function(t,r,e){t.exports=e(687)},function(t,r,e){e(688);var n=e(689);t.exports=n},function(t,r,e){e(291)},function(t,r,e){var n=e(690);t.exports=n},function(t,r,e){var n=e(691);t.exports=n},function(t,r,e){e(291),t.exports=e(14)},function(t,r,e){var n,o,s,a=e(122),i=e(121),u=e(279),c=e(280),d=e(189),m=e(693),v=(e(290),e(2)),g=e(5),b=e(7),T=e(3),k=e(26),y=e(10),A=e(277),V=e(25);function he(ae){var Ne=function(){if(typeof Reflect>"u"||!A||A.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(A(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var _e,Ce=d(ae);if(Ne){var re=d(this).constructor;_e=A(Ce,arguments,re)}else _e=Ce.apply(this,arguments);return c(this,_e)}}s=function(){function ae(_e){if(_e){var Ce,re="";return v(Ce=g(_e)).call(Ce,function(ue,ze){var le;re+=ze===0?"?":"&",re+=b(le="".concat(ue,"=")).call(le,_e[ue])}),re}return""}var Ne=function(_e){u(re,_e);var Ce=he(re);function re(ue,ze,le,de){var Ie;return i(this,re),(Ie=Ce.call(this,le)).source=ue,Ie.code=ze,Ie.desc=le,Ie.detail=de||{},Ie}return a(re)}(m(Error));return function(_e){var Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{dataType:"json",method:"GET",timeout:5e3},re=Ce.dataType==="text"?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",ue=Ce.method==="GET"?ae(Ce.params):"";return new T(function(ze,le){if(window.XMLHttpRequest){var de,Ie,ie=new XMLHttpRequest;if(ie.onreadystatechange=function(){if(ie.readyState===4)if(ie.status===200){try{Ie=JSON.parse(ie.response||"{}")}catch{Ie=ie.response}ze({status:ie.status,data:Ie})}else k(function(){var Ue;le(new Ne(1,ie.status,b(Ue="readyState: ".concat(ie.readyState,"; statusText: ")).call(Ue,ie.statusText)))},0)},ie.open(Ce.method,b(de="".concat(_e)).call(de,ue)),ie.timeout=Ce.timeout||5e3,ie.setRequestHeader("Content-Type",re),Ce.headers)for(var Ve in Ce.headers)ie.setRequestHeader(Ve,Ce.headers[Ve]);ie.ontimeout=function(Ue){le(new Ne(1,408,Ue&&Ue.message?Ue.message:"request timeout"))},ie.send(y(Ce.data))}else le(new Ne(2,10400,"request no suppout"))})}},V(r)==="object"&&t!==void 0?t.exports=s():(o=typeof(n=s)=="function"?n.call(r,e,r,t):n)===void 0||(t.exports=o)},function(t,r,e){var n=e(694),o=e(186),s=e(189),a=e(187),i=e(733),u=e(734);function c(d){var m=typeof n=="function"?new n:void 0;return t.exports=c=function(v){if(v===null||!i(v))return v;if(typeof v!="function")throw new TypeError("Super expression must either be null or a function");if(m!==void 0){if(m.has(v))return m.get(v);m.set(v,g)}function g(){return u(v,arguments,s(this).constructor)}return g.prototype=o(v.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),a(g,v)},t.exports.__esModule=!0,t.exports.default=t.exports,c(d)}t.exports=c,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(695)},function(t,r,e){t.exports=e(696)},function(t,r,e){var n=e(697);e(708),e(710),e(712),e(714),e(715),e(717),e(718),e(719),e(720),e(721),e(723),e(724),e(725),e(726),e(727),e(728),e(729),e(730),e(731),e(732),t.exports=n},function(t,r,e){var n=e(698);t.exports=n},function(t,r,e){var n=e(699);e(67),t.exports=n},function(t,r,e){e(82),e(700),e(96),e(113);var n=e(12);t.exports=n.Map},function(t,r,e){e(701)},function(t,r,e){e(702)("Map",function(n){return function(){return n(this,arguments.length?arguments[0]:void 0)}},e(706))},function(t,r,e){var n=e(1),o=e(14),s=e(292),a=e(4),i=e(53),u=e(46),c=e(167),d=e(16),m=e(28),v=e(81),g=e(38).f,b=e(84).forEach,T=e(27),k=e(97),y=k.set,A=k.getterFor;t.exports=function(V,he,ae){var Ne,_e=V.indexOf("Map")!==-1,Ce=V.indexOf("Weak")!==-1,re=_e?"set":"add",ue=o[V],ze=ue&&ue.prototype,le={};if(T&&d(ue)&&(Ce||ze.forEach&&!a(function(){new ue().entries().next()}))){var de=(Ne=he(function(ie,Ve){y(c(ie,de),{type:V,collection:new ue}),Ve!=null&&u(Ve,ie[re],{that:ie,AS_ENTRIES:_e})})).prototype,Ie=A(V);b(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(ie){var Ve=ie=="add"||ie=="set";!(ie in ze)||Ce&&ie=="clear"||i(de,ie,function(Ue,Dt){var tr=Ie(this).collection;if(!Ve&&Ce&&!m(Ue))return ie=="get"&&void 0;var dr=tr[ie](Ue===0?0:Ue,Dt);return Ve?this:dr})}),Ce||g(de,"size",{configurable:!0,get:function(){return Ie(this).collection.size}})}else Ne=ae.getConstructor(he,V,_e,re),s.enable();return v(Ne,V,!1,!0),le[V]=Ne,n({global:!0,forced:!0},le),Ce||ae.setStrong(Ne,V,_e),Ne}},function(t,r,e){var n=e(4),o=e(28),s=e(63),a=e(704),i=Object.isExtensible,u=n(function(){});t.exports=u||a?function(c){return!!o(c)&&(!a||s(c)!="ArrayBuffer")&&(!i||i(c))}:i},function(t,r,e){var n=e(4);t.exports=n(function(){if(typeof ArrayBuffer=="function"){var o=new ArrayBuffer(8);Object.isExtensible(o)&&Object.defineProperty(o,"a",{value:8})}})},function(t,r,e){var n=e(4);t.exports=!n(function(){return Object.isExtensible(Object.preventExtensions({}))})},function(t,r,e){var n=e(38).f,o=e(80),s=e(707),a=e(34),i=e(167),u=e(91),c=e(46),d=e(165),m=e(166),v=e(236),g=e(27),b=e(292).fastKey,T=e(97),k=T.set,y=T.getterFor;t.exports={getConstructor:function(A,V,he,ae){var Ne=A(function(ze,le){i(ze,_e),k(ze,{type:V,index:o(null),first:void 0,last:void 0,size:0}),g||(ze.size=0),u(le)||c(le,ze[ae],{that:ze,AS_ENTRIES:he})}),_e=Ne.prototype,Ce=y(V),re=function(ze,le,de){var Ie,ie,Ve=Ce(ze),Ue=ue(ze,le);return Ue?Ue.value=de:(Ve.last=Ue={index:ie=b(le,!0),key:le,value:de,previous:Ie=Ve.last,next:void 0,removed:!1},Ve.first||(Ve.first=Ue),Ie&&(Ie.next=Ue),g?Ve.size++:ze.size++,ie!=="F"&&(Ve.index[ie]=Ue)),ze},ue=function(ze,le){var de,Ie=Ce(ze),ie=b(le);if(ie!=="F")return Ie.index[ie];for(de=Ie.first;de;de=de.next)if(de.key==le)return de};return s(_e,{clear:function(){for(var ze=Ce(this),le=ze.index,de=ze.first;de;)de.removed=!0,de.previous&&(de.previous=de.previous.next=void 0),delete le[de.index],de=de.next;ze.first=ze.last=void 0,g?ze.size=0:this.size=0},delete:function(ze){var le=Ce(this),de=ue(this,ze);if(de){var Ie=de.next,ie=de.previous;delete le.index[de.index],de.removed=!0,ie&&(ie.next=Ie),Ie&&(Ie.previous=ie),le.first==de&&(le.first=Ie),le.last==de&&(le.last=ie),g?le.size--:this.size--}return!!de},forEach:function(ze){for(var le,de=Ce(this),Ie=a(ze,arguments.length>1?arguments[1]:void 0);le=le?le.next:de.first;)for(Ie(le.value,le.key,this);le&&le.removed;)le=le.previous},has:function(ze){return!!ue(this,ze)}}),s(_e,he?{get:function(ze){var le=ue(this,ze);return le&&le.value},set:function(ze,le){return re(this,ze===0?0:ze,le)}}:{add:function(ze){return re(this,ze=ze===0?0:ze,ze)}}),g&&n(_e,"size",{get:function(){return Ce(this).size}}),Ne},setStrong:function(A,V,he){var ae=V+" Iterator",Ne=y(V),_e=y(ae);d(A,V,function(Ce,re){k(this,{type:ae,target:Ce,state:Ne(Ce),kind:re,last:void 0})},function(){for(var Ce=_e(this),re=Ce.kind,ue=Ce.last;ue&&ue.removed;)ue=ue.previous;return Ce.target&&(Ce.last=ue=ue?ue.next:Ce.state.first)?m(re=="keys"?ue.key:re=="values"?ue.value:[ue.key,ue.value],!1):(Ce.target=void 0,m(void 0,!0))},he?"entries":"values",!he,!0),v(V)}}},function(t,r,e){var n=e(66);t.exports=function(o,s,a){for(var i in s)a&&a.unsafe&&o[i]?o[i]=s[i]:n(o,i,s[i],a);return o}},function(t,r,e){e(1)({target:"Map",stat:!0,forced:!0},{from:e(709)})},function(t,r,e){var n=e(34),o=e(19),s=e(31),a=e(168),i=e(91),u=e(46),c=[].push;t.exports=function(d){var m,v,g,b,T=arguments.length,k=T>1?arguments[1]:void 0;return a(this),(m=k!==void 0)&&s(k),i(d)?new this:(v=[],m?(g=0,b=n(k,T>2?arguments[2]:void 0),u(d,function(y){o(c,v,b(y,g++))})):u(d,c,{that:v}),new this(v))}},function(t,r,e){e(1)({target:"Map",stat:!0,forced:!0},{of:e(711)})},function(t,r,e){var n=e(98);t.exports=function(){return new this(n(arguments))}},function(t,r,e){var n=e(1),o=e(37),s=e(55).remove;n({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:function(){for(var a,i=o(this),u=!0,c=0,d=arguments.length;c<d;c++)a=s(i,arguments[c]),u=u&&a;return!!u}})},function(t,r){t.exports=function(e,n){return n==1?function(o,s){return o[e](s)}:function(o,s,a){return o[e](s,a)}}},function(t,r,e){var n=e(1),o=e(37),s=e(55),a=s.get,i=s.has,u=s.set;n({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function(c,d){var m,v,g=o(this);return i(g,c)?(m=a(g,c),"update"in d&&(m=d.update(m,c,g),u(g,c,m)),m):(v=d.insert(c,g),u(g,c,v),v)}})},function(t,r,e){var n=e(1),o=e(34),s=e(37),a=e(51);n({target:"Map",proto:!0,real:!0,forced:!0},{every:function(i){var u=s(this),c=o(i,arguments.length>1?arguments[1]:void 0);return a(u,function(d,m){if(!c(d,m,u))return!1},!0)!==!1}})},function(t,r,e){var n=e(19);t.exports=function(o,s,a){for(var i,u,c=a||o.next;!(i=n(c,o)).done;)if((u=s(i.value))!==void 0)return u}},function(t,r,e){var n=e(1),o=e(34),s=e(37),a=e(55),i=e(51),u=a.Map,c=a.set;n({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(d){var m=s(this),v=o(d,arguments.length>1?arguments[1]:void 0),g=new u;return i(m,function(b,T){v(b,T,m)&&c(g,T,b)}),g}})},function(t,r,e){var n=e(1),o=e(34),s=e(37),a=e(51);n({target:"Map",proto:!0,real:!0,forced:!0},{find:function(i){var u=s(this),c=o(i,arguments.length>1?arguments[1]:void 0),d=a(u,function(m,v){if(c(m,v,u))return{value:m}},!0);return d&&d.value}})},function(t,r,e){var n=e(1),o=e(34),s=e(37),a=e(51);n({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(i){var u=s(this),c=o(i,arguments.length>1?arguments[1]:void 0),d=a(u,function(m,v){if(c(m,v,u))return{key:v}},!0);return d&&d.key}})},function(t,r,e){var n=e(1),o=e(19),s=e(11),a=e(16),i=e(31),u=e(46),c=e(55).Map,d=s([].push);n({target:"Map",stat:!0,forced:!0},{groupBy:function(m,v){var g=new(a(this)?this:c);i(v);var b=i(g.has),T=i(g.get),k=i(g.set);return u(m,function(y){var A=v(y);o(b,g,A)?d(o(T,g,A),y):o(k,g,A,[y])}),g}})},function(t,r,e){var n=e(1),o=e(722),s=e(37),a=e(51);n({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(i){return a(s(this),function(u){if(o(u,i))return!0},!0)===!0}})},function(t,r){t.exports=function(e,n){return e===n||e!=e&&n!=n}},function(t,r,e){var n=e(1),o=e(19),s=e(46),a=e(16),i=e(31),u=e(55).Map;n({target:"Map",stat:!0,forced:!0},{keyBy:function(c,d){var m=new(a(this)?this:u);i(d);var v=i(m.set);return s(c,function(g){o(v,m,d(g),g)}),m}})},function(t,r,e){var n=e(1),o=e(37),s=e(51);n({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(a){var i=s(o(this),function(u,c){if(u===a)return{key:c}},!0);return i&&i.key}})},function(t,r,e){var n=e(1),o=e(34),s=e(37),a=e(55),i=e(51),u=a.Map,c=a.set;n({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(d){var m=s(this),v=o(d,arguments.length>1?arguments[1]:void 0),g=new u;return i(m,function(b,T){c(g,v(b,T,m),b)}),g}})},function(t,r,e){var n=e(1),o=e(34),s=e(37),a=e(55),i=e(51),u=a.Map,c=a.set;n({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(d){var m=s(this),v=o(d,arguments.length>1?arguments[1]:void 0),g=new u;return i(m,function(b,T){c(g,T,v(b,T,m))}),g}})},function(t,r,e){var n=e(1),o=e(37),s=e(46),a=e(55).set;n({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(i){for(var u=o(this),c=arguments.length,d=0;d<c;)s(arguments[d++],function(m,v){a(u,m,v)},{AS_ENTRIES:!0});return u}})},function(t,r,e){var n=e(1),o=e(31),s=e(37),a=e(51),i=TypeError;n({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(u){var c=s(this),d=arguments.length<2,m=d?void 0:arguments[1];if(o(u),a(c,function(v,g){d?(d=!1,m=v):m=u(m,v,g,c)}),d)throw i("Reduce of empty map with no initial value");return m}})},function(t,r,e){var n=e(1),o=e(34),s=e(37),a=e(51);n({target:"Map",proto:!0,real:!0,forced:!0},{some:function(i){var u=s(this),c=o(i,arguments.length>1?arguments[1]:void 0);return a(u,function(d,m){if(c(d,m,u))return!0},!0)===!0}})},function(t,r,e){var n=e(1),o=e(31),s=e(37),a=e(55),i=TypeError,u=a.get,c=a.has,d=a.set;n({target:"Map",proto:!0,real:!0,forced:!0},{update:function(m,v){var g=s(this),b=arguments.length;o(v);var T=c(g,m);if(!T&&b<3)throw i("Updating absent value");var k=T?u(g,m):o(b>2?arguments[2]:void 0)(m,g);return d(g,m,v(k,m,g)),g}})},function(t,r,e){e(1)({target:"Map",proto:!0,real:!0,forced:!0},{upsert:e(293)})},function(t,r,e){e(1)({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:e(293)})},function(t,r,e){var n=e(185);t.exports=function(o){var s;return n(s=Function.toString.call(o)).call(s,"[native code]")!==-1},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(149),o=e(294),s=e(187),a=e(738);function i(u,c,d){var m;return a()?(t.exports=i=n(m=o).call(m),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=i=function(v,g,b){var T=[null];T.push.apply(T,g);var k=new(n(Function).apply(v,T));return b&&s(k,b.prototype),k},t.exports.__esModule=!0,t.exports.default=t.exports),i.apply(null,arguments)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(736)},function(t,r,e){var n=e(737);t.exports=n},function(t,r,e){var n=e(278);t.exports=n},function(t,r,e){var n=e(294);t.exports=function(){if(typeof Reflect>"u"||!n||n.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],function(){})),!0}catch{return!1}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(17),o=e(0),s=e(190),a=o.merge({},s.idMap,{auth:{id:2,login:3,kicked:5,logout:6,multiPortLogin:7,kick:8},user:{id:3,updatePushToken:1,appBackground:2,markInBlacklist:3,getBlacklist:4,markInMutelist:5,getMutelist:6,getRelations:8,getUsers:7,updateMyInfo:10,updateDonnop:15,syncMyInfo:109,syncUpdateMyInfo:110},notify:{id:4,markRead:3,syncOfflineMsgs:4,batchMarkRead:5,syncOfflineSysMsgs:6,syncOfflineNetcallMsgs:8,syncRoamingMsgs:9,syncMsgReceipts:12,syncRobots:15,syncBroadcastMsgs:16,syncSuperTeamRoamingMsgs:17,syncOfflineSuperTeamSysMsgs:18,syncDeleteSuperTeamMsgOfflineRoaming:19,syncDeleteMsgSelf:21,syncSessionsWithMoreRoaming:22,syncStickTopSessions:23,syncSessionHistoryMsgsDelete:24,syncSessionReliableInfo:25},sync:{id:5,sync:1,syncTeamMembers:2,syncSuperTeamMembers:3},msg:{id:7,sendMsg:1,msg:2,sysMsg:3,getHistoryMsgs:6,sendCustomSysMsg:7,searchHistoryMsgs:8,deleteSessions:9,getSessions:10,syncSendMsg:101,sendMsgReceipt:11,msgReceipt:12,deleteMsg:13,msgDeleted:14,markSessionAck:16,markSessionAckBatch:25,broadcastMsg:17,clearServerHistoryMsgs:18,getServerSessions:19,getServerSession:20,updateServerSession:21,deleteServerSessions:22,deleteMsgSelf:23,deleteMsgSelfBatch:24,msgFtsInServer:26,msgFtsInServerByTiming:27,onClearServerHistoryMsgs:118,syncUpdateServerSession:121,onDeleteMsgSelf:123,onDeleteMsgSelfBatch:124},msgExtend:{id:23,getThreadMsgs:1,getMsgsByIdServer:2,addQuickComment:3,deleteQuickComment:4,onQuickComment:5,onDeleteQuickComment:6,getQuickComments:7,addCollect:8,deleteCollects:9,updateCollect:10,getCollects:11,addStickTopSession:12,deleteStickTopSession:13,updateStickTopSession:14,addMsgPin:15,updateMsgPin:16,deleteMsgPin:17,onAddMsgPin:18,onUpdateMsgPin:19,onDeleteMsgPin:20,getMsgPins:21,syncAddQuickComment:103,syncDeleteQuickComment:104,syncAddStickTopSession:112,syncDeleteStickTopSession:113,syncUpdateStickTopSession:114,syncAddMsgPin:115,syncUpdateMsgPin:116,syncDeleteMsgPin:117},team:{id:8,createTeam:1,sendTeamMsg:2,teamMsg:3,teamMsgs:4,addTeamMembers:5,removeTeamMembers:6,updateTeam:7,leaveTeam:8,getTeam:9,getTeams:10,getTeamMembers:11,dismissTeam:12,applyTeam:13,passTeamApply:14,rejectTeamApply:15,addTeamManagers:16,removeTeamManagers:17,transferTeam:18,updateInfoInTeam:19,updateNickInTeam:20,acceptTeamInvite:21,rejectTeamInvite:22,getTeamHistoryMsgs:23,searchTeamHistoryMsgs:24,updateMuteStateInTeam:25,getMyTeamMembers:26,getMutedTeamMembers:27,sendTeamMsgReceipt:28,getTeamMsgReads:29,getTeamMsgReadAccounts:30,notifyTeamMsgReads:31,muteTeamAll:32,getTeamMemberInvitorAccid:33,getTeamsById:34,syncMyTeamMembers:126,syncTeams:109,syncTeamMembers:111,syncCreateTeam:101,syncSendTeamMsg:102,syncUpdateTeamMember:119},superTeam:{id:21,sendSuperTeamMsg:2,superTeamMsg:3,addSuperTeamMembers:5,removeSuperTeamMembers:6,leaveSuperTeam:7,updateSuperTeam:8,getSuperTeam:9,getSuperTeams:12,updateInfoInSuperTeam:10,getMySuperTeamMembers:11,getSuperTeamMembers:13,getSuperTeamHistoryMsgs:14,getSuperTeamMembersByJoinTime:15,sendSuperTeamCustomSysMsg:16,deleteSuperTeamMsg:17,superTeamMsgDelete:18,superTeamCustomSysMsg:19,applySuperTeam:20,passSuperTeamApply:21,rejectSuperTeamApply:22,acceptSuperTeamInvite:23,rejectSuperTeamInvite:24,markSuperTeamSessionAck:25,addSuperTeamManagers:26,removeSuperTeamManagers:27,updateSuperTeamMute:28,updateSuperTeamMembersMute:29,updateNickInSuperTeam:30,transferSuperTeam:31,markSuperTeamSessionsAck:32,getSuperTeamMembersByAccounts:33,getMutedSuperTeamMembers:34,syncMySuperTeamMembers:111,syncSuperTeams:109,syncSuperTeamMembers:113,syncCreateSuperTeam:101,syncSendSuperTeamMsg:102,syncUpdateSuperTeamMember:110,syncDeleteSuperTeamMsg:117},friend:{id:12,friendRequest:1,syncFriendRequest:101,deleteFriend:2,syncDeleteFriend:102,updateFriend:3,syncUpdateFriend:103,getFriends:4},chatroom:{id:13,getChatroomAddress:1},filter:{id:101,sendFilterMsg:1,filterMsg:2,filterSysMsg:3,sendFilterCustomSysMsg:7},eventService:{id:14,publishEvent:1,pushEvent:2,subscribeEvent:3,unSubscribeEventsByAccounts:4,unSubscribeEventsByType:5,querySubscribeEventsByAccounts:6,querySubscribeEventsByType:7,pushEvents:9},proxyService:{id:22,httpProxy:1,onProxyMsg:2},qchat:{id:24,getQChatAddress:1}}),i=o.merge({},s.cmdConfig,{login:{sid:a.auth.id,cid:a.auth.login,params:[{type:"Property",name:"login"}]},logout:{sid:a.auth.id,cid:a.auth.logout},kick:{sid:a.auth.id,cid:a.auth.kick,params:[{type:"StrArray",name:"deviceIds"}]},updatePushToken:{sid:a.user.id,cid:a.user.updatePushToken,params:[{type:"String",name:"tokenName"},{type:"String",name:"token"},{type:"int",name:"pushkit"}]},appBackground:{sid:a.user.id,cid:a.user.appBackground,params:[{type:"bool",name:"isBackground"},{type:"Int",name:"badge"}]},markInBlacklist:{sid:a.user.id,cid:a.user.markInBlacklist,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},getBlacklist:{sid:a.user.id,cid:a.user.getBlacklist,params:[{type:"long",name:"time"}]},markInMutelist:{sid:a.user.id,cid:a.user.markInMutelist,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},getMutelist:{sid:a.user.id,cid:a.user.getMutelist,params:[{type:"long",name:"time"}]},getRelations:{sid:a.user.id,cid:a.user.getRelations,params:[{type:"long",name:"timetag"}]},getUsers:{sid:a.user.id,cid:a.user.getUsers,params:[{type:"StrArray",name:"accounts"}]},updateMyInfo:{sid:a.user.id,cid:a.user.updateMyInfo,params:[{type:"Property",name:"user"},{type:"Property",name:"antispamTag"}]},updateDonnop:{sid:a.user.id,cid:a.user.updateDonnop,params:[{type:"Property",name:"donnop"}]},markRead:{sid:a.notify.id,cid:a.notify.markRead,params:[{type:"long",name:"id"},{type:"ph",name:"ph"}]},batchMarkRead:{sid:a.notify.id,cid:a.notify.batchMarkRead,params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]},sync:{sid:a.sync.id,cid:a.sync.sync,isAwaitable:!1,params:[{type:"Property",name:"sync"}]},syncTeamMembers:{sid:a.sync.id,cid:a.sync.syncTeamMembers,params:[{type:"LongLongMap",name:"sync"}]},syncSuperTeamMembers:{sid:a.sync.id,cid:a.sync.syncSuperTeamMembers,params:[{type:"LongLongMap",name:"sync"}]},sendMsg:{sid:a.msg.id,cid:a.msg.sendMsg,params:[{type:"Property",name:"msg"}]},getHistoryMsgs:{sid:a.msg.id,cid:a.msg.getHistoryMsgs,params:[{type:"String",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},sendCustomSysMsg:{sid:a.msg.id,cid:a.msg.sendCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},searchHistoryMsgs:{sid:a.msg.id,cid:a.msg.searchHistoryMsgs,params:[{type:"String",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"String",name:"keyword"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},getSessions:{sid:a.msg.id,cid:a.msg.getSessions,params:[{type:"long",name:"time"}]},deleteSessions:{sid:a.msg.id,cid:a.msg.deleteSessions,params:[{type:"StrArray",name:"sessions"}]},sendMsgReceipt:{sid:a.msg.id,cid:a.msg.sendMsgReceipt,params:[{type:"Property",name:"msgReceipt"}]},deleteMsg:{sid:a.msg.id,cid:a.msg.deleteMsg,params:[{type:"Property",name:"sysMsg"}]},markSessionAck:{sid:a.msg.id,cid:a.msg.markSessionAck,params:[{type:"byte",name:"scene"},{type:"String",name:"to"},{type:"long",name:"timetag"}]},markSessionAckBatch:{sid:a.msg.id,cid:a.msg.markSessionAckBatch,params:[{type:"PropertyArray",name:"sessionAckTags",entity:"sessionAckTag"}]},clearServerHistoryMsgs:{sid:a.msg.id,cid:a.msg.clearServerHistoryMsgs,params:[{type:"Property",name:"clearMsgsParams"}]},clearServerHistoryMsgsWithSync:{sid:a.msg.id,cid:a.msg.clearServerHistoryMsgs,params:[{type:"Property",name:"clearMsgsParamsWithSync"}]},msgFtsInServer:{sid:a.msg.id,cid:a.msg.msgFtsInServer,params:[{type:"Property",name:"msgFullSearchRequestTag"}]},msgFtsInServerByTiming:{sid:a.msg.id,cid:a.msg.msgFtsInServerByTiming,params:[{type:"Property",name:"msgTimingFullSearchRequestTag"}]},onClearServerHistoryMsgs:{sid:a.msg.id,cid:a.msg.clearServerHistoryMsgs},getServerSessions:{sid:a.msg.id,cid:a.msg.getServerSessions,params:[{type:"Property",name:"sessionReqTag"}]},getServerSession:{sid:a.msg.id,cid:a.msg.getServerSession,params:[{type:"Property",name:"session"}]},updateServerSession:{sid:a.msg.id,cid:a.msg.updateServerSession,params:[{type:"Property",name:"session"}]},deleteServerSessions:{sid:a.msg.id,cid:a.msg.deleteServerSessions,params:[{type:"PropertyArray",name:"sessions",entity:"session"}]},deleteMsgSelf:{sid:a.msg.id,cid:a.msg.deleteMsgSelf,params:[{type:"Property",name:"deleteMsgSelfTag"}]},deleteMsgSelfBatch:{sid:a.msg.id,cid:a.msg.deleteMsgSelfBatch,params:[{type:"PropertyArray",name:"deleteMsgSelfTags",entity:"deleteMsgSelfTag"}]},onDeleteMsgSelf:{sid:a.msg.id,cid:a.msg.onDeleteMsgSelf},onDeleteMsgSelfBatch:{sid:a.msg.id,cid:a.msg.onDeleteMsgSelfBatch},sendSuperTeamMsg:{sid:a.superTeam.id,cid:a.superTeam.sendSuperTeamMsg,params:[{type:"Property",name:"msg"}]},addSuperTeamMembers:{sid:a.superTeam.id,cid:a.superTeam.addSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}]},removeSuperTeamMembers:{sid:a.superTeam.id,cid:a.superTeam.removeSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},leaveSuperTeam:{sid:a.superTeam.id,cid:a.superTeam.leaveSuperTeam,params:[{type:"long",name:"teamId"}]},updateSuperTeam:{sid:a.superTeam.id,cid:a.superTeam.updateSuperTeam,params:[{type:"Property",name:"team"},{type:"Property",name:"antispamTag"}]},getSuperTeam:{sid:a.superTeam.id,cid:a.superTeam.getSuperTeam,params:[{type:"long",name:"teamId"}]},getSuperTeams:{sid:a.superTeam.id,cid:a.superTeam.getSuperTeams,params:[{type:"long",name:"timetag"}]},getSuperTeamMembers:{sid:a.superTeam.id,cid:a.superTeam.getSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"long",name:"timetag"}]},updateInfoInSuperTeam:{sid:a.superTeam.id,cid:a.superTeam.updateInfoInSuperTeam,params:[{type:"Property",name:"superTeamMember"}]},getSuperTeamHistoryMsgs:{sid:a.superTeam.id,cid:a.superTeam.getSuperTeamHistoryMsgs,params:[{type:"long",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},applySuperTeam:{sid:a.superTeam.id,cid:a.superTeam.applySuperTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"ps"}]},passSuperTeamApply:{sid:a.superTeam.id,cid:a.superTeam.passSuperTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamApply:{sid:a.superTeam.id,cid:a.superTeam.rejectSuperTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},acceptSuperTeamInvite:{sid:a.superTeam.id,cid:a.superTeam.acceptSuperTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamInvite:{sid:a.superTeam.id,cid:a.superTeam.rejectSuperTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},markSuperTeamSessionAck:{sid:a.superTeam.id,cid:a.superTeam.markSuperTeamSessionAck,params:[{type:"long",name:"to"},{type:"long",name:"timetag"}]},addSuperTeamManagers:{sid:a.superTeam.id,cid:a.superTeam.addSuperTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeSuperTeamManagers:{sid:a.superTeam.id,cid:a.superTeam.removeSuperTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateSuperTeamMute:{sid:a.superTeam.id,cid:a.superTeam.updateSuperTeamMute,params:[{type:"long",name:"teamId"},{type:"int",name:"mute"}]},updateSuperTeamMembersMute:{sid:a.superTeam.id,cid:a.superTeam.updateSuperTeamMembersMute,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"int",name:"mute"}]},updateNickInSuperTeam:{sid:a.superTeam.id,cid:a.superTeam.updateNickInSuperTeam,params:[{type:"Property",name:"superTeamMember"}]},transferSuperTeam:{sid:a.superTeam.id,cid:a.superTeam.transferSuperTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},markSuperTeamSessionsAck:{sid:a.superTeam.id,cid:a.superTeam.markSuperTeamSessionsAck,params:[{type:"PropertyArray",name:"sessionAckTags",entity:"sessionAckTag"}]},getSuperTeamMembersByJoinTime:{sid:a.superTeam.id,cid:a.superTeam.getSuperTeamMembersByJoinTime,params:[{type:"long",name:"teamId"},{type:"long",name:"joinTime"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},getSuperTeamMembersByAccounts:{sid:a.superTeam.id,cid:a.superTeam.getSuperTeamMembersByAccounts,params:[{type:"StrArray",name:"memberIds"}]},getMutedSuperTeamMembers:{sid:a.superTeam.id,cid:a.superTeam.getMutedSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"long",name:"joinTime"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},sendSuperTeamCustomSysMsg:{sid:a.superTeam.id,cid:a.superTeam.sendSuperTeamCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},deleteSuperTeamMsg:{sid:a.superTeam.id,cid:a.superTeam.deleteSuperTeamMsg,params:[{type:"Property",name:"sysMsg"}]},getMySuperTeamMembers:{sid:a.superTeam.id,cid:a.superTeam.getMySuperTeamMembers,params:[{type:"LongArray",name:"teamIds"}]},createTeam:{sid:a.team.id,cid:a.team.createTeam,params:[{type:"Property",name:"team"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"},{type:"Property",name:"antispamTag"}]},sendTeamMsg:{sid:a.team.id,cid:a.team.sendTeamMsg,params:[{type:"Property",name:"msg"}]},addTeamMembers:{sid:a.team.id,cid:a.team.addTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"},{type:"String",name:"attach"}]},removeTeamMembers:{sid:a.team.id,cid:a.team.removeTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateTeam:{sid:a.team.id,cid:a.team.updateTeam,params:[{type:"Property",name:"team"},{type:"Property",name:"antispamTag"}]},leaveTeam:{sid:a.team.id,cid:a.team.leaveTeam,params:[{type:"long",name:"teamId"}]},getTeam:{sid:a.team.id,cid:a.team.getTeam,params:[{type:"long",name:"teamId"}]},getTeams:{sid:a.team.id,cid:a.team.getTeams,params:[{type:"long",name:"timetag"}]},getTeamsById:{sid:a.team.id,cid:a.team.getTeamsById,params:[{type:"longArray",name:"teamIds"}]},getTeamMembers:{sid:a.team.id,cid:a.team.getTeamMembers,params:[{type:"long",name:"teamId"},{type:"long",name:"timetag"}]},dismissTeam:{sid:a.team.id,cid:a.team.dismissTeam,params:[{type:"long",name:"teamId"}]},applyTeam:{sid:a.team.id,cid:a.team.applyTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"ps"}]},passTeamApply:{sid:a.team.id,cid:a.team.passTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamApply:{sid:a.team.id,cid:a.team.rejectTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},addTeamManagers:{sid:a.team.id,cid:a.team.addTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeTeamManagers:{sid:a.team.id,cid:a.team.removeTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},transferTeam:{sid:a.team.id,cid:a.team.transferTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},updateInfoInTeam:{sid:a.team.id,cid:a.team.updateInfoInTeam,params:[{type:"Property",name:"teamMember"}]},updateNickInTeam:{sid:a.team.id,cid:a.team.updateNickInTeam,params:[{type:"Property",name:"teamMember"}]},acceptTeamInvite:{sid:a.team.id,cid:a.team.acceptTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamInvite:{sid:a.team.id,cid:a.team.rejectTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},getTeamHistoryMsgs:{sid:a.team.id,cid:a.team.getTeamHistoryMsgs,params:[{type:"long",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},searchTeamHistoryMsgs:{sid:a.team.id,cid:a.team.searchTeamHistoryMsgs,params:[{type:"long",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"String",name:"keyword"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},updateMuteStateInTeam:{sid:a.team.id,cid:a.team.updateMuteStateInTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"account"},{type:"int",name:"mute"}]},getMyTeamMembers:{sid:a.team.id,cid:a.team.getMyTeamMembers,params:[{type:"LongArray",name:"teamIds"}]},getMutedTeamMembers:{sid:a.team.id,cid:a.team.getMutedTeamMembers,params:[{type:"long",name:"teamId"}]},sendTeamMsgReceipt:{sid:a.team.id,cid:a.team.sendTeamMsgReceipt,params:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},getTeamMsgReads:{sid:a.team.id,cid:a.team.getTeamMsgReads,params:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},getTeamMsgReadAccounts:{sid:a.team.id,cid:a.team.getTeamMsgReadAccounts,params:[{type:"Property",name:"teamMsgReceipt"}]},muteTeamAll:{sid:a.team.id,cid:a.team.muteTeamAll,params:[{type:"long",name:"teamId"},{type:"int",name:"mute"}]},getTeamMemberInvitorAccid:{sid:a.team.id,cid:a.team.getTeamMemberInvitorAccid,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},friendRequest:{sid:a.friend.id,cid:a.friend.friendRequest,params:[{type:"String",name:"account"},{type:"byte",name:"type"},{type:"String",name:"ps"}]},deleteFriend:{sid:a.friend.id,cid:a.friend.deleteFriend,params:[{type:"String",name:"account"},{type:"Property",name:"delFriendParams"}]},updateFriend:{sid:a.friend.id,cid:a.friend.updateFriend,params:[{type:"Property",name:"friend"}]},getFriends:{sid:a.friend.id,cid:a.friend.getFriends,params:[{type:"long",name:"timetag"}]},getChatroomAddress:{sid:a.chatroom.id,cid:a.chatroom.getChatroomAddress,params:[{type:"long",name:"chatroomId"},{type:"bool",name:"isWeixinApp"},{type:"number",name:"type"}]},sendFilterMsg:{sid:n(a).id,cid:n(a).sendFilterMsg,params:[{type:"Property",name:"msg"}]},sendFilterCustomSysMsg:{sid:n(a).id,cid:n(a).sendFilterCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},publishEvent:{sid:a.eventService.id,cid:a.eventService.publishEvent,params:[{type:"Property",name:"msgEvent"}]},pushEvent:{sid:a.eventService.id,cid:a.eventService.pushEvent},subscribeEvent:{sid:a.eventService.id,cid:a.eventService.subscribeEvent,params:[{type:"Property",name:"msgEventSubscribe"},{type:"StrArray",name:"accounts"}]},unSubscribeEventsByAccounts:{sid:a.eventService.id,cid:a.eventService.unSubscribeEventsByAccounts,params:[{type:"Property",name:"msgEventSubscribe"},{type:"StrArray",name:"accounts"}]},unSubscribeEventsByType:{sid:a.eventService.id,cid:a.eventService.unSubscribeEventsByType,params:[{type:"Property",name:"msgEventSubscribe"}]},querySubscribeEventsByAccounts:{sid:a.eventService.id,cid:a.eventService.querySubscribeEventsByAccounts,params:[{type:"Property",name:"msgEventSubscribe"},{type:"StrArray",name:"accounts"}]},querySubscribeEventsByType:{sid:a.eventService.id,cid:a.eventService.querySubscribeEventsByType,params:[{type:"Property",name:"msgEventSubscribe"}]},pushEvents:{sid:a.eventService.id,cid:a.eventService.pushEvents},getThreadMsgs:{sid:a.msgExtend.id,cid:a.msgExtend.getThreadMsgs,params:[{type:"Property",name:"msg"},{type:"Property",name:"threadMsgReq"}]},getMsgsByIdServer:{sid:a.msgExtend.id,cid:a.msgExtend.getMsgsByIdServer,params:[{type:"PropertyArray",name:"reqMsgs",entity:"msg"}]},addQuickComment:{sid:a.msgExtend.id,cid:a.msgExtend.addQuickComment,params:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},deleteQuickComment:{sid:a.msgExtend.id,cid:a.msgExtend.deleteQuickComment,params:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},getQuickComments:{sid:a.msgExtend.id,cid:a.msgExtend.getQuickComments,params:[{type:"PropertyArray",name:"commentReq",entity:"commentReq"}]},addCollect:{sid:a.msgExtend.id,cid:a.msgExtend.addCollect,params:[{type:"Property",name:"collect"}]},deleteCollects:{sid:a.msgExtend.id,cid:a.msgExtend.deleteCollects,params:[{type:"PropertyArray",name:"collectList",entity:"collect"}]},updateCollect:{sid:a.msgExtend.id,cid:a.msgExtend.updateCollect,params:[{type:"Property",name:"collect"}]},getCollects:{sid:a.msgExtend.id,cid:a.msgExtend.getCollects,params:[{type:"Property",name:"collectQuery"}]},addStickTopSession:{sid:a.msgExtend.id,cid:a.msgExtend.addStickTopSession,params:[{type:"Property",name:"stickTopSession"}]},updateStickTopSession:{sid:a.msgExtend.id,cid:a.msgExtend.updateStickTopSession,params:[{type:"Property",name:"stickTopSession"}]},deleteStickTopSession:{sid:a.msgExtend.id,cid:a.msgExtend.deleteStickTopSession,params:[{type:"Property",name:"stickTopSession"}]},addMsgPin:{sid:a.msgExtend.id,cid:a.msgExtend.addMsgPin,params:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"}]},updateMsgPin:{sid:a.msgExtend.id,cid:a.msgExtend.updateMsgPin,params:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"}]},deleteMsgPin:{sid:a.msgExtend.id,cid:a.msgExtend.deleteMsgPin,params:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"}]},getMsgPins:{sid:a.msgExtend.id,cid:a.msgExtend.getMsgPins,params:[{type:"Property",name:"msgPinReq"}]},httpProxy:{sid:a.proxyService.id,cid:a.proxyService.httpProxy,params:[{type:"Property",name:"proxyTag"}]},getQChatAddress:{sid:a.qchat.id,cid:a.qchat.getQChatAddress,params:[{type:"Property",name:"getQChatAddressTag"}]}}),u=o.merge({},s.packetConfig,{"2_3":{service:"auth",cmd:"login",response:[{type:"Property",name:"loginRes"},{type:"PropertyArray",name:"loginPorts",entity:"loginPort"},{type:"Property",name:"aosPushInfo"}]},"2_5":{service:"auth",cmd:"kicked",response:[{type:"Number",name:"from"},{type:"Number",name:"reason"},{type:"String",name:"custom"},{type:"Number",name:"customClientType"}]},"2_6":{service:"auth",cmd:"logout"},"2_7":{service:"auth",cmd:"multiPortLogin",response:[{type:"Number",name:"state"},{type:"PropertyArray",name:"loginPorts",entity:"loginPort"}]},"2_8":{service:"auth",cmd:"kick",response:[{type:"StrArray",name:"deviceIds"}]},"3_1":{service:"user",cmd:"updatePushToken"},"3_2":{service:"user",cmd:"appBackground"},"3_3":{service:"user",cmd:"markInBlacklist"},"3_103":{service:"user",cmd:"syncMarkInBlacklist",response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},"3_4":{service:"user",cmd:"getBlacklist",response:[{type:"StrArray",name:"blacklist"}]},"3_5":{service:"user",cmd:"markInMutelist"},"3_105":{service:"user",cmd:"syncMarkInMutelist",response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},"3_6":{service:"user",cmd:"getMutelist",response:[{type:"StrArray",name:"mutelist"}]},"3_8":{service:"user",cmd:"getRelations",response:[{type:"PropertyArray",name:"specialRelations",entity:"specialRelation"},{type:"Number",name:"timetag"}]},"3_7":{service:"user",cmd:"getUsers",response:[{type:"PropertyArray",name:"users",entity:"user"}]},"3_10":{service:"user",cmd:"updateMyInfo",response:[{type:"Number",name:"timetag"}]},"3_15":{service:"user",cmd:"updateDonnop",response:[{type:"Number",name:"timetag"}]},"3_115":{service:"user",cmd:"syncUpdateDonnop",response:[{type:"Property",name:"donnop"},{type:"Number",name:"timetag"}]},"3_109":{service:"user",cmd:"syncMyInfo",response:[{type:"Property",name:"user"},{type:"Number",name:"timetag"}]},"3_110":{service:"user",cmd:"syncUpdateMyInfo",response:[{type:"Property",name:"user"}]},"4_1":{service:"notify"},"4_2":{service:"notify"},"4_3":{service:"notify",cmd:"markRead"},"4_4":{service:"notify",cmd:"syncOfflineMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_5":{service:"notify",cmd:"batchMarkRead"},"4_6":{service:"notify",cmd:"syncOfflineSysMsgs",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"4_8":{service:"notify",cmd:"syncOfflineNetcallMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_9":{service:"notify",cmd:"syncRoamingMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_12":{service:"notify",cmd:"syncMsgReceipts",response:[{type:"PropertyArray",name:"msgReceipts",entity:"msgReceipt"},{type:"Number",name:"timetag"}]},"4_13":{service:"notify",cmd:"syncDonnop",response:[{type:"Property",name:"donnop"},{type:"Number",name:"timetag"}]},"4_14":{service:"notify",cmd:"syncSessionAck",response:[{type:"StrLongMap",name:"p2p"},{type:"LongLongMap",name:"team"},{type:"Number",name:"timetag"}]},"4_15":{service:"notify",cmd:"syncRobots",response:[{type:"PropertyArray",name:"robots",entity:"robot"}]},"4_16":{service:"notify",cmd:"syncBroadcastMsgs",response:[{type:"PropertyArray",name:"broadcastMsgs",entity:"broadcastMsg"}]},"4_17":{service:"notify",cmd:"syncSuperTeamRoamingMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_18":{service:"notify",cmd:"syncOfflineSuperTeamSysMsgs",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"4_19":{service:"notify",cmd:"syncDeleteSuperTeamMsgOfflineRoaming",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"},{type:"Number",name:"timetag"},{type:"Number",name:"type"}]},"4_20":{service:"notify",cmd:"syncSuperTeamSessionAck",response:[{type:"LongLongMap",name:"superTeam"},{type:"Number",name:"timetag"}]},"4_21":{service:"notify",cmd:"syncDeleteMsgSelf",response:[{type:"PropertyArray",name:"deletedMsgs",entity:"deleteMsgSelfTag"}]},"4_22":{service:"notify",cmd:"syncSessionsWithMoreRoaming",response:[{type:"PropertyArray",name:"sessions",entity:"msg"}]},"4_23":{service:"notify",cmd:"syncStickTopSessions",response:[{type:"Number",name:"timetag"},{type:"boolean",name:"modify"},{type:"PropertyArray",name:"sessions",entity:"stickTopSession"}]},"4_24":{service:"notify",cmd:"syncSessionHistoryMsgsDelete",response:[{type:"PropertyArray",name:"sessionHistoryMsgsDeleteTags",entity:"clearMsgsParamsWithSync"}]},"4_25":{service:"notify",cmd:"syncSessionReliableInfo",response:[{type:"Property",name:"context",entity:"sessionReliableSyncContextTag"},{type:"PropertyArray",name:"datas",entity:"sessionReliableSyncTag"}]},"4_100":{service:"notify",cmd:"syncOfflineFilterMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_101":{service:"notify",cmd:"syncOfflineFilterSysMsgs",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"5_1":{service:"sync",cmd:"syncDone",response:[{type:"Number",name:"timetag"}]},"5_2":{service:"sync",cmd:"syncTeamMembersDone",response:[{type:"Number",name:"timetag"}]},"5_3":{service:"sync",cmd:"syncSuperTeamMembersDone",response:[{type:"Number",name:"timetag"}]},"7_1":{service:"msg",cmd:"sendMsg",response:[{type:"Property",name:"msg"}],trivialErrorCodes:[7101]},"7_2":{service:"msg",cmd:"msg",response:[{type:"Property",name:"msg"}]},"7_3":{service:"msg",cmd:"sysMsg",response:[{type:"Property",name:"sysMsg"}]},"7_6":{service:"msg",cmd:"getHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_7":{service:"msg",cmd:"sendCustomSysMsg",trivialErrorCodes:[7101]},"7_8":{service:"msg",cmd:"searchHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_9":{service:"msg",cmd:"deleteSessions"},"7_10":{service:"msg",cmd:"getSessions",response:[{type:"StrArray",name:"sessions"}]},"7_101":{service:"msg",cmd:"syncSendMsg",response:[{type:"Property",name:"msg"}]},"7_11":{service:"msg",cmd:"sendMsgReceipt",response:[{type:"Property",name:"msgReceipt"}]},"7_12":{service:"msg",cmd:"msgReceipt",response:[{type:"Property",name:"msgReceipt"}]},"7_13":{service:"msg",cmd:"onDeleteMsg"},"7_14":{service:"msg",cmd:"onMsgDeleted",response:[{type:"Property",name:"sysMsg"}]},"7_15":{service:"msg",cmd:"onDeleteMsgOfflineRoaming",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"},{type:"Number",name:"timetag"},{type:"Number",name:"type"}]},"7_16":{service:"msg",cmd:"onMarkSessionAck"},"7_17":{service:"msg",cmd:"broadcastMsg",response:[{type:"Property",name:"broadcastMsg"}]},"7_18":{service:"msg",cmd:"clearServerHistoryMsgs",response:[{type:"Long",name:"timetag"}]},"7_19":{service:"session",cmd:"getServerSessions",response:[{type:"Property",name:"sessionReqTag"},{type:"PropertyArray",name:"sessionList",entity:"session"}]},"7_20":{service:"session",cmd:"getServerSession",response:[{type:"Property",name:"session"}]},"7_21":{service:"session",cmd:"updateServerSession"},"7_22":{service:"session",cmd:"deleteServerSessions"},"7_23":{service:"msg",cmd:"deleteMsgSelf",response:[{type:"Long",name:"timetag"}]},"7_24":{service:"msg",cmd:"deleteMsgSelfBatch",response:[{type:"Long",name:"timetag"}]},"7_25":{service:"msg",cmd:"onMarkSessionAckBatch"},"7_26":{service:"msg",cmd:"msgFtsInServer",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_27":{service:"msg",cmd:"msgFtsInServerByTiming",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_118":{service:"msg",cmd:"onClearServerHistoryMsgs",response:[{type:"Property",name:"sessionHistoryMsgsDeleteTag",entity:"clearMsgsParamsWithSync"}]},"7_123":{service:"msg",cmd:"onDeleteMsgSelf",response:[{type:"Property",name:"deleteMsgSelfTag"}]},"7_124":{service:"msg",cmd:"onDeleteMsgSelfBatch",response:[{type:"PropertyArray",name:"deleteMsgSelfTags",entity:"deleteMsgSelfTag"}]},"7_116":{service:"msg",cmd:"syncMarkSessionAck",response:[{type:"Number",name:"scene"},{type:"String",name:"to"},{type:"Number",name:"timetag"}]},"7_121":{service:"msg",cmd:"syncUpdateServerSession",response:[{type:"Property",name:"session"}]},"23_1":{service:"msgExtend",cmd:"getThreadMsgs",response:[{type:"Property",name:"threadMsg",entity:"msg"},{type:"Property",name:"threadMsgsMeta"},{type:"PropertyArray",name:"msgs",entity:"msg"}]},"23_2":{service:"msgExtend",cmd:"getMsgsByIdServer",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"23_3":{service:"msgExtend",cmd:"addQuickComment",response:[{type:"Number",name:"timetag"}]},"23_4":{service:"msgExtend",cmd:"deleteQuickComment",response:[{type:"Number",name:"timetag"}]},"23_5":{service:"msgExtend",cmd:"onQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_6":{service:"msgExtend",cmd:"onDeleteQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_7":{service:"msgExtend",cmd:"getQuickComments",response:[{type:"PropertyArray",name:"commentRes",entity:"commentRes"}]},"23_8":{service:"msgExtend",cmd:"addCollect",response:[{type:"Property",name:"collect"}]},"23_9":{service:"msgExtend",cmd:"deleteCollects",response:[{type:"Number",name:"deleteNum"}]},"23_10":{service:"msgExtend",cmd:"updateCollect",response:[{type:"Property",name:"collect"}]},"23_11":{service:"msgExtend",cmd:"getCollects",response:[{type:"Number",name:"total"},{type:"PropertyArray",name:"collectList",entity:"collect"}]},"23_12":{service:"msgExtend",cmd:"addStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_13":{service:"msgExtend",cmd:"deleteStickTopSession",response:[{type:"Number",name:"timetag"}]},"23_14":{service:"msgExtend",cmd:"updateStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_15":{service:"msgExtend",cmd:"addMsgPin",response:[{type:"Number",name:"timetag"}]},"23_16":{service:"msgExtend",cmd:"updateMsgPin",response:[{type:"Number",name:"timetag"}]},"23_17":{service:"msgExtend",cmd:"deleteMsgPin",response:[{type:"Number",name:"timetag"}]},"23_18":{service:"msgExtend",cmd:"onAddMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_19":{service:"msgExtend",cmd:"onUpdateMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_20":{service:"msgExtend",cmd:"onDeleteMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_21":{service:"msgExtend",cmd:"getMsgPins",response:[{type:"Number",name:"timetag"},{type:"Boolean",name:"modify"},{type:"PropertyArray",name:"pins",entity:"msgPinRes"}]},"23_103":{service:"msgExtend",cmd:"syncAddQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_104":{service:"msgExtend",cmd:"syncDeleteQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_112":{service:"msgExtend",cmd:"syncAddStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_113":{service:"msgExtend",cmd:"syncDeleteStickTopSession",response:[{type:"Number",name:"timetag"},{type:"Property",name:"stickTopSession"}]},"23_114":{service:"msgExtend",cmd:"syncUpdateStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_115":{service:"msgExtend",cmd:"syncAddMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_116":{service:"msgExtend",cmd:"syncUpdateMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_117":{service:"msgExtend",cmd:"syncDeleteMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"21_2":{service:"superTeam",cmd:"sendSuperTeamMsg",response:[{type:"Property",name:"msg"}]},"21_3":{service:"superTeam",cmd:"superTeamMsg",response:[{type:"Property",name:"msg"}]},"21_5":{service:"superTeam",cmd:"addSuperTeamMembers",response:[{type:"StrArray",name:"abortedAccidList"},{type:"long",name:"timetag"}]},"21_6":{service:"superTeam",cmd:"removeSuperTeamMembers"},"21_7":{service:"superTeam",cmd:"leaveSuperTeam"},"21_8":{service:"superTeam",cmd:"updateSuperTeam",response:[{type:"long",name:"timetag"}]},"21_9":{service:"superTeam",cmd:"getSuperTeam",response:[{type:"Property",name:"team"}]},"21_12":{service:"superTeam",cmd:"getSuperTeams",response:[{type:"PropertyArray",name:"teams",entity:"superTeam"},{type:"bool",name:"isAll"},{type:"long",name:"timetag"}]},"21_10":{service:"superTeam",cmd:"updateInfoInSuperTeam"},"21_13":{service:"superTeam",cmd:"getSuperTeamMembers",response:[{type:"long",name:"timetag"}]},"21_11":{service:"superTeam",cmd:"getMySuperTeamMembers",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_14":{service:"superTeam",cmd:"getSuperTeamHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"21_15":{service:"superTeam",cmd:"getSuperTeamMembersByJoinTime",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_16":{service:"superTeam",cmd:"sendSuperTeamCustomSysMsg",trivialErrorCodes:[7101]},"21_17":{service:"superTeam",cmd:"onDeleteSuperTeamMsg"},"21_18":{service:"superTeam",cmd:"onSuperTeamMsgDelete",response:[{type:"Property",name:"sysMsg"}]},"21_19":{service:"superTeam",cmd:"superTeamCustomSysMsg",response:[{type:"Property",name:"sysMsg"}]},"21_20":{service:"superTeam",cmd:"applySuperTeam",response:[{type:"Property",name:"team"}]},"21_21":{service:"superTeam",cmd:"passSuperTeamApply"},"21_22":{service:"superTeam",cmd:"rejectSuperTeamApply"},"21_23":{service:"superTeam",cmd:"acceptSuperTeamInvite",response:[{type:"Property",name:"team"}]},"21_24":{service:"superTeam",cmd:"rejectSuperTeamInvite"},"21_25":{service:"superTeam",cmd:"onMarkSuperTeamSessionAck"},"21_26":{service:"superTeam",cmd:"addSuperTeamManagers"},"21_27":{service:"superTeam",cmd:"removeSuperTeamManagers"},"21_28":{service:"superTeam",cmd:"updateSuperTeamMute"},"21_29":{service:"superTeam",cmd:"updateSuperTeamMembersMute",response:[{type:"long",name:"timetag"}]},"21_30":{service:"superTeam",cmd:"updateNickInSuperTeam"},"21_31":{service:"superTeam",cmd:"transferSuperTeam"},"21_32":{service:"superTeam",cmd:"onMarkSuperTeamSessionsAck"},"21_33":{service:"superTeam",cmd:"getSuperTeamMembersByAccounts",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_34":{service:"superTeam",cmd:"getMutedSuperTeamMembers",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_113":{service:"superTeam",cmd:"syncSuperTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"members",entity:"superTeamMember"},{type:"bool",name:"isAll"},{type:"long",name:"timetag"}]},"21_111":{service:"superTeam",cmd:"syncMySuperTeamMembers",response:[{type:"PropertyArray",name:"teamMembers",entity:"superTeamMember"},{type:"long",name:"timetag"}]},"21_109":{service:"superTeam",cmd:"syncSuperTeams",response:[{type:"PropertyArray",name:"teams",entity:"superTeam"},{type:"bool",name:"isAll"},{type:"long",name:"timetag"}]},"21_101":{service:"superTeam",cmd:"syncCreateSuperTeam",response:[{type:"Property",name:"team"}]},"21_102":{service:"superTeam",cmd:"syncSendSuperTeamMsg",response:[{type:"Property",name:"msg"}]},"21_110":{service:"superTeam",cmd:"syncUpdateSuperTeamMember",response:[{type:"Property",name:"teamMember",entity:"superTeamMember"}]},"21_117":{service:"superTeam",cmd:"syncDeleteSuperTeamMsg",response:[{type:"Property",name:"sysMsg"}]},"21_125":{service:"superTeam",cmd:"syncMarkSuperTeamSessionAck",response:[{type:"Long",name:"to"},{type:"Long",name:"timetag"}]},"8_1":{service:"team",cmd:"createTeam",response:[{type:"Property",name:"team"},{type:"StrArray",name:"abortedAccidList"}]},"8_2":{service:"team",cmd:"sendTeamMsg",response:[{type:"Property",name:"msg"}]},"8_3":{service:"team",cmd:"teamMsg",response:[{type:"Property",name:"msg"}]},"8_4":{service:"team",cmd:"teamMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_5":{service:"team",cmd:"addTeamMembers",response:[{type:"long",name:"time"},{type:"StrArray",name:"abortedAccidList"}]},"8_6":{service:"team",cmd:"removeTeamMembers"},"8_7":{service:"team",cmd:"updateTeam",response:[{type:"Number",name:"id"},{type:"Number",name:"time"}]},"8_8":{service:"team",cmd:"leaveTeam"},"8_9":{service:"team",cmd:"getTeam",response:[{type:"Property",name:"team"}]},"8_10":{service:"team",cmd:"getTeams",response:[{type:"PropertyArray",name:"teams",entity:"team"},{type:"Number",name:"timetag"}]},"8_11":{service:"team",cmd:"getTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"members",entity:"teamMember"},{type:"Number",name:"timetag"}]},"8_12":{service:"team",cmd:"dismissTeam"},"8_13":{service:"team",cmd:"applyTeam",response:[{type:"Property",name:"team"}]},"8_14":{service:"team",cmd:"passTeamApply"},"8_15":{service:"team",cmd:"rejectTeamApply"},"8_16":{service:"team",cmd:"addTeamManagers"},"8_17":{service:"team",cmd:"removeTeamManagers"},"8_18":{service:"team",cmd:"transferTeam"},"8_19":{service:"team",cmd:"updateInfoInTeam"},"8_20":{service:"team",cmd:"updateNickInTeam"},"8_21":{service:"team",cmd:"acceptTeamInvite",response:[{type:"Property",name:"team"}]},"8_22":{service:"team",cmd:"rejectTeamInvite"},"8_23":{service:"team",cmd:"getTeamHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_24":{service:"team",cmd:"searchTeamHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_25":{service:"team",cmd:"updateMuteStateInTeam"},"8_26":{service:"team",cmd:"getMyTeamMembers",response:[{type:"PropertyArray",name:"teamMembers",entity:"teamMember"}]},"8_27":{service:"team",cmd:"getMutedTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"teamMembers",entity:"teamMember"}]},"8_28":{service:"team",cmd:"sendTeamMsgReceipt",response:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},"8_29":{service:"team",cmd:"getTeamMsgReads",response:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},"8_30":{service:"team",cmd:"getTeamMsgReadAccounts",response:[{type:"Property",name:"teamMsgReceipt"},{type:"StrArray",name:"readAccounts"},{type:"StrArray",name:"unreadAccounts"}]},"8_31":{service:"team",cmd:"notifyTeamMsgReads",response:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},"8_32":{service:"team",cmd:"muteTeamAll",response:[]},"8_33":{service:"team",cmd:"getTeamMemberInvitorAccid",response:[{type:"object",name:"accountsMap"}]},"8_34":{service:"team",cmd:"getTeamsById",response:[{type:"PropertyArray",name:"teams",entity:"team"},{type:"StrArray",name:"tids"}],trivialErrorCodes:[816]},"8_126":{service:"team",cmd:"syncMyTeamMembers",response:[{type:"PropertyArray",name:"teamMembers",entity:"teamMember"},{type:"Number",name:"timetag"}]},"8_109":{service:"team",cmd:"syncTeams",response:[{type:"Number",name:"timetag"},{type:"PropertyArray",name:"teams",entity:"team"}]},"8_111":{service:"team",cmd:"syncTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"members",entity:"teamMember"},{type:"Number",name:"timetag"}]},"8_101":{service:"team",cmd:"syncCreateTeam",response:[{type:"Property",name:"team"}]},"8_102":{service:"team",cmd:"syncSendTeamMsg",response:[{type:"Property",name:"msg"}]},"8_119":{service:"team",cmd:"syncUpdateTeamMember",response:[{type:"Property",name:"teamMember"}]},"12_1":{service:"friend",cmd:"friendRequest"},"12_101":{service:"friend",cmd:"syncFriendRequest",response:[{type:"String",name:"account"},{type:"Number",name:"type"},{type:"String",name:"ps"}]},"12_2":{service:"friend",cmd:"deleteFriend"},"12_102":{service:"friend",cmd:"syncDeleteFriend",response:[{type:"String",name:"account"}]},"12_3":{service:"friend",cmd:"updateFriend"},"12_103":{service:"friend",cmd:"syncUpdateFriend",response:[{type:"Property",name:"friend"}]},"12_4":{service:"friend",cmd:"getFriends",response:[{type:"PropertyArray",name:"friends",entity:"friend"},{type:"Number",name:"timetag"}]},"12_5":{service:"friend",cmd:"syncFriends",response:[{type:"PropertyArray",name:"friends",entity:"friend"},{type:"Number",name:"timetag"}]},"12_6":{service:"friend",cmd:"syncFriendUsers",response:[{type:"PropertyArray",name:"users",entity:"user"},{type:"Number",name:"timetag"}]},"13_1":{service:"chatroom",cmd:"getChatroomAddress",response:[{type:"StrArray",name:"address"}]},"14_1":{service:"eventService",cmd:"publishEvent",response:[{type:"Property",name:"msgEvent"}]},"14_2":{service:"eventService",cmd:"pushEvent",response:[{type:"Property",name:"msgEvent"}]},"14_3":{service:"eventService",cmd:"subscribeEvent",response:[{type:"StrArray",name:"accounts"}]},"14_4":{service:"eventService",cmd:"unSubscribeEventsByAccounts",response:[{type:"StrArray",name:"accounts"}]},"14_5":{service:"eventService",cmd:"unSubscribeEventsByType"},"14_6":{service:"eventService",cmd:"querySubscribeEventsByAccounts",response:[{type:"PropertyArray",name:"msgEventSubscribes",entity:"msgEventSubscribe"}]},"14_7":{service:"eventService",cmd:"querySubscribeEventsByType",response:[{type:"PropertyArray",name:"msgEventSubscribes",entity:"msgEventSubscribe"}]},"14_9":{service:"eventService",cmd:"pushEvents",response:[{type:"PropertyArray",name:"msgEvents",entity:"msgEvent"}]},"22_1":{service:"proxyService",cmd:"httpProxy",response:[{type:"Property",name:"proxyTag"}]},"22_2":{service:"proxyService",cmd:"onProxyMsg",response:[{type:"Property",name:"proxyMsg",entity:"proxyMsgTag"}]},"24_1":{service:"qchat",cmd:"getQChatAddress",response:[{type:"StrArray",name:"address"}]},"101_1":{service:"filter",cmd:"sendFilterMsg",response:[{type:"Property",name:"msg"}]},"101_2":{service:"filter",cmd:"filterMsg",response:[{type:"Property",name:"msg"}]},"101_3":{service:"filter",cmd:"filterSysMsg",response:[{type:"Property",name:"sysMsg"}]},"101_7":{service:"filter",cmd:"sendFilterCustomSysMsg"}});t.exports={idMap:a,cmdConfig:i,packetConfig:u}},function(t,r){t.exports={negotiateTransportTag:{version:-1,serializeList:1,serialize:101},initTransportTag:{},nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},audioToText:{url:2},imageOp:{type:0,stripmeta:1,typeType:2,blurRadius:3,blurSigma:4,qualityQuality:5,cropX:6,cropY:7,cropWidth:8,cropHeight:9,rotateAngle:10,pixelPixel:11,thumbnailMode:12,thumbnailWidth:13,thumbnailHeight:14,thumbnailAxisX:15,thumbnailAxisY:16,thumbnailCenterX:17,thumbnailCenterY:18,thumbnailEnlarge:19,thumbnailToStatic:20,watermarkType:21,watermarkGravity:22,watermarkDissolve:23,watermarkDx:24,watermarkDy:25,watermarkImage:26,watermarkText:27,watermarkFont:28,watermarkFontSize:29,watermarkFontColor:30,interlace:31},robot:{account:4,nick:5,avatar:6,intro:7,config:8,valid:9,createTime:10,updateTime:11,custid:12,botid:13,bindTime:14},clientAntispam:{version:1,md5:2,nosurl:3,thesaurus:4},fileQuickTransfer:{md5:1,url:2,size:3,threshold:4},transToken:{name:1,type:2,transType:3,size:4,extra:5,body:6},transInfo:{docId:1,name:2,prefix:3,size:4,type:5,state:6,transType:7,transSize:8,pageCount:9,picInfo:10,extra:11,flag:12},nosFileUrlTag:{safeUrl:0,originUrl:1},nosAccessTokenTag:{token:0,url:1,userAgent:2,ext:3},fileListParam:{fromDocId:1,limit:2},avSignalTag:{type:1,channelName:2,channelId:3,channelCreateTime:4,channelExpireTime:5,creator:6,ext:7,channelInValid:8,from:10,to:11,requestId:12,needPush:13,pushTitle:14,pushContent:15,pushPayload:16,needBadge:17,members:18,attach:19,attachExt:20,isSave:21,msgid:22,uid:23,time:24,nertcChannelName:25,nertcTokenTtl:26,nertcToken:27,nertcJoinRoomQueryParamMap:28,nertcJoinRoomResponse:29,callStatus:30},login:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appKey:18,account:19,browser:24,session:26,deviceInfo:32,sdkType:41,userAgent:42,isReactNative:112,token:1e3,customTag:38,customClientType:39,sdkHumanVersion:40,authType:115,loginExt:116},loginRes:{lastLoginDeviceId:17,customTag:38,connectionId:102,ip:103,port:104,country:106,hasXMPush:111},loginPort:{type:3,os:4,mac:5,deviceId:13,account:19,deviceInfo:32,connectionId:102,ip:103,time:109,customTag:38,customClientType:39},aosPushInfo:{pushType:110,hasTokenPreviously:111},sync:{myInfo:1,offlineMsgs:2,teams:3,netcallMsgs:6,roamingMsgs:7,relations:9,friends:11,sessions:12,friendUsers:13,msgReceipts:14,myTeamMembers:15,donnop:16,deleteMsg:17,sessionAck:18,robots:19,broadcastMsgs:20,avSignal:21,superTeams:22,myInfoInSuperTeams:23,superTeamRoamingMsgs:24,deleteSuperTeamMsg:25,superTeamSessionAck:26,deleteMsgSelf:27,stickTopSessions:28,sessionHistoryMsgsDelete:29,filterMsgs:100},donnop:{open:1},sessionReqTag:{minTimestamp:1,maxTimestamp:2,needLastMsg:3,limit:4,hasMore:5},session:{id:1,updateTime:2,ext:3,lastMsg:4},superTeam:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,custom:18,serverCustom:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateCustomMode:24,mute:100,muteType:101},superTeamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,createTime:10,updateTime:11,custom:12,mute:13,invitoraccid:14,joinTime:15},team:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,custom:18,serverCustom:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateCustomMode:24,mute:100,muteType:101},teamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,joinTime:10,updateTime:11,custom:12,mute:13,invitorAccid:14},msg:{scene:0,to:1,from:2,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,type:8,body:9,attach:10,idClient:11,idServer:12,resend:13,userUpdateTime:14,custom:15,pushPayload:16,pushContent:17,apnsAccounts:18,apnsContent:19,apnsForcePush:20,yidunEnable:21,antiSpamContent:22,antiSpamBusinessId:23,clientAntiSpam:24,antiSpamUsingYidun:25,needMsgReceipt:26,needUpdateSession:28,replyMsgFromAccount:29,replyMsgToAccount:30,replyMsgTime:31,replyMsgIdServer:32,replyMsgIdClient:33,threadMsgFromAccount:34,threadMsgToAccount:35,threadMsgTime:36,threadMsgIdServer:37,threadMsgIdClient:38,delete:39,callbackExt:40,subType:41,yidunAntiCheating:42,env:43,yidunAntiSpamExt:44,yidunAntiSpamRes:45,__clientExt:46,robotInfoFunction:47,robotInfoTopic:48,robotInfoCustomContent:49,robotInfoAccount:50,isHistoryable:100,isRoamingable:101,isSyncable:102,isMuted:104,cc:105,isInBlackList:106,isPushable:107,isOfflinable:108,isUnreadable:109,needPushNick:110,isReplyMsg:111,tempTeamMemberCount:112},threadMsgReq:{beginTime:1,endTime:2,lastMsgId:3,limit:4,reverse:5},threadMsgsMeta:{total:1,lastMsgTime:2},comment:{from:1,body:2,time:3,custom:4,needPush:5,needBadge:6,pushTitle:7,apnsText:8,pushPayload:9},commentReq:{scene:1,from:2,to:3,time:4,idServer:5,idClient:6,timestamp:100},commentRes:{scene:1,from:2,to:3,time:4,idServer:5,idClient:6,detail:7,modify:8,timestamp:100},collect:{id:1,type:2,data:3,custom:4,uniqueId:5,createTime:6,updateTime:7},collectQuery:{beginTime:1,endTime:2,lastMsgId:3,limit:4,reverse:5,type:6},stickTopSession:{id:1,topCustom:2,createTime:3,updateTime:4},pinTag:{pinFrom:1,pinCustom:2,createTime:3,updateTime:4},msgPinReq:{sessionId:1,timetag:2},msgPinRes:{scene:1,from:2,to:3,time:4,idServer:5,idClient:6,pinFrom:7,pinCustom:8},msgReceipt:{to:1,from:2,time:7,idClient:11},teamMsgReceipt:{teamId:0,idServer:1,read:100,unread:101,idClient:102,account:103},deleteMsgSelfTag:{scene:1,from:2,to:3,idServer:4,idClient:5,time:6,deletedTime:7,custom:8},sysMsg:{time:0,type:1,to:2,from:3,ps:4,attach:5,idServer:6,sendToOnlineUsersOnly:7,apnsText:8,pushPayload:9,deletedIdClient:10,deletedIdServer:11,yidunEnable:12,antiSpamContent:13,deletedMsgTime:14,deletedMsgFromNick:15,opeAccount:16,env:21,idClient:23,callbackExt:22,cc:105,isPushable:107,isUnreadable:109,needPushNick:110},broadcastMsg:{broadcastId:1,fromAccid:2,fromUid:3,timestamp:4,body:5},friend:{account:4,flag:5,beflag:6,source:7,alias:8,bits:9,custom:10,createTime:11,updateTime:12,serverex:13},user:{account:1,nick:3,avatar:4,sign:5,gender:6,email:7,birth:8,tel:9,custom:10,createTime:12,updateTime:13},antispamTag:{antiSpamBusinessId:1},specialRelation:{account:0,isMuted:1,isBlacked:2,createTime:3,updateTime:4},msgType:{text:0,picture:1,audio:2,video:3,location:4,notification:5,file:6,netcall_audio:7,netcall_vedio:8,datatunnel_new:9,tips:10,robot:11,custom:100},msgEvent:{type:1,value:2,idClient:3,custom:4,validTime:5,broadcastType:6,sync:7,validTimeType:8,durable:9,time:10,idServer:11,clientType:12,serverConfig:13,serverCustom:14,appid:101,account:103,enableMultiClient:104,consid:106},msgEventSubscribe:{type:1,subscribeTime:2,sync:3,to:102,from:104,time:105},clearMsgsParams:{account:1,delRoam:2},clearMsgsParamsWithSync:{type:0,otherAccid:1,isDeleteRoam:2,toTid:3,isSyncSelf:4,fromAccid:5,time:6,ext:7},msgFullSearchRequestTag:{keyword:1,fromTime:2,toTime:3,sessionLimit:4,msgLimit:5,order:6,p2pList:7,teamList:8,senderList:9,msgTypeList:10,msgSubTypeList:11},msgTimingFullSearchRequestTag:{keyword:1,fromTime:2,toTime:3,msgLimit:5,order:6,p2pList:7,teamList:8,senderList:9,msgTypeList:10,msgSubTypeList:11},delFriendParams:{delAlias:1},proxyTag:{zone:1,path:2,method:3,header:4,body:5},proxyMsgTag:{from:1,body:2,time:3},sessionAckTag:{scene:1,to:2,timetag:3},mixTokenReq:{provider:0,tokenCount:1,fileExpireSec:2,tag:3,returnBody:4},mixAuthTokenReq:{type:1,urls:2},notifyDetectTag:{type:1,params:2,result:3,t1:100,t2:101,t3:102,t4:103,t5:104,t6:105},getQChatAddressTag:{ipType:1}}},function(t,r){t.exports={negotiateTransportTag:{"-1":"version",1:"serializeList",101:"serialize"},initTransportTag:{},nosToken:{1:"objectName",2:"token",3:"bucket",4:"expireTime",7:"expireSec",8:"tag",9:"shortUrl"},audioToText:{2:"url"},imageOp:{0:"type",1:"stripmeta",2:"typeType",3:"blurRadius",4:"blurSigma",5:"qualityQuality",6:"cropX",7:"cropY",8:"cropWidth",9:"cropHeight",10:"rotateAngle",11:"pixelPixel",12:"thumbnailMode",13:"thumbnailWidth",14:"thumbnailHeight",15:"thumbnailAxisX",16:"thumbnailAxisY",17:"thumbnailCenterX",18:"thumbnailCenterY",19:"thumbnailEnlarge",20:"thumbnailToStatic",21:"watermarkType",22:"watermarkGravity",23:"watermarkDissolve",24:"watermarkDx",25:"watermarkDy",26:"watermarkImage",27:"watermarkText",28:"watermarkFont",29:"watermarkFontSize",30:"watermarkFontColor",31:"interlace"},robot:{4:"account",5:"nick",6:"avatar",7:"intro",8:"config",9:"valid",10:"createTime",11:"updateTime",12:"custid",13:"botid",14:"bindTime",_6_safe:"_avatar_safe"},clientAntispam:{1:"version",2:"md5",3:"nosurl",4:"thesaurus"},fileQuickTransfer:{1:"md5",2:"url",3:"size",4:"threshold",_2_safe:"_url_safe"},transToken:{1:"name",2:"type",3:"transType",4:"size",5:"extra",6:"body"},transInfo:{1:"docId",2:"name",3:"prefix",4:"size",5:"type",6:"state",7:"transType",8:"transSize",9:"pageCount",10:"picInfo",11:"extra",12:"flag"},nosFileUrlTag:{0:"safeUrl",1:"originUrl"},nosAccessTokenTag:{0:"token",1:"url",2:"userAgent",3:"ext"},nosConfigTag:{1:"bucket",2:"cdnDomain",3:"expire",4:"objectNamePrefix"},appGrayConfigTag:{0:"grayConfig",1:"ttl"},mixStorePolicyTag:{0:"providers",1:"ttl",2:"mixEnable",3:"nosPolicy",4:"s3Policy"},mixStoreTokenTag:{0:"provider",1:"accessKeyId",2:"secretAccessKey",3:"sessionToken",4:"token",5:"expireAt",6:"bucket",7:"objectName",8:"fileExpireSec",9:"tag",10:"shortUrl",11:"region"},notifyDetectTag:{1:"type",2:"params",3:"result",100:"t1",101:"t2",102:"t3",103:"t4",104:"t5",105:"t6"},backSourceTokenTag:{1:"type",2:"tokens",3:"token",4:"ttl"},fileListParam:{1:"fromDocId",2:"limit"},avSignalTag:{1:"type",2:"channelName",3:"channelId",4:"channelCreateTime",5:"channelExpireTime",6:"creator",7:"ext",8:"channelInValid",10:"from",11:"to",12:"requestId",13:"needPush",14:"pushTitle",15:"pushContent",16:"pushPayload",17:"needBadge",18:"members",19:"attach",20:"attachExt",21:"isSave",22:"msgid",23:"uid",24:"time",25:"nertcChannelName",26:"nertcTokenTtl",27:"nertcToken",28:"nertcJoinRoomQueryParamMap",29:"nertcJoinRoomResponse",30:"callStatus"},login:{3:"clientType",4:"os",6:"sdkVersion",8:"appLogin",9:"protocolVersion",10:"pushTokenName",11:"pushToken",13:"deviceId",18:"appKey",19:"account",24:"browser",26:"session",32:"deviceInfo",38:"customTag",39:"customClientType",40:"sdkHumanVersion",112:"isReactNative",115:"authType",116:"loginExt",1e3:"token"},loginRes:{17:"lastLoginDeviceId",38:"customTag",102:"connectionId",103:"ip",104:"port",106:"country",111:"hasXMPush"},loginPort:{3:"type",4:"os",5:"mac",13:"deviceId",19:"account",32:"deviceInfo",38:"customTag",39:"customClientType",102:"connectionId",103:"ip",109:"time"},aosPushInfo:{110:"pushType",111:"hasTokenPreviously"},sync:{1:"myInfo",2:"offlineMsgs",3:"teams",6:"netcallMsgs",7:"roamingMsgs",9:"relations",11:"friends",12:"sessions",13:"friendUsers",14:"msgReceipts",15:"myTeamMembers",16:"donnop",17:"deleteMsg",18:"sessionAck",19:"robots",20:"broadcastMsgs",21:"avSignal",22:"superTeams",23:"myInfoInSuperTeams",24:"superTeamRoamingMsgs",25:"deleteSuperTeamMsg",26:"superTeamSessionAck",27:"deleteMsgSelf",28:"stickTopSessions",29:"sessionHistoryMsgsDelete",100:"filterMsgs"},donnop:{1:"open"},sessionReqTag:{1:"minTimestamp",2:"maxTimestamp",3:"needLastMsg",4:"limit",5:"hasMore"},session:{1:"id",2:"updateTime",3:"ext",4:"lastMsg",5:"lastMsgType"},superTeam:{1:"teamId",3:"name",4:"type",5:"owner",6:"level",7:"selfCustom",8:"valid",9:"memberNum",10:"memberUpdateTime",11:"createTime",12:"updateTime",13:"validToCurrentUser",14:"intro",15:"announcement",16:"joinMode",17:"bits",18:"custom",19:"serverCustom",20:"avatar",21:"beInviteMode",22:"inviteMode",23:"updateTeamMode",24:"updateCustomMode",100:"mute",101:"muteType",_20_safe:"_avatar_safe"},superTeamMember:{1:"teamId",3:"account",4:"type",5:"nickInTeam",7:"bits",8:"active",9:"valid",10:"createTime",11:"updateTime",12:"custom",13:"mute",14:"invitoraccid",15:"joinTime"},team:{1:"teamId",3:"name",4:"type",5:"owner",6:"level",7:"selfCustom",8:"valid",9:"memberNum",10:"memberUpdateTime",11:"createTime",12:"updateTime",13:"validToCurrentUser",14:"intro",15:"announcement",16:"joinMode",17:"bits",18:"custom",19:"serverCustom",20:"avatar",21:"beInviteMode",22:"inviteMode",23:"updateTeamMode",24:"updateCustomMode",100:"mute",101:"muteType",_20_safe:"_avatar_safe"},teamMember:{1:"teamId",3:"account",4:"type",5:"nickInTeam",7:"bits",8:"active",9:"valid",10:"joinTime",11:"updateTime",12:"custom",13:"mute",14:"invitorAccid"},msg:{0:"scene",1:"to",2:"from",4:"fromClientType",5:"fromDeviceId",6:"fromNick",7:"time",8:"type",9:"body",10:"attach",11:"idClient",12:"idServer",13:"resend",14:"userUpdateTime",15:"custom",16:"pushPayload",17:"pushContent",18:"apnsAccounts",19:"apnsContent",20:"apnsForcePush",21:"yidunEnable",22:"antiSpamContent",23:"antiSpamBusinessId",24:"clientAntiSpam",25:"antiSpamUsingYidun",26:"needMsgReceipt",28:"needUpdateSession",29:"replyMsgFromAccount",30:"replyMsgToAccount",31:"replyMsgTime",32:"replyMsgIdServer",33:"replyMsgIdClient",34:"threadMsgFromAccount",35:"threadMsgToAccount",36:"threadMsgTime",37:"threadMsgIdServer",38:"threadMsgIdClient",39:"delete",40:"callbackExt",41:"subType",42:"yidunAntiCheating",43:"env",44:"yidunAntiSpamExt",45:"yidunAntiSpamRes",46:"__clientExt",47:"robotInfoFunction",48:"robotInfoTopic",49:"robotInfoCustomContent",50:"robotInfoAccount",100:"isHistoryable",101:"isRoamingable",102:"isSyncable",104:"isMuted",105:"cc",106:"isInBlackList",107:"isPushable",108:"isOfflinable",109:"isUnreadable",110:"needPushNick",111:"isReplyMsg",112:"tempTeamMemberCount"},threadMsgReq:{1:"beginTime",2:"endTime",3:"lastMsgId",4:"limit",5:"reverse"},threadMsgsMeta:{1:"total",2:"lastMsgTime"},comment:{1:"from",2:"body",3:"time",4:"custom",5:"needPush",6:"needBadge",7:"pushTitle",8:"apnsText",9:"pushPayload"},commentReq:{1:"scene",2:"from",3:"to",4:"time",5:"idServer",6:"idClient",100:"timestamp"},commentRes:{1:"scene",2:"from",3:"to",4:"time",5:"idServer",6:"idClient",7:"detail",8:"modify",100:"timestamp"},collect:{1:"id",2:"type",3:"data",4:"custom",5:"uniqueId",6:"createTime",7:"updateTime"},collectQuery:{1:"beginTime",2:"endTime",3:"lastMsgId",4:"limit",5:"reverse",6:"type"},stickTopSession:{1:"id",2:"topCustom",3:"createTime",4:"updateTime"},pinTag:{1:"pinFrom",2:"pinCustom",3:"createTime",4:"updateTime"},msgPinReq:{1:"sessionId",2:"timetag"},msgPinRes:{1:"scene",2:"from",3:"to",4:"time",5:"idServer",6:"idClient",7:"pinFrom",8:"pinCustom"},msgReceipt:{1:"to",2:"from",7:"time",11:"idClient"},teamMsgReceipt:{0:"teamId",1:"idServer",100:"read",101:"unread",102:"idClient",103:"account"},deleteMsgSelfTag:{1:"scene",2:"from",3:"to",4:"idServer",5:"idClient",6:"time",7:"deletedTime",8:"custom"},sysMsg:{0:"time",1:"type",2:"to",3:"from",4:"ps",5:"attach",6:"idServer",7:"sendToOnlineUsersOnly",8:"apnsText",9:"pushPayload",10:"deletedIdClient",11:"deletedIdServer",12:"yidunEnable",13:"antiSpamContent",14:"deletedMsgTime",15:"deletedMsgFromNick",16:"opeAccount",21:"env",22:"callbackExt",23:"idClient",105:"cc",107:"isPushable",109:"isUnreadable",110:"needPushNick"},broadcastMsg:{1:"broadcastId",2:"fromAccid",3:"fromUid",4:"timestamp",5:"body"},friend:{4:"account",5:"flag",6:"beflag",7:"source",8:"alias",9:"bits",10:"custom",11:"createTime",12:"updateTime",13:"serverex"},user:{1:"account",3:"nick",4:"avatar",5:"sign",6:"gender",7:"email",8:"birth",9:"tel",10:"custom",12:"createTime",13:"updateTime",_4_safe:"_avatar_safe"},antispamTag:{antiSpamBusinessId:1},specialRelation:{0:"account",1:"isMuted",2:"isBlacked",3:"createTime",4:"updateTime"},msgType:{0:"text",1:"picture",2:"audio",3:"video",4:"location",5:"notification",6:"file",7:"netcall_audio",8:"netcall_vedio",9:"datatunnel_new",10:"tips",11:"robot",100:"custom"},msgEvent:{1:"type",2:"value",3:"idClient",4:"custom",5:"validTime",6:"broadcastType",7:"sync",8:"validTimeType",9:"durable",10:"time",11:"idServer",12:"clientType",13:"serverConfig",14:"serverCustom",101:"appid",103:"account",104:"enableMultiClient",106:"consid"},msgEventSubscribe:{1:"type",2:"subscribeTime",3:"sync",102:"to",104:"from",105:"time"},clearMsgsParams:{1:"account",2:"delRoam"},clearMsgsParamsWithSync:{0:"type",1:"otherAccid",2:"delRoam",3:"toTid",4:"isSyncSelf",5:"fromAccid",6:"time",7:"ext"},msgFullSearchRequestTag:{1:"keyword",2:"fromTime",3:"toTime",4:"sessionLimit",5:"msgLimit",6:"order",7:"p2pList",8:"teamList",9:"senderList",10:"msgTypeList",11:"msgSubTypeList"},delFriendParams:{1:"delAlias"},proxyTag:{1:"zone",2:"path",3:"method",4:"header",5:"body"},proxyMsgTag:{1:"from",2:"body",3:"time"},sessionReliableSyncTag:{1:"scene",2:"sessionId",3:"syncStatus",4:"syncEndMsgId",5:"syncEndMsgidClient",6:"syncEndMsgTime",7:"syncStartMsgid",8:"syncStartMsgidClient",9:"syncStartMsgTime",10:"nextMsgid",11:"nextMsgidClient",12:"nextMsgTime",13:"roamMsgSync",14:"offlineMsgSync",15:"netCallOfflineMsgSync"},sessionReliableSyncContextTag:{1:"timetag",2:"type"}}},function(t,r,e){var n=e(0),o=e(190),s=n.merge({},o.idMap,{chatroom:{id:13,login:2,kicked:3,logout:4,sendMsg:6,msg:7,getChatroomMembers:8,getHistoryMsgs:9,markChatroomMember:11,closeChatroom:12,getChatroom:13,updateChatroom:14,updateMyChatroomMemberInfo:15,getChatroomMembersInfo:16,kickChatroomMember:17,updateChatroomMemberTempMute:19,queueOffer:20,queuePoll:21,queueList:22,peak:23,queueDrop:24,queueInit:25,queueChange:26,updateTagMembersTempMute:30,getChatroomMembersByTag:31,getChatroomMemberCountByTag:32,updateCoordinate:33,updateChatroomTags:34,sendChatroomMsgAck:35,getHistoryMsgsByTags:36,notifyCdnInfo:99},user:{id:3,syncRobot:16}}),a=n.merge({},o.cmdConfig,{login:{sid:s.chatroom.id,cid:s.chatroom.login,params:[{type:"byte",name:"type"},{type:"Property",name:"login"},{type:"Property",name:"imLogin"}]},logout:{sid:s.chatroom.id,cid:s.chatroom.logout},sendMsg:{sid:s.chatroom.id,cid:s.chatroom.sendMsg,params:[{type:"Property",name:"msg"}]},getChatroomMembers:{sid:s.chatroom.id,cid:s.chatroom.getChatroomMembers,params:[{type:"byte",name:"type"},{type:"long",name:"time"},{type:"int",name:"limit"}]},getHistoryMsgs:{sid:s.chatroom.id,cid:s.chatroom.getHistoryMsgs,params:[{type:"long",name:"timetag"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},markChatroomMember:{sid:s.chatroom.id,cid:s.chatroom.markChatroomMember,params:[{type:"string",name:"account"},{type:"int",name:"type"},{type:"bool",name:"isAdd"},{type:"int",name:"level"},{type:"string",name:"custom"}]},closeChatroom:{sid:s.chatroom.id,cid:s.chatroom.closeChatroom,params:[{type:"string",name:"custom"}]},getChatroom:{sid:s.chatroom.id,cid:s.chatroom.getChatroom},updateChatroom:{sid:s.chatroom.id,cid:s.chatroom.updateChatroom,params:[{type:"Property",name:"chatroom"},{type:"bool",name:"needNotify"},{type:"String",name:"custom"},{type:"Property",name:"antispamTag"}]},updateMyChatroomMemberInfo:{sid:s.chatroom.id,cid:s.chatroom.updateMyChatroomMemberInfo,params:[{type:"Property",name:"chatroomMember"},{type:"bool",name:"needNotify"},{type:"String",name:"custom"},{type:"bool",name:"needSave"},{type:"Property",name:"antispamTag"}]},getChatroomMembersInfo:{sid:s.chatroom.id,cid:s.chatroom.getChatroomMembersInfo,params:[{type:"StrArray",name:"accounts"}]},kickChatroomMember:{sid:s.chatroom.id,cid:s.chatroom.kickChatroomMember,params:[{type:"string",name:"account"},{type:"string",name:"custom"}]},updateChatroomMemberTempMute:{sid:s.chatroom.id,cid:s.chatroom.updateChatroomMemberTempMute,params:[{type:"String",name:"account"},{type:"long",name:"duration"},{type:"bool",name:"needNotify"},{type:"String",name:"custom"}]},queueOffer:{sid:s.chatroom.id,cid:s.chatroom.queueOffer,params:[{type:"string",name:"elementKey"},{type:"string",name:"elementValue"},{type:"bool",name:"transient"},{type:"string",name:"elementAccount"}]},queuePoll:{sid:s.chatroom.id,cid:s.chatroom.queuePoll,params:[{type:"string",name:"elementKey"}]},queueList:{sid:s.chatroom.id,cid:s.chatroom.queueList},peak:{sid:s.chatroom.id,cid:s.chatroom.peak},queueDrop:{sid:s.chatroom.id,cid:s.chatroom.queueDrop},queueInit:{sid:s.chatroom.id,cid:s.chatroom.queueInit,params:[{type:"int",name:"limit"}]},queueChange:{sid:s.chatroom.id,cid:s.chatroom.queueChange,params:[{type:"StrStrMap",name:"elementMap"},{type:"bool",name:"needNotify"},{type:"string",name:"notifyExt"}]},updateTagMembersTempMute:{sid:s.chatroom.id,cid:s.chatroom.updateTagMembersTempMute,params:[{type:"Property",name:"tagMuteReq"}]},updateCoordinate:{sid:s.chatroom.id,cid:s.chatroom.updateCoordinate,params:[{type:"Property",name:"coordinateReq"}]},getChatroomMemberCountByTag:{sid:s.chatroom.id,cid:s.chatroom.getChatroomMemberCountByTag,params:[{type:"String",name:"tag"}]},getChatroomMembersByTag:{sid:s.chatroom.id,cid:s.chatroom.getChatroomMembersByTag,params:[{type:"Property",name:"tagMemberReq"}]},updateChatroomTags:{sid:s.chatroom.id,cid:s.chatroom.updateChatroomTags,params:[{type:"Property",name:"chatRoomTagsUpdateTag"}]},sendChatroomMsgAck:{sid:s.chatroom.id,cid:s.chatroom.sendChatroomMsgAck,params:[{type:"Property",name:"chatRoomMsgAckTag"}]},getHistoryMsgsByTags:{sid:s.chatroom.id,cid:s.chatroom.getHistoryMsgsByTags,params:[{type:"Property",name:"chatRoomTagHistoryMsgRequestTag"}]},notifyCdnInfo:{sid:s.chatroom.id,cid:s.chatroom.notifyCdnInfo},syncRobot:{sid:s.user.id,cid:s.user.syncRobot,params:[{type:"long",name:"timetag"}]}}),i=n.merge({},o.packetConfig,{"4_10":{service:"notify"},"4_11":{service:"notify"},"3_16":{service:"chatroom",cmd:"syncRobot",response:[{type:"PropertyArray",name:"robots",entity:"robot"}]},"13_2":{service:"chatroom",cmd:"login",response:[{type:"Property",name:"chatroom"},{type:"Property",name:"chatroomMember"},{type:"Property",name:"chatroomCdnInfo"}]},"13_3":{service:"chatroom",cmd:"kicked",response:[{type:"Number",name:"reason"},{type:"String",name:"custom"}]},"13_4":{service:"chatroom",cmd:"logout"},"13_6":{service:"chatroom",cmd:"sendMsg",response:[{type:"Property",name:"msg"}]},"13_7":{service:"chatroom",cmd:"msg",response:[{type:"Property",name:"msg"}]},"13_8":{service:"chatroom",cmd:"getChatroomMembers",response:[{type:"PropertyArray",name:"members",entity:"chatroomMember"}]},"13_9":{service:"chatroom",cmd:"getHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"13_11":{service:"chatroom",cmd:"markChatroomMember",response:[{type:"Property",name:"chatroomMember"}]},"13_12":{service:"chatroom",cmd:"closeChatroom"},"13_13":{service:"chatroom",cmd:"getChatroom",response:[{type:"Property",name:"chatroom"}]},"13_14":{service:"chatroom",cmd:"updateChatroom"},"13_15":{service:"chatroom",cmd:"updateMyChatroomMemberInfo"},"13_16":{service:"chatroom",cmd:"getChatroomMembersInfo",response:[{type:"PropertyArray",name:"members",entity:"chatroomMember"}]},"13_17":{service:"chatroom",cmd:"kickChatroomMember"},"13_19":{service:"chatroom",cmd:"updateChatroomMemberTempMute"},"13_20":{service:"chatroom",cmd:"queueOffer"},"13_21":{service:"chatroom",cmd:"queuePoll",response:[{type:"String",name:"elementKey"},{type:"String",name:"elementValue"}]},"13_22":{service:"chatroom",cmd:"queueList",response:[{type:"KVArray",name:"queueList"}]},"13_23":{service:"chatroom",cmd:"peak",response:[{type:"String",name:"elementKey"},{type:"String",name:"elementValue"}]},"13_24":{service:"chatroom",cmd:"queueDrop"},"13_25":{service:"chatroom",cmd:"queueInit"},"13_26":{service:"chatroom",cmd:"queueChange",response:[{type:"StrArray",name:"elementKeyArray"}]},"13_30":{service:"chatroom",cmd:"updateTagMembersTempMute"},"13_33":{service:"chatroom",cmd:"updateCoordinate"},"13_31":{service:"chatroom",cmd:"getChatroomMembersByTag",response:[{type:"PropertyArray",name:"members",entity:"chatroomMember"}]},"13_32":{service:"chatroom",cmd:"getChatroomMemberCountByTag",response:[{type:"long",name:"count"}]},"13_34":{service:"chatroom",cmd:"updateChatroomTags"},"13_36":{service:"chatroom",cmd:"getHistoryMsgsByTags",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"13_99":{service:"chatroom",cmd:"notifyCdnInfo",response:[{type:"Property",name:"chatroomCdnInfo"}]},"13_101":{service:"chatroom",cmd:"updateChatroomTag",response:[{type:"Property",name:"updateTags"}]}});t.exports={idMap:s,cmdConfig:a,packetConfig:i}},function(t,r){t.exports={imLogin:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appKey:18,account:19,browser:24,session:26,deviceInfo:32,sdkType:41,userAgent:42,isReactNative:112,authType:115,loginExt:116,token:1e3,customTag:38},nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},audioToText:{url:2},imageOp:{type:0,stripmeta:1,typeType:2,blurRadius:3,blurSigma:4,qualityQuality:5,cropX:6,cropY:7,cropWidth:8,cropHeight:9,rotateAngle:10,pixelPixel:11,thumbnailMode:12,thumbnailWidth:13,thumbnailHeight:14,thumbnailAxisX:15,thumbnailAxisY:16,thumbnailCenterX:17,thumbnailCenterY:18,thumbnailEnlarge:19,thumbnailToStatic:20,watermarkType:21,watermarkGravity:22,watermarkDissolve:23,watermarkDx:24,watermarkDy:25,watermarkImage:26,watermarkText:27,watermarkFont:28,watermarkFontSize:29,watermarkFontColor:30,interlace:31},robot:{account:4,nick:5,avatar:6,intro:7,config:8,valid:9,createTime:10,updateTime:11,custid:12,botid:13,bindTime:14},clientAntispam:{version:1,md5:2,nosurl:3,thesaurus:4},fileQuickTransfer:{md5:1,url:2,size:3,threshold:4},transToken:{name:1,type:2,transType:3,size:4,extra:5,body:6},transInfo:{docId:1,name:2,prefix:3,size:4,type:5,state:6,transType:7,transSize:8,pageCount:9,picInfo:10,extra:11,flag:12},nosFileUrlTag:{safeUrl:0,originUrl:1},nosAccessTokenTag:{token:0,url:1,userAgent:2,ext:3},fileListParam:{fromDocId:1,limit:2},avSignalTag:{type:1,channelName:2,channelId:3,channelCreateTime:4,channelExpireTime:5,creator:6,ext:7,channelInValid:8,from:10,to:11,requestId:12,needPush:13,pushTitle:14,pushContent:15,pushPayload:16,needBadge:17,members:18,attach:19,attachExt:20,isSave:21,msgid:22,uid:23,time:24,nertcChannelName:25,nertcTokenTtl:26,nertcToken:27,nertcJoinRoomQueryParamMap:28,nertcJoinRoomResponse:29,callStatus:30},login:{appKey:1,account:2,deviceId:3,chatroomId:5,appLogin:8,chatroomNick:20,chatroomAvatar:21,chatroomCustom:22,chatroomEnterCustom:23,session:26,isAnonymous:38,tags:39,notifyTargetTags:40,loginAuthType:41,loginExt:42,loc_x:43,loc_y:44,loc_z:45,distance:46,antiSpamBusinessId:47},chatroom:{id:1,name:3,announcement:4,broadcastUrl:5,custom:12,createTime:14,updateTime:15,queuelevel:16,creator:100,onlineMemberNum:101,mute:102},msg:{idClient:1,type:2,attach:3,custom:4,resend:5,userUpdateTime:6,fromNick:7,fromAvatar:8,fromCustom:9,yidunEnable:10,antiSpamContent:11,skipHistory:12,body:13,antiSpamBusinessId:14,clientAntiSpam:15,antiSpamUsingYidun:16,time:20,from:21,chatroomId:22,fromClientType:23,highPriority:25,callbackExt:27,subType:28,yidunAntiCheating:29,env:30,notifyTargetTags:31,yidunAntiSpamExt:32,yidunAntiSpamRes:33,loc_x:34,loc_y:35,loc_z:36,toAccids:37,needHighPriorityMsgAck:38,__clientExt:39},chatroomMember:{chatroomId:1,account:2,type:3,level:4,nick:5,avatar:6,custom:7,online:8,guest:9,enterTime:10,blacked:12,gaged:13,valid:14,updateTime:15,tempMuted:16,tempMuteDuration:17},antispamTag:{antiSpamBusinessId:1},chatroomCdnInfo:{enable:1,cdnUrls:2,timestamp:3,interval:4,decryptType:5,decryptKey:6,timeout:7},tagMemberReq:{tag:1,time:2,limit:3},tagMuteReq:{tag:1,duration:2,needNotify:3,custom:4,notifyTargetTags:5},coordinateReq:{x:1,y:2,z:3,distance:4},chatRoomTagsUpdateTag:{tags:1,notifyTargetTags:2,needNotify:3,ext:4},chatRoomMsgAckTag:{idClient:1,chatroomId:2},chatRoomTagHistoryMsgRequestTag:{tags:1,types:2,fromTime:3,toTime:4,limit:5,reverse:6}}},function(t,r){t.exports={imLogin:{3:"clientType",4:"os",6:"sdkVersion",8:"appLogin",9:"protocolVersion",10:"pushTokenName",11:"pushToken",13:"deviceId",18:"appKey",19:"account",24:"browser",26:"session",32:"deviceInfo",38:"customTag",41:"sdkType",42:"userAgent",112:"isReactNative",1e3:"token"},nosToken:{1:"objectName",2:"token",3:"bucket",4:"expireTime",7:"expireSec",8:"tag",9:"shortUrl"},audioToText:{2:"url"},imageOp:{0:"type",1:"stripmeta",2:"typeType",3:"blurRadius",4:"blurSigma",5:"qualityQuality",6:"cropX",7:"cropY",8:"cropWidth",9:"cropHeight",10:"rotateAngle",11:"pixelPixel",12:"thumbnailMode",13:"thumbnailWidth",14:"thumbnailHeight",15:"thumbnailAxisX",16:"thumbnailAxisY",17:"thumbnailCenterX",18:"thumbnailCenterY",19:"thumbnailEnlarge",20:"thumbnailToStatic",21:"watermarkType",22:"watermarkGravity",23:"watermarkDissolve",24:"watermarkDx",25:"watermarkDy",26:"watermarkImage",27:"watermarkText",28:"watermarkFont",29:"watermarkFontSize",30:"watermarkFontColor",31:"interlace"},robot:{4:"account",5:"nick",6:"avatar",7:"intro",8:"config",9:"valid",10:"createTime",11:"updateTime",12:"custid",13:"botid",14:"bindTime",_6_safe:"_avatar_safe"},clientAntispam:{1:"version",2:"md5",3:"nosurl",4:"thesaurus"},fileQuickTransfer:{1:"md5",2:"url",3:"size",4:"threshold",_2_safe:"_url_safe"},transToken:{1:"name",2:"type",3:"transType",4:"size",5:"extra",6:"body"},transInfo:{1:"docId",2:"name",3:"prefix",4:"size",5:"type",6:"state",7:"transType",8:"transSize",9:"pageCount",10:"picInfo",11:"extra",12:"flag"},nosFileUrlTag:{0:"safeUrl",1:"originUrl"},nosAccessTokenTag:{0:"token",1:"url",2:"userAgent",3:"ext"},fileListParam:{1:"fromDocId",2:"limit"},avSignalTag:{1:"type",2:"channelName",3:"channelId",4:"channelCreateTime",5:"channelExpireTime",6:"creator",7:"ext",8:"channelInValid",10:"from",11:"to",12:"requestId",13:"needPush",14:"pushTitle",15:"pushContent",16:"pushPayload",17:"needBadge",18:"members",19:"attach",20:"attachExt",21:"isSave",22:"msgid",23:"uid",24:"time",25:"nertcChannelName",26:"nertcTokenTtl",27:"nertcToken",28:"nertcJoinRoomQueryParamMap",29:"nertcJoinRoomResponse",30:"callStatus"},login:{1:"appKey",2:"account",3:"deviceId",5:"chatroomId",8:"appLogin",20:"chatroomNick",21:"chatroomAvatar",22:"chatroomCustom",23:"chatroomEnterCustom",26:"session",38:"isAnonymous",39:"tags",40:"notifyTargetTags",41:"loginAuthType",42:"loginExt",43:"loc_x",44:"loc_y",45:"loc_z",46:"distance",47:"antiSpamBusinessId",_21_safe:"_chatroomAvatar_safe"},chatroom:{1:"id",3:"name",4:"announcement",5:"broadcastUrl",12:"custom",14:"createTime",15:"updateTime",16:"queuelevel",100:"creator",101:"onlineMemberNum",102:"mute"},msg:{1:"idClient",2:"type",3:"attach",4:"custom",5:"resend",6:"userUpdateTime",7:"fromNick",8:"fromAvatar",9:"fromCustom",10:"yidunEnable",11:"antiSpamContent",12:"skipHistory",13:"body",14:"antiSpamBusinessId",15:"clientAntiSpam",16:"antiSpamUsingYidun",20:"time",21:"from",22:"chatroomId",23:"fromClientType",25:"highPriority",27:"callbackExt",28:"subType",29:"yidunAntiCheating",30:"env",31:"notifyTargetTags",32:"yidunAntiSpamExt",33:"yidunAntiSpamRes",34:"loc_x",35:"loc_y",36:"loc_z",37:"toAccids",38:"needHighPriorityMsgAck",39:"__clientExt",_8_safe:"_fromAvatar_safe"},chatroomMember:{1:"chatroomId",2:"account",3:"type",4:"level",5:"nick",6:"avatar",7:"custom",8:"online",9:"guest",10:"enterTime",12:"blacked",13:"gaged",14:"valid",15:"updateTime",16:"tempMuted",17:"tempMuteDuration",_6_safe:"_avatar_safe"},antispamTag:{antiSpamBusinessId:1},chatroomCdnInfo:{1:"enable",2:"cdnUrls",3:"timestamp",4:"interval",5:"decryptType",6:"decryptKey",7:"timeout"},nosConfigTag:{1:"bucket",2:"cdnDomain",3:"expire",4:"objectNamePrefix"},updateTags:{1:"currentTags"}}},function(t,r,e){t.exports=e(785)},function(t,r){t.exports=function(e,n){(n==null||n>e.length)&&(n=e.length);for(var o=0,s=new Array(n);o<n;o++)s[o]=e[o];return s},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(789)},function(t,r,e){var n=e(307),o=e(747),s=e(746);t.exports=function(a,i){var u;if(a){if(typeof a=="string")return s(a,i);var c=n(u=Object.prototype.toString.call(a)).call(u,8,-1);return c==="Object"&&a.constructor&&(c=a.constructor.name),c==="Map"||c==="Set"?o(a):c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?s(a,i):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(793)},function(t,r,e){var n=e(5),o=e(41),s=e(0),a=s.notundef,i={addFriend:1,applyFriend:2,passFriendApply:3,rejectFriendApply:4},u={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"};function c(d){s.verifyOptions(d,"account","friend::Friend"),s.verifyParamAtLeastPresentOne(d,"alias custom","friend::Friend"),this.account=d.account,a(d.alias)&&(this.alias=d.alias),a(d.custom)&&(this.custom=d.custom)}c.reverse=function(d){var m=s.filterObj(d,"account alias custom createTime updateTime serverex");return a(d.flag)&&(m.valid=d.flag==="1"),a(m.createTime)&&(m.createTime=+m.createTime),a(m.updateTime)&&(m.updateTime=+m.updateTime),m},c.validTypes=function(){return n(i)},c.getByteFromType=function(d){return i[d]},c.getTypeFromByte=function(d){return u[d]},c.assembleFriend=function(d){var m=+new Date;return o({},d,{alias:"",createTime:m,custom:"",updateTime:m,valid:!0})},t.exports=c},function(t,r,e){var n=e(752),o=e(41),s=e(0),a=s.notundef;function i(u,c){n(u.body)||s.onParamError("body只能是整数",c),this.body=u.body,this.from=u.from||"",this.custom=u.custom||"",a(u.pushTitle)&&(this.pushTitle=u.pushTitle),a(u.apnsText)&&(this.apnsText=u.apnsText),a(u.pushPayload)&&(this.pushPayload=u.pushPayload),a(u.needPush)&&(this.needPush=u.needPush===!0?1:0),a(u.needBadge)&&(this.needBadge=u.needBadge===!0?1:0)}i.reverse=function(u){var c=o({},u);return a(u.needBadge)&&(c.needBadge=+u.needBadge==1),a(u.needPush)&&(c.needPush=+u.needPush==1),c.body=+u.body,c.time=+u.time,c},t.exports=i},function(t,r,e){t.exports=e(811)},function(t,r,e){var n=e(752),o=e(41),s=e(0);function a(i,u){n(i.type)||s.onParamError("Collect.type只能是整数",u),s.notundef(i.uniqueId)&&(this.uniqueId=i.uniqueId),this.type=i.type,this.data=i.data||"",this.custom=i.custom||""}a.reverse=function(i){var u=o({},i);return u.type=+u.type,u.createTime=+u.createTime,u.updateTime=+u.updateTime,u},t.exports=a},function(t,r,e){var n=e(819),o=e(820),s=e(748),a=e(821);t.exports=function(i,u){return n(i)||o(i,u)||s(i,u)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(756),o=e(757),s=e(758),a=e(759);function i(d,m,v){var g=d;return o(m)?(v=m,typeof d=="string"&&(g={uri:d})):g=a(m,{uri:d}),g.callback=v,g}function u(d,m,v){return c(m=i(d,m,v))}function c(d){if(d.callback===void 0)throw new Error("callback argument missing");var m=!1,v=function(ze,le,de){m||(m=!0,d.callback(ze,le,de))};function g(){var ze=void 0;if(ze=A.response?A.response:A.responseText||function(le){try{if(le.responseType==="document")return le.responseXML;var de=le.responseXML&&le.responseXML.documentElement.nodeName==="parsererror";if(le.responseType===""&&!de)return le.responseXML}catch{}return null}(A),re)try{ze=JSON.parse(ze)}catch{}return ze}function b(ze){return clearTimeout(V),ze instanceof Error||(ze=new Error(""+(ze||"Unknown XMLHttpRequest Error"))),ze.statusCode=0,v(ze,ue)}function T(){if(!y){var ze;clearTimeout(V),ze=d.useXDR&&A.status===void 0?200:A.status===1223?204:A.status;var le=ue,de=null;return ze!==0?(le={body:g(),statusCode:ze,method:ae,headers:{},url:he,rawRequest:A},A.getAllResponseHeaders&&(le.headers=s(A.getAllResponseHeaders()))):de=new Error("Internal XMLHttpRequest Error"),v(de,le,le.body)}}var k,y,A=d.xhr||null;A||(A=d.cors||d.useXDR?new u.XDomainRequest:new u.XMLHttpRequest);var V,he=A.url=d.uri||d.url,ae=A.method=d.method||"GET",Ne=d.body||d.data,_e=A.headers=d.headers||{},Ce=!!d.sync,re=!1,ue={body:void 0,headers:{},statusCode:0,method:ae,url:he,rawRequest:A};if("json"in d&&d.json!==!1&&(re=!0,_e.accept||_e.Accept||(_e.Accept="application/json"),ae!=="GET"&&ae!=="HEAD"&&(_e["content-type"]||_e["Content-Type"]||(_e["Content-Type"]="application/json"),Ne=JSON.stringify(d.json===!0?Ne:d.json))),A.onreadystatechange=function(){A.readyState===4&&setTimeout(T,0)},A.onload=T,A.onerror=b,A.onprogress=function(){},A.onabort=function(){y=!0},A.ontimeout=b,A.open(ae,he,!Ce,d.username,d.password),Ce||(A.withCredentials=!!d.withCredentials),!Ce&&d.timeout>0&&(V=setTimeout(function(){if(!y){y=!0,A.abort("timeout");var ze=new Error("XMLHttpRequest timeout");ze.code="ETIMEDOUT",b(ze)}},d.timeout)),A.setRequestHeader)for(k in _e)_e.hasOwnProperty(k)&&A.setRequestHeader(k,_e[k]);else if(d.headers&&!function(ze){for(var le in ze)if(ze.hasOwnProperty(le))return!1;return!0}(d.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in d&&(A.responseType=d.responseType),"beforeSend"in d&&typeof d.beforeSend=="function"&&d.beforeSend(A),A.send(Ne||null),A}t.exports=u,t.exports.default=u,u.XMLHttpRequest=n.XMLHttpRequest||function(){},u.XDomainRequest="withCredentials"in new u.XMLHttpRequest?u.XMLHttpRequest:n.XDomainRequest,function(d,m){for(var v=0;v<d.length;v++)m(d[v])}(["get","put","post","patch","head","delete"],function(d){u[d==="delete"?"del":d]=function(m,v,g){return(v=i(m,v,g)).method=d.toUpperCase(),c(v)}})},function(t,r,e){(function(n){var o;o=typeof window<"u"?window:n!==void 0?n:typeof self<"u"?self:{},t.exports=o}).call(this,e(56))},function(t,r){t.exports=function(n){if(!n)return!1;var o=e.call(n);return o==="[object Function]"||typeof n=="function"&&o!=="[object RegExp]"||typeof window<"u"&&(n===window.setTimeout||n===window.alert||n===window.confirm||n===window.prompt)};var e=Object.prototype.toString},function(t,r){var e=function(n){return n.replace(/^\s+|\s+$/g,"")};t.exports=function(n){if(!n)return{};for(var o,s={},a=e(n).split(`
`),i=0;i<a.length;i++){var u=a[i],c=u.indexOf(":"),d=e(u.slice(0,c)).toLowerCase(),m=e(u.slice(c+1));s[d]===void 0?s[d]=m:(o=s[d],Object.prototype.toString.call(o)==="[object Array]"?s[d].push(m):s[d]=[s[d],m])}return s}},function(t,r){t.exports=function(){for(var n={},o=0;o<arguments.length;o++){var s=arguments[o];for(var a in s)e.call(s,a)&&(n[a]=s[a])}return n};var e=Object.prototype.hasOwnProperty},function(t,r,e){var n=e(25),o=e(123),s=e(7),a=e(10);function i(u){var c=this,d=u.url||null;c.level={debug:0,log:1,info:2,warn:3,error:4}[u.level]||0,c.logCache=[],c.logNum=1,c.timeInterval=5e3,window.onerror=function(m,v,g,b,T){c.error(T)},o(function(){c.logCache.length>0&&d&&c.postLogs(d,c.logCache)},c.timeInterval)}i.prototype.debug=function(){var u;this.level>0||(console.debug.apply(this,arguments),this.cacheLogs.apply(this,s(u=["[degbug]"]).call(u,arguments)))},i.prototype.log=function(){var u;this.level>1||(console.log.apply(this,arguments),this.cacheLogs.apply(this,s(u=["[log]"]).call(u,arguments)))},i.prototype.info=function(){var u;this.level>2||(console.info.apply(this,arguments),this.cacheLogs.apply(this,s(u=["[info]"]).call(u,arguments)))},i.prototype.warn=function(){var u;this.level>3||(console.warn.apply(this,arguments),this.cacheLogs.apply(this,s(u=["[warn]"]).call(u,arguments)))},i.prototype.error=function(){var u;this.level>4||(console.error.apply(this,arguments),this.cacheLogs.apply(this,s(u=["[error]"]).call(u,arguments)))},i.prototype.cacheLogs=function(u,c){for(var d=[],m=0;m<c.length;m++){var v=c[m];n(v)==="object"?d.push(a(v)):d.push(v)}var g=this.logNum+++" "+u+" "+d.join("; ");this.logCache.push(g.replace("%c",""))},i.prototype.postLogs=function(u,c){var d=this,m=new XMLHttpRequest;m.onreadystatechange=function(){m.readyState===4&&(m.status===200?(console.info("LoggerPlugin::日志上报完成"),d.logCache=[],d.timeInterval=5e3):d.timeInterval+=5e3)},m.open("POST",u),m.setRequestHeader("Content-Type","plain/text;charset=utf-8"),m.timeout=360,m.send(c.join(`
`))},t.exports=i},function(t,r,e){var n=e(3),o=e(44);t.exports=function(s){var a,i,u,c;s.db&&(o.db=s.db),s.rnfs&&(o.rnfs=s.rnfs,o.rnfs.size||(o.rnfs.size=1048576),o.rnfs.nimPromise=(a=o.rnfs,i=a.size/2-256,c=0,u=o.rnfs.DocumentDirectoryPath+"/nimlog_"+c+".log",a.exists(u).then(function(d){return d?a.stat(u):n.reject(0)}).then(function(d){return d&&d.size>i?n.reject(1):n.reject(0)}).catch(function(d){return typeof d=="number"&&(a.nimIndex=d),n.resolve()})))}},function(t,r,e){var n=e(52),o=e(0),s=o.notundef,a=o.undef;function i(u){s(u.name)&&(this.name=""+u.name),s(u.announcement)&&(this.announcement=""+u.announcement),s(u.broadcastUrl)&&(this.broadcastUrl=""+u.broadcastUrl),s(u.custom)&&(this.custom=""+u.custom),s(u.queuelevel)&&(this.queuelevel=n(u.queuelevel))}i.reverse=function(u){var c=o.copy(u);return a(c.announcement)&&(c.announcement=""),a(c.broadcastUrl)&&(c.broadcastUrl=""),a(c.custom)&&(c.custom=""),s(c.createTime)&&(c.createTime=+c.createTime),s(c.updateTime)&&(c.updateTime=+c.updateTime),s(c.onlineMemberNum)&&(c.onlineMemberNum=+c.onlineMemberNum),s(c.mute)&&(c.mute=c.mute==="1"),c},t.exports=i},function(t,r,e){var n,o,s;t.exports=(s=e(89),o=(n=s).lib.WordArray,n.enc.Base64={stringify:function(a){var i=a.words,u=a.sigBytes,c=this._map;a.clamp();for(var d=[],m=0;m<u;m+=3)for(var v=(i[m>>>2]>>>24-m%4*8&255)<<16|(i[m+1>>>2]>>>24-(m+1)%4*8&255)<<8|i[m+2>>>2]>>>24-(m+2)%4*8&255,g=0;g<4&&m+.75*g<u;g++)d.push(c.charAt(v>>>6*(3-g)&63));var b=c.charAt(64);if(b)for(;d.length%4;)d.push(b);return d.join("")},parse:function(a){var i=a.length,u=this._map,c=this._reverseMap;if(!c){c=this._reverseMap=[];for(var d=0;d<u.length;d++)c[u.charCodeAt(d)]=d}var m=u.charAt(64);if(m){var v=a.indexOf(m);v!==-1&&(i=v)}return function(g,b,T){for(var k=[],y=0,A=0;A<b;A++)if(A%4){var V=T[g.charCodeAt(A-1)]<<A%4*2,he=T[g.charCodeAt(A)]>>>6-A%4*2,ae=V|he;k[y>>>2]|=ae<<24-y%4*8,y++}return o.create(k,y)}(a,i,c)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},s.enc.Base64)},function(t,r,e){var n,o,s,a,i,u,c,d;t.exports=(d=e(89),e(888),e(889),o=(n=d).lib,s=o.Base,a=o.WordArray,i=n.algo,u=i.MD5,c=i.EvpKDF=s.extend({cfg:s.extend({keySize:4,hasher:u,iterations:1}),init:function(m){this.cfg=this.cfg.extend(m)},compute:function(m,v){for(var g,b=this.cfg,T=b.hasher.create(),k=a.create(),y=k.words,A=b.keySize,V=b.iterations;y.length<A;){g&&T.update(g),g=T.update(m).finalize(v),T.reset();for(var he=1;he<V;he++)g=T.finalize(g),T.reset();k.concat(g)}return k.sigBytes=4*A,k}}),n.EvpKDF=function(m,v,g){return c.create(g).compute(m,v)},d.EvpKDF)},function(t,r,e){e(297);var n=e(39);e(309)(n),t.exports=n},function(t,r,e){var n=e(52),o=e(3),s=e(15),a=e(10),i=e(2),u=e(7),c=e(304),d=e(8),m=e(17),v=e(74),g=e(197),b=e(302),T=e(767),k=e(0),y=e(305),A=e(40),V=A.newSupportDBError,he=A.noDBError,ae=!1;function Ne(re){ae=re,y.set("db",re,b)}if(Ne(!!k.getGlobal().indexedDB),v.name==="IE"&&Ne(!1),v.name==="Microsoft Edge"&&Ne(!1),v.name==="Safari")try{n(v.version.split(".")[0],10)<10&&Ne(!1)}catch{}function _e(re){this.concurrency=0,this.pendingTasks=[],this.queue=o.resolve(),this.logger=re.logger,this.reporter=re.reporter,this.core=re.core,this.account=re.account,this.notifyError=re.notifyError}var Ce=_e.prototype;Ce.reset=k.emptyFunc,ae&&(Ce.reset=function(re){this.enable=re!==!1}),Ce.addTask=function(re){var ue=this;return new o(function(ze,le){function de(Ie){ue.concurrency--;var ie=ue.pendingTasks.shift();ie&&ue.addTask(ie),Ie()}if(ue.concurrency<100)return ue.concurrency++,re().then(function(Ie){de(function(){ze(Ie),re.resolve&&re.resolve(Ie)})},function(Ie){de(function(){var ie=(Ie=Ie||{}).event||Ie,Ve={event:ie,callFunc:Ie.callFunc||"db::addTask"};ue.logger.error("db::error event is",ie,k.get(ie,"target.error")),le(Ve),re.reject&&re.reject(Ve)})});re.resolve||(re.resolve=ze,re.reject=le),ue.pendingTasks.push(re)})},Ce.reportError=function(re){var ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ze=arguments.length>2?arguments[2]:void 0;this.reporter.reportTraceStart("exceptions",{user_id:this.account,trace_id:k.get(this.core,"socket.socket.sessionid"),action:4,exception_service:0});var le,de=ue.context||"";if(ze)try{var Ie;le=s(Ie=a(ze)).call(Ie,0,100),de+=". ".concat(le)}catch{le=""}var ie=k.get(re,"code")||k.get(re,"target.error.code")||0,Ve=k.get(re,"message")||k.get(re,"target.error.message")||"unknown";this.reporter.reportTraceUpdateV2("exceptions",{code:ie,description:Ve,operation_type:ue.operation_type,target:ue.target||this.name,context:de}),this.reporter.reportTraceEnd("exceptions",1)},Ce.init=function(re){var ue=this;return ue.addTask(function(){return ue.enable?ue.server?o.resolve():(ue.name="nim-"+re,b.open({server:ue.name,version:T.version,schema:T.schema}).then(function(ze){ue.logger.info("db::init: ".concat(ue.name)),ue.server=ze},function(ze){throw Ne(!1),ue.server=null,ue.name=null,ze}).catch(function(ze){throw ue.reportError(ze,{operation_type:0,context:"version ".concat(T.version),target:"nim-"+re}),ze})):o.reject(V({callFunc:"db::init"}))})},Ce.destroy=function(){var re=this;return re.addTask(function(){if(!re.enable)return o.reject(V({callFunc:"db::destroy"}));if(!re.server)return o.resolve();try{return b.remove(re.name).then(function(){re.logger.info("db::destroy: ".concat(re.name)),re.server=null,re.name=null}).catch(function(ue){throw re.reportError(ue,{operation_type:1,context:"remove database failed"}),ue})}catch(ue){throw re.reportError(ue,{operation_type:1,context:"remove database failed"}),ue}})},Ce.clear=function(){var re=this;return re.addTask(function(){return re.enable?re.server?re.server.clear("timetag").then(function(){var ue=s([]).call(re.server.getIndexedDB().objectStoreNames),ze=[];if(i(ue).call(ue,function(le){ze.push(re.server.clear(le).catch(function(de){throw re.reportError(de,{operation_type:3,context:"tableName: ".concat(le,". clear table failed")}),de}))}),ze.length)return o.all(ze).then(function(){re.logger.info("db::clear: ".concat(re.name))}).catch(function(le){return re.logger.error("db::clear: ",le),o.reject(le)})}):o.resolve():o.reject(V({callFunc:"db::clear"}))})},Ce.close=function(){this.server&&(this.server.close(),this.server=null,this.name=null)},Ce.remove=function(re,ue,ze,le,de,Ie,ie){var Ve=this;return Ve.addTask(function(){Ve.checkDB();try{return Ve.server.remove(re,ue,ze,le,de,Ie,ie).then(function(){var Ue;Ve.logger.info(u(Ue="db::delete: ".concat(re," ")).call(Ue,ue||ze))}).catch(function(Ue){throw Ve.reportError(Ue,{operation_type:3,context:"tableName: ".concat(re,", remove failed")},{name:re,keys:ue,keyName:ze,lowerBound:le,upperBound:de,lowerOpen:Ie,upperOpen:ie}),Ve.logger.error("db::remove::server.remove error",Ue),Ue})}catch(Ue){throw Ve.reportError(Ue,{operation_type:3,context:"tableName: ".concat(re,", remove failed")},{name:re,keys:ue,keyName:ze,lowerBound:le,upperBound:de,lowerOpen:Ie,upperOpen:ie}),Ve.logger.error("db::remove::server.remove error",Ue),Ue}})},Ce.put=function(re,ue){var ze=this;return ze.addTask(function(){ze.checkDB(),k.isArray(ue)||(ue=[ue]);try{return ze.server.update(re,ue).then(function(le){var de=[re],Ie=T.keyPath(re),ie=[];return Ie&&(i(le).call(le,function(Ve){ie.push(g(Ve,Ie))}),de.push(ie.length===1?ie[0]:ie)),de.unshift("db::put:"),re==="timetag"&&de.push(le[0]),ze.logger.log.apply(ze.logger.log,de),le}).catch(function(le){throw ze.reportError(le,{operation_type:3,context:"tableName: ".concat(re,". put failed")},ue),le})}catch(le){throw ze.reportError(le,{operation_type:3,context:"tableName: ".concat(re,". put failed")},ue),le}})},Ce.get=function(re,ue){var ze=this;return ze.addTask(function(){ze.checkDB();try{return ze.server.get(re,ue).catch(function(de){var Ie;throw ze.reportError(de,{operation_type:3,context:u(Ie="tableName: ".concat(re,". get failed with key ")).call(Ie,ue)}),de})}catch(de){var le;throw ze.reportError(de,{operation_type:3,context:u(le="tableName: ".concat(re,". get failed with key ")).call(le,ue)}),de}})},Ce.modifyOrPut=function(re){var ue=this,ze=re.table,le=k.copy(re.obj),de=re.key,Ie=re.modifyObjWhenPut,ie=k.copy(le);return delete ie[de],ue.getOne(ze,null,le[de],{modifyObj:ie}).then(function(Ve){return Ve?(ie.idClient?ie={idClient:ie.idClient,server:ie.server,pinFrom:ie.pinFrom}:(ie.lastMsg=ie.lastMsg&&ie.lastMsg.idServer+"_"+ie.lastMsg.idClient,ie.localCustom=ie.localCustom&&"***",ie.topCustom=ie.topCustom&&"***"),ue.logger.log("db::modifyOrPut: update table ".concat(ze),ie),Ve):(le=k.merge(le,Ie),ue.put(ze,le).then(function(Ue){return Ue[0]}))})},Ce.updateAndDelete=function(re,ue,ze){var le=this;return le.addTask(function(){le.checkDB();try{return le.server.updateAndDelete(re,ue,ze).catch(function(de){throw le.reportError(de,{operation_type:3,context:"tableName: ".concat(re,". updateAndDelete failed")},{updates:ue,deletes:ze}),de})}catch(de){throw le.reportError(de,{operation_type:3,context:"tableName: ".concat(re,". updateAndDelete failed")},{updates:ue,deletes:ze}),de}})},Ce.getAll=function(re,ue){var ze=this;return ze.addTask(function(){ze.checkDB(),(ue=ue||{}).keys=c(ue)===!0,ue.desc=ue.desc===!0,ue.distinct=ue.distinct===!0;try{var le,de,Ie;return d(le=c(de=m(Ie=ze.server.query(re,ue.index)).call(Ie,m(ue))).call(de,c(ue)).desc(ue.desc).limit(ue.limit).distinct(ue.distinct)).call(le,ue.mapper).modify(ue.modifyObj).execute().catch(function(ie){throw ze.reportError(ie,{operation_type:3,context:"tableName: ".concat(re,". getAll failed")},ue),ie})}catch(ie){throw ze.reportError(ie,{operation_type:3,context:"tableName: ".concat(re,". getAll failed")},ue),ie}})},Ce.getOnly=function(re,ue,ze,le){var de=this;return de.addTask(function(){de.checkDB(),(le=le||{}).keys=c(le)===!0,le.desc=le.desc===!0,le.distinct=le.distinct===!0,le.remove=le.remove===!0;try{var Ie,ie,Ve;return d(Ie=c(ie=m(Ve=de.server.query(re,ue).only(ze)).call(Ve,m(le))).call(ie,c(le)).desc(le.desc).limit(le.limit).distinct(le.distinct)).call(Ie,le.mapper).modify(le.modifyObj).remove(le.remove).execute().catch(function(tr){var dr,fr;throw de.reportError(tr,{operation_type:3,context:u(dr=u(fr="tableName: ".concat(re,". getOnly failed with index: ")).call(fr,ue,", matchValue: ")).call(dr,ze)},le),tr})}catch(tr){var Ue,Dt;throw de.reportError(tr,{operation_type:3,context:u(Ue=u(Dt="tableName: ".concat(re,". getOnly failed with index: ")).call(Dt,ue,", matchValue: ")).call(Ue,ze)},le),tr}})},Ce.getOne=function(){var re=this;return re.getOnly.apply(re,arguments).then(function(ue){return ue[0]})},Ce.clearTable=function(re){var ue=this;return ue.addTask(function(){ue.checkDB();try{return ue.server.clear(re).catch(function(ze){throw ue.reportError(ze,{operation_type:3,context:"tableName: ".concat(re,". clearTable failed")},options),ze})}catch(ze){throw ue.reportError(ze,{operation_type:3,context:"tableName: ".concat(re,". clearTable failed")},options),ze}})},Ce.checkDB=function(){if(!this.enable)throw V({callFunc:"db::checkDB"});if(!this.server)throw he({callFunc:"db::checkDB"})},t.exports=_e},function(t,r){var e={version:12},n={kv:{key:{keyPath:"key"}},timetag:{key:{keyPath:"name"}},sessionsWithMoreRoaming:{key:{keyPath:"id"}},msgReadDetail:{key:{keyPath:"idClient"}},blacklist:{key:{keyPath:"account"}},mutelist:{key:{keyPath:"account"}},friend:{key:{keyPath:"account"}},user:{key:{keyPath:"account"}},team:{key:{keyPath:"teamId"}},teamMember:{key:{keyPath:"id"},indexes:{teamId:{unique:!1},account:{unique:!1}}},superTeam:{key:{keyPath:"teamId"}},superTeamMember:{key:{keyPath:"id"},indexes:{teamId:{unique:!1},account:{unique:!1},id:{unique:!1}}},msg:{key:{autoIncrement:!0},indexes:{idClient:{unique:!0},sessionId:{unique:!1},time:{unique:!1},type:{unique:!1},sessionType:{unique:!1},status:{unique:!1},sessionTime:{key:["sessionId","time"],unique:!1}}},msg1:{key:{keyPath:"idClient"},indexes:{sessionId:{unique:!1},time:{unique:!1},status:{unique:!1},sessionTime:{key:["sessionId","time"],unique:!1}}},msgPin:{key:{keyPath:"idClient"},indexes:{sessionId:{unique:!1}}},broadcastMsg:{key:{keyPath:"broadcastId"},indexes:{time:{unique:!1}}},sysMsg:{key:{autoIncrement:!0},indexes:{idServer:{unique:!0},category:{unique:!1},type:{unique:!1}}},sysMsgUnread:{key:{keyPath:"type"}},session:{key:{keyPath:"id"},indexes:{updateTime:{unique:!1}}}};e.keyPath=function(o){return n[o].key.keyPath},e.schema=function(){return window._nimForceSyncIM=!0,n},t.exports=e},function(t,r,e){var n=e(71).fn;n.setKey=function(o,s){return this.put("kv",{key:o,value:s})},n.getKey=function(o){return this.get("kv",o).then(function(s){return s&&s.value})},n.setDonnop=function(o){return this.setKey("donnop",o)},n.getDonnop=function(){return this.getKey("donnop")}},function(t,r,e){var n=e(6),o=e(52),s=e(71).fn;s.getTimetags=function(a){var i={};return this.getAll("timetag",{filter:a,mapper:function(u){var c;return n(c=u.name).call(c,"team-")!==-1?i[u.name]=0:i[u.name]=u.value,u}}).then(function(){return i})},s.getTeamMemberTimetags=function(){return this.getTimetags(function(a){var i;return n(i=a.name).call(i,"team-")!==-1})},s.getTimetag=function(a){return this.getOne("timetag",null,a).then(function(i){return(i=i||{value:0}).value})},s.getTeamMemberTimetag=function(){return 0},s.updateTimetag=function(a,i){var u=this,c={name:a,value:i};return this.put("timetag",c).catch(function(d){u.notifyError&&u.notifyError(d)})},s.updateMyInfoTimetag=function(a){return this.updateTimetag("myInfo",a)},s.updateRelationTimetag=function(a){return this.updateTimetag("relations",a)},s.getRelationsTimetag=function(){return this.getTimetag("relations")},s.updateFriendTimetag=function(a){return this.updateTimetag("friends",a)},s.getFriendsTimetag=function(){return this.getTimetag("friends")},s.updateFriendUserTimetag=function(a){return this.updateTimetag("friendUsers",a)},s.updateTeamTimetag=function(a){return this.updateTimetag("teams",a)},s.getTeamsTimetag=function(){return this.getTimetag("teams")},s.updateSuperTeamTimetag=function(a){return this.updateTimetag("superTeams",a)},s.getSuperTeamsTimetag=function(){return this.getTimetag("superTeams")},s.updateTeamMemberTimetag=function(a,i){return this.updateTimetag("team-"+a,i)},s.getTeamMembersTimetag=function(a){return this.getTimetag("team-"+a)},s.updateSuperTeamMemberTimetag=function(a,i){return this.updateTimetag("superTeam-"+a,i)},s.getSuperTeamMembersTimetag=function(a){return this.getTimetag("superTeam-"+a)},s.updateMyTeamMembersTimetag=function(a){return this.updateTimetag("myTeamMembers",a)},s.updateMySuperTeamMembersTimetag=function(a){return this.updateTimetag("myInfoInSuperTeams",a)},s.getBroadcastMsgTimetag=function(){return this.getTimetag("broadcastMsg")},s.updateBroadcastMsgTimetag=function(a){return this.updateTimetag("broadcastMsg",o(a))},s.updateRoamingMsgTimetag=function(a){return this.updateTimetag("roamingMsgs",a)},s.updateSuperTeamRoamingMsgTimetag=function(a){return this.updateTimetag("superTeamRoamingMsgs",a)},s.updateMsgReceiptsTimetag=function(a){return this.updateTimetag("msgReceipts",a)},s.updateDonnopTimetag=function(a){return this.updateTimetag("donnop",a)},s.updateSessionAck=function(a){return this.updateTimetag("sessionAck",a)},s.updateDeleteMsgSelf=function(a){return this.updateTimetag("deleteMsgSelf",a)},s.updateSuperTeamSessionAck=function(a){return this.updateTimetag("superTeamSessionAck",a)},s.deleteTimetag=function(a){return this.remove("timetag",a)},s.deleteTeamMemberTimetag=function(a){return this.deleteTimetag("team-"+a)},s.deleteSuperTeamMemberTimetag=function(a){return this.deleteTimetag("superTeam-"+a)}},function(t,r,e){var n=e(3),o=e(71).fn,s=e(0);o.mergeRelations=function(a,i,u,c,d){var m=this,v=m.updateAndDelete("blacklist",a,i),g=m.updateAndDelete("mutelist",u,c);return n.all([v,g]).then(function(){return m.logger.info("db::mergeRelations: timetag ".concat(d)),m.updateRelationTimetag(d),[a,i,u,c,d]})},o.getRelations=function(){var a=this.getAll("blacklist"),i=this.getAll("mutelist");return n.all([a,i])},o.markInBlacklist=function(a){if((a=s.copy(a)).isAdd){var i=a.record;return this.put("blacklist",i)}var u=a.account;return this.remove("blacklist",u)},o.markInMutelist=function(a){if((a=s.copy(a)).isAdd){var i=a.record;return this.put("mutelist",i)}var u=a.account;return this.remove("mutelist",u)}},function(t,r,e){var n=e(8),o=e(3),s=e(71).fn,a=e(0);s.mergeFriends=function(i,u,c){var d=this;return d.updateAndDelete("friend",i,u).then(function(){return d.logger.log("db::mergeFriends: updateAndDelete done",i&&n(i).call(i,function(m){return m.account}).join(",")),c&&d.updateFriendTimetag(c),[i,u,c]})},s.putFriend=function(i){return this.put("friend",i)},s.updateFriend=function(i){var u=this,c=(i=a.copy(i)).account;return this.getOne("friend",null,c,{modifyObj:i}).then(function(d){return d?u.logger.log("db::updateFriend: ".concat(c)):u.logger.warn("db::updateFriend: no record ".concat(c)),d})},s.deleteFriend=function(i){var u=this.remove("friend",i),c=this.deleteUser(i);return o.all([u,c])},s.getFriends=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=function(c){return i.updateTime!==void 0?c.valid&&c.updateTime>i.updateTime:c.valid};return this.getAll("friend",{filter:u})},s.getFriend=function(i){return this.getOne("friend",null,i)},s.getUserFromBlackList=function(i){return this.getOne("blacklist",null,i)}},function(t,r,e){var n=e(3),o=e(2),s=e(7),a=e(8),i=e(71).fn,u=e(0),c=e(40),d=e(191),m=e(150);function v(T){return T.valid&&T.validToCurrentUser}function g(T){return T&&T.valid}function b(T){return T&&u.fillUndef(T,{mute:!1,custom:""}),T}i.mergeTeams=function(T,k,y){var A=this,V=A.put("team",T),he=A.leaveTeams(k,y);return n.all([V,he]).then(function(){return A.logger.log("db::mergeTeams:"),A.updateTeamTimetag(y),[T,k,y]})},i.putTeam=function(T){if(T)return u.isArray(T)||(T=[T]),o(T).call(T,function(k){k.validToCurrentUser=!0}),this.put("team",T)},i.updateTeam=function(T){var k=this,y=(T=u.copy(T)).teamId;return k.getOne("team",null,y,{modifyObj:T}).then(function(A){if(A)k.logger.log("db::updateTeam: ".concat(y));else if(k.logger.warn("db::updateTeam: no record ".concat(y)),T.validToCurrentUser)return k.putTeam(T);return A})},i.transferTeam=function(T,k,y){var A=this,V=T.teamId,he=T.memberUpdateTime,ae={teamId:V,account:k,type:"normal",updateTime:he},Ne={teamId:V,account:y,type:"owner",updateTime:he};return A.updateTeamMembers([ae,Ne]).then(function(){return A.putTeam(T).then(function(){var _e,Ce;return A.logger.info(s(_e=s(Ce="db::transferTeam: ".concat(T.teamId," ")).call(Ce,k," -> ")).call(_e,y)),[T,k,y]})})},i.leaveTeam=function(T){var k=this;return k.updateTeam({teamId:T,validToCurrentUser:!1}).then(function(){return k.removeAllTeamMembers(T)})},i.dismissTeam=function(T,k){var y=this,A={teamId:T,valid:!1,validToCurrentUser:!1,updateTime:k};return y.updateTeam(A).then(function(){return y.removeAllTeamMembers(T)})},i.leaveTeams=function(T,k){var y,A=this,V=[];return o(T).call(T,function(he){y=A.leaveTeam(he.teamId,k),V.push(y)}),n.all(V)},i.getTeamsByTeamIds=function(T){var k,y=this,A=[];return o(T).call(T,function(V){k=y.getTeam(V),A.push(k)}),n.all(A)},i.getTeam=function(T){T=""+T;var k=this;return k.getOne("team",null,T).then(function(y){return y?(k.updateTeamProperties([y]),y):null})},i.getTeams=function(){var T=this;return T.getAll("team",{filter:v}).then(function(k){return T.updateTeamProperties(k),k})},i.updateTeamProperties=function(T){o(T).call(T,function(k){k&&d.fillProperties(k)})},i.mergeTeamMembers=function(T,k,y,A){var V=this,he=V.putTeamMembers(k),ae=V.updateTeamMembers(y);return n.all([he,ae]).then(function(){return V.logger.log("db::mergeTeamMembers: ".concat(T)),V.updateTeamMemberTimetag(T,A)})},i.putTeamMembers=function(T){return this.put("teamMember",T)},i.getTeamMembersByAccount=function(T){return this.getOnly("teamMember","account",T,{filter:g,mapper:b}).then()},i.getTeamMembers=function(T){var k=this;return T=""+T,k.getOnly("teamMember","teamId",T,{filter:function(y){return y.valid},mapper:b}).then(function(y){return k.updateTeamMemberProperties(y).then(function(){return y})})},i.updateTeamMemberProperties=function(T){var k,y=this,A=[];return o(T).call(T,function(V){m.fillProperties(V)&&(k=y.updateTeamMember(V),A.push(k))}),n.all(A)},i.getInvalidTeamMembers=function(T,k){var y=this;T=""+T;var A,V=[];return o(k).call(k,function(he){A=y.getOne("teamMember",null,m.genId(T,he)).then(function(ae){return b(ae)}),V.push(A)}),n.all(V)},i.updateTeamMember=function(T){var k=this,y=T.teamId,A=T.account,V=m.genId(y,A),he=u.filterObj(T,"nickInTeam muteTeam mute custom updateTime type valid");return this.getOne("teamMember",null,V,{modifyObj:he,mapper:b}).then(function(ae){var Ne,_e;return ae?k.logger.log(s(Ne="db::updateTeamMember: ".concat(y," ")).call(Ne,A),u.pickAsString(he,["muteTeam","mute","updateTime","type","valid"])):k.logger.warn(s(_e="db::updateTeam: no record ".concat(y," ")).call(_e,A)),ae})},i.updateTeamMembers=function(T){var k=this;if(!T.length)return n.resolve();var y,A=[];return o(T).call(T,function(V){y=k.updateTeamMember(V),A.push(y)}),n.all(A)},i.updateTeamManagers=function(T,k,y,A){var V=a(k).call(k,function(he){return{teamId:T,account:he,type:y?"manager":"normal",updateTime:A}});return this.updateTeamMembers(V)},i.removeTeamMembersByAccounts=function(T,k){var y=a(k).call(k,function(A){return{teamId:T,account:A,valid:!1}});return this.updateTeamMembers(y)},i.removeAllTeamMembers=function(T){var k=this;return k.getOnly("teamMember","teamId",T,{modifyObj:{valid:!1}}).then(function(){return k.logger.warn("db::removeAllTeamMembers: ".concat(T)),k.deleteTeamMemberTimetag(T)})},i.deleteTeamMembers=function(T){var k=this;return k.getOnly("teamMember","teamId",T,{remove:!0}).then(function(){k.logger.warn("db::deleteTeamMembers: ".concat(T)),k.deleteTeamMemberTimetag(T)})},i.deleteTeam=function(T){var k,y=this,A=[];return u.isArray(T)||(T=[T]),o(T).call(T,function(V){V=""+V,k=y.get("team",V).then(function(he){if(he&&v(he))throw c.stillInTeamError({callFunc:"team::deleteTeam",team:he});var ae=y.remove("team",V),Ne=y.deleteTeamMembers(V);return n.all([ae,Ne])}),A.push(k)}),A.length===1?A[0]:n.all(A)}},function(t,r,e){var n=e(3),o=e(2),s=e(9),a=e(7),i=e(8),u=e(71).fn,c=e(0),d=e(40),m=e(306),v=e(201);function g(k){return k.valid&&k.validToCurrentUser}function b(k){return k&&k.valid}function T(k){return k&&c.fillUndef(k,{mute:!1,custom:""}),k}u.mergeSuperTeams=function(k,y,A){var V=this,he=V.put("superTeam",k),ae=V.leaveTeams(y,A);return n.all([he,ae]).then(function(){return V.logger.log("db::mergeSuperTeams:"),V.updateSuperTeamTimetag(A),[k,y,A]})},u.putSuperTeam=function(k){if(k)return c.isArray(k)||(k=[k]),o(k).call(k,function(y){y.validToCurrentUser=!0}),this.put("superTeam",k)},u.updateSuperTeam=function(k){var y=this,A=(k=c.copy(k)).teamId;return y.getOne("superTeam",null,A,{modifyObj:k}).then(function(V){return V?(y.logger.info("db::updateSuperTeam: ".concat(A)),V):(y.logger.warn("db::updateSuperTeam: no record ".concat(A)),y.putSuperTeam(k))})},u.leaveSuperTeam=function(k){var y=this;return y.updateSuperTeam({teamId:k,validToCurrentUser:!1}).then(function(){return y.removeAllSuperTeamMembers(k)})},u.dismissSuperTeam=function(k,y){var A=this,V={teamId:k,valid:!1,validToCurrentUser:!1,updateTime:y};return A.updateSuperTeam(V).then(function(){return A.removeAllSuperTeamMembers(k)})},u.leaveSuperTeams=function(k,y){var A,V=this,he=[];return o(k).call(k,function(ae){A=V.leaveSuperTeam(ae.teamId,y),he.push(A)}),n.all(he)},u.getSuperTeamsByTeamIds=function(k){var y,A=this,V=[];return o(k).call(k,function(he){y=A.getSuperTeam(he),V.push(y)}),n.all(V)},u.getSuperTeam=function(k){k=""+k;var y=this;return y.getOne("superTeam",null,k).then(function(A){return A?(y.updateSuperTeamProperties([A]),A):null})},u.getSuperTeams=function(){var k=this;return k.getAll("superTeam",{filter:g}).then(function(y){return k.updateSuperTeamProperties(y),y})},u.updateSuperTeamProperties=function(k){o(k).call(k,function(y){y&&m.fillProperties(y)})},u.mergeSuperTeamMembers=function(k,y,A,V){var he=this,ae=he.putSuperTeamMembers(y),Ne=he.updateSuperTeamMembers(A);return n.all([ae,Ne]).then(function(){return he.logger.log("db::mergeSuperTeamMembers: ".concat(k)),V!=null?he.updateSuperTeamMemberTimetag(k,V):n.resolve()})},u.putSuperTeamMembers=function(k){return this.put("superTeamMember",k)},u.getSuperTeamMemberById=function(k){return this.get("superTeamMember",k)},u.getSuperTeamMembers=function(k,y){var A=this;k=""+k;var V={filter:function(he){return he.valid},mapper:T};if(y){if(typeof y.joinTime!="number")return void A.logger.error("db::getSuperTeamMembers::params.joinTime should be number, not ",y.joinTime);y.limit&&(V.limit=y.limit),s(y)?V.filter=function(he){return he.valid&&he.joinTime<=y.joinTime}:V.filter=function(he){return he.valid&&he.joinTime>=y.joinTime}}return A.getOnly("superTeamMember","teamId",k,V).then(function(he){return A.updateSuperTeamMemberProperties(he).then(function(){return he})})},u.getSuperTeamMembersByAccount=function(k){return this.getOnly("superTeamMember","account",k,{filter:b,mapper:T}).then()},u.updateSuperTeamMemberProperties=function(k){var y,A=this,V=[];return o(k).call(k,function(he){v.fillProperties(he)&&(y=A.updateSuperTeamMember(he),V.push(y))}),n.all(V)},u.getInvalidSuperTeamMembers=function(k,y){var A=this;k=""+k;var V,he=[];return o(y).call(y,function(ae){V=A.getOne("superTeamMember","id",v.genId(k,ae)).then(function(Ne){return T(Ne)}),he.push(V)}),n.all(he)},u.updateSuperTeamMember=function(k){var y=this,A=k.teamId,V=k.account,he=v.genId(A,V),ae=c.filterObj(k,"nickInTeam muteTeam mute custom updateTime type valid");return this.getOne("superTeamMember","id",he,{modifyObj:ae,mapper:T}).then(function(Ne){var _e,Ce;return Ne?y.logger.log(a(_e="db::updateSuperTeamMember: ".concat(A," ")).call(_e,V),c.pickAsString(ae,["muteTeam","mute","updateTime","type","valid"])):y.logger.warn(a(Ce="db::updateSuperTeam: no record ".concat(A," ")).call(Ce,V)),Ne})},u.updateSuperTeamMembers=function(k){var y=this;if(!k.length)return n.resolve();var A,V=[];return o(k).call(k,function(he){A=y.updateSuperTeamMember(he),V.push(A)}),n.all(V)},u.removeSuperTeamMembersByAccounts=function(k,y){var A=i(y).call(y,function(V){return{teamId:k,account:V,valid:!1}});return this.updateSuperTeamMembers(A)},u.removeAllSuperTeamMembers=function(k){var y=this;return y.getOnly("superTeamMember","teamId",k,{modifyObj:{valid:!1}}).then(function(){return y.logger.warn("db::removeAllSuperTeamMembers: ".concat(k)),y.deleteSuperTeamMemberTimetag(k)})},u.deleteSuperTeamMembers=function(k){var y=this;return y.getOnly("superTeamMember","teamId",k,{remove:!0}).then(function(){y.logger.warn("db::deleteSuperTeamMembers: ".concat(k)),y.deleteSuperTeamMemberTimetag(k)})},u.deleteSuperTeam=function(k){var y,A=this,V=[];return c.isArray(k)||(k=[k]),o(k).call(k,function(he){he=""+he,y=A.get("superTeam",he).then(function(ae){if(ae&&g(ae))throw d.stillInTeamError({callFunc:"team::deleteTeam",team:ae});var Ne=A.remove("superTeam",he),_e=A.deleteSuperTeamMembers(he);return n.all([Ne,_e])}),V.push(y)}),V.length===1?V[0]:n.all(V)},u.transferSuperTeam=function(k,y,A){var V=this;return V.updateSuperTeamMembers([y,A]).then(function(){return V.putSuperTeam(k).then(function(){var he,ae;return V.logger.info(a(he=a(ae="db::transferSuperTeam: ".concat(k.teamId," ")).call(ae,y.account," -> ")).call(he,A.account)),[k,y,A]})})}},function(t,r,e){var n=e(2),o=e(3),s=e(6),a=e(71).fn,i=e(0);a.mergeMyInfo=function(u,c){var d=this;return d.put("user",u).then(function(){return c?d.updateMyInfoTimetag(u.updateTime):u})},a.mergeFriendUsers=function(u,c){var d=this;return d.putUsers(u).then(function(){d.updateFriendUserTimetag(c)})},a.putUsers=function(u){return this.put("user",u)},a.putUser=function(u){return this.put("user",u)},a.updateUser=function(u){var c=this,d=(u=i.copy(u)).account;return this.getOne("user",null,d,{modifyObj:u}).then(function(m){return m?c.logger.log("db::updateUser: ".concat(d)):c.logger.warn("db::updateUser: no record ".concat(d)),m})},a.putUsersIfIsFriend=function(u){var c,d=this,m=[],v=[];return n(u).call(u,function(g){c=d.getFriend(g.account).then(function(b){return b&&(c=d.putUser(g),v.push(c)),b}),m.push(c)}),o.all(m).then(function(){return o.all(v).then(function(g){return g})})},a.deleteUser=function(u){return this.remove("user",u)},a.getUser=function(u){return this.getOne("user",null,u)},a.getUsers=function(u){return this.getAll("user",{filter:function(c){return s(u).call(u,c.account)!==-1}})},a.getAllUsers=function(){return this.getAll("user")}},function(t,r,e){var n=e(17),o=e(3),s=e(7),a=e(2),i=e(41),u=e(32),c=e(6),d=e(8),m=e(71).fn,v=e(0),g=e(13);m.putMsg=function(b){var T=this;return v.isArray(b)||(b=[b]),!b.length||n(b[0])?o.resolve():(b=n(b).call(b,function(k){return!k.ignore}),T.put("msg1",b).catch(function(k){return T.notifyError&&T.notifyError(k),o.resolve(b,k)}))},m.putMsgReadDetail=function(b){var T=this;if(b.idClient)return this.put("msgReadDetail",b).catch(function(k){T.logger.error("putMsgReadDetail error",k)})},m.getMsgReadDetail=function(b){return this.getOne("msgReadDetail",null,b)},m.updateMsg=function(b){var T=this;if(!n(b)){var k=b.idClient,y=v.filterObj(b,"resend status idServer time localCustom commentTimetag comments hasSendAck callbackExt");return T.getOne("msg1",null,k,{modifyObj:y}).then(function(A){var V,he,ae;return A?T.logger.info(s(V=s(he=s(ae="db::updateMsg: ".concat(k,"，idServer: ")).call(ae,y.idServer,"，status: ")).call(he,y.status,"，time: ")).call(V,y.time)):T.logger.warn("db::updateMsg: no record ".concat(k)),A}).catch(function(A){return T.notifyError&&T.notifyError(A),o.resolve(b)})}},m.updateMsgBatch=function(b){var T=this;if(g.isRN)this.logger.warn("react native can not support updateMsgBatch");else{this.checkDB();var k=this.server.getIndexedDB().transaction(["msg1"],"readwrite").objectStore("msg1");a(b).call(b,function(y){if(y.idClient){var A=k.get(y.idClient);A.onerror=function(V){T.logger.error("updateMsgBatch::store.get:error",V)},A.onsuccess=function(){var V=A.result||y;k.put(i({},V,y)).onerror=function(he){T.logger.error("updateMsgBatch::store.put:error",he)}}}})}},m.getMsgs=function(b){return g.isBrowser?this.getMsgsIndexedDB(b):g.isRN?this.getMsgsRN(b):o.resolve()},m.getMsgsRN=function(b){var T={};return typeof b.start=="number"&&(T.lowerBound=["time",b.start]),typeof b.end=="number"&&b.end!==1/0&&(T.upperBound=["time",b.end]),T.desc=!1,T.index="time",typeof b.desc=="boolean"&&(T.desc=b.desc),typeof b.limit=="number"&&(T.limit=b.limit),T.searchIndex=[],b.sessionId&&T.searchIndex.push(["sessionId",b.sessionId]),typeof b.type=="string"&&T.searchIndex.push(["type",b.type]),this.getAll("msg1",T)},m.getMsgsIndexedDB=function(b){var T,k=this;k.checkDB();var y="time",A=!1,V=!1,he=(b=b||{}).sessionId||[],ae=b.sessionIds||[];v.isString(he)?he=[he]:u(he)||(he=[]),v.isString(ae)?ae=[ae]:u(ae)||(ae=[]);var Ne=s(he).call(he,ae);Ne.length===1?(A=!0,y="sessionTime",he=Ne[0]):Ne.length>1&&(A=!0,V=!0,ae=Ne);var _e=b.start||0,Ce=b.end||1/0,re=_e,ue=Ce;A&&!V&&(re=[he,_e],ue=[he,Ce]);var ze=b.desc!==!1,le=b.limit||100,de=!1,Ie=!1,ie=b.type||[],Ve=b.types||[];v.isString(ie)?ie=[ie]:u(ie)||(ie=[]),v.isString(Ve)?Ve=[Ve]:u(Ve)||(Ve=[]);var Ue=s(ie).call(ie,Ve);Ue.length===1?(de=!0,ie=Ue[0]):Ue.length>1&&(de=!0,Ie=!0,Ve=Ue);var Dt,tr=b.subTypes&&b.subTypes.length,dr=b.keyword||"",fr=b.filterFunc;return(V||de||dr||tr||v.isFunction(fr))&&(Dt=function(sr){var hr;if(V&&c(ae).call(ae,sr.sessionId)===-1)return!1;if(de){if(Ie){if(c(Ve).call(Ve,sr.type)===-1)return!1}else if(ie!==sr.type)return!1}if(tr&&c(hr=b.subTypes).call(hr,sr.subType)===-1)return!1;if(dr){var Fe=sr.text||sr.tip||"";if(c(Fe).call(Fe,dr)===-1)return!1}return!fr||fr(sr)}),n(T=k.server.query("msg1",y).bound(re,ue,!0,!0).desc(ze).limit(le)).call(T,Dt).execute().catch(function(sr){throw k.reportError(sr,{operation_type:3,context:"tableName: ".concat("msg1",", index ").concat(y,", getMsgsIndexedDB error")},b),sr})},m.getMsgCountAfterAck=function(b){return g.isBrowser?this.getMsgCountAfterAckIndexedDB(b):g.isRN?this.getMsgCountAfterAckRN(b):o.resolve()},m.getMsgCountAfterAckRN=function(b){var T=this,k=b=b||{},y=k.sessionId,A=k.ack;return T.checkDB(),T.getAll("msg1",{searchIndex:["sessionId",y],lowerBound:["time",A]}).then(function(V){var he=n(V).call(V,function(ae){if(ae.flow==="out"||ae.isUnreadable===!1)return!1;if(ae.type==="notification")try{return b.shouldCountNotifyUnread(ae)}catch(Ne){throw T.logger.error("userOption:shouldCountNotifyUnread function error",Ne),Ne}return!0});return o.resolve(he.length)})},m.getMsgCountAfterAckIndexedDB=function(b){var T=this,k=(b=b||{}).sessionId;return T.checkDB(),T.server.query("msg1","sessionTime").bound([k,b.ack],[k,1/0],!0,!0).execute().then(function(y){var A=n(y).call(y,function(V){if(V.flow==="out"||V.isUnreadable===!1)return!1;if(V.type==="notification")try{return b.shouldCountNotifyUnread(V)}catch(he){throw T.logger.error("userOption:shouldCountNotifyUnread function error",he),he}return!0});return o.resolve(A.length)}).catch(function(y){throw T.reportError(y,{operation_type:3,context:"tableName: ".concat("msg1",", IndexSessionTime ").concat("sessionTime",", getMsgCountAfterAckIndexedDB error")},b),y})},m.amendMsg=function(b){return b?(v.notexist(b.text)&&(b.text=""),b):null},m.getMsgByIdClient=function(b){var T=this;return T.getOne("msg1",null,b).then(function(k){return T.amendMsg(k)})},m.getMsgsByIdClients=function(b){var T,k=this,y=[];return a(b).call(b,function(A){T=k.getMsgByIdClient(A),y.push(T)}),o.all(y)},m.clearSendingMsgs=function(){var b=this;return b.getOnly("msg1","status","sending",{modifyObj:{status:"fail"}}).then(function(T){b.logger.info("db::clearSendingMsgs: msgs send failed",T&&d(T).call(T,function(k){return k.idClient}).join(","))})},m.deleteMsg=function(b){var T,k=this,y=[];return v.isArray(b)||(b=[b]),a(b).call(b,function(A){T=k.getOne("msg1",null,A,{remove:!0}).then(function(V){return k.logger.info("db::deleteMsg done",A,V&&V.idClient),V}).catch(function(V){throw k.logger.error("db::deleteMsg failed",A,V),V}),y.push(T)}),y.length===1?y[0]:o.all(y)},m.deleteMsgsBySessionId=function(b){var T=this,k=null,y=b.start,A=b.end;return y!==void 0&&A!==void 0?k=function(V){return V>y&&V<A}:y!==void 0?k=function(V){return V>y}:A!==void 0&&(k=function(V){return V<A}),k?T.getOnly("msg1","sessionId",b.sessionId).then(function(V){var he=[];return d(V=V||[]).call(V,function(ae){k(ae.time)&&he.push(ae.idClient)}),T.logger.info("db::deleteMsgsBySessionId: session results",he),T.deleteMsg(he)}):T.getOnly("msg1","sessionId",b.sessionId,{remove:!0})},m.deleteMsgsByTime=function(b){return this.remove("msg1",null,"time",b.start,b.end,!0,!0)},m.getDeletedMsgsCountByTime=function(b){this.checkDB();var T=this.server.getIndexedDB().transaction(["msg1"],"readonly").objectStore("msg1").index("time"),k=IDBKeyRange.bound(b.start,b.end,!0,!0),y=T.count(k);return new o(function(A,V){y.onsuccess=function(he){A(he.target.result)},y.onerror=function(he){this.logger.error("countDeletedMsgsByTime::index.count:error",he),V(he)}})},m.deleteAllMsgs=function(){var b=this.clearTable("msg1"),T=this.clearTable("session");return o.all([b,T])},m.getMsgPins=function(b){return this.getOnly("msgPin","sessionId",b)},m.deleteMsgPins=function(b){return this.getOnly("msgPin","sessionId",b,{remove:!0})},m.putMsgPin=function(b){var T=this;return this.modifyOrPut({table:"msgPin",obj:b,key:"idClient"}).catch(function(k){T.notifyError&&T.notifyError(k)})},m.putMsgPins=function(b){return this.put("msgPin",b)},m.deleteMsgPin=function(b){var T=this;return this.getOne("msgPin",null,b.idClient,{remove:!0}).then(function(k){return T.logger.info("db::deleteMsgPin:",k.idClient),k})}},function(t,r,e){var n=e(3),o=e(17),s=e(2),a=e(9),i=e(5),u=e(71).fn,c=e(0),d=c.notundef;u.putSysMsg=function(m){var v=this;return new n(function(g){if(c.isArray(m)||(m=[m]),!o(m[0])){var b=[],T=m.length;s(m).call(m,function(y){y=c.copy(y),v.put("sysMsg",y).then(function(A){b.push(A[0]),k()},k)})}function k(){--T===0&&g(b)}})},u.getSysMsgs=function(m){var v=!a(m=m||{}),g=m.limit||100,b=null,T=null;m.category&&(b="category",T=m.category),m.type&&(b="type",T=m.type);var k,y=m.lastIdServer,A=!1,V=m.read;return(d(y)||d(V))&&(k=function(he){return d(y)?(y=""+y,A?ae():(he.idServer===y&&(A=!0),!1)):ae();function ae(){return!d(V)||he.read===V}}),m={filter:k,desc:v,limit:g},b?this.getOnly("sysMsg",b,T,m):this.getAll("sysMsg",m)},u.getSysMsgByIdServer=function(m){return this.getOne("sysMsg","idServer",m)},u.updateSysMsg=function(m){var v=this;if(!o(m)){var g=""+m.idServer,b=c.filterObj(m,"read state error localCustom");return this.getOne("sysMsg","idServer",g,{modifyObj:b}).then(function(T){return T?v.logger.log("db::updateSysMsg: ".concat(g),c.pickAsString(b,["read","state","error"])):v.logger.warn("db::updateSession: ".concat(g)),T})}},u.markSysMsgRead=function(m){var v=this;return new n(function(g,b){c.isArray(m)||(m=[m]);var T,k,y=[],A=[];s(m).call(m,function(V){T=v.getSysMsgByIdServer(V.idServer).then(function(he){he&&!he.read&&(k=v.updateSysMsg({idServer:he.idServer,read:!0}),A.push(k))},b),y.push(T)}),n.all(y).then(function(){n.all(A).then(function(V){g(V)},b)},b)})},u.deleteSysMsg=function(m){var v,g=this,b=[];return c.isArray(m)||(m=[m]),s(m).call(m,function(T){T=""+T,v=g.getOne("sysMsg","idServer",T,{remove:!0}),b.push(v)}),b.length===1?b[0]:n.all(b)},u.deleteAllSysMsgs=function(){var m=this.clearTable("sysMsg"),v=this.clearTable("sysMsgUnread");return n.all([m,v])},u.getSysMsgUnread=function(){return this.getAll("sysMsgUnread").then(function(m){var v={};return s(m).call(m,function(g){v[g.type]=g.num}),v})},u.updateSysMsgUnread=function(m){var v,g=this;m=c.copy(m);var b=[];return s(v=i(m)).call(v,function(T){b.push({type:T,num:m[T]})}),this.put("sysMsgUnread",b).then(function(){return g.logger.info("db::updateSysMsgUnread: ",m),m})}},function(t,r,e){var n=e(3),o=e(2),s=e(71).fn,a=e(0);s.putBroadcastMsg=function(i){var u=this;return new n(function(c){a.isArray(i)||(i=[i]);var d=[],m=i.length;function v(){--m===0&&c(d)}o(i).call(i,function(g){g=a.copy(g),u.put("broadcastMsg",g).then(function(b){d.push(b[0]),v()},v)})})},s.getBroadcastMsgs=function(i){return i=i||{},this.getAll("broadcastMsg",i)}},function(t,r,e){var n=e(3),o=e(9),s=e(7),a=e(32),i=e(2),u=e(71).fn,c=e(0),d=c.notundef;u.putSession=function(m){var v=this,g=m.unread;return(m=c.merge({},m)).updateTime===void 0&&m.lastMsg&&m.lastMsg.time&&(m.updateTime=m.lastMsg.time),(m.lastMsg||!m.ack&&!m.msgReceiptTime)&&(m.isDeleted=!1),delete m.unread,this.modifyOrPut({table:"session",obj:m,key:"id",modifyObjWhenPut:{unread:0}}).catch(function(b){return v.notifyError&&v.notifyError(b),m.unread=g,n.resolve(m)})},u.getAllSessions=function(){return this.getAll("session",{index:"updateTime",desc:!0}).catch(function(m){self.notifyError&&self.notifyError(m)})},u.getSessions=function(m){var v=!o(m=m||{}),g=m.limit||100,b=m.lastSessionId,T=m.sessionId,k=!1,y=this,A=function(){return!0},V=function(){return!0};return d(T)?this.getSession(T,m.isDeleted):(d(b)&&(A=function(he){return he.id===b&&(k=!0),k}),m.includeDeleted||(V=function(he){return!he.isDeleted}),this.getAll("session",{index:"updateTime",desc:v,limit:g,filter:function(he){return A(he)&&V(he)}}).catch(function(he){y.notifyError&&y.notifyError(he)}))},u.getSession=function(m,v){var g=this;return this.get("session",m).then(function(b){return n.resolve(!v&&b&&b.isDeleted?void 0:b)}).catch(function(b){throw g.notifyError&&g.notifyError(b),b})},u.updateSession=function(m){var v=this,g=m.id,b=c.filterObj(m,"ack unread lastMsg localCustom msgReceiptTime msgReceiptServerTime isTop topCustom isDeleted");return m.lastMsg&&(b.lastMsg=m.lastMsg),this.getOne("session",null,g,{modifyObj:b}).then(function(T){if(T){var k,y=s(k="db::updateSession: ".concat(g," ")).call(k,c.pickAsString(b,["ack","unread","msgReceiptTime","msgReceiptServerTime","isTop","isDeleted"]));y+=b.lastMsg?" lastMsg.idClient:".concat(c.get(b,"lastMsg.idClient")):"",v.logger.info(y)}else v.logger.warn("db::updateSession: no record ".concat(g));return T}).catch(function(T){v.notifyError&&v.notifyError(T)})},u.getStickTopSessions=function(){var m=this;return this.getAll("session",{filter:function(v){return v&&v.isTop}}).catch(function(v){m.notifyError&&m.notifyError(v)})},u.deleteSession=function(m,v){var g=v&&v.scene||"";return g==="superTeam"?this.updateSuperTeamSessionAck(0):(g==="p2p"||g==="team"||this.updateSuperTeamSessionAck(0),this.updateSessionAck(0)),this.updateMsgReceiptsTimetag(0),this.remove("session",m)},u.deleteSessionLogic=function(m){var v=this;if(!a(m))return this.getOne("session",null,m,{modifyObj:{isDeleted:!0}});var g=[];return i(m).call(m,function(b){g.push(v.getOne("session",null,b,{modifyObj:{isDeleted:!0}}))}),n.all(g)},u.putSessionsWithMoreRoaming=function(m){return this.put("sessionsWithMoreRoaming",m)},u.updateSessionsWithMoreRoaming=function(m){var v=m.id;return delete m.id,this.getOne("sessionsWithMoreRoaming",null,v,{modifyObj:m})},u.deleteSessionsWithMoreRoaming=function(m){return this.remove("sessionsWithMoreRoaming",m)},u.getSessionsWithMoreRoaming=function(m){return m?this.get("sessionsWithMoreRoaming",m):this.getAll("sessionsWithMoreRoaming")}},function(t,r,e){var n=e(7),o=e(121),s=e(122),a=e(0).throttle,i=function(){function u(c){o(this,u),this.arr=[],this.timer=null,this.maxLength=c.maxLength||100,this.throttleTime=c.throttleTime||5e3,this.processFn=c.processFn||function(){},this.throttleFn=c.processFn||function(){},c.processFn&&(this.throttleFn=a(function(d){c.processFn(d),d.length=0},this.throttleTime,{leading:!1}))}return s(u,[{key:"add",value:function(c){var d;Object.prototype.toString.call(c)==="[object Array]"?this.arr=n(d=this.arr).call(d,c):this.arr.push(c),this.arr.length>=this.maxLength&&(this.processFn(this.arr),this.arr=[]),this.timer=this.throttleFn(this.arr)}},{key:"destroy",value:function(){this.arr=[],this.timer&&clearTimeout(this.timer),this.processFn=function(){},this.throttleFn=function(){}}},{key:"clear",value:function(){this.arr=[],this.timer&&clearTimeout(this.timer)}}]),u}();t.exports=i},function(t,r,e){var n=e(25),o=e(58),s=e(57),a=e(10),i=e(312),u=e(7),c=e(3),d=e(26),m=e(17),v=e(6),g=e(15),b=e(24),T=e(2),k=e(123),y=e(5),A=e(59),V=e(60),he=e(61),ae=e(62),Ne=e(47);function _e(Ue,Dt){var tr=y(Ue);if(A){var dr=A(Ue);Dt&&(dr=m(dr).call(dr,function(fr){return V(Ue,fr).enumerable})),tr.push.apply(tr,dr)}return tr}function Ce(Ue){for(var Dt=1;Dt<arguments.length;Dt++){var tr,dr,fr=arguments[Dt]!=null?arguments[Dt]:{};Dt%2?T(tr=_e(Object(fr),!0)).call(tr,function(sr){o(Ue,sr,fr[sr])}):he?ae(Ue,he(fr)):T(dr=_e(Object(fr))).call(dr,function(sr){Ne(Ue,sr,V(fr,sr))})}return Ue}var re=e(35).fn,ue=e(0),ze=e(13),le=e(154).V2NIMConnectStatus;function de(Ue,Dt){var tr,dr,fr,sr,hr=this,Fe=ze.getDefaultLinkUrl(hr.options.secure);hr.socketUrls=[Fe],hr.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:Dt,code:200,net_connect:hr.checkNetworkAvailable(),succeed:!0}),hr.msgStatEnable=!!Ue.common["msg.stat.enable"],hr.msgStatEnable&&(hr.msgDelayTimer=d(b(dr=hr.doReportMsgDelay).call(dr,hr),1e4)),Ue.common&&Ue.common.link&&T(fr=Ue.common.link).call(fr,function($e){hr.socketUrls.unshift(ze.formatSocketUrl({url:$e,secure:hr.options.secure}))}),Ue.common&&Ue.common["link.default"]&&T(sr=Ue.common["link.default"]).call(sr,function($e){var er,nr;$e=ze.formatSocketUrl({url:$e,secure:hr.options.secure}),v(er=hr.socketUrls).call(er,$e)===-1&&(hr.socketUrls=u(nr=hr.socketUrls).call(nr,$e))}),hr.socketUrls=m(tr=hr.socketUrls).call(tr,function($e,er,nr){return v(nr).call(nr,$e)===er});try{ze.uploadUrl=Ue.nosup[0]}catch{}if(ze.chunkUploadUrl=Ue["nos-chunk"]||ze.chunkUploadUrl||"",hr.logger.info("link::refreshSocketUrl: ".concat(Dt," ajax load , got socket urls "),hr.socketUrls),ze.hasLocalStorage){Ue.common["lbs.backup"]&&hr.options.lbsBackup&&localStorage.setItem("nim_lbs_backup",a(Ue.common["lbs.backup"]));var or=ue.get(Ue,"common.report.apierror.on");Ue.common.report&&localStorage.setItem("nim_lbs_fail_report_on",or===!1?"0":"1")}if(Ue.common.socketConcurrent){var ir=Ue.common.socketConcurrent;typeof ir=="number"&&ir>=1&&ir<=3&&(hr.options.socketConcurrent=ir,hr.imsocket.setConfig({socketConcurrent:ir}))}}function Ie(Ue,Dt){if(this.statusProtector.getConnectStatus()===le.V2NIM_CONNECT_STATUS_DISCONNECTED)return c.reject(new Error("already disconnected"));if(Ue>=Dt){this.logger.warn("doRequestBackupLbsUrls backup lbs all tried");var tr=ze.getDefaultLinkUrl(this.options.secure);return this.logger.warn("doRequestBackupLbsUrls: use default socket link",tr),this.socketUrls=[tr],c.resolve()}return this.logger.warn("doRequestBackupLbsUrls: wait for next lbs request"),c.reject(new Error("lbs request failed"))}function ie(Ue,Dt){var tr=Dt.status||10001,dr=typeof Dt=="string"?Dt:Dt&&Dt.message?Dt.message:"Unknown error";this.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:Ue,code:tr,description:dr,net_connect:this.checkNetworkAvailable(),succeed:!1})}function Ve(Ue){var Dt=this;if(!(Ue&&Ue.length>0))throw new Error("No  lbs url to try");var tr=0,dr=0,fr=!1,sr=null;Dt.logger.log("doRequestBackupLbsUrls: use lbs url in index ",tr,Ue);var hr=function(){var Fe=Ue[tr++],or=new Date().getTime();return Dt.promiseAbortManager.add(Dt.doRequestLbs(Fe)).then(function(ir){if(sr&&clearInterval(sr),fr===!1)return de.call(Dt,ir,Fe),fr=!0,c.resolve()}).catch(function(ir){return dr+=1,Dt.logger.warn("doRequestBackupLbsUrls: ".concat(Fe," ajax lbs error"),ir),ie.call(Dt,Fe,ir,or),Ie.call(Dt,dr,Ue.length)})};return new c(function(Fe,or){sr=k(function(){if(!(tr>=Ue.length))return Dt.statusProtector.getConnectStatus()===le.V2NIM_CONNECT_STATUS_DISCONNECTED?(sr&&clearInterval(sr),void or(new Error("already disconnected"))):void hr().then(function(){sr&&clearInterval(sr),Fe()}).catch(function(){});sr&&clearInterval(sr)},2e3),hr().then(function(){sr&&clearInterval(sr),Fe()}).catch(function(){})})}re.connect=function(){if(this.checkNetworkAvailable()===!1&&this.autoconnect)return this.logger.info("connect::skip this reconnection attempt because network is offline"),void this.reconnect();ze.isBrowser&&this.reporter.restore(),this.createConnectTime=s(),this.reporter.reportTraceCancel("login"),this.reporter.reportTraceStart("login",{user_id:this.options.account,action:this.autoconnect?"auto_login":"manual_login"}),this.reporter.reportTraceUpdateV2("login",{code:0,description:a(Ce(Ce({},this.options),{},{account:"***",token:"***"}),function(Ue,Dt){return Ue===""||typeof Dt!="function"&&n(Dt)!=="object"?Dt:void 0}),operation_type:"conf_init",succeed:!0,target:""}),i(re).connect.call(this)},re.onConnect=function(){this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:this.url,code:200,net_connect:this.checkNetworkAvailable(),succeed:!0}),i(re).onConnect.call(this)},re.onHandshakeFailed=function(Ue,Dt){var tr;this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:Dt,code:408,succeed:!1,net_connect:this.checkNetworkAvailable(),description:"ws_handshake_failed"}),this.reporter.reportTraceEnd("login",!1),this.logger.warn(u(tr="link::onHandshakeFailed: shandshake failed, startTime: ".concat(Ue,", targetUrl: ")).call(tr,Dt))},re.onConnectFailed=function(Ue,Dt,tr){var dr,fr;this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:tr,code:408,succeed:!1,net_connect:this.checkNetworkAvailable(),description:"ws_connect_failed"}),this.reporter.reportTraceEnd("login",!1),this.logger.warn(u(dr=u(fr="link::onConnectFailed: connect failed due to ".concat(Ue,", startTime: ")).call(fr,Dt,", targetUrl: ")).call(dr,tr))},re.onSocketError=function(Ue,Dt,tr){var dr,fr;this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:tr,description:"ws_onerror:"+Ue,code:0,succeed:!1}),this.reporter.reportTraceEnd("login",!1),this.logger.warn(u(dr=u(fr="link::onSocketError: due to ".concat(Ue,", startTime: ")).call(fr,Dt,", targetUrl: ")).call(dr,tr))},re.probeIp=function(){var Ue=this,Dt=ze.ipProbeAddr;return new c(function(tr){var dr=0,fr=-1;function sr(){++dr===2&&(dr=-1,tr(fr))}Ue.adaptersRequest(Dt.ipv4,{timeout:2e3,onerror:sr,onload:function(hr){fr++,sr()}}),Ue.adaptersRequest(Dt.ipv6,{timeout:2e3,onerror:sr,onload:function(hr){fr+=2,sr()}}),d(function(){dr||fr===-1||(dr=-1,tr(fr))},100)})},re.refreshSocketUrl=function(){var Ue=this;return this.statusProtector.emit("auth/loginLifeCycleAddressing"),ze.isWeixinApp?this.doRefreshSocketUrl(2):this.options.ipVersion===2?this.probeIp().then(function(Dt){return Ue.doRefreshSocketUrl(Dt)}):this.doRefreshSocketUrl(this.options.ipVersion)},re.doRefreshSocketUrl=function(Ue){var Dt,tr,dr=this.options.lbsUrl||ze.lbsUrl;Ue!==1&&Ue!==2&&(Ue=0),ze.ipVersion=Ue;var fr=this.options.lbsBackupUrlsCustomer||[],sr=[];this.options.lbsBackup&&ze.hasLocalStorage&&(sr=(sr=localStorage.getItem("nim_lbs_backup"))?JSON.parse(sr):[]);var hr=u(Dt=u(tr=[dr]).call(tr,sr)).call(Dt,fr);return hr=m(hr).call(hr,function(Fe,or,ir){return v(ir).call(ir,Fe)===or}),Ve.call(this,hr)},re.doRequestLbs=function(Ue){var Dt=this,tr=this.options,dr=ze.info;Ue=Ue+ue.genUrlSep(Ue)+"id="+tr.account+"&sv="+dr.sdkVersion+"&pv="+dr.protocolVersion+"&networkType="+ze.ipVersion+"&hostEnv="+ze.hostEnv+"&k="+tr.appKey,this.logger.info("doRequestLbs ".concat(g(Ue).call(Ue,0,-32)));var fr=this;return new c(function(sr,hr){ze.isWeixinApp?wx.request({url:Ue,success:function(Fe){var or=Fe&&Fe.statusCode,ir=Fe&&Fe.data;or===200?sr(ir):hr(ir)},fail:function(Fe){hr(Fe)}}):Dt.adaptersRequest(Ue,{proxyUrl:ue.url2origin(Ue)+"/lbs/res/cors/nej_proxy_frame.html",timeout:ze.xhrTimeout,onload:function(Fe){try{var or=JSON.parse(Fe);sr(or)}catch(ir){fr.logger.warn("doRequestLbs parse JSON Error. request lbs failed"),hr(ir)}},onerror:function(Fe){hr(Fe)}},{exception_service:1})})},re.disconnect=function(){var Ue=this,Dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};if(this.isConnected())return this.sendCmd("logout"),void d(function(){i(re).disconnect.call(Ue,Dt)},0);this.connecting?this.logger.warn("IMProtocolFn api disconnect:: connecting but exiting"):this.statusProtector.getConnectStatus()!==le.V2NIM_CONNECT_STATUS_DISCONNECTED?this.logger.warn("IMProtocolFn api disconnect:: has tried to disconnect"):this.logger.warn("IMProtocolFn api disconnect:: other logic entered");var tr=i(re);tr.disconnect.call(this,Dt)},re.notifyDisconnect=function(Ue){i(re).notifyDisconnect.call(this,Ue)}},function(t,r,e){var n=e(102),o=e(58),s=e(103),a=e(3),i=e(10),u=e(26),c=e(24),d=e(6),m=e(2),v=e(17),g=e(5),b=e(59),T=e(60),k=e(61),y=e(62),A=e(47);function V(Ie,ie){var Ve=g(Ie);if(b){var Ue=b(Ie);ie&&(Ue=v(Ue).call(Ue,function(Dt){return T(Ie,Dt).enumerable})),Ve.push.apply(Ve,Ue)}return Ve}function he(Ie){for(var ie=1;ie<arguments.length;ie++){var Ve,Ue,Dt=arguments[ie]!=null?arguments[ie]:{};ie%2?m(Ve=V(Object(Dt),!0)).call(Ve,function(tr){o(Ie,tr,Dt[tr])}):k?y(Ie,k(Dt)):m(Ue=V(Object(Dt))).call(Ue,function(tr){A(Ie,tr,T(Dt,tr))})}return Ie}var ae=e(35).fn,Ne=e(192),_e=e(13),Ce="NIM-AllGrayscaleConfig",re="NIM-AllMixStorePolicy",ue=e(0);function ze(){var Ie=this;if(_e.hasLocalStorage&&localStorage.getItem(Ce)){var ie=null;try{ie=JSON.parse(localStorage.getItem(Ce))[Ie.options.appKey]}catch(Ve){Ie.logger.error("appGrayConfig error",Ve)}ie&&(Ie.appGrayConfig=ie.timeStamp+1e3*ie.ttl>new Date().getTime()?ie:null,Ie.appGrayConfig&&le.apply(Ie))}Ie.appGrayConfig||Ie.sendCmd("getGrayscaleConfig",{providers:""},function(Ve,Ue){if(Ve)Ie.logger.error("Calculate Delay time, getGrayscaleConfig error",Ve);else if(Ue){var Dt=Ue;if(Dt.grayConfig=JSON.parse(Dt.grayConfig),Dt.ttl=Number(Dt.ttl),Dt.timeStamp=new Date().getTime(),Ie.appGrayConfig=Dt,_e.hasLocalStorage){var tr=localStorage.getItem(Ce)?JSON.parse(localStorage.getItem(Ce)):{};tr[Ie.options.appKey]=Dt,localStorage.setItem(Ce,i(tr))}le.apply(Ie)}else Ie.logger.error("Calculate Delay time, getGrayscaleConfig error",Ue)})}function le(){var Ie=this;if(_e.hasLocalStorage&&localStorage.getItem(re)){var ie=null;try{ie=JSON.parse(localStorage.getItem(re))[Ie.options.appKey]}catch(Ve){Ie.logger.error("mixStorePolicy error",Ve)}ie&&(Ie.mixStorePolicy=ie.timeStamp+1e3*ie.ttl>new Date().getTime()?ie:null,Ie.mixStorePolicy&&ie.ttl&&ie.ttl!==0&&(Ie.mixStorePolicyClock=u(c(le).call(le,Ie),1e3*ie.ttl)))}Ie.mixStorePolicy||Ie.sendCmd("getMixStorePolicy",{providers:Ie.options.providers&&Ie.options.providers.s3?[1,2]:[1]},function(Ve,Ue){if(Ve){Ie.logger.error("Calculate Delay time, getMixStorePolicy error",Ve);try{Ue=JSON.parse(localStorage.getItem("NIM-AllMixStorePolicy"))[Ie.options.appKey]}catch(dr){Ie.logger.error("error:","get last mixStorePolicy failed",dr)}}else if(Ue){var Dt=Ue;if(Dt.ttl=Number(Dt.ttl),Dt.providers=Dt.providers.split(","),Dt.nosPolicy=Dt.nosPolicy?JSON.parse(Dt.nosPolicy):null,Dt.s3Policy=Dt.s3Policy?JSON.parse(Dt.s3Policy):null,Dt.timeStamp=new Date().getTime(),Ie.mixStorePolicy=Dt,Dt.ttl&&Dt.ttl!==0&&(Ie.mixStorePolicyClock=u(c(le).call(le,Ie),1e3*Dt.ttl)),_e.hasLocalStorage){var tr=localStorage.getItem(re)?JSON.parse(localStorage.getItem(re)):{};tr[Ie.options.appKey]=Dt,localStorage.setItem(re,i(tr))}}else Ie.logger.error("Calculate Delay time, mixStorePolicy error",Ue)})}function de(Ie){var ie=this,Ve=this;Ie.code===399?(this.logger.warn("pendingLoginFailed:399, refresh LBS url and reconnecting"),Ve.forceDisconnect(),Ve.doRefreshSocketUrl(_e.ipVersion).then(function(){Ve.reconnect()}).catch(function(){ie.logger.warn("pendingLoginFailed:399, refresh LBS url failed")})):Ie.code===398?(this.logger.warn("pendingLoginFailed:398 try to reconnect socket link，backoff set min 5s"),Ve.backoff.setMin(5e3),Ve.reconnect()):(this.logger.error("pendingLoginFailed: ",Ie.code,Ie),Ve.onAuthError(Ie,"link::onLogin"))}ae.assembleLogin=function(){var Ie=this.assembleIMLogin();return this.addPushInfo instanceof Function?this.addPushInfo(Ie):a.resolve({login:Ie})},ae.login=s(n.mark(function Ie(){var ie,Ve,Ue,Dt=this;return n.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return ie=this,tr.next=3,ie.assembleLogin();case 3:if(Ve=tr.sent,!(Ue=this.socket&&this.socket.socket&&this.socket.socket.sessionid)){tr.next=13;break}if(this.socketIds||(this.socketIds={}),!this.socketIds[Ue]){tr.next=10;break}return this.logger.warn("onConnect::repeat login",Ue),tr.abrupt("return");case 10:this.socketIds[Ue]=!0,tr.next=14;break;case 13:this.logger.warn("onConnect:: no socketId ",this.socket&&this.socket.socket);case 14:this.logger.warn("link::doLogin: "+Ue+" appLogin is "+Ve.login.appLogin),ie.sendCmd("login",he({},Ve),function(dr,fr){if(dr){var sr=ue.get(dr,"event.uploadCode")||dr&&dr.code;sr=typeof sr!="number"?408:sr;var hr=ue.get(dr,"event.disconnectReason"),Fe=hr?i({disconnect_reason:hr}):dr&&dr.message||"login failed";ie.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",code:sr,description:Fe,net_connect:ie.checkNetworkAvailable(),succeed:!1}),ie.reporter.reportTraceEnd("login",!1),de.call(ie,dr),ie.statusProtector.emit("auth/loginLifeCycleLoginFail",dr)}else ie.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",succeed:!0,net_connect:ie.checkNetworkAvailable(),code:200}),ie.reporter.reportTraceEnd("login",!0),ie.resetReconnectStatus(),Dt.heartbeatFail=0,Dt.hasLogin=!0,Dt.autoconnect=!0,ie.startHeartbeat(),ie.initOnlineListener(),ie.statusProtector.emit("auth/loginLifeCycleLoginSucc"),ie.afterLogin(fr)});case 16:case"end":return tr.stop()}},Ie,this)})),ae.afterLogin=function(Ie){var ie=this;this.sendCmd("getNosCdnHost",{}),(typeof ue.get(this.options,"privateConf.isMixStoreEnable")=="boolean"?this.options.privateConf.isMixStoreEnable:_e.privateConf.isMixStoreEnable)&&ze.apply(this),this.initPush instanceof Function&&this.initPush();var Ve=this.db;if(Ve.enable){var Ue=this.account;this.options.appendAppKeyForDBName&&(Ue+="-"+this.options.appKey),this.db.init(Ue).then(function(){ie.notifyLogin(Ie),ie.syncData()},function(Dt){ie.logger.warn("link::afterLogin: no db",Dt),Ve.reset(!1),ie.notifyLogin(Ie),ie.syncData()})}else this.logger.info("link::afterLogin: no db"),this.notifyLogin(Ie),this.syncData()},ae.getFileAuthToken=function(Ie){var ie=this,Ve=ie.mixStorePolicy.nosPolicy.authPolicy.policyType;Ve!==-1?d(Ve).call(Ve,Ie.type)<0?ie.logger.error("this type Token error not support"):Ie.type!=3||Ie.urls&&Ie.urls.length?ie.sendCmd("getBackSourceToken",{mixAuthTokenReq:Ie},function(Ue,Dt){if(Ue)return ie.logger.error("getBackSourceToken error",Ue),Ue;Ie.done&&Ie.done(Dt)}):ie.logger.error("urls is Required when type 3"):ie.logger.error("don't need token")},ae.processAuth=function(Ie){switch(Ie.cmd){case"login":Ie.error||(Ie.content=Ie.content||{},this.loginAndroidPush&&this.loginAndroidPush(Ie.content.aosPushInfo||{}),Ie.obj=Ie.content.loginRes,this.connectionId=Ie.content.loginRes.connectionId,this.onLoginPortsChange(Ie,2));break;case"kicked":return void this.onKicked(Ie);case"multiPortLogin":this.onLoginPortsChange(Ie,Ie.content.state);break;case"kick":Ie.error||(Ie.obj.deviceIds=Ie.content.deviceIds)}},ae.onLoginPortsChange=function(Ie,ie){var Ve=this,Ue=Ie.content.loginPorts;if(Ue&&Ue.length){var Dt=!0;switch(ie){case 2:Dt=!0;break;case 3:Dt=!1}m(Ue).call(Ue,function(tr){tr.type=Ne.reverseType(tr.type),tr.customClientType&&(tr.customClientType=+tr.customClientType),tr.time=+tr.time,tr.online=Dt}),(Ue=v(Ue).call(Ue,function(tr){return tr.connectionId!==Ve.connectionId})).length&&(Ve.logger.info("link::onLoginPortsChange:",Ue),Ve.options.onloginportschange(Ue))}},ae.kickedReasons=["","samePlatformKick","serverKick","otherPlatformKick","silentlyKick"],ae.kickedMessages=["","不允许同一个帐号在多个地方同时登录","被服务器踢了","被其它端踢了","悄悄被踢"]},function(t,r,e){var n=e(783),o=e(3),s=e(24),a=e(7),i=e(749),u=e(41),c=e(2),d=e(5),m=e(138),v=e(17),g=e(6),b=e(8),T=e(797),k=e(69),y=e(26),A=e(32),V=e(87),he=e(35).fn,ae=e(0),Ne=e(40),_e=ae.undef,Ce=ae.objs2ids,re=ae.objs2accounts,ue=ae.teams2ids,ze=e(152),le=ae.getGlobal(),de=e(105).EMSyncType;he.beforeSync=function(){var Ie=this.db;return Ie.enable?Ie.clearSendingMsgs():o.resolve()},he.syncData=function(){var Ie=this,ie=Ie.db,Ve=Ie.options,Ue=ie.enable;function Dt(tr){var dr;Ie.syncPromiseArray=[],Ie.syncResult={},Ie.syncTeamMembersPromiseArray=[],Ie.syncSuperTeamMembersPromiseArray=[],Ie.syncTeamMembersResult={},Ie.checkNosReqNum=0,Ie.getNosOriginUrlReqNum=0,ae.verifyBooleanWithDefault(Ve,"syncRelations syncFriends syncFriendUsers syncTeams syncSuperTeams syncRoamingMsgs syncSuperTeamRoamingMsgs syncMsgReceipts syncExtraTeamInfo syncExtraSuperTeamInfo syncAvSignal",!0,"","sync::syncData"),ae.verifyBooleanWithDefault(Ve,"syncFilter syncTeamMembers syncSuperTeamMembers",!1,"","sync::syncData");var fr={};tr=tr||{},le._nimForceSyncIM&&(Ie.logger.warn("sync::syncData: nimForceSyncIM"),delete tr.teams,le._nimForceSyncIM=!1),fr.myInfo=tr.myInfo||0,fr.deleteMsgSelf=tr.deleteMsgSelf||0,fr.offlineMsgs=0,Ve.syncRelations&&(fr.relations=tr.relations||0),Ve.syncFriends&&(fr.friends=tr.friends||0),Ve.syncFriendUsers&&(fr.friendUsers=tr.friendUsers||0),Ve.syncRobots&&(fr.robots=tr.robots||0),Ve.syncTeams&&(fr.teams=tr.teams||0),Ve.syncSuperTeams&&(fr.superTeams=tr.superTeams||0),Ve.syncStickTopSessions&&(fr.stickTopSessions=tr.stickTopSessions||0),Ve.syncSessionUnread&&(fr.sessionAck=Ue&&tr.sessionAck||0,fr.superTeamSessionAck=Ue&&tr.superTeamSessionAck||0),Ve.syncRoamingMsgs&&(fr.roamingMsgs=Ue&&tr.roamingMsgs||tr.roamingMsgs||0),Ve.syncSuperTeamRoamingMsgs&&(fr.superTeamRoamingMsgs=Ue&&tr.superTeamRoamingMsgs||0),Ve.syncMsgReceipts&&(fr.msgReceipts=tr.msgReceipts||0),Ve.syncExtraTeamInfo&&(fr.myTeamMembers=tr.myTeamMembers||0),Ve.syncExtraSuperTeamInfo&&(fr.myInfoInSuperTeams=tr.myInfoInSuperTeams||0),Ve.syncBroadcastMsgs&&(fr.broadcastMsgs=tr.broadcastMsg||0),fr.donnop=tr.donnop||0,fr.deleteMsg=tr.deleteMsg||0,fr.deleteSuperTeamMsg=tr.deleteSuperTeamMsg||0,fr.sessionHistoryMsgsDelete=tr.sessionHistoryMsgsDelete||0,fr.netcallMsgs=0,Ve.syncFilter&&(fr.filterMsgs=0),Ve.syncAvSignal&&(fr.avSignal=0);var sr=s(dr=Ie.onSyncData).call(dr,Ie);sr.isImSyncDataCb=!0,Ie.logger.info("syncData:: start sync",fr),Ie.reporterHook.emit("reporter/syncStart"),Ie.sendCmd("sync",{sync:fr,isImSyncDataObj:!0},sr)}Ie.syncing=!0,Ue?Ie.beforeSync().then(function(){return Ie.db.getTimetags()}).then(function(tr){Dt(tr)},function(){Dt()}):Dt(Ie.timetags)},he.onSyncData=function(Ie){Ie&&(Ie.callFunc="sync::onSyncData",this.onCustomError("SYNC_DATA_ERROR",Ie))},he.processSync=function(Ie){switch(this.logger.log("sync::processSync cmd: ".concat(Ie.cmd)),Ie.cmd){case"syncDone":if(Ie.error){var ie,Ve=ae.get(Ie.error,"message"),Ue=ae.get(Ie.error,"code");this.logger.error(a(ie="sync::processSync syncDoneError errMsg: ".concat(Ve,", errCode: ")).call(ie,Ue)),this.logger.error("sync::processSync disconnect because syncDone failed");var Dt=Ne.syncError({errMsg:Ve,errCode:Ue});this.shouldReconnect=!1,this.markAllCallbackInvalid(Dt),this.notifyDisconnect(Dt)}else this.timetags.sync=Ie.content.timetag,this.reporterHook.emit("reporter/syncRecv"),this.onSyncDone();break;case"syncTeamMembersDone":this.onSyncTeamMembersDone()}},he.onSyncDone=function(){var Ie,ie,Ve,Ue,Dt,tr,dr,fr,sr,hr,Fe,or,ir,$e,er,nr,Pt,rr,kt,Et,cr,mr,yr,Tr,Ir,kr,Ar,Rr,Mn,Or,Pr=this,Nr=Pr.db,Wr=Nr.enable,Yr=Pr.options,Ur=Pr.syncPromiseArray,qr=Pr.syncResult;function Yn(){if(Ur){Pr.logger.info("sync::onSyncDone: after sync",ae.promises2cmds(Ur)),Ur=[],ie=qr.blacklist||[],Ve=qr.invalidBlacklist||[],Ue=qr.mutelist||[],Dt=qr.invalidMutelist||[],tr=qr.friends,sr=qr.myTeamMembers,hr=qr.mySuperTeamMembers,dr=qr.invalidFriends||[],fr=qr.myInfo,Fe=qr.users,ir=qr.superTeams,er=qr.invalidSuperTeams,or=qr.teams,$e=qr.invalidTeams||[],nr=qr.sessions||{},Pt=i(u({},Pr.sessionSet)),rr=qr.ackMap,qr.msgReceipts,kt=qr.roamingMsgs,Et=qr.offlineMsgs,cr=qr.offlineFilterMsgs,yr=qr.offlineSysMsgs,Tr=qr.offlineCustomSysMsgs,Ir=qr.offlineFilterSysMsgs,kr=qr.offlineFilterCustomSysMsgs,Ar=qr.sysMsgUnread,Rr=qr.sessionsWithMoreRoaming,Or=qr.clearServerHistoryMsgs||[];var bo=o.resolve();(function(){if(Wr){var uo,po=[$n()];nr&&c(uo=d(nr)).call(uo,function(to){po.push(Nr.putSession(nr[to]))}),bo=o.all(po).then(function(){var to,Lr=a(to=[]).call(to,n(d(rr||{})),n(d(nr||{})));Lr=v(Lr).call(Lr,function(Bn,Xn,ko){return g(ko).call(ko,Bn)===Xn});var Qr=[];return c(Lr).call(Lr,function(Bn){var Xn,ko=nr[Bn];(ko.lastMsg||ko.ack)&&(Xn=(Xn=ko.ack?o.resolve(ko):Nr.getSession(ko.id)).then(function(no){var Ra=no.ack||0;return Nr.getMsgCountAfterAck({shouldCountNotifyUnread:Pr.options.shouldCountNotifyUnread,sessionId:Bn,ack:Ra}).then(function(fs){return no.unread=fs||0,nr[Bn]=Pr.mergeSession(no),Nr.updateSession(no)})}),Qr.push(Xn))}),o.all(Qr)}).then(function(){var to=[];return Pr.saveAck.p2pTeam&&to.push(Nr.updateSessionAck(Pr.saveAck.p2pTeam).catch(function(Lr){return Pr.logger.error("sessionAck::syncSessionAck::updatetimetag db",Lr),o.reject(Lr)})),Pr.saveAck.superTeam&&to.push(Nr.updateSuperTeamSessionAck(Pr.saveAck.superTeam).catch(function(Lr){return Pr.logger.error("sessionAck::syncSuperTeamSessionAck::updatetimetag db",Lr),o.reject(Lr)})),o.all(to)})}else if(nr){var No,An,Sa;c(No=[kt,Et]).call(No,function(to){to&&c(to).call(to,function(Lr){var Qr;(An=nr[Lr.sessionId]).unread=An.unread||0,An.unreadMsgs=An.unreadMsgs||[],Sa=An.ack||0,c(Qr=Lr.msgs).call(Qr,function(Bn){if(!(Sa>=Bn.time))if(Bn.type==="notification"){var Xn;try{Xn=Pr.options.shouldCountNotifyUnread(Bn)}catch(ko){throw Pr.logger.error("userOption:shouldCountNotifyUnread function error",ko),ko}Xn&&An.unread++}else Bn.flow==="in"&&Bn.isUnreadable!==!1&&(An.unread++,An.unreadMsgs.push(Bn))}),Pr.mergeSession(An)})})}})(),bo.then(function(){if(Wr&&!Pr.hasSynced)Pr.hasSynced=!0,function(){Yr.syncRelations&&(Ie=Nr.getRelations().then(function(An){ie=An[0],Ue=An[1],ie.invalid=Ve,Ue.invalid=Dt}).catch(function(An){return An._msg="on relations error",Pr.logger.error("sync::syncRelation: ",An),o.reject(An)}),Ur.push(Ie)),Yr.syncFriends&&(Ie=Nr.getFriends().then(function(An){(tr=An).invalid=dr}).catch(function(An){return An._msg="on friends error",Pr.logger.error("sync::syncFriends: ",An),o.reject(An)}),Ur.push(Ie)),_e(fr)&&(Ie=Nr.getUser(Pr.account).then(function(An){fr=An}).catch(function(An){return An._msg="on myInfo error",Pr.logger.error("sync::syncMyInfo: ",An),o.reject(An)}),Ur.push(Ie)),Yr.syncFriendUsers&&(Ie=Nr.getFriends().then(function(An){return b(An).call(An,function(Sa){return Sa.account})}).then(function(An){return Nr.getUsers(An)}).then(function(An){Fe=An}).catch(function(An){return An._msg="on users error",Pr.logger.error("sync::syncFriendUser: ",An),o.reject(An)}),Ur.push(Ie)),Yr.syncTeams&&(Ie=Nr.getTeams().then(function(An){(or=An).invalid=$e}).catch(function(An){return An._msg="on teams error",Pr.logger.error("sync::syncTeams: ",An),o.reject(An)}),Ur.push(Ie)),Yr.syncSuperTeams&&(Ie=Nr.getSuperTeams().then(function(An){(ir=An).invalid=er}).catch(function(An){return An._msg="on superteams error",Pr.logger.error("sync::syncSuperTeams: ",An),o.reject(An)}),Ur.push(Ie)),Ie=Nr.getTeamMembersByAccount(Pr.account).then(function(An){sr=An,Pr.mergeMyTeamMembers(An)}).catch(function(An){return Pr.logger.error("sync::getTeamMembersByAccount: ",An),o.reject(An)}),Ur.push(Ie),Ie=Nr.getSuperTeamMembersByAccount(Pr.account).then(function(An){hr=An,Pr.mergeMySuperTeamMembers(An)}).catch(function(An){return Pr.logger.error("sync::getSuperTeamMembersByAccount: ",An),o.reject(An)}),Ur.push(Ie),Ie=Nr.getDonnop().then(function(An){Pr.mergeDonnop(An)}).catch(function(An){return Pr.logger.error("sync::donnop: ",An),o.reject(An)}),Ur.push(Ie),Ie=Nr.getAllSessions().then(function(An){nr=An}).catch(function(An){return Pr.logger.error("sync::getSession: ",An),o.reject(An)}),Ur.push(Ie),Ie=Nr.getSysMsgUnread().then(function(An){Ar=An}).catch(function(An){return An._msg="on sysMsgUnread error",Pr.logger.error("sync::getSysMsgUnread: ",An),o.reject(An)}),Ur.push(Ie),Ur.push(Nr.getSessionsWithMoreRoaming().then(function(An){Rr=An}))}();else{var uo,po,No=[];c(uo=d(nr)).call(uo,function(An){(po=nr[An]).lastMsg&&No.push(po)}),nr=m(No).call(No,function(An,Sa){return Sa.updateTime-An.updateTime})}o.all(Ur).then(Jr).then(Fr,function(An){Pr.logger.error("taskAfterSync syncDBDataPromise error:",An),An.callFunc="sync::onSyncDone",An.message="taskAfterSync syncDBDataPromise 出错",Pr.onCustomError("SYNC_SESSION_ACK_ERROR",An)})})}else Pr.logger.warn("sync::onSyncDone: after sync --no promiseArray")}function $n(){var bo=[];return kt&&c(kt).call(kt,function(uo){var po;bo=a(po=[]).call(po,n(bo),n(uo.msgs))}),Et&&c(Et).call(Et,function(uo){var po;bo=a(po=[]).call(po,n(bo),n(uo.msgs))}),bo.length?Nr.putMsg(bo).then(function(){return bo}):o.resolve(bo)}function Jr(){Pr.logger.info("sync::onSyncDone: taskAfterSync"),function(){if(qr.deleteMsgSysMsgs){var uo,po={};kt&&c(kt).call(kt,function(Qr){po[Qr.sessionId]=Qr});var No={};Et&&c(Et).call(Et,function(Qr){No[Qr.sessionId]=Qr});var An=Pr.api;if(c(uo=qr.deleteMsgSysMsgs).call(uo,function(Qr){var Bn;c(Bn=Qr.sysMsgs).call(Bn,function(Xn){var ko=Xn.msg,no=ko.sessionId;Qr.type==="roaming"&&po[no]?po[no].msgs=An.cutMsgs(po[no].msgs,ko):No[no]&&(No[no].msgs=An.cutMsgs(No[no].msgs,ko))})}),!Nr.enable){var Sa,to=a(Sa=[]).call(Sa,n(kt||[]),n(Et||[]));c(to).call(to,function(Qr){if(Qr.msgs.length){var Bn=Pr.genSessionByMsgs(Qr.msgs);Pr.cacheSyncedSession(Bn),nr.unshift(Bn)}else{var Xn=T(nr).call(nr,function(ko){return ko.id===Qr.sessionId});k(nr).call(nr,Xn,1)}});var Lr={};c(nr).call(nr,function(Qr){if(Lr[Qr.id]){var Bn=Qr.lastMsg.time>Lr[Qr.id].lastMsg.time?Qr.lastMsg:Lr[Qr.id].lastMsg;Lr[Qr.id]=Qr,Lr[Qr.id].lastMsg=Bn}else Lr[Qr.id]=Qr}),nr=i(Lr),nr=m(nr).call(nr,function(Qr,Bn){return Bn.updateTime-Qr.updateTime})}}}(),Mn=Pr.syncResult.stickTopSessions||[],c(nr).call(nr,function(uo){var po=Pr.sessionSet[uo.id];po&&po.isTop&&(uo.isTop=!0)});var bo=[Pr.deleteMsgOfflineRoaming(qr.deleteMsgSysMsgs,nr)];return Or&&c(Or).call(Or,function(uo){bo.push(function(po,No){var An;Pr.logger.info("sync::taskAfterSync:sessionHistoryMsgsDelete ".concat(po)),No=No||new Date().getTime();var Sa=v(nr).call(nr,function(Bn){return Bn.id===po}),to=Pr.getSessionInCache(po);An=to||Sa[0];var Lr=Yr.rollbackClearMsgsUnread!==!1,Qr=[];return Nr.enable&&Qr.push(Nr.deleteMsgsBySessionId({sessionId:po,end:No})),Lr&&An&&(An.lastMsg=null,An.unread=0,An=Pr.mergeSession(An),Nr.enable&&Qr.push(Nr.updateSession(An))),o.all(Qr)}(uo.sessionId,uo.time))}),o.all(bo)}function Fr(){y(Wn,0)}function Wn(){var bo,uo,po=[],No=[];if(ie&&ie.length&&(Pr.logger.info("sync::notifyDataAsync: on blacklist",re(ie)),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType3_8),Yr.onblacklist(ie)),Ue&&Ue.length&&(Pr.logger.info("sync::notifyDataAsync: on mutelist",re(Ue)),Yr.onmutelist(Ue)),tr&&(Pr.logger.info("sync::notifyDataAsync: on friends",re(tr)),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType12_5),Yr.onfriends(tr)),fr&&(Pr.logger.info("sync::notifyDataAsync: on myInfo"),Pr.myInfo=fr,Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType3_109),Yr.onmyinfo(ae.copy(fr))),sr){Pr.logger.info("sync::notifyDataAsync: on myTeamMembers",sr),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType8_126);var An=ae.simpleClone(sr);A(An)||(An=[An]),Yr.onMyTeamMembers(An)}if(hr){Pr.logger.info("sync::notifyDataAsync: on mySuperTeamMembers",hr),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType21_111);var Sa=ae.simpleClone(hr);A(Sa)||(Sa=[Sa]),Yr.onMySuperTeamMembers(Sa)}Fe&&(c(Fe).call(Fe,function(no){Pr.mergeUser(no)}),Pr.logger.info("sync::notifyDataAsync: on users",re(Fe)),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType12_6),Yr.onusers(Fe)),or&&(Pr.logger.info("sync::notifyDataAsync: on teams",ue(or)),Yr.onteams(or),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType8_109)),ir&&(Pr.logger.info("sync::notifyDataAsync: onSuperTeams",ue(ir)),Yr.onSuperTeams(ir),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType21_109)),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_12),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_14),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_20),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_21),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType7_15),nr&&nr.length?(nr=b(nr).call(nr,function(no){return Pr.mergeSession(no),V(ze).call(ze,no)}),nr=v(nr).call(nr,function(no){return!no.isDeleted}),Pr.logger.info("sync::notifyDataAsync: on sessions",Ce(nr),ae.secureOutput("session",nr)),!Wr&&Pr.timetags&&Pr.timetags.roamingMsgs?Yr.onsessions(v(Pt).call(Pt,function(no){return ze.isComplete(no)})):Yr.onsessions(nr)):!Wr&&Pt.length&&(Pr.logger.info("sync::notifyDataAsync: on sessions",Ce(nr),ae.secureOutput("session",nr)),Yr.onsessions(v(Pt).call(Pt,function(no){return ze.isComplete(no)}))),Mn&&Mn.length&&(Mn=b(Mn).call(Mn,function(no){return no=Pr.mergeSession(no),V(ze).call(ze,no)}),Pr.logger.info("sync::notifyDataAsync: onStickTopSessions",Ce(Mn),ae.secureOutput("session",Mn)),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_23),Yr.onStickTopSessions(Mn)),kt&&c(kt).call(kt,function(no){no.scene==="superTeam"?No.push(no.timetag):po.push(no.timetag),(uo=no.msgs).length&&(Pr.logger.info("sync::notifyDataAsync: on roaming msgs",no.sessionId,uo.length),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_9),Yr.onroamingmsgs(no))}),Et&&(Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_4),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_17),c(Et).call(Et,function(no){no.scene==="superTeam"?No.push(no.timetag):po.push(no.timetag),(uo=no.msgs).length&&(Pr.logger.info("sync::notifyDataAsync: on offline msgs",no.sessionId,uo.length,b(uo).call(uo,function(Ra){return Ra.idServer})),Yr.onofflinemsgs(no))})),cr&&(Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_100),c(cr).call(cr,function(no){po.push(no.timetag),(uo=no.msgs).length&&(Pr.logger.info("sync::notifyDataAsync: on offline filter msgs",no.sessionId,uo.length),Yr.onofflinefiltermsgs(uo))})),Rr&&(Pr.logger.info("sync::notifyDataAsync: on sessionsWithMoreRoaming",Ce(Rr),Rr),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_22),Yr.onSessionsWithMoreRoaming(Rr));var to,Lr=[],Qr=[];qr.deleteMsgSysMsgs&&c(to=qr.deleteMsgSysMsgs).call(to,function(no){no.type==="roaming"?Lr=a(Lr).call(Lr,no.sysMsgs):Qr=a(Qr).call(Qr,no.sysMsgs)}),Lr.length&&(mr=a(mr=mr||[]).call(mr,Lr)),Qr.length&&(yr=a(yr=yr||[]).call(yr,Qr)),mr&&(Pr.logger.info("sync::notifyDataAsync: on roaming sys msgs",mr.length),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_19),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_15),Yr.onroamingsysmsgs(mr)),yr&&(Pr.logger.info("sync::notifyDataAsync: on offline sys msgs",yr.length),Yr.onofflinesysmsgs(yr)),Ir&&(Pr.logger.info("sync::notifyDataAsync: on offline filter sys msgs",Ir.length),Yr.onofflinefiltersysmsgs(Ir)),Tr&&(Pr.logger.info("sync::notifyDataAsync: on offline custom sys msgs",Tr.length),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_6),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_18),Yr.onofflinecustomsysmsgs(Tr)),kr&&(Pr.logger.info("sync::notifyDataAsync: on offline filter custom sys msgs",kr.length),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_101),Yr.onofflinefiltercustomsysmsgs(kr)),Ar&&(Ar=ae.merge({},Pr.sysMsgUnread,Ar),Pr.sysMsgUnread=ae.merge({},Ar),Pr.logger.info("sync::notifyDataAsync: on sysMsgUnread",Ar),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_6),Yr.onsysmsgunread(Ar));var Bn=Pr.getPushNotificationMultiportConfig();Pr.logger.info("sync::notifyDataAsync: on pushNotificationMultiportConfig",Bn),Pr.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_13),Yr.onPushNotificationMultiportConfig(Bn);var Xn=No.length&&Math.max.apply(Math,No);if(bo=po.length&&Math.max.apply(Math,po),Nr.enable){var ko=[];Xn&&ko.push(Pr.db.updateSuperTeamRoamingMsgTimetag(Xn)),bo&&ko.push(Pr.db.updateRoamingMsgTimetag(bo)),o.all(ko).then(ho).catch(ho)}else Pr.timetags.superTeamRoamingMsgs=Xn,Pr.timetags.roamingMsgs=bo||Pr.timetags.roamingMsgs,ho();Pr.syncPromiseArray=[],Pr.syncResult={}}function ho(){if(Pr.processUnsettledMsgs(),Pr.msgPromise.then(function(){Pr.canHandleDeletedMsgInSyncing=!0,y(function(){Pr.processUnsettledSysMsgs()},0)}),Pr.syncing&&Yr.onsyncdone(),Pr.syncing=!1,Pr.reporterHook.emit("reporter/syncComplete"),Yr.syncTeamMembers&&or&&or.length)throw new Ne("sync team members api deprecated!")}Ur&&Ur.length?o.all(Ur).then(Yn).catch(function(bo){Yn(),Pr.logger.error(bo),bo.callFunc="sync::onSyncDone",bo.message="afterSync syncNormalPromise 出错",Pr.onCustomError("SYNC_promiseArray_ERROR",bo)}):Yn()},he.syncTeamMembers=function(Ie){var ie,Ve,Ue=this;Ue.timetags,Ve={},c(Ie).call(Ie,function(Dt){Ve[Dt.teamId]=0},Ue),Ue.sendCmd("syncTeamMembers",{sync:Ve},s(ie=Ue.onSyncTeamMembers).call(ie,Ue))},he.onSyncTeamMembers=function(Ie){Ie.callFunc="sync::onSyncTeamMembers",Ie.message="同步群成员错误",this.onCustomError("SYNC_TEAM_MEMBERS_ERROR",Ie)},he.onSyncTeamMembersDone=function(){var Ie,ie=this,Ve=ie.db,Ue=ie.options,Dt=ie.syncTeamMembersResult,tr=ie.syncTeamMembersPromiseArray;function dr(){ie.logger.log("sync::onSyncTeamMembersDone: afterSync",ae.promises2cmds(tr)),tr=[],Ve.enable&&!ie.hasSyncedTeamMembers?(ie.hasSyncedTeamMembers=!0,function(){if(!Ue.syncTeams||!Ue.syncTeamMembers)return hr();Ve.getTeams().then(function(Fe){c(Fe).call(Fe,function(or){var ir=or.teamId;Ie=new o(function($e,er){ie.api.getTeamMembers({teamId:ir,done:function(nr,Pt){nr&&er({callFunc:"sync::getTeamMembers: teamId-".concat(ir),message:"sync team members error"}),Dt[ir]=Pt.members||[],$e()}})}),tr.push(Ie)}),tr.length?o.all(tr).then(fr,function(or){or.callFunc="sync::onSyncTeamMembersDone",or.message="pullFullData promiseArray notifyData 错误",ie.onCustomError("SYNC_TEAM_MEMBERS_ERROR",or)}):fr()},function(Fe){Fe.callFunc="sync::onSyncTeamMembersDone",Fe.message="pullFullData getTeams 错误",ie.onCustomError("SYNC_TEAM_MEMBERS_ERROR",Fe)})}()):fr()}function fr(){y(sr,0)}function sr(){var Fe,or,ir;c(Fe=d(Dt)).call(Fe,function($e){g($e).call($e,"invalid")===-1&&(or=Dt[$e],ir=Dt[$e+"-invalid"]||[],or.invalid=ir,function(er,nr){ie.logger.info("sync::onSyncTeamMembersDone: onTeamMembers",er,re(nr),nr),Ue.onteammembers({teamId:er,members:nr})}($e,or))}),hr()}function hr(){ie.logger.info("sync::onSyncTeamMembersDone: bingo"),Ue.onsyncteammembersdone(),ie.syncTeamMembersResult=null,ie.syncTeamMembersPromiseArray=null}tr.length?o.all(tr).then(dr,function(Fe){Fe.callFunc="sync::onSyncTeamMembersDone",Fe.message="同步群成员 syncTeamMembersPromiseArray 错误",ie.onCustomError("SYNC_TEAM_MEMBERS_ERROR",Fe)}).catch(function(Fe){ie.logger.log("sync::onSyncTeamMembersDone: syncTeamMembersPromiseArray promise ",Fe),dr()}):dr()}},function(t,r,e){var n=e(784),o=e(788),s=e(748),a=e(792);t.exports=function(i){return n(i)||o(i)||s(i)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(745),o=e(746);t.exports=function(s){if(n(s))return o(s)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(786)},function(t,r,e){var n=e(787);t.exports=n},function(t,r,e){var n=e(298);t.exports=n},function(t,r,e){var n=e(153),o=e(70),s=e(747);t.exports=function(a){if(n!==void 0&&o(a)!=null||a["@@iterator"]!=null)return s(a)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(790)},function(t,r,e){var n=e(791);t.exports=n},function(t,r,e){var n=e(299);t.exports=n},function(t,r){t.exports=function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(794);t.exports=n},function(t,r,e){e(795);var n=e(12);t.exports=n.Object.values},function(t,r,e){var n=e(1),o=e(796).values;n({target:"Object",stat:!0},{values:function(s){return o(s)}})},function(t,r,e){var n=e(27),o=e(11),s=e(118),a=e(43),i=o(e(148).f),u=o([].push),c=function(d){return function(m){for(var v,g=a(m),b=s(g),T=b.length,k=0,y=[];T>k;)v=b[k++],n&&!i(g,v)||u(y,d?[v,g[v]]:g[v]);return y}};t.exports={entries:c(!0),values:c(!1)}},function(t,r,e){t.exports=e(798)},function(t,r,e){var n=e(799);t.exports=n},function(t,r,e){var n=e(21),o=e(800),s=Array.prototype;t.exports=function(a){var i=a.findIndex;return a===s||n(s,a)&&i===s.findIndex?o:i}},function(t,r,e){e(801);var n=e(30);t.exports=n("Array").findIndex},function(t,r,e){var n=e(1),o=e(84).findIndex,s=e(195),a=!0;"findIndex"in[]&&Array(1).findIndex(function(){a=!1}),n({target:"Array",proto:!0,forced:a},{findIndex:function(i){return o(this,i,arguments.length>1?arguments[1]:void 0)}}),s("findIndex")},function(t,r,e){var n=e(8),o=e(9),s=e(3),a=e(2),i=e(35).fn,u=e(0),c=u.objs2accounts,d=e(803),m=e(202);i.processUser=function(v){var g,b=this,T=b.db,k=v.obj,y=v.error,A=v.content;switch(v.cmd){case"markInBlacklist":y||b.markInBlacklist(k);break;case"syncMarkInBlacklist":b.markInBlacklist(A,!0);break;case"markInMutelist":y||b.markInMutelist(k);break;case"syncMarkInMutelist":b.markInMutelist(A,!0);break;case"getRelations":y||b.onRelations(v);break;case"syncMyInfo":b.onMyInfo(v,!0);break;case"updateMyInfo":y||(k.user.updateTime=A.timetag,b.onUpdateMyInfo(v,k.user));break;case"syncUpdateMyInfo":b.onUpdateMyInfo(v,A.user,!0);break;case"getUsers":var V;y||(g=n(V=A.users).call(V,function(he){return he=o(m).call(m,he,b.mixStorePolicy&&b.mixStorePolicy.s3Policy?b.mixStorePolicy.s3Policy.dlcdns:[],b.mixStorePolicy&&b.mixStorePolicy.s3Policy?b.mixStorePolicy.s3Policy.dlcdn:""),b.mergeUser(he),he}),v.obj=g,T.enable&&T.putUsers(g));break;case"updateDonnop":b.onUpdateDonnop(v);break;case"syncUpdateDonnop":b.onDonnop(v,!1)}},i.onMyInfo=function(v){var g,b=this,T=b.db,k=v.error,y=v.content,A=new s(function(he,ae){var Ne,_e;k?(k&&(k.callFunc="user::onMyInfo"),he(k),b.syncData()):(g=o(m).call(m,y.user),T.enable?(Ne=he,_e=ae,T.mergeMyInfo(g,!0).then(function(){V(),Ne()}).then(void 0,function(Ce){Ce.message="db.mergeMyInfo error",Ce.callFunc="user::onMyInfo",_e(Ce)})):(V(),he()))}).catch(function(he){return b.logger.error("user::onMyInfo: ",he),s.reject(he)});function V(){b.timetags.myInfo=g.updateTime,b.syncResult.myInfo=g}A.cmd="myInfo",b.syncPromiseArray.push(A)},i.onUpdateMyInfo=function(v,g,b){var T=this.db,k=o(m).call(m,g),y=u.merge(this.myInfo,k);this.myInfo=y,b?(this.logger.info("user::onUpdateMyInfo:",y&&y.account),this.options.onupdatemyinfo(y)):v.obj=y,T.enable&&(k.account=this.account,T.updateUser(k))},i.onRelations=function(v){var g,b=this,T=b.db,k=v.error,y=b.packetFromSync(v),A=v.content.specialRelations,V=!0,he=[],ae=[],Ne=[],_e=[],Ce=new s(function(ue,ze){var le,de;k?y&&(ue(k),b.syncData()):(a(A).call(A,function(Ie){var ie={account:(Ie=d.parse(Ie)).account,createTime:Ie.createTime,updateTime:Ie.updateTime};Ie.isBlacked?he.push(ie):ae.push(ie),Ie.isMuted?Ne.push(ie):_e.push(ie)}),b.logger.info("user::onRelations: parse blacklist",c(he),he,"delete",c(ae),ae),b.logger.info("user::onRelations: parse mutelist",c(Ne),Ne,"delete",c(_e),_e),A.length?(V=!0,g=v.content.timetag):V=!1,T.enable?(le=ue,de=ze,v.promise=new s(function(Ie,ie){function Ve(){y?(re(),Ie(),le()):T.getRelations().then(function(Ue){he=Ue[0],Ne=Ue[1],re(),Ie(),le()}).then(void 0,function(Ue){Ue.message="db.getRelations error",Ue.callFunc="user::onRelations",ie(Ue),de(Ue)})}V?T.mergeRelations(he,ae,Ne,_e,g).then(function(){Ve()}).then(void 0,function(Ue){Ue.message="db.mergeRelations error",Ue.callFunc="user::onRelations",ie(Ue),de(Ue)}):(b.logger.warn("user::onRelations: no relations need merge"),Ve())}).then(void 0,function(Ie){throw Ie.message="merge relations data error",Ie.callFunc="user::onRelations",de(Ie),Ie})):(re(),ue()))}).catch(function(ue){return b.logger.error("user::onRelations: ",ue),s.reject(ue)});function re(){b.timetags.relations=g,he.invalid=ae,Ne.invalid=_e,y?(b.syncResult.blacklist=he,b.syncResult.mutelist=Ne,b.syncResult.invalidBlacklist=ae,b.syncResult.invalidMutelist=_e):(b.logger.info("user::onRelations: get relations",he,Ne),v.obj.blacklist=he,v.obj.mutelist=Ne)}y&&(Ce.cmd="relations",b.syncPromiseArray.push(Ce))},i.markInBlacklist=function(v,g){var b=this.db;v.record={account:v.account,updateTime:+new Date},b.enable&&b.markInBlacklist(v),g&&(this.logger.info("user::markInBlacklist:",v),this.options.onsyncmarkinblacklist(v))},i.markInMutelist=function(v,g){var b=this.db;v.record={account:v.account,updateTime:+new Date},b.enable&&b.markInMutelist(v),g&&(this.logger.info("user::markInMutelist:",v),this.options.onsyncmarkinmutelist(v))},i.mergeUser=function(v){this.userSet[v.account]=v}},function(t,r,e){var n=e(0);function o(){}o.parse=function(s){var a=n.copy(s);return a.isBlacked=a.isBlacked==="1",a.isMuted=a.isMuted==="1",a.createTime=+a.createTime,a.updateTime=+a.updateTime,a},t.exports=o},function(t,r,e){var n=e(120),o=e(2),s=e(9),a=e(3),i=e(7),u=e(8),c=["type"],d=e(35).fn,m=e(0),v=m.objs2accounts,g=e(750),b=e(202);d.processFriend=function(T){var k=T.obj,y=T.content,A=T.error;switch(T.cmd){case"friendRequest":this.updateFriendSysMsg(T),A||this.onFriendRequest(k);break;case"syncFriendRequest":this.onFriendRequest(y,!0);break;case"deleteFriend":A||this.onDeleteFriend(k);break;case"syncDeleteFriend":this.onDeleteFriend(y,!0);break;case"updateFriend":A||this.onUpdateFriend(k);break;case"syncUpdateFriend":this.onUpdateFriend(y.friend,!0);break;case"getFriends":this.getFriends(T);break;case"syncFriends":this.onFriends(T);break;case"syncFriendUsers":this.onFriendUsers(T)}},d.getFriends=function(T){var k=T.content.friends,y=[],A=[];o(k).call(k,function(V){(V=s(g).call(g,V)).valid?y.push(V):A.push(V)}),y.invalid=A,T.obj=y},d.onFriends=function(T){var k,y=this,A=y.db,V=T.error,he=T.content.friends,ae=!0,Ne=[],_e=[],Ce=new a(function(ue,ze){var le,de;V?ze(V):(function(){ae&&o(he).call(he,function(Ie){(Ie=s(g).call(g,Ie)).valid?Ne.push(Ie):_e.push(Ie)}),y.logger.info("friend::onFriends: parse friends",v(Ne),"delete",v(_e)),he.length?(ae=!0,k=T.content.timetag):ae=!1}(),A.enable?(le=ue,de=ze,T.promise=new a(function(Ie,ie){function Ve(){re(),Ie(),le()}ae?A.mergeFriends(Ne,_e,k).then(function(){Ve()}).then(void 0,function(Ue){Ue._msg="merge friends error",ie(Ue),de(Ue)}):(y.logger.info("friend::onFriends: no merge friends"),Ve())}).then(void 0,function(Ie){throw Ie._msg="merge friends data error",de(Ie),Ie})):(re(),ue()))}).catch(function(ue){return y.logger.error("friend::onFriends: ",ue),a.reject(ue)});function re(){var ue,ze;y.timetags.friends=k,Ne.invalid=_e,y.syncResult.friends=i(ue=y.syncResult.friends||[]).call(ue,Ne||[]),y.syncResult.invalidFriends=i(ze=y.syncResult.invalidFriends||[]).call(ze,_e||[])}Ce.cmd="friends",y.syncPromiseArray.push(Ce)},d.onFriendRequest=function(T,k){var y=a.resolve(),A=this.db,V=T.type,he=n(T,c);if((V=T.type=g.getTypeFromByte(V)||V)==="addFriend"||V==="passFriendApply"){var ae=T.friend=g.assembleFriend(he);A.enable&&(y=A.putFriend(ae))}return k&&this.onSyncFriendAction(T),y},d.onSyncFriendAction=function(T){this.logger.info("friend::onSyncFriendActionon: ".concat(T.type,", "),T.account),this.options.onsyncfriendaction(T)},d.onDeleteFriend=function(T,k){var y=a.resolve(),A=this.db;return A.enable&&(y=A.deleteFriend(T.account)),k&&(T.type="deleteFriend",this.onSyncFriendAction(T)),y},d.onUpdateFriend=function(T,k){var y=this.db,A=s(g).call(g,T);y.enable&&y.updateFriend(A),k&&this.onSyncFriendAction({type:"updateFriend",friend:A})},d.onFriendUsers=function(T){var k,y,A=this.db,V=T.content,he=u(k=V.users).call(k,function(_e){return s(b).call(b,_e)});this.logger.info("friend::onFriendUsers: parse users",v(he));var ae=V.timetag,Ne=a.resolve();A.enable&&(Ne=A.mergeFriendUsers(he,ae)),this.timetags.friendUsers=ae,Ne.cmd="friendUsers",this.syncPromiseArray.push(Ne),this.syncResult.users=i(y=this.syncResult.users||[]).call(y,he||[]),this.syncing||this.onSyncDone()},d.updateFriendSysMsg=function(T){var k,y,A=T.obj,V=T.error;if(T.obj.idServer){if(V)k="error",V=m.filterObj(V,"code message");else{var he=A.type;switch(he=g.getTypeFromByte(he)||he){case"passFriendApply":k="passed";break;case"rejectFriendApply":k="rejected"}}y={idServer:A.idServer,state:k,from:A.account,type:"applyFriend"},V&&(y.error=V),this.updateSysMsg(y)}}},function(t,r,e){var n=e(32),o=e(17),s=e(35).fn,a=e(0);s.onRobots=function(i){var u=i.content;if(a.isFunction(this.options.onrobots)&&n(u.robots)){var c,d=o(c=u.robots).call(c,function(m){return!!m.botid});d.length>0&&this.options.onrobots(d||[])}}},function(t,r,e){var n=e(9),o=e(2),s=e(26),a=e(170),i=e(3),u=e(8),c=e(17),d=e(5),m=e(35).fn,v=e(0),g=v.objs2accounts,b=v.teams2ids,T=e(191),k=e(150);m.processTeam=function(y){var A,V,he,ae=y.error;switch(y.obj===void 0&&(y.obj={}),y.cmd){case"createTeam":A=y.obj.team,ae||(A=y.content.team),A=n(T).call(T,A),y.obj.team=A,he=k.assembleOwner(A),y.obj.owner=he,ae||(this.logger.info("team::processTeam: create team ",A&&A.teamId,he&&he.account),this.onCreateTeam(A,he));break;case"syncCreateTeam":A=n(T).call(T,y.content.team),he=k.assembleOwner(A),this.logger.info("team::processTeam: sync createTeam",A&&A.teamId,he&&he.account),this.options.onsynccreateteam(A,he),this.onCreateTeam(A,he);break;case"sendSuperTeamMsg":case"sendTeamMsg":this.onSendMsg(y);break;case"teamMsg":this.onMsg(y);break;case"teamMsgs":this.onMsgs(y);break;case"addTeamMembers":case"removeTeamMembers":case"leaveTeam":case"dismissTeam":case"addTeamManagers":case"removeTeamManagers":case"transferTeam":break;case"updateInfoInTeam":ae||((V=y.obj).account=this.account,V.id=k.genId(V.teamId,V.account),V=n(k).call(k,V),y.obj=V,this.mergeMyTeamMembers(V),this.onUpdateTeamMember(V));break;case"updateNickInTeam":y.obj=n(k).call(k,y.obj);break;case"updateTeam":y.obj=n(T).call(T,y.obj,!0);break;case"applyTeam":y.error||(y.obj=n(T).call(T,y.content.team));break;case"passTeamApply":this.updateTeamSysMsgState(y,"passed");break;case"rejectTeamApply":this.updateTeamSysMsgState(y,"rejected");break;case"acceptTeamInvite":this.updateTeamSysMsgState(y,"passed"),y.error||(y.obj=n(T).call(T,y.content.team));break;case"rejectTeamInvite":this.updateTeamSysMsgState(y,"rejected");break;case"getTeam":y.error||(y.obj=n(T).call(T,y.content.team));break;case"getTeams":this.onTeams(y);break;case"getTeamMembers":this.onTeamMembers(y);break;case"syncTeams":this.onTeams(y);break;case"syncTeamMembers":this.onTeamMembers(y);break;case"getTeamHistoryMsgs":case"searchTeamHistoryMsgs":this.onHistoryMsgs(y);break;case"syncSendTeamMsg":this.onMsg(y);break;case"notifyTeamMsgReads":this.onTeamMsgReceipt(y);break;case"syncUpdateTeamMember":(V=n(k).call(k,y.content.teamMember)).account===this.account&&this.mergeMyTeamMembers(V),this.onUpdateTeamMember(V);break;case"updateMuteStateInTeam":break;case"getMyTeamMembers":y.error||(y.obj=k.reverseMembers(y.content.teamMembers));break;case"getMutedTeamMembers":y.error||(y.obj={teamId:y.obj.teamId,members:k.reverseMembers(y.content.teamMembers)});break;case"syncMyTeamMembers":this.onSyncMyTeamMembers(y);break;case"sendTeamMsgReceipt":this.sendTeamMsgReceipt(y);break;case"getTeamMsgReads":this.getTeamMsgReads(y);break;case"getTeamMsgReadAccounts":this.getTeamMsgReadAccounts(y);break;case"getTeamsById":this.getTeamsById(y)}},m.getTeamMsgReads=function(y){var A=this;if(y.error)this.logger.error("team::sendTeamMsgReceipt: ",y.error);else{var V=v._get(y,"content.teamMsgReceipts")||[];if(this.db.enable){var he=[];o(V).call(V,function(ae){ae.idClient&&he.push({idClient:ae.idClient,unread:+ae.unread,read:+ae.read})}),he.length>0&&s(function(){return A.db.updateMsgBatch(he)},0)}}},m.getTeamMsgReadAccounts=function(y){if(y.error)this.logger.error("team::getTeamMsgReadAccounts: ",y.error);else{var A=v._get(y,"content.readAccounts")||[],V=v._get(y,"content.unreadAccounts")||[],he=v._get(y,"content.teamMsgReceipt.idClient")||[];this.db.enable&&this.db.putMsgReadDetail({idClient:he,readAccounts:A,unreadAccounts:V})}},m.sendTeamMsgReceipt=function(y){var A=this;if(y.error)this.logger.error("team::sendTeamMsgReceipt: ",y.error);else{var V=v._get(y,"obj.teamMsgReceipts")||[],he=v._get(y,"content.teamMsgReceipts")||[];if(this.db.enable){var ae=[];o(V).call(V,function(Ne){a(he).call(he,function(_e){return Ne.idServer===_e.idServer})||ae.push({idClient:Ne.idClient,hasRead:!0})}),ae.length>0&&(this.logger.log("sendTeamMsgReceipt::updateMsgBatch"),s(function(){return A.db.updateMsgBatch(ae)},0))}}},m.onCreateTeam=function(y,A){var V=this.db;V.enable&&(V.putTeam(y),V.putTeamMembers(A)),this.options.onCreateTeam(y,A)},m.onTeams=function(y){y.content=y.content||{};var A,V=this,he=V.db,ae=V.packetFromSync(y),Ne=y.content.teams||[],_e=!0,Ce=[],re=[];if(y.error)switch(y.error.code){case 803:y.error=null,_e=!1}var ue=new i(function(le,de){var Ie,ie;y.error?ae&&de(y.error):(function(){_e&&o(Ne).call(Ne,function(Ve){(Ve=n(T).call(T,Ve)).validToCurrentUser?Ce.push(Ve):re.push(Ve)}),Ne.length?(_e=!0,A=y.content.timetag):_e=!1}(),he.enable?(Ie=le,ie=de,y.promise=new i(function(Ve,Ue){function Dt(){ae?(ze(),Ve(),Ie()):he.getTeams().then(function(tr){Ce=tr,ze(),Ve(),Ie()}).catch(function(tr){tr.message="db.getTeams error",tr.callFunc="team::afterMergeData",Ue(tr),ie(tr)})}_e?he.mergeTeams(Ce,re,A).then(function(){Dt()}).catch(function(tr){var dr={callFunc:"team::onTeams:mergeData",message:"db.mergeTeams error",event:tr};Ue(dr),ie(dr)}):(V.logger.warn("team::onTeams:mergeData: no teams need merge"),Dt())}).then(void 0,function(Ve){throw Ve.message="merge teams data error",Ve.callFunc="team::mergeData",ie(Ve),Ve})):(ze(),le()))}).catch(function(le){return V.logger.error("team::onTeams: ",le),i.reject(le)});function ze(){V.timetags.teams=A,Ce.invalid=re,ae?(V.syncResult.teams=Ce,V.syncResult.invalidTeams=re,V.syncing||V.onSyncDone()):(V.logger.info("team::onTeams: not in syncing, get teams",b(Ce)),y.obj=Ce)}ae&&(ue.cmd="teams",V.syncPromiseArray.push(ue))},m.getTeamsById=function(y){var A;if(y.error){if(y.error.code!==816)return;this.logger.error("team::getTeamsById: ",y.error),y.error=null}y.content.teams=u(A=y.content.teams).call(A,function(V){return n(T).call(T,V)}),y.obj=y.content},m.onTeamMembers=function(y){y.content=y.content||{};var A,V,he=this,ae=he.packetFromSync(y),Ne=y.content.members||[],_e=!0,Ce=[],re=[];if(y.obj&&(V=y.obj.teamId),V||(V=y.content.teamId),V=""+V,y.error)switch(y.error.code){case 406:y.error=null,_e=!1}var ue=new i(function(ze,le){y.error?ae&&(he.logger.error("team::onTeamMember: team error:",V,y.error),le({callFunc:"team::onTeamMembers",event:y.error,message:"teamId-".concat(V," 获取群成员错误")})):(function(){_e&&o(Ne).call(Ne,function(de){(de=n(k).call(k,de)).valid?Ce.push(de):re.push(de)}),Ne.length?(_e=!0,A=y.content.timetag):_e=!1}(),Ce.invalid=re,ae?(he.syncTeamMembersResult[V]=Ce,he.syncTeamMembersResult[V+"-invalid"]=re,he.timetags["team-"+V]=A):(he.logger.info("team::onTeamMembers: not syncing, get members",V,g(Ce)),y.obj={teamId:V,members:Ce}),ze())});ae&&(ue.cmd=V,he.syncTeamMembersPromiseArray.push(ue))},m.onUpdateTeamMember=function(y){if(y.updateTime||(y.updateTime=+new Date),this.logger.info("team::onUpdateTeamMember: ",y&&y.account),this.options.onupdateteammember(v.simpleClone(y)),this.account===y.account){var A=this.myTeamMembersMap[y.teamId];this.logger.info("team::onMyTeamMembers: ",[A]),this.options.onMyTeamMembers(v.simpleClone([A]))}var V={teamId:y.teamId,memberUpdateTime:y.updateTime};this.onUpdateTeam(V);var he=this.db;he.enable&&he.updateTeamMember(y)},m.onUpdateTeam=function(y){this.logger.info("team::onUpdateTeam:",y&&y.teamId),this.options.onUpdateTeam(v.simpleClone(y));var A=this.db;A.enable&&A.updateTeam(y)},m.onSyncMyTeamMembers=function(y){var A=this,V=A.db,he=k.reverseMembers(y.content.teamMembers);if(V.enable){var ae=V.putTeamMembers(he).then(function(){return V.updateMyTeamMembersTimetag(y.content.timetag)}).catch(function(Ne){return A.logger.error("team::syncMyTeamMember: ",Ne),i.reject(Ne)});ae.cmd="myTeamMembers",A.syncTeamMembersPromiseArray.push(ae),A.syncPromiseArray.push(ae)}else A.syncResult.myTeamMembers=he;A.mergeMyTeamMembers(he)},m.mergeMyTeamMembers=function(y){v.isArray(y)||(y=[y]);var A=this.myTeamMembersMap=this.myTeamMembersMap||{};o(y).call(y,function(V){var he=V.teamId;A[he]=v.merge(A[he],V)})},m.notifyForNewTeamMsg=function(y){v.isArray(y)||(y=[y]);var A=this,V=this.myTeamMembersMap||{},he={},ae=[];o(y).call(y,function(_e){v.exist(V[_e])?he[_e]=V[_e].muteNotiType:ae.push(_e)});var Ne=i.resolve({map:he});return ae.length&&(Ne=A.api.getMyTeamMembers({teamIds:ae,promise:!0}).then(function(_e){A.mergeMyTeamMembers(_e),o(_e).call(_e,function(re){he[re.teamId]=re.muteNotiType});var Ce=c(y).call(y,function(re){return!he[re]});return i.resolve({map:he,miss:Ce})}).catch(function(_e){return d(he).length>0?i.resolve({map:he,miss:ae,error:_e}):i.reject(_e)})),Ne},m.updateTeamSysMsgState=function(y,A){var V,he=y.error;he&&(A="error",he=v.filterObj(he,"code message")),V={idServer:y.obj.idServer,state:A,from:y.obj.from,type:y.obj.type},he&&(V.error=he),this.updateSysMsg(V)},m.onTeamMsgReceipt=function(y){var A=y.content,V=y.error;V&&this.logger.error("team::onTeamMsgReceipt:",V),A&&A.teamMsgReceipts&&(this.options.onTeamMsgReceipt(A),this.options.onMsgReceipts(A.teamMsgReceipts))}},function(t,r,e){var n=e(9),o=e(3),s=e(2),a=e(35).fn,i=e(0),u=i.teams2ids,c=e(306),d=e(201);a.processSuperTeam=function(m){var v,g,b,T=m.error;switch(m.obj===void 0&&(m.obj={}),m.cmd){case"sendSuperTeamMsg":this.onSendMsg(m);break;case"superTeamMsg":this.onMsg(m);break;case"sendSuperTeamCustomSysMsg":this.onSendSysMsg(m);break;case"superTeamCustomSysMsg":this.onSysMsg(m);break;case"syncSuperTeams":this.onSuperTeams(m);break;case"syncCreateSuperTeam":v=n(c).call(c,m.content.team),b=d.assembleOwner(v),this.logger.info("team::processTeam: sync createTeam",v&&v.teamId,b&&b.account),this.options.onSyncCreateSuperTeam(v,b),this.onCreateSuperTeam(v,b);break;case"getSuperTeamHistoryMsgs":case"searchSuperTeamHistoryMsgs":this.onHistoryMsgs(m);break;case"syncSendSuperTeamMsg":this.onMsg(m);break;case"addSuperTeamMembers":case"removeSuperTeamMembers":case"leaveSuperTeam":case"addSuperTeamManagers":case"removeSuperTeamManagers":case"transferSuperTeam":break;case"updateInfoInSuperTeam":T||((g=m.obj).account=this.account,g.id=d.genId(g.teamId,g.account),g=n(d).call(d,g),m.obj=g,this.mergeMySuperTeamMembers(g),this.onUpdateSuperTeamMember(g));break;case"updateNickInTeam":m.obj=n(d).call(d,m.obj);break;case"syncUpdateSuperTeamMember":(g=n(d).call(d,m.content.teamMember)).account===this.account&&this.mergeMySuperTeamMembers(g),this.onUpdateSuperTeamMember(g);break;case"updateSuperTeam":m.obj=n(c).call(c,m.obj,!0);break;case"getSuperTeam":m.error||(m.obj=n(c).call(c,m.content.team));break;case"getSuperTeams":this.onSuperTeams(m);break;case"syncSuperTeamMembers":this.onSyncSuperTeamMembers(m);break;case"syncMySuperTeamMembers":this.onSyncMySuperTeamMembers(m);break;case"getSuperTeamMembers":m.error||this.onGetAllSuperTeamMembers(m);break;case"getSuperTeamMembersByJoinTime":case"getSuperTeamMembersByAccounts":case"getMutedSuperTeamMembers":m.error||this.onSuperTeamMembers(m);break;case"onDeleteSuperTeamMsg":this.onDeleteMsg(m);break;case"onSuperTeamMsgDelete":case"syncDeleteSuperTeamMsg":this.onMsgDeleted(m,!0);break;case"onMarkSuperTeamSessionAck":this.onMarkSessionAck(m);break;case"syncMarkSuperTeamSessionAck":this.syncMarkSessionAck(m);break;case"passSuperTeamApply":this.updateSuperTeamSysMsgState(m,"passed");break;case"rejectSuperTeamApply":this.updateTeamSysMsgState(m,"rejected");break;case"acceptSuperTeamInvite":this.updateTeamSysMsgState(m,"passed");break;case"rejectSuperTeamInvite":this.updateSuperTeamSysMsgState(m,"rejected")}},a.onSuperTeams=function(m){m.content=m.content||{};var v,g=this,b=g.db,T=g.packetFromSync(m),k=m.content.teams||[],y=!0,A=[],V=[];if(m.error)switch(m.error.code){case 803:m.error=null,y=!1}var he=new o(function(Ne,_e){var Ce,re;m.error?T&&_e(m.error):(function(){y&&s(k).call(k,function(ue){(ue=n(c).call(c,ue)).validToCurrentUser?A.push(ue):V.push(ue)}),k.length?(y=!0,v=m.content.timetag):y=!1}(),b.enable?(Ce=Ne,re=_e,m.promise=new o(function(ue,ze){function le(){T?(ae(),ue(),Ce()):b.getSuperTeams().then(function(de){A=de,ae(),ue(),Ce()}).then(void 0,function(de){de.message="db.getSuperTeams error",de.callFunc="superTeam::afterMergeData",ze(de),re(de)})}y?b.mergeSuperTeams(A,V,v).then(function(){le()}).then(void 0,function(de){var Ie={callFunc:"superTeam::onSuperTeams:mergeData",message:"db.mergeSuperTeams error",event:de};ze(Ie),re(Ie)}):(g.logger.warn("superTeam::onSuperTeams:mergeData: no teams need merge"),le())}).then(void 0,function(ue){throw ue.message="merge teams data error",ue.callFunc="superTeam::mergeData",re(ue),ue})):(ae(),Ne()))}).catch(function(Ne){return g.logger.error("superTeam::onSuperTeams: ",Ne),o.reject(Ne)});function ae(){g.timetags.superTeams=v,A.invalid=V,T?(g.syncResult.superTeams=A,g.syncResult.invalidSuperTeams=V):(g.logger.info("superTeam::onSuperTeams: not in syncing, get teams",u(A)),m.obj=A)}T&&(he.cmd="superteams",g.syncPromiseArray.push(he))},a.onCreateSuperTeam=function(m,v){var g=this.db;g.enable&&(g.putSuperTeam(m),g.putSuperTeamMembers(v))},a.onGetAllSuperTeamMembers=function(m){var v=this,g=this.db,b=m.raw.ser,T=this.superTeamMembersData[b]||{},k=T.teamId||m.obj&&m.obj.teamId;if(g.enable){var y=m.content&&m.content.timetag,A=m.raw.code===200?o.all(T.pArr):o.resolve();m.promise=A.then(function(){return g.getSuperTeamMembers(k).then(function(V){y&&g.updateSuperTeamMemberTimetag(k,y),m.obj={members:V,invalid:[],teamId:k}})}).catch(function(V){return v.logger.error(V)})}else m.obj={members:T.members,invalid:T.invalid,teamId:k};this.superTeamMembersData[b]=void 0},a.onSyncSuperTeamMembers=function(m){var v,g=this.db,b=[],T=[],k=m.content.members||[],y=m.raw.ser;if(m.obj&&(v=m.obj.teamId),v||(v=m.content.teamId),s(k).call(k,function(he){(he=n(d).call(d,he)).valid?T.push(he):b.push(he)}),g.enable){this.superTeamMembersData[y]=this.superTeamMembersData[y]||{teamId:v,pArr:[]};var A=o.resolve();m.content&&m.content.isAll&&(A=g.deleteSuperTeamMembers(v));var V=A.then(function(){return g.mergeSuperTeamMembers(v,T,b)}).then(function(){return o.resolve()});this.superTeamMembersData[y].pArr.push(V)}else this.superTeamMembersData[y]=this.superTeamMembersData[y]||{teamId:v,members:[],invalid:[]},T.length&&(this.superTeamMembersData[y].members=this.api.mergeTeamMembers(this.superTeamMembersData[y].members,T)),b.length&&(this.superTeamMembersData[y].invalid=this.api.mergeTeamMembers(this.superTeamMembersData[y].invalid,b));m.raw=void 0},a.onSyncMySuperTeamMembers=function(m){var v=this,g=v.db,b=d.reverseMembers(m.content.teamMembers);if(g.enable){var T=g.putSuperTeamMembers(b).then(function(){return g.updateMySuperTeamMembersTimetag(m.content.timetag)}).catch(function(k){return v.logger.error("superTeam::syncMySuperTeamMember: ",k),o.reject(k)});v.syncPromiseArray.push(T)}else v.syncResult.mySuperTeamMembers=b;v.mergeMySuperTeamMembers(b)},a.onSuperTeamMembers=function(m,v){var g,b=this.db,T=[],k=[],y=m.content.members||[];s(y).call(y,function(A){(A=n(d).call(d,A)).valid?k.push(A):T.push(A)}),m.obj&&(g=m.obj.teamId),g||(g=m.content.teamId||k[0]&&k[0].teamId),b.enable&&!v&&b.mergeSuperTeamMembers(g,k,T),m.obj={members:k,invalid:T,teamId:g}},a.onUpdateSuperTeamMember=function(m){if(m.updateTime||(m.updateTime=+new Date),this.logger.info("superTeam::onUpdateSuperTeamMember: ",m&&m.account),this.options.onUpdateSuperTeamMember(i.simpleClone(m)),this.account===m.account){var v=this.mySuperTeamMembersMap[m.teamId];this.logger.info("superTeam::onMySuperTeamMembers: ",[v]),this.options.onMySuperTeamMembers(i.simpleClone([v]))}var g={teamId:m.teamId,memberUpdateTime:m.updateTime};this.onUpdateSuperTeam(g);var b=this.db;b.enable&&b.updateSuperTeamMember(m)},a.onUpdateSuperTeam=function(m){this.logger.info("superteam::onUpdateSuperTeam:",m&&m.teamId),this.options.onUpdateSuperTeam(i.simpleClone(m));var v=this.db;v.enable&&v.updateSuperTeam(m)},a.mergeMySuperTeamMembers=function(m){i.isArray(m)||(m=[m]);var v=this.mySuperTeamMembersMap=this.mySuperTeamMembersMap||{};s(m).call(m,function(g){var b=g.teamId;v[b]=i.merge(v[b],g)})},a.updateSuperTeamSysMsgState=function(m,v){var g,b=m.error;b&&(v="error",b=i.filterObj(b,"code message")),g={idServer:m.obj.idServer,state:v,from:m.obj.from,type:m.obj.type},b&&(g.error=b),this.updateSysMsg(g)}},function(t,r,e){var n=e(9),o=e(3),s=e(26),a=e(35).fn,i=e(0),u=e(308);a.processNotify=function(c){switch(c.cmd){case"syncOfflineNetcallMsgs":case"syncOfflineMsgs":this.onOfflineMsgs(c);break;case"batchMarkRead":break;case"syncOfflineSysMsgs":case"syncOfflineSuperTeamSysMsgs":this.onOfflineSysMsgs(c);break;case"syncRoamingMsgs":case"syncSuperTeamRoamingMsgs":this.onRoamingMsgs(c);break;case"syncOfflineFilterMsgs":this.onOfflineMsgs(c,!0);break;case"syncOfflineFilterSysMsgs":this.onOfflineSysMsgs(c,!0);break;case"syncMsgReceipts":this.onOfflineMsgReceipts(c);break;case"syncDonnop":this.onDonnop(c,!0);break;case"syncSessionAck":this.syncSessionAck(c);break;case"syncSuperTeamSessionAck":this.syncSuperTeamSessionAck(c);break;case"syncRobots":this.onRobots(c);break;case"syncBroadcastMsgs":this.onBroadcastMsgs(c);break;case"syncDeleteSuperTeamMsgOfflineRoaming":this.onDeleteMsgOfflineRoaming(c);break;case"syncDeleteMsgSelf":this.syncDeleteMsgSelf(c);break;case"syncSessionsWithMoreRoaming":this.syncSessionsWithMoreRoaming(c);break;case"syncStickTopSessions":this.syncStickTopSessions(c);break;case"syncSessionHistoryMsgsDelete":this.syncSessionHistoryMsgsDelete(c)}},a.onDonnop=function(c,d){if(!c.error){var m=this,v=m.db,g=n(u).call(u,c.content.donnop);m.mergeDonnop(g);var b=m.dbDonnop();if(d){var T=c.content.timetag;m.timetags.donnop=T,v.enable&&(b=b.then(function(){return m.db.updateDonnopTimetag(T)}).catch(function(k){return m.logger.error("notify::onDonnop: ",k),o.reject(k)})),b.cmd="donnop",m.syncPromiseArray.push(b)}else m.onPushNotificationMultiportConfigUpdate()}},a.onUpdateDonnop=function(c){if(!c.error){var d=c.obj;d&&(this.mergeDonnop(i.filterObj(d,["shouldPushNotificationWhenPCOnline"])),this.dbDonnop(),this.onPushNotificationMultiportConfigUpdate())}},a.getPushNotificationMultiportConfig=function(){return i.merge({},this.pushNotificationMultiportConfig)},a.mergeDonnop=function(c){this.pushNotificationMultiportConfig=i.merge({},this.pushNotificationMultiportConfig,c)},a.dbDonnop=function(){return this.db.enable?this.db.setDonnop(this.pushNotificationMultiportConfig):o.resolve()},a.onPushNotificationMultiportConfigUpdate=function(){var c=this;s(function(){var d=c.getPushNotificationMultiportConfig();c.logger.info("link::onPushNotificationMultiportConfigUpdate:",d),c.options.onPushNotificationMultiportConfigUpdate(d)})}},function(t,r,e){var n=e(58),o=e(2),s=e(17),a=e(3),i=e(8),u=e(5),c=e(6),d=e(10),m=e(9),v=e(138),g=e(7),b=e(26),T=e(24),k=e(52),y=e(41),A=e(59),V=e(60),he=e(61),ae=e(62),Ne=e(47),_e=e(15),Ce=e(85),re=e(86),ue=e(70),ze=e(32);function le($e,er){var nr=re!==void 0&&ue($e)||$e["@@iterator"];if(!nr){if(ze($e)||(nr=function(mr,yr){var Tr;if(mr){if(typeof mr=="string")return de(mr,yr);var Ir=_e(Tr=Object.prototype.toString.call(mr)).call(Tr,8,-1);if(Ir==="Object"&&mr.constructor&&(Ir=mr.constructor.name),Ir==="Map"||Ir==="Set")return Ce(mr);if(Ir==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ir))return de(mr,yr)}}($e))||er&&$e&&typeof $e.length=="number"){nr&&($e=nr);var Pt=0,rr=function(){};return{s:rr,n:function(){return Pt>=$e.length?{done:!0}:{done:!1,value:$e[Pt++]}},e:function(mr){throw mr},f:rr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var kt,Et=!0,cr=!1;return{s:function(){nr=nr.call($e)},n:function(){var mr=nr.next();return Et=mr.done,mr},e:function(mr){cr=!0,kt=mr},f:function(){try{Et||nr.return==null||nr.return()}finally{if(cr)throw kt}}}}function de($e,er){(er==null||er>$e.length)&&(er=$e.length);for(var nr=0,Pt=new Array(er);nr<er;nr++)Pt[nr]=$e[nr];return Pt}function Ie($e,er){var nr=u($e);if(A){var Pt=A($e);er&&(Pt=s(Pt).call(Pt,function(rr){return V($e,rr).enumerable})),nr.push.apply(nr,Pt)}return nr}var ie=e(35).fn,Ve=e(0),Ue=Ve.undef,Dt=e(44),tr=e(150),dr=e(201),fr=e(152),sr=e(289),hr=e(13),Fe=e(74),or=e(72);function ir($e,er,nr){var Pt=this,rr=Pt.message.Message,kt=nr?"offlineFilterMsgs":"offlineMsgs";if(!(er&&er.length>0))return a.resolve();var Et=rr.getMaxTimetag(er),cr=er[0].scene,mr=er[0].target;Pt.markMsgRead(er),er=rr.deduplication(er),er=rr.sortMsgs(er);var yr=Pt.genSessionByMsgs(er);Pt.cacheSyncedSession(yr);var Tr=Pt.putMsg(er,"offlineMsgs").then(function(Ir){var kr=Ir;(kr=Pt.filterIgnore(kr)).length&&(Pt.logger.info("msg::onOfflineMsgs： toreLastSession",kt,$e,kr.length),Pt.syncResult[kt]=Pt.syncResult[kt]||[],Pt.syncResult[kt].push({sessionId:$e,scene:cr,to:mr,msgs:kr,timetag:Et}))}).catch(function(Ir){return Pt.logger.error("msg::onOfflineMsgs: ",Ir),a.reject(Ir)});return Tr.cmd="offlineMsgs-"+$e,Tr}ie.processMsg=function($e){switch($e.cmd){case"sendMsg":this.onSendMsg($e);break;case"msg":this.onMsg($e);break;case"sysMsg":this.onSysMsg($e);break;case"broadcastMsg":this.onBroadcastMsg($e);break;case"sendCustomSysMsg":this.onSendSysMsg($e);break;case"getHistoryMsgs":case"searchHistoryMsgs":this.onHistoryMsgs($e);break;case"msgFtsInServer":case"msgFtsInServerByTiming":this.onmsgFtsInServer($e);break;case"syncSendMsg":this.onMsg($e);break;case"deleteSessions":this.onDeleteSessions($e);break;case"sendMsgReceipt":this.onSendMsgReceipt($e);break;case"msgReceipt":this.onMsgReceipt($e);break;case"onDeleteMsg":this.onDeleteMsg($e);break;case"onMsgDeleted":this.onMsgDeleted($e);break;case"onDeleteMsgOfflineRoaming":this.onDeleteMsgOfflineRoaming($e);break;case"onMarkSessionAck":this.onMarkSessionAck($e);break;case"syncMarkSessionAck":this.syncMarkSessionAck($e);break;case"syncUpdateServerSession":this.onSyncUpdateServerSession($e);break;case"deleteMsgSelf":this.deleteMsgSelf($e);break;case"deleteMsgSelfBatch":this.deleteMsgSelfBatch($e);break;case"onDeleteMsgSelf":this.onDeleteMsgSelf($e);break;case"onDeleteMsgSelfBatch":this.onDeleteMsgSelfBatch($e);break;case"clearServerHistoryMsgs":this.clearServerHistoryMsgs($e);break;case"onClearServerHistoryMsgs":this.onClearServerHistoryMsgs($e)}},ie.checkIgnore=function($e){var er=this;o($e).call($e,function(nr){if(!nr.ignore){try{er.options.shouldIgnoreMsg(nr)&&(nr.ignore=!0)}catch(rr){throw er.logger.error("userOption:shouldIgnoreMsg function error",rr),rr}var Pt;try{Pt=er.options.shouldIgnoreNotification(nr)}catch(rr){throw er.logger.error("userOption:shouldIgnoreNotification function error",rr),rr}nr.type==="notification"&&Pt&&(nr.ignore=!0)}})},ie.filterIgnore=function($e){return s($e).call($e,function(er){return!er.ignore})},ie.genSessionByMsgs=function($e){return this.checkIgnore($e),fr.genSessionByMsgs(this.message.Message,$e)},ie.onRoamingMsgs=function($e){var er=this,nr=er.message,Pt=nr.Message,rr=Pt.getMaxTimetag,kt=nr.reverseMsgs($e.content.msgs),Et=rr(kt);kt=Pt.deduplication(kt);var cr=(kt=Pt.sortMsgs(kt))[0],mr=cr.sessionId,yr=er.genSessionByMsgs(kt);er.cacheSyncedSession(yr);var Tr=er.putMsg(kt,"roamingMsgs").then(function(Ir){kt=Ir,(kt=er.filterIgnore(kt)).length&&(er.logger.info("msg::onRoamingMsgs: putRoamingMsgs",mr,kt.length),er.syncResult.roamingMsgs=er.syncResult.roamingMsgs||[],er.syncResult.roamingMsgs.push({sessionId:mr,scene:cr.scene,to:cr.target,msgs:kt,timetag:Et}),er.syncing||er.onSyncDone())}).catch(function(Ir){return er.logger.error("msg::onRoamingMsgs: ",Ir),a.reject(Ir)});Tr.cmd="roamingMsgs-"+mr,er.syncPromiseArray.push(Tr)},ie.onOfflineMsgs=function($e,er){var nr,Pt=this,rr=this.message,kt=null;er&&(kt={filter:!0});var Et=rr.reverseMsgs($e.content.msgs,{modifyObj:kt});Et=or.deduplication(Et);var cr={};o(Et).call(Et,function(Tr){cr[Tr.sessionId]=cr[Tr.sessionId]||[],cr[Tr.sessionId].push(Tr)});var mr=i(nr=u(cr)).call(nr,function(Tr){return{sessionId:Tr,msgs:cr[Tr]}}),yr=Ve.asyncPool(50,mr,function(Tr){return ir.call(Pt,Tr.sessionId,Tr.msgs,er)});this.syncPromiseArray.push(yr)},ie.completeMsg=function($e){return $e.from=this.account,$e.fromNick=this.myInfo&&this.myInfo.nick,$e.fromClientType="Web",$e.fromDeviceId=Dt.deviceId,$e.time||($e.time=+new Date),$e},ie.amendMsg=function($e){if($e.scene==="team"){var er=Ve.get(this.myTeamMembersMap,$e.to+".nickInTeam");er&&($e.fromNick=er)}else if($e.scene==="superTeam"){var nr=Ve.get(this.mySuperTeamMembersMap,$e.to+".nickInTeam");nr&&($e.fromNick=nr)}return $e},ie.onMsgs=function($e){var er=this,nr=er.reporterHook.getSafeClock(),Pt=er.message.reverseMsgs($e.content.msgs,{mapper:function(rr){var kt=function(Et){for(var cr=1;cr<arguments.length;cr++){var mr,yr,Tr=arguments[cr]!=null?arguments[cr]:{};cr%2?o(mr=Ie(Object(Tr),!0)).call(mr,function(Ir){n(Et,Ir,Tr[Ir])}):he?ae(Et,he(Tr)):o(yr=Ie(Object(Tr))).call(yr,function(Ir){Ne(Et,Ir,V(Tr,Ir))})}return Et}({},rr);if(kt.__receiveTime=$e.__receiveTime,kt.__handleTime=nr,kt.__clientExt)try{kt.__clientExt=JSON.parse(kt.__clientExt)}catch{er.logger.warn("IMProtocolFn:onMsg __clientExt parse failed ".concat(kt.__clientExt))}return er.handleMsg(kt),kt}});er.pushMsgDelay(Pt)},ie.onMsg=function($e,er){var nr;if($e.content.msg.attach){var Pt=null;try{Pt=JSON.parse($e.content.msg.attach)}catch{}if(Pt&&Pt.url&&Ve.get(this.mixStorePolicy,"s3Policy.dlcdns")){var rr,kt=le(this.mixStorePolicy.s3Policy.dlcdns);try{for(kt.s();!(rr=kt.n()).done;){var Et,cr=rr.value;c(Et=Pt.url).call(Et,cr)>=0&&(Pt.isS3=!0,cr!==this.mixStorePolicy.s3Policy.dlcdn&&(Pt.url=Pt.url.replace(cr,this.mixStorePolicy.s3Policy.dlcdn)))}}catch(yr){kt.e(yr)}finally{kt.f()}}$e.content.msg.attach=d(Pt)}var mr=m(nr=this.message).call(nr,$e.content.msg);if(mr.__receiveTime=$e.__receiveTime,mr.__handleTime=this.reporterHook.getSafeClock(),Ve.get($e,"content.msg.__clientExt"))try{mr.__clientExt=JSON.parse($e.content.msg.__clientExt)}catch{this.logger.warn("IMProtocolFn:onMsg __clientExt parse failed ".concat($e.content.msg.__clientExt))}er&&(mr.filter=!0),$e.cmd!=="syncSendMsg"||mr.from!==mr.to?(this.pushMsgDelay([mr]),this.syncing?(this.logger.info("msg::onMsg:is in syncing ..."),this.unhandledMsgs.push({type:"onMsg",msg:mr})):this.handleMsg(mr)):this.logger.warn("onMsg::syncSendMsg to self, so ignore",mr.idClient,mr.idServer)},ie.onBroadcastMsgs=function($e){var er=$e.content.broadcastMsgs;er=v(er).call(er,function(nr,Pt){return nr.broadcastId-Pt.broadcastId}),this.putBroadcastMsgs(er)},ie.onBroadcastMsg=function($e){var er=$e.content.broadcastMsg;er.time=er.timestamp,this.syncing?this.unhandledMsgs.push({type:"onBroadcastMsg",msg:er}):er&&this.putBroadcastMsg(er)},ie.pushMsgTask=function($e){this.msgPromise=this.msgPromise.then(function(){return $e()})},ie.pushMsgDelay=function($e){if($e&&$e.length>0){var er=this;if(er.msgStatEnable&&!hr.isWeixinApp){var nr,Pt=i($e).call($e,function(rr){return{appkey:er.options.appKey,accid:rr.to,fromAccid:rr.from,msgId:rr.idServer,serverTime:rr.time,receiveTime:er.reporterHook.getNTPTime(),sessionId:er.sdkSession,platform:"web",sdk_ver:hr.info.version,manufactor:Fe.name+" "+Fe.version}});er.msgDelayArr=g(nr=er.msgDelayArr).call(nr,Pt),er.msgDelayArr.length>5&&er.doReportMsgDelay()}}},ie.doReportMsgDelay=function(){var $e,er=d(this.msgDelayArr);this.msgDelayArr&&this.msgDelayArr.length>0&&(sr.sendBeacon("https://statistic.live.126.net/statics/report/im/sdk/msgreceived",er),this.msgDelayArr=[]),this.msgDelayTimer&&clearTimeout(this.msgDelayTimer),this.socket&&(this.msgDelayTimer=b(T($e=this.doReportMsgDelay).call($e,this),1e4))},ie.handleMsg=function($e){var er=this,nr=er.db,Pt=$e.time;er.markMsgRead($e),er.msgPromise=er.msgPromise.then(function(){return er.putMsg($e,"onMsg")}).then(function(){var rr;return er.logger.info(g(rr="msg::handleMsg:putMsg: done ".concat($e.idServer," ")).call(rr,$e.idClient)),nr.enable?$e.scene==="superTeam"?nr.updateSuperTeamRoamingMsgTimetag(Pt):nr.updateRoamingMsgTimetag(Pt):(er.timetags[$e.scene==="superTeam"?"superTeamRoamingMsgs":"roamingMsgs"]=Pt,a.resolve())}).then(function(){if($e)return er.checkUserUpdate($e)}).then(function(){if($e){var rr=$e.type;switch(er.logger.info("msg::handleMsg:checkUserUpdate: "+$e.scene+" "+rr+" msg"+(rr==="notification"?" "+$e.attach.type:"")),rr){case"notification":return er.onTeamNotificationMsg($e)}}}).then(function(){$e&&!$e.ignore&&(er.logger.info("msg::handleMsg:onmsg: ",$e.idClient,$e.idServer),b(function(){var rr=$e.scene==="p2p";if(hr.isBrowser&&$e.flow!=="out"){var kt={msgId:$e.idServer,clientId:$e.idClient,receiveTime:er.reporterHook.getNTPTime($e.__receiveTime),serverTime:$e.time,callbackTime:er.reporterHook.getNTPTime(),preHandleTime:er.reporterHook.getNTPTime($e.__handleTime),fromAccid:$e.from,toAccid:er.options.account,type:er.message.sceneMap[$e.scene],tid:rr?"":$e.to,result:200,failReason:"",rt:k(er.reporterHook.getSafeClock()-$e.__receiveTime)},Et=Ve.get($e,"__clientExt.statistics.apiCallingTime"),cr=Ve.get($e,"__clientExt.statistics.sendTime");Et&&cr&&(kt.apiCallingTime=Et,kt.sendTime=cr,kt.attachUploadDuration=Ve.get($e,"__clientExt.statistics.attachUploadDuration")||0),er.reporter&&er.reporter.report("msgReceive",kt)}delete $e.__receiveTime,delete $e.__handleTime,delete $e.__clientExt,er.options.onmsg(Ve.copy($e))},0))}).catch(function(rr){rr.callFunc="msg::handleMsg",er.onCustomError("消息处理错误",rr)})},ie.putMsg=function($e,er){if(Ve.isArray($e)||($e=[$e]),s($e[0]))return a.resolve($e);var nr,Pt=this,rr=Pt.db,kt=rr.enable,Et=a.resolve(),cr=Pt.message.Message.getLastMsg($e),mr=cr.flow,yr=Pt.genSessionByMsgs($e);Ir(yr);var Tr=[];function Ir(kr){er!=="roamingMsgs"&&er!=="offlineMsgs"||Pt.cacheSyncedSession(kr)}return Et=(Et=(Et=Et.then(function(){var kr;return kt||Pt.options.autoMarkRead||er==="roamingMsgs"||!yr||(Pt.sessionUnreadMsgs=Pt.sessionUnreadMsgs||{},Pt.sessionUnreadMsgs[yr.id]=Pt.sessionUnreadMsgs[yr.id]||[],Pt.sessionUnreadMsgs[yr.id]=g(kr=Pt.sessionUnreadMsgs[yr.id]).call(kr,s($e).call($e,function(Ar){try{return Pt.options.shouldCountNotifyUnread(Ar)}catch(Rr){throw Pt.logger.error("userOption:shouldCountNotifyUnread function error",Rr),Rr}}))),er==="offlineMsgs"||er==="roamingMsgs"?a.reject($e):kt?rr.putMsg($e):$e}).then(function(kr){var Ar=[];return o($e).call($e,function(Rr){Pt.checkMsgUnique(Rr)&&Ar.push(Rr)}),$e=Ar,Tr=kt?kr:$e,a.resolve($e)})).then(function(kr){return kr.length&&kt&&yr?new a(function(Ar){rr.getSessions({sessionId:yr.id}).then(function(Rr){if(Rr&&Rr.lastMsg){var Mn=Rr.lastMsg;yr.lastMsg&&yr.lastMsg.time<Mn.time&&(yr.lastMsg=Mn)}Tr&&Tr.length?yr?rr.putSession(yr).then(function(Or){Ar(Or)}):Ar(Rr):(Tr=kr,Ar(Rr))})}):a.resolve(yr)})).then(function(kr){if(yr&&Tr.length){nr=cr.sessionId!==Pt.currSessionId;var Ar=er==="roamingMsgs",Rr=Pt.options.syncSessionUnread,Mn=yr.id,Or=Pt.getSessionInCache(Mn,!0)||{},Pr=Or.ack||0;if(er==="offlineMsgs"||Ar&&Rr||er==="onMsg"&&mr==="in"&&nr){var Nr;if(kt&&kr){var Wr=Or.unread||0;(yr=kr).unread=Wr,Pr=Pr||yr.ack||0}else(kr=Or)&&(yr.unread=kr.unread||0);Ir(yr),yr.unread=yr.unread||0;var Yr=0;o(Tr).call(Tr,function(qr){var Yn;try{Yn=Pt.options.shouldCountNotifyUnread(qr)}catch(Fr){throw Pt.logger.error("userOption:shouldCountNotifyUnread function error",Fr),Fr}var $n=(qr.type!=="notification"||qr.type==="notification"&&Yn)&&(Ue(qr.isUnreadable)||qr.isUnreadable);if($n&&Rr&&($n=qr.time>Pr&&qr.flow!=="out"),$n&&(Yr++,Rr&&!kt)){var Jr=Or.unreadMsgs||[];Jr.push(qr),yr.unreadMsgs=Jr}}),yr.unread+=Yr;var Ur=Ve.secureOutput("session",yr);if(Ur.unreadMsgs&&(Ur.unreadMsgs=i(Nr=Ur.unreadMsgs).call(Nr,function(qr){return qr&&qr.idServer})),Pt.logger.info("msg::putMsg:updateSession: ",Ur),Ir(yr),kt)return rr.updateSession({id:yr.id,unread:yr.unread})}}}),er==="onMsg"&&(Et=Et.then(function(){$e.length&&yr&&(Pt.onUpdateSession(yr),Pt.options.syncSessionUnread&&!nr&&Pt.api.resetSessionUnread(Pt.currSessionId))})),Et.then(function(){return a.resolve($e)}).catch(function(kr){return kr&&kr.length?a.resolve(kr):a.reject(kr)})},ie.putBroadcastMsgs=function($e){var er=this,nr=er.db,Pt=$e.length;if(Pt>0){if(er.doMarkBroadcastMsgsRead($e),nr.enable){var rr=$e[Pt-1].broadcastId;return nr.updateBroadcastMsgTimetag(rr),nr.putBroadcastMsg($e).then(function(){return b(function(){er.doMarkMsgsRead(),er.options.onbroadcastmsgs(Ve.copy($e))},0),a.resolve($e)})}b(function(){er.options.onbroadcastmsgs(Ve.copy($e))},0)}return $e},ie.putBroadcastMsg=function($e){var er=this,nr=er.db;return er.doMarkBroadcastMsgsRead([$e]),nr.enable?($e.broadcastId&&nr.updateBroadcastMsgTimetag($e.broadcastId),nr.putBroadcastMsg($e).then(function(){return b(function(){er.options.onbroadcastmsg(Ve.copy($e))},0),a.resolve($e)})):(b(function(){er.options.onbroadcastmsg(Ve.copy($e))},0),$e)},ie.doMarkBroadcastMsgsRead=function($e){$e=i($e).call($e,function(er){return er.broadcastId}),this.sendCmd("batchMarkRead",{sid:7,cid:17,ids:$e})},ie.cacheSyncedSession=function($e){if($e&&this.syncResult){$e=y({},$e),this.syncResult.sessions=this.syncResult.sessions||{};var er=$e.id,nr=this.syncResult.sessions[er]||{};nr&&nr.ack>$e.ack&&($e.ack=void 0),nr&&nr.msgReceiptTime>$e.msgReceiptTime&&($e.msgReceiptTime=void 0);var Pt=Ve.get(nr,"lastMsg.time"),rr=Ve.get($e,"lastMsg.time");Pt&&rr&&Pt>rr&&($e.lastMsg=nr.lastMsg),this.syncResult.sessions[er]=y(nr,$e),this.syncResult.sessions[er]=y({},this.mergeSession(this.syncResult.sessions[er]))}},ie.checkMsgUnique=Ve.genCheckUniqueFunc("idClient"),ie.revokeMsgUniqueCheck=function($e){this.uniqueSet&&this.uniqueSet.idClient&&(this.uniqueSet.idClient[$e]=!1)},ie.storeSendMsg=function($e){if(!this.syncing){var er=this.putMsg($e,"sendMsg");return this.msgPromise=this.msgPromise.then(function(){return er}),er}this.unhandledMsgs.push({type:"sendMsg",msg:$e})},ie.updateSendMsgError=function($e){if(!this.syncing){var er=this.updateMsg($e);return this.msgPromise=this.msgPromise.then(function(){return er}),er}this.unupdatedMsgs.push($e)},ie.onSendMsg=function($e,er){var nr,Pt,rr=this,kt=$e.content&&$e.content.msg,Et=$e.obj&&$e.obj.msg||kt;if(Et)if(this.logger.warn(g(nr=g(Pt="sendMsg::end: ".concat(kt&&kt.idServer," ")).call(Pt,Et.idClient," ")).call(nr,$e&&$e.raw&&$e.raw.ser)),$e.obj)mr();else{var cr=rr.db;cr&&cr.enable&&cr.getMsgByIdClient(Et.idClient).then(function(yr){yr&&(Et=yr,mr(!1))}).catch(function(){return mr()})}else this.logger.error("sendMsg::error::get msg failed, msg empty");function mr(){var yr,Tr=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];rr.completeMsg(Et);var Ir=$e.error&&$e.error.code===7101;$e.error&&!Ir||(Et.idServer=kt.idServer,Et.time=+kt.time,kt.yidunAntiSpamRes&&(Et.yidunAntiSpamRes=kt.yidunAntiSpamRes),kt.callbackExt&&(Et.callbackExt=kt.callbackExt)),Ir&&(Et.isInBlackList=!0),$e.error?Et.status="fail":Et.status="success",Et=Tr?m(yr=rr.message).call(yr,Et):Et,Et=rr.amendMsg(Et),er&&(Et.filter=!0),$e.obj=Et,rr.syncing?rr.unupdatedMsgs.push(Et):rr.msgPromise=a.all([rr.msgPromise,$e.obj.promise]).then(function(kr){return kr.length||(Et.resend=!0),rr.updateMsg(Et).then(function(){return rr.options.syncSessionUnread&&rr.currSessionId===Et.sessionId&&rr.api.resetSessionUnread(rr.currSessionId),rr.resolveMsgReceiptTask(Et),Et})}).catch(function(kr){rr.logger.error("onSendMsg::dealMsg error",kr)})}},ie.updateLocalMsg=function($e){var er=this.updateMsg($e);return this.msgPromise=this.msgPromise.then(function(){return er}),er},ie.updateMsg=function($e){if(s($e)||this.options.shouldIgnoreMsg($e))return a.resolve($e);var er=this,nr=er.db,Pt=$e.status==="success",rr=fr.genSessionByMsg($e),kt=!!$e.isLocal;return er.onUpdateSession(rr),nr.enable?nr.updateMsg($e).then(function(Et){var cr=nr.updateSession(rr),mr=a.resolve();return Pt&&Et&&!kt&&(mr=$e.scene==="superTeam"?nr.updateSuperTeamRoamingMsgTimetag(Et.time):nr.updateRoamingMsgTimetag(Et.time)),a.all([cr,mr])}).catch(function(Et){er.logger.error("updateMsg error",Et)}):(Pt&&!kt&&(er.timetags.roamingMsgs=$e.time),a.resolve($e))},ie.updateRoamingMsgTimetag=function($e){var er=this.db;return er.enable?er.updateRoamingMsgTimetag($e):(this.timetags.roamingMsgs=$e,a.resolve($e))},ie.checkUserUpdate=function($e){var er=this,nr=$e.from;return er.logger.info("handleMsg::checkUserUpdate: ",nr,er.account),nr===er.account?a.resolve():new a(function(Pt){var rr=er.userSet[nr];if(rr){var kt=+rr.updateTime,Et=+$e.userUpdateTime;!isNaN(kt)&&!isNaN(Et)&&Ve.isNumber(kt)&&Ve.isNumber(Et)&&kt<Et?cr():Pt()}else cr();function cr(){er.api.getUser({account:nr,sync:!0,done:function(mr,yr){mr||b(function(){er.logger.log("user::checkUserUpdate: onupdateuser",yr&&yr.account),er.options.onupdateuser(yr)},0),Pt()}})}})},ie.processUnsettledMsgs=function(){var $e,er,nr=this;o($e=nr.unhandledMsgs).call($e,function(Pt){var rr=Pt.msg;switch(Pt.type){case"onMsg":nr.handleMsg(rr);break;case"sendMsg":nr.msgPromise=nr.msgPromise.then(function(){return nr.putMsg(rr)});break;case"onBroadcastMsg":nr.msgPromise=nr.msgPromise.then(function(){return nr.putBroadcastMsg(rr)})}}),o(er=nr.unupdatedMsgs).call(er,function(Pt){nr.msgPromise=nr.msgPromise.then(function(){return nr.updateMsg(Pt)})}),nr.resetUnsettledMsgs()},ie.onTeamNotificationMsg=function($e){var er=$e.attach,nr=er.type,Pt=$e.from,rr=$e.to,kt=$e.time,Et=er.team,cr=er.account,mr=er.accounts;switch(nr){case"updateTeam":return Et.updateTime=kt,this.onUpdateTeam(Et);case"addTeamMembers":return this.onAddTeamMembers($e,Et,mr);case"removeTeamMembers":return this.onRemoveTeamMembers(Et,rr,mr);case"acceptTeamInvite":return this.onAddTeamMembers($e,Et,[Pt]);case"passTeamApply":return this.onAddTeamMembers($e,Et,[cr]);case"addTeamManagers":return this.updateTeamManagers($e,rr,mr,!0,kt);case"removeTeamManagers":return this.updateTeamManagers($e,rr,mr,!1,kt);case"leaveTeam":return this.onRemoveTeamMembers(Et,rr,[Pt]);case"dismissTeam":return this.onDismissTeam(rr,kt);case"transferTeam":return this.transferTeam($e,Et,Pt,cr);case"updateTeamMute":return this.onUpdateTeamMembersMute($e,Et,[cr],er.mute);case"updateSuperTeam":return Et.updateTime=kt,this.onUpdateSuperTeam(Et);case"acceptSuperTeamInvite":return this.onAddSuperTeamMembers($e,Et,[$e.from]);case"addSuperTeamMembers":return this.onAddSuperTeamMembers($e,Et,mr);case"passSuperTeamApply":return this.onAddSuperTeamMembers($e,Et,[cr]);case"removeSuperTeamMembers":return this.onRemoveSuperTeamMembers(Et,rr,mr);case"leaveSuperTeam":return this.onRemoveSuperTeamMembers(Et,rr,[Pt]);case"dismissSuperTeam":return this.onDismissSuperTeam(rr,kt);case"transferSuperTeam":return this.transferSuperTeam($e,Et,Pt,cr);case"addSuperTeamManagers":return this.updateSuperTeamManagers($e,rr,mr,!0,kt);case"removeSuperTeamManagers":return this.updateSuperTeamManagers($e,rr,mr,!1,kt);case"updateSuperTeamMembersMute":return this.onUpdateSuperTeamMembersMute($e,Et,mr,er.mute)}},ie.onAddSuperTeamMembers=function($e,er,nr){var Pt=this.db,rr=dr.assembleMembers(er,nr);$e.attach.members=rr;var kt={team:er,accounts:nr,members:rr};if(this.logger.info("team::onAddSuperTeamMembers: ".concat(kt.team.teamId,", "),kt.accounts),this.options.onAddSuperTeamMembers(Ve.simpleClone(kt)),Pt.enable){var Et=Pt.putSuperTeamMembers(rr),cr=Pt.putSuperTeam(er);return a.all([Et,cr])}},ie.onRemoveSuperTeamMembers=function($e,er,nr){var Pt=this.db,rr={team:$e,teamId:er,accounts:nr};if(this.logger.info("team::onRemoveSuperTeamMembers: ".concat(er,", "),rr.accounts),this.options.onRemoveSuperTeamMembers&&this.options.onRemoveSuperTeamMembers(Ve.simpleClone(rr)),$e&&Pt.enable){if(c(nr).call(nr,this.account)===-1){var kt=Pt.removeSuperTeamMembersByAccounts(er,nr),Et=a.resolve();return $e&&(Et=Pt.putSuperTeam($e)),a.all([kt,Et])}return Pt.leaveSuperTeam(er)}},ie.onDismissSuperTeam=function($e,er){var nr=this.db,Pt={teamId:$e};if(this.logger.info("team::onDismissSuperTeam:",$e),this.options.onDismissSuperTeam(Pt),nr.enable)return nr.dismissSuperTeam($e,er)},ie.onAddTeamMembers=function($e,er,nr){var Pt=this,rr=Pt.db,kt=er.teamId,Et=tr.assembleMembers(er,nr);$e.attach.members=Et;var cr={team:er,accounts:nr,members:Et};if(Pt.logger.info("team::onAddTeamMembers: ",kt,nr),Pt.options.onAddTeamMembers(Ve.simpleClone(cr)),rr.enable){var mr,yr=rr.putTeam(er);return c(nr).call(nr,Pt.account)===-1?mr=rr.putTeamMembers(Et):(Pt.logger.log("team::onAddTeamMembers: user join team",kt),yr=new a(function(Tr){Pt.api.getTeamMembers({teamId:kt,sync:!0,done:function(){Tr()}})})),a.all([mr,yr])}},ie.onRemoveTeamMembers=function($e,er,nr){var Pt=this.db,rr={team:$e,teamId:er,accounts:nr};if(this.logger.info("team::onRemoveTeamMembers: ".concat(er),nr),this.options.onRemoveTeamMembers(Ve.simpleClone(rr)),$e&&Pt.enable){if(c(nr).call(nr,this.account)===-1){var kt=Pt.removeTeamMembersByAccounts(er,nr),Et=a.resolve();return $e&&(Et=Pt.putTeam($e)),a.all([kt,Et])}return Pt.leaveTeam(er)}},ie.updateTeamManagers=function($e,er,nr,Pt,rr){var kt=this.db,Et=$e.attach.members=i(nr).call(nr,function(Ir){return{id:tr.genId(er,Ir),type:Pt?"manager":"normal",updateTime:rr}}),cr={teamId:""+er,memberUpdateTime:rr};$e.attach.team=cr;var mr={team:cr,accounts:nr,isManager:Pt,members:Et};if(this.logger.info("team::updateTeamManagers:",er,nr,Pt),this.options.onUpdateTeamManagers(Ve.simpleClone(mr)),kt.enable){var yr=kt.updateTeam(cr),Tr=kt.updateTeamManagers(er,nr,Pt,rr);return a.all([yr,Tr])}},ie.updateSuperTeamManagers=function($e,er,nr,Pt,rr){var kt=this.db,Et=$e.attach.members=i(nr).call(nr,function(Ir){return{id:tr.genId(er,Ir),teamId:er,account:Ir,type:Pt?"manager":"normal",updateTime:rr}}),cr={teamId:""+er,memberUpdateTime:rr};$e.attach.team=cr;var mr={team:cr,accounts:nr,isManager:Pt,members:Et};if(this.logger.info("team::updateSuperTeamManagers:",er,nr,Pt),this.options.onUpdateSuperTeamManagers(Ve.simpleClone(mr)),kt.enable){var yr=kt.updateSuperTeam(cr),Tr=kt.updateSuperTeamMembers(Et);return a.all([yr,Tr])}},ie.onDismissTeam=function($e,er){var nr=this.db,Pt={teamId:$e};if(this.logger.info("team::onDismissTeam:",$e),this.options.onDismissTeam(Pt),nr.enable)return nr.dismissTeam($e,er)},ie.transferTeam=function($e,er,nr,Pt){var rr=this.db,kt=er.teamId,Et=er.memberUpdateTime,cr={id:tr.genId(kt,nr),type:"normal",updateTime:Et},mr={id:tr.genId(kt,Pt),type:"owner",updateTime:Et};$e.attach.members=[cr,mr];var yr={team:er,from:cr,to:mr};if(this.logger.info("team::transferTeam: from to",kt,nr,Pt),this.options.onTransferTeam(Ve.simpleClone(yr)),rr.enable)return rr.transferTeam(er,nr,Pt)},ie.transferSuperTeam=function($e,er,nr,Pt){var rr=this.db,kt=er.teamId,Et=er.memberUpdateTime,cr={teamId:kt,type:"normal",account:nr,updateTime:Et},mr={teamId:kt,type:"owner",account:Pt,updateTime:Et};$e.attach.members=[cr,mr];var yr={team:er,from:cr,to:mr};if(this.logger.info("team::transferSuperTeam: from to ",kt,nr,Pt),this.options.onTransferSuperTeam(Ve.simpleClone(yr)),rr.enable)return rr.transferSuperTeam(er,cr,mr)},ie.onUpdateTeamMembersMute=function($e,er,nr,Pt){var rr=this.db,kt=i(nr).call(nr,function(yr){return{id:tr.genId(er.teamId,yr),account:yr,teamId:er.teamId,mute:Pt,updateTime:er.memberUpdateTime}});$e.attach.members=kt;var Et={team:er,accounts:nr,members:kt,mute:Pt};if(this.logger.info("team::onUpdateTeamMembersMute:",er.teamId,nr,Pt),this.options.onUpdateTeamMembersMute(Ve.simpleClone(Et)),rr.enable){var cr=rr.updateTeamMembers(kt),mr=rr.putTeam(er);return a.all([cr,mr])}},ie.onUpdateSuperTeamMembersMute=function($e,er,nr,Pt){var rr=this.db,kt=i(nr).call(nr,function(yr){return{id:dr.genId(er.teamId,yr),account:yr,teamId:er.teamId,mute:Pt,updateTime:er.memberUpdateTime}});$e.attach.members=kt;var Et={team:er,accounts:nr,members:kt,mute:Pt};if(this.logger.info("team::onUpdateSuperTeamMembersMute:",er.teamId,nr,Pt),this.options.onUpdateSuperTeamMembersMute(Ve.simpleClone(Et)),rr.enable){var cr=rr.updateSuperTeamMembers(kt),mr=rr.putSuperTeam(er);return a.all([cr,mr])}},ie.onHistoryMsgs=function($e){$e.error||($e.obj.msgs=this.message.reverseMsgs($e.content.msgs))},ie.onmsgFtsInServer=function($e){if(!$e.error){var er=this.message.reverseMsgs($e.content.msgs);$e.obj.msgs=er,$e.content.msgs=er}},ie.isFilterMsgs=function($e){return!!s($e[0])},ie.splitMsgs=function($e,er,nr,Pt){o($e).call($e,function(rr){if(s(rr))Pt.push(rr);else switch(rr.scene){case"p2p":er.push(rr);break;case"team":nr.push(rr)}})},ie.markMsgRead=function($e,er){if(Ve.isArray($e)||($e=[$e]),this.db.enable||this.options.autoMarkRead||er){var nr=i($e).call($e,function(Pt){return{flag:"msg",idServer:Pt.idServer,scene:Pt.scene,filter:s(Pt),type:Pt.type,attachType:Pt.attach&&Pt.attach.type}});this.msgAckBufferManager.add(nr)}},ie.markSysMsgRead=function($e,er){if(Ve.isArray($e)||($e=[$e]),this.db.enable||this.options.autoMarkRead||er){var nr=i($e).call($e,function(Pt){return{flag:"systemMsg",idServer:Pt.idServer,scene:Pt.scene,filter:s(Pt),type:Pt.type}});this.msgAckBufferManager.add(nr)}},ie.handleMsgsAck=function($e){var er,nr=this,Pt={p2pSysMsgs:{sid:7,cid:3,msgs:[]},p2pMsgs:{sid:7,cid:2,msgs:[]},superTeamSysMsgs:{sid:21,cid:19,msgs:[]},teamMsgs:{sid:8,cid:3,msgs:[]},filterSysMsgs:{sid:101,cid:3,msgs:[]},filterMsgs:{sid:101,cid:2,msgs:[]},netcallMsgs:{sid:9,cid:11,msgs:[]}};o($e).call($e,function(rr){/^(netcallBill|netcallMiss|netcallReject)$/.test(rr.attachType)?Pt.netcallMsgs.msgs.push(rr):s(rr)?rr.flag==="systemMsg"?Pt.filterSysMsgs.msgs.push(rr):Pt.filterMsgs.msgs.push(rr):rr.flag!=="systemMsg"?rr.scene==="p2p"?Pt.p2pMsgs.msgs.push(rr):rr.scene==="team"&&Pt.teamMsgs.msgs.push(rr):rr.scene==="superTeam"?Pt.superTeamSysMsgs.msgs.push(rr):Pt.p2pSysMsgs.msgs.push(rr)}),o(er=u(Pt)).call(er,function(rr){return nr.doMarkMsgsRead(Pt[rr].sid,Pt[rr].cid,Pt[rr].msgs)})},ie.doMarkMsgsRead=function($e,er,nr){nr&&nr.length&&(this.logger.log("markMsgRead::batchMarkRead",$e,er,nr),this.sendCmd("batchMarkRead",{sid:$e,cid:er,ids:i(nr).call(nr,function(Pt){return Pt.idServer})}))}},function(t,r,e){var n=e(58),o=e(9),s=e(2),a=e(5),i=e(17),u=e(3),c=e(41),d=e(59),m=e(60),v=e(61),g=e(62),b=e(47);function T(Ne,_e){var Ce=a(Ne);if(d){var re=d(Ne);_e&&(re=i(re).call(re,function(ue){return m(Ne,ue).enumerable})),Ce.push.apply(Ce,re)}return Ce}function k(Ne){for(var _e=1;_e<arguments.length;_e++){var Ce,re,ue=arguments[_e]!=null?arguments[_e]:{};_e%2?s(Ce=T(Object(ue),!0)).call(Ce,function(ze){n(Ne,ze,ue[ze])}):v?g(Ne,v(ue)):s(re=T(Object(ue))).call(re,function(ze){b(Ne,ze,m(ue,ze))})}return Ne}var y=e(35).fn,A=e(751),V=e(753);function he(Ne,_e,Ce){var re=this,ue=this.timetags&&this.timetags.sync;this.db.enable&&ue&&_e&&this.db.getMsgByIdClient(Ne).then(function(ze){if(ze&&!(ze.commentTimetag&&ze.commentTimetag<=ue&&ze.time<=ue)){if(ze.commentTimetag=_e.time,ze.comments=ze.comments||[],Ce){var le;ze.comments=i(le=ze.comments).call(le,function(Ve){return Ve.body!==_e.body||Ve.from!==_e.from})}else{for(var de,Ie=0;Ie<ze.comments.length;Ie++)if(ze.comments[Ie].from===_e.from&&ze.comments[Ie].body===_e.body){ze.comments[Ie]=_e,de=!0;break}de||ze.comments.push(_e)}var ie={idClient:ze.idClient,comments:ze.comments,commentTimetag:ze.commentTimetag};re.db.updateMsg(ie)}})}function ae(Ne){Ne.scene=this.message.sceneReverseMap[+Ne.scene]||Ne.scene,Ne.time=+Ne.time}y.processMsgExtend=function(Ne){switch(Ne.cmd){case"getThreadMsgs":this.onGetThreadMsgs(Ne);break;case"getMsgsByIdServer":this.onGetMsgsByIdServer(Ne);break;case"addQuickComment":this.changeQuickComment(Ne);break;case"deleteQuickComment":this.changeQuickComment(Ne,!0);break;case"onQuickComment":case"syncAddQuickComment":this.onQuickComment(Ne);break;case"onDeleteQuickComment":case"syncDeleteQuickComment":this.onQuickComment(Ne,!0);break;case"getQuickComments":this.getQuickComments(Ne);break;case"addCollect":case"updateCollect":this.addCollect(Ne);break;case"deleteCollects":this.deleteCollects(Ne);break;case"getCollects":this.getCollects(Ne);break;case"addStickTopSession":case"syncAddStickTopSession":this.onChangeStickTopSession(Ne,"add");break;case"updateStickTopSession":case"syncUpdateStickTopSession":this.onChangeStickTopSession(Ne,"update");break;case"deleteStickTopSession":case"syncDeleteStickTopSession":this.onChangeStickTopSession(Ne,"delete");break;case"addMsgPin":case"onAddMsgPin":case"syncAddMsgPin":this.pinMsgChange(Ne,"add");break;case"updateMsgPin":case"onUpdateMsgPin":case"syncUpdateMsgPin":this.pinMsgChange(Ne,"update");break;case"deleteMsgPin":case"onDeleteMsgPin":case"syncDeleteMsgPin":this.pinMsgChange(Ne,"delete");break;case"getMsgPins":this.getMsgPins(Ne)}},y.onGetThreadMsgs=function(Ne){if(!Ne.error){var _e;Ne.obj.msgs=this.message.reverseMsgs(Ne.content.msgs),Ne.obj.threadMsg=o(_e=this.message).call(_e,Ne.content.threadMsg);var Ce=Ne.content.threadMsgsMeta||{};Ne.obj.total=Ce.total,Ne.obj.timetag=Ce.lastMsgTime}},y.onGetMsgsByIdServer=function(Ne){Ne.error||(Ne.obj.msgs=this.message.reverseMsgs(Ne.content.msgs))},y.changeQuickComment=function(Ne,_e){Ne.error||(Ne.obj.comment.time=Ne.content.timetag,Ne.obj.comment=o(A).call(A,Ne.obj.comment),ae.call(this,Ne.obj.msg),he.call(this,Ne.obj.msg.idClient,Ne.obj.comment,_e))},y.onQuickComment=function(Ne,_e){if(Ne.content){var Ce=Ne.content,re=Ce.comment,ue=Ce.msg;re&&ue&&(ae.call(this,ue),re=o(A).call(A,re),_e?this.options.onDeleteQuickComment(Ne.content.msg,re):this.options.onQuickComment(Ne.content.msg,re),he.call(this,ue.idClient,re,_e))}},y.getQuickComments=function(Ne){var _e,Ce=this;if(!Ne.error){var re=Ne.obj.idMap,ue=Ne.obj.indexMap,ze=Ne.content&&Ne.content.commentRes||[];s(ze).call(ze,function(le){var de=[],Ie=Ce.parser.unserializeMap.comment;if(+le.modify==1)try{de=JSON.parse(le.detail)}catch(Ve){Ce.logger.warn("getQuickComments parse detail error",Ve)}if(s(de).call(de,function(Ve,Ue){var Dt,tr={};s(Dt=a(Ve)).call(Dt,function(dr){tr[Ie[dr]]=Ve[dr]}),tr=o(A).call(A,tr),de[Ue]=tr}),le.timestamp=+le.timestamp,re[le.idClient]){var ie={idClient:le.idClient,commentTimetag:le.timestamp};re[le.idClient].commentTimetag=le.timestamp,+le.modify==1&&(re[le.idClient].comments=de,ie.comments=de),Ce.db.enable&&Ce.db.updateMsg(ie)}else re[le.idClient]={idServer:le.idServer,idClient:le.idClient,comments:de,commentTimetag:le.timestamp,scene:Ce.message.sceneReverseMap[le.scene]||le.scene}}),Ne.obj=[],s(_e=a(ue)).call(_e,function(le){Ne.obj[ue[le]]=re[le]})}},y.addCollect=function(Ne){Ne.error||(Ne.obj.collect=o(V).call(V,Ne.content.collect))},y.deleteCollects=function(Ne){Ne.error||(Ne.obj.deleteNum=Ne.content.deleteNum)},y.getCollects=function(Ne){if(!Ne.error){var _e=[],Ce=Ne.content.collectList||[];s(Ce).call(Ce,function(re){_e.push(o(V).call(V,re))}),Ne.obj.collectList=_e,Ne.obj.total=Ne.content.total}},y.onChangeStickTopSession=function(Ne,_e){var Ce=this;if(!Ne.error){var re=Ne.content.stickTopSession||Ne.obj.stickTopSession||{},ue=Ne.content.timetag||+re.updateTime,ze=re.id.split("|");ze[0]==="super_team"&&(ze[0]="superTeam"),re={id:ze.join("-"),scene:ze[0],to:ze[1],topCustom:re.topCustom||""},_e==="delete"?re.isTop=!1:_e==="add"&&(re.isTop=!0),re=this.onUpdateSession(re),Ne.obj&&(Ne.obj.stickTopSession=re),this.db.enable&&(this.db.updateSession(re).then(function(le){le||Ce.db.putSession(re)}),this.db.updateTimetag("stickTopSessions",ue))}},y.pinMsgChange=function(Ne,_e){var Ce=this;if(!Ne.error){Ne.content=Ne.content||{};var re=this,ue=this.db,ze=Ne.obj&&Ne.obj.msg,le=Ne.content.msg||ze||{},de=Ne.content.pinTag||Ne.obj.pinTag,Ie=Ne.content.timetag||+de.updateTime,ie=u.resolve();ae.call(this,le),ue.enable&&(ie=ue.getMsgByIdClient(le.idClient)),de.createTime&&(de.createTime=+de.createTime),de.updateTime&&(de.updateTime=+de.updateTime),ie.then(function(Ve){return le=Ve||le,Ve?le=Ve:le.sessionId=le.scene+"-"+Ce.message.Message.getMsgTarget(le,Ce.account),ze?(Ne.obj.msg=le,Ne.obj.pinTag=de):Ce.options.onPinMsgChange({msg:le,pinTag:de},_e),function(){ue.enable&&ue[_e==="delete"?"deleteMsgPin":"putMsgPin"](k(k({},le),{},{pinFrom:de.pinFrom,pinCustom:de.pinCustom})).then(function(){var Ue="pin-"+le.sessionId,Dt=re.timetags.sync;return ue.getTimetag(Ue).then(function(tr){return tr>Dt?ue.updateTimetag(Ue,Ie):u.resolve()})}).catch(function(Ue){re.logger.error("msgExtend::pinMsgChange:error",Ue)})}(),u.resolve}).then(function(){}),Ne.promise=ie}},y.getMsgPins=function(Ne){var _e=this;if(!Ne.error){var Ce=this.db,re=Ne.content||{};if(re.pins=re.pins||[],re.modify){var ue,ze=[];Ce.enable&&(Ce.updateTimetag("pin-"+Ne.obj.id,re.timetag),s(ue=re.pins).call(ue,function(le){le.sessionId=Ne.obj.id,ze.push(Ce.getMsgByIdClient(le.idClient))})),Ne.promise=u.all(ze).then(function(le){var de;s(de=re.pins).call(de,function(Ie,ie){le[ie]?c(Ie,le[ie]):(Ie.sessionId=Ne.obj.id,ae.call(_e,Ie))}),Ne.obj.pins=re.pins,Ce.enable&&Ce.deleteMsgPins(Ne.obj.id).then(function(){return Ce.putMsgPins(re.pins)}).catch(function(Ie){_e.logger.error("msgExtend::getMsgPins:change db error",Ie)})})}else Ce.enable?(Ce.updateTimetag("pin-"+Ne.obj.id,re.timetag),Ne.promise=Ce.getMsgPins(Ne.obj.id).then(function(le){Ne.obj.pins=le||[]})):Ne.obj.pins=[]}}},function(t,r,e){var n=e(812);t.exports=n},function(t,r,e){e(813);var n=e(12);t.exports=n.Number.isInteger},function(t,r,e){e(1)({target:"Number",stat:!0},{isInteger:e(814)})},function(t,r,e){var n=e(28),o=Math.floor;t.exports=Number.isInteger||function(s){return!n(s)&&isFinite(s)&&o(s)===s}},function(t,r,e){var n=e(120),o=e(3),s=e(2),a=e(7),i=["time","from"],u=e(35).fn,c=e(0);u.onOfflineMsgReceipts=function(d){var m,v=this,g=v.db,b=d.content.msgReceipts,T=[],k=o.resolve();this.logger.info("onOfflineMsgReceipts",b),s(b).call(b,function(y){m={id:"p2p-"+y.from,msgReceiptTime:+y.time},v.cacheSyncedSession(m)}),v.syncResult.msgReceipts=T,g.enable&&(k=g.updateMsgReceiptsTimetag(d.content.timetag)),k.cmd=T,v.syncPromiseArray.push(k)},u.shouldUpdateSessionFromMsgReceipt=function(d,m){return!d||!d.msgReceiptServerTime||m.time>d.msgReceiptServerTime},u.genSessionFromMsgReceipt=function(d,m){var v=m.time,g={id:m.sessionId,msgReceiptTime:v,msgReceiptServerTime:v};return d&&d.id===m.sessionId&&(g=c.merge({},d,g)),d&&d.updateTime||(g.updateTime=v),g},u.onMsgReceipt=function(d){var m=this,v=m.db,g=d.content.msgReceipt;g.time=+g.time;var b=g.idClient,T=o.resolve();v.enable&&b&&(T=v.getMsgByIdClient(b)),this.logger.info("onMsgReceipt::",g),T.then(function(k){if(k){if(!k.idServer)return void(m.msgReceiptTasks[b]=g);k.time}else g.time;g.msgReceiptTime=g.time,g.sessionId="p2p-".concat(g.from),m.updateSessionMsgReceiptTime(g),g.time,g.from;var y=n(g,i);m.options.onMsgReceipts([y])})},u.resolveMsgReceiptTask=function(d){var m=this.msgReceiptTasks[d.idClient];m&&(m.msgReceiptTime=d.time,this.updateSessionMsgReceiptTime(m))},u.updateSessionMsgReceiptTime=function(d){var m=this.db,v={id:"p2p-"+d.from,msgReceiptTime:d.msgReceiptTime,msgReceiptServerTime:d.time};(this.getSessionInCache(v.id)||{}).msgReceiptTime>=v.msgReceiptTime?this.logger.warn("receive old msgReceiptTime",d):(m.enable&&m.putSession(v),this.onUpdateSession(v))},u.onSendMsgReceipt=function(d){var m;if(!d.error)if(d.obj&&d.obj.msgReceipt){var v=d.obj.msgReceipt,g=+v.time,b=+d.content.msgReceipt.time,T=this.getSessionInCache("p2p-"+v.to);T?(this.logger.info(a(m="sendMsgReceipt on:: param time ".concat(g,", res time ")).call(m,b)),T.msgReceiptSendTime=Math.min(g,b)):this.logger.info("sendMsgReceipt on:: session is undefined or logically deleted, failed to send read receipt")}else this.logger.info("sendMsgReceipt on:: origin msg is missing, it maybe timeout")},u.shouldSendMsgReceipt=function(d){if(d&&d.scene==="p2p"&&d.status==="success"){var m=this.getSessionInCache(d.sessionId);if(m){var v=m.msgReceiptSendTime;return!v||v<d.time}}return!1},u.isMsgRemoteRead=function(d){if(d&&d.scene==="p2p"&&d.flow==="out"&&d.status==="success"){var m=this.getSessionInCache(d.sessionId);if(m&&m.msgReceiptTime)return d.time<=m.msgReceiptTime}return!1}},function(t,r,e){var n=e(102),o=e(103),s=e(57),a=e(9),i=e(2),u=e(7),c=e(8),d=e(3),m=e(87),v=e(196),g=e(5),b=e(17),T=e(52),k=e(15),y=e(24),A=e(200),V=e(85),he=e(86),ae=e(70),Ne=e(32);function _e(Ue,Dt){var tr=he!==void 0&&ae(Ue)||Ue["@@iterator"];if(!tr){if(Ne(Ue)||(tr=function(or,ir){var $e;if(or){if(typeof or=="string")return Ce(or,ir);var er=k($e=Object.prototype.toString.call(or)).call($e,8,-1);if(er==="Object"&&or.constructor&&(er=or.constructor.name),er==="Map"||er==="Set")return V(or);if(er==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(er))return Ce(or,ir)}}(Ue))||Dt&&Ue&&typeof Ue.length=="number"){tr&&(Ue=tr);var dr=0,fr=function(){};return{s:fr,n:function(){return dr>=Ue.length?{done:!0}:{done:!1,value:Ue[dr++]}},e:function(or){throw or},f:fr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var sr,hr=!0,Fe=!1;return{s:function(){tr=tr.call(Ue)},n:function(){var or=tr.next();return hr=or.done,or},e:function(or){Fe=!0,sr=or},f:function(){try{hr||tr.return==null||tr.return()}finally{if(Fe)throw sr}}}}function Ce(Ue,Dt){(Dt==null||Dt>Ue.length)&&(Dt=Ue.length);for(var tr=0,dr=new Array(Dt);tr<Dt;tr++)dr[tr]=Ue[tr];return dr}var re=e(35).fn,ue=e(151),ze=e(152),le=e(0),de=e(105).EMSyncType;function Ie(Ue,Dt){return ie.apply(this,arguments)}function ie(){return(ie=o(n.mark(function Ue(Dt,tr){var dr,fr,sr,hr,Fe,or,ir,$e,er,nr,Pt,rr,kt,Et=this;return n.wrap(function(cr){for(;;)switch(cr.prev=cr.next){case 0:if(sr=(fr=this).db,hr=[],i(Dt).call(Dt,function(mr){Et.revokeMsgUniqueCheck(mr.idClient),hr.push(mr.idClient)}),fr.options.rollbackDelMsgUnread){cr.next=14;break}return cr.next=7,sr.deleteMsg(hr);case 7:if(cr.t0=cr.sent,cr.t0){cr.next=10;break}cr.t0=[];case 10:return Fe=cr.t0,Fe=Object.prototype.toString.call(Fe)==="[object Array]"?Fe:[Fe],fr.logger.info("msg::_deleteMsgSelfBatchInDb, rollback false, affect: ".concat(Fe.length," rows")),cr.abrupt("return");case 14:return or=!1,ir=fr.options.cbUpdateSession||y(dr=fr.updateSessionInDbWithNotify).call(dr,fr),$e=fr.getSessionInCache(tr)||{id:tr},er=$e.lastMsg||{},A(hr).call(hr,er.idClient)&&(or=!0),fr.logger.info("msg::_deleteMsgSelfBatchInDb session change before:",tr,or,$e.unread),cr.next=22,sr.deleteMsg(hr);case 22:if(cr.t1=cr.sent,cr.t1){cr.next=25;break}cr.t1=[];case 25:if(nr=cr.t1,nr=Object.prototype.toString.call(nr)==="[object Array]"?nr:[nr],fr.logger.info("msg::_deleteMsgSelfBatchInDb affect:",nr.length," rows"),!or){cr.next=34;break}return cr.next=31,sr.getMsgs({sessionId:tr,limit:1});case 31:Pt=cr.sent,er=Pt&&Pt[0]?Pt[0]:null,$e.lastMsg=er;case 34:if(rr=!1,$e&&$e.unread&&(kt=$e&&$e.ack||0,i(nr).call(nr,function(mr){kt<mr.time&&mr.flow==="in"&&($e.unread=$e.unread>0?$e.unread-1:0,rr=!0)})),!or&&!rr){cr.next=39;break}return fr.logger.info("msg::_deleteMsgSelfBatchInDb session change after:",tr,$e.unread),cr.abrupt("return",ir($e));case 39:case"end":return cr.stop()}},Ue,this)}))).apply(this,arguments)}function Ve(Ue,Dt){Dt=Dt||new Date().getTime();var tr=this.db,dr=this.getSessionInCache(Ue),fr=this.options.rollbackClearMsgsUnread!==!1,sr=[];return tr.enable&&sr.push(tr.deleteMsgsBySessionId({sessionId:Ue,end:Dt})),fr&&dr&&(dr=this.mergeSession({id:dr.id,unread:0,lastMsg:null,unreadMsgs:[]}),dr=this.onUpdateSession(dr)),tr.enable&&fr&&dr&&sr.push(tr.updateSession(dr)),d.all(sr)}re.onDeleteMsg=function(Ue){var Dt=this.db;if(delete Ue.obj.sysMsg,!Ue.error){var tr=Ue.obj.msg;Ue.promise=this.deleteLocalMsg(tr).then(function(){if(Dt.enable){var dr=tr.scene==="superTeam"?"deleteSuperTeamMsg":"deleteMsg";Dt.getTimetag(dr).then(function(fr){fr=fr||0,s()+1>=fr&&Dt.updateTimetag(dr,s()+1)})}})}},re.onMsgDeleted=function(Ue,Dt){var tr=this;if(!tr.canHandleDeletedMsgInSyncing)return tr.logger.info("msg::onMsgDeleted:is in syncing ..."),void tr.unhandledSysMsgsForDeletedMsgs.push({packet:Ue,isSuperTeam:Dt});if(!Ue.error){var dr=tr.db,fr=a(ue).call(ue,Ue.content.sysMsg);fr=tr.processDeleteMsgSysMsg(fr),Dt||tr.markSysMsgRead(fr),tr.deleteLocalMsg(fr.msg).then(function(){if(dr.enable){var sr=Dt?"deleteSuperTeamMsg":"deleteMsg";dr.updateTimetag(sr,fr.time+1)}tr.handleSysMsg(fr)})}},re.processDeleteMsgSysMsg=function(Ue){var Dt;return Ue.msg={},i(Dt=["scene","from","to"]).call(Dt,function(tr){Ue.msg[tr]=Ue[tr]}),Ue.msg.idClient=Ue.deletedIdClient,Ue.msg.idServer=Ue.deletedIdServer,Ue.msg.time=Ue.deletedMsgTime,Ue.msg.fromNick=Ue.deletedMsgFromNick,Ue.opeAccount=Ue.opeAccount||Ue.from,Ue.msg.opeAccount=Ue.opeAccount,this.message.Message.setExtra(Ue.msg,this.account),Ue},re.onDeleteMsgOfflineRoaming=function(Ue){if(!Ue.error){var Dt,tr=this,dr=+Ue.content.type==1?"offline":"roaming",fr=ue.reverseSysMsgs(Ue.content.sysMsgs,{mapper:function(or){return tr.processDeleteMsgSysMsg(or)}}),sr=fr&&fr[0]&&fr[0].scene==="superTeam";tr.logger.info(u(Dt="msg::onDeleteMsgOfflineRoaming: on delete ".concat(dr," ")).call(Dt,sr?"superTeam":""," idServer deletedIdClient deletedIdClient="),c(fr).call(fr,function(or){var ir,$e;return u(ir=u($e="".concat(or.idServer,"-")).call($e,or.deletedIdServer,"-")).call(ir,or.deletedIdClient)})),dr==="offline"&&tr.markSysMsgRead(fr);var hr=Ue.content.timetag;sr?(tr.timetags.deleteSuperTeamMsg=hr,tr.syncResult.deleteSuperTeamMsgTimetag=hr):(tr.timetags.deleteMsg=hr,tr.syncResult.deleteMsgTimetag=hr);var Fe=tr.putSysMsg(fr,"offlineSysMsgs").catch(function(or){return tr.logger.error("msgDelete::onDeleteMsgOfflineRoaming: ",or),d.reject(or)});Fe.cmd="deleteMsgSysMsgs "+dr,tr.syncPromiseArray.push(Fe),tr.syncResult.deleteMsgSysMsgs=tr.syncResult.deleteMsgSysMsgs||[],tr.syncResult.deleteMsgSysMsgs.push({type:dr,sysMsgs:fr})}},re.deleteMsgOfflineRoaming=function(Ue,Dt){if(!Ue)return d.resolve();var tr=this;tr.logger.info("msg::deleteMsgOfflineRoaming: ",c(Ue).call(Ue,function(sr){var hr;return sr.type+" "+c(hr=sr.sysMsgs).call(hr,function(Fe){var or,ir;return u(or=u(ir="".concat(Fe.idServer,"-")).call(ir,Fe.deletedIdServer,"-")).call(or,Fe.deletedIdClient)})}),le.secureOutput("session",Dt));var dr=tr.db,fr=[];return i(Ue).call(Ue,function(sr){var hr;i(hr=sr.sysMsgs).call(hr,function(Fe){var or=tr.deleteLocalMsg(Fe.msg,{cbUpdateSession:function(ir){ir=tr.mergeSession(ir),ir=m(ze).call(ze,ir);var $e=le.findObjIndexInArray(Dt,{value:ir.id});if($e!==-1&&(Dt[$e]=le.merge({},Dt[$e],ir)),dr.enable)return dr.updateSession(ir)}});fr.push(or)})}),d.all(fr).then(function(){dr.enable&&(tr.syncResult.deleteMsgTimetag&&dr.updateTimetag("deleteMsg",tr.syncResult.deleteMsgTimetag),tr.syncResult.deleteSuperTeamMsgTimetag&&dr.updateTimetag("deleteSuperTeamMsg",tr.syncResult.deleteSuperTeamMsgTimetag))})},re.deleteMsgSelf=function(Ue){if(!Ue.error){var Dt=this.db,tr=Ue.obj&&Ue.obj.deleteMsgSelfTag;if(tr){var dr=Ue.content&&Ue.content.timetag;tr.scene=tr.scene+""=="1"?"p2p":"team";var fr=[this.deleteLocalMsg(tr)];dr<=this.timetags.deleteMsgSelf||(this.timetags.deleteMsgSelf=dr,Dt.enable&&fr.push(Dt.updateDeleteMsgSelf(dr))),Ue.promise=d.all(fr)}}},re.deleteMsgSelfBatch=function(){var Ue=o(n.mark(function Dt(tr){var dr,fr,sr,hr,Fe,or,ir,$e;return n.wrap(function(er){for(;;)switch(er.prev=er.next){case 0:if(!tr.error){er.next=2;break}return er.abrupt("return");case 2:if(fr=this,sr=this.db,(hr=tr.obj&&tr.obj.deleteMsgSelfTags)&&hr.length>0){er.next=7;break}return er.abrupt("return");case 7:if(Fe=v(hr).call(hr,function(nr,Pt){var rr=Pt.sessionId;if(nr[rr]=nr[rr]||[],nr[rr].push(Pt),!sr.enable){var kt=fr.getSessionInCache(rr);kt&&kt.lastMsg&&Pt&&kt.lastMsg.idClient===Pt.idClient&&(kt.lastMsg=null,fr.onUpdateSession(kt))}return nr},{}),sr.enable){er.next=11;break}return i(or=g(Fe)).call(or,function(nr){var Pt=Fe[nr],rr=fr.getSessionInCache(nr);if(fr.options.rollbackDelMsgUnread&&rr){var kt=rr.ack||0,Et=b(Pt).call(Pt,function(cr){return fr.message.Message.setFlow(cr,fr.account),kt<cr.time&&cr.flow==="in"});Et.length>0&&rr.unread&&(rr.unread=rr.unread-Et.length>=0?rr.unread-Et.length:0,fr.onUpdateSession(rr))}}),er.abrupt("return",d.resolve());case 11:ir=c(dr=g(Fe)).call(dr,function(nr){var Pt=Fe[nr];return Ie.call(fr,Pt,nr)}),($e=tr.content&&tr.content.timetag)<=fr.timetags.deleteMsgSelf||(fr.timetags.deleteMsgSelf=$e,ir.push(sr.updateDeleteMsgSelf($e))),tr.promise=d.all(ir);case 15:case"end":return er.stop()}},Dt,this)}));return function(Dt){return Ue.apply(this,arguments)}}(),re.onDeleteMsgSelf=function(Ue){var Dt=this,tr=this.db,dr=Ue.content.deleteMsgSelfTag;dr.scene=dr.scene+""=="1"?"p2p":"team",Dt.options.onDeleteMsgSelf([dr]),Dt.deleteLocalMsg(dr).then(function(){var fr=dr.deletedTime;return fr<=Dt.timetags.deleteMsgSelf||!tr.enable?d.resolve():(Dt.timetags.deleteMsgSelf=fr,tr.updateDeleteMsgSelf(fr))}).catch(function(fr){Dt.logger.error("onDeleteMsgSelf error",fr)})},re.onDeleteMsgSelfBatch=function(Ue){var Dt=this;if(!Ue.error){var tr={1:"p2p",2:"team"},dr=le.get(Ue,"content.deleteMsgSelfTags")||[];i(dr).call(dr,function(sr){var hr;sr.scene=tr[sr.scene],sr.sessionId=u(hr="".concat(sr.scene,"-")).call(hr,Dt.message.Message.getMsgTarget(sr,Dt.account)),sr.deletedTime=T(sr.deletedTime),sr.time=T(sr.time)});var fr=le.get(Ue,"content.deleteMsgSelfTags[0].deletedTime");fr=T(fr)||0,this.options.onDeleteMsgSelf(dr),this.deleteMsgSelfBatch({obj:{deleteMsgSelfTags:dr},content:{timetag:fr}})}},re.clearServerHistoryMsgs=function(Ue){if(!Ue.error){var Dt=this.db,tr=Ue.obj&&Ue.obj.clearMsgsParamsWithSync;if(tr){var dr=(tr.type&&tr.type.toString()==="2"?"team":"p2p")=="p2p"?"p2p-".concat(tr.otherAccid):"team-".concat(tr.toTid),fr=Ue.content&&T(Ue.content.timetag);fr&&fr>this.timetags.sessionHistoryMsgsDelete&&(this.timetags.sessionHistoryMsgsDelete=fr,Dt.enable&&Dt.updateTimetag("sessionHistoryMsgsDelete",this.timetags.sessionHistoryMsgsDelete)),Ve.call(this,dr,fr)}}},re.onClearServerHistoryMsgs=function(Ue){if(!Ue.error){var Dt=this.db,tr=Ue.content&&Ue.content.sessionHistoryMsgsDeleteTag;if(tr){var dr=(tr.type&&tr.type.toString()==="2"?"team":"p2p")=="p2p"?"p2p-".concat(tr.otherAccid):"team-".concat(tr.toTid),fr=tr.ext,sr=T(tr.time);this.options.onClearServerHistoryMsgs&&this.options.onClearServerHistoryMsgs([{sessionId:dr,time:sr,ext:fr}]),sr<=this.timetags.sessionHistoryMsgsDelete||(this.timetags.sessionHistoryMsgsDelete=sr,Dt.enable&&Dt.updateTimetag("sessionHistoryMsgsDelete",this.timetags.sessionHistoryMsgsDelete)),Ve.call(this,dr,sr)}}},re.syncSessionHistoryMsgsDelete=function(Ue){if(!Ue.error){var Dt=this.db,tr=Ue.content&&Ue.content.sessionHistoryMsgsDeleteTags;if(tr&&tr.length>0){var dr=c(tr).call(tr,function(sr){return{sessionId:(sr.type&&sr.type.toString()==="2"?"team":"p2p")=="p2p"?"p2p-".concat(sr.otherAccid):"team-".concat(sr.toTid),time:T(sr.time)}});this.reporterHook.emit("reporter/syncItemComplete",de.kSyncType4_24),this.options.onClearServerHistoryMsgs&&this.options.onClearServerHistoryMsgs(dr),this.syncResult.clearServerHistoryMsgs=dr;var fr=0;i(dr).call(dr,function(sr){sr.time>fr&&(fr=sr.time)}),Dt.enable&&Dt.updateTimetag("sessionHistoryMsgsDelete",fr)}}},re.syncDeleteMsgSelf=function(Ue){var Dt=this,tr=this.db,dr=Ue.content.deletedMsgs;if(dr&&dr.length!==0){var fr=[];i(dr).call(dr,function(sr){sr.scene=sr.scene==="1"?"p2p":"team",sr.deletedTime=+sr.deletedTime,sr.time=+sr.time,fr.push(Dt.deleteLocalMsg(sr))}),Dt.options.onDeleteMsgSelf(dr),d.all(fr).then(function(){var sr=k(dr).call(dr,-1)[0].deletedTime;if(!(Dt.timetags.deleteMsgSelf>=sr))return Dt.timetags.deleteMsgSelf=sr,tr.enable?tr.updateDeleteMsgSelf(sr):void 0}).catch(function(sr){Dt.logger.error("syncDeleteMsgSelf error",sr)})}},re.deleteLocalMsg=function(){var Ue=o(n.mark(function Dt(tr,dr){var fr,sr,hr,Fe,or,ir,$e,er,nr,Pt,rr;return n.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:if(tr){kt.next=2;break}return kt.abrupt("return");case 2:if(hr=(sr=this).db,Fe=(dr=dr||{}).cbUpdateSession||y(fr=sr.updateSessionInDbWithNotify).call(fr,sr),this.revokeMsgUniqueCheck(tr&&tr.idClient),or=tr.sessionId||tr.scene+"-"+this.message.Message.getMsgTarget(tr,this.account),ir=!1,$e=sr.getSessionInCache(or),sr.options.rollbackDelMsgUnread&&$e&&(er=$e.ack||0,$e&&er<tr.time&&tr.from!==sr.account&&$e.unread&&(sr.logger.info("msgDelete::deleteLocalMsg:cache.getSessions: unread",$e.id,$e.unread),$e.unread=$e.unread-1,ir=!0)),$e&&$e.lastMsg&&$e.lastMsg.idClient==tr.idClient&&(sr.logger.info("msgDelete::deleteLocalMsg:cache.getSessions: lastMsg",$e.id,$e.unread),$e.lastMsg=null,ir=!0),!hr.enable){kt.next=39;break}return nr=null,kt.next=16,hr.getMsgByIdClient(tr.idClient);case 16:return kt.sent||sr.logger.info("msgDelete::deleteLocalMsg::db.deleteMsg no find in DB",tr),sr.logger.info("msgDelete::deleteLocalMsg::db.deleteMsg ",tr.idClient),kt.next=21,hr.deleteMsg(tr.idClient);case 21:if(!$e||$e.lastMsg!==null){kt.next=26;break}return kt.next=24,hr.getMsgs({sessionId:or,limit:1});case 24:(Pt=kt.sent)&&Pt[0]&&(nr=Pt[0]);case 26:if($e||!sr.options.rollbackDelMsgUnread){kt.next=36;break}return sr.logger.info("msgDelete::deleteLocalMsg::Can not find session in cache,will find in DB",or),kt.next=30,hr.getSession(or);case 30:if(rr=kt.sent){kt.next=33;break}return kt.abrupt("return");case 33:er=($e=rr).ack||0,$e&&er<tr.time&&tr.flow==="in"&&$e.unread&&(sr.logger.info("msgDelete::deleteLocalMsg:db.getSessions: unread",rr.id,rr.unread),$e.unread=$e.unread-1,ir=!0);case 36:if($e&&$e.lastMsg===null&&nr&&(sr.logger.info("msgDelete::deleteLocalMsg:db.getSessions: lastMsg",or,nr),$e.lastMsg=nr||null,ir=!0),!ir){kt.next=39;break}return kt.abrupt("return",Fe($e));case 39:if(hr.enable||!ir){kt.next=42;break}return sr.onUpdateSession($e),kt.abrupt("return");case 42:case"end":return kt.stop()}},Dt,this)}));return function(Dt,tr){return Ue.apply(this,arguments)}}(),re.deleteLocalMsgs=function(Ue){var Dt=this,tr=Dt.db;return new d(function(dr,fr){if(function(sr){var hr=Dt.getSessionInCache(Ue.sessionId);if(hr&&Ue.updateSession){var Fe=hr.lastMsg;Fe&&(!Ue.start&&!Ue.end||Fe.time>Ue.start&&Fe.time<Ue.end)&&(hr.lastMsg=null,Dt.logger.log("deleteLocalMsgs::delete cacheSession lastMsg done, options is",Ue),tr.enable||(Dt.onUpdateSession(hr),sr()))}}(dr),tr.enable)return tr.deleteMsgsBySessionId(Ue).then(function(){Ue.updateSession&&Dt.checkAndUpdateLocalSessionByMsg(Ue.sessionId),dr()},function(sr){return fr(sr)})})},re.deleteLocalMsgsByTime=function(){var Ue=o(n.mark(function Dt(tr){var dr,fr,sr,hr,Fe,or,ir,$e,er,nr,Pt,rr,kt,Et;return n.wrap(function(cr){for(;;)switch(cr.prev=cr.next){case 0:return fr=(dr=this).db,cr.next=4,fr.getDeletedMsgsCountByTime(tr);case 4:return sr=cr.sent,hr=0,Fe=[],cr.next=9,fr.deleteMsgsByTime(tr);case 9:return tr.deletedone&&tr.deletedone({deletedMsgCount:sr}),cr.next=12,fr.getAllSessions();case 12:or=cr.sent,ir=_e(or),cr.prev=14,ir.s();case 16:if(($e=ir.n()).done){cr.next=47;break}return er=$e.value,nr=er.id,Pt=!1,cr.next=22,fr.getSession(nr);case 22:if(rr=cr.sent){cr.next=25;break}return cr.abrupt("continue",45);case 25:return cr.next=27,fr.getMsgCountAfterAck({shouldCountNotifyUnread:dr.options.shouldCountNotifyUnread,sessionId:nr,ack:rr.ack||0});case 27:if(kt=cr.sent,rr.unread!==kt&&(rr.unread=kt,Pt=!0),!(rr.lastMsg&&rr.lastMsg.time>tr.start&&rr.lastMsg.time<tr.end)){cr.next=39;break}if(tr.start!==0){cr.next=34;break}rr.lastMsg=null,cr.next=38;break;case 34:return cr.next=36,fr.getMsgs({sessionId:nr,limit:1});case 36:Et=cr.sent,rr.lastMsg=Et&&Et[0]?Et[0]:null;case 38:Pt=!0;case 39:if(!Pt){cr.next=45;break}return cr.next=42,fr.updateSession(rr);case 42:dr.sessionSet[nr]&&Fe.push(rr),hr++;case 45:cr.next=16;break;case 47:cr.next=52;break;case 49:cr.prev=49,cr.t0=cr.catch(14),ir.e(cr.t0);case 52:return cr.prev=52,ir.f(),cr.finish(52);case 55:return dr.onUpdateSessions(Fe),cr.abrupt("return",d.resolve({deletedMsgCount:sr,sessionUpdateCount:hr}));case 57:case"end":return cr.stop()}},Dt,this,[[14,49,52,55]])}));return function(Dt){return Ue.apply(this,arguments)}}()},function(t,r,e){var n=e(69),o=e(8),s=e(9),a=e(7),i=e(3),u=e(26),c=e(17),d=e(2),m=e(35).fn,v=e(0),g=e(151);m.splitSysMsgs=function(b,T){for(var k,y=b.length-1;y>=0;y--)k=b[y],g.isCustom(k)&&(n(b).call(b,y,1),T.push(k))},m.onOfflineSysMsgs=function(b,T){var k,y=this,A=o(k=b.content.sysMsgs).call(k,function(Ce){return Ce=s(g).call(g,Ce),T&&(Ce.filter=!0),Ce});A=s(A).call(A),y.markSysMsgRead(A);var V=[];y.splitSysMsgs(A,V);var he,ae=T?"offlineFilterSysMsgs":"offlineSysMsgs",Ne=T?"offlineFilterCustomSysMsgs":"offlineCustomSysMsgs";if(A.length){var _e=y.putSysMsg(A,"offlineSysMsgs").then(function(Ce){var re;(A=Ce).length&&(y.logger.info("sysmsg::onOfflineSysMsgs: ",ae,A.length,A&&o(A).call(A,function(ue){return ue.idServer})),y.syncResult[ae]=y.syncResult[ae]||[],y.syncResult[ae]=a(re=y.syncResult[ae]).call(re,A))}).catch(function(Ce){return y.logger.error("sysMsg::onOfflineSysMsgs: ",Ce),i.reject(Ce)});_e.cmd="sysMsgs",y.syncPromiseArray.push(_e)}V.length&&(y.logger.info("sysmsg::onOfflineSysMsgs: ",Ne,o(V).call(V,function(Ce){return Ce.idServer})),y.syncResult[Ne]=y.syncResult[Ne]||[],y.syncResult[Ne]=a(he=y.syncResult[Ne]).call(he,V))},m.onSendSysMsg=function(b,T){var k=b.obj||{};k?(this.completeSysMsg(k),b.error?k.status="fail":k.status="success",k=s(g).call(g,k),T&&(b.obj.filter=!0),b.obj=k):this.logger.warn("onSendSysMsg::no obj")},m.completeSysMsg=function(b){return b.from=this.account,b},m.onSysMsg=function(b,T){var k=s(g).call(g,b.content.sysMsg);T&&(k.filter=!0),this.markSysMsgRead(k),g.isCustom(k)?(this.logger.info("sysmsg::onSysMsg: on customSysMsg"),this.options.oncustomsysmsg(k)):this.syncing?(this.logger.info("sysmsg::onSysMsg:is in syncing ..."),this.unhandledSysMsgs.push(k)):this.handleSysMsg(k)},m.handleSysMsg=function(b){var T=this,k=b.type,y=b.from,A=b.serverex;T.sysMsgPromise=T.sysMsgPromise.then(function(){return T.putSysMsg(b,"onSysMsg")}).then(function(V){b=V[0]}).then(function(){if(b){var V,he=i.resolve();switch(k){case"addFriend":V={type:"addFriend",account:y},A&&(V.serverex=A),he=T.onFriendRequest(V);break;case"passFriendApply":V={type:"passFriendApply",account:y},he=T.onFriendRequest(V);break;case"deleteFriend":he=T.onDeleteFriend({account:y})}return V&&V.friend&&(b.friend=V.friend),he}}).then(function(){b&&(T.logger.info("sysmsg::handleSysMsg: ",k,v.pickAsString(b,["idServer","deletedIdClient","deletedIdServer"])),u(function(){T.options.onsysmsg(b)},0))})},m.putSysMsg=function(b,T){if(v.isArray(b)||(b=[b]),c(b[0]))return i.resolve(b);var k=this,y=k.db,A=y.enable,V=i.resolve(),he=[];return(V=(V=V.then(function(){return A?y.putSysMsg(b):b}).then(function(ae){var Ne=[];d(b).call(b,function(_e){k.checkSysMsgUnique(_e)&&Ne.push(_e)}),b=Ne,he=A?ae:b})).then(function(){return k.getSysMsgUnread().then(function(ae){return he.length||((he=b).backward=!0),k.updateSysMsgUnread(he,ae,1).then(function(Ne){T==="offlineSysMsgs"&&(k.syncResult.sysMsgUnread=Ne),T==="onSysMsg"&&k.onUpdateSysMsgUnread(Ne)})})})).then(function(){return b})},m.checkSysMsgUnique=v.genCheckUniqueFunc("idServer"),m.getSysMsgUnread=function(){var b=this,T=b.db;return new i(function(k){T.enable?T.getSysMsgUnread().then(function(y){k(y)},function(){k(b.sysMsgUnread)}):k(b.sysMsgUnread)})},m.updateSysMsgUnread=function(b,T,k){if(v.isArray(b)||(b=[b]),!b.length)return i.resolve(T);T=T||{};var y,A=this.db;return d(b).call(b,function(V){(k>0&&!V.read||k<0&&V.read)&&(y=V.type,T[y]=(T[y]||0)+k)}),T=g.completeUnread(T),this.sysMsgUnread=T,A.enable&&!b.backward?A.updateSysMsgUnread(T):i.resolve(T)},m.reduceSysMsgUnread=function(b){var T=this;return T.getSysMsgUnread().then(function(k){return T.updateSysMsgUnread(b,k,-1)}).then(function(k){T.onUpdateSysMsgUnread(k)})},m.onUpdateSysMsgUnread=function(b){var T=this;u(function(){T.logger.info("sysmsg::onUpdateSysMsgUnread:",b),T.options.onupdatesysmsgunread(b)},0)},m.updateSysMsg=function(b){var T=this,k=T.db;(k.enable?k.updateSysMsg(b):i.resolve(b)).then(function(y){T.onUpdateSysMsg(y)})},m.onUpdateSysMsg=function(b){var T=this;u(function(){v.isArray(b)||(b=[b]),d(b).call(b,function(k){T.logger.info("sysmsg::onUpdateSysMsg:",k.idServer),T.options.onupdatesysmsg(k)})},0)},m.processUnsettledSysMsgs=function(){var b,T,k=this;d(b=k.unhandledSysMsgs).call(b,function(y){k.handleSysMsg(y)}),d(T=k.unhandledSysMsgsForDeletedMsgs).call(T,function(y){k.onMsgDeleted(y.packet,y.isSuperTeam)}),k.resetUnsettledSysMsgs()}},function(t,r,e){var n=e(754),o=e(58),s=e(2),a=e(6),i=e(15),u=e(9),c=e(3),d=e(8),m=e(87),v=e(17),g=e(41),b=e(5),T=e(7),k=e(59),y=e(60),A=e(61),V=e(62),he=e(47);function ae(le,de){var Ie=b(le);if(k){var ie=k(le);de&&(ie=v(ie).call(ie,function(Ve){return y(le,Ve).enumerable})),Ie.push.apply(Ie,ie)}return Ie}function Ne(le){for(var de=1;de<arguments.length;de++){var Ie,ie,Ve=arguments[de]!=null?arguments[de]:{};de%2?s(Ie=ae(Object(Ve),!0)).call(Ie,function(Ue){o(le,Ue,Ve[Ue])}):A?V(le,A(Ve)):s(ie=ae(Object(Ve))).call(ie,function(Ue){he(le,Ue,y(Ve,Ue))})}return le}var _e=e(35).fn,Ce=e(0),re=e(152),ue=e(40),ze=e(151);_e.processSession=function(le){if(!le.error)switch(le.cmd){case"getServerSessions":this.onGetServerSessions(le);break;case"getServerSession":this.onGetServerSession(le);break;case"updateServerSession":this.onUpdateServerSession(le)}},_e.onGetServerSessions=function(le){var de=this,Ie=le.content&&le.content.sessionReqTag,ie=le.content&&le.content.sessionList,Ve=[];s(ie).call(ie,function(Ue){var Dt,tr;if(Ue.id=Ue.id.split("|").join("-"),a(Dt=Ue.id).call(Dt,"super_team")===0&&(Ue.id="superTeam"+i(tr=Ue.id).call(tr,10)),Ue.updateTime=+Ue.updateTime,Ue.lastMsg){var dr=Ue.lastMsgType==="1"?"sysMsg":"msg";Ve.push(de.parser.unserialize(JSON.parse(Ue.lastMsg),dr).then(function(fr){var sr;Ue.lastMsg=dr==="msg"?u(sr=de.message).call(sr,fr):u(ze).call(ze,fr)}))}}),le.promise=c.all(Ve).then(function(){le.obj={sessionList:ie,hasMore:Ie.hasMore==="1"},Ie.minTimestamp&&(le.obj.minTimestamp=+Ie.minTimestamp)})},_e.onGetServerSession=function(le){var de,Ie=this,ie=le.content&&le.content.session;if(ie){var Ve;if(ie.id=ie.id.split("|").join("-"),a(de=ie.id).call(de,"super_team")===0&&(ie.id="superTeam"+i(Ve=ie.id).call(Ve,10)),ie.updateTime=+ie.updateTime,ie.lastMsg){var Ue=le.content.session&&le.content.session.lastMsgType==="1"?"sysMsg":"msg";le.promise=Ie.parser.unserialize(JSON.parse(ie.lastMsg),Ue).then(function(Dt){var tr;ie.lastMsg=Ue==="msg"?u(tr=Ie.message).call(tr,Dt):u(ze).call(ze,Dt),le.obj=ie})}else le.obj=ie}},_e.onUpdateServerSession=function(le){le.obj={}},_e.onSyncUpdateServerSession=function(le){var de,Ie=this,ie=this,Ve=le.content&&le.content.session;if(Ve){var Ue;Ve.id=Ve.id.split("|").join("-"),a(de=Ve.id).call(de,"super_team")===0&&(Ve.id="superTeam"+i(Ue=Ve.id).call(Ue,10)),Ve.updateTime=+Ve.updateTime,Ve.lastMsg?ie.parser.unserialize(JSON.parse(Ve.lastMsg),"msg").then(function(Dt){var tr;Ve.lastMsg=u(tr=ie.message).call(tr,Dt),Ie.options.onSyncUpdateServerSession(Ce.simpleClone(Ve))}):this.options.onSyncUpdateServerSession(Ce.simpleClone(Ve))}},_e.mergeSession=function(le){le=Ce.copyWithNull(le);var de=this.sessionSet,Ie=le.id,ie=de[Ie]||{},Ve=!1;return re.isComplete(le)?delete ie.isDeleted:ie.isDeleted&&(Ve=!0),de[Ie]=Ce.merge(ie,le),le=Ve?le:de[Ie],Ce.undef(le.unread)&&(le.unread=0),le},_e.mergeSessions=function(le){var de=this;return d(le=le||[]).call(le,function(Ie){return de.mergeSession(Ie)})},_e.onDeleteSessions=function(le){var de;le.obj=d(de=le.obj.sessions).call(de,function(Ie){return re.parse(Ie)})},_e.onUpdateSession=function(le){if(le){if(le=this.mergeSession(le),le=m(re).call(re,le),re.isComplete(le))return this.logger.info("session::onUpdateSession: ".concat(le.id),le.id,Ce.secureOutput("session",le)),this.options.onupdatesessions?this.options.onupdatesessions([le]):this.options.onupdatesession(le),le;this.logger.warn("session::onUpdateSession::session is not complete",Ce.secureOutput("session",le))}},_e.onUpdateSessions=function(le){var de=this;if(le){le=de.mergeSessions(le),le=d(le).call(le,function(Ve){return m(re).call(re,Ve)});var Ie=v(le).call(le,function(Ve){return re.isComplete(Ve)}),ie=v(le).call(le,function(Ve){return!re.isComplete(Ve)});if(ie&&ie.length>0&&de.logger.warn("session::onUpdateSessions::sessions is not complete",d(ie).call(ie,function(Ve){return Ve.id}),Ce.secureOutput("session",ie)),Ie.length!==0)return de.logger.info("session::onUpdateSessions:",Ce.secureOutput("session",Ie)),de.options.onupdatesessions?de.options.onupdatesessions(Ie):s(Ie).call(Ie,function(Ve){de.options.onupdatesession(Ve)}),Ie;de.logger.warn("session::onUpdateSessions::completeSessions is empty")}},_e.setCurrSession=function(le){le=""+le,this.currSessionId=le,this.logger.info("session::setCurrSession:",le)},_e.resetSessionUnread=function(le){var de=le.id;this.db.enable&&this.db.updateSession({id:de,unread:0}),!this.options.autoMarkRead&&this.sessionUnreadMsgs&&this.sessionUnreadMsgs[de]&&(this.markMsgRead(this.sessionUnreadMsgs[de],!0),this.sessionUnreadMsgs[de]=[]),this.getSessionInCache(de)?this.onUpdateSession({id:de,unread:0}):this.onUpdateSession(Ne(Ne({},le),{},{unread:0}))},_e.resetSessionsUnread=function(le){var de=this,Ie=this.db;Ie.enable&&d(le).call(le,function(Ve){Ie.updateSession({id:Ve.id,unread:0})});var ie=!this.options.autoMarkRead&&this.sessionUnreadMsgs;le=d(le).call(le,function(Ve){return ie&&de.sessionUnreadMsgs[Ve.id]&&(de.markMsgRead(de.sessionUnreadMsgs[Ve.id],!0),de.sessionUnreadMsgs[Ve.id]=[]),de.getSessionInCache(Ve.id)?{id:Ve.id,unread:0}:Ne(Ne({},Ve),{},{unread:0})}),this.onUpdateSessions(le)},_e.insertLocalSession=function(le){var de=this,Ie=de.db,ie=le.scene+"-"+le.to,Ve=de.getSessionInCache(ie);return Ve&&re.isComplete(Ve)?c.reject(ue.sessionExist({callFunc:"session::insertLocalSession",session:Ve})):(Ie.enable?Ie.getMsgs({sessionId:ie,limit:1}):c.resolve()).then(function(Ue){if(Ce.isArray(Ue)&&Ue.length===1){var Dt=Ue[0];(Ve=re.genSessionByMsg(Dt)).updateTime=Dt.time}else Ve={id:ie,scene:le.scene,to:le.to,updateTime:+le.updateTime||+new Date,lastMsg:null};return de.onUpdateSession(Ve),Ie.enable?Ie.putSession(Ve):c.resolve(Ve)})},_e.checkAndUpdateLocalSessionByMsg=function(le){var de,Ie=this.db,ie=this,Ve=this.options.syncSessionUnread&&le!==this.currSessionId,Ue=Ie.getMsgs({sessionId:le,limit:1}),Dt=Ie.getSession(le).then(function(tr){if(tr)return de=g({},tr),tr.ack=tr.ack||0,Ve?Ie.getMsgs({sessionId:le,start:tr.ack}):c.resolve();ie.logger.error("can't find session that sessionId = ".concat(le))});return c.all([Ue,Dt]).then(function(tr){var dr,fr,sr=n(tr,2),hr=sr[0],Fe=sr[1],or={id:le};if(!de)return ie.logger.error("checkAndUpdateLocalSessionByMsg:can not find session",le),c.resolve(200);if(dr=de&&!de.lastMsg?null:de.lastMsg.idClient,hr&&hr[0]?fr=(hr=hr[0]).idClient:(fr=null,hr=null),dr!==fr&&(or.lastMsg=hr),Fe!==void 0){var ir=0;s(Fe=Fe||[]).call(Fe,function($e){var er;try{er=ie.options.shouldCountNotifyUnread($e)}catch(nr){throw ie.logger.error("userOption:shouldCountNotifyUnread function error",nr),nr}$e.isUnreadable&&$e.flow==="in"&&($e.type!=="notification"||er)&&ir++}),ir!==de.unread&&(or.unread=ir)}return b(or).length>1?(ie.logger.info("session::checkAndUpdateLocalSessionByMsg::needUpdate newSession:",Ce.secureOutput("session",or)),Ie.updateSession(or).then(function(){return ie.onUpdateSession(or)})):c.resolve(200)})},_e.syncSessionsWithMoreRoaming=function(le){var de=this,Ie=le&&le.content&&le.content.sessions;if(Ie&&Ie.length){var ie={0:"p2p",1:"team",5:"superTeam"};if(s(Ie).call(Ie,function(Ue){var Dt,tr=Ue.to===de.options.account?Ue.from:Ue.to;Ue.scene=ie[Ue.scene],Ue.id=T(Dt="".concat(Ue.scene,"-")).call(Dt,tr),Ue.time=+Ue.time}),this.db.enable){var Ve=this.db.putSessionsWithMoreRoaming(Ie);Ve.cmd="syncSessionsWithMoreRoaming",this.syncPromiseArray.push(Ve)}this.syncing&&this.syncResult?this.syncResult.sessionsWithMoreRoaming=Ie:this.logger.warn("syncSessionsWithMoreRoaming::not in syncing or no syncResult")}},_e.syncStickTopSessions=function(le){var de=this,Ie=this.db,ie=[],Ve=[],Ue=c.resolve(),Dt=le.content.sessions||[];this.syncing&&this.syncResult?(s(Dt).call(Dt,function(tr){var dr=tr.id.split("|");dr[0]==="super_team"&&(dr[0]="superTeam"),tr.id=dr.join("-"),tr.scene=dr[0],tr.to=dr[1],tr.isTop=!0,ie.push(dr.join("-")),delete tr.createTime,delete tr.updateTime,Ie.enable&&Ve.push(Ie.putSession(tr))}),Ie.enable&&(Ue=Ie.updateTimetag("stickTopSessions",le.content.timetag)),Ue.then(function(){return Ie.enable?Ie.getStickTopSessions():[]}).then(function(tr){if(le.content.modify){var dr=[];s(tr).call(tr,function(fr){a(ie).call(ie,fr.id)>-1||(dr.push(fr.id),fr.isTop=!1,fr.topCustom="",Ve.push(Ie.putSession(fr)))})}else de.syncResult.stickTopSessions=tr;return c.all(Ve)}),this.syncResult.stickTopSessions=Dt,Ue.cmd="syncStickTopSessions",this.syncPromiseArray.push(Ue)):this.logger.warn("syncSessionsWithMoreRoaming::not in syncing or no syncResult")},_e.getSessionInCache=function(le,de){var Ie=this.sessionSet[le];return!Ie||Ie.isDeleted&&!de?void 0:Ie},_e.deleteSessionInCache=function(le,de){var Ie=this;Ce.isArray(le)||(le=[le]),de?s(le).call(le,function(ie){Ie.sessionSet[ie]&&(Ie.sessionSet[ie].isDeleted=!0)}):s(le).call(le,function(ie){return delete Ie.sessionSet[ie]}),this.logger.info("sessions::deleteSessionInCache::delete session done",le,de)},_e.updateSessionInCache=function(le){return this.logger.info("session::updateSessionInCache: ".concat(le.id),le.id,le),this.getSessionInCache(le.id)?le=this.mergeSession(le):(this.logger.info("session::updateSessionInCache: can not find session in cache ".concat(le.id)),null)},_e.updateSessionInDbWithNotify=function(le,de){var Ie=this;return new c(function(ie,Ve){var Ue=Ie.db;if(Ie.getSessionInCache(le.id)){var Dt=c.resolve(),tr=Ce.filterObj(le,"id lastMsg localCustom unread");Ue.enable&&(Dt=Ue.updateSession(tr)),Dt.then(function(dr){return Ie.onUpdateSession(dr,de)}).then(ie,function(dr){Ve({callFunc:"session::updateLocalSession",event:dr})})}else Ve(ue.sessionNotExist({sessionId:le.id,callFunc:"session::updateLocalSession"}))})}},function(t,r,e){var n=e(745);t.exports=function(o){if(n(o))return o},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(153),o=e(70);t.exports=function(s,a){var i=s==null?null:n!==void 0&&o(s)||s["@@iterator"];if(i!=null){var u,c,d,m,v=[],g=!0,b=!1;try{if(d=(i=i.call(s)).next,a===0){if(Object(i)!==i)return;g=!1}else for(;!(g=(u=d.call(i)).done)&&(v.push(u.value),v.length!==a);g=!0);}catch(T){b=!0,c=T}finally{try{if(!g&&i.return!=null&&(m=i.return(),Object(m)!==m))return}finally{if(b)throw c}}return v}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r){t.exports=function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(2),o=e(5),s=e(7),a=e(41),i=e(35).fn,u=e(0);i.syncSessionAck=function(c){var d,m=this;if(this.logger.info("syncSessionAck::",c.content),m.syncing&&m.syncResult){m.saveAck.p2pTeam=c.content.timetag;var v={};n(d=[[c.content.p2p,"p2p"],[c.content.team.m_map,"team"]]).call(d,function(g){var b,T=g[0],k=g[1];n(b=o(T)).call(b,function(y){var A,V;v[s(A="".concat(k,"-")).call(A,y)]=T[y];var he={id:s(V="".concat(k,"-")).call(V,y),ack:T[y]};m.cacheSyncedSession(he)})}),m.syncResult.ackMap?m.syncResult.ackMap=a(m.syncResult.ackMap,v):m.syncResult.ackMap=v}else m.logger.warn("syncSessionAck: not in syncing or no syncResult",m.syncing,!!m.syncResult)},i.syncSuperTeamSessionAck=function(c){var d,m=this;if(m.syncResult){m.saveAck.superTeam=c.content.timetag;var v={},g=c.content.superTeam.m_map;n(d=o(g)).call(d,function(b){v["superTeam-".concat(b)]=g[b];var T={id:"superTeam-".concat(b),ack:g[b]};m.cacheSyncedSession(T)}),m.syncResult.ackMap?m.syncResult.ackMap=a(m.syncResult.ackMap,v):m.syncResult.ackMap=v}},i.onMarkSessionAck=function(c){c.error||this.storeSessionAck(c.obj)},i.syncMarkSessionAck=function(c){this.storeSessionAck(c.content,!0)},i.storeSessionAck=function(c,d){var m;if(this.options.syncSessionUnread&&c){var v;switch(c.scene){case 0:v="p2p";break;case 1:v="team";break;case void 0:default:v="superTeam"}var g=s(m="".concat(v,"-")).call(m,c.to),b=c.timetag;if(b<=((this.getSessionInCache(g)||{}).ack||0))this.logger.warn("session::storeSessionAck: ack <= ackInMemory",b);else{var T={id:g,ack:b};this.mergeSession(T),this.logger.info("session::storeSessionAck:",u.secureOutput("session",T)),this.markUnreadBySessionAck({sessionId:g,ack:T.ack},d)}}},i.markUnreadBySessionAck=function(c,d){var m=c.sessionId,v=c.ack,g=this,b=g.db;if(b.enable)g.pushMsgTask(function(){return b.getMsgCountAfterAck({shouldCountNotifyUnread:g.options.shouldCountNotifyUnread,sessionId:m,ack:v}).then(function(ae){var Ne={id:m,unread:ae,ack:v};return g.logger.info("session::markUnreadBySessionAck: db.getMsgCountAfterAck done",Ne),g.syncing?g.cacheSyncedSession(Ne):d&&g.onUpdateSession(Ne),b.updateSession(Ne)}).catch(function(ae){g.logger.error("markUnreadBySessionAck::error",ae)})});else{var T=g.getSessionInCache(m);if(T){var k=T.unreadMsgs;if(k&&k.length){for(var y=0,A=[],V=k.length-1;V>=0;V--){var he=k[V];if(!(he.time>v))break;y++,A.push(he)}T.unreadMsgs=A,T.unread=y,g.logger.info("session::markUnreadBySessionAck: unread ".concat(y)),g.syncing?g.cacheSyncedSession(T):d&&g.onUpdateSession(T)}}}}},function(t,r,e){var n=e(35).fn;n.processChatroom=function(o){switch(o.cmd){case"getChatroomAddress":this.onChatroomAddress(o)}},n.onChatroomAddress=function(o){o.error||(o.obj.address=o.content.address)}},function(t,r,e){var n=e(35).fn;n.processQchat=function(o){switch(o.cmd){case"getQChatAddress":this.onQChatAddress(o)}},n.onQChatAddress=function(o){o.error||(o.obj.address=o.content.address)}},function(t,r,e){e(35).fn.processFilter=function(n){switch(n.cmd){case"sendFilterMsg":this.onSendMsg(n,!0);break;case"filterMsg":this.onMsg(n,!0);break;case"filterSysMsg":this.onSysMsg(n,!0);break;case"sendFilterCustomSysMsg":this.onSendSysMsg(n,!0)}}},function(t,r,e){var n=e(8),o=e(44),s=e(35).fn,a=e(0),i=o.clientTypeMap;function u(c){c=c||{};var d=a.copy(c);return d.clientType&&(d.clientType=i[d.clientType]||""),d.serverCustom&&(d.custom=JSON.parse(d.serverCustom),typeof d.custom[0]=="string"&&(d.custom=d.custom[0]),delete d.serverCustom),d}s.processEventService=function(c){var d=c.content,m=c.error,v=this.options||{};switch(m&&(m.callFunc="events::processsEventService",this.onCustomError("事件服务解包失败","EVENT_SERVICE_ERROR",m)),c.cmd){case"pushEvent":if(a.isFunction(v.onpushevents)){var g={msgEvents:[u(d.msgEvent)]};v.onpushevents(g)}break;case"pushEvents":if(a.isFunction(v.onpushevents)){var b=d.msgEvents;b={msgEvents:n(b).call(b,function(T){return u(T)})},v.onpushevents(b)}}}},function(t,r,e){var n=e(35).fn,o=e(0);n.processProxyService=function(s){var a=s.error;switch(a&&(a.callFunc="events::processProxyService",this.onCustomError("proxyService","EVENT_PROXY_SERVICE_ERROR",a)),s.cmd){case"onProxyMsg":if(o.isFunction(this.options.onProxyMsg)){var i=s.content.proxyMsg||{};i.time&&(i.time=+i.time),this.options.onProxyMsg(i)}break;case"httpProxy":s.obj=s.content&&s.content.proxyTag}}},function(t,r,e){var n=e(9),o=e(8),s=e(0),a=function(y){this.account=y.account},i=a.prototype,u=i.Message=e(72),c=i.TextMessage=e(829),d=i.FileMessage=e(203),m=i.GeoMessage=e(833),v=i.NotificationMessage=e(834),g=i.CustomMessage=e(835),b=i.TipMessage=e(836),T=i.RobotMessage=e(837),k=i.G2Message=e(838);i.validScenes=u.validScenes,i.validTypes=u.validTypes,i.sceneMap=u.sceneMap,i.sceneReverseMap=u.sceneReverseMap,i.reverse=function(y){var A;switch(u.getType(y)){case"text":A=n(c).call(c,y);break;case"image":case"audio":case"video":case"file":A=n(d).call(d,y);break;case"geo":A=n(m).call(m,y);break;case"notification":A=n(v).call(v,y);break;case"custom":A=n(g).call(g,y);break;case"tip":A=n(b).call(b,y);break;case"g2":A=n(k).call(k,y);break;case"robot":A=n(T).call(T,y);break;default:A=n(u).call(u,y)}return u.setExtra(A,this.account),A},i.reverseMsgs=function(y,A){var V,he,ae=this;return o(y).call(y,function(Ne){return Ne=n(ae).call(ae,Ne),A&&((V=A.modifyObj)&&(Ne=s.merge(Ne,V)),he=A.mapper,s.isFunction(he)&&(Ne=he(Ne))),Ne})},t.exports=a},function(t,r,e){var n=e(18),o=e(9),s=e(72),a=e(0);function i(u){a.verifyOptions(u,"text","msg::TextMessage"),u.type="text",s.call(this,u)}i.prototype=n(s.prototype),i.reverse=function(u){return o(s).call(s,u)},t.exports=i},function(t,r,e){var n=e(18),o=e(203);function s(){}s.prototype=n(o.prototype),s.verifyFile=function(a,i){return!0},t.exports=s},function(t,r,e){var n=e(18),o=e(203);function s(){}s.prototype=n(o.prototype),s.verifyFile=function(){},t.exports=s},function(t,r,e){var n=e(18),o=e(203);function s(){}s.prototype=n(o.prototype),s.verifyFile=function(){},t.exports=s},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(72),i=e(0);function u(c){c.type="geo",i.verifyOptions(c,"geo","msg::GeoMessage"),i.verifyOptions(c.geo,"lng lat title",!0,"geo.","msg::GeoMessage"),i.verifyParamType("geo.lng",c.geo.lng,"number","msg::GeoMessage"),i.verifyParamType("geo.lat",c.geo.lat,"number","msg::GeoMessage"),i.verifyParamType("geo.title",c.geo.title,"string","msg::GeoMessage"),a.call(this,c),this.attach=n(c.geo)}u.prototype=o(a.prototype),u.reverse=function(c){var d=s(a).call(a,c);return c.attach=c.attach?""+c.attach:"",d.geo=c.attach?JSON.parse(c.attach):{},d},t.exports=u},function(t,r,e){var n=e(18),o=e(9),s=e(8),a=e(170),i=e(0).notundef,u=e(72),c=e(147).IM,d=e(191),m=e(202),v={0:"addTeamMembers",1:"removeTeamMembers",2:"leaveTeam",3:"updateTeam",4:"dismissTeam",5:"passTeamApply",6:"transferTeam",7:"addTeamManagers",8:"removeTeamManagers",9:"acceptTeamInvite",10:"updateTeamMute",101:"netcallMiss",102:"netcallBill",103:"netcallReject",401:"addSuperTeamMembers",402:"removeSuperTeamMembers",403:"leaveSuperTeam",404:"updateSuperTeam",405:"dismissSuperTeam",406:"transferSuperTeam",407:"addSuperTeamManagers",408:"removeSuperTeamManagers",409:"updateSuperTeamMembersMute",410:"passSuperTeamApply",411:"acceptSuperTeamInvite"};function g(){}g.prototype=n(u.prototype),g.reverse=function(b){var T=o(u).call(u,b);if(b.attach=b.attach?""+b.attach:"",b.attach){var k=JSON.parse(b.attach);if(T.attach={type:v[k.id]||k.id},i(k.data)){var y,A,V=k.data;i(V.tinfo)&&(T.attach.team=o(d).call(d,c.syncUnserialize(V.tinfo,"team"),!0)),i(V.ids)&&(T.attach.accounts=V.ids),i(V.id)&&(T.attach.account=V.id),i(V.uinfos)&&(T.attach.users=s(y=V.uinfos).call(y,function(he){return o(m).call(m,c.syncUnserialize(he,"user"))})),i(V.mute)&&(T.attach.mute=+V.mute==1),i(V.attach)&&(T.attach.custom=V.attach),i(V.channel)&&(T.attach.channelId=V.channel),i(V.calltype)&&(T.attach.netcallType=V.calltype),i(V.duration)&&(T.attach.duration=V.duration),i(V.time)&&(T.attach.time=V.time),i(V.from)&&(T.attach.from=V.from),i(V.ext)&&(T.attach.ext=V.ext),T.attach.accounts&&T.attach.accounts.length<=2&&T.from===T.to&&a(A=T.attach.accounts).call(A,function(he){if(he!==T.to)return T.to=he,!0})}}else T.attach={};return T},t.exports=g},function(t,r,e){var n=e(18),o=e(9),s=e(72),a=e(0);function i(u){a.verifyOptions(u,"content","msg::CustomMessage"),u.type="custom",s.call(this,u),this.attach=u.content}i.prototype=n(s.prototype),i.reverse=function(u){var c=o(s).call(s,u);return c.content=u.attach,c},t.exports=i},function(t,r,e){var n=e(18),o=e(9),s=e(72),a=e(0);function i(u){a.verifyOptions(u,"tip","msg::TipMessage"),u.type="tip",s.call(this,u),this.body=u.tip}i.prototype=n(s.prototype),i.reverse=function(u){var c=o(s).call(s,u);return c.text="",c.tip=u.body,u.attach&&(c.attach=u.attach),c},t.exports=i},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(8),i=e(72),u=e(0),c={welcome:"00",text:"01",link:"03"},d={"01":"text","02":"image","03":"answer",11:"template"};function m(v){u.verifyOptions(v,"content","msg::RobotMessage"),u.undef(v.robotAccid)&&(v.robotAccid=v.to);var g=v.content;switch(g.type){case"welcome":u.undef(v.body)&&(this.body="欢迎消息");break;case"text":u.verifyOptions(g,"content","msg::RobotMessage"),u.undef(v.body)&&(this.body=g.content);break;case"link":u.verifyOptions(g,"target","msg::RobotMessage")}g.type&&(g.type=c[g.type]),g={param:g,robotAccid:v.robotAccid},this.attach=n(g),v.type="robot",i.call(this,v)}m.prototype=o(i.prototype),m.reverse=function(v){var g=s(i).call(i,v);if(g.type==="robot"){var b=JSON.parse(v.attach);if(b.param&&(b.param.type=d[b.param.type]||"unknown"),b.robotMsg){var T=(b=u.merge(b,b.robotMsg)).message;b.flag==="bot"?b.message=a(T).call(T,function(k){return k.type=d[k.type]||"unknown",k}):b.flag,delete b.robotMsg}g.content=b}return g},t.exports=m},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(72),i=e(0);function u(c){i.verifyOptions(c,"attach","msg::G2Message"),c.type="g2",a.call(this,c),this.attach=n(c.attach)}u.prototype=o(a.prototype),u.reverse=function(c){var d=s(a).call(a,c);return c.attach&&(d.attach=JSON.parse(c.attach)),d},t.exports=u},function(t,r,e){var n=e(58),o=e(102),s=e(25),a=e(103),i=e(8),u=e(17),c=e(6),d=e(3),m=e(2),v=e(41),g=e(5),b=e(59),T=e(60),k=e(61),y=e(62),A=e(47);function V(re,ue){var ze=g(re);if(b){var le=b(re);ue&&(le=u(le).call(le,function(de){return T(re,de).enumerable})),ze.push.apply(ze,le)}return ze}function he(re){for(var ue=1;ue<arguments.length;ue++){var ze,le,de=arguments[ue]!=null?arguments[ue]:{};ue%2?m(ze=V(Object(de),!0)).call(ze,function(Ie){n(re,Ie,de[Ie])}):k?y(re,k(de)):m(le=V(Object(de))).call(le,function(Ie){A(re,Ie,T(de,Ie))})}return re}var ae=e(39).fn,Ne=e(0),_e=Ne.isArray,Ce=e(150);ae.mergeObjArray=function(re,ue,ze){return re||(re=[]),ue?(_e(ue)||(ue=[ue]),ue.length?(ze=ze||{},Ne.mergeObjArray(re,ue,ze)):re):re},ae.cutObjArray=function(re,ue,ze){return re&&ue?(_e(ue)||(ue=[ue]),ue.length?(ze=ze||{},Ne.cutObjArray(re,ue,ze)):re):re},ae.mergeLoginPorts=function(re,ue){return this.mergeObjArray(re,ue,{keyPath:"deviceId"})},ae.cutLoginPorts=function(re,ue){return this.cutObjArray(re,ue,{keyPath:"deviceId",sortPath:"type"})},ae.mergeRelations=function(re,ue){return this.mergeObjArray(re,ue,{keyPath:"account"})},ae.cutRelations=function(re,ue){return this.cutObjArray(re,ue,{keyPath:"account"})},ae.findRelation=function(re,ue){return Ne.findObjInArray(re,{keyPath:"account",value:ue})},ae.mergeFriends=function(re,ue){return this.mergeObjArray(re,ue,{keyPath:"account"})},ae.cutFriends=function(re,ue){return this.cutObjArray(re,ue,{keyPath:"account"})},ae.cutFriendsByAccounts=function(re,ue){_e(ue)||(ue=[ue]);var ze=i(ue).call(ue,function(le){return{account:le}});return this.cutFriends(re,ze)},ae.findFriend=function(re,ue){return Ne.findObjInArray(re,{keyPath:"account",value:ue})},ae.mergeUsers=function(re,ue){return this.mergeObjArray(re,ue,{keyPath:"account"})},ae.findUser=function(re,ue){return Ne.findObjInArray(re,{keyPath:"account",value:ue})},ae.mergeTeams=function(re,ue){return this.mergeObjArray(re,ue,{keyPath:"teamId"})},ae.cutTeams=function(re,ue){return this.cutObjArray(re,ue,{keyPath:"teamId"})},ae.findTeam=function(re,ue){return Ne.findObjInArray(re,{keyPath:"teamId",value:ue})},ae.assembleTeamOwner=Ce.assembleOwner,ae.assembleTeamMembers=Ce.assembleMembers,ae.genTeamMemberId=Ce.genId,ae.mergeTeamMembers=function(re,ue){return this.mergeObjArray(re,ue)},ae.cutTeamMembers=function(re,ue){return this.cutObjArray(re,ue)},ae.cutTeamMembersByAccounts=function(re,ue,ze){_e(ze)||(ze=[ze]);var le=Ce.assembleMembers({teamId:ue},ze);return this.cutTeamMembers(re,le)},ae.findTeamMember=function(re,ue){return Ne.findObjInArray(re,{keyPath:"id",value:ue})},ae.mergeSessions=function(re,ue){return this.mergeObjArray(re,ue,{sortPath:"updateTime",desc:!0})},ae.cutSessions=function(re,ue){return this.cutObjArray(re,ue)},ae.cutSessionsByIds=function(re,ue){_e(ue)||(ue=[ue]);var ze=i(ue).call(ue,function(le){return{id:le}});return this.cutSessions(re,ze)},ae.findSession=function(re,ue){return Ne.findObjInArray(re,{keyPath:"id",value:ue})},ae.mergeMsgs=function(re,ue){return this.mergeObjArray(re,ue,{keyPath:"idClient",sortPath:"time"})},ae.cutMsgs=function(re,ue){return this.cutObjArray(re,ue,{keyPath:"idClient"})},ae.cutMsgsByIdClients=function(re,ue){_e(ue)||(ue=[ue]);var ze=i(ue).call(ue,function(le){return{idClient:le}});return this.cutMsgs(re,ze)},ae.findMsg=function(re,ue){return Ne.findObjInArray(re,{keyPath:"idClient",value:ue})},ae.mergeSysMsgs=function(re,ue){return this.mergeObjArray(re,ue,{keyPath:"idServer",desc:!0})},ae.cutSysMsgs=function(re,ue){return this.cutObjArray(re,ue,{keyPath:"idServer"})},ae.cutSysMsgsByIdServers=function(re,ue){_e(ue)||(ue=[ue]);var ze=i(ue).call(ue,function(le){return{idServer:le}});return this.cutSysMsgs(re,ze)},ae.findSysMsg=function(re,ue){return Ne.findObjInArray(re,{keyPath:"idServer",value:ue})},ae.searchLocal=function(re){if(Ne.verifyOptions(re,"keyword","searchLocal"),this.db.enable){var ue,ze=this,le=this.db,de=re.keyword+"",Ie=["account","nick","alias"],ie=["id","scene","lastMsg.type","lastMsg.text","localCustom","target.account","target.nick","target.alias","target.name"],Ve="",Ue=re.keyPath;switch(Ue?(Ve=(Ue=(Ue+"").split(".")).shift(),Ue=Ue.join(".")):Ve="all",Ve){case"user":Ue&&(Ie=u(Ie).call(Ie,function(ir){return ir===Ue||c(ir).call(ir,Ue+".")===0})),dr(Ie).then(function(ir){re.done(null,{sessions:[],users:ir})});break;case"session":Ue&&(ie=u(ie).call(ie,function(ir){return ir===Ue||c(ir).call(ir,Ue+".")===0})),Dt(ie,!Ue||c(Ue).call(Ue,"target")>-1).then(function(ir){re.done(null,{sessions:ir,users:[]})});break;case"all":sr().then(function(){d.all([Dt(ie,!0),dr(Ie)]).then(function(ir){re.done(null,{sessions:ir[0],users:ir[1]})})});break;default:re.done(null,{sessions:[],users:[],msg:'keyPath must start with "user" or "session"'})}}else re.done(null,{sessions:[],users:[],msg:"no db"});function Dt(ir,$e){return tr.apply(this,arguments)}function tr(){return(tr=a(o.mark(function ir($e,er){var nr;return o.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return nr=er?[le.getSessions(),sr(),le.getTeams(),le.getSuperTeams()]:[le.getSessions()],Pt.abrupt("return",d.all(nr).then(function(rr){var kt,Et=rr[0]||[],cr={p2p:rr[1]||[],team:rr[2]||[],superTeam:rr[3]||[]},mr={};return er&&(m(kt=g(cr)).call(kt,function(yr){var Tr;m(Tr=cr[yr]).call(Tr,function(Ir){var kr=Ir.teamId||Ir.account;mr[yr+"-"+kr]=Ir})}),m(Et).call(Et,function(yr){yr.target=mr[yr.id]})),Fe($e,Et)}));case 2:case"end":return Pt.stop()}},ir)}))).apply(this,arguments)}function dr(ir){return fr.apply(this,arguments)}function fr(){return(fr=a(o.mark(function ir($e){var er;return o.wrap(function(nr){for(;;)switch(nr.prev=nr.next){case 0:return nr.next=2,sr();case 2:return er=nr.sent,nr.abrupt("return",Fe($e,er));case 4:case"end":return nr.stop()}},ir)}))).apply(this,arguments)}function sr(){return hr.apply(this,arguments)}function hr(){return(hr=a(o.mark(function ir(){var $e,er;return o.wrap(function(nr){for(;;)switch(nr.prev=nr.next){case 0:if(!ue){nr.next=2;break}return nr.abrupt("return",ue);case 2:return nr.next=4,ze.db.getFriends();case 4:if(nr.t0=nr.sent,nr.t0){nr.next=7;break}nr.t0=[];case 7:return $e=nr.t0,er=ze.protocol.userSet||{},ue=i($e).call($e,function(Pt){return he(he({},Pt),er[Pt.account])}),nr.abrupt("return",ue);case 11:case"end":return nr.stop()}},ir)}))).apply(this,arguments)}function Fe(ir,$e){var er=[];return m($e).call($e,function(nr){for(var Pt=0;Pt<ir.length;Pt++){var rr=or(nr,ir[Pt].split("."));if(rr&&c(rr).call(rr,de)>-1){er.push(v({},nr));break}}}),er}function or(ir,$e){if(s(ir)==="object"&&ir)return $e.length===1?ir[$e[0]]:or(ir[$e.shift()],$e)}}},function(t,r,e){var n=e(15),o=e(39).fn,s=e(0),a=e(23).reportAPI;o.kick=function(i){var u;(i=i||{}).done=a({instance:this,className:"NIMFn",funcName:"kick",done:i.done}),s.verifyOptions(i,"deviceIds","link::kick"),this.processCallback(i),this.sendCmd("kick",{deviceIds:n(u=i.deviceIds).call(u,0)},i.callback)},o.disconnect=function(i){(i=i||{}).done=a({instance:this,className:"NIMFn",funcName:"disconnect",done:i.done}),i=i||{},this.protocol.disconnect(i.done)}},function(t,r,e){var n=e(39).fn,o=e(0),s=e(23).reportAPI;n.markInBlacklist=function(a){(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"markInBlacklist",done:a.done}),o.verifyOptions(a,"account isAdd","relation::markInBlacklist"),o.verifyParamType("isAdd",a.isAdd,"boolean","relation::markInBlacklist"),this.processCallback(a),this.sendCmd("markInBlacklist",{account:a.account,isAdd:a.isAdd},a.callback)},n.addToBlacklist=function(a){return(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"addToBlacklist",done:a.done}),a.isAdd=!0,this.markInBlacklist(a)},n.removeFromBlacklist=function(a){return(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"removeFromBlacklist",done:a.done}),a.isAdd=!1,this.markInBlacklist(a)},n.markInMutelist=function(a){(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"markInMutelist",done:a.done}),o.verifyOptions(a,"account","relation::markInMutelist"),o.verifyParamType("isAdd",a.isAdd,"boolean","relation::markInMutelist"),this.processCallback(a),this.sendCmd("markInMutelist",{account:a.account,isAdd:a.isAdd},a.callback)},n.addToMutelist=function(a){return(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"addToMutelist",done:a.done}),a.isAdd=!0,this.markInMutelist(a)},n.removeFromMutelist=function(a){return(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"removeFromMutelist",done:a.done}),a.isAdd=!1,this.markInMutelist(a)},n.getRelations=function(a){(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"getRelations",done:a.done});var i=this,u=i.db,c=0;function d(){i.sendCmd("getRelations",{timetag:c,NOTSTORE:"timetag"},a.callback)}a=o.verifyOptions(a),i.processCallback(a),u.enable?u.getRelationsTimetag().then(function(m){c=m,d()},d):d()}},function(t,r,e){var n=e(7),o=e(2),s=e(6),a=e(39).fn,i=e(0),u=i.objs2accounts,c=e(202),d=e(23).reportAPI;a.updateMyInfo=function(m){(m=m||{}).done=d({instance:this,className:"NIMFn",funcName:"updateMyInfo",done:m.done}),i.verifyOptions(m),this.processCallback(m),m.user=new c(m),delete m.user.account,this.sendCmd("updateMyInfo",{user:m.user,antispamTag:{antiSpamBusinessId:m.antiSpamBusinessId},single:!0},m.callback)},a.getMyInfo=function(m){return(m=m||{}).done=d({instance:this,className:"NIMFn",funcName:"getMyInfo",done:m.done}),(m=m||{}).account=this.account,this.getUser(m)},a.getUser=function(m){(m=m||{}).done=d({instance:this,className:"NIMFn",funcName:"getUser",done:m.done});var v,g=this,b=g.db;function T(){g.sendCmd("getUsers",{accounts:[v],single:!0},m.callback)}i.verifyOptions(m,"account","user::getUser"),g.processCallback(m),m.cbaop=function(k,y){if(!k)return y=y[0]||null,g.logger.info("api::getUser: cbaop ".concat(v)),y},v=m.account,m.sync?T():b.enable?b.getUser(v).then(function(k){k?m.done(null,k):T()},T):T()},a.getUsers=function(m){(m=m||{}).done=d({instance:this,className:"NIMFn",funcName:"getUsers",done:m.done});var v,g=this,b=g.db,T=[];function k(){g.sendCmd("getUsers",{accounts:v,single:!0},m.callback)}i.verifyOptions(m,"accounts","user::getUsers"),i.verifyParamType("accounts",m.accounts,"array","user::getUsers"),g.processCallback(m),m.cbaop=function(y,A){if(!y)return A=n(A).call(A,T),g.logger.info("api::getUsers: cbaop ".concat(v)),A},v=i.deduplicate(m.accounts),i.verifyArrayMax("accounts",m.accounts,150,"user::getUsers"),m.sync?k():b.enable?b.getUsers(v).then(function(y){if(y&&y.length===v.length)m.done(null,y);else{T=y;var A=u(y),V=[];o(v).call(v,function(he){s(A).call(A,he)===-1&&V.push(he)}),v=V,k()}},k):k()}},function(t,r,e){var n=e(138),o=e(39).fn,s=e(0),a=s.notundef,i=e(750),u=e(23).reportAPI;o.friendRequest=function(c){(c=c||{}).done=u({instance:this,className:"NIMFn",funcName:"friendRequest",done:c.done}),s.verifyOptions(c,"type account","friend::friendRequest"),s.verifyParamValid("type",c.type,i.validTypes(),"friend::friendRequest"),this.processPs(c),this.processCallback(c);var d={account:c.account,type:i.getByteFromType(c.type),ps:c.ps};a(c.idServer)&&(d.idServer=c.idServer),this.sendCmd("friendRequest",d,c.callback)},o.addFriend=function(c){(c=c||{}).done=u({instance:this,className:"NIMFn",funcName:"addFriend",done:c.done}),c.type="addFriend",this.friendRequest(c)},o.applyFriend=function(c){(c=c||{}).done=u({instance:this,className:"NIMFn",funcName:"applyFriend",done:c.done}),c.type="applyFriend",this.friendRequest(c)},o.passFriendApply=function(c){(c=c||{}).done=u({instance:this,className:"NIMFn",funcName:"passFriendApply",done:c.done}),s.verifyOptions(c,"idServer","friend::passFriendApply"),c.type="passFriendApply",this.friendRequest(c)},o.rejectFriendApply=function(c){(c=c||{}).done=u({instance:this,className:"NIMFn",funcName:"rejectFriendApply",done:c.done}),s.verifyOptions(c,"idServer","friend::rejectFriendApply"),c.type="rejectFriendApply",this.friendRequest(c)},o.deleteFriend=function(c){(c=c||{}).done=u({instance:this,className:"NIMFn",funcName:"deleteFriend",done:c.done}),s.verifyOptions(c,"account","friend::deleteFriend");var d=c.delAlias===!0;this.processCallback(c),this.sendCmd("deleteFriend",{account:c.account,delFriendParams:{delAlias:d?1:0}},c.callback)},o.updateFriend=function(c){(c=c||{}).done=u({instance:this,className:"NIMFn",funcName:"updateFriend",done:c.done}),this.processCallback(c);var d=new i(c);this.sendCmd("updateFriend",{friend:d,single:!0},c.callback)},o.getFriends=function(c){(c=c||{}).done=u({instance:this,className:"NIMFn",funcName:"getFriends",done:c.done});var d=this.db;s.validate({timetag:{type:"number",required:!1}},c,"friend::getFriends"),this.processCallback(c),d.enable?d.getFriends({updateTime:c.updateTime||0}).then(function(m){(m=n(m).call(m,function(v,g){return v.updateTime-g.updateTime})).invalid=[],c.done(null,m)}):this.sendCmd("getFriends",{timetag:c.updateTime||0,NOTSTORE:"timetag"},c.callback)},o.isMyFriend=function(c){(c=c||{}).done=u({instance:this,className:"NIMFn",funcName:"isMyFriend",done:c.done});var d=this.db;s.validate({account:{type:"string",allowEmpty:!1,require:!0}},c),this.processCallback(c),d.enable||c.done(null,!1),d.getFriend(c.account).then(function(m){m&&m.valid===!0?c.done(null,!0):c.done(null,!1)})},o.isUserInBlackList=function(c){(c=c||{}).done=u({instance:this,className:"NIMFn",funcName:"isUserInBlackList",done:c.done});var d=this.db;s.validate({account:{type:"string",allowEmpty:!1,require:!0}},c),this.processCallback(c),d.enable||c.done(null,!1),d.getUserFromBlackList(c.account).then(function(m){m&&m.account?c.done(null,!0):c.done(null,!1)})}},function(t,r,e){var n=e(39).fn,o=e(23).reportAPI;n.getRobots=function(s){(s=s||{}).done=o({instance:this,className:"NIMFn",funcName:"getRobots",done:s.done}),this.logger.warn("this api will be abandon"),(s=s||{}).type="getRobots",this.processCallback(s),this.sendCmd("sync",{sync:{robots:0}},s.callback)}},function(t,r,e){var n=e(15),o=e(8),s=e(17),a=e(3),i=e(39).fn,u=e(0),c=u.undef,d=e(191),m=e(150),v=e(23).reportAPI;i.createTeam=function(g){var b;(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"createTeam",done:g.done}),u.verifyOptions(g,"type name","team::createTeam"),c(g.accounts)?g.accounts=[]:u.verifyParamType("accounts",g.accounts,"array","team::createTeam"),g.action="create",this.processPs(g),this.processCallback(g),g.team=new d(g);var T={team:g.team,accounts:n(b=g.accounts).call(b,0),ps:g.ps,antispamTag:{antiSpamBusinessId:g.antiSpamBusinessId}};this.sendCmd("createTeam",T,g.callback)},i.updateTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"updateTeam",done:g.done}),u.verifyOptions(g,"teamId","team::updateTeam"),g.action="update",this.processCallback(g),g.team=new d(g),this.sendCmd("updateTeam",{team:g.team,antispamTag:{antiSpamBusinessId:g.antiSpamBusinessId},single:!0},g.callback)},i.addTeamMembers=function(g){var b;(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"addTeamMembers",done:g.done}),u.verifyOptions(g,"teamId accounts","team::addTeamMembers"),u.verifyParamType("accounts",g.accounts,"array","team::addTeamMembers"),this.processPs(g),u.notexist(g.custom)&&(g.custom=""),this.processCallback(g);var T={teamId:g.teamId,accounts:n(b=g.accounts).call(b,0),ps:g.ps,attach:g.custom};this.sendCmd("addTeamMembers",T,g.callback)},i.removeTeamMembers=function(g){var b;(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"removeTeamMembers",done:g.done}),u.verifyOptions(g,"teamId accounts","team::removeTeamMembers"),u.verifyParamType("accounts",g.accounts,"array","team::removeTeamMembers"),this.processCallback(g);var T={teamId:g.teamId,accounts:n(b=g.accounts).call(b,0)};this.sendCmd("removeTeamMembers",T,g.callback)},i.acceptTeamInvite=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"acceptTeamInvite",done:g.done}),u.verifyOptions(g,"idServer teamId from","team::acceptTeamInvite"),this.processCallback(g);var b={idServer:g.idServer,teamId:g.teamId,from:g.from,type:"teamInvite"};this.sendCmd("acceptTeamInvite",b,g.callback)},i.rejectTeamInvite=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"rejectTeamInvite",done:g.done}),u.verifyOptions(g,"idServer teamId from","team::rejectTeamInvite"),this.processPs(g),this.processCallback(g);var b={idServer:g.idServer,teamId:g.teamId,from:g.from,ps:g.ps,type:"teamInvite"};this.sendCmd("rejectTeamInvite",b,g.callback)},i.applyTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"applyTeam",done:g.done}),u.verifyOptions(g,"teamId","team::applyTeam"),this.processPs(g),this.processCallback(g);var b={teamId:g.teamId,ps:g.ps};this.sendCmd("applyTeam",b,g.callback)},i.passTeamApply=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"passTeamApply",done:g.done}),u.verifyOptions(g,"idServer teamId from","team::passTeamApply"),this.processCallback(g);var b={idServer:g.idServer,teamId:g.teamId,from:g.from,type:"applyTeam"};this.sendCmd("passTeamApply",b,g.callback)},i.rejectTeamApply=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"rejectTeamApply",done:g.done}),u.verifyOptions(g,"idServer teamId from","team::rejectTeamApply"),this.processPs(g),this.processCallback(g);var b={idServer:g.idServer,teamId:g.teamId,from:g.from,ps:g.ps,type:"applyTeam"};this.sendCmd("rejectTeamApply",b,g.callback)},i.addTeamManagers=function(g){var b;(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"addTeamManagers",done:g.done}),u.verifyOptions(g,"teamId accounts","team::addTeamManagers"),u.verifyParamType("accounts",g.accounts,"array","team::addTeamManagers"),this.processCallback(g);var T={teamId:g.teamId,accounts:n(b=g.accounts).call(b,0)};this.sendCmd("addTeamManagers",T,g.callback)},i.removeTeamManagers=function(g){var b;(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"removeTeamManagers",done:g.done}),u.verifyOptions(g,"teamId accounts","team::removeTeamManagers"),u.verifyParamType("accounts",g.accounts,"array","team::removeTeamManagers"),this.processCallback(g);var T={teamId:g.teamId,accounts:n(b=g.accounts).call(b,0)};this.sendCmd("removeTeamManagers",T,g.callback)},i.updateInfoInTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"updateInfoInTeam",done:g.done}),u.verifyOptions(g,"teamId","team::updateInfoInTeam"),this.processCallback(g),this.sendCmd("updateInfoInTeam",{teamMember:new m(g),single:!0},g.callback)},i.updateNickInTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"updateNickInTeam",done:g.done}),u.verifyOptions(g,"teamId account","team::updateNickInTeam"),this.processCallback(g),this.sendCmd("updateNickInTeam",{teamMember:new m(g),single:!0},g.callback)},i.updateMuteStateInTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"updateMuteStateInTeam",done:g.done}),u.verifyOptions(g,"teamId account mute","team::updateMuteStateInTeam"),this.processCallback(g),g.mute=g.mute?1:0,this.sendCmd("updateMuteStateInTeam",g)},i.getMutedTeamMembers=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getMutedTeamMembers",done:g.done}),u.verifyOptions(g,"teamId","team::getMutedTeamMembers"),this.processCallback(g),this.sendCmd("getMutedTeamMembers",g)},i.leaveTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"leaveTeam",done:g.done}),u.verifyOptions(g,"teamId","team::leaveTeam"),this.processCallback(g);var b={teamId:g.teamId};this.sendCmd("leaveTeam",b,g.callback)},i.transferTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"transferTeam",done:g.done}),u.verifyOptions(g,"teamId account leave","team::transferTeam"),u.verifyParamType("leave",g.leave,"boolean","team::transferTeam"),this.processCallback(g);var b={teamId:g.teamId,account:g.account,leave:g.leave};this.sendCmd("transferTeam",b,g.callback)},i.dismissTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"dismissTeam",done:g.done}),u.verifyOptions(g,"teamId","team::dismissTeam"),this.processCallback(g);var b={teamId:g.teamId};this.sendCmd("dismissTeam",b,g.callback)},i.getTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeam",done:g.done});var b,T=this,k=T.db;function y(){T.sendCmd("getTeam",{teamId:g.teamId},g.callback)}u.verifyOptions(g,"teamId","team::getTeam"),T.processCallback(g),g.cbaop=function(A){A||T.logger.info("api::getTeam: cbaop ".concat(b))},b=g.teamId,k.enable&&!g.sync?k.getTeam(b).then(function(A){A&&A.validToCurrentUser?(T.logger.log("api::getTeam: db.getTeam ".concat(b)),g.done(null,A)):y()},y):y()},i.getTeams=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeams",done:g.done});var b=this,T=b.db,k=0;function y(){b.sendCmd("getTeams",{timetag:k,NOTSTORE:"timetag"},g.callback)}u.verifyOptions(g),b.processCallback(g),T.enable?T.getTeamsTimetag().then(function(A){k=A,y()},y):y()},i.getTeamsById=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeamsById",done:g.done}),u.verifyOptions(g,"teamIds","teams::getTeamsById"),this.processCallback(g),this.sendCmd("getTeamsById",{teamIds:g.teamIds},g.callback)},i.getTeamMembers=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeamMembers",done:g.done});var b=this;u.verifyOptions(g,"teamId","team::getTeamMembers"),b.processCallback(g),b.sendCmd("getTeamMembers",{teamId:g.teamId,timetag:0,NOTSTORE:"timetag"},g.callback)},i.getTeamMemberByTeamIdAndAccount=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeamMemberByTeamIdAndAccount",done:g.done});var b=this;u.verifyParamType("teamId",g.teamId,"numeric or numeric string","team::getTeamMemberByTeamIdAndAccount"),u.verifyOptions(g,"account","team::getTeamMemberByTeamIdAndAccount"),b.processCallback(g),b.sendCmd("getTeamMembers",{teamId:g.teamId,timetag:0,NOTSTORE:"timetag"},function(T,k,y){var A={};if(k&&k.members&&k.members.length){for(var V=0;V<k.members.length;V++)if(k.members[V].account===g.account){A[g.account]=k.members[V];break}}g.callback(T,A,y)})},i.getTeamMemberInvitorAccid=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeamMemberInvitorAccid",done:g.done}),u.verifyParamType("teamId",g.teamId,"numeric or numeric string","team::getTeamMemberInvitorAccid"),c(g.accounts)||(u.verifyParamType("accounts",g.accounts,"array","team::getTeamMemberInvitorAccid"),g.accounts.length>200&&u.onParamError("accounts 参数数组长度不能超过200","team::getTeamMemberInvitorAccid"));var b,T={teamId:g.teamId};g.accounts.length&&(T.accounts=n(b=g.accounts).call(b,0)),this.processCallback(g),this.sendCmd("getTeamMemberInvitorAccid",T,function(k,y,A){g.callback(k,A&&A.accountsMap||{})})},i.notifyForNewTeamMsg=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"notifyForNewTeamMsg",done:g.done}),u.verifyOptions(g,"teamIds","team::notifyForNewTeamMsg"),this.protocol.notifyForNewTeamMsg(g.teamIds).then(function(b){g.done(b.error||null,o(b),b.miss)},function(b){g.done(b)})},i.getMyTeamMembers=function(g){v({instance:this,className:"NIMFn",funcName:"getMyTeamMembers",hasCallback:!1}),u.verifyOptions(g,"teamIds","team::getMyTeamMembers");var b=this.processCallbackPromise(g);return this.sendCmd("getMyTeamMembers",g),b},i.getLocalTeams=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getLocalTeams",done:g.done});var b,T=this.db,k=[];function y(){g.teams=k,g.done(b,g)}u.verifyOptions(g,"teamIds","team::getLocalTeams"),u.verifyParamType("teamIds",g.teamIds,"array","team::getLocalTeams"),this.processCallback(g),T.enable?T.getTeamsByTeamIds(g.teamIds).then(function(A){k=s(A).call(A,function(V){return!!V}),y()},function(A){b=A,y()}):y()},i.getLocalTeamMembers=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getLocalTeamMembers",done:g.done});var b,T=this.db,k=[];function y(){g.members=k,g.done(b,g)}u.verifyOptions(g,"teamId accounts","team::getLocalTeamMembers"),u.verifyParamType("accounts",g.accounts,"array","team::getLocalTeamMembers"),this.processCallback(g),T.enable?T.getInvalidTeamMembers(g.teamId,g.accounts).then(function(A){k=s(A).call(A,function(V){return!!V}),y()},function(A){b=A,y()}):y()},i.deleteLocalTeam=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"deleteLocalTeam",done:g.done});var b,T=this.db;function k(){g.done(b,g)}u.verifyOptions(g,"teamId","team::deleteLocalTeam"),this.processCallback(g),T.enable?T.deleteTeam(g.teamId).then(function(){k()},function(y){b=y,k()}):k()},i.muteTeamAll=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"muteTeamAll",done:g.done}),u.verifyOptions(g,"teamId mute","team::muteTeamAll"),g.mute=g.mute?1:0,this.processCallback(g),this.sendCmd("muteTeamAll",g)},i.sendTeamMsgReceipt=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"sendTeamMsgReceipt",done:g.done}),u.verifyOptions(g,"teamMsgReceipts","team::sendTeamMsgReceipt"),g.teamMsgReceipts.length>50?this.logger.error("team::sendTeamMsgReceipt：teamMsgReceipts length over 50"):(this.processCallback(g),this.sendCmd("sendTeamMsgReceipt",g))},i.getTeamMsgReads=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeamMsgReads",done:g.done}),u.verifyOptions(g,"teamMsgReceipts","team::getTeamMsgReads"),this.processCallback(g),this.sendCmd("getTeamMsgReads",g)},i.getTeamMsgReadAccounts=function(g){var b=this;(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getTeamMsgReadAccounts",done:g.done});var T,k=this;u.verifyOptions(g,"teamMsgReceipt","team::getTeamMsgReadAccounts"),g.callback=function(y,A,V){y&&T?(A=A||{teamMsgReceipt:g.teamMsgReceipt},g.done(y,A,{teamMsgReceipt:g.teamMsgReceipt,unreadAccounts:T.unreadAccounts,readAccounts:T.readAccounts})):g.done(y,A,V)},this.db.enable&&g.teamMsgReceipt.idClient?this.db.getMsgReadDetail(g.teamMsgReceipt.idClient).then(function(y){if(T=y,!y)return a.reject("no record");if(y.unreadAccounts&&y.unreadAccounts.length>0)return a.reject("unreadAccounts.length > 0");var A={teamMsgReceipt:g.teamMsgReceipt,unreadAccounts:y.unreadAccounts,readAccounts:y.readAccounts};k.logger.info("getTeamMsgReadAccounts from db"),g.done(null,{teamMsgReceipt:g.teamMsgReceipt},A)}).catch(function(y){b.logger.warn("db.getMsgReadDetail invalid",y),k.sendCmd("getTeamMsgReadAccounts",g)}):k.sendCmd("getTeamMsgReadAccounts",g)}},function(t,r,e){var n=e(754),o=e(3),s=e(9),a=e(24),i=e(15),u=e(8),c=e(2),d=e(7),m=e(39).fn,v=e(0),g=v.undef,b=e(306),T=e(201),k=e(23).reportAPI;function y(A){var V=this.db;if(!V.enable)return o.resolve({valid:!1});var he=V.getSuperTeam(A),ae=V.getSuperTeamMembersTimetag(A);return o.all([he,ae]).then(function(Ne){var _e=n(Ne,2),Ce=_e[0],re=_e[1],ue=Ce&&Ce.memberUpdateTime,ze={timetag:re=re||0};return ue&&re>=ue&&(ze.valid=!0),o.resolve(ze)}).catch(function(){return o.resolve({timetag:0})})}m.addSuperTeamMembers=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"addSuperTeamMembers",done:A.done}),v.verifyOptions(A,"teamId accounts","superTeam::addSuperTeamMembers"),v.verifyParamType("accounts",A.accounts,"array","superTeam::addSuperTeamMembers");var V=v.deduplicate(A.accounts);this.processPs(A),this.processCallback(A);var he={teamId:A.teamId,accounts:V,ps:A.ps};this.sendCmd("addSuperTeamMembers",he,A.callback)},m.removeSuperTeamMembers=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"removeSuperTeamMembers",done:A.done}),v.verifyOptions(A,"teamId accounts","team::removeSuperTeamMembers"),v.verifyParamType("accounts",A.accounts,"array","team::removeSuperTeamMembers");var V=v.deduplicate(A.accounts);this.processCallback(A);var he={teamId:A.teamId,accounts:V};this.sendCmd("removeSuperTeamMembers",he,A.callback)},m.leaveSuperTeam=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"leaveSuperTeam",done:A.done}),v.verifyOptions(A,"teamId","superTeam::leaveSuperTeam"),this.processCallback(A);var V={teamId:A.teamId};this.sendCmd("leaveSuperTeam",V,A.callback)},m.getSuperTeam=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"getSuperTeam",done:A.done});var V,he=this,ae=he.db;function Ne(){he.sendCmd("getSuperTeam",{teamId:A.teamId},A.callback)}v.verifyOptions(A,"teamId","team::getSuperTeam"),he.processCallback(A),A.cbaop=function(_e){_e||he.logger.info("api::getSuperTeam: cbaop ".concat(V))},V=A.teamId,ae.enable&&!A.sync?ae.getSuperTeam(V).then(function(_e){_e&&_e.validToCurrentUser?(he.logger.log("api::getSuperTeam: db.getSuperTeam ".concat(V)),A.done(null,_e)):Ne()}).catch(function(){Ne()}):Ne()},m.getSuperTeams=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"getSuperTeams",done:A.done});var V=this,he=V.db,ae=0;function Ne(){V.sendCmd("getSuperTeams",{timetag:ae,NOTSTORE:"timetag"},A.callback)}v.verifyOptions(A),V.processCallback(A),he.enable?he.getSuperTeamsTimetag().then(function(_e){ae=_e,Ne()},Ne):Ne()},m.updateSuperTeam=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"updateSuperTeam",done:A.done}),v.verifyOptions(A,"teamId","superTeam::updateSuperTeam"),A.action="update",this.processCallback(A),A.team=new b(A),this.sendCmd("updateSuperTeam",{team:A.team,antispamTag:{antiSpamBusinessId:A.antiSpamBusinessId},single:!0},A.callback)},m.updateInfoInSuperTeam=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"updateInfoInSuperTeam",done:A.done}),v.verifyOptions(A,"teamId","superTeam::updateInfoInSuperTeam"),this.processCallback(A),this.sendCmd("updateInfoInSuperTeam",{superTeamMember:new T(A),single:!0},A.callback)},m.getSuperTeamMembersByJoinTime=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"getSuperTeamMembersByJoinTime",done:A.done});var V=this,he=A,ae=he.joinTime,Ne=s(he),_e=he.limit,Ce=he.teamId;Ne=!!Ne,g(ae)&&(ae=0),g(_e)&&(_e=100),v.verifyOptions(A,"teamId","superTeam::getSuperTeamMembersByJoinTime"),v.verifyParamType("joinTime",ae,"number","api::superTeam::getSuperTeamMembersByJoinTime"),v.verifyParamType("limit",_e,"number","api::superTeam::getSuperTeamMembersByJoinTime"),V.processCallback(A),V.sendCmd("getSuperTeamMembersByJoinTime",{teamId:Ce,limit:_e,joinTime:ae,reverse:Ne,timetag:0,NOTSTORE:"timetag"},A.callback)},m.getAllSuperTeamMembers=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"getAllSuperTeamMembers",done:A.done});var V=this,he=this.db;function ae(Ne){Ne=Ne||0,V.sendCmd("getSuperTeamMembers",{teamId:A.teamId,timetag:Ne,NOTSTORE:"timetag"},A.callback)}v.verifyOptions(A,"teamId","superTeam::getAllSuperTeamMembers"),V.processCallback(A),a(y).call(y,this)(A.teamId).then(function(Ne){var _e=Ne.valid,Ce=Ne.timetag;_e?(V.logger.info("getAllSuperTeamMembers from local db"),he.getSuperTeamMembers(A.teamId).then(function(re){var ue={teamId:A.teamId,members:re};A.done(null,ue)},function(){return ae()})):ae(Ce)})},m.applySuperTeam=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"applySuperTeam",done:A.done}),v.verifyOptions(A,"teamId","team::applySuperTeam"),v.verifyOptions(A,"teamId","team::applySuperTeam"),this.processPs(A),this.processCallback(A);var V={teamId:A.teamId,ps:A.ps};this.sendCmd("applySuperTeam",V,A.callback)},m.passSuperTeamApply=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"passSuperTeamApply",done:A.done}),v.verifyOptions(A,"idServer teamId from","team::passSuperTeamApply"),this.processCallback(A);var V={idServer:A.idServer,teamId:A.teamId,from:A.from};this.sendCmd("passSuperTeamApply",V,A.callback)},m.rejectSuperTeamApply=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"rejectSuperTeamApply",done:A.done}),v.verifyOptions(A,"idServer teamId from","team::rejectSuperTeamApply"),this.processPs(A),this.processCallback(A);var V={idServer:A.idServer,teamId:A.teamId,from:A.from,ps:A.ps};this.sendCmd("rejectSuperTeamApply",V,A.callback)},m.acceptSuperTeamInvite=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"acceptSuperTeamInvite",done:A.done}),v.verifyOptions(A,"idServer teamId from","team::acceptSuperTeamInvite"),this.processCallback(A);var V={idServer:A.idServer,teamId:A.teamId,from:A.from};this.sendCmd("acceptSuperTeamInvite",V,A.callback)},m.rejectSuperTeamInvite=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"rejectSuperTeamInvite",done:A.done}),v.verifyOptions(A,"idServer teamId from","team::rejectSuperTeamInvite"),this.processPs(A),this.processCallback(A);var V={idServer:A.idServer,teamId:A.teamId,from:A.from,ps:A.ps};this.sendCmd("rejectSuperTeamInvite",V,A.callback)},m.addSuperTeamManagers=function(A){var V;(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"addSuperTeamManagers",done:A.done}),v.verifyOptions(A,"teamId accounts","team::addSuperTeamManagers"),v.verifyParamType("accounts",A.accounts,"array","team::addSuperTeamManagers"),this.processCallback(A);var he={teamId:A.teamId,accounts:i(V=A.accounts).call(V,0)};this.sendCmd("addSuperTeamManagers",he,A.callback)},m.removeSuperTeamManagers=function(A){var V;(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"removeSuperTeamManagers",done:A.done}),v.verifyOptions(A,"teamId accounts","team::removeSuperTeamManagers"),v.verifyParamType("accounts",A.accounts,"array","team::removeSuperTeamManagers"),this.processCallback(A);var he={teamId:A.teamId,accounts:i(V=A.accounts).call(V,0)};this.sendCmd("removeSuperTeamManagers",he,A.callback)},m.updateSuperTeamMembersMute=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"updateSuperTeamMembersMute",done:A.done}),v.verifyOptions(A,"teamId accounts mute","team::updateSuperTeamMembersMute"),v.verifyParamType("accounts",A.accounts,"array","team::updateSuperTeamMembersMute"),v.verifyArrayMax("accounts",A.accounts,10),this.processCallback(A),A.mute=A.mute?1:0,this.sendCmd("updateSuperTeamMembersMute",A)},m.updateSuperTeamMute=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"updateSuperTeamMute",done:A.done}),v.verifyOptions(A,"teamId mute","team::updateSuperTeamMute"),A.mute=A.mute?1:0,this.processCallback(A),this.sendCmd("updateSuperTeamMute",A)},m.updateNickInSuperTeam=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"updateNickInSuperTeam",done:A.done}),v.verifyOptions(A,"teamId account","team::updateNickInSuperTeam"),this.processCallback(A),this.sendCmd("updateNickInSuperTeam",{superTeamMember:new T(A),single:!0},A.callback)},m.transferSuperTeam=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"transferSuperTeam",done:A.done}),v.verifyOptions(A,"teamId account leave","team::transferSuperTeam"),v.verifyParamType("leave",A.leave,"boolean","team::transferSuperTeam"),this.processCallback(A);var V={teamId:A.teamId,account:A.account,leave:A.leave};this.sendCmd("transferSuperTeam",V,A.callback)},m.getSuperTeamMembersByAccounts=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"getSuperTeamMembersByAccounts",done:A.done});var V=this,he=this.db,ae=A,Ne=ae.teamId,_e=ae.accounts;if(v.verifyOptions(A,"teamId accounts","superTeam::getSuperTeamMembersByAccounts"),v.verifyParamType("accounts",_e,"array","superTeam::getSuperTeamMembersByAccounts"),v.verifyArrayMax("accounts",_e,20),_e.length<=0)return v.onParamError("参数accounts不能为空数组","superTeam::getSuperTeamMembersByAccounts");function Ce(){var re=u(_e).call(_e,function(ue){return Ne+"|"+ue});V.processCallback(A),V.sendCmd("getSuperTeamMembersByAccounts",{memberIds:re},function(ue,ze){A.done(null,{accounts:_e,members:ze.members,invaldAccounts:ze.invalid})})}y.call(this,Ne).then(function(re){var ue,ze,le;return re.valid?(ue=[],ze=[],le=[],c(_e).call(_e,function(de){var Ie,ie=he.getSuperTeamMemberById(d(Ie="".concat(Ne,"-")).call(Ie,de)).then(function(Ve){ze.push(Ve)}).catch(function(){le.push(de)});ue.push(ie)}),void o.all(ue).then(function(){A.done(null,{accounts:_e,members:ze,invaldAccounts:le})})):Ce()}).catch(function(){return Ce()})},m.getMutedSuperTeamMembers=function(A){(A=A||{}).done=k({instance:this,className:"NIMFn",funcName:"getMutedSuperTeamMembers",done:A.done});var V=this,he=A,ae=he.joinTime,Ne=s(he),_e=he.limit,Ce=he.teamId;Ne=!!Ne,g(ae)&&(ae=0),g(_e)&&(_e=100),v.verifyOptions(A,"teamId","superTeam::getSuperTeamMembersByJoinTime"),v.verifyParamType("joinTime",ae,"number","api::superTeam::getSuperTeamMembersByJoinTime"),v.verifyParamType("limit",_e,"number","api::superTeam::getSuperTeamMembersByJoinTime"),this.processCallback(A),V.sendCmd("getMutedSuperTeamMembers",{teamId:Ce,limit:_e,joinTime:ae,reverse:Ne},A.callback)}},function(t,r,e){var n=e(102),o=e(8),s=e(3),a=e(2),i=e(7),u=e(9),c=e(749),d=e(41),m=e(15),v=e(87),g=e(32),b=e(17),T=e(6),k=e(85),y=e(86),A=e(70),V=e(103);function he(ie,Ve){var Ue=y!==void 0&&A(ie)||ie["@@iterator"];if(!Ue){if(g(ie)||(Ue=function(hr,Fe){var or;if(hr){if(typeof hr=="string")return ae(hr,Fe);var ir=m(or=Object.prototype.toString.call(hr)).call(or,8,-1);if(ir==="Object"&&hr.constructor&&(ir=hr.constructor.name),ir==="Map"||ir==="Set")return k(hr);if(ir==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ir))return ae(hr,Fe)}}(ie))||Ve&&ie&&typeof ie.length=="number"){Ue&&(ie=Ue);var Dt=0,tr=function(){};return{s:tr,n:function(){return Dt>=ie.length?{done:!0}:{done:!1,value:ie[Dt++]}},e:function(hr){throw hr},f:tr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var dr,fr=!0,sr=!1;return{s:function(){Ue=Ue.call(ie)},n:function(){var hr=Ue.next();return fr=hr.done,hr},e:function(hr){sr=!0,dr=hr},f:function(){try{fr||Ue.return==null||Ue.return()}finally{if(sr)throw dr}}}}function ae(ie,Ve){(Ve==null||Ve>ie.length)&&(Ve=ie.length);for(var Ue=0,Dt=new Array(Ve);Ue<Ve;Ue++)Dt[Ue]=ie[Ue];return Dt}var Ne=e(39).fn,_e=e(0),Ce=_e.undef,re=_e.notundef,ue=e(295),ze=e(152),le=e(23).reportAPI,de=e(848);function Ie(ie,Ve){var Ue=this,Dt=[],tr=[],dr=this.db,fr=this;return dr.enable?(a(ie).call(ie,function(hr){var Fe=Ue.protocol.getSessionInCache(hr);Fe?sr(Fe,hr):tr.push(dr.getSession(hr).then(function(or){return sr(or,hr)}))}),s.all(tr).then(function(){return Dt})):(a(ie).call(ie,function(hr){return sr(Ue.protocol.getSessionInCache(hr),hr)}),s.resolve(Dt));function sr(hr,Fe){var or,ir,$e,er;hr?hr.lastMsg?hr.scene&&hr.to?hr.ack>=hr.lastMsg.time?fr.logger.warn(i(or="".concat(Ve," not need ack ")).call(or,hr.id)):Dt.push(hr):fr.logger.warn(i(ir="".concat(Ve," session.scene|to undefined ")).call(ir,hr.id)):fr.logger.warn(i($e="".concat(Ve," session.lastMsg undefined ")).call($e,hr.id)):fr.logger.warn(i(er="".concat(Ve," session undefined ")).call(er,Fe))}}Ne.setCurrSession=function(ie){le({instance:this,className:"NIMFn",funcName:"setCurrSession",hasCallback:!1}),this.resetSessionUnread(ie),this.protocol.setCurrSession(ie)},Ne.resetAllSessionUnread=function(){le({instance:this,className:"NIMFn",funcName:"resetAllSessionUnread",hasCallback:!1});for(var ie in this.protocol.sessionSet)this.protocol.sessionSet[ie].unread>0&&this.resetSessionUnread(ie)},Ne.resetSessionsUnread=function(){var ie=V(n.mark(function Ve(Ue){var Dt,tr,dr,fr,sr,hr,Fe,or,ir=arguments;return n.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return Dt=ir.length>1&&ir[1]!==void 0?ir[1]:function(){},Dt=le({instance:this,className:"NIMFn",funcName:"resetSessionsUnread",done:Dt}),(tr=this).logger.info("resetSessionsUnread::",Ue),$e.next=6,Ie.call(this,Ue,"api::resetSessionsUnread");case 6:if(dr=$e.sent,tr.protocol.resetSessionsUnread(dr),tr.options.syncSessionUnread&&dr.length!==0){$e.next=11;break}return Dt(),$e.abrupt("return");case 11:fr=o(dr).call(dr,function(er){return{scene:er.scene==="p2p"?0:1,to:er.to,timetag:er.lastMsg.time}}),sr=de(fr,50),hr=he(sr),$e.prev=14,or=n.mark(function er(){var nr;return n.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return nr=Fe.value,Pt.next=3,new s(function(rr,kt){tr.sendCmd("markSessionAckBatch",{sessionAckTags:nr},function(Et){Et?(Dt(Et),kt(Et)):rr()})});case 3:case"end":return Pt.stop()}},er)}),hr.s();case 17:if((Fe=hr.n()).done){$e.next=21;break}return $e.delegateYield(or(),"t0",19);case 19:$e.next=17;break;case 21:$e.next=26;break;case 23:$e.prev=23,$e.t1=$e.catch(14),hr.e($e.t1);case 26:return $e.prev=26,hr.f(),$e.finish(26);case 29:Dt(null);case 30:case"end":return $e.stop()}},Ve,this,[[14,23,26,29]])}));return function(Ve){return ie.apply(this,arguments)}}(),Ne.resetSuperTeamSessionsUnread=function(){var ie=V(n.mark(function Ve(Ue){var Dt,tr,dr,fr,sr,hr,Fe,or,ir=arguments;return n.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return Dt=ir.length>1&&ir[1]!==void 0?ir[1]:function(){},Dt=le({instance:this,className:"NIMFn",funcName:"resetSuperTeamSessionsUnread",done:Dt}),(tr=this).logger.info("resetSuperTeamSessionsUnread::",Ue),$e.next=6,Ie.call(this,Ue,"api::resetSuperTeamSessionsUnread");case 6:if(dr=$e.sent,tr.protocol.resetSessionsUnread(dr),tr.options.syncSessionUnread&&dr.length!==0){$e.next=11;break}return Dt(),$e.abrupt("return");case 11:fr=o(dr).call(dr,function(er){return{to:er.to,timetag:er.lastMsg.time}}),sr=de(fr,50),hr=he(sr),$e.prev=14,or=n.mark(function er(){var nr;return n.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return nr=Fe.value,Pt.next=3,new s(function(rr,kt){tr.sendCmd("markSuperTeamSessionsAck",{sessionAckTags:nr},function(Et){Et?(Dt(Et),kt(Et)):rr()})});case 3:case"end":return Pt.stop()}},er)}),hr.s();case 17:if((Fe=hr.n()).done){$e.next=21;break}return $e.delegateYield(or(),"t0",19);case 19:$e.next=17;break;case 21:$e.next=26;break;case 23:$e.prev=23,$e.t1=$e.catch(14),hr.e($e.t1);case 26:return $e.prev=26,hr.f(),$e.finish(26);case 29:Dt(null);case 30:case"end":return $e.stop()}},Ve,this,[[14,23,26,29]])}));return function(Ve){return ie.apply(this,arguments)}}(),Ne.resetSessionUnread=function(ie){var Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};Ve=le({instance:this,className:"NIMFn",funcName:"resetSessionUnread",done:Ve});var Ue=this,Dt=Ue.options.resetUnreadMode!==!1,tr=function(){var hr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;hr?Ve(hr,ie):Ve(null)};Ue.logger.info("resetSessionUnread::use reset mode",Dt);var dr=Ue.protocol.getSessionInCache(ie),fr=!dr&&this.db.enable?Ue.db.getSession(ie):s.resolve(dr);function sr(hr){if(!hr.lastMsg&&!hr.updateTime)return Ue.logger.warn("api::resetSessionUnread: session.lastMsg undefined ".concat(ie)),tr();if(!hr.scene||!hr.to)return Ue.logger.warn("api::resetSessionUnread: session.scene|to undefined ".concat(ie)),tr();var Fe;if(Fe=hr.lastMsg?hr.lastMsg.time:hr.updateTime,hr&&hr.ack&&hr.ack>=Fe)return Ue.logger.warn("api::resetSessionUnread: session ack not needs ".concat(ie)),tr();var or={done:function($e){$e?(Ue.logger.error({message:$e||"mark ack failed",callFunc:"resetSessionUnread"}),tr($e||"mark ack failed")):(Dt||Ue.protocol.resetSessionUnread(hr),tr())}};if(Ue.processCallback(or),hr.scene==="superTeam")Ue.sendCmd("markSuperTeamSessionAck",{to:hr.to,timetag:Fe},or.callback);else{var ir={scene:hr.scene==="p2p"?0:1,to:hr.to,timetag:Fe};Ue.sendCmd("markSessionAck",ir,or.callback)}}fr.then(function(hr){return hr?Ue.options.syncSessionUnread?(Dt&&Ue.protocol.resetSessionUnread(hr),void sr(hr)):(Ue.protocol.resetSessionUnread(hr),tr()):(Ue.logger.warn("api::resetSessionUnread: session undefined ".concat(ie)),tr())})},Ne.resetCurrSession=function(){le({instance:this,className:"NIMFn",funcName:"resetCurrSession",hasCallback:!1}),this.protocol.setCurrSession("")},Ne.insertLocalSession=function(ie){(ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"insertLocalSession",done:ie.done});var Ve,Ue;function Dt(){ie.session=Ue,ie.done(Ve,ie)}_e.verifyOptions(ie,"scene to","scene::insertLocalSession"),_e.verifyParamValid("scene",ie.scene,this.message.validScenes,"scene::insertLocalSession"),this.protocol.insertLocalSession(ie).then(function(tr){Ue=tr,Dt()},function(tr){Ve=tr,Dt()})},Ne.getLocalSessions=function(ie){(ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"getLocalSessions",done:ie.done});var Ve=[];_e.verifyOptions(ie),Ce(ie.limit)&&(ie.limit=100),_e.verifyParamType("limit",ie.limit,"number","scene::getLocalSessions"),re(u(ie))?_e.verifyParamType("reverse",u(ie),"boolean","scene::getLocalSessions"):ie.reverse=!1,this.processCallback(ie);var Ue=c(this.protocol.sessionSet),Dt=0,tr=ie.lastSessionId;if(u(ie)){var dr,fr=he(Ue);try{for(fr.s();!(dr=fr.n()).done;){var sr=dr.value,hr=sr.id;if(tr)hr===tr&&(tr=void 0);else if(sr.lastMsg!==void 0){if(++Dt>ie.limit)break;Ve.push(d({},sr))}}}catch(er){fr.e(er)}finally{fr.f()}}else{var Fe,or,ir=he(Ue);try{for(ir.s();!(or=ir.n()).done;){var $e=or.value;if(tr===$e.id)break;$e.lastMsg!==void 0&&Ve.push($e)}}catch(er){ir.e(er)}finally{ir.f()}Ve=u(Fe=m(Ve).call(Ve,-ie.limit)).call(Fe)}this.logger.debug("getLocalSessions::sessions is",Ve),Ve=o(Ve).call(Ve,function(er){return v(ze).call(ze,er)}),ie.sessions=Ve,delete ie.callback,ie.done(void 0,ie)},Ne.getLocalSession=function(ie){(ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"getLocalSession",done:ie.done});var Ve=this,Ue=Ve.db,Dt=null;if(_e.verifyOptions(ie,"sessionId","scene::getLocalSession"),_e.verifyParamType("sessionId",ie.sessionId,"string","scene::getLocalSession"),Dt=Ve.protocol.getSessionInCache(ie.sessionId),Ve.logger.debug("getLocalSession::cache session is",Dt),!Dt&&Ue.enable)return Ve.processCallback(ie),void Ue.getSession(ie.sessionId).then(function(tr){tr&&(Dt=tr,Ve.logger.debug("getLocalSession::db session is",Dt)),ie.done(null,Dt)}).catch(function(tr){ie.done(tr)});ie.done(null,v(ze).call(ze,Dt))},Ne.getLocalSessionsByMsgType=function(ie){var Ve;(ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"getLocalSessionsByMsgType",done:ie.done});var Ue=this.db,Dt=ie.exclude,tr=[],dr=m(Ve=ue.validTypes).call(Ve,0);if(re(Dt)){if(typeof Dt=="string")Dt=[Dt];else if(!g(Dt))return void _e.onParamInvalidType("exclude",["string","string array"],"","exclude::getLocalSessionsByMsgType");Dt=b(Dt).call(Dt,function(fr){return T(dr).call(dr,fr)>-1}),dr=b(dr).call(dr,function(fr){return T(Dt).call(Dt,fr)===-1})}this.processCallback(ie),Ue.enable?Ue.getSessions().then(function(fr){Dt&&Dt.length!==0?dr&&dr.length!==0?(a(fr).call(fr,function(sr,hr){var Fe,or,ir;sr.lastMsg&&T(Dt).call(Dt,sr.lastMsg.type)>-1&&(Fe=hr,or=sr.id,ir=Ue.getMsgs({sessionId:or,limit:1,types:dr}).then(function($e){return $e&&$e[0]?fr[Fe].lastMsg=$e[0]:fr[Fe].lastMsg=null,s.resolve()}),tr.push(ir))}),s.all(tr).then(function(){ie.done(null,{exclude:Dt,sessions:fr})})):ie.done(null,{exclude:Dt,sessions:o(fr).call(fr,function(sr){sr.lastMsg=null})}):ie.done(null,{exclude:Dt,sessions:fr})}):ie.done(null,{exclude:Dt,sessions:[]})},Ne.updateLocalSession=function(ie){(ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"updateLocalSession",done:ie.done});var Ve,Ue=this,Dt=Ue.db;_e.verifyOptions(ie,"id","scene::updateLocalSession"),Ue.processCallback(ie);var tr=_e.filterObj(ie,"id localCustom");function dr(){ie.needNotify!==!1&&Ue.protocol.onUpdateSession(tr),ie.session=tr,ie.done(Ve,ie)}tr=Ue.protocol.updateSessionInCache(ie),Dt.enable&&tr?Dt.updateSession(tr).then(function(fr){tr=fr,dr()},function(fr){Ve=fr,dr()}):dr()},Ne.deleteLocalSession=function(ie){(ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"deleteLocalSession",done:ie.done});var Ve,Ue=this,Dt=Ue.db;_e.verifyOptions(ie,"id","session::deleteLocalSession"),Ue.processCallback(ie);var tr=Ue.protocol.getSessionInCache(ie.id);if(Ue.protocol.deleteSessionInCache(ie.id,ie.isLogic),Dt.enable?(ie.isLogic?Dt.deleteSessionLogic(ie.id):Dt.deleteSession(ie.id,tr)).then(function(){Ue.logger.info("sessions::deleteSessionInDb::delete session done",ie.id),fr()},function(sr){Ve=sr,fr()}):fr(),ie.isDeleteRoaming){var dr=typeof ie.id=="string"?[ie.id]:ie.id;dr=o(dr).call(dr,function(sr){return sr.replace("-","|")}),this.sendCmd("deleteSessions",{sessions:dr},function(){})}function fr(){ie.done(Ve,ie)}},Ne.deleteSession=function(ie,Ve){(ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"deleteSession",done:ie.done}),Ve||this.logger.warn('this api will be abandon,please use "deleteLocalSession"'),_e.verifyOptions(ie,"scene to","session::deleteSession"),this.processCallback(ie),ie.sessions=[{scene:ie.scene,to:ie.to}],this.deleteSessions(ie)},Ne.deleteRoamingMsgBySession=function(ie){(ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"deleteRoamingMsgBySession",done:ie.done}),this.deleteSession(ie,!0)},Ne.deleteSessions=function(ie){var Ve,Ue;(ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"deleteSessions",done:ie.done}),_e.verifyOptions(ie,"sessions","session::deleteSessions"),_e.verifyParamType("sessions",ie.sessions,"array","session::deleteSessions"),a(Ve=ie.sessions).call(Ve,function(Dt,tr){_e.verifyOptions(Dt,"scene to",!0,"sessions["+tr+"].","session::deleteSessions")}),this.processCallback(ie),this.sendCmd("deleteSessions",{sessions:o(Ue=ie.sessions).call(Ue,function(Dt){return Dt.scene+"|"+Dt.to})},ie.callback)},Ne.getServerSessions=function(ie){(ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"getServerSessions",done:ie.done}),re(ie.minTimestamp)&&_e.verifyParamType("minTimestamp",ie.minTimestamp,"number","session::deleteSessions"),re(ie.maxTimestamp)&&_e.verifyParamType("maxTimestamp",ie.maxTimestamp,"number","session::deleteSessions"),re(ie.needLastMsg)&&(ie.needLastMsg=ie.needLastMsg===!1?0:1),re(ie.limit)&&(_e.verifyParamType("limit",ie.limit,"number","session::deleteSessions"),_e.verifyParamMax("limit",ie.limit,100,"scene::getLocalSessions")),this.processCallback(ie),this.sendCmd("getServerSessions",{sessionReqTag:ie},ie.callback)},Ne.getServerSession=function(ie){(ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"getServerSession",done:ie.done}),_e.verifyOptions(ie,"scene to","scene::getServerSession"),_e.verifyParamValid("scene",ie.scene,this.message.validScenes,"scene::getServerSession"),_e.verifyParamType("to",ie.to,"string","to::getServerSession");var Ve=ie.scene+"|"+ie.to;ie.scene==="superTeam"&&(Ve="super_team|"+ie.to),this.processCallback(ie),this.sendCmd("getServerSession",{session:{id:Ve}},ie.callback)},Ne.updateServerSession=function(ie){(ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"updateServerSession",done:ie.done}),_e.verifyOptions(ie,"scene to","scene::updateServerSession"),_e.verifyParamValid("scene",ie.scene,this.message.validScenes,"scene::updateServerSession"),_e.verifyParamType("to",ie.to,"string","to::updateServerSession"),re(ie.extra)&&_e.verifyParamType("extra",ie.extra,"string","extra::updateServerSession");var Ve=ie.scene+"|"+ie.to;ie.scene==="superTeam"&&(Ve="super_team|"+ie.to),this.processCallback(ie),this.sendCmd("updateServerSession",{session:{id:Ve,ext:ie.extra||""}},ie.callback)},Ne.deleteServerSessions=function(ie){var Ve,Ue=this;(ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"deleteServerSessions",done:ie.done}),_e.verifyOptions(ie,"sessions","scene::deleteServerSessions"),_e.verifyParamType("sessions",ie.sessions,"array","sessions::deleteServerSessions");var Dt=[];a(Ve=ie.sessions).call(Ve,function(tr){_e.verifyParamValid("scene",tr.scene,Ue.message.validScenes,"scene::deleteServerSessions"),_e.verifyParamType("to",tr.to,"string","to::deleteServerSessions");var dr=tr.scene+"|"+tr.to;tr.scene==="superTeam"&&(dr="super_team|"+tr.to),Dt.push({id:dr})}),this.processCallback(ie),this.sendCmd("deleteServerSessions",{sessions:Dt},ie.callback)},Ne.updateSessionsWithMoreRoaming=function(ie){var Ve;if((ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"updateSessionsWithMoreRoaming",done:ie.done}),_e.verifyOptions(ie,"msg","session::updateSessionsWithMoreRoaming"),_e.verifyCallback(ie,"done","session::updateSessionsWithMoreRoaming"),!this.db.enable)return ie.done(null,"db is disable");var Ue={time:ie.msg.time,idServer:ie.msg.idServer,to:ie.msg.to,from:ie.msg.from};_e.verifyParamType("msg.time",ie.msg.time,"number","time::updateSessionsWithMoreRoaming"),_e.verifyParamType("msg.idServer",ie.msg.idServer,"string","idServer::updateSessionsWithMoreRoaming"),_e.verifyParamType("msg.from",ie.msg.from,"string","from::updateSessionsWithMoreRoaming"),_e.verifyParamType("msg.to",ie.msg.to,"string","to::updateSessionsWithMoreRoaming"),_e.verifyParamValid("scene",ie.msg.scene,this.message.validScenes,"scene::updateSessionsWithMoreRoaming");var Dt=Ue.to===this.account?Ue.from:Ue.to;Ue.id=i(Ve="".concat(ie.msg.scene,"-")).call(Ve,Dt),this.db.updateSessionsWithMoreRoaming(Ue).then(function(tr){ie.done(null,tr)}).catch(function(tr){ie.done(tr)})},Ne.deleteSessionsWithMoreRoaming=function(ie){if((ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"deleteSessionsWithMoreRoaming",done:ie.done}),_e.verifyOptions(ie,"id","session::deleteSessionsWithMoreRoaming"),_e.verifyCallback(ie,"done","session::deleteSessionsWithMoreRoaming"),!this.db.enable)return ie.done(null,"db is disable");this.db.deleteSessionsWithMoreRoaming(ie.id).then(function(Ve){ie.done(null,Ve)}).catch(function(Ve){ie.done(Ve)})},Ne.getSessionsWithMoreRoaming=function(ie){if((ie=ie||{}).done=le({instance:this,className:"NIMFn",funcName:"getSessionsWithMoreRoaming",done:ie.done}),_e.verifyCallback(ie,"done","session::getSessionsWithMoreRoaming"),!this.db.enable)return ie.done(null,"db is disable");this.db.getSessionsWithMoreRoaming(ie.id).then(function(Ve){ie.done(null,Ve)}).catch(function(Ve){ie.done(Ve)})}},function(t,r,e){var n=e(849),o=e(850),s=e(851),a=Math.ceil,i=Math.max;t.exports=function(u,c,d){c=(d?o(u,c,d):c===void 0)?1:i(s(c),0);var m=u==null?0:u.length;if(!m||c<1)return[];for(var v=0,g=0,b=Array(a(m/c));v<m;)b[g++]=n(u,v,v+=c);return b}},function(t,r){t.exports=function(e,n,o){var s=-1,a=e.length;n<0&&(n=-n>a?0:a+n),(o=o>a?a:o)<0&&(o+=a),a=n>o?0:o-n>>>0,n>>>=0;for(var i=Array(a);++s<a;)i[s]=e[s+n];return i}},function(t,r,e){var n=e(198),o=e(199),s=e(300),a=e(88);t.exports=function(i,u,c){if(!a(c))return!1;var d=typeof u;return!!(d=="number"?o(c)&&s(u,c.length):d=="string"&&u in c)&&n(c[u],i)}},function(t,r,e){var n=e(852);t.exports=function(o){var s=n(o),a=s%1;return s==s?a?s-a:s:0}},function(t,r,e){var n=e(853);t.exports=function(o){return o?(o=n(o))===1/0||o===-1/0?17976931348623157e292*(o<0?-1:1):o==o?o:0:o===0?o:0}},function(t,r,e){var n=e(854),o=e(88),s=e(856),a=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;t.exports=function(d){if(typeof d=="number")return d;if(s(d))return NaN;if(o(d)){var m=typeof d.valueOf=="function"?d.valueOf():d;d=o(m)?m+"":m}if(typeof d!="string")return d===0?d:+d;d=n(d);var v=i.test(d);return v||u.test(d)?c(d.slice(2),v?2:8):a.test(d)?NaN:+d}},function(t,r,e){var n=e(855),o=/^\s+/;t.exports=function(s){return s&&s.slice(0,n(s)+1).replace(o,"")}},function(t,r){var e=/\s/;t.exports=function(n){for(var o=n.length;o--&&e.test(n.charAt(o)););return o}},function(t,r,e){var n=e(119),o=e(104);t.exports=function(s){return typeof s=="symbol"||o(s)&&n(s)=="[object Symbol]"}},function(t,r,e){var n=e(120),o=e(858),s=e(859),a=e(102),i=e(103),u=e(58),c=e(17),d=e(15),m=e(2),v=e(32),g=e(170),b=e(8),T=e(7),k=e(9),y=e(10),A=e(864),V=e(5),he=e(59),ae=e(60),Ne=e(61),_e=e(62),Ce=e(47),re=["callback","done"];function ue(Fe,or){var ir=V(Fe);if(he){var $e=he(Fe);or&&($e=c($e).call($e,function(er){return ae(Fe,er).enumerable})),ir.push.apply(ir,$e)}return ir}function ze(Fe){for(var or=1;or<arguments.length;or++){var ir,$e,er=arguments[or]!=null?arguments[or]:{};or%2?m(ir=ue(Object(er),!0)).call(ir,function(nr){u(Fe,nr,er[nr])}):Ne?_e(Fe,Ne(er)):m($e=ue(Object(er))).call($e,function(nr){Ce(Fe,nr,ae(er,nr))})}return Fe}var le=e(39).fn,de=e(0),Ie=de.undef,ie=de.notundef,Ve=e(44),Ue=e(152),Dt=e(151),tr=e(40),dr=e(72),fr=e(23).reportAPI,sr=e(13);le.sendG2Msg=function(Fe){return(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"sendG2Msg",done:Fe.done}),this.processCallback(Fe),Fe.msg=new this.message.G2Message(Fe),this.sendMsg(Fe)},le.beforeSendMsg=function(Fe){var or,ir=this.protocol,$e=Fe.msg;switch($e.to===this.account&&($e.fromDeviceId=Ve.deviceId),$e.userUpdateTime=ir.myInfo&&ir.myInfo.updateTime,$e.getScene()){case"p2p":or="sendMsg";break;case"team":or="sendTeamMsg";break;case"superTeam":or="sendSuperTeamMsg"}c(Fe)&&(or="sendFilterMsg",$e.filter=!0),Fe.cmd=or},le.afterSendMsg=function(Fe){var or=Fe.rtnMsg;if(!or||!or.ignore){var ir=this.protocol.getSessionInCache(or.sessionId);Fe.isLocal&&ir&&ir.lastMsg&&or.time<ir.lastMsg.time||this.protocol.onUpdateSession(Ue.genSessionByMsg(or))}},le.beforeForwardMsg=function(Fe){de.verifyOptions(Fe,"msg scene to","msg::beforeForwardMsg"),Fe.msg.scene=Fe.scene,Fe.msg.to=Fe.to},le.markMsgRead=function(Fe){var or=this.protocol;!Fe||this.db.enable||or.options.autoMarkRead?this.logger.warn("api::markMsgRead: 不需要标记消息为已收到 (没有消息, 或者启用了数据库, 或者启用了自动标记已收到)"):or.markMsgRead(Fe,!0)},le.sendMsgReceipt=function(Fe){if((Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"sendMsgReceipt",done:Fe.done}),de.verifyOptions(Fe),this.processCallback(Fe),Fe.msg){de.verifyOptions(Fe,"msg","msg::sendMsgReceipt");var or=Fe.msg;de.verifyOptions(or,"target idClient time",!0,"msg.","msg::sendMsgReceipt"),this.protocol.shouldSendMsgReceipt(or)?this.sendCmd("sendMsgReceipt",{msgReceipt:{to:or.target,idClient:or.idClient,time:or.time}},Fe.callback):Fe.done()}else Fe.done()},le.isMsgRemoteRead=function(Fe){return fr({instance:this,className:"NIMFn",funcName:"isMsgRemoteRead",hasCallback:!1}),this.protocol.isMsgRemoteRead(Fe)},le.recallMsg=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"recallMsg",done:Fe.done}),this.deleteMsg(Fe,!0)},le.deleteMsg=function(Fe,or){var ir;(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"deleteMsg",done:Fe.done}),or||this.logger.warn("this api will be abandon,please use “recallMsg”"),de.verifyOptions(Fe,"msg","msg::deleteMsg");var $e=Fe.msg;if($e.scene!=="team"&&$e.from!==this.account||$e.status!=="success"||$e.isLocal)return Fe.done(tr.newParamError("只能删除自己发的, 并且发送成功的消息，且不能是本地消息",{callFunc:"msg::deleteMsg"}),Fe);de.verifyOptions($e,["scene","to","from","time","idClient","idServer"],!0,"msg.","msg::deleteMsg"),de.verifyParamValid("msg.scene",$e.scene,this.message.validScenes,"msg::deleteMsg"),this.processPs(Fe),this.processCallback(Fe);var er={deletedIdClient:$e.idClient,deletedIdServer:$e.idServer,time:$e.time,from:$e.from,to:$e.to,opeAccount:$e.from},nr=$e.scene==="superTeam"?"deleteSuperTeamMsg":"deleteMsg";er.type="deleteMsg"+$e.scene[0].toUpperCase()+d(ir=$e.scene).call(ir,1);var Pt=["ps","apnsText","pushPayload","env","opeAccount","attach"];m(Pt).call(Pt,function(rr){Fe[rr]&&(er[rr]=Fe[rr])}),er=new Dt(er),this.sendCmd(nr,{sysMsg:er,msg:$e},Fe.callback)},le.deleteMsgSelf=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"deleteMsgSelf",done:Fe.done}),de.verifyOptions(Fe,"msg","msg::deleteMsgSelf");var or=Fe.msg;if(or.scene==="superTeam")return Fe.done(tr.newParamError("单向删除暂不支持超大群场景",{callFunc:"msg::deleteMsgSelf"}),Fe);de.verifyOptions(or,["scene","to","from","time","idClient","idServer"],!0,"msg.","msg::deleteMsgSelf"),de.verifyParamValid("msg.scene",or.scene,this.message.validScenes,"msg::deleteMsgSelf"),this.processCallback(Fe);var ir={scene:or.scene==="p2p"?1:2,from:or.from,to:or.to,time:or.time,idClient:or.idClient,idServer:or.idServer,custom:Fe.custom};this.sendCmd("deleteMsgSelf",{deleteMsgSelfTag:ir},Fe.callback)},le.deleteMsgSelfBatch=function(Fe){var or,ir,$e,er=this;if((Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"deleteMsgSelfBatch",done:Fe.done}),de.verifyOptions(Fe,"msgs","msg::deleteMsgSelfBatch"),(!v(Fe.msgs)||Fe.msgs.length===0||Fe.msgs.length>100)&&de.onParamError("msgs应该是数组且数据长度应大于0小于等于100","msg::deleteMsgSelfBatch"),g(or=Fe.msgs).call(or,function(Pt){return Pt.scene==="superTeam"}))return Fe.done(tr.newParamError("消息列表中存在超大群消息，单向删除暂不支持超大群场景",{callFunc:"msg::deleteMsgSelfBatch"}),Fe);m(ir=Fe.msgs).call(ir,function(Pt){de.verifyOptions(Pt,["scene","to","from","time","idClient","idServer"],!0,"msg.","msg::deleteMsgSelfBatch"),de.verifyParamValid("msg.scene",Pt.scene,er.message.validScenes,"msg::deleteMsgSelfBatch")}),this.processCallback(Fe);var nr=b($e=Fe.msgs).call($e,function(Pt){var rr;return{scene:Pt.scene==="p2p"?1:2,from:Pt.from,to:Pt.to,time:Pt.time,idClient:Pt.idClient,idServer:Pt.idServer,sessionId:Pt.sessionId||T(rr="".concat(Pt.scene,"-")).call(rr,Pt.to),custom:Fe.custom}});this.sendCmd("deleteMsgSelfBatch",{deleteMsgSelfTags:nr},Fe.callback)};var hr={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,tip:10,robot:11,custom:100};le.getHistoryMsgs=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"getHistoryMsgs",done:Fe.done}),this.protocol.syncing&&this.logger.warn("Please call getHistoryMsgs after onsyncdone callback"),de.verifyOptions(Fe,"scene to","msg::getHistoryMsgs"),de.verifyParamValid("scene",Fe.scene,this.message.validScenes,"msg::getHistoryMsgs"),Fe.beginTime===void 0&&(Fe.beginTime=0);var or,ir=this.protocol.getSessionInCache(Fe.scene+"-"+Fe.to),$e=ir&&ir.lastEmptyTime;if($e>Fe.beginTime&&(Fe.beginTime=$e),de.verifyParamType("beginTime",Fe.beginTime,"number","msg::getHistoryMsgs"),Fe.endTime===void 0&&(Fe.endTime=0),de.verifyParamType("endTime",Fe.endTime,"number","msg::getHistoryMsgs"),Fe.lastMsgId=Fe.lastMsgId&&+Fe.lastMsgId?Fe.lastMsgId:"0",Fe.limit===void 0&&(Fe.limit=100),de.verifyParamType("limit",Fe.limit,"number","msg::getHistoryMsgs"),de.verifyParamMax("limit",Fe.limit,100,"msg::getHistoryMsgs"),ie(k(Fe))?de.verifyParamType("reverse",k(Fe),"boolean","msg::getHistoryMsgs"):Fe.reverse=!1,ie(Fe.asc)?de.verifyParamType("asc",Fe.asc,"boolean","msg::getHistoryMsgs"):Fe.asc=!1,Ie(Fe.msgTypes))Fe.msgTypes=[];else if(v(Fe.msgTypes)){var er,nr;Fe.msgTypes=b(er=Fe.msgTypes).call(er,function(rr){return hr[rr]}),Fe.msgTypes=c(nr=Fe.msgTypes).call(nr,function(rr){return typeof rr=="number"})}else typeof hr[Fe.msgTypes]=="number"?Fe.msgTypes=[hr[Fe.msgTypes]]:Fe.msgTypes=[];switch(this.processCallback(Fe),Fe.cbaop=function(rr,kt){if(!rr){var Et;Fe.asc&&(kt.msgs=k(Et=kt.msgs).call(Et)),kt.msgs=dr.deduplication(kt.msgs)}},Fe.scene){case"p2p":or="getHistoryMsgs";break;case"team":or="getTeamHistoryMsgs";break;case"superTeam":or="getSuperTeamHistoryMsgs"}var Pt={scene:Fe.scene,to:Fe.to,beginTime:Fe.beginTime,endTime:Fe.endTime,lastMsgId:Fe.lastMsgId,limit:Fe.limit,reverse:k(Fe),msgTypes:Fe.msgTypes};this.sendCmd(or,Pt,Fe.callback)},le.searchHistoryMsgs=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"searchHistoryMsgs",done:Fe.done}),de.verifyOptions(Fe,"scene to keyword","msg::searchHistoryMsgs"),de.verifyParamValid("scene",Fe.scene,this.message.validScenes,"msg::searchHistoryMsgs"),Fe.beginTime===void 0&&(Fe.beginTime=0);var or,ir=this.protocol.getSessionInCache(Fe.scene+"-"+Fe.to),$e=ir&&ir.lastEmptyTime;switch($e>Fe.beginTime&&(Fe.beginTime=$e),de.verifyParamType("beginTime",Fe.beginTime,"number","msg::searchHistoryMsgs"),Fe.endTime===void 0&&(Fe.endTime=0),de.verifyParamType("endTime",Fe.endTime,"number","msg::searchHistoryMsgs"),Fe.limit===void 0&&(Fe.limit=100),de.verifyParamType("limit",Fe.limit,"number","msg::searchHistoryMsgs"),de.verifyParamMax("limit",Fe.limit,100,"msg::searchHistoryMsgs"),ie(k(Fe))?de.verifyParamType("reverse",k(Fe),"boolean","msg::searchHistoryMsgs"):Fe.reverse=!1,ie(Fe.asc)?de.verifyParamType("asc",Fe.asc,"boolean","msg::searchHistoryMsgs"):Fe.asc=!1,this.processCallback(Fe),Fe.asc&&(Fe.cbaop=function(nr,Pt){var rr;nr||(Pt.msgs=k(rr=Pt.msgs).call(rr))}),Fe.scene){case"p2p":or="searchHistoryMsgs";break;case"team":or="searchTeamHistoryMsgs"}var er=de.filterObj(Fe,"scene to beginTime endTime keyword limit reverse");this.sendCmd(or,er,Fe.callback)},le.getLocalMsgs=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"getLocalMsgs",done:Fe.done});var or=this,ir=or.db,$e=[];de.verifyOptions(Fe);var er=!1;ie(Fe.start)&&(er=!0,de.verifyParamType("start",Fe.start,"number","msg::getLocalMsgs"));var nr=!1;if(ie(Fe.end)&&(nr=!0,de.verifyParamType("end",Fe.end,"number","msg::getLocalMsgs")),er&&nr&&Fe.end<=Fe.start&&de.onParamError("参数 end 必须晚于 start"),ie(Fe.subTypes)&&de.verifyParamType("subTypes",Fe.subTypes,"array","msg::getLocalMsgs"),Ie(Fe.limit)&&(Fe.limit=100),de.verifyParamType("limit",Fe.limit,"number","msg::getLocalMsgs"),de.verifyParamMin("limit",Fe.limit,1,"msg::getLocalMsgs"),or.processCallback(Fe),ir.enable){var Pt=new Date().getTime();ir.getMsgs(Fe).then(function(kt){var Et;$e=kt,or.logger.info(T(Et="api::getLocalMsgs: query db cost ".concat(new Date().getTime()-Pt," ms and the conditions is ")).call(Et,y(Fe))),rr()},function(kt){(kt=kt||{}).message=kt.message||"msg::getLocalMsgs:db error",rr()})}else rr();function rr(){var kt=de.simpleClone(Fe);kt.msgs=$e,delete kt.callback,delete kt.done,Fe.done(null,kt)}},le.getLocalMsgsInUnread=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"getLocalMsgsInUnread",done:Fe.done});var or=this;de.validate({sessionId:{type:"string",allowEmpty:!1}},Fe),this.getLocalSession({sessionId:Fe.sessionId,done:function(ir,$e){ir?Fe.done&&Fe.done(ir):$e?($e.ack=$e.ack||0,or.getLocalMsgs(ze({sessionId:Fe.sessionId,start:$e.ack,limit:A,filterFunc:function(er){return er.flow==="in"&&er.isUnreadable===!0},done:function(){}},Fe))):Fe.done&&Fe.done(new Error("session ".concat(Fe.sessionId," not exist")))}})},le.getLocalMsgByIdClient=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"getLocalMsgByIdClient",done:Fe.done});var or=this.db,ir=null,$e=null;function er(){Fe.msg=$e,Fe.done(ir,Fe)}de.verifyOptions(Fe,"idClient","msg::getLocalMsgByIdClient"),this.processCallback(Fe),or.enable?or.getMsgByIdClient(Fe.idClient).then(function(nr){nr&&($e=nr),er()},function(nr){ir=nr,er()}):(this.logger.warn("because db is false,error is null"),er())},le.getLocalMsgsByIdClients=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"getLocalMsgsByIdClients",done:Fe.done});var or,ir=this.db,$e=[];function er(){Fe.msgs=$e,Fe.done(or,Fe)}de.verifyOptions(Fe,"idClients","msg::getLocalMsgByIdClients"),de.verifyParamType("idClients",Fe.idClients,"array","msg::getLocalMsgByIdClients"),this.processCallback(Fe),ir.enable?ir.getMsgsByIdClients(Fe.idClients).then(function(nr){$e=c(nr).call(nr,function(Pt){return!!Pt}),er()},function(nr){or=nr,er()}):er()},le.updateLocalMsg=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"updateLocalMsg",done:Fe.done});var or,ir=this.db,$e=null;if(de.verifyOptions(Fe,"idClient","msg::updateLocalMsg"),this.processCallback(Fe),ir.enable){var er=de.filterObj(Fe,"idClient localCustom");ir.updateMsg(er).then(function(Pt){$e=Pt,nr()},function(Pt){or=Pt,nr()})}else nr();function nr(){Fe.msg=$e,Fe.done(or,Fe)}},le.deleteLocalMsg=function(){var Fe=i(a.mark(function or(ir){var $e,er,nr,Pt;return a.wrap(function(rr){for(;;)switch(rr.prev=rr.next){case 0:return Pt=function(){ir.done(er,ir)},(ir=ir||{}).done=fr({instance:this,className:"NIMFn",funcName:"deleteLocalMsg",done:ir.done}),$e=this,de.verifyOptions(ir,"msg","msg::deleteLocalMsg"),nr=ir.msg,de.verifyOptions(nr,"idClient sessionId",!0,"msg.","msg::deleteLocalMsg"),$e.processCallback(ir),rr.prev=8,rr.next=11,$e.protocol.deleteLocalMsg(nr);case 11:Pt(),rr.next=18;break;case 14:rr.prev=14,rr.t0=rr.catch(8),er=rr.t0,Pt();case 18:case"end":return rr.stop()}},or,this,[[8,14]])}));return function(or){return Fe.apply(this,arguments)}}(),le.deleteLocalMsgsBySession=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"deleteLocalMsgsBySession",done:Fe.done});var or,ir=this,$e=ir.db;de.verifyOptions(Fe,"scene to","msg::deleteLocalMsgsBySession"),de.verifyParamValid("scene",Fe.scene,ir.message.validScenes,"msg::deleteLocalMsgsBySession"),Fe.sessionId=Fe.scene+"-"+Fe.to,Fe.delLastMsg=Fe.delLastMsg===!0,Fe.isTag=Fe.isTag===!0;var er=new Date().getTime();function nr(){Fe.done(or,Fe)}ir.processCallback(Fe);var Pt={id:Fe.sessionId};Fe.delLastMsg&&(Pt.lastMsg=null),Fe.isTag&&(Pt.lastEmptyTime=er),$e.enable?$e.deleteMsgsBySessionId(Fe).then(function(){Fe.delLastMsg||Fe.isTag?$e.updateSession(Pt).then(function(rr){ir.protocol.onUpdateSession(rr),Fe.session=rr,nr()}):nr()}).catch(function(rr){or=rr,nr()}):(this.logger.warn("because db is false,error is null"),nr(),(Fe.delLastMsg||Fe.isTag)&&ir.protocol.onUpdateSession(Pt))},le.deleteLocalMsgsByTime=function(Fe){var or=this.db;sr.isBrowser&&or.enable&&(ie((Fe=Fe||{}).start)?de.verifyParamType("start",Fe.start,"number","msg::deleteLocalMsgsByTime"):Fe.start=0,ie(Fe.end)?de.verifyParamType("end",Fe.end,"number","msg::deleteLocalMsgsByTime"):Fe.end=1/0,ie(Fe.end)&&ie(Fe.start)&&Fe.end<=Fe.start&&de.onParamError("参数 end 必须大于 start"),this.processCallback(Fe),this.protocol.deleteLocalMsgsByTime(Fe).then(function(ir){Fe.done(null,ir)},function(ir){Fe.done(ir,null)}))},le.deleteLocalMsgs=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"deleteLocalMsgs",done:Fe.done});var or;function ir(){Fe.done(or,Fe)}Fe.updateSession=Fe.updateSession!==!1,de.verifyOptions(Fe,"sessionId","msg::deleteLocalMsgsBySession"),ie(Fe.start)&&de.verifyParamType("start",Fe.start,"number","msg::deleteLocalMsgs"),ie(Fe.end)&&de.verifyParamType("end",Fe.end,"number","msg::deleteLocalMsgs"),ie(Fe.end)&&ie(Fe.start)&&Fe.end<=Fe.start&&de.onParamError("参数 end 必须大于 start"),this.processCallback(Fe),this.protocol.deleteLocalMsgs(Fe).then(function(){ir()},function($e){or=$e,ir()})},le.deleteAllLocalMsgs=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"deleteAllLocalMsgs",done:Fe.done});var or,ir=this.db;function $e(){Fe.done(or,Fe)}this.processCallback(Fe),this.protocol.sessionSet={},ir.enable?ir.deleteAllMsgs().then(function(){$e()},function(er){or=er,$e()}):(this.logger.warn("because db is false,error is null"),$e())},le.saveMsgsToLocal=function(Fe){var or;(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"saveMsgsToLocal",done:Fe.done}),this.db.enable||(this.logger.warn("because db is false,error is null"),Fe.done(null,[])),de.verifyOptions(Fe,"msgs done","msg::saveMsgsToLocal"),de.verifyParamType("msgs",Fe.msgs,"Array","msg::saveMsgsToLocal");var ir=b(or=Fe.msgs).call(or,function($e){var er=ze({},$e);return er.hasOwnProperty("needUpdateSession")||(er.needUpdateSession=!0),er});this.db.putMsg(ir).then(function($e,er){er?Fe.done(er):Fe.done(null,$e)})},le.clearServerHistoryMsgs=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"clearServerHistoryMsgs",done:Fe.done}),de.verifyOptions(Fe,"account","msg::clearServerHistoryMsgs");var or=Fe.delRoam!==!1;this.processCallback(Fe),this.sendCmd("clearServerHistoryMsgs",{clearMsgsParams:{account:Fe.account,delRoam:or?1:0}},Fe.callback)},le.clearServerHistoryMsgsWithSync=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"clearServerHistoryMsgsWithSync",done:Fe.done}),de.verifyOptions(Fe,"scene to","msg::clearServerHistoryMsgsWithSync");var or=Fe.isDeleteRoam===void 0||Fe.isDeleteRoam===!0,ir={type:Fe.scene==="team"?2:1,isDeleteRoam:or?1:0,isSyncSelf:Fe.isSyncSelf===!0?1:0};ir[ir.type===2?"toTid":"otherAccid"]=Fe.to,Fe.ext!==void 0&&(ir.ext=Fe.ext),this.processCallback(Fe),this.sendCmd("clearServerHistoryMsgsWithSync",{clearMsgsParamsWithSync:ir},Fe.callback)},le.msgFtsInServer=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"msgFtsInServer",done:Fe.done}),this.processCallback(Fe);var or=Fe,ir=s({},(o(or),or));de.validate({keyword:{type:"string"},fromTime:{type:"number",required:!1},toTime:{type:"number",required:!1},sessionLimit:{type:"number",min:0,required:!1},msgLimit:{type:"number",min:0,required:!1},order:{type:"enum",values:["ASC","DESC"],required:!1},p2pList:{type:"array",required:!1},teamList:{type:"array",required:!1},senderList:{type:"array",required:!1},msgTypeList:{type:"array",required:!1},msgSubTypeList:{type:"array",required:!1}},ir,"msg::msgFtsInServer"),ie(ir.toTime)&&ie(ir.fromTime)&&ir.toTime<ir.fromTime&&de.onParamError("Options error: toTime should be greater than fromTime");var $e,er={ASC:1,DESC:2};ir.order&&er[ir.order]&&(ir.order=er[ir.order]),ir.msgTypeList&&(ir.msgTypeList=b($e=ir.msgTypeList).call($e,function(Pt){return hr[Pt]}));var nr=["p2pList","teamList","senderList","msgTypeList","msgSubTypeList"];m(nr).call(nr,function(Pt){v(ir[Pt])&&(ir[Pt]=ir[Pt].join(","))}),this.sendCmd("msgFtsInServer",{msgFullSearchRequestTag:ir},Fe.callback)},le.msgFtsInServerByTiming=function(Fe){(Fe=Fe||{}).done=fr({instance:this,className:"NIMFn",funcName:"msgFtsInServerByTiming",done:Fe.done}),this.processCallback(Fe);var or=Fe,ir=(or.callback,or.done,n(or,re));de.validate({keyword:{type:"string"},fromTime:{type:"number",required:!1},toTime:{type:"number",required:!1},msgLimit:{type:"number",min:0,required:!1},order:{type:"enum",values:["ASC","DESC"],required:!1},p2pList:{type:"array",required:!1},teamList:{type:"array",required:!1},senderList:{type:"array",required:!1},msgTypeList:{type:"array",required:!1},msgSubTypeList:{type:"array",required:!1}},ir,"msg::msgFtsInServerByTimeSort"),ie(ir.toTime)&&ie(ir.fromTime)&&ir.toTime<ir.fromTime&&de.onParamError("Options error: toTime should be greater than fromTime");var $e,er={ASC:1,DESC:2};ir.msgLimit===void 0&&(ir.msgLimit=20),ir.order&&er[ir.order]&&(ir.order=er[ir.order]),ir.msgTypeList&&(ir.msgTypeList=b($e=ir.msgTypeList).call($e,function(Pt){return hr[Pt]}));var nr=["p2pList","teamList","senderList","msgTypeList","msgSubTypeList"];m(nr).call(nr,function(Pt){v(ir[Pt])&&(ir[Pt]=ir[Pt].join(","))}),this.sendCmd("msgFtsInServerByTiming",{msgTimingFullSearchRequestTag:ir},Fe.callback)}},function(t,r){t.exports=function(e){if(e==null)throw new TypeError("Cannot destructure "+e)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(860),o=e(149);function s(){var a;return t.exports=s=n?o(a=n).call(a):function(i){for(var u=1;u<arguments.length;u++){var c=arguments[u];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(i[d]=c[d])}return i},t.exports.__esModule=!0,t.exports.default=t.exports,s.apply(this,arguments)}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(861)},function(t,r,e){t.exports=e(862)},function(t,r,e){var n=e(863);t.exports=n},function(t,r,e){var n=e(303);t.exports=n},function(t,r,e){t.exports=e(865)},function(t,r,e){var n=e(866);t.exports=n},function(t,r,e){e(867),t.exports=9007199254740991},function(t,r,e){e(1)({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991})},function(t,r,e){var n=e(9),o=e(32),s=e(15),a=e(2),i=e(10),u=e(5),c=e(17),d=e(39).fn,m=e(0),v=e(751),g=e(753),b=(e(72),m.notundef),T=e(23).reportAPI;function k(y,A,V,he){V=V||"",m.verifyParamType(V+"from",y.from,"string",A),m.verifyParamType(V+"to",y.to,"string",A),m.verifyParamType(V+"idServer",y.idServer,"string",A),m.verifyParamType(V+"time",y.time,"number",A),m.verifyParamValid(V+"scene",y.scene,this.message.validScenes,A),he||m.verifyParamType(V+"idClient",y.idClient,"string",A)}d.getThreadMsgs=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"getThreadMsgs",done:y.done}),m.verifyCallback(y,"done","msg::getThreadMsgs"),m.verifyOptions(y,"scene threadMsgFromAccount threadMsgToAccount threadMsgIdServer threadMsgTime","msg::getThreadMsgs"),m.verifyParamType("threadMsgFromAccount",y.threadMsgFromAccount,"string","msg::getThreadMsgs"),m.verifyParamType("threadMsgToAccount",y.threadMsgToAccount,"string","msg::getThreadMsgs"),m.verifyParamType("threadMsgIdServer",y.threadMsgIdServer,"string","msg::getThreadMsgs"),m.verifyParamType("threadMsgTime",y.threadMsgTime,"number","msg::getThreadMsgs"),m.verifyParamValid("scene",y.scene,this.message.validScenes,"msg::getThreadMsgs"),this.processCallback(y);var A={scene:this.message.sceneMap[y.scene],from:y.threadMsgFromAccount,to:y.threadMsgToAccount,time:y.threadMsgTime,idServer:y.threadMsgIdServer},V={limit:y.limit<100?y.limit:100,beginTime:typeof y.beginTime=="number"?y.beginTime:0,reverse:n(y)===!0?1:0};typeof y.endTime=="number"&&(V.endTime=y.endTime,V.endTime<=V.beginTime&&m.onParamError("endTime应该大于beginTime","msg::getThreadMsgs")),y.lastMsgId&&(V.lastMsgId=y.lastMsgId),this.sendCmd("getThreadMsgs",{msg:A,threadMsgReq:V,NOTSTORE:"msg threadMsgReq"},y.callback)},d.getMsgsByIdServer=function(y){var A,V,he=this;(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"getMsgsByIdServer",done:y.done});var ae=this,Ne="msg::getMsgsByIdServer";m.verifyCallback(y,"done",Ne),(!o(y.reqMsgs)||y.reqMsgs.length===0||y.reqMsgs.length>100)&&m.onParamError("reqMsgs应该是数组且数据长度应大于0小于等于100",Ne),y.reqMsgs=s(A=y.reqMsgs).call(A,0),a(V=y.reqMsgs).call(V,function(_e,Ce){k.call(ae,_e,Ne,"reqMsgs[".concat(Ce,"]."),!0),_e.scene=he.message.sceneMap[_e.scene]}),this.processCallback(y),this.sendCmd("getMsgsByIdServer",{reqMsgs:y.reqMsgs},y.callback)},d.addQuickComment=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"addQuickComment",done:y.done}),m.verifyOptions(y,"msg body","msg::addQuickComment"),k.call(this,y.msg,"msg::addQuickComment");var A=new v(y,"msg::addQuickComment");A.from=this.account;var V={scene:this.message.sceneMap[y.msg.scene],from:y.msg.from,to:y.msg.to,time:y.msg.time,idServer:y.msg.idServer,idClient:y.msg.idClient};this.processCallback(y),this.sendCmd("addQuickComment",{msg:V,comment:A},y.callback)},d.deleteQuickComment=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"deleteQuickComment",done:y.done}),m.verifyOptions(y,"msg body","msg::deleteQuickComment"),k.call(this,y.msg,"msg::deleteQuickComment");var A=new v(y,"msg::addQuickComment");A.from=this.account;var V={scene:this.message.sceneMap[y.msg.scene],from:y.msg.from,to:y.msg.to,time:y.msg.time,idServer:y.msg.idServer,idClient:y.msg.idClient};this.processCallback(y),this.sendCmd("deleteQuickComment",{msg:V,comment:A},y.callback)},d.getQuickComments=function(y){var A=this;(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"getQuickComments",done:y.done});var V="msg::getQuickComments",he=this,ae={},Ne={};m.verifyOptions(y,"msgs","msg::getQuickComments"),(!o(y.msgs)||y.msgs.length===0||y.msgs.length>20)&&m.onParamError("msgs应该是数组且数据长度应大于0小于等于20",V);var _e=[];try{_e=JSON.parse(i(y.msgs))}catch{m.onParamError("msgs 不是合法的对象",V)}a(_e).call(_e,function(Ce,re){k.call(he,Ce,V,"msgs[".concat(re,"]."),!0),Ce.scene=A.message.sceneMap[Ce.scene],ae[Ce.idClient]=null,Ne[Ce.idClient]=re}),this.processCallback(y),this.getLocalMsgsByIdClients({idClients:u(ae),done:function(Ce,re){var ue,ze=he.protocol.timetags.sync;!Ce&&re.msgs&&re.msgs.length&&ze&&(a(ue=re.msgs).call(ue,function(le){ae[le.idClient]=le}),_e=c(_e).call(_e,function(le){var de=ae[le.idClient];return!de||(de.commentTimetag&&(le.timestamp=de.commentTimetag),!(de.commentTimetag>ze))})),he.sendCmd("getQuickComments",{commentReq:_e,idMap:ae,indexMap:Ne},y.callback)}})},d.addCollect=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"addCollect",done:y.done}),m.verifyOptions(y,"type data","msg::addCollect");var A=new g(y,"msg::addCollect");this.processCallback(y),this.sendCmd("addCollect",{collect:A},y.callback)},d.deleteCollects=function(y){var A;(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"deleteCollects",done:y.done}),m.verifyOptions(y,"collectList","msg::deleteCollects"),(!o(y.collectList)||y.collectList.length===0||y.collectList.length>100)&&m.onParamError("collectList应该是数组且数据长度应大于0小于等于100","msg::deleteCollects"),a(A=y.collectList).call(A,function(V,he){m.verifyParamType("collectList[".concat(he,"].id"),V.id,"string","msg::deleteCollects"),m.verifyParamType("collectList[".concat(he,"].createTime"),V.createTime,"number","msg::deleteCollects")}),this.processCallback(y),this.sendCmd("deleteCollects",{collectList:y.collectList},y.callback)},d.updateCollect=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"updateCollect",done:y.done}),m.verifyOptions(y,"collect","msg::updateCollect"),m.verifyParamType("collect.id",y.collect.id,"string","msg::updateCollect"),m.verifyParamType("collect.createTime",y.collect.createTime,"number","msg::updateCollect"),this.processCallback(y),this.sendCmd("updateCollect",{collect:y.collect},y.callback)},d.getCollects=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"getCollects",done:y.done}),m.verifyCallback(y,"done","msg::getCollects");var A={},V=["type","beginTime","endTime","limit"];a(V).call(V,function(he){b(y[he])&&(m.verifyParamType(he,y[he],"number","msg::getCollects"),A[he]=y[he])}),y.limit>100&&m.onParamError("limit不能大于100","msg::getCollects"),y.beginTime>y.endTime&&m.onParamError("beginTime不能大于endTime","msg::getCollects"),b(y.lastId)&&(m.verifyParamType("lastId",y.lastId,"string","msg::getCollects"),A.lastMsgId=y.lastId),b(n(y))&&(A.reverse=n(y)===!0?1:0),this.processCallback(y),this.sendCmd("getCollects",{collectQuery:A,NOTSTORE:"collectQuery"},y.callback)},d.addStickTopSession=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"addStickTopSession",done:y.done}),m.verifyOptions(y,"id","msg::addStickTopSession");var A=m.getIdArray(y.id);m.verifyParamValid("id的前半部分",A[0],this.message.validScenes,"msg::addStickTopSession"),m.verifyParamType("id的后半部分",A[1],"string","msg::addStickTopSession"),A[0]==="superTeam"&&(A[0]="super_team");var V={id:A=A.join("|")};y.topCustom&&(m.verifyParamType("topCustom",y.topCustom,"string","msg::addStickTopSession"),V.topCustom=y.topCustom),this.processCallback(y),this.sendCmd("addStickTopSession",{stickTopSession:V},y.callback)},d.deleteStickTopSession=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"deleteStickTopSession",done:y.done}),m.verifyOptions(y,"id","msg::deleteStickTopSession");var A=m.getIdArray(y.id);m.verifyParamValid("id的前半部分",A[0],this.message.validScenes,"msg::deleteStickTopSession"),m.verifyParamType("id的后半部分",A[1],"string","msg::deleteStickTopSession"),A[0]==="superTeam"&&(A[0]="super_team"),A=A.join("|"),this.processCallback(y),this.sendCmd("deleteStickTopSession",{stickTopSession:{id:A}},y.callback)},d.updateStickTopSession=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"updateStickTopSession",done:y.done}),m.verifyOptions(y,"id","msg::updateStickTopSession");var A=m.getIdArray(y.id);m.verifyParamValid("id的前半部分",A[0],this.message.validScenes,"msg::updateStickTopSession"),m.verifyParamType("id的后半部分",A[1],"string","msg::updateStickTopSession"),A[0]==="superTeam"&&(A[0]="super_team");var V={id:A=A.join("|")};y.topCustom&&(m.verifyParamType("topCustom",y.topCustom,"string","msg::updateStickTopSession"),V.topCustom=y.topCustom),this.processCallback(y),this.sendCmd("updateStickTopSession",{stickTopSession:V},y.callback)},d.getStickTopSessions=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"getStickTopSessions",done:y.done}),m.verifyOptions(y,"done","msg::getStickTopSessions"),this.processCallback(y);var A,V=this.protocol.sessionSet,he=[];for(var ae in V)(A=this.protocol.getSessionInCache(ae,y.findDelete))&&A.isTop&&he.push(V[ae]);y.callback(null,he)},d.addMsgPin=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"addMsgPin",done:y.done}),m.verifyOptions(y,"msg","msg::addMsgPin"),k.call(this,y.msg,"msg::addMsgPin");var A={pinFrom:this.account};b(y.pinCustom)&&(m.verifyParamType("pinCustom",y.pinCustom,"string","msg::addMsgPin"),A.pinCustom=y.pinCustom);var V={scene:this.message.sceneMap[y.msg.scene],from:y.msg.from,to:y.msg.to,time:y.msg.time,idServer:y.msg.idServer,idClient:y.msg.idClient};this.processCallback(y),this.sendCmd("addMsgPin",{msg:V,pinTag:A},y.callback)},d.updateMsgPin=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"updateMsgPin",done:y.done}),m.verifyOptions(y,"msg","msg::updateMsgPin"),k.call(this,y.msg,"msg::updateMsgPin");var A={pinFrom:this.account};b(y.pinCustom)&&(m.verifyParamType("pinCustom",y.pinCustom,"string","msg::updateMsgPin"),A.pinCustom=y.pinCustom);var V={scene:this.message.sceneMap[y.msg.scene],from:y.msg.from,to:y.msg.to,time:y.msg.time,idServer:y.msg.idServer,idClient:y.msg.idClient};this.processCallback(y),this.sendCmd("updateMsgPin",{msg:V,pinTag:A},y.callback)},d.deleteMsgPin=function(y){(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"deleteMsgPin",done:y.done}),m.verifyOptions(y,"msg","msg::deleteMsgPin"),k.call(this,y.msg,"msg::deleteMsgPin");var A={pinFrom:this.account},V={scene:this.message.sceneMap[y.msg.scene],from:y.msg.from,to:y.msg.to,time:y.msg.time,idServer:y.msg.idServer,idClient:y.msg.idClient};this.processCallback(y),this.sendCmd("deleteMsgPin",{msg:V,pinTag:A},y.callback)},d.getMsgPins=function(y){var A=this;(y=y||{}).done=T({instance:this,className:"NIMFn",funcName:"getMsgPins",done:y.done}),m.verifyOptions(y,"id","msg::getMsgPins");var V=this.db,he=m.getIdArray(y.id);m.verifyParamValid("id的前半部分",he[0],this.message.validScenes,"msg::getMsgPins"),m.verifyParamType("id的后半部分",he[1],"string","msg::getMsgPins"),he[0]==="superTeam"&&(he[0]="super_team");var ae={sessionId:he=he.join("|"),timetag:0};if(this.processCallback(y),V.enable){var Ne=this.protocol.timetags.sync;V.getTimetag("pin-"+y.id).then(function(Ce){Ce>Ne?V.getMsgPins(y.id).then(function(re){return y.callback(null,{pins:re||[]})}).catch(function(re){return y.callback(re)}):(ae.timetag=Ce,_e.call(A))})}else _e.call(this);function _e(){this.sendCmd("getMsgPins",{msgPinReq:ae,id:y.id,NOTSTORE:"msgPinReq"},y.callback)}}},function(t,r,e){var n=e(3),o=e(17),s=e(2),a=e(9),i=e(39).fn,u=e(0),c=u.undef,d=u.notundef,m=e(151),v=e(23).reportAPI;i.markSysMsgRead=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"markSysMsgRead",done:g.done});var b,T=this.db,k=n.resolve(),y=this.protocol;u.verifyOptions(g,"sysMsgs","sysmsg::markSysMsgRead");var A=g.sysMsgs;function V(){g.done(b,g)}u.isArray(A)||(A=[A]),T.enable?k=T.markSysMsgRead(A).then(function(he){A=he,y.onUpdateSysMsg(he)}):(A=o(A).call(A,function(he){return!he.read})).length&&(y.options.autoMarkRead||y.markSysMsgRead(A,!0),s(A).call(A,function(he){he.read=!0}),y.onUpdateSysMsg(A)),k.then(function(){return y.reduceSysMsgUnread(A)}).then(V,function(he){b=he,V()})},i.sendCustomSysMsg=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"sendCustomSysMsg",done:g.done}),u.verifyOptions(g,"scene to content","sysmsg::sendCustomSysMsg"),u.verifyParamValid("scene",g.scene,this.message.validScenes,"sysmsg::sendCustomSysMsg"),this.processCallback(g);var b="sendCustomSysMsg";return g.scene==="p2p"?g.type="customP2p":g.scene==="superTeam"?(g.type="customSuperTeam",b="sendSuperTeamCustomSysMsg"):g.type="customTeam",g.sysMsg=new m(g),o(g)&&(b="sendFilterCustomSysMsg"),this.sendCmd(b,{sysMsg:g.sysMsg,single:!0},g.callback),this.formatReturnSysMsg(g.sysMsg)},i.formatReturnSysMsg=function(g){return g=u.copy(g),this.protocol.completeSysMsg(g),g.status="sending",g=a(m).call(m,g)},i.getLocalSysMsgs=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"getLocalSysMsgs",done:g.done});var b,T=this.db,k=[];function y(){g.sysMsgs=k,g.done(b,g)}u.verifyOptions(g),g.category&&u.verifyParamValid("category",g.category,m.validCategories,"sysmsg::getLocalSysMsgs"),g.type&&u.verifyParamValid("type",g.type,m.validTypes,"sysmsg::getLocalSysMsgs"),c(g.limit)&&(g.limit=100),u.verifyParamType("limit",g.limit,"number","sysmsg::getLocalSysMsgs"),u.verifyParamMax("limit",g.limit,100,"sysmsg::getLocalSysMsgs"),d(a(g))?u.verifyParamType("reverse",a(g),"boolean","sysmsg::getLocalSysMsgs"):g.reverse=!1,this.processCallback(g),T.enable?T.getSysMsgs(g).then(function(A){k=A,y()},function(A){b=A,y()}):y()},i.updateLocalSysMsg=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"updateLocalSysMsg",done:g.done});var b,T=this.db,k=null;if(u.verifyOptions(g,"idServer","sysmsg::updateLocalSysMsg"),this.processCallback(g),T.enable){var y=u.filterObj(g,"idServer state localCustom");T.updateSysMsg(y).then(function(V){k=V,A()},function(V){b=V,A()})}else A();function A(){g.sysMsg=k,g.done(b,g)}},i.deleteLocalSysMsg=function(g){(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"deleteLocalSysMsg",done:g.done});var b,T=this.db;function k(){g.done(b,g)}u.verifyOptions(g,"idServer","sysmsg::deleteLocalSysMsg"),this.processCallback(g),T.enable?T.deleteSysMsg(g.idServer).then(function(){k()},function(y){b=y,k()}):k()},i.deleteAllLocalSysMsgs=function(g){var b;(g=g||{}).done=v({instance:this,className:"NIMFn",funcName:"deleteAllLocalSysMsgs",done:g.done});var T=this,k=T.db;function y(){T.protocol.onUpdateSysMsgUnread({}),g.done(b,g)}T.processCallback(g),k.enable?k.deleteAllSysMsgs().then(function(){y()},function(A){b=A,y()}):y()}},function(t,r,e){var n=e(39).fn,o=e(0),s=e(13),a=e(23).reportAPI;n.getChatroomAddress=function(i){(i=i||{}).done=a({instance:this,className:"NIMFn",funcName:"getChatroomAddress",done:i.done}),o.verifyOptions(i,"chatroomId","chatroom::getChatroomAddress"),i.isWeixinApp=s.isWeixinApp,i.type=s.ipVersion,this.processCallback(i),this.sendCmd("getChatroomAddress",i)}},function(t,r){},function(t,r){},function(t,r,e){var n=e(39).fn,o=e(0),s=e(23).reportAPI;n.audioToText=function(a){(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"audioToText",done:a.done}),o.verifyOptions(a,"url","audio::audioToText"),a.audioToText=o.filterObj(a,"url"),this.processCallback(a),this.sendCmd("audioToText",a)}},function(t,r,e){var n=e(39).fn;n.clearDB=function(o){var s=this.db;this.processCallback(o);var a=o.done;s.enable?s.clear().then(a,a):a()},n.removeDB=function(o){var s=this.db;this.processCallback(o);var a=o.done;s.enable?s.destroy().then(a,a):a()},n.closeDB=function(o){var s=this.db;this.processCallback(o);var a=o.done;s.enable?s.close().then(a,a):a()}},function(t,r,e){var n=e(39).fn,o=e(308),s=e(0),a=s.undef,i=e(23).reportAPI;n.getPushNotificationMultiportConfig=function(){return i({instance:this,className:"NIMFn",funcName:"getPushNotificationMultiportConfig",hasCallback:!1}),this.protocol.getPushNotificationMultiportConfig()},n.updatePushNotificationMultiportConfig=function(u){(u=u||{}).done=i({instance:this,className:"NIMFn",funcName:"updatePushNotificationMultiportConfig",done:u.done}),s.verifyOptions(u),a(u.shouldPushNotificationWhenPCOnline)&&(u.shouldPushNotificationWhenPCOnline=!0),u.donnop=new o(u),this.processCallback(u),this.sendCmd("updateDonnop",u)}},function(t,r,e){var n=e(2),o=e(3),s=e(7),a=e(25),i=e(39).fn,u=e(0),c=e(877),d=e(878),m=e(23).reportAPI;function v(g){return a(g)==="object"&&(g.msgEventSubscribes?g=g.msgEventSubscribes:g.msgEventSubscribe?g=g.msgEventSubscribe:g.accounts?g=g.accounts:g.msgEvent&&(g=g.msgEvent).time&&(g.time=+g.time),g.sync===1?g.sync=!0:g.sync===0&&(g.sync=!1)),g}i.batchSendEventsCmds=function(g,b,T){var k=this,y=u.dropArrayDuplicates(b.accounts);y=u.reshape2d(y,100);var A=[];n(y).call(y,function(V){A.push(new o(function(he,ae){var Ne=u.simpleClone(b);Ne.accounts=V,k.sendCmdWithResp(g,Ne,function(_e,Ce){_e?ae(_e):he(v(Ce))})}))}),o.all(A).then(function(V){var he=null;if(V.length>0)if(V[0].msgEventSubscribe){var ae=V[0].msgEventSubscribe;ae=v(ae);var Ne=[];n(V).call(V,function(_e){Ne=s(Ne).call(Ne,_e.accounts)}),he={accounts:Ne,msgEventSubscribe:ae}}else he=[],n(V).call(V,function(_e){he=s(he).call(he,_e)});T(null,he)},function(V){T(V,null)})},i.publishEvent=function(g){(g=g||{}).done=m({instance:this,className:"NIMFn",funcName:"publishEvent",done:g.done});var b=new c(g);b=b.assembleEvent(),this.processCallback(g),this.sendCmdWithResp("publishEvent",{msgEvent:b},function(T,k){T||(k=v(k)),g.callback(T,k)})},i.subscribeEvent=function(g){(g=g||{}).done=m({instance:this,className:"NIMFn",funcName:"subscribeEvent",done:g.done}),u.verifyOptions(g,"accounts","event::subscribeEvent");var b=new d(g);u.verifyParamType("accounts",g.accounts,"array","event::subscribeEvent"),this.processCallback(g),b=b.assembleEvent(),this.batchSendEventsCmds("subscribeEvent",{msgEventSubscribe:b,accounts:g.accounts},function(T,k){!T&&k&&(k={failedAccounts:k}),g.callback(T,k)})},i.unSubscribeEventsByAccounts=function(g){(g=g||{}).done=m({instance:this,className:"NIMFn",funcName:"unSubscribeEventsByAccounts",done:g.done}),u.verifyOptions(g,"accounts","event::unSubscribeEventsByAccounts"),u.verifyParamType("accounts",g.accounts,"array","event::unSubscribeEventsByAccounts");var b=new d(g);b=b.assembleEvent(),this.processCallback(g),this.batchSendEventsCmds("unSubscribeEventsByAccounts",{msgEventSubscribe:b,accounts:g.accounts},function(T,k){!T&&k&&(k={failedAccounts:k}),g.callback(T,k)})},i.unSubscribeEventsByType=function(g){(g=g||{}).done=m({instance:this,className:"NIMFn",funcName:"unSubscribeEventsByType",done:g.done});var b=new d(g);b=b.assembleEvent(),this.processCallback(g),this.sendCmdWithResp("unSubscribeEventsByType",{msgEventSubscribe:b},function(T,k){g.callback(T,k)})},i.querySubscribeEventsByAccounts=function(g){(g=g||{}).done=m({instance:this,className:"NIMFn",funcName:"querySubscribeEventsByAccounts",done:g.done}),u.verifyOptions(g,"accounts","event::querySubscribeEventsByAccounts"),u.verifyParamType("accounts",g.accounts,"array","event::querySubscribeEventsByAccounts");var b=new d(g);b=b.assembleEvent(),this.processCallback(g),this.batchSendEventsCmds("querySubscribeEventsByAccounts",{msgEventSubscribe:b,accounts:g.accounts},function(T,k){!T&&k&&(k={msgEventSubscribes:k}),g.callback(T,k)})},i.querySubscribeEventsByType=function(g){(g=g||{}).done=m({instance:this,className:"NIMFn",funcName:"querySubscribeEventsByType",done:g.done});var b=new d(g);b=b.assembleEvent(),this.processCallback(g),this.sendCmdWithResp("querySubscribeEventsByType",{msgEventSubscribe:b},function(T,k){T||(k={msgEventSubscribes:v(k)}),g.callback(T,k)})}},function(t,r,e){var n=e(6),o=e(0),s=o.notundef,a=e(40);function i(u){if(o.verifyOptions(u,"type value","event::MsgEvent"),o.verifyParamType("type",u.type,"number","event::MsgEvent"),o.verifyParamType("value",u.value,"number","event::MsgEvent"),this.type=u.type,this.value=u.value,this.idClient=o.guid(),s(u.custom)&&(this.custom=""+u.custom),this.validTime=u.validTime||604800,o.verifyParamType("validTime",this.validTime,"number","event::MsgEvent"),o.verifyParamMin("validTime",this.validTime,60,"event::MsgEvent"),o.verifyParamMax("validTime",this.validTime,604800,"event::MsgEvent"),s(u.broadcastType)){var c;if(o.verifyParamType("broadcastType",u.broadcastType,"number","event::MsgEvent"),n(c=[1,2]).call(c,u.broadcastType)<0)throw new a('参数错误"broadcastType":只能为1或2');this.broadcastType=u.broadcastType}else this.broadcastType=2;s(u.sync)?(o.verifyParamType("sync",u.sync,"boolean","event::MsgEvent"),this.sync=u.sync):this.sync=!1}i.prototype.assembleEvent=function(){return{type:this.type,value:this.value,idClient:this.idClient,custom:this.custom||"",validTime:this.validTime,broadcastType:this.broadcastType,sync:this.sync===!0?1:0}},t.exports=i},function(t,r,e){var n=e(0),o=n.notundef;function s(a){n.verifyOptions(a,"type","event::MsgEventSubscribe"),n.verifyParamType("type",a.type,"number","event::MsgEventSubscribe"),n.findObjIndexInArray([1,2,3],a.type)<0&&n.verifyParamMin("type",a.type,1e5,"event::MsgEventSubscribe"),this.type=a.type,o(a.subscribeTime)?(n.verifyParamType("subscribeTime",a.subscribeTime,"number","event::MsgEventSubscribe"),n.verifyParamMin("subscribeTime",a.subscribeTime,60,"event::MsgEventSubscribe"),n.verifyParamMax("subscribeTime",a.subscribeTime,2592e3,"event::MsgEventSubscribe"),this.subscribeTime=a.subscribeTime):this.subscribeTime=2592e3,o(a.sync)?(n.verifyParamType("sync",a.sync,"boolean","event::MsgEventSubscribe"),this.sync=a.sync):this.sync=!0}s.prototype.assembleEvent=function(){return{type:this.type,subscribeTime:this.subscribeTime,sync:this.sync===!0?1:0}},t.exports=s},function(t,r,e){var n=e(41),o=e(39).fn,s=e(0),a=e(23).reportAPI;o.httpRequestProxy=function(i){(i=i||{}).done=a({instance:this,className:"NIMFn",funcName:"httpRequestProxy",done:i.done}),s.verifyOptions(i,"path","misc::httpRequestProxy");var u=n({},i);delete u.done,this.processCallback(i),this.sendCmd("httpProxy",{proxyTag:u},i.callback)}},function(t,r,e){var n=e(39).fn,o=e(13),s=e(23).reportAPI;n.getQChatAddress=function(a){(a=a||{}).done=s({instance:this,className:"NIMFn",funcName:"getQChatAddress",done:a.done}),this.processCallback(a),this.sendCmd("getQChatAddress",{getQChatAddressTag:{ipType:o.ipVersion}},a.done)}},function(t,r,e){e(297);var n=e(193);e(309)(n),t.exports=n},function(t,r,e){var n=e(312),o=e(15),s=e(3),a=e(57),i=e(7),u=e(26),c=e(194).fn,d=e(13),m=e(154).V2NIMConnectStatus;c.connect=function(){if(this.checkNetworkAvailable()===!1&&this.autoconnect)return this.logger.info("connect::skip this reconnection attempt because network is offline"),void this.reconnect();d.isBrowser&&this.reporter.restore(),n(c).connect.call(this)},c.refreshSocketUrl=function(){var v;return this.socketUrlsBackup=this.socketUrlsBackup||[],this.socketUrls=o(v=this.socketUrlsBackup).call(v,0),this.logger.info("link::refreshSocketUrl"),this.statusProtector.emit("auth/loginLifeCycleAddressing"),s.resolve(this.socketUrls)},c.onHandshakeFailed=function(v,g){var b;this.reporter.report("chatroomLogin",{accid:this.account,roomId:this.options&&this.options.chatroomId,serverIps:this.options&&this.options.chatroomAddresses&&this.options.chatroomAddresses.join(","),currentServerIp:g,rt:a()-v,result:408,failReason:"ws_handshake_failed",time:a()}),this.logger.warn(i(b="link::onHandshakeFailed: shandshake failed, startTime: ".concat(v,", targetUrl: ")).call(b,g))},c.onConnectFailed=function(v,g,b){var T,k,y=typeof v=="string"?"connect_failed:".concat(v):"connect_failed";this.reporter.report("chatroomLogin",{accid:this.account,roomId:this.options&&this.options.chatroomId,serverIps:this.options&&this.options.chatroomAddresses&&this.options.chatroomAddresses.join(","),currentServerIp:b,rt:a()-g,result:408,failReason:"ws_".concat(y),time:a()}),this.logger.warn(i(T=i(k="link::onConnectFailed: connect failed due to ".concat(v,", startTime: ")).call(k,g,", targetUrl: ")).call(T,b))},c.onSocketError=function(v,g,b){var T,k,y=typeof v=="string"?"socket.io error:".concat(v):"socket.io error";this.reporter.report("chatroomLogin",{accid:this.account,roomId:this.options&&this.options.chatroomId,serverIps:this.options&&this.options.chatroomAddresses&&this.options.chatroomAddresses.join(","),currentServerIp:b,rt:a()-g,result:408,failReason:"ws_".concat(y),time:a()}),this.logger.warn(i(T=i(k="link::onSocketError: due to ".concat(v,", startTime: ")).call(k,g,", targetUrl: ")).call(T,b))},c.notifyDisconnect=function(v){n(c).notifyDisconnect.call(this,v)},c.disconnect=function(){var v=this,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};if(this.isConnected())return this.sendCmd("logout"),void u(function(){n(c).disconnect.call(v,g)},0);this.connecting?this.logger.warn("ChatroomProtocolFn api disconnect:: connecting but exiting"):this.statusProtector.getConnectStatus()!==m.V2NIM_CONNECT_STATUS_DISCONNECTED?this.logger.warn("ChatroomProtocolFn api disconnect:: has tried to disconnect actively"):this.logger.warn("ChatroomProtocolFn api disconnect:: other logic entered");var b=n(c);b.disconnect.call(this,g)}},function(t,r,e){var n=e(102),o=e(58),s=e(103),a=e(10),i=e(57),u=e(3),c=e(24),d=e(5),m=e(59),v=e(17),g=e(60),b=e(2),T=e(61),k=e(62),y=e(47);function A(Ce,re){var ue=d(Ce);if(m){var ze=m(Ce);re&&(ze=v(ze).call(ze,function(le){return g(Ce,le).enumerable})),ue.push.apply(ue,ze)}return ue}function V(Ce){for(var re=1;re<arguments.length;re++){var ue,ze,le=arguments[re]!=null?arguments[re]:{};re%2?b(ue=A(Object(le),!0)).call(ue,function(de){o(Ce,de,le[de])}):T?k(Ce,T(le)):b(ze=A(Object(le))).call(ze,function(de){y(Ce,de,g(le,de))})}return Ce}var he=e(194).fn,ae=e(44),Ne=e(0);function _e(Ce){var re=this;if(Ce.code===398)return this.logger.warn("pendingLoginFailed:398 try to reconnect socket link，backoff set min 5s"),re.forceDisconnect(),re.backoff.setMin(5e3),void(re.retryCount===0?re.refreshSocketUrl():u.resolve()).then(function(){var ue;re.reconnect({allFailedCB:c(ue=function(ze){this.logger.error("pendingLoginFailed: ",ze.code,ze),this.onAuthError(ze,"link::onLoginReconnectFailed")}).call(ue,re,Ce)})});this.logger.error("pendingLoginFailed: ",Ce.code,Ce),re.onAuthError(Ce,"link::onLogin")}he.assembleLogin=function(){var Ce=this.options;this.sdkSession=this.genSessionKey();var re={appKey:Ce.appKey,account:Ce.account,deviceId:ae.deviceId,chatroomId:Ce.chatroomId,session:this.sdkSession,appLogin:this.autoconnect?1:0},ue=!0;if(Ce.loc_x===void 0||Ce.loc_y===void 0||Ce.loc_z===void 0?ue=!1:(typeof Ce.loc_x!="number"&&(Ce.loc_x=0),typeof Ce.loc_y!="number"&&(Ce.loc_y=0),typeof Ce.loc_z!="number"&&(Ce.loc_z=0)),Ce.authType=Ce.loginAuthType,re=Ne.merge(re,Ne.filterObj(Ce,ue?"chatroomNick chatroomAvatar chatroomCustom chatroomEnterCustom isAnonymous notifyTargetTags loginAuthType loginExt loc_x loc_y loc_z distance antiSpamBusinessId":"chatroomNick chatroomAvatar chatroomCustom chatroomEnterCustom isAnonymous notifyTargetTags loginAuthType loginExt distance antiSpamBusinessId")),Ce.tags&&Ce.tags.length>0)try{re.tags=a(Ce.tags)}catch(ze){this.logger.error("assembleLogin::format tags error",Ce.tags,ze)}return{type:1,login:re,imLogin:this.assembleIMLogin()}},he.login=s(n.mark(function Ce(){var re,ue,ze,le=this;return n.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return re=this,de.next=3,re.assembleLogin();case 3:if(ue=de.sent,!(ze=this.socket&&this.socket.socket&&this.socket.socket.sessionid)){de.next=13;break}if(this.socketIds||(this.socketIds={}),!this.socketIds[ze]){de.next=10;break}return this.logger.warn("onConnect::repeat login",ze),de.abrupt("return");case 10:this.socketIds[ze]=!0,de.next=14;break;case 13:this.logger.warn("onConnect:: no socketId ",this.socket&&this.socket.socket);case 14:this.logger.warn("link::doLogin: "+ze+" appLogin is "+ue.login.appLogin),re.createLoginTime=i(),re.sendCmd("login",V({},ue),function(Ie,ie){if(Ie)re.reporter.report("chatroomLogin",{accid:re.account,roomId:re.options&&re.options.chatroomId,serverIps:re.options&&re.options.chatroomAddresses&&re.options.chatroomAddresses.join(","),currentServerIp:re.url,rt:i()-re.createLoginTime,result:Ie?Ie.code:408,failReason:Ie?Ie.message:"",time:i()}),_e.call(re,Ie),re.statusProtector.emit("auth/loginLifeCycleLoginFail",Ie);else if(re.reporter.report("chatroomLogin",{accid:re.account,roomId:re.options&&re.options.chatroomId,serverIps:re.options&&re.options.chatroomAddresses&&re.options.chatroomAddresses.join(","),currentServerIp:re.url,rt:i()-re.createLoginTime,result:200,failReason:"",time:i()}),re.resetReconnectStatus(),le.heartbeatFail=0,le.hasLogin=!0,le.autoconnect=!0,re.startHeartbeat(),re.initOnlineListener(),re.statusProtector.emit("auth/loginLifeCycleLoginSucc"),re.keepNosSafeUrl)re.afterLogin(ie);else{var Ve=[];re.parser.checkObjSafeUrl(ie,Ve,[]),u.all(Ve).then(function(){re.afterLogin(ie)}).catch(function(){re.afterLogin(ie)})}});case 17:case"end":return de.stop()}},Ce,this)})),he.afterLogin=function(Ce){var re=Ce.chatroom;this.sendCmd("getNosCdnHost",{}),this.chatroom=re,this.notifyLogin(Ce)},he.kickedReasons=["","chatroomClosed","managerKick","samePlatformKick","silentlyKick","blacked"],he.kickedMessages=["","聊天室关闭了","被房主或者管理员踢出","不允许同一个帐号在多个地方同时登录","悄悄被踢","被拉黑了"]},function(t,r,e){var n=e(9),o=e(26),s=e(69),a=e(2),i=e(52),u=e(41),c=e(15),d=e(32),m=e(123),v=e(5),g=e(194).fn,b=e(0),T=e(13),k=e(885),y=e(763),A=e(890),V=e(891),he=e(892);g.completeMsg=function(ae){ae.chatroomId=this.chatroom&&this.chatroom.id,ae.from=this.options.account,ae.fromClientType="Web",ae.time||(ae.time=+new Date)},g.amendMsg=function(ae){return ae},g.onMsg=function(ae){var Ne,_e=n(Ne=this.message).call(Ne,ae.content.msg);if(this.checkMsgUnique(_e)){if(_e.__handleTime=this.reporterHook.getSafeClock(),_e.__receiveTime=ae.__receiveTime,b.get(ae,"content.msg.__clientExt"))try{_e.__clientExt=JSON.parse(ae.content.msg.__clientExt)}catch{this.logger.warn("ChatroomProtocolFn:onMsg __clientExt parse failed ".concat(ae.content.msg.__clientExt))}this.msgBuffer.push(_e),this.msgFlushTimer||this.startMsgFlushTimer(),ae&&ae.content&&ae.content.msg&&ae.content.msg.needHighPriorityMsgAck==="1"&&this.sendCmd("sendChatroomMsgAck",{chatRoomMsgAckTag:{idClient:_e.idClient,chatroomId:_e.chatroomId}})}else this.logger.warn("onMsg::msg::repeat",_e.idClient)},g.startMsgFlushTimer=function(){var ae=this,Ne=ae.options;ae.msgFlushTimer=o(function(){var _e,Ce=s(_e=ae.msgBuffer).call(_e,0,Ne.msgBufferSize);if(T.isBrowser){var re=ae.reporterHook.getSafeClock();a(Ce).call(Ce,function(ue){if(ue.flow!=="out"){var ze={msgId:ue.idServer,clientId:ue.idClient,receiveTime:ae.reporterHook.getNTPTime(ue.__receiveTime),serverTime:ue.time,callbackTime:ae.reporterHook.getNTPTime(re),preHandleTime:ae.reporterHook.getNTPTime(ue.__handleTime),fromAccid:ue.from,toAccid:ae.options.account,type:4,tid:"",roomId:ue.chatroomId,result:200,failReason:"",rt:i(re-ue.__receiveTime)},le=b.get(ue,"__clientExt.statistics.apiCallingTime"),de=b.get(ue,"__clientExt.statistics.sendTime");le&&de&&(ze.apiCallingTime=le,ze.sendTime=de,ze.attachUploadDuration=b.get(ue,"__clientExt.statistics.attachUploadDuration")||0),ae.reporter&&ae.reporter.report("msgReceive",ze)}delete ue.__handleTime,delete ue.__receiveTime,delete ue.__clientExt})}ae.options.onmsgs(Ce),ae.msgBuffer.length?ae.startMsgFlushTimer():delete ae.msgFlushTimer},Ne.msgBufferInterval)},g.checkMsgUnique=b.genCheckUniqueFunc("idClient"),g.onSendMsg=function(ae){var Ne,_e=ae.obj.msg;ae.error?_e.status="fail":(_e=ae.content.msg).status="success",u(_e,ae.obj.msg),_e=n(Ne=this.message).call(Ne,_e),this.checkMsgUnique(_e),ae.obj=_e},g.onHistoryMsgs=function(ae){ae.error||(ae.obj||(ae.obj={}),ae.obj.msgs=this.message.reverseMsgs(ae.content.msgs))},g.onCdnMsgInfo=function(ae){if(ae){ae.cdnUrls&&(ae.cdnUrls=ae.cdnUrls.split("|")),ae.interval&&(ae.interval=1e3*i(ae.interval)),ae.timeout&&(ae.timeout=+ae.timeout),ae.enable&&(ae.enable=+ae.enable),ae.timestamp&&(ae.timestamp=+ae.timestamp,this.correctCdnTime(ae.timestamp));var Ne=!this.cdnInfo.enable&&ae.enable;u(this.cdnInfo,ae),Ne&&this.queryCdnMsgs()}},g.correctCdnTime=function(ae){ae&&typeof ae=="number"&&(this.cdnInfo||(this.cdnInfo={}),this.cdnInfo.timestamp=ae,this.cdnInfo.localTime=+new Date,this.cdnInfo.lastNow=null,this.logger.info("correctCdnTime: timestamp, localTime",ae,this.cdnInfo.localTime,new Date(ae),new Date(this.cdnInfo.localTime)))},g.queryCdnMsgs=function(ae){var Ne,_e=this;if(this.cdnInfo&&this.cdnInfo.enable&&this.isConnected()){this.queryCdnTimer=o(function(){return _e.queryCdnMsgs()},this.cdnInfo.interval);var Ce=+new Date;if(Ce=Ce-this.cdnInfo.localTime+this.cdnInfo.timestamp,Ce-=Ce%this.cdnInfo.interval,this.cdnInfo.lastNow!==Ce&&this.cdnInfo.cdnUrls&&this.cdnInfo.cdnUrls.length){this.cdnInfo.cdnUrls.push(this.cdnInfo.cdnUrls.shift());var re=this,ue=this.cdnInfo.decryptKey,ze=this.cdnInfo.timeout||Math.ceil(this.cdnInfo.interval/2),le=c(Ne=this.cdnInfo.cdnUrls).call(Ne,0);ae=ae||0,function de(){if(ae>=3)return void re.finalFail++;if(le.length){var Ie=le.shift().replace("#time",Ce),ie=Ie.split("/")[2],Ve=+new Date;re.adaptersRequest(Ie,{timeout:ze,onload:function(Ue){if(re.cdnInfo.lastNow>Ce)re.logger.warn("queryCdnMsgs::doQuery cdnInfo.lastNow > now, will throw data ",re.cdnInfo.lastNow,Ce,Ue);else{re.cdnInfo.lastNow=Ce,re.afterQueryCdn(ie,+new Date-Ve,!0);try{Ue=JSON.parse(Ue)}catch(fr){re.logger.warn("queryCdnMsgs::doQuery::onload parse res error: ",fr)}if(Ue&&Ue.data){Ue.ptm&&(re.cdnInfo.timeout=Ue.ptm),Ue.pis&&(re.cdnInfo.interval=1e3*Ue.pis);var Dt,tr,dr=Ue.e===!0?(Dt=Ue.data,tr=ue,k.decrypt(Dt,y.parse(tr),{mode:A,padding:V}).toString(he)):Ue.data;re.onCdnMsgsSmoothly(dr,Ce,1e3*Ue.c)}}},onerror:function(Ue){if(ae++,re.afterQueryCdn(ie,+new Date-Ve,!1),Ue.status===404){var Dt;try{var tr=JSON.parse(Ue.result);tr.code===404&&tr.timestamp&&(Dt=tr.timestamp)}catch(dr){re.logger.warn("queryCdnMsgs::doQuery::parse 404 result error",dr,Ue)}!Dt&&Ue.date&&(Dt=+new Date(Ue.date)),Dt&&(re.correctCdnTime(Dt),clearTimeout(re.queryCdnTimer),re.queryCdnMsgs(ae))}else de()}},{exception_service:8})}}()}}},g.onCdnMsgsSmoothly=function(ae,Ne,_e){try{ae=JSON.parse(ae)}catch(le){this.logger.warn("onCdnMsgsSmoothly::JSON.parse error",le)}if(this.logger.info("receive cdn msgs "+ae.length+" and request time is "+new Date(Ne)),d(ae)&&ae.length){var Ce=this,re=this.options.msgBufferInterval,ue=Math.ceil(ae.length*re/_e);ze(),clearInterval(Ce.cdnSmoothTimer),Ce.cdnSmoothTimer=m(function(){return ze()},re)}function ze(){if(Ce.isConnected()){var le=s(ae).call(ae,0,ue);a(le).call(le,function(de){var Ie=Ce.parser.syncUnserialize(de,"msg");Ce.onMsg({content:{msg:Ie}})}),ae.length||clearInterval(Ce.cdnSmoothTimer)}}},g.resetCdnData=function(){this.cdnData={},this.finalFail=0,this.cdnDataTime=+new Date},g.initCdnData=function(){this.resetCdnData(),b.isFunction(this.options.onCdnRequestData)?(this.options.cdnRequestDataInterval=this.options.cdnRequestDataInterval||3e4,this.afterQueryCdn=function(ae,Ne,_e){var Ce,re=this;this.cdnData[ae]||(this.cdnData[ae]={success:0,fail:0,sr:0,fr:0,smr:0,fmr:0}),_e?(this.cdnData[ae].success++,this.cdnData[ae].sr+=Ne,Ne>this.cdnData[ae].smr&&(this.cdnData[ae].smr=Ne)):(this.cdnData[ae].fail++,this.cdnData[ae].fr+=Ne,Ne>this.cdnData[ae].fmr&&(this.cdnData[ae].fmr=Ne)),+new Date-this.cdnDataTime<this.options.cdnRequestDataInterval||(a(Ce=v(this.cdnData)).call(Ce,function(ue){re.cdnData[ue].sr=re.cdnData[ue].sr/re.cdnData[ue].success||0,re.cdnData[ue].fr=re.cdnData[ue].fr/re.cdnData[ue].fail||0}),this.options.onCdnRequestData(u({},this.cdnData),this.finalFail),this.resetCdnData())}):this.afterQueryCdn=function(){}}},function(t,r,e){var n;t.exports=(n=e(89),e(763),e(887),e(764),e(311),function(){var o=n,s=o.lib.BlockCipher,a=o.algo,i=[],u=[],c=[],d=[],m=[],v=[],g=[],b=[],T=[],k=[];(function(){for(var V=[],he=0;he<256;he++)V[he]=he<128?he<<1:he<<1^283;var ae=0,Ne=0;for(he=0;he<256;he++){var _e=Ne^Ne<<1^Ne<<2^Ne<<3^Ne<<4;_e=_e>>>8^255&_e^99,i[ae]=_e,u[_e]=ae;var Ce=V[ae],re=V[Ce],ue=V[re],ze=257*V[_e]^16843008*_e;c[ae]=ze<<24|ze>>>8,d[ae]=ze<<16|ze>>>16,m[ae]=ze<<8|ze>>>24,v[ae]=ze,ze=16843009*ue^65537*re^257*Ce^16843008*ae,g[_e]=ze<<24|ze>>>8,b[_e]=ze<<16|ze>>>16,T[_e]=ze<<8|ze>>>24,k[_e]=ze,ae?(ae=Ce^V[V[V[ue^Ce]]],Ne^=V[V[Ne]]):ae=Ne=1}})();var y=[0,1,2,4,8,16,32,64,128,27,54],A=a.AES=s.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var V=this._keyPriorReset=this._key,he=V.words,ae=V.sigBytes/4,Ne=4*((this._nRounds=ae+6)+1),_e=this._keySchedule=[],Ce=0;Ce<Ne;Ce++)Ce<ae?_e[Ce]=he[Ce]:(ze=_e[Ce-1],Ce%ae?ae>6&&Ce%ae==4&&(ze=i[ze>>>24]<<24|i[ze>>>16&255]<<16|i[ze>>>8&255]<<8|i[255&ze]):(ze=i[(ze=ze<<8|ze>>>24)>>>24]<<24|i[ze>>>16&255]<<16|i[ze>>>8&255]<<8|i[255&ze],ze^=y[Ce/ae|0]<<24),_e[Ce]=_e[Ce-ae]^ze);for(var re=this._invKeySchedule=[],ue=0;ue<Ne;ue++){if(Ce=Ne-ue,ue%4)var ze=_e[Ce];else ze=_e[Ce-4];re[ue]=ue<4||Ce<=4?ze:g[i[ze>>>24]]^b[i[ze>>>16&255]]^T[i[ze>>>8&255]]^k[i[255&ze]]}}},encryptBlock:function(V,he){this._doCryptBlock(V,he,this._keySchedule,c,d,m,v,i)},decryptBlock:function(V,he){var ae=V[he+1];V[he+1]=V[he+3],V[he+3]=ae,this._doCryptBlock(V,he,this._invKeySchedule,g,b,T,k,u),ae=V[he+1],V[he+1]=V[he+3],V[he+3]=ae},_doCryptBlock:function(V,he,ae,Ne,_e,Ce,re,ue){for(var ze=this._nRounds,le=V[he]^ae[0],de=V[he+1]^ae[1],Ie=V[he+2]^ae[2],ie=V[he+3]^ae[3],Ve=4,Ue=1;Ue<ze;Ue++){var Dt=Ne[le>>>24]^_e[de>>>16&255]^Ce[Ie>>>8&255]^re[255&ie]^ae[Ve++],tr=Ne[de>>>24]^_e[Ie>>>16&255]^Ce[ie>>>8&255]^re[255&le]^ae[Ve++],dr=Ne[Ie>>>24]^_e[ie>>>16&255]^Ce[le>>>8&255]^re[255&de]^ae[Ve++],fr=Ne[ie>>>24]^_e[le>>>16&255]^Ce[de>>>8&255]^re[255&Ie]^ae[Ve++];le=Dt,de=tr,Ie=dr,ie=fr}Dt=(ue[le>>>24]<<24|ue[de>>>16&255]<<16|ue[Ie>>>8&255]<<8|ue[255&ie])^ae[Ve++],tr=(ue[de>>>24]<<24|ue[Ie>>>16&255]<<16|ue[ie>>>8&255]<<8|ue[255&le])^ae[Ve++],dr=(ue[Ie>>>24]<<24|ue[ie>>>16&255]<<16|ue[le>>>8&255]<<8|ue[255&de])^ae[Ve++],fr=(ue[ie>>>24]<<24|ue[le>>>16&255]<<16|ue[de>>>8&255]<<8|ue[255&Ie])^ae[Ve++],V[he]=Dt,V[he+1]=tr,V[he+2]=dr,V[he+3]=fr},keySize:8});o.AES=s._createHelper(A)}(),n.AES)},function(t,r){},function(t,r,e){var n;t.exports=(n=e(89),function(o){var s=n,a=s.lib,i=a.WordArray,u=a.Hasher,c=s.algo,d=[];(function(){for(var k=0;k<64;k++)d[k]=4294967296*o.abs(o.sin(k+1))|0})();var m=c.MD5=u.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(k,y){for(var A=0;A<16;A++){var V=y+A,he=k[V];k[V]=16711935&(he<<8|he>>>24)|4278255360&(he<<24|he>>>8)}var ae=this._hash.words,Ne=k[y+0],_e=k[y+1],Ce=k[y+2],re=k[y+3],ue=k[y+4],ze=k[y+5],le=k[y+6],de=k[y+7],Ie=k[y+8],ie=k[y+9],Ve=k[y+10],Ue=k[y+11],Dt=k[y+12],tr=k[y+13],dr=k[y+14],fr=k[y+15],sr=ae[0],hr=ae[1],Fe=ae[2],or=ae[3];sr=v(sr,hr,Fe,or,Ne,7,d[0]),or=v(or,sr,hr,Fe,_e,12,d[1]),Fe=v(Fe,or,sr,hr,Ce,17,d[2]),hr=v(hr,Fe,or,sr,re,22,d[3]),sr=v(sr,hr,Fe,or,ue,7,d[4]),or=v(or,sr,hr,Fe,ze,12,d[5]),Fe=v(Fe,or,sr,hr,le,17,d[6]),hr=v(hr,Fe,or,sr,de,22,d[7]),sr=v(sr,hr,Fe,or,Ie,7,d[8]),or=v(or,sr,hr,Fe,ie,12,d[9]),Fe=v(Fe,or,sr,hr,Ve,17,d[10]),hr=v(hr,Fe,or,sr,Ue,22,d[11]),sr=v(sr,hr,Fe,or,Dt,7,d[12]),or=v(or,sr,hr,Fe,tr,12,d[13]),Fe=v(Fe,or,sr,hr,dr,17,d[14]),sr=g(sr,hr=v(hr,Fe,or,sr,fr,22,d[15]),Fe,or,_e,5,d[16]),or=g(or,sr,hr,Fe,le,9,d[17]),Fe=g(Fe,or,sr,hr,Ue,14,d[18]),hr=g(hr,Fe,or,sr,Ne,20,d[19]),sr=g(sr,hr,Fe,or,ze,5,d[20]),or=g(or,sr,hr,Fe,Ve,9,d[21]),Fe=g(Fe,or,sr,hr,fr,14,d[22]),hr=g(hr,Fe,or,sr,ue,20,d[23]),sr=g(sr,hr,Fe,or,ie,5,d[24]),or=g(or,sr,hr,Fe,dr,9,d[25]),Fe=g(Fe,or,sr,hr,re,14,d[26]),hr=g(hr,Fe,or,sr,Ie,20,d[27]),sr=g(sr,hr,Fe,or,tr,5,d[28]),or=g(or,sr,hr,Fe,Ce,9,d[29]),Fe=g(Fe,or,sr,hr,de,14,d[30]),sr=b(sr,hr=g(hr,Fe,or,sr,Dt,20,d[31]),Fe,or,ze,4,d[32]),or=b(or,sr,hr,Fe,Ie,11,d[33]),Fe=b(Fe,or,sr,hr,Ue,16,d[34]),hr=b(hr,Fe,or,sr,dr,23,d[35]),sr=b(sr,hr,Fe,or,_e,4,d[36]),or=b(or,sr,hr,Fe,ue,11,d[37]),Fe=b(Fe,or,sr,hr,de,16,d[38]),hr=b(hr,Fe,or,sr,Ve,23,d[39]),sr=b(sr,hr,Fe,or,tr,4,d[40]),or=b(or,sr,hr,Fe,Ne,11,d[41]),Fe=b(Fe,or,sr,hr,re,16,d[42]),hr=b(hr,Fe,or,sr,le,23,d[43]),sr=b(sr,hr,Fe,or,ie,4,d[44]),or=b(or,sr,hr,Fe,Dt,11,d[45]),Fe=b(Fe,or,sr,hr,fr,16,d[46]),sr=T(sr,hr=b(hr,Fe,or,sr,Ce,23,d[47]),Fe,or,Ne,6,d[48]),or=T(or,sr,hr,Fe,de,10,d[49]),Fe=T(Fe,or,sr,hr,dr,15,d[50]),hr=T(hr,Fe,or,sr,ze,21,d[51]),sr=T(sr,hr,Fe,or,Dt,6,d[52]),or=T(or,sr,hr,Fe,re,10,d[53]),Fe=T(Fe,or,sr,hr,Ve,15,d[54]),hr=T(hr,Fe,or,sr,_e,21,d[55]),sr=T(sr,hr,Fe,or,Ie,6,d[56]),or=T(or,sr,hr,Fe,fr,10,d[57]),Fe=T(Fe,or,sr,hr,le,15,d[58]),hr=T(hr,Fe,or,sr,tr,21,d[59]),sr=T(sr,hr,Fe,or,ue,6,d[60]),or=T(or,sr,hr,Fe,Ue,10,d[61]),Fe=T(Fe,or,sr,hr,Ce,15,d[62]),hr=T(hr,Fe,or,sr,ie,21,d[63]),ae[0]=ae[0]+sr|0,ae[1]=ae[1]+hr|0,ae[2]=ae[2]+Fe|0,ae[3]=ae[3]+or|0},_doFinalize:function(){var k=this._data,y=k.words,A=8*this._nDataBytes,V=8*k.sigBytes;y[V>>>5]|=128<<24-V%32;var he=o.floor(A/4294967296),ae=A;y[15+(V+64>>>9<<4)]=16711935&(he<<8|he>>>24)|4278255360&(he<<24|he>>>8),y[14+(V+64>>>9<<4)]=16711935&(ae<<8|ae>>>24)|4278255360&(ae<<24|ae>>>8),k.sigBytes=4*(y.length+1),this._process();for(var Ne=this._hash,_e=Ne.words,Ce=0;Ce<4;Ce++){var re=_e[Ce];_e[Ce]=16711935&(re<<8|re>>>24)|4278255360&(re<<24|re>>>8)}return Ne},clone:function(){var k=u.clone.call(this);return k._hash=this._hash.clone(),k}});function v(k,y,A,V,he,ae,Ne){var _e=k+(y&A|~y&V)+he+Ne;return(_e<<ae|_e>>>32-ae)+y}function g(k,y,A,V,he,ae,Ne){var _e=k+(y&V|A&~V)+he+Ne;return(_e<<ae|_e>>>32-ae)+y}function b(k,y,A,V,he,ae,Ne){var _e=k+(y^A^V)+he+Ne;return(_e<<ae|_e>>>32-ae)+y}function T(k,y,A,V,he,ae,Ne){var _e=k+(A^(y|~V))+he+Ne;return(_e<<ae|_e>>>32-ae)+y}s.MD5=u._createHelper(m),s.HmacMD5=u._createHmacHelper(m)}(Math),n.MD5)},function(t,r,e){var n,o,s,a,i,u,c,d;t.exports=(d=e(89),o=(n=d).lib,s=o.WordArray,a=o.Hasher,i=n.algo,u=[],c=i.SHA1=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(m,v){for(var g=this._hash.words,b=g[0],T=g[1],k=g[2],y=g[3],A=g[4],V=0;V<80;V++){if(V<16)u[V]=0|m[v+V];else{var he=u[V-3]^u[V-8]^u[V-14]^u[V-16];u[V]=he<<1|he>>>31}var ae=(b<<5|b>>>27)+A+u[V];ae+=V<20?1518500249+(T&k|~T&y):V<40?1859775393+(T^k^y):V<60?(T&k|T&y|k&y)-1894007588:(T^k^y)-899497514,A=y,y=k,k=T<<30|T>>>2,T=b,b=ae}g[0]=g[0]+b|0,g[1]=g[1]+T|0,g[2]=g[2]+k|0,g[3]=g[3]+y|0,g[4]=g[4]+A|0},_doFinalize:function(){var m=this._data,v=m.words,g=8*this._nDataBytes,b=8*m.sigBytes;return v[b>>>5]|=128<<24-b%32,v[14+(b+64>>>9<<4)]=Math.floor(g/4294967296),v[15+(b+64>>>9<<4)]=g,m.sigBytes=4*v.length,this._process(),this._hash},clone:function(){var m=a.clone.call(this);return m._hash=this._hash.clone(),m}}),n.SHA1=a._createHelper(c),n.HmacSHA1=a._createHmacHelper(c),d.SHA1)},function(t,r,e){var n,o,s,a;t.exports=(n=e(89),s=(o=n).lib.Base,a=o.enc.Utf8,void(o.algo.HMAC=s.extend({init:function(i,u){i=this._hasher=new i.init,typeof u=="string"&&(u=a.parse(u));var c=i.blockSize,d=4*c;u.sigBytes>d&&(u=i.finalize(u)),u.clamp();for(var m=this._oKey=u.clone(),v=this._iKey=u.clone(),g=m.words,b=v.words,T=0;T<c;T++)g[T]^=1549556828,b[T]^=909522486;m.sigBytes=v.sigBytes=d,this.reset()},reset:function(){var i=this._hasher;i.reset(),i.update(this._iKey)},update:function(i){return this._hasher.update(i),this},finalize:function(i){var u=this._hasher,c=u.finalize(i);return u.reset(),u.finalize(this._oKey.clone().concat(c))}})))},function(t,r,e){var n,o;t.exports=(o=e(89),e(311),o.mode.ECB=((n=o.lib.BlockCipherMode.extend()).Encryptor=n.extend({processBlock:function(s,a){this._cipher.encryptBlock(s,a)}}),n.Decryptor=n.extend({processBlock:function(s,a){this._cipher.decryptBlock(s,a)}}),n),o.mode.ECB)},function(t,r,e){var n;t.exports=(n=e(89),e(311),n.pad.Pkcs7)},function(t,r,e){var n;t.exports=(n=e(89),n.enc.Utf8)},function(t,r,e){var n=e(9),o=e(194).fn,s=e(310);o.onChatroomMembersInfo=o.onChatroomMembers=function(a){a.error||(a.obj.members=s.reverseMembers(a.content.members))},o.onGetChatroomMemberCountByTag=function(a){a.error||(a.obj=a.content)},o.onMarkChatroomMember=function(a){a.error||(a.obj.member=n(s).call(s,a.content.chatroomMember))},o.onSyncRobot=function(a){!a.error&&this.options.onrobots?this.options.onrobots(null,a.content):this.ontions.onrobots(a.error,{})}},function(t,r,e){var n=e(9),o=e(8),s=e(0),a=function(k){this.account=k.account},i=a.prototype,u=i.Message=e(117),c=i.TextMessage=e(895),d=i.FileMessage=e(204),m=i.GeoMessage=e(899),v=i.NotificationMessage=e(900),g=i.CustomMessage=e(901),b=i.TipMessage=e(902),T=i.RobotMessage=e(903);i.validTypes=u.validTypes,i.reverse=function(k){var y;switch(u.getType(k)){case"text":y=n(c).call(c,k);break;case"image":case"audio":case"video":case"file":y=n(d).call(d,k);break;case"geo":y=n(m).call(m,k);break;case"notification":y=n(v).call(v,k);break;case"custom":y=n(g).call(g,k);break;case"tip":y=n(b).call(b,k);break;case"robot":y=n(T).call(T,k);break;default:y=n(u).call(u,k)}return u.setExtra(y,this.account),y},i.reverseMsgs=function(k,y){var A,V,he=this;return o(k).call(k,function(ae){return ae=n(he).call(he,ae),y&&((A=y.modifyObj)&&(ae=s.merge(ae,A)),V=y.mapper,s.isFunction(V)&&(ae=V(ae))),ae})},t.exports=a},function(t,r,e){var n=e(18),o=e(9),s=e(117),a=e(0);function i(u){a.verifyOptions(u,"text","msg::TextMessage"),u.type="text",s.call(this,u),this.attach=u.text,this.body=""}i.prototype=n(s.prototype),i.reverse=function(u){var c=o(s).call(s,u);return c.text=u.attach,c},t.exports=i},function(t,r,e){var n=e(18),o=e(0),s=e(204);function a(){}a.prototype=n(s.prototype),a.verifyFile=function(i,u){o.verifyOptions(i,"w h",!0,"file.",u)},t.exports=a},function(t,r,e){var n=e(18),o=e(204),s=e(0);function a(){}a.prototype=n(o.prototype),a.verifyFile=function(i,u){s.verifyOptions(i,"dur",!0,"file.",u)},t.exports=a},function(t,r,e){var n=e(18),o=e(204),s=e(0);function a(){}a.prototype=n(o.prototype),a.verifyFile=function(i,u){s.verifyOptions(i,"dur w h",!0,"file.",u)},t.exports=a},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(117),i=e(0);function u(c){c.type="geo",i.verifyOptions(c,"geo","msg::GeoMessage"),i.verifyOptions(c.geo,"lng lat title",!0,"geo.","msg::GeoMessage"),i.verifyParamType("geo.lng",c.geo.lng,"number","msg::GeoMessage"),i.verifyParamType("geo.lat",c.geo.lat,"number","msg::GeoMessage"),i.verifyParamType("geo.title",c.geo.title,"string","msg::GeoMessage"),a.call(this,c),this.attach=n(c.geo)}u.prototype=o(a.prototype),u.reverse=function(c){var d=s(a).call(a,c);return c.attach=c.attach?""+c.attach:"",d.geo=c.attach?JSON.parse(c.attach):{},d},t.exports=u},function(t,r,e){var n=e(18),o=e(9),s=e(52),a=e(0).notundef,i=e(117),u={301:"memberEnter",302:"memberExit",303:"blackMember",304:"unblackMember",305:"gagMember",306:"ungagMember",307:"addManager",308:"removeManager",309:"addCommon",310:"removeCommon",311:"closeChatroom",312:"updateChatroom",313:"kickMember",314:"addTempMute",315:"removeTempMute",316:"updateMemberInfo",317:"updateQueue",318:"muteRoom",319:"unmuteRoom",320:"batchUpdateQueue",321:"addTempMuteTag",322:"removeTempMuteTag",324:"batchQueueOffer",323:"deleteChatroomMsg",325:"updateChatroomTags"};function c(){}c.prototype=n(i.prototype),c.reverse=function(d){var m=o(i).call(i,d);if(d.attach=d.attach?""+d.attach:"",d.attach){var v=JSON.parse(d.attach);if(m.attach={type:u[v.id]},a(v.data)){var g=v.data;if(a(g.operator)&&(m.attach.from=g.operator),a(g.opeNick)&&(m.attach.fromNick=g.opeNick),a(g.target)&&(m.attach.to=g.target),a(g.tarNick)&&(m.attach.toNick=g.tarNick),a(g.muteDuration)&&(m.attach.duration=s(g.muteDuration,10)),a(g.tags)&&(m.attach.tags=g.tags),m.attach.type==="memberEnter"&&(a(g.muted)?m.attach.gaged=+g.muted==1:m.attach.gaged=!1,a(g.tempMuted)?m.attach.tempMuted=+g.tempMuted==1:m.attach.tempMuted=!1,a(g.muteTtl)?m.attach.tempMuteDuration=+g.muteTtl:m.attach.tempMuteDuration=0),m.attach.type==="deleteChatroomMsg"&&(m.attach.msgId=g.msgId,m.attach.msgTime=g.msgTime),a(g.ext)&&(m.attach.custom=g.ext),a(g.queueChange)){var b=JSON.parse(g.queueChange);switch(b._e){case"OFFER":m.attach.queueChange={type:"OFFER",elementKey:b.key,elementValue:b.content};break;case"POLL":m.attach.queueChange={type:"POLL",elementKey:b.key,elementValue:b.content};break;case"DROP":m.attach.queueChange={type:"DROP"};break;case"PARTCLEAR":case"BATCH_UPDATE":m.attach.queueChange={type:b._e,elementKv:b.kvObject};break;case"BATCH_OFFER":m.attach.queueChange={type:b._e,elements:b.elements}}}}}else m.attach={};return m},t.exports=c},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(117),i=e(0);function u(c){i.verifyOptions(c,"content","msg::CustomMessage"),c.type="custom",a.call(this,c),typeof c.content!="string"&&(c.content=n(c.content)),this.attach=c.content}u.prototype=o(a.prototype),u.reverse=function(c){var d=s(a).call(a,c);return d.content=c.attach,d},t.exports=u},function(t,r,e){var n=e(18),o=e(9),s=e(117),a=e(0);function i(u){a.verifyOptions(u,"tip","msg::TipMessage"),u.type="tip",s.call(this,u),this.attach=u.tip}i.prototype=n(s.prototype),i.reverse=function(u){var c=o(s).call(s,u);return c.tip=u.attach,c},t.exports=i},function(t,r,e){var n=e(10),o=e(18),s=e(9),a=e(8),i=e(117),u=e(0),c={welcome:"00",text:"01",link:"03"},d={"01":"text","02":"image","03":"answer",11:"template"};function m(v){u.verifyOptions(v,"content","msg::RobotMessage");var g=v.content;switch(g.type){case"welcome":u.undef(v.body)&&(this.body="欢迎消息");break;case"text":u.verifyOptions(g,"content","msg::RobotMessage"),u.undef(v.body)&&(this.body=g.content);break;case"link":u.verifyOptions(g,"target","msg::RobotMessage")}g.type&&(g.type=c[g.type]),g={param:g,robotAccid:v.robotAccid},this.attach=n(g),v.type="robot",i.call(this,v)}m.prototype=o(i.prototype),m.reverse=function(v){var g=s(i).call(i,v);if(g.type==="robot"){var b=JSON.parse(v.attach);if(b.param&&(b.param.type=d[b.param.type]||"unknown"),b.robotMsg){var T=(b=u.merge(b,b.robotMsg)).message;b.flag==="bot"?b.message=a(T).call(T,function(k){return k.type=d[k.type]||"unknown",k}):b.flag,delete b.robotMsg}g.content=b}return g},t.exports=m},function(t,r,e){var n=e(9),o=e(32),s=e(8),a=e(17),i=e(10),u=e(0),c=u.undef,d=e(193).fn,m=e(23).reportAPI;d.beforeSendMsg=function(g){g.cmd="sendMsg"};var v={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,tip:10,robot:11,custom:100};d.getHistoryMsgs=function(g){if((g=g||{}).done=m({instance:this,className:"ChatroomFn",funcName:"getHistoryMsgs",done:g.done}),u.verifyOptions(g),c(g.timetag)?g.timetag=0:u.verifyParamType("timetag",g.timetag,"number","msg::getHistoryMsgs"),c(g.limit)?g.limit=100:u.verifyParamType("limit",g.limit,"number","msg::getHistoryMsgs"),c(n(g))?g.reverse=!1:u.verifyParamType("reverse",n(g),"boolean","msg::getHistoryMsgs"),c(g.msgTypes))g.msgTypes=[];else if(o(g.msgTypes)){var b,T;g.msgTypes=s(b=g.msgTypes).call(b,function(k){return v[k]}),g.msgTypes=a(T=g.msgTypes).call(T,function(k){return typeof k=="number"})}else typeof v[g.msgTypes]=="number"?g.msgTypes=[v[g.msgTypes]]:g.msgTypes=[];this.processCallback(g),this.sendCmd("getHistoryMsgs",g,function(k,y,A){o(A)&&(A=s(A).call(A,function(V){return v[V.type]&&(V.type=v[V.type]),V})),g.callback(k,y,A)})},d.getHistoryMsgsByTags=function(g){if((g=g||{}).done=m({instance:this,className:"ChatroomFn",funcName:"getHistoryMsgsByTags",done:g.done}),u.verifyOptions(g,"tags","api::msg::getHistoryMsgsByTags"),u.verifyParamType("tags",g.tags,"array","api::msg::getHistoryMsgsByTags"),c(g.fromTime)?g.fromTime=0:u.verifyParamType("fromTime",g.fromTime,"number","api::msg::getHistoryMsgsByTags"),c(g.toTime)?g.toTime=0:u.verifyParamType("toTime",g.toTime,"number","api::msg::getHistoryMsgsByTags"),c(g.limit)?g.limit=100:u.verifyParamType("limit",g.limit,"number","msg::getHistoryMsgs"),c(n(g))?g.reverse=0:u.verifyParamType("reverse",n(g),"number","msg::getHistoryMsgs"),c(g.types))g.types=[];else if(o(g.types)){var b,T;g.types=s(b=g.types).call(b,function(k){return v[k]}),g.types=a(T=g.types).call(T,function(k){return typeof k=="number"})}else typeof v[g.types]=="number"?g.types=[v[g.types]]:g.types=[];this.processCallback(g),g.types=i(g.types),g.tags=i(g.tags),this.sendCmd("getHistoryMsgsByTags",{chatRoomTagHistoryMsgRequestTag:g},g.callback)}},function(t,r,e){var n=e(193).fn,o=e(23).reportAPI;n.disconnect=function(s){(s=s||{}).done=o({instance:this,className:"ChatroomFn",funcName:"disconnect",done:s.done}),this.protocol.disconnect(s.done)}},function(t,r,e){var n=e(0),o=n.undef,s=n.verifyOptions,a=n.verifyParamType,i=e(310),u=e(193).fn,c=e(23).reportAPI;u.updateMyChatroomMemberInfo=function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"updateMyChatroomMemberInfo",done:d.done}),s(d,"member needNotify","member::updateMyChatroomMemberInfo"),a("needNotify",d.needNotify,"boolean","member::updateMyChatroomMemberInfo"),d.needSave=d.needSave||!1,a("needSave",d.needSave,"boolean","member::updateMyChatroomMemberInfo"),this.processCustom(d),this.processCallback(d),d.chatroomMember=new i(d.member),d.antispamTag={antiSpamBusinessId:d.antiSpamBusinessId},this.sendCmd("updateMyChatroomMemberInfo",d)},u.getChatroomMembers=function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"getChatroomMembers",done:d.done}),s(d,"guest","member::getChatroomMembers"),a("guest",d.guest,"boolean","member::getChatroomMembers"),o(d.time)?d.time=0:a("time",d.time,"number","member::getChatroomMembers"),o(d.limit)?d.limit=100:a("limit",d.limit,"number","member::getChatroomMembers"),this.processCallback(d),d.guest?d.type=d.desc===!1?3:1:d.type=d.onlyOnline?2:0,this.sendCmd("getChatroomMembers",d)},u.getChatroomMembersByTag=function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"getChatroomMembersByTag",done:d.done}),s(d,"tag","getChatroomMembersByTag::rag"),o(d.time)?d.time=0:a("time",d.time,"number","getChatroomMembersByTag::time"),o(d.limit)?d.limit=100:a("limit",d.limit,"number","getChatroomMembersByTag::limit"),this.processCallback(d),this.sendCmd("getChatroomMembersByTag",{tagMemberReq:n.filterObj(d,"tag limit time"),callback:d.callback})},u.getChatroomMemberCountByTag=function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"getChatroomMemberCountByTag",done:d.done}),s(d,"tag","getChatroomMemberCountByTag::rag"),this.processCallback(d),this.sendCmd("getChatroomMemberCountByTag",d)},u.getChatroomMembersInfo=function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"getChatroomMembersInfo",done:d.done}),s(d,"accounts","member::getChatroomMembersInfo"),a("accounts",d.accounts,"array","member::getChatroomMembersInfo"),this.processCallback(d),this.sendCmd("getChatroomMembersInfo",d)},u.markChatroomIdentity=function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"markChatroomIdentity",done:d.done}),s(d,"identity","member::markChatroomIdentity"),d.type={manager:1,common:2,black:-1,mute:-2}[d.identity],delete d.identity,isNaN(d.type)?s(d,"identity",'member::markChatroomIdentity. The valid value of the identity is "manager" or "common" or "black" or "mute".'):this.markChatroomMember(d)},u.markChatroomManager=function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"markChatroomManager",done:d.done}),d.type=1,this.markChatroomMember(d)},u.markChatroomCommonMember=function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"markChatroomCommonMember",done:d.done}),d.type=2,this.markChatroomMember(d)},u.markChatroomBlacklist=function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"markChatroomBlacklist",done:d.done}),d.type=-1,this.markChatroomMember(d)},u.markChatroomGaglist=function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"markChatroomGaglist",done:d.done}),d.type=-2,this.markChatroomMember(d)},u.markChatroomMember=function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"markChatroomMember",done:d.done}),s(d,"account type isAdd","member::markChatroomMember"),a("isAdd",d.isAdd,"boolean","member::markChatroomMember"),o(d.level)?d.level=0:a("level",d.level,"number","member::markChatroomMember"),this.processCustom(d),this.processCallback(d),this.sendCmd("markChatroomMember",d)},u.kickChatroomMember=function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"kickChatroomMember",done:d.done}),s(d,"account","member::kickChatroomMember"),this.processCustom(d),this.processCallback(d),this.sendCmd("kickChatroomMember",d)},u.updateChatroomMemberTempMute=function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"updateChatroomMemberTempMute",done:d.done}),s(d,"account duration needNotify","member::updateChatroomMemberTempMute"),a("duration",d.duration,"number","member::updateChatroomMemberTempMute"),a("needNotify",d.needNotify,"boolean","member::updateChatroomMemberTempMute"),this.processCustom(d),this.processCallback(d),this.sendCmd("updateChatroomMemberTempMute",d)},u.updateTagMembersTempMute=function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"updateTagMembersTempMute",done:d.done}),s(d,"tag duration needNotify","member::updateTagMembersTempMute"),a("duration",d.duration,"number","member::updateTagMembersTempMute"),a("needNotify",d.needNotify,"boolean","member::updateTagMembersTempMute"),this.processCustom(d),this.processCallback(d);var m=n.filterObj(d,"tag duration custom notifyTargetTags");m.needNotify=d.needNotify?1:0,this.sendCmd("updateTagMembersTempMute",{tagMuteReq:m,callback:d.callback})},u.updateCoordinate=n.throttle(function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"updateCoordinate",done:d.done});var m=!0;d.x===void 0||d.y===void 0||d.z===void 0?m=!1:(typeof d.x!="number"&&(d.x=0),typeof d.y!="number"&&(d.y=0),typeof d.z!="number"&&(d.z=0)),this.processCallback(d);var v=n.filterObj(d,m?"x y z distance":"distance");this.sendCmd("updateCoordinate",{coordinateReq:v,callback:d.callback})},300,{},function(d){d&&d.done&&d.done({code:416,chatroomId:this.options.chatroomId})}),u.getRobotList=function(d){(d=d||{}).done=c({instance:this,className:"ChatroomFn",funcName:"getRobotList",done:d.done}),this.logger.warn("this api will be abandon"),o(d.timetag)&&(d.timetag=0),this.processCallback(d),this.sendCmd("syncRobot",d)}},function(t,r,e){var n=e(193).fn,o=e(0),s=e(23).reportAPI;n.queueOffer=function(a){(a=a||{}).done=s({instance:this,className:"ChatroomFn",funcName:"queueOffer",done:a.done}),o.verifyOptions(a,"elementKey elementValue","msg::queueOffer");var i={elementKey:a.elementKey,elementValue:a.elementValue,transient:!!a.transient};a.elementAccount&&(i.elementAccount=a.elementAccount),this.processCallback(a),this.sendCmd("queueOffer",i,a.callback)},n.queuePoll=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(a=a||{}).done=s({instance:this,className:"ChatroomFn",funcName:"queuePoll",done:a.done}),a.elementKey=a.elementKey||"",this.processCallback(a),this.sendCmd("queuePoll",a,a.callback)},n.queueList=function(a){(a=a||{}).done=s({instance:this,className:"ChatroomFn",funcName:"queueList",done:a.done}),this.processCallback(a),this.sendCmd("queueList",a,a.callback)},n.peak=function(a){(a=a||{}).done=s({instance:this,className:"ChatroomFn",funcName:"peak",done:a.done}),this.processCallback(a),this.sendCmd("peak",a,a.callback)},n.queueDrop=function(a){(a=a||{}).done=s({instance:this,className:"ChatroomFn",funcName:"queueDrop",done:a.done}),this.processCallback(a),this.sendCmd("queueDrop",a,a.callback)},n.queueChange=function(a){(a=a||{}).done=s({instance:this,className:"ChatroomFn",funcName:"queueChange",done:a.done}),o.verifyOptions(a,"elementMap","msg::queueOffer"),a.needNotify?(a.needNotify=!0,o.verifyOptions(a,"notifyExt","msg::queueOffer")):a.needNotify=!1,this.processCallback(a),this.sendCmd("queueChange",a,a.callback)}},,,function(t,r,e){t.exports=e(911)},function(t,r,e){e(297);var n={NIM:e(765),Chatroom:e(881)};e(309)(n),t.exports=n}])})})(NIM_Web_SDK);var NIM_Web_SDKExports=NIM_Web_SDK.exports;const NIM_SDK=getDefaultExportFromCjs(NIM_Web_SDKExports);class NimChatroomSocket{constructor(r){vc(this,"liveId");vc(this,"nimChatroomSocket");vc(this,"onMessage");vc(this,"handleRoomSocketMessage",r=>{this.onMessage(this,r)});vc(this,"onConnet",r=>{console.log("进入小偶像的直播间成功。")});vc(this,"handleRoomSocketError",(r,e)=>{console.log("发生错误",r,e)});vc(this,"handleRoomSocketDisconnect",r=>{console.log("连接断开",r)});this.liveId=r.liveId,this.onMessage=r.onMessage}init(r){this.nimChatroomSocket=NIM_SDK.Chatroom.getInstance({appKey:atob(r),chatroomId:this.liveId,chatroomAddresses:["chatweblink01.netease.im:443"],onconnect:this.onConnet,onmsgs:this.handleRoomSocketMessage,onerror:this.handleRoomSocketError,ondisconnect:this.handleRoomSocketDisconnect,isAnonymous:!0,chatroomNick:this.uuid(),chatroomAvatar:"",db:!1,dbLog:!1})}disconnect(){var r,e;(e=(r=this.nimChatroomSocket)==null?void 0:r.disconnect)==null||e.call(r,{done(){}}),this.nimChatroomSocket=void 0}uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var e=Math.random()*16|0,n=r==="x"?e:e&3|8;return n.toString(16)})}}class PocketMessage{constructor(){vc(this,"content");vc(this,"url");vc(this,"type")}add(r){return this.content=r,this.type=1,this}addImg(r,e){return this.content=r,this.url=e,this.type=2,this}addVoice(r,e){return this.content=r,this.url=e,this.type=3,this}addVideo(r,e){return this.content=r,this.url=e,this.type=4,this}}const elBadge="",elMessage="",elMessageBox="",elInput="",elOverlay="",_hoisted_1$2=createBaseVNode("span",{style:{color:"red"}},"(不启用QQ机器人无需配置)",-1),_hoisted_2$2=createBaseVNode("h3",{style:{"margin-left":"40%"}},"消息及日志",-1),_hoisted_3$2={style:{height:"530px",overflow:"auto"},id:"textArae"},_hoisted_4$2={style:{margin:"5px"}},_hoisted_5$2={key:0},_hoisted_6$1={key:1},_hoisted_7$1={style:{height:"530px",overflow:"auto"}},_hoisted_8$1=createBaseVNode("tr",null,[createBaseVNode("th",{width:"300px"},"图片"),createBaseVNode("th",null,"操作")],-1),_hoisted_9$1={align:"center"},_hoisted_10$1=createBaseVNode("span",{title:"点击复制",style:{position:"absolute",right:"10px",bottom:"0",color:"rgb(194, 191, 191)","font-size":"15px"}},"如发现问题，反馈QQ：1615842006",-1),_sfc_main$3=defineComponent({__name:"Index",setup(t){const r=ref({}),e=ref({}),n=ref(!1),o=ref(!1),s=useRouter(),a=ref(),i=ref(),u=ref(),c=ref(new Array),d=ref(new Array),m=ref(),v=ref(!1);watch(c.value,(le,de)=>{le.length>=100&&c.value.splice(0,1);var Ie=document.getElementById("textArae");Ie!==null&&(Ie.scrollTop=Ie.scrollHeight)});const g=async()=>{await axios$1({url:"http://parkerbot.api/api/StartAliYunApi"})},b=async()=>{var le=await axios$1({url:"http://parkerbot.api/api/StartMiraiConsole"});le.data||ElMessage({showClose:!0,message:"Mirai目录不存在或路径错误，请检查后重试！",type:"error"}),le.data&&ElMessage({showClose:!0,message:"已为您打开Mirai控制台！",type:"success"})},T=async()=>{a.value&&a.value.destroy(),i.value&&i.value.destroy();const le=await _e();r.value=le.data.config;const de=le.data.config.KD;var Ie=!1;if(le.data.enable.forEach(Ue=>{Ue.key=="KD"&&(Ie=JSON.parse(Ue.value))}),Ie)a.value=new NIMSDK({appkey:atob(de.appKey),account:de.account,token:de.token}),await a.value.connect(),i.value=new QChatSDK({appkey:atob(de.appKey),account:de.account,token:de.token,linkAddresses:await a.value.plugin.getQChatAddress({ipType:2})}),i.value.on("logined",k),i.value.on("message",y),i.value.on("disconnect",V),await i.value.login();else{var ie="机器人启动中！";c.value.push(new PocketMessage().add(ie)),ie="";var Ve=await axios$1({url:"http://parkerbot.api/api/start"});n.value&&(Ve.data.mirai?ie+="QQ机器人启动成功。":ie+="QQ机器人启动失败。"),setTimeout(()=>{ie&&c.value.push(new PocketMessage().add(ie)),c.value.push(new PocketMessage().add("机器人已启动"))},500)}},k=async function(){var le=`口袋登录成功。订阅小偶像${r.value.KD.name}的房间。`;if(c.value.push(new PocketMessage().add(le)),i.value==null)throw"聊天室未成功实例化";if((await i.value.qchatServer.subscribeAllChannel({type:1,serverIds:[r.value.KD.serverId]})).failServerIds.length){le=`小偶像${r.value.KD.name}的房间订阅失败。请检查配置后重试，如仍有问题，请联系开发者。`,c.value.push(new PocketMessage().add(le));return}le=`小偶像${r.value.KD.name}的房间订阅成功。`,c.value.push(new PocketMessage().add(le)),u.value=new NimChatroomSocket({liveId:r.value.KD.liveRoomId,onMessage:A}),u.value.init(r.value.KD.appKey);var Ie=await axios$1({url:"http://parkerbot.api/api/start"});m.value=new window.WebSocket("ws://localhost:6001"),m.value.onopen=()=>{v.value=!0,c.value.push(new PocketMessage().add("连接消息推送服务器成功。"))},m.value.onclose=()=>{v.value=!1,c.value.push(new PocketMessage().add("连接消息推送服务器失败，请尝试再次启动机器人。请检查配置后重试，如仍有问题，请联系开发者。"))},n.value&&(Ie.data.mirai?le="QQ机器人启动成功。":le="QQ机器人启动失败，请尝试再次启动机器人。请检查配置后重试，如仍有问题，请联系开发者。",c.value.push(new PocketMessage().add(le)))},y=async function(le){var Ie,ie,Ve,Ue;if(le.fromType=1,le.ext=JSON.parse(le.ext),le.channelName=await he(le.channelId),le.time=dayjs(le.time).format("YYYY-MM-DD HH:mm:ss"),v.value&&((Ie=m.value)==null||Ie.send(JSON.stringify(le))),le.type=="text"){var de=`【${le.channelName}|${le.time}】${le.ext.user.nickName}:${le.body}`;c.value.push(new PocketMessage().add(de))}else le.type=="image"?c.value.push(new PocketMessage().addImg(`【${le.channelName}|${le.time}】${le.ext.user.nickName}:`,(ie=le==null?void 0:le.attach)==null?void 0:ie.url)):le.type=="video"?c.value.push(new PocketMessage().addVideo(`【${le.channelName}|${le.time}】${le.ext.user.nickName}:`,(Ve=le==null?void 0:le.attach)==null?void 0:Ve.url)):le.type=="audio"?c.value.push(new PocketMessage().addVoice(`【${le.channelName}|${le.time}】${le.ext.user.nickName}:`,(Ue=le==null?void 0:le.attach)==null?void 0:Ue.url)):le.type=="custom"&&c.value.push(new PocketMessage().add(`【${le.channelName}|${le.time}】${le.ext.user.nickName}:发送了一条特殊消息！`))},A=function(le,de){de.forEach(Ie=>{var ie;v.value&&(Ie.fromType=2,(ie=m.value)==null||ie.send(JSON.stringify(Ie)))})},V=function(...le){c.value.push(new PocketMessage().add("登录连接状态已断开。"))},he=async function(le){if(i.value==null)throw"聊天室未成功实例化。";const de=await i.value.qchatChannel.getChannels({channelIds:[`${le}`]});return de?de[0].name:""},ae=()=>{a.value&&a.value.destroy(),i.value&&i.value.destroy(),u.value&&u.value.disconnect(),s.push("/config")},Ne=()=>{a.value&&a.value.destroy(),i.value&&i.value.destroy(),u.value&&u.value.disconnect(),s.push("mirai")},_e=async()=>{var le=await axios$1({url:"http://parkerbot.api/api/GetBaseConfig"});return le};onMounted(async()=>{const le=await _e();r.value=le.data.config,e.value=le.data.mirai,n.value=le.data.mirai.useMirai,le.data.enable.forEach(de=>{de.key==="BD"&&JSON.parse(de.value)&&le.data.config.BD.saveAliyunDisk&&(o.value=!0)}),await ue()});const Ce=async(le,de)=>{var Ie=await axios$1({url:"http://parkerbot.api/api/piccheck?id="+le+"&type=1"});Ie.data&&(ElMessage({showClose:!0,message:"保存成功！",type:"success"}),d.value.splice(de,1)),Ie.data||ElMessage({showClose:!0,message:"保存失败！",type:"error"})},re=async(le,de)=>{var Ie=await axios$1({url:"http://parkerbot.api/api/piccheck?id="+le+"&type=2"});Ie.data&&(ElMessage({showClose:!0,message:"删除成功！",type:"success"}),d.value.splice(de,1)),Ie.data||ElMessage({showClose:!0,message:"删除失败！",type:"error"})},ue=async()=>{var le=await axios$1({url:"http://parkerbot.api/api/refresh"});d.value=le.data},ze=()=>{ElMessageBox.prompt("","请输入微博id",{confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:(le,de,Ie)=>{if(le=="confirm"){const ie=de.inputValue;!ie||ie.trim()===""?ElMessage({showClose:!0,message:"请输入微博id",type:"warning"}):Ie()}else Ie()}}).then(async({value:le})=>{if(!(!le||le.trim()==="")){var de=await axios$1({url:"http://parkerbot.api/api/SaveByBlogId?blogId="+le});de.data.success?ElMessage({showClose:!0,message:"抓取成功！",type:"success"}):ElMessage({showClose:!0,message:de.data.msg||"抓取失败！",type:"error"})}})};return(le,de)=>{const Ie=ElButton,ie=ElDropdownItem,Ve=ElDropdownMenu,Ue=ElDropdown,Dt=ElFormItem,tr=ElForm,dr=ElHeader,fr=ElImage,sr=ElCol,hr=ElRow,Fe=ElMain,or=ElContainer;return openBlock(),createElementBlock(Fragment,null,[createVNode(or,null,{default:withCtx(()=>[createVNode(dr,null,{default:withCtx(()=>[createVNode(tr,null,{default:withCtx(()=>[createVNode(Dt,null,{default:withCtx(()=>[createVNode(Ie,{type:"primary","native-type":"button",icon:unref(setting_default),onClick:ae},{default:withCtx(()=>[createTextVNode(" 修改配置 ")]),_:1},8,["icon"]),createVNode(Ie,{type:"primary","native-type":"button",icon:unref(setting_default),onClick:Ne},{default:withCtx(()=>[createTextVNode(" Mirai配置 ")]),_:1},8,["icon"]),_hoisted_1$2,n.value?(openBlock(),createBlock(Ie,{key:0,type:"primary","native-type":"button",onClick:b},{default:withCtx(()=>[createTextVNode("启动Mirai机器人")]),_:1})):createCommentVNode("",!0),createVNode(Ie,{type:"primary","native-type":"button",onClick:T},{default:withCtx(()=>[createTextVNode("启动机器人")]),_:1}),o.value?(openBlock(),createBlock(Ie,{key:1,type:"primary","native-type":"button",onClick:g},{default:withCtx(()=>[createTextVNode("启动阿里云盘")]),_:1})):createCommentVNode("",!0),createVNode(Ue,{style:{left:"25vw"}},{dropdown:withCtx(()=>[createVNode(Ve,null,{default:withCtx(()=>[createVNode(ie,{onClick:ze},{default:withCtx(()=>[createTextVNode("抓取微博")]),_:1})]),_:1})]),default:withCtx(()=>[createVNode(Ie,{type:"primary",circle:"",icon:unref(arrow_down_default)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),createVNode(Fe,null,{default:withCtx(()=>[createVNode(hr,{gutter:20},{default:withCtx(()=>[createVNode(sr,{span:12},{default:withCtx(()=>[_hoisted_2$2,createBaseVNode("div",_hoisted_3$2,[(openBlock(!0),createElementBlock(Fragment,null,renderList(c.value,(ir,$e)=>(openBlock(),createElementBlock("div",_hoisted_4$2,[createTextVNode(toDisplayString($e+1+":")+" ",1),ir.type!=2?(openBlock(),createElementBlock("span",_hoisted_5$2,toDisplayString(ir.content),1)):createCommentVNode("",!0),ir.type==2?(openBlock(),createElementBlock("span",_hoisted_6$1,[createTextVNode(toDisplayString(ir.content)+" ",1),createVNode(fr,{style:{height:"80px",width:"80px"},src:ir.url,"preview-src-list":[ir.url]},null,8,["src","preview-src-list"])])):createCommentVNode("",!0)]))),256))])]),_:1}),createVNode(sr,{span:12},{default:withCtx(()=>[createBaseVNode("h3",{title:"点此刷新",onClick:ue,style:{cursor:"pointer","margin-left":"40%"}},"图片列表"),createBaseVNode("div",_hoisted_7$1,[createBaseVNode("table",null,[_hoisted_8$1,(openBlock(!0),createElementBlock(Fragment,null,renderList(d.value,(ir,$e)=>(openBlock(),createElementBlock("tr",null,[createBaseVNode("td",_hoisted_9$1,[createVNode(fr,{style:{height:"80px",width:"80px"},src:ir.content,"preview-src-list":[ir.content]},null,8,["src","preview-src-list"])]),createBaseVNode("td",null,[createVNode(Ie,{size:"small",onClick:er=>Ce(ir.id,$e)},{default:withCtx(()=>[createTextVNode("保存")]),_:2},1032,["onClick"]),createVNode(Ie,{size:"small",type:"danger",onClick:er=>re(ir.id,$e)},{default:withCtx(()=>[createTextVNode("删除")]),_:2},1032,["onClick"])])]))),256))])])]),_:1})]),_:1})]),_:1})]),_:1}),_hoisted_10$1],64)}}}),elCascader="",elTag="",elCascaderPanel="",elCheckbox="",elRadio="",elDialog="",elBacktop="",elCollapse="",elUpload="",elProgress="",elIcon="",elSwitch="",elCollapseItem="",elOption="",elOptionGroup="",elSelect="",elCheckboxGroup="",elTransfer="",elAffix="",_hoisted_1$1={style:{"margin-bottom":"1%"}},_hoisted_2$1=createBaseVNode("label",{style:{"font-size":"18px","margin-right":"3%"}},"启用模块",-1),_hoisted_3$1=createBaseVNode("span",{style:{color:"red"}},"*撤回机器人需要管理员权限，私信需要与机器人为好友",-1),_hoisted_4$1=createBaseVNode("span",{style:{color:"red"}},"*用户微博人脸识别",-1),_hoisted_5$1=createBaseVNode("span",{style:{color:"red"}},"*多个用英文逗号,分隔",-1),_hoisted_6=createBaseVNode("span",{style:{color:"red"}},"*当【关注用户】发的微博文案中含有这些词汇时监听生效",-1),_hoisted_7=createBaseVNode("span",{style:{color:"red"}},"*多个用英文逗号,分隔；不填写则使用qq配置的群",-1),_hoisted_8=createBaseVNode("span",{style:{color:"red"}},"*多个用英文逗号,分隔；不填写则默认超管",-1),_hoisted_9=createBaseVNode("span",{style:{color:"red"}},"*多个用英文逗号,分隔；不填写则使用qq配置的群",-1),_hoisted_10=createBaseVNode("span",{style:{color:"red"}},"*多个用英文逗号,分隔；不填写则默认超管",-1),_hoisted_11=createBaseVNode("span",{style:{color:"red"}},"*IM账号和token可点此登录口袋后自动获取",-1),_hoisted_12=createBaseVNode("span",{style:{color:"red"}},"*多个用英文逗号,分隔；不填写则使用qq配置的群",-1),_hoisted_13=createBaseVNode("span",{style:{color:"red"}},"*多个用英文逗号,分隔；不填写则默认超管",-1),_hoisted_14=createBaseVNode("span",{style:{color:"red"}},"*多个用英文逗号,分隔；不填写则使用qq配置的群",-1),_hoisted_15=createBaseVNode("span",{style:{color:"red"}},"*多个用英文逗号,分隔；不填写则默认超管",-1),_hoisted_16=createBaseVNode("span",{style:{color:"red"}},"*多个用英文逗号,分隔；不填写则使用qq配置的群",-1),_hoisted_17=createBaseVNode("span",{style:{color:"red"}},"*多个用英文逗号,分隔；不填写则默认超管",-1),_hoisted_18=createBaseVNode("span",{style:{color:"red"}},"*上传人脸轮廓清晰的图片",-1),_hoisted_19=createBaseVNode("span",{style:{color:"red"}},"*直接保存(非双胞胎建议80，双胞胎建议70)",-1),_hoisted_20=createBaseVNode("span",{style:{color:"red"}},"*超过该值，但未超过上面的值，将加入审核列表，审核通过才会保存",-1),_hoisted_21=createBaseVNode("span",{style:{color:"red"}},"*启用会将图片自动上传到阿里云盘相册",-1),_hoisted_22={key:0,style:{width:"95%","margin-top":"5px"}},_hoisted_23=createBaseVNode("span",null,"未查询到小偶像，检查名称等后重新查询或者自行通过下方地址获取小偶像信息填入：",-1),_hoisted_24={style:{"word-break":"break-all"}},_sfc_main$2=defineComponent({__name:"Config",setup(t){const r=ref([]),e=ref([]),n=ref([]),o=ref([]),s=ref(!1),a=ref({show:!1,group:[],name:"",loading:!1,url:""}),i=ref({qq:!1,wb:!1,bz:!1,kd:!1,xhs:!1,dy:!1,bd:!1}),u=ref(),c=ref({QQ:{group:"",funcEnable:"",funcEnable1:[],funcAdmin:"",funcAdmin1:[],funcUser:"",funcUser1:[],admin:"",notice:!1,permission:"",sensitive:"",action:"",actions:Array(),debug:!1,gptKey:""},WB:{url:"",timeSpan:0,group:"",forwardGroup:!1,qq:"",forwardQQ:!1,cg:"",keyword:""},BZ:{url:"",timeSpan:0,group:"",forwardGroup:!1,qq:"",forwardQQ:!1},KD:{name:"",sec:60,hasSend:!1,area:"86",code:"",phone:"",group:"",forwardGroup:!1,token:"",account:"",serverId:"",qq:"",forwardQQ:!1,liveRoomId:"",msgType:""},XHS:{url:"",timeSpan:0,group:"",forwardGroup:!1,qq:"",forwardQQ:!1},DY:{url:"",timeSpan:0,group:"",forwardGroup:!1,qq:"",forwardQQ:!1},BD:{appKey:"",appSeret:"",faceVerify:!1,imageList:"",imageList1:new Array,similarity:0,saveAliyunDisk:!1,audit:0,albumName:""}}),d=ref({input:[{required:!0,message:"请输入该值",trigger:"blur"}],imageList1:[{required:!0,validator:(re,ue,ze)=>{c.value.BD.faceVerify&&c.value.BD.imageList1.length<=0&&ze(new Error("请上传图片")),ze()},trigger:["blur","change"]}],audit:[{required:!0,validator:(re,ue,ze)=>{c.value.BD.faceVerify&&!ue&&ze(new Error("请输入该值")),ze()},trigger:["blur","change"]}],saveAliyunDisk:[{required:!0,validator:(re,ue,ze)=>{c.value.BD.saveAliyunDisk&&!ue&&ze(new Error("请输入该值")),ze()},trigger:["blur","change"]}]});watch(e,(re,ue)=>{if(re.length<=0){c.value.QQ.funcEnable1=[];return}var ze=re.filter(function(Ie){return ue.indexOf(Ie)===-1}).concat(ue.filter(function(Ie){return re.indexOf(Ie)===-1})),le=ze[0];if(re.length>ue.length&&r.value.forEach(Ie=>{if(Ie.value==le&&!c.value.QQ.funcEnable1.some(ie=>ie.value==le)){c.value.QQ.funcEnable1.push(Ie);return}}),re.length<ue.length){var de=-1;c.value.QQ.funcEnable1.forEach((Ie,ie)=>{if(Ie.value==le){de=ie;return}}),c.value.QQ.funcEnable1.splice(de,1)}}),onMounted(()=>{axios$1({url:"http://parkerbot.api/api/GetBaseConfig"}).then(re=>{for(let ue in i.value)for(let ze of re.data.enable)if(ze.key.toLowerCase()==ue){JSON.parse(ze.value)?i.value[ue]=!0:i.value[ue]=!1;continue}o.value=JSON.parse(re.data.config.KD.msgTypeList),re.data.config.QQ.funcEnable1=re.data.config.QQ.funcEnable?JSON.parse(re.data.config.QQ.funcEnable):new Array,re.data.config.QQ.funcAdmin1=re.data.config.QQ.funcAdmin?re.data.config.QQ.funcAdmin.split(","):[],re.data.config.QQ.funcUser1=re.data.config.QQ.funcUser?re.data.config.QQ.funcUser.split(","):[],c.value=re.data.config,c.value.QQ.actions=c.value.QQ.action===""?[]:c.value.QQ.action.split(","),c.value.KD.area="86",e.value=re.data.config.QQ.funcEnable1.map(ue=>ue.value),n.value=c.value.KD.msgType?c.value.KD.msgType.split(","):[]}),axios$1({url:"http://parkerbot.api/api/GetQQFun"}).then(re=>{r.value=re.data})});const m=()=>{history.go(-1)},v=async re=>{re&&await re.validate((ue,ze)=>{if(ue){c.value.BD.imageList=c.value.BD.imageList1.map(Ie=>Ie.url).toString(),c.value.QQ.action=c.value.QQ.actions.toString(),c.value.QQ.funcEnable=JSON.stringify(c.value.QQ.funcEnable1);var le=c.value.QQ.funcEnable1.map(Ie=>Ie.value),de=le.filter(function(Ie){return c.value.QQ.funcUser.indexOf(Ie)==-1});c.value.QQ.funcAdmin=de.toString(),c.value.QQ.funcUser=c.value.QQ.funcUser1.toString(),c.value.KD.msgType=n.value.toString(),console.log(c.value.QQ),axios$1({url:"http://parkerbot.api/api/SetConfig",method:"post",data:{config:c.value,enable:i.value}}).then(Ie=>{Ie.data?ElMessage({message:"修改成功",type:"success"}):ElMessage({message:"修改失败，请重试。如果连续失败，请联系作者！",type:"error"})})}else return ElMessage({message:"请检查配置信息是否均已填写完成",type:"warning"}),!1})},g=()=>{a.value.loading=!1,a.value.show=!1,a.value.name="",a.value.url="",a.value.group=[],s.value=!1,c.value.KD.hasSend=!1,c.value.KD.sec=60},b=()=>{if(!c.value.KD.phone){ElMessage({message:"请输入手机号码！",type:"warning"});return}var re=/^1[3456789]\d{9}$/;if(re.test(c.value.KD.phone)==!1){ElMessage({message:"手机号码格式有误，请重新输入！",type:"warning"});return}c.value.KD.hasSend=!0,k(),axios$1({url:"https://pocketapi.48.cn/user/api/v1/sms/send2",method:"post",headers:V(""),responseType:"json",timeout:18e4,data:{mobile:c.value.KD.phone,area:c.value.KD.area}}).then(ue=>{ue.data.success&&ElMessage({message:"发送成功，请注意查收！",type:"success"})})},T=()=>{if(!c.value.KD.phone){ElMessage({message:"请输入手机号码！",type:"warning"});return}if(!c.value.KD.code){ElMessage({message:"请输入验证码！",type:"warning"});return}var re=/^1[3456789]\d{9}$/;if(re.test(c.value.KD.phone)==!1){ElMessage({message:"手机号码格式有误，请重新输入！",type:"warning"});return}axios$1({url:"https://pocketapi.48.cn/user/api/v1/login/app/mobile/code",method:"post",headers:V(""),responseType:"json",timeout:18e4,data:{mobile:c.value.KD.phone,code:c.value.KD.code}}).then(ue=>{axios$1({url:"https://pocketapi.48.cn/im/api/v1/im/userinfo",method:"post",headers:V(ue.data.content.token),responseType:"json",timeout:18e4}).then(ze=>{c.value.KD.token=ze.data.content.pwd,c.value.KD.account=ze.data.content.accid,setTimeout(()=>{g()},1e3)})})},k=()=>{c.value.KD.sec=60;let re;re=setInterval(()=>{c.value.KD.sec>0?c.value.KD.sec--:(clearInterval(re),c.value.KD.sec=60,c.value.KD.hasSend=!1)},1e3)},y=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(re){var ue=Math.random()*16|0,ze=re=="x"?ue:ue&3|8;return ze.toString(16)})},A=function(re){const ue="QWERTYUIOPASDFGHJKLZXCVBNM1234567890";let ze="";for(let le=0;le<re;le++){const de=Math.floor(Math.random()*ue.length);ze+=ue[de]}return ze},V=function(re){var ue={pa:y(),"Content-Type":"application/json;charset=utf-8",appInfo:JSON.stringify({vendor:"apple",deviceId:`${A(8)}-${A(4)}-${A(4)}-${A(4)}-${A(12)}`,appVersion:"6.2.2",appBuild:"21080401",osVersion:"11.4.1",osType:"ios",deviceName:"iPhone XR",os:"ios"}),"Accept-Language":"zh-Hans-AW;q=1",token:""};return re&&(ue.token=re),ue},he=re=>{c.value.BD.imageList1.push(re)},ae=re=>{var ue=-1;c.value.BD.imageList1.forEach((ze,le)=>{if(ze.name===re.name){ue=le;return}}),ue>=0&&c.value.BD.imageList1.splice(ue,1)},Ne=ref([{label:"SNH48",value:"SNH48",children:[{value:"TEAM SII",label:"TEAM SII"},{value:"TEAM HII",label:"TEAM HII"},{value:"TEAM X",label:"TEAM X"}]},{label:"GNZ48",value:"GNZ48",children:[{value:"TEAM G",label:"TEAM G"},{value:"TEAM NIII",label:"TEAM NIII"},{value:"TEAM Z",label:"TEAM Z"},{value:"TEAM CII",label:"TEAM CII"}]},{label:"CGT48",value:"CGT48",children:[{value:"TEAM GII",label:"TEAM GII"}]},{label:"BEJ48",value:"BEJ48",children:[{value:"TEAM B",label:"TEAM B"},{value:"TEAM E",label:"TEAM E"}]},{label:"CKG48",value:"CKG48"}]),_e=async()=>{if(!a.value.name){ElMessage({message:"请输入小偶像姓名",type:"error"});return}a.value.loading=!0;var re=await axios$1({url:"http://parkerbot.api/api/getxox?group="+a.value.group.toString()+"&name="+a.value.name}).catch(()=>{a.value.loading=!1});if(re.data.success){var ue=re.data.data;c.value.KD.name=ue.name,c.value.KD.liveRoomId=ue.liveId,c.value.KD.serverId=ue.serverId,g()}else a.value.url=re.data.data;a.value.loading=!1},Ce=()=>{};return(re,ue)=>{const ze=ElButton,le=ElAffix,de=ElHeader,Ie=ElCheckbox,ie=ElInput,Ve=ElFormItem,Ue=ElCol,Dt=ElCheckboxGroup,tr=ElTransfer,dr=ElOption,fr=ElSelect,sr=ElCollapseItem,hr=ElSwitch,Fe=ElIcon,or=ElUpload,ir=ElForm,$e=ElCollapse,er=ElBacktop,nr=ElMain,Pt=ElContainer,rr=ElDialog,kt=ElCascader;return openBlock(),createElementBlock(Fragment,null,[createVNode(Pt,null,{default:withCtx(()=>[createVNode(de,null,{default:withCtx(()=>[createVNode(le,{offset:30},{default:withCtx(()=>[createVNode(ze,{type:"primary","native-type":"button",icon:unref(arrow_left_default),onClick:m},{default:withCtx(()=>[createTextVNode("返回")]),_:1},8,["icon"]),createVNode(ze,{type:"primary","native-type":"button",icon:unref(edit_default),onClick:ue[0]||(ue[0]=Et=>v(u.value))},{default:withCtx(()=>[createTextVNode("保存")]),_:1},8,["icon"]),createVNode(ze,{type:"primary","native-type":"button",icon:unref(setting_default),onClick:ue[1]||(ue[1]=Et=>Ce())},{default:withCtx(()=>[createTextVNode("重置")]),_:1},8,["icon"])]),_:1})]),_:1}),createVNode(nr,null,{default:withCtx(()=>[createBaseVNode("div",_hoisted_1$1,[_hoisted_2$1,createVNode(Ie,{modelValue:i.value.qq,"onUpdate:modelValue":ue[2]||(ue[2]=Et=>i.value.qq=Et),label:"QQ"},null,8,["modelValue"]),createVNode(Ie,{modelValue:i.value.wb,"onUpdate:modelValue":ue[3]||(ue[3]=Et=>i.value.wb=Et),label:"微博"},null,8,["modelValue"]),createVNode(Ie,{modelValue:i.value.bz,"onUpdate:modelValue":ue[4]||(ue[4]=Et=>i.value.bz=Et),label:"B站"},null,8,["modelValue"]),createVNode(Ie,{modelValue:i.value.kd,"onUpdate:modelValue":ue[5]||(ue[5]=Et=>i.value.kd=Et),label:"口袋48"},null,8,["modelValue"]),createVNode(Ie,{modelValue:i.value.xhs,"onUpdate:modelValue":ue[6]||(ue[6]=Et=>i.value.xhs=Et),label:"小红书"},null,8,["modelValue"]),createVNode(Ie,{modelValue:i.value.dy,"onUpdate:modelValue":ue[7]||(ue[7]=Et=>i.value.dy=Et),label:"抖音"},null,8,["modelValue"]),createVNode(Ie,{modelValue:i.value.bd,"onUpdate:modelValue":ue[8]||(ue[8]=Et=>i.value.bd=Et),label:"百度"},null,8,["modelValue"])]),createVNode($e,null,{default:withCtx(()=>[createVNode(ir,{ref_key:"form",ref:u,model:c.value,"label-width":"100px"},{default:withCtx(()=>[i.value.qq?(openBlock(),createBlock(sr,{key:0,title:"QQ",name:"qq"},{default:withCtx(()=>[createVNode(Ve,{label:"QQ群",prop:"QQ.group",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.QQ.group,"onUpdate:modelValue":ue[9]||(ue[9]=Et=>c.value.QQ.group=Et),placeholder:"多个用英文逗号,分隔；不填写则qq机器人所在的全部群开启，填写则针对填写的群开启"},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ve,{label:"超级管理员",prop:"QQ.admin",rules:d.value.input},{default:withCtx(()=>[createVNode(Ue,{span:16},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.QQ.admin,"onUpdate:modelValue":ue[10]||(ue[10]=Et=>c.value.QQ.admin=Et),placeholder:"仅支持配置一个账号"},null,8,["modelValue"])]),_:1}),createVNode(Ue,{span:3,style:{"margin-left":"2%"}},{default:withCtx(()=>[createVNode(Ie,{modelValue:c.value.QQ.notice,"onUpdate:modelValue":ue[11]||(ue[11]=Et=>c.value.QQ.notice=Et),label:"开启消息通知"},null,8,["modelValue"])]),_:1}),createVNode(Ue,{span:3,style:{"margin-left":"2%"}},{default:withCtx(()=>[createVNode(Ie,{modelValue:c.value.QQ.debug,"onUpdate:modelValue":ue[12]||(ue[12]=Et=>c.value.QQ.debug=Et),label:"开启程序错误通知"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules"]),createVNode(Ve,{label:"管理员"},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.QQ.permission,"onUpdate:modelValue":ue[13]||(ue[13]=Et=>c.value.QQ.permission=Et),placeholder:"多个用英文逗号,分隔"},null,8,["modelValue"])]),_:1}),createVNode(Ve,{label:"启用功能"},{default:withCtx(()=>[createVNode(Dt,{modelValue:e.value,"onUpdate:modelValue":ue[14]||(ue[14]=Et=>e.value=Et)},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.value,Et=>(openBlock(),createBlock(Ie,{label:Et.value,key:Et.id},{default:withCtx(()=>[createTextVNode(toDisplayString(Et.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),createVNode(Ve,{label:"功能分类"},{default:withCtx(()=>[createVNode(tr,{modelValue:c.value.QQ.funcUser1,"onUpdate:modelValue":ue[15]||(ue[15]=Et=>c.value.QQ.funcUser1=Et),data:c.value.QQ.funcEnable1,titles:["管理员","普通用户"],props:{key:"value",label:"name"}},null,8,["modelValue","data"])]),_:1}),createVNode(Ve,{label:"敏感词"},{default:withCtx(()=>[createVNode(ie,{type:"textarea",modelValue:c.value.QQ.sensitive,"onUpdate:modelValue":ue[16]||(ue[16]=Et=>c.value.QQ.sensitive=Et),placeholder:"多个用英文逗号,分隔"},null,8,["modelValue"])]),_:1}),createVNode(Ve,{label:"敏感词操作"},{default:withCtx(()=>[createVNode(fr,{modelValue:c.value.QQ.actions,"onUpdate:modelValue":ue[17]||(ue[17]=Et=>c.value.QQ.actions=Et),multiple:"",placeholder:"请选择","collapse-tags":"",style:{width:"30%"}},{default:withCtx(()=>[createVNode(dr,{label:"群内提示",value:"1"}),createVNode(dr,{label:"私信群管理员",value:"2"}),createVNode(dr,{label:"私信机器人管理员",value:"3"}),createVNode(dr,{label:"私信机器人超管",value:"4"}),createVNode(dr,{label:"撤回",value:"5"})]),_:1},8,["modelValue"]),_hoisted_3$1]),_:1}),createVNode(Ve,{label:"ChatGpt密钥"},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.QQ.gptKey,"onUpdate:modelValue":ue[18]||(ue[18]=Et=>c.value.QQ.gptKey=Et),placeholder:"启用【问答功能时需要提供】"},null,8,["modelValue"])]),_:1})]),_:1})):createCommentVNode("",!0),i.value.wb?(openBlock(),createBlock(sr,{key:1,title:"微博",name:"wb"},{default:withCtx(()=>[createVNode(Ve,{label:"主要用户",prop:"WB.url",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.WB.url,"onUpdate:modelValue":ue[19]||(ue[19]=Et=>c.value.WB.url=Et),placeholder:"多个用英文,分隔"},null,8,["modelValue"]),_hoisted_4$1]),_:1},8,["rules"]),i.value.qq?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(Ve,{label:"关注用户"},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.WB.cg,"onUpdate:modelValue":ue[20]||(ue[20]=Et=>c.value.WB.cg=Et),placeholder:"多个用英文,分隔"},null,8,["modelValue"]),_hoisted_5$1]),_:1}),createVNode(Ve,{label:"微博关键词"},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.WB.keyword,"onUpdate:modelValue":ue[21]||(ue[21]=Et=>c.value.WB.keyword=Et),placeholder:"多个用英文逗号,分隔"},null,8,["modelValue"]),_hoisted_6]),_:1})],64)):createCommentVNode("",!0),createVNode(Ve,{label:"监听间隔",prop:"WB.timeSpan",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{type:"number",modelValue:c.value.WB.timeSpan,"onUpdate:modelValue":ue[22]||(ue[22]=Et=>c.value.WB.timeSpan=Et),placeholder:"单位分钟"},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ve,{label:"转发至qq群"},{default:withCtx(()=>[createVNode(hr,{modelValue:c.value.WB.forwardGroup,"onUpdate:modelValue":ue[23]||(ue[23]=Et=>c.value.WB.forwardGroup=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),withDirectives(createVNode(Ve,{label:"qq群"},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.WB.group,"onUpdate:modelValue":ue[24]||(ue[24]=Et=>c.value.WB.group=Et),placeholder:"发新微博转发消息"},null,8,["modelValue"]),_hoisted_7]),_:1},512),[[vShow,c.value.WB.forwardGroup===!0]]),createVNode(Ve,{label:"转发至qq好友"},{default:withCtx(()=>[createVNode(hr,{modelValue:c.value.WB.forwardQQ,"onUpdate:modelValue":ue[25]||(ue[25]=Et=>c.value.WB.forwardQQ=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),withDirectives(createVNode(Ve,{label:"qq好友"},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.WB.qq,"onUpdate:modelValue":ue[26]||(ue[26]=Et=>c.value.WB.qq=Et),placeholder:"发新微博转发消息"},null,8,["modelValue"]),_hoisted_8]),_:1},512),[[vShow,c.value.WB.forwardQQ===!0]])]),_:1})):createCommentVNode("",!0),i.value.bz?(openBlock(),createBlock(sr,{key:2,title:"B站",name:"bz"},{default:withCtx(()=>[createVNode(Ve,{label:"用户ID",prop:"BZ.url",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.BZ.url,"onUpdate:modelValue":ue[27]||(ue[27]=Et=>c.value.BZ.url=Et),placeholder:"多个用英文,分隔"},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ve,{label:"监听间隔",prop:"BZ.timeSpan",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{type:"number",modelValue:c.value.BZ.timeSpan,"onUpdate:modelValue":ue[28]||(ue[28]=Et=>c.value.BZ.timeSpan=Et),placeholder:"单位分钟"},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ve,{label:"转发至qq群"},{default:withCtx(()=>[createVNode(hr,{modelValue:c.value.BZ.forwardGroup,"onUpdate:modelValue":ue[29]||(ue[29]=Et=>c.value.BZ.forwardGroup=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),withDirectives(createVNode(Ve,{label:"qq群"},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.BZ.group,"onUpdate:modelValue":ue[30]||(ue[30]=Et=>c.value.BZ.group=Et),placeholder:"发新动态转发消息"},null,8,["modelValue"]),_hoisted_9]),_:1},512),[[vShow,c.value.BZ.forwardGroup===!0]]),createVNode(Ve,{label:"转发至qq好友"},{default:withCtx(()=>[createVNode(hr,{modelValue:c.value.BZ.forwardQQ,"onUpdate:modelValue":ue[31]||(ue[31]=Et=>c.value.BZ.forwardQQ=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),withDirectives(createVNode(Ve,{label:"qq好友"},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.BZ.qq,"onUpdate:modelValue":ue[32]||(ue[32]=Et=>c.value.BZ.qq=Et),placeholder:"发新微博转发消息"},null,8,["modelValue"]),_hoisted_10]),_:1},512),[[vShow,c.value.BZ.forwardQQ===!0]])]),_:1})):createCommentVNode("",!0),i.value.kd?(openBlock(),createBlock(sr,{key:3,title:"口袋48",name:"kd"},{default:withCtx(()=>[createVNode(Ve,{label:"姓名",prop:"KD.name",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.KD.name,"onUpdate:modelValue":ue[33]||(ue[33]=Et=>c.value.KD.name=Et)},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ve,{label:"IMServerId",prop:"KD.serverId",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.KD.serverId,"onUpdate:modelValue":ue[34]||(ue[34]=Et=>c.value.KD.serverId=Et)},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ve,{label:"直播房间Id",prop:"KD.liveRoomId",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.KD.liveRoomId,"onUpdate:modelValue":ue[35]||(ue[35]=Et=>c.value.KD.liveRoomId=Et)},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ve,null,{default:withCtx(()=>[createVNode(ze,{onClick:ue[36]||(ue[36]=Et=>a.value.show=!0)},{default:withCtx(()=>[createTextVNode("查询小偶像信息")]),_:1})]),_:1}),createVNode(Ve,{label:"IM账号",prop:"KD.account",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.KD.account,"onUpdate:modelValue":ue[37]||(ue[37]=Et=>c.value.KD.account=Et)},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ve,{label:"IMtoken",prop:"KD.token",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.KD.token,"onUpdate:modelValue":ue[38]||(ue[38]=Et=>c.value.KD.token=Et)},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ve,null,{default:withCtx(()=>[createVNode(ze,{onClick:ue[39]||(ue[39]=Et=>s.value=!0)},{default:withCtx(()=>[createTextVNode("登录口袋48")]),_:1}),_hoisted_11]),_:1}),createVNode(Ve,{label:"转发至qq群"},{default:withCtx(()=>[createVNode(hr,{modelValue:c.value.KD.forwardGroup,"onUpdate:modelValue":ue[40]||(ue[40]=Et=>c.value.KD.forwardGroup=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),withDirectives(createVNode(Ve,{label:"qq群"},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.KD.group,"onUpdate:modelValue":ue[41]||(ue[41]=Et=>c.value.KD.group=Et),placeholder:"发新消息转发消息"},null,8,["modelValue"]),_hoisted_12]),_:1},512),[[vShow,c.value.KD.forwardGroup===!0]]),createVNode(Ve,{label:"转发至qq好友"},{default:withCtx(()=>[createVNode(hr,{modelValue:c.value.KD.forwardQQ,"onUpdate:modelValue":ue[42]||(ue[42]=Et=>c.value.KD.forwardQQ=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),withDirectives(createVNode(Ve,{label:"qq好友"},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.KD.qq,"onUpdate:modelValue":ue[43]||(ue[43]=Et=>c.value.KD.qq=Et),placeholder:"发新微博转发消息"},null,8,["modelValue"]),_hoisted_13]),_:1},512),[[vShow,c.value.KD.forwardQQ===!0]]),withDirectives(createVNode(Ve,{label:"监听消息类型"},{default:withCtx(()=>[createVNode(Dt,{modelValue:n.value,"onUpdate:modelValue":ue[44]||(ue[44]=Et=>n.value=Et)},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(o.value,(Et,cr)=>(openBlock(),createBlock(Ie,{label:Et.value,key:cr},{default:withCtx(()=>[createTextVNode(toDisplayString(Et.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},512),[[vShow,c.value.KD.forwardGroup===!0||c.value.KD.forwardQQ===!0]])]),_:1})):createCommentVNode("",!0),i.value.xhs?(openBlock(),createBlock(sr,{key:4,title:"小红书",name:"xhs"},{default:withCtx(()=>[createVNode(Ve,{label:"用户ID",prop:"XHS.url",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.XHS.url,"onUpdate:modelValue":ue[45]||(ue[45]=Et=>c.value.XHS.url=Et),placeholder:"多个用英文,分隔"},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ve,{label:"监听时长",prop:"XHS.timeSpan",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{type:"number",modelValue:c.value.XHS.timeSpan,"onUpdate:modelValue":ue[46]||(ue[46]=Et=>c.value.XHS.timeSpan=Et),placeholder:"单位分钟"},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ve,{label:"转发至qq群"},{default:withCtx(()=>[createVNode(hr,{modelValue:c.value.XHS.forwardGroup,"onUpdate:modelValue":ue[47]||(ue[47]=Et=>c.value.XHS.forwardGroup=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),withDirectives(createVNode(Ve,{label:"qq群"},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.XHS.group,"onUpdate:modelValue":ue[48]||(ue[48]=Et=>c.value.XHS.group=Et),placeholder:"发新动态转发消息"},null,8,["modelValue"]),_hoisted_14]),_:1},512),[[vShow,c.value.XHS.forwardGroup===!0]]),createVNode(Ve,{label:"转发至qq好友"},{default:withCtx(()=>[createVNode(hr,{modelValue:c.value.XHS.forwardQQ,"onUpdate:modelValue":ue[49]||(ue[49]=Et=>c.value.XHS.forwardQQ=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),withDirectives(createVNode(Ve,{label:"qq好友"},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.XHS.qq,"onUpdate:modelValue":ue[50]||(ue[50]=Et=>c.value.XHS.qq=Et),placeholder:"发新微博转发消息"},null,8,["modelValue"]),_hoisted_15]),_:1},512),[[vShow,c.value.XHS.forwardQQ===!0]])]),_:1})):createCommentVNode("",!0),i.value.dy?(openBlock(),createBlock(sr,{key:5,title:"抖音",name:"dy"},{default:withCtx(()=>[createVNode(Ve,{label:"用户ID",prop:"DY.url",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.DY.url,"onUpdate:modelValue":ue[51]||(ue[51]=Et=>c.value.DY.url=Et),placeholder:"多个用英文,分隔"},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ve,{label:"监听时长",prop:"DY.timeSpan",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{type:"number",modelValue:c.value.DY.timeSpan,"onUpdate:modelValue":ue[52]||(ue[52]=Et=>c.value.DY.timeSpan=Et),placeholder:"单位分钟"},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ve,{label:"转发至qq群"},{default:withCtx(()=>[createVNode(hr,{modelValue:c.value.DY.forwardGroup,"onUpdate:modelValue":ue[53]||(ue[53]=Et=>c.value.DY.forwardGroup=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),withDirectives(createVNode(Ve,{label:"qq群"},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.DY.group,"onUpdate:modelValue":ue[54]||(ue[54]=Et=>c.value.DY.group=Et),placeholder:"发新抖音转发消息"},null,8,["modelValue"]),_hoisted_16]),_:1},512),[[vShow,c.value.DY.forwardGroup===!0]]),createVNode(Ve,{label:"转发至qq好友"},{default:withCtx(()=>[createVNode(hr,{modelValue:c.value.DY.forwardQQ,"onUpdate:modelValue":ue[55]||(ue[55]=Et=>c.value.DY.forwardQQ=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),withDirectives(createVNode(Ve,{label:"qq好友"},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.DY.qq,"onUpdate:modelValue":ue[56]||(ue[56]=Et=>c.value.DY.qq=Et),placeholder:"发新微博转发消息"},null,8,["modelValue"]),_hoisted_17]),_:1},512),[[vShow,c.value.DY.forwardQQ===!0]])]),_:1})):createCommentVNode("",!0),i.value.bd?(openBlock(),createBlock(sr,{key:6,title:"百度",name:"bd"},{default:withCtx(()=>[createVNode(Ve,{label:"apiKey",prop:"BD.appKey",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.BD.appKey,"onUpdate:modelValue":ue[57]||(ue[57]=Et=>c.value.BD.appKey=Et),placeholder:"百度appKey"},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ve,{label:"appSeret",prop:"BD.appSeret",rules:d.value.input},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.BD.appSeret,"onUpdate:modelValue":ue[58]||(ue[58]=Et=>c.value.BD.appSeret=Et),placeholder:"百度appSeret"},null,8,["modelValue"])]),_:1},8,["rules"]),createVNode(Ve,{label:"开启人脸验证"},{default:withCtx(()=>[createVNode(hr,{modelValue:c.value.BD.faceVerify,"onUpdate:modelValue":ue[59]||(ue[59]=Et=>c.value.BD.faceVerify=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),withDirectives(createVNode(Ve,{label:"基础人脸",prop:"BD.imageList1",rules:d.value.imageList1},{default:withCtx(()=>[createVNode(or,{"file-list":c.value.BD.imageList1,action:"http://parkerbot.api/api/upload","on-success":he,"on-remove":ae,"list-type":"picture-card",limit:3,accept:".jpg,.png,.jpeg"},{default:withCtx(()=>[createVNode(Fe,null,{default:withCtx(()=>[createVNode(unref(plus_default))]),_:1})]),_:1},8,["file-list"]),_hoisted_18]),_:1},8,["rules"]),[[vShow,c.value.BD.faceVerify]]),withDirectives(createVNode(Ve,{label:"人脸相似度",prop:"BD.similarity",rules:d.value.audit},{default:withCtx(()=>[createVNode(Ue,{span:8},{default:withCtx(()=>[createVNode(ie,{type:"number",modelValue:c.value.BD.similarity,"onUpdate:modelValue":ue[60]||(ue[60]=Et=>c.value.BD.similarity=Et)},null,8,["modelValue"])]),_:1}),_hoisted_19]),_:1},8,["rules"]),[[vShow,c.value.BD.faceVerify]]),withDirectives(createVNode(Ve,{label:"审核相似度",prop:"BD.audit",rules:d.value.audit},{default:withCtx(()=>[createVNode(Ue,{span:8},{default:withCtx(()=>[createVNode(ie,{type:"number",modelValue:c.value.BD.audit,"onUpdate:modelValue":ue[61]||(ue[61]=Et=>c.value.BD.audit=Et)},null,8,["modelValue"])]),_:1}),_hoisted_20]),_:1},8,["rules"]),[[vShow,c.value.BD.faceVerify]]),withDirectives(createVNode(Ve,{label:"上传云盘"},{default:withCtx(()=>[createVNode(hr,{modelValue:c.value.BD.saveAliyunDisk,"onUpdate:modelValue":ue[62]||(ue[62]=Et=>c.value.BD.saveAliyunDisk=Et),"active-value":!0,"inactive-value":!1},null,8,["modelValue"]),_hoisted_21]),_:1},512),[[vShow,c.value.BD.faceVerify]]),withDirectives(createVNode(Ve,{label:"相册名称",prop:"BD.albumName",rules:d.value.saveAliyunDisk},{default:withCtx(()=>[createVNode(Ue,{span:8},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.BD.albumName,"onUpdate:modelValue":ue[63]||(ue[63]=Et=>c.value.BD.albumName=Et)},null,8,["modelValue"])]),_:1})]),_:1},8,["rules"]),[[vShow,c.value.BD.saveAliyunDisk]])]),_:1})):createCommentVNode("",!0)]),_:1},8,["model"])]),_:1}),createVNode(er,{right:100,bottom:100})]),_:1})]),_:1}),createVNode(rr,{title:"登录口袋48",modelValue:s.value,"onUpdate:modelValue":ue[66]||(ue[66]=Et=>s.value=Et),"before-close":g,"close-on-click-modal":!1},{default:withCtx(()=>[createVNode(ir,{"label-width":"100px"},{default:withCtx(()=>[createVNode(Ve,{label:"手机号",required:"",class:"mt-4"},{default:withCtx(()=>[createVNode(ie,{modelValue:c.value.KD.phone,"onUpdate:modelValue":ue[64]||(ue[64]=Et=>c.value.KD.phone=Et),style:{width:"95%"}},{prepend:withCtx(()=>[createTextVNode("+"+toDisplayString(c.value.KD.area),1)]),_:1},8,["modelValue"])]),_:1}),createVNode(Ve,{label:"验证码",required:""},{default:withCtx(()=>[createVNode(ie,{type:"primary",modelValue:c.value.KD.code,"onUpdate:modelValue":ue[65]||(ue[65]=Et=>c.value.KD.code=Et),style:{width:"65%"}},null,8,["modelValue"]),withDirectives(createVNode(ze,{style:{width:"25%","margin-left":"5%"},onClick:b},{default:withCtx(()=>[createTextVNode("发送验证码")]),_:1},512),[[vShow,!c.value.KD.hasSend]]),withDirectives(createVNode(ze,{style:{width:"25%","margin-left":"5%"}},{default:withCtx(()=>[createTextVNode(toDisplayString(c.value.KD.sec)+"秒",1)]),_:1},512),[[vShow,c.value.KD.hasSend]])]),_:1}),createVNode(Ve,null,{default:withCtx(()=>[createVNode(ze,{type:"primary",onClick:T},{default:withCtx(()=>[createTextVNode("登录")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(rr,{title:"查询小偶像 ",modelValue:a.value.show,"onUpdate:modelValue":ue[69]||(ue[69]=Et=>a.value.show=Et),"before-close":g,"close-on-click-modal":!1},{default:withCtx(()=>[createVNode(ir,{"label-width":"100px"},{default:withCtx(()=>[createVNode(Ve,{label:"队伍",class:"mt-4"},{default:withCtx(()=>[createVNode(kt,{props:{expandTrigger:"hover",checkStrictly:"true"},placeholder:"请选择",modelValue:a.value.group,"onUpdate:modelValue":ue[67]||(ue[67]=Et=>a.value.group=Et),options:Ne.value,style:{width:"95%"}},null,8,["modelValue","options"])]),_:1}),createVNode(Ve,{label:"姓名",required:""},{default:withCtx(()=>[createVNode(ie,{modelValue:a.value.name,"onUpdate:modelValue":ue[68]||(ue[68]=Et=>a.value.name=Et),style:{width:"95%"}},null,8,["modelValue"])]),_:1}),createVNode(Ve,null,{default:withCtx(()=>[createVNode(ze,{type:"primary",loading:a.value.loading,onClick:_e},{default:withCtx(()=>[createTextVNode("查询")]),_:1},8,["loading"])]),_:1}),a.value.url?(openBlock(),createElementBlock("div",_hoisted_22,[_hoisted_23,createBaseVNode("div",_hoisted_24,toDisplayString(a.value.url),1)])):createCommentVNode("",!0)]),_:1})]),_:1},8,["modelValue"])],64)}}}),_hoisted_1=createBaseVNode("span",null,"配置正确目录后下方内容可以通过上方【获取配置】按钮获取。",-1),_hoisted_2=createBaseVNode("div",null,"具体配置教学由于网上很多此处不再赘述，下面提供几个教学地址：",-1),_hoisted_3=createBaseVNode("div",null,[createTextVNode("1、GitHub："),createBaseVNode("span",{style:{color:"rgb(19, 1, 173)","text-decoration-line":"underline"}},"https://sinoahpx.github.io/Mirai.Net.Documents/#/?id=mirainet-文档"),createTextVNode(" 通常来说你只用看到开始使用-快速开始-安装mirai环境即可，如果想了解什么是mirai可以看开始使用-基础知识-mirai生态 ")],-1),_hoisted_4=createBaseVNode("div",null,[createTextVNode("2、CSDN博客："),createBaseVNode("span",{style:{color:"rgb(19, 1, 173)","text-decoration-line":"underline"}},"https://blog.csdn.net/qq_30141543/article/details/125576220")],-1),_hoisted_5=createBaseVNode("div",null,[createTextVNode("3、哔哩哔哩："),createBaseVNode("span",{style:{color:"rgb(19, 1, 173)","text-decoration-line":"underline"}},"https://www.bilibili.com/video/BV1eb4y1k7uX/")],-1),_sfc_main$1=defineComponent({__name:"Mirai",setup(t){const r=ref(),e=ref({useMirai:!1,path:"",address:"",qq:"",verifyKey:""});onMounted(()=>{axios$1({url:"http://parkerbot.api/api/GetMiraiConfig"}).then(a=>{e.value=a.data})});const n=function(){axios$1({url:"http://parkerbot.api/api/getMiraiFile"}).then(a=>{a.data==!1?ElMessage({showClose:!0,message:"目录不存在或路径错误，请检查后重试！",type:"error"}):(e.value.address=a.data.address,e.value.verifyKey=a.data.verifyKey,ElMessage({showClose:!0,message:"获取成功！",type:"success"}))})},o=()=>{history.go(-1)},s=async a=>{a&&await a.validate((i,u)=>{i&&axios$1({url:"http://parkerbot.api/api/setMiraiconfig",method:"post",data:e.value}).then(c=>{if(c.data)ElMessage({showClose:!0,message:"保存成功",type:"success"});else return ElMessage({message:"修改失败，请重试。如果连续失败，请联系作者！",type:"error"}),!1})})};return(a,i)=>{const u=ElButton,c=ElHeader,d=ElSwitch,m=ElFormItem,v=ElInput,g=ElForm,b=ElMain,T=ElFooter,k=ElContainer;return openBlock(),createBlock(k,null,{default:withCtx(()=>[createVNode(c,null,{default:withCtx(()=>[createVNode(u,{type:"primary","native-type":"button",icon:unref(arrow_left_default),onClick:o},{default:withCtx(()=>[createTextVNode("返回")]),_:1},8,["icon"]),createVNode(u,{type:"primary","native-type":"button",icon:unref(edit_default),onClick:i[0]||(i[0]=y=>s(r.value))},{default:withCtx(()=>[createTextVNode("保存")]),_:1},8,["icon"])]),_:1}),createVNode(b,null,{default:withCtx(()=>[createVNode(g,{ref_key:"miraiForm",ref:r,model:e.value,"label-width":"120px"},{default:withCtx(()=>[createVNode(m,{label:"启用机器人",prop:"useMirai"},{default:withCtx(()=>[createVNode(d,{modelValue:e.value.useMirai,"onUpdate:modelValue":i[1]||(i[1]=y=>e.value.useMirai=y),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),e.value.useMirai?(openBlock(),createBlock(m,{key:0,label:"qq",prop:"qq"},{default:withCtx(()=>[createVNode(v,{modelValue:e.value.qq,"onUpdate:modelValue":i[2]||(i[2]=y=>e.value.qq=y)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.value.useMirai?(openBlock(),createBlock(m,{key:1,label:"mirai根目录",prop:"path"},{default:withCtx(()=>[createVNode(v,{modelValue:e.value.path,"onUpdate:modelValue":i[3]||(i[3]=y=>e.value.path=y),style:{width:"87%"}},null,8,["modelValue"]),createVNode(u,{onClick:n,"native-type":"button",type:"primary"},{default:withCtx(()=>[createTextVNode("获取配置")]),_:1})]),_:1})):createCommentVNode("",!0),e.value.useMirai?(openBlock(),createBlock(m,{key:2,label:"Tips："},{default:withCtx(()=>[_hoisted_1]),_:1})):createCommentVNode("",!0),e.value.useMirai?(openBlock(),createBlock(m,{key:3,label:"地址",prop:"address"},{default:withCtx(()=>[createVNode(v,{modelValue:e.value.address,"onUpdate:modelValue":i[4]||(i[4]=y=>e.value.address=y)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),e.value.useMirai?(openBlock(),createBlock(m,{key:4,label:"verifyKey",prop:"verifyKey"},{default:withCtx(()=>[createVNode(v,{modelValue:e.value.verifyKey,"onUpdate:modelValue":i[5]||(i[5]=y=>e.value.verifyKey=y)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0)]),_:1},8,["model"])]),_:1}),createVNode(T,null,{default:withCtx(()=>[_hoisted_2,_hoisted_3,_hoisted_4,_hoisted_5]),_:1})]),_:1})}}}),router=createRouter({history:createWebHistory("/"),routes:[{path:"/",name:"home",component:_sfc_main$3},{path:"/mirai",name:"mirai",component:_sfc_main$1},{path:"/config",name:"config",component:_sfc_main$2}]}),_sfc_main=defineComponent({__name:"App",setup(t){return(r,e)=>(openBlock(),createBlock(unref(RouterView)))}}),app=createApp(_sfc_main);app.use(router);app.mount("#app")});export default YC();
